/*! @preserve
 * luckysheet
 * version: 2.1.13
 * https://github.com/mengshukeji/Luckysheet
 */
var luckysheet=(()=>{var uw=Object.create,Lf=Object.defineProperty;var fw=Object.getOwnPropertyDescriptor;var hw=Object.getOwnPropertyNames;var dw=Object.getPrototypeOf,mw=Object.prototype.hasOwnProperty;var gw=e=>Lf(e,"__esModule",{value:!0});var Wo=e=>{if(typeof require!="undefined")return require(e);throw new Error('Dynamic require of "'+e+'" is not supported')};var Tt=(e,n)=>()=>(e&&(n=e(e=0)),n),fn=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),pw=(e,n)=>{for(var t in n)Lf(e,t,{get:n[t],enumerable:!0})},vw=(e,n,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let l of hw(n))!mw.call(e,l)&&l!=="default"&&Lf(e,l,{get:()=>n[l],enumerable:!(t=fw(n,l))||t.enumerable});return e},Le=e=>vw(gw(Lf(e!=null?uw(dw(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var Be=fn((kn,In)=>{(function(e,n){typeof In=="object"&&typeof In.exports=="object"?In.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)})(typeof window!="undefined"?window:kn,function(e,n){function t(H,G){return G.toUpperCase()}var l=[],o=e.document,a=l.slice,s=l.concat,u=l.push,f=l.indexOf,m={},d=m.toString,g=m.hasOwnProperty,b={},y="2.2.4",p=function(H,G){return new p.fn.init(H,G)},x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,_=/^-ms-/,S=/-([\da-z])/gi;function I(H){var G=!!H&&"length"in H&&H.length,ee=p.type(H);return ee!=="function"&&!p.isWindow(H)&&(ee==="array"||G===0||typeof G=="number"&&0<G&&G-1 in H)}p.fn=p.prototype={jquery:y,constructor:p,selector:"",length:0,toArray:function(){return a.call(this)},get:function(H){return H!=null?H<0?this[H+this.length]:this[H]:a.call(this)},pushStack:function(H){return H=p.merge(this.constructor(),H),H.prevObject=this,H.context=this.context,H},each:function(H){return p.each(this,H)},map:function(H){return this.pushStack(p.map(this,function(G,ee){return H.call(G,ee,G)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(H){var G=this.length,H=+H+(H<0?G:0);return this.pushStack(0<=H&&H<G?[this[H]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:l.sort,splice:l.splice},p.extend=p.fn.extend=function(){var H,G,ee,ne,ce,ge=arguments[0]||{},Ae=1,Je=arguments.length,at=!1;for(typeof ge=="boolean"&&(at=ge,ge=arguments[Ae]||{},Ae++),typeof ge=="object"||p.isFunction(ge)||(ge={}),Ae===Je&&(ge=this,Ae--);Ae<Je;Ae++)if((H=arguments[Ae])!=null)for(G in H)ce=ge[G],ee=H[G],ge!==ee&&(at&&ee&&(p.isPlainObject(ee)||(ne=p.isArray(ee)))?(ce=ne?(ne=!1,ce&&p.isArray(ce)?ce:[]):ce&&p.isPlainObject(ce)?ce:{},ge[G]=p.extend(at,ce,ee)):ee!==void 0&&(ge[G]=ee));return ge},p.extend({expando:"jQuery"+(y+Math.random()).replace(/\D/g,""),isReady:!0,error:function(H){throw new Error(H)},noop:function(){},isFunction:function(H){return p.type(H)==="function"},isArray:Array.isArray,isWindow:function(H){return H!=null&&H===H.window},isNumeric:function(H){var G=H&&H.toString();return!p.isArray(H)&&0<=G-parseFloat(G)+1},isPlainObject:function(H){if(p.type(H)!=="object"||H.nodeType||p.isWindow(H)||H.constructor&&!g.call(H,"constructor")&&!g.call(H.constructor.prototype||{},"isPrototypeOf"))return!1;for(var G in H);return G===void 0||g.call(H,G)},isEmptyObject:function(H){for(var G in H)return!1;return!0},type:function(H){return H==null?H+"":typeof H=="object"||typeof H=="function"?m[d.call(H)]||"object":typeof H},globalEval:function(H){var G,ee=eval;(H=p.trim(H))&&(H.indexOf("use strict")===1?((G=o.createElement("script")).text=H,o.head.appendChild(G).parentNode.removeChild(G)):ee(H))},camelCase:function(H){return H.replace(_,"ms-").replace(S,t)},nodeName:function(H,G){return H.nodeName&&H.nodeName.toLowerCase()===G.toLowerCase()},each:function(H,G){var ee,ne=0;if(I(H))for(ee=H.length;ne<ee&&G.call(H[ne],ne,H[ne])!==!1;ne++);else for(ne in H)if(G.call(H[ne],ne,H[ne])===!1)break;return H},trim:function(H){return H==null?"":(H+"").replace(x,"")},makeArray:function(H,G){return G=G||[],H!=null&&(I(Object(H))?p.merge(G,typeof H=="string"?[H]:H):u.call(G,H)),G},inArray:function(H,G,ee){return G==null?-1:f.call(G,H,ee)},merge:function(H,G){for(var ee=+G.length,ne=0,ce=H.length;ne<ee;ne++)H[ce++]=G[ne];return H.length=ce,H},grep:function(H,G,ee){for(var ne=[],ce=0,ge=H.length,Ae=!ee;ce<ge;ce++)!G(H[ce],ce)!=Ae&&ne.push(H[ce]);return ne},map:function(H,G,ee){var ne,ce,ge=0,Ae=[];if(I(H))for(ne=H.length;ge<ne;ge++)(ce=G(H[ge],ge,ee))!=null&&Ae.push(ce);else for(ge in H)ce=G(H[ge],ge,ee),ce!=null&&Ae.push(ce);return s.apply([],Ae)},guid:1,proxy:function(H,G){var ee,ne;return typeof G=="string"&&(ne=H[G],G=H,H=ne),p.isFunction(H)?(ee=a.call(arguments,2),(ne=function(){return H.apply(G||this,ee.concat(a.call(arguments)))}).guid=H.guid=H.guid||p.guid++,ne):void 0},now:Date.now,support:b}),typeof Symbol=="function"&&(p.fn[Symbol.iterator]=l[Symbol.iterator]),p.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(H,G){m["[object "+G+"]"]=G.toLowerCase()});var O=function(H){function G(Se,Ee,qe){var st="0x"+Ee-65536;return st!=st||qe?Ee:st<0?String.fromCharCode(65536+st):String.fromCharCode(st>>10|55296,1023&st|56320)}function ee(){bt()}var ne,ce,ge,Ae,Je,at,ze,Pe,ie,dt,ut,bt,Lt,Il,yr,Ql,nn,Dl,Ai,sl="sizzle"+ +new Date,kr=H.document,Kr=0,Xn=0,ho=as(),oa=as(),mi=as(),Wr=function(Se,Ee){return Se===Ee&&(ut=!0),0},vn={}.hasOwnProperty,zr=[],_n=zr.pop,mo=zr.push,Er=zr.push,sr=zr.slice,Or=function(Se,Ee){for(var qe=0,st=Se.length;qe<st;qe++)if(Se[qe]===Ee)return qe;return-1},Cn="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",_l="[\\x20\\t\\r\\n\\f]",rr="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Pn="\\["+_l+"*("+rr+")(?:"+_l+"*([*^$|!~]?=)"+_l+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+rr+"))|)"+_l+"*\\]",aa=":("+rr+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Pn+")*)|.*)\\)|)",Ws=new RegExp(_l+"+","g"),go=new RegExp("^"+_l+"+|((?:^|[^\\\\])(?:\\\\.)*)"+_l+"+$","g"),af=new RegExp("^"+_l+"*,"+_l+"*"),Wn=new RegExp("^"+_l+"*([>+~]|"+_l+")"+_l+"*"),Zc=new RegExp("="+_l+`*([^\\]'"]*?)`+_l+"*\\]","g"),qh=new RegExp(aa),sf=new RegExp("^"+rr+"$"),Fa={ID:new RegExp("^#("+rr+")"),CLASS:new RegExp("^\\.("+rr+")"),TAG:new RegExp("^("+rr+"|[*])"),ATTR:new RegExp("^"+Pn),PSEUDO:new RegExp("^"+aa),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+_l+"*(even|odd|(([+-]|)(\\d*)n|)"+_l+"*(?:([+-]|)"+_l+"*(\\d+)|))"+_l+"*\\)|)","i"),bool:new RegExp("^(?:"+Cn+")$","i"),needsContext:new RegExp("^"+_l+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+_l+"*((?:-\\d)?\\d*)"+_l+"*\\)|)(?=[^-]|$)","i")},os=/^(?:input|select|textarea|button)$/i,cf=/^h\d$/i,po=/^[^{]+\{\s*\[native \w/,Kc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Us=/[+~]/,uf=/'|\\/g,zi=new RegExp("\\\\([\\da-f]{1,6}"+_l+"?|("+_l+")|.)","ig");try{Er.apply(zr=sr.call(kr.childNodes),kr.childNodes),zr[kr.childNodes.length].nodeType}catch(Se){Er={apply:zr.length?function(Ee,qe){mo.apply(Ee,sr.call(qe))}:function(Ee,qe){for(var st=Ee.length,Dt=0;Ee[st++]=qe[Dt++];);Ee.length=st-1}}}function Cr(Se,Ee,qe,st){var Dt,il,At,Xt,fl,vl,ol,Bl,dr=Ee&&Ee.ownerDocument,gr=Ee?Ee.nodeType:9;if(qe=qe||[],typeof Se!="string"||!Se||gr!==1&&gr!==9&&gr!==11)return qe;if(!st&&((Ee?Ee.ownerDocument||Ee:kr)!==Lt&&bt(Ee),Ee=Ee||Lt,yr)){if(gr!==11&&(vl=Kc.exec(Se)))if(Dt=vl[1]){if(gr===9){if(!(At=Ee.getElementById(Dt)))return qe;if(At.id===Dt)return qe.push(At),qe}else if(dr&&(At=dr.getElementById(Dt))&&Ai(Ee,At)&&At.id===Dt)return qe.push(At),qe}else{if(vl[2])return Er.apply(qe,Ee.getElementsByTagName(Se)),qe;if((Dt=vl[3])&&ce.getElementsByClassName&&Ee.getElementsByClassName)return Er.apply(qe,Ee.getElementsByClassName(Dt)),qe}if(ce.qsa&&!mi[Se+" "]&&(!Ql||!Ql.test(Se))){if(gr!==1)dr=Ee,Bl=Se;else if(Ee.nodeName.toLowerCase()!=="object"){for((Xt=Ee.getAttribute("id"))?Xt=Xt.replace(uf,"\\$&"):Ee.setAttribute("id",Xt=sl),il=(ol=at(Se)).length,fl=sf.test(Xt)?"#"+Xt:"[id='"+Xt+"']";il--;)ol[il]=fl+" "+Ma(ol[il]);Bl=ol.join(","),dr=Us.test(Se)&&Ys(Ee.parentNode)||Ee}if(Bl)try{return Er.apply(qe,dr.querySelectorAll(Bl)),qe}catch(cl){}finally{Xt===sl&&Ee.removeAttribute("id")}}}return Pe(Se.replace(go,"$1"),Ee,qe,st)}function as(){var Se=[];function Ee(qe,st){return Se.push(qe+" ")>ge.cacheLength&&delete Ee[Se.shift()],Ee[qe+" "]=st}return Ee}function gi(Se){return Se[sl]=!0,Se}function Oi(Se){var Ee=Lt.createElement("div");try{return!!Se(Ee)}catch(qe){return!1}finally{Ee.parentNode&&Ee.parentNode.removeChild(Ee),Ee=null}}function Gs(Se,Ee){for(var qe=Se.split("|"),st=qe.length;st--;)ge.attrHandle[qe[st]]=Ee}function ss(Se,Ee){var qe=Ee&&Se,st=qe&&Se.nodeType===1&&Ee.nodeType===1&&(~Ee.sourceIndex||1<<31)-(~Se.sourceIndex||1<<31);if(st)return st;if(qe){for(;qe=qe.nextSibling;)if(qe===Ee)return-1}return Se?1:-1}function Eo(Se){return gi(function(Ee){return Ee=+Ee,gi(function(qe,st){for(var Dt,il=Se([],qe.length,Ee),At=il.length;At--;)qe[Dt=il[At]]&&(qe[Dt]=!(st[Dt]=qe[Dt]))})})}function Ys(Se){return Se&&Se.getElementsByTagName!==void 0&&Se}for(ne in ce=Cr.support={},Je=Cr.isXML=function(Se){return Se=Se&&(Se.ownerDocument||Se).documentElement,!!Se&&Se.nodeName!=="HTML"},bt=Cr.setDocument=function(Se){var Se=Se?Se.ownerDocument||Se:kr;return Se!==Lt&&Se.nodeType===9&&Se.documentElement&&(Il=(Lt=Se).documentElement,yr=!Je(Lt),(Se=Lt.defaultView)&&Se.top!==Se&&(Se.addEventListener?Se.addEventListener("unload",ee,!1):Se.attachEvent&&Se.attachEvent("onunload",ee)),ce.attributes=Oi(function(Ee){return Ee.className="i",!Ee.getAttribute("className")}),ce.getElementsByTagName=Oi(function(Ee){return Ee.appendChild(Lt.createComment("")),!Ee.getElementsByTagName("*").length}),ce.getElementsByClassName=po.test(Lt.getElementsByClassName),ce.getById=Oi(function(Ee){return Il.appendChild(Ee).id=sl,!Lt.getElementsByName||!Lt.getElementsByName(sl).length}),ce.getById?(ge.find.ID=function(Ee,qe){if(qe.getElementById!==void 0&&yr)return Ee=qe.getElementById(Ee),Ee?[Ee]:[]},ge.filter.ID=function(Ee){var qe=Ee.replace(zi,G);return function(st){return st.getAttribute("id")===qe}}):(delete ge.find.ID,ge.filter.ID=function(Ee){var qe=Ee.replace(zi,G);return function(st){return st=st.getAttributeNode!==void 0&&st.getAttributeNode("id"),st&&st.value===qe}}),ge.find.TAG=ce.getElementsByTagName?function(Ee,qe){return qe.getElementsByTagName!==void 0?qe.getElementsByTagName(Ee):ce.qsa?qe.querySelectorAll(Ee):void 0}:function(Ee,qe){var st,Dt=[],il=0,At=qe.getElementsByTagName(Ee);if(Ee!=="*")return At;for(;st=At[il++];)st.nodeType===1&&Dt.push(st);return Dt},ge.find.CLASS=ce.getElementsByClassName&&function(Ee,qe){return qe.getElementsByClassName!==void 0&&yr?qe.getElementsByClassName(Ee):void 0},nn=[],Ql=[],(ce.qsa=po.test(Lt.querySelectorAll))&&(Oi(function(Ee){Il.appendChild(Ee).innerHTML="<a id='"+sl+"'></a><select id='"+sl+"-\r\\' msallowcapture=''><option selected=''></option></select>",Ee.querySelectorAll("[msallowcapture^='']").length&&Ql.push("[*^$]="+_l+`*(?:''|"")`),Ee.querySelectorAll("[selected]").length||Ql.push("\\["+_l+"*(?:value|"+Cn+")"),Ee.querySelectorAll("[id~="+sl+"-]").length||Ql.push("~="),Ee.querySelectorAll(":checked").length||Ql.push(":checked"),Ee.querySelectorAll("a#"+sl+"+*").length||Ql.push(".#.+[+~]")}),Oi(function(Ee){var qe=Lt.createElement("input");qe.setAttribute("type","hidden"),Ee.appendChild(qe).setAttribute("name","D"),Ee.querySelectorAll("[name=d]").length&&Ql.push("name"+_l+"*[*^$|!~]?="),Ee.querySelectorAll(":enabled").length||Ql.push(":enabled",":disabled"),Ee.querySelectorAll("*,:x"),Ql.push(",.*:")})),(ce.matchesSelector=po.test(Dl=Il.matches||Il.webkitMatchesSelector||Il.mozMatchesSelector||Il.oMatchesSelector||Il.msMatchesSelector))&&Oi(function(Ee){ce.disconnectedMatch=Dl.call(Ee,"div"),Dl.call(Ee,"[s!='']:x"),nn.push("!=",aa)}),Ql=Ql.length&&new RegExp(Ql.join("|")),nn=nn.length&&new RegExp(nn.join("|")),Se=po.test(Il.compareDocumentPosition),Ai=Se||po.test(Il.contains)?function(Ee,qe){var st=Ee.nodeType===9?Ee.documentElement:Ee,qe=qe&&qe.parentNode;return Ee===qe||!(!qe||qe.nodeType!==1||!(st.contains?st.contains(qe):Ee.compareDocumentPosition&&16&Ee.compareDocumentPosition(qe)))}:function(Ee,qe){if(qe){for(;qe=qe.parentNode;)if(qe===Ee)return!0}return!1},Wr=Se?function(Ee,qe){if(Ee===qe)return ut=!0,0;var st=!Ee.compareDocumentPosition-!qe.compareDocumentPosition;return st||(1&(st=(Ee.ownerDocument||Ee)===(qe.ownerDocument||qe)?Ee.compareDocumentPosition(qe):1)||!ce.sortDetached&&qe.compareDocumentPosition(Ee)===st?Ee===Lt||Ee.ownerDocument===kr&&Ai(kr,Ee)?-1:qe===Lt||qe.ownerDocument===kr&&Ai(kr,qe)?1:dt?Or(dt,Ee)-Or(dt,qe):0:4&st?-1:1)}:function(Ee,qe){if(Ee===qe)return ut=!0,0;var st,Dt=0,il=Ee.parentNode,At=qe.parentNode,Xt=[Ee],fl=[qe];if(!il||!At)return Ee===Lt?-1:qe===Lt?1:il?-1:At?1:dt?Or(dt,Ee)-Or(dt,qe):0;if(il===At)return ss(Ee,qe);for(st=Ee;st=st.parentNode;)Xt.unshift(st);for(st=qe;st=st.parentNode;)fl.unshift(st);for(;Xt[Dt]===fl[Dt];)Dt++;return Dt?ss(Xt[Dt],fl[Dt]):Xt[Dt]===kr?-1:fl[Dt]===kr?1:0}),Lt},Cr.matches=function(Se,Ee){return Cr(Se,null,null,Ee)},Cr.matchesSelector=function(Se,Ee){if((Se.ownerDocument||Se)!==Lt&&bt(Se),Ee=Ee.replace(Zc,"='$1']"),ce.matchesSelector&&yr&&!mi[Ee+" "]&&(!nn||!nn.test(Ee))&&(!Ql||!Ql.test(Ee)))try{var qe=Dl.call(Se,Ee);if(qe||ce.disconnectedMatch||Se.document&&Se.document.nodeType!==11)return qe}catch(st){}return 0<Cr(Ee,Lt,null,[Se]).length},Cr.contains=function(Se,Ee){return(Se.ownerDocument||Se)!==Lt&&bt(Se),Ai(Se,Ee)},Cr.attr=function(Se,Ee){(Se.ownerDocument||Se)!==Lt&&bt(Se);var qe=ge.attrHandle[Ee.toLowerCase()],qe=qe&&vn.call(ge.attrHandle,Ee.toLowerCase())?qe(Se,Ee,!yr):void 0;return qe!==void 0?qe:ce.attributes||!yr?Se.getAttribute(Ee):(qe=Se.getAttributeNode(Ee))&&qe.specified?qe.value:null},Cr.error=function(Se){throw new Error("Syntax error, unrecognized expression: "+Se)},Cr.uniqueSort=function(Se){var Ee,qe=[],st=0,Dt=0;if(ut=!ce.detectDuplicates,dt=!ce.sortStable&&Se.slice(0),Se.sort(Wr),ut){for(;Ee=Se[Dt++];)Ee===Se[Dt]&&(st=qe.push(Dt));for(;st--;)Se.splice(qe[st],1)}return dt=null,Se},Ae=Cr.getText=function(Se){var Ee,qe="",st=0,Dt=Se.nodeType;if(Dt){if(Dt===1||Dt===9||Dt===11){if(typeof Se.textContent=="string")return Se.textContent;for(Se=Se.firstChild;Se;Se=Se.nextSibling)qe+=Ae(Se)}else if(Dt===3||Dt===4)return Se.nodeValue}else for(;Ee=Se[st++];)qe+=Ae(Ee);return qe},(ge=Cr.selectors={cacheLength:50,createPseudo:gi,match:Fa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(Se){return Se[1]=Se[1].replace(zi,G),Se[3]=(Se[3]||Se[4]||Se[5]||"").replace(zi,G),Se[2]==="~="&&(Se[3]=" "+Se[3]+" "),Se.slice(0,4)},CHILD:function(Se){return Se[1]=Se[1].toLowerCase(),Se[1].slice(0,3)==="nth"?(Se[3]||Cr.error(Se[0]),Se[4]=+(Se[4]?Se[5]+(Se[6]||1):2*(Se[3]==="even"||Se[3]==="odd")),Se[5]=+(Se[7]+Se[8]||Se[3]==="odd")):Se[3]&&Cr.error(Se[0]),Se},PSEUDO:function(Se){var Ee,qe=!Se[6]&&Se[2];return Fa.CHILD.test(Se[0])?null:(Se[3]?Se[2]=Se[4]||Se[5]||"":qe&&qh.test(qe)&&(Ee=at(qe,!0))&&(Ee=qe.indexOf(")",qe.length-Ee)-qe.length)&&(Se[0]=Se[0].slice(0,Ee),Se[2]=qe.slice(0,Ee)),Se.slice(0,3))}},filter:{TAG:function(Se){var Ee=Se.replace(zi,G).toLowerCase();return Se==="*"?function(){return!0}:function(qe){return qe.nodeName&&qe.nodeName.toLowerCase()===Ee}},CLASS:function(Se){var Ee=ho[Se+" "];return Ee||(Ee=new RegExp("(^|"+_l+")"+Se+"("+_l+"|$)"))&&ho(Se,function(qe){return Ee.test(typeof qe.className=="string"&&qe.className||qe.getAttribute!==void 0&&qe.getAttribute("class")||"")})},ATTR:function(Se,Ee,qe){return function(st){return st=Cr.attr(st,Se),st==null?Ee==="!=":!Ee||(st+="",Ee==="="?st===qe:Ee==="!="?st!==qe:Ee==="^="?qe&&st.indexOf(qe)===0:Ee==="*="?qe&&-1<st.indexOf(qe):Ee==="$="?qe&&st.slice(-qe.length)===qe:Ee==="~="?-1<(" "+st.replace(Ws," ")+" ").indexOf(qe):Ee==="|="&&(st===qe||st.slice(0,qe.length+1)===qe+"-"))}},CHILD:function(Se,Ee,qe,st,Dt){var il=Se.slice(0,3)!=="nth",At=Se.slice(-4)!=="last",Xt=Ee==="of-type";return st===1&&Dt===0?function(fl){return!!fl.parentNode}:function(fl,vl,ol){var Bl,dr,gr,cl,Jr,cn,Qr=il!=At?"nextSibling":"previousSibling",nr=fl.parentNode,yn=Xt&&fl.nodeName.toLowerCase(),on=!ol&&!Xt,En=!1;if(nr){if(il){for(;Qr;){for(cl=fl;cl=cl[Qr];)if(Xt?cl.nodeName.toLowerCase()===yn:cl.nodeType===1)return!1;cn=Qr=Se==="only"&&!cn&&"nextSibling"}return!0}if(cn=[At?nr.firstChild:nr.lastChild],At&&on){for(En=(Jr=(Bl=(dr=(gr=(cl=nr)[sl]||(cl[sl]={}))[cl.uniqueID]||(gr[cl.uniqueID]={}))[Se]||[])[0]===Kr&&Bl[1])&&Bl[2],cl=Jr&&nr.childNodes[Jr];cl=++Jr&&cl&&cl[Qr]||(En=Jr=0)||cn.pop();)if(cl.nodeType===1&&++En&&cl===fl){dr[Se]=[Kr,Jr,En];break}}else if(on&&(En=Jr=(Bl=(dr=(gr=(cl=fl)[sl]||(cl[sl]={}))[cl.uniqueID]||(gr[cl.uniqueID]={}))[Se]||[])[0]===Kr&&Bl[1]),En===!1)for(;(cl=++Jr&&cl&&cl[Qr]||(En=Jr=0)||cn.pop())&&((Xt?cl.nodeName.toLowerCase()!==yn:cl.nodeType!==1)||!++En||(on&&((dr=(gr=cl[sl]||(cl[sl]={}))[cl.uniqueID]||(gr[cl.uniqueID]={}))[Se]=[Kr,En]),cl!==fl)););return(En-=Dt)===st||En%st==0&&0<=En/st}}},PSEUDO:function(Se,Ee){var qe,st=ge.pseudos[Se]||ge.setFilters[Se.toLowerCase()]||Cr.error("unsupported pseudo: "+Se);return st[sl]?st(Ee):1<st.length?(qe=[Se,Se,"",Ee],ge.setFilters.hasOwnProperty(Se.toLowerCase())?gi(function(Dt,il){for(var At,Xt=st(Dt,Ee),fl=Xt.length;fl--;)Dt[At=Or(Dt,Xt[fl])]=!(il[At]=Xt[fl])}):function(Dt){return st(Dt,0,qe)}):st}},pseudos:{not:gi(function(Se){var Ee=[],qe=[],st=ze(Se.replace(go,"$1"));return st[sl]?gi(function(Dt,il,At,Xt){for(var fl,vl=st(Dt,null,Xt,[]),ol=Dt.length;ol--;)(fl=vl[ol])&&(Dt[ol]=!(il[ol]=fl))}):function(Dt,il,At){return Ee[0]=Dt,st(Ee,null,At,qe),Ee[0]=null,!qe.pop()}}),has:gi(function(Se){return function(Ee){return 0<Cr(Se,Ee).length}}),contains:gi(function(Se){return Se=Se.replace(zi,G),function(Ee){return-1<(Ee.textContent||Ee.innerText||Ae(Ee)).indexOf(Se)}}),lang:gi(function(Se){return sf.test(Se||"")||Cr.error("unsupported lang: "+Se),Se=Se.replace(zi,G).toLowerCase(),function(Ee){var qe;do if(qe=yr?Ee.lang:Ee.getAttribute("xml:lang")||Ee.getAttribute("lang"))return(qe=qe.toLowerCase())===Se||qe.indexOf(Se+"-")===0;while((Ee=Ee.parentNode)&&Ee.nodeType===1);return!1}}),target:function(Se){var Ee=H.location&&H.location.hash;return Ee&&Ee.slice(1)===Se.id},root:function(Se){return Se===Il},focus:function(Se){return Se===Lt.activeElement&&(!Lt.hasFocus||Lt.hasFocus())&&!!(Se.type||Se.href||~Se.tabIndex)},enabled:function(Se){return Se.disabled===!1},disabled:function(Se){return Se.disabled===!0},checked:function(Se){var Ee=Se.nodeName.toLowerCase();return Ee==="input"&&!!Se.checked||Ee==="option"&&!!Se.selected},selected:function(Se){return Se.parentNode&&Se.parentNode.selectedIndex,Se.selected===!0},empty:function(Se){for(Se=Se.firstChild;Se;Se=Se.nextSibling)if(Se.nodeType<6)return!1;return!0},parent:function(Se){return!ge.pseudos.empty(Se)},header:function(Se){return cf.test(Se.nodeName)},input:function(Se){return os.test(Se.nodeName)},button:function(Se){var Ee=Se.nodeName.toLowerCase();return Ee==="input"&&Se.type==="button"||Ee==="button"},text:function(Se){return Se.nodeName.toLowerCase()==="input"&&Se.type==="text"&&((Se=Se.getAttribute("type"))==null||Se.toLowerCase()==="text")},first:Eo(function(){return[0]}),last:Eo(function(Se,Ee){return[Ee-1]}),eq:Eo(function(Se,Ee,qe){return[qe<0?qe+Ee:qe]}),even:Eo(function(Se,Ee){for(var qe=0;qe<Ee;qe+=2)Se.push(qe);return Se}),odd:Eo(function(Se,Ee){for(var qe=1;qe<Ee;qe+=2)Se.push(qe);return Se}),lt:Eo(function(Se,Ee,qe){for(var st=qe<0?qe+Ee:qe;0<=--st;)Se.push(st);return Se}),gt:Eo(function(Se,Ee,qe){for(var st=qe<0?qe+Ee:qe;++st<Ee;)Se.push(st);return Se})}}).pseudos.nth=ge.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})ge.pseudos[ne]=function(Se){return function(Ee){return Ee.nodeName.toLowerCase()==="input"&&Ee.type===Se}}(ne);for(ne in{submit:!0,reset:!0})ge.pseudos[ne]=function(Se){return function(Ee){var qe=Ee.nodeName.toLowerCase();return(qe==="input"||qe==="button")&&Ee.type===Se}}(ne);function Jc(){}function Ma(Se){for(var Ee=0,qe=Se.length,st="";Ee<qe;Ee++)st+=Se[Ee].value;return st}function qs(Se,Ee,qe){var st=Ee.dir,Dt=qe&&st==="parentNode",il=Xn++;return Ee.first?function(At,Xt,fl){for(;At=At[st];)if(At.nodeType===1||Dt)return Se(At,Xt,fl)}:function(At,Xt,fl){var vl,ol,Bl=[Kr,il];if(fl){for(;At=At[st];)if((At.nodeType===1||Dt)&&Se(At,Xt,fl))return!0}else for(;At=At[st];)if(At.nodeType===1||Dt){if((ol=(vl=(ol=At[sl]||(At[sl]={}))[At.uniqueID]||(ol[At.uniqueID]={}))[st])&&ol[0]===Kr&&ol[1]===il)return Bl[2]=ol[2];if((vl[st]=Bl)[2]=Se(At,Xt,fl))return!0}}}function cs(Se){return 1<Se.length?function(Ee,qe,st){for(var Dt=Se.length;Dt--;)if(!Se[Dt](Ee,qe,st))return!1;return!0}:Se[0]}function Da(Se,Ee,qe,st,Dt){for(var il,At=[],Xt=0,fl=Se.length,vl=Ee!=null;Xt<fl;Xt++)(il=Se[Xt])&&(qe&&!qe(il,st,Dt)||(At.push(il),vl&&Ee.push(Xt)));return At}function El(Se,Ee,qe,st,Dt,il){return st&&!st[sl]&&(st=El(st)),Dt&&!Dt[sl]&&(Dt=El(Dt,il)),gi(function(At,Xt,fl,vl){var ol,Bl,dr,gr=[],cl=[],Jr=Xt.length,cn=At||function(yn,on,En){for(var us=0,ff=on.length;us<ff;us++)Cr(yn,on[us],En);return En}(Ee||"*",fl.nodeType?[fl]:fl,[]),Qr=!Se||!At&&Ee?cn:Da(cn,gr,Se,fl,vl),nr=qe?Dt||(At?Se:Jr||st)?[]:Xt:Qr;if(qe&&qe(Qr,nr,fl,vl),st)for(ol=Da(nr,cl),st(ol,[],fl,vl),Bl=ol.length;Bl--;)(dr=ol[Bl])&&(nr[cl[Bl]]=!(Qr[cl[Bl]]=dr));if(At){if(Dt||Se){if(Dt){for(ol=[],Bl=nr.length;Bl--;)(dr=nr[Bl])&&ol.push(Qr[Bl]=dr);Dt(null,nr=[],ol,vl)}for(Bl=nr.length;Bl--;)(dr=nr[Bl])&&-1<(ol=Dt?Or(At,dr):gr[Bl])&&(At[ol]=!(Xt[ol]=dr))}}else nr=Da(nr===Xt?nr.splice(Jr,nr.length):nr),Dt?Dt(null,Xt,nr,vl):Er.apply(Xt,nr)})}function Xh(Se,Ee){function qe(il,At,Xt,fl,vl){var ol,Bl,dr,gr=0,cl="0",Jr=il&&[],cn=[],Qr=ie,nr=il||Dt&&ge.find.TAG("*",vl),yn=Kr+=Qr==null?1:Math.random()||.1,on=nr.length;for(vl&&(ie=At===Lt||At||vl);cl!==on&&(ol=nr[cl])!=null;cl++){if(Dt&&ol){for(Bl=0,At||ol.ownerDocument===Lt||(bt(ol),Xt=!yr);dr=Se[Bl++];)if(dr(ol,At||Lt,Xt)){fl.push(ol);break}vl&&(Kr=yn)}st&&((ol=!dr&&ol)&&gr--,il&&Jr.push(ol))}if(gr+=cl,st&&cl!==gr){for(Bl=0;dr=Ee[Bl++];)dr(Jr,cn,At,Xt);if(il){if(0<gr)for(;cl--;)Jr[cl]||cn[cl]||(cn[cl]=_n.call(fl));cn=Da(cn)}Er.apply(fl,cn),vl&&!il&&0<cn.length&&1<gr+Ee.length&&Cr.uniqueSort(fl)}return vl&&(Kr=yn,ie=Qr),Jr}var st=0<Ee.length,Dt=0<Se.length;return st?gi(qe):qe}return Jc.prototype=ge.filters=ge.pseudos,ge.setFilters=new Jc,at=Cr.tokenize=function(Se,Ee){var qe,st,Dt,il,At,Xt,fl,vl=oa[Se+" "];if(vl)return Ee?0:vl.slice(0);for(At=Se,Xt=[],fl=ge.preFilter;At;){for(il in qe&&!(st=af.exec(At))||(st&&(At=At.slice(st[0].length)||At),Xt.push(Dt=[])),qe=!1,(st=Wn.exec(At))&&(qe=st.shift(),Dt.push({value:qe,type:st[0].replace(go," ")}),At=At.slice(qe.length)),ge.filter)!(st=Fa[il].exec(At))||fl[il]&&!(st=fl[il](st))||(qe=st.shift(),Dt.push({value:qe,type:il,matches:st}),At=At.slice(qe.length));if(!qe)break}return Ee?At.length:At?Cr.error(Se):oa(Se,Xt).slice(0)},ze=Cr.compile=function(Se,Ee){var qe,st=[],Dt=[],il=mi[Se+" "];if(!il){for(qe=(Ee=Ee||at(Se)).length;qe--;)((il=function At(Xt){for(var fl,vl,ol,Bl=Xt.length,dr=ge.relative[Xt[0].type],gr=dr||ge.relative[" "],cl=dr?1:0,Jr=qs(function(nr){return nr===fl},gr,!0),cn=qs(function(nr){return-1<Or(fl,nr)},gr,!0),Qr=[function(nr,yn,on){return on=!dr&&(on||yn!==ie)||((fl=yn).nodeType?Jr:cn)(nr,yn,on),fl=null,on}];cl<Bl;cl++)if(vl=ge.relative[Xt[cl].type])Qr=[qs(cs(Qr),vl)];else{if((vl=ge.filter[Xt[cl].type].apply(null,Xt[cl].matches))[sl]){for(ol=++cl;ol<Bl&&!ge.relative[Xt[ol].type];ol++);return El(1<cl&&cs(Qr),1<cl&&Ma(Xt.slice(0,cl-1).concat({value:Xt[cl-2].type===" "?"*":""})).replace(go,"$1"),vl,cl<ol&&At(Xt.slice(cl,ol)),ol<Bl&&At(Xt=Xt.slice(ol)),ol<Bl&&Ma(Xt))}Qr.push(vl)}return cs(Qr)}(Ee[qe]))[sl]?st:Dt).push(il);(il=mi(Se,Xh(Dt,st))).selector=Se}return il},Pe=Cr.select=function(Se,Ee,qe,st){var Dt,il,At,Xt,fl,vl=typeof Se=="function"&&Se,ol=!st&&at(Se=vl.selector||Se);if(qe=qe||[],ol.length===1){if(2<(il=ol[0]=ol[0].slice(0)).length&&(At=il[0]).type==="ID"&&ce.getById&&Ee.nodeType===9&&yr&&ge.relative[il[1].type]){if(!(Ee=(ge.find.ID(At.matches[0].replace(zi,G),Ee)||[])[0]))return qe;vl&&(Ee=Ee.parentNode),Se=Se.slice(il.shift().value.length)}for(Dt=Fa.needsContext.test(Se)?0:il.length;Dt--&&(At=il[Dt],!ge.relative[Xt=At.type]);)if((fl=ge.find[Xt])&&(st=fl(At.matches[0].replace(zi,G),Us.test(il[0].type)&&Ys(Ee.parentNode)||Ee))){if(il.splice(Dt,1),!(Se=st.length&&Ma(il)))return Er.apply(qe,st),qe;break}}return(vl||ze(Se,ol))(st,Ee,!yr,qe,!Ee||Us.test(Se)&&Ys(Ee.parentNode)||Ee),qe},ce.sortStable=sl.split("").sort(Wr).join("")===sl,ce.detectDuplicates=!!ut,bt(),ce.sortDetached=Oi(function(Se){return 1&Se.compareDocumentPosition(Lt.createElement("div"))}),Oi(function(Se){return Se.innerHTML="<a href='#'></a>",Se.firstChild.getAttribute("href")==="#"})||Gs("type|href|height|width",function(Se,Ee,qe){return qe?void 0:Se.getAttribute(Ee,Ee.toLowerCase()==="type"?1:2)}),ce.attributes&&Oi(function(Se){return Se.innerHTML="<input/>",Se.firstChild.setAttribute("value",""),Se.firstChild.getAttribute("value")===""})||Gs("value",function(Se,Ee,qe){return qe||Se.nodeName.toLowerCase()!=="input"?void 0:Se.defaultValue}),Oi(function(Se){return Se.getAttribute("disabled")==null})||Gs(Cn,function(Se,Ee,qe){return qe?void 0:Se[Ee]===!0?Ee.toLowerCase():(Ee=Se.getAttributeNode(Ee))&&Ee.specified?Ee.value:null}),Cr}(e);p.find=O,p.expr=O.selectors,p.expr[":"]=p.expr.pseudos,p.uniqueSort=p.unique=O.uniqueSort,p.text=O.getText,p.isXMLDoc=O.isXML,p.contains=O.contains;function F(H,G,ee){for(var ne=[],ce=ee!==void 0;(H=H[G])&&H.nodeType!==9;)if(H.nodeType===1){if(ce&&p(H).is(ee))break;ne.push(H)}return ne}function D(H,G){for(var ee=[];H;H=H.nextSibling)H.nodeType===1&&H!==G&&ee.push(H);return ee}var k=p.expr.match.needsContext,w=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,C=/^.[^:#\[\.,]*$/;function T(H,G,ee){if(p.isFunction(G))return p.grep(H,function(ne,ce){return!!G.call(ne,ce,ne)!==ee});if(G.nodeType)return p.grep(H,function(ne){return ne===G!==ee});if(typeof G=="string"){if(C.test(G))return p.filter(G,H,ee);G=p.filter(G,H)}return p.grep(H,function(ne){return-1<f.call(G,ne)!==ee})}p.filter=function(H,G,ee){var ne=G[0];return ee&&(H=":not("+H+")"),G.length===1&&ne.nodeType===1?p.find.matchesSelector(ne,H)?[ne]:[]:p.find.matches(H,p.grep(G,function(ce){return ce.nodeType===1}))},p.fn.extend({find:function(H){var G,ee=this.length,ne=[],ce=this;if(typeof H!="string")return this.pushStack(p(H).filter(function(){for(G=0;G<ee;G++)if(p.contains(ce[G],this))return!0}));for(G=0;G<ee;G++)p.find(H,ce[G],ne);return(ne=this.pushStack(1<ee?p.unique(ne):ne)).selector=this.selector?this.selector+" "+H:H,ne},filter:function(H){return this.pushStack(T(this,H||[],!1))},not:function(H){return this.pushStack(T(this,H||[],!0))},is:function(H){return!!T(this,typeof H=="string"&&k.test(H)?p(H):H||[],!1).length}});var z,A=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(p.fn.init=function(H,G,ee){if(!H)return this;if(ee=ee||z,typeof H!="string")return H.nodeType?(this.context=this[0]=H,this.length=1,this):p.isFunction(H)?ee.ready!==void 0?ee.ready(H):H(p):(H.selector!==void 0&&(this.selector=H.selector,this.context=H.context),p.makeArray(H,this));if(!(ne=H[0]==="<"&&H[H.length-1]===">"&&3<=H.length?[null,H,null]:A.exec(H))||!ne[1]&&G)return(!G||G.jquery?G||ee:this.constructor(G)).find(H);if(ne[1]){if(G=G instanceof p?G[0]:G,p.merge(this,p.parseHTML(ne[1],G&&G.nodeType?G.ownerDocument||G:o,!0)),w.test(ne[1])&&p.isPlainObject(G))for(var ne in G)p.isFunction(this[ne])?this[ne](G[ne]):this.attr(ne,G[ne]);return this}return(ee=o.getElementById(ne[2]))&&ee.parentNode&&(this.length=1,this[0]=ee),this.context=o,this.selector=H,this}).prototype=p.fn,z=p(o);var M=/^(?:parents|prev(?:Until|All))/,P={children:!0,contents:!0,next:!0,prev:!0};function N(H,G){for(;(H=H[G])&&H.nodeType!==1;);return H}p.fn.extend({has:function(H){var G=p(H,this),ee=G.length;return this.filter(function(){for(var ne=0;ne<ee;ne++)if(p.contains(this,G[ne]))return!0})},closest:function(H,G){for(var ee,ne=0,ce=this.length,ge=[],Ae=k.test(H)||typeof H!="string"?p(H,G||this.context):0;ne<ce;ne++)for(ee=this[ne];ee&&ee!==G;ee=ee.parentNode)if(ee.nodeType<11&&(Ae?-1<Ae.index(ee):ee.nodeType===1&&p.find.matchesSelector(ee,H))){ge.push(ee);break}return this.pushStack(1<ge.length?p.uniqueSort(ge):ge)},index:function(H){return H?typeof H=="string"?f.call(p(H),this[0]):f.call(this,H.jquery?H[0]:H):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(H,G){return this.pushStack(p.uniqueSort(p.merge(this.get(),p(H,G))))},addBack:function(H){return this.add(H==null?this.prevObject:this.prevObject.filter(H))}}),p.each({parent:function(H){return H=H.parentNode,H&&H.nodeType!==11?H:null},parents:function(H){return F(H,"parentNode")},parentsUntil:function(H,G,ee){return F(H,"parentNode",ee)},next:function(H){return N(H,"nextSibling")},prev:function(H){return N(H,"previousSibling")},nextAll:function(H){return F(H,"nextSibling")},prevAll:function(H){return F(H,"previousSibling")},nextUntil:function(H,G,ee){return F(H,"nextSibling",ee)},prevUntil:function(H,G,ee){return F(H,"previousSibling",ee)},siblings:function(H){return D((H.parentNode||{}).firstChild,H)},children:function(H){return D(H.firstChild)},contents:function(H){return H.contentDocument||p.merge([],H.childNodes)}},function(H,G){p.fn[H]=function(ee,ne){var ce=p.map(this,G,ee);return H.slice(-5)!=="Until"&&(ne=ee),ne&&typeof ne=="string"&&(ce=p.filter(ne,ce)),1<this.length&&(P[H]||p.uniqueSort(ce),M.test(H)&&ce.reverse()),this.pushStack(ce)}});var E,B=/\S+/g;function U(){o.removeEventListener("DOMContentLoaded",U),e.removeEventListener("load",U),p.ready()}p.Callbacks=function(H){var G,ee;H=typeof H=="string"?(G=H,ee={},p.each(G.match(B)||[],function(dt,ut){ee[ut]=!0}),ee):p.extend({},H);function ne(){for(Je=H.once,Ae=ce=!0;ze.length;Pe=-1)for(ge=ze.shift();++Pe<at.length;)at[Pe].apply(ge[0],ge[1])===!1&&H.stopOnFalse&&(Pe=at.length,ge=!1);H.memory||(ge=!1),ce=!1,Je&&(at=ge?[]:"")}var ce,ge,Ae,Je,at=[],ze=[],Pe=-1,ie={add:function(){return at&&(ge&&!ce&&(Pe=at.length-1,ze.push(ge)),function dt(ut){p.each(ut,function(bt,Lt){p.isFunction(Lt)?H.unique&&ie.has(Lt)||at.push(Lt):Lt&&Lt.length&&p.type(Lt)!=="string"&&dt(Lt)})}(arguments),ge&&!ce&&ne()),this},remove:function(){return p.each(arguments,function(dt,ut){for(var bt;-1<(bt=p.inArray(ut,at,bt));)at.splice(bt,1),bt<=Pe&&Pe--}),this},has:function(dt){return dt?-1<p.inArray(dt,at):0<at.length},empty:function(){return at=at&&[],this},disable:function(){return Je=ze=[],at=ge="",this},disabled:function(){return!at},lock:function(){return Je=ze=[],ge||(at=ge=""),this},locked:function(){return!!Je},fireWith:function(dt,ut){return Je||(ut=[dt,(ut=ut||[]).slice?ut.slice():ut],ze.push(ut),ce||ne()),this},fire:function(){return ie.fireWith(this,arguments),this},fired:function(){return!!Ae}};return ie},p.extend({Deferred:function(H){var G=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],ee="pending",ne={state:function(){return ee},always:function(){return ce.done(arguments).fail(arguments),this},then:function(){var ge=arguments;return p.Deferred(function(Ae){p.each(G,function(Je,at){var ze=p.isFunction(ge[Je])&&ge[Je];ce[at[1]](function(){var Pe=ze&&ze.apply(this,arguments);Pe&&p.isFunction(Pe.promise)?Pe.promise().progress(Ae.notify).done(Ae.resolve).fail(Ae.reject):Ae[at[0]+"With"](this===ne?Ae.promise():this,ze?[Pe]:arguments)})}),ge=null}).promise()},promise:function(ge){return ge!=null?p.extend(ge,ne):ne}},ce={};return ne.pipe=ne.then,p.each(G,function(ge,Ae){var Je=Ae[2],at=Ae[3];ne[Ae[1]]=Je.add,at&&Je.add(function(){ee=at},G[1^ge][2].disable,G[2][2].lock),ce[Ae[0]]=function(){return ce[Ae[0]+"With"](this===ce?ne:this,arguments),this},ce[Ae[0]+"With"]=Je.fireWith}),ne.promise(ce),H&&H.call(ce,ce),ce},when:function(H){function G(Pe,ie,dt){return function(ut){ie[Pe]=this,dt[Pe]=1<arguments.length?a.call(arguments):ut,dt===ee?ze.notifyWith(ie,dt):--at||ze.resolveWith(ie,dt)}}var ee,ne,ce,ge=0,Ae=a.call(arguments),Je=Ae.length,at=Je!==1||H&&p.isFunction(H.promise)?Je:0,ze=at===1?H:p.Deferred();if(1<Je)for(ee=new Array(Je),ne=new Array(Je),ce=new Array(Je);ge<Je;ge++)Ae[ge]&&p.isFunction(Ae[ge].promise)?Ae[ge].promise().progress(G(ge,ne,ee)).done(G(ge,ce,Ae)).fail(ze.reject):--at;return at||ze.resolveWith(ce,Ae),ze.promise()}}),p.fn.ready=function(H){return p.ready.promise().done(H),this},p.extend({isReady:!1,readyWait:1,holdReady:function(H){H?p.readyWait++:p.ready(!0)},ready:function(H){(H===!0?--p.readyWait:p.isReady)||(p.isReady=!0)!==H&&0<--p.readyWait||(E.resolveWith(o,[p]),p.fn.triggerHandler&&(p(o).triggerHandler("ready"),p(o).off("ready")))}}),p.ready.promise=function(H){return E||(E=p.Deferred(),o.readyState==="complete"||o.readyState!=="loading"&&!o.documentElement.doScroll?e.setTimeout(p.ready):(o.addEventListener("DOMContentLoaded",U),e.addEventListener("load",U))),E.promise(H)},p.ready.promise();function X(H){return H.nodeType===1||H.nodeType===9||!+H.nodeType}var le=function(H,G,ee,ne,ce,ge,Ae){var Je=0,at=H.length,ze=ee==null;if(p.type(ee)==="object")for(Je in ce=!0,ee)le(H,G,Je,ee[Je],!0,ge,Ae);else if(ne!==void 0&&(ce=!0,p.isFunction(ne)||(Ae=!0),ze&&(G=Ae?(G.call(H,ne),null):(ze=G,function(Pe,ie,dt){return ze.call(p(Pe),dt)})),G))for(;Je<at;Je++)G(H[Je],ee,Ae?ne:ne.call(H[Je],Je,G(H[Je],ee)));return ce?H:ze?G.call(H):at?G(H[0],ee):ge};function he(){this.expando=p.expando+he.uid++}he.uid=1,he.prototype={register:function(H,G){return G=G||{},H.nodeType?H[this.expando]=G:Object.defineProperty(H,this.expando,{value:G,writable:!0,configurable:!0}),H[this.expando]},cache:function(H){if(!X(H))return{};var G=H[this.expando];return G||(G={},X(H)&&(H.nodeType?H[this.expando]=G:Object.defineProperty(H,this.expando,{value:G,configurable:!0}))),G},set:function(H,G,ee){var ne,ce=this.cache(H);if(typeof G=="string")ce[G]=ee;else for(ne in G)ce[ne]=G[ne];return ce},get:function(H,G){return G===void 0?this.cache(H):H[this.expando]&&H[this.expando][G]},access:function(H,G,ee){var ne;return G===void 0||G&&typeof G=="string"&&ee===void 0?(ne=this.get(H,G))!==void 0?ne:this.get(H,p.camelCase(G)):(this.set(H,G,ee),ee!==void 0?ee:G)},remove:function(H,G){var ee,ne,ce,ge=H[this.expando];if(ge!==void 0){if(G===void 0)this.register(H);else for(ee=(ne=p.isArray(G)?G.concat(G.map(p.camelCase)):(ce=p.camelCase(G),G in ge?[G,ce]:(ne=ce)in ge?[ne]:ne.match(B)||[])).length;ee--;)delete ge[ne[ee]];G!==void 0&&!p.isEmptyObject(ge)||(H.nodeType?H[this.expando]=void 0:delete H[this.expando])}},hasData:function(H){return H=H[this.expando],H!==void 0&&!p.isEmptyObject(H)}};var Z=new he,ae=new he,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,pe=/[A-Z]/g;function K(H,G,ee){var ne;if(ee===void 0&&H.nodeType===1)if(ne="data-"+G.replace(pe,"-$&").toLowerCase(),typeof(ee=H.getAttribute(ne))=="string"){try{ee=ee==="true"||ee!=="false"&&(ee==="null"?null:+ee+""===ee?+ee:J.test(ee)?p.parseJSON(ee):ee)}catch(ce){}ae.set(H,G,ee)}else ee=void 0;return ee}p.extend({hasData:function(H){return ae.hasData(H)||Z.hasData(H)},data:function(H,G,ee){return ae.access(H,G,ee)},removeData:function(H,G){ae.remove(H,G)},_data:function(H,G,ee){return Z.access(H,G,ee)},_removeData:function(H,G){Z.remove(H,G)}}),p.fn.extend({data:function(H,G){var ee,ne,ce,ge=this[0],Ae=ge&&ge.attributes;if(H!==void 0)return typeof H=="object"?this.each(function(){ae.set(this,H)}):le(this,function(Je){var at,ze;return ge&&Je===void 0?(at=ae.get(ge,H)||ae.get(ge,H.replace(pe,"-$&").toLowerCase()))!==void 0?at:(ze=p.camelCase(H),(at=ae.get(ge,ze))!==void 0||(at=K(ge,ze,void 0))!==void 0?at:void 0):(ze=p.camelCase(H),void this.each(function(){var Pe=ae.get(this,ze);ae.set(this,ze,Je),-1<H.indexOf("-")&&Pe!==void 0&&ae.set(this,H,Je)}))},null,G,1<arguments.length,null,!0);if(this.length&&(ce=ae.get(ge),ge.nodeType===1&&!Z.get(ge,"hasDataAttrs"))){for(ee=Ae.length;ee--;)Ae[ee]&&(ne=Ae[ee].name).indexOf("data-")===0&&(ne=p.camelCase(ne.slice(5)),K(ge,ne,ce[ne]));Z.set(ge,"hasDataAttrs",!0)}return ce},removeData:function(H){return this.each(function(){ae.remove(this,H)})}}),p.extend({queue:function(H,G,ee){var ne;return H?(G=(G||"fx")+"queue",ne=Z.get(H,G),ee&&(!ne||p.isArray(ee)?ne=Z.access(H,G,p.makeArray(ee)):ne.push(ee)),ne||[]):void 0},dequeue:function(H,G){G=G||"fx";var ee=p.queue(H,G),ne=ee.length,ce=ee.shift(),ge=p._queueHooks(H,G);ce==="inprogress"&&(ce=ee.shift(),ne--),ce&&(G==="fx"&&ee.unshift("inprogress"),delete ge.stop,ce.call(H,function(){p.dequeue(H,G)},ge)),!ne&&ge&&ge.empty.fire()},_queueHooks:function(H,G){var ee=G+"queueHooks";return Z.get(H,ee)||Z.access(H,ee,{empty:p.Callbacks("once memory").add(function(){Z.remove(H,[G+"queue",ee])})})}}),p.fn.extend({queue:function(H,G){var ee=2;return typeof H!="string"&&(G=H,H="fx",ee--),arguments.length<ee?p.queue(this[0],H):G===void 0?this:this.each(function(){var ne=p.queue(this,H,G);p._queueHooks(this,H),H==="fx"&&ne[0]!=="inprogress"&&p.dequeue(this,H)})},dequeue:function(H){return this.each(function(){p.dequeue(this,H)})},clearQueue:function(H){return this.queue(H||"fx",[])},promise:function(H,G){function ee(){--ce||ge.resolveWith(Ae,[Ae])}var ne,ce=1,ge=p.Deferred(),Ae=this,Je=this.length;for(typeof H!="string"&&(G=H,H=void 0),H=H||"fx";Je--;)(ne=Z.get(Ae[Je],H+"queueHooks"))&&ne.empty&&(ce++,ne.empty.add(ee));return ee(),ge.promise(G)}});function se(H,G){return H=G||H,p.css(H,"display")==="none"||!p.contains(H.ownerDocument,H)}var y=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+y+")([a-z%]*)$","i"),re=["Top","Right","Bottom","Left"];function fe(H,G,ee,ne){var ce,ge=1,Ae=20,Je=ne?function(){return ne.cur()}:function(){return p.css(H,G,"")},at=Je(),ze=ee&&ee[3]||(p.cssNumber[G]?"":"px"),Pe=(p.cssNumber[G]||ze!=="px"&&+at)&&te.exec(p.css(H,G));if(Pe&&Pe[3]!==ze)for(ze=ze||Pe[3],ee=ee||[],Pe=+at||1;ge=ge||".5",Pe/=ge,p.style(H,G,Pe+ze),ge!==(ge=Je()/at)&&ge!==1&&--Ae;);return ee&&(Pe=+Pe||+at||0,ce=ee[1]?Pe+(ee[1]+1)*ee[2]:+ee[2],ne&&(ne.unit=ze,ne.start=Pe,ne.end=ce)),ce}var Me=/^(?:checkbox|radio)$/i,ye=/<([\w:-]+)/,Ye=/^$|\/(?:java|ecma)script/i,Ce={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Ke(H,G){var ee=H.getElementsByTagName!==void 0?H.getElementsByTagName(G||"*"):H.querySelectorAll!==void 0?H.querySelectorAll(G||"*"):[];return G===void 0||G&&p.nodeName(H,G)?p.merge([H],ee):ee}function ft(H,G){for(var ee=0,ne=H.length;ee<ne;ee++)Z.set(H[ee],"globalEval",!G||Z.get(G[ee],"globalEval"))}Ce.optgroup=Ce.option,Ce.tbody=Ce.tfoot=Ce.colgroup=Ce.caption=Ce.thead,Ce.th=Ce.td;var et=/<|&#?\w+;/;function vt(H,G,ee,ne,ce){for(var ge,Ae,Je,at,ze,Pe=G.createDocumentFragment(),ie=[],dt=0,ut=H.length;dt<ut;dt++)if((ge=H[dt])||ge===0)if(p.type(ge)==="object")p.merge(ie,ge.nodeType?[ge]:ge);else if(et.test(ge)){for(Ae=Ae||Pe.appendChild(G.createElement("div")),Je=(ye.exec(ge)||["",""])[1].toLowerCase(),Je=Ce[Je]||Ce._default,Ae.innerHTML=Je[1]+p.htmlPrefilter(ge)+Je[2],ze=Je[0];ze--;)Ae=Ae.lastChild;p.merge(ie,Ae.childNodes),(Ae=Pe.firstChild).textContent=""}else ie.push(G.createTextNode(ge));for(Pe.textContent="",dt=0;ge=ie[dt++];)if(ne&&-1<p.inArray(ge,ne))ce&&ce.push(ge);else if(at=p.contains(ge.ownerDocument,ge),Ae=Ke(Pe.appendChild(ge),"script"),at&&ft(Ae),ee)for(ze=0;ge=Ae[ze++];)Ye.test(ge.type||"")&&ee.push(ge);return Pe}l=o.createDocumentFragment().appendChild(o.createElement("div")),(O=o.createElement("input")).setAttribute("type","radio"),O.setAttribute("checked","checked"),O.setAttribute("name","t"),l.appendChild(O),b.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,l.innerHTML="<textarea>x</textarea>",b.noCloneChecked=!!l.cloneNode(!0).lastChild.defaultValue;var wt=/^key/,be=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Q=/^([^.]*)(?:\.(.+)|)/;function me(){return!0}function xe(){return!1}function Te(){try{return o.activeElement}catch(H){}}function je(H,G,ee,ne,ce,ge){var Ae,Je;if(typeof G=="object"){for(Je in typeof ee!="string"&&(ne=ne||ee,ee=void 0),G)je(H,Je,ee,ne,G[Je],ge);return H}if(ne==null&&ce==null?(ce=ee,ne=ee=void 0):ce==null&&(typeof ee=="string"?(ce=ne,ne=void 0):(ce=ne,ne=ee,ee=void 0)),ce===!1)ce=xe;else if(!ce)return H;return ge===1&&(Ae=ce,(ce=function(at){return p().off(at),Ae.apply(this,arguments)}).guid=Ae.guid||(Ae.guid=p.guid++)),H.each(function(){p.event.add(this,G,ce,ne,ee)})}p.event={global:{},add:function(H,G,ee,ne,ce){var ge,Ae,Je,at,ze,Pe,ie,dt,ut,bt=Z.get(H);if(bt)for(ee.handler&&(ee=(ge=ee).handler,ce=ge.selector),ee.guid||(ee.guid=p.guid++),(Je=bt.events)||(Je=bt.events={}),(Ae=bt.handle)||(Ae=bt.handle=function(Lt){return p!==void 0&&p.event.triggered!==Lt.type?p.event.dispatch.apply(H,arguments):void 0}),at=(G=(G||"").match(B)||[""]).length;at--;)ie=ut=(ze=Q.exec(G[at])||[])[1],dt=(ze[2]||"").split(".").sort(),ie&&(Pe=p.event.special[ie]||{},ie=(ce?Pe.delegateType:Pe.bindType)||ie,Pe=p.event.special[ie]||{},ze=p.extend({type:ie,origType:ut,data:ne,handler:ee,guid:ee.guid,selector:ce,needsContext:ce&&p.expr.match.needsContext.test(ce),namespace:dt.join(".")},ge),(ut=Je[ie])||((ut=Je[ie]=[]).delegateCount=0,Pe.setup&&Pe.setup.call(H,ne,dt,Ae)!==!1||H.addEventListener&&H.addEventListener(ie,Ae)),Pe.add&&(Pe.add.call(H,ze),ze.handler.guid||(ze.handler.guid=ee.guid)),ce?ut.splice(ut.delegateCount++,0,ze):ut.push(ze),p.event.global[ie]=!0)},remove:function(H,G,ee,ne,ce){var ge,Ae,Je,at,ze,Pe,ie,dt,ut,bt,Lt,Il=Z.hasData(H)&&Z.get(H);if(Il&&(at=Il.events)){for(ze=(G=(G||"").match(B)||[""]).length;ze--;)if(ut=Lt=(Je=Q.exec(G[ze])||[])[1],bt=(Je[2]||"").split(".").sort(),ut){for(ie=p.event.special[ut]||{},dt=at[ut=(ne?ie.delegateType:ie.bindType)||ut]||[],Je=Je[2]&&new RegExp("(^|\\.)"+bt.join("\\.(?:.*\\.|)")+"(\\.|$)"),Ae=ge=dt.length;ge--;)Pe=dt[ge],!ce&&Lt!==Pe.origType||ee&&ee.guid!==Pe.guid||Je&&!Je.test(Pe.namespace)||ne&&ne!==Pe.selector&&(ne!=="**"||!Pe.selector)||(dt.splice(ge,1),Pe.selector&&dt.delegateCount--,ie.remove&&ie.remove.call(H,Pe));Ae&&!dt.length&&(ie.teardown&&ie.teardown.call(H,bt,Il.handle)!==!1||p.removeEvent(H,ut,Il.handle),delete at[ut])}else for(ut in at)p.event.remove(H,ut+G[ze],ee,ne,!0);p.isEmptyObject(at)&&Z.remove(H,"handle events")}},dispatch:function(H){H=p.event.fix(H);var G,ee,ne,ce,ge,Ae=a.call(arguments),Je=(Z.get(this,"events")||{})[H.type]||[],at=p.event.special[H.type]||{};if((Ae[0]=H).delegateTarget=this,!at.preDispatch||at.preDispatch.call(this,H)!==!1){for(ge=p.event.handlers.call(this,H,Je),G=0;(ne=ge[G++])&&!H.isPropagationStopped();)for(H.currentTarget=ne.elem,ee=0;(ce=ne.handlers[ee++])&&!H.isImmediatePropagationStopped();)H.rnamespace&&!H.rnamespace.test(ce.namespace)||(H.handleObj=ce,H.data=ce.data,(ce=((p.event.special[ce.origType]||{}).handle||ce.handler).apply(ne.elem,Ae))!==void 0&&(H.result=ce)===!1&&(H.preventDefault(),H.stopPropagation()));return at.postDispatch&&at.postDispatch.call(this,H),H.result}},handlers:function(H,G){var ee,ne,ce,ge,Ae=[],Je=G.delegateCount,at=H.target;if(Je&&at.nodeType&&(H.type!=="click"||isNaN(H.button)||H.button<1)){for(;at!==this;at=at.parentNode||this)if(at.nodeType===1&&(at.disabled!==!0||H.type!=="click")){for(ne=[],ee=0;ee<Je;ee++)ne[ce=(ge=G[ee]).selector+" "]===void 0&&(ne[ce]=ge.needsContext?-1<p(ce,this).index(at):p.find(ce,this,null,[at]).length),ne[ce]&&ne.push(ge);ne.length&&Ae.push({elem:at,handlers:ne})}}return Je<G.length&&Ae.push({elem:this,handlers:G.slice(Je)}),Ae},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(H,G){return H.which==null&&(H.which=G.charCode!=null?G.charCode:G.keyCode),H}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(H,G){var ee,ne,ce=G.button;return H.pageX==null&&G.clientX!=null&&(ee=(ne=H.target.ownerDocument||o).documentElement,ne=ne.body,H.pageX=G.clientX+(ee&&ee.scrollLeft||ne&&ne.scrollLeft||0)-(ee&&ee.clientLeft||ne&&ne.clientLeft||0),H.pageY=G.clientY+(ee&&ee.scrollTop||ne&&ne.scrollTop||0)-(ee&&ee.clientTop||ne&&ne.clientTop||0)),H.which||ce===void 0||(H.which=1&ce?1:2&ce?3:4&ce?2:0),H}},fix:function(H){if(H[p.expando])return H;var G,ee,ne,ce=H.type,ge=H,Ae=this.fixHooks[ce];for(Ae||(this.fixHooks[ce]=Ae=be.test(ce)?this.mouseHooks:wt.test(ce)?this.keyHooks:{}),ne=Ae.props?this.props.concat(Ae.props):this.props,H=new p.Event(ge),G=ne.length;G--;)H[ee=ne[G]]=ge[ee];return H.target||(H.target=o),H.target.nodeType===3&&(H.target=H.target.parentNode),Ae.filter?Ae.filter(H,ge):H},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==Te()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===Te()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return this.type==="checkbox"&&this.click&&p.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(H){return p.nodeName(H.target,"a")}},beforeunload:{postDispatch:function(H){H.result!==void 0&&H.originalEvent&&(H.originalEvent.returnValue=H.result)}}}},p.removeEvent=function(H,G,ee){H.removeEventListener&&H.removeEventListener(G,ee)},p.Event=function(H,G){return this instanceof p.Event?(H&&H.type?(this.originalEvent=H,this.type=H.type,this.isDefaultPrevented=H.defaultPrevented||H.defaultPrevented===void 0&&H.returnValue===!1?me:xe):this.type=H,G&&p.extend(this,G),this.timeStamp=H&&H.timeStamp||p.now(),void(this[p.expando]=!0)):new p.Event(H,G)},p.Event.prototype={constructor:p.Event,isDefaultPrevented:xe,isPropagationStopped:xe,isImmediatePropagationStopped:xe,isSimulated:!1,preventDefault:function(){var H=this.originalEvent;this.isDefaultPrevented=me,H&&!this.isSimulated&&H.preventDefault()},stopPropagation:function(){var H=this.originalEvent;this.isPropagationStopped=me,H&&!this.isSimulated&&H.stopPropagation()},stopImmediatePropagation:function(){var H=this.originalEvent;this.isImmediatePropagationStopped=me,H&&!this.isSimulated&&H.stopImmediatePropagation(),this.stopPropagation()}},p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(H,G){p.event.special[H]={delegateType:G,bindType:G,handle:function(ee){var ne,ce=ee.relatedTarget,ge=ee.handleObj;return ce&&(ce===this||p.contains(this,ce))||(ee.type=ge.origType,ne=ge.handler.apply(this,arguments),ee.type=G),ne}}}),p.fn.extend({on:function(H,G,ee,ne){return je(this,H,G,ee,ne)},one:function(H,G,ee,ne){return je(this,H,G,ee,ne,1)},off:function(H,G,ee){var ne,ce;if(H&&H.preventDefault&&H.handleObj)return ne=H.handleObj,p(H.delegateTarget).off(ne.namespace?ne.origType+"."+ne.namespace:ne.origType,ne.selector,ne.handler),this;if(typeof H!="object")return G!==!1&&typeof G!="function"||(ee=G,G=void 0),ee===!1&&(ee=xe),this.each(function(){p.event.remove(this,H,ee,G)});for(ce in H)this.off(ce,G,H[ce]);return this}});var De=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Fe=/<script|<style|<link/i,Ze=/checked\s*(?:[^=]|=\s*.checked.)/i,Ve=/^true\/(.*)/,Ie=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function ve(H,G){return p.nodeName(H,"table")&&p.nodeName(G.nodeType!==11?G:G.firstChild,"tr")?H.getElementsByTagName("tbody")[0]||H.appendChild(H.ownerDocument.createElement("tbody")):H}function Ge(H){return H.type=(H.getAttribute("type")!==null)+"/"+H.type,H}function Ue(H){var G=Ve.exec(H.type);return G?H.type=G[1]:H.removeAttribute("type"),H}function We(H,G){var ee,ne,ce,ge,Ae,Je;if(G.nodeType===1){if(Z.hasData(H)&&(ge=Z.access(H),Ae=Z.set(G,ge),Je=ge.events))for(ce in delete Ae.handle,Ae.events={},Je)for(ee=0,ne=Je[ce].length;ee<ne;ee++)p.event.add(G,ce,Je[ce][ee]);ae.hasData(H)&&(H=ae.access(H),H=p.extend({},H),ae.set(G,H))}}function it(H,G,ee,ne){G=s.apply([],G);var ce,ge,Ae,Je,at,ze,Pe=0,ie=H.length,dt=ie-1,ut=G[0],bt=p.isFunction(ut);if(bt||1<ie&&typeof ut=="string"&&!b.checkClone&&Ze.test(ut))return H.each(function(Lt){var Il=H.eq(Lt);bt&&(G[0]=ut.call(this,Lt,Il.html())),it(Il,G,ee,ne)});if(ie&&(ge=(ce=vt(G,H[0].ownerDocument,!1,H,ne)).firstChild,ce.childNodes.length===1&&(ce=ge),ge||ne)){for(Je=(Ae=p.map(Ke(ce,"script"),Ge)).length;Pe<ie;Pe++)at=ce,Pe!==dt&&(at=p.clone(at,!0,!0),Je&&p.merge(Ae,Ke(at,"script"))),ee.call(H[Pe],at,Pe);if(Je)for(ze=Ae[Ae.length-1].ownerDocument,p.map(Ae,Ue),Pe=0;Pe<Je;Pe++)at=Ae[Pe],Ye.test(at.type||"")&&!Z.access(at,"globalEval")&&p.contains(ze,at)&&(at.src?p._evalUrl&&p._evalUrl(at.src):p.globalEval(at.textContent.replace(Ie,"")))}return H}function St(H,G,ee){for(var ne,ce=G?p.filter(G,H):H,ge=0;(ne=ce[ge])!=null;ge++)ee||ne.nodeType!==1||p.cleanData(Ke(ne)),ne.parentNode&&(ee&&p.contains(ne.ownerDocument,ne)&&ft(Ke(ne,"script")),ne.parentNode.removeChild(ne));return H}p.extend({htmlPrefilter:function(H){return H.replace(De,"<$1></$2>")},clone:function(H,G,ee){var ne,ce,ge,Ae,Je,at,ze,Pe=H.cloneNode(!0),ie=p.contains(H.ownerDocument,H);if(!(b.noCloneChecked||H.nodeType!==1&&H.nodeType!==11||p.isXMLDoc(H)))for(Ae=Ke(Pe),ne=0,ce=(ge=Ke(H)).length;ne<ce;ne++)Je=ge[ne],at=Ae[ne],ze=void 0,(ze=at.nodeName.toLowerCase())==="input"&&Me.test(Je.type)?at.checked=Je.checked:ze!=="input"&&ze!=="textarea"||(at.defaultValue=Je.defaultValue);if(G)if(ee)for(ge=ge||Ke(H),Ae=Ae||Ke(Pe),ne=0,ce=ge.length;ne<ce;ne++)We(ge[ne],Ae[ne]);else We(H,Pe);return 0<(Ae=Ke(Pe,"script")).length&&ft(Ae,!ie&&Ke(H,"script")),Pe},cleanData:function(H){for(var G,ee,ne,ce=p.event.special,ge=0;(ee=H[ge])!==void 0;ge++)if(X(ee)){if(G=ee[Z.expando]){if(G.events)for(ne in G.events)ce[ne]?p.event.remove(ee,ne):p.removeEvent(ee,ne,G.handle);ee[Z.expando]=void 0}ee[ae.expando]&&(ee[ae.expando]=void 0)}}}),p.fn.extend({domManip:it,detach:function(H){return St(this,H,!0)},remove:function(H){return St(this,H)},text:function(H){return le(this,function(G){return G===void 0?p.text(this):this.empty().each(function(){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(this.textContent=G)})},null,H,arguments.length)},append:function(){return it(this,arguments,function(H){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||ve(this,H).appendChild(H)})},prepend:function(){return it(this,arguments,function(H){var G;this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(G=ve(this,H)).insertBefore(H,G.firstChild)})},before:function(){return it(this,arguments,function(H){this.parentNode&&this.parentNode.insertBefore(H,this)})},after:function(){return it(this,arguments,function(H){this.parentNode&&this.parentNode.insertBefore(H,this.nextSibling)})},empty:function(){for(var H,G=0;(H=this[G])!=null;G++)H.nodeType===1&&(p.cleanData(Ke(H,!1)),H.textContent="");return this},clone:function(H,G){return H=H!=null&&H,G=G??H,this.map(function(){return p.clone(this,H,G)})},html:function(H){return le(this,function(G){var ee=this[0]||{},ne=0,ce=this.length;if(G===void 0&&ee.nodeType===1)return ee.innerHTML;if(typeof G=="string"&&!Fe.test(G)&&!Ce[(ye.exec(G)||["",""])[1].toLowerCase()]){G=p.htmlPrefilter(G);try{for(;ne<ce;ne++)(ee=this[ne]||{}).nodeType===1&&(p.cleanData(Ke(ee,!1)),ee.innerHTML=G);ee=0}catch(ge){}}ee&&this.empty().append(G)},null,H,arguments.length)},replaceWith:function(){var H=[];return it(this,arguments,function(G){var ee=this.parentNode;p.inArray(this,H)<0&&(p.cleanData(Ke(this)),ee&&ee.replaceChild(G,this))},H)}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(H,G){p.fn[H]=function(ee){for(var ne,ce=[],ge=p(ee),Ae=ge.length-1,Je=0;Je<=Ae;Je++)ne=Je===Ae?this:this.clone(!0),p(ge[Je])[G](ne),u.apply(ce,ne.get());return this.pushStack(ce)}});var Kt,bl={HTML:"block",BODY:"block"};function hl(H,G){return H=p(G.createElement(H)).appendTo(G.body),G=p.css(H[0],"display"),H.detach(),G}function Rr(H){var G=o,ee=bl[H];return ee||((ee=hl(H,G))!=="none"&&ee||((G=(Kt=(Kt||p("<iframe frameborder='0' width='0' height='0'/>")).appendTo(G.documentElement))[0].contentDocument).write(),G.close(),ee=hl(H,G),Kt.detach()),bl[H]=ee),ee}function Di(H,G,ee,ne){var ce,ge={};for(ce in G)ge[ce]=H.style[ce],H.style[ce]=G[ce];for(ce in ne=ee.apply(H,ne||[]),G)H.style[ce]=ge[ce];return ne}var ln,_e,Ne,nt,mt,Ft,_t=/^margin/,Jt=new RegExp("^("+y+")(?!px)[a-z%]+$","i"),qt=function(H){var G=H.ownerDocument.defaultView;return G&&G.opener||(G=e),G.getComputedStyle(H)},wl=o.documentElement;function Tl(){Ft.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",Ft.innerHTML="",wl.appendChild(mt);var H=e.getComputedStyle(Ft);ln=H.top!=="1%",nt=H.marginLeft==="2px",_e=H.width==="4px",Ft.style.marginRight="50%",Ne=H.marginRight==="4px",wl.removeChild(mt)}function Wl(H,G,ee){var ne,ce,ge=H.style;return(ce=(ee=ee||qt(H))?ee.getPropertyValue(G)||ee[G]:void 0)!==""&&ce!==void 0||p.contains(H.ownerDocument,H)||(ce=p.style(H,G)),ee&&!b.pixelMarginRight()&&Jt.test(ce)&&_t.test(G)&&(ne=ge.width,H=ge.minWidth,G=ge.maxWidth,ge.minWidth=ge.maxWidth=ge.width=ce,ce=ee.width,ge.width=ne,ge.minWidth=H,ge.maxWidth=G),ce!==void 0?ce+"":ce}function sn(H,G){return{get:function(){return H()?void delete this.get:(this.get=G).apply(this,arguments)}}}mt=o.createElement("div"),(Ft=o.createElement("div")).style&&(Ft.style.backgroundClip="content-box",Ft.cloneNode(!0).style.backgroundClip="",b.clearCloneStyle=Ft.style.backgroundClip==="content-box",mt.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",mt.appendChild(Ft),p.extend(b,{pixelPosition:function(){return Tl(),ln},boxSizingReliable:function(){return _e==null&&Tl(),_e},pixelMarginRight:function(){return _e==null&&Tl(),Ne},reliableMarginLeft:function(){return _e==null&&Tl(),nt},reliableMarginRight:function(){var H,G=Ft.appendChild(o.createElement("div"));return G.style.cssText=Ft.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",G.style.marginRight=G.style.width="0",Ft.style.width="1px",wl.appendChild(mt),H=!parseFloat(e.getComputedStyle(G).marginRight),wl.removeChild(mt),Ft.removeChild(G),H}}));var Vr=/^(none|table(?!-c[ea]).+)/,An={position:"absolute",visibility:"hidden",display:"block"},zn={letterSpacing:"0",fontWeight:"400"},On=["Webkit","O","Moz","ms"],Dr=o.createElement("div").style;function Vn(H){if(H in Dr)return H;for(var G=H[0].toUpperCase()+H.slice(1),ee=On.length;ee--;)if((H=On[ee]+G)in Dr)return H}function ii(H,G,ee){var ne=te.exec(G);return ne?Math.max(0,ne[2]-(ee||0))+(ne[3]||"px"):G}function na(H,G,ee,ne,ce){for(var ge=ee===(ne?"border":"content")?4:G==="width"?1:0,Ae=0;ge<4;ge+=2)ee==="margin"&&(Ae+=p.css(H,ee+re[ge],!0,ce)),ne?(ee==="content"&&(Ae-=p.css(H,"padding"+re[ge],!0,ce)),ee!=="margin"&&(Ae-=p.css(H,"border"+re[ge]+"Width",!0,ce))):(Ae+=p.css(H,"padding"+re[ge],!0,ce),ee!=="padding"&&(Ae+=p.css(H,"border"+re[ge]+"Width",!0,ce)));return Ae}function di(H,G,ee){var ne=!0,ce=G==="width"?H.offsetWidth:H.offsetHeight,ge=qt(H),Ae=p.css(H,"boxSizing",!1,ge)==="border-box";if(ce<=0||ce==null){if(((ce=Wl(H,G,ge))<0||ce==null)&&(ce=H.style[G]),Jt.test(ce))return ce;ne=Ae&&(b.boxSizingReliable()||ce===H.style[G]),ce=parseFloat(ce)||0}return ce+na(H,G,ee||(Ae?"border":"content"),ne,ge)+"px"}function oi(H,G){for(var ee,ne,ce,ge=[],Ae=0,Je=H.length;Ae<Je;Ae++)(ne=H[Ae]).style&&(ge[Ae]=Z.get(ne,"olddisplay"),ee=ne.style.display,G?(ge[Ae]||ee!=="none"||(ne.style.display=""),ne.style.display===""&&se(ne)&&(ge[Ae]=Z.access(ne,"olddisplay",Rr(ne.nodeName)))):(ce=se(ne),ee==="none"&&ce||Z.set(ne,"olddisplay",ce?ee:p.css(ne,"display"))));for(Ae=0;Ae<Je;Ae++)(ne=H[Ae]).style&&(G&&ne.style.display!=="none"&&ne.style.display!==""||(ne.style.display=G?ge[Ae]||"":"none"));return H}function gn(H,G,ee,ne,ce){return new gn.prototype.init(H,G,ee,ne,ce)}p.extend({cssHooks:{opacity:{get:function(H,G){if(G)return H=Wl(H,"opacity"),H===""?"1":H}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(H,G,ee,ne){if(H&&H.nodeType!==3&&H.nodeType!==8&&H.style){var ce,ge,Ae,Je=p.camelCase(G),at=H.style;return G=p.cssProps[Je]||(p.cssProps[Je]=Vn(Je)||Je),Ae=p.cssHooks[G]||p.cssHooks[Je],ee===void 0?Ae&&"get"in Ae&&(ce=Ae.get(H,!1,ne))!==void 0?ce:at[G]:((ge=typeof ee)==="string"&&(ce=te.exec(ee))&&ce[1]&&(ee=fe(H,G,ce),ge="number"),void(ee!=null&&ee==ee&&(ge==="number"&&(ee+=ce&&ce[3]||(p.cssNumber[Je]?"":"px")),b.clearCloneStyle||ee!==""||G.indexOf("background")!==0||(at[G]="inherit"),Ae&&"set"in Ae&&(ee=Ae.set(H,ee,ne))===void 0||(at[G]=ee))))}},css:function(H,G,ee,ne){var ce,ge=p.camelCase(G);return G=p.cssProps[ge]||(p.cssProps[ge]=Vn(ge)||ge),(ge=p.cssHooks[G]||p.cssHooks[ge])&&"get"in ge&&(ce=ge.get(H,!0,ee)),ce===void 0&&(ce=Wl(H,G,ne)),ce==="normal"&&G in zn&&(ce=zn[G]),ee===""||ee?(G=parseFloat(ce),ee===!0||isFinite(G)?G||0:ce):ce}}),p.each(["height","width"],function(H,G){p.cssHooks[G]={get:function(ee,ne,ce){return ne?Vr.test(p.css(ee,"display"))&&ee.offsetWidth===0?Di(ee,An,function(){return di(ee,G,ce)}):di(ee,G,ce):void 0},set:function(ee,ne,ce){var ge,Ae=ce&&qt(ee),Ae=ce&&na(ee,G,ce,p.css(ee,"boxSizing",!1,Ae)==="border-box",Ae);return Ae&&(ge=te.exec(ne))&&(ge[3]||"px")!=="px"&&(ee.style[G]=ne,ne=p.css(ee,G)),ii(0,ne,Ae)}}}),p.cssHooks.marginLeft=sn(b.reliableMarginLeft,function(H,G){return G?(parseFloat(Wl(H,"marginLeft"))||H.getBoundingClientRect().left-Di(H,{marginLeft:0},function(){return H.getBoundingClientRect().left}))+"px":void 0}),p.cssHooks.marginRight=sn(b.reliableMarginRight,function(H,G){return G?Di(H,{display:"inline-block"},Wl,[H,"marginRight"]):void 0}),p.each({margin:"",padding:"",border:"Width"},function(H,G){p.cssHooks[H+G]={expand:function(ee){for(var ne=0,ce={},ge=typeof ee=="string"?ee.split(" "):[ee];ne<4;ne++)ce[H+re[ne]+G]=ge[ne]||ge[ne-2]||ge[0];return ce}},_t.test(H)||(p.cssHooks[H+G].set=ii)}),p.fn.extend({css:function(H,G){return le(this,function(ee,ne,ce){var ge,Ae,Je={},at=0;if(p.isArray(ne)){for(ge=qt(ee),Ae=ne.length;at<Ae;at++)Je[ne[at]]=p.css(ee,ne[at],!1,ge);return Je}return ce!==void 0?p.style(ee,ne,ce):p.css(ee,ne)},H,G,1<arguments.length)},show:function(){return oi(this,!0)},hide:function(){return oi(this)},toggle:function(H){return typeof H=="boolean"?H?this.show():this.hide():this.each(function(){se(this)?p(this).show():p(this).hide()})}}),(p.Tween=gn).prototype={constructor:gn,init:function(H,G,ee,ne,ce,ge){this.elem=H,this.prop=ee,this.easing=ce||p.easing._default,this.options=G,this.start=this.now=this.cur(),this.end=ne,this.unit=ge||(p.cssNumber[ee]?"":"px")},cur:function(){var H=gn.propHooks[this.prop];return(H&&H.get?H:gn.propHooks._default).get(this)},run:function(H){var G,ee=gn.propHooks[this.prop];return this.options.duration?this.pos=G=p.easing[this.easing](H,this.options.duration*H,0,1,this.options.duration):this.pos=G=H,this.now=(this.end-this.start)*G+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(ee&&ee.set?ee:gn.propHooks._default).set(this),this}},gn.prototype.init.prototype=gn.prototype,gn.propHooks={_default:{get:function(H){return H.elem.nodeType!==1||H.elem[H.prop]!=null&&H.elem.style[H.prop]==null?H.elem[H.prop]:(H=p.css(H.elem,H.prop,""))&&H!=="auto"?H:0},set:function(H){p.fx.step[H.prop]?p.fx.step[H.prop](H):H.elem.nodeType!==1||H.elem.style[p.cssProps[H.prop]]==null&&!p.cssHooks[H.prop]?H.elem[H.prop]=H.now:p.style(H.elem,H.prop,H.now+H.unit)}}},gn.propHooks.scrollTop=gn.propHooks.scrollLeft={set:function(H){H.elem.nodeType&&H.elem.parentNode&&(H.elem[H.prop]=H.now)}},p.easing={linear:function(H){return H},swing:function(H){return .5-Math.cos(H*Math.PI)/2},_default:"swing"},p.fx=gn.prototype.init,p.fx.step={};var ai,zt,tl=/^(?:toggle|show|hide)$/,ul=/queueHooks$/;function Ar(){return e.setTimeout(function(){ai=void 0}),ai=p.now()}function or(H,G){var ee,ne=0,ce={height:H};for(G=G?1:0;ne<4;ne+=2-G)ce["margin"+(ee=re[ne])]=ce["padding"+ee]=H;return G&&(ce.opacity=ce.width=H),ce}function pn(H,G,ee){for(var ne,ce=(Fl.tweeners[G]||[]).concat(Fl.tweeners["*"]),ge=0,Ae=ce.length;ge<Ae;ge++)if(ne=ce[ge].call(ee,G,H))return ne}function Fl(H,G,ee){var ne,ce,ge=0,Ae=Fl.prefilters.length,Je=p.Deferred().always(function(){delete at.elem}),at=function(){if(ce)return!1;for(var ie=ai||Ar(),ie=Math.max(0,ze.startTime+ze.duration-ie),dt=1-(ie/ze.duration||0),ut=0,bt=ze.tweens.length;ut<bt;ut++)ze.tweens[ut].run(dt);return Je.notifyWith(H,[ze,dt,ie]),dt<1&&bt?ie:(Je.resolveWith(H,[ze]),!1)},ze=Je.promise({elem:H,props:p.extend({},G),opts:p.extend(!0,{specialEasing:{},easing:p.easing._default},ee),originalProperties:G,originalOptions:ee,startTime:ai||Ar(),duration:ee.duration,tweens:[],createTween:function(ie,dt){return ie=p.Tween(H,ze.opts,ie,dt,ze.opts.specialEasing[ie]||ze.opts.easing),ze.tweens.push(ie),ie},stop:function(ie){var dt=0,ut=ie?ze.tweens.length:0;if(ce)return this;for(ce=!0;dt<ut;dt++)ze.tweens[dt].run(1);return ie?(Je.notifyWith(H,[ze,1,0]),Je.resolveWith(H,[ze,ie])):Je.rejectWith(H,[ze,ie]),this}}),Pe=ze.props;for(function(ie,dt){var ut,bt,Lt,Il,yr;for(ut in ie)if(bt=p.camelCase(ut),Lt=dt[bt],Il=ie[ut],p.isArray(Il)&&(Lt=Il[1],Il=ie[ut]=Il[0]),ut!==bt&&(ie[bt]=Il,delete ie[ut]),yr=p.cssHooks[bt],yr&&"expand"in yr)for(ut in Il=yr.expand(Il),delete ie[bt],Il)ut in ie||(ie[ut]=Il[ut],dt[ut]=Lt);else dt[bt]=Lt}(Pe,ze.opts.specialEasing);ge<Ae;ge++)if(ne=Fl.prefilters[ge].call(ze,H,Pe,ze.opts))return p.isFunction(ne.stop)&&(p._queueHooks(ze.elem,ze.opts.queue).stop=p.proxy(ne.stop,ne)),ne;return p.map(Pe,pn,ze),p.isFunction(ze.opts.start)&&ze.opts.start.call(H,ze),p.fx.timer(p.extend(at,{elem:H,anim:ze,queue:ze.opts.queue})),ze.progress(ze.opts.progress).done(ze.opts.done,ze.opts.complete).fail(ze.opts.fail).always(ze.opts.always)}p.Animation=p.extend(Fl,{tweeners:{"*":[function(H,G){var ee=this.createTween(H,G);return fe(ee.elem,H,te.exec(G),ee),ee}]},tweener:function(H,G){for(var ee,ne=0,ce=(H=p.isFunction(H)?(G=H,["*"]):H.match(B)).length;ne<ce;ne++)ee=H[ne],Fl.tweeners[ee]=Fl.tweeners[ee]||[],Fl.tweeners[ee].unshift(G)},prefilters:[function(H,G,ee){var ne,ce,ge,Ae,Je,at,ze,Pe=this,ie={},dt=H.style,ut=H.nodeType&&se(H),bt=Z.get(H,"fxshow");for(ne in ee.queue||((Je=p._queueHooks(H,"fx")).unqueued==null&&(Je.unqueued=0,at=Je.empty.fire,Je.empty.fire=function(){Je.unqueued||at()}),Je.unqueued++,Pe.always(function(){Pe.always(function(){Je.unqueued--,p.queue(H,"fx").length||Je.empty.fire()})})),H.nodeType===1&&("height"in G||"width"in G)&&(ee.overflow=[dt.overflow,dt.overflowX,dt.overflowY],((ze=p.css(H,"display"))==="none"?Z.get(H,"olddisplay")||Rr(H.nodeName):ze)==="inline"&&p.css(H,"float")==="none"&&(dt.display="inline-block")),ee.overflow&&(dt.overflow="hidden",Pe.always(function(){dt.overflow=ee.overflow[0],dt.overflowX=ee.overflow[1],dt.overflowY=ee.overflow[2]})),G)if(ce=G[ne],tl.exec(ce)){if(delete G[ne],ge=ge||ce==="toggle",ce===(ut?"hide":"show")){if(ce!=="show"||!bt||bt[ne]===void 0)continue;ut=!0}ie[ne]=bt&&bt[ne]||p.style(H,ne)}else ze=void 0;if(p.isEmptyObject(ie))(ze==="none"?Rr(H.nodeName):ze)==="inline"&&(dt.display=ze);else for(ne in bt?"hidden"in bt&&(ut=bt.hidden):bt=Z.access(H,"fxshow",{}),ge&&(bt.hidden=!ut),ut?p(H).show():Pe.done(function(){p(H).hide()}),Pe.done(function(){for(var Lt in Z.remove(H,"fxshow"),ie)p.style(H,Lt,ie[Lt])}),ie)Ae=pn(ut?bt[ne]:0,ne,Pe),ne in bt||(bt[ne]=Ae.start,ut&&(Ae.end=Ae.start,Ae.start=ne==="width"||ne==="height"?1:0))}],prefilter:function(H,G){G?Fl.prefilters.unshift(H):Fl.prefilters.push(H)}}),p.speed=function(H,G,ee){var ne=H&&typeof H=="object"?p.extend({},H):{complete:ee||!ee&&G||p.isFunction(H)&&H,duration:H,easing:ee&&G||G&&!p.isFunction(G)&&G};return ne.duration=p.fx.off?0:typeof ne.duration=="number"?ne.duration:ne.duration in p.fx.speeds?p.fx.speeds[ne.duration]:p.fx.speeds._default,ne.queue!=null&&ne.queue!==!0||(ne.queue="fx"),ne.old=ne.complete,ne.complete=function(){p.isFunction(ne.old)&&ne.old.call(this),ne.queue&&p.dequeue(this,ne.queue)},ne},p.fn.extend({fadeTo:function(H,G,ee,ne){return this.filter(se).css("opacity",0).show().end().animate({opacity:G},H,ee,ne)},animate:function(H,G,ee,ne){var ce=p.isEmptyObject(H),ge=p.speed(G,ee,ne),ne=function(){var Ae=Fl(this,p.extend({},H),ge);(ce||Z.get(this,"finish"))&&Ae.stop(!0)};return ne.finish=ne,ce||ge.queue===!1?this.each(ne):this.queue(ge.queue,ne)},stop:function(H,G,ee){function ne(ce){var ge=ce.stop;delete ce.stop,ge(ee)}return typeof H!="string"&&(ee=G,G=H,H=void 0),G&&H!==!1&&this.queue(H||"fx",[]),this.each(function(){var ce=!0,ge=H!=null&&H+"queueHooks",Ae=p.timers,Je=Z.get(this);if(ge)Je[ge]&&Je[ge].stop&&ne(Je[ge]);else for(ge in Je)Je[ge]&&Je[ge].stop&&ul.test(ge)&&ne(Je[ge]);for(ge=Ae.length;ge--;)Ae[ge].elem!==this||H!=null&&Ae[ge].queue!==H||(Ae[ge].anim.stop(ee),ce=!1,Ae.splice(ge,1));!ce&&ee||p.dequeue(this,H)})},finish:function(H){return H!==!1&&(H=H||"fx"),this.each(function(){var G,ee=Z.get(this),ne=ee[H+"queue"],ce=ee[H+"queueHooks"],ge=p.timers,Ae=ne?ne.length:0;for(ee.finish=!0,p.queue(this,H,[]),ce&&ce.stop&&ce.stop.call(this,!0),G=ge.length;G--;)ge[G].elem===this&&ge[G].queue===H&&(ge[G].anim.stop(!0),ge.splice(G,1));for(G=0;G<Ae;G++)ne[G]&&ne[G].finish&&ne[G].finish.call(this);delete ee.finish})}}),p.each(["toggle","show","hide"],function(H,G){var ee=p.fn[G];p.fn[G]=function(ne,ce,ge){return ne==null||typeof ne=="boolean"?ee.apply(this,arguments):this.animate(or(G,!0),ne,ce,ge)}}),p.each({slideDown:or("show"),slideUp:or("hide"),slideToggle:or("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(H,G){p.fn[H]=function(ee,ne,ce){return this.animate(G,ee,ne,ce)}}),p.timers=[],p.fx.tick=function(){var H,G=0,ee=p.timers;for(ai=p.now();G<ee.length;G++)(H=ee[G])()||ee[G]!==H||ee.splice(G--,1);ee.length||p.fx.stop(),ai=void 0},p.fx.timer=function(H){p.timers.push(H),H()?p.fx.start():p.timers.pop()},p.fx.interval=13,p.fx.start=function(){zt=zt||e.setInterval(p.fx.tick,p.fx.interval)},p.fx.stop=function(){e.clearInterval(zt),zt=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(H,G){return H=p.fx&&p.fx.speeds[H]||H,G=G||"fx",this.queue(G,function(ee,ne){var ce=e.setTimeout(ee,H);ne.stop=function(){e.clearTimeout(ce)}})},O=o.createElement("input"),l=o.createElement("select"),y=l.appendChild(o.createElement("option")),O.type="checkbox",b.checkOn=O.value!=="",b.optSelected=y.selected,l.disabled=!0,b.optDisabled=!y.disabled,(O=o.createElement("input")).value="t",O.type="radio",b.radioValue=O.value==="t";var Gi,fo=p.expr.attrHandle;p.fn.extend({attr:function(H,G){return le(this,p.attr,H,G,1<arguments.length)},removeAttr:function(H){return this.each(function(){p.removeAttr(this,H)})}}),p.extend({attr:function(H,G,ee){var ne,ce,ge=H.nodeType;if(ge!==3&&ge!==8&&ge!==2)return H.getAttribute===void 0?p.prop(H,G,ee):(ge===1&&p.isXMLDoc(H)||(G=G.toLowerCase(),ce=p.attrHooks[G]||(p.expr.match.bool.test(G)?Gi:void 0)),ee!==void 0?ee===null?void p.removeAttr(H,G):ce&&"set"in ce&&(ne=ce.set(H,ee,G))!==void 0?ne:(H.setAttribute(G,ee+""),ee):ce&&"get"in ce&&(ne=ce.get(H,G))!==null?ne:(ne=p.find.attr(H,G))==null?void 0:ne)},attrHooks:{type:{set:function(H,G){if(!b.radioValue&&G==="radio"&&p.nodeName(H,"input")){var ee=H.value;return H.setAttribute("type",G),ee&&(H.value=ee),G}}}},removeAttr:function(H,G){var ee,ne,ce=0,ge=G&&G.match(B);if(ge&&H.nodeType===1)for(;ee=ge[ce++];)ne=p.propFix[ee]||ee,p.expr.match.bool.test(ee)&&(H[ne]=!1),H.removeAttribute(ee)}}),Gi={set:function(H,G,ee){return G===!1?p.removeAttr(H,ee):H.setAttribute(ee,ee),ee}},p.each(p.expr.match.bool.source.match(/\w+/g),function(H,G){var ee=fo[G]||p.find.attr;fo[G]=function(ne,ce,ge){var Ae,Je;return ge||(Je=fo[ce],fo[ce]=Ae,Ae=ee(ne,ce,ge)!=null?ce.toLowerCase():null,fo[ce]=Je),Ae}});var ts=/^(?:input|select|textarea|button)$/i,Oo=/^(?:a|area)$/i;p.fn.extend({prop:function(H,G){return le(this,p.prop,H,G,1<arguments.length)},removeProp:function(H){return this.each(function(){delete this[p.propFix[H]||H]})}}),p.extend({prop:function(H,G,ee){var ne,ce,ge=H.nodeType;if(ge!==3&&ge!==8&&ge!==2)return ge===1&&p.isXMLDoc(H)||(G=p.propFix[G]||G,ce=p.propHooks[G]),ee!==void 0?ce&&"set"in ce&&(ne=ce.set(H,ee,G))!==void 0?ne:H[G]=ee:ce&&"get"in ce&&(ne=ce.get(H,G))!==null?ne:H[G]},propHooks:{tabIndex:{get:function(H){var G=p.find.attr(H,"tabindex");return G?parseInt(G,10):ts.test(H.nodeName)||Oo.test(H.nodeName)&&H.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),b.optSelected||(p.propHooks.selected={get:function(H){return H=H.parentNode,H&&H.parentNode&&H.parentNode.selectedIndex,null},set:function(H){H=H.parentNode,H&&(H.selectedIndex,H.parentNode&&H.parentNode.selectedIndex)}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){p.propFix[this.toLowerCase()]=this});var Po=/[\t\r\n\f]/g;function Yi(H){return H.getAttribute&&H.getAttribute("class")||""}p.fn.extend({addClass:function(H){var G,ee,ne,ce,ge,Ae,Je=0;if(p.isFunction(H))return this.each(function(at){p(this).addClass(H.call(this,at,Yi(this)))});if(typeof H=="string"&&H){for(G=H.match(B)||[];ee=this[Je++];)if(Ae=Yi(ee),ne=ee.nodeType===1&&(" "+Ae+" ").replace(Po," ")){for(ge=0;ce=G[ge++];)ne.indexOf(" "+ce+" ")<0&&(ne+=ce+" ");Ae!==(Ae=p.trim(ne))&&ee.setAttribute("class",Ae)}}return this},removeClass:function(H){var G,ee,ne,ce,ge,Ae,Je=0;if(p.isFunction(H))return this.each(function(at){p(this).removeClass(H.call(this,at,Yi(this)))});if(!arguments.length)return this.attr("class","");if(typeof H=="string"&&H){for(G=H.match(B)||[];ee=this[Je++];)if(Ae=Yi(ee),ne=ee.nodeType===1&&(" "+Ae+" ").replace(Po," ")){for(ge=0;ce=G[ge++];)for(;-1<ne.indexOf(" "+ce+" ");)ne=ne.replace(" "+ce+" "," ");Ae!==(Ae=p.trim(ne))&&ee.setAttribute("class",Ae)}}return this},toggleClass:function(H,G){var ee=typeof H;return typeof G=="boolean"&&ee=="string"?G?this.addClass(H):this.removeClass(H):p.isFunction(H)?this.each(function(ne){p(this).toggleClass(H.call(this,ne,Yi(this),G),G)}):this.each(function(){var ne,ce,ge,Ae;if(ee=="string")for(ce=0,ge=p(this),Ae=H.match(B)||[];ne=Ae[ce++];)ge.hasClass(ne)?ge.removeClass(ne):ge.addClass(ne);else H!==void 0&&ee!="boolean"||((ne=Yi(this))&&Z.set(this,"__className__",ne),this.setAttribute&&this.setAttribute("class",!ne&&H!==!1&&Z.get(this,"__className__")||""))})},hasClass:function(H){for(var G,ee=0,ne=" "+H+" ";G=this[ee++];)if(G.nodeType===1&&-1<(" "+Yi(G)+" ").replace(Po," ").indexOf(ne))return!0;return!1}});var Wc=/\r/g,Ju=/[\x20\t\r\n\f]+/g;p.fn.extend({val:function(H){var G,ee,ne,ce=this[0];return arguments.length?(ne=p.isFunction(H),this.each(function(ge){this.nodeType===1&&((ge=ne?H.call(this,ge,p(this).val()):H)==null?ge="":typeof ge=="number"?ge+="":p.isArray(ge)&&(ge=p.map(ge,function(Ae){return Ae==null?"":Ae+""})),(G=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()])&&"set"in G&&G.set(this,ge,"value")!==void 0||(this.value=ge))})):ce?(G=p.valHooks[ce.type]||p.valHooks[ce.nodeName.toLowerCase()])&&"get"in G&&(ee=G.get(ce,"value"))!==void 0?ee:typeof(ee=ce.value)=="string"?ee.replace(Wc,""):ee??"":void 0}}),p.extend({valHooks:{option:{get:function(H){var G=p.find.attr(H,"value");return G??p.trim(p.text(H)).replace(Ju," ")}},select:{get:function(H){for(var G,ee=H.options,ne=H.selectedIndex,ce=H.type==="select-one"||ne<0,ge=ce?null:[],Ae=ce?ne+1:ee.length,Je=ne<0?Ae:ce?ne:0;Je<Ae;Je++)if(((G=ee[Je]).selected||Je===ne)&&(b.optDisabled?!G.disabled:G.getAttribute("disabled")===null)&&(!G.parentNode.disabled||!p.nodeName(G.parentNode,"optgroup"))){if(G=p(G).val(),ce)return G;ge.push(G)}return ge},set:function(H,G){for(var ee,ne,ce=H.options,ge=p.makeArray(G),Ae=ce.length;Ae--;)((ne=ce[Ae]).selected=-1<p.inArray(p.valHooks.option.get(ne),ge))&&(ee=!0);return ee||(H.selectedIndex=-1),ge}}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]={set:function(H,G){return p.isArray(G)?H.checked=-1<p.inArray(p(H).val(),G):void 0}},b.checkOn||(p.valHooks[this].get=function(H){return H.getAttribute("value")===null?"on":H.value})});var ls=/^(?:focusinfocus|focusoutblur)$/;p.extend(p.event,{trigger:function(H,G,ee,ne){var ce,ge,Ae,Je,at,ze,Pe=[ee||o],ie=g.call(H,"type")?H.type:H,dt=g.call(H,"namespace")?H.namespace.split("."):[],ut=ge=ee=ee||o;if(ee.nodeType!==3&&ee.nodeType!==8&&!ls.test(ie+p.event.triggered)&&(-1<ie.indexOf(".")&&(ie=(dt=ie.split(".")).shift(),dt.sort()),Je=ie.indexOf(":")<0&&"on"+ie,(H=H[p.expando]?H:new p.Event(ie,typeof H=="object"&&H)).isTrigger=ne?2:3,H.namespace=dt.join("."),H.rnamespace=H.namespace?new RegExp("(^|\\.)"+dt.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,H.result=void 0,H.target||(H.target=ee),G=G==null?[H]:p.makeArray(G,[H]),ze=p.event.special[ie]||{},ne||!ze.trigger||ze.trigger.apply(ee,G)!==!1)){if(!ne&&!ze.noBubble&&!p.isWindow(ee)){for(Ae=ze.delegateType||ie,ls.test(Ae+ie)||(ut=ut.parentNode);ut;ut=ut.parentNode)Pe.push(ut),ge=ut;ge===(ee.ownerDocument||o)&&Pe.push(ge.defaultView||ge.parentWindow||e)}for(ce=0;(ut=Pe[ce++])&&!H.isPropagationStopped();)H.type=1<ce?Ae:ze.bindType||ie,(at=(Z.get(ut,"events")||{})[H.type]&&Z.get(ut,"handle"))&&at.apply(ut,G),(at=Je&&ut[Je])&&at.apply&&X(ut)&&(H.result=at.apply(ut,G),H.result===!1&&H.preventDefault());return H.type=ie,ne||H.isDefaultPrevented()||ze._default&&ze._default.apply(Pe.pop(),G)!==!1||!X(ee)||Je&&p.isFunction(ee[ie])&&!p.isWindow(ee)&&((ge=ee[Je])&&(ee[Je]=null),ee[p.event.triggered=ie](),p.event.triggered=void 0,ge&&(ee[Je]=ge)),H.result}},simulate:function(H,G,ee){H=p.extend(new p.Event,ee,{type:H,isSimulated:!0}),p.event.trigger(H,null,G)}}),p.fn.extend({trigger:function(H,G){return this.each(function(){p.event.trigger(H,G,this)})},triggerHandler:function(H,G){var ee=this[0];return ee?p.event.trigger(H,G,ee,!0):void 0}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(H,G){p.fn[G]=function(ee,ne){return 0<arguments.length?this.on(G,null,ee,ne):this.trigger(G)}}),p.fn.extend({hover:function(H,G){return this.mouseenter(H).mouseleave(G||H)}}),b.focusin="onfocusin"in e,b.focusin||p.each({focus:"focusin",blur:"focusout"},function(H,G){function ee(ne){p.event.simulate(G,ne.target,p.event.fix(ne))}p.event.special[G]={setup:function(){var ne=this.ownerDocument||this,ce=Z.access(ne,G);ce||ne.addEventListener(H,ee,!0),Z.access(ne,G,(ce||0)+1)},teardown:function(){var ne=this.ownerDocument||this,ce=Z.access(ne,G)-1;ce?Z.access(ne,G,ce):(ne.removeEventListener(H,ee,!0),Z.remove(ne,G))}}});var Ra=e.location,rs=p.now(),Ls=/\?/;p.parseJSON=function(H){return JSON.parse(H+"")},p.parseXML=function(H){var G;if(!H||typeof H!="string")return null;try{G=new e.DOMParser().parseFromString(H,"text/xml")}catch(ee){G=void 0}return G&&!G.getElementsByTagName("parsererror").length||p.error("Invalid XML: "+H),G};var ns=/#.*$/,Hs=/([?&])_=[^&]*/,Qu=/^(.*?):[ \t]*([^\r\n]*)$/gm,Uc=/^(?:GET|HEAD)$/,Gc=/^\/\//,ia={},Bs={},ef="*/".concat("*"),Yc=o.createElement("a");function js(H){return function(G,ee){typeof G!="string"&&(ee=G,G="*");var ne,ce=0,ge=G.toLowerCase().match(B)||[];if(p.isFunction(ee))for(;ne=ge[ce++];)ne[0]==="+"?(ne=ne.slice(1)||"*",(H[ne]=H[ne]||[]).unshift(ee)):(H[ne]=H[ne]||[]).push(ee)}}function tf(H,G,ee,ne){var ce={},ge=H===Bs;function Ae(Je){var at;return ce[Je]=!0,p.each(H[Je]||[],function(ze,Pe){return Pe=Pe(G,ee,ne),typeof Pe!="string"||ge||ce[Pe]?ge?!(at=Pe):void 0:(G.dataTypes.unshift(Pe),Ae(Pe),!1)}),at}return Ae(G.dataTypes[0])||!ce["*"]&&Ae("*")}function qc(H,G){var ee,ne,ce=p.ajaxSettings.flatOptions||{};for(ee in G)G[ee]!==void 0&&((ce[ee]?H:ne=ne||{})[ee]=G[ee]);return ne&&p.extend(!0,H,ne),H}Yc.href=Ra.href,p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ra.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Ra.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ef,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(H,G){return G?qc(qc(H,p.ajaxSettings),G):qc(p.ajaxSettings,H)},ajaxPrefilter:js(ia),ajaxTransport:js(Bs),ajax:function(H,G){typeof H=="object"&&(G=H,H=void 0),G=G||{};var ee,ne,ce,ge,Ae,Je,at,ze,Pe=p.ajaxSetup({},G),ie=Pe.context||Pe,dt=Pe.context&&(ie.nodeType||ie.jquery)?p(ie):p.event,ut=p.Deferred(),bt=p.Callbacks("once memory"),Lt=Pe.statusCode||{},Il={},yr={},Ql=0,nn="canceled",Dl={readyState:0,getResponseHeader:function(sl){var kr;if(Ql===2){if(!ge)for(ge={};kr=Qu.exec(ce);)ge[kr[1].toLowerCase()]=kr[2];kr=ge[sl.toLowerCase()]}return kr??null},getAllResponseHeaders:function(){return Ql===2?ce:null},setRequestHeader:function(sl,kr){var Kr=sl.toLowerCase();return Ql||(sl=yr[Kr]=yr[Kr]||sl,Il[sl]=kr),this},overrideMimeType:function(sl){return Ql||(Pe.mimeType=sl),this},statusCode:function(sl){if(sl)if(Ql<2)for(var kr in sl)Lt[kr]=[Lt[kr],sl[kr]];else Dl.always(sl[Dl.status]);return this},abort:function(sl){return sl=sl||nn,ee&&ee.abort(sl),Ai(0,sl),this}};if(ut.promise(Dl).complete=bt.add,Dl.success=Dl.done,Dl.error=Dl.fail,Pe.url=((H||Pe.url||Ra.href)+"").replace(ns,"").replace(Gc,Ra.protocol+"//"),Pe.type=G.method||G.type||Pe.method||Pe.type,Pe.dataTypes=p.trim(Pe.dataType||"*").toLowerCase().match(B)||[""],Pe.crossDomain==null){Je=o.createElement("a");try{Je.href=Pe.url,Je.href=Je.href,Pe.crossDomain=Yc.protocol+"//"+Yc.host!=Je.protocol+"//"+Je.host}catch(sl){Pe.crossDomain=!0}}if(Pe.data&&Pe.processData&&typeof Pe.data!="string"&&(Pe.data=p.param(Pe.data,Pe.traditional)),tf(ia,Pe,G,Dl),Ql===2)return Dl;for(ze in(at=p.event&&Pe.global)&&p.active++==0&&p.event.trigger("ajaxStart"),Pe.type=Pe.type.toUpperCase(),Pe.hasContent=!Uc.test(Pe.type),ne=Pe.url,Pe.hasContent||(Pe.data&&(ne=Pe.url+=(Ls.test(ne)?"&":"?")+Pe.data,delete Pe.data),Pe.cache===!1&&(Pe.url=Hs.test(ne)?ne.replace(Hs,"$1_="+rs++):ne+(Ls.test(ne)?"&":"?")+"_="+rs++)),Pe.ifModified&&(p.lastModified[ne]&&Dl.setRequestHeader("If-Modified-Since",p.lastModified[ne]),p.etag[ne]&&Dl.setRequestHeader("If-None-Match",p.etag[ne])),(Pe.data&&Pe.hasContent&&Pe.contentType!==!1||G.contentType)&&Dl.setRequestHeader("Content-Type",Pe.contentType),Dl.setRequestHeader("Accept",Pe.dataTypes[0]&&Pe.accepts[Pe.dataTypes[0]]?Pe.accepts[Pe.dataTypes[0]]+(Pe.dataTypes[0]!=="*"?", "+ef+"; q=0.01":""):Pe.accepts["*"]),Pe.headers)Dl.setRequestHeader(ze,Pe.headers[ze]);if(Pe.beforeSend&&(Pe.beforeSend.call(ie,Dl,Pe)===!1||Ql===2))return Dl.abort();for(ze in nn="abort",{success:1,error:1,complete:1})Dl[ze](Pe[ze]);if(ee=tf(Bs,Pe,G,Dl)){if(Dl.readyState=1,at&&dt.trigger("ajaxSend",[Dl,Pe]),Ql===2)return Dl;Pe.async&&0<Pe.timeout&&(Ae=e.setTimeout(function(){Dl.abort("timeout")},Pe.timeout));try{Ql=1,ee.send(Il,Ai)}catch(sl){if(!(Ql<2))throw sl;Ai(-1,sl)}}else Ai(-1,"No Transport");function Ai(sl,kr,Kr,Xn){var ho,oa,mi,Wr=kr;Ql!==2&&(Ql=2,Ae&&e.clearTimeout(Ae),ee=void 0,ce=Xn||"",Dl.readyState=0<sl?4:0,Xn=200<=sl&&sl<300||sl===304,Kr&&(mi=function(vn,zr,_n){for(var mo,Er,sr,Or,Cn=vn.contents,_l=vn.dataTypes;_l[0]==="*";)_l.shift(),mo===void 0&&(mo=vn.mimeType||zr.getResponseHeader("Content-Type"));if(mo){for(Er in Cn)if(Cn[Er]&&Cn[Er].test(mo)){_l.unshift(Er);break}}if(_l[0]in _n)sr=_l[0];else{for(Er in _n){if(!_l[0]||vn.converters[Er+" "+_l[0]]){sr=Er;break}Or=Or||Er}sr=sr||Or}return sr?(sr!==_l[0]&&_l.unshift(sr),_n[sr]):void 0}(Pe,Dl,Kr)),mi=function(vn,zr,_n,mo){var Er,sr,Or,Cn,_l,rr={},Pn=vn.dataTypes.slice();if(Pn[1])for(Or in vn.converters)rr[Or.toLowerCase()]=vn.converters[Or];for(sr=Pn.shift();sr;)if(vn.responseFields[sr]&&(_n[vn.responseFields[sr]]=zr),!_l&&mo&&vn.dataFilter&&(zr=vn.dataFilter(zr,vn.dataType)),_l=sr,sr=Pn.shift()){if(sr==="*")sr=_l;else if(_l!=="*"&&_l!==sr){if(!(Or=rr[_l+" "+sr]||rr["* "+sr])){for(Er in rr)if(Cn=Er.split(" "),Cn[1]===sr&&(Or=rr[_l+" "+Cn[0]]||rr["* "+Cn[0]])){Or===!0?Or=rr[Er]:rr[Er]!==!0&&(sr=Cn[0],Pn.unshift(Cn[1]));break}}if(Or!==!0)if(Or&&vn.throws)zr=Or(zr);else try{zr=Or(zr)}catch(aa){return{state:"parsererror",error:Or?aa:"No conversion from "+_l+" to "+sr}}}}return{state:"success",data:zr}}(Pe,mi,Dl,Xn),Xn?(Pe.ifModified&&((Kr=Dl.getResponseHeader("Last-Modified"))&&(p.lastModified[ne]=Kr),(Kr=Dl.getResponseHeader("etag"))&&(p.etag[ne]=Kr)),sl===204||Pe.type==="HEAD"?Wr="nocontent":sl===304?Wr="notmodified":(Wr=mi.state,ho=mi.data,Xn=!(oa=mi.error))):(oa=Wr,!sl&&Wr||(Wr="error",sl<0&&(sl=0))),Dl.status=sl,Dl.statusText=(kr||Wr)+"",Xn?ut.resolveWith(ie,[ho,Wr,Dl]):ut.rejectWith(ie,[Dl,Wr,oa]),Dl.statusCode(Lt),Lt=void 0,at&&dt.trigger(Xn?"ajaxSuccess":"ajaxError",[Dl,Pe,Xn?ho:oa]),bt.fireWith(ie,[Dl,Wr]),at&&(dt.trigger("ajaxComplete",[Dl,Pe]),--p.active||p.event.trigger("ajaxStop")))}return Dl},getJSON:function(H,G,ee){return p.get(H,G,ee,"json")},getScript:function(H,G){return p.get(H,void 0,G,"script")}}),p.each(["get","post"],function(H,G){p[G]=function(ee,ne,ce,ge){return p.isFunction(ne)&&(ge=ge||ce,ce=ne,ne=void 0),p.ajax(p.extend({url:ee,type:G,dataType:ge,data:ne,success:ce},p.isPlainObject(ee)&&ee))}}),p._evalUrl=function(H){return p.ajax({url:H,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},p.fn.extend({wrapAll:function(H){var G;return p.isFunction(H)?this.each(function(ee){p(this).wrapAll(H.call(this,ee))}):(this[0]&&(G=p(H,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&G.insertBefore(this[0]),G.map(function(){for(var ee=this;ee.firstElementChild;)ee=ee.firstElementChild;return ee}).append(this)),this)},wrapInner:function(H){return p.isFunction(H)?this.each(function(G){p(this).wrapInner(H.call(this,G))}):this.each(function(){var G=p(this),ee=G.contents();ee.length?ee.wrapAll(H):G.append(H)})},wrap:function(H){var G=p.isFunction(H);return this.each(function(ee){p(this).wrapAll(G?H.call(this,ee):H)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)}).end()}}),p.expr.filters.hidden=function(H){return!p.expr.filters.visible(H)},p.expr.filters.visible=function(H){return 0<H.offsetWidth||0<H.offsetHeight||0<H.getClientRects().length};var Uh=/%20/g,Gh=/\[\]$/,lf=/\r?\n/g,Fr=/^(?:submit|button|image|reset|file)$/i,_r=/^(?:input|select|textarea|keygen)/i;p.param=function(H,G){function ee(ge,Ae){Ae=p.isFunction(Ae)?Ae():Ae??"",ce[ce.length]=encodeURIComponent(ge)+"="+encodeURIComponent(Ae)}var ne,ce=[];if(G===void 0&&(G=p.ajaxSettings&&p.ajaxSettings.traditional),p.isArray(H)||H.jquery&&!p.isPlainObject(H))p.each(H,function(){ee(this.name,this.value)});else for(ne in H)(function ge(Ae,Je,at,ze){if(p.isArray(Je))p.each(Je,function(ie,dt){at||Gh.test(Ae)?ze(Ae,dt):ge(Ae+"["+(typeof dt=="object"&&dt!=null?ie:"")+"]",dt,at,ze)});else if(at||p.type(Je)!=="object")ze(Ae,Je);else for(var Pe in Je)ge(Ae+"["+Pe+"]",Je[Pe],at,ze)})(ne,H[ne],G,ee);return ce.join("&").replace(Uh,"+")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var H=p.prop(this,"elements");return H?p.makeArray(H):this}).filter(function(){var H=this.type;return this.name&&!p(this).is(":disabled")&&_r.test(this.nodeName)&&!Fr.test(H)&&(this.checked||!Me.test(H))}).map(function(H,G){var ee=p(this).val();return ee==null?null:p.isArray(ee)?p.map(ee,function(ne){return{name:G.name,value:ne.replace(lf,`\r
`)}}):{name:G.name,value:ee.replace(lf,`\r
`)}}).get()}}),p.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(H){}};var Yh={0:200,1223:204},is=p.ajaxSettings.xhr();b.cors=!!is&&"withCredentials"in is,b.ajax=is=!!is,p.ajaxTransport(function(H){var G,ee;return b.cors||is&&!H.crossDomain?{send:function(ne,ce){var ge,Ae=H.xhr();if(Ae.open(H.type,H.url,H.async,H.username,H.password),H.xhrFields)for(ge in H.xhrFields)Ae[ge]=H.xhrFields[ge];for(ge in H.mimeType&&Ae.overrideMimeType&&Ae.overrideMimeType(H.mimeType),H.crossDomain||ne["X-Requested-With"]||(ne["X-Requested-With"]="XMLHttpRequest"),ne)Ae.setRequestHeader(ge,ne[ge]);G=function(Je){return function(){G&&(G=ee=Ae.onload=Ae.onerror=Ae.onabort=Ae.onreadystatechange=null,Je==="abort"?Ae.abort():Je==="error"?typeof Ae.status!="number"?ce(0,"error"):ce(Ae.status,Ae.statusText):ce(Yh[Ae.status]||Ae.status,Ae.statusText,(Ae.responseType||"text")!=="text"||typeof Ae.responseText!="string"?{binary:Ae.response}:{text:Ae.responseText},Ae.getAllResponseHeaders()))}},Ae.onload=G(),ee=Ae.onerror=G("error"),Ae.onabort!==void 0?Ae.onabort=ee:Ae.onreadystatechange=function(){Ae.readyState===4&&e.setTimeout(function(){G&&ee()})},G=G("abort");try{Ae.send(H.hasContent&&H.data||null)}catch(Je){if(G)throw Je}},abort:function(){G&&G()}}:void 0}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(H){return p.globalEval(H),H}}}),p.ajaxPrefilter("script",function(H){H.cache===void 0&&(H.cache=!1),H.crossDomain&&(H.type="GET")}),p.ajaxTransport("script",function(H){var G,ee;if(H.crossDomain)return{send:function(ne,ce){G=p("<script>").prop({charset:H.scriptCharset,src:H.url}).on("load error",ee=function(ge){G.remove(),ee=null,ge&&ce(ge.type==="error"?404:200,ge.type)}),o.head.appendChild(G[0])},abort:function(){ee&&ee()}}});var rf=[],rn=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var H=rf.pop()||p.expando+"_"+rs++;return this[H]=!0,H}}),p.ajaxPrefilter("json jsonp",function(H,G,ee){var ne,ce,ge,Ae=H.jsonp!==!1&&(rn.test(H.url)?"url":typeof H.data=="string"&&(H.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&rn.test(H.data)&&"data");return Ae||H.dataTypes[0]==="jsonp"?(ne=H.jsonpCallback=p.isFunction(H.jsonpCallback)?H.jsonpCallback():H.jsonpCallback,Ae?H[Ae]=H[Ae].replace(rn,"$1"+ne):H.jsonp!==!1&&(H.url+=(Ls.test(H.url)?"&":"?")+H.jsonp+"="+ne),H.converters["script json"]=function(){return ge||p.error(ne+" was not called"),ge[0]},H.dataTypes[0]="json",ce=e[ne],e[ne]=function(){ge=arguments},ee.always(function(){ce===void 0?p(e).removeProp(ne):e[ne]=ce,H[ne]&&(H.jsonpCallback=G.jsonpCallback,rf.push(ne)),ge&&p.isFunction(ce)&&ce(ge[0]),ge=ce=void 0}),"script"):void 0}),p.parseHTML=function(H,G,ee){if(!H||typeof H!="string")return null;typeof G=="boolean"&&(ee=G,G=!1),G=G||o;var ne=w.exec(H),ee=!ee&&[];return ne?[G.createElement(ne[1])]:(ne=vt([H],G,ee),ee&&ee.length&&p(ee).remove(),p.merge([],ne.childNodes))};var Xc=p.fn.load;function Vs(H){return p.isWindow(H)?H:H.nodeType===9&&H.defaultView}p.fn.load=function(H,G,ee){if(typeof H!="string"&&Xc)return Xc.apply(this,arguments);var ne,ce,ge,Ae=this,Je=H.indexOf(" ");return-1<Je&&(ne=p.trim(H.slice(Je)),H=H.slice(0,Je)),p.isFunction(G)?(ee=G,G=void 0):G&&typeof G=="object"&&(ce="POST"),0<Ae.length&&p.ajax({url:H,type:ce||"GET",dataType:"html",data:G}).done(function(at){ge=arguments,Ae.html(ne?p("<div>").append(p.parseHTML(at)).find(ne):at)}).always(ee&&function(at,ze){Ae.each(function(){ee.apply(this,ge||[at.responseText,ze,at])})}),this},p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(H,G){p.fn[G]=function(ee){return this.on(G,ee)}}),p.expr.filters.animated=function(H){return p.grep(p.timers,function(G){return H===G.elem}).length},p.offset={setOffset:function(H,G,ee){var ne,ce,ge,Ae,Je=p.css(H,"position"),at=p(H),ze={};Je==="static"&&(H.style.position="relative"),ge=at.offset(),ne=p.css(H,"top"),Ae=p.css(H,"left"),Ae=(Je==="absolute"||Je==="fixed")&&-1<(ne+Ae).indexOf("auto")?(ce=(Je=at.position()).top,Je.left):(ce=parseFloat(ne)||0,parseFloat(Ae)||0),p.isFunction(G)&&(G=G.call(H,ee,p.extend({},ge))),G.top!=null&&(ze.top=G.top-ge.top+ce),G.left!=null&&(ze.left=G.left-ge.left+Ae),"using"in G?G.using.call(H,ze):at.css(ze)}},p.fn.extend({offset:function(H){if(arguments.length)return H===void 0?this:this.each(function(ge){p.offset.setOffset(this,H,ge)});var G,ee=this[0],ne={top:0,left:0},ce=ee&&ee.ownerDocument;return ce?(G=ce.documentElement,p.contains(G,ee)?(ne=ee.getBoundingClientRect(),ce=Vs(ce),{top:ne.top+ce.pageYOffset-G.clientTop,left:ne.left+ce.pageXOffset-G.clientLeft}):ne):void 0},position:function(){if(this[0]){var H,G,ee=this[0],ne={top:0,left:0};return p.css(ee,"position")==="fixed"?G=ee.getBoundingClientRect():(H=this.offsetParent(),G=this.offset(),p.nodeName(H[0],"html")||(ne=H.offset()),ne.top+=p.css(H[0],"borderTopWidth",!0),ne.left+=p.css(H[0],"borderLeftWidth",!0)),{top:G.top-ne.top-p.css(ee,"marginTop",!0),left:G.left-ne.left-p.css(ee,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var H=this.offsetParent;H&&p.css(H,"position")==="static";)H=H.offsetParent;return H||wl})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(H,G){var ee=G==="pageYOffset";p.fn[H]=function(ne){return le(this,function(ce,ge,Ae){var Je=Vs(ce);return Ae===void 0?Je?Je[G]:ce[ge]:void(Je?Je.scrollTo(ee?Je.pageXOffset:Ae,ee?Ae:Je.pageYOffset):ce[ge]=Ae)},H,ne,arguments.length)}}),p.each(["top","left"],function(H,G){p.cssHooks[G]=sn(b.pixelPosition,function(ee,ne){return ne?(ne=Wl(ee,G),Jt.test(ne)?p(ee).position()[G]+"px":ne):void 0})}),p.each({Height:"height",Width:"width"},function(H,G){p.each({padding:"inner"+H,content:G,"":"outer"+H},function(ee,ne){p.fn[ne]=function(ce,ge){var Ae=arguments.length&&(ee||typeof ce!="boolean"),Je=ee||(ce===!0||ge===!0?"margin":"border");return le(this,function(at,ze,Pe){var ie;return p.isWindow(at)?at.document.documentElement["client"+H]:at.nodeType===9?(ie=at.documentElement,Math.max(at.body["scroll"+H],ie["scroll"+H],at.body["offset"+H],ie["offset"+H],ie["client"+H])):Pe===void 0?p.css(at,ze,Je):p.style(at,ze,Pe,Je)},G,Ae?ce:void 0,Ae,null)}})}),p.fn.extend({bind:function(H,G,ee){return this.on(H,null,G,ee)},unbind:function(H,G){return this.off(H,null,G)},delegate:function(H,G,ee,ne){return this.on(G,H,ee,ne)},undelegate:function(H,G,ee){return arguments.length===1?this.off(H,"**"):this.off(G,H||"**",ee)},size:function(){return this.length}}),p.fn.andSelf=p.fn.addBack,typeof define=="function"&&define.amd&&define("jquery",[],function(){return p});var nf=e.jQuery,of=e.$;return p.noConflict=function(H){return e.$===p&&(e.$=of),H&&e.jQuery===p&&(e.jQuery=nf),p},n||(e.jQuery=e.$=p),p}),function(e,n){typeof kn=="object"&&typeof In!="undefined"?n(kn):typeof define=="function"&&define.amd?define(["exports"],n):n((e=typeof globalThis!="undefined"?globalThis:e||self).uuid={})}(kn,function(e){"use strict";var n,t=new Uint8Array(16);function l(){if(!n&&!(n=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(t)}var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function a(T){return typeof T=="string"&&o.test(T)}for(var s,u,f=[],m=0;m<256;++m)f.push((m+256).toString(16).substr(1));function d(T){var z=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,z=(f[T[z+0]]+f[T[z+1]]+f[T[z+2]]+f[T[z+3]]+"-"+f[T[z+4]]+f[T[z+5]]+"-"+f[T[z+6]]+f[T[z+7]]+"-"+f[T[z+8]]+f[T[z+9]]+"-"+f[T[z+10]]+f[T[z+11]]+f[T[z+12]]+f[T[z+13]]+f[T[z+14]]+f[T[z+15]]).toLowerCase();if(!a(z))throw TypeError("Stringified UUID is invalid");return z}var g=0,b=0;function y(T){if(!a(T))throw TypeError("Invalid UUID");var z,A=new Uint8Array(16);return A[0]=(z=parseInt(T.slice(0,8),16))>>>24,A[1]=z>>>16&255,A[2]=z>>>8&255,A[3]=255&z,A[4]=(z=parseInt(T.slice(9,13),16))>>>8,A[5]=255&z,A[6]=(z=parseInt(T.slice(14,18),16))>>>8,A[7]=255&z,A[8]=(z=parseInt(T.slice(19,23),16))>>>8,A[9]=255&z,A[10]=(z=parseInt(T.slice(24,36),16))/1099511627776&255,A[11]=z/4294967296&255,A[12]=z>>>24&255,A[13]=z>>>16&255,A[14]=z>>>8&255,A[15]=255&z,A}function p(T,z,A){function M(P,N,E,B){if(typeof P=="string"&&(P=function(le){le=unescape(encodeURIComponent(le));for(var he=[],Z=0;Z<le.length;++Z)he.push(le.charCodeAt(Z));return he}(P)),typeof N=="string"&&(N=y(N)),N.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var U=new Uint8Array(16+P.length);if(U.set(N),U.set(P,N.length),(U=A(U))[6]=15&U[6]|z,U[8]=63&U[8]|128,E){B=B||0;for(var X=0;X<16;++X)E[B+X]=U[X];return E}return d(U)}try{M.name=T}catch(P){}return M.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",M.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",M}function x(T){return 14+(T+64>>>9<<4)+1}function _(T,z){var A=(65535&T)+(65535&z);return(T>>16)+(z>>16)+(A>>16)<<16|65535&A}function S(T,z,A,M,P,N){return _((N=_(_(z,T),_(M,N)))<<P|N>>>32-P,A)}function I(T,z,A,M,P,N,E){return S(z&A|~z&M,T,z,P,N,E)}function O(T,z,A,M,P,N,E){return S(z&M|A&~M,T,z,P,N,E)}function F(T,z,A,M,P,N,E){return S(z^A^M,T,z,P,N,E)}function D(T,z,A,M,P,N,E){return S(A^(z|~M),T,z,P,N,E)}var k=p("v3",48,function(T){if(typeof T=="string"){var z=unescape(encodeURIComponent(T));T=new Uint8Array(z.length);for(var A=0;A<z.length;++A)T[A]=z.charCodeAt(A)}return function(M){for(var P=[],N=32*M.length,E="0123456789abcdef",B=0;B<N;B+=8){var U=M[B>>5]>>>B%32&255,U=parseInt(E.charAt(U>>>4&15)+E.charAt(15&U),16);P.push(U)}return P}(function(M,P){M[P>>5]|=128<<P%32,M[x(P)-1]=P;for(var N=1732584193,E=-271733879,B=-1732584194,U=271733878,X=0;X<M.length;X+=16){var le=N,he=E,Z=B,ae=U,N=I(N,E,B,U,M[X],7,-680876936),U=I(U,N,E,B,M[X+1],12,-389564586),B=I(B,U,N,E,M[X+2],17,606105819),E=I(E,B,U,N,M[X+3],22,-1044525330);N=I(N,E,B,U,M[X+4],7,-176418897),U=I(U,N,E,B,M[X+5],12,1200080426),B=I(B,U,N,E,M[X+6],17,-1473231341),E=I(E,B,U,N,M[X+7],22,-45705983),N=I(N,E,B,U,M[X+8],7,1770035416),U=I(U,N,E,B,M[X+9],12,-1958414417),B=I(B,U,N,E,M[X+10],17,-42063),E=I(E,B,U,N,M[X+11],22,-1990404162),N=I(N,E,B,U,M[X+12],7,1804603682),U=I(U,N,E,B,M[X+13],12,-40341101),B=I(B,U,N,E,M[X+14],17,-1502002290),N=O(N,E=I(E,B,U,N,M[X+15],22,1236535329),B,U,M[X+1],5,-165796510),U=O(U,N,E,B,M[X+6],9,-1069501632),B=O(B,U,N,E,M[X+11],14,643717713),E=O(E,B,U,N,M[X],20,-373897302),N=O(N,E,B,U,M[X+5],5,-701558691),U=O(U,N,E,B,M[X+10],9,38016083),B=O(B,U,N,E,M[X+15],14,-660478335),E=O(E,B,U,N,M[X+4],20,-405537848),N=O(N,E,B,U,M[X+9],5,568446438),U=O(U,N,E,B,M[X+14],9,-1019803690),B=O(B,U,N,E,M[X+3],14,-187363961),E=O(E,B,U,N,M[X+8],20,1163531501),N=O(N,E,B,U,M[X+13],5,-1444681467),U=O(U,N,E,B,M[X+2],9,-51403784),B=O(B,U,N,E,M[X+7],14,1735328473),N=F(N,E=O(E,B,U,N,M[X+12],20,-1926607734),B,U,M[X+5],4,-378558),U=F(U,N,E,B,M[X+8],11,-2022574463),B=F(B,U,N,E,M[X+11],16,1839030562),E=F(E,B,U,N,M[X+14],23,-35309556),N=F(N,E,B,U,M[X+1],4,-1530992060),U=F(U,N,E,B,M[X+4],11,1272893353),B=F(B,U,N,E,M[X+7],16,-155497632),E=F(E,B,U,N,M[X+10],23,-1094730640),N=F(N,E,B,U,M[X+13],4,681279174),U=F(U,N,E,B,M[X],11,-358537222),B=F(B,U,N,E,M[X+3],16,-722521979),E=F(E,B,U,N,M[X+6],23,76029189),N=F(N,E,B,U,M[X+9],4,-640364487),U=F(U,N,E,B,M[X+12],11,-421815835),B=F(B,U,N,E,M[X+15],16,530742520),N=D(N,E=F(E,B,U,N,M[X+2],23,-995338651),B,U,M[X],6,-198630844),U=D(U,N,E,B,M[X+7],10,1126891415),B=D(B,U,N,E,M[X+14],15,-1416354905),E=D(E,B,U,N,M[X+5],21,-57434055),N=D(N,E,B,U,M[X+12],6,1700485571),U=D(U,N,E,B,M[X+3],10,-1894986606),B=D(B,U,N,E,M[X+10],15,-1051523),E=D(E,B,U,N,M[X+1],21,-2054922799),N=D(N,E,B,U,M[X+8],6,1873313359),U=D(U,N,E,B,M[X+15],10,-30611744),B=D(B,U,N,E,M[X+6],15,-1560198380),E=D(E,B,U,N,M[X+13],21,1309151649),N=D(N,E,B,U,M[X+4],6,-145523070),U=D(U,N,E,B,M[X+11],10,-1120210379),B=D(B,U,N,E,M[X+2],15,718787259),E=D(E,B,U,N,M[X+9],21,-343485551),N=_(N,le),E=_(E,he),B=_(B,Z),U=_(U,ae)}return[N,E,B,U]}(function(M){if(M.length===0)return[];for(var P=8*M.length,N=new Uint32Array(x(P)),E=0;E<P;E+=8)N[E>>5]|=(255&M[E/8])<<E%32;return N}(T),8*T.length))});function w(T,z){return T<<z|T>>>32-z}var C=p("v5",80,function(T){var z=[1518500249,1859775393,2400959708,3395469782],A=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof T=="string"){var M=unescape(encodeURIComponent(T));T=[];for(var P=0;P<M.length;++P)T.push(M.charCodeAt(P))}else Array.isArray(T)||(T=Array.prototype.slice.call(T));T.push(128);for(var N=T.length/4+2,E=Math.ceil(N/16),B=new Array(E),U=0;U<E;++U){for(var X=new Uint32Array(16),le=0;le<16;++le)X[le]=T[64*U+4*le]<<24|T[64*U+4*le+1]<<16|T[64*U+4*le+2]<<8|T[64*U+4*le+3];B[U]=X}B[E-1][14]=8*(T.length-1)/Math.pow(2,32),B[E-1][14]=Math.floor(B[E-1][14]),B[E-1][15]=8*(T.length-1)&4294967295;for(var he=0;he<E;++he){for(var Z=new Uint32Array(80),ae=0;ae<16;++ae)Z[ae]=B[he][ae];for(var J=16;J<80;++J)Z[J]=w(Z[J-3]^Z[J-8]^Z[J-14]^Z[J-16],1);for(var pe=A[0],K=A[1],se=A[2],te=A[3],re=A[4],fe=0;fe<80;++fe)var Me=Math.floor(fe/20),Me=w(pe,5)+function(ye,Ye,Ce,Ke){switch(ye){case 0:return Ye&Ce^~Ye&Ke;case 1:return Ye^Ce^Ke;case 2:return Ye&Ce^Ye&Ke^Ce&Ke;case 3:return Ye^Ce^Ke}}(Me,K,se,te)+re+z[Me]+Z[fe]>>>0,re=te,te=se,se=w(K,30)>>>0,K=pe,pe=Me;A[0]=A[0]+pe>>>0,A[1]=A[1]+K>>>0,A[2]=A[2]+se>>>0,A[3]=A[3]+te>>>0,A[4]=A[4]+re>>>0}return[A[0]>>24&255,A[0]>>16&255,A[0]>>8&255,255&A[0],A[1]>>24&255,A[1]>>16&255,A[1]>>8&255,255&A[1],A[2]>>24&255,A[2]>>16&255,A[2]>>8&255,255&A[2],A[3]>>24&255,A[3]>>16&255,A[3]>>8&255,255&A[3],A[4]>>24&255,A[4]>>16&255,A[4]>>8&255,255&A[4]]});e.NIL="00000000-0000-0000-0000-000000000000",e.parse=y,e.stringify=d,e.v1=function(T,z,A){var M=z&&A||0,P=z||new Array(16),N=(T=T||{}).node||s,E=T.clockseq!==void 0?T.clockseq:u;N!=null&&E!=null||(U=T.random||(T.rng||l)(),N==null&&(N=s=[1|U[0],U[1],U[2],U[3],U[4],U[5]]),E==null&&(E=u=16383&(U[6]<<8|U[7])));var B=T.msecs!==void 0?T.msecs:Date.now(),A=T.nsecs!==void 0?T.nsecs:b+1,U=B-g+(A-b)/1e4;if(U<0&&T.clockseq===void 0&&(E=E+1&16383),(U<0||g<B)&&T.nsecs===void 0&&(A=0),1e4<=A)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g=B,u=E,A=(1e4*(268435455&(B+=122192928e5))+(b=A))%4294967296,P[M++]=A>>>24&255,P[M++]=A>>>16&255,P[M++]=A>>>8&255,P[M++]=255&A,B=B/4294967296*1e4&268435455,P[M++]=B>>>8&255,P[M++]=255&B,P[M++]=B>>>24&15|16,P[M++]=B>>>16&255,P[M++]=E>>>8|128,P[M++]=255&E;for(var X=0;X<6;++X)P[M+X]=N[X];return z||d(P)},e.v3=k,e.v4=function(T,z,A){var M=(T=T||{}).random||(T.rng||l)();if(M[6]=15&M[6]|64,M[8]=63&M[8]|128,z){A=A||0;for(var P=0;P<16;++P)z[A+P]=M[P];return z}return d(M)},e.v5=C,e.validate=a,e.version=function(T){if(!a(T))throw TypeError("Invalid UUID");return parseInt(T.substr(14,1),16)},Object.defineProperty(e,"__esModule",{value:!0})}),function(e,n){typeof kn=="object"&&typeof In=="object"?In.exports=n():typeof define=="function"&&define.amd?define([],n):typeof kn=="object"?kn.clipboard=n():e.clipboard=n()}(kn,function(){return t={},e.m=n=[function(l,o,a){"use strict";function s(D){var k=new F,D=function(w,C,T){x("listener called"),w.success=!0,C.forEach(function(z,A){T.clipboardData.setData(A,z),A===I&&T.clipboardData.getData(A)!=z&&(x("setting text/plain failed"),w.success=!1)}),T.preventDefault()}.bind(this,k,D);document.addEventListener("copy",D);try{document.execCommand("copy")}finally{document.removeEventListener("copy",D)}return k.success}function u(D,k){return f(D),k=s(k),m(),k}function f(D){var k=document.getSelection(),w=document.createRange();w.selectNodeContents(D),k.removeAllRanges(),k.addRange(w)}function m(){document.getSelection().removeAllRanges()}function d(){return typeof ClipboardEvent=="undefined"&&window.clipboardData!==void 0&&window.clipboardData.setData!==void 0}function g(){return new p(function(D,k){var w=window.clipboardData.getData("Text");w===""?k(new Error("Empty clipboard or could not read plain text from clipboard")):D(w)})}Object.defineProperty(o,"__esModule",{value:!0});var b=a(1),y=a(5),p=typeof Promise=="undefined"?b.Promise:Promise,x=function(D){},_=!0,S=function(){(console.warn||console.log).call(arguments)}.bind(console,"[clipboard-polyfill]"),I="text/plain",b=(O.setDebugLog=function(D){x=D},O.suppressWarnings=function(){_=!1,y.suppressDTWarnings()},O.write=function(D){return _&&!D.getData(I)&&S("clipboard.write() was called without a `text/plain` data type. On some platforms, this may result in an empty clipboard. Call clipboard.suppressWarnings() to suppress this warning."),new p(function(k,w){if(d())(function(z){if((z=z.getData(I))!==void 0)return window.clipboardData.setData("Text",z);throw"No `text/plain` value was specified."})(D)?k():w(new Error("Copying failed, possibly because the user rejected it."));else{if(s(D))return x("regular execCopy worked"),void k();if(-1<navigator.userAgent.indexOf("Edge"))return x('UA "Edge" => assuming success'),void k();if(u(document.body,D))return x("copyUsingTempSelection worked"),void k();if(T=D,(C=document.createElement("div")).setAttribute("style","-webkit-user-select: text !important"),C.textContent="temporary element",document.body.appendChild(C),T=u(C,T),document.body.removeChild(C),T)return x("copyUsingTempElem worked"),void k();var C,T=D.getData(I);if(T!==void 0&&function(z){x("copyTextUsingDOM");var A=document.createElement("div");A.setAttribute("style","-webkit-user-select: text !important");var M=A;A.attachShadow&&(x("Using shadow DOM."),M=A.attachShadow({mode:"open"}));var P=document.createElement("span");return P.innerText=z,M.appendChild(P),document.body.appendChild(A),f(P),P=document.execCommand("copy"),m(),document.body.removeChild(A),P}(T))return x("copyTextUsingDOM worked"),void k();w(new Error("Copy command failed."))}})},O.writeText=function(D){if(navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(D);var k=new y.DT;return k.setData(I,D),this.write(k)},O.read=function(){return new p(function(D,k){d()?g().then(function(w){return D((C=w,(w=new y.DT).setData(I,C),w));var C},k):k("Read is not supported in your browser.")})},O.readText=function(){return navigator.clipboard&&navigator.clipboard.readText?navigator.clipboard.readText():d()?g():new p(function(D,k){k("Read is not supported in your browser.")})},O.DT=y.DT,O);function O(){}o.default=b;var F=function(){this.success=!1};l.exports=b},function(l,o,a){(function(s,u){l.exports=function(){"use strict";function f(ve){var Ge=typeof ve;return ve!==null&&(Ge==="object"||Ge==="function")}function m(ve){return typeof ve=="function"}function d(ve){Ke=ve}function g(ve){ft=ve}function b(){return Ce!==void 0?function(){Ce(p)}:y()}function y(){var ve=setTimeout;return function(){return ve(p,1)}}function p(){for(var ve=0;ve<Ye;ve+=2)(0,me[ve])(me[ve+1]),me[ve]=void 0,me[ve+1]=void 0;Ye=0}function x(ve,Ge){var Ue=arguments,We=this,it=new this.constructor(S);it[Te]===void 0&&he(it);var St=We._state;return St?function(){var Kt=Ue[St-1];ft(function(){return U(St,it,Kt,We._result)})}():P(We,it,ve,Ge),it}function _(ve){var Ge=this;if(ve&&typeof ve=="object"&&ve.constructor===Ge)return ve;var Ue=new Ge(S);return T(Ue,ve),Ue}function S(){}function I(){return new TypeError("You cannot resolve a promise with itself")}function O(){return new TypeError("A promises callback cannot return that same promise.")}function F(ve){try{return ve.then}catch(Ge){return Ze.error=Ge,Ze}}function D(ve,Ge,Ue,We){try{ve.call(Ge,Ue,We)}catch(it){return it}}function k(ve,Ge,Ue){ft(function(We){var it=!1,St=D(Ue,Ge,function(Kt){it||(it=!0,Ge!==Kt?T(We,Kt):A(We,Kt))},function(Kt){it||(it=!0,M(We,Kt))},"Settle: "+(We._label||" unknown promise"));!it&&St&&(it=!0,M(We,St))},ve)}function w(ve,Ge){Ge._state===De?A(ve,Ge._result):Ge._state===Fe?M(ve,Ge._result):P(Ge,void 0,function(Ue){return T(ve,Ue)},function(Ue){return M(ve,Ue)})}function C(ve,Ge,Ue){Ge.constructor===ve.constructor&&Ue===x&&Ge.constructor.resolve===_?w(ve,Ge):Ue===Ze?(M(ve,Ze.error),Ze.error=null):Ue===void 0?A(ve,Ge):m(Ue)?k(ve,Ge,Ue):A(ve,Ge)}function T(ve,Ge){ve===Ge?M(ve,I()):f(Ge)?C(ve,Ge,F(Ge)):A(ve,Ge)}function z(ve){ve._onerror&&ve._onerror(ve._result),N(ve)}function A(ve,Ge){ve._state===je&&(ve._result=Ge,ve._state=De,ve._subscribers.length!==0&&ft(N,ve))}function M(ve,Ge){ve._state===je&&(ve._state=Fe,ve._result=Ge,ft(z,ve))}function P(ve,Ge,Ue,We){var it=ve._subscribers,St=it.length;ve._onerror=null,it[St]=Ge,it[St+De]=Ue,it[St+Fe]=We,St===0&&ve._state&&ft(N,ve)}function N(ve){var Ge=ve._subscribers,Ue=ve._state;if(Ge.length!==0){for(var We=void 0,it=void 0,St=ve._result,Kt=0;Kt<Ge.length;Kt+=3)We=Ge[Kt],it=Ge[Kt+Ue],We?U(Ue,We,it,St):it(St);ve._subscribers.length=0}}function E(){this.error=null}function B(ve,Ge){try{return ve(Ge)}catch(Ue){return Ve.error=Ue,Ve}}function U(ve,Ge,Ue,We){var it=m(Ue),St=void 0,Kt=void 0,bl=void 0,hl=void 0;if(it){if(St=B(Ue,We),St===Ve?(hl=!0,Kt=St.error,St.error=null):bl=!0,Ge===St)return void M(Ge,O())}else St=We,bl=!0;Ge._state!==je||(it&&bl?T(Ge,St):hl?M(Ge,Kt):ve===De?A(Ge,St):ve===Fe&&M(Ge,St))}function X(ve,Ge){try{Ge(function(Ue){T(ve,Ue)},function(Ue){M(ve,Ue)})}catch(Ue){M(ve,Ue)}}function le(){return Ie++}function he(ve){ve[Te]=Ie++,ve._state=void 0,ve._result=void 0,ve._subscribers=[]}function Z(ve,Ge){this._instanceConstructor=ve,this.promise=new ve(S),this.promise[Te]||he(this.promise),ye(Ge)?(this.length=Ge.length,this._remaining=Ge.length,this._result=new Array(this.length),this.length===0?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(Ge),this._remaining===0&&A(this.promise,this._result))):M(this.promise,ae())}function ae(){return new Error("Array Methods must be provided an Array")}function J(ve){return new Z(this,ve).promise}function pe(ve){var Ge=this;return new Ge(ye(ve)?function(Ue,We){for(var it=ve.length,St=0;St<it;St++)Ge.resolve(ve[St]).then(Ue,We)}:function(Ue,We){return We(new TypeError("You must pass an array to race."))})}function K(ve){var Ge=this,Ue=new Ge(S);return M(Ue,ve),Ue}function se(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function te(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function re(ve){this[Te]=le(),this._result=this._state=void 0,this._subscribers=[],S!==ve&&(typeof ve!="function"&&se(),this instanceof re?X(this,ve):te())}function fe(){var ve=void 0;if(u!==void 0)ve=u;else if(typeof self!="undefined")ve=self;else try{ve=Function("return this")()}catch(We){throw new Error("polyfill failed because global object is unavailable in this environment")}var Ge=ve.Promise;if(Ge){var Ue=null;try{Ue=Object.prototype.toString.call(Ge.resolve())}catch(We){}if(Ue==="[object Promise]"&&!Ge.cast)return}ve.Promise=re}var Me=void 0,ye=Me=Array.isArray?Array.isArray:function(ve){return Object.prototype.toString.call(ve)==="[object Array]"},Ye=0,Ce=void 0,Ke=void 0,ft=function(ve,Ge){me[Ye]=ve,me[Ye+1]=Ge,(Ye+=2)===2&&(Ke?Ke(p):xe())},et=typeof window!="undefined"?window:void 0,vt=et||{},wt=vt.MutationObserver||vt.WebKitMutationObserver,be=typeof self=="undefined"&&s!==void 0&&{}.toString.call(s)==="[object process]",Q=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined",me=new Array(1e3),xe=void 0;xe=be?function(){return function(){return s.nextTick(p)}}():wt?function(){var ve=0,Ge=new wt(p),Ue=document.createTextNode("");return Ge.observe(Ue,{characterData:!0}),function(){Ue.data=ve=++ve%2}}():Q?function(){var ve=new MessageChannel;return ve.port1.onmessage=p,function(){return ve.port2.postMessage(0)}}():et===void 0?function(){try{var ve=a(4);return Ce=ve.runOnLoop||ve.runOnContext,b()}catch(Ge){return y()}}():y();var Te=Math.random().toString(36).substring(16),je=void 0,De=1,Fe=2,Ze=new E,Ve=new E,Ie=0;return Z.prototype._enumerate=function(ve){for(var Ge=0;this._state===je&&Ge<ve.length;Ge++)this._eachEntry(ve[Ge],Ge)},Z.prototype._eachEntry=function(ve,Ge){var Ue=this._instanceConstructor,We=Ue.resolve;if(We===_){var it=F(ve);if(it===x&&ve._state!==je)this._settledAt(ve._state,Ge,ve._result);else if(typeof it!="function")this._remaining--,this._result[Ge]=ve;else if(Ue===re){var St=new Ue(S);C(St,ve,it),this._willSettleAt(St,Ge)}else this._willSettleAt(new Ue(function(Kt){return Kt(ve)}),Ge)}else this._willSettleAt(We(ve),Ge)},Z.prototype._settledAt=function(ve,Ge,Ue){var We=this.promise;We._state===je&&(this._remaining--,ve===Fe?M(We,Ue):this._result[Ge]=Ue),this._remaining===0&&A(We,this._result)},Z.prototype._willSettleAt=function(ve,Ge){var Ue=this;P(ve,void 0,function(We){return Ue._settledAt(De,Ge,We)},function(We){return Ue._settledAt(Fe,Ge,We)})},re.all=J,re.race=pe,re.resolve=_,re.reject=K,re._setScheduler=d,re._setAsap=g,re._asap=ft,re.prototype={constructor:re,then:x,catch:function(ve){return this.then(null,ve)}},re.polyfill=fe,re.Promise=re}()}).call(o,a(2),a(3))},function(l,o){function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(I){if(b===setTimeout)return setTimeout(I,0);if((b===a||!b)&&setTimeout)return b=setTimeout,setTimeout(I,0);try{return b(I,0)}catch(O){try{return b.call(null,I,0)}catch(F){return b.call(this,I,0)}}}function f(){_&&p&&(_=!1,p.length?x=p.concat(x):S=-1,x.length&&m())}function m(){if(!_){var I=u(f);_=!0;for(var O=x.length;O;){for(p=x,x=[];++S<O;)p&&p[S].run();S=-1,O=x.length}p=null,_=!1,function(F){if(y===clearTimeout)return clearTimeout(F);if((y===s||!y)&&clearTimeout)return y=clearTimeout,clearTimeout(F);try{y(F)}catch(D){try{return y.call(null,F)}catch(k){return y.call(this,F)}}}(I)}}function d(I,O){this.fun=I,this.array=O}function g(){}var b,y,l=l.exports={};(function(){try{b=typeof setTimeout=="function"?setTimeout:a}catch(I){b=a}try{y=typeof clearTimeout=="function"?clearTimeout:s}catch(I){y=s}})();var p,x=[],_=!1,S=-1;l.nextTick=function(I){var O=new Array(arguments.length-1);if(1<arguments.length)for(var F=1;F<arguments.length;F++)O[F-1]=arguments[F];x.push(new d(I,O)),x.length!==1||_||u(m)},d.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=g,l.addListener=g,l.once=g,l.off=g,l.removeListener=g,l.removeAllListeners=g,l.emit=g,l.prependListener=g,l.prependOnceListener=g,l.listeners=function(I){return[]},l.binding=function(I){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(I){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(l,o){var a=function(){return this}();try{a=a||Function("return this")()||(0,eval)("this")}catch(s){typeof window=="object"&&(a=window)}l.exports=a},function(l,o){},function(l,o,a){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var s=["text/plain","text/html"],u=function(){(console.warn||console.log).call(arguments)}.bind(console,"[clipboard-polyfill]"),f=!0;o.suppressDTWarnings=function(){f=!1};var m=(d.prototype.setData=function(g,b){f&&s.indexOf(g)===-1&&u("Unknown data type: "+g,"Call clipboard.suppressWarnings() to suppress this warning."),this.m[g]=b},d.prototype.getData=function(g){return this.m[g]},d.prototype.forEach=function(g){for(var b in this.m)g(this.m[b],b)},d);function d(){this.m={}}o.DT=m}],e.c=t,e.d=function(l,o,a){e.o(l,o)||Object.defineProperty(l,o,{configurable:!1,enumerable:!0,get:a})},e.n=function(l){var o=l&&l.__esModule?function(){return l.default}:function(){return l};return e.d(o,"a",o),o},e.o=function(l,o){return Object.prototype.hasOwnProperty.call(l,o)},e.p="",e(e.s=0);function e(l){if(t[l])return t[l].exports;var o=t[l]={i:l,l:!1,exports:{}};return n[l].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n,t}),function(e){"use strict";typeof define=="function"&&define.amd?define(["jquery"],e):typeof kn=="object"&&typeof In=="object"?In.exports=e(Wo("jquery")):e(jQuery)}(function(e,n){"use strict";var t,l={beforeShow:b,move:b,change:b,show:b,hide:b,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},o=[],a=!!/msie/i.exec(window.navigator.userAgent),s=((t=document.createElement("div").style).cssText="background-color:rgba(0,0,0,.5)",m(t.backgroundColor,"rgba")||m(t.backgroundColor,"hsla")),u=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),f=function(){var I="";if(a)for(var O=1;O<=6;O++)I+="<div class='sp-"+O+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",I,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input formulaInputFocus' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function m(I,O){return!!~(""+I).indexOf(O)}function d(I,O,F,D){for(var k=[],w=0;w<I.length;w++){var C,T,z,A=I[w];A?(T=(C=tinycolor(A)).toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",T+=tinycolor.equals(O,A)?" sp-thumb-active":"",z=C.toString(D.preferredFormat||"rgb"),A=s?"background-color:"+C.toRgbString():"filter:"+C.toFilter(),k.push('<span title="'+z+'" data-color="'+C.toRgbString()+'" class="'+T+'"><span class="sp-thumb-inner" style="'+A+';" /></span>')):k.push(e("<div />").append(e('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",D.noColorSelectedText)).html())}return"<div class='sp-cf "+F+"'>"+k.join("")+"</div>"}function g(I,O){var F,D,k,w=(k=I,(O=e.extend({},l,O)).callbacks={move:p(O.move,k),change:p(O.change,k),show:p(O.show,k),hide:p(O.hide,k),beforeShow:p(O.beforeShow,k)},O),C=w.flat,T=w.showSelectionPalette,z=w.localStorageKey,O=w.theme,A=w.callbacks,M=(F=oi,function(){var zt=this,tl=arguments;D=D||setTimeout(function(){D=null,F.apply(zt,tl)},10)}),P=!1,N=!1,E=0,B=0,U=0,X=0,le=0,he=0,Z=0,ae=0,J=0,pe=0,K=1,se=[],te=[],re={},fe=w.selectionPalette.slice(0),Me=w.maxSelectionSize,ye="sp-dragging",Ye=null,Ce=I.ownerDocument,Ke=(Ce.body,e(I)),ft=!1,et=e(f,Ce).addClass(O),vt=et.find(".sp-picker-container"),wt=et.find(".sp-color"),be=et.find(".sp-dragger"),Q=et.find(".sp-hue"),me=et.find(".sp-slider"),xe=et.find(".sp-alpha-inner"),Te=et.find(".sp-alpha"),je=et.find(".sp-alpha-handle"),De=et.find(".sp-input"),Fe=et.find(".sp-palette"),Ze=et.find(".sp-initial"),Ve=et.find(".sp-cancel"),Ie=et.find(".sp-clear"),ve=et.find(".sp-choose"),Ge=et.find(".sp-palette-toggle"),Ue=Ke.is("input"),I=Ue&&Ke.attr("type")==="color"&&_(),We=Ue&&!C,it=We?e(u).addClass(O).addClass(w.className).addClass(w.replacerClassName):e([]),St=We?it:Ke,Kt=it.find(".sp-preview-inner"),bl=w.color||Ue&&Ke.val(),hl=!1,Rr=w.preferredFormat,Di=!w.showButtons||w.clickoutFiresChange,ln=!bl,_e=w.allowEmpty&&!I;function Ne(){if(w.showPaletteOnly&&(w.showPalette=!0),Ge.text(w.showPaletteOnly?w.togglePaletteMoreText:w.togglePaletteLessText),w.palette){se=w.palette.slice(0),te=e.isArray(se[0])?se:[se],re={};for(var zt=0;zt<te.length;zt++)for(var tl=0;tl<te[zt].length;tl++){var ul=tinycolor(te[zt][tl]).toRgbString();re[ul]=!0}}et.toggleClass("sp-flat",C),et.toggleClass("sp-input-disabled",!w.showInput),et.toggleClass("sp-alpha-enabled",w.showAlpha),et.toggleClass("sp-clear-enabled",_e),et.toggleClass("sp-buttons-disabled",!w.showButtons),et.toggleClass("sp-palette-buttons-disabled",!w.togglePaletteOnly),et.toggleClass("sp-palette-disabled",!w.showPalette),et.toggleClass("sp-palette-only",w.showPaletteOnly),et.toggleClass("sp-initial-disabled",!w.showInitial),et.addClass(w.className).addClass(w.containerClassName),oi()}function nt(){if(z&&window.localStorage){try{var zt=window.localStorage[z].split(",#");1<zt.length&&(delete window.localStorage[z],e.each(zt,function(tl,ul){mt(ul)}))}catch(tl){}try{fe=window.localStorage[z].split(";")}catch(tl){}}}function mt(zt){if(T){var tl=tinycolor(zt).toRgbString();if(!re[tl]&&e.inArray(tl,fe)===-1)for(fe.push(tl);fe.length>Me;)fe.shift();if(z&&window.localStorage)try{window.localStorage[z]=fe.join(";")}catch(ul){}}}function Ft(){var zt=Dr(),tl=e.map(te,function(ul,Ar){return d(ul,zt,"sp-palette-row sp-palette-row-"+Ar,w)});nt(),fe&&tl.push(d(function(){var ul=[];if(w.showPalette)for(var Ar=0;Ar<fe.length;Ar++){var or=tinycolor(fe[Ar]).toRgbString();re[or]||ul.push(fe[Ar])}return ul.reverse().slice(0,w.maxSelectionSize)}(),zt,"sp-palette-row sp-palette-row-selection",w)),Fe.html(tl.join(""))}function _t(){var zt,tl;w.showInitial&&(zt=hl,tl=Dr(),Ze.html(d([zt,tl],tl,"sp-palette-row-initial",w)))}function Jt(){(B<=0||E<=0||X<=0)&&oi(),N=!0,et.addClass(ye),Ye=null,Ke.trigger("dragstart.spectrum",[Dr()])}function qt(){N=!1,et.removeClass(ye),Ke.trigger("dragstop.spectrum",[Dr()])}function wl(){var zt=De.val();zt!==null&&zt!==""||!_e?(zt=tinycolor(zt)).isValid()?(On(zt),di(!0)):De.addClass("sp-validation-error"):(On(null),di(!0))}function Tl(){(P?An:Wl)()}function Wl(){var zt=e.Event("beforeShow.spectrum");P?oi():(Ke.trigger(zt,[Dr()]),A.beforeShow(Dr())===!1||zt.isDefaultPrevented()||(function(){for(var tl=0;tl<o.length;tl++)o[tl]&&o[tl].hide()}(),P=!0,e(Ce).bind("keydown.spectrum",sn),e(Ce).bind("click.spectrum",Vr),e(window).bind("resize.spectrum",M),it.addClass("sp-active"),et.removeClass("sp-hidden"),oi(),ii(),hl=Dr(),_t(),A.show(hl),Ke.trigger("show.spectrum",[hl])))}function sn(zt){zt.keyCode===27&&An()}function Vr(zt){zt.button!=2&&(N||(Di?di(!0):zn(),An()))}function An(){P&&!C&&(P=!1,e(Ce).unbind("keydown.spectrum",sn),e(Ce).unbind("click.spectrum",Vr),e(window).unbind("resize.spectrum",M),it.removeClass("sp-active"),et.addClass("sp-hidden"),A.hide(Dr()),Ke.trigger("hide.spectrum",[Dr()]))}function zn(){On(hl,!0)}function On(zt,tl){var ul;tinycolor.equals(zt,Dr())?ii():(!zt&&_e?ln=!0:(ln=!1,zt=(ul=tinycolor(zt)).toHsv(),ae=zt.h%360/360,J=zt.s,pe=zt.v,K=zt.a),ii(),ul&&ul.isValid()&&!tl&&(Rr=w.preferredFormat||ul.getFormat()))}function Dr(zt){return zt=zt||{},_e&&ln?null:tinycolor.fromRatio({h:ae,s:J,v:pe,a:Math.round(100*K)/100},{format:zt.format||Rr})}function Vn(){ii(),A.move(Dr()),Ke.trigger("move.spectrum",[Dr()])}function ii(){De.removeClass("sp-validation-error"),na();var zt=tinycolor.fromRatio({h:ae,s:1,v:1});wt.css("background-color",zt.toHexString());var tl=Rr;K<1&&(K!==0||tl!=="name")&&(tl!=="hex"&&tl!=="hex3"&&tl!=="hex6"&&tl!=="name"||(tl="rgb"));var ul,Ar,or=Dr({format:tl}),pn="";Kt.removeClass("sp-clear-display"),Kt.css("background-color","transparent"),!or&&_e?Kt.addClass("sp-clear-display"):(ul=or.toHexString(),Ar=or.toRgbString(),s||or.alpha===1?Kt.css("background-color",Ar):(Kt.css("background-color","transparent"),Kt.css("filter",or.toFilter())),w.showAlpha&&((zt=or.toRgb()).a=0,zt="linear-gradient(left, "+(Ar=tinycolor(zt).toRgbString())+", "+ul+")",a?xe.css("filter",tinycolor(Ar).toFilter({gradientType:1},ul)):(xe.css("background","-webkit-"+zt),xe.css("background","-moz-"+zt),xe.css("background","-ms-"+zt),xe.css("background","linear-gradient(to right, "+Ar+", "+ul+")"))),pn=or.toString(tl)),w.showInput&&De.val(pn),w.showPalette&&Ft(),_t()}function na(){var zt=J,tl=pe;_e&&ln?(je.hide(),me.hide(),be.hide()):(je.show(),me.show(),be.show(),zt=zt*E,tl=B-tl*B,zt=Math.max(-U,Math.min(E-U,zt-U)),tl=Math.max(-U,Math.min(B-U,tl-U)),be.css({top:tl+"px",left:zt+"px"}),zt=K*le,je.css({left:zt-he/2+"px"}),zt=ae*X,me.css({top:zt-Z+"px"}))}function di(zt){var tl=Dr(),ul="";tl&&(ul=tl.toString(Rr),mt(tl)),Ue&&Ke.val(ul),zt&&(A.change(tl),Ke.trigger("change",[tl]))}function oi(){var zt,tl,ul,Ar,or,pn,Fl;P&&(E=wt.width(),B=wt.height(),U=be.height(),Q.width(),X=Q.height(),Z=me.height(),le=Te.width(),he=je.width(),C||(et.css("position","absolute"),w.offset?et.offset(w.offset):et.offset((Fl=St,zt=(or=et).outerWidth(),tl=or.outerHeight(),ul=Fl.outerHeight(),or=(Ar=(pn=or[0].ownerDocument).documentElement).clientWidth+e(pn).scrollLeft(),pn=Ar.clientHeight+e(pn).scrollTop(),(Fl=Fl.offset()).top+=ul,Fl.left-=Math.min(Fl.left,Fl.left+zt>or&&zt<or?Math.abs(Fl.left+zt-or):0),Fl.top-=Math.min(Fl.top,Fl.top+tl>pn&&tl<pn?Math.abs(+(tl+ul)):0),Fl))),na(),w.showPalette&&Ft(),Ke.trigger("reflow.spectrum"))}function gn(){An(),ft=!0,Ke.attr("disabled",!0),St.addClass("sp-disabled")}(function(){function zt(ul){return ul.data&&ul.data.ignore?(On(e(ul.target).closest(".sp-thumb-el").data("color")),Vn()):(On(e(ul.target).closest(".sp-thumb-el").data("color")),Vn(),di(!0),w.hideAfterPaletteSelect&&An()),!1}a&&et.find("*:not(input)").attr("unselectable","on"),Ne(),We&&Ke.after(it).hide(),_e||Ie.hide(),C?Ke.after(et).hide():((tl=w.appendTo==="parent"?Ke.parent():e(w.appendTo)).length!==1&&(tl=e("body")),tl.append(et)),nt(),St.bind("click.spectrum touchstart.spectrum",function(ul){ft||Tl(),ul.stopPropagation(),e(ul.target).is("input")||ul.preventDefault()}),!Ke.is(":disabled")&&w.disabled!==!0||gn(),et.click(y),De.change(wl),De.bind("paste",function(){setTimeout(wl,1)}),De.keydown(function(ul){ul.keyCode==13&&wl()}),Ve.text(w.cancelText),Ve.bind("click.spectrum",function(ul){ul.stopPropagation(),ul.preventDefault(),zn(),An()}),Ie.attr("title",w.clearText),Ie.bind("click.spectrum",function(ul){ul.stopPropagation(),ul.preventDefault(),ln=!0,Vn(),C&&di(!0)}),ve.text(w.chooseText),ve.bind("click.spectrum",function(ul){ul.stopPropagation(),ul.preventDefault(),a&&De.is(":focus")&&De.trigger("change"),De.hasClass("sp-validation-error")||(di(!0),An())}),Ge.text(w.showPaletteOnly?w.togglePaletteMoreText:w.togglePaletteLessText),Ge.bind("click.spectrum",function(ul){ul.stopPropagation(),ul.preventDefault(),w.showPaletteOnly=!w.showPaletteOnly,w.showPaletteOnly||C||et.css("left","-="+(vt.outerWidth(!0)+5)),Ne()}),x(Te,function(ul,Ar,or){K=ul/le,ln=!1,or.shiftKey&&(K=Math.round(10*K)/10),Vn()},Jt,qt),x(Q,function(ul,Ar){ae=parseFloat(Ar/X),ln=!1,w.showAlpha||(K=1),Vn()},Jt,qt),x(wt,function(ul,Ar,or){or.shiftKey?Ye||(or=J*E,pn=B-pe*B,pn=Math.abs(ul-or)>Math.abs(Ar-pn),Ye=pn?"x":"y"):Ye=null;var pn=!Ye||Ye==="y";Ye&&Ye!=="x"||(J=parseFloat(ul/E)),pn&&(pe=parseFloat((B-Ar)/B)),ln=!1,w.showAlpha||(K=1),Vn()},Jt,qt),bl?(On(bl),ii(),Rr=w.preferredFormat||tinycolor(bl).format,mt(bl)):ii(),C&&Wl();var tl=a?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Fe.delegate(".sp-thumb-el",tl,zt),Ze.delegate(".sp-thumb-el:nth-child(1)",tl,{ignore:!0},zt)})();var ai={show:Wl,hide:An,toggle:Tl,reflow:oi,option:function(zt,tl){return zt===n?e.extend({},w):tl===n?w[zt]:(w[zt]=tl,zt==="preferredFormat"&&(Rr=w.preferredFormat),void Ne())},enable:function(){ft=!1,Ke.attr("disabled",!1),St.removeClass("sp-disabled")},disable:gn,offset:function(zt){w.offset=zt,oi()},set:function(zt){On(zt),di()},get:Dr,destroy:function(){Ke.show(),St.unbind("click.spectrum touchstart.spectrum"),et.remove(),it.remove(),o[ai.id]=null},container:et};return ai.id=o.push(ai)-1,ai}function b(){}function y(I){I.stopPropagation()}function p(I,O){var F=Array.prototype.slice,D=F.call(arguments,2);return function(){return I.apply(O,D.concat(F.call(arguments)))}}function x(I,O,F,D){O=O||function(){},F=F||function(){},D=D||function(){};var k=document,w=!1,C={},T=0,z=0,A="ontouchstart"in window,M={};function P(B){B.stopPropagation&&B.stopPropagation(),B.preventDefault&&B.preventDefault(),B.returnValue=!1}function N(B){if(w){if(a&&k.documentMode<9&&!B.button)return E();var U=B.originalEvent&&B.originalEvent.touches&&B.originalEvent.touches[0],X=U&&U.pageX||B.pageX,U=U&&U.pageY||B.pageY,X=Math.max(0,Math.min(X-C.left,z)),U=Math.max(0,Math.min(U-C.top,T));A&&P(B),O.apply(I,[X,U,B])}}function E(){w&&(e(k).unbind(M),e(k.body).removeClass("sp-dragging"),setTimeout(function(){D.apply(I,arguments)},0)),w=!1}M.selectstart=P,M.dragstart=P,M["touchmove mousemove"]=N,M["touchend mouseup"]=E,e(I).bind("touchstart mousedown",function(B){(B.which?B.which==3:B.button==2)||w||F.apply(I,arguments)!==!1&&(w=!0,T=e(I).height(),z=e(I).width(),C=e(I).offset(),e(k).bind(M),e(k.body).addClass("sp-dragging"),N(B),P(B))})}function _(){return e.fn.spectrum.inputTypeColorSupport()}var S="spectrum.id";e.fn.spectrum=function(I,O){if(typeof I!="string")return this.spectrum("destroy").each(function(){var k=g(this,e.extend({},I,e(this).data()));e(this).data(S,k.id)});var F=this,D=Array.prototype.slice.call(arguments,1);return this.each(function(){var k=o[e(this).data(S)];if(k){var w=k[I];if(!w)throw new Error("Spectrum: no such method: '"+I+"'");I=="get"?F=k.get():I=="container"?F=k.container:I=="option"?F=k.option.apply(k,D):I=="destroy"?(k.destroy(),e(this).removeData(S)):w.apply(k,D)}}),F},e.fn.spectrum.load=!0,e.fn.spectrum.loadOpts={},e.fn.spectrum.draggable=x,e.fn.spectrum.defaults=l,e.fn.spectrum.inputTypeColorSupport=function I(){var O;return I._cachedResult===void 0&&(O=e("<input type='color'/>")[0],I._cachedResult=O.type==="color"&&O.value!==""),I._cachedResult},e.spectrum={},e.spectrum.localization={},e.spectrum.palettes={},e.fn.spectrum.processNativeColorInputs=function(){var I=e("input[type=color]");I.length&&!_()&&I.spectrum({preferredFormat:"hex6"})},function(){var I=/^[\s,#]+/,O=/\s+$/,F=0,D=Math,k=D.round,w=D.min,C=D.max,T=D.random,z=function(be,Q){if(Q=Q||{},(be=be||"")instanceof z)return be;if(!(this instanceof z))return new z(be,Q);var me,xe,Te,je,De,Fe,Ze,Ve,Ie,ve,Ge,Ie=(Ve={r:0,g:0,b:0},Ge=ve=!(Ie=1),typeof(me=be)=="string"&&(me=function(We){We=We.replace(I,"").replace(O,"").toLowerCase();var it,St=!1;if(re[We])We=re[We],St=!0;else if(We=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(it=wt.rgb.exec(We))?{r:it[1],g:it[2],b:it[3]}:(it=wt.rgba.exec(We))?{r:it[1],g:it[2],b:it[3],a:it[4]}:(it=wt.hsl.exec(We))?{h:it[1],s:it[2],l:it[3]}:(it=wt.hsla.exec(We))?{h:it[1],s:it[2],l:it[3],a:it[4]}:(it=wt.hsv.exec(We))?{h:it[1],s:it[2],v:it[3]}:(it=wt.hsva.exec(We))?{h:it[1],s:it[2],v:it[3],a:it[4]}:(it=wt.hex8.exec(We))?{a:Ce(it[1])/255,r:Ce(it[2]),g:Ce(it[3]),b:Ce(it[4]),format:St?"name":"hex8"}:(it=wt.hex6.exec(We))?{r:Ce(it[1]),g:Ce(it[2]),b:Ce(it[3]),format:St?"name":"hex"}:!!(it=wt.hex3.exec(We))&&{r:Ce(it[1]+""+it[1]),g:Ce(it[2]+""+it[2]),b:Ce(it[3]+""+it[3]),format:St?"name":"hex"}}(me)),typeof me=="object"&&(me.hasOwnProperty("r")&&me.hasOwnProperty("g")&&me.hasOwnProperty("b")?(De=me.r,Fe=me.g,Ze=me.b,Ve={r:255*ye(De,255),g:255*ye(Fe,255),b:255*ye(Ze,255)},ve=!0,Ge=String(me.r).substr(-1)==="%"?"prgb":"rgb"):me.hasOwnProperty("h")&&me.hasOwnProperty("s")&&me.hasOwnProperty("v")?(me.s=ft(me.s),me.v=ft(me.v),Ve=function(We,it,St){We=6*ye(We,360),it=ye(it,100),St=ye(St,100);var Kt=D.floor(We),bl=We-Kt,hl=St*(1-it),We=St*(1-bl*it),it=St*(1-(1-bl)*it),Kt=Kt%6;return{r:255*[St,We,hl,hl,it,St][Kt],g:255*[it,St,St,We,hl,hl][Kt],b:255*[hl,hl,it,St,St,We][Kt]}}(me.h,me.s,me.v),ve=!0,Ge="hsv"):me.hasOwnProperty("h")&&me.hasOwnProperty("s")&&me.hasOwnProperty("l")&&(me.s=ft(me.s),me.l=ft(me.l),De=me.h,Fe=me.s,Ze=me.l,De=ye(De,360),Fe=ye(Fe,100),Ze=ye(Ze,100),Fe===0?xe=Te=je=Ze:(xe=Ue(Fe=2*Ze-(Ze=Ze<.5?Ze*(1+Fe):Ze+Fe-Ze*Fe),Ze,De+1/3),Te=Ue(Fe,Ze,De),je=Ue(Fe,Ze,De-1/3)),Ve={r:255*xe,g:255*Te,b:255*je},ve=!0,Ge="hsl"),me.hasOwnProperty("a")&&(Ie=me.a)),Ie=Me(Ie),{ok:ve,format:me.format||Ge,r:w(255,C(Ve.r,0)),g:w(255,C(Ve.g,0)),b:w(255,C(Ve.b,0)),a:Ie});function Ue(We,it,St){return St<0&&(St+=1),1<St&&--St,St<1/6?We+6*(it-We)*St:St<.5?it:St<2/3?We+(it-We)*(2/3-St)*6:We}this._originalInput=be,this._r=Ie.r,this._g=Ie.g,this._b=Ie.b,this._a=Ie.a,this._roundA=k(100*this._a)/100,this._format=Q.format||Ie.format,this._gradientType=Q.gradientType,this._r<1&&(this._r=k(this._r)),this._g<1&&(this._g=k(this._g)),this._b<1&&(this._b=k(this._b)),this._ok=Ie.ok,this._tc_id=F++};function A(be,Q,me){be=ye(be,255),Q=ye(Q,255),me=ye(me,255);var xe,Te=C(be,Q,me),je=w(be,Q,me),De=(Te+je)/2;if(Te==je)xe=Ze=0;else{var Fe=Te-je,Ze=.5<De?Fe/(2-Te-je):Fe/(Te+je);switch(Te){case be:xe=(Q-me)/Fe+(Q<me?6:0);break;case Q:xe=(me-be)/Fe+2;break;case me:xe=(be-Q)/Fe+4}xe/=6}return{h:xe,s:Ze,l:De}}function M(be,Q,me){be=ye(be,255),Q=ye(Q,255),me=ye(me,255);var xe,Te=C(be,Q,me),je=w(be,Q,me),De=Te,Fe=Te-je,Ze=Te===0?0:Fe/Te;if(Te==je)xe=0;else{switch(Te){case be:xe=(Q-me)/Fe+(Q<me?6:0);break;case Q:xe=(me-be)/Fe+2;break;case me:xe=(be-Q)/Fe+4}xe/=6}return{h:xe,s:Ze,v:De}}function P(be,Q,me,xe){return me=[Ke(k(be).toString(16)),Ke(k(Q).toString(16)),Ke(k(me).toString(16))],xe&&me[0].charAt(0)==me[0].charAt(1)&&me[1].charAt(0)==me[1].charAt(1)&&me[2].charAt(0)==me[2].charAt(1)?me[0].charAt(0)+me[1].charAt(0)+me[2].charAt(0):me.join("")}function N(be,Q,me,xe){return[Ke(Math.round(255*parseFloat(xe)).toString(16)),Ke(k(be).toString(16)),Ke(k(Q).toString(16)),Ke(k(me).toString(16))].join("")}function E(be,Q){return Q=Q===0?0:Q||10,be=z(be).toHsl(),be.s-=Q/100,be.s=Ye(be.s),z(be)}function B(be,Q){return Q=Q===0?0:Q||10,be=z(be).toHsl(),be.s+=Q/100,be.s=Ye(be.s),z(be)}function U(be){return z(be).desaturate(100)}function X(be,Q){return Q=Q===0?0:Q||10,be=z(be).toHsl(),be.l+=Q/100,be.l=Ye(be.l),z(be)}function le(be,Q){return Q=Q===0?0:Q||10,be=z(be).toRgb(),be.r=C(0,w(255,be.r-k(-Q/100*255))),be.g=C(0,w(255,be.g-k(-Q/100*255))),be.b=C(0,w(255,be.b-k(-Q/100*255))),z(be)}function he(be,Q){return Q=Q===0?0:Q||10,be=z(be).toHsl(),be.l-=Q/100,be.l=Ye(be.l),z(be)}function Z(be,Q){return be=z(be).toHsl(),Q=(k(be.h)+Q)%360,be.h=Q<0?360+Q:Q,z(be)}function ae(be){return be=z(be).toHsl(),be.h=(be.h+180)%360,z(be)}function J(be){var Q=z(be).toHsl(),me=Q.h;return[z(be),z({h:(me+120)%360,s:Q.s,l:Q.l}),z({h:(me+240)%360,s:Q.s,l:Q.l})]}function pe(be){var Q=z(be).toHsl(),me=Q.h;return[z(be),z({h:(me+90)%360,s:Q.s,l:Q.l}),z({h:(me+180)%360,s:Q.s,l:Q.l}),z({h:(me+270)%360,s:Q.s,l:Q.l})]}function K(be){var Q=z(be).toHsl(),me=Q.h;return[z(be),z({h:(me+72)%360,s:Q.s,l:Q.l}),z({h:(me+216)%360,s:Q.s,l:Q.l})]}function se(be,Q,me){Q=Q||6,me=me||30;var xe=z(be).toHsl(),Te=360/me,je=[z(be)];for(xe.h=(xe.h-(Te*Q>>1)+720)%360;--Q;)xe.h=(xe.h+Te)%360,je.push(z(xe));return je}function te(be,Q){Q=Q||6;for(var be=z(be).toHsv(),me=be.h,xe=be.s,Te=be.v,je=[],De=1/Q;Q--;)je.push(z({h:me,s:xe,v:Te})),Te=(Te+De)%1;return je}z.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var be=this.toRgb();return(299*be.r+587*be.g+114*be.b)/1e3},setAlpha:function(be){return this._a=Me(be),this._roundA=k(100*this._a)/100,this},toHsv:function(){var be=M(this._r,this._g,this._b);return{h:360*be.h,s:be.s,v:be.v,a:this._a}},toHsvString:function(){var be=M(this._r,this._g,this._b),Q=k(360*be.h),me=k(100*be.s),be=k(100*be.v);return this._a==1?"hsv("+Q+", "+me+"%, "+be+"%)":"hsva("+Q+", "+me+"%, "+be+"%, "+this._roundA+")"},toHsl:function(){var be=A(this._r,this._g,this._b);return{h:360*be.h,s:be.s,l:be.l,a:this._a}},toHslString:function(){var be=A(this._r,this._g,this._b),Q=k(360*be.h),me=k(100*be.s),be=k(100*be.l);return this._a==1?"hsl("+Q+", "+me+"%, "+be+"%)":"hsla("+Q+", "+me+"%, "+be+"%, "+this._roundA+")"},toHex:function(be){return P(this._r,this._g,this._b,be)},toHexString:function(be){return"#"+this.toHex(be)},toHex8:function(){return N(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:k(this._r),g:k(this._g),b:k(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+k(this._r)+", "+k(this._g)+", "+k(this._b)+")":"rgba("+k(this._r)+", "+k(this._g)+", "+k(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:k(100*ye(this._r,255))+"%",g:k(100*ye(this._g,255))+"%",b:k(100*ye(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+k(100*ye(this._r,255))+"%, "+k(100*ye(this._g,255))+"%, "+k(100*ye(this._b,255))+"%)":"rgba("+k(100*ye(this._r,255))+"%, "+k(100*ye(this._g,255))+"%, "+k(100*ye(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(fe[P(this._r,this._g,this._b,!0)]||!1)},toFilter:function(be){var Q="#"+N(this._r,this._g,this._b,this._a),me=Q,xe=this._gradientType?"GradientType = 1, ":"";return be&&(me=z(be).toHex8String()),"progid:DXImageTransform.Microsoft.gradient("+xe+"startColorstr="+Q+",endColorstr="+me+")"},toString:function(be){var Q=!!be;be=be||this._format;var me=!1,xe=this._a<1&&0<=this._a;return Q||!xe||be!=="hex"&&be!=="hex6"&&be!=="hex3"&&be!=="name"?(be==="rgb"&&(me=this.toRgbString()),be==="prgb"&&(me=this.toPercentageRgbString()),be!=="hex"&&be!=="hex6"||(me=this.toHexString()),be==="hex3"&&(me=this.toHexString(!0)),be==="hex8"&&(me=this.toHex8String()),be==="name"&&(me=this.toName()),be==="hsl"&&(me=this.toHslString()),be==="hsv"&&(me=this.toHsvString()),me||this.toHexString()):be==="name"&&this._a===0?this.toName():this.toRgbString()},_applyModification:function(be,Q){return Q=be.apply(null,[this].concat([].slice.call(Q))),this._r=Q._r,this._g=Q._g,this._b=Q._b,this.setAlpha(Q._a),this},lighten:function(){return this._applyModification(X,arguments)},brighten:function(){return this._applyModification(le,arguments)},darken:function(){return this._applyModification(he,arguments)},desaturate:function(){return this._applyModification(E,arguments)},saturate:function(){return this._applyModification(B,arguments)},greyscale:function(){return this._applyModification(U,arguments)},spin:function(){return this._applyModification(Z,arguments)},_applyCombination:function(be,Q){return be.apply(null,[this].concat([].slice.call(Q)))},analogous:function(){return this._applyCombination(se,arguments)},complement:function(){return this._applyCombination(ae,arguments)},monochromatic:function(){return this._applyCombination(te,arguments)},splitcomplement:function(){return this._applyCombination(K,arguments)},triad:function(){return this._applyCombination(J,arguments)},tetrad:function(){return this._applyCombination(pe,arguments)}},z.fromRatio=function(be,Q){if(typeof be=="object"){var me,xe={};for(me in be)be.hasOwnProperty(me)&&(xe[me]=me==="a"?be[me]:ft(be[me]));be=xe}return z(be,Q)},z.equals=function(be,Q){return!(!be||!Q)&&z(be).toRgbString()==z(Q).toRgbString()},z.random=function(){return z.fromRatio({r:T(),g:T(),b:T()})},z.mix=function(be,Q,me){me=me===0?0:me||50;var xe=z(be).toRgb(),Te=z(Q).toRgb(),be=me/100,Q=2*be-1,me=Te.a-xe.a,me=1-(Q=(1+(Q=Q*me==-1?Q:(Q+me)/(1+Q*me)))/2),be={r:Te.r*Q+xe.r*me,g:Te.g*Q+xe.g*me,b:Te.b*Q+xe.b*me,a:Te.a*be+xe.a*(1-be)};return z(be)},z.readability=function(be,Q){var me=z(be),xe=z(Q),be=me.toRgb(),Q=xe.toRgb(),me=me.getBrightness(),xe=xe.getBrightness(),Q=Math.max(be.r,Q.r)-Math.min(be.r,Q.r)+Math.max(be.g,Q.g)-Math.min(be.g,Q.g)+Math.max(be.b,Q.b)-Math.min(be.b,Q.b);return{brightness:Math.abs(me-xe),color:Q}},z.isReadable=function(be,Q){return Q=z.readability(be,Q),125<Q.brightness&&500<Q.color},z.mostReadable=function(be,Q){for(var me=null,xe=0,Te=!1,je=0;je<Q.length;je++){var De=z.readability(be,Q[je]),Fe=125<De.brightness&&500<De.color,De=De.brightness/125*3+De.color/500;(Fe&&!Te||Fe&&Te&&xe<De||!Fe&&!Te&&xe<De)&&(Te=Fe,xe=De,me=z(Q[je]))}return me};var re=z.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},fe=z.hexNames=function(be){var Q,me={};for(Q in be)be.hasOwnProperty(Q)&&(me[be[Q]]=Q);return me}(re);function Me(be){return be=parseFloat(be),(isNaN(be)||be<0||1<be)&&(be=1),be}function ye(be,Q){typeof(me=be)=="string"&&me.indexOf(".")!=-1&&parseFloat(me)===1&&(be="100%");var me=typeof be=="string"&&be.indexOf("%")!=-1;return be=w(Q,C(0,parseFloat(be))),me&&(be=parseInt(be*Q,10)/100),D.abs(be-Q)<1e-6?1:be%Q/parseFloat(Q)}function Ye(be){return w(1,C(0,be))}function Ce(be){return parseInt(be,16)}function Ke(be){return be.length==1?"0"+be:""+be}function ft(be){return be<=1&&(be=100*be+"%"),be}var et,vt,wt=(et="[\\s|\\(]+("+(vt="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+vt+")[,|\\s]+("+vt+")\\s*\\)?",vt="[\\s|\\(]+("+vt+")[,|\\s]+("+vt+")[,|\\s]+("+vt+")[,|\\s]+("+vt+")\\s*\\)?",{rgb:new RegExp("rgb"+et),rgba:new RegExp("rgba"+vt),hsl:new RegExp("hsl"+et),hsla:new RegExp("hsla"+vt),hsv:new RegExp("hsv"+et),hsva:new RegExp("hsva"+vt),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});window.tinycolor=z}(),e(function(){e.fn.spectrum.load&&e.fn.spectrum.processNativeColorInputs()})}),function(){var e=function(n){n.ui=n.ui||{},n.ui.version="1.12.1";var t,l,o,a,s,u,f,m,d,g,b=0,y=Array.prototype.slice;function p(k,w,C){return[parseFloat(k[0])*(d.test(k[0])?w/100:1),parseFloat(k[1])*(d.test(k[1])?C/100:1)]}function x(k,w){return parseInt(n.css(k,w),10)||0}n.cleanData=(t=n.cleanData,function(k){for(var w,C,T=0;(C=k[T])!=null;T++)try{(w=n._data(C,"events"))&&w.remove&&n(C).triggerHandler("remove")}catch(z){}t(k)}),n.widget=function(k,w,C){var T,z,A,M={},P=k.split(".")[0],N=P+"-"+(k=k.split(".")[1]);return C||(C=w,w=n.Widget),n.isArray(C)&&(C=n.extend.apply(null,[{}].concat(C))),n.expr[":"][N.toLowerCase()]=function(E){return!!n.data(E,N)},n[P]=n[P]||{},T=n[P][k],z=n[P][k]=function(E,B){if(!this._createWidget)return new z(E,B);arguments.length&&this._createWidget(E,B)},n.extend(z,T,{version:C.version,_proto:n.extend({},C),_childConstructors:[]}),(A=new w).options=n.widget.extend({},A.options),n.each(C,function(E,B){function U(){return w.prototype[E].apply(this,arguments)}function X(le){return w.prototype[E].apply(this,le)}n.isFunction(B)?M[E]=function(){var le,he=this._super,Z=this._superApply;return this._super=U,this._superApply=X,le=B.apply(this,arguments),this._super=he,this._superApply=Z,le}:M[E]=B}),z.prototype=n.widget.extend(A,{widgetEventPrefix:T&&A.widgetEventPrefix||k},M,{constructor:z,namespace:P,widgetName:k,widgetFullName:N}),T?(n.each(T._childConstructors,function(E,B){var U=B.prototype;n.widget(U.namespace+"."+U.widgetName,z,B._proto)}),delete T._childConstructors):w._childConstructors.push(z),n.widget.bridge(k,z),z},n.widget.extend=function(k){for(var w,C,T=y.call(arguments,1),z=0,A=T.length;z<A;z++)for(w in T[z])C=T[z][w],T[z].hasOwnProperty(w)&&C!==void 0&&(n.isPlainObject(C)?k[w]=n.isPlainObject(k[w])?n.widget.extend({},k[w],C):n.widget.extend({},C):k[w]=C);return k},n.widget.bridge=function(k,w){var C=w.prototype.widgetFullName||k;n.fn[k]=function(T){var z=typeof T=="string",A=y.call(arguments,1),M=this;return z?this.length||T!=="instance"?this.each(function(){var P,N=n.data(this,C);return T==="instance"?(M=N,!1):N?n.isFunction(N[T])&&T.charAt(0)!=="_"?(P=N[T].apply(N,A))!==N&&P!==void 0?(M=P&&P.jquery?M.pushStack(P.get()):P,!1):void 0:n.error("no such method '"+T+"' for "+k+" widget instance"):n.error("cannot call methods on "+k+" prior to initialization; attempted to call method '"+T+"'")}):M=void 0:(A.length&&(T=n.widget.extend.apply(null,[T].concat(A))),this.each(function(){var P=n.data(this,C);P?(P.option(T||{}),P._init&&P._init()):n.data(this,C,new w(T,this))})),M}},n.Widget=function(){},n.Widget._childConstructors=[],n.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(k,w){w=n(w||this.defaultElement||this)[0],this.element=n(w),this.uuid=b++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=n(),this.hoverable=n(),this.focusable=n(),this.classesElementLookup={},w!==this&&(n.data(w,this.widgetFullName,this),this._on(!0,this.element,{remove:function(C){C.target===w&&this.destroy()}}),this.document=n(w.style?w.ownerDocument:w.document||w),this.window=n(this.document[0].defaultView||this.document[0].parentWindow)),this.options=n.widget.extend({},this.options,this._getCreateOptions(),k),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:n.noop,_create:n.noop,_init:n.noop,destroy:function(){var k=this;this._destroy(),n.each(this.classesElementLookup,function(w,C){k._removeClass(C,w)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:n.noop,widget:function(){return this.element},option:function(k,w){var C,T,z,A=k;if(arguments.length===0)return n.widget.extend({},this.options);if(typeof k=="string")if(A={},k=(C=k.split(".")).shift(),C.length){for(T=A[k]=n.widget.extend({},this.options[k]),z=0;z<C.length-1;z++)T[C[z]]=T[C[z]]||{},T=T[C[z]];if(k=C.pop(),arguments.length===1)return T[k]===void 0?null:T[k];T[k]=w}else{if(arguments.length===1)return this.options[k]===void 0?null:this.options[k];A[k]=w}return this._setOptions(A),this},_setOptions:function(k){for(var w in k)this._setOption(w,k[w]);return this},_setOption:function(k,w){return k==="classes"&&this._setOptionClasses(w),this.options[k]=w,k==="disabled"&&this._setOptionDisabled(w),this},_setOptionClasses:function(k){var w,C,T;for(w in k)T=this.classesElementLookup[w],k[w]!==this.options.classes[w]&&T&&T.length&&(C=n(T.get()),this._removeClass(T,w),C.addClass(this._classes({element:C,keys:w,classes:k,add:!0})))},_setOptionDisabled:function(k){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!k),k&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(k){var w=[],C=this;function T(z,A){for(var M,P=0;P<z.length;P++)M=C.classesElementLookup[z[P]]||n(),M=k.add?n(n.unique(M.get().concat(k.element.get()))):n(M.not(k.element).get()),C.classesElementLookup[z[P]]=M,w.push(z[P]),A&&k.classes[z[P]]&&w.push(k.classes[z[P]])}return k=n.extend({element:this.element,classes:this.options.classes||{}},k),this._on(k.element,{remove:"_untrackClassesElement"}),k.keys&&T(k.keys.match(/\S+/g)||[],!0),k.extra&&T(k.extra.match(/\S+/g)||[]),w.join(" ")},_untrackClassesElement:function(k){var w=this;n.each(w.classesElementLookup,function(C,T){n.inArray(k.target,T)!==-1&&(w.classesElementLookup[C]=n(T.not(k.target).get()))})},_removeClass:function(k,w,C){return this._toggleClass(k,w,C,!1)},_addClass:function(k,w,C){return this._toggleClass(k,w,C,!0)},_toggleClass:function(k,w,C,T){T=typeof T=="boolean"?T:C;var z=typeof k=="string"||k===null,k={extra:z?w:C,keys:z?k:w,element:z?this.element:k,add:T};return k.element.toggleClass(this._classes(k),T),this},_on:function(k,w,C){var T,z=this;typeof k!="boolean"&&(C=w,w=k,k=!1),C?(w=T=n(w),this.bindings=this.bindings.add(w)):(C=w,w=this.element,T=this.widget()),n.each(C,function(A,M){function P(){if(k||z.options.disabled!==!0&&!n(this).hasClass("ui-state-disabled"))return(typeof M=="string"?z[M]:M).apply(z,arguments)}typeof M!="string"&&(P.guid=M.guid=M.guid||P.guid||n.guid++);var N=A.match(/^([\w:-]*)\s*(.*)$/),A=N[1]+z.eventNamespace,N=N[2];N?T.on(A,N,P):w.on(A,P)})},_off:function(k,w){w=(w||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,k.off(w).off(w),this.bindings=n(this.bindings.not(k).get()),this.focusable=n(this.focusable.not(k).get()),this.hoverable=n(this.hoverable.not(k).get())},_delay:function(k,w){var C=this;return setTimeout(function(){return(typeof k=="string"?C[k]:k).apply(C,arguments)},w||0)},_hoverable:function(k){this.hoverable=this.hoverable.add(k),this._on(k,{mouseenter:function(w){this._addClass(n(w.currentTarget),null,"ui-state-hover")},mouseleave:function(w){this._removeClass(n(w.currentTarget),null,"ui-state-hover")}})},_focusable:function(k){this.focusable=this.focusable.add(k),this._on(k,{focusin:function(w){this._addClass(n(w.currentTarget),null,"ui-state-focus")},focusout:function(w){this._removeClass(n(w.currentTarget),null,"ui-state-focus")}})},_trigger:function(k,w,C){var T,z,A=this.options[k];if(C=C||{},(w=n.Event(w)).type=(k===this.widgetEventPrefix?k:this.widgetEventPrefix+k).toLowerCase(),w.target=this.element[0],z=w.originalEvent)for(T in z)T in w||(w[T]=z[T]);return this.element.trigger(w,C),!(n.isFunction(A)&&A.apply(this.element[0],[w].concat(C))===!1||w.isDefaultPrevented())}},n.each({show:"fadeIn",hide:"fadeOut"},function(k,w){n.Widget.prototype["_"+k]=function(C,T,z){var A;typeof T=="string"&&(T={effect:T});var M=T?T!==!0&&typeof T!="number"&&T.effect||w:k;typeof(T=T||{})=="number"&&(T={duration:T}),A=!n.isEmptyObject(T),T.complete=z,T.delay&&C.delay(T.delay),A&&n.effects&&n.effects.effect[M]?C[k](T):M!==k&&C[M]?C[M](T.duration,T.easing,z):C.queue(function(P){n(this)[k](),z&&z.call(C[0]),P()})}}),n.widget,o=Math.max,a=Math.abs,s=/left|center|right/,u=/top|center|bottom/,f=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,d=/%$/,g=n.fn.position,n.position={scrollbarWidth:function(){if(l!==void 0)return l;var k,w=n("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),C=w.children()[0];return n("body").append(w),k=C.offsetWidth,w.css("overflow","scroll"),k===(C=C.offsetWidth)&&(C=w[0].clientWidth),w.remove(),l=k-C},getScrollInfo:function(k){var w=k.isWindow||k.isDocument?"":k.element.css("overflow-x"),C=k.isWindow||k.isDocument?"":k.element.css("overflow-y"),w=w==="scroll"||w==="auto"&&k.width<k.element[0].scrollWidth;return{width:C==="scroll"||C==="auto"&&k.height<k.element[0].scrollHeight?n.position.scrollbarWidth():0,height:w?n.position.scrollbarWidth():0}},getWithinInfo:function(k){var w=n(k||window),C=n.isWindow(w[0]),T=!!w[0]&&w[0].nodeType===9;return{element:w,isWindow:C,isDocument:T,offset:C||T?{left:0,top:0}:n(k).offset(),scrollLeft:w.scrollLeft(),scrollTop:w.scrollTop(),width:w.outerWidth(),height:w.outerHeight()}}},n.fn.position=function(k){if(!k||!k.of)return g.apply(this,arguments);k=n.extend({},k);var w,C,T,z,A,M,P=n(k.of),N=n.position.getWithinInfo(k.within),E=n.position.getScrollInfo(N),B=(k.collision||"flip").split(" "),U={},X=(M=(X=P)[0]).nodeType===9?{width:X.width(),height:X.height(),offset:{top:0,left:0}}:n.isWindow(M)?{width:X.width(),height:X.height(),offset:{top:X.scrollTop(),left:X.scrollLeft()}}:M.preventDefault?{width:0,height:0,offset:{top:M.pageY,left:M.pageX}}:{width:X.outerWidth(),height:X.outerHeight(),offset:X.offset()};return P[0].preventDefault&&(k.at="left top"),C=X.width,T=X.height,z=X.offset,A=n.extend({},z),n.each(["my","at"],function(){var le,he,Z=(k[this]||"").split(" ");Z.length===1&&(Z=s.test(Z[0])?Z.concat(["center"]):u.test(Z[0])?["center"].concat(Z):["center","center"]),Z[0]=s.test(Z[0])?Z[0]:"center",Z[1]=u.test(Z[1])?Z[1]:"center",le=f.exec(Z[0]),he=f.exec(Z[1]),U[this]=[le?le[0]:0,he?he[0]:0],k[this]=[m.exec(Z[0])[0],m.exec(Z[1])[0]]}),B.length===1&&(B[1]=B[0]),k.at[0]==="right"?A.left+=C:k.at[0]==="center"&&(A.left+=C/2),k.at[1]==="bottom"?A.top+=T:k.at[1]==="center"&&(A.top+=T/2),w=p(U.at,C,T),A.left+=w[0],A.top+=w[1],this.each(function(){var le,he,Z=n(this),ae=Z.outerWidth(),J=Z.outerHeight(),pe=x(this,"marginLeft"),K=x(this,"marginTop"),se=ae+pe+x(this,"marginRight")+E.width,te=J+K+x(this,"marginBottom")+E.height,re=n.extend({},A),fe=p(U.my,Z.outerWidth(),Z.outerHeight());k.my[0]==="right"?re.left-=ae:k.my[0]==="center"&&(re.left-=ae/2),k.my[1]==="bottom"?re.top-=J:k.my[1]==="center"&&(re.top-=J/2),re.left+=fe[0],re.top+=fe[1],le={marginLeft:pe,marginTop:K},n.each(["left","top"],function(Me,ye){n.ui.position[B[Me]]&&n.ui.position[B[Me]][ye](re,{targetWidth:C,targetHeight:T,elemWidth:ae,elemHeight:J,collisionPosition:le,collisionWidth:se,collisionHeight:te,offset:[w[0]+fe[0],w[1]+fe[1]],my:k.my,at:k.at,within:N,elem:Z})}),k.using&&(he=function(Me){var ye=z.left-re.left,Ye=ye+C-ae,Ce=z.top-re.top,Ke=Ce+T-J,ft={target:{element:P,left:z.left,top:z.top,width:C,height:T},element:{element:Z,left:re.left,top:re.top,width:ae,height:J},horizontal:Ye<0?"left":0<ye?"right":"center",vertical:Ke<0?"top":0<Ce?"bottom":"middle"};C<ae&&a(ye+Ye)<C&&(ft.horizontal="center"),T<J&&a(Ce+Ke)<T&&(ft.vertical="middle"),o(a(ye),a(Ye))>o(a(Ce),a(Ke))?ft.important="horizontal":ft.important="vertical",k.using.call(this,Me,ft)}),Z.offset(n.extend(re,{using:he}))})},n.ui.position={fit:{left:function(k,w){var C=w.within,T=C.isWindow?C.scrollLeft:C.offset.left,z=C.width,A=k.left-w.collisionPosition.marginLeft,M=T-A,P=A+w.collisionWidth-z-T;w.collisionWidth>z?0<M&&P<=0?(C=k.left+M+w.collisionWidth-z-T,k.left+=M-C):k.left=!(0<P&&M<=0)&&P<M?T+z-w.collisionWidth:T:0<M?k.left+=M:0<P?k.left-=P:k.left=o(k.left-A,k.left)},top:function(k,w){var C=w.within,T=C.isWindow?C.scrollTop:C.offset.top,z=w.within.height,A=k.top-w.collisionPosition.marginTop,M=T-A,P=A+w.collisionHeight-z-T;w.collisionHeight>z?0<M&&P<=0?(C=k.top+M+w.collisionHeight-z-T,k.top+=M-C):k.top=!(0<P&&M<=0)&&P<M?T+z-w.collisionHeight:T:0<M?k.top+=M:0<P?k.top-=P:k.top=o(k.top-A,k.top)}},flip:{left:function(k,w){var C=w.within,T=C.offset.left+C.scrollLeft,z=C.width,A=C.isWindow?C.scrollLeft:C.offset.left,M=k.left-w.collisionPosition.marginLeft,P=M-A,N=M+w.collisionWidth-z-A,E=w.my[0]==="left"?-w.elemWidth:w.my[0]==="right"?w.elemWidth:0,C=w.at[0]==="left"?w.targetWidth:w.at[0]==="right"?-w.targetWidth:0,M=-2*w.offset[0];P<0?((T=k.left+E+C+M+w.collisionWidth-z-T)<0||T<a(P))&&(k.left+=E+C+M):0<N&&(0<(A=k.left-w.collisionPosition.marginLeft+E+C+M-A)||a(A)<N)&&(k.left+=E+C+M)},top:function(k,w){var C=w.within,T=C.offset.top+C.scrollTop,z=C.height,A=C.isWindow?C.scrollTop:C.offset.top,M=k.top-w.collisionPosition.marginTop,P=M-A,N=M+w.collisionHeight-z-A,E=w.my[1]==="top"?-w.elemHeight:w.my[1]==="bottom"?w.elemHeight:0,C=w.at[1]==="top"?w.targetHeight:w.at[1]==="bottom"?-w.targetHeight:0,M=-2*w.offset[1];P<0?((T=k.top+E+C+M+w.collisionHeight-z-T)<0||T<a(P))&&(k.top+=E+C+M):0<N&&(0<(A=k.top-w.collisionPosition.marginTop+E+C+M-A)||a(A)<N)&&(k.top+=E+C+M)}},flipfit:{left:function(){n.ui.position.flip.left.apply(this,arguments),n.ui.position.fit.left.apply(this,arguments)},top:function(){n.ui.position.flip.top.apply(this,arguments),n.ui.position.fit.top.apply(this,arguments)}}},n.ui.position,n.fn.form=function(){return typeof this[0].form=="string"?this.closest("form"):n(this[0].form)},n.ui.formResetMixin={_formResetHandler:function(){var k=n(this);setTimeout(function(){var w=k.data("ui-form-reset-instances");n.each(w,function(){this.refresh()})})},_bindFormResetHandler:function(){var k;this.form=this.element.form(),this.form.length&&((k=this.form.data("ui-form-reset-instances")||[]).length||this.form.on("reset.ui-form-reset",this._formResetHandler),k.push(this),this.form.data("ui-form-reset-instances",k))},_unbindFormResetHandler:function(){var k;this.form.length&&((k=this.form.data("ui-form-reset-instances")).splice(n.inArray(this,k),1),k.length?this.form.data("ui-form-reset-instances",k):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset"))}},n.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},n.ui.escapeSelector=(_=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,function(k){return k.replace(_,"\\$1")}),n.fn.labels=function(){var k,w,C;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(w=this.eq(0).parents("label"),(k=this.attr("id"))&&(C=(C=this.eq(0).parents().last()).add((C.length?C:this).siblings()),k="label[for='"+n.ui.escapeSelector(k)+"']",w=w.add(C.find(k).addBack(k))),this.pushStack(w))},n.fn.extend({uniqueId:(S=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++S)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&n(this).removeAttr("id")})}});var _,S,I,O=/ui-corner-([a-z]){2,6}/g;n.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var k=this,w=[];n.each(this.options.items,function(C,T){var z,A;if(T)return C==="controlgroupLabel"?((z=k.element.find(T)).each(function(){var M=n(this);M.children(".ui-controlgroup-label-contents").length||M.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),k._addClass(z,null,"ui-widget ui-widget-content ui-state-default"),void(w=w.concat(z.get()))):void(n.fn[C]&&(A=k["_"+C+"Options"]?k["_"+C+"Options"]("middle"):{classes:{}},k.element.find(T).each(function(){var M=n(this),P=M[C]("instance"),N=n.widget.extend({},A);C==="button"&&M.parent(".ui-spinner").length||((P=P||M[C]()[C]("instance"))&&(N.classes=k._resolveClassesValues(N.classes,P)),M[C](N),N=M[C]("widget"),n.data(N[0],"ui-controlgroup-data",P||M[C]("instance")),w.push(N[0]))})))}),this.childWidgets=n(n.unique(w)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(k){this.childWidgets.each(function(){var w=n(this).data("ui-controlgroup-data");w&&w[k]&&w[k]()})},_updateCornerClass:function(k,w){w=this._buildSimpleOptions(w,"label").classes.label,this._removeClass(k,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(k,null,w)},_buildSimpleOptions:function(k,w){var C=this.options.direction==="vertical",T={classes:{}};return T.classes[w]={middle:"",first:"ui-corner-"+(C?"top":"left"),last:"ui-corner-"+(C?"bottom":"right"),only:"ui-corner-all"}[k],T},_spinnerOptions:function(k){return k=this._buildSimpleOptions(k,"ui-spinner"),k.classes["ui-spinner-up"]="",k.classes["ui-spinner-down"]="",k},_buttonOptions:function(k){return this._buildSimpleOptions(k,"ui-button")},_checkboxradioOptions:function(k){return this._buildSimpleOptions(k,"ui-checkboxradio-label")},_selectmenuOptions:function(k){var w=this.options.direction==="vertical";return{width:!!w&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(w?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(w?"top":"left")},last:{"ui-selectmenu-button-open":w?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(w?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[k]}},_resolveClassesValues:function(k,w){var C={};return n.each(k,function(T){var z=w.options.classes[T]||"",z=n.trim(z.replace(O,""));C[T]=(z+" "+k[T]).replace(/\s+/g," ")}),C},_setOption:function(k,w){k==="direction"&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(k,w),k!=="disabled"?this.refresh():this._callChildMethod(w?"disable":"enable")},refresh:function(){var k,w=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),this.options.direction==="horizontal"&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),k=this.childWidgets,this.options.onlyVisible&&(k=k.filter(":visible")),k.length&&(n.each(["first","last"],function(C,T){var z,A=k[T]().data("ui-controlgroup-data");A&&w["_"+A.widgetName+"Options"]?((z=w["_"+A.widgetName+"Options"](k.length===1?"only":T)).classes=w._resolveClassesValues(z.classes,A),A.element[A.widgetName](z)):w._updateCornerClass(k[T](),T)}),this._callChildMethod("refresh"))}}),n.widget("ui.checkboxradio",[n.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var k,w=this,C=this._super()||{};return this._readType(),k=this.element.labels(),this.label=n(k[k.length-1]),this.label.length||n.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){w.originalLabel+=this.nodeType===3?n(this).text():this.outerHTML}),this.originalLabel&&(C.label=this.originalLabel),(k=this.element[0].disabled)!=null&&(C.disabled=k),C},_create:function(){var k=this.element[0].checked;this._bindFormResetHandler(),this.options.disabled==null&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),this.type==="radio"&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),k&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var k=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,k==="input"&&/radio|checkbox/.test(this.type)||n.error("Can't create checkboxradio on element.nodeName="+k+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var k=this.element[0].name,w="input[name='"+n.ui.escapeSelector(k)+"']";return k?(this.form.length?n(this.form[0].elements).filter(w):n(w).filter(function(){return n(this).form().length===0})).not(this.element):n([])},_toggleClasses:function(){var k=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",k),this.options.icon&&this.type==="checkbox"&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",k)._toggleClass(this.icon,null,"ui-icon-blank",!k),this.type==="radio"&&this._getRadioGroup().each(function(){var w=n(this).checkboxradio("instance");w&&w._removeClass(w.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(k,w){if(k!=="label"||w){if(this._super(k,w),k==="disabled")return this._toggleClass(this.label,null,"ui-state-disabled",w),void(this.element[0].disabled=w);this.refresh()}},_updateIcon:function(k){var w="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=n("<span>"),this.iconSpace=n("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),this.type==="checkbox"?(w+=k?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,k?"ui-icon-blank":"ui-icon-check")):w+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",w),k||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):this.icon!==void 0&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var k=this.label.contents().not(this.element[0]);this.icon&&(k=k.not(this.icon[0])),this.iconSpace&&(k=k.not(this.iconSpace[0])),k.remove(),this.label.append(this.options.label)},refresh:function(){var k=this.element[0].checked,w=this.element[0].disabled;this._updateIcon(k),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",k),this.options.label!==null&&this._updateLabel(),w!==this.options.disabled&&this._setOptions({disabled:w})}}]),n.ui.checkboxradio,n.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var k,w=this._super()||{};return this.isInput=this.element.is("input"),(k=this.element[0].disabled)!=null&&(w.disabled=k),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(w.label=this.originalLabel),w},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),this.options.disabled==null&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(k){k.keyCode===n.ui.keyCode.SPACE&&(k.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(k,w){var C=k!=="iconPosition",T=C?this.options.iconPosition:w,k=T==="top"||T==="bottom";this.icon?C&&this._removeClass(this.icon,null,this.options.icon):(this.icon=n("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),C&&this._addClass(this.icon,null,w),this._attachIcon(T),k?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=n("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(T))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(k){this.icon[/^(?:end|bottom)/.test(k)?"before":"after"](this.iconSpace)},_attachIcon:function(k){this.element[/^(?:end|bottom)/.test(k)?"append":"prepend"](this.icon)},_setOptions:function(k){var w=(k.showLabel===void 0?this.options:k).showLabel,C=(k.icon===void 0?this.options:k).icon;w||C||(k.showLabel=!0),this._super(k)},_setOption:function(k,w){k==="icon"&&(w?this._updateIcon(k,w):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),k==="iconPosition"&&this._updateIcon(k,w),k==="showLabel"&&(this._toggleClass("ui-button-icon-only",null,!w),this._updateTooltip()),k==="label"&&(this.isInput?this.element.val(w):(this.element.html(w),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(k,w),k==="disabled"&&(this._toggleClass(null,"ui-state-disabled",w),(this.element[0].disabled=w)&&this.element.blur())},refresh:function(){var k=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");k!==this.options.disabled&&this._setOptions({disabled:k}),this._updateTooltip()}}),n.uiBackCompat!==!1&&(n.widget("ui.button",n.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(k,w){k!=="text"?(k==="showLabel"&&(this.options.text=w),k==="icon"&&(this.options.icons.primary=w),k==="icons"&&(w.primary?(this._super("icon",w.primary),this._super("iconPosition","beginning")):w.secondary&&(this._super("icon",w.secondary),this._super("iconPosition","end"))),this._superApply(arguments)):this._super("showLabel",w)}}),n.fn.button=(I=n.fn.button,function(){return!this.length||this.length&&this[0].tagName!=="INPUT"||this.length&&this[0].tagName==="INPUT"&&this.attr("type")!=="checkbox"&&this.attr("type")!=="radio"?I.apply(this,arguments):(n.ui.checkboxradio||n.error("Checkboxradio widget missing"),arguments.length===0?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}),n.fn.buttonset=function(){return n.ui.controlgroup||n.error("Controlgroup widget missing"),arguments[0]==="option"&&arguments[1]==="items"&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):arguments[0]==="option"&&arguments[1]==="items"?this.controlgroup.apply(this,[arguments[0],"items.button"]):(typeof arguments[0]=="object"&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),n.ui.button,n.ui.safeActiveElement=function(k){var w;try{w=k.activeElement}catch(C){w=k.body}return(w=w||k.body).nodeName||(w=k.body),w},n.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(k){k.preventDefault()},"click .ui-menu-item":function(k){var w=n(k.target),C=n(n.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&w.not(".ui-state-disabled").length&&(this.select(k),k.isPropagationStopped()||(this.mouseHandled=!0),w.has(".ui-menu").length?this.expand(k):!this.element.is(":focus")&&C.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(k){var w,C;this.previousFilter||(w=n(k.target).closest(".ui-menu-item"),C=n(k.currentTarget),w[0]===C[0]&&(this._removeClass(C.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(k,C)))},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(k,w){var C=this.active||this.element.find(this.options.items).eq(0);w||this.focus(k,C)},blur:function(k){this._delay(function(){n.contains(this.element[0],n.ui.safeActiveElement(this.document[0]))||this.collapseAll(k)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(k){this._closeOnDocumentClick(k)&&this.collapseAll(k),this.mouseHandled=!1}})},_destroy:function(){var k=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),k.children().each(function(){var w=n(this);w.data("ui-menu-submenu-caret")&&w.remove()})},_keydown:function(k){var w,C,T,z=!0;switch(k.keyCode){case n.ui.keyCode.PAGE_UP:this.previousPage(k);break;case n.ui.keyCode.PAGE_DOWN:this.nextPage(k);break;case n.ui.keyCode.HOME:this._move("first","first",k);break;case n.ui.keyCode.END:this._move("last","last",k);break;case n.ui.keyCode.UP:this.previous(k);break;case n.ui.keyCode.DOWN:this.next(k);break;case n.ui.keyCode.LEFT:this.collapse(k);break;case n.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(k);break;case n.ui.keyCode.ENTER:case n.ui.keyCode.SPACE:this._activate(k);break;case n.ui.keyCode.ESCAPE:this.collapse(k);break;default:z=!1,w=this.previousFilter||"",T=!1,C=96<=k.keyCode&&k.keyCode<=105?(k.keyCode-96).toString():String.fromCharCode(k.keyCode),clearTimeout(this.filterTimer),C===w?T=!0:C=w+C,w=this._filterMenuItems(C),(w=T&&w.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):w).length||(C=String.fromCharCode(k.keyCode),w=this._filterMenuItems(C)),w.length?(this.focus(k,w),this.previousFilter=C,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}z&&k.preventDefault()},_activate:function(k){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(k):this.select(k))},refresh:function(){var k,w,C=this,T=this.options.icons.submenu,z=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),w=z.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var A=n(this),M=A.prev(),P=n("<span>").data("ui-menu-submenu-caret",!0);C._addClass(P,"ui-menu-icon","ui-icon "+T),M.attr("aria-haspopup","true").prepend(P),A.attr("aria-labelledby",M.attr("id"))}),this._addClass(w,"ui-menu","ui-widget ui-widget-content ui-front"),(k=z.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var A=n(this);C._isDivider(A)&&C._addClass(A,"ui-menu-divider","ui-widget-content")}),z=(w=k.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(w,"ui-menu-item")._addClass(z,"ui-menu-item-wrapper"),k.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!n.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(k,w){var C;k==="icons"&&(C=this.element.find(".ui-menu-icon"),this._removeClass(C,null,this.options.icons.submenu)._addClass(C,null,w.submenu)),this._super(k,w)},_setOptionDisabled:function(k){this._super(k),this.element.attr("aria-disabled",String(k)),this._toggleClass(null,"ui-state-disabled",!!k)},focus:function(k,w){var C;this.blur(k,k&&k.type==="focus"),this._scrollIntoView(w),this.active=w.first(),C=this.active.children(".ui-menu-item-wrapper"),this._addClass(C,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",C.attr("id")),C=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(C,null,"ui-state-active"),k&&k.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),(C=w.children(".ui-menu")).length&&k&&/^mouse/.test(k.type)&&this._startOpening(C),this.activeMenu=w.parent(),this._trigger("focus",k,{item:w})},_scrollIntoView:function(k){var w,C,T;this._hasScroll()&&(C=parseFloat(n.css(this.activeMenu[0],"borderTopWidth"))||0,T=parseFloat(n.css(this.activeMenu[0],"paddingTop"))||0,w=k.offset().top-this.activeMenu.offset().top-C-T,C=this.activeMenu.scrollTop(),T=this.activeMenu.height(),k=k.outerHeight(),w<0?this.activeMenu.scrollTop(C+w):T<w+k&&this.activeMenu.scrollTop(C+w-T+k))},blur:function(k,w){w||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",k,{item:this.active}),this.active=null)},_startOpening:function(k){clearTimeout(this.timer),k.attr("aria-hidden")==="true"&&(this.timer=this._delay(function(){this._close(),this._open(k)},this.delay))},_open:function(k){var w=n.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(k.parents(".ui-menu")).hide().attr("aria-hidden","true"),k.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(w)},collapseAll:function(k,w){clearTimeout(this.timer),this.timer=this._delay(function(){var C=w?this.element:n(k&&k.target).closest(this.element.find(".ui-menu"));C.length||(C=this.element),this._close(C),this.blur(k),this._removeClass(C.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=C},this.delay)},_close:function(k){(k=k||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(k){return!n(k.target).closest(".ui-menu").length},_isDivider:function(k){return!/[^\-\u2014\u2013\s]/.test(k.text())},collapse:function(k){var w=this.active&&this.active.parent().closest(".ui-menu-item",this.element);w&&w.length&&(this._close(),this.focus(k,w))},expand:function(k){var w=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();w&&w.length&&(this._open(w.parent()),this._delay(function(){this.focus(k,w)}))},next:function(k){this._move("next","first",k)},previous:function(k){this._move("prev","last",k)},isFirstItem:function(){return this.active&&!this.active.preval(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(k,w,C){var T;this.active&&(T=k==="first"||k==="last"?this.active[k==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[k+"All"](".ui-menu-item").eq(0)),T&&T.length&&this.active||(T=this.activeMenu.find(this.options.items)[w]()),this.focus(C,T)},nextPage:function(k){var w,C,T;this.active?this.isLastItem()||(this._hasScroll()?(C=this.active.offset().top,T=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(w=n(this)).offset().top-C-T<0}),this.focus(k,w)):this.focus(k,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())):this.next(k)},previousPage:function(k){var w,C,T;this.active?this.isFirstItem()||(this._hasScroll()?(C=this.active.offset().top,T=this.element.height(),this.active.preval(".ui-menu-item").each(function(){return 0<(w=n(this)).offset().top-C+T}),this.focus(k,w)):this.focus(k,this.activeMenu.find(this.options.items).first())):this.next(k)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(k){this.active=this.active||n(k.target).closest(".ui-menu-item");var w={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(k,!0),this._trigger("select",k,w)},_filterMenuItems:function(k){var k=k.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),w=new RegExp("^"+k,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return w.test(n.trim(n(this).children(".ui-menu-item-wrapper").text()))})}}),n.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var F=!1;function D(k){return function(){var w=this.element.val();k.apply(this,arguments),this._refresh(),w!==this.element.val()&&this._trigger("change")}}n(document).on("mouseup",function(){F=!1}),n.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var k=this;this.element.on("mousedown."+this.widgetName,function(w){return k._mouseDown(w)}).on("click."+this.widgetName,function(w){if(n.data(w.target,k.widgetName+".preventClickEvent")===!0)return n.removeData(w.target,k.widgetName+".preventClickEvent"),w.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(k){if(!F){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(k),this._mouseDownEvent=k;var w=this,C=k.which===1,T=!(typeof this.options.cancel!="string"||!k.target.nodeName)&&n(k.target).closest(this.options.cancel).length;return!(C&&!T&&this._mouseCapture(k))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){w.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(k)&&this._mouseDelayMet(k)&&(this._mouseStarted=this._mouseStart(k)!==!1,!this._mouseStarted)?(k.preventDefault(),!0):(n.data(k.target,this.widgetName+".preventClickEvent")===!0&&n.removeData(k.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(z){return w._mouseMove(z)},this._mouseUpDelegate=function(z){return w._mouseUp(z)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),k.preventDefault(),F=!0))}},_mouseMove:function(k){if(this._mouseMoved){if(n.ui.ie&&(!document.documentMode||document.documentMode<9)&&!k.button)return this._mouseUp(k);if(!k.which){if(k.originalEvent.altKey||k.originalEvent.ctrlKey||k.originalEvent.metaKey||k.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(k)}}return(k.which||k.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(k),k.preventDefault()):(this._mouseDistanceMet(k)&&this._mouseDelayMet(k)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,k)!==!1,this._mouseStarted?this._mouseDrag(k):this._mouseUp(k)),!this._mouseStarted)},_mouseUp:function(k){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,k.target===this._mouseDownEvent.target&&n.data(k.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(k)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,F=!1,k.preventDefault()},_mouseDistanceMet:function(k){return Math.max(Math.abs(this._mouseDownEvent.pageX-k.pageX),Math.abs(this._mouseDownEvent.pageY-k.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),n.widget("ui.selectmenu",[n.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var k=this.element.uniqueId().attr("id");this.ids={element:k,button:k+"-button",menu:k+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=n()},_drawButton:function(){var k,w=this,C=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(T){this.button.focus(),T.preventDefault()}}),this.element.hide(),this.button=n("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),k=n("<span>").appendTo(this.button),this._addClass(k,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(C).appendTo(this.button),this.options.width!==!1&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){w._rendered||w._refreshMenu()})},_drawMenu:function(){var k=this;this.menu=n("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=n("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(w,C){w.preventDefault(),k._setSelection(),k._select(C.item.data("ui-selectmenu-item"),w)},focus:function(w,C){C=C.item.data("ui-selectmenu-item"),k.focusIndex!=null&&C.index!==k.focusIndex&&(k._trigger("focus",w,{item:C}),k.isOpen||k._select(C,w)),k.focusIndex=C.index,k.button.attr("aria-activedescendant",k.menuItems.eq(C.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),this.options.width===null&&this._resizeButton()},_refreshMenu:function(){var k=this.element.find("option");this.menu.empty(),this._parseOptions(k),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,k.length&&(k=this._getSelectedItem(),this.menuInstance.focus(null,k),this._setAria(k.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(k){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",k)))},_position:function(){this.menuWrap.position(n.extend({of:this.button},this.options.position))},close:function(k){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",k))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(k){var w=n("<span>");return this._setText(w,k.label),this._addClass(w,"ui-selectmenu-text"),w},_renderMenu:function(k,w){var C=this,T="";n.each(w,function(z,A){var M;A.optgroup!==T&&(M=n("<li>",{text:A.optgroup}),C._addClass(M,"ui-selectmenu-optgroup","ui-menu-divider"+(A.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),M.appendTo(k),T=A.optgroup),C._renderItemData(k,A)})},_renderItemData:function(k,w){return this._renderItem(k,w).data("ui-selectmenu-item",w)},_renderItem:function(k,w){var C=n("<li>"),T=n("<div>",{title:w.element.attr("title")});return w.disabled&&this._addClass(C,null,"ui-state-disabled"),this._setText(T,w.label),C.append(T).appendTo(k)},_setText:function(k,w){w?k.text(w):k.html("&#160;")},_move:function(k,w){var C,T=".ui-menu-item";this.isOpen?C=this.menuItems.eq(this.focusIndex).parent("li"):(C=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),T+=":not(.ui-state-disabled)"),(T=k==="first"||k==="last"?C[k==="first"?"prevAll":"nextAll"](T).eq(-1):C[k+"All"](T).eq(0)).length&&this.menuInstance.focus(w,T)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(k){this[this.isOpen?"close":"open"](k)},_setSelection:function(){var k;this.range&&(window.getSelection?((k=window.getSelection()).removeAllRanges(),k.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(k){this.isOpen&&(n(k.target).closest(".ui-selectmenu-menu, #"+n.ui.escapeSelector(this.ids.button)).length||this.close(k))}},_buttonEvents:{mousedown:function(){var k;window.getSelection?(k=window.getSelection()).rangeCount&&(this.range=k.getRangeAt(0)):this.range=document.selection.createRange()},click:function(k){this._setSelection(),this._toggle(k)},keydown:function(k){var w=!0;switch(k.keyCode){case n.ui.keyCode.TAB:case n.ui.keyCode.ESCAPE:this.close(k),w=!1;break;case n.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(k);break;case n.ui.keyCode.UP:k.altKey?this._toggle(k):this._move("prev",k);break;case n.ui.keyCode.DOWN:k.altKey?this._toggle(k):this._move("next",k);break;case n.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(k):this._toggle(k);break;case n.ui.keyCode.LEFT:this._move("prev",k);break;case n.ui.keyCode.RIGHT:this._move("next",k);break;case n.ui.keyCode.HOME:case n.ui.keyCode.PAGE_UP:this._move("first",k);break;case n.ui.keyCode.END:case n.ui.keyCode.PAGE_DOWN:this._move("last",k);break;default:this.menu.trigger(k),w=!1}w&&k.preventDefault()}},_selectFocusedItem:function(k){var w=this.menuItems.eq(this.focusIndex).parent("li");w.hasClass("ui-state-disabled")||this._select(w.data("ui-selectmenu-item"),k)},_select:function(k,w){var C=this.element[0].selectedIndex;this.element[0].selectedIndex=k.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(k)),this._setAria(k),this._trigger("select",w,{item:k}),k.index!==C&&this._trigger("change",w,{item:k}),this.close(w)},_setAria:function(k){k=this.menuItems.eq(k.index).attr("id"),this.button.attr({"aria-labelledby":k,"aria-activedescendant":k}),this.menu.attr("aria-activedescendant",k)},_setOption:function(k,w){var C;k==="icons"&&(C=this.button.find("span.ui-icon"),this._removeClass(C,null,this.options.icons.button)._addClass(C,null,w.button)),this._super(k,w),k==="appendTo"&&this.menuWrap.appendTo(this._appendTo()),k==="width"&&this._resizeButton()},_setOptionDisabled:function(k){this._super(k),this.menuInstance.option("disabled",k),this.button.attr("aria-disabled",k),this._toggleClass(this.button,null,"ui-state-disabled",k),this.element.prop("disabled",k),k?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var k=this.options.appendTo;return(k=k&&(k.jquery||k.nodeType?n(k):this.document.find(k).eq(0)))&&k[0]||(k=this.element.closest(".ui-front, dialog")),k.length||(k=this.document[0].body),k},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var k=this.options.width;k!==!1?(k===null&&(k=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(k)):this.button.css("width","")},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var k=this._super();return k.disabled=this.element.prop("disabled"),k},_parseOptions:function(k){var w=this,C=[];k.each(function(T,z){C.push(w._parseOption(n(z),T))}),this.items=C},_parseOption:function(k,w){var C=k.parent("optgroup");return{element:k,index:w,value:k.val(),label:k.text(),optgroup:C.attr("label")||"",disabled:C.prop("disabled")||k.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),n.widget("ui.slider",n.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var k,w=this.options,C=this.element.find(".ui-slider-handle"),T=[],z=w.values&&w.values.length||1;for(C.length>z&&(C.slice(z).remove(),C=C.slice(0,z)),k=C.length;k<z;k++)T.push("<span tabindex='0'></span>");this.handles=C.add(n(T.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(A){n(this).data("ui-slider-handle-index",A).attr("tabIndex",0)})},_createRange:function(){var k=this.options;k.range?(k.range===!0&&(k.values?k.values.length&&k.values.length!==2?k.values=[k.values[0],k.values[0]]:n.isArray(k.values)&&(k.values=k.values.slice(0)):k.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=n("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),k.range!=="min"&&k.range!=="max"||this._addClass(this.range,"ui-slider-range-"+k.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(k){var w,C,T,z,A,M,P=this,N=this.options;return!N.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),M={x:k.pageX,y:k.pageY},w=this._normValueFromMouse(M),C=this._valueMax()-this._valueMin()+1,this.handles.each(function(E){var B=Math.abs(w-P.values(E));(B<C||C===B&&(E===P._lastChangedValue||P.values(E)===N.min))&&(C=B,T=n(this),z=E)}),this._start(k,z)!==!1&&(this._mouseSliding=!0,this._handleIndex=z,this._addClass(T,null,"ui-state-active"),T.trigger("focus"),A=T.offset(),M=!n(k.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=M?{left:0,top:0}:{left:k.pageX-A.left,top:k.pageY-A.top-T.height()/2-(parseInt(T.css("borderTopWidth"),10)||0)-(parseInt(T.css("borderBottomWidth"),10)||0)+(parseInt(T.css("marginTop"),10)||0)},this._animateOff=!0))},_mouseStart:function(){return!0},_mouseDrag:function(k){var w={x:k.pageX,y:k.pageY},w=this._normValueFromMouse(w);return this._slide(k,this._handleIndex,w),!1},_mouseStop:function(k){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(k,this._handleIndex),this._change(k,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(k){var w,k=this.orientation==="horizontal"?(w=this.elementSize.width,k.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(w=this.elementSize.height,k.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));return 1<(k=k/w)&&(k=1),k<0&&(k=0),this.orientation==="vertical"&&(k=1-k),w=this._valueMax()-this._valueMin(),w=this._valueMin()+k*w,this._trimAlignValue(w)},_uiHash:function(k,w,C){var T={handle:this.handles[k],handleIndex:k,value:w!==void 0?w:this.value()};return this._hasMultipleValues()&&(T.value=w!==void 0?w:this.values(k),T.values=C||this.values()),T},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(k,w){return this._trigger("start",k,this._uiHash(w))},_slide:function(k,w,C){var T,z=this.value(),A=this.values();this._hasMultipleValues()&&(T=this.values(w?0:1),z=this.values(w),this.options.values.length===2&&this.options.range===!0&&(C=w===0?Math.min(T,C):Math.max(T,C)),A[w]=C),C!==z&&this._trigger("slide",k,this._uiHash(w,C,A))!==!1&&(this._hasMultipleValues()?this.values(w,C):this.value(C))},_stop:function(k,w){this._trigger("stop",k,this._uiHash(w))},_change:function(k,w){this._keySliding||this._mouseSliding||(this._lastChangedValue=w,this._trigger("change",k,this._uiHash(w)))},value:function(k){return arguments.length?(this.options.value=this._trimAlignValue(k),this._refreshValue(),void this._change(null,0)):this._value()},values:function(k,w){var C,T,z;if(1<arguments.length)return this.options.values[k]=this._trimAlignValue(w),this._refreshValue(),void this._change(null,k);if(!arguments.length)return this._values();if(!n.isArray(k))return this._hasMultipleValues()?this._values(k):this.value();for(C=this.options.values,T=k,z=0;z<C.length;z+=1)C[z]=this._trimAlignValue(T[z]),this._change(null,z);this._refreshValue()},_setOption:function(k,w){var C,T=0;switch(k==="range"&&this.options.range===!0&&(w==="min"?(this.options.value=this._values(0),this.options.values=null):w==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),n.isArray(this.options.values)&&(T=this.options.values.length),this._super(k,w),k){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(w),this.handles.css(w==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),C=T-1;0<=C;C--)this._change(null,C);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(k){this._super(k),this._toggleClass(null,"ui-state-disabled",!!k)},_value:function(){var k=this.options.value;return this._trimAlignValue(k)},_values:function(k){var w,C,T;if(arguments.length)return w=this.options.values[k],this._trimAlignValue(w);if(this._hasMultipleValues()){for(C=this.options.values.slice(),T=0;T<C.length;T+=1)C[T]=this._trimAlignValue(C[T]);return C}return[]},_trimAlignValue:function(k){if(k<=this._valueMin())return this._valueMin();if(k>=this._valueMax())return this._valueMax();var w=0<this.options.step?this.options.step:1,C=(k-this._valueMin())%w,k=k-C;return 2*Math.abs(C)>=w&&(k+=0<C?w:-w),parseFloat(k.toFixed(5))},_calculateNewMax:function(){var k=this.options.max,w=this._valueMin(),C=this.options.step;(k=Math.round((k-w)/C)*C+w)>this.options.max&&(k-=C),this.max=parseFloat(k.toFixed(this._precision()))},_precision:function(){var k=this._precisionOf(this.options.step);return this.options.min!==null&&(k=Math.max(k,this._precisionOf(this.options.min))),k},_precisionOf:function(k){var w=k.toString(),k=w.indexOf(".");return k===-1?0:w.length-k-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(k){k==="vertical"&&this.range.css({width:"",left:""}),k==="horizontal"&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var k,w,C,T,z,A=this.options.range,M=this.options,P=this,N=!this._animateOff&&M.animate,E={};this._hasMultipleValues()?this.handles.each(function(B){w=(P.values(B)-P._valueMin())/(P._valueMax()-P._valueMin())*100,E[P.orientation==="horizontal"?"left":"bottom"]=w+"%",n(this).stop(1,1)[N?"animate":"css"](E,M.animate),P.options.range===!0&&(P.orientation==="horizontal"?(B===0&&P.range.stop(1,1)[N?"animate":"css"]({left:w+"%"},M.animate),B===1&&P.range[N?"animate":"css"]({width:w-k+"%"},{queue:!1,duration:M.animate})):(B===0&&P.range.stop(1,1)[N?"animate":"css"]({bottom:w+"%"},M.animate),B===1&&P.range[N?"animate":"css"]({height:w-k+"%"},{queue:!1,duration:M.animate}))),k=w}):(C=this.value(),T=this._valueMin(),z=this._valueMax(),w=z!==T?(C-T)/(z-T)*100:0,E[this.orientation==="horizontal"?"left":"bottom"]=w+"%",this.handle.stop(1,1)[N?"animate":"css"](E,M.animate),A==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[N?"animate":"css"]({width:w+"%"},M.animate),A==="max"&&this.orientation==="horizontal"&&this.range.stop(1,1)[N?"animate":"css"]({width:100-w+"%"},M.animate),A==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[N?"animate":"css"]({height:w+"%"},M.animate),A==="max"&&this.orientation==="vertical"&&this.range.stop(1,1)[N?"animate":"css"]({height:100-w+"%"},M.animate))},_handleEvents:{keydown:function(k){var w,C,T,z=n(k.target).data("ui-slider-handle-index");switch(k.keyCode){case n.ui.keyCode.HOME:case n.ui.keyCode.END:case n.ui.keyCode.PAGE_UP:case n.ui.keyCode.PAGE_DOWN:case n.ui.keyCode.UP:case n.ui.keyCode.RIGHT:case n.ui.keyCode.DOWN:case n.ui.keyCode.LEFT:if(k.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(n(k.target),null,"ui-state-active"),this._start(k,z)===!1))return}switch(T=this.options.step,w=C=this._hasMultipleValues()?this.values(z):this.value(),k.keyCode){case n.ui.keyCode.HOME:C=this._valueMin();break;case n.ui.keyCode.END:C=this._valueMax();break;case n.ui.keyCode.PAGE_UP:C=this._trimAlignValue(w+(this._valueMax()-this._valueMin())/this.numPages);break;case n.ui.keyCode.PAGE_DOWN:C=this._trimAlignValue(w-(this._valueMax()-this._valueMin())/this.numPages);break;case n.ui.keyCode.UP:case n.ui.keyCode.RIGHT:if(w===this._valueMax())return;C=this._trimAlignValue(w+T);break;case n.ui.keyCode.DOWN:case n.ui.keyCode.LEFT:if(w===this._valueMin())return;C=this._trimAlignValue(w-T)}this._slide(k,z,C)},keyup:function(k){var w=n(k.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(k,w),this._change(k,w),this._removeClass(n(k.target),null,"ui-state-active"))}}}),n.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this.value()!==""&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var k=this._super(),w=this.element;return n.each(["min","max","step"],function(C,T){var z=w.attr(T);z!=null&&z.length&&(k[T]=z)}),k},_events:{keydown:function(k){this._start(k)&&this._keydown(k)&&k.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(k){this.cancelBlur?delete this.cancelBlur:(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",k))},mousewheel:function(k,w){if(w){if(!this.spinning&&!this._start(k))return!1;this._spin((0<w?1:-1)*this.options.step,k),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(k)},100),k.preventDefault()}},"mousedown .ui-spinner-button":function(k){var w;function C(){this.element[0]===n.ui.safeActiveElement(this.document[0])||(this.element.trigger("focus"),this.previous=w,this._delay(function(){this.previous=w}))}w=this.element[0]===n.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),k.preventDefault(),C.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,C.call(this)}),this._start(k)!==!1&&this._repeat(null,n(k.currentTarget).hasClass("ui-spinner-up")?1:-1,k)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(k){if(n(k.currentTarget).hasClass("ui-state-active"))return this._start(k)!==!1&&void this._repeat(null,n(k.currentTarget).hasClass("ui-spinner-up")?1:-1,k)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&0<this.uiSpinner.height()&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(k){var w=this.options,C=n.ui.keyCode;switch(k.keyCode){case C.UP:return this._repeat(null,1,k),!0;case C.DOWN:return this._repeat(null,-1,k),!0;case C.PAGE_UP:return this._repeat(null,w.page,k),!0;case C.PAGE_DOWN:return this._repeat(null,-w.page,k),!0}return!1},_start:function(k){return!(!this.spinning&&this._trigger("start",k)===!1)&&(this.counter||(this.counter=1),this.spinning=!0)},_repeat:function(k,w,C){k=k||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,w,C)},k),this._spin(w*this.options.step,C)},_spin:function(k,w){var C=this.value()||0;this.counter||(this.counter=1),C=this._adjustValue(C+k*this._increment(this.counter)),this.spinning&&this._trigger("spin",w,{value:C})===!1||(this._value(C),this.counter++)},_increment:function(k){var w=this.options.incremental;return w?n.isFunction(w)?w(k):Math.floor(k*k*k/5e4-k*k/500+17*k/200+1):1},_precision:function(){var k=this._precisionOf(this.options.step);return this.options.min!==null&&(k=Math.max(k,this._precisionOf(this.options.min))),k},_precisionOf:function(k){var w=k.toString(),k=w.indexOf(".");return k===-1?0:w.length-k-1},_adjustValue:function(k){var w,C=this.options,T=k-(w=C.min!==null?C.min:0);return k=w+Math.round(T/C.step)*C.step,k=parseFloat(k.toFixed(this._precision())),C.max!==null&&k>C.max?C.max:C.min!==null&&k<C.min?C.min:k},_stop:function(k){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",k))},_setOption:function(k,w){var C;if(k==="culture"||k==="numberFormat")return C=this._parse(this.element.val()),this.options[k]=w,void this.element.val(this._format(C));k!=="max"&&k!=="min"&&k!=="step"||typeof w=="string"&&(w=this._parse(w)),k==="icons"&&(C=this.buttons.first().find(".ui-icon"),this._removeClass(C,null,this.options.icons.up),this._addClass(C,null,w.up),C=this.buttons.last().find(".ui-icon"),this._removeClass(C,null,this.options.icons.down),this._addClass(C,null,w.down)),this._super(k,w)},_setOptionDisabled:function(k){this._super(k),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!k),this.element.prop("disabled",!!k),this.buttons.button(k?"disable":"enable")},_setOptions:D(function(k){this._super(k)}),_parse:function(k){return typeof k=="string"&&k!==""&&(k=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(k,10,this.options.culture):+k),k===""||isNaN(k)?null:k},_format:function(k){return k===""?"":window.Globalize&&this.options.numberFormat?Globalize.format(k,this.options.numberFormat,this.options.culture):k},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var k=this.value();return k!==null&&k===this._adjustValue(k)},_value:function(k,w){var C;k!==""&&(C=this._parse(k))!==null&&(w||(C=this._adjustValue(C)),k=this._format(C)),this.element.val(k),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:D(function(k){this._stepUp(k)}),_stepUp:function(k){this._start()&&(this._spin((k||1)*this.options.step),this._stop())},stepDown:D(function(k){this._stepDown(k)}),_stepDown:function(k){this._start()&&(this._spin((k||1)*-this.options.step),this._stop())},pageUp:D(function(k){this._stepUp((k||1)*this.options.page)}),pageDown:D(function(k){this._stepDown((k||1)*this.options.page)}),value:function(k){if(!arguments.length)return this._parse(this.element.val());D(this._value).call(this,k)},widget:function(){return this.uiSpinner}}),n.uiBackCompat!==!1&&n.widget("ui.spinner",n.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),n.ui.spinner};typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)}(),function(e){typeof define=="function"&&define.amd?define(["jquery"],e):typeof kn=="object"?In.exports=e:e(jQuery)}(function(e){function n(g){var b,y=g||window.event,p=f.call(arguments,1),x=0,_=0,S=0,I=0,O=0,F=0;if((g=e.event.fix(y)).type="mousewheel","detail"in y&&(S=-1*y.detail),"wheelDelta"in y&&(S=y.wheelDelta),"wheelDeltaY"in y&&(S=y.wheelDeltaY),"wheelDeltaX"in y&&(_=-1*y.wheelDeltaX),"axis"in y&&y.axis===y.HORIZONTAL_AXIS&&(_=-1*S,S=0),x=S===0?_:S,"deltaY"in y&&(x=S=-1*y.deltaY),"deltaX"in y&&(_=y.deltaX,S===0&&(x=-1*_)),S!==0||_!==0){y.deltaMode===1?(x*=b=e.data(this,"mousewheel-line-height"),S*=b,_*=b):y.deltaMode===2&&(x*=b=e.data(this,"mousewheel-page-height"),S*=b,_*=b);var I=Math.max(Math.abs(S),Math.abs(_));return a&&!(I<a)||l(y,a=I)&&(a/=40),l(y,I)&&(x/=40,_/=40,S/=40),x=Math[1<=x?"floor":"ceil"](x/a),_=Math[1<=_?"floor":"ceil"](_/a),S=Math[1<=S?"floor":"ceil"](S/a),d.settings.normalizeOffset&&this.getBoundingClientRect&&(I=this.getBoundingClientRect(),O=g.clientX-I.left,F=g.clientY-I.top),g.deltaX=_,g.deltaY=S,g.deltaFactor=a,g.offsetX=O,g.offsetY=F,g.deltaMode=0,p.unshift(g,x,_,S),o&&clearTimeout(o),o=setTimeout(t,200),(e.event.dispatch||e.event.handle).apply(this,p)}}function t(){a=null}function l(g,b){return d.settings.adjustOldDeltas&&g.type==="mousewheel"&&b%120==0}var o,a,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],u="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],f=Array.prototype.slice;if(e.event.fixHooks)for(var m=s.length;m;)e.event.fixHooks[s[--m]]=e.event.mouseHooks;var d=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var g=u.length;g;)this.addEventListener(u[--g],n,!1);else this.onmousewheel=n;e.data(this,"mousewheel-line-height",d.getLineHeight(this)),e.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var g=u.length;g;)this.removeEventListener(u[--g],n,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(g){var b=e(g),g=b["offsetParent"in e.fn?"offsetParent":"parent"]();return g.length||(g=e("body")),parseInt(g.css("fontSize"),10)||parseInt(b.css("fontSize"),10)||16},getPageHeight:function(g){return e(g).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(g){return g?this.bind("mousewheel",g):this.trigger("mousewheel")},unmousewheel:function(g){return this.unbind("mousewheel",g)}})}),function(e){var n;typeof kn=="object"&&typeof In!="undefined"?In.exports=e():typeof define=="function"&&define.amd?define([],e):(typeof window!="undefined"?n=window:typeof global!="undefined"?n=global:typeof self!="undefined"&&(n=self),n.html2canvas=e())}(function(){return function e(n,t,l){function o(u,f){if(!t[u]){if(!n[u]){var m=typeof Wo=="function"&&Wo;if(!f&&m)return m(u,!0);if(a)return a(u,!0);throw m=new Error("Cannot find module '"+u+"'"),m.code="MODULE_NOT_FOUND",m}m=t[u]={exports:{}},n[u][0].call(m.exports,function(d){var g=n[u][1][d];return o(g||d)},m,m.exports,e,n,t,l)}return t[u].exports}for(var a=typeof Wo=="function"&&Wo,s=0;s<l.length;s++)o(l[s]);return o}({1:[function(e,n,t){(function(l){(function(o){function a(le){throw RangeError(N[le])}function s(le,he){for(var Z=le.length;Z--;)le[Z]=he(le[Z]);return le}function u(le,he){return s(le.split(P),he).join(".")}function f(le){for(var he,Z,ae=[],J=0,pe=le.length;J<pe;)55296<=(he=le.charCodeAt(J++))&&he<=56319&&J<pe?(64512&(Z=le.charCodeAt(J++)))==56320?ae.push(((1023&he)<<10)+(1023&Z)+65536):(ae.push(he),J--):ae.push(he);return ae}function m(le){return s(le,function(he){var Z="";return 65535<he&&(Z+=U((he-=65536)>>>10&1023|55296),he=56320|1023&he),Z+U(he)}).join("")}function d(le,he){return le+22+75*(le<26)-((he!=0)<<5)}function g(le,he,Z){var ae=0;for(le=Z?B(le/w):le>>1,le+=B(le/he);E*D>>1<le;ae+=O)le=B(le/E);return B(ae+(E+1)*le/(le+k))}function b(le){var he,Z,ae,J,pe,K,se,te=[],re=le.length,fe=0,Me=T,ye=C,Ye=le.lastIndexOf(z);for(Ye<0&&(Ye=0),Z=0;Z<Ye;++Z)128<=le.charCodeAt(Z)&&a("not-basic"),te.push(le.charCodeAt(Z));for(ae=0<Ye?Ye+1:0;ae<re;){for(J=fe,pe=1,K=O;re<=ae&&a("invalid-input"),se=le.charCodeAt(ae++),(O<=(se=se-48<10?se-22:se-65<26?se-65:se-97<26?se-97:O)||se>B((I-fe)/pe))&&a("overflow"),fe+=se*pe,!(se<(se=K<=ye?F:ye+D<=K?D:K-ye));K+=O)pe>B(I/(se=O-se))&&a("overflow"),pe*=se;ye=g(fe-J,he=te.length+1,J==0),B(fe/he)>I-Me&&a("overflow"),Me+=B(fe/he),fe%=he,te.splice(fe++,0,Me)}return m(te)}function y(le){for(var he,Z,ae,J,pe,K,se,te,re,fe,Me,ye=[],Ye=(le=f(le)).length,Ce=T,Ke=C,ft=he=0;ft<Ye;++ft)(te=le[ft])<128&&ye.push(U(te));for(Z=ae=ye.length,ae&&ye.push(z);Z<Ye;){for(J=I,ft=0;ft<Ye;++ft)Ce<=(te=le[ft])&&te<J&&(J=te);for(J-Ce>B((I-he)/(re=Z+1))&&a("overflow"),he+=(J-Ce)*re,Ce=J,ft=0;ft<Ye;++ft)if((te=le[ft])<Ce&&++he>I&&a("overflow"),te==Ce){for(pe=he,K=O;!(pe<(se=K<=Ke?F:Ke+D<=K?D:K-Ke));K+=O)Me=pe-se,fe=O-se,ye.push(U(d(se+Me%fe,0))),pe=B(Me/fe);ye.push(U(d(pe,0))),Ke=g(he,re,Z==ae),he=0,++Z}++he,++Ce}return ye.join("")}var p=typeof t=="object"&&t,x=typeof n=="object"&&n&&n.exports==p&&n,_=typeof l=="object"&&l;_.global!==_&&_.window!==_||(o=_);var S,I=2147483647,O=36,F=1,D=26,k=38,w=700,C=72,T=128,z="-",A=/^xn--/,M=/[^ -~]/,P=/\x2E|\u3002|\uFF0E|\uFF61/g,N={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=O-F,B=Math.floor,U=String.fromCharCode,X={version:"1.2.4",ucs2:{decode:f,encode:m},decode:b,encode:y,toASCII:function(le){return u(le,function(he){return M.test(he)?"xn--"+y(he):he})},toUnicode:function(le){return u(le,function(he){return A.test(he)?b(he.slice(4).toLowerCase()):he})}};if(p&&!p.nodeType)if(x)x.exports=X;else for(S in X)X.hasOwnProperty(S)&&(p[S]=X[S]);else o.punycode=X})(this)}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(e,n){function t(o,a){for(var s=o.nodeType===3?document.createTextNode(o.nodeValue):o.cloneNode(!1),u=o.firstChild;u;)a!==!0&&u.nodeType===1&&u.nodeName==="SCRIPT"||s.appendChild(t(u,a)),u=u.nextSibling;return o.nodeType===1&&(s._scrollTop=o.scrollTop,s._scrollLeft=o.scrollLeft,o.nodeName==="CANVAS"?function(f,m){try{m&&(m.width=f.width,m.height=f.height,m.getContext("2d").putImageData(f.getContext("2d").getImageData(0,0,f.width,f.height),0,0))}catch(d){l("Unable to copy canvas content from",f,d)}}(o,s):o.nodeName!=="TEXTAREA"&&o.nodeName!=="SELECT"||(s.value=o.value)),s}var l=e("./log");n.exports=function(o,a,s,u,f,m,d){var g=t(o.documentElement,f.javascriptEnabled),b=a.createElement("iframe");return b.className="html2canvas-container",b.style.visibility="hidden",b.style.position="fixed",b.style.left="-10000px",b.style.top="0px",b.style.border="0",b.width=s,b.height=u,b.scrolling="no",a.body.appendChild(b),new Promise(function(y){var p,x,_,S=b.contentWindow.document;b.contentWindow.onload=b.onload=function(){var I=setInterval(function(){0<S.body.childNodes.length&&(function O(F){if(F.nodeType===1){F.scrollTop=F._scrollTop,F.scrollLeft=F._scrollLeft;for(var D=F.firstChild;D;)O(D),D=D.nextSibling}}(S.documentElement),clearInterval(I),f.type==="view"&&(b.contentWindow.scrollTo(m,d),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||b.contentWindow.scrollY===d&&b.contentWindow.scrollX===m||(S.documentElement.style.top=-d+"px",S.documentElement.style.left=-m+"px",S.documentElement.style.position="absolute")),y(b))},50)},S.open(),S.write("<!DOCTYPE html><html></html>"),x=m,_=d,!(p=o).defaultView||x===p.defaultView.pageXOffset&&_===p.defaultView.pageYOffset||p.defaultView.scrollTo(x,_),S.replaceChild(S.adoptNode(g),S.documentElement),S.close()})}},{"./log":13}],3:[function(e,n){function t(f){this.r=0,this.g=0,this.b=0,this.a=null,this.fromArray(f)||this.namedColor(f)||this.rgb(f)||this.rgba(f)||this.hex6(f)||this.hex3(f)}t.prototype.darken=function(f){return f=1-f,new t([Math.round(this.r*f),Math.round(this.g*f),Math.round(this.b*f),this.a])},t.prototype.isTransparent=function(){return this.a===0},t.prototype.isBlack=function(){return this.r===0&&this.g===0&&this.b===0},t.prototype.fromArray=function(f){return Array.isArray(f)&&(this.r=Math.min(f[0],255),this.g=Math.min(f[1],255),this.b=Math.min(f[2],255),3<f.length&&(this.a=f[3])),Array.isArray(f)};var l=/^#([a-f0-9]{3})$/i;t.prototype.hex3=function(f){var m;return(m=f.match(l))!==null&&(this.r=parseInt(m[1][0]+m[1][0],16),this.g=parseInt(m[1][1]+m[1][1],16),this.b=parseInt(m[1][2]+m[1][2],16)),m!==null};var o=/^#([a-f0-9]{6})$/i;t.prototype.hex6=function(f){var m=null;return(m=f.match(o))!==null&&(this.r=parseInt(m[1].substring(0,2),16),this.g=parseInt(m[1].substring(2,4),16),this.b=parseInt(m[1].substring(4,6),16)),m!==null};var a=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;t.prototype.rgb=function(f){var m;return(m=f.match(a))!==null&&(this.r=Number(m[1]),this.g=Number(m[2]),this.b=Number(m[3])),m!==null};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;t.prototype.rgba=function(f){var m;return(m=f.match(s))!==null&&(this.r=Number(m[1]),this.g=Number(m[2]),this.b=Number(m[3]),this.a=Number(m[4])),m!==null},t.prototype.toString=function(){return this.a!==null&&this.a!==1?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},t.prototype.namedColor=function(f){f=f.toLowerCase();var m=u[f];if(m)this.r=m[0],this.g=m[1],this.b=m[2];else if(f==="transparent")return!(this.r=this.g=this.b=this.a=0);return!!m},t.prototype.isColor=!0;var u={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};n.exports=t},{}],4:[function(e,n){function t(S,I){var O,F,D=_++;if((I=I||{}).logging&&(d.options.logging=!0,d.options.start=Date.now()),I.async=I.async===void 0||I.async,I.allowTaint=I.allowTaint!==void 0&&I.allowTaint,I.removeContainer=I.removeContainer===void 0||I.removeContainer,I.javascriptEnabled=I.javascriptEnabled!==void 0&&I.javascriptEnabled,I.imageTimeout=I.imageTimeout===void 0?1e4:I.imageTimeout,I.renderer=typeof I.renderer=="function"?I.renderer:s,I.strict=!!I.strict,typeof S=="string"){if(typeof I.proxy!="string")return Promise.reject("Proxy must be used when rendering url");var k=I.width!=null?I.width:window.innerWidth,w=I.height!=null?I.height:window.innerHeight;return y((O=S,(F=document.createElement("a")).href=O,F.href=F.href,F),I.proxy,document,k,w,I).then(function(P){return l(P.contentWindow.document.documentElement,P,I,k,w)})}var C,T,z,A,M,S=(S===void 0?[document.documentElement]:S.length?S:[S])[0];return S.setAttribute(x+D,D),C=S.ownerDocument,T=I,z=S.ownerDocument.defaultView.innerWidth,A=S.ownerDocument.defaultView.innerHeight,M=D,b(C,C,z,A,T,C.defaultView.pageXOffset,C.defaultView.pageYOffset).then(function(P){d("Document cloned");var N=x+M,E="["+N+"='"+M+"']";C.querySelector(E).removeAttribute(N);var N=P.contentWindow,B=N.document.querySelector(E);return Promise.resolve(typeof T.onclone!="function"||T.onclone(N.document)).then(function(){return l(B,P,T,z,A)})}).then(function(P){return typeof I.onrendered=="function"&&(d("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),I.onrendered(P)),P})}function l(S,I,O,F,D){var k,w,C=I.contentWindow,T=new a(C.document),z=new u(O,T),A=p(S),w=O.type==="view"?F:(w=C.document,Math.max(Math.max(w.body.scrollWidth,w.documentElement.scrollWidth),Math.max(w.body.offsetWidth,w.documentElement.offsetWidth),Math.max(w.body.clientWidth,w.documentElement.clientWidth))),k=O.type==="view"?D:(k=C.document,Math.max(Math.max(k.body.scrollHeight,k.documentElement.scrollHeight),Math.max(k.body.offsetHeight,k.documentElement.offsetHeight),Math.max(k.body.clientHeight,k.documentElement.clientHeight))),M=new O.renderer(w,k,z,O,document);return new f(S,M,T,z,O).ready.then(function(){var P,N;return d("Finished rendering"),P=O.type==="view"?o(M.canvas,{width:M.canvas.width,height:M.canvas.height,top:0,left:0,x:0,y:0}):S===C.document.body||S===C.document.documentElement||O.canvas!=null?M.canvas:o(M.canvas,{width:(O.width!=null?O:A).width,height:(O.height!=null?O:A).height,top:A.top,left:A.left,x:0,y:0}),N=I,O.removeContainer&&(N.parentNode.removeChild(N),d("Cleaned up container")),P})}function o(S,I){var O=document.createElement("canvas"),F=Math.min(S.width-1,Math.max(0,I.left)),D=Math.min(S.width,Math.max(1,I.left+I.width)),k=Math.min(S.height-1,Math.max(0,I.top)),w=Math.min(S.height,Math.max(1,I.top+I.height));return O.width=I.width,O.height=I.height,D-=F,w-=k,d("Cropping canvas at:","left:",I.left,"top:",I.top,"width:",D,"height:",w),d("Resulting crop with width",I.width,"and height",I.height,"with x",F,"and y",k),O.getContext("2d").drawImage(S,F,k,D,w,I.x,I.y,D,w),O}var a=e("./support"),s=e("./renderers/canvas"),u=e("./imageloader"),f=e("./nodeparser"),m=e("./nodecontainer"),d=e("./log"),g=e("./utils"),b=e("./clone"),y=e("./proxy").loadUrlDocument,p=g.getBounds,x="data-html2canvas-node",_=0;t.CanvasRenderer=s,t.NodeContainer=m,t.log=d,t.utils=g,g=typeof document=="undefined"||typeof Object.create!="function"||typeof document.createElement("canvas").getContext!="function"?function(){return Promise.reject("No canvas support")}:t,n.exports=g},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(e,n){function t(a){var s;this.src=a,l("DummyImageContainer for",a),this.promise&&this.image||(l("Initiating DummyImageContainer"),t.prototype.image=new Image,s=this.image,t.prototype.promise=new Promise(function(u,f){s.onload=u,s.onerror=f,s.src=o(),s.complete===!0&&u(s)}))}var l=e("./log"),o=e("./utils").smallImage;n.exports=t},{"./log":13,"./utils":26}],6:[function(e,n){var t=e("./utils").smallImage;n.exports=function(l,o){var a=document.createElement("div"),s=document.createElement("img"),u=document.createElement("span"),f="Hidden Text";a.style.visibility="hidden",a.style.fontFamily=l,a.style.fontSize=o,a.style.margin=0,a.style.padding=0,document.body.appendChild(a),s.src=t(),s.width=1,s.height=1,s.style.margin=0,s.style.padding=0,s.style.verticalAlign="baseline",u.style.fontFamily=l,u.style.fontSize=o,u.style.margin=0,u.style.padding=0,u.appendChild(document.createTextNode(f)),a.appendChild(u),a.appendChild(s),o=s.offsetTop-u.offsetTop+1,a.removeChild(u),a.appendChild(document.createTextNode(f)),a.style.lineHeight="normal",s.style.verticalAlign="super",s=s.offsetTop-a.offsetTop+1,document.body.removeChild(a),this.baseline=o,this.lineWidth=1,this.middle=s}},{"./utils":26}],7:[function(e,n){function t(){this.data={}}var l=e("./font");t.prototype.getMetrics=function(o,a){return this.data[o+"-"+a]===void 0&&(this.data[o+"-"+a]=new l(o,a)),this.data[o+"-"+a]},n.exports=t},{"./font":6}],8:[function(e,n){function t(a,s,u){this.image=null,this.src=a;var f=this,m=l(a);this.promise=(s?new Promise(function(d){a.contentWindow.document.URL==="about:blank"||a.contentWindow.document.documentElement==null?a.contentWindow.onload=a.onload=function(){d(a)}:d(a)}):this.proxyLoad(u.proxy,m,u)).then(function(d){return e("./core")(d.contentWindow.document.documentElement,{type:"view",width:d.width,height:d.height,proxy:u.proxy,javascriptEnabled:u.javascriptEnabled,removeContainer:u.removeContainer,allowTaint:u.allowTaint,imageTimeout:u.imageTimeout/2})}).then(function(d){return f.image=d})}var l=e("./utils").getBounds,o=e("./proxy").loadUrlDocument;t.prototype.proxyLoad=function(a,s,u){var f=this.src;return o(f.src,a,f.ownerDocument,s.width,s.height,u)},n.exports=t},{"./core":4,"./proxy":16,"./utils":26}],9:[function(e,n){function t(l){this.src=l.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=Promise.resolve(!0)}t.TYPES={LINEAR:1,RADIAL:2},t.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,n.exports=t},{}],10:[function(e,n){n.exports=function(t,l){this.src=t,this.image=new Image;var o=this;this.tainted=null,this.promise=new Promise(function(a,s){o.image.onload=a,o.image.onerror=s,l&&(o.image.crossOrigin="anonymous"),o.image.src=t,o.image.complete===!0&&a(o.image)})}},{}],11:[function(e,n){function t(y,p){this.link=null,this.options=y,this.support=p,this.origin=this.getOrigin(window.location.href)}var l=e("./log"),o=e("./imagecontainer"),a=e("./dummyimagecontainer"),s=e("./proxyimagecontainer"),u=e("./framecontainer"),f=e("./svgcontainer"),m=e("./svgnodecontainer"),d=e("./lineargradientcontainer"),g=e("./webkitgradientcontainer"),b=e("./utils").bind;t.prototype.findImages=function(y){var p=[];return y.reduce(function(x,_){switch(_.node.nodeName){case"IMG":return x.concat([{args:[_.node.src],method:"url"}]);case"svg":case"IFRAME":return x.concat([{args:[_.node],method:_.node.nodeName}])}return x},[]).forEach(this.addImage(p,this.loadImage),this),p},t.prototype.findBackgroundImage=function(y,p){return p.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(y,this.loadImage),this),y},t.prototype.addImage=function(y,p){return function(x){x.args.forEach(function(_){this.imageExists(y,_)||(y.splice(0,0,p.call(this,x)),l("Added image #"+y.length,typeof _=="string"?_.substring(0,100):_))},this)}},t.prototype.hasImageBackground=function(y){return y.method!=="none"},t.prototype.loadImage=function(y){return y.method!=="url"?y.method==="linear-gradient"?new d(y):y.method==="gradient"?new g(y):y.method==="svg"?new m(y.args[0],this.support.svg):y.method==="IFRAME"?new u(y.args[0],this.isSameOrigin(y.args[0].src),this.options):new a(y):(y=y.args[0],!this.isSVG(y)||this.support.svg||this.options.allowTaint?y.match(/data:image\/.*;base64,/i)?new o(y.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(y)||this.options.allowTaint===!0||this.isSVG(y)?new o(y,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new o(y,!0):this.options.proxy?new s(y,this.options.proxy):new a(y):new f(y))},t.prototype.isSVG=function(y){return y.substring(y.length-3).toLowerCase()==="svg"||f.prototype.isInline(y)},t.prototype.imageExists=function(y,p){return y.some(function(x){return x.src===p})},t.prototype.isSameOrigin=function(y){return this.getOrigin(y)===this.origin},t.prototype.getOrigin=function(y){var p=this.link||(this.link=document.createElement("a"));return p.href=y,p.href=p.href,p.protocol+p.hostname+p.port},t.prototype.getPromise=function(y){return this.timeout(y,this.options.imageTimeout).catch(function(){return new a(y.src).promise.then(function(p){y.image=p})})},t.prototype.get=function(y){var p=null;return this.images.some(function(x){return(p=x).src===y})?p:null},t.prototype.fetch=function(y){return this.images=y.reduce(b(this.findBackgroundImage,this),this.findImages(y)),this.images.forEach(function(p,x){p.promise.then(function(){l("Succesfully loaded image #"+(x+1),p)},function(_){l("Failed loading image #"+(x+1),p,_)})}),this.ready=Promise.all(this.images.map(this.getPromise,this)),l("Finished searching images"),this},t.prototype.timeout=function(y,p){var x,_=Promise.race([y.promise,new Promise(function(S,I){x=setTimeout(function(){l("Timed out loading image",y),I(y)},p)})]).then(function(S){return clearTimeout(x),S});return _.catch(function(){clearTimeout(x)}),_},n.exports=t},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(e,n){function t(a){l.apply(this,arguments),this.type=l.TYPES.LINEAR;var s=t.REGEXP_DIRECTION.test(a.args[0])||!l.REGEXP_COLORSTOP.test(a.args[0]);s?a.args[0].split(/\s+/).reverse().forEach(function(u,f){switch(u){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var m=this.y0,d=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=d,this.y1=m;break;case"center":break;default:if(m=.01*parseFloat(u,10),isNaN(m))break;f===0?(this.y0=m,this.y1=1-this.y0):(this.x0=m,this.x1=1-this.x0)}},this):(this.y0=0,this.y1=1),this.colorStops=a.args.slice(s?1:0).map(function(u){var f=u.match(l.REGEXP_COLORSTOP),m=+f[2],u=m==0?"%":f[3];return{color:new o(f[1]),stop:u==="%"?m/100:null}}),this.colorStops[0].stop===null&&(this.colorStops[0].stop=0),this.colorStops[this.colorStops.length-1].stop===null&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(u,f){u.stop===null&&this.colorStops.slice(f).some(function(m,d){return m.stop!==null&&(u.stop=(m.stop-this.colorStops[f-1].stop)/(d+1)+this.colorStops[f-1].stop,!0)},this)},this)}var l=e("./gradientcontainer"),o=e("./color");t.prototype=Object.create(l.prototype),t.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,n.exports=t},{"./color":3,"./gradientcontainer":9}],13:[function(e,n){var t=function(){t.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-t.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};t.options={logging:!1},n.exports=t},{}],14:[function(e,n){function t(d,g){this.node=d,this.parent=g,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function l(d){return d.toString().indexOf("%")!==-1}function o(d){return d.replace("px","")}function a(d){return parseFloat(d)}var s=e("./color"),e=e("./utils"),u=e.getBounds,f=e.parseBackgrounds,m=e.offsetBounds;t.prototype.cloneTo=function(d){d.visible=this.visible,d.borders=this.borders,d.bounds=this.bounds,d.clip=this.clip,d.backgroundClip=this.backgroundClip,d.computedStyles=this.computedStyles,d.styles=this.styles,d.backgroundImages=this.backgroundImages,d.opacity=this.opacity},t.prototype.getOpacity=function(){return this.opacity===null?this.opacity=this.cssFloat("opacity"):this.opacity},t.prototype.assignStack=function(d){(this.stack=d).children.push(this)},t.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:this.css("display")!=="none"&&this.css("visibility")!=="hidden"&&!this.node.hasAttribute("data-html2canvas-ignore")&&(this.node.nodeName!=="INPUT"||this.node.getAttribute("type")!=="hidden")},t.prototype.css=function(d){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[d]||(this.styles[d]=this.computedStyles[d])},t.prototype.prefixedCss=function(d){var g=this.css(d);return g===void 0&&["webkit","moz","ms","o"].some(function(b){return(g=this.css(b+d.substr(0,1).toUpperCase()+d.substr(1)))!==void 0},this),g===void 0?null:g},t.prototype.computedStyle=function(d){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,d)},t.prototype.cssInt=function(d){return d=parseInt(this.css(d),10),isNaN(d)?0:d},t.prototype.color=function(d){return this.colors[d]||(this.colors[d]=new s(this.css(d)))},t.prototype.cssFloat=function(d){return d=parseFloat(this.css(d)),isNaN(d)?0:d},t.prototype.fontWeight=function(){var d=this.css("fontWeight");switch(parseInt(d,10)){case 401:d="bold";break;case 400:d="normal"}return d},t.prototype.parseClip=function(){var d=this.css("clip").match(this.CLIP);return d?{top:parseInt(d[1],10),right:parseInt(d[2],10),bottom:parseInt(d[3],10),left:parseInt(d[4],10)}:null},t.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=f(this.css("backgroundImage")))},t.prototype.cssList=function(d,g){return d=(this.css(d)||"").split(","),(d=(d=d[g||0]||d[0]||"auto").trim().split(" ")).length===1&&(d=[d[0],l(d[0])?"auto":d[0]]),d},t.prototype.parseBackgroundSize=function(d,g,b){var y,p=this.cssList("backgroundSize",b);if(l(p[0]))y=d.width*parseFloat(p[0])/100;else{if(/contain|cover/.test(p[0])){var x=d.width/d.height,b=g.width/g.height;return x<b^p[0]==="contain"?{width:d.height*b,height:d.height}:{width:d.width,height:d.width/b}}y=parseInt(p[0],10)}return d=p[0]==="auto"&&p[1]==="auto"?g.height:p[1]==="auto"?y/g.width*g.height:l(p[1])?d.height*parseFloat(p[1])/100:parseInt(p[1],10),p[0]==="auto"&&(y=d/g.height*g.width),{width:y,height:d}},t.prototype.parseBackgroundPosition=function(d,g,b,y){var p=this.cssList("backgroundPosition",b),b=l(p[0])?(d.width-(y||g).width)*(parseFloat(p[0])/100):parseInt(p[0],10),y=p[1]==="auto"?b/g.width*g.height:l(p[1])?(d.height-(y||g).height)*parseFloat(p[1])/100:parseInt(p[1],10);return p[0]==="auto"&&(b=y/g.height*g.width),{left:b,top:y}},t.prototype.parseBackgroundRepeat=function(d){return this.cssList("backgroundRepeat",d)[0]},t.prototype.parseTextShadows=function(){var d=this.css("textShadow"),g=[];if(d&&d!=="none")for(var b=d.match(this.TEXT_SHADOW_PROPERTY),y=0;b&&y<b.length;y++){var p=b[y].match(this.TEXT_SHADOW_VALUES);g.push({color:new s(p[0]),offsetX:p[1]?parseFloat(p[1].replace("px","")):0,offsetY:p[2]?parseFloat(p[2].replace("px","")):0,blur:p[3]?p[3].replace("px",""):0})}return g},t.prototype.parseTransform=function(){var d,g;return this.transformData||(this.hasTransform()?(d=this.parseBounds(),(g=this.prefixedCss("transformOrigin").split(" ").map(o).map(a))[0]+=d.left,g[1]+=d.top,this.transformData={origin:g,matrix:this.parseTransformMatrix()}):this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]}),this.transformData},t.prototype.parseTransformMatrix=function(){var d;return this.transformMatrix||(d=(d=this.prefixedCss("transform"))?function(g){if(g&&g[1]==="matrix")return g[2].split(",").map(function(b){return parseFloat(b.trim())});if(g&&g[1]==="matrix3d")return g=g[2].split(",").map(function(b){return parseFloat(b.trim())}),[g[0],g[1],g[4],g[5],g[12],g[13]]}(d.match(this.MATRIX_PROPERTY)):null,this.transformMatrix=d||[1,0,0,1,0,0]),this.transformMatrix},t.prototype.parseBounds=function(){return this.bounds||(this.bounds=(this.hasTransform()?m:u)(this.node))},t.prototype.hasTransform=function(){return this.parseTransformMatrix().join(",")!=="1,0,0,1,0,0"||this.parent&&this.parent.hasTransform()},t.prototype.getValue=function(){var d,g=this.node.value||"";return this.node.tagName==="SELECT"?g=(d=(d=this.node).options[d.selectedIndex||0])&&d.text||"":this.node.type==="password"&&(g=Array(g.length+1).join("\u2022")),g.length===0?this.node.placeholder||"":g},t.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,t.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,t.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,t.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,n.exports=t},{"./color":3,"./utils":26}],15:[function(e,n){function t(K,se,te,re,fe){M("Starting NodeParser"),this.renderer=se,this.options=fe,this.range=null,this.support=te,this.renderQueue=[],this.stack=new le(!0,1,K.ownerDocument,null);var Me=new N(K,null);fe.background&&se.rectangle(0,0,se.width,se.height,new X(fe.background)),K===K.ownerDocument.documentElement&&(te=new N(Me.color("backgroundColor").isTransparent()?K.ownerDocument.body:K.ownerDocument.documentElement,null),se.rectangle(0,0,se.width,se.height,te.color("backgroundColor"))),Me.visibile=Me.isElementVisible(),this.createPseudoHideStyles(K.ownerDocument),this.disableAnimations(K.ownerDocument),this.nodes=A([Me].concat(this.getChildren(Me)).filter(function(ye){return ye.visible=ye.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new U,M("Fetched nodes, total:",this.nodes.length),M("Calculate overflow clips"),this.calculateOverflowClips(),M("Start fetching images"),this.images=re.fetch(this.nodes.filter(D)),this.ready=this.images.ready.then(he(function(){return M("Images loaded, starting parsing"),M("Creating stacking contexts"),this.createStackingContexts(),M("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),M("Render queue created with "+this.renderQueue.length+" items"),new Promise(he(function(ye){fe.async?typeof fe.async=="function"?fe.async.call(this,this.renderQueue,ye):0<this.renderQueue.length?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,ye)):ye():(this.renderQueue.forEach(this.paint,this),ye())},this))},this))}function l(K){return K.parent&&K.parent.clip.length}function o(){}function a(K,se,te,re){return K.map(function(fe,Me){if(0<fe.width){var ye=se.left,Ye=se.top,Ce=se.width,Ke=se.height-K[2].width;switch(Me){case 0:Ke=K[0].width,fe.args=m({c1:[ye,Ye],c2:[ye+Ce,Ye],c3:[ye+Ce-K[1].width,Ye+Ke],c4:[ye+K[3].width,Ye+Ke]},re[0],re[1],te.topLeftOuter,te.topLeftInner,te.topRightOuter,te.topRightInner);break;case 1:ye=se.left+se.width-K[1].width,Ce=K[1].width,fe.args=m({c1:[ye+Ce,Ye],c2:[ye+Ce,Ye+Ke+K[2].width],c3:[ye,Ye+Ke],c4:[ye,Ye+K[0].width]},re[1],re[2],te.topRightOuter,te.topRightInner,te.bottomRightOuter,te.bottomRightInner);break;case 2:Ye=Ye+se.height-K[2].width,Ke=K[2].width,fe.args=m({c1:[ye+Ce,Ye+Ke],c2:[ye,Ye+Ke],c3:[ye+K[3].width,Ye],c4:[ye+Ce-K[3].width,Ye]},re[2],re[3],te.bottomRightOuter,te.bottomRightInner,te.bottomLeftOuter,te.bottomLeftInner);break;case 3:Ce=K[3].width,fe.args=m({c1:[ye,Ye+Ke+K[2].width],c2:[ye,Ye],c3:[ye+Ce,Ye+K[0].width],c4:[ye+Ce,Ye+Ke]},re[3],re[0],te.bottomLeftOuter,te.bottomLeftInner,te.topLeftOuter,te.topLeftInner)}}return fe})}function s(K,se,te,re){var fe=(Math.sqrt(2)-1)/3*4,Me=te*fe,fe=re*fe,te=K+te,re=se+re;return{topLeft:f({x:K,y:re},{x:K,y:re-fe},{x:te-Me,y:se},{x:te,y:se}),topRight:f({x:K,y:se},{x:K+Me,y:se},{x:te,y:re-fe},{x:te,y:re}),bottomRight:f({x:te,y:se},{x:te,y:se+fe},{x:K+Me,y:re},{x:K,y:re}),bottomLeft:f({x:te,y:re},{x:te-Me,y:re},{x:K,y:se+fe},{x:K,y:se})}}function u(K,se,te){var re=K.left,fe=K.top,Me=K.width,ye=K.height,Ye=se[0][0]<Me/2?se[0][0]:Me/2,Ce=se[0][1]<ye/2?se[0][1]:ye/2,Ke=se[1][0]<Me/2?se[1][0]:Me/2,ft=se[1][1]<ye/2?se[1][1]:ye/2,et=se[2][0]<Me/2?se[2][0]:Me/2,vt=se[2][1]<ye/2?se[2][1]:ye/2,wt=se[3][0]<Me/2?se[3][0]:Me/2,be=se[3][1]<ye/2?se[3][1]:ye/2,Q=Me-Ke,me=ye-vt,K=Me-et,se=ye-be;return{topLeftOuter:s(re,fe,Ye,Ce).topLeft.subdivide(.5),topLeftInner:s(re+te[3].width,fe+te[0].width,Math.max(0,Ye-te[3].width),Math.max(0,Ce-te[0].width)).topLeft.subdivide(.5),topRightOuter:s(re+Q,fe,Ke,ft).topRight.subdivide(.5),topRightInner:s(re+Math.min(Q,Me+te[3].width),fe+te[0].width,Q>Me+te[3].width?0:Ke-te[3].width,ft-te[0].width).topRight.subdivide(.5),bottomRightOuter:s(re+K,fe+me,et,vt).bottomRight.subdivide(.5),bottomRightInner:s(re+Math.min(K,Me-te[3].width),fe+Math.min(me,ye+te[0].width),Math.max(0,et-te[1].width),vt-te[2].width).bottomRight.subdivide(.5),bottomLeftOuter:s(re,fe+se,wt,be).bottomLeft.subdivide(.5),bottomLeftInner:s(re+te[3].width,fe+se,Math.max(0,wt-te[3].width),be-te[2].width).bottomLeft.subdivide(.5)}}function f(K,se,te,re){function fe(Me,ye,Ye){return{x:Me.x+(ye.x-Me.x)*Ye,y:Me.y+(ye.y-Me.y)*Ye}}return{start:K,startControl:se,endControl:te,end:re,subdivide:function(Me){var ye=fe(K,se,Me),Ye=fe(se,te,Me),Ce=fe(te,re,Me),Ke=fe(ye,Ye,Me),Ye=fe(Ye,Ce,Me),Me=fe(Ke,Ye,Me);return[f(K,ye,Ke,Me),f(Me,Ye,Ce,re)]},curveTo:function(Me){Me.push(["bezierCurve",se.x,se.y,te.x,te.y,re.x,re.y])},curveToReversed:function(Me){Me.push(["bezierCurve",te.x,te.y,se.x,se.y,K.x,K.y])}}}function m(K,se,te,re,fe,Me,ye){var Ye=[];return 0<se[0]||0<se[1]?(Ye.push(["line",re[1].start.x,re[1].start.y]),re[1].curveTo(Ye)):Ye.push(["line",K.c1[0],K.c1[1]]),0<te[0]||0<te[1]?(Ye.push(["line",Me[0].start.x,Me[0].start.y]),Me[0].curveTo(Ye),Ye.push(["line",ye[0].end.x,ye[0].end.y]),ye[0].curveToReversed(Ye)):(Ye.push(["line",K.c2[0],K.c2[1]]),Ye.push(["line",K.c3[0],K.c3[1]])),0<se[0]||0<se[1]?(Ye.push(["line",fe[1].end.x,fe[1].end.y]),fe[1].curveToReversed(Ye)):Ye.push(["line",K.c4[0],K.c4[1]]),Ye}function d(K,se,te,re,fe,Me,ye){0<se[0]||0<se[1]?(K.push(["line",re[0].start.x,re[0].start.y]),re[0].curveTo(K),re[1].curveTo(K)):K.push(["line",Me,ye]),(0<te[0]||0<te[1])&&K.push(["line",fe[0].start.x,fe[0].start.y])}function g(K){return K.cssInt("zIndex")<0}function b(K){return 0<K.cssInt("zIndex")}function y(K){return K.cssInt("zIndex")===0}function p(K){return["inline","inline-block","inline-table"].indexOf(K.css("display"))!==-1}function x(K){return K instanceof le}function _(K){return 0<K.node.data.trim().length}function S(K){return K.nodeType===Node.TEXT_NODE||K.nodeType===Node.ELEMENT_NODE}function I(K){return K.css("position")!=="static"}function O(K){return K.css("float")!=="none"}function F(K){var se=this;return function(){return!K.apply(se,arguments)}}function D(K){return K.node.nodeType===Node.ELEMENT_NODE}function k(K){return K.isPseudoElement===!0}function w(K){return K.node.nodeType===Node.TEXT_NODE}function C(K){return parseInt(K,10)}function T(K){return K.width}function z(K){return K.node.nodeType!==Node.ELEMENT_NODE||["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(K.node.nodeName)===-1}function A(K){return[].concat.apply([],K)}var M=e("./log"),P=e("punycode"),N=e("./nodecontainer"),E=e("./textcontainer"),B=e("./pseudoelementcontainer"),U=e("./fontmetrics"),X=e("./color"),le=e("./stackingcontext"),e=e("./utils"),he=e.bind,Z=e.getBounds,ae=e.parseBackgrounds,J=e.offsetBounds;t.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(K){var se,te;D(K)?(k(K)&&K.appendToDOM(),K.borders=this.parseBorders(K),se=K.css("overflow")==="hidden"?[K.borders.clip]:[],(te=K.parseClip())&&["absolute","fixed"].indexOf(K.css("position"))!==-1&&se.push([["rect",K.bounds.left+te.left,K.bounds.top+te.top,te.right-te.left,te.bottom-te.top]]),K.clip=l(K)?K.parent.clip.concat(se):se,K.backgroundClip=K.css("overflow")!=="hidden"?K.clip.concat([K.borders.clip]):K.clip,k(K)&&K.cleanDOM()):w(K)&&(K.clip=l(K)?K.parent.clip:[]),k(K)||(K.bounds=null)},this)},t.prototype.asyncRenderer=function(K,se,te){te=te||Date.now(),this.paint(K[this.renderIndex++]),K.length===this.renderIndex?se():te+20>Date.now()?this.asyncRenderer(K,se,te):setTimeout(he(function(){this.asyncRenderer(K,se)},this),0)},t.prototype.createPseudoHideStyles=function(K){this.createStyles(K,"."+B.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+B.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},t.prototype.disableAnimations=function(K){this.createStyles(K,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},t.prototype.createStyles=function(K,se){var te=K.createElement("style");te.innerHTML=se,K.body.appendChild(te)},t.prototype.getPseudoElements=function(K){var se,te=[[K]];return K.node.nodeType===Node.ELEMENT_NODE&&(se=this.getPseudoElement(K,":before"),K=this.getPseudoElement(K,":after"),se&&te.push(se),K&&te.push(K)),A(te)},t.prototype.getPseudoElement=function(K,se){var te=K.computedStyle(se);if(!te||!te.content||te.content==="none"||te.content==="-moz-alt-content"||te.display==="none")return null;for(var re,Ye=(re=te.content,(Ye=re.substr(0,1))===re.substr(re.length-1)&&Ye.match(/'|"/)?re.substr(1,re.length-2):re),re=Ye.substr(0,3)==="url",fe=document.createElement(re?"img":"html2canvaspseudoelement"),se=new B(fe,K,se),Me=te.length-1;0<=Me;Me--){var ye=te.item(Me).replace(/(\-[a-z])/g,function(ft){return ft.toUpperCase().replace("-","")});fe.style[ye]=te[ye]}if(fe.className=B.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+B.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,re)return fe.src=ae(Ye)[0].args[0],[se];var Ye=document.createTextNode(Ye);return fe.appendChild(Ye),[se,new E(Ye,se)]},t.prototype.getChildren=function(K){return A([].filter.call(K.node.childNodes,S).map(function(se){var te=[new(se.nodeType===Node.TEXT_NODE?E:N)(se,K)].filter(z);return se.nodeType===Node.ELEMENT_NODE&&te.length&&se.tagName!=="TEXTAREA"?te[0].isElementVisible()?te.concat(this.getChildren(te[0])):[]:te},this))},t.prototype.newStackingContext=function(K,se){var te=new le(se,K.getOpacity(),K.node,K.parent);K.cloneTo(te),(se?te.getParentStack(this):te.parent.stack).contexts.push(te),K.stack=te},t.prototype.createStackingContexts=function(){this.nodes.forEach(function(K){var se,te;D(K)&&(this.isRootElement(K)||K.getOpacity()<1||(te=(se=K).css("position"),(["absolute","relative","fixed"].indexOf(te)!==-1?se.css("zIndex"):"auto")!=="auto")||this.isBodyWithTransparentRoot(K)||K.hasTransform())?this.newStackingContext(K,!0):D(K)&&(I(K)&&y(K)||["inline-block","inline-table"].indexOf(K.css("display"))!==-1||O(K))?this.newStackingContext(K,!1):K.assignStack(K.parent.stack)},this)},t.prototype.isBodyWithTransparentRoot=function(K){return K.node.nodeName==="BODY"&&K.parent.color("backgroundColor").isTransparent()},t.prototype.isRootElement=function(K){return K.parent===null},t.prototype.sortStackingContexts=function(K){var se;K.contexts.sort((se=K.contexts.slice(0),function(te,re){return te.cssInt("zIndex")+se.indexOf(te)/se.length-(re.cssInt("zIndex")+se.indexOf(re)/se.length)})),K.contexts.forEach(this.sortStackingContexts,this)},t.prototype.parseTextBounds=function(K){return function(se,te,re){if(K.parent.css("textDecoration").substr(0,4)!=="none"||se.trim().length!==0){if(this.support.rangeBounds&&!K.parent.hasTransform()){var fe=re.slice(0,te).join("").length;return this.getRangeBounds(K.node,fe,se.length)}if(K.node&&typeof K.node.data=="string")return te=K.node.splitText(se.length),fe=this.getWrapperBounds(K.node,K.parent.hasTransform()),K.node=te,fe}else this.support.rangeBounds&&!K.parent.hasTransform()||(K.node=K.node.splitText(se.length));return{}}},t.prototype.getWrapperBounds=function(K,se){var te=K.ownerDocument.createElement("html2canvaswrapper"),re=K.parentNode,fe=K.cloneNode(!0);return te.appendChild(K.cloneNode(!0)),re.replaceChild(te,K),se=(se?J:Z)(te),re.replaceChild(fe,te),se},t.prototype.getRangeBounds=function(K,se,te){var re=this.range||(this.range=K.ownerDocument.createRange());return re.setStart(K,se),re.setEnd(K,se+te),re.getBoundingClientRect()},t.prototype.parse=function(K){var se=K.contexts.filter(g),te=K.children.filter(D),re=te.filter(F(O)),fe=re.filter(F(I)).filter(F(p)),Me=te.filter(F(I)).filter(O),ye=re.filter(F(I)).filter(p),te=K.contexts.concat(re.filter(I)).filter(y),re=K.children.filter(w).filter(_),K=K.contexts.filter(b);se.concat(fe).concat(Me).concat(ye).concat(te).concat(re).concat(K).forEach(function(Ye){this.renderQueue.push(Ye),x(Ye)&&(this.parse(Ye),this.renderQueue.push(new o))},this)},t.prototype.paint=function(K){try{K instanceof o?this.renderer.ctx.restore():w(K)?(k(K.parent)&&K.parent.appendToDOM(),this.paintText(K),k(K.parent)&&K.parent.cleanDOM()):this.paintNode(K)}catch(se){if(M(se),this.options.strict)throw se}},t.prototype.paintNode=function(K){x(K)&&(this.renderer.setOpacity(K.opacity),this.renderer.ctx.save(),K.hasTransform()&&this.renderer.setTransform(K.parseTransform())),K.node.nodeName==="INPUT"&&K.node.type==="checkbox"?this.paintCheckbox(K):K.node.nodeName==="INPUT"&&K.node.type==="radio"?this.paintRadio(K):this.paintElement(K)},t.prototype.paintElement=function(K){var se=K.parseBounds();this.renderer.clip(K.backgroundClip,function(){this.renderer.renderBackground(K,se,K.borders.borders.map(T))},this),this.renderer.clip(K.clip,function(){this.renderer.renderBorders(K.borders.borders)},this),this.renderer.clip(K.backgroundClip,function(){switch(K.node.nodeName){case"svg":case"IFRAME":var te=this.images.get(K.node);te?this.renderer.renderImage(K,se,K.borders,te):M("Error loading <"+K.node.nodeName+">",K.node);break;case"IMG":te=this.images.get(K.node.src),te?this.renderer.renderImage(K,se,K.borders,te):M("Error loading <img>",K.node.src);break;case"CANVAS":this.renderer.renderImage(K,se,K.borders,{image:K.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(K)}},this)},t.prototype.paintCheckbox=function(K){var se=K.parseBounds(),te=Math.min(se.width,se.height),re={width:te-1,height:te-1,top:se.top,left:se.left},se=[3,3],fe=[se,se,se,se],Me=[1,1,1,1].map(function(Ye){return{color:new X("#A5A5A5"),width:Ye}}),ye=u(re,fe,Me);this.renderer.clip(K.backgroundClip,function(){this.renderer.rectangle(re.left+1,re.top+1,re.width-2,re.height-2,new X("#DEDEDE")),this.renderer.renderBorders(a(Me,re,ye,fe)),K.node.checked&&(this.renderer.font(new X("#424242"),"normal","normal","bold",te-3+"px","arial"),this.renderer.text("\u2714",re.left+te/6,re.top+te-1))},this)},t.prototype.paintRadio=function(K){var se=K.parseBounds(),te=Math.min(se.width,se.height)-2;this.renderer.clip(K.backgroundClip,function(){this.renderer.circleStroke(se.left+1,se.top+1,te,new X("#DEDEDE"),1,new X("#A5A5A5")),K.node.checked&&this.renderer.circle(Math.ceil(se.left+te/4)+1,Math.ceil(se.top+te/4)+1,Math.floor(te/2),new X("#424242"))},this)},t.prototype.paintFormValue=function(K){var se,te,re,fe=K.getValue();0<fe.length&&(se=K.node.ownerDocument,te=se.createElement("html2canvaswrapper"),["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"].forEach(function(Me){try{te.style[Me]=K.css(Me)}catch(ye){M("html2canvas: Parse: Exception caught in renderFormValue: "+ye.message)}}),re=K.parseBounds(),te.style.position="fixed",te.style.left=re.left+"px",te.style.top=re.top+"px",te.textContent=fe,se.body.appendChild(te),this.paintText(new E(te.firstChild,K)),se.body.removeChild(te))},t.prototype.paintText=function(K){K.applyTextTransform();var se=P.ucs2.decode(K.node.data),te=this.options.letterRendering&&!/^(normal|none|0px)$/.test(K.parent.css("letterSpacing"))||/[^\u0000-\u00ff]/.test(K.node.data)?se.map(function(ye){return P.ucs2.encode([ye])}):function(ye){for(var Ye,Ce=[],Ke=0,ft=!1;ye.length;)[32,13,10,9,45].indexOf(ye[Ke])!==-1===ft?((Ye=ye.splice(0,Ke)).length&&Ce.push(P.ucs2.encode(Ye)),ft=!ft,Ke=0):Ke++,Ke>=ye.length&&(Ye=ye.splice(0,Ke)).length&&Ce.push(P.ucs2.encode(Ye));return Ce}(se),re=K.parent.fontWeight(),fe=K.parent.css("fontSize"),Me=K.parent.css("fontFamily"),se=K.parent.parseTextShadows();this.renderer.font(K.parent.color("color"),K.parent.css("fontStyle"),K.parent.css("fontVariant"),re,fe,Me),se.length?this.renderer.fontShadow(se[0].color,se[0].offsetX,se[0].offsetY,se[0].blur):this.renderer.clearShadow(),this.renderer.clip(K.parent.clip,function(){te.map(this.parseTextBounds(K),this).forEach(function(ye,Ye){ye&&(this.renderer.text(te[Ye],ye.left,ye.bottom),this.renderTextDecoration(K.parent,ye,this.fontMetrics.getMetrics(Me,fe)))},this)},this)},t.prototype.renderTextDecoration=function(K,se,te){switch(K.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(se.left,Math.round(se.top+te.baseline+te.lineWidth),se.width,1,K.color("color"));break;case"overline":this.renderer.rectangle(se.left,Math.round(se.top),se.width,1,K.color("color"));break;case"line-through":this.renderer.rectangle(se.left,Math.ceil(se.top+te.middle+te.lineWidth),se.width,1,K.color("color"))}};var pe={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};t.prototype.parseBorders=function(K){var se,te=K.parseBounds(),re=(se=K,["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(ye){return ye=se.css("border"+ye+"Radius").split(" "),ye.length<=1&&(ye[1]=ye[0]),ye.map(C)})),fe=["Top","Right","Bottom","Left"].map(function(ye,Ye){var Ce=K.css("border"+ye+"Style"),Ke=K.color("border"+ye+"Color");return Ce==="inset"&&Ke.isBlack()&&(Ke=new X([255,255,255,Ke.a])),Ye=pe[Ce]?pe[Ce][Ye]:null,{width:K.cssInt("border"+ye+"Width"),color:Ye?Ke[Ye[0]](Ye[1]):Ke,args:null}}),Me=u(te,re,fe);return{clip:this.parseBackgroundClip(K,Me,fe,re,te),borders:a(fe,te,Me,re)}},t.prototype.parseBackgroundClip=function(K,se,te,re,fe){var Me=[];switch(K.css("backgroundClip")){case"content-box":case"padding-box":d(Me,re[0],re[1],se.topLeftInner,se.topRightInner,fe.left+te[3].width,fe.top+te[0].width),d(Me,re[1],re[2],se.topRightInner,se.bottomRightInner,fe.left+fe.width-te[1].width,fe.top+te[0].width),d(Me,re[2],re[3],se.bottomRightInner,se.bottomLeftInner,fe.left+fe.width-te[1].width,fe.top+fe.height-te[2].width),d(Me,re[3],re[0],se.bottomLeftInner,se.topLeftInner,fe.left+te[3].width,fe.top+fe.height-te[2].width);break;default:d(Me,re[0],re[1],se.topLeftOuter,se.topRightOuter,fe.left,fe.top),d(Me,re[1],re[2],se.topRightOuter,se.bottomRightOuter,fe.left+fe.width,fe.top),d(Me,re[2],re[3],se.bottomRightOuter,se.bottomLeftOuter,fe.left+fe.width,fe.top+fe.height),d(Me,re[3],re[0],se.bottomLeftOuter,se.topLeftOuter,fe.left,fe.top+fe.height)}return Me},n.exports=t},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(e,n,t){function l(y,p,x){var _="withCredentials"in new XMLHttpRequest;if(!p)return Promise.reject("No proxy configured");var S=a(_),y=s(p,y,S);return _?u(y):o(x,y,S).then(function(I){return g(I.content)})}function o(y,p,x){return new Promise(function(_,S){function I(){delete window.html2canvas.proxy[x],y.body.removeChild(O)}var O=y.createElement("script");window.html2canvas.proxy[x]=function(F){I(),_(F)},O.src=p,O.onerror=function(F){I(),S(F)},y.body.appendChild(O)})}function a(y){return y?"":"html2canvas_"+Date.now()+"_"+ ++b+"_"+Math.round(1e5*Math.random())}function s(y,p,x){return y+"?url="+encodeURIComponent(p)+(x.length?"&callback=html2canvas.proxy."+x:"")}var u=e("./xhr"),f=e("./utils"),m=e("./log"),d=e("./clone"),g=f.decode64,b=0;t.Proxy=l,t.ProxyURL=function(y,p,x){var _="crossOrigin"in new Image,S=a(_),y=s(p,y,S);return _?Promise.resolve(y):o(x,y,S).then(function(I){return"data:"+I.type+";base64,"+I.content})},t.loadUrlDocument=function(y,p,x,_,S,I){return new l(y,p,window.document).then((O=y,function(F){var D,k=new DOMParser;try{D=k.parseFromString(F,"text/html")}catch(C){m("DOMParser not supported, falling back to createHTMLDocument"),D=document.implementation.createHTMLDocument("");try{D.open(),D.write(F),D.close()}catch(T){m("createHTMLDocument write not supported, falling back to document.body.innerHTML"),D.body.innerHTML=F}}var w=D.querySelector("base");return w&&w.href.host||((w=D.createElement("base")).href=O,D.head.insertBefore(w,D.head.firstChild)),D})).then(function(F){return d(F,x,_,S,I,0,0)});var O}},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(e,n){var t=e("./proxy").ProxyURL;n.exports=function(l,o){var a=document.createElement("a");a.href=l,l=a.href,this.src=l,this.image=new Image;var s=this;this.promise=new Promise(function(u,f){s.image.crossOrigin="Anonymous",s.image.onload=u,s.image.onerror=f,new t(l,o,document).then(function(m){s.image.src=m}).catch(f)})}},{"./proxy":16}],18:[function(e,n){function t(o,a,s){l.call(this,o,a),this.isPseudoElement=!0,this.before=s===":before"}var l=e("./nodecontainer");t.prototype.cloneTo=function(o){t.prototype.cloneTo.call(this,o),o.isPseudoElement=!0,o.before=this.before},(t.prototype=Object.create(l.prototype)).appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},t.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},t.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},t.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",t.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",n.exports=t},{"./nodecontainer":14}],19:[function(e,n){function t(o,a,s,u,f){this.width=o,this.height=a,this.images=s,this.options=u,this.document=f}var l=e("./log");t.prototype.renderImage=function(o,a,s,u){var f=o.cssInt("paddingLeft"),m=o.cssInt("paddingTop"),d=o.cssInt("paddingRight"),o=o.cssInt("paddingBottom"),s=s.borders,d=a.width-(s[1].width+s[3].width+f+d),o=a.height-(s[0].width+s[2].width+m+o);this.drawImage(u,0,0,u.image.width||d,u.image.height||o,a.left+f+s[3].width,a.top+m+s[0].width,d,o)},t.prototype.renderBackground=function(o,a,s){0<a.height&&0<a.width&&(this.renderBackgroundColor(o,a),this.renderBackgroundImage(o,a,s))},t.prototype.renderBackgroundColor=function(o,a){o=o.color("backgroundColor"),o.isTransparent()||this.rectangle(a.left,a.top,a.width,a.height,o)},t.prototype.renderBorders=function(o){o.forEach(this.renderBorder,this)},t.prototype.renderBorder=function(o){o.color.isTransparent()||o.args===null||this.drawShape(o.args,o.color)},t.prototype.renderBackgroundImage=function(o,a,s){o.parseBackgroundImages().reverse().forEach(function(u,f,m){switch(u.method){case"url":var d=this.images.get(u.args[0]);d?this.renderBackgroundRepeating(o,a,d,m.length-(f+1),s):l("Error loading background-image",u.args[0]);break;case"linear-gradient":case"gradient":d=this.images.get(u.value),d?this.renderBackgroundGradient(d,a,s):l("Error loading background-image",u.args[0]);break;case"none":break;default:l("Unknown background-image type",u.args[0])}},this)},t.prototype.renderBackgroundRepeating=function(o,a,s,u,f){var m=o.parseBackgroundSize(a,s.image,u),d=o.parseBackgroundPosition(a,s.image,u,m);switch(o.parseBackgroundRepeat(u)){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(s,d,m,a,a.left+f[3],a.top+d.top+f[0],99999,m.height,f);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(s,d,m,a,a.left+d.left+f[3],a.top+f[0],m.width,99999,f);break;case"no-repeat":this.backgroundRepeatShape(s,d,m,a,a.left+d.left+f[3],a.top+d.top+f[0],m.width,m.height,f);break;default:this.renderBackgroundRepeat(s,d,m,{top:a.top,left:a.left},f[3],f[0])}},n.exports=t},{"./log":13}],20:[function(e,n){function t(u,f){o.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=u,this.canvas.height=f),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},s("Initialized CanvasRenderer with size",u,"x",f)}function l(u){return 0<u.length}var o=e("../renderer"),a=e("../lineargradientcontainer"),s=e("../log");(t.prototype=Object.create(o.prototype)).setFillStyle=function(u){return this.ctx.fillStyle=typeof u=="object"&&u.isColor?u.toString():u,this.ctx},t.prototype.rectangle=function(u,f,m,d,g){this.setFillStyle(g).fillRect(u,f,m,d)},t.prototype.circle=function(u,f,m,d){this.setFillStyle(d),this.ctx.beginPath(),this.ctx.arc(u+m/2,f+m/2,m/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},t.prototype.circleStroke=function(u,f,m,d,g,b){this.circle(u,f,m,d),this.ctx.strokeStyle=b.toString(),this.ctx.stroke()},t.prototype.drawShape=function(u,f){this.shape(u),this.setFillStyle(f).fill()},t.prototype.taints=function(u){if(u.tainted===null){this.taintCtx.drawImage(u.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),u.tainted=!1}catch(f){this.taintCtx=document.createElement("canvas").getContext("2d"),u.tainted=!0}}return u.tainted},t.prototype.drawImage=function(u,f,m,d,g,b,y,p,x){this.taints(u)&&!this.options.allowTaint||this.ctx.drawImage(u.image,f,m,d,g,b,y,p,x)},t.prototype.clip=function(u,f,m){this.ctx.save(),u.filter(l).forEach(function(d){this.shape(d).clip()},this),f.call(m),this.ctx.restore()},t.prototype.shape=function(u){return this.ctx.beginPath(),u.forEach(function(f,m){(f[0]==="rect"?this.ctx.rect:this.ctx[m===0?"moveTo":f[0]+"To"]).apply(this.ctx,f.slice(1))},this),this.ctx.closePath(),this.ctx},t.prototype.font=function(u,f,m,d,g,b){this.setFillStyle(u).font=[f,m,d,g,b].join(" ").split(",")[0]},t.prototype.fontShadow=function(u,f,m,d){this.setVariable("shadowColor",u.toString()).setVariable("shadowOffsetY",f).setVariable("shadowOffsetX",m).setVariable("shadowBlur",d)},t.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},t.prototype.setOpacity=function(u){this.ctx.globalAlpha=u},t.prototype.setTransform=function(u){this.ctx.translate(u.origin[0],u.origin[1]),this.ctx.transform.apply(this.ctx,u.matrix),this.ctx.translate(-u.origin[0],-u.origin[1])},t.prototype.setVariable=function(u,f){return this.variables[u]!==f&&(this.variables[u]=this.ctx[u]=f),this},t.prototype.text=function(u,f,m){this.ctx.fillText(u,f,m)},t.prototype.backgroundRepeatShape=function(u,f,m,d,g,b,y,p,x){b=[["line",Math.round(g),Math.round(b)],["line",Math.round(g+y),Math.round(b)],["line",Math.round(g+y),Math.round(p+b)],["line",Math.round(g),Math.round(p+b)]],this.clip([b],function(){this.renderBackgroundRepeat(u,f,m,d,x[3],x[0])},this)},t.prototype.renderBackgroundRepeat=function(u,f,m,d,g,b){g=Math.round(d.left+f.left+g),b=Math.round(d.top+f.top+b),this.setFillStyle(this.ctx.createPattern(this.resizeImage(u,m),"repeat")),this.ctx.translate(g,b),this.ctx.fill(),this.ctx.translate(-g,-b)},t.prototype.renderBackgroundGradient=function(u,f){var m;u instanceof a&&(m=this.ctx.createLinearGradient(f.left+f.width*u.x0,f.top+f.height*u.y0,f.left+f.width*u.x1,f.top+f.height*u.y1),u.colorStops.forEach(function(d){m.addColorStop(d.stop,d.color.toString())}),this.rectangle(f.left,f.top,f.width,f.height,m))},t.prototype.resizeImage=function(u,f){var m=u.image;return m.width===f.width&&m.height===f.height?m:(u=document.createElement("canvas"),u.width=f.width,u.height=f.height,u.getContext("2d").drawImage(m,0,0,m.width,m.height,0,0,f.width,f.height),u)},n.exports=t},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(e,n){function t(o,a,s,u){l.call(this,s,u),this.ownStacking=o,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*a}var l=e("./nodecontainer");(t.prototype=Object.create(l.prototype)).getParentStack=function(o){var a=this.parent?this.parent.stack:null;return a?a.ownStacking?a:a.getParentStack(o):o.stack},n.exports=t},{"./nodecontainer":14}],22:[function(e,n){function t(l){this.rangeBounds=this.testRangeBounds(l),this.cors=this.testCORS(),this.svg=this.testSVG()}t.prototype.testRangeBounds=function(l){var o,a,s=!1;return l.createRange&&(o=l.createRange()).getBoundingClientRect&&((a=l.createElement("boundtest")).style.height="123px",a.style.display="block",l.body.appendChild(a),o.selectNode(a),o.getBoundingClientRect().height===123&&(s=!0),l.body.removeChild(a)),s},t.prototype.testCORS=function(){return new Image().crossOrigin!==void 0},t.prototype.testSVG=function(){var l=new Image,o=document.createElement("canvas"),a=o.getContext("2d");l.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{a.drawImage(l,0,0),o.toDataURL()}catch(s){return!1}return!0},n.exports=t},{}],23:[function(e,n){function t(a){this.src=a,this.image=null;var s=this;this.promise=this.hasFabric().then(function(){return s.isInline(a)?Promise.resolve(s.inlineFormatting(a)):l(a)}).then(function(u){return new Promise(function(f){window.html2canvas.svg.fabric.loadSVGFromString(u,s.createCanvas.call(s,f))})})}var l=e("./xhr"),o=e("./utils").decode64;t.prototype.hasFabric=function(){return window.html2canvas.svg&&window.html2canvas.svg.fabric?Promise.resolve():Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},t.prototype.inlineFormatting=function(a){return/^data:image\/svg\+xml;base64,/.test(a)?this.decode64(this.removeContentType(a)):this.removeContentType(a)},t.prototype.removeContentType=function(a){return a.replace(/^data:image\/svg\+xml(;base64)?,/,"")},t.prototype.isInline=function(a){return/^data:image\/svg\+xml/i.test(a)},t.prototype.createCanvas=function(a){var s=this;return function(u,f){var m=new window.html2canvas.svg.fabric.StaticCanvas("c");s.image=m.lowerCanvasEl,m.setWidth(f.width).setHeight(f.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(u,f)).renderAll(),a(m.lowerCanvasEl)}},t.prototype.decode64=function(a){return typeof window.atob=="function"?window.atob(a):o(a)},n.exports=t},{"./utils":26,"./xhr":28}],24:[function(e,n){function t(l,o){this.src=l,this.image=null;var a=this;this.promise=o?new Promise(function(s,u){a.image=new Image,a.image.onload=s,a.image.onerror=u,a.image.src="data:image/svg+xml,"+new XMLSerializer().serializeToString(l),a.image.complete===!0&&s(a.image)}):this.hasFabric().then(function(){return new Promise(function(s){window.html2canvas.svg.fabric.parseSVGDocument(l,a.createCanvas.call(a,s))})})}e=e("./svgcontainer"),t.prototype=Object.create(e.prototype),n.exports=t},{"./svgcontainer":23}],25:[function(e,n){function t(a,s){o.call(this,a,s)}function l(a,s,u){return 0<a.length?s+u.toUpperCase():void 0}var o=e("./nodecontainer");(t.prototype=Object.create(o.prototype)).applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},t.prototype.transform=function(a){var s=this.node.data;switch(a){case"lowercase":return s.toLowerCase();case"capitalize":return s.replace(/(^|\s|:|-|\(|\))([a-z])/g,l);case"uppercase":return s.toUpperCase();default:return s}},n.exports=t},{"./nodecontainer":14}],26:[function(e,n,t){t.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},t.bind=function(l,o){return function(){return l.apply(o,arguments)}},t.decode64=function(l){for(var o,a,s,u,f,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=l.length,g="",b=0;b<d;b+=4)s=m.indexOf(l[b])<<2|(f=m.indexOf(l[b+1]))>>4,u=(15&f)<<4|(o=m.indexOf(l[b+2]))>>2,f=(3&o)<<6|(a=m.indexOf(l[b+3])),g+=o===64?String.fromCharCode(s):a===64||a===-1?String.fromCharCode(s,u):String.fromCharCode(s,u,f);return g},t.getBounds=function(l){if(l.getBoundingClientRect){var o=l.getBoundingClientRect(),a=l.offsetWidth==null?o.width:l.offsetWidth;return{top:o.top,bottom:o.bottom||o.top+o.height,right:o.left+a,left:o.left,width:a,height:l.offsetHeight==null?o.height:l.offsetHeight}}return{}},t.offsetBounds=function(l){var o=l.offsetParent?t.offsetBounds(l.offsetParent):{top:0,left:0};return{top:l.offsetTop+o.top,bottom:l.offsetTop+l.offsetHeight+o.top,right:l.offsetLeft+o.left+l.offsetWidth,left:l.offsetLeft+o.left,width:l.offsetWidth,height:l.offsetHeight}},t.parseBackgrounds=function(l){function o(){p&&(a.substr(0,1)==='"'&&(a=a.substr(1,a.length-2)),a&&y.push(a),p.substr(0,1)==="-"&&0<(u=p.indexOf("-",1)+1)&&(s=p.substr(0,u),p=p.substr(u)),d.push({prefix:s,method:p.toLowerCase(),value:f,args:y,image:null})),y=[],p=s=a=f=""}var a,s,u,f,m,d=[],g=0,b=0,y=[],p=s=a=f="";return l.split("").forEach(function(x){if(!(g===0&&-1<` \r
	`.indexOf(x))){switch(x){case'"':m?m===x&&(m=null):m=x;break;case"(":if(m)break;if(g===0)return g=1,void(f+=x);b++;break;case")":if(m)break;if(g===1){if(b===0)return g=0,f+=x,void o();b--}break;case",":if(m)break;if(g===0)return void o();if(g===1&&b===0&&!p.match(/^url$/i))return y.push(a),a="",void(f+=x)}f+=x,g===0?p+=x:a+=x}}),o(),d}},{}],27:[function(e,n){function t(o){l.apply(this,arguments),this.type=o.args[0]==="linear"?l.TYPES.LINEAR:l.TYPES.RADIAL}var l=e("./gradientcontainer");t.prototype=Object.create(l.prototype),n.exports=t},{"./gradientcontainer":9}],28:[function(e,n){n.exports=function(t){return new Promise(function(l,o){var a=new XMLHttpRequest;a.open("GET",t),a.onload=function(){a.status===200?l(a.responseText):o(new Error(a.statusText))},a.onerror=function(){o(new Error("Network Error"))},a.send()})}},{}]},{},[4])(4)}),function(e){typeof kn=="object"&&typeof In!="undefined"?In.exports=e():typeof define=="function"&&define.amd?define([],e):(typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this).localforage=e()}(function(){return function e(n,t,l){function o(u,f){if(!t[u]){if(!n[u]){var m=typeof Wo=="function"&&Wo;if(!f&&m)return m(u,!0);if(a)return a(u,!0);throw m=new Error("Cannot find module '"+u+"'"),m.code="MODULE_NOT_FOUND",m}m=t[u]={exports:{}},n[u][0].call(m.exports,function(d){return o(n[u][1][d]||d)},m,m.exports,e,n,t,l)}return t[u].exports}for(var a=typeof Wo=="function"&&Wo,s=0;s<l.length;s++)o(l[s]);return o}({1:[function(e,n,t){(function(l){"use strict";function o(){f=!0;for(var b,y,p=g.length;p;){for(y=g,g=[],b=-1;++b<p;)y[b]();p=g.length}f=!1}var a,s,u,f,m=l.MutationObserver||l.WebKitMutationObserver,d=m?(a=0,m=new m(o),s=l.document.createTextNode(""),m.observe(s,{characterData:!0}),function(){s.data=a=++a%2}):l.setImmediate||l.MessageChannel===void 0?"document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var b=l.document.createElement("script");b.onreadystatechange=function(){o(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},l.document.documentElement.appendChild(b)}:function(){setTimeout(o,0)}:((u=new l.MessageChannel).port1.onmessage=o,function(){u.port2.postMessage(0)}),g=[];n.exports=function(b){g.push(b)!==1||f||d()}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(e,n,t){"use strict";function l(){}function o(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,x!==l&&f(this,x)}function a(x,_,S){this.promise=x,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function s(x,_,S){d(function(){var I;try{I=_(S)}catch(O){return g.reject(x,O)}I===x?g.reject(x,new TypeError("Cannot resolve promise with itself")):g.resolve(x,I)})}function u(x){var _=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof _=="function")return function(){_.apply(x,arguments)}}function f(x,_){function S(D){O||(O=!0,g.reject(x,D))}function I(D){O||(O=!0,g.resolve(x,D))}var O=!1,F=m(function(){_(I,S)});F.status==="error"&&S(F.value)}function m(x,_){var S={};try{S.value=x(_),S.status="success"}catch(I){S.status="error",S.value=I}return S}var d=e(1),g={},b=["REJECTED"],y=["FULFILLED"],p=["PENDING"];(n.exports=o).prototype.catch=function(x){return this.then(null,x)},o.prototype.then=function(x,_){if(typeof x!="function"&&this.state===y||typeof _!="function"&&this.state===b)return this;var S=new this.constructor(l);return this.state!==p?s(S,this.state===y?x:_,this.outcome):this.queue.push(new a(S,x,_)),S},a.prototype.callFulfilled=function(x){g.resolve(this.promise,x)},a.prototype.otherCallFulfilled=function(x){s(this.promise,this.onFulfilled,x)},a.prototype.callRejected=function(x){g.reject(this.promise,x)},a.prototype.otherCallRejected=function(x){s(this.promise,this.onRejected,x)},g.resolve=function(x,_){var S=m(u,_);if(S.status==="error")return g.reject(x,S.value);if(S=S.value,S)f(x,S);else{x.state=y,x.outcome=_;for(var I=-1,O=x.queue.length;++I<O;)x.queue[I].callFulfilled(_)}return x},g.reject=function(x,_){x.state=b,x.outcome=_;for(var S=-1,I=x.queue.length;++S<I;)x.queue[S].callRejected(_);return x},o.resolve=function(x){return x instanceof this?x:g.resolve(new this(l),x)},o.reject=function(x){var _=new this(l);return g.reject(_,x)},o.all=function(x){var _=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,I=!1;if(!S)return this.resolve([]);for(var O=new Array(S),F=0,D=-1,k=new this(l);++D<S;)(function(w,C){_.resolve(w).then(function(T){O[C]=T,++F!==S||I||(I=!0,g.resolve(k,O))},function(T){I||(I=!0,g.reject(k,T))})})(x[D],D);return k},o.race=function(x){var _=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,I=!1;if(!S)return this.resolve([]);for(var O,F=-1,D=new this(l);++F<S;)O=x[F],_.resolve(O).then(function(k){I||(I=!0,g.resolve(D,k))},function(k){I||(I=!0,g.reject(D,k))});return D}},{1:1}],3:[function(e,n,t){(function(l){"use strict";typeof l.Promise!="function"&&(l.Promise=e(2))}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(e,n,t){"use strict";function l(Q,me){Q=Q||[],me=me||{};try{return new Blob(Q,me)}catch(je){if(je.name!=="TypeError")throw je;for(var xe=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder),Te=0;Te<Q.length;Te+=1)xe.append(Q[Te]);return xe.getBlob(me.type)}}function o(Q,me){me&&Q.then(function(xe){me(null,xe)},function(xe){me(xe)})}function a(Q,me,xe){typeof me=="function"&&Q.then(me),typeof xe=="function"&&Q.catch(xe)}function s(Q){return typeof Q!="string"&&(Q=String(Q)),Q}function u(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}function f(Q){return typeof X=="boolean"?B.resolve(X):(me=Q,new B(function(xe){var Te=me.transaction(U,ae),je=l([""]);Te.objectStore(U).put(je,"key"),Te.onabort=function(De){De.preventDefault(),De.stopPropagation(),xe(!1)},Te.oncomplete=function(){var De=navigator.userAgent.match(/Chrome\/(\d+)/),Fe=navigator.userAgent.match(/Edge\//);xe(Fe||!De||43<=parseInt(De[1],10))}}).catch(function(){return!1}).then(function(xe){return X=xe}));var me}function m(Q){var Q=le[Q.name],me={};me.promise=new B(function(xe,Te){me.resolve=xe,me.reject=Te}),Q.deferredOperations.push(me),Q.dbReady?Q.dbReady=Q.dbReady.then(function(){return me.promise}):Q.dbReady=me.promise}function d(Q){return Q=le[Q.name].deferredOperations.pop(),Q&&(Q.resolve(),Q.promise)}function g(Q,me){if(Q=le[Q.name].deferredOperations.pop(),Q)return Q.reject(me),Q.promise}function b(Q,me){return new B(function(xe,Te){if(le[Q.name]=le[Q.name]||F(),Q.db){if(!me)return xe(Q.db);m(Q),Q.db.close()}var je=[Q.name];me&&je.push(Q.version);var De=N.open.apply(N,je);me&&(De.onupgradeneeded=function(Fe){var Ze=De.result;try{Ze.createObjectStore(Q.storeName),Fe.oldVersion<=1&&Ze.createObjectStore(U)}catch(Ve){if(Ve.name!=="ConstraintError")throw Ve}}),De.onerror=function(Fe){Fe.preventDefault(),Te(De.error)},De.onsuccess=function(){xe(De.result),d(Q)}})}function y(Q){return b(Q,!1)}function p(Q){return b(Q,!0)}function x(Q){if(!Q.db)return 1;var me=!Q.db.objectStoreNames.contains(Q.storeName),xe=Q.version<Q.db.version,Te=Q.version>Q.db.version;return xe&&(Q.version,Q.version=Q.db.version),(Te||me)&&(!me||(me=Q.db.version+1)>Q.version&&(Q.version=me),1)}function _(Q){return l([function(me){for(var xe=me.length,Te=new ArrayBuffer(xe),je=new Uint8Array(Te),De=0;De<xe;De++)je[De]=me.charCodeAt(De);return Te}(atob(Q.data))],{type:Q.type})}function S(Q){return Q&&Q.__local_forage_encoded_blob}function I(Q){var me=this,xe=me._initReady().then(function(){var Te=le[me._dbInfo.name];if(Te&&Te.dbReady)return Te.dbReady});return a(xe,Q,Q),xe}function O(Q,me,xe,Te){Te===void 0&&(Te=1);try{var je=Q.db.transaction(Q.storeName,me);xe(null,je)}catch(De){if(0<Te&&(!Q.db||De.name==="InvalidStateError"||De.name==="NotFoundError"))return B.resolve().then(function(){if(!Q.db||De.name==="NotFoundError"&&!Q.db.objectStoreNames.contains(Q.storeName)&&Q.version<=Q.db.version)return Q.db&&(Q.version=Q.db.version+1),p(Q)}).then(function(){return function(Fe){m(Fe);for(var Ze=le[Fe.name],Ve=Ze.forages,Ie=0;Ie<Ve.length;Ie++){var ve=Ve[Ie];ve._dbInfo.db&&(ve._dbInfo.db.close(),ve._dbInfo.db=null)}return Fe.db=null,y(Fe).then(function(Ge){return Fe.db=Ge,x(Fe)?p(Fe):Ge}).then(function(Ge){Fe.db=Ze.db=Ge;for(var Ue=0;Ue<Ve.length;Ue++)Ve[Ue]._dbInfo.db=Ge}).catch(function(Ge){throw g(Fe,Ge),Ge})}(Q).then(function(){O(Q,me,xe,Te-1)})}).catch(xe);xe(De)}}function F(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function D(Q){var me,xe,Te,je,De=.75*Q.length,Fe=Q.length,Ze=0;Q[Q.length-1]==="="&&(De--,Q[Q.length-2]==="="&&De--);for(var De=new ArrayBuffer(De),Ve=new Uint8Array(De),Ie=0;Ie<Fe;Ie+=4)me=pe.indexOf(Q[Ie]),xe=pe.indexOf(Q[Ie+1]),Te=pe.indexOf(Q[Ie+2]),je=pe.indexOf(Q[Ie+3]),Ve[Ze++]=me<<2|xe>>4,Ve[Ze++]=(15&xe)<<4|Te>>2,Ve[Ze++]=(3&Te)<<6|63&je;return De}function k(Q){for(var me=new Uint8Array(Q),xe="",Te=0;Te<me.length;Te+=3)xe+=pe[me[Te]>>2],xe+=pe[(3&me[Te])<<4|me[Te+1]>>4],xe+=pe[(15&me[Te+1])<<2|me[Te+2]>>6],xe+=pe[63&me[Te+2]];return me.length%3==2?xe=xe.substring(0,xe.length-1)+"=":me.length%3==1&&(xe=xe.substring(0,xe.length-2)+"=="),xe}function w(Q,me,xe,Te){Q.executeSql("CREATE TABLE IF NOT EXISTS "+me.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],xe,Te)}function C(Q,me,xe,Te,je,De){Q.executeSql(xe,Te,je,function(Fe,Ze){Ze.code===Ze.SYNTAX_ERR?Fe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[name],function(Ve,Ie){Ie.rows.length?De(Ve,Ze):w(Ve,me,function(){Ve.executeSql(xe,Te,je,De)},De)},De):De(Fe,Ze)},De)}function T(Q,me,xe,Te){var je=this;Q=s(Q);var De=new B(function(Fe,Ze){je.ready().then(function(){me===void 0&&(me=null);var Ve=me,Ie=je._dbInfo;Ie.serializer.serialize(me,function(ve,Ge){Ge?Ze(Ge):Ie.db.transaction(function(Ue){C(Ue,Ie,"INSERT OR REPLACE INTO "+Ie.storeName+" (key, value) VALUES (?, ?)",[Q,ve],function(){Fe(Ve)},function(We,it){Ze(it)})},function(Ue){Ue.code===Ue.QUOTA_ERR&&(0<Te?Fe(T.apply(je,[Q,Ve,xe,Te-1])):Ze(Ue))})})}).catch(Ze)});return o(De,xe),De}function z(Q,me){var xe=Q.name+"/";return Q.storeName!==me.storeName&&(xe+=Q.storeName+"/"),xe}function A(){return!function(){var Q="_localforage_support_test";try{return localStorage.setItem(Q,!0),localStorage.removeItem(Q),0}catch(me){return 1}}()||0<localStorage.length}function M(Q){for(var me=1;me<arguments.length;me++){var xe=arguments[me];if(xe)for(var Te in xe)xe.hasOwnProperty(Te)&&(Ye(xe[Te])?Q[Te]=xe[Te].slice():Q[Te]=xe[Te])}return Q}var P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},N=function(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(Q){return}}();typeof Promise=="undefined"&&e(3);function E(Q,me){for(var xe,Te,je=Q.length,De=0;De<je;){if((xe=Q[De])===(Te=me)||typeof xe=="number"&&typeof Te=="number"&&isNaN(xe)&&isNaN(Te))return 1;De++}}var B=Promise,U="local-forage-detect-blob-support",X=void 0,le={},he=Object.prototype.toString,Z="readonly",ae="readwrite",J={_driver:"asyncStorage",_initStorage:function(Q){function me(){return B.resolve()}var xe=this,Te={db:null};if(Q)for(var je in Q)Te[je]=Q[je];var De=le[Te.name];De||(De=F(),le[Te.name]=De),De.forages.push(xe),xe._initReady||(xe._initReady=xe.ready,xe.ready=I);for(var Fe=[],Ze=0;Ze<De.forages.length;Ze++){var Ve=De.forages[Ze];Ve!==xe&&Fe.push(Ve._initReady().catch(me))}var Ie=De.forages.slice(0);return B.all(Fe).then(function(){return Te.db=De.db,y(Te)}).then(function(ve){return Te.db=ve,x(Te,xe._defaultConfig.version)?p(Te):ve}).then(function(ve){Te.db=De.db=ve,xe._dbInfo=Te;for(var Ge=0;Ge<Ie.length;Ge++){var Ue=Ie[Ge];Ue!==xe&&(Ue._dbInfo.db=Te.db,Ue._dbInfo.version=Te.version)}})},_support:function(){try{if(!N)return!1;var Q=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),me=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!Q||me)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(xe){return!1}}(),iterate:function(Q,me){var xe=this,Te=new B(function(je,De){xe.ready().then(function(){O(xe._dbInfo,Z,function(Fe,Ze){if(Fe)return De(Fe);try{var Ve=Ze.objectStore(xe._dbInfo.storeName).openCursor(),Ie=1;Ve.onsuccess=function(){var ve,Ge=Ve.result;Ge?(S(ve=Ge.value)&&(ve=_(ve)),(ve=Q(ve,Ge.key,Ie++))!==void 0?je(ve):Ge.continue()):je()},Ve.onerror=function(){De(Ve.error)}}catch(ve){De(ve)}})}).catch(De)});return o(Te,me),Te},getItem:function(Q,me){var xe=this;Q=s(Q);var Te=new B(function(je,De){xe.ready().then(function(){O(xe._dbInfo,Z,function(Fe,Ze){if(Fe)return De(Fe);try{var Ve=Ze.objectStore(xe._dbInfo.storeName).get(Q);Ve.onsuccess=function(){var Ie=Ve.result;Ie===void 0&&(Ie=null),S(Ie)&&(Ie=_(Ie)),je(Ie)},Ve.onerror=function(){De(Ve.error)}}catch(Ie){De(Ie)}})}).catch(De)});return o(Te,me),Te},setItem:function(Q,me,xe){var Te=this;Q=s(Q);var je=new B(function(De,Fe){var Ze;Te.ready().then(function(){return Ze=Te._dbInfo,he.call(me)==="[object Blob]"?f(Ze.db).then(function(Ve){return Ve?me:(Ie=me,new B(function(ve,Ge){var Ue=new FileReader;Ue.onerror=Ge,Ue.onloadend=function(We){We=btoa(We.target.result||""),ve({__local_forage_encoded_blob:!0,data:We,type:Ie.type})},Ue.readAsBinaryString(Ie)}));var Ie}):me}).then(function(Ve){O(Te._dbInfo,ae,function(Ie,ve){if(Ie)return Fe(Ie);try{var Ge=ve.objectStore(Te._dbInfo.storeName);Ve===null&&(Ve=void 0);var Ue=Ge.put(Ve,Q);ve.oncomplete=function(){Ve===void 0&&(Ve=null),De(Ve)},ve.onabort=ve.onerror=function(){var We=Ue.error||Ue.transaction.error;Fe(We)}}catch(We){Fe(We)}})}).catch(Fe)});return o(je,xe),je},removeItem:function(Q,me){var xe=this;Q=s(Q);var Te=new B(function(je,De){xe.ready().then(function(){O(xe._dbInfo,ae,function(Fe,Ze){if(Fe)return De(Fe);try{var Ve=Ze.objectStore(xe._dbInfo.storeName).delete(Q);Ze.oncomplete=function(){je()},Ze.onerror=function(){De(Ve.error)},Ze.onabort=function(){var Ie=Ve.error||Ve.transaction.error;De(Ie)}}catch(Ie){De(Ie)}})}).catch(De)});return o(Te,me),Te},clear:function(Q){var me=this,xe=new B(function(Te,je){me.ready().then(function(){O(me._dbInfo,ae,function(De,Fe){if(De)return je(De);try{var Ze=Fe.objectStore(me._dbInfo.storeName).clear();Fe.oncomplete=function(){Te()},Fe.onabort=Fe.onerror=function(){var Ve=Ze.error||Ze.transaction.error;je(Ve)}}catch(Ve){je(Ve)}})}).catch(je)});return o(xe,Q),xe},length:function(Q){var me=this,xe=new B(function(Te,je){me.ready().then(function(){O(me._dbInfo,Z,function(De,Fe){if(De)return je(De);try{var Ze=Fe.objectStore(me._dbInfo.storeName).count();Ze.onsuccess=function(){Te(Ze.result)},Ze.onerror=function(){je(Ze.error)}}catch(Ve){je(Ve)}})}).catch(je)});return o(xe,Q),xe},key:function(Q,me){var xe=this,Te=new B(function(je,De){Q<0?je(null):xe.ready().then(function(){O(xe._dbInfo,Z,function(Fe,Ze){if(Fe)return De(Fe);try{var Ve=Ze.objectStore(xe._dbInfo.storeName),Ie=!1,ve=Ve.openCursor();ve.onsuccess=function(){var Ge=ve.result;Ge?Q===0||Ie?je(Ge.key):(Ie=!0,Ge.advance(Q)):je(null)},ve.onerror=function(){De(ve.error)}}catch(Ge){De(Ge)}})}).catch(De)});return o(Te,me),Te},keys:function(Q){var me=this,xe=new B(function(Te,je){me.ready().then(function(){O(me._dbInfo,Z,function(De,Fe){if(De)return je(De);try{var Ze=Fe.objectStore(me._dbInfo.storeName).openCursor(),Ve=[];Ze.onsuccess=function(){var Ie=Ze.result;Ie?(Ve.push(Ie.key),Ie.continue()):Te(Ve)},Ze.onerror=function(){je(Ze.error)}}catch(Ie){je(Ie)}})}).catch(je)});return o(xe,Q),xe},dropInstance:function(Q,me){me=u.apply(this,arguments);var xe,Te=this.config();return(Q=typeof Q!="function"&&Q||{}).name||(Q.name=Q.name||Te.name,Q.storeName=Q.storeName||Te.storeName),o(xe=Q.name?(xe=Q.name===Te.name&&this._dbInfo.db?B.resolve(this._dbInfo.db):y(Q).then(function(je){var De=le[Q.name],Fe=De.forages;De.db=je;for(var Ze=0;Ze<Fe.length;Ze++)Fe[Ze]._dbInfo.db=je;return je}),Q.storeName?xe.then(function(je){if(je.objectStoreNames.contains(Q.storeName)){var De=je.version+1;m(Q);var Fe=le[Q.name],Ze=Fe.forages;je.close();for(var Ve=0;Ve<Ze.length;Ve++){var Ie=Ze[Ve];Ie._dbInfo.db=null,Ie._dbInfo.version=De}return new B(function(ve,Ge){var Ue=N.open(Q.name,De);Ue.onerror=function(We){Ue.result.close(),Ge(We)},Ue.onupgradeneeded=function(){Ue.result.deleteObjectStore(Q.storeName)},Ue.onsuccess=function(){var We=Ue.result;We.close(),ve(We)}}).then(function(ve){Fe.db=ve;for(var Ge=0;Ge<Ze.length;Ge++){var Ue=Ze[Ge];Ue._dbInfo.db=ve,d(Ue._dbInfo)}}).catch(function(ve){throw(g(Q,ve)||B.resolve()).catch(function(){}),ve})}}):xe.then(function(je){m(Q);var De=le[Q.name],Fe=De.forages;je.close();for(var Ze=0;Ze<Fe.length;Ze++)Fe[Ze]._dbInfo.db=null;return new B(function(Ve,Ie){var ve=N.deleteDatabase(Q.name);ve.onerror=ve.onblocked=function(Ge){var Ue=ve.result;Ue&&Ue.close(),Ie(Ge)},ve.onsuccess=function(){var Ge=ve.result;Ge&&Ge.close(),Ve(Ge)}}).then(function(Ve){De.db=Ve;for(var Ie=0;Ie<Fe.length;Ie++)d(Fe[Ie]._dbInfo)}).catch(function(Ve){throw(g(Q,Ve)||B.resolve()).catch(function(){}),Ve})})):B.reject("Invalid arguments"),me),xe}},pe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",K=/^~~local_forage_type~([^~]+)~/,se="__lfsc__:",te=se.length,re=te+"arbf".length,fe=Object.prototype.toString,Me={serialize:function(Q,me){var xe="";if(Q&&(xe=fe.call(Q)),Q&&(xe==="[object ArrayBuffer]"||Q.buffer&&fe.call(Q.buffer)==="[object ArrayBuffer]")){var Te=se;Q instanceof ArrayBuffer?(je=Q,Te+="arbf"):(je=Q.buffer,xe==="[object Int8Array]"?Te+="si08":xe==="[object Uint8Array]"?Te+="ui08":xe==="[object Uint8ClampedArray]"?Te+="uic8":xe==="[object Int16Array]"?Te+="si16":xe==="[object Uint16Array]"?Te+="ur16":xe==="[object Int32Array]"?Te+="si32":xe==="[object Uint32Array]"?Te+="ui32":xe==="[object Float32Array]"?Te+="fl32":xe==="[object Float64Array]"?Te+="fl64":me(new Error("Failed to get type for BinaryArray"))),me(Te+k(je))}else if(xe==="[object Blob]"){var je=new FileReader;je.onload=function(){var De="~~local_forage_type~"+Q.type+"~"+k(this.result);me(se+"blob"+De)},je.readAsArrayBuffer(Q)}else try{me(JSON.stringify(Q))}catch(De){me(null,De)}},deserialize:function(Q){if(Q.substring(0,te)!==se)return JSON.parse(Q);var me,xe=Q.substring(re),Te=Q.substring(te,re);Te==="blob"&&K.test(xe)&&(me=(Q=xe.match(K))[1],xe=xe.substring(Q[0].length));var je=D(xe);switch(Te){case"arbf":return je;case"blob":return l([je],{type:me});case"si08":return new Int8Array(je);case"ui08":return new Uint8Array(je);case"uic8":return new Uint8ClampedArray(je);case"si16":return new Int16Array(je);case"ur16":return new Uint16Array(je);case"si32":return new Int32Array(je);case"ui32":return new Uint32Array(je);case"fl32":return new Float32Array(je);case"fl64":return new Float64Array(je);default:throw new Error("Unkown type: "+Te)}},stringToBuffer:D,bufferToString:k},ye={_driver:"webSQLStorage",_initStorage:function(Q){var me=this,xe={db:null};if(Q)for(var Te in Q)xe[Te]=typeof Q[Te]!="string"?Q[Te].toString():Q[Te];var je=new B(function(De,Fe){try{xe.db=openDatabase(xe.name,String(xe.version),xe.description,xe.size)}catch(Ze){return Fe(Ze)}xe.db.transaction(function(Ze){w(Ze,xe,function(){me._dbInfo=xe,De()},function(Ve,Ie){Fe(Ie)})},Fe)});return xe.serializer=Me,je},_support:typeof openDatabase=="function",iterate:function(Q,me){var xe=this,Te=new B(function(je,De){xe.ready().then(function(){var Fe=xe._dbInfo;Fe.db.transaction(function(Ze){C(Ze,Fe,"SELECT * FROM "+Fe.storeName,[],function(Ve,Ie){for(var ve=Ie.rows,Ge=ve.length,Ue=0;Ue<Ge;Ue++){var We=ve.item(Ue),it=(it=We.value)&&Fe.serializer.deserialize(it);if((it=Q(it,We.key,Ue+1))!==void 0)return void je(it)}je()},function(Ve,Ie){De(Ie)})})}).catch(De)});return o(Te,me),Te},getItem:function(Q,me){var xe=this;Q=s(Q);var Te=new B(function(je,De){xe.ready().then(function(){var Fe=xe._dbInfo;Fe.db.transaction(function(Ze){C(Ze,Fe,"SELECT * FROM "+Fe.storeName+" WHERE key = ? LIMIT 1",[Q],function(Ve,Ie){Ie=(Ie=Ie.rows.length?Ie.rows.item(0).value:null)&&Fe.serializer.deserialize(Ie),je(Ie)},function(Ve,Ie){De(Ie)})})}).catch(De)});return o(Te,me),Te},setItem:function(Q,me,xe){return T.apply(this,[Q,me,xe,1])},removeItem:function(Q,me){var xe=this;Q=s(Q);var Te=new B(function(je,De){xe.ready().then(function(){var Fe=xe._dbInfo;Fe.db.transaction(function(Ze){C(Ze,Fe,"DELETE FROM "+Fe.storeName+" WHERE key = ?",[Q],function(){je()},function(Ve,Ie){De(Ie)})})}).catch(De)});return o(Te,me),Te},clear:function(Q){var me=this,xe=new B(function(Te,je){me.ready().then(function(){var De=me._dbInfo;De.db.transaction(function(Fe){C(Fe,De,"DELETE FROM "+De.storeName,[],function(){Te()},function(Ze,Ve){je(Ve)})})}).catch(je)});return o(xe,Q),xe},length:function(Q){var me=this,xe=new B(function(Te,je){me.ready().then(function(){var De=me._dbInfo;De.db.transaction(function(Fe){C(Fe,De,"SELECT COUNT(key) as c FROM "+De.storeName,[],function(Ze,Ve){Ve=Ve.rows.item(0).c,Te(Ve)},function(Ze,Ve){je(Ve)})})}).catch(je)});return o(xe,Q),xe},key:function(Q,me){var xe=this,Te=new B(function(je,De){xe.ready().then(function(){var Fe=xe._dbInfo;Fe.db.transaction(function(Ze){C(Ze,Fe,"SELECT key FROM "+Fe.storeName+" WHERE id = ? LIMIT 1",[Q+1],function(Ve,Ie){Ie=Ie.rows.length?Ie.rows.item(0).key:null,je(Ie)},function(Ve,Ie){De(Ie)})})}).catch(De)});return o(Te,me),Te},keys:function(Q){var me=this,xe=new B(function(Te,je){me.ready().then(function(){var De=me._dbInfo;De.db.transaction(function(Fe){C(Fe,De,"SELECT key FROM "+De.storeName,[],function(Ze,Ve){for(var Ie=[],ve=0;ve<Ve.rows.length;ve++)Ie.push(Ve.rows.item(ve).key);Te(Ie)},function(Ze,Ve){je(Ve)})})}).catch(je)});return o(xe,Q),xe},dropInstance:function(Q,me){me=u.apply(this,arguments);var xe=this.config();(Q=typeof Q!="function"&&Q||{}).name||(Q.name=Q.name||xe.name,Q.storeName=Q.storeName||xe.storeName);var Te=this,je=Q.name?new B(function(De){var Fe,Ze=Q.name===xe.name?Te._dbInfo.db:openDatabase(Q.name,"","",0);De(Q.storeName?{db:Ze,storeNames:[Q.storeName]}:(Fe=Ze,new B(function(Ve,Ie){Fe.transaction(function(ve){ve.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Ge,Ue){for(var We=[],it=0;it<Ue.rows.length;it++)We.push(Ue.rows.item(it).name);Ve({db:Fe,storeNames:We})},function(Ge,Ue){Ie(Ue)})},function(ve){Ie(ve)})})))}).then(function(De){return new B(function(Fe,Ze){De.db.transaction(function(Ve){for(var Ie=[],ve=0,Ge=De.storeNames.length;ve<Ge;ve++)Ie.push(function(Ue){return new B(function(We,it){Ve.executeSql("DROP TABLE IF EXISTS "+Ue,[],function(){We()},function(St,Kt){it(Kt)})})}(De.storeNames[ve]));B.all(Ie).then(function(){Fe()}).catch(function(Ue){Ze(Ue)})},function(Ve){Ze(Ve)})})}):B.reject("Invalid arguments");return o(je,me),je}},e={_driver:"localStorageWrapper",_initStorage:function(Q){var me={};if(Q)for(var xe in Q)me[xe]=Q[xe];return me.keyPrefix=z(Q,this._defaultConfig),A()?((this._dbInfo=me).serializer=Me,B.resolve()):B.reject()},_support:function(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(Q){return!1}}(),iterate:function(Q,me){var xe=this,Te=xe.ready().then(function(){for(var je=xe._dbInfo,De=je.keyPrefix,Fe=De.length,Ze=localStorage.length,Ve=1,Ie=0;Ie<Ze;Ie++){var ve=localStorage.key(Ie);if(ve.indexOf(De)===0){var Ge=(Ge=localStorage.getItem(ve))&&je.serializer.deserialize(Ge);if((Ge=Q(Ge,ve.substring(Fe),Ve++))!==void 0)return Ge}}});return o(Te,me),Te},getItem:function(Q,me){var xe=this;Q=s(Q);var Te=xe.ready().then(function(){var je=xe._dbInfo,De=localStorage.getItem(je.keyPrefix+Q);return De=De&&je.serializer.deserialize(De)});return o(Te,me),Te},setItem:function(Q,me,xe){var Te=this;Q=s(Q);var je=Te.ready().then(function(){me===void 0&&(me=null);var De=me;return new B(function(Fe,Ze){var Ve=Te._dbInfo;Ve.serializer.serialize(me,function(Ie,ve){if(ve)Ze(ve);else try{localStorage.setItem(Ve.keyPrefix+Q,Ie),Fe(De)}catch(Ge){Ge.name!=="QuotaExceededError"&&Ge.name!=="NS_ERROR_DOM_QUOTA_REACHED"||Ze(Ge),Ze(Ge)}})})});return o(je,xe),je},removeItem:function(Q,me){var xe=this;Q=s(Q);var Te=xe.ready().then(function(){var je=xe._dbInfo;localStorage.removeItem(je.keyPrefix+Q)});return o(Te,me),Te},clear:function(Q){var me=this,xe=me.ready().then(function(){for(var Te=me._dbInfo.keyPrefix,je=localStorage.length-1;0<=je;je--){var De=localStorage.key(je);De.indexOf(Te)===0&&localStorage.removeItem(De)}});return o(xe,Q),xe},length:function(Q){var me=this.keys().then(function(xe){return xe.length});return o(me,Q),me},key:function(Q,me){var xe=this,Te=xe.ready().then(function(){var je,De=xe._dbInfo;try{je=localStorage.key(Q)}catch(Fe){je=null}return je=je&&je.substring(De.keyPrefix.length)});return o(Te,me),Te},keys:function(Q){var me=this,xe=me.ready().then(function(){for(var Te=me._dbInfo,je=localStorage.length,De=[],Fe=0;Fe<je;Fe++){var Ze=localStorage.key(Fe);Ze.indexOf(Te.keyPrefix)===0&&De.push(Ze.substring(Te.keyPrefix.length))}return De});return o(xe,Q),xe},dropInstance:function(Q,me){me=u.apply(this,arguments),(Q=typeof Q!="function"&&Q||{}).name||(Te=this.config(),Q.name=Q.name||Te.name,Q.storeName=Q.storeName||Te.storeName);var xe=this,Te=Q.name?new B(function(je){je(Q.storeName?z(Q,xe._defaultConfig):Q.name+"/")}).then(function(je){for(var De=localStorage.length-1;0<=De;De--){var Fe=localStorage.key(De);Fe.indexOf(je)===0&&localStorage.removeItem(Fe)}}):B.reject("Invalid arguments");return o(Te,me),Te}},Ye=Array.isArray||function(Q){return Object.prototype.toString.call(Q)==="[object Array]"},Ce={},Ke={},ft={INDEXEDDB:J,WEBSQL:ye,LOCALSTORAGE:e},e=[ft.INDEXEDDB._driver,ft.WEBSQL._driver,ft.LOCALSTORAGE._driver],et=["dropInstance"],vt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(et),wt={description:"",driver:e.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},e=new(be.prototype.config=function(Q){if((Q===void 0?"undefined":P(Q))!=="object")return typeof Q=="string"?this._config[Q]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var me in Q){if(me==="storeName"&&(Q[me]=Q[me].replace(/\W/g,"_")),me==="version"&&typeof Q[me]!="number")return new Error("Database version must be a number.");this._config[me]=Q[me]}return!("driver"in Q&&Q.driver)||this.setDriver(this._config.driver)},be.prototype.defineDriver=function(Q,me,xe){var Te=new B(function(je,De){try{var Fe=Q._driver,Ze=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!Q._driver)return void De(Ze);for(var Ve=vt.concat("_initStorage"),Ie=0,ve=Ve.length;Ie<ve;Ie++){var Ge=Ve[Ie];if((!E(et,Ge)||Q[Ge])&&typeof Q[Ge]!="function")return void De(Ze)}(function(){for(var We=0,it=et.length;We<it;We++){var St=et[We];Q[St]||(Q[St]=function(Kt){return function(){var bl=new Error("Method "+Kt+" is not implemented by the current driver"),bl=B.reject(bl);return o(bl,arguments[arguments.length-1]),bl}}(St))}})();var Ue=function(We){Ce[Fe],Ce[Fe]=Q,Ke[Fe]=We,je()};"_support"in Q?Q._support&&typeof Q._support=="function"?Q._support().then(Ue,De):Ue(!!Q._support):Ue(!0)}catch(We){De(We)}});return a(Te,me,xe),Te},be.prototype.driver=function(){return this._driver||null},be.prototype.getDriver=function(Q,me,xe){return Q=Ce[Q]?B.resolve(Ce[Q]):B.reject(new Error("Driver not found.")),a(Q,me,xe),Q},be.prototype.getSerializer=function(Q){var me=B.resolve(Me);return a(me,Q),me},be.prototype.ready=function(Q){var me=this,xe=me._driverSet.then(function(){return me._ready===null&&(me._ready=me._initDriver()),me._ready});return a(xe,Q,Q),xe},be.prototype.setDriver=function(Q,me,xe){function Te(){Fe._config.driver=Fe.driver()}function je(Ve){return Fe._extend(Ve),Te(),Fe._ready=Fe._initStorage(Fe._config),Fe._ready}function De(Ve){return function(){var Ie=0;return function ve(){for(;Ie<Ve.length;){var Ge=Ve[Ie];return Ie++,Fe._dbInfo=null,Fe._ready=null,Fe.getDriver(Ge).then(je).catch(ve)}Te();var Ue=new Error("No available storage method found.");return Fe._driverSet=B.reject(Ue),Fe._driverSet}()}}var Fe=this;Ye(Q)||(Q=[Q]);var Ze=this._getSupportedDrivers(Q),Q=this._driverSet!==null?this._driverSet.catch(function(){return B.resolve()}):B.resolve();return this._driverSet=Q.then(function(){var Ve=Ze[0];return Fe._dbInfo=null,Fe._ready=null,Fe.getDriver(Ve).then(function(Ie){Fe._driver=Ie._driver,Te(),Fe._wrapLibraryMethodsWithReady(),Fe._initDriver=De(Ze)})}).catch(function(){Te();var Ve=new Error("No available storage method found.");return Fe._driverSet=B.reject(Ve),Fe._driverSet}),a(this._driverSet,me,xe),this._driverSet},be.prototype.supports=function(Q){return!!Ke[Q]},be.prototype._extend=function(Q){M(this,Q)},be.prototype._getSupportedDrivers=function(Q){for(var me=[],xe=0,Te=Q.length;xe<Te;xe++){var je=Q[xe];this.supports(je)&&me.push(je)}return me},be.prototype._wrapLibraryMethodsWithReady=function(){for(var Q=0,me=vt.length;Q<me;Q++)(function(xe,Te){xe[Te]=function(){var je=arguments;return xe.ready().then(function(){return xe[Te].apply(xe,je)})}})(this,vt[Q])},be.prototype.createInstance=function(Q){return new be(Q)},be);function be(Q){for(var me in function(je){if(!(je instanceof be))throw new TypeError("Cannot call a class as a function")}(this),ft){var xe,Te;ft.hasOwnProperty(me)&&(Te=(xe=ft[me])._driver,this[me]=Te,Ce[Te]||this.defineDriver(xe))}this._defaultConfig=M({},wt),this._config=M({},this._defaultConfig,Q),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}n.exports=e},{3:3}]},{},[4])(4)}),function(){function e(ze,Pe){return ze.set(Pe[0],Pe[1]),ze}function n(ze,Pe){return ze.add(Pe),ze}function t(ze,Pe,ie){switch(ie.length){case 0:return ze.call(Pe);case 1:return ze.call(Pe,ie[0]);case 2:return ze.call(Pe,ie[0],ie[1]);case 3:return ze.call(Pe,ie[0],ie[1],ie[2])}return ze.apply(Pe,ie)}function l(ze,Pe,ie,dt){for(var ut=-1,bt=ze==null?0:ze.length;++ut<bt;){var Lt=ze[ut];Pe(dt,Lt,ie(Lt),ze)}return dt}function o(ze,Pe){for(var ie=-1,dt=ze==null?0:ze.length;++ie<dt&&Pe(ze[ie],ie,ze)!==!1;);return ze}function a(ze,Pe){for(var ie=ze==null?0:ze.length;ie--&&Pe(ze[ie],ie,ze)!==!1;);return ze}function s(ze,Pe){for(var ie=-1,dt=ze==null?0:ze.length;++ie<dt;)if(!Pe(ze[ie],ie,ze))return!1;return!0}function u(ze,Pe){for(var ie=-1,dt=ze==null?0:ze.length,ut=0,bt=[];++ie<dt;){var Lt=ze[ie];Pe(Lt,ie,ze)&&(bt[ut++]=Lt)}return bt}function f(ze,Pe){return!!(ze==null?0:ze.length)&&-1<S(ze,Pe,0)}function m(ze,Pe,ie){for(var dt=-1,ut=ze==null?0:ze.length;++dt<ut;)if(ie(Pe,ze[dt]))return!0;return!1}function d(ze,Pe){for(var ie=-1,dt=ze==null?0:ze.length,ut=Array(dt);++ie<dt;)ut[ie]=Pe(ze[ie],ie,ze);return ut}function g(ze,Pe){for(var ie=-1,dt=Pe.length,ut=ze.length;++ie<dt;)ze[ut+ie]=Pe[ie];return ze}function b(ze,Pe,ie,dt){var ut=-1,bt=ze==null?0:ze.length;for(dt&&bt&&(ie=ze[++ut]);++ut<bt;)ie=Pe(ie,ze[ut],ut,ze);return ie}function y(ze,Pe,ie,dt){var ut=ze==null?0:ze.length;for(dt&&ut&&(ie=ze[--ut]);ut--;)ie=Pe(ie,ze[ut],ut,ze);return ie}function p(ze,Pe){for(var ie=-1,dt=ze==null?0:ze.length;++ie<dt;)if(Pe(ze[ie],ie,ze))return!0;return!1}function x(ze,Pe,ie){var dt;return ie(ze,function(ut,bt,Lt){if(Pe(ut,bt,Lt))return dt=bt,!1}),dt}function _(ze,Pe,ie,dt){for(var ut=ze.length,bt=ie+(dt?1:-1);dt?bt--:++bt<ut;)if(Pe(ze[bt],bt,ze))return bt;return-1}function S(ze,Pe,ie){return Pe==Pe?function(dt,ut,bt){for(var Lt=bt-1,Il=dt.length;++Lt<Il;)if(dt[Lt]===ut)return Lt;return-1}(ze,Pe,ie):_(ze,O,ie)}function I(ze,Pe,ie,dt){for(var ut=ie-1,bt=ze.length;++ut<bt;)if(dt(ze[ut],Pe))return ut;return-1}function O(ze){return ze!=ze}function F(ze,Pe){var ie=ze==null?0:ze.length;return ie?C(ze,Pe)/ie:re}function D(ze){return function(Pe){return Pe==null?J:Pe[ze]}}function k(ze){return function(Pe){return ze==null?J:ze[Pe]}}function w(ze,Pe,ie,dt,ut){return ut(ze,function(bt,Lt,Il){ie=dt?(dt=!1,bt):Pe(ie,bt,Lt,Il)}),ie}function C(ze,Pe){for(var ie,dt=-1,ut=ze.length;++dt<ut;){var bt=Pe(ze[dt]);bt!==J&&(ie=ie===J?bt:ie+bt)}return ie}function T(ze,Pe){for(var ie=-1,dt=Array(ze);++ie<ze;)dt[ie]=Pe(ie);return dt}function z(ze){return function(Pe){return ze(Pe)}}function A(ze,Pe){return d(Pe,function(ie){return ze[ie]})}function M(ze,Pe){return ze.has(Pe)}function P(ze,Pe){for(var ie=-1,dt=ze.length;++ie<dt&&-1<S(Pe,ze[ie],0););return ie}function N(ze,Pe){for(var ie=ze.length;ie--&&-1<S(Pe,ze[ie],0););return ie}function E(ze){return"\\"+Yh[ze]}function B(ze){return qc.test(ze)}function U(ze){var Pe=-1,ie=Array(ze.size);return ze.forEach(function(dt,ut){ie[++Pe]=[ut,dt]}),ie}function X(ze,Pe){return function(ie){return ze(Pe(ie))}}function le(ze,Pe){for(var ie=-1,dt=ze.length,ut=0,bt=[];++ie<dt;){var Lt=ze[ie];Lt!==Pe&&Lt!==se||(ze[ie]=se,bt[ut++]=ie)}return bt}function he(ze){var Pe=-1,ie=Array(ze.size);return ze.forEach(function(dt){ie[++Pe]=dt}),ie}function Z(ze){return(B(ze)?function(Pe){for(var ie=js.lastIndex=0;js.test(Pe);)++ie;return ie}:ce)(ze)}function ae(ze){return B(ze)?ze.match(js)||[]:ze.split("")}var J,pe="Expected a function",K="__lodash_hash_undefined__",se="__lodash_placeholder__",te=9007199254740991,re=NaN,fe=4294967295,Me=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],ye="[object Arguments]",Ye="[object Array]",Ce="[object Boolean]",Ke="[object Date]",ft="[object Error]",et="[object Function]",vt="[object GeneratorFunction]",wt="[object Map]",be="[object Number]",Q="[object Object]",me="[object Promise]",xe="[object RegExp]",Te="[object Set]",je="[object String]",De="[object Symbol]",Fe="[object WeakMap]",Ze="[object ArrayBuffer]",Ve="[object DataView]",Ie="[object Float32Array]",ve="[object Float64Array]",Ge="[object Int8Array]",Ue="[object Int16Array]",We="[object Int32Array]",it="[object Uint8Array]",St="[object Uint8ClampedArray]",Kt="[object Uint16Array]",bl="[object Uint32Array]",hl=/\b__p \+= '';/g,Rr=/\b(__p \+=) '' \+/g,Di=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ln=/&(?:amp|lt|gt|quot|#39);/g,_e=/[&<>"']/g,Ne=RegExp(ln.source),nt=RegExp(_e.source),mt=/<%-([\s\S]+?)%>/g,Ft=/<%([\s\S]+?)%>/g,_t=/<%=([\s\S]+?)%>/g,Jt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,qt=/^\w*$/,wl=/^\./,Tl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Wl=/[\\^$.*+?()[\]{}|]/g,sn=RegExp(Wl.source),Vr=/^\s+|\s+$/g,An=/^\s+/,zn=/\s+$/,On=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Dr=/\{\n\/\* \[wrapped with (.+)\] \*/,Vn=/,? & /,ii=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,na=/\\(\\)?/g,di=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,oi=/\w*$/,gn=/^[-+]0x[0-9a-f]+$/i,ai=/^0b[01]+$/i,zt=/^\[object .+?Constructor\]$/,tl=/^0o[0-7]+$/i,ul=/^(?:0|[1-9]\d*)$/,Ar=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,or=/($^)/,pn=/['\n\r\u2028\u2029\\]/g,Fl="\\ud800-\\udfff",Gi="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",fo="\\u2700-\\u27bf",ts="a-z\\xdf-\\xf6\\xf8-\\xff",Oo="A-Z\\xc0-\\xd6\\xd8-\\xde",Po="\\ufe0e\\ufe0f",Yi="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Wc="["+Fl+"]",Ju="["+Yi+"]",ls="["+Gi+"]",Ra="\\d+",rs="["+fo+"]",Ls="["+ts+"]",ns="[^"+Fl+Yi+Ra+fo+ts+Oo+"]",Hs="\\ud83c[\\udffb-\\udfff]",Qu="[^"+Fl+"]",Uc="(?:\\ud83c[\\udde6-\\uddff]){2}",Gc="[\\ud800-\\udbff][\\udc00-\\udfff]",ia="["+Oo+"]",Bs="(?:"+Ls+"|"+ns+")",Yi="(?:"+ia+"|"+ns+")",fo="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ts="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Oo="(?:"+ls+"|"+Hs+")?",ns="["+Po+"]?",Oo=ns+Oo+("(?:\\u200d(?:"+[Qu,Uc,Gc].join("|")+")"+ns+Oo+")*"),rs="(?:"+[rs,Uc,Gc].join("|")+")"+Oo,Wc="(?:"+[Qu+ls+"?",ls,Uc,Gc,Wc].join("|")+")",ef=RegExp("['\u2019]","g"),Yc=RegExp(ls,"g"),js=RegExp(Hs+"(?="+Hs+")|"+Wc+Oo,"g"),tf=RegExp([ia+"?"+Ls+"+"+fo+"(?="+[Ju,ia,"$"].join("|")+")",Yi+"+"+ts+"(?="+[Ju,ia+Bs,"$"].join("|")+")",ia+"?"+Bs+"+"+fo,ia+"+"+ts,"\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",Ra,rs].join("|"),"g"),qc=RegExp("[\\u200d"+Fl+Gi+Po+"]"),Uh=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Gh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],lf=-1,Fr={};Fr[Ie]=Fr[ve]=Fr[Ge]=Fr[Ue]=Fr[We]=Fr[it]=Fr[St]=Fr[Kt]=Fr[bl]=!0,Fr[ye]=Fr[Ye]=Fr[Ze]=Fr[Ce]=Fr[Ve]=Fr[Ke]=Fr[ft]=Fr[et]=Fr[wt]=Fr[be]=Fr[Q]=Fr[xe]=Fr[Te]=Fr[je]=Fr[Fe]=!1;var _r={};_r[ye]=_r[Ye]=_r[Ze]=_r[Ve]=_r[Ce]=_r[Ke]=_r[Ie]=_r[ve]=_r[Ge]=_r[Ue]=_r[We]=_r[wt]=_r[be]=_r[Q]=_r[xe]=_r[Te]=_r[je]=_r[De]=_r[it]=_r[St]=_r[Kt]=_r[bl]=!0,_r[ft]=_r[et]=_r[Fe]=!1;var Yh={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},is=parseFloat,rf=parseInt,Fl=typeof global=="object"&&global&&global.Object===Object&&global,Gi=typeof self=="object"&&self&&self.Object===Object&&self,rn=Fl||Gi||Function("return this")(),Po=typeof kn=="object"&&kn&&!kn.nodeType&&kn,Gi=Po&&typeof In=="object"&&In&&!In.nodeType&&In,Xc=Gi&&Gi.exports===Po,Vs=Xc&&Fl.process,Fl=function(){try{return Vs&&Vs.binding&&Vs.binding("util")}catch(ze){}}(),nf=Fl&&Fl.isArrayBuffer,of=Fl&&Fl.isDate,H=Fl&&Fl.isMap,G=Fl&&Fl.isRegExp,ee=Fl&&Fl.isSet,ne=Fl&&Fl.isTypedArray,ce=D("length"),ge=k({\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"}),Ae=k({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Je=k({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),at=function ze(Pe){function ie(R){if(an(R)&&!Ll(R)&&!(R instanceof bt)){if(R instanceof ut)return R;if(Nr.call(R,"__wrapped__"))return sp(R)}return new ut(R)}function dt(){}function ut(R,L){this.__wrapped__=R,this.__actions__=[],this.__chain__=!!L,this.__index__=0,this.__values__=J}function bt(R){this.__wrapped__=R,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=fe,this.__views__=[]}function Lt(R){var L=-1,W=R==null?0:R.length;for(this.clear();++L<W;){var oe=R[L];this.set(oe[0],oe[1])}}function Il(R){var L=-1,W=R==null?0:R.length;for(this.clear();++L<W;){var oe=R[L];this.set(oe[0],oe[1])}}function yr(R){var L=-1,W=R==null?0:R.length;for(this.clear();++L<W;){var oe=R[L];this.set(oe[0],oe[1])}}function Ql(R){var L=-1,W=R==null?0:R.length;for(this.__data__=new yr;++L<W;)this.add(R[L])}function nn(R){R=this.__data__=new Il(R),this.size=R.size}function Dl(R,L){var W,oe=Ll(R),ke=!oe&&gs(R),Re=!oe&&!ke&&za(R),Xe=!oe&&!ke&&!Re&&oc(R),tt=oe||ke||Re||Xe,ot=tt?T(R.length,Vk):[],kt=ot.length;for(W in R)!L&&!Nr.call(R,W)||tt&&(W=="length"||Re&&(W=="offset"||W=="parent")||Xe&&(W=="buffer"||W=="byteLength"||W=="byteOffset")||ua(W,kt))||ot.push(W);return ot}function Ai(R){var L=R.length;return L?R[cs(0,L-1)]:J}function sl(R,L){return kf(pi(R),zr(L,0,R.length))}function kr(R){return kf(pi(R))}function Kr(R,L,W){(W===J||Ho(R[L],W))&&(W!==J||L in R)||Wr(R,L,W)}function Xn(R,L,W){var oe=R[L];Nr.call(R,L)&&Ho(oe,W)&&(W!==J||L in R)||Wr(R,L,W)}function ho(R,L){for(var W=R.length;W--;)if(Ho(R[W][0],L))return W;return-1}function oa(R,L,W,oe){return Aa(R,function(ke,Re,Xe){L(oe,ke,W(ke),Xe)}),oe}function mi(R,L){return R&&No(L,Nn(L),R)}function Wr(R,L,W){L=="__proto__"&&Mf?Mf(R,L,{configurable:!0,enumerable:!0,value:W,writable:!0}):R[L]=W}function vn(R,L){for(var W=-1,oe=L.length,ke=$n(oe),Re=R==null;++W<oe;)ke[W]=Re?J:ad(R,L[W]);return ke}function zr(R,L,W){return R==R&&(W!==J&&(R=R<=W?R:W),L!==J&&(R=L<=R?R:L)),R}function _n(R,L,W,oe,ke,Re){var Xe,tt=1&L,ot=2&L,kt=4&L;if(W&&(Xe=ke?W(R,oe,ke,Re):W(R)),Xe!==J)return Xe;if(!en(R))return R;var gt,Rt,Bt=Ll(R);if(Bt){if(oe=(Ot=R).length,Wt=Ot.constructor(oe),oe&&typeof Ot[0]=="string"&&Nr.call(Ot,"index")&&(Wt.index=Ot.index,Wt.input=Ot.input),Xe=Wt,!tt)return pi(R,Xe)}else{var Ot=Kn(R),Wt=Ot==et||Ot==vt;if(za(R))return En(R,tt);if(Ot==Q||Ot==ye||Wt&&!ke){if(Xe=ot||Wt?{}:tp(R),!tt)return ot?(Wt=gt=R,Rt=(Rt=Xe)&&No(Wt,Ei(Wt),Rt),No(gt,Wp(gt),Rt)):(Rt=mi(Xe,gt=R),No(gt,Id(gt),Rt))}else{if(!_r[Ot])return ke?R:{};Xe=function(Ht,dl,Cl,yl){var Pr=Ht.constructor;switch(dl){case Ze:return us(Ht);case Ce:case Ke:return new Pr(+Ht);case Ve:return function(pl,cr){return cr=cr?us(pl.buffer):pl.buffer,new pl.constructor(cr,pl.byteOffset,pl.byteLength)}(Ht,yl);case Ie:case ve:case Ge:case Ue:case We:case it:case St:case Kt:case bl:return ff(Ht,yl);case wt:return function(pl,cr,Lr){return b(cr?Lr(U(pl),1):U(pl),e,new pl.constructor)}(Ht,yl,Cl);case be:case je:return new Pr(Ht);case xe:return function(pl){var cr=new pl.constructor(pl.source,oi.exec(pl));return cr.lastIndex=pl.lastIndex,cr}(Ht);case Te:return function(pl,cr,Lr){return b(cr?Lr(he(pl),1):he(pl),n,new pl.constructor)}(Ht,yl,Cl);case De:return function(pl){return cu?Ur(cu.call(pl)):{}}(Ht)}}(R,Ot,_n,tt)}}if(tt=(Re=Re||new nn).get(R),tt)return tt;Re.set(R,Xe);var ml=Bt?J:(kt?ot?ed:Qh:ot?Ei:Nn)(R);return o(ml||R,function(Ht,dl){ml&&(Ht=R[dl=Ht]),Xn(Xe,dl,_n(Ht,L,W,dl,R,Re))}),Xe}function mo(R,L,W){var oe=W.length;if(R==null)return!oe;for(R=Ur(R);oe--;){var ke=W[oe],Re=L[ke],Xe=R[ke];if(Xe===J&&!(ke in R)||!Re(Xe))return!1}return!0}function Er(R,L,W){if(typeof R!="function")throw new Zi(pe);return uu(function(){R.apply(J,W)},L)}function sr(R,L,W,oe){var ke=-1,Re=f,Xe=!0,tt=R.length,ot=[],kt=L.length;if(!tt)return ot;W&&(L=d(L,z(W))),oe?(Re=m,Xe=!1):200<=L.length&&(Re=M,Xe=!1,L=new Ql(L));e:for(;++ke<tt;){var gt=R[ke],Rt=W==null?gt:W(gt),gt=oe||gt!==0?gt:0;if(Xe&&Rt==Rt){for(var Bt=kt;Bt--;)if(L[Bt]===Rt)continue e;ot.push(gt)}else Re(L,Rt,oe)||ot.push(gt)}return ot}function Or(R,L){var W=!0;return Aa(R,function(oe,ke,Re){return W=!!L(oe,ke,Re)}),W}function Cn(R,L,W){for(var oe=-1,ke=R.length;++oe<ke;){var Re,Xe,tt=R[oe],ot=L(tt);ot!=null&&(Re===J?ot==ot&&!Pi(ot):W(ot,Re))&&(Re=ot,Xe=tt)}return Xe}function _l(R,L){var W=[];return Aa(R,function(oe,ke,Re){L(oe,ke,Re)&&W.push(oe)}),W}function rr(R,L,W,oe,ke){var Re=-1,Xe=R.length;for(W=W||jk,ke=ke||[];++Re<Xe;){var tt=R[Re];0<L&&W(tt)?1<L?rr(tt,L-1,W,oe,ke):g(ke,tt):oe||(ke[ke.length]=tt)}return ke}function Pn(R,L){return R&&_d(R,L,Nn)}function aa(R,L){return R&&jp(R,L,Nn)}function Ws(R,L){return u(L,function(W){return fa(R[W])})}function go(R,L){for(var W=0,oe=(L=yn(L,R)).length;R!=null&&W<oe;)R=R[Lo(L[W++])];return W&&W==oe?R:J}function af(R,L,W){return L=L(R),Ll(R)?L:g(L,W(R))}function Wn(R){return R==null?R===J?"[object Undefined]":"[object Null]":ds&&ds in Ur(R)?function(L){var W=Nr.call(L,ds),oe=L[ds];try{L[ds]=J;var ke=!0}catch(Xe){}var Re=zp.call(L);return ke&&(W?L[ds]=oe:delete L[ds]),Re}(R):(R=R,zp.call(R))}function Zc(R,L){return L<R}function qh(R,L){return R!=null&&Nr.call(R,L)}function sf(R,L){return R!=null&&L in Ur(R)}function Fa(R,L,W){for(var oe=W?m:f,ke=R[0].length,Re=R.length,Xe=Re,tt=$n(Re),ot=1/0,kt=[];Xe--;){var gt=R[Xe];Xe&&L&&(gt=d(gt,z(L))),ot=Zn(gt.length,ot),tt[Xe]=!W&&(L||120<=ke&&120<=gt.length)?new Ql(Xe&&gt):J}gt=R[0];var Rt=-1,Bt=tt[0];e:for(;++Rt<ke&&kt.length<ot;){var Ot=gt[Rt],Wt=L?L(Ot):Ot,Ot=W||Ot!==0?Ot:0;if(!(Bt?M(Bt,Wt):oe(kt,Wt,W))){for(Xe=Re;--Xe;){var ml=tt[Xe];if(!(ml?M(ml,Wt):oe(R[Xe],Wt,W)))continue e}Bt&&Bt.push(Wt),kt.push(Ot)}}return kt}function os(R,L,W){return L=(R=ip(R,L=yn(L,R)))==null?R:R[Lo(qi(L))],L==null?J:t(L,R,W)}function cf(R){return an(R)&&Wn(R)==ye}function po(R,L,W,oe,ke){return R===L||(R==null||L==null||!an(R)&&!an(L)?R!=R&&L!=L:function(Re,Xe,tt,ot,kt,gt){var Rt=Ll(Re),Bt=Ll(Xe),Ot=Rt?Ye:Kn(Re),Wt=Bt?Ye:Kn(Xe),ml=(Ot=Ot==ye?Q:Ot)==Q,Bt=(Wt=Wt==ye?Q:Wt)==Q,Wt=Ot==Wt;if(Wt&&za(Re)){if(!za(Xe))return!1;ml=!(Rt=!0)}return Wt&&!ml?(gt=gt||new nn,Rt||oc(Re)?Qg(Re,Xe,tt,ot,kt,gt):function(Ht,dl,Cl,yl,Pr,pl,cr){switch(Cl){case Ve:if(Ht.byteLength!=dl.byteLength||Ht.byteOffset!=dl.byteOffset)return!1;Ht=Ht.buffer,dl=dl.buffer;case Ze:return!(Ht.byteLength!=dl.byteLength||!pl(new Tf(Ht),new Tf(dl)));case Ce:case Ke:case be:return Ho(+Ht,+dl);case ft:return Ht.name==dl.name&&Ht.message==dl.message;case xe:case je:return Ht==dl+"";case wt:var Lr=U;case Te:var Ln=1&yl;return Lr=Lr||he,Ht.size!=dl.size&&!Ln?!1:(Ln=cr.get(Ht),Ln?Ln==dl:(yl|=2,cr.set(Ht,dl),Lr=Qg(Lr(Ht),Lr(dl),yl,Pr,pl,cr),cr.delete(Ht),Lr));case De:if(cu)return cu.call(Ht)==cu.call(dl)}return!1}(Re,Xe,Ot,tt,ot,kt,gt)):!(1&tt)&&(ml=ml&&Nr.call(Re,"__wrapped__"),Bt=Bt&&Nr.call(Xe,"__wrapped__"),ml||Bt)?(ml=ml?Re.value():Re,Bt=Bt?Xe.value():Xe,gt=gt||new nn,kt(ml,Bt,tt,ot,gt)):!!Wt&&(gt=gt||new nn,function(Ht,dl,Cl,yl,Pr,pl){var cr=1&Cl,Lr=Qh(Ht),Ln=Lr.length,Ki=Qh(dl).length;if(Ln!=Ki&&!cr)return!1;for(var vo=Ln;vo--;){var jo=Lr[vo];if(!(cr?jo in dl:Nr.call(dl,jo)))return!1}var Vo=pl.get(Ht);if(Vo&&pl.get(dl))return Vo==dl;var Pf=!0;pl.set(Ht,dl),pl.set(dl,Ht);for(var Ed=cr;++vo<Ln;){jo=Lr[vo];var Nd,Ef=Ht[jo],Nf=dl[jo];if(yl&&(Nd=cr?yl(Nf,Ef,jo,dl,Ht,pl):yl(Ef,Nf,jo,Ht,dl,pl)),!(Nd===J?Ef===Nf||Pr(Ef,Nf,Cl,yl,pl):Nd)){Pf=!1;break}Ed=Ed||jo=="constructor"}return Pf&&!Ed&&(Ki=Ht.constructor,Vo=dl.constructor,Ki!=Vo&&"constructor"in Ht&&"constructor"in dl&&!(typeof Ki=="function"&&Ki instanceof Ki&&typeof Vo=="function"&&Vo instanceof Vo)&&(Pf=!1)),pl.delete(Ht),pl.delete(dl),Pf}(Re,Xe,tt,ot,kt,gt))}(R,L,W,oe,po,ke))}function Kc(R,L,W,oe){var ke=W.length,Re=ke,Xe=!oe;if(R==null)return!Re;for(R=Ur(R);ke--;){var tt=W[ke];if(Xe&&tt[2]?tt[1]!==R[tt[0]]:!(tt[0]in R))return!1}for(;++ke<Re;){var ot=(tt=W[ke])[0],kt=R[ot],gt=tt[1];if(Xe&&tt[2]){if(kt===J&&!(ot in R))return!1}else{var Rt,Bt=new nn;if(oe&&(Rt=oe(kt,gt,ot,R,L,Bt)),!(Rt===J?po(gt,kt,3,oe,Bt):Rt))return!1}}return!0}function Us(R){return!(!en(R)||(L=R,Ap&&Ap in L))&&(fa(R)?Yk:zt).test(hs(R));var L}function uf(R){return typeof R=="function"?R:R==null?ki:typeof R=="object"?Ll(R)?Gs(R[0],R[1]):Oi(R):Fp(R)}function zi(R){if(!eu(R))return Zk(R);var L,W=[];for(L in Ur(R))Nr.call(R,L)&&L!="constructor"&&W.push(L);return W}function Cr(R){if(!en(R))return function(ke){var Re=[];if(ke!=null)for(var Xe in Ur(ke))Re.push(Xe);return Re}(R);var L,W=eu(R),oe=[];for(L in R)(L!="constructor"||!W&&Nr.call(R,L))&&oe.push(L);return oe}function as(R,L){return R<L}function gi(R,L){var W=-1,oe=yi(R)?$n(R.length):[];return Aa(R,function(ke,Re,Xe){oe[++W]=L(ke,Re,Xe)}),oe}function Oi(R){var L=td(R);return L.length==1&&L[0][2]?rp(L[0][0],L[0][1]):function(W){return W===R||Kc(W,R,L)}}function Gs(R,L){return ld(R)&&lp(L)?rp(Lo(R),L):function(W){var oe=ad(W,R);return oe===J&&oe===L?sd(W,R):po(L,oe,3)}}function ss(R,L,W,oe,ke){R!==L&&_d(L,function(Re,Xe){var tt;en(Re)?(ke=ke||new nn,function(ot,kt,gt,Rt,Bt,Ot,Wt){var ml=ot[gt],Ht=kt[gt],dl=Wt.get(Ht);if(dl)return Kr(ot,gt,dl);var Cl,yl=Ot?Ot(ml,Ht,gt+"",ot,kt,Wt):J,Pr=yl===J;Pr&&(Cl=Ll(Ht),dl=!Cl&&za(Ht),kt=!Cl&&!dl&&oc(Ht),yl=Ht,Cl||dl||kt?yl=Ll(ml)?ml:un(ml)?pi(ml):dl?En(Ht,!(Pr=!1)):kt?ff(Ht,!(Pr=!1)):[]:tu(Ht)||gs(Ht)?gs(yl=ml)?yl=$p(ml):(!en(ml)||Rt&&fa(ml))&&(yl=tp(Ht)):Pr=!1),Pr&&(Wt.set(Ht,yl),Bt(yl,Ht,Rt,Ot,Wt),Wt.delete(Ht)),Kr(ot,gt,yl)}(R,L,Xe,W,ss,oe,ke)):((tt=oe?oe(R[Xe],Re,Xe+"",R,L,ke):J)===J&&(tt=Re),Kr(R,Xe,tt))},Ei)}function Eo(R,L){var W=R.length;if(W)return ua(L+=L<0?W:0,W)?R[L]:J}function Ys(R,L,W){var oe=-1;return L=d(L.length?L:[ki],z(xl())),function(ke,Re){var Xe=ke.length;for(ke.sort(Re);Xe--;)ke[Xe]=ke[Xe].value;return ke}(gi(R,function(ke,Re,Xe){return{criteria:d(L,function(tt){return tt(ke)}),index:++oe,value:ke}}),function(ke,Re){return function(Xe,tt,ot){for(var kt=-1,gt=Xe.criteria,Rt=tt.criteria,Bt=gt.length,Ot=ot.length;++kt<Bt;){var Wt=Hg(gt[kt],Rt[kt]);if(Wt){if(Ot<=kt)return Wt;var ml=ot[kt];return Wt*(ml=="desc"?-1:1)}}return Xe.index-tt.index}(ke,Re,W)})}function Jc(R,L,W){for(var oe=-1,ke=L.length,Re={};++oe<ke;){var Xe=L[oe],tt=go(R,Xe);W(tt,Xe)&&Ee(Re,yn(Xe,R),tt)}return Re}function Ma(R,L,W,oe){var ke=oe?I:S,Re=-1,Xe=L.length,tt=R;for(R===L&&(L=pi(L)),W&&(tt=d(R,z(W)));++Re<Xe;)for(var ot=0,kt=L[Re],gt=W?W(kt):kt;-1<(ot=ke(tt,gt,ot,oe));)tt!==R&&Ff.call(tt,ot,1),Ff.call(R,ot,1);return R}function qs(R,L){for(var W=R?L.length:0,oe=W-1;W--;){var ke,Re=L[W];W!=oe&&Re===ke||(ua(ke=Re)?Ff.call(R,Re,1):Bl(R,Re))}return R}function cs(R,L){return R+Af(Lp()*(L-R+1))}function Da(R,L){var W="";if(!R||L<1||te<L)return W;for(;L%2&&(W+=R),L=Af(L/2),L&&(R+=R),L;);return W}function El(R,L){return Fd(np(R,L,ki),R+"")}function Xh(R){return Ai(Js(R))}function Se(R,L){return R=Js(R),kf(R,zr(L,0,R.length))}function Ee(R,L,W,oe){if(!en(R))return R;for(var ke=-1,Re=(L=yn(L,R)).length,Xe=Re-1,tt=R;tt!=null&&++ke<Re;){var ot,kt=Lo(L[ke]),gt=W;ke!=Xe&&(ot=tt[kt],(gt=oe?oe(ot,kt,tt):J)===J&&(gt=en(ot)?ot:ua(L[ke+1])?[]:{})),Xn(tt,kt,gt),tt=tt[kt]}return R}function qe(R){return kf(Js(R))}function st(R,L,W){var oe=-1,ke=R.length;L<0&&(L=ke<-L?0:ke+L),(W=ke<W?ke:W)<0&&(W+=ke),ke=W<L?0:W-L>>>0,L>>>=0;for(var Re=$n(ke);++oe<ke;)Re[oe]=R[oe+L];return Re}function Dt(R,L){var W;return Aa(R,function(oe,ke,Re){return!(W=L(oe,ke,Re))}),!!W}function il(R,L,W){var oe=0,ke=R==null?oe:R.length;if(typeof L=="number"&&L==L&&ke<=2147483647){for(;oe<ke;){var Re=oe+ke>>>1,Xe=R[Re];Xe!==null&&!Pi(Xe)&&(W?Xe<=L:Xe<L)?oe=1+Re:ke=Re}return ke}return At(R,L,ki,W)}function At(R,L,W,oe){L=W(L);for(var ke=0,Re=R==null?0:R.length,Xe=L!=L,tt=L===null,ot=Pi(L),kt=L===J;ke<Re;){var gt=Af((ke+Re)/2),Rt=W(R[gt]),Bt=Rt!==J,Ot=Rt===null,Wt=Rt==Rt,ml=Pi(Rt),Rt=Xe?oe||Wt:kt?Wt&&(oe||Bt):tt?Wt&&Bt&&(oe||!Ot):ot?Wt&&Bt&&!Ot&&(oe||!ml):!Ot&&!ml&&(oe?Rt<=L:Rt<L);Rt?ke=gt+1:Re=gt}return Zn(Re,4294967294)}function Xt(R,L){for(var W=-1,oe=R.length,ke=0,Re=[];++W<oe;){var Xe,tt=R[W],ot=L?L(tt):tt;W&&Ho(ot,Xe)||(Xe=ot,Re[ke++]=tt===0?0:tt)}return Re}function fl(R){return typeof R=="number"?R:Pi(R)?re:+R}function vl(R){if(typeof R=="string")return R;if(Ll(R))return d(R,vl)+"";if(Pi(R))return Hp?Hp.call(R):"";var L=R+"";return L=="0"&&1/R==-1/0?"-0":L}function ol(R,L,W){var oe=-1,ke=f,Re=R.length,Xe=!0,tt=[],ot=tt;if(W)Xe=!1,ke=m;else if(200<=Re){var kt=L?null:ob(R);if(kt)return he(kt);Xe=!1,ke=M,ot=new Ql}else ot=L?[]:tt;e:for(;++oe<Re;){var gt=R[oe],Rt=L?L(gt):gt,gt=W||gt!==0?gt:0;if(Xe&&Rt==Rt){for(var Bt=ot.length;Bt--;)if(ot[Bt]===Rt)continue e;L&&ot.push(Rt),tt.push(gt)}else ke(ot,Rt,W)||(ot!==tt&&ot.push(Rt),tt.push(gt))}return tt}function Bl(R,L){return(R=ip(R,L=yn(L,R)))==null||delete R[Lo(qi(L))]}function dr(R,L,W,oe){return Ee(R,L,W(go(R,L)),oe)}function gr(R,L,W,oe){for(var ke=R.length,Re=oe?ke:-1;(oe?Re--:++Re<ke)&&L(R[Re],Re,R););return W?st(R,oe?0:Re,oe?Re+1:ke):st(R,oe?Re+1:0,oe?ke:Re)}function cl(R,L){return R instanceof bt&&(R=R.value()),b(L,function(W,oe){return oe.func.apply(oe.thisArg,g([W],oe.args))},R)}function Jr(R,L,W){var oe=R.length;if(oe<2)return oe?ol(R[0]):[];for(var ke=-1,Re=$n(oe);++ke<oe;)for(var Xe=R[ke],tt=-1;++tt<oe;)tt!=ke&&(Re[ke]=sr(Re[ke]||Xe,R[tt],L,W));return ol(rr(Re,1),L,W)}function cn(R,L,W){for(var oe=-1,ke=R.length,Re=L.length,Xe={};++oe<ke;){var tt=oe<Re?L[oe]:J;W(Xe,R[oe],tt)}return Xe}function Qr(R){return un(R)?R:[]}function nr(R){return typeof R=="function"?R:ki}function yn(R,L){return Ll(R)?R:ld(R,L)?[R]:Gp(pr(R))}function on(R,L,W){var oe=R.length;return W=W===J?oe:W,!L&&oe<=W?R:st(R,L,W)}function En(R,L){return L?R.slice():(L=R.length,L=Op?Op(L):new R.constructor(L),R.copy(L),L)}function us(R){var L=new R.constructor(R.byteLength);return new Tf(L).set(new Tf(R)),L}function ff(R,L){return L=L?us(R.buffer):R.buffer,new R.constructor(L,R.byteOffset,R.length)}function Hg(R,L){if(R!==L){var W=R!==J,oe=R===null,ke=R==R,Re=Pi(R),Xe=L!==J,tt=L===null,ot=L==L,kt=Pi(L);if(!tt&&!kt&&!Re&&L<R||Re&&Xe&&ot&&!tt&&!kt||oe&&Xe&&ot||!W&&ot||!ke)return 1;if(!oe&&!Re&&!kt&&R<L||kt&&W&&ke&&!oe&&!Re||tt&&W&&ke||!Xe&&ke||!ot)return-1}return 0}function Bg(R,L,W,oe){for(var ke=-1,Re=R.length,Xe=W.length,tt=-1,ot=L.length,kt=Sn(Re-Xe,0),gt=$n(ot+kt),Rt=!oe;++tt<ot;)gt[tt]=L[tt];for(;++ke<Xe;)(Rt||ke<Re)&&(gt[W[ke]]=R[ke]);for(;kt--;)gt[tt++]=R[ke++];return gt}function jg(R,L,W,oe){for(var ke=-1,Re=R.length,Xe=-1,tt=W.length,ot=-1,kt=L.length,gt=Sn(Re-tt,0),Rt=$n(gt+kt),Bt=!oe;++ke<gt;)Rt[ke]=R[ke];for(var Ot=ke;++ot<kt;)Rt[Ot+ot]=L[ot];for(;++Xe<tt;)(Bt||ke<Re)&&(Rt[Ot+W[Xe]]=R[ke++]);return Rt}function pi(R,L){var W=-1,oe=R.length;for(L=L||$n(oe);++W<oe;)L[W]=R[W];return L}function No(R,L,W,oe){var ke=!W;W=W||{};for(var Re=-1,Xe=L.length;++Re<Xe;){var tt=L[Re],ot=oe?oe(W[tt],R[tt],tt,W,R):J;ot===J&&(ot=R[tt]),(ke?Wr:Xn)(W,tt,ot)}return W}function hf(R,L){return function(W,oe){var ke=Ll(W)?l:oa,Re=L?L():{};return ke(W,R,xl(oe,2),Re)}}function Xs(R){return El(function(L,W){var oe=-1,ke=W.length,Re=1<ke?W[ke-1]:J,Xe=2<ke?W[2]:J,Re=3<R.length&&typeof Re=="function"?(ke--,Re):J;for(Xe&&vi(W[0],W[1],Xe)&&(Re=ke<3?J:Re,ke=1),L=Ur(L);++oe<ke;){var tt=W[oe];tt&&R(L,tt,oe,Re)}return L})}function Vg(R,L){return function(W,oe){if(W==null)return W;if(!yi(W))return R(W,oe);for(var ke=W.length,Re=L?ke:-1,Xe=Ur(W);(L?Re--:++Re<ke)&&oe(Xe[Re],Re,Xe)!==!1;);return W}}function Wg(R){return function(L,W,oe){for(var ke=-1,Re=Ur(L),Xe=oe(L),tt=Xe.length;tt--;){var ot=Xe[R?tt:++ke];if(W(Re[ot],ot,Re)===!1)break}return L}}function Ug(R){return function(L){var W=B(L=pr(L))?ae(L):J,oe=W?W[0]:L.charAt(0),L=W?on(W,1).join(""):L.slice(1);return oe[R]()+L}}function Zs(R){return function(L){return b(Rp(Tp(L).replace(ef,"")),R,"")}}function Qc(R){return function(){var L=arguments;switch(L.length){case 0:return new R;case 1:return new R(L[0]);case 2:return new R(L[0],L[1]);case 3:return new R(L[0],L[1],L[2]);case 4:return new R(L[0],L[1],L[2],L[3]);case 5:return new R(L[0],L[1],L[2],L[3],L[4]);case 6:return new R(L[0],L[1],L[2],L[3],L[4],L[5]);case 7:return new R(L[0],L[1],L[2],L[3],L[4],L[5],L[6])}var W=ic(R.prototype),oe=R.apply(W,L);return en(oe)?oe:W}}function Lk(R,L,W){var oe=Qc(R);return function ke(){for(var Re=arguments.length,Xe=$n(Re),tt=Re,ot=Ks(ke);tt--;)Xe[tt]=arguments[tt];return ot=Re<3&&Xe[0]!==ot&&Xe[Re-1]!==ot?[]:le(Xe,ot),(Re-=ot.length)<W?Zg(R,L,df,ke.placeholder,J,Xe,ot,J,J,W-Re):t(this&&this!==rn&&this instanceof ke?oe:R,this,Xe)}}function Gg(R){return function(L,W,oe){var ke,Re=Ur(L);return yi(L)||(ke=xl(W,3),L=Nn(L),W=function(Xe){return ke(Re[Xe],Xe,Re)}),oe=R(L,W,oe),-1<oe?Re[ke?L[oe]:oe]:J}}function Yg(R){return ca(function(L){var W=L.length,oe=W,ke=ut.prototype.thru;for(R&&L.reverse();oe--;){var Re=L[oe];if(typeof Re!="function")throw new Zi(pe);ke&&!ot&&vf(Re)=="wrapper"&&(ot=new ut([],!0))}for(oe=ot?oe:W;++oe<W;)var Xe=vf(Re=L[oe]),tt=Xe=="wrapper"?Sd(Re):J,ot=tt&&rd(tt[0])&&tt[1]==424&&!tt[4].length&&tt[9]==1?ot[vf(tt[0])].apply(ot,tt[3]):Re.length==1&&rd(Re)?ot[Xe]():ot.thru(Re);return function(){var kt=arguments,gt=kt[0];if(ot&&kt.length==1&&Ll(gt))return ot.plant(gt).value();for(var Rt=0,Bt=W?L[Rt].apply(this,kt):gt;++Rt<W;)Bt=L[Rt].call(this,Bt);return Bt}})}function df(R,L,W,oe,ke,Re,Xe,tt,ot,kt){var gt=128&L,Rt=1&L,Bt=2&L,Ot=24&L,Wt=512&L,ml=Bt?J:Qc(R);return function Ht(){for(var dl,Cl=$n(cr=arguments.length),yl=cr;yl--;)Cl[yl]=arguments[yl];if(Ot&&(dl=function(Lr,Ln){for(var Ki=Lr.length,vo=0;Ki--;)Lr[Ki]===Ln&&++vo;return vo}(Cl,Pr=Ks(Ht))),oe&&(Cl=Bg(Cl,oe,ke,Ot)),Re&&(Cl=jg(Cl,Re,Xe,Ot)),cr-=dl,Ot&&cr<kt){var pl=le(Cl,Pr);return Zg(R,L,df,Ht.placeholder,W,Cl,pl,tt,ot,kt-cr)}var Pr=Rt?W:this,pl=Bt?Pr[R]:R,cr=Cl.length;return tt?Cl=function(Lr,Ln){for(var Ki=Lr.length,vo=Zn(Ln.length,Ki),jo=pi(Lr);vo--;){var Vo=Ln[vo];Lr[vo]=ua(Vo,Ki)?jo[Vo]:J}return Lr}(Cl,tt):Wt&&1<cr&&Cl.reverse(),gt&&ot<cr&&(Cl.length=ot),this&&this!==rn&&this instanceof Ht&&(pl=ml||Qc(pl)),pl.apply(Pr,Cl)}}function qg(R,L){return function(W,oe){return W=W,ke=R,Re=L(oe),Xe={},Pn(W,function(tt,ot,kt){ke(Xe,Re(tt),ot,kt)}),Xe;var ke,Re,Xe}}function mf(R,L){return function(W,oe){var ke;if(W===J&&oe===J)return L;if(W!==J&&(ke=W),oe!==J){if(ke===J)return oe;oe=typeof W=="string"||typeof oe=="string"?(W=vl(W),vl(oe)):(W=fl(W),fl(oe)),ke=R(W,oe)}return ke}}function Zh(R){return ca(function(L){return L=d(L,z(xl())),El(function(W){var oe=this;return R(L,function(ke){return t(ke,oe,W)})})})}function gf(R,L){var W=(L=L===J?" ":vl(L)).length;return W<2?W?Da(L,R):L:(W=Da(L,Df(R/Z(L))),B(L)?on(ae(W),0,R).join(""):W.slice(0,R))}function Hk(R,L,W,oe){var ke=1&L,Re=Qc(R);return function Xe(){for(var tt=-1,ot=arguments.length,kt=-1,gt=oe.length,Rt=$n(gt+ot),Bt=this&&this!==rn&&this instanceof Xe?Re:R;++kt<gt;)Rt[kt]=oe[kt];for(;ot--;)Rt[kt++]=arguments[++tt];return t(Bt,ke?W:this,Rt)}}function Xg(R){return function(L,W,oe){return oe&&typeof oe!="number"&&vi(L,W,oe)&&(W=oe=J),L=ha(L),W===J?(W=L,L=0):W=ha(W),function(ke,Re,Xe,tt){for(var ot=-1,kt=Sn(Df((Re-ke)/(Xe||1)),0),gt=$n(kt);kt--;)gt[tt?kt:++ot]=ke,ke+=Xe;return gt}(L,W,oe=oe===J?L<W?1:-1:ha(oe),R)}}function pf(R){return function(L,W){return typeof L=="string"&&typeof W=="string"||(L=Xi(L),W=Xi(W)),R(L,W)}}function Zg(R,L,W,oe,ke,Re,Xe,tt,ot,kt){var gt=8&L;return L|=gt?32:64,4&(L&=~(gt?64:32))||(L&=-4),kt=[R,L,ke,gt?Re:J,gt?Xe:J,gt?J:Re,gt?J:Xe,tt,ot,kt],W=W.apply(J,kt),rd(R)&&Up(W,kt),W.placeholder=oe,op(W,R,L)}function Kh(R){var L=ec[R];return function(W,oe){if(W=Xi(W),oe=oe==null?0:Zn(jl(oe),292)){var ke=(pr(W)+"e").split("e");return+((ke=(pr(L(ke[0]+"e"+(+ke[1]+oe)))+"e").split("e"))[0]+"e"+(+ke[1]-oe))}return L(W)}}function Kg(R){return function(L){var W,oe,ke,Re=Kn(L);return Re==wt?U(L):Re==Te?(Re=L,oe=-1,ke=Array(Re.size),Re.forEach(function(Xe){ke[++oe]=[Xe,Xe]}),ke):d(R(W=L),function(Xe){return[Xe,W[Xe]]})}}function sa(R,L,W,oe,ke,Re,Xe,tt){var ot=2&L;if(!ot&&typeof R!="function")throw new Zi(pe);var kt=oe?oe.length:0;kt||(L&=-97,oe=ke=J),Xe=Xe===J?Xe:Sn(jl(Xe),0),tt=tt===J?tt:jl(tt),kt-=ke?ke.length:0,64&L&&(Wt=oe,ml=ke,oe=ke=J);var gt,Rt,Bt,Ot,Wt,ml,Ht,dl,Cl,yl,Pr=ot?J:Sd(R),pl=[R,L,W,oe,ke,Wt,ml,Re,Xe,tt];return Pr&&(Rt=Pr,Ot=(gt=pl)[1],Wt=Rt[1],Re=(ml=Ot|Wt)<131,Xe=Wt==128&&Ot==8||Wt==128&&Ot==256&&gt[7].length<=Rt[8]||Wt==384&&Rt[7].length<=Rt[8]&&Ot==8,(Re||Xe)&&(1&Wt&&(gt[2]=Rt[2],ml|=1&Ot?0:4),(Ot=Rt[3])&&(Bt=gt[3],gt[3]=Bt?Bg(Bt,Ot,Rt[4]):Ot,gt[4]=Bt?le(gt[3],se):Rt[4]),(Ot=Rt[5])&&(Bt=gt[5],gt[5]=Bt?jg(Bt,Ot,Rt[6]):Ot,gt[6]=Bt?le(gt[5],se):Rt[6]),(Ot=Rt[7])&&(gt[7]=Ot),128&Wt&&(gt[8]=gt[8]==null?Rt[8]:Zn(gt[8],Rt[8])),gt[9]==null&&(gt[9]=Rt[9]),gt[0]=Rt[0],gt[1]=ml)),R=pl[0],L=pl[1],W=pl[2],oe=pl[3],ke=pl[4],!(tt=pl[9]=pl[9]===J?ot?0:R.length:Sn(pl[9]-kt,0))&&24&L&&(L&=-25),W=L&&L!=1?L==8||L==16?Lk(R,L,tt):L!=32&&L!=33||ke.length?df.apply(J,pl):Hk(R,L,W,oe):(dl=W,Cl=1&L,yl=Qc(Ht=R),function cr(){return(this&&this!==rn&&this instanceof cr?yl:Ht).apply(Cl?dl:this,arguments)}),op((Pr?Vp:Up)(W,pl),R,L)}function Jh(R,L,W,oe){return R===J||Ho(R,lu[W])&&!Nr.call(oe,W)?L:R}function Jg(R,L,W,oe,ke,Re){return en(R)&&en(L)&&(Re.set(L,R),ss(R,L,J,Jg,Re),Re.delete(L)),R}function Bk(R){return tu(R)?J:R}function Qg(R,L,W,oe,ke,Re){var Xe=1&W,tt=R.length,ot=L.length;if(tt!=ot&&!(Xe&&tt<ot))return!1;if(ot=Re.get(R),ot&&Re.get(L))return ot==L;var kt=-1,gt=!0,Rt=2&W?new Ql:J;for(Re.set(R,L),Re.set(L,R);++kt<tt;){var Bt,Ot=R[kt],Wt=L[kt];if(oe&&(Bt=Xe?oe(Wt,Ot,kt,L,R,Re):oe(Ot,Wt,kt,R,L,Re)),Bt!==J){if(Bt)continue;gt=!1;break}if(Rt){if(!p(L,function(ml,Ht){return!M(Rt,Ht)&&(Ot===ml||ke(Ot,ml,W,oe,Re))&&Rt.push(Ht)})){gt=!1;break}}else if(Ot!==Wt&&!ke(Ot,Wt,W,oe,Re)){gt=!1;break}}return Re.delete(R),Re.delete(L),gt}function ca(R){return Fd(np(R,J,fp),R+"")}function Qh(R){return af(R,Nn,Id)}function ed(R){return af(R,Ei,Wp)}function vf(R){for(var L=R.name+"",W=su[L],oe=Nr.call(su,L)?W.length:0;oe--;){var ke=W[oe],Re=ke.func;if(Re==null||Re==R)return ke.name}return L}function Ks(R){return(Nr.call(ie,"placeholder")?ie:R).placeholder}function xl(){var R=(R=ie.iteratee||ud)===ud?uf:R;return arguments.length?R(arguments[0],arguments[1]):R}function yf(R,L){var W,oe=R.__data__;return((R=typeof(W=L))=="string"||R=="number"||R=="symbol"||R=="boolean"?W!=="__proto__":W===null)?oe[typeof L=="string"?"string":"hash"]:oe.map}function td(R){for(var L=Nn(R),W=L.length;W--;){var oe=L[W],ke=R[oe];L[W]=[oe,ke,lp(ke)]}return L}function fs(R,L){return L=L,L=(R=R)==null?J:R[L],Us(L)?L:J}function ep(R,L,W){for(var oe=-1,ke=(L=yn(L,R)).length,Re=!1;++oe<ke;){var Xe=Lo(L[oe]);if(!(Re=R!=null&&W(R,Xe)))break;R=R[Xe]}return Re||++oe!=ke?Re:!!(ke=R==null?0:R.length)&&Cf(ke)&&ua(Xe,ke)&&(Ll(R)||gs(R))}function tp(R){return typeof R.constructor!="function"||eu(R)?{}:ic(Rf(R))}function jk(R){return Ll(R)||gs(R)||!!(Np&&R&&R[Np])}function ua(R,L){return!!(L=L??te)&&(typeof R=="number"||ul.test(R))&&-1<R&&R%1==0&&R<L}function vi(R,L,W){if(en(W)){var oe=typeof L;return(oe=="number"?yi(W)&&ua(L,W.length):oe=="string"&&L in W)&&Ho(W[L],R)}}function ld(R,L){if(!Ll(R)){var W=typeof R;return W=="number"||W=="symbol"||W=="boolean"||R==null||Pi(R)||qt.test(R)||!Jt.test(R)||L!=null&&R in Ur(L)}}function rd(R){var L=vf(R),W=ie[L];if(typeof W=="function"&&L in bt.prototype)return R===W?1:(W=Sd(W),W&&R===W[0])}function eu(R){var L=R&&R.constructor;return R===(typeof L=="function"&&L.prototype||lu)}function lp(R){return R==R&&!en(R)}function rp(R,L){return function(W){return W!=null&&W[R]===L&&(L!==J||R in Ur(W))}}function np(R,L,W){return L=Sn(L===J?R.length-1:L,0),function(){for(var oe=arguments,ke=-1,Re=Sn(oe.length-L,0),Xe=$n(Re);++ke<Re;)Xe[ke]=oe[L+ke];ke=-1;for(var tt=$n(L+1);++ke<L;)tt[ke]=oe[ke];return tt[L]=W(Xe),t(R,this,tt)}}function ip(R,L){return L.length<2?R:go(R,st(L,0,-1))}function op(R,L,W){var oe,ke,L=L+"";return Fd(R,function(Re,Xe){var tt=Xe.length;if(!tt)return Re;var ot=tt-1;return Xe[ot]=(1<tt?"& ":"")+Xe[ot],Xe=Xe.join(2<tt?", ":" "),Re.replace(On,`{
/* [wrapped with `+Xe+`] */
`)}(L,(oe=(L=(L=L).match(Dr))?L[1].split(Vn):[],ke=W,o(Me,function(Re){var Xe="_."+Re[0];ke&Re[1]&&!f(oe,Xe)&&oe.push(Xe)}),oe.sort())))}function ap(R){var L=0,W=0;return function(){var oe=Kk(),ke=16-(oe-W);if(W=oe,0<ke){if(800<=++L)return arguments[0]}else L=0;return R.apply(J,arguments)}}function kf(R,L){var W=-1,oe=R.length,ke=oe-1;for(L=L===J?oe:L;++W<L;){var Re=cs(W,ke),Xe=R[Re];R[Re]=R[W],R[W]=Xe}return R.length=L,R}function Lo(R){if(typeof R=="string"||Pi(R))return R;var L=R+"";return L=="0"&&1/R==-1/0?"-0":L}function hs(R){if(R!=null){try{return If.call(R)}catch(L){}try{return R+""}catch(L){}}return""}function sp(R){if(R instanceof bt)return R.clone();var L=new ut(R.__wrapped__,R.__chain__);return L.__actions__=pi(R.__actions__),L.__index__=R.__index__,L.__values__=R.__values__,L}function cp(R,L,W){var oe=R==null?0:R.length;return oe?(W=W==null?0:jl(W),W<0&&(W=Sn(oe+W,0)),_(R,xl(L,3),W)):-1}function up(R,L,W){var oe=R==null?0:R.length;if(!oe)return-1;var ke=oe-1;return W!==J&&(ke=jl(W),ke=W<0?Sn(oe+ke,0):Zn(ke,oe-1)),_(R,xl(L,3),ke,!0)}function fp(R){return(R==null?0:R.length)?rr(R,1):[]}function hp(R){return R&&R.length?R[0]:J}function qi(R){var L=R==null?0:R.length;return L?R[L-1]:J}function dp(R,L){return R&&R.length&&L&&L.length?Ma(R,L):R}function nd(R){return R==null?R:Qk.call(R)}function id(R){if(!R||!R.length)return[];var L=0;return R=u(R,function(W){return un(W)&&(L=Sn(W.length,L),1)}),T(L,function(W){return d(R,D(W))})}function mp(R,L){return!R||!R.length?[]:(R=id(R),L==null?R:d(R,function(W){return t(L,J,W)}))}function gp(R){return R=ie(R),R.__chain__=!0,R}function bf(R,L){return L(R)}function pp(R,L){return(Ll(R)?o:Aa)(R,xl(L,3))}function vp(R,L){return(Ll(R)?a:Bp)(R,xl(L,3))}function wf(R,L){return(Ll(R)?d:gi)(R,xl(L,3))}function yp(R,L,W){return L=W?J:L,L=R&&L==null?R.length:L,sa(R,128,J,J,J,J,L)}function kp(R,L){var W;if(typeof L!="function")throw new Zi(pe);return R=jl(R),function(){return 0<--R&&(W=L.apply(this,arguments)),R<=1&&(L=J),W}}function bp(R,L,W){function oe(Cl){var yl=ot,Pr=kt;return ot=kt=J,Wt=Cl,Rt=R.apply(Pr,yl)}function ke(Cl){var yl=Cl-Ot;return Ot===J||L<=yl||yl<0||Ht&&gt<=Cl-Wt}function Re(){var Cl,yl=Of();return ke(yl)?Xe(yl):void(Bt=uu(Re,(yl=L-((Cl=yl)-Ot),Ht?Zn(yl,gt-(Cl-Wt)):yl)))}function Xe(Cl){return Bt=J,dl&&ot?oe(Cl):(ot=kt=J,Rt)}function tt(){var Cl=Of(),yl=ke(Cl);if(ot=arguments,kt=this,Ot=Cl,yl){if(Bt===J)return Wt=yl=Ot,Bt=uu(Re,L),ml?oe(yl):Rt;if(Ht)return Bt=uu(Re,L),oe(Ot)}return Bt===J&&(Bt=uu(Re,L)),Rt}var ot,kt,gt,Rt,Bt,Ot,Wt=0,ml=!1,Ht=!1,dl=!0;if(typeof R!="function")throw new Zi(pe);return L=Xi(L)||0,en(W)&&(ml=!!W.leading,Ht="maxWait"in W,gt=Ht?Sn(Xi(W.maxWait)||0,L):gt,dl="trailing"in W?!!W.trailing:dl),tt.cancel=function(){Bt!==J&&ib(Bt),Wt=0,ot=Ot=kt=Bt=J},tt.flush=function(){return Bt===J?Rt:Xe(Of())},tt}function xf(R,L){if(typeof R!="function"||L!=null&&typeof L!="function")throw new Zi(pe);var W=function(){var oe=arguments,ke=L?L.apply(this,oe):oe[0],Re=W.cache;return Re.has(ke)?Re.get(ke):(oe=R.apply(this,oe),W.cache=Re.set(ke,oe)||Re,oe)};return W.cache=new(xf.Cache||yr),W}function _f(R){if(typeof R!="function")throw new Zi(pe);return function(){var L=arguments;switch(L.length){case 0:return!R.call(this);case 1:return!R.call(this,L[0]);case 2:return!R.call(this,L[0],L[1]);case 3:return!R.call(this,L[0],L[1],L[2])}return!R.apply(this,L)}}function Ho(R,L){return R===L||R!=R&&L!=L}function yi(R){return R!=null&&Cf(R.length)&&!fa(R)}function un(R){return an(R)&&yi(R)}function od(R){if(!an(R))return!1;var L=Wn(R);return L==ft||L=="[object DOMException]"||typeof R.message=="string"&&typeof R.name=="string"&&!tu(R)}function fa(R){return en(R)?(R=Wn(R),R==et||R==vt||R=="[object AsyncFunction]"||R=="[object Proxy]"):!1}function wp(R){return typeof R=="number"&&R==jl(R)}function Cf(R){return typeof R=="number"&&-1<R&&R%1==0&&R<=te}function en(R){var L=typeof R;return R!=null&&(L=="object"||L=="function")}function an(R){return R!=null&&typeof R=="object"}function xp(R){return typeof R=="number"||an(R)&&Wn(R)==be}function tu(R){return!an(R)||Wn(R)!=Q?!1:(R=Rf(R),R===null?!0:(R=Nr.call(R,"constructor")&&R.constructor,typeof R=="function"&&R instanceof R&&If.call(R)==Uk))}function $f(R){return typeof R=="string"||!Ll(R)&&an(R)&&Wn(R)==je}function Pi(R){return typeof R=="symbol"||an(R)&&Wn(R)==De}function _p(R){if(!R)return[];if(yi(R))return($f(R)?ae:pi)(R);if(ru&&R[ru])return function(W){for(var oe,ke=[];!(oe=W.next()).done;)ke.push(oe.value);return ke}(R[ru]());var L=Kn(R);return(L==wt?U:L==Te?he:Js)(R)}function ha(R){return R?(R=Xi(R))!==1/0&&R!==-1/0?R==R?R:0:17976931348623157e292*(R<0?-1:1):R===0?R:0}function jl(R){var L=ha(R),R=L%1;return L==L?R?L-R:L:0}function Cp(R){return R?zr(jl(R),0,fe):0}function Xi(R){if(typeof R=="number")return R;if(Pi(R))return re;if(en(R)&&(R=en(L=typeof R.valueOf=="function"?R.valueOf():R)?L+"":L),typeof R!="string")return R===0?R:+R;R=R.replace(Vr,"");var L=ai.test(R);return L||tl.test(R)?rf(R.slice(2),L?2:8):gn.test(R)?re:+R}function $p(R){return No(R,Ei(R))}function pr(R){return R==null?"":vl(R)}function ad(R,L,W){return L=R==null?J:go(R,L),L===J?W:L}function sd(R,L){return R!=null&&ep(R,L,sf)}function Nn(R){return(yi(R)?Dl:zi)(R)}function Ei(R){return yi(R)?Dl(R,!0):Cr(R)}function Sp(R,L){if(R==null)return{};var W=d(ed(R),function(oe){return[oe]});return L=xl(L),Jc(R,W,function(oe,ke){return L(oe,ke[0])})}function Js(R){return R==null?[]:A(R,Nn(R))}function Ip(R){return Od(pr(R).toLowerCase())}function Tp(R){return(R=pr(R))&&R.replace(Ar,ge).replace(Yc,"")}function Rp(R,L,W){return R=pr(R),(L=W?J:L)===J?(W=R,Uh.test(W)?R.match(tf)||[]:R.match(ii)||[]):R.match(L)||[]}function cd(R){return function(){return R}}function ki(R){return R}function ud(R){return uf(typeof R=="function"?R:_n(R,1))}function fd(R,L,W){var oe=Nn(L),ke=Ws(L,oe);W!=null||en(L)&&(ke.length||!oe.length)||(W=L,L=R,R=this,ke=Ws(L,Nn(L)));var Re=!(en(W)&&"chain"in W&&!W.chain),Xe=fa(R);return o(ke,function(tt){var ot=L[tt];R[tt]=ot,Xe&&(R.prototype[tt]=function(){var kt=this.__chain__;if(Re||kt){var gt=R(this.__wrapped__);return(gt.__actions__=pi(this.__actions__)).push({func:ot,args:arguments,thisArg:R}),gt.__chain__=kt,gt}return ot.apply(R,g([this.value()],arguments))})}),R}function hd(){}function Fp(R){return ld(R)?D(Lo(R)):(L=R,function(W){return go(W,L)});var L}function dd(){return[]}function md(){return!1}var $n=(Pe=Pe==null?rn:at.defaults(rn.Object(),Pe,at.pick(rn,Gh))).Array,Qs=Pe.Date,Mp=Pe.Error,Dp=Pe.Function,ec=Pe.Math,Ur=Pe.Object,gd=Pe.RegExp,Vk=Pe.String,Zi=Pe.TypeError,Sf=$n.prototype,pd=Dp.prototype,lu=Ur.prototype,tc=Pe["__core-js_shared__"],If=pd.toString,Nr=lu.hasOwnProperty,Wk=0,Ap=(Pd=/[^.]+$/.exec(tc&&tc.keys&&tc.keys.IE_PROTO||""))?"Symbol(src)_1."+Pd:"",zp=lu.toString,Uk=If.call(Ur),Gk=rn._,Yk=gd("^"+If.call(Nr).replace(Wl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),lc=Xc?Pe.Buffer:J,Bo=Pe.Symbol,Tf=Pe.Uint8Array,Op=lc?lc.allocUnsafe:J,Rf=X(Ur.getPrototypeOf,Ur),Pp=Ur.create,Ep=lu.propertyIsEnumerable,Ff=Sf.splice,Np=Bo?Bo.isConcatSpreadable:J,ru=Bo?Bo.iterator:J,ds=Bo?Bo.toStringTag:J,Mf=function(){try{var R=fs(Ur,"defineProperty");return R({},"",{}),R}catch(L){}}(),vd=Pe.clearTimeout!==rn.clearTimeout&&Pe.clearTimeout,yd=Qs&&Qs.now!==rn.Date.now&&Qs.now,kd=Pe.setTimeout!==rn.setTimeout&&Pe.setTimeout,Df=ec.ceil,Af=ec.floor,bd=Ur.getOwnPropertySymbols,wd=lc?lc.isBuffer:J,qk=Pe.isFinite,Xk=Sf.join,Zk=X(Ur.keys,Ur),Sn=ec.max,Zn=ec.min,Kk=Qs.now,Jk=Pe.parseInt,Lp=ec.random,Qk=Sf.reverse,nu=fs(Pe,"DataView"),iu=fs(Pe,"Map"),ou=fs(Pe,"Promise"),rc=fs(Pe,"Set"),ms=fs(Pe,"WeakMap"),au=fs(Ur,"create"),zf=ms&&new ms,su={},eb=hs(nu),tb=hs(iu),lb=hs(ou),rb=hs(rc),nb=hs(ms),nc=Bo?Bo.prototype:J,cu=nc?nc.valueOf:J,Hp=nc?nc.toString:J,ic=function(R){return en(R)?Pp?Pp(R):(xd.prototype=R,R=new xd,xd.prototype=J,R):{}};function xd(){}ie.templateSettings={escape:mt,evaluate:Ft,interpolate:_t,variable:"",imports:{_:ie}},(ie.prototype=dt.prototype).constructor=ie,(ut.prototype=ic(dt.prototype)).constructor=ut,(bt.prototype=ic(dt.prototype)).constructor=bt,Lt.prototype.clear=function(){this.__data__=au?au(null):{},this.size=0},Lt.prototype.delete=function(R){return R=this.has(R)&&delete this.__data__[R],this.size-=R?1:0,R},Lt.prototype.get=function(R){var L=this.__data__;if(au){var W=L[R];return W===K?J:W}return Nr.call(L,R)?L[R]:J},Lt.prototype.has=function(R){var L=this.__data__;return au?L[R]!==J:Nr.call(L,R)},Lt.prototype.set=function(R,L){var W=this.__data__;return this.size+=this.has(R)?0:1,W[R]=au&&L===J?K:L,this},Il.prototype.clear=function(){this.__data__=[],this.size=0},Il.prototype.delete=function(R){var L=this.__data__;return!((R=ho(L,R))<0)&&(R==L.length-1?L.pop():Ff.call(L,R,1),--this.size,!0)},Il.prototype.get=function(R){var L=this.__data__;return(R=ho(L,R))<0?J:L[R][1]},Il.prototype.has=function(R){return-1<ho(this.__data__,R)},Il.prototype.set=function(R,L){var W=this.__data__,oe=ho(W,R);return oe<0?(++this.size,W.push([R,L])):W[oe][1]=L,this},yr.prototype.clear=function(){this.size=0,this.__data__={hash:new Lt,map:new(iu||Il),string:new Lt}},yr.prototype.delete=function(R){return R=yf(this,R).delete(R),this.size-=R?1:0,R},yr.prototype.get=function(R){return yf(this,R).get(R)},yr.prototype.has=function(R){return yf(this,R).has(R)},yr.prototype.set=function(R,L){var W=yf(this,R),oe=W.size;return W.set(R,L),this.size+=W.size==oe?0:1,this},Ql.prototype.add=Ql.prototype.push=function(R){return this.__data__.set(R,K),this},Ql.prototype.has=function(R){return this.__data__.has(R)},nn.prototype.clear=function(){this.__data__=new Il,this.size=0},nn.prototype.delete=function(R){var L=this.__data__,R=L.delete(R);return this.size=L.size,R},nn.prototype.get=function(R){return this.__data__.get(R)},nn.prototype.has=function(R){return this.__data__.has(R)},nn.prototype.set=function(R,L){var W=this.__data__;if(W instanceof Il){var oe=W.__data__;if(!iu||oe.length<199)return oe.push([R,L]),this.size=++W.size,this;W=this.__data__=new yr(oe)}return W.set(R,L),this.size=W.size,this};var Aa=Vg(Pn),Bp=Vg(aa,!0),_d=Wg(),jp=Wg(!0),Vp=zf?function(R,L){return zf.set(R,L),R}:ki,Cd=Mf?function(R,L){return Mf(R,"toString",{configurable:!0,enumerable:!1,value:cd(L),writable:!0})}:ki,$d=El,ib=vd||function(R){return rn.clearTimeout(R)},ob=rc&&1/he(new rc([,-0]))[1]==1/0?function(R){return new rc(R)}:hd,Sd=zf?function(R){return zf.get(R)}:hd,Id=bd?function(R){return R==null?[]:(R=Ur(R),u(bd(R),function(L){return Ep.call(R,L)}))}:dd,Wp=bd?function(R){for(var L=[];R;)g(L,Id(R)),R=Rf(R);return L}:dd,Kn=Wn;(nu&&Kn(new nu(new ArrayBuffer(1)))!=Ve||iu&&Kn(new iu)!=wt||ou&&Kn(ou.resolve())!=me||rc&&Kn(new rc)!=Te||ms&&Kn(new ms)!=Fe)&&(Kn=function(R){var L=Wn(R),R=L==Q?R.constructor:J,R=R?hs(R):"";if(R)switch(R){case eb:return Ve;case tb:return wt;case lb:return me;case rb:return Te;case nb:return Fe}return L});var Td,Rd,ab=tc?fa:md,Up=ap(Vp),uu=kd||function(R,L){return rn.setTimeout(R,L)},Fd=ap(Cd),Gp=(Rd=(Td=xf(Td=function(R){var L=[];return wl.test(R)&&L.push(""),R.replace(Tl,function(W,oe,ke,Re){L.push(ke?Re.replace(na,"$1"):oe||W)}),L},function(R){return Rd.size===500&&Rd.clear(),R})).cache,Td),sb=El(function(R,L){return un(R)?sr(R,rr(L,1,un,!0)):[]}),cb=El(function(R,L){var W=qi(L);return un(W)&&(W=J),un(R)?sr(R,rr(L,1,un,!0),xl(W,2)):[]}),ub=El(function(R,L){var W=qi(L);return un(W)&&(W=J),un(R)?sr(R,rr(L,1,un,!0),J,W):[]}),fb=El(function(R){var L=d(R,Qr);return L.length&&L[0]===R[0]?Fa(L):[]}),hb=El(function(R){var L=qi(R),W=d(R,Qr);return L===qi(W)?L=J:W.pop(),W.length&&W[0]===R[0]?Fa(W,xl(L,2)):[]}),db=El(function(R){var L=qi(R),W=d(R,Qr);return(L=typeof L=="function"?L:J)&&W.pop(),W.length&&W[0]===R[0]?Fa(W,J,L):[]}),mb=El(dp),gb=ca(function(R,L){var W=R==null?0:R.length,oe=vn(R,L);return qs(R,d(L,function(ke){return ua(ke,W)?+ke:ke}).sort(Hg)),oe}),pb=El(function(R){return ol(rr(R,1,un,!0))}),vb=El(function(R){var L=qi(R);return un(L)&&(L=J),ol(rr(R,1,un,!0),xl(L,2))}),yb=El(function(R){var L=typeof(L=qi(R))=="function"?L:J;return ol(rr(R,1,un,!0),J,L)}),kb=El(function(R,L){return un(R)?sr(R,L):[]}),bb=El(function(R){return Jr(u(R,un))}),wb=El(function(R){var L=qi(R);return un(L)&&(L=J),Jr(u(R,un),xl(L,2))}),xb=El(function(R){var L=typeof(L=qi(R))=="function"?L:J;return Jr(u(R,un),J,L)}),_b=El(id),Cb=El(function(R){var L=R.length,L=typeof(L=1<L?R[L-1]:J)=="function"?(R.pop(),L):J;return mp(R,L)}),$b=ca(function(R){function L(Re){return vn(Re,R)}var W=R.length,oe=W?R[0]:0,ke=this.__wrapped__;return!(1<W||this.__actions__.length)&&ke instanceof bt&&ua(oe)?((ke=ke.slice(oe,+oe+(W?1:0))).__actions__.push({func:bf,args:[L],thisArg:J}),new ut(ke,this.__chain__).thru(function(Re){return W&&!Re.length&&Re.push(J),Re})):this.thru(L)}),Sb=hf(function(R,L,W){Nr.call(R,W)?++R[W]:Wr(R,W,1)}),Ib=Gg(cp),Tb=Gg(up),Rb=hf(function(R,L,W){Nr.call(R,W)?R[W].push(L):Wr(R,W,[L])}),Fb=El(function(R,L,W){var oe=-1,ke=typeof L=="function",Re=yi(R)?$n(R.length):[];return Aa(R,function(Xe){Re[++oe]=ke?t(L,Xe,W):os(Xe,L,W)}),Re}),Mb=hf(function(R,L,W){Wr(R,W,L)}),Db=hf(function(R,L,W){R[W?0:1].push(L)},function(){return[[],[]]}),Ab=El(function(R,L){if(R==null)return[];var W=L.length;return 1<W&&vi(R,L[0],L[1])?L=[]:2<W&&vi(L[0],L[1],L[2])&&(L=[L[0]]),Ys(R,rr(L,1),[])}),Of=yd||function(){return rn.Date.now()},Md=El(function(R,L,W){var oe,ke=1;return W.length&&(oe=le(W,Ks(Md)),ke|=32),sa(R,ke,L,W,oe)}),Yp=El(function(R,L,W){var oe,ke=3;return W.length&&(oe=le(W,Ks(Yp)),ke|=32),sa(L,ke,R,W,oe)}),zb=El(function(R,L){return Er(R,1,L)}),Ob=El(function(R,L,W){return Er(R,Xi(L)||0,W)});xf.Cache=yr;var Dd,Pb=$d(function(R,L){var W=(L=L.length==1&&Ll(L[0])?d(L[0],z(xl())):d(rr(L,1),z(xl()))).length;return El(function(oe){for(var ke=-1,Re=Zn(oe.length,W);++ke<Re;)oe[ke]=L[ke].call(this,oe[ke]);return t(R,this,oe)})}),Ad=El(function(R,L){var W=le(L,Ks(Ad));return sa(R,32,J,L,W)}),qp=El(function(R,L){var W=le(L,Ks(qp));return sa(R,64,J,L,W)}),Eb=ca(function(R,L){return sa(R,256,J,J,J,L)}),Nb=pf(Zc),Lb=pf(function(R,L){return L<=R}),gs=cf(function(){return arguments}())?cf:function(R){return an(R)&&Nr.call(R,"callee")&&!Ep.call(R,"callee")},Ll=$n.isArray,Hb=nf?z(nf):function(R){return an(R)&&Wn(R)==Ze},za=wd||md,Bb=of?z(of):function(R){return an(R)&&Wn(R)==Ke},jb=H?z(H):function(R){return an(R)&&Kn(R)==wt},zd=G?z(G):function(R){return an(R)&&Wn(R)==xe},Vb=ee?z(ee):function(R){return an(R)&&Kn(R)==Te},oc=ne?z(ne):function(R){return an(R)&&Cf(R.length)&&!!Fr[Wn(R)]},Wb=pf(as),Ub=pf(function(R,L){return R<=L}),Gb=Xs(function(R,L){if(eu(L)||yi(L))No(L,Nn(L),R);else for(var W in L)Nr.call(L,W)&&Xn(R,W,L[W])}),Xp=Xs(function(R,L){No(L,Ei(L),R)}),fu=Xs(function(R,L,W,oe){No(L,Ei(L),R,oe)}),Yb=Xs(function(R,L,W,oe){No(L,Nn(L),R,oe)}),qb=ca(vn),Xb=El(function(R){return R.push(J,Jh),t(fu,J,R)}),Zb=El(function(R){return R.push(J,Jg),t(Zp,J,R)}),Kb=qg(function(R,L,W){R[L]=W},cd(ki)),Jb=qg(function(R,L,W){Nr.call(R,L)?R[L].push(W):R[L]=[W]},xl),Qb=El(os),ew=Xs(function(R,L,W){ss(R,L,W)}),Zp=Xs(function(R,L,W,oe){ss(R,L,W,oe)}),tw=ca(function(R,L){var W={};if(R==null)return W;var oe=!1;L=d(L,function(Re){return Re=yn(Re,R),oe=oe||1<Re.length,Re}),No(R,ed(R),W),oe&&(W=_n(W,7,Bk));for(var ke=L.length;ke--;)Bl(W,L[ke]);return W}),lw=ca(function(R,L){return R==null?{}:Jc(W=R,L,function(oe,ke){return sd(W,ke)});var W}),Kp=Kg(Nn),Jp=Kg(Ei),rw=Zs(function(R,L,W){return L=L.toLowerCase(),R+(W?Ip(L):L)}),nw=Zs(function(R,L,W){return R+(W?"-":"")+L.toLowerCase()}),iw=Zs(function(R,L,W){return R+(W?" ":"")+L.toLowerCase()}),ow=Ug("toLowerCase"),aw=Zs(function(R,L,W){return R+(W?"_":"")+L.toLowerCase()}),sw=Zs(function(R,L,W){return R+(W?" ":"")+Od(L)}),cw=Zs(function(R,L,W){return R+(W?" ":"")+L.toUpperCase()}),Od=Ug("toUpperCase"),Qp=El(function(R,L){try{return t(R,J,L)}catch(W){return od(W)?W:new Mp(W)}}),pd=ca(function(R,L){return o(L,function(W){W=Lo(W),Wr(R,W,Md(R[W],R))}),R}),Pd=Yg(),lc=Yg(!0),Qs=El(function(R,L){return function(W){return os(W,R,L)}}),Pe=El(function(R,L){return function(W){return os(R,W,L)}}),Bo=Zh(d),nc=Zh(s),vd=Zh(p),nu=Xg(),ou=Xg(!0),ms=mf(function(R,L){return R+L},0),tc=Kh("ceil"),kd=mf(function(R,L){return R/L},1),Cd=Kh("floor"),yd=mf(function(R,L){return R*L},1),$d=Kh("round"),wd=mf(function(R,L){return R-L},0);return ie.after=function(R,L){if(typeof L!="function")throw new Zi(pe);return R=jl(R),function(){if(--R<1)return L.apply(this,arguments)}},ie.ary=yp,ie.assign=Gb,ie.assignIn=Xp,ie.assignInWith=fu,ie.assignWith=Yb,ie.at=qb,ie.before=kp,ie.bind=Md,ie.bindAll=pd,ie.bindKey=Yp,ie.castArray=function(){if(!arguments.length)return[];var R=arguments[0];return Ll(R)?R:[R]},ie.chain=gp,ie.chunk=function(R,L,W){L=(W?vi(R,L,W):L===J)?1:Sn(jl(L),0);var oe=R==null?0:R.length;if(!oe||L<1)return[];for(var ke=0,Re=0,Xe=$n(Df(oe/L));ke<oe;)Xe[Re++]=st(R,ke,ke+=L);return Xe},ie.compact=function(R){for(var L=-1,W=R==null?0:R.length,oe=0,ke=[];++L<W;){var Re=R[L];Re&&(ke[oe++]=Re)}return ke},ie.concat=function(){var R=arguments.length;if(!R)return[];for(var L=$n(R-1),W=arguments[0],oe=R;oe--;)L[oe-1]=arguments[oe];return g(Ll(W)?pi(W):[W],rr(L,1))},ie.cond=function(R){var L=R==null?0:R.length,W=xl();return R=L?d(R,function(oe){if(typeof oe[1]!="function")throw new Zi(pe);return[W(oe[0]),oe[1]]}):[],El(function(oe){for(var ke=-1;++ke<L;){var Re=R[ke];if(t(Re[0],this,oe))return t(Re[1],this,oe)}})},ie.conforms=function(R){return L=_n(R,1),W=Nn(L),function(oe){return mo(oe,L,W)};var L,W},ie.constant=cd,ie.countBy=Sb,ie.create=function(R,L){return R=ic(R),L==null?R:mi(R,L)},ie.curry=function R(L,W,oe){return W=sa(L,8,J,J,J,J,J,W=oe?J:W),W.placeholder=R.placeholder,W},ie.curryRight=function R(L,W,oe){return W=sa(L,16,J,J,J,J,J,W=oe?J:W),W.placeholder=R.placeholder,W},ie.debounce=bp,ie.defaults=Xb,ie.defaultsDeep=Zb,ie.defer=zb,ie.delay=Ob,ie.difference=sb,ie.differenceBy=cb,ie.differenceWith=ub,ie.drop=function(R,L,W){var oe=R==null?0:R.length;return oe?st(R,(L=W||L===J?1:jl(L))<0?0:L,oe):[]},ie.dropRight=function(R,L,W){var oe=R==null?0:R.length;return oe?st(R,0,(L=oe-(L=W||L===J?1:jl(L)))<0?0:L):[]},ie.dropRightWhile=function(R,L){return R&&R.length?gr(R,xl(L,3),!0,!0):[]},ie.dropWhile=function(R,L){return R&&R.length?gr(R,xl(L,3),!0):[]},ie.fill=function(R,L,W,oe){var ke=R==null?0:R.length;return ke?(W&&typeof W!="number"&&vi(R,L,W)&&(W=0,oe=ke),function(Re,Xe,tt,ot){var kt=Re.length;for((tt=jl(tt))<0&&(tt=kt<-tt?0:kt+tt),(ot=ot===J||kt<ot?kt:jl(ot))<0&&(ot+=kt),ot=ot<tt?0:Cp(ot);tt<ot;)Re[tt++]=Xe;return Re}(R,L,W,oe)):[]},ie.filter=function(R,L){return(Ll(R)?u:_l)(R,xl(L,3))},ie.flatMap=function(R,L){return rr(wf(R,L),1)},ie.flatMapDeep=function(R,L){return rr(wf(R,L),1/0)},ie.flatMapDepth=function(R,L,W){return W=W===J?1:jl(W),rr(wf(R,L),W)},ie.flatten=fp,ie.flattenDeep=function(R){return(R==null?0:R.length)?rr(R,1/0):[]},ie.flattenDepth=function(R,L){return(R==null?0:R.length)?rr(R,L=L===J?1:jl(L)):[]},ie.flip=function(R){return sa(R,512)},ie.flow=Pd,ie.flowRight=lc,ie.fromPairs=function(R){for(var L=-1,W=R==null?0:R.length,oe={};++L<W;){var ke=R[L];oe[ke[0]]=ke[1]}return oe},ie.functions=function(R){return R==null?[]:Ws(R,Nn(R))},ie.functionsIn=function(R){return R==null?[]:Ws(R,Ei(R))},ie.groupBy=Rb,ie.initial=function(R){return(R==null?0:R.length)?st(R,0,-1):[]},ie.intersection=fb,ie.intersectionBy=hb,ie.intersectionWith=db,ie.invert=Kb,ie.invertBy=Jb,ie.invokeMap=Fb,ie.iteratee=ud,ie.keyBy=Mb,ie.keys=Nn,ie.keysIn=Ei,ie.map=wf,ie.mapKeys=function(R,L){var W={};return L=xl(L,3),Pn(R,function(oe,ke,Re){Wr(W,L(oe,ke,Re),oe)}),W},ie.mapValues=function(R,L){var W={};return L=xl(L,3),Pn(R,function(oe,ke,Re){Wr(W,ke,L(oe,ke,Re))}),W},ie.matches=function(R){return Oi(_n(R,1))},ie.matchesProperty=function(R,L){return Gs(R,_n(L,1))},ie.memoize=xf,ie.merge=ew,ie.mergeWith=Zp,ie.method=Qs,ie.methodOf=Pe,ie.mixin=fd,ie.negate=_f,ie.nthArg=function(R){return R=jl(R),El(function(L){return Eo(L,R)})},ie.omit=tw,ie.omitBy=function(R,L){return Sp(R,_f(xl(L)))},ie.once=function(R){return kp(2,R)},ie.orderBy=function(R,L,W,oe){return R==null?[]:(Ll(L)||(L=L==null?[]:[L]),Ll(W=oe?J:W)||(W=W==null?[]:[W]),Ys(R,L,W))},ie.over=Bo,ie.overArgs=Pb,ie.overEvery=nc,ie.overSome=vd,ie.partial=Ad,ie.partialRight=qp,ie.partition=Db,ie.pick=lw,ie.pickBy=Sp,ie.property=Fp,ie.propertyOf=function(R){return function(L){return R==null?J:go(R,L)}},ie.pull=mb,ie.pullAll=dp,ie.pullAllBy=function(R,L,W){return R&&R.length&&L&&L.length?Ma(R,L,xl(W,2)):R},ie.pullAllWith=function(R,L,W){return R&&R.length&&L&&L.length?Ma(R,L,J,W):R},ie.pullAt=gb,ie.range=nu,ie.rangeRight=ou,ie.rearg=Eb,ie.reject=function(R,L){return(Ll(R)?u:_l)(R,_f(xl(L,3)))},ie.remove=function(R,L){var W=[];if(!R||!R.length)return W;var oe=-1,ke=[],Re=R.length;for(L=xl(L,3);++oe<Re;){var Xe=R[oe];L(Xe,oe,R)&&(W.push(Xe),ke.push(oe))}return qs(R,ke),W},ie.rest=function(R,L){if(typeof R!="function")throw new Zi(pe);return El(R,L=L===J?L:jl(L))},ie.reverse=nd,ie.sampleSize=function(R,L,W){return L=(W?vi(R,L,W):L===J)?1:jl(L),(Ll(R)?sl:Se)(R,L)},ie.set=function(R,L,W){return R==null?R:Ee(R,L,W)},ie.setWith=function(R,L,W,oe){return oe=typeof oe=="function"?oe:J,R==null?R:Ee(R,L,W,oe)},ie.shuffle=function(R){return(Ll(R)?kr:qe)(R)},ie.slice=function(R,L,W){var oe=R==null?0:R.length;return oe?(W=W&&typeof W!="number"&&vi(R,L,W)?(L=0,oe):(L=L==null?0:jl(L),W===J?oe:jl(W)),st(R,L,W)):[]},ie.sortBy=Ab,ie.sortedUniq=function(R){return R&&R.length?Xt(R):[]},ie.sortedUniqBy=function(R,L){return R&&R.length?Xt(R,xl(L,2)):[]},ie.split=function(R,L,W){return W&&typeof W!="number"&&vi(R,L,W)&&(L=W=J),(W=W===J?fe:W>>>0)?(R=pr(R))&&(typeof L=="string"||L!=null&&!zd(L))&&!(L=vl(L))&&B(R)?on(ae(R),0,W):R.split(L,W):[]},ie.spread=function(R,L){if(typeof R!="function")throw new Zi(pe);return L=L==null?0:Sn(jl(L),0),El(function(W){var oe=W[L],W=on(W,0,L);return oe&&g(W,oe),t(R,this,W)})},ie.tail=function(R){var L=R==null?0:R.length;return L?st(R,1,L):[]},ie.take=function(R,L,W){return R&&R.length?st(R,0,(L=W||L===J?1:jl(L))<0?0:L):[]},ie.takeRight=function(R,L,W){var oe=R==null?0:R.length;return oe?st(R,(L=oe-(L=W||L===J?1:jl(L)))<0?0:L,oe):[]},ie.takeRightWhile=function(R,L){return R&&R.length?gr(R,xl(L,3),!1,!0):[]},ie.takeWhile=function(R,L){return R&&R.length?gr(R,xl(L,3)):[]},ie.tap=function(R,L){return L(R),R},ie.throttle=function(R,L,W){var oe=!0,ke=!0;if(typeof R!="function")throw new Zi(pe);return en(W)&&(oe="leading"in W?!!W.leading:oe,ke="trailing"in W?!!W.trailing:ke),bp(R,L,{leading:oe,maxWait:L,trailing:ke})},ie.thru=bf,ie.toArray=_p,ie.toPairs=Kp,ie.toPairsIn=Jp,ie.toPath=function(R){return Ll(R)?d(R,Lo):Pi(R)?[R]:pi(Gp(pr(R)))},ie.toPlainObject=$p,ie.transform=function(R,L,W){var oe,ke=Ll(R),Re=ke||za(R)||oc(R);return L=xl(L,4),W==null&&(oe=R&&R.constructor,W=Re?ke?new oe:[]:en(R)&&fa(oe)?ic(Rf(R)):{}),(Re?o:Pn)(R,function(Xe,tt,ot){return L(W,Xe,tt,ot)}),W},ie.unary=function(R){return yp(R,1)},ie.union=pb,ie.unionBy=vb,ie.unionWith=yb,ie.uniq=function(R){return R&&R.length?ol(R):[]},ie.uniqBy=function(R,L){return R&&R.length?ol(R,xl(L,2)):[]},ie.uniqWith=function(R,L){return L=typeof L=="function"?L:J,R&&R.length?ol(R,J,L):[]},ie.unset=function(R,L){return R==null||Bl(R,L)},ie.unzip=id,ie.unzipWith=mp,ie.update=function(R,L,W){return R==null?R:dr(R,L,nr(W))},ie.updateWith=function(R,L,W,oe){return oe=typeof oe=="function"?oe:J,R==null?R:dr(R,L,nr(W),oe)},ie.values=Js,ie.valuesIn=function(R){return R==null?[]:A(R,Ei(R))},ie.without=kb,ie.words=Rp,ie.wrap=function(R,L){return Ad(nr(L),R)},ie.xor=bb,ie.xorBy=wb,ie.xorWith=xb,ie.zip=_b,ie.zipObject=function(R,L){return cn(R||[],L||[],Xn)},ie.zipObjectDeep=function(R,L){return cn(R||[],L||[],Ee)},ie.zipWith=Cb,ie.entries=Kp,ie.entriesIn=Jp,ie.extend=Xp,ie.extendWith=fu,fd(ie,ie),ie.add=ms,ie.attempt=Qp,ie.camelCase=rw,ie.capitalize=Ip,ie.ceil=tc,ie.clamp=function(R,L,W){return W===J&&(W=L,L=J),W!==J&&(W=(W=Xi(W))==W?W:0),L!==J&&(L=(L=Xi(L))==L?L:0),zr(Xi(R),L,W)},ie.clone=function(R){return _n(R,4)},ie.cloneDeep=function(R){return _n(R,5)},ie.cloneDeepWith=function(R,L){return _n(R,5,L=typeof L=="function"?L:J)},ie.cloneWith=function(R,L){return _n(R,4,L=typeof L=="function"?L:J)},ie.conformsTo=function(R,L){return L==null||mo(R,L,Nn(L))},ie.deburr=Tp,ie.defaultTo=function(R,L){return R==null||R!=R?L:R},ie.divide=kd,ie.endsWith=function(R,L,W){R=pr(R),L=vl(L);var oe=R.length,oe=W=W===J?oe:zr(jl(W),0,oe);return 0<=(W-=L.length)&&R.slice(W,oe)==L},ie.eq=Ho,ie.escape=function(R){return(R=pr(R))&&nt.test(R)?R.replace(_e,Ae):R},ie.escapeRegExp=function(R){return(R=pr(R))&&sn.test(R)?R.replace(Wl,"\\$&"):R},ie.every=function(R,L,W){var oe=Ll(R)?s:Or;return W&&vi(R,L,W)&&(L=J),oe(R,xl(L,3))},ie.find=Ib,ie.findIndex=cp,ie.findKey=function(R,L){return x(R,xl(L,3),Pn)},ie.findLast=Tb,ie.findLastIndex=up,ie.findLastKey=function(R,L){return x(R,xl(L,3),aa)},ie.floor=Cd,ie.forEach=pp,ie.forEachRight=vp,ie.forIn=function(R,L){return R==null?R:_d(R,xl(L,3),Ei)},ie.forInRight=function(R,L){return R==null?R:jp(R,xl(L,3),Ei)},ie.forOwn=function(R,L){return R&&Pn(R,xl(L,3))},ie.forOwnRight=function(R,L){return R&&aa(R,xl(L,3))},ie.get=ad,ie.gt=Nb,ie.gte=Lb,ie.has=function(R,L){return R!=null&&ep(R,L,qh)},ie.hasIn=sd,ie.head=hp,ie.identity=ki,ie.includes=function(R,L,W,oe){return R=yi(R)?R:Js(R),W=W&&!oe?jl(W):0,oe=R.length,W<0&&(W=Sn(oe+W,0)),$f(R)?W<=oe&&-1<R.indexOf(L,W):!!oe&&-1<S(R,L,W)},ie.indexOf=function(R,L,W){var oe=R==null?0:R.length;return oe?((W=W==null?0:jl(W))<0&&(W=Sn(oe+W,0)),S(R,L,W)):-1},ie.inRange=function(R,L,W){return L=ha(L),W===J?(W=L,L=0):W=ha(W),(R=R=Xi(R))>=Zn(L=L,W=W)&&R<Sn(L,W)},ie.invoke=Qb,ie.isArguments=gs,ie.isArray=Ll,ie.isArrayBuffer=Hb,ie.isArrayLike=yi,ie.isArrayLikeObject=un,ie.isBoolean=function(R){return R===!0||R===!1||an(R)&&Wn(R)==Ce},ie.isBuffer=za,ie.isDate=Bb,ie.isElement=function(R){return an(R)&&R.nodeType===1&&!tu(R)},ie.isEmpty=function(R){if(R==null)return!0;if(yi(R)&&(Ll(R)||typeof R=="string"||typeof R.splice=="function"||za(R)||oc(R)||gs(R)))return!R.length;var L,W=Kn(R);if(W==wt||W==Te)return!R.size;if(eu(R))return!zi(R).length;for(L in R)if(Nr.call(R,L))return!1;return!0},ie.isEqual=function(R,L){return po(R,L)},ie.isEqualWith=function(R,L,W){var oe=(W=typeof W=="function"?W:J)?W(R,L):J;return oe===J?po(R,L,J,W):!!oe},ie.isError=od,ie.isFinite=function(R){return typeof R=="number"&&qk(R)},ie.isFunction=fa,ie.isInteger=wp,ie.isLength=Cf,ie.isMap=jb,ie.isMatch=function(R,L){return R===L||Kc(R,L,td(L))},ie.isMatchWith=function(R,L,W){return W=typeof W=="function"?W:J,Kc(R,L,td(L),W)},ie.isNaN=function(R){return xp(R)&&R!=+R},ie.isNative=function(R){if(ab(R))throw new Mp("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Us(R)},ie.isNil=function(R){return R==null},ie.isNull=function(R){return R===null},ie.isNumber=xp,ie.isObject=en,ie.isObjectLike=an,ie.isPlainObject=tu,ie.isRegExp=zd,ie.isSafeInteger=function(R){return wp(R)&&-te<=R&&R<=te},ie.isSet=Vb,ie.isString=$f,ie.isSymbol=Pi,ie.isTypedArray=oc,ie.isUndefined=function(R){return R===J},ie.isWeakMap=function(R){return an(R)&&Kn(R)==Fe},ie.isWeakSet=function(R){return an(R)&&Wn(R)=="[object WeakSet]"},ie.join=function(R,L){return R==null?"":Xk.call(R,L)},ie.kebabCase=nw,ie.last=qi,ie.lastIndexOf=function(R,L,W){var oe=R==null?0:R.length;if(!oe)return-1;var ke=oe;return W!==J&&(ke=(ke=jl(W))<0?Sn(oe+ke,0):Zn(ke,oe-1)),L==L?function(Re,Xe,tt){for(var ot=tt+1;ot--;)if(Re[ot]===Xe)return ot;return ot}(R,L,ke):_(R,O,ke,!0)},ie.lowerCase=iw,ie.lowerFirst=ow,ie.lt=Wb,ie.lte=Ub,ie.max=function(R){return R&&R.length?Cn(R,ki,Zc):J},ie.maxBy=function(R,L){return R&&R.length?Cn(R,xl(L,2),Zc):J},ie.mean=function(R){return F(R,ki)},ie.meanBy=function(R,L){return F(R,xl(L,2))},ie.min=function(R){return R&&R.length?Cn(R,ki,as):J},ie.minBy=function(R,L){return R&&R.length?Cn(R,xl(L,2),as):J},ie.stubArray=dd,ie.stubFalse=md,ie.stubObject=function(){return{}},ie.stubString=function(){return""},ie.stubTrue=function(){return!0},ie.multiply=yd,ie.nth=function(R,L){return R&&R.length?Eo(R,jl(L)):J},ie.noConflict=function(){return rn._===this&&(rn._=Gk),this},ie.noop=hd,ie.now=Of,ie.pad=function(R,L,W){R=pr(R);var oe=(L=jl(L))?Z(R):0;return!L||L<=oe?R:gf(Af(oe=(L-oe)/2),W)+R+gf(Df(oe),W)},ie.padEnd=function(R,L,W){R=pr(R);var oe=(L=jl(L))?Z(R):0;return L&&oe<L?R+gf(L-oe,W):R},ie.padStart=function(R,L,W){R=pr(R);var oe=(L=jl(L))?Z(R):0;return L&&oe<L?gf(L-oe,W)+R:R},ie.parseInt=function(R,L,W){return L=W||L==null?0:L&&+L,Jk(pr(R).replace(An,""),L||0)},ie.random=function(R,L,W){var oe;return W&&typeof W!="boolean"&&vi(R,L,W)&&(L=W=J),W===J&&(typeof L=="boolean"?(W=L,L=J):typeof R=="boolean"&&(W=R,R=J)),R===J&&L===J?(R=0,L=1):(R=ha(R),L===J?(L=R,R=0):L=ha(L)),L<R&&(oe=R,R=L,L=oe),W||R%1||L%1?(W=Lp(),Zn(R+W*(L-R+is("1e-"+((W+"").length-1))),L)):cs(R,L)},ie.reduce=function(R,L,W){var oe=Ll(R)?b:w,ke=arguments.length<3;return oe(R,xl(L,4),W,ke,Aa)},ie.reduceRight=function(R,L,W){var oe=Ll(R)?y:w,ke=arguments.length<3;return oe(R,xl(L,4),W,ke,Bp)},ie.repeat=function(R,L,W){return L=(W?vi(R,L,W):L===J)?1:jl(L),Da(pr(R),L)},ie.replace=function(){var R=arguments,L=pr(R[0]);return R.length<3?L:L.replace(R[1],R[2])},ie.result=function(R,L,W){var oe=-1,ke=(L=yn(L,R)).length;for(ke||(ke=1,R=J);++oe<ke;){var Re=R==null?J:R[Lo(L[oe])];Re===J&&(oe=ke,Re=W),R=fa(Re)?Re.call(R):Re}return R},ie.round=$d,ie.runInContext=ze,ie.sample=function(R){return(Ll(R)?Ai:Xh)(R)},ie.size=function(R){if(R==null)return 0;if(yi(R))return $f(R)?Z(R):R.length;var L=Kn(R);return L==wt||L==Te?R.size:zi(R).length},ie.snakeCase=aw,ie.some=function(R,L,W){var oe=Ll(R)?p:Dt;return W&&vi(R,L,W)&&(L=J),oe(R,xl(L,3))},ie.sortedIndex=function(R,L){return il(R,L)},ie.sortedIndexBy=function(R,L,W){return At(R,L,xl(W,2))},ie.sortedIndexOf=function(R,L){var W=R==null?0:R.length;if(W){var oe=il(R,L);if(oe<W&&Ho(R[oe],L))return oe}return-1},ie.sortedLastIndex=function(R,L){return il(R,L,!0)},ie.sortedLastIndexBy=function(R,L,W){return At(R,L,xl(W,2),!0)},ie.sortedLastIndexOf=function(R,L){if(R==null?0:R.length){var W=il(R,L,!0)-1;if(Ho(R[W],L))return W}return-1},ie.startCase=sw,ie.startsWith=function(R,L,W){return R=pr(R),W=W==null?0:zr(jl(W),0,R.length),L=vl(L),R.slice(W,W+L.length)==L},ie.subtract=wd,ie.sum=function(R){return R&&R.length?C(R,ki):0},ie.sumBy=function(R,L){return R&&R.length?C(R,xl(L,2)):0},ie.template=function(R,L,W){var oe=ie.templateSettings;W&&vi(R,L,W)&&(L=J),R=pr(R),L=fu({},L,oe,Jh);var ke,Re,Xe=Nn(oe=fu({},L.imports,oe.imports,Jh)),tt=A(oe,Xe),ot=0,oe=L.interpolate||or,kt="__p += '",oe=gd((L.escape||or).source+"|"+oe.source+"|"+(oe===_t?di:or).source+"|"+(L.evaluate||or).source+"|$","g"),gt="//# sourceURL="+("sourceURL"in L?L.sourceURL:"lodash.templateSources["+ ++lf+"]")+`
`;if(R.replace(oe,function(Rt,Bt,Ot,Wt,ml,Ht){return Ot=Ot||Wt,kt+=R.slice(ot,Ht).replace(pn,E),Bt&&(ke=!0,kt+=`' +
__e(`+Bt+`) +
'`),ml&&(Re=!0,kt+=`';
`+ml+`;
__p += '`),Ot&&(kt+=`' +
((__t = (`+Ot+`)) == null ? '' : __t) +
'`),ot=Ht+Rt.length,Rt}),kt+=`';
`,(L=L.variable)||(kt=`with (obj) {
`+kt+`
}
`),kt=(Re?kt.replace(hl,""):kt).replace(Rr,"$1").replace(Di,"$1;"),kt="function("+(L||"obj")+`) {
`+(L?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ke?", __e = _.escape":"")+(Re?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+kt+`return __p
}`,(L=Qp(function(){return Dp(Xe,gt+"return "+kt).apply(J,tt)})).source=kt,od(L))throw L;return L},ie.times=function(R,L){if((R=jl(R))<1||te<R)return[];var W=fe,oe=Zn(R,fe);for(L=xl(L),R-=fe,oe=T(oe,L);++W<R;)L(W);return oe},ie.toFinite=ha,ie.toInteger=jl,ie.toLength=Cp,ie.toLower=function(R){return pr(R).toLowerCase()},ie.toNumber=Xi,ie.toSafeInteger=function(R){return R?zr(jl(R),-te,te):R===0?R:0},ie.toString=pr,ie.toUpper=function(R){return pr(R).toUpperCase()},ie.trim=function(R,L,W){return(R=pr(R))&&(W||L===J)?R.replace(Vr,""):R&&(L=vl(L))?(R=ae(R),L=ae(L),on(R,P(R,L),N(R,L)+1).join("")):R},ie.trimEnd=function(R,L,W){return(R=pr(R))&&(W||L===J)?R.replace(zn,""):R&&(L=vl(L))?on(R=ae(R),0,N(R,ae(L))+1).join(""):R},ie.trimStart=function(R,L,W){return(R=pr(R))&&(W||L===J)?R.replace(An,""):R&&(L=vl(L))?on(R=ae(R),P(R,ae(L))).join(""):R},ie.truncate=function(R,L){var W,oe=30,ke="...";en(L)&&(W="separator"in L?L.separator:W,oe="length"in L?jl(L.length):oe,ke="omission"in L?vl(L.omission):ke);var Re,L=(R=pr(R)).length;if(B(R)&&(L=(Re=ae(R)).length),L<=oe)return R;if((L=oe-Z(ke))<1)return ke;if(oe=Re?on(Re,0,L).join(""):R.slice(0,L),W===J)return oe+ke;if(Re&&(L+=oe.length-L),zd(W)){if(R.slice(L).search(W)){var Xe,tt=oe;for(W.global||(W=gd(W.source,pr(oi.exec(W))+"g")),W.lastIndex=0;Xe=W.exec(tt);)var ot=Xe.index;oe=oe.slice(0,ot===J?L:ot)}}else R.indexOf(vl(W),L)==L||-1<(L=oe.lastIndexOf(W))&&(oe=oe.slice(0,L));return oe+ke},ie.unescape=function(R){return(R=pr(R))&&Ne.test(R)?R.replace(ln,Je):R},ie.uniqueId=function(R){var L=++Wk;return pr(R)+L},ie.upperCase=cw,ie.upperFirst=Od,ie.each=pp,ie.eachRight=vp,ie.first=hp,fd(ie,(Dd={},Pn(ie,function(R,L){Nr.call(ie.prototype,L)||(Dd[L]=R)}),Dd),{chain:!1}),ie.VERSION="4.17.4",o(["bind","bindKey","curry","curryRight","partial","partialRight"],function(R){ie[R].placeholder=ie}),o(["drop","take"],function(R,L){bt.prototype[R]=function(W){W=W===J?1:Sn(jl(W),0);var oe=this.__filtered__&&!L?new bt(this):this.clone();return oe.__filtered__?oe.__takeCount__=Zn(W,oe.__takeCount__):oe.__views__.push({size:Zn(W,fe),type:R+(oe.__dir__<0?"Right":"")}),oe},bt.prototype[R+"Right"]=function(W){return this.reverse()[R](W).reverse()}}),o(["filter","map","takeWhile"],function(R,L){var W=L+1,oe=W==1||W==3;bt.prototype[R]=function(ke){var Re=this.clone();return Re.__iteratees__.push({iteratee:xl(ke,3),type:W}),Re.__filtered__=Re.__filtered__||oe,Re}}),o(["head","last"],function(R,L){var W="take"+(L?"Right":"");bt.prototype[R]=function(){return this[W](1).value()[0]}}),o(["initial","tail"],function(R,L){var W="drop"+(L?"":"Right");bt.prototype[R]=function(){return this.__filtered__?new bt(this):this[W](1)}}),bt.prototype.compact=function(){return this.filter(ki)},bt.prototype.find=function(R){return this.filter(R).head()},bt.prototype.findLast=function(R){return this.reverse().find(R)},bt.prototype.invokeMap=El(function(R,L){return typeof R=="function"?new bt(this):this.map(function(W){return os(W,R,L)})}),bt.prototype.reject=function(R){return this.filter(_f(xl(R)))},bt.prototype.slice=function(R,L){R=jl(R);var W=this;return W.__filtered__&&(0<R||L<0)?new bt(W):(R<0?W=W.takeRight(-R):R&&(W=W.drop(R)),L!==J&&(W=(L=jl(L))<0?W.dropRight(-L):W.take(L-R)),W)},bt.prototype.takeRightWhile=function(R){return this.reverse().takeWhile(R).reverse()},bt.prototype.toArray=function(){return this.take(fe)},Pn(bt.prototype,function(R,L){var W=/^(?:filter|find|map|reject)|While$/.test(L),oe=/^(?:head|last)$/.test(L),ke=ie[oe?"take"+(L=="last"?"Right":""):L],Re=oe||/^find/.test(L);ke&&(ie.prototype[L]=function(){function Xe(ml){return ml=ke.apply(ie,g([ml],ot)),oe&&Bt?ml[0]:ml}var tt=this.__wrapped__,ot=oe?[1]:arguments,kt=tt instanceof bt,gt=ot[0],Rt=kt||Ll(tt);Rt&&W&&typeof gt=="function"&&gt.length!=1&&(kt=Rt=!1);var Bt=this.__chain__,Ot=!!this.__actions__.length,gt=Re&&!Bt,Ot=kt&&!Ot;if(Re||!Rt)return gt&&Ot?R.apply(this,ot):(Wt=this.thru(Xe),gt?oe?Wt.value()[0]:Wt.value():Wt);tt=Ot?tt:new bt(this);var Wt=R.apply(tt,ot);return Wt.__actions__.push({func:bf,args:[Xe],thisArg:J}),new ut(Wt,Bt)})}),o(["pop","push","shift","sort","splice","unshift"],function(R){var L=Sf[R],W=/^(?:push|sort|unshift)$/.test(R)?"tap":"thru",oe=/^(?:pop|shift)$/.test(R);ie.prototype[R]=function(){var ke=arguments;if(!oe||this.__chain__)return this[W](function(Xe){return L.apply(Ll(Xe)?Xe:[],ke)});var Re=this.value();return L.apply(Ll(Re)?Re:[],ke)}}),Pn(bt.prototype,function(R,L){var W,oe=ie[L];oe&&(W=oe.name+"",(su[W]||(su[W]=[])).push({name:L,func:oe}))}),su[df(J,2).name]=[{name:"wrapper",func:J}],bt.prototype.clone=function(){var R=new bt(this.__wrapped__);return R.__actions__=pi(this.__actions__),R.__dir__=this.__dir__,R.__filtered__=this.__filtered__,R.__iteratees__=pi(this.__iteratees__),R.__takeCount__=this.__takeCount__,R.__views__=pi(this.__views__),R},bt.prototype.reverse=function(){var R;return this.__filtered__?((R=new bt(this)).__dir__=-1,R.__filtered__=!0):(R=this.clone()).__dir__*=-1,R},bt.prototype.value=function(){var R=this.__wrapped__.value(),L=this.__dir__,W=Ll(R),oe=L<0,ke=W?R.length:0,Re=function(Cl,yl,Pr){for(var pl=-1,cr=Pr.length;++pl<cr;){var Lr=Pr[pl],Ln=Lr.size;switch(Lr.type){case"drop":Cl+=Ln;break;case"dropRight":yl-=Ln;break;case"take":yl=Zn(yl,Cl+Ln);break;case"takeRight":Cl=Sn(Cl,yl-Ln)}}return{start:Cl,end:yl}}(0,ke,this.__views__),Xe=Re.start,tt=(Re=Re.end)-Xe,ot=oe?Re:Xe-1,kt=this.__iteratees__,gt=kt.length,Rt=0,Bt=Zn(tt,this.__takeCount__);if(!W||!oe&&ke==tt&&Bt==tt)return cl(R,this.__actions__);var Ot=[];e:for(;tt--&&Rt<Bt;){for(var Wt=-1,ml=R[ot+=L];++Wt<gt;){var Ht=kt[Wt],dl=Ht.iteratee,Ht=Ht.type,dl=dl(ml);if(Ht==2)ml=dl;else if(!dl){if(Ht==1)continue e;break e}}Ot[Rt++]=ml}return Ot},ie.prototype.at=$b,ie.prototype.chain=function(){return gp(this)},ie.prototype.commit=function(){return new ut(this.value(),this.__chain__)},ie.prototype.next=function(){this.__values__===J&&(this.__values__=_p(this.value()));var R=this.__index__>=this.__values__.length;return{done:R,value:R?J:this.__values__[this.__index__++]}},ie.prototype.plant=function(R){for(var L,W=this;W instanceof dt;){var oe=sp(W);oe.__index__=0,oe.__values__=J,L?ke.__wrapped__=oe:L=oe;var ke=oe,W=W.__wrapped__}return ke.__wrapped__=R,L},ie.prototype.reverse=function(){var R=this.__wrapped__;return R instanceof bt?(R=R,this.__actions__.length&&(R=new bt(this)),(R=R.reverse()).__actions__.push({func:bf,args:[nd],thisArg:J}),new ut(R,this.__chain__)):this.thru(nd)},ie.prototype.toJSON=ie.prototype.valueOf=ie.prototype.value=function(){return cl(this.__wrapped__,this.__actions__)},ie.prototype.first=ie.prototype.head,ru&&(ie.prototype[ru]=function(){return this}),ie}();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(rn._=at,define(function(){return at})):Gi?((Gi.exports=at)._=at,Po._=at):rn._=at}.call(kn),function(e,n){typeof kn=="object"?In.exports=n():typeof define=="function"&&define.amd?define(n):e.jStat=n()}(kn,function(){var e,n,t,l,o,a,s,u,f,m,d,g,b,y,p,x=function(k,w){var C=Array.prototype.concat,T=Array.prototype.slice,z=Object.prototype.toString;function A(Z,ae){return ae=ae<Z?Z:ae,k.pow(10,17-~~(k.log(0<ae?ae:-ae)*k.LOG10E))}var M=Array.isArray||function(Z){return z.call(Z)==="[object Array]"};function P(Z){return z.call(Z)==="[object Function]"}function N(Z){return typeof Z=="number"&&Z-Z==0}function E(){return new E._init(arguments)}function B(){return 0}function U(){return 1}function X(Z,ae){return Z===ae?1:0}function le(Z,ae,J,pe){var K,se=[],te=Z.length;if(ae===w&&J===w&&pe===w)return E.copy(Z);if(pe=pe||1,(ae=0<=(ae=ae||0)?ae:te+ae)===(J=0<=(J=J||Z.length)?J:te+J)||pe===0)return[];if(ae<J&&pe<0)return[];if(J<ae&&0<pe)return[];if(0<pe)for(K=ae;K<J;K+=pe)se.push(Z[K]);else for(K=ae;J<K;K+=pe)se.push(Z[K]);return se}E.fn=E.prototype,E._init=function(Z){if(M(Z[0]))if(M(Z[0][0])){P(Z[1])&&(Z[0]=E.map(Z[0],Z[1]));for(var ae=0;ae<Z[0].length;ae++)this[ae]=Z[0][ae];this.length=Z[0].length}else this[0]=P(Z[1])?E.map(Z[0],Z[1]):Z[0],this.length=1;else if(N(Z[0]))this[0]=E.seq.apply(null,Z),this.length=1;else{if(Z[0]instanceof E)return E(Z[0].toArray());this[0]=[],this.length=1}return this},E._init.prototype=E.prototype,(E._init.constructor=E).utils={calcRdx:A,isArray:M,isFunction:P,isNumber:N,toVector:function(Z){return C.apply([],Z)}},E._random_fn=k.random,E.setRandom=function(Z){if(typeof Z!="function")throw new TypeError("fn is not a function");E._random_fn=Z},E.extend=function(Z){var ae,J;if(arguments.length===1){for(J in Z)E[J]=Z[J];return this}for(ae=1;ae<arguments.length;ae++)for(J in arguments[ae])Z[J]=arguments[ae][J];return Z},E.rows=function(Z){return Z.length||1},E.cols=function(Z){return Z[0].length||1},E.dimensions=function(Z){return{rows:E.rows(Z),cols:E.cols(Z)}},E.row=function(Z,ae){return M(ae)?ae.map(function(J){return E.row(Z,J)}):Z[ae]},E.rowa=function(Z,ae){return E.row(Z,ae)},E.col=function(Z,ae){if(M(ae)){var J=E.arange(Z.length).map(function(){return new Array(ae.length)});return ae.forEach(function(se,te){E.arange(Z.length).forEach(function(re){J[re][te]=Z[re][se]})}),J}for(var pe=new Array(Z.length),K=0;K<Z.length;K++)pe[K]=[Z[K][ae]];return pe},E.cola=function(Z,ae){return E.col(Z,ae).map(function(J){return J[0]})},E.diag=function(Z){for(var ae=E.rows(Z),J=new Array(ae),pe=0;pe<ae;pe++)J[pe]=[Z[pe][pe]];return J},E.antidiag=function(Z){for(var ae=E.rows(Z)-1,J=new Array(ae),pe=0;0<=ae;ae--,pe++)J[pe]=[Z[pe][ae]];return J},E.transpose=function(Z){var ae,J,pe,K,se,te=[];for(M(Z[0])||(Z=[Z]),J=Z.length,pe=Z[0].length,se=0;se<pe;se++){for(ae=new Array(J),K=0;K<J;K++)ae[K]=Z[K][se];te.push(ae)}return te.length===1?te[0]:te},E.map=function(Z,ae,J){var pe,K,se,te,re;for(M(Z[0])||(Z=[Z]),K=Z.length,se=Z[0].length,te=J?Z:new Array(K),pe=0;pe<K;pe++)for(te[pe]||(te[pe]=new Array(se)),re=0;re<se;re++)te[pe][re]=ae(Z[pe][re],pe,re);return te.length===1?te[0]:te},E.cumreduce=function(Z,ae,J){var pe,K,se,te,re;for(M(Z[0])||(Z=[Z]),K=Z.length,se=Z[0].length,te=J?Z:new Array(K),pe=0;pe<K;pe++)for(te[pe]||(te[pe]=new Array(se)),0<se&&(te[pe][0]=Z[pe][0]),re=1;re<se;re++)te[pe][re]=ae(te[pe][re-1],Z[pe][re]);return te.length===1?te[0]:te},E.alter=function(Z,ae){return E.map(Z,ae,!0)},E.create=function(Z,ae,J){var pe,K,se=new Array(Z);for(P(ae)&&(J=ae,ae=Z),pe=0;pe<Z;pe++)for(se[pe]=new Array(ae),K=0;K<ae;K++)se[pe][K]=J(pe,K);return se},E.zeros=function(Z,ae){return N(ae)||(ae=Z),E.create(Z,ae,B)},E.ones=function(Z,ae){return N(ae)||(ae=Z),E.create(Z,ae,U)},E.rand=function(Z,ae){return N(ae)||(ae=Z),E.create(Z,ae,E._random_fn)},E.identity=function(Z,ae){return N(ae)||(ae=Z),E.create(Z,ae,X)},E.symmetric=function(Z){var ae,J,pe=Z.length;if(Z.length!==Z[0].length)return!1;for(ae=0;ae<pe;ae++)for(J=0;J<pe;J++)if(Z[J][ae]!==Z[ae][J])return!1;return!0},E.clear=function(Z){return E.alter(Z,B)},E.seq=function(Z,ae,J,pe){P(pe)||(pe=!1);for(var K=[],se=A(Z,ae),te=(ae*se-Z*se)/((J-1)*se),re=Z,fe=0;re<=ae&&fe<J;re=(Z*se+te*se*++fe)/se)K.push(pe?pe(re,fe):re);return K},E.arange=function(Z,ae,J){var pe,K=[];if(J=J||1,ae===w&&(ae=Z,Z=0),Z===ae||J===0)return[];if(Z<ae&&J<0)return[];if(ae<Z&&0<J)return[];if(0<J)for(pe=Z;pe<ae;pe+=J)K.push(pe);else for(pe=Z;ae<pe;pe+=J)K.push(pe);return K},E.slice=function(Z,ae){var J,pe;return N((ae=ae||{}).row)?N(ae.col)?Z[ae.row][ae.col]:le(E.rowa(Z,ae.row),(J=ae.col||{}).start,J.end,J.step):N(ae.col)?le(E.cola(Z,ae.col),(pe=ae.row||{}).start,pe.end,pe.step):(pe=ae.row||{},J=ae.col||{},le(Z,pe.start,pe.end,pe.step).map(function(K){return le(K,J.start,J.end,J.step)}))},E.sliceAssign=function(Z,ae,J){var pe,K;if(N(ae.row)){if(N(ae.col))return Z[ae.row][ae.col]=J;ae.col=ae.col||{},ae.col.start=ae.col.start||0,ae.col.end=ae.col.end||Z[0].length,ae.col.step=ae.col.step||1,pe=E.arange(ae.col.start,k.min(Z.length,ae.col.end),ae.col.step);var se=ae.row;return pe.forEach(function(re,fe){Z[se][re]=J[fe]}),Z}if(N(ae.col)){ae.row=ae.row||{},ae.row.start=ae.row.start||0,ae.row.end=ae.row.end||Z.length,ae.row.step=ae.row.step||1,K=E.arange(ae.row.start,k.min(Z[0].length,ae.row.end),ae.row.step);var te=ae.col;return K.forEach(function(re,fe){Z[re][te]=J[fe]}),Z}return J[0].length===w&&(J=[J]),ae.row.start=ae.row.start||0,ae.row.end=ae.row.end||Z.length,ae.row.step=ae.row.step||1,ae.col.start=ae.col.start||0,ae.col.end=ae.col.end||Z[0].length,ae.col.step=ae.col.step||1,K=E.arange(ae.row.start,k.min(Z.length,ae.row.end),ae.row.step),pe=E.arange(ae.col.start,k.min(Z[0].length,ae.col.end),ae.col.step),K.forEach(function(re,fe){pe.forEach(function(Me,ye){Z[re][Me]=J[fe][ye]})}),Z},E.diagonal=function(Z){var ae=E.zeros(Z.length,Z.length);return Z.forEach(function(J,pe){ae[pe][pe]=J}),ae},E.copy=function(Z){return Z.map(function(ae){return N(ae)?ae:ae.map(function(J){return J})})};var he=E.prototype;return he.length=0,he.push=Array.prototype.push,he.sort=Array.prototype.sort,he.splice=Array.prototype.splice,he.slice=Array.prototype.slice,he.toArray=function(){return 1<this.length?T.call(this):T.call(this)[0]},he.map=function(Z,ae){return E(E.map(this,Z,ae))},he.cumreduce=function(Z,ae){return E(E.cumreduce(this,Z,ae))},he.alter=function(Z){return E.alter(this,Z),this},function(Z){for(var ae=0;ae<Z.length;ae++)(function(J){he[J]=function(pe){var K,se=this;return pe?(setTimeout(function(){pe.call(se,he[J].call(se))}),this):(K=E[J](this),M(K)?E(K):K)}})(Z[ae])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(Z){for(var ae=0;ae<Z.length;ae++)(function(J){he[J]=function(pe,K){var se=this;return K?(setTimeout(function(){K.call(se,he[J].call(se,pe))}),this):E(E[J](this,pe))}})(Z[ae])}("row col".split(" ")),function(Z){for(var ae=0;ae<Z.length;ae++)(function(J){he[J]=function(){return E(E[J].apply(null,arguments))}})(Z[ae])}("create zeros ones rand identity".split(" ")),E}(Math);function _(k,w,C,T){for(var z,A=0,M=1,P=1,N=1,E=0,B=0;l.abs((P-B)/P)>T;)M=N+(z=-(w+E)*(w+C+E)*k/(w+2*E)/(w+2*E+1))*M,P=(A=(B=P)+z*A)+(z=(E+=1)*(C-E)*k/(w+2*E-1)/(w+2*E))*P,A/=N=M+z*N,M/=N,P/=N,N=1;return P/w}function S(k,w,C){var T=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],z=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],A=.5*k;if(8<=A)return 1;for(var M=(M=2*t.normal.cdf(A,0,1,1,0)-1)>=l.exp(-50/C)?l.pow(M,C):0,P=3<k?2:3,N=A,E=(8-A)/P,B=N+E,U=0,X=C-1,le=1;le<=P;le++){for(var he=0,Z=.5*(B+N),ae=.5*(B-N),J=1;J<=12;J++){var pe,K=6<J?T[(pe=12-J+1)-1]:-T[(pe=J)-1],se=Z+ae*K,K=se*se;if(60<K)break;se=.5*(2*t.normal.cdf(se,0,1,1,0))-.5*(2*t.normal.cdf(se,k,1,1,0)),se>=l.exp(-30/X)&&(he+=z[pe-1]*l.exp(-.5*K)*l.pow(se,X))}U+=he*=2*ae*C/l.sqrt(2*l.PI),N=B,B+=E}return(M+=U)<=l.exp(-30/w)?0:1<=(M=l.pow(M,w))?1:M}function I(k){return m(k)||k instanceof o}function O(k,w,C,T){if(1<k||1<C||k<=0||C<=0)throw new Error("Proportions should be greater than 0 and less than 1");var z=(k*w+C*T)/(w+T);return(k-C)/g.sqrt(z*(1-z)*(1/w+1/T))}function F(k,w){var C=k.length,T=w[0].length-1,z=C-T-1,A=x.lstsq(w,k),M=x.multiply(w,A.map(function(X){return[X]})).map(function(X){return X[0]}),P=x.subtract(k,M),N=x.mean(k),E=x.sum(M.map(function(X){return Math.pow(X-N,2)})),B=x.sum(k.map(function(X,le){return Math.pow(X-M[le],2)})),U=E+B;return{exog:w,endog:k,nobs:C,df_model:T,df_resid:z,coef:A,predict:M,resid:P,ybar:N,SST:U,SSE:E,SSR:B,R2:E/U}}function D(k){var w,C,T=(w=k.exog,C=w[0].length,x.arange(C).map(function(E){var B=x.arange(C).filter(function(U){return U!==E});return F(x.col(w,E).map(function(U){return U[0]}),x.col(w,B))})),z=Math.sqrt(k.SSR/k.df_resid),A=T.map(function(E){var B=E.SST,E=E.R2;return z/Math.sqrt(B*(1-E))}),M=k.coef.map(function(E,B){return+E/A[B]}),P=M.map(function(E){return E=x.studentt.cdf(E,k.df_resid),2*(.5<E?1-E:E)}),N=x.studentt.inv(.975,k.df_resid),T=k.coef.map(function(E,B){return B=N*A[B],[E-B,E+B]});return{se:A,t:M,p:P,sigmaHat:z,interval95:T}}return function(k,w){var C=k.utils.isFunction;function T(M,P){return M-P}function z(M,P,N){return w.max(P,w.min(M,N))}k.sum=function(M){for(var P=0,N=M.length;0<=--N;)P+=M[N];return P},k.sumsqrd=function(M){for(var P=0,N=M.length;0<=--N;)P+=M[N]*M[N];return P},k.sumsqerr=function(M){for(var P,N=k.mean(M),E=0,B=M.length;0<=--B;)E+=(P=M[B]-N)*P;return E},k.sumrow=function(M){for(var P=0,N=M.length;0<=--N;)P+=M[N];return P},k.product=function(M){for(var P=1,N=M.length;0<=--N;)P*=M[N];return P},k.min=function(M){for(var P=M[0],N=0;++N<M.length;)M[N]<P&&(P=M[N]);return P},k.max=function(M){for(var P=M[0],N=0;++N<M.length;)M[N]>P&&(P=M[N]);return P},k.unique=function(M){for(var P={},N=[],E=0;E<M.length;E++)P[M[E]]||(P[M[E]]=!0,N.push(M[E]));return N},k.mean=function(M){return k.sum(M)/M.length},k.meansqerr=function(M){return k.sumsqerr(M)/M.length},k.geomean=function(M){return w.pow(k.product(M),1/M.length)},k.median=function(M){var P=M.length,M=M.slice().sort(T);return 1&P?M[P/2|0]:(M[P/2-1]+M[P/2])/2},k.cumsum=function(M){return k.cumreduce(M,function(P,N){return P+N})},k.cumprod=function(M){return k.cumreduce(M,function(P,N){return P*N})},k.diff=function(M){for(var P=[],N=M.length,E=1;E<N;E++)P.push(M[E]-M[E-1]);return P},k.rank=function(M){for(var P=[],N={},E=0;E<M.length;E++)N[le=M[E]]?N[le]++:(N[le]=1,P.push(le));var B=P.sort(T),U={},X=1;for(E=0;E<B.length;E++){var le,he=N[le=B[E]],Z=(X+(X+he-1))/2;U[le]=Z,X+=he}return M.map(function(ae){return U[ae]})},k.mode=function(M){for(var P=M.length,N=M.slice().sort(T),E=1,B=0,U=0,X=[],le=0;le<P;le++)N[le]===N[le+1]?E++:(B<E?(X=[N[le]],B=E,U=0):E===B&&(X.push(N[le]),U++),E=1);return U===0?X[0]:X},k.range=function(M){return k.max(M)-k.min(M)},k.variance=function(M,P){return k.sumsqerr(M)/(M.length-(P?1:0))},k.pooledvariance=function(M){return M.reduce(function(P,N){return P+k.sumsqerr(N)},0)/(M.reduce(function(P,N){return P+N.length},0)-M.length)},k.deviation=function(M){for(var P=k.mean(M),N=M.length,E=new Array(N),B=0;B<N;B++)E[B]=M[B]-P;return E},k.stdev=function(M,P){return w.sqrt(k.variance(M,P))},k.pooledstdev=function(M){return w.sqrt(k.pooledvariance(M))},k.meandev=function(M){for(var P=k.mean(M),N=[],E=M.length-1;0<=E;E--)N.push(w.abs(M[E]-P));return k.mean(N)},k.meddev=function(M){for(var P=k.median(M),N=[],E=M.length-1;0<=E;E--)N.push(w.abs(M[E]-P));return k.median(N)},k.coeffvar=function(M){return k.stdev(M)/k.mean(M)},k.quartiles=function(M){var P=M.length,M=M.slice().sort(T);return[M[w.round(P/4)-1],M[w.round(P/2)-1],M[w.round(3*P/4)-1]]},k.quantiles=function(M,P,N,E){var B,U,X,le=M.slice().sort(T),he=[P.length],Z=M.length;for(N===void 0&&(N=3/8),E===void 0&&(E=3/8),B=0;B<P.length;B++)X=Z*(U=P[B])+(N+U*(1-N-E)),U=w.floor(z(X,1,Z-1)),X=z(X-U,0,1),he[B]=(1-X)*le[U-1]+X*le[U];return he},k.percentile=function(M,P,N){return M=M.slice().sort(T),P=P*(M.length+(N?1:-1))+(N?0:1),N=parseInt(P),P-=N,N+1<M.length?M[N-1]+P*(M[N]-M[N-1]):M[N-1]},k.percentileOfScore=function(M,P,N){for(var E,B=0,U=M.length,X=N==="strict",le=0;le<U;le++)E=M[le],(X&&E<P||!X&&E<=P)&&B++;return B/U},k.histogram=function(M,P){P=P||4;for(var N=k.min(M),E=(k.max(M)-N)/P,B=M.length,U=[],X=0;X<P;X++)U[X]=0;for(X=0;X<B;X++)U[w.min(w.floor((M[X]-N)/E),P-1)]+=1;return U},k.covariance=function(M,P){for(var N=k.mean(M),E=k.mean(P),B=M.length,U=new Array(B),X=0;X<B;X++)U[X]=(M[X]-N)*(P[X]-E);return k.sum(U)/(B-1)},k.corrcoeff=function(M,P){return k.covariance(M,P)/k.stdev(M,1)/k.stdev(P,1)},k.spearmancoeff=function(M,P){return M=k.rank(M),P=k.rank(P),k.corrcoeff(M,P)},k.stanMoment=function(M,P){for(var N=k.mean(M),E=k.stdev(M),B=M.length,U=0,X=0;X<B;X++)U+=w.pow((M[X]-N)/E,P);return U/M.length},k.skewness=function(M){return k.stanMoment(M,3)},k.kurtosis=function(M){return k.stanMoment(M,4)-3};var A=k.prototype;(function(M){for(var P=0;P<M.length;P++)(function(N){A[N]=function(E,B){var U=[],X=0,le=this;if(C(E)&&(B=E,E=!1),B)return setTimeout(function(){B.call(le,A[N].call(le,E))}),this;if(1<this.length){for(le=E===!0?this:this.transpose();X<le.length;X++)U[X]=k[N](le[X]);return U}return k[N](this[0],E)}})(M[P])})("cumsum cumprod".split(" ")),function(M){for(var P=0;P<M.length;P++)(function(N){A[N]=function(E,B){var U=[],X=0,le=this;if(C(E)&&(B=E,E=!1),B)return setTimeout(function(){B.call(le,A[N].call(le,E))}),this;if(1<this.length){for(N!=="sumrow"&&(le=E===!0?this:this.transpose());X<le.length;X++)U[X]=k[N](le[X]);return E===!0?k[N](k.utils.toVector(U)):U}return k[N](this[0],E)}})(M[P])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(M){for(var P=0;P<M.length;P++)(function(N){A[N]=function(){var E,B=[],U=0,X=this,le=Array.prototype.slice.call(arguments);if(C(le[le.length-1])){E=le[le.length-1];var he=le.slice(0,le.length-1);return setTimeout(function(){E.call(X,A[N].apply(X,he))}),this}E=void 0;var Z=function(ae){return k[N].apply(X,[ae].concat(le))};if(1<this.length){for(X=X.transpose();U<X.length;U++)B[U]=Z(X[U]);return B}return Z(this[0])}})(M[P])}("quantiles percentileOfScore".split(" "))}(x,Math),e=x,n=Math,e.gammaln=function(k){var w,C,T=0,z=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],A=1.000000000190015,k=(C=w=k)+5.5;for(k-=(w+.5)*n.log(k);T<6;T++)A+=z[T]/++C;return n.log(2.5066282746310007*A/w)-k},e.loggam=function(k){var w,C,T,z,A,M=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],P=k,N=0;if(k==1||k==2)return 0;for(k<=7&&(P=k+(N=n.floor(7-k))),w=1/(P*P),C=2*n.PI,z=M[9],A=8;0<=A;A--)z*=w,z+=M[A];if(T=z/P+.5*n.log(C)+(P-.5)*n.log(P)-P,k<=7)for(A=1;A<=N;A++)T-=n.log(P-1),--P;return T},e.gammafn=function(k){var w,C,T,z=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],A=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],M=!1,P=0,N=0,E=0,B=k;if(171.6243769536076<k)return 1/0;if(B<=0){if(!(T=B%1+36e-17))return 1/0;M=(1&B?-1:1)*n.PI/n.sin(n.PI*T),B=1-B}for(C=(k=B)<1?B++:(B-=P=(0|B)-1)-1,w=0;w<8;++w)E=(E+z[w])*C,N=N*C+A[w];if(T=E/N+1,k<B)T/=k;else if(B<k)for(w=0;w<P;++w)T*=B,B++;return M&&(T=M/T),T},e.gammap=function(k,w){return e.lowRegGamma(k,w)*e.gammafn(k)},e.lowRegGamma=function(k,w){var C,T=e.gammaln(k),z=k,A=1/k,M=A,P=w+1-k,N=1/1e-30,E=1/P,B=E,U=1,X=-~(8.5*n.log(1<=k?k:1/k)+.4*k+17);if(w<0||k<=0)return NaN;if(w<k+1){for(;U<=X;U++)A+=M*=w/++z;return A*n.exp(-w+k*n.log(w)-T)}for(;U<=X;U++)B*=(E=1/(E=(C=-U*(U-k))*E+(P+=2)))*(N=P+C/N);return 1-B*n.exp(-w+k*n.log(w)-T)},e.factorialln=function(k){return k<0?NaN:e.gammaln(k+1)},e.factorial=function(k){return k<0?NaN:e.gammafn(k+1)},e.combination=function(k,w){return 170<k||170<w?n.exp(e.combinationln(k,w)):e.factorial(k)/e.factorial(w)/e.factorial(k-w)},e.combinationln=function(k,w){return e.factorialln(k)-e.factorialln(w)-e.factorialln(k-w)},e.permutation=function(k,w){return e.factorial(k)/e.factorial(k-w)},e.betafn=function(k,w){if(!(k<=0||w<=0))return 170<k+w?n.exp(e.betaln(k,w)):e.gammafn(k)*e.gammafn(w)/e.gammafn(k+w)},e.betaln=function(k,w){return e.gammaln(k)+e.gammaln(w)-e.gammaln(k+w)},e.betacf=function(k,w,C){var T,z,A,M=1e-30,P=1,N=w+C,E=w+1,B=w-1,U=1,X=1-N*k/E;for(n.abs(X)<M&&(X=M),A=X=1/X;P<=100&&(X=1+(z=P*(C-P)*k/((B+(T=2*P))*(w+T)))*X,n.abs(X)<M&&(X=M),U=1+z/U,n.abs(U)<M&&(U=M),A*=(X=1/X)*U,X=1+(z=-(w+P)*(N+P)*k/((w+T)*(E+T)))*X,n.abs(X)<M&&(X=M),U=1+z/U,n.abs(U)<M&&(U=M),A*=z=(X=1/X)*U,!(n.abs(z-1)<3e-7));P++);return A},e.gammapinv=function(k,w){var C,T,z,A,M,P,N=0,E=w-1,B=e.gammaln(w);if(1<=k)return n.max(100,w+100*n.sqrt(w));if(k<=0)return 0;for(C=1<w?(M=n.log(E),P=n.exp(E*(M-1)-B),A=k<.5?k:1-k,C=(2.30753+.27061*(T=n.sqrt(-2*n.log(A))))/(1+T*(.99229+.04481*T))-T,k<.5&&(C=-C),n.max(.001,w*n.pow(1-1/(9*w)-C/(3*n.sqrt(w)),3))):k<(T=1-w*(.253+.12*w))?n.pow(k/T,1/w):1-n.log(1-(k-T)/(1-T));N<12;N++){if(C<=0)return 0;if((C-=T=(z=(e.lowRegGamma(w,C)-k)/(T=1<w?P*n.exp(-(C-E)+E*(n.log(C)-M)):n.exp(-C+E*n.log(C)-B)))/(1-.5*n.min(1,z*((w-1)/C-1))))<=0&&(C=.5*(C+T)),n.abs(T)<1e-8*C)break}return C},e.erf=function(k){var w,C,T,z=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],A=z.length-1,M=!1,P=0,N=0;for(k<0&&(k=-k,M=!0),C=4*(w=2/(2+k))-2;0<A;A--)P=C*(T=P)-N+z[A],N=T;return k=w*n.exp(-k*k+.5*(z[0]+C*P)-N),M?k-1:1-k},e.erfc=function(k){return 1-e.erf(k)},e.erfcinv=function(k){var w,C,T,z,A=0;if(2<=k)return-100;if(k<=0)return 100;for(z=k<1?k:2-k,w=-.70711*((2.30753+.27061*(T=n.sqrt(-2*n.log(z/2))))/(1+T*(.99229+.04481*T))-T);A<2;A++)w+=(C=e.erfc(w)-z)/(1.1283791670955126*n.exp(-w*w)-w*C);return k<1?w:-w},e.ibetainv=function(k,w,C){var T,z,A,M,P,N,E,B=w-1,U=C-1,X=0;if(k<=0)return 0;if(1<=k)return 1;for(A=1<=w&&1<=C?(N=k<.5?k:1-k,A=(2.30753+.27061*(T=n.sqrt(-2*n.log(N))))/(1+T*(.99229+.04481*T))-T,k<.5&&(A=-A),M=(A*A-3)/6,P=2/(1/(2*w-1)+1/(2*C-1)),N=A*n.sqrt(M+P)/P-(1/(2*C-1)-1/(2*w-1))*(M+5/6-2/(3*P)),w/(w+C*n.exp(2*N))):(M=n.log(w/(w+C)),P=n.log(C/(w+C)),k<(T=n.exp(w*M)/w)/(N=T+(z=n.exp(C*P)/C))?n.pow(w*N*k,1/w):1-n.pow(C*N*(1-k),1/C)),E=-e.gammaln(w)-e.gammaln(C)+e.gammaln(w+C);X<10;X++){if(A===0||A===1)return A;if((A-=T=(z=(e.ibeta(A,w,C)-k)/(T=n.exp(B*n.log(A)+U*n.log(1-A)+E)))/(1-.5*n.min(1,z*(B/A-U/(1-A)))))<=0&&(A=.5*(A+T)),1<=A&&(A=.5*(A+T+1)),n.abs(T)<1e-8*A&&0<X)break}return A},e.ibeta=function(k,w,C){var T=k===0||k===1?0:n.exp(e.gammaln(w+C)-e.gammaln(w)-e.gammaln(C)+w*n.log(k)+C*n.log(1-k));return!(k<0||1<k)&&(k<(w+1)/(w+C+2)?T*e.betacf(k,w,C)/w:1-T*e.betacf(1-k,C,w)/C)},e.randn=function(k,w){var C,T,z,A;if(w=w||k,k)return e.create(k,w,function(){return e.randn()});for(;C=e._random_fn(),T=1.7156*(e._random_fn()-.5),A=(A=C-.449871)*A+(z=n.abs(T)+.386595)*(.196*z-.25472*A),.27597<A&&(.27846<A||T*T>-4*n.log(C)*C*C););return T/C},e.randg=function(k,w,C){var T,z,A,M,P,N=k;if(C=C||w,k=k||1,w)return(C=e.zeros(w,C)).alter(function(){return e.randg(k)}),C;k<1&&(k+=1),T=k-1/3,z=1/n.sqrt(9*T);do for(;M=1+z*(P=e.randn()),M<=0;);while(M*=M*M,(A=e._random_fn())>1-.331*n.pow(P,4)&&n.log(A)>.5*P*P+T*(1-M+n.log(M)));if(k==N)return T*M;for(;A=e._random_fn(),A===0;);return n.pow(A,1/N)*T*M},function(k){for(var w=0;w<k.length;w++)(function(C){e.fn[C]=function(){return e(e.map(this,function(T){return e[C](T)}))}})(k[w])}("gammaln gammafn factorial factorialln".split(" ")),function(k){for(var w=0;w<k.length;w++)(function(C){e.fn[C]=function(){return e(e[C].apply(null,arguments))}})(k[w])}("randn".split(" ")),t=x,l=Math,function(k){for(var w=0;w<k.length;w++)(function(C){t[C]=function(T,z,A){return this instanceof arguments.callee?(this._a=T,this._b=z,this._c=A,this):new arguments.callee(T,z,A)},t.fn[C]=function(T,z,A){return A=t[C](T,z,A),A.data=this,A},t[C].prototype.sample=function(T){var z=this._a,A=this._b,M=this._c;return T?t.alter(T,function(){return t[C].sample(z,A,M)}):t[C].sample(z,A,M)},function(T){for(var z=0;z<T.length;z++)(function(A){t[C].prototype[A]=function(M){var P=this._a,N=this._b,E=this._c;return M||M===0||(M=this.data),typeof M!="number"?t.fn.map.call(M,function(B){return t[C][A](B,P,N,E)}):t[C][A](M,P,N,E)}})(T[z])}("pdf cdf inv".split(" ")),function(T){for(var z=0;z<T.length;z++)(function(A){t[C].prototype[A]=function(){return t[C][A](this._a,this._b,this._c)}})(T[z])}("mean median mode variance".split(" "))})(k[w])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(k,w,C){return 1<k||k<0?0:w==1&&C==1?1:w<512&&C<512?l.pow(k,w-1)*l.pow(1-k,C-1)/t.betafn(w,C):l.exp((w-1)*l.log(k)+(C-1)*l.log(1-k)-t.betaln(w,C))},cdf:function(k,w,C){return 1<k||k<0?+(1<k):t.ibeta(k,w,C)},inv:function(k,w,C){return t.ibetainv(k,w,C)},mean:function(k,w){return k/(k+w)},median:function(k,w){return t.ibetainv(.5,k,w)},mode:function(k,w){return(k-1)/(k+w-2)},sample:function(k,w){return k=t.randg(k),k/(k+t.randg(w))},variance:function(k,w){return k*w/(l.pow(k+w,2)*(k+w+1))}}),t.extend(t.centralF,{pdf:function(k,w,C){var T;return k<0?0:w<=2?k===0&&w<2?1/0:k===0&&w===2?1:1/t.betafn(w/2,C/2)*l.pow(w/C,w/2)*l.pow(k,w/2-1)*l.pow(1+w/C*k,-(w+C)/2):(T=w*k/(C+k*w),w*(C/(C+k*w))/2*t.binomial.pdf((w-2)/2,(w+C-2)/2,T))},cdf:function(k,w,C){return k<0?0:t.ibeta(w*k/(w*k+C),w/2,C/2)},inv:function(k,w,C){return C/(w*(1/t.ibetainv(k,w/2,C/2)-1))},mean:function(k,w){return 2<w?w/(w-2):void 0},mode:function(k,w){return 2<k?w*(k-2)/(k*(w+2)):void 0},sample:function(k,w){return 2*t.randg(k/2)/k/(2*t.randg(w/2)/w)},variance:function(k,w){if(!(w<=4))return 2*w*w*(k+w-2)/(k*(w-2)*(w-2)*(w-4))}}),t.extend(t.cauchy,{pdf:function(k,w,C){return C<0?0:C/(l.pow(k-w,2)+l.pow(C,2))/l.PI},cdf:function(k,w,C){return l.atan((k-w)/C)/l.PI+.5},inv:function(k,w,C){return w+C*l.tan(l.PI*(k-.5))},median:function(k){return k},mode:function(k){return k},sample:function(k,w){return t.randn()*l.sqrt(1/(2*t.randg(.5)))*w+k}}),t.extend(t.chisquare,{pdf:function(k,w){return k<0?0:k===0&&w===2?.5:l.exp((w/2-1)*l.log(k)-k/2-w/2*l.log(2)-t.gammaln(w/2))},cdf:function(k,w){return k<0?0:t.lowRegGamma(w/2,k/2)},inv:function(k,w){return 2*t.gammapinv(k,.5*w)},mean:function(k){return k},median:function(k){return k*l.pow(1-2/(9*k),3)},mode:function(k){return 0<k-2?k-2:0},sample:function(k){return 2*t.randg(k/2)},variance:function(k){return 2*k}}),t.extend(t.exponential,{pdf:function(k,w){return k<0?0:w*l.exp(-w*k)},cdf:function(k,w){return k<0?0:1-l.exp(-w*k)},inv:function(k,w){return-l.log(1-k)/w},mean:function(k){return 1/k},median:function(k){return 1/k*l.log(2)},mode:function(){return 0},sample:function(k){return-1/k*l.log(t._random_fn())},variance:function(k){return l.pow(k,-2)}}),t.extend(t.gamma,{pdf:function(k,w,C){return k<0?0:k===0&&w===1?1/C:l.exp((w-1)*l.log(k)-k/C-t.gammaln(w)-w*l.log(C))},cdf:function(k,w,C){return k<0?0:t.lowRegGamma(w,k/C)},inv:function(k,w,C){return t.gammapinv(k,w)*C},mean:function(k,w){return k*w},mode:function(k,w){if(1<k)return(k-1)*w},sample:function(k,w){return t.randg(k)*w},variance:function(k,w){return k*w*w}}),t.extend(t.invgamma,{pdf:function(k,w,C){return k<=0?0:l.exp(-(w+1)*l.log(k)-C/k-t.gammaln(w)+w*l.log(C))},cdf:function(k,w,C){return k<=0?0:1-t.lowRegGamma(w,C/k)},inv:function(k,w,C){return C/t.gammapinv(1-k,w)},mean:function(k,w){return 1<k?w/(k-1):void 0},mode:function(k,w){return w/(k+1)},sample:function(k,w){return w/t.randg(k)},variance:function(k,w){if(!(k<=2))return w*w/((k-1)*(k-1)*(k-2))}}),t.extend(t.kumaraswamy,{pdf:function(k,w,C){return k===0&&w===1?C:k===1&&C===1?w:l.exp(l.log(w)+l.log(C)+(w-1)*l.log(k)+(C-1)*l.log(1-l.pow(k,w)))},cdf:function(k,w,C){return k<0?0:1<k?1:1-l.pow(1-l.pow(k,w),C)},inv:function(k,w,C){return l.pow(1-l.pow(1-k,1/C),1/w)},mean:function(k,w){return w*t.gammafn(1+1/k)*t.gammafn(w)/t.gammafn(1+1/k+w)},median:function(k,w){return l.pow(1-l.pow(2,-1/w),1/k)},mode:function(k,w){if(1<=k&&1<=w&&k!==1&&w!==1)return l.pow((k-1)/(k*w-1),1/k)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(k,w,C){return k<=0?0:l.exp(-l.log(k)-.5*l.log(2*l.PI)-l.log(C)-l.pow(l.log(k)-w,2)/(2*C*C))},cdf:function(k,w,C){return k<0?0:.5+.5*t.erf((l.log(k)-w)/l.sqrt(2*C*C))},inv:function(k,w,C){return l.exp(-1.4142135623730951*C*t.erfcinv(2*k)+w)},mean:function(k,w){return l.exp(k+w*w/2)},median:function(k){return l.exp(k)},mode:function(k,w){return l.exp(k-w*w)},sample:function(k,w){return l.exp(t.randn()*w+k)},variance:function(k,w){return(l.exp(w*w)-1)*l.exp(2*k+w*w)}}),t.extend(t.noncentralt,{pdf:function(k,w,C){return l.abs(C)<1e-14?t.studentt.pdf(k,w):l.abs(k)<1e-14?l.exp(t.gammaln((w+1)/2)-C*C/2-.5*l.log(l.PI*w)-t.gammaln(w/2)):w/k*(t.noncentralt.cdf(k*l.sqrt(1+2/w),w+2,C)-t.noncentralt.cdf(k,w,C))},cdf:function(k,w,C){if(l.abs(C)<1e-14)return t.studentt.cdf(k,w);var T=!1;k<0&&(T=!0,C=-C);for(var z=t.normal.cdf(-C,0,1),A=1e-14+1,M=A,P=k*k/(k*k+w),N=0,E=l.exp(-C*C/2),B=l.exp(-C*C/2-.5*l.log(2)-t.gammaln(1.5))*C;N<200||1e-14<M||1e-14<A;)M=A,0<N&&(E*=C*C/(2*N),B*=C*C/(2*(N+.5))),z+=.5*(A=E*t.beta.cdf(P,N+.5,w/2)+B*t.beta.cdf(P,N+1,w/2)),N++;return T?1-z:z}}),t.extend(t.normal,{pdf:function(k,w,C){return l.exp(-.5*l.log(2*l.PI)-l.log(C)-l.pow(k-w,2)/(2*C*C))},cdf:function(k,w,C){return .5*(1+t.erf((k-w)/l.sqrt(2*C*C)))},inv:function(k,w,C){return-1.4142135623730951*C*t.erfcinv(2*k)+w},mean:function(k){return k},median:function(k){return k},mode:function(k){return k},sample:function(k,w){return t.randn()*w+k},variance:function(k,w){return w*w}}),t.extend(t.pareto,{pdf:function(k,w,C){return k<w?0:C*l.pow(w,C)/l.pow(k,C+1)},cdf:function(k,w,C){return k<w?0:1-l.pow(w/k,C)},inv:function(k,w,C){return w/l.pow(1-k,1/C)},mean:function(k,w){if(!(w<=1))return w*l.pow(k,w)/(w-1)},median:function(k,w){return k*(w*l.SQRT2)},mode:function(k){return k},variance:function(k,w){if(!(w<=2))return k*k*w/(l.pow(w-1,2)*(w-2))}}),t.extend(t.studentt,{pdf:function(k,w){return w=1e100<w?1e100:w,1/(l.sqrt(w)*t.betafn(.5,w/2))*l.pow(1+k*k/w,-(w+1)/2)},cdf:function(k,w){var C=w/2;return t.ibeta((k+l.sqrt(k*k+w))/(2*l.sqrt(k*k+w)),C,C)},inv:function(k,w){var C=t.ibetainv(2*l.min(k,1-k),.5*w,.5),C=l.sqrt(w*(1-C)/C);return .5<k?C:-C},mean:function(k){return 1<k?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(k){return t.randn()*l.sqrt(k/(2*t.randg(k/2)))},variance:function(k){return 2<k?k/(k-2):1<k?1/0:void 0}}),t.extend(t.weibull,{pdf:function(k,w,C){return k<0||w<0||C<0?0:C/w*l.pow(k/w,C-1)*l.exp(-l.pow(k/w,C))},cdf:function(k,w,C){return k<0?0:1-l.exp(-l.pow(k/w,C))},inv:function(k,w,C){return w*l.pow(-l.log(1-k),1/C)},mean:function(k,w){return k*t.gammafn(1+1/w)},median:function(k,w){return k*l.pow(l.log(2),1/w)},mode:function(k,w){return w<=1?0:k*l.pow((w-1)/w,1/w)},sample:function(k,w){return k*l.pow(-l.log(t._random_fn()),1/w)},variance:function(k,w){return k*k*t.gammafn(1+2/w)-l.pow(t.weibull.mean(k,w),2)}}),t.extend(t.uniform,{pdf:function(k,w,C){return k<w||C<k?0:1/(C-w)},cdf:function(k,w,C){return k<w?0:k<C?(k-w)/(C-w):1},inv:function(k,w,C){return w+k*(C-w)},mean:function(k,w){return .5*(k+w)},median:function(k,w){return t.mean(k,w)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(k,w){return k/2+w/2+(w/2-k/2)*(2*t._random_fn()-1)},variance:function(k,w){return l.pow(w-k,2)/12}}),t.extend(t.binomial,{pdf:function(k,w,C){return C===0||C===1?w*C===k?1:0:t.combination(w,k)*l.pow(C,k)*l.pow(1-C,w-k)},cdf:function(k,w,C){if(k<0)return 0;if(w<=k)return 1;if(C<0||1<C||w<=0)return NaN;var T=C,z=(k=l.floor(k))+1,C=w-k,w=z+C,k=l.exp(t.gammaln(w)-t.gammaln(C)-t.gammaln(z)+z*l.log(T)+C*l.log(1-T)),z=T<(z+1)/(w+2)?k*_(T,z,C,1e-10):1-k*_(1-T,C,z,1e-10);return l.round(1e10*(1-z))/1e10}}),t.extend(t.negbin,{pdf:function(k,w,C){return k===k>>>0&&(k<0?0:t.combination(k+w-1,w-1)*l.pow(1-C,k)*l.pow(C,w))},cdf:function(k,w,C){var T=0,z=0;if(k<0)return 0;for(;z<=k;z++)T+=t.negbin.pdf(z,w,C);return T}}),t.extend(t.hypgeom,{pdf:function(k,w,C,T){if(k!=k|0)return!1;if(k<0||k<C-(w-T)||T<k||C<k)return 0;if(w<2*C)return w<2*T?t.hypgeom.pdf(w-C-T+k,w,w-C,w-T):t.hypgeom.pdf(T-k,w,w-C,T);if(w<2*T)return t.hypgeom.pdf(C-k,w,C,w-T);if(C<T)return t.hypgeom.pdf(k,w,T,C);for(var z=1,A=0,M=0;M<k;M++){for(;1<z&&A<T;)z*=1-C/(w-A),A++;z*=(T-M)*(C-M)/((M+1)*(w-C-T+M+1))}for(;A<T;A++)z*=1-C/(w-A);return l.min(1,l.max(0,z))},cdf:function(k,w,C,T){if(k<0||k<C-(w-T))return 0;if(T<=k||C<=k)return 1;if(w<2*C)return w<2*T?t.hypgeom.cdf(w-C-T+k,w,w-C,w-T):1-t.hypgeom.cdf(T-k-1,w,w-C,T);if(w<2*T)return 1-t.hypgeom.cdf(C-k-1,w,C,w-T);if(C<T)return t.hypgeom.cdf(k,w,T,C);for(var z=1,A=1,M=0,P=0;P<k;P++){for(;1<z&&M<T;){var N=1-C/(w-M);A*=N,z*=N,M++}z+=A*=(T-P)*(C-P)/((P+1)*(w-C-T+P+1))}for(;M<T;M++)z*=1-C/(w-M);return l.min(1,l.max(0,z))}}),t.extend(t.poisson,{pdf:function(k,w){return w<0||k%1!=0||k<0?0:l.pow(w,k)*l.exp(-w)/t.factorial(k)},cdf:function(k,w){var C=[],T=0;if(k<0)return 0;for(;T<=k;T++)C.push(t.poisson.pdf(T,w));return t.sum(C)},mean:function(k){return k},variance:function(k){return k},sampleSmall:function(k){for(var w=1,C=0,T=l.exp(-k);C++,w*=t._random_fn(),T<w;);return C-1},sampleLarge:function(k){for(var w,C,T,z=k,k=l.sqrt(z),A=l.log(z),M=.931+2.53*k,P=.02483*M-.059,N=1.1239+1.1328/(M-3.4),E=.9277-3.6224/(M-2);;)if(w=l.random()-.5,C=l.random(),T=.5-l.abs(w),w=l.floor((2*P/T+M)*w+z+.43),.07<=T&&C<=E||!(w<0||T<.013&&T<C)&&l.log(C)+l.log(N)-l.log(P/(T*T)+M)<=w*A-z-t.loggam(w+1))return w},sample:function(k){return k<10?this.sampleSmall(k):this.sampleLarge(k)}}),t.extend(t.triangular,{pdf:function(k,w,C,T){return C<=w||T<w||C<T?NaN:k<w||C<k?0:k<T?2*(k-w)/((C-w)*(T-w)):k===T?2/(C-w):2*(C-k)/((C-w)*(C-T))},cdf:function(k,w,C,T){return C<=w||T<w||C<T?NaN:k<=w?0:C<=k?1:k<=T?l.pow(k-w,2)/((C-w)*(T-w)):1-l.pow(C-k,2)/((C-w)*(C-T))},inv:function(k,w,C,T){return C<=w||T<w||C<T?NaN:k<=(T-w)/(C-w)?w+(C-w)*l.sqrt(k*((T-w)/(C-w))):w+(C-w)*(1-l.sqrt((1-k)*(1-(T-w)/(C-w))))},mean:function(k,w,C){return(k+w+C)/3},median:function(k,w,C){return C<=(k+w)/2?w-l.sqrt((w-k)*(w-C))/l.sqrt(2):(k+w)/2<C?k+l.sqrt((w-k)*(C-k))/l.sqrt(2):void 0},mode:function(k,w,C){return C},sample:function(k,w,C){var T=t._random_fn();return T<(C-k)/(w-k)?k+l.sqrt(T*(w-k)*(C-k)):w-l.sqrt((1-T)*(w-k)*(w-C))},variance:function(k,w,C){return(k*k+w*w+C*C-k*w-k*C-w*C)/18}}),t.extend(t.arcsine,{pdf:function(k,w,C){return C<=w?NaN:k<=w||C<=k?0:2/l.PI*l.pow(l.pow(C-w,2)-l.pow(2*k-w-C,2),-.5)},cdf:function(k,w,C){return k<w?0:k<C?2/l.PI*l.asin(l.sqrt((k-w)/(C-w))):1},inv:function(k,w,C){return w+(.5-.5*l.cos(l.PI*k))*(C-w)},mean:function(k,w){return w<=k?NaN:(k+w)/2},median:function(k,w){return w<=k?NaN:(k+w)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(k,w){return(k+w)/2+(w-k)/2*l.sin(2*l.PI*t.uniform.sample(0,1))},variance:function(k,w){return w<=k?NaN:l.pow(w-k,2)/8}}),t.extend(t.laplace,{pdf:function(k,w,C){return C<=0?0:l.exp(-l.abs(k-w)/C)/(2*C)},cdf:function(k,w,C){return C<=0?0:k<w?.5*l.exp((k-w)/C):1-.5*l.exp(-(k-w)/C)},mean:function(k){return k},median:function(k){return k},mode:function(k){return k},variance:function(k,w){return 2*w*w},sample:function(k,w){var C=t._random_fn()-.5;return k-w*((w=C)/l.abs(w))*l.log(1-2*l.abs(C))}}),t.extend(t.tukey,{cdf:function(k,w,C){var T=w,z=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],A=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(k<=0)return 0;if(C<2||T<2)return NaN;if(!Number.isFinite(k))return 1;if(25e3<C)return S(k,1,T);var w=.5*C,M=w*l.log(C)-C*l.log(2)-t.gammaln(w),P=w-1,N=.25*C,E=C<=100?1:C<=800?.5:C<=5e3?.25:.125;M+=l.log(E);for(var B=0,U=1;U<=50;U++){for(var X=0,le=(2*U-1)*E,he=1;he<=16;he++){var Z,ae=8<he?(Z=he-8-1,M+P*l.log(le+z[Z]*E)-(z[Z]*E+le)*N):(Z=he-1,M+P*l.log(le-z[Z]*E)+(z[Z]*E-le)*N);-30<=ae&&(X+=S(8<he?k*l.sqrt(.5*(z[Z]*E+le)):k*l.sqrt(.5*(-z[Z]*E+le)),1,T)*A[Z]*l.exp(ae))}if(1<=U*E&&X<=1e-14)break;B+=X}if(1e-14<X)throw new Error("tukey.cdf failed to converge");return 1<B&&(B=1),B},inv:function(k,w,C){if(C<2||w<2)return NaN;if(k<0||1<k)return NaN;if(k===0)return 0;if(k===1)return 1/0;for(var T,z,A,M,P=(z=w,A=C,M=.5-.5*(T=k),M=(T=l.sqrt(l.log(1/(M*M))))+((((-453642210148e-16*T-.204231210125)*T-.342242088547)*T-1)*T+.322232421088)/((((.0038560700634*T+.10353775285)*T+.531103462366)*T+.588581570495)*T+.099348462606),A<120&&(M+=(M*M*M+M)/A/4),T=.8832-.2368*M,A<120&&(T+=-1.214/A+1.208*M/A),M*(T*l.log(z-1)+1.4142)),N=0<(X=t.tukey.cdf(P,w,C)-k)?l.max(0,P-1):P+1,E=t.tukey.cdf(N,w,C)-k,B=1;B<50;B++){var U=N-E*(N-P)/(E-X),X=E,P=N;if(U<0&&(U=0,E=-k),E=t.tukey.cdf(U,w,C)-k,N=U,l.abs(N-P)<1e-4)return U}throw new Error("tukey.inv failed to converge")}}),o=x,a=Math,f=Array.prototype.push,m=o.utils.isArray,o.extend({add:function(k,w){return I(w)?(I(w[0])||(w=[w]),o.map(k,function(C,T,z){return C+w[T][z]})):o.map(k,function(C){return C+w})},subtract:function(k,w){return I(w)?(I(w[0])||(w=[w]),o.map(k,function(C,T,z){return C-w[T][z]||0})):o.map(k,function(C){return C-w})},divide:function(k,w){return I(w)?(I(w[0])||(w=[w]),o.multiply(k,o.inv(w))):o.map(k,function(C){return C/w})},multiply:function(k,w){var C,T,z,A,M,P,N,E;if(k.length===void 0&&w.length===void 0)return k*w;if(M=k.length,P=k[0].length,N=o.zeros(M,z=I(w)?w[0].length:P),E=0,I(w)){for(;E<z;E++)for(C=0;C<M;C++){for(T=A=0;T<P;T++)A+=k[C][T]*w[T][E];N[C][E]=A}return M===1&&E===1?N[0][0]:N}return o.map(k,function(B){return B*w})},outer:function(k,w){return o.multiply(k.map(function(C){return[C]}),[w])},dot:function(k,w){I(k[0])||(k=[k]),I(w[0])||(w=[w]);for(var C,T,z=k[0].length===1&&k.length!==1?o.transpose(k):k,A=w[0].length===1&&w.length!==1?o.transpose(w):w,M=[],P=0,N=z.length,E=z[0].length;P<N;P++){for(M[P]=[],T=C=0;T<E;T++)C+=z[P][T]*A[P][T];M[P]=C}return M.length===1?M[0]:M},pow:function(k,w){return o.map(k,function(C){return a.pow(C,w)})},exp:function(k){return o.map(k,function(w){return a.exp(w)})},log:function(k){return o.map(k,function(w){return a.log(w)})},abs:function(k){return o.map(k,function(w){return a.abs(w)})},norm:function(k,w){var C=0,T=0;for(isNaN(w)&&(w=2),I(k[0])&&(k=k[0]);T<k.length;T++)C+=a.pow(a.abs(k[T]),w);return a.pow(C,1/w)},angle:function(k,w){return a.acos(o.dot(k,w)/(o.norm(k)*o.norm(w)))},aug:function(k,w){for(var C=[],T=0;T<k.length;T++)C.push(k[T].slice());for(T=0;T<C.length;T++)f.apply(C[T],w[T]);return C},inv:function(k){for(var w,C=k.length,T=k[0].length,z=o.identity(C,T),A=o.gauss_jordan(k,z),M=[],P=0;P<C;P++)for(M[P]=[],w=T;w<A[0].length;w++)M[P][w-T]=A[P][w];return M},det:function(k){var w,C=k.length,T=2*C,z=new Array(T),A=C-1,M=T-1,P=A-C+1,N=M,E=0,B=0;if(C===2)return k[0][0]*k[1][1]-k[0][1]*k[1][0];for(;E<T;E++)z[E]=1;for(E=0;E<C;E++){for(w=0;w<C;w++)z[P<0?P+C:P]*=k[E][w],z[N<C?N+C:N]*=k[E][w],P++,N--;P=--A-C+1,N=--M}for(E=0;E<C;E++)B+=z[E];for(;E<T;E++)B-=z[E];return B},gauss_elimination:function(k,w){for(var C,T,z,A,M=0,P=0,N=k.length,E=k[0].length,B=0,U=[],X=(k=o.aug(k,w))[0].length,M=0;M<N;M++){for(T=k[M][M],A=(P=M)+1;A<E;A++)T<a.abs(k[A][M])&&(T=k[A][M],P=A);if(P!=M)for(A=0;A<X;A++)z=k[M][A],k[M][A]=k[P][A],k[P][A]=z;for(P=M+1;P<N;P++)for(C=k[P][M]/k[M][M],A=M;A<X;A++)k[P][A]=k[P][A]-C*k[M][A]}for(M=N-1;0<=M;M--){for(B=0,P=M+1;P<=N-1;P++)B+=U[P]*k[M][P];U[M]=(k[M][X-1]-B)/k[M][M]}return U},gauss_jordan:function(k,w){for(var C,T=o.aug(k,w),z=T.length,A=T[0].length,M=0,P=0;P<z;P++){for(var N=P,E=P+1;E<z;E++)a.abs(T[E][P])>a.abs(T[N][P])&&(N=E);var B=T[P];for(T[P]=T[N],T[N]=B,E=P+1;E<z;E++)for(M=T[E][P]/T[P][P],C=P;C<A;C++)T[E][C]-=T[P][C]*M}for(P=z-1;0<=P;P--){for(M=T[P][P],E=0;E<P;E++)for(C=A-1;P-1<C;C--)T[E][C]-=T[P][C]*T[E][P]/M;for(T[P][P]/=M,C=z;C<A;C++)T[P][C]/=M}return T},triaUpSolve:function(k,w){var C,T=k[0].length,z=o.zeros(1,T)[0],A=!1;return w[0].length!=null&&(w=w.map(function(M){return M[0]}),A=!0),o.arange(T-1,-1,-1).forEach(function(M){C=o.arange(M+1,T).map(function(P){return z[P]*k[M][P]}),z[M]=(w[M]-o.sum(C))/k[M][M]}),A?z.map(function(M){return[M]}):z},triaLowSolve:function(k,w){var C,T=k[0].length,z=o.zeros(1,T)[0],A=!1;return w[0].length!=null&&(w=w.map(function(M){return M[0]}),A=!0),o.arange(T).forEach(function(M){C=o.arange(M).map(function(P){return k[M][P]*z[P]}),z[M]=(w[M]-o.sum(C))/k[M][M]}),A?z.map(function(M){return[M]}):z},lu:function(k){var w,C=k.length,T=o.identity(C),z=o.zeros(k.length,k[0].length);return o.arange(C).forEach(function(A){z[0][A]=k[0][A]}),o.arange(1,C).forEach(function(A){o.arange(A).forEach(function(M){w=o.arange(M).map(function(P){return T[A][P]*z[P][M]}),T[A][M]=(k[A][M]-o.sum(w))/z[M][M]}),o.arange(A,C).forEach(function(M){w=o.arange(A).map(function(P){return T[A][P]*z[P][M]}),z[A][M]=k[w.length][M]-o.sum(w)})}),[T,z]},cholesky:function(k){var w,C=k.length,T=o.zeros(k.length,k[0].length);return o.arange(C).forEach(function(z){w=o.arange(z).map(function(A){return a.pow(T[z][A],2)}),T[z][z]=a.sqrt(k[z][z]-o.sum(w)),o.arange(z+1,C).forEach(function(A){w=o.arange(z).map(function(M){return T[z][M]*T[A][M]}),T[A][z]=(k[z][A]-o.sum(w))/T[z][z]})}),T},gauss_jacobi:function(k,w,C,T){for(var z,A,M,P,N=0,E=0,B=k.length,U=[],X=[],le=[];N<B;N++)for(U[N]=[],X[N]=[],le[N]=[],E=0;E<B;E++)E<N?(U[N][E]=k[N][E],X[N][E]=le[N][E]=0):N<E?(X[N][E]=k[N][E],U[N][E]=le[N][E]=0):(le[N][E]=k[N][E],U[N][E]=X[N][E]=0);for(M=o.multiply(o.multiply(o.inv(le),o.add(U,X)),-1),A=o.multiply(o.inv(le),w),z=C,P=o.add(o.multiply(M,C),A),N=2;a.abs(o.norm(o.subtract(P,z)))>T;)z=P,P=o.add(o.multiply(M,z),A),N++;return P},gauss_seidel:function(k,w,C,T){for(var z,A,M,P,N,E=0,B=k.length,U=[],X=[],le=[];E<B;E++)for(U[E]=[],X[E]=[],le[E]=[],z=0;z<B;z++)z<E?(U[E][z]=k[E][z],X[E][z]=le[E][z]=0):E<z?(X[E][z]=k[E][z],U[E][z]=le[E][z]=0):(le[E][z]=k[E][z],U[E][z]=X[E][z]=0);for(P=o.multiply(o.multiply(o.inv(o.add(le,U)),X),-1),M=o.multiply(o.inv(o.add(le,U)),w),A=C,N=o.add(o.multiply(P,C),M),E=2;a.abs(o.norm(o.subtract(N,A)))>T;)A=N,N=o.add(o.multiply(P,A),M),E+=1;return N},SOR:function(k,w,C,T,z){for(var A,M,P,N,E,B=0,U=k.length,X=[],le=[],he=[];B<U;B++)for(X[B]=[],le[B]=[],he[B]=[],A=0;A<U;A++)A<B?(X[B][A]=k[B][A],le[B][A]=he[B][A]=0):B<A?(le[B][A]=k[B][A],X[B][A]=he[B][A]=0):(he[B][A]=k[B][A],X[B][A]=le[B][A]=0);for(N=o.multiply(o.inv(o.add(he,o.multiply(X,z))),o.subtract(o.multiply(he,1-z),o.multiply(le,z))),P=o.multiply(o.multiply(o.inv(o.add(he,o.multiply(X,z))),w),z),M=C,E=o.add(o.multiply(N,C),P),B=2;a.abs(o.norm(o.subtract(E,M)))>T;)M=E,E=o.add(o.multiply(N,M),P),B++;return E},householder:function(k){for(var w,C,T,z,A,M=k.length,P=k[0].length,N=0,E=[];N<M-1;N++){for(C=0,A=N+1;A<P;A++)C+=k[A][N]*k[A][N];for(C=(0<k[N+1][N]?-1:1)*a.sqrt(C),T=a.sqrt((C*C-k[N+1][N]*C)/2),(E=o.zeros(M,1))[N+1][0]=(k[N+1][N]-C)/(2*T),z=N+2;z<M;z++)E[z][0]=k[z][N]/(2*T);w=o.subtract(o.identity(M,P),o.multiply(o.multiply(E,o.transpose(E)),2)),k=o.multiply(w,o.multiply(k,w))}return k},QR:(s=o.sum,u=o.arange,function(k){var w,C,T,z=k.length,A=k[0].length,M=o.zeros(A,A);for(k=o.copy(k),C=0;C<A;C++){for(M[C][C]=a.sqrt(s(u(z).map(function(P){return k[P][C]*k[P][C]}))),w=0;w<z;w++)k[w][C]=k[w][C]/M[C][C];for(T=C+1;T<A;T++)for(M[C][T]=s(u(z).map(function(P){return k[P][C]*k[P][T]})),w=0;w<z;w++)k[w][T]=k[w][T]-k[w][C]*M[C][T]}return[k,M]}),lstsq:function(k,w){var C=!1;w[0].length===void 0&&(w=w.map(function(P){return[P]}),C=!0);var T,z,A=(M=o.QR(k))[0],M=M[1],k=k[0].length,A=o.slice(A,{col:{end:k}}),k=o.slice(M,{row:{end:k}}),k=(T=k,k=(T=o.copy(T)).length,z=o.identity(k),o.arange(k-1,-1,-1).forEach(function(P){o.sliceAssign(z,{row:P},o.divide(o.slice(z,{row:P}),T[P][P])),o.sliceAssign(T,{row:P},o.divide(o.slice(T,{row:P}),T[P][P])),o.arange(P).forEach(function(N){var E=o.multiply(T[N][P],-1),B=o.slice(T,{row:N}),U=o.multiply(o.slice(T,{row:P}),E);o.sliceAssign(T,{row:N},o.add(B,U)),U=o.slice(z,{row:N}),E=o.multiply(o.slice(z,{row:P}),E),o.sliceAssign(z,{row:N},o.add(U,E))})}),z);return(A=o.transpose(A))[0].length===void 0&&(A=[A]),(w=o.multiply(o.multiply(k,A),w)).length===void 0&&(w=[[w]]),C?w.map(function(P){return P[0]}):w},jacobi:function(k){for(var w,C,T,z,A,M,P,N=1,E=k.length,B=o.identity(E,E),U=[];N===1;){for(A=k[0][1],z=1,w=T=0;w<E;w++)for(C=0;C<E;C++)w!=C&&A<a.abs(k[w][C])&&(A=a.abs(k[w][C]),T=w,z=C);for(M=k[T][T]===k[z][z]?0<k[T][z]?a.PI/4:-a.PI/4:a.atan(2*k[T][z]/(k[T][T]-k[z][z]))/2,(P=o.identity(E,E))[T][T]=a.cos(M),P[T][z]=-a.sin(M),P[z][T]=a.sin(M),P[z][z]=a.cos(M),B=o.multiply(B,P),k=o.multiply(o.multiply(o.inv(P),k),P),N=0,w=1;w<E;w++)for(C=1;C<E;C++)w!=C&&.001<a.abs(k[w][C])&&(N=1)}for(w=0;w<E;w++)U.push(k[w][w]);return[B,U]},rungekutta:function(k,w,C,T,z,A){var M,P,N;if(A===2)for(;T<=C;)z=z+((M=w*k(T,z))+(P=w*k(T+w,z+M)))/2,T+=w;if(A===4)for(;T<=C;)z=z+((M=w*k(T,z))+2*(P=w*k(T+w/2,z+M/2))+2*(N=w*k(T+w/2,z+P/2))+w*k(T+w,z+N))/6,T+=w;return z},romberg:function(k,w,C,T){for(var z,A,M,P,N,E=0,B=(C-w)/2,U=[],X=[],le=[];E<T/2;){for(N=k(w),M=w,P=0;M<=C;M+=B,P++)U[P]=M;for(z=U.length,M=1;M<z-1;M++)N+=(M%2!=0?4:2)*k(U[M]);N=B/3*(N+k(C)),le[E]=N,B/=2,E++}for(A=le.length,z=1;A!==1;){for(M=0;M<A-1;M++)X[M]=(a.pow(4,z)*le[M+1]-le[M])/(a.pow(4,z)-1);A=X.length,le=X,X=[],z++}return le},richardson:function(k,w,C,T){function z(he,Z){for(var ae,J=0,pe=he.length;J<pe;J++)he[J]===Z&&(ae=J);return ae}for(var A,M,P,N,E,B=a.abs(C-k[z(k,C)+1]),U=0,X=[],le=[];B<=T;)A=z(k,C+T),M=z(k,C),X[U]=(w[A]-2*w[M]+w[2*M-A])/(T*T),T/=2,U++;for(N=X.length,P=1;N!=1;){for(E=0;E<N-1;E++)le[E]=(a.pow(4,P)*X[E+1]-X[E])/(a.pow(4,P)-1);N=le.length,X=le,le=[],P++}return X},simpson:function(k,w,C,T){for(var z,A=(C-w)/T,M=k(w),P=[],N=w,E=0,B=1;N<=C;N+=A,E++)P[E]=N;for(z=P.length;B<z-1;B++)M+=(B%2!=0?4:2)*k(P[B]);return A/3*(M+k(C))},hermite:function(k,w,C,T){for(var z,A=k.length,M=0,P=0,N=[],E=[],B=[],U=[];P<A;P++){for(N[P]=1,z=0;z<A;z++)P!=z&&(N[P]*=(T-k[z])/(k[P]-k[z]));for(z=E[P]=0;z<A;z++)P!=z&&(E[P]+=1/(k[P]-k[z]));B[P]=(1-2*(T-k[P])*E[P])*(N[P]*N[P]),U[P]=(T-k[P])*(N[P]*N[P]),M+=B[P]*w[P]+U[P]*C[P]}return M},lagrange:function(k,w,C){for(var T,z,A=0,M=0,P=k.length;M<P;M++){for(z=w[M],T=0;T<P;T++)M!=T&&(z*=(C-k[T])/(k[M]-k[T]));A+=z}return A},cubic_spline:function(k,w,C){for(var T,z,A=k.length,M=0,P=[],N=[],E=[],B=[],U=[],X=[];M<A-1;M++)B[M]=k[M+1]-k[M];for(E[0]=0,M=1;M<A-1;M++)E[M]=3/B[M]*(w[M+1]-w[M])-3/B[M-1]*(w[M]-w[M-1]);for(M=1;M<A-1;M++)P[M]=[],N[M]=[],P[M][M-1]=B[M-1],P[M][M]=2*(B[M-1]+B[M]),P[M][M+1]=B[M],N[M][0]=E[M];for(z=o.multiply(o.inv(P),N),T=0;T<A-1;T++)U[T]=(w[T+1]-w[T])/B[T]-B[T]*(z[T+1][0]+2*z[T][0])/3,X[T]=(z[T+1][0]-z[T][0])/(3*B[T]);for(T=0;T<A&&!(k[T]>C);T++);return w[--T]+(C-k[T])*U[T]+o.sq(C-k[T])*z[T]+(C-k[T])*o.sq(C-k[T])*X[T]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(k){for(var w,C,T,z,A,M,P=k.length,N=k[0].length,E=0,B=[],U=[],X=[],le=[],he=[],Z=[],E=0;E<P;E++)B[E]=o.sum(k[E])/N;for(E=0;E<N;E++)for(le[E]=[],w=0;w<P;w++)le[E][w]=k[w][E]-B[w];for(le=o.transpose(le),E=0;E<P;E++)for(he[E]=[],w=0;w<P;w++)he[E][w]=o.dot([le[E]],[le[w]])/(N-1);for(M=(T=o.jacobi(he))[0],U=T[1],Z=o.transpose(M),E=0;E<U.length;E++)for(w=E;w<U.length;w++)U[E]<U[w]&&(C=U[E],U[E]=U[w],U[w]=C,z=Z[E],Z[E]=Z[w],Z[w]=z);for(A=o.transpose(le),E=0;E<P;E++)for(X[E]=[],w=0;w<A.length;w++)X[E][w]=o.dot([Z[E]],[A[w]]);return[k,U,Z,X]}}),function(k){for(var w=0;w<k.length;w++)(function(C){o.fn[C]=function(T,z){var A=this;return z?(setTimeout(function(){z.call(A,o.fn[C].call(A,T))},15),this):typeof o[C](this,T)=="number"?o[C](this,T):o(o[C](this,T))}})(k[w])}("add divide multiply subtract dot pow exp log abs norm angle".split(" ")),d=x,g=Math,b=[].slice,y=d.utils.isNumber,p=d.utils.isArray,d.extend({zscore:function(){var k=b.call(arguments);return y(k[1])?(k[0]-k[1])/k[2]:(k[0]-d.mean(k[1]))/d.stdev(k[1],k[2])},ztest:function(){var k,w=b.call(arguments);return p(w[1])?(k=d.zscore(w[0],w[1],w[3]),w[2]===1?d.normal.cdf(-g.abs(k),0,1):2*d.normal.cdf(-g.abs(k),0,1)):2<w.length?(k=d.zscore(w[0],w[1],w[2]),w[3]===1?d.normal.cdf(-g.abs(k),0,1):2*d.normal.cdf(-g.abs(k),0,1)):(k=w[0],w[1]===1?d.normal.cdf(-g.abs(k),0,1):2*d.normal.cdf(-g.abs(k),0,1))}}),d.extend(d.fn,{zscore:function(k,w){return(k-this.mean())/this.stdev(w)},ztest:function(k,w,C){return C=g.abs(this.zscore(k,C)),w===1?d.normal.cdf(-C,0,1):2*d.normal.cdf(-C,0,1)}}),d.extend({tscore:function(){var k=b.call(arguments);return k.length===4?(k[0]-k[1])/(k[2]/g.sqrt(k[3])):(k[0]-d.mean(k[1]))/(d.stdev(k[1],!0)/g.sqrt(k[1].length))},ttest:function(){var k,w=b.call(arguments);return w.length===5?(k=g.abs(d.tscore(w[0],w[1],w[2],w[3])),w[4]===1?d.studentt.cdf(-k,w[3]-1):2*d.studentt.cdf(-k,w[3]-1)):y(w[1])?(k=g.abs(w[0]),w[2]==1?d.studentt.cdf(-k,w[1]-1):2*d.studentt.cdf(-k,w[1]-1)):(k=g.abs(d.tscore(w[0],w[1])),w[2]==1?d.studentt.cdf(-k,w[1].length-1):2*d.studentt.cdf(-k,w[1].length-1))}}),d.extend(d.fn,{tscore:function(k){return(k-this.mean())/(this.stdev(!0)/g.sqrt(this.cols()))},ttest:function(k,w){return w===1?1-d.studentt.cdf(g.abs(this.tscore(k)),this.cols()-1):2*d.studentt.cdf(-g.abs(this.tscore(k)),this.cols()-1)}}),d.extend({anovafscore:function(){var k,w,C,T,z,A,M,P,N=b.call(arguments);if(N.length===1){for(z=new Array(N[0].length),M=0;M<N[0].length;M++)z[M]=N[0][M];N=z}for(w=new Array,M=0;M<N.length;M++)w=w.concat(N[M]);for(C=d.mean(w),M=k=0;M<N.length;M++)k+=N[M].length*g.pow(d.mean(N[M])-C,2);for(k/=N.length-1,M=A=0;M<N.length;M++)for(T=d.mean(N[M]),P=0;P<N[M].length;P++)A+=g.pow(N[M][P]-T,2);return k/(A/=w.length-N.length)},anovaftest:function(){var k,w=b.call(arguments);if(y(w[0]))return 1-d.centralF.cdf(w[0],w[1],w[2]);for(var C=d.anovafscore(w),T=w.length-1,z=0,A=0;A<w.length;A++)z+=w[A].length;return k=z-T-1,1-d.centralF.cdf(C,T,k)},ftest:function(k,w,C){return 1-d.centralF.cdf(k,w,C)}}),d.extend(d.fn,{anovafscore:function(){return d.anovafscore(this.toArray())},anovaftes:function(){for(var k=0,w=0;w<this.length;w++)k+=this[w].length;return d.ftest(this.anovafscore(),this.length-1,k-this.length)}}),d.extend({qscore:function(){var k,w,C,T,z=b.call(arguments),z=y(z[0])?(k=z[0],w=z[1],C=z[2],T=z[3],z[4]):(k=d.mean(z[0]),w=d.mean(z[1]),C=z[0].length,T=z[1].length,z[2]);return g.abs(k-w)/(z*g.sqrt((1/C+1/T)/2))},qtest:function(){var k,w=b.call(arguments),C=(w=w.length===3?(k=w[0],w.slice(1)):w.length===7?(k=d.qscore(w[0],w[1],w[2],w[3],w[4]),w.slice(5)):(k=d.qscore(w[0],w[1],w[2]),w.slice(3)))[0],w=w[1];return 1-d.tukey.cdf(k,w,C-w)},tukeyhsd:function(k){for(var w=d.pooledstdev(k),C=k.map(function(N){return d.mean(N)}),T=k.reduce(function(N,E){return N+E.length},0),z=[],A=0;A<k.length;++A)for(var M=A+1;M<k.length;++M){var P=d.qtest(C[A],C[M],k[A].length,k[M].length,w,T,k.length);z.push([[A,M],P])}return z}}),d.extend({normalci:function(){var k=b.call(arguments),w=new Array(2),C=k.length===4?g.abs(d.normal.inv(k[1]/2,0,1)*k[2]/g.sqrt(k[3])):g.abs(d.normal.inv(k[1]/2,0,1)*d.stdev(k[2])/g.sqrt(k[2].length));return w[0]=k[0]-C,w[1]=k[0]+C,w},tci:function(){var k=b.call(arguments),w=new Array(2),C=k.length===4?g.abs(d.studentt.inv(k[1]/2,k[3]-1)*k[2]/g.sqrt(k[3])):g.abs(d.studentt.inv(k[1]/2,k[2].length-1)*d.stdev(k[2],!0)/g.sqrt(k[2].length));return w[0]=k[0]-C,w[1]=k[0]+C,w},significant:function(k,w){return k<w}}),d.extend(d.fn,{normalci:function(k,w){return d.normalci(k,w,this.toArray())},tci:function(k,w){return d.tci(k,w,this.toArray())}}),d.extend(d.fn,{oneSidedDifferenceOfProportions:function(k,w,C,T){return T=O(k,w,C,T),d.ztest(T,1)},twoSidedDifferenceOfProportions:function(k,w,C,T){return T=O(k,w,C,T),d.ztest(T,2)}}),x.models={ols:function(k,w){var C=F(k,w),T=D(C),k={F_statistic:k=(z=C).R2/z.df_model/((1-z.R2)/z.df_resid),pvalue:1-(w=k,k=z.df_model,z=z.df_resid,x.beta.cdf(w/(z/k+w),k/2,z/2))},z=1-(1-C.R2)*((C.nobs-1)/C.df_resid);return C.t=T,C.f=k,C.adjust_R2=z,C}},x.extend({buildxmatrix:function(){for(var k=new Array(arguments.length),w=0;w<arguments.length;w++)k[w]=[1].concat(arguments[w]);return x(k)},builddxmatrix:function(){for(var k=new Array(arguments[0].length),w=0;w<arguments[0].length;w++)k[w]=[1].concat(arguments[0][w]);return x(k)},buildjxmatrix:function(k){for(var w=new Array(k.length),C=0;C<k.length;C++)w[C]=k[C];return x.builddxmatrix(w)},buildymatrix:function(k){return x(k).transpose()},buildjymatrix:function(k){return k.transpose()},matrixmult:function(k,w){var C,T,z,A,M;if(k.cols()==w.rows()){if(1<w.rows()){for(A=[],C=0;C<k.rows();C++)for(A[C]=[],T=0;T<w.cols();T++){for(z=M=0;z<k.cols();z++)M+=k.toArray()[C][z]*w.toArray()[z][T];A[C][T]=M}return x(A)}for(A=[],C=0;C<k.rows();C++)for(A[C]=[],T=0;T<w.cols();T++){for(z=M=0;z<k.cols();z++)M+=k.toArray()[C][z]*w.toArray()[T];A[C][T]=M}return x(A)}},regress:function(k,w){var C=x.xtranspxinv(k),k=k.transpose(),k=x.matrixmult(x(C),k);return x.matrixmult(k,w)},regresst:function(k,w,C){var T=x.regress(k,w),z={anova:{}},A=x.jMatYBar(k,T);z.yBar=A;var M=w.mean();z.anova.residuals=x.residuals(w,A),z.anova.ssr=x.ssr(A,M),z.anova.msr=z.anova.ssr/(k[0].length-1),z.anova.sse=x.sse(w,A),z.anova.mse=z.anova.sse/(w.length-(k[0].length-1)-1),z.anova.sst=x.sst(w,M),z.anova.mst=z.anova.sst/(w.length-1),z.anova.r2=1-z.anova.sse/z.anova.sst,z.anova.r2<0&&(z.anova.r2=0),z.anova.fratio=z.anova.msr/z.anova.mse,z.anova.pvalue=x.anovaftest(z.anova.fratio,k[0].length-1,w.length-(k[0].length-1)-1),z.anova.rmse=Math.sqrt(z.anova.mse),z.anova.r2adj=1-z.anova.mse/z.anova.mst,z.anova.r2adj<0&&(z.anova.r2adj=0),z.stats=new Array(k[0].length);for(var P,N,E,B=x.xtranspxinv(k),U=0;U<T.length;U++)P=Math.sqrt(z.anova.mse*Math.abs(B[U][U])),N=Math.abs(T[U]/P),E=x.ttest(N,w.length-k[0].length-1,C),z.stats[U]=[T[U],P,N,E];return z.regress=T,z},xtranspx:function(k){return x.matrixmult(k.transpose(),k)},xtranspxinv:function(k){return k=x.matrixmult(k.transpose(),k),x.inv(k)},jMatYBar:function(k,w){return w=x.matrixmult(k,w),new x(w)},residuals:function(k,w){return x.matrixsubtract(k,w)},ssr:function(k,w){for(var C=0,T=0;T<k.length;T++)C+=Math.pow(k[T]-w,2);return C},sse:function(k,w){for(var C=0,T=0;T<k.length;T++)C+=Math.pow(k[T]-w[T],2);return C},sst:function(k,w){for(var C=0,T=0;T<k.length;T++)C+=Math.pow(k[T]-w,2);return C},matrixsubtract:function(k,w){for(var C=new Array(k.length),T=0;T<k.length;T++){C[T]=new Array(k[T].length);for(var z=0;z<k[T].length;z++)C[T][z]=k[T][z]-w[T][z]}return x(C)}}),x.jStat=x});var z_=function(e){var n={};function t(l){if(n[l])return n[l].exports;var o=n[l]={i:l,l:!1,exports:{}};return e[l].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(l,o,a){t.o(l,o)||Object.defineProperty(l,o,{enumerable:!0,get:a})},t.r=function(l){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},t.t=function(l,o){if(1&o&&(l=t(l)),8&o||4&o&&typeof l=="object"&&l&&l.__esModule)return l;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:l}),2&o&&typeof l!="string")for(var s in l)t.d(a,s,function(u){return l[u]}.bind(null,s));return a},t.n=function(l){var o=l&&l.__esModule?function(){return l.default}:function(){return l};return t.d(o,"a",o),o},t.o=function(l,o){return Object.prototype.hasOwnProperty.call(l,o)},t.p="",t(t.s=29)}([function(e,n,t){"use strict";function l(u,f){return u<<f|u>>>32-f|0}function o(u,f){return u>>>f|u<<32-f|0}function a(u,f,m){return m===32?f:32<m?a(f,u,m-32):4294967295&(u>>>m|f<<32-m)}function s(u,f,m){return m===32?u:32<m?s(f,u,m-32):4294967295&(f>>>m|u<<32-m)}t.d(n,"a",function(){return l}),t.d(n,"b",function(){return o}),t.d(n,"d",function(){return s}),t.d(n,"c",function(){return a})},function(e,n,t){"use strict";function l(o){for(var a="",s=0,u=o.length;s<u;s++){var f=o.charCodeAt(s);f<128?a+=String.fromCharCode(f):(f<2048?a+=String.fromCharCode(192|f>>6):(f<55296||57344<=f?a+=String.fromCharCode(224|f>>12):(s++,f=65536+((1023&f)<<10|1023&o.charCodeAt(s)),a+=String.fromCharCode(240|f>>18),a+=String.fromCharCode(128|f>>12&63)),a+=String.fromCharCode(128|f>>6&63)),a+=String.fromCharCode(128|63&f))}return a}t.d(n,"a",function(){return l})},function(e,n,t){"use strict";function l(o){for(var a="",s=0,u=o.length;s<u;s++)a+=(o.charCodeAt(s)<16?"0":"")+o.charCodeAt(s).toString(16);return a}t.d(n,"a",function(){return l})},function(e,n,t){"use strict";function l(u){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function o(u){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}function a(u,f){return(a=Object.setPrototypeOf||function(m,d){return m.__proto__=d,m})(u,f)}(function(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),f&&a(u,f)})(s,t(4).a),function(u,f){for(var m=0;m<f.length;m++){var d=f[m];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}(s.prototype,[{key:"process",value:function(){for(;this.state.message.length>=this.blockSizeInBytes;){this.blockUnits=[];for(var u=0;u<this.blockSizeInBytes;u+=4)this.blockUnits.push(this.state.message.charCodeAt(u)<<24|this.state.message.charCodeAt(u+1)<<16|this.state.message.charCodeAt(u+2)<<8|this.state.message.charCodeAt(u+3));this.state.message=this.state.message.substr(this.blockSizeInBytes),this.processBlock(this.blockUnits)}}},{key:"processBlock",value:function(u){}},{key:"getStateHash",value:function(u){u=u||this.state.hash.length;for(var f="",m=0;m<u;m++)f+=String.fromCharCode(this.state.hash[m]>>24&255)+String.fromCharCode(this.state.hash[m]>>16&255)+String.fromCharCode(this.state.hash[m]>>8&255)+String.fromCharCode(255&this.state.hash[m]);return f}},{key:"addLengthBits",value:function(){this.state.message+="\0\0\0"+String.fromCharCode(this.state.length>>29&255)+String.fromCharCode(this.state.length>>21&255)+String.fromCharCode(this.state.length>>13&255)+String.fromCharCode(this.state.length>>5&255)+String.fromCharCode(this.state.length<<3&255)}}]),t=s;function s(u){var f;return function(m){if(!(m instanceof s))throw new TypeError("Cannot call a class as a function")}(this),f=this,(u=!(u=o(s).call(this,u))||l(u)!=="object"&&typeof u!="function"?function(){if(f!==void 0)return f;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():u).unitOrder=1,u.blockUnits=[],u}n.a=t},function(e,n,t){"use strict";var l=(function(a,s){for(var u=0;u<s.length;u++){var f=s[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(a,f.key,f)}}(o.prototype,[{key:"reset",value:function(){this.state={},this.state.message="",this.state.length=0}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(this.state))}},{key:"setState",value:function(a){this.state=a}},{key:"update",value:function(a){this.state.message+=a,this.state.length+=a.length,this.process()}},{key:"process",value:function(){}},{key:"finalize",value:function(){return""}},{key:"getStateHash",value:function(a){return""}},{key:"addPaddingPKCS7",value:function(a){this.state.message+=new Array(a+1).join(String.fromCharCode(a))}},{key:"addPaddingISO7816",value:function(a){this.state.message+="\x80"+new Array(a).join("\0")}},{key:"addPaddingZero",value:function(a){this.state.message+=new Array(a+1).join("\0")}}]),o);function o(a){(function(s){if(!(s instanceof o))throw new TypeError("Cannot call a class as a function")})(this),this.unitSize=4,this.unitOrder=0,this.blockSize=16,this.blockSizeInBytes=this.blockSize*this.unitSize,this.options=a||{},this.reset()}n.a=l},function(e,n,t){"use strict";function l(u){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function o(u){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}function a(u,f){return(a=Object.setPrototypeOf||function(m,d){return m.__proto__=d,m})(u,f)}(function(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),f&&a(u,f)})(s,t(4).a),function(u,f){for(var m=0;m<f.length;m++){var d=f[m];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}(s.prototype,[{key:"process",value:function(){for(;this.state.message.length>=this.blockSizeInBytes;){this.blockUnits=[];for(var u=0;u<this.blockSizeInBytes;u+=4)this.blockUnits.push(this.state.message.charCodeAt(u)|this.state.message.charCodeAt(u+1)<<8|this.state.message.charCodeAt(u+2)<<16|this.state.message.charCodeAt(u+3)<<24);this.state.message=this.state.message.substr(this.blockSizeInBytes),this.processBlock(this.blockUnits)}}},{key:"processBlock",value:function(u){}},{key:"getStateHash",value:function(u){u=u||this.state.hash.length;for(var f="",m=0;m<u;m++)f+=String.fromCharCode(255&this.state.hash[m])+String.fromCharCode(this.state.hash[m]>>8&255)+String.fromCharCode(this.state.hash[m]>>16&255)+String.fromCharCode(this.state.hash[m]>>24&255);return f}},{key:"addLengthBits",value:function(){this.state.message+=String.fromCharCode(this.state.length<<3&255)+String.fromCharCode(this.state.length>>5&255)+String.fromCharCode(this.state.length>>13&255)+String.fromCharCode(this.state.length>>21&255)+String.fromCharCode(this.state.length>>29&255)+"\0\0\0"}}]),t=s;function s(u){var f;return function(m){if(!(m instanceof s))throw new TypeError("Cannot call a class as a function")}(this),f=this,(u=!(u=o(s).call(this,u))||l(u)!=="object"&&typeof u!="function"?function(){if(f!==void 0)return f;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():u).blockUnits=[],u}n.a=t},function(e,n,t){"use strict";var l=t(3),o=t(0);function a(g){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(g)}function s(g,b,y){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(p,x,_){if(p=function(S,I){for(;!Object.prototype.hasOwnProperty.call(S,I)&&(S=u(S))!==null;);return S}(p,x),p)return x=Object.getOwnPropertyDescriptor(p,x),x.get?x.get.call(_):x.value})(g,b,y||g)}function u(g){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(g)}function f(g,b){return(f=Object.setPrototypeOf||function(y,p){return y.__proto__=p,y})(g,b)}var m=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],l=(function(g,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(b&&b.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),b&&f(g,b)}(d,l.a),l=[{key:"reset",value:function(){switch(s(u(d.prototype),"reset",this).call(this),this.options.length){case 384:this.state.hash=[-876896931,-1056596264,1654270250,914150663,-1856437926,812702999,355462360,-150054599,1731405415,-4191439,-1900787065,1750603025,-619958771,1694076839,1203062813,-1090891868];break;case 512:this.state.hash=[1779033703,-205731576,-1150833019,-2067093701,1013904242,-23791573,-1521486534,1595750129,1359893119,-1377402159,-1694144372,725511199,528734635,-79577749,1541459225,327033209];break;default:for(var g=new d,b=0;b<16;b++)g.state.hash[b]=2779096485^g.state.hash[b];g.update("SHA-512/"+this.options.length);var y=g.finalize();this.state.hash=[];for(var p=0;p<64;p+=4)this.state.hash.push(y.charCodeAt(p)<<24|y.charCodeAt(p+1)<<16|y.charCodeAt(p+2)<<8|y.charCodeAt(p+3))}}},{key:"processBlock",value:function(g){for(var b,y,p,x,_=this.state.hash[0],S=this.state.hash[1],I=this.state.hash[2],O=this.state.hash[3],F=this.state.hash[4],D=this.state.hash[5],k=this.state.hash[6],w=this.state.hash[7],C=this.state.hash[8],T=this.state.hash[9],z=this.state.hash[10],A=this.state.hash[11],M=this.state.hash[12],P=this.state.hash[13],N=this.state.hash[14],E=this.state.hash[15],B=0;B<this.options.rounds;B+=2){B<32?(this.W[B]=g[B],this.W[B+1]=g[B+1]):(b=Object(o.c)(this.W[B-30],this.W[B-29],1)^Object(o.c)(this.W[B-30],this.W[B-29],8)^this.W[B-30]>>>7,y=Object(o.d)(this.W[B-30],this.W[B-29],1)^Object(o.d)(this.W[B-30],this.W[B-29],8)^(this.W[B-29]>>>7|this.W[B-30]<<25),p=Object(o.c)(this.W[B-4],this.W[B-3],19)^Object(o.c)(this.W[B-4],this.W[B-3],61)^this.W[B-4]>>>6,x=Object(o.d)(this.W[B-4],this.W[B-3],19)^Object(o.d)(this.W[B-4],this.W[B-3],61)^(this.W[B-3]>>>6|this.W[B-4]<<26),he=(65535&this.W[B-13])+(65535&this.W[B-31])+(65535&y)+(65535&x)|0,Z=(this.W[B-13]>>>16)+(this.W[B-31]>>>16)+(y>>>16)+(x>>>16)+(he>>>16)|0,le=(65535&this.W[B-14])+(65535&this.W[B-32])+(65535&b)+(65535&p)+(Z>>>16)|0,X=(this.W[B-14]>>>16)+(this.W[B-32]>>>16)+(b>>>16)+(p>>>16)+(le>>>16)|0,this.W[B]=4294967295&(X<<16|65535&le),this.W[B+1]=4294967295&(Z<<16|65535&he)),b=Object(o.c)(_,S,28)^Object(o.c)(_,S,34)^Object(o.c)(_,S,39),y=Object(o.d)(_,S,28)^Object(o.d)(_,S,34)^Object(o.d)(_,S,39);var U=T&A^~T&P,X=_&I^_&F^I&F,le=S&O^S&D^O&D,he=(he=(he=N+(p=Object(o.c)(C,T,14)^Object(o.c)(C,T,18)^Object(o.c)(C,T,41))+((Z=E+(x=Object(o.d)(C,T,14)^Object(o.d)(C,T,18)^Object(o.d)(C,T,41))|0)>>>0<E>>>0?1:0)|0)+(C&z^~C&M)+((Z=Z+U|0)>>>0<U>>>0?1:0)|0)+m[B]+((Z=Z+m[B+1]|0)>>>0<m[B+1]>>>0?1:0)|0,Z=Z+this.W[B+1]|0,le=y+le|0,N=M,E=P,M=z,P=A,z=C,A=T,C=k+(he=he+this.W[B]+(Z>>>0<this.W[B+1]>>>0?1:0)|0)+((T=w+Z|0)>>>0<w>>>0?1:0)|0,k=F,w=D,F=I,D=O,I=_,O=S,_=he+(b+X+(le>>>0<y>>>0?1:0)|0)+((S=Z+le|0)>>>0<Z>>>0?1:0)|0}this.state.hash[1]=this.state.hash[1]+S|0,this.state.hash[0]=this.state.hash[0]+_+(this.state.hash[1]>>>0<S>>>0?1:0)|0,this.state.hash[3]=this.state.hash[3]+O|0,this.state.hash[2]=this.state.hash[2]+I+(this.state.hash[3]>>>0<O>>>0?1:0)|0,this.state.hash[5]=this.state.hash[5]+D|0,this.state.hash[4]=this.state.hash[4]+F+(this.state.hash[5]>>>0<D>>>0?1:0)|0,this.state.hash[7]=this.state.hash[7]+w|0,this.state.hash[6]=this.state.hash[6]+k+(this.state.hash[7]>>>0<w>>>0?1:0)|0,this.state.hash[9]=this.state.hash[9]+T|0,this.state.hash[8]=this.state.hash[8]+C+(this.state.hash[9]>>>0<T>>>0?1:0)|0,this.state.hash[11]=this.state.hash[11]+A|0,this.state.hash[10]=this.state.hash[10]+z+(this.state.hash[11]>>>0<A>>>0?1:0)|0,this.state.hash[13]=this.state.hash[13]+P|0,this.state.hash[12]=this.state.hash[12]+M+(this.state.hash[13]>>>0<P>>>0?1:0)|0,this.state.hash[15]=this.state.hash[15]+E|0,this.state.hash[14]=this.state.hash[14]+N+(this.state.hash[15]>>>0<E>>>0?1:0)|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<112?112-this.state.message.length|0:240-this.state.message.length|0),this.state.message+="\0\0\0\0\0\0\0\0",this.addLengthBits(),this.process(),this.getStateHash(this.options.length/32|0)}}],function(g,b){for(var y=0;y<b.length;y++){var p=b[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(g,p.key,p)}}(d.prototype,l),d);function d(g){var b;return function(y){if(!(y instanceof d))throw new TypeError("Cannot call a class as a function")}(this),(g=g||{}).length=g.length||512,g.rounds=g.rounds||160,b=this,(g=!(g=u(d).call(this,g))||a(g)!=="object"&&typeof g!="function"?function(){if(b!==void 0)return b;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():g).blockSize=32,g.blockSizeInBytes=g.blockSize*g.unitSize,g.W=new Array(160),g}n.a=l},function(e,n,t){"use strict";var l=t(3),o=t(0);function a(g){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(g)}function s(g,b,y){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(p,x,_){if(p=function(S,I){for(;!Object.prototype.hasOwnProperty.call(S,I)&&(S=u(S))!==null;);return S}(p,x),p)return x=Object.getOwnPropertyDescriptor(p,x),x.get?x.get.call(_):x.value})(g,b,y||g)}function u(g){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(g)}function f(g,b){return(f=Object.setPrototypeOf||function(y,p){return y.__proto__=p,y})(g,b)}var m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=(function(g,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(b&&b.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),b&&f(g,b)}(d,l.a),function(g,b){for(var y=0;y<b.length;y++){var p=b[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(g,p.key,p)}}(d.prototype,[{key:"reset",value:function(){s(u(d.prototype),"reset",this).call(this),this.options.length===224?this.state.hash=[-1056596264,914150663,812702999,-150054599,-4191439,1750603025,1694076839,-1090891868]:this.state.hash=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225]}},{key:"processBlock",value:function(g){for(var b=0|this.state.hash[0],y=0|this.state.hash[1],p=0|this.state.hash[2],x=0|this.state.hash[3],_=0|this.state.hash[4],S=0|this.state.hash[5],I=0|this.state.hash[6],O=0|this.state.hash[7],F=0;F<this.options.rounds;F++){this.W[F]=F<16?0|g[F]:this.W[F-16]+(Object(o.b)(this.W[F-15],7)^Object(o.b)(this.W[F-15],18)^this.W[F-15]>>>3)+this.W[F-7]+(Object(o.b)(this.W[F-2],17)^Object(o.b)(this.W[F-2],19)^this.W[F-2]>>>10)|0;var D=O+(Object(o.b)(_,6)^Object(o.b)(_,11)^Object(o.b)(_,25))+(_&S^~_&I)+m[F]+this.W[F]|0,k=(Object(o.b)(b,2)^Object(o.b)(b,13)^Object(o.b)(b,22))+(b&y^b&p^y&p)|0,O=I,I=S,S=_,_=x+D|0,x=p,p=y,y=b,b=D+k|0}this.state.hash[0]=this.state.hash[0]+b|0,this.state.hash[1]=this.state.hash[1]+y|0,this.state.hash[2]=this.state.hash[2]+p|0,this.state.hash[3]=this.state.hash[3]+x|0,this.state.hash[4]=this.state.hash[4]+_|0,this.state.hash[5]=this.state.hash[5]+S|0,this.state.hash[6]=this.state.hash[6]+I|0,this.state.hash[7]=this.state.hash[7]+O|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash(this.options.length/32|0)}}]),d);function d(g){var b;return function(y){if(!(y instanceof d))throw new TypeError("Cannot call a class as a function")}(this),(g=g||{}).length=g.length||256,g.rounds=g.rounds||64,b=this,(g=!(g=u(d).call(this,g))||a(g)!=="object"&&typeof g!="function"?function(){if(b!==void 0)return b;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():g).W=new Array(64),g}n.a=l},function(e,n,t){"use strict";var l=t(5),o=t(0);function a(x){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(x)}function s(x,_){for(var S=0;S<_.length;S++){var I=_[S];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(x,I.key,I)}}function u(x,_,S){return(u=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(I,O,F){if(I=function(D,k){for(;!Object.prototype.hasOwnProperty.call(D,k)&&(D=f(D))!==null;);return D}(I,O),I)return O=Object.getOwnPropertyDescriptor(I,O),O.get?O.get.call(F):O.value})(x,_,S||x)}function f(x){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(_){return _.__proto__||Object.getPrototypeOf(_)})(x)}function m(x,_){return(m=Object.setPrototypeOf||function(S,I){return S.__proto__=I,S})(x,_)}var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],g=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],y=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],t=(function(x,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");x.prototype=Object.create(_&&_.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),_&&m(x,_)}(p,l.a),t=[{key:"F",value:function(x,_,S){return x^_^S}},{key:"G",value:function(x,_,S){return x&_|~x&S}},{key:"H",value:function(x,_,S){return(x|~_)^S}},{key:"I",value:function(x,_,S){return x&S|_&~S}},{key:"J",value:function(x,_,S){return x^(_|~S)}},{key:"T",value:function(x,_,S,I){return x<16?this.F(_,S,I):x<32?this.G(_,S,I)+1518500249|0:x<48?this.H(_,S,I)+1859775393|0:x<64?this.I(_,S,I)+2400959708|0:this.J(_,S,I)+2840853838|0}},{key:"T64",value:function(x,_,S,I){return x<16?this.I(_,S,I)+1352829926|0:x<32?this.H(_,S,I)+1548603684|0:x<48?this.G(_,S,I)+1836072691|0:this.F(_,S,I)}},{key:"T80",value:function(x,_,S,I){return x<16?this.J(_,S,I)+1352829926|0:x<32?this.I(_,S,I)+1548603684|0:x<48?this.H(_,S,I)+1836072691|0:x<64?this.G(_,S,I)+2053994217|0:this.F(_,S,I)}}],s((l=p).prototype,[{key:"reset",value:function(){switch(u(f(p.prototype),"reset",this).call(this),this.options.length){case 128:this.state.hash=[1732584193,4023233417,2562383102,271733878],this.processBlock=this.processBlock128;break;case 256:this.state.hash=[1732584193,4023233417,2562383102,271733878,1985229328,4275878552,2309737967,19088743],this.processBlock=this.processBlock256;break;case 320:this.state.hash=[1732584193,4023233417,2562383102,271733878,3285377520,1985229328,4275878552,2309737967,19088743,1009589775],this.processBlock=this.processBlock320;break;default:this.state.hash=[1732584193,4023233417,2562383102,271733878,3285377520],this.processBlock=this.processBlock160}}},{key:"processBlock128",value:function(x){for(var _=k=0|this.state.hash[0],S=T=0|this.state.hash[1],I=C=0|this.state.hash[2],O=w=0|this.state.hash[3],F=0;F<64;F++){var D=(D=k+x[d[F]]|0)+p.T(F,T,C,w)|0,k=w,w=C,C=T,T=D=Object(o.a)(D,b[F]);D=(D=_+x[g[F]]|0)+p.T64(F,S,I,O)|0,_=O,O=I,I=S,S=D=Object(o.a)(D,y[F])}var z=this.state.hash[1]+C+O|0;this.state.hash[1]=this.state.hash[2]+w+_|0,this.state.hash[2]=this.state.hash[3]+k+S|0,this.state.hash[3]=this.state.hash[0]+T+I|0,this.state.hash[0]=z}},{key:"processBlock160",value:function(x){for(var _=0|this.state.hash[0],S=0|this.state.hash[1],I=0|this.state.hash[2],O=0|this.state.hash[3],F=0|this.state.hash[4],D=_,k=S,w=I,C=O,T=F,z=0;z<80;z++){var A=(A=_+x[d[z]]|0)+p.T(z,S,I,O)|0;A=(A=Object(o.a)(A,b[z]))+F|0,_=F,F=O,O=Object(o.a)(I,10),I=S,S=A,A=(A=D+x[g[z]]|0)+p.T80(z,k,w,C)|0,A=(A=Object(o.a)(A,y[z]))+T|0,D=T,T=C,C=Object(o.a)(w,10),w=k,k=A}var M=this.state.hash[1]+I+C|0;this.state.hash[1]=this.state.hash[2]+O+T|0,this.state.hash[2]=this.state.hash[3]+F+D|0,this.state.hash[3]=this.state.hash[4]+_+k|0,this.state.hash[4]=this.state.hash[0]+S+w|0,this.state.hash[0]=M}},{key:"processBlock256",value:function(x){for(var _=0|this.state.hash[0],S=0|this.state.hash[1],I=0|this.state.hash[2],O=0|this.state.hash[3],F=0|this.state.hash[4],D=0|this.state.hash[5],k=0|this.state.hash[6],w=0|this.state.hash[7],C=0;C<64;C+=1){var T=(T=_+x[d[C]]|0)+p.T(C,S,I,O)|0,_=O,O=I,I=S,S=T=Object(o.a)(T,b[C]);switch(T=(T=F+x[g[C]]|0)+p.T64(C,D,k,w)|0,F=w,w=k,k=D,D=T=Object(o.a)(T,y[C]),C){case 15:T=_,_=F,F=T;break;case 31:T=S,S=D,D=T;break;case 47:T=I,I=k,k=T;break;case 63:T=O,O=w,w=T}}this.state.hash[0]=this.state.hash[0]+_|0,this.state.hash[1]=this.state.hash[1]+S|0,this.state.hash[2]=this.state.hash[2]+I|0,this.state.hash[3]=this.state.hash[3]+O|0,this.state.hash[4]=this.state.hash[4]+F|0,this.state.hash[5]=this.state.hash[5]+D|0,this.state.hash[6]=this.state.hash[6]+k|0,this.state.hash[7]=this.state.hash[7]+w|0}},{key:"processBlock320",value:function(x){for(var _=0|this.state.hash[0],S=0|this.state.hash[1],I=0|this.state.hash[2],O=0|this.state.hash[3],F=0|this.state.hash[4],D=0|this.state.hash[5],k=0|this.state.hash[6],w=0|this.state.hash[7],C=0|this.state.hash[8],T=0|this.state.hash[9],z=0;z<80;z+=1){var A=(A=_+x[d[z]]|0)+p.T(z,S,I,O)|0;switch(A=(A=Object(o.a)(A,b[z]))+F|0,_=F,F=O,O=Object(o.a)(I,10),I=S,S=A,A=(A=D+x[g[z]]|0)+p.T80(z,k,w,C)|0,A=(A=Object(o.a)(A,y[z]))+T|0,D=T,T=C,C=Object(o.a)(w,10),w=k,k=A,z){case 15:A=S,S=k,k=A;break;case 31:A=O,O=C,C=A;break;case 47:A=_,_=D,D=A;break;case 63:A=I,I=w,w=A;break;case 79:A=F,F=T,T=A}}this.state.hash[0]=this.state.hash[0]+_|0,this.state.hash[1]=this.state.hash[1]+S|0,this.state.hash[2]=this.state.hash[2]+I|0,this.state.hash[3]=this.state.hash[3]+O|0,this.state.hash[4]=this.state.hash[4]+F|0,this.state.hash[5]=this.state.hash[5]+D|0,this.state.hash[6]=this.state.hash[6]+k|0,this.state.hash[7]=this.state.hash[7]+w|0,this.state.hash[8]=this.state.hash[8]+C|0,this.state.hash[9]=this.state.hash[9]+T|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),s(l,t),p);function p(x){return function(S){if(!(S instanceof p))throw new TypeError("Cannot call a class as a function")}(this),(x=x||{}).length=x.length||160,_=this,!(x=f(p).call(this,x))||a(x)!=="object"&&typeof x!="function"?function(){if(_!==void 0)return _;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():x;var _}n.a=t},function(e,n,t){"use strict";var l=t(3),o=t(0);function a(x){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(x)}function s(x,_,S){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(I,O,F){if(I=function(D,k){for(;!Object.prototype.hasOwnProperty.call(D,k)&&(D=u(D))!==null;);return D}(I,O),I)return O=Object.getOwnPropertyDescriptor(I,O),O.get?O.get.call(F):O.value})(x,_,S||x)}function u(x){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(_){return _.__proto__||Object.getPrototypeOf(_)})(x)}function f(x,_){return(f=Object.setPrototypeOf||function(S,I){return S.__proto__=I,S})(x,_)}var m=[10097,32533,76520,13586,34673,54876,80959,9117,39292,74945,37542,4805,64894,74296,24805,24037,20636,10402,822,91665,8422,68953,19645,9303,23209,2560,15953,34764,35080,33606,99019,2529,9376,70715,38311,31165,88676,74397,4436,27659,12807,99970,80157,36147,64032,36653,98951,16877,12171,76833,66065,74717,34072,76850,36697,36170,65813,39885,11199,29170,31060,10805,45571,82406,35303,42614,86799,7439,23403,9732,85269,77602,2051,65692,68665,74818,73053,85247,18623,88579,63573,32135,5325,47048,90553,57548,28468,28709,83491,25624,73796,45753,3529,64778,35808,34282,60935,20344,35273,88435,98520,17767,14905,68607,22109,40558,60970,93433,50500,73998,11805,5431,39808,27732,50725,68248,29405,24201,52775,67851,83452,99634,6288,98083,13746,70078,18475,40610,68711,77817,88685,40200,86507,58401,36766,67951,90364,76493,29609,11062,99594,67348,87517,64969,91826,8928,93785,61368,23478,34113,65481,17674,17468,50950,58047,76974,73039,57186,40218,16544,80124,35635,17727,8015,45318,22374,21115,78253,14385,53763,74350,99817,77402,77214,43236,210,45521,64237,96286,2655,69916,26803,66252,29148,36936,87203,76621,13990,94400,56418,9893,20505,14225,68514,46427,56788,96297,78822,54382,14598,91499,14523,68479,27686,46162,83554,94750,89923,37089,20048,80336,94598,26940,36858,70297,34135,53140,33340,42050,82341,44104,81949,85157,47954,32979,26575,57600,40881,22222,6413,12550,73742,11100,2040,12860,74697,96644,89439,28707,25815,63606,49329,16505,34484,40219,52563,43651,77082,7207,31790,61196,90446,26457,47774,51924,33729,65394,59593,42582,60527,15474,45266,95270,79953,59367,83848,82396,10118,33211,59466,94557,28573,67897,54387,54622,44431,91190,42592,92927,45973,42481,16213,97344,8721,16868,48767,3071,12059,25701,46670,23523,78317,73208,89837,68935,91416,26252,29663,5522,82562,4493,52494,75246,33824,45862,51025,61962,79335,65337,12472,549,97654,64051,88159,96119,63896,54692,82391,23287,29529,35963,15307,26898,9354,33351,35462,77974,50024,90103,39333,59808,8391,45427,26842,83609,49700,13021,24892,78565,20106,46058,85236,1390,92286,77281,44077,93910,83647,70617,42941,32179,597,87379,25241,5567,7007,86743,17157,85394,11838,69234,61406,20117,45204,15956,6e4,18743,92423,97118,96338,19565,41430,1758,75379,40419,21585,66674,36806,84962,85207,45155,14938,19476,7246,43667,94543,59047,90033,20826,69541,94864,31994,36168,10851,34888,81553,1540,35456,5014,51176,98086,24826,45240,28404,44999,8896,39094,73407,35441,31880,33185,16232,41941,50949,89435,48581,88695,41994,37548,73043,80951,406,96382,70774,20151,23387,25016,25298,94624,61171,79752,49140,71961,28296,69861,2591,74852,20539,387,59579,18633,32537,98145,6571,31010,24674,5455,61427,77938,91936,74029,43902,77557,32270,97790,17119,52527,58021,80814,51748,54178,45611,80993,37143,5335,12969,56127,19255,36040,90324,11664,49883,52079,84827,59381,71539,9973,33440,88461,23356,48324,77928,31249,64710,2295,36870,32307,57546,15020,9994,69074,94138,87637,91976,35584,4401,10518,21615,1848,76938,9188,20097,32825,39527,4220,86304,83389,87374,64278,58044,90045,85497,51981,50654,94938,81997,91870,76150,68476,64659,73189,50207,47677,26269,62290,64464,27124,67018,41361,82760,75768,76490,20971,87749,90429,12272,95375,5871,93823,43178,54016,44056,66281,31003,682,27398,20714,53295,7706,17813,8358,69910,78542,42785,13661,58873,4618,97553,31223,8420,28306,3264,81333,10591,40510,7893,32604,60475,94119,1840,53840,86233,81594,13628,51215,90290,28466,68795,77762,20791,91757,53741,61613,62269,50263,90212,55781,76514,83483,47055,89415,92694,397,58391,12607,17646,48949,72306,94541,37408,77513,3820,86864,29901,68414,82774,51908,13980,72893,55507,19502,37174,69979,20288,55210,29773,74287,75251,65344,67415,21818,59313,93278,81757,5686,73156,7082,85046,31853,38452,51474,66499,68107,23621,94049,91345,42836,9191,8007,45449,99559,68331,62535,24170,69777,12830,74819,78142,43860,72834,33713,48007,93584,72869,51926,64721,58303,29822,93174,93972,85274,86893,11303,22970,28834,34137,73515,90400,71148,43643,84133,89640,44035,52166,73852,70091,61222,60561,62327,18423,56732,16234,17395,96131,10123,91622,85496,57560,81604,18880,65138,56806,87648,85261,34313,65861,45875,21069,85644,47277,38001,2176,81719,11711,71602,92937,74219,64049,65584,49698,37402,96397,1304,77586,56271,10086,47324,62605,40030,37438,97125,40348,87083,31417,21815,39250,75237,62047,15501,29578,21826,41134,47143,34072,64638,85902,49139,6441,3856,54552,73135,42742,95719,9035,85794,74296,8789,88156,64691,19202,7638,77929,3061,18072,96207,44156,23821,99538,4713,66994,60528,83441,7954,19814,59175,20695,5533,52139,61212,6455,83596,35655,6958,92983,5128,9719,77433,53783,92301,50498,10850,62746,99599,10507,13499,6319,53075,71839,6410,19362,39820,98952,43622,63147,64421,80814,43800,9351,31024,73167,59580,6478,75569,78800,88835,54486,23768,6156,4111,8408,38508,7341,23793,48763,90822,97022,17719,4207,95954,49953,30692,70668,94688,16127,56196,80091,82067,63400,5462,69200,65443,95659,18288,27437,49632,24041,8337,65676,96299,90836,27267,50264,13192,72294,7477,44606,17985,48911,97341,30358,91307,6991,19072,24210,36699,53728,28825,35793,28976,66252,68434,94688,84473,13622,62126,98408,12843,82590,9815,93146,48908,15877,54745,24591,35700,4754,83824,52692,54130,55160,6913,45197,42672,78601,11883,9528,63011,98901,14974,40344,10455,16019,14210,33712,91342,37821,88325,80851,43667,70883,12883,97343,65027,61184,4285,1392,17974,15077,90712,26769,21778,30976,38807,36961,31649,42096,63281,2023,8816,47449,19523,59515,65122,59659,86283,68258,69572,13798,16435,91529,67245,52670,35583,16563,79246,86686,76463,34222,26655,90802,60584,47377,7500,37992,45134,26529,26760,83637,41326,44344,53853,41377,36066,94850,58838,73859,49364,73331,96240,43642,24637,38736,74384,89342,52623,7992,12369,18601,3742,83873,83080,12451,38992,22815,7759,51777,97377,27585,51972,37867,16444,24334,36151,99073,27493,70939,85130,32552,54846,54759,60790,18157,57178,65762,11161,78576,45819,52979,65130,4860,3991,10461,93716,16894,66083,24653,84609,58232,88618,19161,38555,95554,32886,59780,8355,60860,29735,47762,71299,23853,17546,73704,92052,46215,55121,29281,59076,7936,27954,58909,32643,52861,95819,6831,911,98936,76355,93779,80863,514,69572,68777,39510,35905,14060,40619,29549,69616,33564,60780,24122,66591,27699,6494,14845,46672,61958,77100,90899,75754,61196,30231,92962,61773,41839,55382,17267,70943,78038,70267,30532,21704,10274,12202,39685,23309,10061,68829,55986,66485,3788,97599,75867,20717,74416,53166,35208,33374,87539,8823,48228,63379,85783,47619,53152,67433,35663,52972,16818,60311,60365,94653,35075,33949,42614,29297,1918,28316,98953,73231,83799,42402,56623,34442,34994,41374,70071,14736,9958,18065,32960,7405,36409,83232,99385,41600,11133,7586,15917,6253,19322,53845,57620,52606,66497,68646,78138,66559,19640,99413,11220,94747,7399,37408,48509,23929,27482,45476,85244,35159,31751,57260,68980,5339,15470,48355,88651,22596,3152,19121,88492,99382,14454,4504,20094,98977,74843,93413,22109,78508,30934,47744,7481,83828,73788,6533,28597,20405,94205,20380,22888,48893,27499,98748,60530,45128,74022,84617,82037,10268,78212,16993,35902,91386,44372,15486,65741,14014,87481,37220,41849,84547,46850,52326,34677,58300,74910,64345,19325,81549,46352,33049,69248,93460,45305,7521,61318,31855,14413,70951,11087,96294,14013,31792,59747,67277,76503,34513,39663,77544,52701,8337,56303,87315,16520,69676,11654,99893,2181,68161,57275,36898,81304,48585,68652,27376,92852,55866,88448,3584,20857,73156,70284,24326,79375,95220,1159,63267,10622,48391,15633,84924,90415,93614,33521,26665,55823,47641,86225,31704,92694,48297,39904,2115,59589,49067,66821,41575,49767,4037,77613,19019,88152,80,20554,91409,96277,48257,50816,97616,38688,32486,45134,63545,59404,72059,43947,51680,43852,59693,25163,1889,70014,15021,41290,67312,71857,15957,68971,11403,65251,7629,37239,33295,5870,1119,92784,26340,18477,65622,36815,43625,18637,37509,82444,99005,4921,73701,14707,93997,64397,11692,5327,82162,20247,81759,45197,25332,83745,22567,4515,25624,95096,67946,48460,85558,15191,18782,16930,33361,83761,60873,43253,84145,60833,25983,1291,41349,20368,7126,14387,6345,80854,9279,43529,6318,38384,74761,41196,37480,51321,92246,80088,77074,88722,56736,66164,49431,66919,31678,72472,8,80890,18002,94813,31900,54155,83436,35352,54131,5466,55306,93128,18464,74457,90561,72848,11834,79982,68416,39528,72484,82474,25593,48545,35247,18619,13674,18611,19241,81616,18711,53342,44276,75122,11724,74627,73707,58319,15997,7586,16120,82641,22820,92904,13141,32392,19763,61199,67940,90767,4235,13574,17200,69902,63742,78464,22501,18627,90872,40188,28193,29593,88627,94972,11598,62095,36787,441,58997,34414,82157,86887,55087,19152,23,12302,80783,32624,68691,63439,75363,44989,16822,36024,867,76378,41605,65961,73488,67049,9070,93399,45547,94458,74284,5041,49807,20288,34060,79495,4146,52162,90286,54158,34243,46978,35482,59362,95938,91704,30552,4737,21031,75051,93029,47665,64382,99782,93478,94015,46874,32444,48277,59820,96163,64654,25843,41145,42820,74108,88222,88570,74015,25704,91035,1755,14750,48968,38603,62880,87873,95160,59221,22304,90314,72877,17334,39283,4149,11748,12102,80580,41867,17710,59621,6554,7850,73950,79552,17944,5600,60478,3343,25852,58905,57216,39618,49856,99326,66067,42792,95043,52680,46780,56487,9971,59481,37006,22186,54244,91030,45547,70818,59849,96169,61459,21647,87417,17198,30945,57589,31732,57260,47670,7654,46376,25366,94746,49580,69170,37403,86995,90307,94304,71803,26825,5511,12459,91314,8345,88975,35841,85771,8105,59987,87112,21476,14713,71181,27767,43584,85301,88977,29490,69714,73035,41207,74699,9310,13025,14338,54066,15243,47724,66733,47431,43905,31048,56699,80217,36292,98525,24335,24432,24896,43277,58874,11466,16082,10875,62004,90391,61105,57411,6368,53856,30743,8670,84741,54127,57326,26629,19087,24472,88779,30540,27886,61732,75454,60311,42824,37301,42678,45990,43242,17374,52003,70707,70214,49739,71484,92003,98086,76668,73209,59202,11973,2902,33250,78626,51594,16453,94614,39014,97066,83012,9832,25571,77628,66692,13986,99837,582,81232,44987,9504,96412,90193,79568,44071,28091,7362,97703,76447,42537,98524,97831,65704,9514,41468,85149,49554,17994,14924,39650,95294,556,70481,6905,94559,37559,49678,53119,70312,5682,66986,34099,74474,20740,41615,70360,64114,58660,90850,64618,80620,51790,11436,38072,50273,93113,41794,86861,24781,89683,55411,85667,77535,99892,41396,80504,90670,8289,40902,5069,95083,6783,28102,57816,25807,24260,71529,78920,72682,7385,90726,57166,98884,8583,6170,97965,88302,98041,21443,41808,68984,83620,89747,98882,60808,54444,74412,81105,1176,28838,36421,16489,18059,51061,80940,44893,10408,36222,80582,71944,92638,40333,67054,16067,19516,90120,46759,71643,13177,55292,21036,82808,77501,97427,49386,54480,23604,23554,21785,41101,91178,10174,29420,90438,6312,88940,15995,69321,47458,64809,98189,81851,29651,84215,60942,307,11897,92674,40405,68032,96717,54244,10701,41393,92329,98932,78284,46347,71209,92061,39448,93136,25722,8564,77936,63574,31384,51924,85561,29671,58137,17820,22751,36518,38101,77756,11657,13897,95889,57067,47648,13885,70669,93406,39641,69457,91339,22502,92613,89719,11947,56203,19324,20504,84054,40455,99396,63680,67667,60631,69181,96845,38525,11600,47468,3577,57649,63266,24700,71594,14004,23153,69249,5747,43321,31370,28977,23896,76479,68562,62342,7589,8899,5985,64281,61826,18555,64937,13173,33365,78851,16499,87064,13075,66847,70495,32350,2985,86716,38746,26313,77463,55387,72681,72461,33230,21529,53424,92581,2262,78438,66276,18396,73538,21032,91050,13058,16218,12470,56500,15292,76139,59526,52113,95362,67011,6651,16136,1016,857,55018,56374,35824,71708,49712,97380,10404,55452,34030,60726,75211,10271,36633,68424,58275,61764,97586,54716,50259,46345,87195,46092,26787,60939,89514,11788,68224,23417,73959,76145,30342,40277,11049,72049,15472,50669,48139,36732,46874,37088,73465,9819,58869,35220,12120,86124,51247,44302,60883,52109,21437,36786,49226,77837,19612,78430,11661,94770,77603,65669,86868,12665,30012,75989,39141,77400,28e3,64238,73258,71794,31340,26256,66453,37016,64756,80457,8747,12836,3469,50678,3274,43423,66677,82556,92901,51878,56441,22998,29718,38447,6453,25311,7565,53771,3551,90070,9483,94050,45938,18135,36908,43321,11073,51803,98884,66209,6830,53656,14663,56346,71430,4909,19818,5707,27369,86882,53473,7541,53633,70863,3748,12822,19360,49088,59066,75974,63335,20483,43514,37481,58278,26967,49325,43951,91647,93783,64169,49022,98588,9495,49829,59068,38831,4838,83605,92419,39542,7772,71568,75673,35185,89759,44901,74291,24895,88530,70774,35439,46758,70472,70207,92675,91623,61275,35720,26556,95596,20094,73750,85788,34264,1703,46833,65248,14141,53410,38649,6343,57256,61342,72709,75318,90379,37562,27416,75670,92176,72535,93119,56077,6886,18244,92344,31374,82071,7429,81007,47749,40744,56974,23336,88821,53841,10536,21445,82793,24831,93241,14199,76268,70883,68002,3829,17443,72513,76400,52225,92348,62308,98481,29744,33165,33141,61020,71479,45027,76160,57411,13780,13632,52308,77762,88874,33697,83210,51466,9088,50395,26743,5306,21706,70001,99439,80767,68749,95148,94897,78636,96750,9024,94538,91143,96693,61886,5184,75763,47075,88158,5313,53439,14908,8830,60096,21551,13651,62546,96892,25240,47511,58483,87342,78818,7855,39269,566,21220,292,24069,25072,29519,52548,54091,21282,21296,50958,17695,58072,68990,60329,95955,71586,63417,35947,67807,57621,64547,46850,37981,38527,9037,64756,3324,4986,83666,9282,25844,79139,78435,35428,43561,69799,63314,12991,93516,23394,94206,93432,37836,94919,26846,2555,74410,94915,48199,5280,37470,93622,4345,15092,19510,18094,16613,78234,50001,95491,97976,38306,32192,82639,54624,72434,92606,23191,74693,78521,104,18248,75583,90326,50785,54034,66251,35774,14692,96345,44579,85932,44053,75704,20840,86583,83944,52456,73766,77963,31151,32364,91691,47357,40338,23435,24065,8458,95366,7520,11294,23238,1748,41690,67328,54814,37777,10057,42332,38423,2309,70703,85736,46148,14258,29236,12152,5088,65825,2463,65533,21199,60555,33928,1817,7396,89215,30722,22102,15880,92261,17292,88190,61781,48898,92525,21283,88581,60098,71926,819,59144,224,30570,90194,18329,6999,26857,19238,64425,28108,16554,16016,42,83229,10333,36168,65617,94834,79782,23924,49440,30432,81077,31543,95216,64865,13658,51081,35337,74538,44553,64672,90960,41849,93865,44608,93176,34851,5249,29329,19715,94082,14738,86667,43708,66354,93692,25527,56463,99380,38793,85774,19056,13939,46062,27647,66146,63210,96296,33121,54196,34108,75814,85986,71171,15102,28992,63165,98380,36269,60014,7201,62448,46385,42175,88350,46182,49126,52567,64350,16315,53969,80395,81114,54358,64578,47269,15747,78498,90830,25955,99236,43286,91064,99969,95144,64424,77377,49553,24241,8150,89535,8703,91041,77323,81079,45127,93686,32151,7075,83155,10252,73100,88618,23891,87418,45417,20268,11314,50363,26860,27799,49416,83534,19187,8059,76677,2110,12364,71210,87052,50241,90785,97889,81399,58130,64439,5614,59467,58309,87834,57213,37510,33689,1259,62486,56320,46265,73452,17619,56421,40725,23439,41701,93223,41682,45026,47505,27635,56293,91700,4391,67317,89604,73020,69853,61517,51207,86040,2596,1655,9918,45161,222,54577,74821,47335,8582,52403,94255,26351,46527,68224,90183,85057,72310,34963,83462,49465,46581,61499,4844,94626,2963,41482,83879,44942,63915,94365,92560,12363,30246,2086,75036,88620,91088,67691,67762,34261,8769,91830,23313,18256,28850,37639,92748,57791,71328,37110,66538,39318,15626,44324,82827,8782,65960,58167,1305,83950,45424,72453,19444,68219,64733,94088,62006,89985,36936,61630,97966,76537,46467,30942,7479,67971,14558,22458,35148,1929,17165,12037,74558,16250,71750,55546,29693,94984,37782,41659,39098,23982,29899,71594,77979,54477,13764,17315,72893,32031,39608,75992,73445,1317,50525,87313,45191,30214,19769,90043,93478,58044,6949,31176,88370,50274,83987,45316,38551,79418,14322,91065,7841,36130,86602,10659,40859,964,71577,85447,61079,96910,72906,7361,84338,34114,52096,66715,51091,86219,81115,49625,48799,89485,24855,13684,68433,70595,70102,71712,88559,92476,32903,68009,58417,87962,11787,16644,72964,29776,63075,13270,84758,49560,10317,28778,23006,31036,84906,81488,17340,74154,42801,27917,89792,62604,62234,13124,76471,51667,37589,87147,24743,48023,6325,79794,35889,13255,4925,99004,70322,60832,76636,56907,56534,72615,46288,36788,93196,68656,66492,35933,52293,47953,95495,95304,50009,83464,28608,38074,74083,9337,7965,65047,36871,59015,21769,30398,44855,1020,80680,59328,8712,48190,45332,27284,31287,66011,9376,86379,74508,33579,77114,92955,23085,92824,3054,25242,16322,48498,9938,44420,13484,52319,58875,2012,88591,52500,95795,41800,95363,54142,17482,32705,60564,12505,40954,46174,64130,63026,96712,79883,39225,52653,69549,36693,59822,22684,31661,88298,15489,16030,42480,15372,38781,71995,77438,91161,10192,7839,62735,99218,25624,2547,27445,69187,55749,32322,15504,73298,51108,48717,92926,75705,89787,96114,99902,37749,96305,12829,70474,838,50385,91711,80370,56504,56857,80906,9018,76569,61072,48568,36491,22587,44363,39592,61546,90181,37348,41665,41339,62106,44203,6732,76111,79840,67999,32231,76869,58652,49983,1669,27464,79553,52855,25988,18087,38052,17529,13607,657,76173,43357,77334,24140,53860,2906,89863,44651,55715,26203,65933,51087,98234,40625,45545,63563,89148,82581,4110,66683,99001,9796,47349,65003,66524,81970,71262,14479,31300,8681,58068,44115,40064,77879,23965,69019,73985,19453,26225,97543,37044,7494,85778,35345,61115,92498,49737,64599,7158,82763,25072,38478,57782,75291,62155,52056,4786,11585,71251,25572,79771,93328,66927,54069,58752,26624,50463,77361,29991,96526,2820,91659,12818,96356,49499,1507,40223,9171,83642,21057,2677,9367,38097,16100,19355,6120,15378,56559,69167,30235,6767,66323,78294,14916,19124,88044,16673,66102,86018,29406,75415,22038,27056,26906,25867,14751,92380,30434,44114,6026,79553,55091,95385,41212,37882,46864,54717,97038,53805,64150,70915,63127,63695,41288,38192,72437,75075,18570,52065,8853,30104,79937,66913,53200,84570,78079,28970,53859,37632,80274,35240,32960,74859,7359,55176,3930,38984,35151,82576,82805,94031,12779,90879,24109,25367,77861,9541,85739,69023,64971,99321,7521,95909,43897,71724,92581,5471,64337,98949,3606,78236,78985,29212,57369,34857,67757,58019,58872,96526,28749,56592,37871,72905,70198,57319,54116,47014,18285,33692,72111,60958,96848,17893,40993,50445,14186,76877,87867,50335,9513,44346,26439,55293,6449,44301,63740,40158,72703,88321,85062,57345,66231,15409,3451,95261,43561,15673,28956,90303,62469,82517,43035,36850,15592,64098,59022,31752,4370,50486,11885,23085,41712,80692,48492,16495,99721,36912,28267,27882,16269,64483,11273,2680,1616,46138,54606,14761,5134,45144,63213,49666,27441,86989,29884,54334,6740,8368,80051,81020,17882,74973,74531,94994,24927,64894,22667,20466,82948,66831,47427,76033,31197,59817,20064,61135,28556,29695,80179,74058,18293,9963,35278,13062,83094,23373,90287,33477,48865,30348,70174,11468,25994,25343,22317,1587,30682,1,67814,59557,23362,13746,82244,42093,24671,79458,93730,45488,60234,67098,9899,25775,332,36636,57594,19958,85564,58977,12247,60774,66371,69442,20385,14486,91330,50332,46023,75768,59877,60081,92936,72302,75064,85727,52987,5750,19384,33684,78859,80458,69902,34870,88684,49762,40801,86291,18194,90366,82639,53844,96326,65728,48563,26027,52692,62406,76294,41848,63010,69841,29451,36170,21529,16525,64326,22086,24469,57407,96033,37771,31002,18311,93285,31948,14331,58335,15977,80336,81667,27286,24361,61638,57580,95270,46180,76990,53031,94366,2727,49944,19278,5756,51875,53445,33342,1965,7937,10054,97712,87693,58124,46064,39133,77385,9605,65359,70113,90563,86637,94282,12025,31926,24541,23854,58407,32131,92845,20714,27898,26917,50326,35145,50859,72119,95094,29441,42301,62460,75252,94267,38422,73047,24200,85349,72049,91723,97802,98496,12734,73432,10371,57213,53300,80847,46229,7099,72961,13767,65654,31102,82119,96946,65919,81083,3819,57888,57908,16849,77111,41429,92261,45263,1172,55926,78835,27697,48420,58865,41207,21406,8582,10785,36233,12237,7866,13706,92551,11021,63813,71512,65206,37768,94325,14721,20990,54235,71986,5345,56239,52028,1419,7215,55067,11669,21738,66605,69621,69827,8537,18638,60982,28151,98885,76431,25566,3085,23639,30849,63986,73287,26201,36174,14106,54102,57041,16141,64174,3591,90024,73332,31254,17288,59809,25061,51612,47951,16570,43330,79213,11354,55585,19646,99246,37564,32660,20632,21124,60597,69315,31312,57741,85108,21615,24365,27684,16124,33888,14966,35303,69921,15795,4020,67672,86816,63027,84470,45605,44887,26222,79888,58982,22466,98844,48353,60666,58256,31140,93507,69561,6256,88526,18655,865,75247,264,65957,98261,72706,36396,46065,85700,32121,99975,73627,78812,89638,86602,96758,65099,52777,46792,13790,55240,52002,10313,91933,71231,10053,78416,54563,96004,42215,30094,45958,48437,49591,50483,13422,69108,59952,27896,40450,79327,31962,46456,39260,51479,61882,48181,50691,64709,32902,10676,12083,35771,79656,56667,76783,3937,99859,10362,57411,40986,35045,2838,29255,64230,84418,34988,77644,39892,77327,74129,53444,35487,95803,38640,20383,55402,25793,14213,87082,42837,95030,97198,61608,97723,79390,35290,34683,81419,87133,70447,53127,97146,28299,56763,12868,1145,12147,58158,92124,60934,18414,97510,7056,54488,20719,53743,91037,44797,52110,8512,18991,20129,31441,51449,14661,71126,23180,68124,18807,70997,21913,19594,70355,73637,68266,60775,43164,52643,96363,77989,79332,39890,65379,20405,52935,43816,92740,95319,4538,60660,28982,15328,80475,34690,2293,19646,46524,96627,33159,42081,8816,74931,20674,8697,66169,46460,46326,39923,60625,28386,22919,19415,75766,43668,31626,70301,67053,3949,70082,2303,48642,38429,94053,38770,68137,68441,52928,70244,91954,17401,92693,98342,21451,84988,80487,33807,73797,49494,41878,76635,83227,76618,11946,13451,87591,78381,21407,90038,72638,69692,51599,86413,32019,64856,74730,41531,11064,1790,58817,86400,66213,92599,70905,78324,54326,43659,34206,63132,38837,40210,96346,16967,81619,96503,14881,89405,32205,49508,98425,2451,35423,56072,36810,30332,85998,49358,92748,84147,79835,94867,41224,61794,35066,82220,66684,20096,2754,41731,37068,32753,91059,13407,5607,69384,53329,95909,44968,11397,92973,50014,92997,80968,93761,57598,74703,7768,37978,73873,33475,9720,97852,98449,48722,84977,11271,11728,68318,22312,78792,87508,88466,72976,47099,84126,38595,85124,64405,90020,7492,52413,95111,34455,86311,68892,1074,60274,28136,19328,38161,57475,13771,63562,84207,94121,18901,52768,33801,82087,86091,59969,90398,56870,55756,78841,98450,54165,55106,50343,70519,14567,36780,55450,19606,83749,67562,64765,38543,16585,86841,73742,8766,39252,75678,75379,78760,37279,15280,13558,95916,89759,76686,76467,67147,63110,94008,8037,35263,53710,16667,79008,11231,29397,67136,18601,64502,90228,89109,72849,22711,65547,34542,26686,81678,87765,77654,23664,96352,14106,32938,28083,18633,80286,65507,46197,52722,75476,77816,47204,34876,45963,79262,90181,84041,3745,90041,30780,27226,92847,85572,15308,80688,5761,82638,13464,23683,81015,54214,64175,43701,86845,15569,50687,52679,87696,8285,97444,47599,94472,64150,87753,68652,60726,26213,17320,64553,81285,98126,12158,52095,64833,492,35817,55571,91300,97812,37507,4209,53515,64342,21223,16662,43265,68219,3529,43636,68417,53640,95326,93381,37113,80751,76469,96677,43054,22937,31954,13266,34140,27253,2734,99070,60077,57988,93211,92795,83795,57477,3941,39007,14619,38320,93449,31336,25279,97030,26245,47394,39475,90621,23820,29344,94859,91604,14033,41868,14816,4075,66644,87803,97815,99552,78666,3942,8175,22345,19983,76783,99044,20851,84981,59052,77178,72109,76475,21619,73017,6812,56633,50612,55289,4671,84419,94072,94446,80603,32188,93415,23464,43947,43728,74284,67177,57105,31059,10642,13803,69602,46961,66567,19359,84676,63918,40650,12923,15974,79732,20225,92525,71179,4859,91208,60430,5239,61458,24089,68852,60171,29603,42535,86365,93905,28237,45317,60718,82001,41679,20679,56304,70043,87568,21386,59049,78353,48696,77379,55309,23780,28391,5940,55583,81256,59418,97521,32846,70761,90115,45325,5490,65974,11186,15357,3568,450,96644,58976,36211,88240,92457,89200,94696,11370,91157,48487,59501,56983,89795,42789,69758,79701,29511,55968,41472,89474,84344,80517,7485,97523,17264,82840,59556,37119,30985,48866,60605,95719,70417,59083,95137,76538,44155,67286,57897,28262,4052,919,86207,79932,44236,10089,44373,65670,44285,6903,20834,49701,95735,21149,3425,17594,31427,14262,32252,68540,39427,44026,47257,45055,95091,8367,28381,57375,41562,83883,27715,10122,67745,46497,28626,87297,36568,39483,11385,63292,92305,78683,6146,81905,15038,38338,51206,65749,34119,71516,74068,51094,6665,91884,66762,11428,70908,21506,480,94183,78484,66507,75901,25728,52539,86806,69944,65036,27882,2530,4918,74351,65737,89178,8791,39342,94963,22581,56917,17541,83578,75376,65202,30935,79270,91986,99286,45236,44720,81915,70881,45886,43213,49789,97081,16075,20517,69980,25310,91953,1759,67635,88933,54558,18395,73375,62251,58871,9870,70538,48936,7757,90374,56631,88862,30487,38794,36079,32712,11130,55451,25137,38785,83558,31960,69473,45950,18225,9871,88502,75179,11551,75664,74321,67351,27703,83717,18913,42470,8816,37627,14288,62831,44047,67612,72738,26995,50933,63758,50003,43693,52661,55852,52372,59042,37595,4931,73622,68387,86478,40997,5245,75300,24902,59609,35653,15970,37681,69365,22236,86374,65550,343,98377,35354,65770,15365,41422,71356,16630,40044,19290,66449,53629,79452,71674,30260,97303,6487,62789,13005,70152,22501,49867,89294,59232,31776,54919,99851,5438,1096,72269,50486,16719,6144,82041,38332,64452,31840,99287,59928,25503,8407,46970,45907,99238,74547,19704,72035,26542,54600,79172,58779,35747,78956,11478,41195,58135,63856,33037,45753,60159,25193,71838,7526,7985,60714,88627,75790,38454,96110,39237,19792,34534,70169,24805,63215,38175,38784,38855,24826,50917,25147,17082,26997,32295,10894,21805,65245,85407,37926,69214,38579,84721,23544,88548,65626,75517,69737,55626,52175,21697,19453,16908,82841,24060,40285,19195,80281,89322,15232,70043,60691,86370,91949,19017,83846,77869,14321,95102,87073,71467,31305,64677,80358,52629,79419,22359,87867,48296,50141,46807,82184,95812,84665,74511,59914,4146,90417,58508,62875,17630,21868,9199,30322,33352,43374,25473,4119,63086,14147,14863,38020,44757,98628,57916,22199,11865,42911,62651,78290,9392,77294,63168,21043,17409,13786,27475,75979,89668,43596,74316,84489,54941,95992,45445,41059,55142,15214,42903,16799,88254,95984,48575,77822,21067,57238,35352,96779,89564,23797,99937,46379,27119,16060,30302,95327,12849,38111,97090,7598,78473,63079,18570,72803,70040,91385,96436,96263,17368,56188,85999,50026,36050,73736,13351,48321,28357,51718,65636,72903,21584,21060,39829,15564,4716,14594,22363,97639,65937,17802,31535,42767,98761,30987,57657,33398,63053,25926,20944,19306,81727,2695,97479,79172,72764,66446,78864,12698,15812,97209,38827,91016,91281,57875,45228,49211,69755,99224,43999,62879,8879,80015,74396,57146,64665,31159,6980,79069,37409,75037,69977,85919,42826,6974,61063,97640,13433,92528,91311,8440,38840,22362,93929,1836,36590,75052,89475,15437,65648,99012,70236,12307,83585,414,62851,48787,28447,21702,57033,29633,44760,34165,27548,37516,24343,63046,2081,20378,19510,42226,97134,68739,32982,56455,53129,77693,25022,55534,99375,30086,98001,7432,67126,76656,29347,28492,43108,64736,32278,84816,80440,30461,818,9136,1952,48442,91058,92590,10443,5195,34009,32141,62209,43740,54102,76895,98172,31583,4155,66492,58981,16591,11331,6838,3818,77063,12523,45570,68970,70055,77751,73743,71732,4704,61384,57343,66682,44500,89745,10436,67202,36455,42467,88801,91280,1056,27534,81619,79004,25824,66362,33280,20706,31929,57422,18730,96197,22101,47592,2180,18287,82310,60430,59627,26471,7794,60475,76713,45427,89654,14370,81674,41246,98416,8669,48883,77154,9806,94015,60347,20027,8405,33150,27368,53375,70171,59431,14534,34018,85665,77797,17944,49602,74391,48830,55029,10371,94261,16658,68400,44148,28150,40364,90913,73151,64463,50058,78191,84439,82478,62398,3113,17578,12830,6571,95934,9132,25287,78731,80683,67207,76597,42096,34934,76609,52553,47508,71561,8038,83011,72577,95790,40076,20292,32138,61197,95476,23123,26648,13611,48452,39963,85857,4855,27029,1542,72443,53688,82635,56264,7977,23090,93553,65434,12124,91087,87800,95675,99419,44659,30382,55263,82514,86800,16781,65977,65946,13033,93895,4056,75895,47878,91309,51233,81409,46773,69135,56906,84493,34530,84534,38312,54574,92933,77341,20839,36126,1143,35356,35459,7959,98335,53266,36146,78047,50607,22486,63308,8996,96056,39085,26567,6779,62663,30523,47881,41279,49864,82248,78333,29466,48151,41957,93235,53308,22682,90722,54478,7235,34306,15827,20121,96837,6283,80172,66109,92592,48238,76428,94546,45430,16288,74839,740,25553,83767,35900,5998,7493,46755,11449,88824,44906,33143,7454,56652,34755,63992,59674,65131,46358,12799,96988,51158,73176,1184,49925,63519,11785,29073,72850,47997,75172,55187,15313,40725,33225,56643,10465,38583,86440,97967,26401,17078,38765,33454,19136,57712,48446,98790,27315,71074,10157,57946,35582,49383,61324,26572,84503,3496,60449,17962,26017,65651,40400,83246,80056,75306,75147,41863,25581,87530,33193,43294,5065,99644,62771,75986,79005,44924,18703,40889,4403,5862,2571,82500,74200,36170,46836,74642,65471,26815,30937,64946,10160,15544,31962,54015,28853,66533,14573,79398,47391,73165,47805,77589,16881,13423,89452,76992,62509,9796,57540,13486,48855,25546,47589,21012,47388,78428,70196,84413,81026,87597,22445,83769,85937,38321,85485,87359,9839,67228,71179,94372,4446,62801,50775,96179,40646,44272,12417,47199,39701,30665,32775,66525,53558,78882,31939,67209,38906,34533,99914,27719,216,99225,96537,3843,90564,91110,51838,30300,9559,37795,94880,11325,44979,89696,28129,29931,89971,46292,92710,11036,74760,75307,12291,49618,16293,92408,67928,80823,32872,25460,66819,35374,4035,99087,61129,11341,39118,10891,37217,63638,75477,30068,42334,57570,6890,59353,89939,37692,15232,20033,32202,22348,2766,96791,58448,92248,5769,96684,67885,99295,47271,38655,59513,96960,31718,8974,16122,20535,52380,29769,70660,57425,50891,75044,84257,73315,38181,28673,93140,26307,82265,78382,19681,56585,8975,76764,39956,83450,84663,89963,71584,57696,30829,60527,64947,34899,28805,28397,91830,51842,99838,39839,66971,67177,74219,35637,35634,93581,81746,29991,81096,94279,2968,62561,2479,82126,25702,67953,88088,50293,83423,86206,39935,23253,43041,48941,85787,8388,6671,43574,84908,67295,33623,55060,28174,48415,2529,22009,24524,5283,30460,32399,80423,56929,40852,69969,88541,5979,91496,64730,57198,83145,39750,3568,54669,98679,4297,51047,31492,47734,31343,31180,232,19707,24823,75079,73943,17997,8446,91252,39879,58682,82972,18417,39203,36681,42895,8459,15618,17941,52594,43277,16530,40052,91100,87422,47230,95699,49794,50492,87439,86354,4546,65333,11057,77727,19748,38722,91821,18107,42125,89239,28847,54623,38783,47803,31414,38450,3697,89186,30579,44188,26532,8420,80723,48100,60748,76330,45832,8311,16051,4475,13400,48527,46073,17439,56498,94632,9021,16871,83366,14896,4219,38375,87890,90217,42370,61028,85101,76771,83715,94737,69973,74187,1958,59691,86712,86570,60984,76342,13648,85250,28323,48379,45141,36277,51845,29039,3553,5128,59866,51281,68124,17007,24729,29710,41439,40574,11774,86746,89698,56020,37810,88972,11361,95583,70786,589,74473,87513,17690,61427,72914,32517,1804,97910,6327,30246,33049,2622,41026,80875,41293,16752,84225,84414,37137,68956,8095,64981,28180,38629,76962,23840,17477,75268,48297,70340,57888,13938,38554,86836,2195,30270,55484,53364,54705,41380,56316,37723,234,21424,26664,63804,75139,36534,18579,9833,98849,72762,59767,52497,24227,83152,71794,21398,99456,89215,51632,54799,27973,68568,68465,98500,28681,18369,24279,96335,12874,82160,67202,85199,27908,67022,49810,77929,96212,81153,77884,7032,1671,53362,28119,56786,30883,28540,76029,3774,64611,19736,25589,46569,45206,48215,69523,17423,91807,90039,30393,58319,85098,66519,57571,24541,3562,14400,62731,82534,61477,89731,18421,29861,52829,838,78040,43350,74323,82892,84746,28302,13264,7595,134,12933,46831,24864,47275,20527,9110,28485,30326,99826,64005,99308,65779,42760,90066,3974,38688,39968,32604,11694,46262,73262,45405,43923,67397,88228,56405,17839,92073,57622,93328,15442,50186,7570,58001,31e3,8915,11467,14793,82691,51238,12485,51745,18192,5985,36826,89434,38669,91592,88799,65621,67237,59541,19657,93402,58705,73553,78280,69125,95591,81168,91927,25976,89077,71690,19404,64603,59752,74698,44233,67602,38615,31303,28650,53700,89819,7783,4351,77451,47350,21234,16016,41532,76508,23063,44993,43983,33356,61715,96485,22121,78004,6316,87896,99289,93981,37850,66128,92735,45064,50924,24204,58816,65290,34392,55567,66416,72353,45775,68590,85685,72683,60090,37149,85347,57414,72336,12979,5720,92754,76911,96883,74420,5220,85815,23557,80567,44365,70254,50864,36619,51479,23281,76428,18580,34240,59289,49076,18439,29522,42541,4024,84446,92434,90407,77241,19690,78143,65919,13699,91844,91241,38361,67171,90551,5709,3474,76025,97043,33834,44638,54040,82797,545,38159,16089,35870,89158,55864,98078,50563,36492,10994,85909,9018,19252,73887,67928,60045,70782,11937,4074,53814,46621,52577,94853,45968,73667,65062,73306,76045,78649,91654,53958,96537,95542,67622,54579,17279,67440,56441,20681,64011,52226,96618,32831,60664,67547,39523,2043,59748,1887,69229,94653,99271,98164,62155,9234,47367,13047,6364,35064,10073,6793,80248,29009,44969,11129,17139,79630,89772,26921,56949,23465,30036,17173,82459,96218,60768,76417,24405,18710,68887,82394,69729,82503,40873,41590,67255,30757,9657,91881,34578,9511,5417,58953,18532,10721,22029,48524,47778,881,83489,3464,57462,97459,86689,39755,39547,740,36666,7993,31671,86304,12970,73402,52849,31652,79655,11250,18463,57518,20306,25301,1374,51208,33298,87662,61849,60923,68685,69411,39266,80320,34844,89416,81569,83651,35795,40168,33501,1042,58931,3892,85188,74740,85476,23790,33842,89565,53359,25579,59049,62394,72435,12457,21904,18370,97035,57905,9581,91227,92754,37760,1411,7440,87175,88318,63242,85960,56690,12618,30493,11569,73723,7448,58830,157,65814,21118,22140,73793,57855,81830,6795,13183,12625,30635,56429,73216,12342,36722,83886,96828,82870,90954,97614,2370,42160,73370,11944,49067,59452,80495,43911,46712,17033,68037,41963,3874,44856,82985,57453,84358,16120,4454,76624,405,62369,55080,61880,51270,87807,10653,36894,70850,35660,234,14705,93418,94084,82856,25384,71555,56754,78315,18291,91656,98079,52384,43306,65205,75903,58701,99496,50048,33557,87793,90857,10143,46726,84284,43635,41213,83845,70986,91408,80220,5728,68890,46577,21152,43759,43301,93661,97252,50106,10099,13722,18572,44024,351,18173,23717,85114,85998,57782,63951,53723,86853,63851,79430,49181,46386,69666,55743,76162,71724,40028,94786,34457,16906,90040,30789,40281,94697,96584,81907,4055,53990,66397,80579,42517,78181,39251,9467,67097,95523,66568,63632,71048,15581,39904,75774,77495,75994,29911,65690,41178,47712,70355,16998,56025,5230,10093,71495,34784,70950,54680,57811,53782,39145,36829,85342,40406,35883,45668,3459,29870,78252,70088,70621,67153,5737,40933,91075,93335,86853,15860,81167,91259,16118,52401,83593,84474,2423,75608,39646,90871,70284,82100,96032,5115,63678,2225,88087,58581,44364,57468,21539,13042,64150,63754,5210,87644,54114,64013,63562,41388,32397,74152,23982,71982,71700,33026,66477,47838,46712,39848,35083,65927,97868,11067,76771,71799,43836,41014,97025,93225,8511,63096,26628,73012,12543,76269,99708,2629,49845,73677,19193,14924,57236,95564,15010,59667,73773,78515,2624,99744,13585,33746,58771,94785,62628,99585,11363,80832,59979,9444,78700,2596,85984,69438,16913,96475,93283,18625,77086,45911,39746,64722,39938,43930,54619,302,50384,2738,75714,75249,95439,80714,52555,47266,96190,78750,94973,83669,16479,53163,48071,28e3,45011,26733,67132,83362,84162,43028,8415,27236,52651,89059,64844,80910,1676,91752,57815,26264,3415,57532,29981,61200,96036,62600,20068,56530,38487,8432,89514,26883,69165,97237,22361,55276,39902,95927,82190,49269,27212,46095,37106,64254,27460,49572,51700,27679,12574,33891,3867,9925,6476,82018,45094,59014,67113,44192,75,23318,79895,70550,81717,28833,30271,15821,14999,88174,62617,57517,55256,50281,51583,96879,5225,42272,5339,20483,57596,41011,75937,22767,50120,95938,49753,63882,99616,69083,38721,73889,80236,99531,23053,71237,48861,59046,76283,60538,19732,93877,30345,64882,66660,17026,70364,45676,8039,96228,89936,59141,95585,89552,97247,59325,27848,80058,15950,61481,90906,40998,44137,16144,66300,44091,50018,81364,18211,60294,76559,20279,27414,10589,39860,23e3,31767,95618,56738,50332,16936,70342,92481,30702,76264,62619,68678,62284,83112,93032,55203,52614,36950,41796,45403,79262,2887,53596,61308,20738,34811,27099,90956,65448,3080,75795,29753,97699,80872,23830,85882,74427,99523,74904,28017,45898,57232,48525,7086,26805,74533,92470,18840,76011,93109,14344,55614,50284,15865,19458,35856,13464,53679,64603,51571,56124,79107,29596,89572,78198,57121,73649,8804,87977,87959,70859,40909,77295,87877,75158,62810,92074,23244,59516,50552,31602,41899,6347,27821,68370,48596,88577,30231,25267,84622,31449,12086,56461,22962,78213,62483,93966,60437,52239,58113,32526,38708,81607,57016,1695,90110,4649,59990,23979,3855,10297,46516,96092,82305,30760,78756,4967,82876,4773,86651,16648,53133,82439,78851,49766,24553,15273,36417,1901,33386,76979,25920,33372,2695,11982,40911,6230,91696,43907,17827,30332,89203,32215,91806,23080,49102,9174,11548,54590,75803,66108,73882,62324,26017,72716,33887,1285,31604,71039,24337,53514,58964,89901,22040,92751,12617,37007,5523,61672,62557,98540,26094,60284,19621,96230,38044,6545,9458,42988,2913,86345,67936,90174,40840,44991,24256,34989,74086,13652,68706,1363,4294,88008,78693,83068,94746,221,89299,53186,5930,61889,51341,45412,58860,72568,11381,59785,36887,10690,31347,93326,96267,86987,57565,86836,49071,90331,41248,34629,30240,27270,3864,84308,3035,61369,36902,51017,44409,17120,23823,36460,63359,8333,63173,19134,6493,303,18550,26191,19051,81502,66343,6737,90430,65478,58982,82484,16483,47704,44640,68322,44548,72787,2335,28749,39320,5436,98146,56596,812,51445,35533,35478,47573,38414,25542,38032,13442,42983,97207,77854,57806,81616,52828,79429,47389,96795,57764,19605,24767,63253,18809,65093,44449,22952,76872,30983,38948,9310,48336,87651,27110,84427,76209,56412,12760,16747,14551,82626,31224,98636,75100,84882,79479,83420,5347,6803,90063,4617,40257,79183,41766,71873,25242,12275,336,40798,42055,74066,69128,32547,76508,32530,42359,89207,49758,58984,92732,15779,7234,28884,28226,50011,35883,99606,45423,76224,75427,85747,33879,97978,57441,927,19164,74716,40702,19715,70917,60344,40236,9019,50577,15598,53136,57285,20536,7539,74832,89184,41501,39447,97422,97041,21913,40581,76081,13089,28776,54164,55736,36263,71841,34488,74988,55467,43322,9214,36746,67981,71877,81683,32461,84091,19422,88366,62054,85664,13409,8003,88276,6989,16607,33633,85349,5784,25950,97998,74110,16699,60184,92818,79705,10381,1474,18656,50434,18232,92132,66537,70141,42854,25120,39581,28249,14215,34810,19767,3409,11807,6566,66138,42997,41999,67504,87117,28961,5e3,29673,77726,73225,54753,69712,71576,92337,17713,63185,87923,91889,68351,17712,75532,93849,48280,62219,317,25290,29209,90927,92929,92762,60413,2018,31793,76290,73373,80777,60819,77375,57886,47291,99670,32605,29064,99476,80999,31217,35,91300,14892,73653,26593,25305,56797,12837,39560,27582,37253,38531,76489,49946,69108,58687,43092,73807,96282,6648,67431,87124,57694,21660,64002,6,33600,30245,60636,80164,9285,61426,4658,54130,14710,76553,1904,93668,63110,98618,5601,32199,74923,98049,49717,55539,35940,58545,43295,35810,45451,38735,42065,66769,69825,45461,83881,67372,67351,90612,79502,69460,23108,74421,82990,46821,40683,71603,55267,48192,50242,79738,96417,6664,19929,23644,41116,51056,219,45086,32747,49492,15399,24874,80825,95928,61457,45813,59037,16136,3953,83583,5910,12654,53630,92997,22168,93491,71897,74579,24022,6278,24049,71670,43044,8474,38572,77402,35800,7455,96177,41653,74493,20802,65843,73050,73349,2638,65813,96209,49196,45007,32207,14097,66059,46681,7534,71263,20582,10171,51514,52142,60961,57951,25637,37860,21683,86190,90434,94481,85697,95344,2606,74095,61133,7472,64777,94050,41482,975,23471,76052,82021,87676,91345,20196,2612,86299,44996,40312,65712,46079,88514,8610,3685,63197,9073,53105,86824,28112,99306,40706,66840,83003,51590,52755,32285,68454,85058,13645,23073,24724,52989,71880,21952,44144,74975,76715,7844,46447,86643,75579,29276,10864,83179,36721,19300,35066,29383,47478,56644,33354,31414,17643,92374,85085,88458,87191,85248,34963,76278,53230,13953,76985,70959,36663,5293,32658,56767,56997,76736,6558,64248,11907,29123,78458,17678,63805,89973,5076,39263,54404,4355,64957,74407,99838,18836,78098,6490,74888,73719,80675,86178,56283,33591,96957,38382,18772,74773,71229,2603,52673,44609,14843,58418,18060,95459,626,30914,13550,42195,44863,8871,89182,64446,78422,41140,15312,98274,48168,95651,35562,85386,56252,72136,85088,68761,78434,98143,61330,2446,64409,49406,99127,98626,55095,44808,13594,87370,89472,12833,98932,68064,58193,20225,5192,28425,23978,24542,80845,55858,4015,21454,37346,51007,17202,10242,12682,55933,96922,22280,75597,50227,70712,44236,20470,36320,49339,60536,80083,38880,93327,49522,93585,9918,55268,4671,57526,11457,48424,54610,7211,78610,9473,72923,27347,30057,76968,26177,59367,46172,88951,40229,34921,60405,88959,16779,29547,92231,61997,36002,21080,39795,77221,10012,49748,76900,15964,3803,40260,92351,92844,10288,57483,10881,70408,75688,16610,1638,93082,44282,66849,75702,69428,34047,84968,71281,72328,73143,88672,49802,50639,18129,93659,58389,49095,45971,34196,84609,59222,19332,17777,41004,47057,30688,16039,20906,41477,42915,60877,33864,75195,62294,3371,11672,1370,2486,35553,17907,90621,45136,9722,67635,12114,63055,16004,21625,24321,20491,26881,66259,94287,54751,36242,36557,5842,30687,65418,94608,24741,45887,78800,86912,42076,50287,9284,68891,76368,83094,96302,35997,30761,97081,9501,68887,32876,1705,34260,95065,45528,88241,30402,12318,52430,40139,96986,84900,72408,42027,31676,54382,73370,26184,14024,57444,57660,52173,30274,93448,63273,77681,74946,2099,69091,19372,66961,14595,58642,75760,52253,53148,26074,52293,65359,63971,4833,86492,1227,54505,19515,89889,46933,13364,33883,83389,36952,52505,67513,40071,31001,3105,87912,29610,75108,37363,28479,43546,89992,19550,54863,82633,19209,21548,35022,21960,57961,11815,95867,559,26428,69386,57453,70147,73538,49562,46806,64550,36653,25718,68792,31113,7607,48037,71020,22666,65957,11141,39227,7990,19849,65972,74528,40888,55386,95918,92088,91125,53648,66122,138,79933,71058,34826,97725,69513,22915,18246,52244,91161,40861,40374,13239,56162,4703,95851,22824,41271,28202,62852,84238,46625,20031,8524,20077,65817,21174,29279,57712,22401,67500,30980,74485,26480,21343,30031,61921,35744,57308,71196,1865,49234,62616,54021,29008,83672,85839,96836,45077,80900,66906,63526,93824,71820,11033,20183,85704,4683,63512,39144,56880,64424,95979,17709,94849,31771,5737,84286,16757,46256,24478,73180,59978,8254,78963,95437,86351,33824,32540,18357,2668,99260,21284,81351,70961,10255,6911,47394,72408,23827,59865,96395,30665,43699,3593,29165,23388,26628,92402,16731,86740,29493,9069,78653,90094,42735,33682,95041,89887,92369,57949,81585,50593,14698,4737,72551,57271,59433,156,33966,58773,59108,49578,18100,59836,73221,21110,1650,11058,47770,66141,84576,58388,40915,94507,32209,17272,65674,95552,25685,5345,36995,36302,7971,67001,62062,75939,36005,26739,56484,46885,66348,87666,78055,44485,82955,85936,9219,1847,92687,72579,45457,78252,98239,4e4,75563,92408,17175,78845,32638,26959,35406,59553,57852,7506,9,93172,77713,93880,40981,27924,9678,24538,52426,84852,83781,23712,82490,77890,22482,66668,55850,25644,44972,62275,78089,28894,98685,32998,98766,89119,34355,75127,69797,71419,62067,57990,96514,50603,79807,26135,29207,43632,32905,38513,18924,88872,20758,70232,60425,1116,24077,21369,93541,75329,78656,44251,42014,98154,42552,14575,30765,348,1134,71581,68420,78141,21105,63305,9718,54851,65867,8595,47390,39182,51174,41478,64433,59628,31945,87322,78667,95282,5622,26224,19972,97269,98376,14779,51138,49658,45345,4972,52794,15737,496,48939,63485,42780,16061,59631,37171,13483,56058,51093,62290,88227,17400,88433,67363,89507,26482,85964,71336,67799,28342,37747,61722,27180,78755,18603,42953,6606,23875,56766,1932,36113,62807,84012,21103,9685,69662,76755,13701,95168,13169,44726,15284,16702,89617,54397,52052,12835,37741,86434,22400,37947,95763,86337,35189,22756,47473,16618,42479,47405,14055,64262,66670,89692,54032,94591,44149,29854,76691,33263,62048,25116,88598,16119,62116,54517,31883,86707,18895,81790,71294,2684,15292,48107,14341,91416,75609,92564,39987,2283,89970,95855,80970,5432,89860,90293,99851,94648,5598,32171,28793,92305,64244,8277,93391,96717,34464,29838,10664,28050,60122,77934,10758,84922,92220,45071,97697,36368,17792,84792,76594,67319,51886,5665,45201,11348,9254,7510,51039,91683,84500,85338,5555,19633,3870,39576,41486,58524,54508,20707,58504,39642,22454,80069,83455,31043,90794,51934,3295,26582,16300,74990,22197,83310,69642,81113,58558,84833,17105,46659,25003,85749,44829,4103,67516,76458,52392,53546,70291,98846,67315,30686,18555,29755,5923,22732,19501,56181,85351,5023,4808,56911,16793,75336,49712,27723,96974,34321,5454,12862,71924,45928,95697,68664,58183,78104,42483,71204,99628,40642,56410,17350,13396,76724,87509,9158,83708,27298,92651,95086,38851,63558,89810,1580,32518,35795,26514,56322,78635,63731,91428,7247,66460,38671,26799,22549,47991,46064,80467,40083,17141,39152,99872,27561,75389,74778,94893,82935,99076,93419,10474,84436,47536,16719,60136,80566,28404,74525,74212,3704,65516,98197,34210,64140,22238,49939,99542,27481,21992,78181,90060,71365,66935,29578,14961,8569,9454,43308,66753,45972,93572,16382,87320,37183,25478,38164,31997,69856,60898,63968,62264,4799,17591,89937,73905,55890,88285,2448,40398,54180,65869,45155,43407,39105,339,51619,20203,21189,68245,76912,1222,76411,82679,7,66047,32043,42627,16638,27019,15248,66444,8249,18790,82150,54084,84469,3426,50226,99868,88894,43769,66384,8593,41414,2976,60053,51866,87904,74135,53842,59520,67482,16995,32328,29555,49067,2799,68851,41049,97190,53984,99755,46412,45885,64e3,21962,36438,71742,57223,66599,86071,31436,32667,98099,38399,47377,5171,2742,48803,17823,22093,9866,691,5514,25546,2114,5919,56181,96052,67211,61712,25995,3188,23833,38549,44775,55355,61548,55988,47309,23749,30667,70732,33299,16127,30842,78961,41072,9876,18903,30292,25275,61881,15939,72573,84502,92654,97226,53434,77025,63892,12421,33644,39445,30933,84218,13757,37719,84450,2697,60309,22402,80310,92771,45205,72792,95776,85945,74651,216,50842,47854,21916,61588,75405,10495,83083,60427,78495,99809,47890,22993,21508,9459,26845,98130,1184,46438,27698,40652,65654,98517,1096,6998,49133,57041,77983,58708,42176,67356,324,70063,10597,65205,25622,34336,16640,27896,26907,86760,48244,89650,44997,51609,28934,9171,97859,97213,19859,41037,64081,94781,27683,41521,52871,86935,26486,38744,25943,60617,6414,42292,46204,53262,30201,38776,88831,97253,67282,72860,18452,60927,81504,57713,30296,10896,39900,67135,42772,4631,55283,39253,25264,1809,12874,88035,88421,90491,83290,6884,15444,90113,20406,20796,40239,34431,15018,45600,17241,26611,9551,89126,65673,31708,91252,39647,63011,24193,58932,89326,33491,53217,27976,70151,37531,53576,23931,11789,73073,52171,89301,51718,15385,79487,66436,35771,34163,86540,42665,80748,77622,14679,40185,25030,42622,13162,17048,24243,59985,59807,60562,3595,10135,29199,69784,59796,38194,58432,50943,40422,63035,3208,81440,90749,88046,32218,88092,22224,2627,91576,16781,43948,57795,71073,27817,87077,82717,24473,42096,76920,88864,90537,14715,42551,45066,24316,37361,38582,21871,14672,93362,21727,57021,94313,39562,64985,94028,46094,43845,91838,79574,7597,3153,56783,18817,74711,6883,91061,31674,73729,99315,66183,57647,74484,68077,33224,397,56753,53158,71872,68153,9298,20961,49656,33407,95683,14328,44708,72952,27048,67887,28741,46752,88177,95894,40086,88534,87112,68614,83073,88794,96799,67588,75049,84603,83140,97347,87316,73087,77135,71883,98643,3808,8848,14133,60447,1366,72976,1868,51667,63279,60040,88264,79152,3474,61366,20523,21584,93712,83654,89761,90154,96345,37539,32556,74254,70603,97122,44978,78028,8943,13778,11080,34271,68276,85372,48410,94516,15427,75323,71685,70774,50342,33771,3678,42321,69788,41758,55004,30992,17402,63523,42328,87171,24751,15084,33884,83655,88345,69602,52606,57886,18034,3381,75796,35901,77480,28683,68324,66035,7223,14926,16128,13645,90370,31949,11057,98849,29499,21565,30786,83292,92392,37104,36899,49906,79368,43710,80365,88735,75275,21664,57965,19002,301,12658,94385,1717,96191,50404,80166,93965,24688,27839,10812,31715,92127,42588,93307,80834,11317,26583,25769,98227,14884,58462,29148,68662,26872,72927,79021,51622,29521,33355,45701,45996,33782,93424,16530,96086,17329,74020,11501,46660,5583,22277,77653,55430,84644,448,86828,58855,67451,95264,67386,82424,52611,60012,88620,72894,94716,22262,99813,69592,63464,33163,91857,47904,22209,78590,68615,52952,31441,41313,18550,72685,68825,4795,53971,14592,39634,23682,76630,2731,81481,86542,23727,54291,56045,61635,32186,9355,73416,63532,24340,18886,84832,30654,48543,18339,65024,91197,64624,74648,9660,27897,49771,11123,8732,49393,12911,72416,17834,18878,62754,85072,23727,56577,51257,83291,12329,16203,91681,68137,79959,43609,58987,2026,42969,59144,84349,75214,76972,22633,64104,53799,16851,99197,70476,77113,46320,88693,37711,96536,68156,7119,2104,49435,77706,18924,24957,92406,87148,70482,36491,42605,54440,7893,31618,35707,65130,30007,75706,77266,37100,9601,87681,42543,69847,81848,32034,49429,99434,62209,17125,55227,61634,52574,83649,28725,70119,62467,80676,21192,99584,21310,25292,72781,17186,10393,98390,19789,92931,36234,62627,23437,3885,58822,82941,43806,8172,23790,72295,36196,98200,2889,87619,13846,56197,27151,21238,48794,81100,62643,40001,39243,33213,78416,194,91369,79342,36404,52308,13741,24442,88610,12659,11574,70052,93039,79367,41792,61816,35435,47192,97596,28330,41145,16918,62865,9576,45857,68737,90124,16703,7071,48433,57222,34435,800,72496,16449,68187,28739,97672,86818,50768,40807,88681,64340,2224,19703,59245,90905,31239,84216,93942,97371,16842,92168,52692,16064,84686,89444,27938,98406,41365,4515,20494,18813,16242,10634,61566,18592,78057,8720,33739,78345,87693,30242,70545,55521,23687,9160,8655,38811,61768,7228,5567,5561,82071,85,50145,23113,97761,88441,14891,72188,85166,37189,75671,81377,92470,73645,93258,6610,12185,43065,26704,47922,56650,7527,18006,56948,51675,16658,66402,1047,81624,77395,62310,73262,66050,57275,32936,87641,51528,58183,21952,84098,28913,28622,18140,89796,41317,93954,67690,64667,57092,21315,4731,76115,77291,11204,8634,93034,27411,27149,13843,9817,9407,84492,28444,59901,14592,89654,66207,66232,80293,74502,36925,55515,10121,16768,4720,71502,40500,21406,571,87320,81683,42788,86367,44686,22159,67015,35892,49668,83991,72088,30210,74009,86370,97956,2132,93512,54819,26094,51409,21485,94764,85806,13393,48543,7042,76538,64224,47909,9994,23750,17351,52141,30486,60380,86546,66606,36913,58173,45709,83679,82617,23381,9603,61107,566,6572,64745,10614,86371,43244,97154,10397,50975,68006,20045,16942,25536,74031,31807,70133,78790,40341,68730,39635,39013,66841,44043,96215,21270,59427,25034,40645,84741,52083,54503,36861,27659,95463,53847,40921,70116,61536,56756,8967,31079,20097,76014,99818,16606,19713,66904,27106,24874,96701,73287,76772,6073,57343,51428,91171,28299,17520,64903,4177,36071,94952,59008,28543,11576,74547,13260,20688,41261,2780,6633,37536,8844,95774,49323,30448,14154,83379,71259,23302,68402,43750,88505,15575,44927,6584,29867,21541,65763,12154,86616,79877,73259,68626,98962,68548,86576,48046,51755,64995,3661,64585,81550,46798,49319,50206,22024,5175,12923,23427,55915,91723,55831,83784,81034,86779,34622,84570,18960,48798,42970,95789,39465,82353,68905,44234,18244,54345,5592,89361,14644,67924,66415,89349,88530,72096,44459,5258,48317,48866,56886,90458,75889,4514,37227,11302,4667,2129,80414,86289,15887,87380,50749,83220,50529,20619,11606,36531,23409,78122,19566,76564,33045,66703,30017,35347,35038,12952,13971,3922,98702,11786,38388,69556,76728,60535,59961,23634,42211,98387,34880,27755,93182,99040,96390,65989,38375,3652,59657,57431,24666,11061,64713,85185,72849,58611,31220,26657,77056,24553,24993,5210,89024,32054,46997,92652,28363,98992,22593,97710,47766,37646,93573,95502,33790,92973,27766,62671,89698,10877,73893,41004,96035,18795,48080,59666,30241,35233,87353,43647,13404,41982,19264,29229,61369,8309,39383,42305,25944,13577,51545,68990,69801,37145,79189,55897,57793,66816,21930,56771,79296,73793,21632,42301,23696,72641,56310,85576,3004,25669,69221,32996,23040,65782,23712,13414,10758,15590,97298,74246,51511,46900,36795,38292,3852,6384,84421,3446,91670,45312,27609,87034,6683,83891,88991,16533,9197,34427,60384,48525,90978,46107,21693,12956,21804,46558,37682,81207,85840,53238,35026,4835,53264,41376,17783,64756,39278,25403,33042,20954,31193,24247,45911,92453,25370,86602,48574,57865,26436,16122,76614,17028,21262,59718,77821,14036,31033,90563,45410,15158,90209,84089,38053,60780,54166,14255,33120,27171,71798,91214,80040,56699,12475,40193,59415,4769,75920,1036,2692,75862,16612,73670,61182,3305,90334,187,91659,28063,75684,50017,82643,9282,77376,85469,8164,5584,36623,82597,83859,3435,98460,70095,80257,4381,6501,8924,35514,14297,54373,71369,5172,15955,82441,4636,48215,6821,3385,17663,40107,55679,30366,42390,95895,16083,58499,17176,55993,51034,49296,4010,78974,35930,2019,96226,27167,68245,53109,59037,37843,79243,10262,58797,61490,82590,52411,54783,29447,94551,30026,97959,93939,73217,82573,62154,78291,33728,39102,11484,86210,43794,73553,87435,1110,77108,56521,78610,8254,1842,43068,70415,79195,26136,49786,47279,38471,20379,54704,86614,91138,51595,50818,80186,73087,17262,94735,4952,27935,4928,74862,51392,62388,9570,38485,30594,56278,47395,72762,94597,72279,16010,34697,54475,67874,78014,88381,4045,41494,55178,46054,24373,1824,55333,7525,97908,61178,84635,2199,35361,4803,21907,79414,66083,54782,58692,28332,41851,28198,55819,37313,67046,16147,90478,71230,34141,85002,44332,35906,429,39744,773,22909,19536,98986,90945,45209,85439,92265,25291,22775,60611,49159,95701,36113,53923,60824,84935,29656,50007,86624,61691,76150,32187,42765,60660,13859,10792,88210,29374,29563,45188,28811,19739,67649,73775,99247,48414,91067,68253,9452,90116,91737,73979,62370,69112,58791,20349,71480,56852,36919,87977,77609,68738,85159,4918,70076,46473,4122,57713,1426,50987,77910,66211,62546,77749,96462,34304,77441,12104,91805,10287,60943,49632,83116,25716,23113,22707,77770,31176,6759,46130,4739,55554,3843,31653,70834,72877,41561,36903,23010,6663,2266,16360,70118,91936,17098,77278,4880,23484,94970,41826,46733,93484,68350,38861,18134,32936,241,24803,13876,93278,5039,35873,44418,5305,28510,36115,46717,15238,78607,23464,68635,55712,55007,92411,65739,4858,67537,37041,67453,89801,45963,14800,14225,65655,80463,9716,77255,65136,11230,76323,81433,36445,86523,61058,59560,19380,40791,48073,29626,36661,87907,57369,41623,13705,3880,45088,55444,41003,27754,1450,75312,71801,99600,60719,54182,29245,63315,73758,42973,32702,10855,56363,14638,84424,27178,78195,3133,70865,48019,26117,7151,52107,85562,41347,50486,69457,86961,95482,11857,93587,45680,42145,13029,10043,5142,49213,54525,85761,42707,70754,33768,87671,85038,58900,88438,20004,63390,14815,38875,73417,82875,89481,55517,944,15773,61814,32915,27868,5510,21916,28426,89881,16680,88850,11056,51991,4230,39107,49216,40065,4523,75848,95349,56034,10724,9885,88232,42478,65702,95696,39746,66032,88082,86905,30007,75068,66629,7358,26706,90511,72843,67857,20061,98581,69682,38e3,14186,70,2290,17269,30909,69449,19997,13275,2444,84985,51290,97641,15092,69650,21920,19617,7418,49725,91090,20805,28627,80665,67192,34697,57667,99323,50101,40587,35081,14037,34414,19898,60779,83267,87499,29596,41852,15813,32419,72232,8322,39184,46525,13833,65743,94595,37363,4711,35386,96413,10627,62625,56555,12919,93218,25191,98380,51923,66181,5788,73491,1452,487,12277,45415,11884,61300,94528,9181,26616,11455,31514,63290,45035,42759,33804,85721,80979,46010,50975,72482,31231,3086,58941,46102,25773,89742,29788,96741,88523,14922,88262,76305,57676,93259,2396,69145,26074,30056,3853,75317,56639,66203,38923,48939,22813,91864,10934,6714,84099,25631,73223,95630,97552,45950,22197,42886,33764,1263,41856,82057,62349,94091,78028,62651,18911,5693,92561,97821,41994,92343,76785,22216,4203,5038,86151,23596,24338,77181,51761,97693,10955,98159,37568,58932,72128,27303,99608,31688,57557,91022,43036,93927,32869,53653,55205,33139,47271,31224,51650,36422,86857,73799,22068,43376,84760,44898,65776,42451,71480,38509,41673,44141,75918,95652,68981,83001,48815,98086,67950,27986,33175,43624,55274,71051,61124,51550,64967,31570,15748,19159,38174,51078,79811,39183,57527,96550,85168,28824,47466,56993,13151,96664,29735,70251,1079,4314,77714,11507,1440,48415,31984,99915,20282,26524,18057,4992,40521,98108,84045,91961,79256,72244,25788,5487,23595,73302,14205,8925,27625,64343,28821,37992,67156,83320,31106,10884,30735,15067,51091,15668,48777,50770,19169,76504,41165,29749,92812,8065,66782,26841,1411,95461,61134,18699,52261,60469,81373,44825,11448,73320,30151,56991,31372,6655,36472,86292,30247,30931,21029,53410,9859,37267,47514,3492,49008,94727,25234,40546,53417,36492,25723,76227,58456,15979,34876,9574,34392,3751,36933,83921,65108,63135,67572,40184,21098],d=new Array(16),g=[16,8,16,24],b=4,y=0;(function(){for(var x=0;x<16;x++){d[x]=new Array(256);for(var _=0;_<256;_++)d[x][_]=_|_<<8|_<<16|_<<24|0;for(var S=3;0<=S;S--)for(var I=0;I<255;I++){var O=255<<(S<<3),F=0|d[x][I],D=function(k,w){var C=w-k+1,T=0,z=1;do for(T=0,z=1;z<C;z*=10)T=10*T+(b<0&&(b=4,y++),m[y]%Math.pow(10,b+1)/Math.pow(10,b--)|0);while((z/C|0)*C<=T);return k+T%C|0}(I,255);d[x][I]=d[x][I]&~O|d[x][D]&O|0,d[x][D]=d[x][D]&~O|F&O|0}}})(),function(x,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");x.prototype=Object.create(_&&_.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),_&&f(x,_)}(p,l.a),function(x,_){for(var S=0;S<_.length;S++){var I=_[S];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(x,I.key,I)}}(p.prototype,[{key:"reset",value:function(){s(u(p.prototype),"reset",this).call(this),this.state.hash=new Array(this.options.length/32|0);for(var x=0;x<this.state.hash.length;x++)this.state.hash[x]=0}},{key:"processBlock",value:function(x){for(var _=0;_<this.state.hash.length;_++)this.W[_]=0|this.state.hash[_];for(var S=this.state.hash.length;S<16;S++)this.W[S]=0|x[S-this.state.hash.length];for(var I=0;I<this.options.rounds<<1;I+=2)for(var O=0;O<4;O++){for(var F=0;F<16;F++){var D=0|d[I+(F/2|0)%2][255&this.W[F]];this.W[F-1>>>0&15]^=D,this.W[F+1&15]^=D}for(var k=0;k<16;k++)this.W[k]=Object(o.b)(this.W[k],g[O])}for(var w=0;w<this.state.hash.length;w++)this.state.hash[w]=this.state.hash[w]^this.W[15-w]|0}},{key:"finalize",value:function(){return 0<this.state.message.length&&this.addPaddingZero(this.blockSizeInBytes-this.state.message.length|0),this.addPaddingZero(this.blockSizeInBytes-8|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),l=p;function p(x){var _;return function(S){if(!(S instanceof p))throw new TypeError("Cannot call a class as a function")}(this),(x=x||{}).length=x.length||128,x.rounds=x.rounds||8,_=this,(x=!(x=u(p).call(this,x))||a(x)!=="object"&&typeof x!="function"?function(){if(_!==void 0)return _;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():x).blockSize=16-x.state.hash.length,x.blockSizeInBytes=x.blockSize*x.unitSize,x.W=new Array(16),x}n.a=l},function(e,n,t){"use strict";var l=t(5),o=t(0);function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(p)}function s(p,x){for(var _=0;_<x.length;_++){var S=x[_];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(p,S.key,S)}}function u(p,x,_){return(u=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(S,I,O){if(S=function(F,D){for(;!Object.prototype.hasOwnProperty.call(F,D)&&(F=f(F))!==null;);return F}(S,I),S)return I=Object.getOwnPropertyDescriptor(S,I),I.get?I.get.call(O):I.value})(p,x,_||p)}function f(p){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(p)}function m(p,x){return(m=Object.setPrototypeOf||function(_,S){return _.__proto__=S,_})(p,x)}for(var d=[[7,12,17,22],[5,9,14,20],[4,11,16,23],[6,10,15,21]],g=new Array(64),b=0;b<64;b++)g[b]=4294967296*Math.abs(Math.sin(b+1))|0;(function(p,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(x&&x.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),x&&m(p,x)})(y,l.a),t=[{key:"FF",value:function(p,x,_){return p&x|~p&_}},{key:"GG",value:function(p,x,_){return p&_|x&~_}},{key:"HH",value:function(p,x,_){return p^x^_}},{key:"II",value:function(p,x,_){return x^(p|~_)}},{key:"CC",value:function(p,x,_,S,I,O,F,D){return Object(o.a)(_+p(S,I,O)+F+x,D)+S|0}}],s((l=y).prototype,[{key:"reset",value:function(){u(f(y.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878]}},{key:"processBlock",value:function(p){var x=0|this.state.hash[0],_=0|this.state.hash[1],S=0|this.state.hash[2],I=0|this.state.hash[3],x=y.CC(y.FF,g[0],x,_,S,I,p[0],d[0][0]),I=y.CC(y.FF,g[1],I,x,_,S,p[1],d[0][1]),S=y.CC(y.FF,g[2],S,I,x,_,p[2],d[0][2]),_=y.CC(y.FF,g[3],_,S,I,x,p[3],d[0][3]);x=y.CC(y.FF,g[4],x,_,S,I,p[4],d[0][0]),I=y.CC(y.FF,g[5],I,x,_,S,p[5],d[0][1]),S=y.CC(y.FF,g[6],S,I,x,_,p[6],d[0][2]),_=y.CC(y.FF,g[7],_,S,I,x,p[7],d[0][3]),x=y.CC(y.FF,g[8],x,_,S,I,p[8],d[0][0]),I=y.CC(y.FF,g[9],I,x,_,S,p[9],d[0][1]),S=y.CC(y.FF,g[10],S,I,x,_,p[10],d[0][2]),_=y.CC(y.FF,g[11],_,S,I,x,p[11],d[0][3]),x=y.CC(y.FF,g[12],x,_,S,I,p[12],d[0][0]),I=y.CC(y.FF,g[13],I,x,_,S,p[13],d[0][1]),S=y.CC(y.FF,g[14],S,I,x,_,p[14],d[0][2]),_=y.CC(y.FF,g[15],_,S,I,x,p[15],d[0][3]),x=y.CC(y.GG,g[16],x,_,S,I,p[1],d[1][0]),I=y.CC(y.GG,g[17],I,x,_,S,p[6],d[1][1]),S=y.CC(y.GG,g[18],S,I,x,_,p[11],d[1][2]),_=y.CC(y.GG,g[19],_,S,I,x,p[0],d[1][3]),x=y.CC(y.GG,g[20],x,_,S,I,p[5],d[1][0]),I=y.CC(y.GG,g[21],I,x,_,S,p[10],d[1][1]),S=y.CC(y.GG,g[22],S,I,x,_,p[15],d[1][2]),_=y.CC(y.GG,g[23],_,S,I,x,p[4],d[1][3]),x=y.CC(y.GG,g[24],x,_,S,I,p[9],d[1][0]),I=y.CC(y.GG,g[25],I,x,_,S,p[14],d[1][1]),S=y.CC(y.GG,g[26],S,I,x,_,p[3],d[1][2]),_=y.CC(y.GG,g[27],_,S,I,x,p[8],d[1][3]),x=y.CC(y.GG,g[28],x,_,S,I,p[13],d[1][0]),I=y.CC(y.GG,g[29],I,x,_,S,p[2],d[1][1]),S=y.CC(y.GG,g[30],S,I,x,_,p[7],d[1][2]),_=y.CC(y.GG,g[31],_,S,I,x,p[12],d[1][3]),x=y.CC(y.HH,g[32],x,_,S,I,p[5],d[2][0]),I=y.CC(y.HH,g[33],I,x,_,S,p[8],d[2][1]),S=y.CC(y.HH,g[34],S,I,x,_,p[11],d[2][2]),_=y.CC(y.HH,g[35],_,S,I,x,p[14],d[2][3]),x=y.CC(y.HH,g[36],x,_,S,I,p[1],d[2][0]),I=y.CC(y.HH,g[37],I,x,_,S,p[4],d[2][1]),S=y.CC(y.HH,g[38],S,I,x,_,p[7],d[2][2]),_=y.CC(y.HH,g[39],_,S,I,x,p[10],d[2][3]),x=y.CC(y.HH,g[40],x,_,S,I,p[13],d[2][0]),I=y.CC(y.HH,g[41],I,x,_,S,p[0],d[2][1]),S=y.CC(y.HH,g[42],S,I,x,_,p[3],d[2][2]),_=y.CC(y.HH,g[43],_,S,I,x,p[6],d[2][3]),x=y.CC(y.HH,g[44],x,_,S,I,p[9],d[2][0]),I=y.CC(y.HH,g[45],I,x,_,S,p[12],d[2][1]),S=y.CC(y.HH,g[46],S,I,x,_,p[15],d[2][2]),_=y.CC(y.HH,g[47],_,S,I,x,p[2],d[2][3]),x=y.CC(y.II,g[48],x,_,S,I,p[0],d[3][0]),I=y.CC(y.II,g[49],I,x,_,S,p[7],d[3][1]),S=y.CC(y.II,g[50],S,I,x,_,p[14],d[3][2]),_=y.CC(y.II,g[51],_,S,I,x,p[5],d[3][3]),x=y.CC(y.II,g[52],x,_,S,I,p[12],d[3][0]),I=y.CC(y.II,g[53],I,x,_,S,p[3],d[3][1]),S=y.CC(y.II,g[54],S,I,x,_,p[10],d[3][2]),_=y.CC(y.II,g[55],_,S,I,x,p[1],d[3][3]),x=y.CC(y.II,g[56],x,_,S,I,p[8],d[3][0]),I=y.CC(y.II,g[57],I,x,_,S,p[15],d[3][1]),S=y.CC(y.II,g[58],S,I,x,_,p[6],d[3][2]),_=y.CC(y.II,g[59],_,S,I,x,p[13],d[3][3]),x=y.CC(y.II,g[60],x,_,S,I,p[4],d[3][0]),I=y.CC(y.II,g[61],I,x,_,S,p[11],d[3][1]),S=y.CC(y.II,g[62],S,I,x,_,p[2],d[3][2]),_=y.CC(y.II,g[63],_,S,I,x,p[9],d[3][3]),this.state.hash[0]=this.state.hash[0]+x|0,this.state.hash[1]=this.state.hash[1]+_|0,this.state.hash[2]=this.state.hash[2]+S|0,this.state.hash[3]=this.state.hash[3]+I|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),s(l,t),t=y;function y(){return function(_){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}(this),p=this,!(x=f(y).apply(this,arguments))||a(x)!=="object"&&typeof x!="function"?function(){if(p!==void 0)return p;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():x;var p,x}n.a=t},function(e,n,t){"use strict";var l=t(3),o=t(0);function a(g){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(g)}function s(g,b,y){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(p,x,_){if(p=function(S,I){for(;!Object.prototype.hasOwnProperty.call(S,I)&&(S=u(S))!==null;);return S}(p,x),p)return x=Object.getOwnPropertyDescriptor(p,x),x.get?x.get.call(_):x.value})(g,b,y||g)}function u(g){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(g)}function f(g,b){return(f=Object.setPrototypeOf||function(y,p){return y.__proto__=p,y})(g,b)}var m=[1518500249,1859775393,2400959708,3395469782],l=(function(g,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(b&&b.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),b&&f(g,b)}(d,l.a),function(g,b){for(var y=0;y<b.length;y++){var p=b[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(g,p.key,p)}}(d.prototype,[{key:"reset",value:function(){s(u(d.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878,-1009589776]}},{key:"processBlock",value:function(g){for(var b=0|this.state.hash[0],y=0|this.state.hash[1],p=0|this.state.hash[2],x=0|this.state.hash[3],_=0|this.state.hash[4],S=0;S<this.options.rounds;S++){this.W[S]=S<16?0|g[S]:0|Object(o.a)(this.W[S-3]^this.W[S-8]^this.W[S-14]^this.W[S-16],1);var I=Object(o.a)(b,5)+_+this.W[S]+m[S/20>>0]|0,I=S<20?I+(y&p|~y&x)|0:!(S<40)&&S<60?I+(y&p|y&x|p&x)|0:I+(y^p^x)|0,_=x,x=p,p=0|Object(o.a)(y,30),y=b,b=I}this.state.hash[0]=this.state.hash[0]+b|0,this.state.hash[1]=this.state.hash[1]+y|0,this.state.hash[2]=this.state.hash[2]+p|0,this.state.hash[3]=this.state.hash[3]+x|0,this.state.hash[4]=this.state.hash[4]+_|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),d);function d(g){var b;return function(y){if(!(y instanceof d))throw new TypeError("Cannot call a class as a function")}(this),b=this,(g=!(g=u(d).call(this,g))||a(g)!=="object"&&typeof g!="function"?function(){if(b!==void 0)return b;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():g).options.rounds=g.options.rounds||80,g.W=new Array(80),g}n.a=l},function(e,n,t){"use strict";var l=t(0),t=t(3);function o(w){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(w)}function a(w,C,T){return(a=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(z,A,M){if(z=function(P,N){for(;!Object.prototype.hasOwnProperty.call(P,N)&&(P=s(P))!==null;);return P}(z,A),z)return A=Object.getOwnPropertyDescriptor(z,A),A.get?A.get.call(M):A.value})(w,C,T||w)}function s(w){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)})(w)}function u(w,C){return(u=Object.setPrototypeOf||function(T,z){return T.__proto__=z,T})(w,C)}var f=new Array(256),m=[104,208,235,43,72,157,106,228,227,163,86,129,125,241,133,158,44,142,120,202,23,169,97,213,93,11,140,60,119,81,34,66,63,84,65,128,204,134,179,24,46,87,6,98,244,54,209,107,27,101,117,16,218,73,38,249,203,102,231,186,174,80,82,171,5,240,13,115,59,4,32,254,221,245,180,95,10,181,192,160,113,165,45,96,114,147,57,8,131,33,92,135,177,224,0,195,18,145,138,2,28,230,69,194,196,253,191,68,161,76,51,197,132,35,124,176,37,21,53,105,255,148,77,112,162,175,205,214,108,183,248,9,243,103,164,234,236,182,212,210,20,30,225,36,56,198,219,75,122,58,222,94,223,149,252,170,215,206,7,15,61,88,154,152,156,242,167,17,126,139,67,3,226,220,229,178,78,199,109,233,39,64,216,55,146,143,1,29,83,62,89,193,79,50,22,250,116,251,99,159,52,26,42,90,141,201,207,246,144,40,136,155,49,14,189,74,232,150,166,12,200,121,188,190,239,110,70,151,91,237,25,217,172,153,168,41,100,31,173,85,19,187,247,111,185,71,47,238,184,123,137,48,211,127,118,130],d=[1,11,9,12,13,6,15,3,14,8,7,4,10,2,5,0],g=[7,12,11,13,14,4,9,15,6,3,8,10,2,5,1,0],b=new Array(16),y=[1,1,4,1,8,5,2,9],p=[1,1,3,1,5,8,9,5],x=new Array(512),_=new Array(22),S=new Array(512),I=new Array(22),O=new Array(512),F=new Array(22);function D(w,C){for(var T=new Array(512),z=new Array(22),A=0;A<8;A++)T[A]=[];for(var M=0;M<256;M++){var P=new Array(10);P[1]=w[M],P[2]=P[1]<<1,256<=P[2]&&(P[2]^=285),P[3]=P[2]^P[1],P[4]=P[2]<<1,256<=P[4]&&(P[4]^=285),P[5]=P[4]^P[1],P[8]=P[4]<<1,256<=P[8]&&(P[8]^=285),P[9]=P[8]^P[1],T[0][2*M]=P[C[0]]<<24|P[C[1]]<<16|P[C[2]]<<8|P[C[3]],T[0][2*M+1]=P[C[4]]<<24|P[C[5]]<<16|P[C[6]]<<8|P[C[7]];for(var N=1;N<8;N++)T[N][2*M]=Object(l.d)(T[0][2*M+1],T[0][2*M],N<<3),T[N][2*M+1]=Object(l.c)(T[0][2*M+1],T[0][2*M],N<<3)}z[0]=0,z[1]=0;for(var E=1;E<=10;E++)z[2*E]=4278190080&T[0][16*E-16]^16711680&T[1][16*E-14]^65280&T[2][16*E-12]^255&T[3][16*E-10],z[2*E+1]=4278190080&T[4][16*E-7]^16711680&T[5][16*E-5]^65280&T[6][16*E-3]^255&T[7][16*E-1];return[T,z]}(function(){(function(){for(var C=0;C<16;C++)b[d[C]]=0|C;for(var T=0;T<256;T++){var z=d[T>>4],A=b[15&T],M=g[z^A];f[T]=d[z^M]<<4|b[A^M]}})();var w=D(m,p);S=w[0],I=w[1],w=D(f,p),O=w[0],F=w[1],w=D(f,y),x=w[0],_=w[1]})(),function(w,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(C&&C.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),C&&u(w,C)}(k,t.a),function(w,C){for(var T=0;T<C.length;T++){var z=C[T];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(w,z.key,z)}}(k.prototype,[{key:"reset",value:function(){a(s(k.prototype),"reset",this).call(this),this.state.hash=new Array(16);for(var w=0;w<16;w++)this.state.hash[w]=0}},{key:"processBlock",value:function(w){for(var C=new Array(16),T=[],z=0;z<16;z++)T[z]=w[z]^(C[z]=this.state.hash[z])|0;for(var A=[],M=1;M<=this.options.rounds;M++){for(var P=0;P<8;P++){A[2*P]=0;for(var N=A[2*P+1]=0,E=56,B=0;N<8;N++,B=(E-=8)<32?1:0)A[2*P]^=this.C[N][2*(C[2*(P-N&7)+B]>>>E%32&255)],A[2*P+1]^=this.C[N][2*(C[2*(P-N&7)+B]>>>E%32&255)+1]}for(var U=0;U<16;U++)C[U]=A[U];C[0]^=this.RC[2*M],C[1]^=this.RC[2*M+1];for(var X=0;X<8;X++){A[2*X]=C[2*X],A[2*X+1]=C[2*X+1];for(var le=0,he=56,Z=0;le<8;le++,Z=(he-=8)<32?1:0)A[2*X]^=this.C[le][2*(T[2*(X-le&7)+Z]>>>he%32&255)],A[2*X+1]^=this.C[le][2*(T[2*(X-le&7)+Z]>>>he%32&255)+1]}for(var ae=0;ae<16;ae++)T[ae]=A[ae]}for(var J=0;J<16;J++)this.state.hash[J]^=T[J]^w[J]}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<32?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),t=k;function k(w){var C,T;switch(function(z){if(!(z instanceof k))throw new TypeError("Cannot call a class as a function")}(this),(w=w||{}).type=w.type||"",w.rounds=w.rounds||10,T=this,(C=!(w=s(k).call(this,w))||o(w)!=="object"&&typeof w!="function"?function(){if(T!==void 0)return T;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():w).options.type){case"0":case 0:C.C=S,C.RC=I;break;case"t":C.C=O,C.RC=F;break;default:C.C=x,C.RC=_}return C}n.a=t},function(e,n,t){"use strict";function l(y){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(y)}function o(y){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(p){return p.__proto__||Object.getPrototypeOf(p)})(y)}function a(y,p){return(a=Object.setPrototypeOf||function(x,_){return x.__proto__=_,x})(y,p)}(function(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(p&&p.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),p&&a(y,p)})(s,t(4).a),function(y,p){for(var x=0;x<p.length;x++){var _=p[x];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(y,_.key,_)}}(s.prototype,[{key:"process",value:function(){for(;this.state.message.length>=this.blockSizeInBytes;){this.blockUnits=new Array(this.blockSizeInBytes);for(var y=0;y<this.blockSizeInBytes;y++)this.blockUnits[y]=0|this.state.message.charCodeAt(y);this.state.message=this.state.message.substr(this.blockSizeInBytes),this.processBlock(this.blockUnits)}}},{key:"processBlock",value:function(y){}},{key:"getStateHash",value:function(y){y=y||this.state.hash.length;for(var p="",x=0;x<y;x++)p+=String.fromCharCode(255&this.state.hash[x]);return p}}]),t=s;function s(y){var p;return function(x){if(!(x instanceof s))throw new TypeError("Cannot call a class as a function")}(this),p=this,(y=!(y=o(s).call(this,y))||l(y)!=="object"&&typeof y!="function"?function(){if(p!==void 0)return p;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():y).unitSize=1,y.blockSizeInBytes=y.blockSize*y.unitSize,y.blockUnits=[],y}function u(y){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p})(y)}function f(y,p,x){return(f=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(_,S,I){if(_=function(O,F){for(;!Object.prototype.hasOwnProperty.call(O,F)&&(O=m(O))!==null;);return O}(_,S),_)return S=Object.getOwnPropertyDescriptor(_,S),S.get?S.get.call(I):S.value})(y,p,x||y)}function m(y){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(p){return p.__proto__||Object.getPrototypeOf(p)})(y)}function d(y,p){return(d=Object.setPrototypeOf||function(x,_){return x.__proto__=_,x})(y,p)}var g=[41,46,67,201,162,216,124,1,61,54,84,161,236,240,6,19,98,167,5,243,192,199,115,140,152,147,43,217,188,76,130,202,30,155,87,60,253,212,224,22,103,66,111,24,138,23,229,18,190,78,196,214,218,158,222,73,160,251,245,142,187,47,238,122,169,104,121,145,21,178,7,63,148,194,16,137,11,34,95,33,128,127,93,154,90,144,50,39,53,62,204,231,191,247,151,3,255,25,48,179,72,165,181,209,215,94,146,42,172,86,170,198,79,184,56,210,150,164,125,182,118,252,107,226,156,116,4,241,69,157,112,89,100,113,135,32,134,91,207,101,230,45,168,2,27,96,37,173,174,176,185,246,28,70,97,105,52,64,126,15,85,71,163,35,221,81,175,58,195,92,249,206,186,197,234,38,44,83,13,110,133,40,132,9,211,223,205,244,65,129,77,82,106,220,55,200,108,193,171,250,36,225,123,8,12,189,177,74,120,136,149,139,227,99,232,109,233,203,213,254,59,0,29,57,242,239,183,14,102,88,208,228,166,119,114,248,235,117,75,10,49,68,80,180,143,237,31,26,219,153,141,51,159,17,131,20],t=(function(y,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function");y.prototype=Object.create(p.prototype,{constructor:{value:y,writable:!0,configurable:!0}}),d(y,p)}(b,t),function(y,p){for(var x=0;x<p.length;x++){var _=p[x];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(y,_.key,_)}}(b.prototype,[{key:"reset",value:function(){f(m(b.prototype),"reset",this).call(this),this.state.hash=new Array(48),this.state.checksum=new Array(16)}},{key:"processBlock",value:function(y){for(var p=0;p<16;p++)this.state.hash[16+p]=0|y[p],this.state.hash[32+p]=y[p]^this.state.hash[p];for(var x=0,_=0;_<this.options.rounds;_++){for(var S=0;S<48;S++)x=this.state.hash[S]^=g[x];x=x+_&255}x=255&this.state.checksum[15];for(var I=0;I<16;I++)x=this.state.checksum[I]^=g[y[I]^x]}},{key:"finalize",value:function(){this.addPaddingPKCS7(16-(15&this.state.message.length)|0),this.process();for(var y=0;y<16;y++)this.state.message+=String.fromCharCode(this.state.checksum[y]);return this.process(),this.getStateHash(16)}}]),b);function b(y){var p;return function(x){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}(this),p=this,(y=!(y=m(b).call(this,y))||u(y)!=="object"&&typeof y!="function"?function(){if(p!==void 0)return p;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():y).options.rounds=y.options.rounds||18,y}n.a=t},function(e,n,t){"use strict";var l=t(5),o=t(0);function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(p)}function s(p,x,_){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(S,I,O){if(S=function(F,D){for(;!Object.prototype.hasOwnProperty.call(F,D)&&(F=u(F))!==null;);return F}(S,I),S)return I=Object.getOwnPropertyDescriptor(S,I),I.get?I.get.call(O):I.value})(p,x,_||p)}function u(p){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(p)}function f(p,x){return(f=Object.setPrototypeOf||function(_,S){return _.__proto__=S,_})(p,x)}var m=[0,1518500249,1859775393,2400959708],d=[5,11,7,15,6,13,8,14,7,12,9,11,8,15,6,12,9,14,5,13],g=[10,17,25,30],b=[18,0,1,2,3,19,4,5,6,7,16,8,9,10,11,17,12,13,14,15,22,3,6,9,12,23,15,2,5,8,20,11,14,1,4,21,7,10,13,0,26,12,5,14,7,27,0,9,2,11,24,4,13,6,15,25,8,1,10,3,30,7,2,13,8,31,3,14,9,4,28,15,10,5,0,29,11,6,1,12],l=(function(p,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(x&&x.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),x&&f(p,x)}(y,l.a),function(p,x){for(var _=0;_<x.length;_++){var S=x[_];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(p,S.key,S)}}(y.prototype,[{key:"reset",value:function(){s(u(y.prototype),"reset",this).call(this),this.state.hash=[1732584193,4023233417,2562383102,271733878,3285377520]}},{key:"processBlock",value:function(p){for(var x=0|this.state.hash[0],_=0|this.state.hash[1],S=0|this.state.hash[2],I=0|this.state.hash[3],O=0|this.state.hash[4],F=0;F<16;F++)this.W[F]=0|p[F];this.W[16]=this.W[0]^this.W[1]^this.W[2]^this.W[3]|0,this.W[17]=this.W[4]^this.W[5]^this.W[6]^this.W[7]|0,this.W[18]=this.W[8]^this.W[9]^this.W[10]^this.W[11]|0,this.W[19]=this.W[12]^this.W[13]^this.W[14]^this.W[15]|0,this.W[20]=this.W[3]^this.W[6]^this.W[9]^this.W[12]|0,this.W[21]=this.W[2]^this.W[5]^this.W[8]^this.W[15]|0,this.W[22]=this.W[1]^this.W[4]^this.W[11]^this.W[14]|0,this.W[23]=this.W[0]^this.W[7]^this.W[10]^this.W[13]|0,this.W[24]=this.W[5]^this.W[7]^this.W[12]^this.W[14]|0,this.W[25]=this.W[0]^this.W[2]^this.W[9]^this.W[11]|0,this.W[26]=this.W[4]^this.W[6]^this.W[13]^this.W[15]|0,this.W[27]=this.W[1]^this.W[3]^this.W[8]^this.W[10]|0,this.W[28]=this.W[2]^this.W[7]^this.W[8]^this.W[13]|0,this.W[29]=this.W[3]^this.W[4]^this.W[9]^this.W[14]|0,this.W[30]=this.W[0]^this.W[5]^this.W[10]^this.W[15]|0,this.W[31]=this.W[1]^this.W[6]^this.W[11]^this.W[12]|0;for(var D=0;D<this.options.rounds;D++)var k=Object(o.a)(x,d[D%20])+O+this.W[b[D]]+m[D/20>>0]|0,k=D<20?k+(_&S|~_&I)|0:!(D<40)&&D<60?k+(S^(_|~I))|0:k+(_^S^I)|0,O=I,I=S,S=0|Object(o.a)(_,g[D/20>>0]),_=x,x=k;this.state.hash[0]=this.state.hash[0]+x|0,this.state.hash[1]=this.state.hash[1]+_|0,this.state.hash[2]=this.state.hash[2]+S|0,this.state.hash[3]=this.state.hash[3]+I|0,this.state.hash[4]=this.state.hash[4]+O|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),y);function y(p){var x;return function(_){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}(this),x=this,(p=!(p=u(y).call(this,p))||a(p)!=="object"&&typeof p!="function"?function(){if(x!==void 0)return x;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():p).options.rounds=p.options.rounds||80,p.W=new Array(32),p}n.a=l},function(e,n,t){"use strict";t.d(n,"a",function(){return o});var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function o(a){for(var s="",u=a.length-a.length%3|0,f=0,m=0;m<u;m+=3)f=a.charCodeAt(m)<<16|a.charCodeAt(m+1)<<8|a.charCodeAt(m+2),s+=l.charAt(f>>18)+l.charAt(f>>12&63)+l.charAt(f>>6&63)+l.charAt(63&f);return a.length-u==2?(f=a.charCodeAt(u)<<16|a.charCodeAt(1+u)<<8,s+=l.charAt(f>>18)+l.charAt(f>>12&63)+l.charAt(f>>6&63)+"="):a.length-u==1&&(f=a.charCodeAt(u)<<16,s+=l.charAt(f>>18)+l.charAt(f>>12&63)+"=="),s}},function(e,n,t){"use strict";var l=t(5),o=t(0);function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(p)}function s(p,x){for(var _=0;_<x.length;_++){var S=x[_];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(p,S.key,S)}}function u(p,x,_){return(u=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(S,I,O){if(S=function(F,D){for(;!Object.prototype.hasOwnProperty.call(F,D)&&(F=f(F))!==null;);return F}(S,I),S)return I=Object.getOwnPropertyDescriptor(S,I),I.get?I.get.call(O):I.value})(p,x,_||p)}function f(p){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(p)}function m(p,x){return(m=Object.setPrototypeOf||function(_,S){return _.__proto__=S,_})(p,x)}var d=[[3,7,11,19],[3,5,9,13],[3,9,11,15]],g=1518500249,b=1859775393,t=(function(p,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(x&&x.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),x&&m(p,x)}(y,l.a),t=[{key:"FF",value:function(p,x,_){return p&x|~p&_}},{key:"GG",value:function(p,x,_){return p&x|p&_|x&_}},{key:"HH",value:function(p,x,_){return p^x^_}},{key:"CC",value:function(p,x,_,S,I,O,F,D){return 0|Object(o.a)(_+p(S,I,O)+F+x,D)}}],s((l=y).prototype,[{key:"reset",value:function(){u(f(y.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878]}},{key:"processBlock",value:function(p){var x=0|this.state.hash[0],_=0|this.state.hash[1],S=0|this.state.hash[2],I=0|this.state.hash[3],x=y.CC(y.FF,0,x,_,S,I,p[0],d[0][0]),I=y.CC(y.FF,0,I,x,_,S,p[1],d[0][1]),S=y.CC(y.FF,0,S,I,x,_,p[2],d[0][2]),_=y.CC(y.FF,0,_,S,I,x,p[3],d[0][3]);x=y.CC(y.FF,0,x,_,S,I,p[4],d[0][0]),I=y.CC(y.FF,0,I,x,_,S,p[5],d[0][1]),S=y.CC(y.FF,0,S,I,x,_,p[6],d[0][2]),_=y.CC(y.FF,0,_,S,I,x,p[7],d[0][3]),x=y.CC(y.FF,0,x,_,S,I,p[8],d[0][0]),I=y.CC(y.FF,0,I,x,_,S,p[9],d[0][1]),S=y.CC(y.FF,0,S,I,x,_,p[10],d[0][2]),_=y.CC(y.FF,0,_,S,I,x,p[11],d[0][3]),x=y.CC(y.FF,0,x,_,S,I,p[12],d[0][0]),I=y.CC(y.FF,0,I,x,_,S,p[13],d[0][1]),S=y.CC(y.FF,0,S,I,x,_,p[14],d[0][2]),_=y.CC(y.FF,0,_,S,I,x,p[15],d[0][3]),x=y.CC(y.GG,g,x,_,S,I,p[0],d[1][0]),I=y.CC(y.GG,g,I,x,_,S,p[4],d[1][1]),S=y.CC(y.GG,g,S,I,x,_,p[8],d[1][2]),_=y.CC(y.GG,g,_,S,I,x,p[12],d[1][3]),x=y.CC(y.GG,g,x,_,S,I,p[1],d[1][0]),I=y.CC(y.GG,g,I,x,_,S,p[5],d[1][1]),S=y.CC(y.GG,g,S,I,x,_,p[9],d[1][2]),_=y.CC(y.GG,g,_,S,I,x,p[13],d[1][3]),x=y.CC(y.GG,g,x,_,S,I,p[2],d[1][0]),I=y.CC(y.GG,g,I,x,_,S,p[6],d[1][1]),S=y.CC(y.GG,g,S,I,x,_,p[10],d[1][2]),_=y.CC(y.GG,g,_,S,I,x,p[14],d[1][3]),x=y.CC(y.GG,g,x,_,S,I,p[3],d[1][0]),I=y.CC(y.GG,g,I,x,_,S,p[7],d[1][1]),S=y.CC(y.GG,g,S,I,x,_,p[11],d[1][2]),_=y.CC(y.GG,g,_,S,I,x,p[15],d[1][3]),x=y.CC(y.HH,b,x,_,S,I,p[0],d[2][0]),I=y.CC(y.HH,b,I,x,_,S,p[8],d[2][1]),S=y.CC(y.HH,b,S,I,x,_,p[4],d[2][2]),_=y.CC(y.HH,b,_,S,I,x,p[12],d[2][3]),x=y.CC(y.HH,b,x,_,S,I,p[2],d[2][0]),I=y.CC(y.HH,b,I,x,_,S,p[10],d[2][1]),S=y.CC(y.HH,b,S,I,x,_,p[6],d[2][2]),_=y.CC(y.HH,b,_,S,I,x,p[14],d[2][3]),x=y.CC(y.HH,b,x,_,S,I,p[1],d[2][0]),I=y.CC(y.HH,b,I,x,_,S,p[9],d[2][1]),S=y.CC(y.HH,b,S,I,x,_,p[5],d[2][2]),_=y.CC(y.HH,b,_,S,I,x,p[13],d[2][3]),x=y.CC(y.HH,b,x,_,S,I,p[3],d[2][0]),I=y.CC(y.HH,b,I,x,_,S,p[11],d[2][1]),S=y.CC(y.HH,b,S,I,x,_,p[7],d[2][2]),_=y.CC(y.HH,b,_,S,I,x,p[15],d[2][3]),this.state.hash=[this.state.hash[0]+x|0,this.state.hash[1]+_|0,this.state.hash[2]+S|0,this.state.hash[3]+I|0]}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),s(l,t),y);function y(){return function(_){if(!(_ instanceof y))throw new TypeError("Cannot call a class as a function")}(this),p=this,!(x=f(y).apply(this,arguments))||a(x)!=="object"&&typeof x!="function"?function(){if(p!==void 0)return p;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():x;var p,x}n.a=t},function(e,n,t){"use strict";var l=t(3),o=t(0);function a(g){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(g)}function s(g,b,y){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(p,x,_){if(p=function(S,I){for(;!Object.prototype.hasOwnProperty.call(S,I)&&(S=u(S))!==null;);return S}(p,x),p)return x=Object.getOwnPropertyDescriptor(p,x),x.get?x.get.call(_):x.value})(g,b,y||g)}function u(g){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(g)}function f(g,b){return(f=Object.setPrototypeOf||function(y,p){return y.__proto__=p,y})(g,b)}var m=[1518500249,1859775393,2400959708,3395469782],l=(function(g,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(b&&b.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),b&&f(g,b)}(d,l.a),function(g,b){for(var y=0;y<b.length;y++){var p=b[y];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(g,p.key,p)}}(d.prototype,[{key:"reset",value:function(){s(u(d.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878,-1009589776]}},{key:"processBlock",value:function(g){for(var b=0|this.state.hash[0],y=0|this.state.hash[1],p=0|this.state.hash[2],x=0|this.state.hash[3],_=0|this.state.hash[4],S=0;S<this.options.rounds;S++){this.W[S]=S<16?0|g[S]:this.W[S-3]^this.W[S-8]^this.W[S-14]^this.W[S-16]|0;var I=Object(o.a)(b,5)+_+this.W[S]+m[S/20>>0]|0,I=S<20?I+(y&p|~y&x)|0:!(S<40)&&S<60?I+(y&p|y&x|p&x)|0:I+(y^p^x)|0,_=x,x=p,p=0|Object(o.a)(y,30),y=b,b=I}this.state.hash[0]=this.state.hash[0]+b|0,this.state.hash[1]=this.state.hash[1]+y|0,this.state.hash[2]=this.state.hash[2]+p|0,this.state.hash[3]=this.state.hash[3]+x|0,this.state.hash[4]=this.state.hash[4]+_|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),d);function d(g){var b;return function(y){if(!(y instanceof d))throw new TypeError("Cannot call a class as a function")}(this),b=this,(g=!(g=u(d).call(this,g))||a(g)!=="object"&&typeof g!="function"?function(){if(b!==void 0)return b;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():g).options.rounds=g.options.rounds||80,g.W=new Array(80),g}n.a=l},function(e,n,t){"use strict";function l(o){for(var a="",s=new Uint8Array(o),u=0;u<s.length;u++)a+=String.fromCharCode(s[u]);return a}t.d(n,"a",function(){return l})},,function(e,n,t){"use strict";var l=(function(a,s){for(var u=0;u<s.length;u++){var f=s[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(a,f.key,f)}}(o.prototype,[{key:"update",value:function(a){this.hasher.update(a)}},{key:"finalize",value:function(){var a=this.hasher.finalize();return this.hasher.reset(),this.hasher.update(this.oPad),this.hasher.update(a),this.hasher.finalize()}}]),o);function o(a,s){(function(m){if(!(m instanceof o))throw new TypeError("Cannot call a class as a function")})(this),a.length>s.blockSizeInBytes&&(s.update(a),a=s.finalize(),s.reset());for(var u=a.length;u<s.blockSizeInBytes;u++)a+="\0";this.oPad="";for(var f=0;f<a.length;f++)s.update(String.fromCharCode(54^a.charCodeAt(f))),this.oPad+=String.fromCharCode(92^a.charCodeAt(f));this.hasher=s}n.a=l},,,,,,,,,function(e,n,t){"use strict";t.r(n);var l=t(14),o=t(13),a=t(16),s=t(10),u=t(8),f=t(17),m=t(11),d=t(7),g=t(6),b=t(9),y=t(12),p=t(1),x=t(18),_=t(2),S=t(15),I=t(20);(function(F,D){for(var k=0;k<D.length;k++){var w=D[k];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(F,w.key,w)}})(O.prototype,[{key:"getHasher",value:function(F,D){switch(D=D||{},F){case"has160":return new l.a(D);case"md2":return new o.a(D);case"md4":return new a.a(D);case"md5":return new s.a(D);case"ripemd128":return D=Object.assign({},{length:128},D),new u.a(D);case"ripemd":case"ripemd160":return D=Object.assign({},{length:160},D),new u.a(D);case"ripemd256":return D=Object.assign({},{length:256},D),new u.a(D);case"ripemd320":return D=Object.assign({},{length:320},D),new u.a(D);case"sha0":return new f.a(D);case"sha1":return new m.a(D);case"sha224":return D=Object.assign({},{length:224},D),new d.a(D);case"sha256":return D=Object.assign({},{length:256},D),new d.a(D);case"sha384":return D=Object.assign({},{length:384},D),new g.a(D);case"sha512":return D=Object.assign({},{length:512},D),new g.a(D);case"sha512/224":return D=Object.assign({},{length:224},D),new g.a(D);case"sha512/256":return D=Object.assign({},{length:256},D),new g.a(D);case"snefru":case"snefru128":case"snefru128/8":return D=Object.assign({},{length:128},D),new b.a(D);case"snefru256":case"snefru256/8":return D=Object.assign({},{length:256},D),new b.a(D);case"snefru128/2":return D=Object.assign({},{length:128,rounds:2},D),new b.a(D);case"snefru256/4":return D=Object.assign({},{length:256,rounds:4},D),new b.a(D);case"whirlpool":return new y.a(D);case"whirlpool-0":return D=Object.assign({},{type:"0"},D),new y.a(D);case"whirlpool-t":return D=Object.assign({},{type:"t"},D),new y.a(D)}}},{key:"hash",value:function(F,D,k){return k=k||{},k=this.getHasher(F,k),k.update(Object(p.a)(D)),Object(_.a)(k.finalize())}},{key:"getHmac",value:function(F,D){return new I.a(F,D)}},{key:"hmac",value:function(F,D,k){return k=this.getHmac(Object(p.a)(F),k),k.update(Object(p.a)(D)),Object(_.a)(k.finalize())}}]),t=O;function O(){(function(F){if(!(F instanceof O))throw new TypeError("Cannot call a class as a function")})(this),this.encoder={},this.encoder.fromUtf=p.a,this.encoder.fromArrayBuffer=x.a,this.encoder.toHex=_.a,this.encoder.toBase64=S.a}t=new t,n.default=t}]).default;(function(e){"use strict";var n={page:1,pageSize:200,total:0,showTotal:!1,totalTxt:"",noData:!1,showSkip:!1,showPN:!0,prevPage:"\u4E0A\u4E00\u9875",nextPage:"\u4E0B\u4E00\u9875",fastForward:0,selectOption:[],backFun:function(l){}};function t(l,o){this.element=e(l),this.settings=e.extend({},n,o),this.pageNum=1,this.pageList=[],this.pageTatol=0,this.init()}e.extend(t.prototype,{init:function(){this.element.empty(),this.viewHtml(),this.clickBtn()},creatHtml:function(l){l==this.settings.page?this.pageList.push('<button class="active" data-page='+l+">"+l+"</button>"):this.pageList.push("<button data-page="+l+">"+l+"</button>")},viewHtml:function(){var l=this.settings,o=0,a=[];if(0<l.total)o=Math.ceil(l.total/l.pageSize);else{if(!l.noData)return;o=1,l.page=1,l.total=0}if(this.pageTatol=o,this.pageNum=l.page,l.showTotal&&a.push('<div class="spage-total">'+l.totalTxt+"</div>"),a.push('<div class="spage-number">'),this.pageList=[],l.showPN&&(l.page==1?this.pageList.push('<button class="button-disabled" data-page="prev"><i class="prevBtn"></i></button>'):this.pageList.push('<button data-page="prev"><i class="prevBtn"></i></button>')),o<=6)for(var s=1;s<o+1;s++)this.creatHtml(s);else if(l.page<3){for(s=1;s<=3;s++)this.creatHtml(s);this.pageList.push('<button data-page="after" class="spage-after">...</button><button data-page='+o+">"+o+"</button>")}else if(l.page>o-3)for(this.pageList.push('<button data-page="1">1</button><button data-page="before" class="spage-before">...</button>'),s=o-3;s<=o;s++)this.creatHtml(s);else{for(this.pageList.push('<button data-page="1">1</button>'),3<l.page&&this.pageList.push('<button data-page="before" class="spage-before">...</button>'),s=l.page-1;s<=Number(l.page)+1;s++)this.creatHtml(s);l.page<=o-3&&this.pageList.push('<button data-page="after" class="spage-after">...</button>'),this.pageList.push("<button data-page="+o+">"+o+"</button>")}if(l.showPN&&(l.page==o?this.pageList.push('<button class="button-disabled" data-page="next"><i class="nextBtn"></i></button>'):this.pageList.push('<button data-page="next"><i class="nextBtn"></i></button>')),a.push(this.pageList.join("")),a.push("</div>"),0<l.selectOption.length){for(var u='<select class="selectNum" id="selectNum">',f=0;f<=l.selectOption.length-1;f++)u+="<option value="+l.selectOption[f]+" ",l.pageSize===l.selectOption[f]?u+="selected>"+l.selectOption[f]+"\u884C/\u9875</option>":u+=">"+l.selectOption[f]+"\u884C/\u9875</option>";u+="</select>",a.push(u)}l.showSkip&&a.push('<div class="spage-skip">\u8DF3\u81F3&nbsp;<input type="text" class="luckysheet-mousedown-cancel" value="'+l.page+'"/>&nbsp;\u9875&nbsp;&nbsp;</div>'),this.element.html(a.join(""))},clickBtn:function(){var l=this,o=this.settings,a=this.element,s=this.pageTatol;this.element.on("change","select",function(u){var f=parseInt(document.getElementById("selectNum").value);o.pageSize=f,o.page=1,l.element.empty(),l.viewHtml(),o.backFun(o)}),this.element.off("click","button"),this.element.on("click","button",function(){var u=e(this).data("page");switch(u){case"prev":o.page=1<=o.page-1?o.page-1:1,u=o.page;break;case"next":o.page=Number(o.page)+1<=s?Number(o.page)+1:s,u=o.page;break;case"before":o.page=1<=o.page-o.fastForward?o.page-o.fastForward:1,u=o.page;break;case"after":o.page=Number(o.page)+Number(o.fastForward)<=s?Number(o.page)+Number(o.fastForward):s,u=o.page;break;case"go":var f=parseInt(a.find("input").val());if(!(/^[0-9]*$/.test(f)&&1<=f&&f<=s))return;u=o.page=f;break;default:o.page=u}u!=l.pageNum&&(l.pageNum=o.page,l.viewHtml(),o.backFun(o))}),this.element.off("keyup","input"),this.element.on("keyup","input",function(u){u.keyCode==13&&(u=parseInt(a.find("input").val()),/^[0-9]*$/.test(u)&&1<=u&&u<=s&&u!=l.pageNum&&(o.page=u,l.pageNum=u,l.viewHtml(),o.backFun(o)))}),0<o.fastForward&&(a.find(".spage-after").hover(function(){e(this).html("&raquo;")},function(){e(this).html("...")}),a.find(".spage-before").hover(function(){e(this).html("&laquo;")},function(){e(this).html("...")}))}}),e.fn.sPage=function(l){return this.each(function(){new t(this,l)})}})(jQuery,document)});var import_plugin,yw,lt,bn=Tt(()=>{import_plugin=Le(Be()),yw={autoFormatw:!1,accuracy:void 0,total:0,allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,userInfo:!1,userMenuItem:[],myFolderUrl:null,functionButton:null,showConfigWindowResize:!0,enableAddRow:!0,addRowCount:100,enableAddBackTop:!0,enablePage:!0,pageInfo:null,editMode:!1,beforeCreateDom:null,workbookCreateBefore:null,workbookCreateAfter:null,remoteFunction:null,fireMousedown:null,plugins:[],forceCalculation:!1,defaultColWidth:73,defaultRowHeight:19,defaultTextColor:"#000",defaultCellColor:"#fff"},lt=yw});var import_plugin,kw,h,Ut=Tt(()=>{import_plugin=Le(Be()),kw={container:null,loadingObj:{},luckysheetfile:null,defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:!0,devicePixelRatio:1,currentSheetIndex:0,calculateSheetIndex:0,flowdata:[],config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:0,infobarHeight:0,calculatebarHeight:0,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,jfcountfuncTimeout:null,jfautoscrollTimeout:null,luckysheet_select_status:!1,luckysheet_select_save:[{row:[0,0],column:[0,0]}],luckysheet_selection_range:[],luckysheet_copy_save:{},luckysheet_paste_iscut:!1,filterchage:!0,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:!1,luckysheet_sheet_move_data:[],luckysheet_scroll_status:!1,luckysheetisrefreshdetail:!0,luckysheetisrefreshtheme:!0,luckysheetcurrentisPivotTable:!1,luckysheet_rows_selected_status:!1,luckysheet_cols_selected_status:!1,luckysheet_rows_change_size:!1,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:!1,luckysheet_cols_change_size_start:[],luckysheet_cols_dbclick_timeout:null,luckysheet_cols_dbclick_times:0,luckysheetCellUpdate:[],luckysheet_shiftpositon:null,iscopyself:!0,orderbyindex:0,luckysheet_model_move_state:!1,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:!1,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:!1,luckysheet_cell_selected_extend_index:[],luckysheet_cell_selected_extend_time:null,clearjfundo:!0,jfundo:[],jfredo:[],lang:"en",createChart:"",highlightChart:"",zIndex:15,chartparam:{luckysheetCurrentChart:null,luckysheetCurrentChartActive:!1,luckysheetCurrentChartMove:null,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:null,luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetCurrentChartResize:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheetInsertChartTosheetChange:!0,luckysheetCurrentChartZIndexRank:100,luckysheet_chart_redo_click:!1,luckysheetCurrentChartMaxState:!1,jfrefreshchartall:"",changeChartCellData:"",renderChart:"",getChartJson:""},functionList:null,luckysheet_function:null,chart_selection:{},currentChart:"",scrollRefreshSwitch:!0,measureTextCache:{},measureTextCellInfoCache:{},measureTextCacheTimeOut:null,cellOverflowMapCache:{},zoomRatio:1,visibledatacolumn_unique:null,visibledatarow_unique:null,showGridLines:!0,toobarObject:{},inlineStringEditCache:null,inlineStringEditRange:null,fontList:[],defaultFontSize:10,currentSheetView:"viewNormal",cooperativeEdit:{usernameTimeout:{},changeCollaborationSize:[],allDataColumnlen:[],merge_range:{},checkoutData:[]},asyncLoad:["core"],defaultCell:{bg:null,bl:0,ct:{fa:"General",t:"n"},fc:"rgb(51, 51, 51)",ff:0,fs:11,ht:1,it:0,vt:1,m:"",v:""}},h=kw});function rt(e){return e==null||e.toString().replace(/\s/g,"")==""}function Y(e){return!(e==null||e.toString().replace(/\s/g,"")===""||typeof e=="boolean"||isNaN(e))}function q(e){let n=!1;for(let t in It)if(e==It[t]){n=!0;break}return n}function Oa(e){return!!/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.exec(e)}function Qe(){return!!lt.editMode}function Un(){return!!h.allowEdit}function Ul(e,n,t,l,o){let a=!1;for(let s in h.config.merge){let u=e.merge[s];if(n<u.r){if(t>=u.r&&t<u.r+u.rs-1){if(l>=u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<=u.c+u.cs-1){a=!0;break}else if(l<u.c&&o>u.c+u.cs-1){a=!0;break}}else if(t>=u.r&&t==u.r+u.rs-1){if(l>u.c&&l<u.c+u.cs-1){a=!0;break}else if(o>u.c&&o<u.c+u.cs-1){a=!0;break}else if(l==u.c&&o<u.c+u.cs-1){a=!0;break}else if(l>u.c&&o==u.c+u.cs-1){a=!0;break}}else if(t>u.r+u.rs-1){if(l>u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<u.c+u.cs-1){a=!0;break}else if(l==u.c&&o<u.c+u.cs-1){a=!0;break}else if(l>u.c&&o==u.c+u.cs-1){a=!0;break}}}else if(n==u.r){if(t<u.r+u.rs-1){if(l>=u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<=u.c+u.cs-1){a=!0;break}else if(l<u.c&&o>u.c+u.cs-1){a=!0;break}}else if(t>=u.r+u.rs-1){if(l>u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<u.c+u.cs-1){a=!0;break}else if(l==u.c&&o<u.c+u.cs-1){a=!0;break}else if(l>u.c&&o==u.c+u.cs-1){a=!0;break}}}else if(n<=u.r+u.rs-1){if(l>=u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<=u.c+u.cs-1){a=!0;break}else if(l<u.c&&o>u.c+u.cs-1){a=!0;break}}}return a}function Ld(e){return Math.ceil(e.charCodeAt().toString(2).length/8)}var import_plugin,It,Gl=Tt(()=>{import_plugin=Le(Be());bn();Ut();It={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"}});function bw(e){return Math.floor(e)===e}function e0(e){var n={times:1,num:0};if(bw(e))return n.num=e,n;var t=e+"",l=t.indexOf("."),o=t.substr(l+1).length,a=Math.pow(10,o),s=parseInt(e*a+.5,10);return n.times=a,n.num=s,n}function hu(e,n,t){var l=e0(e),o=e0(n),a=l.num,s=o.num,u=l.times,f=o.times,m=u>f?u:f,d=null;switch(t){case"add":return u===f?d=a+s:u>f?d=a+s*(u/f):d=a*(f/u)+s,d/m;case"subtract":return u===f?d=a-s:u>f?d=a-s*(u/f):d=a*(f/u)-s,d/m;case"multiply":return d=a*s/(u*f),d;case"divide":return d=function(){var g=a/s,b=f/u;return hu(g,b,"multiply")}()}}function ww(e,n){if(n||(n=2),!Y(e))return e;let t=e.toFixed(n),l=t.indexOf("."),o=t.substring(0,l),a=t.substring(l+1,t.length);if(a)for(let s=a.length-1;s!=0&&!(a.charAt(s)!="0"&&s==a.length-1);s--)a=a.substring(0,s);return Number(o+"."+a)}var import_plugin,t0=Tt(()=>{import_plugin=Le(Be());Gl();Number.prototype.add=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return hu(this,n,"add")};Number.prototype.subtract=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return hu(this,n,"subtract")};Number.prototype.multiply=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return hu(this,n,"multiply")};Number.prototype.divide=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return hu(this,n,"divide")};Number.prototype.tofixed=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return ww(this,n)}});var import_plugin,l0,r0=Tt(()=>{import_plugin=Le(Be()),l0={container:"luckysheet",loading:{},column:60,row:84,allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,data:[{name:"Sheet1",color:"",status:"1",order:"0",data:[],config:{},index:0},{name:"Sheet2",color:"",status:"0",order:"1",data:[],config:{},index:1},{name:"Sheet3",color:"",status:"0",order:"2",data:[],config:{},index:2}],title:"Luckysheet Demo",userInfo:!1,userMenuItem:[],myFolderUrl:"https://github.com/luncheon/luckysheet-nightly",config:{},fullscreenmode:!0,devicePixelRatio:window.devicePixelRatio,allowEdit:!0,loadUrl:"",loadSheetUrl:"",gridKey:"",updateUrl:"",updateImageUrl:"",allowUpdate:!1,functionButton:"",showConfigWindowResize:!0,enableAddRow:!0,enableAddBackTop:!0,autoFormatw:!1,accuracy:void 0,pageInfo:{queryExps:"",reportId:"",fields:"",mobile:"",frezon:"",currentPage:"",totalPage:10,pageUrl:""},editMode:!1,beforeCreateDom:null,fireMousedown:null,lang:"en",plugins:[],forceCalculation:!1,rowHeaderWidth:46,columnHeaderHeight:20,defaultColWidth:73,defaultRowHeight:19,defaultFontSize:10,limitSheetNameLength:!0,defaultSheetNameMaxLength:31,sheetFormulaBar:!0,showtoolbarConfig:{},showsheetbarConfig:{},showstatisticBarConfig:{},cellRightClickConfig:{},sheetRightClickConfig:{},imageUpdateMethodConfig:{}}});var import_plugin,Hd,Oe,Rl=Tt(()=>{import_plugin=Le(Be());Ut();Hd={},Oe=()=>Hd[h.lang]});function n0(){let e=Oe().toolbar,n=Oe().fontarray,t=Oe().defaultFmt,l={undo:`<div class="luckysheet-toolbar-button luckysheet-inline-block disabled" data-tips="${e.undo}"
        id="luckysheet-icon-undo" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-undo iconfont luckysheet-iconfont-qianjin"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,redo:`<div class="luckysheet-toolbar-button luckysheet-inline-block disabled" data-tips="${e.redo}"
        id="luckysheet-icon-redo" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-redo iconfont luckysheet-iconfont-houtui"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,paintFormat:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.paintFormat}"
        id="luckysheet-icon-paintformat" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-geshishua"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,currencyFormat:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.currencyFormat}"
        id="luckysheet-icon-currency" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-jine"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,percentageFormat:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.percentageFormat}"
        id="luckysheet-icon-percent" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-baifenhao"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,numberDecrease:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.numberDecrease}"
        id="luckysheet-icon-fmt-decimal-decrease" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block toolbar-decimal-icon"
                    style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-decimal-decrease iconfont luckysheet-iconfont-jianxiaoxiaoshuwei"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,numberIncrease:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.numberIncrease}"
        id="luckysheet-icon-fmt-decimal-increase" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block toolbar-decimal-icon"
                    style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-decimal-increase iconfont luckysheet-iconfont-zengjiaxiaoshuwei"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,moreFormats:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.moreFormats}"
        id="luckysheet-icon-fmt-other" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${t[0].text}
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,font:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.font}" id="luckysheet-icon-font-family" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${n[0]}
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,fontSize:`<div class="luckysheet-toolbar-select luckysheet-toolbar-zoom-combobox luckysheet-toolbar-combo-button luckysheet-inline-block"
        data-tips="${e.fontSize}" id="luckysheet-icon-font-size" style="user-select: none;">
            <div class="luckysheet-toolbar-combo-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-combo-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div aria-posinset="4" aria-setsize="7" class="luckysheet-inline-block luckysheet-toolbar-combo-button-caption"
                    style="user-select: none;">
                        <input aria-label="${e.fontSize}" class="luckysheet-toolbar-combo-button-input luckysheet-toolbar-textinput"
                        role="combobox" style="user-select: none;" tabindex="-1" type="text" value="10"
                        />
                    </div>
                    <div class="luckysheet-toolbar-combo-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,bold:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.bold}"
        id="luckysheet-icon-bold" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-bold iconfont luckysheet-iconfont-jiacu"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,italic:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.italic}"
        id="luckysheet-icon-italic" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-italic iconfont luckysheet-iconfont-wenbenqingxie1"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,strikethrough:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.strikethrough}"
        id="luckysheet-icon-strikethrough" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-strikethrough iconfont luckysheet-iconfont-wenbenshanchuxian"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,underline:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.underline}"
        id="luckysheet-icon-underline" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-underline iconfont luckysheet-iconfont-wenbenxiahuaxian"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,textColor:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-text-color"
        data-tips="${e.textColor}" id="luckysheet-icon-text-color" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-color-menu-button-indicator" style="border-bottom-color: rgb(0, 0, 0); user-select: none;">
                            <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                                <div class="text-color-bar" style="background-color:${lt.defaultTextColor}"></div>
                                <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color iconfont luckysheet-iconfont-wenbenyanse"
                                style="user-select: none;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.chooseColor}..." id="luckysheet-icon-text-color-menu" role="button"
        style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,fillColor:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-cell-color"
        data-tips="${e.fillColor}" id="luckysheet-icon-cell-color" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-color-menu-button-indicator" style="border-bottom-color: rgb(255, 255, 255); user-select: none;">
                            <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                                <div class="text-color-bar" style="background-color:${lt.defaultCellColor}"></div>
                                <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color iconfont luckysheet-iconfont-tianchong"
                                style="user-select: none;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.chooseColor}..." id="luckysheet-icon-cell-color-menu" role="button"
        style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,border:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-border-all"
        data-tips="${e.border}" id="luckysheet-icon-border-all" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all iconfont luckysheet-iconfont-quanjiabiankuang"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.borderStyle}..." id="luckysheet-icon-border-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,mergeCell:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-merge-button"
        data-tips="${e.mergeCell}" id="luckysheet-icon-merge-button" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-merge iconfont luckysheet-iconfont-hebing"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.chooseMergeType}..." id="luckysheet-icon-merge-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,horizontalAlignMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-align"
        data-tips="${e.horizontalAlign}" id="luckysheet-icon-align" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left iconfont luckysheet-iconfont-wenbenzuoduiqi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.alignment}..." id="luckysheet-icon-align-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,verticalAlignMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-valign"
        data-tips="${e.verticalAlign}" id="luckysheet-icon-valign" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom iconfont luckysheet-iconfont-dibuduiqi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.alignment}..." id="luckysheet-icon-valign-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,textWrapMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-textwrap"
        data-tips="${e.textWrap}" id="luckysheet-icon-textwrap" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-clip iconfont luckysheet-iconfont-jieduan"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.textWrapMode}..." id="luckysheet-icon-textwrap-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,textRotateMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-rotation"
        data-tips="${e.textRotate}" id="luckysheet-icon-rotation" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wuxuanzhuang"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.textRotateMode}..." id="luckysheet-icon-rotation-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,image:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.insertImage}" id="luckysheet-insertImg-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-tupian"
                            style="user-select: none;">
                                <input id="luckysheet-imgUpload" type="file" accept="image/*" style="display:none;"></input>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,link:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.insertLink}" id="luckysheet-insertLink-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-lianjie"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,chart:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.chart}" id="luckysheet-chart-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-tubiao"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,postil:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.postil}"
        id="luckysheet-icon-postil" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon-img-container luckysheet-toolbar-menu-button-caption luckysheet-inline-block iconfont luckysheet-iconfont-zhushi"
                    style="user-select: none;">
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,pivotTable:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.pivotTable}" id="luckysheet-pivot-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-shujutoushi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,function:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-function"
        data-tips="${e.autoSum}" id="luckysheet-icon-function" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-jisuan"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${e.sum}
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.moreFunction}..." id="luckysheet-icon-function-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,frozenMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-freezen-btn-horizontal"
        data-tips="${e.freezeTopRow}" id="luckysheet-freezen-btn-horizontal" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-dongjie1"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.moreOptions}..." id="luckysheet-icon-freezen-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,sortAndFilter:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.sortAndFilter}"
        id="luckysheet-icon-autofilter" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-shaixuan"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>`,conditionalFormat:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.conditionalFormat}"
        id="luckysheet-icon-conditionformat" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-geshitiaojian"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,dataVerification:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.dataVerification}" id="luckysheet-dataVerification-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-shujuyanzheng"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,splitColumn:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.splitColumn}" id="luckysheet-splitColumn-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wenbenfenge"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,screenshot:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.screenshot}" id="luckysheet-chart-btn-screenshot" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-jieping"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,findAndReplace:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.findAndReplace}"
        id="luckysheet-icon-seachmore" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-sousuo"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>`,protection:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.protection}" id="luckysheet-icon-protection" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-biaogesuoding"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,print:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.print}"
        id="luckysheet-icon-print" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-dayin"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>`},o=lt.showtoolbar,a=lt.showtoolbarConfig,s=['<div class="luckysheet-toolbar-left-theme"></div>'];if(V(a)==="array"){if(!o)return"";let f=0;return a.forEach(function(m,d){if(m==="|"){let g=a[d-1];g!=="|"&&s.push(`<div id="toolbar-separator-${Pa(g)}" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"></div>`)}else s.push(l[m])}),s.join("")}let u=yo.reduce(function(f,m){return m!=="|"&&(f[m]=!0),f},{});if(!o)for(let f in u)u[f]=!1;JSON.stringify(a)!=="{}"&&(a.hasOwnProperty("undoRedo")&&(u.undo=u.redo=a.undoRedo),Object.assign(u,a));for(let f=0;f<yo.length;f++){let m=yo[f];if(!u[m]&&m!=="|"){yo[f+1]==="|"&&f++;continue}if(m==="|"){let d=yo[f-1];d!=="|"&&s.push(`<div id="toolbar-separator-${Pa(d)}" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"></div>`)}else s.push(l[m])}return s.join("")}var import_plugin,yo,Bd,jd=Tt(()=>{import_plugin=Le(Be());Rl();bn();gl();yo=["undo","redo","paintFormat","|","currencyFormat","percentageFormat","numberDecrease","numberIncrease","moreFormats","|","font","|","fontSize","|","bold","italic","strikethrough","underline","textColor","|","fillColor","border","mergeCell","|","horizontalAlignMode","verticalAlignMode","textWrapMode","textRotateMode","|","image","link","chart","postil","pivotTable","|","function","frozenMode","sortAndFilter","conditionalFormat","dataVerification","splitColumn","screenshot","findAndReplace","protection","print"],Bd={undo:"#luckysheet-icon-undo",redo:"#luckysheet-icon-redo",paintFormat:["#luckysheet-icon-paintformat"],currencyFormat:"#luckysheet-icon-currency",percentageFormat:"#luckysheet-icon-percent",numberDecrease:"#luckysheet-icon-fmt-decimal-decrease",numberIncrease:"#luckysheet-icon-fmt-decimal-increase",moreFormats:"#luckysheet-icon-fmt-other",font:"#luckysheet-icon-font-family",fontSize:"#luckysheet-icon-font-size",bold:"#luckysheet-icon-bold",italic:"#luckysheet-icon-italic",strikethrough:"#luckysheet-icon-strikethrough",underline:"#luckysheet-icon-underline",textColor:["#luckysheet-icon-text-color","#luckysheet-icon-text-color-menu"],fillColor:["#luckysheet-icon-cell-color","#luckysheet-icon-cell-color-menu"],border:["#luckysheet-icon-border-all","#luckysheet-icon-border-menu"],mergeCell:["#luckysheet-icon-merge-button","#luckysheet-icon-merge-menu"],horizontalAlignMode:["#luckysheet-icon-align","#luckysheet-icon-align-menu"],verticalAlignMode:["#luckysheet-icon-valign","#luckysheet-icon-valign-menu"],textWrapMode:["#luckysheet-icon-textwrap","#luckysheet-icon-textwrap-menu"],textRotateMode:["#luckysheet-icon-rotation","#luckysheet-icon-rotation-menu"],image:"#luckysheet-insertImg-btn-title",link:"#luckysheet-insertLink-btn-title",chart:"#luckysheet-chart-btn-title",postil:"#luckysheet-icon-postil",pivotTable:["#luckysheet-pivot-btn-title"],function:["#luckysheet-icon-function","#luckysheet-icon-function-menu"],frozenMode:["#luckysheet-freezen-btn-horizontal","#luckysheet-icon-freezen-menu"],sortAndFilter:"#luckysheet-icon-autofilter",conditionalFormat:"#luckysheet-icon-conditionformat",dataVerification:"#luckysheet-dataVerification-btn-title",splitColumn:"#luckysheet-splitColumn-btn-title",screenshot:"#luckysheet-chart-btn-screenshot",findAndReplace:"#luckysheet-icon-seachmore",protection:"#luckysheet-icon-protection",print:"#luckysheet-icon-print"}});function s0(){let e=Oe(),n=e.rightclick,t=e.toolbar,l=Cw(),o=!0;!l.insertRow&&!l.insertColumn&&!l.deleteRow&&!l.deleteColumn&&!l.deleteCell&&(o=!1);let a=!0;!l.clear&&!l.matrix&&!l.sort&&!l.filter&&!l.chart&&!l.image&&!l.link&&!l.data&&!l.cellFormat&&(a=!1);let s=(l.customs||[]).map((f,m)=>`
            <div data-index="${m}" class="luckysheetColsRowsHandleAdd_custom luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                ${f.title}
                </div>
            </div>`).join("");return`<div id="luckysheet-rightclick-menu" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel">
                <div id="luckysheet-copy-btn" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-copy-btn" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" style="display:${l.copy?"block":"none"};">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.copy}</div>
                </div>
                <div id="luckysheetcopyfor" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel"  style="display:${l.copyAs?"block":"none"};">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.copyAs}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                    </div>
                </div>
                <div id="luckysheet-copy-paste" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.paste?"block":"none"};">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.paste}</div>
                </div>
                <div id="luckysheet-cols-rows-handleincell">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${o?"block":"none"};"></div>
                    <div id="luckysheetColsRowsHandleAdd_row" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.insertRow?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.insert}${n.row}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheetColsRowsHandleAdd_column" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.insertColumn?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.insert}${n.column}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheet-delRows" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.deleteRow?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.row}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheet-delCols" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.deleteColumn?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.column}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <!-- cell right click remove hide button
                    <div id="luckysheetColsRowsHandleHid" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.hide}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                    -->
                    <div id="luckysheetCellsHandleDel" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.deleteCell?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.deleteCell}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-add">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                    <div id="luckysheet-top-left-add-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.to}
                            <span class="luckysheet-cols-rows-shift-left">${n.left}</span>
                            ${n.add}
                            <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align:center;margin-left:5px;"/>
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-bottom-right-add-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.to}
                            <span class="luckysheet-cols-rows-shift-right">${n.right}</span>
                            ${n.add}
                            <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-del-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.deleteSelected}
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-hide-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.hideSelected}
                        <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-show-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.showHide}
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-column-row-width-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                            <span class="luckysheet-cols-rows-shift-size luckysheet-mousedown-cancel">${n.width}</span>
                            <input type="number" class="luckysheet-mousedown-cancel rcsize" min="0" max="255" placeholder="${n.number}" value="" style="width:50px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;">
                            px
                        </div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-shift">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${l.sort?"block":"none"};"></div>
                    <div id="luckysheetorderbyasc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.sort?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.orderAZ}</div>
                    </div>
                    <div id="luckysheetorderbydesc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.sort?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.orderZA}</div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-data">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${a?"block":"none"};"></div>
                    <div id="luckysheet-delete-text" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.clear?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.clearContent}</div>
                    </div>
                    <div id="luckysheetmatrix" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.matrix?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.matrix}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheetorderby" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.sort?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.sortSelection}</div>
                    </div>
                    <div id="luckysheetfilter" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.filter?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.filterSelection}</div>
                    </div>
                    <div id="luckysheetdatavisual" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.chart?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.chartGeneration}</div>
                    </div>
                    <div id="luckysheetInsertImage" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.image?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.insertImage}</div>
                    </div>
                    <div id="luckysheetInsertLink" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.link?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.insertLink}</div>
                    </div>
                    <div id="luckysheetDataVerification" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.data?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.dataVerification}</div>
                    </div>
                    <div id="luckysheetCellFormatRightClickMenu" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.cellFormat?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.cellFormat}</div>
                    </div>
                    ${s}
                </div>
            </div>
            <div id="luckysheetcopyfor_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-copy-json-head" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">Json ${n.firstLineTitle}</div>
                </div>
                <div id="luckysheet-copy-json-nohead" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">Json ${n.untitled}</div>
                </div>
                <div id="luckysheet-copy-array1" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.array1}</div>
                </div>
                <div id="luckysheet-copy-array2" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.array2}</div>
                </div>
                <div id="luckysheet-copy-arraymore-confirm" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        <span class="luckysheet-mousedown-cancel">${n.array3}</span>
                        <input type="number" id="luckysheet-copy-arraymore-row" min="1" class="luckysheet-mousedown-cancel" placeholder="${n.row}" style="width:40px;height:20px;box-sizing:border-box;text-align: center;"/>
                            \xD7
                            <input type="number" id="luckysheet-copy-arraymore-col" min="1" class="luckysheet-mousedown-cancel" placeholder="${n.column}" style="width:40px;height:20px;box-sizing:border-box;text-align: center;"/>
                    </div>
                </div>
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                <div id="luckysheet-copy-diagonal" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.diagonal}</div>
                </div>
                <div id="luckysheet-copy-antidiagonal" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.antiDiagonal}</div>
                </div>
                <div id="luckysheet-copy-diagonaloffset" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.diagonalOffset}
                        <input type="number" id="luckysheet-copy-diagonaloffset-value" class="luckysheet-mousedown-cancel" placeholder="${n.offset}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        ${n.column}
                    </div>
                </div>
                <div id="luckysheet-copy-boolvalue" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.boolean}</div>
                </div>
            </div>
            
            <!-- Revision: modeled on google sheet
            
            <div id="luckysheetColsRowsHandleAdd_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.top}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.row}</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.bottom}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.row}</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.left}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.column}</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.right}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.column}</span>
                    </div>
                </div>
            </div>
            
            -->

            <!-- delete row or column
            
            <div id="luckysheetColsRowsHandleDel_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-delRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.row}
                    </div>
                </div>
                <div id="luckysheet-delCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.column}
                    </div>
                </div>
            </div>
            
            -->

            <!--
            <div id="luckysheetColsRowsHandleHid_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-hidRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.hideSelected}${n.row}
                    </div>
                </div>
                <div id="luckysheet-showHidRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.showHide}${n.row}
                    </div>
                </div>
                <div id="luckysheet-hidCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.hideSelected}${n.column}
                    </div>
                </div>
                <div id="luckysheet-showHidCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.showHide}${n.column}
                    </div>
                </div>
            </div>

            -->

            <div id="luckysheetCellsHandleDel_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-delCellsMoveLeft" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.moveLeft}
                    </div>
                </div>
                <div id="luckysheet-delCellsMoveUp" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.moveUp}
                    </div>
                </div>
            </div>
            <div id="luckysheetmatrix_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.flip}
                        <button id="luckysheet-matrix-turn-up" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.upAndDown}</button>
                        <button id="luckysheet-matrix-turn-left" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.leftAndRight}</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.flip}
                        <button id="luckysheet-matrix-turn-cw" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.clockwise}</button>
                        <button id="luckysheet-matrix-turn-anticw" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.counterclockwise}</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div id="luckysheet-matrix-turn-trans" class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.transpose}</div>
                </div>
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                <div id="luckysheet-matrix-cal-confirm" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        <div class="luckysheet-mousedown-cancel">${n.matrixCalculation}</div>
                        <div class="luckysheet-mousedown-cancel">
                            <select id="luckysheet-matrix-cal-type" class="luckysheet-mousedown-cancel" style="height:20px;">
                                <option value="plus">${n.plus}</option>
                                <option value="minus">${n.minus}</option>
                                <option value="multiply">${n.multiply}</option>
                                <option value="divided">${n.divided}</option>
                                <option value="power">${n.power}</option>
                                <option value="root">${n.root}</option>
                                <option value="log">${n.log}</option>
                            </select>
                            <input type="number" id="luckysheet-matrix-cal-value" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="2" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        </div>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.delete0}
                        <button id="luckysheet-matrix-delezero-row" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byRow}</button>
                        <button id="luckysheet-matrix-delezero-column" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byCol}</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.removeDuplicate}
                        <button id="luckysheet-matrix-delerpt-row" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byRow}</button>
                        <button id="luckysheet-matrix-delerpt-column" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byCol}</button>
                    </div>
                </div>
            </div>`}function p0(){let e=Oe().sheetconfig,n=$w();if(Object.values(n).every(a=>!a))return $("#luckysheet-sheet-container-c").addClass("luckysheet-sheet-container-menu-hide"),"";let t=!0,l=!0;return!n.delete&&!n.copy&&!n.rename&&!n.color&&(t=!1,n.hide||(l=!1)),n.hide||(t=!1),n.move||(l=!1),`<div id="luckysheet-rightclick-sheet-menu" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel"> 
                <div id="luckysheetsheetconfigdelete" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.delete?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.delete}</div>
                </div> 
                <div id="luckysheetsheetconfigcopy" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.copy?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.copy}</div> 
                </div> 
                <div id="luckysheetsheetconfigrename" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.rename?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.rename}</div> 
                </div> 
                <div id="luckysheetsheetconfigcolor" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${n.color?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> 
                        ${e.changeColor} <span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span> 
                    </div> 
                </div> 
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${t?"block":"none"};"></div> 
                <div id="luckysheetsheetconfighide" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.hide?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.hide}</div> 
                </div> 
                <div id="luckysheetsheetconfigshow" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.hide?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.unhide}</div> 
                </div> 
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${l?"block":"none"};"></div> 
                <div id="luckysheetsheetconfigmoveleft" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.move?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.moveLeft}</div> 
                </div> 
                <div id="luckysheetsheetconfigmoveright" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.move?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.moveRight}</div> 
                </div> 
            </div> 
            <div id="luckysheetsheetconfigcolor_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheetsheetconfigcolorreset" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.resetColor}</div>
                </div> 
                <div class="luckysheet-mousedown-cancel"> 
                    <div class="luckysheet-mousedown-cancel"> 
                        <input type="text" id="luckysheetsheetconfigcolorur" /> 
                    </div> 
                </div> 
            </div>`}function Hf(){let n=Oe().filter;return`<div class="luckysheet-cols-menu luckysheet-mousedown-cancel luckysheet-filter-menu" id="luckysheet-\${menuid}-menu"><div id="luckysheet-\${menuid}-orderby-asc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.sortByAsc}</div></div><div id="luckysheet-\${menuid}-orderby-desc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div style="width:205px;" class="luckysheet-mousedown-cancel">${n.sortByDesc}</div></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div><div id="luckysheet-\${menuid}-orderby-color" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="position: relative;">${n.filterByColor}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;right: 0;"></span></div></div><div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-bycondition" style="padding-top:0px;padding-bottom:0px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> ${n.filterByCondition}</div></div> <div class="luckysheet-\${menuid}-bycondition" style="display:none;"><div class="luckysheet-flat-menu-button luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-selected"><span class="luckysheet-mousedown-cancel" data-value="null" data-type="0">${n.filiterInputNone}</span><div class="luckysheet-mousedown-cancel"><i class="fa fa-sort" aria-hidden="true"></i></div></div><div class="luckysheet-\${menuid}-selected-input"><input type="text" placeholder="${n.filiterInputTip}" class="luckysheet-mousedown-cancel" /></div><div class="luckysheet-\${menuid}-selected-input luckysheet-\${menuid}-selected-input2"><span>${n.filiterRangeStart}</span><input type="text" placeholder="${n.filiterRangeStartTip}" class="luckysheet-mousedown-cancel" /><span>${n.filiterRangeEnd}</span><input type="text" placeholder="${n.filiterRangeEndTip}" class="luckysheet-mousedown-cancel" /></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-byvalue" style="padding-top:0px;padding-bottom:0px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> ${n.filterByValues}</div></div> <div class="luckysheet-\${menuid}-byvalue"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel luckysheet-mousedown-\${menuid}-byvalue-btn"><span id="luckysheet-\${menuid}-byvalue-btn-all" class="luckysheet-mousedown-cancel">${n.filterValueByAllBtn}</span> - <span id="luckysheet-\${menuid}-byvalue-btn-clear" class="luckysheet-mousedown-cancel">${n.filterValueByClearBtn}</span> - <span id="luckysheet-\${menuid}-byvalue-btn-contra" class="luckysheet-mousedown-cancel">${n.filterValueByInverseBtn}</span> <div><i class="fa fa-\${menuid} luckysheet-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="padding-left:3px; padding-right:3px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><input type="text" placeholder="${n.filterValueByTip}" class="luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-byvalue-input" /><div class="luckysheet-\${menuid}-byvalue-input-icon luckysheet-mousedown-cancel"><i class="fa fa-search luckysheet-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div id="luckysheet-\${menuid}-byvalue-select" class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"></div></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div class="btn btn-primary luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-confirm">${n.filterConform}</div> <div class="btn btn-default luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-cancel">${n.filterCancel}</div> <div class="btn btn-danger luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-initial">${n.clearFilter}</div></div></div> </div>`}function Bf(){let n=Oe().filter;return`<div style="z-index:1004;overflow-y:auto;" class="luckysheet-filter-submenu luckysheet-cols-menu luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-submenu"><div data-value="null" data-type="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionNone}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="cellnull"  data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellIsNull}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="cellnonull"  data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellNotNull}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textinclude"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextContain}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textnotinclude"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextNotContain}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textstart"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextStart}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textend"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextEnd}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextEqual}</div></div>  <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>  <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="dateequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellDateEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="datelessthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellDateBefore}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="datemorethan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellDateAfter}</div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="morethan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellGreater}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="moreequalthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellGreaterEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="lessthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellLess}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="lessequalthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellLessEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="equal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="noequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellNotEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="include"  data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellBetween}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="noinclude" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellNotBetween}</div></div> </div>`}function y0(){let e=Oe(),n=e.alternatingColors,t=e.toolbar;return'<div id="luckysheet-modal-dialog-slider-alternateformat" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-alternateformat" style="display: block;"><div class="luckysheet-modal-dialog-slider-title"><span>'+t.alternatingColors+'</span><span class="luckysheet-model-close-btn" title="'+n.close+'"><i class="fa fa-times" aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-slider-content"><div class="textTitle">'+n.applyRange+'</div><div id="luckysheet-alternateformat-range"><input class="formulaInputFocus" placeholder="'+n.selectRange+'"/><i class="fa fa-table" aria-hidden="true"></i></div><div id="luckysheet-alternateformat-checkbox"><div class="cf"><input type="checkbox" id="luckysheet-alternateformat-rowHeader"/><label for="luckysheet-alternateformat-rowHeader">'+n.header+'</label></div><div class="cf"><input type="checkbox" id="luckysheet-alternateformat-rowFooter"/><label for="luckysheet-alternateformat-rowFooter">'+n.footer+'</label></div></div><div class="textTitle">'+n.textTitle+'</div><div id="luckysheet-alternateformat-modelList" class="cf"></div><div class="textTitle">'+n.custom+'</div><div id="luckysheet-alternateformat-modelCustom" class="cf"></div><div id="luckysheet-alternateformat-modelToning"><div class="toningbox header"><div class="toningShow"> '+n.header+' </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctOne"><div class="toningShow"> '+n.colorShow+'1 </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctTwo"><div class="toningShow"> '+n.colorShow+'2 </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox footer"><div class="toningShow"> '+n.footer+' </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div></div><button id="luckysheet-alternateformat-remove" class="btn btn-default" style="margin: 10px;">'+n.removeColor+"</button></div></div>"}function w0(){return n0()}function xw(){let n=Oe().info,t={enable:!0,image:()=>`<svg viewBox="25 25 50 50" class="circular">
            <circle cx="50" cy="50" r="20" fill="none"></circle>
            </svg>`,text:n.loading,viewBox:"32 32 64 64",imageClass:"",textClass:"",customClass:""};return JSON.stringify(lt.loading)!=="{}"&&Object.assign(t,lt.loading),t}function Cw(){let e={copy:!0,copyAs:!0,paste:!0,insertRow:!0,insertColumn:!0,deleteRow:!0,deleteColumn:!0,deleteCell:!0,hideRow:!0,hideColumn:!0,rowHeight:!0,columnWidth:!0,clear:!0,matrix:!0,sort:!0,filter:!0,chart:!0,image:!0,link:!0,data:!0,cellFormat:!0};return JSON.stringify(lt.cellRightClickConfig)!=="{}"&&Object.assign(e,lt.cellRightClickConfig),lt.cellRightClickConfig=e,e}function $w(){let e={delete:!0,copy:!0,rename:!0,color:!0,hide:!0,move:!0};return JSON.stringify(lt.sheetRightClickConfig)!=="{}"&&Object.assign(e,lt.sheetRightClickConfig),lt.sheetRightClickConfig=e,e}var import_plugin,i0,o0,a0,c0,u0,bi,f0,h0,d0,m0,kl,g0,v0,k0,b0,_w,ko,si,rl,Tn,ps,ac,Uo,ar=Tt(()=>{import_plugin=Le(Be());Rl();Ut();bn();gl();jd();i0=function(){let e=Oe(),n=e.info,t=e.print,l=lt.userInfo===!0?'<i style="font-size:16px;color:#ff6a00;" class="fa fa-taxi" aria-hidden="true"></i> Lucky':lt.userInfo;return`<div class="luckysheet">
                    <canvas id="luckysheetTableContentF" style="display:none;" class="luckysheetTableContent"></canvas> 
                    <div class="luckysheet-work-area luckysheet-noselected-text"> 
                        <div id ="luckysheet_info_detail" class="luckysheet_info_detail"> 
                            <div data-tips="${n.return}" id="luckysheet_info_detail_title" class="luckysheet_info_detail_back"> 
                                <i style="color:#444D5A;" class="fa fa-angle-left fa-2x" aria-hidden="true"></i> 
                            </div> 
                            <div class="luckysheet-share-logo" title="\${logotitle}"></div>
                            <div class="sheet-name"> 
                                <input data-tips="${n.tips}" id="luckysheet_info_detail_input" class="luckysheet_info_detail_input luckysheet-mousedown-cancel" value="${n.noName}" tabindex="0" dir="ltr" aria-label="${n.rename}" style="visibility: visible; width: 149px;" data-tooltip="${n.rename}"> 
                            </div> 
                            <div id="luckysheet_info_detail_update" class="luckysheet_info_detail_update"> ${n.detailUpdate} </div> 
                            <div id="luckysheet_info_detail_save" class="luckysheet_info_detail_save"> ${n.wait} </div>
                            
                            \${functionButton}
                            
                            ${V(l)==="string"?`<div class="luckysheet_info_detail_user">
                            <span id="luckysheet_info_detail_user">${l}</span></div>`:""}

                            ${V(l)==="object"?`<div class="luckysheet_info_detail_user">                            
                            <img src="${l.userImage}" id="luckysheet_info_detail_user_img">
                            <span id="luckysheet_info_detail_user">${l.userName}</span>
                            </div>`:""}
                            
                        </div> 
                        <div id="luckysheet-wa-editor" class="luckysheet-wa-editor toolbar"> \${menu} </div> 
                        <div id="luckysheet-wa-calculate" class="luckysheet-wa-calculate"> 
                            <div class="luckysheet-wa-calculate-size" id="luckysheet-wa-calculate-size"></div> 
                            <div class="luckysheet-wa-calculate-help"> 
                                <div class="luckysheet-wa-calculate-help-box"> 
                                    <div spellcheck="false" aria-hidden="false" id="luckysheet-helpbox">
                                        <div id="luckysheet-helpbox-cell" class="luckysheet-helpbox-cell-input luckysheet-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list"></div>
                                    </div> 
                                </div>  
                                <div class="luckysheet-wa-calculate-help-tool">
                                    <i class="fa fa-caret-down" aria-hidden="true"></i>
                                </div> 
                            </div> 
                            <div id="luckysheet-wa-functionbox-cancel" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-qingchu" aria-hidden="true"></i></span>
                            </div> 
                            <div id="luckysheet-wa-functionbox-confirm" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-yunhang" aria-hidden="true"></i></span>
                            </div> 
                            <div id="luckysheet-wa-functionbox-fx" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-hanshu" aria-hidden="true" style="color:#333"></i></span> 
                            </div> 
                            <div id="luckysheet-functionbox-container" class="luckysheet-mousedown-cancel">
                                <div class="luckysheet-mousedown-cancel" dir="ltr">
                                    <div spellcheck="false" aria-hidden="false" id="luckysheet-functionbox">
                                        <div id="luckysheet-functionbox-cell" class="luckysheet-functionbox-cell-input luckysheet-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list" aria-label="D4"></div>
                                    </div>
                                </div>
                            </div>   
                        </div> 
                    </div> 
                    <div class="luckysheet-grid-container luckysheet-scrollbars-enabled"> 
                        <div class="luckysheet-grid-window"> 
                            <div class="luckysheet-help-sub"></div> 
                            <div class="luckysheet-grid-window-1" id="luckysheet-grid-window-1">
                                <canvas id="luckysheetTableContent" class="luckysheetTableContent"></canvas> 
                                <table class="luckysheet-grid-window-2" cellspacing="0" cellpadding="0" dir="ltr" tabindex="-1" > 
                                    <tbody> 
                                        <tr> 
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div class="luckysheet-left-top" id="luckysheet-left-top"> </div> 
                                            </td> 
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div id="luckysheet-cols-h-c" class="luckysheet-cols-h-c">
                                                    <div class="luckysheet-cols-change-size" id="luckysheet-cols-change-size"></div>  
                                                    <div class="luckysheet-cols-menu-btn luckysheet-mousedown-cancel" id="luckysheet-cols-menu-btn"><i class="fa fa-caret-down luckysheet-mousedown-cancel" aria-hidden="true"></i></div>  
                                                    <div class="luckysheet-cols-h-hover" id="luckysheet-cols-h-hover"></div>  
                                                    <div id="luckysheet-cols-h-selected"></div>  
                                                    <div class="luckysheet-grdusedrange"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div>  \${columnHeader}
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div class="luckysheet-rows-h" id="luckysheet-rows-h"> 
                                                    <div class="luckysheet-rows-change-size" id="luckysheet-rows-change-size"></div> 
                                                    <div class="luckysheet-rows-h-hover" id="luckysheet-rows-h-hover"></div> 
                                                    <div id="luckysheet-rows-h-selected"></div>  
                                                    <div class="luckysheet-grdusedrange"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div> \${rowHeader}
                                                </div> 
                                            </td>  
                                            <td valign="top" class="luckysheet-paneswrapper">
                                                <div class="luckysheet-cell-loading" id="luckysheet-cell-loading">
                                                    <div class="luckysheet-cell-loading-inner">
                                                        <i class="fa fa-circle-o-notch fa-spin"></i>
                                                        <span></span>
                                                    </div>
                                                </div> 
                                                <div class="luckysheet-cell-freezen"></div> 
                                                <div class="luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-x" id="luckysheet-scrollbar-x"><div></div></div> 
                                                <div class="luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-y" id="luckysheet-scrollbar-y"><div></div></div> 
                                                <div class="luckysheet-cell-main " id="luckysheet-cell-main">
                                                    <div id="luckysheet-formula-functionrange"></div>  
                                                    <div id="luckysheet-formula-functionrange-select" class="luckysheet-selection-copy luckysheet-formula-functionrange-select">
                                                        <div class="luckysheet-selection-copy-top luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-right luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-bottom luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-left luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-hc"></div>
                                                    </div>  
                                                    <div class="luckysheet-row-count-show luckysheet-count-show" id="luckysheet-row-count-show"></div>
                                                    <div class="luckysheet-column-count-show luckysheet-count-show" id="luckysheet-column-count-show"></div>
                                                    <div class="luckysheet-change-size-line" id="luckysheet-change-size-line"></div>  
                                                    <div class="luckysheet-cell-selected-focus" id="luckysheet-cell-selected-focus"></div>  
                                                    <div id="luckysheet-selection-copy"></div>  
                                                    <div id="luckysheet-chart-rangeShow"></div>
                                                    <div class="luckysheet-cell-selected-extend" id="luckysheet-cell-selected-extend"></div>  
                                                    <div class="luckysheet-cell-selected-move" id="luckysheet-cell-selected-move"></div>  
                                                    <div id="luckysheet-cell-selected-boxs">
                                                        <div id="luckysheet-cell-selected" class="luckysheet-cell-selected">
                                                            <div class="luckysheet-cs-inner-border"></div>
                                                            <div class="luckysheet-cs-fillhandle"></div>
                                                            <div class="luckysheet-cs-inner-border"></div>
                                                            <div class="luckysheet-cs-draghandle-top luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-bottom luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-left luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-right luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-touchhandle luckysheet-cs-touchhandle-lt"><div class="luckysheet-cs-touchhandle-btn"></div></div>
                                                            <div class="luckysheet-cs-touchhandle luckysheet-cs-touchhandle-rb"><div class="luckysheet-cs-touchhandle-btn"></div></div>
                                                        </div>
                                                    </div>
                                                    <div id="luckysheet-postil-showBoxs"></div>
                                                    <div id="luckysheet-multipleRange-show"></div>  
                                                    <div id="luckysheet-dynamicArray-hightShow"></div>  
                                                    <div id="luckysheet-image-showBoxs">
                                                        <div id="luckysheet-modal-dialog-activeImage" class="luckysheet-modal-dialog" style="display:none;padding:0;position:absolute;z-index:300;">
                                                            <div class="luckysheet-modal-dialog-border" style="position:absolute;"></div> 
                                                            <div class="luckysheet-modal-dialog-content"></div>  
                                                            <div class="luckysheet-modal-dialog-resize">
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt" data-type="lt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt" data-type="mt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm" data-type="lm"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm" data-type="rm"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt" data-type="rt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb" data-type="lb"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb" data-type="mb"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb" data-type="rb"></div>
                                                            </div>
                                                            <div class="luckysheet-modal-dialog-controll">
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-crop" role="button" tabindex="0" aria-label="\u88C1\u526A" title="\u88C1\u526A">
                                                                    <i class="fa fa-pencil" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-restore" role="button" tabindex="0" aria-label="\u6062\u590D\u539F\u56FE" title="\u6062\u590D\u539F\u56FE">
                                                                    <i class="fa fa-window-maximize" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del" role="button" tabindex="0" aria-label="\u5220\u9664" title="\u5220\u9664">
                                                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div id="luckysheet-modal-dialog-cropping" class="luckysheet-modal-dialog" style="display:none;padding:0;position:absolute;z-index:300;">
                                                            <div class="cropping-mask"></div>
                                                            <div class="cropping-content"></div>
                                                            <div class="luckysheet-modal-dialog-border" style="position:absolute;"></div>
                                                            <div class="luckysheet-modal-dialog-resize">
                                                                <div class="resize-item lt" data-type="lt"></div> 
                                                                <div class="resize-item mt" data-type="mt"></div> 
                                                                <div class="resize-item lm" data-type="lm"></div> 
                                                                <div class="resize-item rm" data-type="rm"></div> 
                                                                <div class="resize-item rt" data-type="rt"></div> 
                                                                <div class="resize-item lb" data-type="lb"></div> 
                                                                <div class="resize-item mb" data-type="mb"></div> 
                                                                <div class="resize-item rb" data-type="rb"></div>
                                                            </div>
                                                            <div class="luckysheet-modal-dialog-controll">
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-crop" role="button" tabindex="0" aria-label="\u88C1\u526A" title="\u88C1\u526A">
                                                                    <i class="fa fa-pencil" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-restore" role="button" tabindex="0" aria-label="\u6062\u590D\u539F\u56FE" title="\u6062\u590D\u539F\u56FE">
                                                                    <i class="fa fa-window-maximize" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del" role="button" tabindex="0" aria-label="\u5220\u9664" title="\u5220\u9664">
                                                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="img-list"></div>
                                                        <div class="cell-date-picker">
                                                            <input id="cellDatePickerBtn" class="formulaInputFocus" readonly="readonly"/>
                                                        </div>
                                                    </div>
                                                    <div id="luckysheet-dataVerification-dropdown-btn"></div>
                                                    <div id="luckysheet-dataVerification-dropdown-List" class="luckysheet-mousedown-cancel"></div>
                                                    <div id="luckysheet-dataVerification-showHintBox" class="luckysheet-mousedown-cancel"></div>
                                                    <div class="luckysheet-cell-copy"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div>  \${flow} 
                                                </div> 
                                            </td> 
                                        </tr> 
                                    </tbody> 
                                </table> 
                            </div> 
                            <div class="luckysheet-sheet-area luckysheet-noselected-text" id="luckysheet-sheet-area">
                                <div id="luckysheet-sheet-content">
                                    <div id="luckysheet-sheets-add" class="luckysheet-sheets-add lucky-button-custom"><i class="iconfont luckysheet-iconfont-jia1"></i></div>
                                    <div id="luckysheet-sheets-m" class="luckysheet-sheets-m lucky-button-custom"><i class="iconfont luckysheet-iconfont-caidan2"></i></div>
                                    <div class="luckysheet-sheet-container" id="luckysheet-sheet-container">
                                        <div class="docs-sheet-fade docs-sheet-fade-left" style="display: none;">
                                            <div class="docs-sheet-fade3"></div>
                                            <div class="docs-sheet-fade2"></div>
                                            <div class="docs-sheet-fade1"></div>
                                        </div>
                                        <div class="docs-sheet-fade docs-sheet-fade-right" style="display: none;">
                                            <div class="docs-sheet-fade1"></div>
                                            <div class="docs-sheet-fade2"></div>
                                            <div class="docs-sheet-fade3"></div>
                                        </div>
                                        <div class="luckysheet-sheet-container-c" id="luckysheet-sheet-container-c"></div>
                                    </div>
                                    <div id="luckysheet-sheets-leftscroll" class="luckysheet-sheets-scroll lucky-button-custom"><i class="fa fa-caret-left"></i></div>
                                    <div id="luckysheet-sheets-rightscroll" class="luckysheet-sheets-scroll lucky-button-custom"><i class="fa fa-caret-right"></i></div>
                                </div>
                            </div> 
                        </div> 
                        <div class="luckysheet-stat-area"> 
                            <div class="luckysheet-sta-c">
                                <div class="luckysheet-zoom-content" id="luckysheet-zoom-content">
                                    <div class="luckysheet-zoom-minus" id="luckysheet-zoom-minus">
                                        <div class="luckysheet-zoom-minus-icon"></div>
                                    </div>
                                    <div class="luckysheet-zoom-slider" id="luckysheet-zoom-slider">
                                        <div class="luckysheet-zoom-line"></div>
                                        <div class="luckysheet-zoom-cursor" id="luckysheet-zoom-cursor"></div>
                                        <div class="luckysheet-zoom-hundred"></div>
                                    </div>
                                    <div class="luckysheet-zoom-plus" id="luckysheet-zoom-plus">
                                        <div class="luckysheet-zoom-plus-icon"></div>
                                    </div>
                                    <div class="luckysheet-zoom-ratioText" id="luckysheet-zoom-ratioText">100%</div>
                                </div>
                                <div class="luckysheet-print-viewList">
                                    <div type="viewNormal" class="luckysheet-print-viewBtn luckysheet-print-viewNormal luckysheet-print-viewBtn-active" title="${t.normalBtn}"><i class="icon iconfont luckysheet-iconfont-putong"></i></div>
                                    <div type="viewLayout" class="luckysheet-print-viewBtn luckysheet-print-viewLayout" title="${t.layoutBtn}"><i class="icon iconfont luckysheet-iconfont-yemianbuju"></i></div>
                                    <div type="viewPage" class="luckysheet-print-viewBtn luckysheet-print-viewPage" title="${t.pageBtn}"><i class="icon iconfont luckysheet-iconfont-fenyeyulan"></i></div>
                                </div>
                                <div class="luckysheet-sta-content" id="luckysheet-sta-content"></div>  
                                <!--<div class="luckysheet-bottom-content" id="luckysheet-bottom-content-show"></div> -->
                            </div> 
                        </div> 
                    </div>
                    <div id="luckysheet-copy-content" contenteditable="true"></div>
                    <input id="luckysheet-copy-btn" type="button" data-clipboard-target="luckysheet-copy-content">
                    <div id="testdpidiv" style="height: 1in; left: -100%; position: absolute; top: -100%; width: 1in;"></div>
                  </div>`},o0='<div id="luckysheet-cell-flow_${index}" class="luckysheet-cell-flow luckysheetsheetchange" style="width:${width}px;"><div class="luckysheet-cell-flow-clip"><div class="luckysheet-grdblkpush"></div>${flow}</div></div>',a0="";c0=function(){let n=Oe().pivotTable;return'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-pivotTable-config-option"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.titleSort+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-order"> <option selected="selected" value="default">'+n.titleNoSort+'</option> <option value="asc">'+n.titleSortAsc+'</option> <option value="desc">'+n.titleSortDesc+'</option> </select> </div> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.titleSortBy+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-orderby"> </select> </div> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.titleShowSum+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-stastic"> <option  value="0">'+n.titleStasticFalse+'</option> <option value="1" selected="selected">'+n.titleStasticTrue+"</option> </select> </div> </div> </div> </div>"},u0=function(){let n=Oe().pivotTable;return'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-pivotTable-config-option-sumtype"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="SUM"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsSUM+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNT"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsCOUNT+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNTA"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsCOUNTA+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNTUNIQUE"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsCOUNTUNIQUE+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="AVERAGE"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsAVERAGE+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MAX"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsMAX+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MIN"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsMIN+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MEDIAN"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsMEDIAN+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="PRODUCT"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsPRODUCT+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="STDEV"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsSTDEV+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="STDEVP"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsSTDEVP+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="VAR"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticslet+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="VARP"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsVARP+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> </div>'},bi='<div style="${style}" id="luckysheet-sheets-item${index}" data-index="${index}" class="luckysheet-sheets-item ${active}"><span class="luckysheet-sheets-item-name" spellcheck ="false" contenteditable="false">${name}</span> <span class="luckysheet-sheets-item-menu luckysheet-mousedown-cancel"><i class="fa fa-sort-desc luckysheet-mousedown-cancel"></i></span>${colorset}</div>',f0='<div class="luckysheet-cols-h-cells luckysheetsheetchange"  id="luckysheet-cols-h-cells_${index}" style="width:${width}px;"> <div class="luckysheet-cols-h-cells-c"> <div class="luckysheet-grdblkpush"></div>${column}</div></div>',h0='<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-sheet-list">${item}</div>',d0='<div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"  id="luckysheet-sheet-btn${index}" data-index="${index}"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="${style}" ><span class="icon luckysheet-mousedown-cancel">${icon}</span>${name}</div></div>',m0='<div dir="ltr"><div class="luckysheet-input-box-index" id="luckysheet-input-box-index"></div><div id="luckysheet-input-box" spellcheck="false" aria-hidden="false" class="luckysheet-input-box"><div class="luckysheet-cell-input editable" tabindex="0" role="combobox" contenteditable="true" id="luckysheet-rich-text-editor" dir="ltr" g_editable="true" aria-autocomplete="list"></div></div></div>',kl='<div id="${id}" style="${style}" class="luckysheet-modal-dialog ${addclass}" tabindex="0" role="dialog" aria-labelledby=":41e" dir="ltr"> <div class="luckysheet-modal-dialog-title luckysheet-modal-dialog-title-draggable"> <span class="luckysheet-modal-dialog-title-text" role="heading">${title}</span>	 <span class="luckysheet-modal-dialog-title-close" role="button" tabindex="0" aria-label="${close}"><i class="fa fa-times" aria-hidden="true"></i></span> </div> <div class="luckysheet-modal-dialog-content">${content}</div> <div class="luckysheet-modal-dialog-buttons">	 ${botton} </div></div>',g0='<div class="luckysheet-modal-dialog-mask" id="luckysheet-modal-dialog-mask"></div>';v0=function(){let n=Oe().pivotTable;return`
        <div id="luckysheet-modal-dialog-slider-pivot" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot">
        <div class="luckysheet-modal-dialog-slider-title"> <span>${n.title}</span> <span id="luckysheet-modal-dialog-slider-close" title="${n.closePannel}"><i class="fa fa-times" aria-hidden="true"></i></span> </div>
        <div class="luckysheet-modal-dialog-slider-content">
            <div class="luckysheet-modal-dialog-slider-range">
                <div id="luckysheet-dialog-pivotTable-range"></div>
                <div id="luckysheet-dialog-pivotTable-range-seleted">${n.editRange}</div>
            </div>
            <div class="luckysheet-modal-dialog-slider-list-title"> ${n.tipPivotFieldSelected} <span title="${n.tipClearSelectedField}" id="luckysheet-dialog-pivotTable-clearitem">${n.btnClearSelectedField}</span></div>
            <div id="luckysheet-modal-dialog-pivotTable-list" class="luckysheet-modal-dialog-slider-list luckysheet-scrollbars"> </div>
            <div class="luckysheet-modal-dialog-slider-config-c">
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-filter">
                    <div> <span><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i> ${n.btnFilter}</span> </div>
                    <div id="luckysheet-modal-dialog-config-filter" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-row">
                    <div> <span><i class="fa fa-list-alt" aria-hidden="true"></i> ${n.titleRow}</span> </div>
                    <div id="luckysheet-modal-dialog-config-row" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-column">
                    <div> <span><i class="fa fa-indent" aria-hidden="true"></i> ${n.titleColumn}</span> </div>
                    <div id="luckysheet-modal-dialog-config-column" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-value">
                    <div> <span><i class="fa fa-cube" aria-hidden="true"></i> ${n.titleValue}</span> <span style="float: right;margin-right: 10px;display:none;" id="luckysheetpivottablevaluecolrowshow"><label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="${n.tipShowColumn}" for="luckysheetpivottablevaluecolrow">${n.titleColumn}</label> <input type="radio" checked="checked" value="1" name="luckysheetpivottablevaluecolrow" id="luckysheetpivottablevaluecolrow" /> <label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="${n.tipShowRow}" for="luckysheetpivottablevaluecolrow1">${n.titleRow}</label> <input type="radio" value="0" name="luckysheetpivottablevaluecolrow" id="luckysheetpivottablevaluecolrow1" /></span></div>
                    <div id="luckysheet-modal-dialog-config-value" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
            </div>
        </div>
        </div>
        `};k0='<div class="luckysheet-chart-point-config"> <div class="luckysheet-chart-point-config-set"> <div class="luckysheet-chart-point-config-left"> <div class="luckysheet-chart-point-config-left-top"> <div class="luckysheet-chart-point-searchcondition"> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 0px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u9009\u62E9\u7EF4\u5EA6</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="\u7EF4\u5EA6\u9009\u62E9" name="luckysheetpointconfigsearchdim" id="luckysheetpointconfigsearchdim"> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 3px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;">\u6392\u5E8F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <label data-tips="\u65E0\u6392\u5E8F" for="luckysheetpointconfigsearchorderno">\u65E0\u6392\u5E8F</label> <input type="radio" checked="checked" value="0" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderno"> <label data-tips="\u5347\u5E8F" for="luckysheetpointconfigsearchorderasc">\u5347\u5E8F</label> <input type="radio" value="1" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderasc"> <label data-tips="\u964D\u5E8F" for="luckysheetpointconfigsearchorderdesc">\u964D\u5E8F</label> <input type="radio" value="2" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderdesc"> </div> </div> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 5px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:90%;text-align: left;"> <select data-width="70" data-tips="\u6309\u7167\u4EC0\u4E48\u65B9\u5F0F\u67E5\u8BE2" name="luckysheetpointconfigsearchtype" id="luckysheetpointconfigsearchtype"> <option value="0" selected="selected">\u6309\u7167\u540D\u79F0</option> <option value="1">\u6309\u6392\u5E8F\u524D%</option> </select> <input data-tips="\u67E5\u8BE2\u5173\u4E8E\u70B9\u7684\u5173\u952E\u5B57" id="luckysheetpointconfigsearchcontent" type="text" class="luckysheet-datavisual-config-input-no" style="width:40%;" placeholder="\u67E5\u8BE2\u5185\u5BB9" /> <button id="luckysheetpointconfigsearchcomfirm" class="btn btn-primary luckysheet-model-conform-btn">\u67E5\u8BE2</button> </div> </div> </div> </div> <div class="luckysheet-chart-point-config-left-mid"> <span id="luckysheet-chart-point-btn-all" class="luckysheet-mousedown-cancel">\u5168\u9009</span> - <span id="luckysheet-chart-point-btn-clear" class="luckysheet-mousedown-cancel">\u6E05\u9664</span> - <span id="luckysheet-chart-point-btn-contra" class="luckysheet-mousedown-cancel">\u53CD\u9009</span><span style="text-decoration:none;color:#8D8D8D;float:right;margin-right:40px;cursor:default;" class="luckysheet-mousedown-cancel">\u53EF\u4EE5\u76F4\u63A5\u6846\u9009\u6570\u636E\u70B9</span> </div> <div class="luckysheet-chart-point-config-left-bottom"> <div class="luckysheet-chart-point-searchitem-c luckysheet-noselected-text">  </div> </div> </div> <div class="luckysheet-chart-point-config-right"> <div class="luckysheet-chart-point-itemconfig"> <div class="luckysheet-datavisual-content-row" style="font-size: 16px;font-weight: bold;"> \u6570\u636E\u70B9\u8BBE\u7F6E </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u56FE\u5F62\u989C\u8272</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <input data-tips="\u989C\u8272" class="luckysheet-datavisual-config-colorOpacity" id="scattersingleitemstylecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="color" /> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u56FE\u5F62\u5927\u5C0F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleallsymbolsizeslider" data-tips="\u70B9\u5927\u5C0F\u8BBE\u7F6E" name="scattersingleallsymbolsize" id="scattersingleallsymbolsize" data-width="50" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize"> <option value="4" selected="selected">4px</option> <option value="6">6px</option> <option value="8">8px</option> <option value="10">10px</option> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u70B9\u5927\u5C0F" id="scattersingleallsymbolsizeslider" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="1" data-max="50" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u70B9\u5927\u5C0F" data-sliderid="scattersingleallsymbolsizeslider" id="scattersingleallsymbolsizesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleallsymbolsizesliderdiy">px</label> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u56FE\u5F62\u5F62\u72B6</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="\u70B9\u7C7B\u578B\u8BBE\u7F6E" data-width="70" name="scattersingleallsymboltype" id="scattersingleallsymboltype" data-bigclass="scattersingle" data-attr="all" data-func="symboltype"> <option value="emptyCircle" selected="selected">\u7A7A\u5FC3\u5706</option> <option value="circle">\u5706\u5F62</option> <option value="emptyRectangle">\u7A7A\u5FC3\u77E9\u5F62</option> <option value="rect">\u77E9\u5F62</option> <option value="roundRect">\u5706\u89D2\u77E9\u5F62</option> <option value="emptyTriangle">\u7A7A\u5FC3\u4E09\u89D2</option> <option value="triangle">\u4E09\u89D2\u5F62</option> <option value="emptyDiamond">\u7A7A\u5FC3\u83F1\u5F62</option> <option value="diamond">\u83F1\u5F62</option> <option value="droplet">\u6C34\u6EF4</option> <option value="pin">\u6807\u6CE8</option> <option value="arrow">\u7BAD\u5934</option> <option value="heart">\u5FC3\u5F62</option> <option value="star">\u661F\u661F</option> </select> </div> </div> <div class="luckysheet-datavisual-content-rowsplit-sub"></div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u8FB9\u6846\u7C97\u7EC6</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleitemstyleborderwidthslider" data-tips="\u70B9\u8FB9\u6846\u7C97\u7EC6" name="scattersingleitemstyleborderwidth" id="scattersingleitemstyleborderwidth" data-width="50" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth"><option value="0" selected="selected">\u65E0</option> <option value="1">1px</option> <option value="2">2px</option> <option value="3">3px</option> <option value="4">4px</option> <option value="5">5px</option> <option value="6">6px</option> <option value="7">7px</option> <option value="8">8px</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u8FB9\u6846\u7C97\u7EC6" id="scattersingleitemstyleborderwidthslider" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u8FB9\u6846\u7C97\u7EC6" data-sliderid="scattersingleitemstyleborderwidthslider" id="scattersingleitemstyleborderwidthsliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleitemstyleborderwidthsliderdiy">%</label> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u8FB9\u6846\u6837\u5F0F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="\u70B9\u8FB9\u6846\u7C7B\u578B\u8BBE\u7F6E" data-width="50" name="scattersingleitemstyleborderlinetype" id="scattersingleitemstyleborderlinetype" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinetype"> <option value="solid" selected="selected">\u5B9E\u7EBF</option> <option value="dashed">\u865A\u7EBF</option> <option value="dotted">\u70B9\u7EBF</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u8FB9\u6846\u989C\u8272</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <input data-tips="\u70B9\u8FB9\u6846\u989C\u8272" class="luckysheet-datavisual-config-colorOpacity" id="scattersingleitemstyleborderlinecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinecolor" /> </div> </div> <div class="luckysheet-datavisual-content-rowsplit-sub"></div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"><i class="fa fa-th-large" aria-hidden="true"></i> \u6587\u5B57\u6807\u7B7E</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <label data-tips="\u663E\u793A\u6570\u636E\u70B9\u7684\u6807\u7B7E" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow">\u663E\u793A</label> <input type="radio" checked="checked" value="1" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> <label data-tips="\u9690\u85CF\u6570\u636E\u70B9\u7684\u6807\u7B7E" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow1">\u9690\u85CF</label> <input type="radio" value="0" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow1" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> </div> </div> <div class="luckysheet-datavisual-content-row" style="height:auto;line-height: initial;margin-left:auto;" showfor="scattersinglelabellabelshow1" hidefor="scattersinglelabellabelshow"> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:40%;">\u6570\u503C\u6BD4\u4F8B</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:50%;"> <select data-tips="\u523B\u5EA6\u6570\u503C\u653E\u5927\u6BD4\u4F8B" name="scattersinglelabelformatratio" id="scattersinglelabelformatratio" data-bigclass="scattersingle" data-attr="label" data-func="formatratio"> <option value="0.01">\u4E58\u4EE5100</option> <option value="0.1">\u4E58\u4EE510</option> <option value="1" selected="selected">\u9ED8\u8BA4</option> <option value="10">\u9664\u4EE510</option> <option value="100">\u9664\u4EE5100</option> <option value="1000">\u9664\u4EE51000</option> <option value="10000">\u9664\u4EE51\u4E07</option> <option value="100000">\u9664\u4EE510\u4E07</option> <option value="1000000">\u9664\u4EE5\u4E00\u767E\u4E07</option> <option value="10000000">\u9664\u4EE5\u4E00\u5343\u4E07</option> <option value="100000000">\u9664\u4EE5\u4E00\u4EBF</option> <option value="1000000000">\u9664\u4EE5\u5341\u4EBF</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:40%;white-space: nowrap;">\u5C0F\u6570\u4F4D\u6570</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:50%;"> <select data-tips="\u6570\u503C\u5C0F\u6570\u70B9\u4F4D\u6570" name="scattersinglelabelfloatlen" id="scattersinglelabelfloatlen" data-bigclass="scattersingle" data-attr="label" data-func="floatlen"> <option value="auto" selected="selected">\u81EA\u52A8\u663E\u793A</option> <option value="0">\u6574\u6570</option> <option value="1">1\u4F4D\u5C0F\u6570</option> <option value="2">2\u4F4D\u5C0F\u6570</option> <option value="3">3\u4F4D\u5C0F\u6570</option> <option value="4">4\u4F4D\u5C0F\u6570</option> <option value="5">5\u4F4D\u5C0F\u6570</option> <option value="6">6\u4F4D\u5C0F\u6570</option> <option value="7">7\u4F4D\u5C0F\u6570</option> <option value="8">8\u4F4D\u5C0F\u6570</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:20%;">\u6807\u7B7E\u683C\u5F0F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:70%;"> <select data-sliderdiy="scattersinglelabelcontentformatslider" data-tips="\u6807\u7B7E\u663E\u793A\u683C\u5F0F" name="scattersinglelabelcontentformat" id="scattersinglelabelcontentformat" data-bigclass="scattersingle" data-attr="label" data-func="contentformat"> <option value="default" selected="selected">\u9ED8\u8BA4</option> <option value="1">\u4EC5\u6570\u636E\u540D</option> <option value="2">\u6570\u636E\u540D+2\u7EF4\u6570\u503C</option> <option value="5">\u6570\u636E\u540D+\u5168\u90E8\u6570\u503C</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> </div> </div> <div style="display:none;"> <div class="luckysheet-datavisual-content-row" id="scattersinglelabelcontentformatslider"> <div style="text-align:center; width:60px; display:inline-block;">\u6570\u636E\u540D\u79F0</div> <label data-tips="\u662F\u5426\u663E\u793A\u6570\u636E\u540D" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow" for="scattersinglelabeldatalabelshow" style="font-weight:bold;"><i class="fa fa-eye" aria-hidden="true"></i></label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelshow" id="scattersinglelabeldatalabelshow" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow"> <input data-tips="\u663E\u793A\u5728\u6570\u636E\u540D\u524D\u90E8\u6587\u5B57" placeholder="\u524D\u7F00" id="scattersinglelabeldatalabelprefix" type="text" class="luckysheet-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelprefix" /> <input data-tips="\u663E\u793A\u5728\u6570\u636E\u540D\u5C3E\u90E8\u6587\u5B57" placeholder="\u540E\u7F00" id="scattersinglelabeldatalabelsuffix" type="text" class="luckysheet-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelsuffix" /> <label data-tips="\u662F\u5426\u5728\u6570\u636E\u540D\u540E\u6362\u884C" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline" for="scattersinglelabeldatalabelline" style="font-weight:bold;">\u6362\u884C</label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelline" id="scattersinglelabeldatalabelline" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline"> </div> </div> <div class="luckysheet-datavisual-content-row" > <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u6807\u7B7E\u4F4D\u7F6E</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersinglelabellabelplaceslider" data-tips="\u6807\u7B7E\u8DDD\u79BB\u56FE\u5F62\u4F4D\u7F6E" data-width="70" name="scattersinglelabellabelplace" id="scattersinglelabellabelplace" data-bigclass="scattersingle" data-attr="label" data-func="labelplace"> <option value="top" selected="selected">\u9876\u7AEF</option> <option value="left">\u5DE6\u4FA7</option> <option value="right">\u53F3\u4FA7</option> <option value="bottom">\u5E95\u90E8</option> <option value="inside">\u5185\u90E8\u5C45\u4E2D</option> <option value="diy">\u81EA\u5B9A\u4E49</option> <option value="insideLeft">\u5185\u90E8\u5DE6\u4FA7</option> <option value="insideRight">\u5185\u90E8\u53F3\u4FA7</option> <option value="insideTop">\u5185\u90E8\u9876\u7AEF</option> <option value="insideBottom">\u5185\u90E8\u5E95\u7AEF</option> <option value="insideTopLeft">\u5185\u90E8\u5DE6\u4E0A</option> <option value="insideBottomLeft">\u5185\u90E8\u5DE6\u4E0B</option> <option value="insideTopRight">\u5185\u90E8\u53F3\u4E0A</option> <option value="insideBottomRight">\u5185\u90E8\u53F3\u4E0B</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;height:65px;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u70B9\u6587\u672C\u6C34\u5E73\u4F4D\u7F6E" id="scattersinglelabellabelplaceslider" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u70B9\u6587\u672C\u6C34\u5E73\u4F4D\u7F6E" data-sliderid="scattersinglelabellabelplaceslider" id="scattersinglelabellabelplacesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplacesliderdiy">px</label> <br /> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u70B9\u6587\u672C\u5782\u76F4\u4F4D\u7F6E" id="scattersinglelabellabelplaceslider1" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u70B9\u6587\u672C\u5782\u76F4\u4F4D\u7F6E" data-sliderid="scattersinglelabellabelplaceslider1" id="scattersinglelabellabelplaceslider1diy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplaceslider1diy">px</label> </div> <div class="luckysheet-datavisual-content-row"> <label data-tips="\u52A0\u7C97" data-bigclass="scattersingle" data-attr="label" data-func="labelbold" for="scattersinglelabellabelbold" style="font-weight:bold;"><i class="fa fa-bold" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelbold" id="scattersinglelabellabelbold" data-bigclass="scattersingle" data-attr="label" data-func="labelbold"> <label data-tips="\u659C\u4F53" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic" for="scattersinglelabellabelitalic" class="luckysheet-datavisual-content-column-italic"><i class="fa fa-italic" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelitalic" id="scattersinglelabellabelitalic" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic"> <select data-sliderdiy="scattersinglelabellabelfontsizeslider" data-width="50" data-tips="\u5B57\u4F53\u5927\u5C0F" name="scattersinglelabellabelfontsize" id="scattersinglelabellabelfontsize" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize"> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="18">18px</option> <option value="20">20px</option> <option value="22">22px</option> <option value="24">24px</option> <option value="30">30px</option> <option value="36">36px</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> <input data-tips="\u5B57\u4F53\u989C\u8272" class="luckysheet-datavisual-config-color" id="scattersinglelinelabelcolor" type="text" data-bigclass="scattersingle" data-attr="label" data-func="labelcolor" /> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u5B57\u4F53\u5927\u5C0F" id="scattersinglelabellabelfontsizeslider" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u5B57\u4F53\u5927\u5C0F" data-sliderid="scattersinglelabellabelfontsizeslider" id="scattersinglelabellabelfontsizesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelfontsizesliderdiy">px</label> </div> </div> </div> </div> </div> <div class="luckysheet-chart-point-config-chart"> <div id="luckysheet-chart-point-config-chart-c" class="luckysheet-chart-point-config-chart-c"> </div> </div> </div>',b0='<div id="luckysheet-tooltip-up" class="jfk-tooltip" role="tooltip" aria-hidden="true" style="left: 505px; top: 410px;"><div class="jfk-tooltip-contentId">\u7EC4\u5408\u56FE\u8868</div><div class="jfk-tooltip-arrow jfk-tooltip-arrowup" style="left: 35.5px;"><div class="jfk-tooltip-arrowimplbefore"></div><div class="jfk-tooltip-arrowimplafter"></div></div></div>';_w=function(e){if(typeof e.image=="function")return e.image();let t=new RegExp("^(image|path)://").exec(e.image),l="";if(t!==null){let o=t[0],a=t[1],s=t.input.substring(o.length);switch(a){case"image":l=`<div class="image-type" style="background-image: url(${s});"></div>`;break;case"path":let u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.setAttribute("class","path-type"),u.setAttribute("viewBox",e.viewBox);let f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttribute("d",s),f.setAttribute("fill","currentColor"),u.appendChild(f),l=u.outerHTML;break;default:break}}return l},ko=function(e,n){if(!e)return;let t=xw();if(n&&JSON.stringify(n)!=="{}"&&Object.assign(t,n),typeof t.enable=="boolean"&&t.enable===!1)return{el:"",show:u,close:f};let l=_w(t),o="luckysheet-loading-"+uuid.v4(),a=`
        <div class="luckysheet-loading-content"> 
            <div class="${t.imageClass} luckysheet-loading-image">
                ${l}
            </div>
            <div class="${t.textClass} luckysheet-loading-text">
            <span>${t.text}</span>
            </div>    
        </div>`,s=document.createElement("div");s.id=o,s.className="luckysheet-loading-mask "+t.customClass,$(s).html(a),$(e).append(s);function u(){o&&$("#"+o).show()}function f(){o&&$("#"+o).hide()}return{el:s,show:u,close:f}},si=["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],rl={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:33,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,WIN:91,WIN_R:92,MENU:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145},Tn={fillStyle:"#000000",textBaseline:"middle",strokeStyle:"#dfdfdf",rowFillStyle:"#5e5e5e",textAlign:"center"},ps=function(){return"normal normal normal "+h.defaultFontSize+"pt "+Oe().fontarray[0]+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC",  "WenQuanYi Micro Hei", sans-serif'},ac=new Image;ac.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZoAAAGACAYAAACUS6SeAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAHBbSURBVHja7J13mFxV+cc/M7OzLbvpjZBKQhISUgAhgAlVkADSRcDyky4iYAAhAmpQQtMIiqigYkV6FRHphgBBKSGBkB5IIb1sdrO72dmZ+f3xniGTzZR755a5s/t+nmefTGbuPec7Z8497ynveU9on5m3YJMuwNnAt4B9gA3A48CPgY0UyPxJUzN/MLMShxwDXAMcAmwGbgD+UlBKhzVn/+yqqwrVFwIuBL7tZnkyYwaK98yaNb/QW6uBk4DLgfHAduDfwI+ApYUmOnHiKC+0AowAfgh8EYgAvwF+AMTd1OlQ40nAtcB+QIMpzx8Cy70oT8U6YZvXn2x+tN8A44ByYE/gMmA18B9g7wB9v58AzwNfADoBA4A/m4c5KPwWuCdDef4X6KVVtF1yGPAx8IDpAFUBPYGvAguBucCRAdJ7CvAecA7QA+gKfB94DKgMiMargaeAQ0159gK+BrwNqLUoIUNzFPAw0C3L5+XmAXoZ6B+A7/ZNM3rJxDTgl2Y0UUwmAxdl+WwI8HOtou2OzwFP5+hERIAxwDPAhADoHQvcbxrvTB3PZ4HaImscDmSbmukO/F6rXWkYmgnAP4wxyUd/U/m6FPF7lQO35bnmMuCvQLSIOs/J8/npQIVW03bDPjaejWrgn8boFJPpRks2jgReKfLo+yygLMfnhwCDtPoF29CMMUam2ka6Y8wDVV2k73Uw0NvCdV9F1kOqiqQzX+WvQqfP2gsDkWlcO79nD/McFWuGoAJZk8nHAcBM8x2LwRAL1+ytVTC4hmawqeiFNHaHInPQkSJ8rxob156ILBp2LYLOkAu/kRJ8egEvFWgw+iPT0cXocJTnGSmkMxJ4zfxbDJ1WjKYSQEPTC3jBYW/qJODX+L8WMhuos3H9JDP876NVQnGZLsbIDHOQxt5mVqGTz9rrgTdtjtpmmhGOouQ1NF2MkRnmQh4XATf7/L02GyO3zcY944FZZhSnKG5QDfwLd9ZZJiBOBOU+f4evAAtsjt5eIVhec0oADU21qdDjXMxnKnCJz99tJuIpt97GPcOA14HRWjUUh5QDTyAL0W5xFPAn/J2OXoV4k75j455aZMr9ZK0GSiZDE0XWVQ7zIK+7kI2efvKO+S6f2LinnzFSB2v1UAokAvwNONaDtM82z5KfbDBG7lUb91Qi+2z+T6uDkm5oQsAfkSknrx6+P5kK6ycLkTWYj2zc0x14EYkqoCh2CCGbcL/sYR6XIDve/WQbsu/rKZvP/B+BKVotOjbpHiW/RNx9vZ5OeByZv32vwDQmG51DsOdJYne/TCdk09xXgUcdfN9DkE2urwGbXCjDLsDvEG+5rcCTSASENVqdA8HtwAU+5HOjGWn8psD7RxmDNRZ7TgZ2p+1CyMbjzkZzoR3izyGOSf8DVrrUFv0S2cvWgqyl3Qgs0SrsnaH5IfAdn/LsgrgTH2rzR031FC/ysXzKzSjsBex5sQGci2wa7ZXWIzzZ5vRDW6oR76NJ5v9VprE4wxie/2qVLirXIaFQ/OIu03l52OZ93wTuxd/NytOQdZv/2bzvGMRzNeWY1Aqch2y2djLqvK9Nx/prSKidc8wzprhI2PxoN/qcby/Tg7CzN+BbPhuZ9JHNWTbvmW4qcvr362xGH/sXqCOCrJ9NylKezwB9tUoXjfPM7+4nEdPg2pmOHoXE1itGRIyLbV7/VdNODGvTOXY6xf8rMs/e1AAPoc5Anhia64uU9zDsxSD6VhHL6ds2e2DX5RjNPYd9t/GQeThOymO8r9cqXTSKVfblyNRuZ4vXX4D/LtLpowarcdGGmPYhksXAPkhh671T8zzPVfi/HaNDGJo9LF77EWAlhvetNvK342s/oojlZGe387UWRnN2A4/ebNHQnqpVumhYfY5WIfu18vFzZO3ACt2QfWBW2KeIZVSB9ZhjV5A7MnQVst5rZ3PoNy0akckUL3xWuzU0b1h8OI5FNkLm4zc2jI2dDZUbi1hOG2xce6iFawYg61TdLVx7iemFWaGzVumi8YbFenQcsMLCtS8jrsxWz3tpKIHnCGCLxeusRK7ugkytWYl1dpIZIVmJUhLFXhgrxYKhud3Cw3GUMTZWuQ5ZuM/HEzbSfLqI5fSkjWuten+Nwto5GVNt5P2KVumike8EwTrEYeNDG2k+jkQZz8cyrHtxPlHEMnoLObfKTYPUC2ubYi/Cusfc+9jb6K1YMDTP5xhO1plh5GKb6SYRL7an8/Ss7Cye/gg5LMpvmhCPGatML9JvuQR/3GqVzLyU47dvBE6jMK/A35B9zS/1rH3X/GvV0DxVpDK6zsa1P8H61KHbsxdnaHV239CALGSex65TRNsQd793Ckw7bob+r2X5MU8E1tqsABOQHdfNPpbRbJvTDffZNExuPRyTsTfFp7jPDchO+LVtjMyZyFSYk9HS3VmesSuw546bRDaT3oi/02hbsrQF2XgT2SIQ91FjI/AldC+N66Rv2PwjcpLeoUjI/FkuVMTUD/d7Y1i24GyD4Xrg66bn3gfrIcwxUxDftZnfJxTmUn2jGdJf6sNvmBp16sMRDP6CuKEfjBzP/KbNDlWu+rsNcQqJIGGSbkKmo+wSM52hn5jnyM5xzIcj0+J2PNe2m05nzKbOvyPrML/24XdrQQKIvqVV2FtDkyrsVz1oCN0Ox7EDawuqIIt/PynAyHyALNyudtAwdMXbaAstZkrmHa3KgSJms/dudSRyHfamn6zMOnxq4/pTTaNvx8hsAk5w0ID/BnGaucnD3yuJzOg8o1XXG9r7oVoRJFyL3T0Os5BgnKtdqLxeOTHETfovazVWfOAi4BGbo5+V5jlyOkqYDvzCw+92HTKbo6ihsU3Kz/58m/c9jbhyb3FBQwvZ16mccpk+HIpP/BCJJmAnztl84PNY23tnhSke1fefYW/vn6KG5jO6IN50dsNU/AGZimpyUUtqnWqei2neSuHBFBXFKiHECcFuiKo3kVBJK13UkkQ2XLo5Q3A/cI3+zGpoCuVeYGIBw/ML8cbLpQ44GncW7H+Hu/P0ipKNb2Mv/BLIOscXsLa52y6tZobgPy6k9SIy9ZzUn1kNTaF80ca1CeByxDXVy0q3AZmSW+UgjaeRSAH6cCh+MNnm9X9CHAYaPdTUiERBn+sgjbdMGi36EwfT0Fhp4BIB+F5Wp75akLDgfp1YuBw4nsLOpXkDeyFJFMUp221ce5sZIbT6oKvOjJoKmSFYgkxlN+rPG1xDk8+luIlgbBq0Emaj3jT6D/msbR7i7tlo857j9eFoN6x04VnzAysRBJLIQv1Un0fahcwQrEK2LOjG5oAbmnxeH48he1yKzfQ8lWkdEjn6pSLpewtxVGix+HAcj/2D15Tg8mCekf/7uOs84kTnm3lmBL4G3FkkfXZmCOrMtUu1+vlPmc3r/4UsRl+Y5Ue/MiDfa7UZNfyT3Q9XW4as4RR7J/1LyE7k+5Aw722JmYf8Apyt6yjBYw4Su+8nGT7bioSxCQIJJAzVv9j9wL4G4HTEu7OYzEPWkv6BRDloS9xcc4mbxnvWrPmB+IEmThxVEhW+EGeAi82PNtf0aFYju4UPCtiQ9H/AOGT9ZRUyrfcY4tsflHAtTyIhzi/NUJ79kHAfi1HaIzchMdBmI7H7NpsRxEFmRBMU1iMenFORM6l2GM2HB8DIpD/rQ0x5vmnKcxMyA7M3sJ/RrJTIiAZkHva3WDsGoNisQTzKLg+wxjpjWH6t1bFDUY1sgEyav4TpfScCqLUJWey/LcDl2YRELnikBH77k5EDEsebkeG/KF50en8MzfxJU/WRd4MZM7QMFKschhy/nD6tW4XExTsL2U1/BR3wfKHUVFCxp6Y8nJK6po3BrgK+gawfTQIW6IimKI9kM4rSjvgcsh+qS5bPI8AYZOPjUbgYTXjixFFWGvAIsmbY3fzb9nWuz3Yga7h3k8VrzmEDPhwYbUYBb2L9VNFUg/4dY8hHmbZvCTKd/jNkbcxrRpL97K+eSJifw9XQKIrihH2AZ3MYmXSqEWeWI/HOA60PEl7mc0APYzScHAdebXrs1yBrjlchO/Cd0h/4K3BE2nv1yHTTneR3q+6OBJ8dl6Hhv96MJCfhvdPN2eSOF3cYMJBguLa7a2hGvVb8eHLtYvruqquCo0Wn8YLIQGTxvJeNe3oYw3SIB41gZyRK+TCPvu9Y4DkkUsA/HKTTAwlKO7jN+7XAz5HF/kvzGJvpGYxMOoMR54xvelwHBlu4ZkB7NDRhff4VxXN6Ie7s/Qvszb9s00BZ4bseGpkUEeTQw04O0rg+TwN9CRIMN9dIYYKFfD7nR8fewjWh9vgAhB1WgM3m73qUFF8CPkRCcSR9+ms1eZ6kxR84uhgj46RR39uMCjq5qOsMn75/byQieqGcbuGac5GTTbMZGysLvT20qgbP0HzJDDVTi4A3aSP3GX9GFhsjPuYZMXn+RYs/UFQjrqtjXEhrAuJEUO6StmE+lsP3HdxrdRR4DvBwlvKxEkm6m1bXYBma/mTe8zHDg+F9KfJQB81b2ZVyJObeIS6meRQSIdmNToyf+3VGOrjXztrUaYgXWUUBhqYC8UxTAmBouiCLk/2z9JAecrHHVapcgr1z2N3ieiRqg1J8IsDfkKCPbnM27kQb93OjipN1h6dsXn8iMs1Ynfae1dNydVTjEWU2H57780wDHImc7X2JawpnVgantKzv6TkTWcD1y+g+CNyi1TkQhJCoGV/2uDOzFvixgzQeBg70qUycbIb7MbKTfqCNe44xHeITkb02dgzNp1qFizuiuQsJVJmPb2H/VL72xuv4d3rf28D56GFoQeF2JBCq19zosEP3K5wdHmYHJxHdNxrDYfdY6FQsti42DI1Th4Awspb2JSRWoRuUIxs5601Z/AUY2l4NzVSblfpOZD7ZbWqR8A2fIHPMXnlxJUwet5k8C+F+vD9y+VO8P9FQsc51wNU+5neXGT0XOso4GtnJPx8JTPk8Mv39G2QH+/eQTZfFrl+LjOH42OZ9hyAef1an7pxMnU0GFiLBO59Gotmf5fB7p6ZgLwJqjCH8OhL9e3IpPRhWps5OQjY82SFqKuwhuBcpuRqYiQSi82P6YyCyw/lYJOJzIQ/brchu8G94NB1xGnqEQFA4r4DnxCkRZMf8RmSqtpDRwkU5Pu9sjE91AMp3ObJz/kUkFI1VDjDPoJeG5qtmpBFuMxL5i2k3nnbQkcg0BVuDxMo7gBKJjZZvRDMBeIDCvNN6Il43XVzSer1PRqYt43G2T+jCAhsBK+m+hRIUirWXrNw0Op1dTrcaibc2IUBlvBIJQ/NRAd/FK0OzN7JhNJylw/2AMZB2yTeLVF2Ejo0nhmYvdvfesMu+Zujnhjvm2UUsJyd5t5iRh5vxqm435aoEhz0sXrcKCf2Sj59j7QTWVAPpZiesCvH2mhTAcl6DTKPN8SDtQgzNVezuTt3WIDyNhOSxyiVkD76ZzomzZs0vD8ohbIUYmi7IoVxu7Is50WKh5WPPIpaT07zrkLUUNw6Gewbv134U+7xh4ZoNyJn1VmJZvWw6OHGL+Te49D1SI6QvBLisNyDrS28HwNAcYOGaLsiU3xAL156ETJmFLP5WnUrh4QhnEf847uxmTnENcra4E1YXsZzcyHsp4o3iZGH1Q1OOcZSgkc+9vM50uj60kebjwGUWrlsGvOfCdyhDXOWPd7ls6jwo783GGL7uYprdC7hnq8XremFt8+73sD4D9DbWPeoCZ2juxRuPsd/hbL73gSKWk1t5v2V6qYW4Im9Czm+vQwkiL5F9zrwRmT79bwHp/ibPCDaJBMh06t6e8nA6tYTKvM6MEP9TREPzQ6xPcbo9qju7VH6otoZmKvB/HuVVaXpo/Qu8fzrezMvmYw7uLro9jf2pr1bEjXUJSpC5wTw/a9sYmdQGXiejpbszvB9HTuL8h0PdISTK8lds3vc84tJbTBrMCOzfLqRVyNTZm/i3Zy69Tn2plNqDdEPzVdxZS8lFP2Nsqgss3MOQmGp+nNewAlmQPQz39xHcanqqVvku3niuKe7zF8Q1/jAzihmKHGDmlMuMwdkCbEPW6j6P83A0IVMXv2nzvv+Y0Y9fvfnO5rvOR6ahlwLvINNHM3FnDbdQ9+b7kdM7/aDFzGyUlMdpah/NocB9+HMWwoGIO+A5BfQC6pENcVdT+lyGnLORb+PVPVl6s0pwiSGHdblJ0oyE3XYE+Tn2Y+S9ifP1Rrsd4ieREFde4mTD5q+RdZhpHupLmtHTC6X2QKQMzSP4GwzzLMTdN/8I6rBm2ilxZI71NbI7XrwCXK7ttuIRl5vRsh3eMZ2jeh91nuaDkXFqaEDCAvVCTvz0gmvN6KnkCJthc78i5D0dCT7YkalD5pcz7e5fisyZt6Ao7lNlGkY7zAO+yK4OKVY2czvtLZ7uU5m40au9zCNjcCvw01KtbGG8jTJrZWTT0VlF5iCkV+LOvhtFycQEoKuN6z9C9q5savO+lViAOxxqHe5TmfzZhTRS01vPuKjLj7iJnhua85EFNj/3ZsRNnv+nzzsgXkM3ID75683rp7VYFA+xEyx2CRJBeUOBowCnbUvYpzL5lUvptJjZCDf2+PwT/73aXKcMCTXxlD53RWc6JRS7SCl5rG4c/QTZV5dt0/LLFkYcTj2kluB9nMMluOuq3Ygcq5JrDRYL5XYm7WD6vEyfN5eYMUPLQCklliFhUXKFmlllPs91FsxU05B+PsvnryOL2E54AjjDw7JIIjvy3R411CHR319DTiC2a/j89Ozz1tDMnzRVHzlF8Rcrh3j5sVfsXNMIDs6i8RjybwqsQ/YMnYl4h40w7y9FTvF8GDnfyQkPIftUDvGgDLYi3ndPelTGaxEvvVexvtdnFeJl127WaHVEoyj+86DpQWdbe3gfd6N952rQPocccfBlJGrHKmRT9XRkvdAKCfOdHvRIZxyZhrrNGLVo2mchcjs1VJM5uvJyxJPrYazHKyuUJcbYvEb+Y1NyeaKWrqEZ9dqtgRCiIyufuOqqYOnpmFOOc4AfAT/J0sP200lmE+LheGVQCidL2Pst5D6kzRMNEyeOcivJecg02jNkjorfYurFFW52MoJyhEDpjGhmVhY3//a7cVQpDjchi89XIgvdjUjssB8Ci7V42iX/RaYpT0M2dY4HtgP/An6A/aOqS2dEU8A9XZAd7d9CjkjdYIbaP0aOhu3YtF+DGEJO9fy2/u6uUI1ETE6avwQyRZTQonHEPsZYH2PK91dIWJigHK3RiETJLoWDC7+JbEAdbUa+T5myXG83IbuG5mTgj+waqmFPI+ZiYDZwgY89sj2Rk0ArkXnaKvOXel1ptKa/rmxzTRVyBvd7wJ3I/pXt+rzuxm/bTF2kfvcTkc1/urnUOocjYZ/Sp1CqkMC2ZyF7zK5AQhAp1jkN2dyY3tu7ARiFxFbc4VZGqSm1Yk9NuTi115Y7TR1M0Q85+fN4YCI215DsGJqjkIWzbDHRypGFupcR7xAvF7MipuE7H/cCgR4E/N00mBfizt6iEOLZc4Xpae1AFgSnYf9skqh5YHoCnwKLfOylTSb7/PgQJDDj17Wds8SBpm51yVG3xyBz+UfhfZTersjR4HYX2TtlaQuWIlGmH0GiTPvFOPP8VmQxQM8iUY/9iNE2wjyrDUgAUjunn1aZ9uJMk0YYcSZ4xDxnfpxHdVgbI5POIKPjTDsJWt1xOwHZvW4l8GZ/86N28bAgrjYjJy+iTfcCHjOF7dTI3IdEqh5rHuIa02i/bvRboQb4mTGAc5C9D/ONsbkO66fxOeGcPJ+fTu5z05Wd0zr/tPhsVJtrx3ioJ2Ke1QtN47hX2t8QMwOQ7S9bWzAUOdtmKd7ufWnLLXnq4FHI4XQ9PNTQ34xCFyDTys+b5/S7Fu/vaTqgtwD7me8TZed04DvAHj6UZb4D1U7B5hHSVgzNGGNk7JwhM8ZU4GqPHg6vPWQipnF32jh/M8dI8l5knSsX5UhI8KsyNE69ERfUe32oeIMs9MJ6qR3JW4bP2yynHuY56u+Rpq/gzd6UVKP5EOJp5TVVFvM50MwoeFGePUzaR7R5vxa4A1krytcxvhnYN8fnQ43B8ZoBFmZXbJVhPkMz2FT0QhqRQ5EjkN3uce9jGlk/pjic9B7yGZEQcoZFrgOTTgUOzpPOuRYqhlNCLtSljkxvMxItpIHrj0xHe2HIvT62OYwcVOg1lTbamX2AWbgfqPN6Mm98TXEpcrZUrufkIAv5HBSQOl1utyJko5fpTTux/ieZxtTNKa4ePhbmjx0aRCsN+C/JfubMEItpDEIJKl2MkRnmII29zaxCJ5e1DfXh++9rsR47YQty0qad0eVMZHrKLawcZXAhEiE6m1GMWUijWyk+BOEcD8cLDh+OFBfh7hHRW30sHyfHGFhdAAwBvyDzdGCTxTRqUYJINbJHwo11lgmIR6SbBxT6FRH4Uh/yOANxkLFKHyQszOEu5W+1Q/41xGkhmsVg5qN7ezE01aZCj3Mxn6mIa5wbzMe/0/2cjMRetHn9DHY/otpqQL1qlKBRjgSDdHMN5CjgT7g3Hb3Ip7I414c8PkEceN61cU9n0xH4kgv52/GyPZPMpxpbMTRd8McByFNDE0XWVQ7zIK+7yO/NYIUY8DufysdJ5NRbsO+K+FNjlFNY3c+jhiZYRJD9HF4shJ9tniU3eMyn8vBrF/M6JBjlf2zcU4V4iH3NYd52t0OcbO6psmlooASnz8Jteu9/RNZVvHr4/mR6ZU6ZhvinB9nQLEWm3pps3ncLO0/Ts7oPoUbb9sAQQhZ9vXTtvQR3vI8eR6aPvGaLj+W/DdlC8A8b95QBfyH7WqkVfoz9vYPHsatH76b2amjSN2z+EtmZ7PV0wuOm1/Geg3TqETfCVMTZHcYo1JmGvRHx5jrZhUrrhOcQn/MnbI46ppvfZpbF62td+F0OMRX4NRsVPt8Q/3dI5ICtSBj2nwBr2rmhuR3ZSOw1NyJ7q37jII2EeUamI8c0p/ah1LEzFE4lEoLECZsd3LsvEnVkLPacIexGPUmtldZQ2JryRuTsHrvehUcD/0aiU/s1ooki3qw9gTfMSNApnZGtFieZ+vOPdOOb+jF+SG43WzfpYgr2UPKfdZGLFjM9kYkfuWBkwJ1QNM+bwn/aprG5EXEtt4KTqbNzkfDrvdKM68kOe7rVpqJNSpueuMT08k/EflSEUuE6dl9n85K7TKfgYYedqcty/I5PFtHQnGdGh34G//0JslH2/QLuXcjO6CiDbdw30bQTj/hgaL6C7Ozvl9bGnWmjrcnWUX2CnbNVVYiH3anGgP43bH7MG31+IHshi3Be7A24HplacwO3Trd7yRS43fSO99jQTEeiF/Rq0zN5Eti/wDQjyDrfpCy/+zNA33ZoZM7D/6O4I8BfcWc6ui01pvE5xoW0Cpk6G10EIwOynODEcWk54slmtxM9AevbKQo1NNcgZwb1S3uvkzFwBzuog/dnqYM9U8972DTMxWAYEqrCTaYi4dfdws1jVF9F5o4bPGoU7HIMO9eCMo06n8O+e3sI2QF9Up5ORrHqnJcU6zuVA4+aDoKbsw7P457rbyGG5iKKd4zJN3G2Z2mFKbuPCpgJsEIhLs4HI+u/2fJ9jsLc8O8i93pkL+AHYazvfv8IcS3Oh52T1I50sXJcnaMgnUwruMlMY2zcds8uZI0m3znuvcwUgJ355pvJHxEBvN+RXgysPkersLb29nNkethqD3e8S9+juxmBu+mWXYih2aeIv2UFzjdBf4qsI8/1QF8hI5qryb1Bv5DOpdVtKyeHkcUgKw/HsViba/2NDWPjVkM+BXENdhsvjguYZYyNm1FYC5k6O9TCNQOQ9TQrPahL2NU1OxedaX9YeY42IJ5GKyxc+zLiymw1QrcbI+XeJt8DXC6bQgzNpiL/nm7kvx6ZUnrXZW3dPHre+yFLGr0tPu9WO/a9w4iXTL6H4yjsue5dh4Txz8cTLhT6Fab3ZwerD2+jR5X4ddPguGVsCjE0Vr2/Rpk/K70bq7THc1byPXR1iCPEhzbSfJzsC/XpLMOZF2dqRPYq7m7UdmJonijib/km7nhipQzWUbi7HaMQQ7PW4nXDkDiPVgyNVf4RRuZib87xcEzG/kFmScSL7ekc12zE+eLpZUhkVDvUYX0+vdHDyjzbjBK3upBWIWs004v0EC/B+hEJpcRLOcq0ETkTpRBvu9+QfS0t9ax9F2fhZAYaI2N3usrq81HI6OARZCG5GHzf5fTqgC8iWweKZWhuxr+QQ+ksBS5Pzdldj3jNpJ+SuA3ZA/JOgRnEzdD/tSyjpBNtWNlsFvUX2AsTU4csgltdpHM6tRdBDgSbgUwnXofENLsI2czZz7zvtAIUskZzH+5551llg+m4tNfTOG8A/q9NvW5E3EdfdjhaujvLM3YF9jYntmUIspPebjTj/2F902ghI5qkMc434e802mbTCXSbejOL8aILaRViaB5Fjhvx+3k/Dlid7tXxR8RN7VDkZL1ZOD8LvhGJI/R7Y1i24M7GvQvMg2fXyBxnHpBzLN7jZI0mjIT4ONmHH7RQ9+YbkUV/P4IepkbHS2jf/AVx705tiHvTYYcqffS+DXG2iCCOJTfh7ATO4abhs3vMxCzzPFsdmRY6ao8BPzAdoj7YC2VzpBkNRm3csx3nRz53ZvcNsFvTOpNuhOMp1L35DvO8f9+H5yDV9i+B3d0HW3A/JEUdsoPfLQ4yFciOkalH9qTMtjkCcDJ19nWfjIwTQ5NqwLribVSIFtM7fYeOQczFaZL0Hv515J5Gs0NPJEK7XSPzimlAttto8JyGoIkjXlxWOcN0RO0YmU3IXjcnhjuMxC87wuP65eSolOvM836Jx8/7yellWYqHVV2PPf/6BmNk3iigYXZiaM7zsUycxDpLGq1Pe6QtbtJ/GSVI/ABZm7HDv81IJjXSt7qfw89YZ99GNiXaOVr8E2R3/lsO8z7NByPjZEST3rl80CNtqfbkxbYWuNSws/em0fRSZhU4AnCyRrOfj2VS5UIP5GwPeuGpSn2/tuuB4xSb1z+NbMRN73wFzdDcaEYydsLofwB8HljgQv6n+/Q9dzi8P46sJb7ggbZrMz3vpWhorM5xNpqRzEwHIwAnazRVPpbJHBfSSM2pznNR1604C/qoeEc/G9c+ikx/txTQs64HWj3+LqmI2XYjWs9CYpOtdknHCJ9+u/tcSKPFdDbecvl5z7ifsRQNjZWGsNH0vv7j0Ag4MTQrfSwTt85lr0MWMd1YsP8d7q0nKO5jdc3jfsRDMlOUAiuGxg+PscsRT067I7RjXR5thXz67e52KZ1UZ9yNzuX9uZ73UjQ0v87zeZOx1C/luMbK5rbN2Ntc15YXfSqPjTiLvNqWDeYBXOUgjaeRxcYkSlCxcujZH5AplmwbnK0cK+3HtJndEzL/gKynNLmsww+Pyg+Aj11Mb7MxNssdpPFPZF0m6ZahsdJwJHwYNv4xxzD9FPLPPf6N3HsPms0D5sQZ4Kd4u+ET0wCcj/uBOpebyldIb/QN7IVOUYrD9DwN1m+QUO+5fkcr0y7/8+G71Nn83hd6VD+9jmaQwJu9MKkQY4Xsb3sL2SeWMy6fXUOTL0ZTE95vxkuaxvUbSCiXTUbXn5AF+OctNtCnGGPyH2Og4ubBuxeJYup0V/Ji0+Bu9qgc3jaVwytvsXnYP9pgnjFQjSi5WOnCs+aUTchRDq9m6KxdieytytexvN70sLOxDH+OILHSwCeQKbYbPBxpP4Q3mz1TMxdnWmzfCh2NfcGm0V5iRpN5n3e7YbjvJ/d+i8dw7hFh1dj81fw56R38xfx5xdPIPoXhyL6FSmR9qFva667m39TrSsQrLv11F/N5Ajnk6gfY21dQKG8ha13PWpgmWWWMTB1KPh4Evpejo/c+7jpl5PrNjjT1c7QZGb9pY4S8EdnXdoVpBEchHl9LTFvwM9wJsZSPBxC35mwRp1tMx/QhH2YYjkcOEjyMXffxhMwznY1OWZ6xpUhkiEdwP5p8W+aa5/1f5PfMTdUdSwMLu4bmX8gi74VZpluu7LBNx8ysznCNuOMVZl3HYc1upvgScirffWRe/I2ZxukCnK3r7MpVVwXr950xw83U5iCnwP4kw2dbzUjbTxaZv0JoQryNbi3irxNHNmlmOlOlHjmW4iWftGzBvmNCoFoyxMPw76aDm+l5fxuZVbL8vBdysNDFSNjrS4CRxqI9ZR6cjZ59fXcbT8UeTyI7wr9qfn//fvf2y03I0b9XImfJNJppkR9iP4itIiP8CWZ09Q1gr7R26n0tHls8i5xDdZYZKY5GplqfMbMptiNbF2JoUmeJJNv0KIo1YvAH7w3dMchRq4cg6zo34O20nl3qEI+/Xwf8IQmZEfe3kWjEG5Bw+z8OoEF8BOvnxLvCxImjaMf4Prpqx+XZgMSodOUUZLuG5mTE4yt9CmVPZPf3xchC2AXaI7PNT4xhSdEJ+DMSWdfdxdTUFFD7Ndy/bTN1kaqfJ5oer6vOKu284VZKnKDUTzuG5ihkITrbonA5sgD2sumVr/JB/56mMU5fVK80hjD9db5F+Bpkb82diNtzg4+/wTfbGJl0piEB9K7A2z0pIeBck88+iEPHayZ/u2eoRJFF4Z5mOmMR/rk6Tyb7/PgQ5IC8r2vzo42jEkxDM8E0wFY2aPVH5vgm4Z0HUgj4pZkecWvT6UHIAthGMyp7yofyL0c8VHJxGRJT6lxkIc6LsrzPGLx0YzEZmc67xOLwucYYpgvYdRFxPXJu0G0+GJx8xz+cbvTt0EdfUfzDSiM9xhgZO6HoxxhjU+2R7suREzy9iGzQE3HNPMyH8j8Ya+dzfxVZZ/Aifto5bYxM247IvcgZKPkM5gvIZrK2niq9kU1y9/pQnoPyfF6FnMehKEqADM1gYzAKeTgPRfzbIy5rDgFXe1wuEWQPgNfYCe9/IhKmvavLGr5lobx/bQx7Nk41RjMX52L/7JNC6oYbnStFUXwyNL1ML7W/g/RPMo2Um8HmhjrUZJUDgT08zmM29qYXJyFuxn1c1GDlnPjUVOXlWT4fYjGNQfrIKYoamhRdjJEZ5kIeFwE3u6i5t4/l82OP099sjLGdHb/jkfDmg13SYNXxIYSstWTalGs1OGGtPnKKooYGZF3laWCci/lMxb2jQ/3cC3GWD3nMRDz61tu4ZxgS5220C/nbjTI9g92nLq3GNqvWR05R1NBEkXUVLxbC70KCTDplCf6ccZHqxfvBO6bMP7FxTz9jpA52mPct2PcO/KnpPKSwem6PGhpF6eCGJoRsxjzJo7wiSITloxymk0A25fmBn1GIFyJrMB/ZuKe7GZEc4yDfpWbkZvdsjlvYedCR1am/Gn3kFKXjkb6P5pfkjszsBuWIm+6RWDt8LBs3mxHApAAbmsmmPIcAFTbui9rMpxMSg+iryJG7hfAccmzCEzZHHdNNHZpl8fpaF+rPIcjG29dcGtl2QQLFnogEtHwSidSwRpsHRXHX0PyQ3O6rbtIFcdM9lMJPpGtEjhz+MuIyu8O8V4ccWrYdWRM6zaHWQsJyh9g9DIrXlJvR4gsUvkn2eTOafdqmsbkR6yd8Opk6OxfZ9Nkr7bc5md3PU7FDNbJHLNVhqTL15gxjeP6rTYSiuGNozsOfw4nS6YUcOXAohceeiiE7+TPxfReMDFhfe0jnWxQnTHgnZArsHgdpvIQcdvZPm0bheI8NzXR2P4+8sxl9HIVE6bVLBFmPnJSlfj4DjAXWajOhKM4II6fkFYNhuBQZtA3fwz136kKmzr5VxN/z2y6k8Soy7edFvLdC1miOyWBk0kfHz2HfDT8E/Irc65G9ivhsKEq7MzRWNyV+BMy3cJ2dEN1Huvx9pgC3u5heIYZmRBF/z5EupTPTGJt6l/UVskYz1cLo+GXsbeK92WKH4FRtIhTFHUPzhoXrViHn02+2cO1vbBgbN48mvQKJzusmhegr5pknbobAn2WMjZuBUQuZOjvEwjUDkHW/7hauvcSC8UrRWZsIRXHH0OQbAWxA5sHthP2/DmsuyE+49D2+A9zhQfkUskbzdBF/zyddTu914DgXjU0hhsaq99co8+d0hJTOK9pEKIo7huZ5sq9p1Jlerd2DzJKm8X86T89/ugvf4RLENTtkU58VCpk6+xHwcRF+yyYkTL/bzDaj2a0upFXIGs30Ij0bS5AjBRRFcUjKvfl682C1dR89Bdm1XghxJBLAc+zu2bMB+BLOPXouBO62aWTqTONlZS2nEEOzATm/ZwbiJuvXUZazKXzaLoIcFzAe8ebbhriJN6S9vhXZpOkkWkIhazT3IVNj03x8LjaYDtYGbSIUxT1DAxIV4H7E5bgrMkfvdL2h0RiU3yP7Erbg3oa48xBXXrtGZjLW5vJTxrYQ1iMnOV6ARFq2c5LpZcB3beb3CYW7VIeR83dO9qG+FerefKPpAF3qg8ZUHVmizYOiuG9oAFpwtgEu24P7ZZfT/Bqym9uOkalH9nu8ifWYa9sd6twBrLB4bcgYYLtG5gNkHWV1gRq/7pORcWJoUga4K95Gr2hB9l+9o02DonhnaEqB/YE/YO8Aq+3GyLxhs8HzK9ZZxIzOzrd53yxkL8gWhyNDv3AS6yxptNbiTTy+uEn/ZW0WFMVdSvG0weuQkCtWaTRGZlYBPWs/DE0VEv/NrpF5Glmk3+Iw//18/O2cHkXdYkajr3mg7TJk6lhRFDU0tgJpNiJrQzPbvN/J4v3bPP4uXdgZY8wOf0CmeJpc0FDl4283x4U0Uut+81zUdSuy/0tRFDU0toxEI+I1l2kvhNWNeNs9/i73AhNt3jMd8baLu6RhpY+/3QyX0qlDgqq6sWD/O7KHuFEUpYMamrkWrmk2Pf4XsnxudW3Ka0PzRRvXJoDLgRuwvg/ICi/69LttxHqUZytsQKYOVzlI42lkH1ZSmwJFCY6hsfJAJjzWfFeez1uQGFX/znGNlbNwNgMfevxdrE59tSD7XO7yQMNP8X4tKo6sQbkdqHM5sv5WyLk0byDrPXFtBhQlWIYmn6tuE95vcnsAme7IRIMxMs/lSeNhcoe/aQb+z4cG2EoInpRb9kMeaVhsGtzNHqX/thl5eBWaZx5ytEGjzXuOx98TVBWlw2LXvfl+cu9jeAzZO+I1FyFuqJcAo02D8Qqyc32BxR72Gch+nHMRl+lOyHrF86aX78eGvelGR68sn68zjajX+zqeRnbfDwd6ItEMqpCTLFOvu5p/U68rEe+99NddzOcJY8x/AHzqQzm+hThUPEt+j8RVxsjU6eOvKME0NP8yo4kLs0xjXOm6wplZI7g8aP4KJQH8xfxZ03FYc/bPnypo0/pqTr47ddBYW2OzDPgiT11q3+AdVlB5NOKOV1ixeAn4ChKypluGz2PIZt0LcLauo3jMxRdfHBgt99xzj/4gRTA0ABcjJxpegpx/sgF4CgkmuVGL1CZPXfo/Tr57HHIq6KlAD9Mz/w5PXaqnO9rjSTOy/aqpp57Xz1JpFLXxVkrF0NQg0zhHIsEX+yLOAT2R6Z8DTI/4FdNDbyjSd2qrcwgypQMyXbI8cDqfurStzkmm0fROZ67RWWlTB/za/BWDPZCp3QPwbo9SEzKdei+FxwwsFZ19kaC/JyKH25UhzjG5PEIbzAg2E0l2j0QeQyKuP4Ksm6oXYhEMzTDgWmTBONselt7mb4LpSW5HFu1vw8Jax/xJU934Lp7rdIlS0VlcZswoRdWnIFOxtT7k9SXgKiRW3VPtVOcYxP2+d5v3y8m9FtetAJ0HA2eZTt2ZqKOIq+TyOqtEdkx/iMxrd7KRbidzz4emcfQyVL7qVILAvsiaYa2PedYi3oj7tkOd5WZ00dvn3/EE3NtYrOQxNEORhdNrsRdXLFNlucakNcwD/apTCQo/ACqKkG+Fybu96TzJPDfF4EJkmk7x0NDsjxzhO97FfMYjQS33dzFN1emuTsUZRxUx7yPboc4Di6gzQqG+m0pG2q7RDEM2O/byIK8+Ju1Dcb7OoDrd1ak4p6edi+NlYbb0q6KuTyVNtVGSYQgloKo+Rpd1zXT7tIlIq+UgG7280llR1srofqsZ0WctvWrqiYQTxBNhNjTUsnBdXz78dE92tJZ5odPW1F6nUIgxkQj7lpWxRzhMp1CIeDJJXTLJikSCD1pbmR+P2wlb0kWrtDeGpgp41KNGMb2iPYYsvBUaeVh1uqtT8ZGWqggrxnRl3dBaEpHdz+3bQhWfjuhMOJ6kz9J6Bs7bSnmT/1FyOlc1ccK+7/P5oUuIRjLnf8TwBcTiEV5fOox/fjCObU1VvuvsFApxXHk5R0ajRNt+GArRExgaiXBkNMrmZJJnW1qYFYupW5nPpE+dTQPG+ZDnWJyd/6463dWp+MSGwZ14++T+rBneOaORSScRCbFmeGfePrk/GwZ38lXngYOWc9NJj3PE8IVZjUyKaCTOEcMXctNJj3PgoOW+6hwdiXBjdTXHZjIyGegeCvG1igqmVFXRORTSClkEQzMUmOJjvlMobDFbdbqrU/GJT8Z1Y8HE3sTL7IUXjJeFWTCxN5+M6+aLzi+NncP5E2dSUdZq676KslbOnziTk8bO8ccYlpXxnaoqagswGCMiEa6tqqKbGhvfDc1UsNQpcIuoydMuqtNdnYoPrN6nCyvGdHWUxooxXVm9j7fLBl8YOZ8Tx7xPoc1vCDhhzPt8YeR8N+RkXfjZOxLhm5WVjs446RkOc1lVVS4XUJ1dc9nQ1CKbB/3mLOwt+KlOd3UqPrC9WznL93NnNLJ8v25s71buic7+3TZz6n7uxG49db93GNDNcTDwjPOFFaEQ51VWFhQ7qy17hsOcWpHV03ub1l53Dc3x2Ns86BadTN5WUZ3u6lR8YNkB3UmG3ZmiSYZDLDuguyc6v7z/25SF3TlKqiyc4Iz93/ZE59HRKN1dnPI6IhqldzisFdUHQ3N0EfM/2qNrVadSdBq6l7O1r7ueWFv7VtHQ3d1RzYBumxnZd42raY7su8aNUc1ujdWR0Wjg01Qyl/PYIuY/1qNrVadSdDYMqimJdA8c7I23mNvpDotEPPEW26+sTCurD4ZmaBHzH+rRtapTKTp1fSpLIt29e6/zRKfb6Q6NRDzR2S0Uood6oHluaDoXMf/OHl2rOpWi01xbVhLp9q71Zt3b7XR7e2gMdJ3Ge0OjKIoHxMq96YHHKtxNt1N5iyc6O1U4OtV9t8WtMg8NTYa0m7UGu2toiunGt82ja1WnUnQicW+2YkRa3U23Je6NQWxpdTTy2s3jwctAPK3J3cp0h9Zgdw3N0iLmv9Sja1WnUnQqtreWRLqbt3vjje92uhsTCc9+q01J3Z/ptaGZW8T853p0repUik7N5h0lke6KzT080el2usvj3oxp6pNJNnhoxBQxNC8VMf+XPLpWdSpFp8dKb04D7rHK3XTnrBroic73Vw1wNb2F8TjbPRh5zGlt1XgzPhiaZ5Ez6f2m0eRtFdXprk7Fa0OzqtH1EP/lTXHXDdjcVQPY2lTtappbm6p532UD1grMisVcTTMJvOpymkpmQ1OPnCHuNw+YvC2PcFWnqzoVjwklkgx6f4uraQ56fwuhhLv979ZEmGfmunuixTNzx9GacN+p9d+xGPUujmr+29rKKp0288XQANwK+GnWY8BtBdynOt3VqXhM3yX1dPvUnTPpun3aRN+l3vQlZi0Zzodr+rmS1odr+jFr6d5Ok8kYIHZ7Mslfd+xwZaprUzLJQzuyrnepB6cHhmYJcIeP+d4JLC7gPtXprk7FB0a+tp5OW5ztVem0pYWRr633LHh9Evjda4ezaquzSNOrtnbjd68dTjLpeM9L1uHQ+62tPObQ2NQnk/yqqSnXmo8u23hgaEBOafTDa2kuzk+uVJ3u6VQ8piyWYOwLa+i6rrA9gF3XNTP2hTWUxbyd4mmKlfPzF77IwnV9C7p/4bq+/PyFL9IUK/e8TF+IxfhTczOFmO9PEwlub2riU50yK4qhaQJOBzZ4mN8Gk4eT1UzV6a5OxQ9j05Jg3xfXsNc7mylrSVi+Z693NrPvi2ss3+OU7S0V3PnSsTzyzoE0tlgzGI0t5TzyzoHc+dKxbG+p8K1MZ7e2cmNjI/+z6DXWnEzyj5YWbm5sZL0aGX/rf5v/LwGOQ7yX+ric1zrkvJQlLqSlOt3VqTinGcgZ7TKUhD0/qqPvknrW7VXDpv7V1PesIB7d2d+LxBLUbtxBj1WN9FnWQMTaKKbZTZ2JZIgXF4xi1tK9OXjIUsYPWMGQHhupjO5cdmyORVm+qSdzVg5k9vKhNMeibuu0tEayMZHg983NPB0Os19ZGaMjEXqGQnQxscu2JhKsTCT4MB7n7dZWmqw7EmzXKu2doQF4F5gIPIZ7Yefnmp63m42i6lQjEyTmAAdbuTASS9Bv4Tb6LZS2NFYZIV4WItKaJNocLzRv13U2x6K8umgkry4aCUBtZTMVZTF2tEapb670Wucb2DjIb30iwb9bWvi3O79lE7BQq7R7hHP0xCcAt+PMeypm0pjgUaOoOpWgcG+hN0ab41Q2tBZqZOzmXbDO+uZKNjbUFmpk7OZ9D7C5SL/lfeh0tC+GJjXMvRYYDfzeZsE3AX8w916Lt5FQVWdbrrpKa7b//Am4vwj53m/ybm86NwKnAVt91vkOMFWrs7tYCa+6GLgQmAKcCBwJjAeGAF3NNVuB5WZo/ArwDNDghsBRoWlWL10MXDg/Oc2WzlGhaZZ1znenzItanopnJIFvAP8Fvmt+Ty9ZjrjQ3409V9xg69y1k/QfYIx5Vo5G9tZUA7k8DroChfhWrzYjmVutdAJnzZofmIo3ceKodmFo2lbS9L9ElveLhjEcD1Kc3fl2SNc5wlTwY035zQKuBpZp+11SJIBfmr8eQJe2F8Sj4fDy/bqNbexafmhrNDwyGQ7tmQzJdaEkdaFEcnVZLLGgemvszSHvbX4/EsvoHlUHbPJSZ2U0Fj51/Dtj9+y69dDKaGxkWTixZziU7AKQSIbqWhPh1c2x6II1dV3ffOy9A95vjkW90AmwCsg6RL+npiYMHGgM0ThgEJDaDLQF+AR4H3j5rqam9z6IxzPF2on50JGzrNN0AtqVW5wVQzPMTNecDWSL+93b/E0ALkY8Nh5AdqsXey3hOGTaqRm4FHguYL/B54Dn0yodwKnAJOAY7C2gKsFhU3oj+9rXhnQz9e9CIFcQsPHACXW9K1kzvHYF8Dvg7kl/W77FD533fPXPtnTu3Xsdh+298DOdF9//f1v8KNx7amqs6pwAnAlwWVXVTp0NDVt8qge2dQKf6TRGqOQJ7TPzlmyfVSIbAaeQ4RAii7Qgu9Z/RI51hfmTsk+JjnrtViffr4cZFaSOON5mpgoKWmTMpbPAdZHPAS+wc8qsLRsLNjYzZmhT78cIOn/9DAHfBm7K8TvnYyvwA+DXuXq6OevnzMrA6OSwZifPkX86czxDFqbOfNNZClNn2ZwBhgJvmpGMk22+5cA1Jq1hRfh+J6UZGczrEwM0knkhTyXsaa4Zr016SVIDPAH8ykFjg7n3LuBxk6bqVJ0lRSZDsz/wusuN23hk3WF/H79b1Bi5tlxOYYuFfhsZNTalzWDTwTrZxTRPNmkOVp2qs5QNzTBkDaOPB3n1MWn7NbK5FBiZ4f0DgHNKxMiosSlNepnfa18P0t7XpN1LdarOUjQ0VcCjHn+RXsgO+SqPv1dPZF0oG9PJ7SIZJCOjxqa0iJg67mWHahgynVKmOlVnqRmaaYjbndeMxftowz/O05gPAr5TQkZGjU3pcC3iMeg1E8k8Naw6VWdgDc1QxLvML6Z4aPn3RVwJ83E90L2EjIwam+DT39Qrv7je5Kk6VWdJGJqpyOK5X0TxLszDnRaHlt2AG0rMyKixCTZXIzvX/aLa5Kk6VWfgDU0tshnTb84iy3GtDjgF2XlrlW/jrSeHF0ZGjU0wqQTOLUK+52JvzVN1dkydRTc0x5N9x7+XdMJGGHALVCCRje3ec3MJGhk1NsFjMrvu2fKLziZv1ak6A21oji5i/m7mfRmwd4EjqwNL0MiosQkWXyiR50h1dkydRTc0Y4uYv1t590FCNRRCqICRUC729tHIpBub54G9tL0vGsU09ONUp+oMuqEZWsT83cr7JofD1yNwLzTNz3w2Mil6IRGgleKwdxHzHq46VWfQDU3nIubvRt7jgfNcSOc23NkIVcyh9LHa3pd0XfYjb9XZMXUW3dCUOne69D1GuWSwikkcpSM+S2HVqTqD/nBsK2L+TvP+MnC4i3puxLkH3vNFLM8Xtb0v2brsV96qs2PqLLqhWVrE/J3kXYlMd7lJX5xvhLoa2FCEstxACYamaEcsL2Ley1Sn6gy6oZlbxPyd5H0l3px3frUxOE6M57E4P8LWrpE5EjkOVim9uuxn3qqzY+osuqF5qYj5F5r3HsD3PdJUg0yhOWEO4hTgh7FJGZkPta0vKi8XMe9XVKfqDLqheRbYXoS8G03ehXAL3p44dx6wTwkYGzUyweEfQFMR8m0GnlGdqjPohqYeeLAIeT9g8rbL54BveKytDHf2pHhpbNTIBIttwMNFyPchoE51qs6gGxpMoxrzMd8YhS3kh4Bf4M9RzCfhjkebF8ZGjUwwuQVo9TG/1gI7RKqzY+osuqFZAtzhY753AosLuO8s4FAfdf7UJaPmprFRIxNcFgJ3+ZjfXcAC1ak6S8XQgJx66YcXw1wKP2Fzms/lcyBwpktpuWFs1MgEnxuA+T7kMx9n5ympzo6ps+iGpgk4HW/3gGwweTQWcO9eFCe2z624F6zSibFRI1MaNAIn+/AcnVzgc6Q6O7bOohsakCm044B1HuS1zqS9pMD77y1SGQ0G7nMxvUKMzXo1MiXFEuSsEC8anQ0m7SWqU3WWqqEBeBeYiLvTaHNNmu86SGNCEcvpEJfTs2Ns1gNHqZEpOd4BPg984GKaH5g031GdqrPUDU3KMk9Azmlx4o0WM2lMcMES/7eI5TTbgzStGBs1MqXNYlP3Z+DMK6kV+LlJa7HqVJ2lRq6w+M3AtcDvkRha5wDVFtNtAv6OuDC7VUAXAn82lj3kU/kkgdfx7kzwlLF5EejR5rN1yAl6rhqZiy++ODCV75577ukIxqYRCWt0DzAVOBvrZ703IfvNbvWhoVGdHVNn0Q1NunW+EJiCHA52JHIGzBB2HvC1FQkuNwcJi/AM0OCy1mXApHbYEM0BDjIjv6ONcXsOuA74WAcF7Wp0cz7wXeAEM1Idl+U5eh8JbfIs/kfoVZ0dU2fRDU3bHn76XyLL+0Vj/pMbaswPmm4Qu5iP69oYxH+OOqVXQzF0zjr1/Ew6Uz2eo5FoDZ/pnPjEHxqKVKS2ytODDkZ7IxWJ40HVqTo7CqF9Zt6S75phyBTa2Vg/q2W7GfrdhoW1mfmTpmb/8KqrrH4Xz3UyY4ZjnbNOPd+RzolP/MHaWlcWrTamzjwvzw4ydaYoHZ5cI5pKZIPkFKDcZrqdgAuQmGR3Aj9C1ny8IBA6Z516vi86Z516fl6dEyeOKvnyVBSl/ZDN62wo8Kbp0ZY7SL8ccSR40/SQ3UZ1dkydiqKUuKHZH/G0Gu9iPuOBWSZtt1CdHVOnoiglbmiGIR5PfTzIq49J240erursmDoVRSlxQ1MFPAr08jC/XsBjWPcnz4Tq7Jg6FUVpB4ZmGuLf7TVjcRaFWXV2TJ2KopS4oRmKeBn5xRQKm0pRnR1Tp6Io7cDQTAWiPuYbNXnaRXV2TJ2KopS4oalFNuX5zVkmb6uozo6pU1GUdmBojsf6zm836WTytorq7Jg6FUVpB4bm6CLmf7RH16rO9qNTUZR2YGjGFjH/sR5dqzrbj05FUdqBoRlaxPyHenSt6mw/OhVFaQeGpnMR8+/s0bWqs/3oVBSlHRgaRVEURfHU0BTzJLdtHl2rOtuPTkVR2oGhWVrE/Jd6dK3qbD86FUVpB4ZmbhHzn+vRtaqz/ehUFKUdGJqXipj/Sx5dqzrbj05FUdqBoXkWOevdbxpN3lZRnR1Tp6Io7cDQ1AMPFiHvB0zeVlGdHVOnoijtwNAA3ArEfMw3BtxWwH2qs2PqVBSlHRiaJcAdPuZ7J7C4gPtUZ8fUqShKOzA0IKcf+uENNBfnJ0Kqzo6nU1GUdmBomoDTgQ0e5rfB5NHoIA3V2TF1KorSDgwNyFTKccA6D/JaZ9Je4kJaqrNj6lQUpR0YGoB3gYm4O50y16T5rotpqs6OqVNRlHZgaFI93AnA7TjzSoqZNCZ41KNVnR1Tp6IoJURon5m35Ltmb+Aa4Byg2mK6TcDfEVdWS15G8ydNzfzBzEprOT51qTOdJ99tzRvqsObM7191laXbZ516viOdE5/4gzWdM2ZkfPviiy+2Wjc8/93vuecefQKVgp4j38jyHCn2KLNwzWLgQmAKcCJwJDAeGAJ0NddsBZYDc4BXgGeABl+/iRiKC3nqUns6T77bV53GUFw469Tzbemc+MQfGnyuG6XxuyveYLWDZ7UjpqihaVecfHdJyJz4xB9KpUQbkAgCD+rj0mEZCnwPmAz0BdYD/7YzY1EghwJTgdHARuBfyF6srS6lvwdwHXAS0AP4ELgBeEF/cv8NzTDgWnJPofQyfwcBFyFTKPcj8/R+bdBTnRbQ6SrFJieYTkZN2nv9gfNNHf4G8KgH+U5Cgq9Gzf/3Ms/DhcBpwFsO0z8GeDhtdI5J/1/A4cDr+tP7Y2gqgRuB7wLl5r1VSEDE2cBCYLN5vzswAjgYON5UxAtMJbwT+BHg1Zi6ves8AdjTR52KDUa9dmug9GRd6yyM4aYxztYhqjIdoI/MaMBNbkwzMun0A140z+9rBaZ9LPCk0d+WiOkInqS123tDMwx4DBhr/j8LuNkMlxNZ7nkD+CPiyfZFMySdiCwoH4ds2HPbAymfzu7AZaaHAvAf4K4A6gxKeSpKOt8nvyNIOXC9Gd24ybgcn9WYkcfxwEyb6X4BeCKLkUmxj/707pLJvXl/0xCOReZCv2aGsf/K0SimkzDXHmbu3WrSmmXSdot8Oochi9TTkIXsI83rOeazoOgMSnkqweeL5ndvMqPfv5hRuVcca6Pxdpu6PJ93Ms/FUTbSPBJ4yoLx3KRVzVtDMwx4DugDLAIOMEPjQkiaew8w00J9TNrDXBoh5NP5B2BAhnsHmM+CorOQ8lzksk4l+HwbmWb9PDIN2w34OvBfZGrVC/aweF0vD/J+0cI11cA/LBq6wxGvSCuu+s9rdfPO0FQhi3q9zJTMJGCZC3ksM73xJSbtx/IMW/NhRedgk2c2DkPcdIuhM4TsUdnHvM5HCBiFeN6ETRqTXNSpBJ9LgV9lmYHYA++OXggV8Tv/FGixaGyeMqO9XM/7sxaNzFZkel3xyNBMQ+ZF65A1gPUu5rPeVIStyLTPNAdpWdFppZc/tAg6RyELp4uA+UholiE50hgCvI0stH5g/kaZtCabtJ3qVILNd0zDl6vRP6Edfu/FwHlmJG/F2DxpnrO2TLJhZFqBr+JtgNkObWiGIhvzUhV7qYt5VCOLd8uQhXlMXoVM+VjVWWEhrYocIzAvdIaQRcgRadeNRxYzh2ZJYya7rsPsY0ZJITOi+Y5DnUqwuRz4pYWRRXU7/f73I1OGVoxNpTE2x6e9N9EYmU4W7o8jDg16zLiHhmYq4ko4i8LXENrSHXgE2Gb+/o3sHp9l8irED/P7HujMVsHd1jkMcRdtS39TLkPbGJlXybzQu0+aUXGqUwkuVyCu7Famr95qx+XwW+Bii8amwnTmvoSsZT3Lrvt/8hmZR7TaeWdoaoGzzf9vtviDWjEyLwBnIH7pIcSD5QkgFVztbJO3VbzQmY2kyQPgLJd0xnPcMyDN2Aw1r/vneTDa6rRbnkpw+S5y8qkVIxNH9py0Z36H7COz4qVZbkb9z1p8HuKIN+fDWu28NTTHm6HlajPqcMvIZHK9PRBYaf6qkRhaVjnB3OOWznz82+js1GY4XqjOZYhrdT5j8wqZveVSvMeuzg//LrA8Fe/oCQwke3T0XEyxYWSSprf/Ugco0/uQNZu4RWPT2aKR+QYaXskXQ3O0ef2MxR5DoUYmvRKk5kGPtJH2US7qtEIiTefRLuk8A4kGkMvY5DIyq4Azc+g8Uqt0UdkfeBNZTP4EWMPOdTQrXAn83Eb9vIBdXfXbO38GzrVobKwYmW8i0cYVHwxNarf6bB+MzErkMKw3zf/H2UjfLZ12eLNN3k51LgWOyGNschmZI8gcDaCQ8lTcZTQSEuXgtPd6Ix5j+bzGAK4GrMakTxmZ+zpgOf/VjEKcGJu4GR39Tautf4YmtQi9oM1nZWSONVSokakHvowcirXIvLeXDa3ZdBaKlTWeRW3ydkNnIcYmZWSW5tG5l1bponET2b2/voPsg8lmbL6H7Bux2khegIQn8ppkQMv674gbciHGJlV+f9Eq66+hSc1lpkI+9EHcBOuQEPF/IfeimhUjsw3Z95Hyjtli/u1sQ2tbnblYa+EaK/uEvNJpx9iszGNkCtWpuEu+UCjfBu7OYGyuQaJyW20kz/fJyIBM/VmhGPtOHkIcYOycBJtAoj//Saur/4amLY8CJ5veWTkS5uJ5oIsDI3M8/obdnpun8m8E3g9A+Sddvk4JNpcAv04zNlOxvqs/Nd3zZx/1Wg3F8mKRynMJsN3m85bQalgcQ7PNvO6C7DqfmOG6g5G4Wl1cMjLd0j63SrrOfMTIva/kWos9Ia90plyYB1hIbwCyp2Yvl3Uq7vKyxeu+hewNuY6drv5WjMy5+D/dcyv5j6NoYaeLvZ+MN+1PVxv3RBDniXO1uvpvaFJTMiPIvYM23dg4Hcnsbf61E0stXacV7jOjsfTpqVXmPauLqHu3ydsNnanNmANspJkyNkPz6FymVbpoXA80Wrz2ImC6DSPzf8giuN8sRDYyZhs1NCFrJR/4rGucaX96FHBvythcoFXWX0Mz17w+BJlOWm3B2DidLjvU/DvXhtZ0nVb5GzDINPojzGs7niZu6xxG9h3/VozNK1mMTSE6FXeZj+yhanQxzdQ+j/uL+L2eMKOHe5H1wphpI+4z7z/qs56xpv3p6SCNkPk+F2m19c/QpDZ7ncjOoHKNeYyNEyOT2iRqZ7oB08imdFrdCNcJ8fi5xfx9B2txj9rqfMklnY/kMTIryb/P5mGXylNxn1fNb+GGsYmb0XcQ9nksQTaGDkTWbVNHOS/yWce+yHqQG8cShJApzG9rtfXH0DxrhsZ7IpGL/2MayUIeFisL/8eaBrMR2dRolWfMPSmd+egPvAP8Ajlj/DTz+h2LI4p0nc+6oHMv0wPMZWRSB7TlMjb7s+t6TaHlqXjDfxAPy+0O0oibDt8DAflOIeTMl5+ZGYGfI5GS/TxGYLTpSFkxMklgh8Xv9SvsbapVCjQ09ewMwXBdWq/c7jSAVe+y682/D5i8rVKf9uBdZ+H635N5nWSE+QyfdUZy3LPKGJilpveYz9hEXNCpeMdMY2waCjQyZyPuu0FgD2M8XwCuMgZwCnK65evYW2sslFE2jcwUJLCmlfYrhETIvkKrrbeGBsS7JIZ4nH0tbRrAqrGxamS+avKIUdhhTZl0ZhvN5Br1fDHPA+KFziXI4momI3MEuzocLCH7PpuF7IwO4FSn4h2vmWfCjrFpNUYmKFGEOyGx9CZl+fwQYwC83L+1j8mjt8XrrzQzFy/YNDZ3mnsVDw3NEiSQH0i4jCE2jI1VIzPEDFMxP+riAvRm05kpr3wM8llnEpm++yjtuneR0/8yebUtRY6fndPGyJxm0trLBZ2K98ZmssWRZixgRgYkivSYPNcMQyIbeMEAY2T62DAyd6b9/2XTflmdxpyB7HVSPDI0IKc0zkX80p9P60HkMjapHf/5jExv0zPqavKY5kBzNp3prLSQzuoi6JyPzDUPN9MBnwOW50hjGbImsy8y5TfKpOGmTsVbZplnZJsFI/NowLSfbfG6r3iQdwiZ0u9r8fqr0zp36byKvWnMu9CYgZ4amibgdGRH/TAkKOS+aT/W8ey62z517PEbefLYFwn6uLe5/3SceeXk0pniY9ObzPXwLy+SzqQZfXyEtR3/SeQo50XIruYxJq1hLulUvOd18/xkCku0wzTojwVQt9VTW4d4kPcX2Om2n49ryB2Q1M7IMoIcXKh4ZGhSUz7HAetM5XkDWQcAWRAchoSnOdZ8ni+S8tdMGnuZNI8jc/Rhu+TSmeK8LCObley+M7iYOu3wNdNoDXFZp+KPsZmA7EupM9M5LyDrH48FVPMmi9dt8SDvYy1eNxVrAUlnmefFSqzEL2h19dbQgKwbTDRTMrWIO2O6F83T5gFpzJHmZHPPX00ac02a77qoPZfOsGmA90OmlV41f9PMe0sCpNPKb+SHTsV7UmtsXZEjho8F/hdgvcWMdWZlQ+Z12HOCecOisemiVdVdynL0xCcgR8ROMb2uScAKJDLAG2b6J9Xj6Y6sOxxiGsWB5v0YMm/6I/LHTCp0xJBP5wvsdN/ujuwRCqLOTOV5qNE5wCedipLOrchR5pU5rvEq1tlHeT6/Aeux4tKZDRxjjGjXLNdohA2XCe0zM+9vtTcyB3oO2c/baEsTsqP5Nix6Q82flCUG5sxKq9/FF50clqV9v+qqYOmcMUNrt1I4O5+7U81IulOWevkN0p0YDnPY/9n5HPVAYqi1dQZIkH9NxgrjgKfY3fs0DpxEapO2PkeejmjSWYyc4TDFjAaORHa4D0nrEWxFFtfnIJs9n6GwzWpOUJ2K4j6pWGffQ6ad+iKOQM+bjo9XYWg2Ia7/M8wz0oJMH9+GO6fsvo8451yBeNX2Mc/mT7EXckqxYWgms/Ps8fORXb9nmh+5GtkA9QQyBfVgEfWqTkXxn1SsM79ZbEYXXtGARNGerj+xt6Smzj5FQk2AnKrXD9jMznNOUryKrDO86rYQi1NnRddpceqs+Dp1yK+UItanoP1BnyNXDU3b/Rwhcu/xmGkaSMfRgrMamMzGpmg6Lc0973xIiqdTHwxFUQJGuMD7DkPmMV9DPDiCiupUFEUpUUOTYiKyKPg6slAYVFSnoihKiRqaFIciC96z2XkIVxBRnYqiKCVqaFJMAP4J/Bdx3Q0F9HurTkVRlBI1NCkOBP6BhNc4KcANpOpUFEUpUUOT4gBk9+07wCkBbiBVp6IoSokamhT7IRsU30PC2tcEtDxUp6IoSokamhTjkLhI64BLA1wuqlNRFMUHQxP3MN9qJAKxG6hOd3UqiqL4Zmi8DOIYY9ezvZ2gOt3VqSiK4iplPuc3F7gdOSNmfYDLRXUqiqKUmKF5Azmk6J/kjvlVbFSnoihKiRma55BT+v4T8HJQnYqiKCVkaBLA48jxru8F+LurTkVRlBIzNC3A3/D21D3VqSiK0gENzXbg98jpkSsD/F1Vp6IoSokZmi3A3cixxBsD/B1Vp6IoSokZmrXAz4HfAvUB/m6qU1EUJeCGZivQJe3/y4CfAn8CmgP0HVSnoihKgMkVGeAyZI2gHnGpHWF63UFrFFWnoihKiY5o/mH+go7qVBRFKdERjaIoiqKooVEURVHU0CiKoihqaBRFURRFDY2iKIqihkZRFEVRdiWU/E8Fo0LTPgX2MO+tnZ+ctofvSg7Lsp1kZmX6/3bRmfY6WDqfunRXnSffHRydiqIoRRrRXGAa7tXA+QHWqzoVRVFKcUTjwEg9D4SAY5BzU7we0ahOHdEEkilXrPUzu0OQI7yHAzOBKXf8ou+qYuls2B5mwIAYx03eSjwO8Xgo9VE34FFgLHLc+LkTJ47a4YXObdsijB7dxJFHb6OxMUzS3rmzruls2RGiulOCE760lepOCVp2hNws6oJ1Fhsn0ZvPAI42r78MPBTQ76g6lfZEGXAHMMH8/xRgA/DtYgmKhGFHc4jWVohEIB7/7KOngEnm9dmmE3V2AMtUdXqME2eAi7O8DhqqU2lP7JVmZFKGp6iNTUV5gk2byti4sYyqqs8G4kPTGsUUpwWwPFVngA1NH+DwtP8fZt4LGqpTaW/0zvBe16I2ImXQ3BxmyeJKQjtblJ4ZLo0HsDxVZ4ANzalABJgPLDCvTw3g91OdSqnRBTgPuBQYk+HzUIC0HgGcQhKqq+OsXFHBpo0RKisTIEeRt6XVSzGhUB6dmfFdZ97yDL5O3wzNmebfR4CHzesvB/D7qU6llKgBbgamAz8BbkMW/NNJBkTrr4FXgCeAuRUVyZ5btkRYtqySikr/JaYW/8Ph3DqzjAwCV54B1umboRmITO2AeEA8Yl4fDgwI0HdTnUqpMQlZ1O+LeBhNBs4NoM7jgEvS/j8GmBEOw7o1UVpjoVyjC08oiyTZVh8mFttlZJNRZ6mUZ0c3NNciUztzgA/N33vmvakB+m5tdX5QAjo/CLBOxXsOyfDeoQHUeUSG9yaEw5BIiNeZ34amsirBmk/LWbMmSk1NPDXCyaizVMqzIxuak4Bvmdc/Ar5o/m40733LXFNsMumkBHQSUJ2Ku0SyvF9u49piEsvw3g6QqatQEVaRysqguSnM4oVVhMPJlIasOkulPDuiobkQmdYJA38GnjY97qmIf/efzGePmGuLRTadlIBOAqhTcdfA7Ad8BTgggxHJtLhRrDWZPoj77OAMn8UtvuebzmSSwTU1cZYvq2Dt2ijV1Ymi6QyF5C9ZmuVZFENTARwPvAzca3pczyD7PA5B1hEON68vNp+Vm2tfNvdW+PA9rOhMEVSdbSmmTsUbJpvf9PfIsd4nBlTnocBi4DHz7wmloLO8InnCtvoIixdWEo0W32ciVHrl6d2I01T+84D+QNS838181jdtOB8DbjXTOnF2XT+4FnHLO8VMAU0FjjR/LUjcr1ZgS1paq4A/As/aeEid6sToCaJOfNapeDNiCZtRSCbX0+lAP/O6CvEqeyZgvdcw8CBQm9ZGPAp0B5qCrDOZ5NFoWbL7+g3RpuYdIVJrRr5WgDLYvj3M9u0hunZN0LIjUirl6bmheRhxq8zGZuBxxAtigXlvFPCltGtOMu/NB34I/B24ygwVuyOeVZk4Lu0HyEchOke30Zk+LA2Szmx4qVNxl1rgeuBgYDnwY/Nvih5IjKp0RiBurOt81noVEu5oBXA5u+7R6Mfu3o6VwEjESSXQOiPh5MhkkvcS8RChUBKfth19pjMSSV5eXx9p+eTjCgYMaAlaeRbV0PwWuNr8f7lp2NaZXtla4CPT4NUi88rDgYva/IIh4G4zxbPI/F2ILGbvY3ryIWSe8sfAEHPfvTa02tH5OaPzwjw1bUERddrBC52Ku0xBNlnWABOR3fqnszM4aqcs91X6rPNaM5JOsTc7Y+xBZoeE1Ggt8DqTEPHZIWE3nRXlyaM/Xl7JmLFNRKPJ8lgsFITyLLqhuQbxcLjONFiXmQdklRkRPG96XnvmSesIdnXTWw0sND2RF41Vv8nkkUQ2pv3AhlYrOkemTU3YIc5O12IvdTrFTZ2Ku1ycNpKNINOeg9JGNdmaPr8XE65r8/+jzEhrblody1b3VKcFndHy5NimpvDchoYwvXu3xrMYmnhHejhS88k3INGD64GDgHeRRfQPjZHYs4C09wReMmkcArxj0q43ed1g8yGzorOfw/LwWqdbuKFTcZd+ed4Lym9TleG9/gEsz5LVmUzSPxIRF+ukPpGfGZoUjyObhBYAvUzDvR9wCzCtgLSnmV7255CzE3qZEc4Ek1ehuK0zhV86neK2TsWf5ysoZNqf0aI63dcZCukDkO1B+Mj0lucA1ciZKFWIZ9R0G+nebO6pBh5A5qffRxZKP3JBdyad1QXoTO+V/N3onOODTie9Jy90Kt6QLBFNqrP96wxcj2srspN+PbIAd5l5/wbgLgtp/grxvsHcO8ykdaxJ2y3a6vyOTZ3pXG7SWG/S9ENnIXipU1EUxdeh/Xp2hkH5Ttp1cyyk+V5a2pea1zeaNN3GiU4CoJOA6VQURfHN0AD8BdlQNAA40Ly3j4U0U9ccaO5tMml5RaE6CYBOAqhTURTFN0PTAMw2rw8y/46ykOaoNvfMNml5RaE6CYBOAqhTURTFN0MD8LH5d2CGBnwJslP9NPO6raEZ2CYNL7GiMxupe5YXQacd/NSpKIrim6HZbv6NIJ5Og4CNyCL/aOQ0uCfM68vMZ4PMtZG0nrzXWNGZjUibNPzSaRc/dSqKovhmaIaaf9eYxvs2xOvpV+zq095i3tsbuN30vteYz/by4XtY1ZmJlM5hPuu0i586FUVRXKMsx2flyNGyAP9FAmZ+HwmzcQayZtDHfL7OXPMcO6Ml9zb/TkSiGMc8+g6F6mxIuweThp86U9QgwTCDolNRFMU3Q/N50wjWAW8gmwW/j+zl6JLlnjrgl8gu/TfM/7sYY/OKR99BdSqKopSooUkdzvM8srj+ADvdhj9FwqCkFqaHAMcgsZ1+YEYSZ5l7v2zS8qphVJ1KUAlleY2F93HpekUpCUPTF3GprUQW2K8G/sbu0UcjwNeAn5kG9C12TvecwM7Q+V414KpTCRrpoUiyRetNtPnN8z2jTsObRPO8V2bhvvJsn6fF94rabG981Zknn/aos6hkcwYYhITcB1kTqDQ96PHI+fbZzrj+s7nmFXPPYeazkSZNt1GdSlCoy/DehrTX29oYlZTRSPfKzHQA2uY2/88UEWKrDZ2ZjFlDG52ZSH8/li3dROKziMV1DhtGT3Xm+d3ao87ijmhmhd/d7c2Jif3T96G0IscJ3zor/K6Vg1FXT0zs/wVk/WFaWmGMmhV+95MMeTnRn1Fnhgc6o04go07gE5fLuVR0lhyzZs13dP/EiaPckvIAcEHa7/MWsLRNw/I0cDI7p7+eZedx3CDHaqxjp1PIduDJNvksM2lPSKtPD9jQ+ZAZKadYC/yvjXF8AZm6TfEBu54G+whyoF86fw2FksQTIRKJEKFQciGE5rLrqaIvBkFnm/8vRM64ae86AzmiWWJ6Uq8Ch84Kv3uzRSMjD3/43cSs8LvTgUNNGpvZdVOnW+yiE4kabeeU8AQS7Vl1Kk6ZbozCemAWcKUxAulch6yzrTdG5Zo2n8811yw0HYzfAfe3uaYVOc1zlknnSVOfrHIBsq9ss8nvKHYPdf8Vo3OzyWdym88/AM5BNiBvRE7XvSUUgkQilH4Gy5dMo7sZ+HebBrloOjPk1RF0FndEk8VQLEbOOP+MjRsX1SBrA0ea6Zwh7PSWqkMWsueYaZ5/9uw5vGFW+N3/mesd8+TmBzO9vYvOUChEMpm0pdMMc/PqPKX7Wa7pNNjSGQ6HGxKJhHs6n3wy62emHAmHwyQSiULKMy+nnHKKqxW5kPrp8rO0CnHUyMVHiCt7rg7FfebPK3aQO1IGZpT1RQsjuAcAGraHGTAgxtlf3UQ8DmknStabv4RpHLd7pXPbtgijRzdx5NHbaGwM09IS2k1nDlzT2bIjRHWnBCd8aSvVnRI0NYVtl6cXOp2O/G1yCLKfcjgwE5hSZuEBHgZcC6Gzy8urO0WjnYhGKwmHo4RCMiBKJhO9E4lY71iseUIstv3ilpbG7Rs3LnoAuK1nz+F+9byHAddWVFSe06NH7+q+ffegS5daKisriETCvPnmgow6IfkAssHTV53ZyvOQQ0YSjyd6Nzfv6F1XVz9h/fp1F69fv6axtTX2oOnl+Knz+2Vl0bN69uxd3bt3b7p160KnTtU0NcVYtmwd9fXbfSnPjz7aeeROeXk54XCY1tZWamtr2bhx0bBIJPL9aLT8rJ49U797Z6qrqygrk/rZ2pro3djY1LuubtuEtWvXXLxx4/rGLVuWPhiPx29Zu7b7kvr6esrKykgkErS07Nzfu88++xBAyoA70qbOTjHTM98ulqBIGHY0h2hthUgE4jtXHJ9i596xs82U4dkBLFPV6XH9LMthYCqBaaFQeEpVVbfyysquhMORLD3gCOFwhLKySqqqupJIxDs1N2+9oKlpyzc2blx0J/Cjnj2HN2e8+bDm3LJTn2fvgVcC02pqaq8cOHCv6MCB/ams3NVBI5lMEgqFcupMJhN3ImsnnurMV56RSJiysggVFVG6dKlh4MA9iMX2rV6x4tPzPv54ydfr67fd4UhnfiqBH1dVVX934MDB0UGD+lNdvetZbS0tccLhEOGwg/J0yIcfflgJTKuu7nTlgAGDo4MGDaCyspxQKLzbyYbl5WHKy2vp0qWWAQP2oLm5pfqTT1aet3Llx1+fPXv2HcCPxo0b10xpsFfaQ5x6sM8upqGpKE+waVMZGzeWMXhwC7FYBCQKxqQ2l54WwPJUnT7Uz7IsRmYo8GhFRe34Tp16EQ7bc24IhyNUV/egsrJL+fbtG67ZsaP+2I0bF33Zg9HN0HA4/NigQUPHDR8+jKqqCsc6zfTHEg8qScHlGY2WMXToQAYO7BddtGjpNR9/vGRyLBY7zQud4XD48X79BowdOXI4NTWdAlme77///tBQKPTYnnsOHDdy5AiqqysJh/Mf8RMKQSgUprq6khEjhjJgwJ7RBQsWXrN69Yovvv/++2eMGTOmFNa9emd4r2sxBYXLoHlbmCWLKxmy12cjwp4ZLo0HsDxVpw/1M5zByOwPvF5T03t8be0ethvFXRueMmpr96Cmpvd4YJZJ2y32j0ajb4wf/7lx48aNtm1kcukEXNXpVnlGo2WMHj2C/fc/aExlZeUbbuuMRqNvjho1Zuz48WNsGxm/ynPevHn7R6PRN0ePHjduzJjR1NRUWzIyu2sMU1NTzZgxoxk9ety4aDT6xrx58/YPwIPaBTgPOeRuTCZ7GaBG5QjgFJJQXR1n5YoKNm2MUFmZgMwxBlu9FBMK5dGZGd915i3PYOssqH6G2xiZYcBztbV79KmsdK+TVFnZldraPfoAz5k8nDIsGo3+e7/9Duo9cGA/T3TiTvBKT8pzjz16cdBBh/SqrKx83i2d0Wj0hX33HddryJBBlJWVBbI8Fy5cOCwajT6/777jew0e3J+KinLn0z4V5Qwe3J999x3fKxqNPr9w4cJiBi2tQTzIpgM/Qda6hre5Jijn0f8acax4AphbUZHsuWVLhGXLKqmo9F9iytMtQ59jF51ZRgaBK8+A6iy4fobTjEwV8GhNTe9eFRW1riusqKilpqZ3L+Axk1ehVIXD4cf23Xe/nv369fJUJxKPrGCdXpZn9+5dOOCAg3qUlZU94VRnOBx+bMSIUd3799+DSCQcyPJcuHBhFfDoyJH79thzzz6uGUOAsrIy9tyzLyNH7tsDeMzkVQwmIWstfYFuiBvsuQFscI4DLkn7/xhgRjgM69ZEaY2Fco0uPKEskmRbfZhYbJeRTUadpVKeAdRZcP1Mb1WmVVTUjnOz552ph1tRUTsW2XhYKNMGDRo6duDAPQKv0+vy7NWrO3vvPXLfcDj848KnG0I37rnnwLEDB/YnEokEsjzLy8sBpvXvP2jcgAH9XDUyO41NhAED+tG//6CxwDSTp98ckuG9QwPY4ByR4b0J4bBEBojH8d3QVFYlWPNpOWvWRKmpiadGOBl1lkp5BlBnwfUzbEYzQ0Oh8JROnXp5rrRTp96EQuEpBU6hDa2pqb1y+PBhhDyuySmdBU75+Faew4btRW1t5+8WqrOysmrKiBF7U14eDWx5zps3b2hVVdWVw4cP91RneXmU4cOHU1VVfeW8efO8nELLZtHLbVxbTDKFTNkBMnUVKsIqUlkZNDeFWbywinA4mdKQVWeplGeRcL1+pkY0U6uqukWdLFRbJRyOUFXVLcrOc2vs9L6nDhy4V5mThX8/dPpZnpFImOHD9ymLRCLX2f+O4esHDBhUVlVVGfTf/bqBA/cqq6mp9lxnTU01AwcOKQuFQtd59ADvh+wUPyDDQ5ppfrtYazJ9EPfZwRk+i1t8zzedySSDa2riLF9Wwdq1UaqrE0XTKd6Nu/1wpVCentXP8MaNi2ohdLaXUzyZplIgdJbkbZna8vKKcwYO3NN3nYAtnX6X5x579Ka8vOIrdnVGImVfGTx4oGdTZm6U55NPPlkbiZSdNXjwQMJh77vK4XAIKZOyrzz55JNuL65NBp4Bfg/8AziRYHIoEs3iMfPvCaWgs7wiecK2+giLF1YSjRbfZyJUeuXpWf0MA8eXl1d3yrYZ06vebXl5dSfgeBu3Hd+zZ+/qysrywOv0vzxD9OvXv9quzl69eldXVlYEvjx79epT7ccodqdBrKBXrz52yzPVI4ySParudOSMoSpgD8RrJ2hTY2HgwbTOQBnwKM4cTnzRmUzyaLQsWbV+Q5TmHSHCYf9FRcpg+/Yw27eHqChPBK08i1Y/w8DR0Wgn37+xyfNoG7cc3afPHiWhsxjl2atXb9s6e/fu7flalxvl2bdvX397oiEwedrRWWse1BeQYJhD2nzeg10j7wKMoDhurFchkaN/y+7z7v2AAW1tLzuPuQi0zkg4OTKZhEQ8RCiU9F1nJJIsb2wM88nHFYTDySCVZ1HrZxkwtqyswvcaZPIca+OWsZ0715aEzmKUZ21tp3Zbnl27dvFdp8nTjs4pyCa2GuSo7a7A6eyM0p2t91Hp81e7FjmiIsXebQxqeY7ecOB1JiHis0PCbjorypNHf7y8kjFjm4hGk+VpQUaLWZ5FrZ9hYGgk4r8rp8lzqI1bhlZXV5SEzmKUp9m8aLM8q30f0RRSnlVV/s8ymDzt6LzYPMSpRuQUdj2cLltB+72Y0NbJ4ag2BjXbInRcdVrTGS1Pjm1qCtPQECYaTQZFZ1HrZxjoHC7CZKbJs7ONWzqHw2GSyaTtv0Qi6bvOUijPaLRwr7iUgZJgpdb/jOOBLZ2pKMz+jrxsl2e/PO8FZUd/Jqvdn+BRsjqTSfpHIuJinUwGRmdR62fJHAUKMHv2AoIV6ik4JBIJ3/KqqalizJjCTpKOx+M888yijvKzhAOoaQe7nz/fojrd1xkKaf1Mz2ibn41Um4Zxm41bVGcOWlpitnXGYoXH5LM7kkn9tbbGbetsbfW/PE2e2xwmkwxg45JUnR1SZ1HrZxhYGo/731EweS61cYvqzEF9faNtnY2NjSR9HNsnk0kaG+3rbGpq8r08TZ5LURTFFUMzt7XV/2gH8fgOkCilVlGdOdi8eYttndu21fuu0+RpS+fWrXW+6zR5ztUmQlHcMTQvxWLbfc+4pWU7wEs2blGdWUgkkqxZ86ltnevXr/d9RLN+/XrbOteuXevromoyCWvXrrWrU1GUHIbm2ZaWxu2JhH/edolEnJaWxkZkk5NVVGcW1q/fSkPDVts6N2xY39jc7N/oq7l5Bxs2rG+yr3NdEXSus6tTUZRshqZnz+H1kHywuXmrjw/yViD5gORtmaLplLyDqTMeT7Bs2XISibhtnfF468OffLKSeDzug844klfrQ3Z0nnLKKfXxeOtDH3+8wpGbup3R4ccfryAeb33wlFNOqdcmQlHcGdEA3NrUtCXmRy88kYjT1LQlhsTRsYvqbMOKFevZuHF1QToTicT0FSs+bm1qavZcZ1NTMytXftyaSCRutntvMpm8ecWK5a0NDY2e69y+vZEVK5a3JpPJW7R5UBQXDU3PnsOXJJOJO7ZvX+/Dg7yeZDJxZ8+ewxcXcLvvOpFoq4HUuWlTPYsXLyCRiBess7m56Y6FCxen3KM9oaUlxsKFi2lsbLyjEJ1jxoxZ0tTU+PNFixb5orOpqfGOMWPGLNbmQVHcHdEATNuxo36ul1M+zc1b2bGjfi4OT65UnbB163bmz19IY+NWRzqTyeSPVq9eMW/FilWeTKHF43FWrFjF6tUr5hWqs6WlBWDaqlWfzF258tPUXhxXaW1tZeXKT1m9+pN5wDSTp6Iobhqanj2HNwGnNzSs37Bjh/tT0zt21NPQsH4DcHrPnsOdzIH4phMIpM716+v44IOFbNq0yhWdiUTitIUL529etWoN8bh7myPj8QSrVq1h4cL5mxOJxGlOdI4YMaIJOH3Bgg82rV691lVj09oaZ/XqdSxY8MGmZDJ52ogRIxq1aVAUb0Y09Ow5fAlwXH39mnVu9sSbm7dSX79mHXCcycMpnus0eQRKZyzWytKla5g/fwEbN65wVWcsFjvmgw/e37h8+Se0trY6TrC1tZXlyz/hgw/e3xiLxY5xQ+eIESOWxGKxYz/4YM6Gjz9eyY4dzkcdO3a08PHHK/nggzkbYrHYsSNGjFji4vMVyvIaC+/j0vWKUvT6uVusm549h78LTGxoWD+3vn4NiUThjU4iEae+fg0NDevnAhNN2m7hmU6TdmB0xmJxVqzYwJw5y1i0aD5bt67xRGcsFjtk/vx5H8yZM4+GhsL3AjU0bGfOnHnMnz/vg1gsdoibOseMGfNuLBY7dP78ufPmzfuQhobGguK8JRIJGhoamTfvQ+bPnzsvFosdOmbMmHddfpDT3eSyDcHSxWcKHV+WI81CiOZ5r8zCfeXZPk+L7xW18F2KpjNPPu1RZ1HrZ8agambUMWHHjvrbt2z5ONbYuAk7HlSJRJzGxk1s2bI8tmNH/e3ABJdGMplGDK7qdGmEULDOeDxJS0sr27Y18umnm5k/fyVvv72QhQsX8umnCzzXmUgkDly9esXPXn/99daPPlqUChljicbGRj76aBGvv/566+rVK36WSCQO9ELnuHHjliQSiYNWrfrk9jfeeL114cKlNDY2k0gkcm7sTCbFwDQ2NrNw4VLeeOP11lWrPrk9kUgcNG7cOKc6M4Uv2JD2elubhzb1UDak/X9dhjQ2t/l/Jg8TO8PlTI1FQxudmUh/P5Yt3UTis4jFdQ4bRk915vnd2qPOotbPrEJ79hzeDFy7ceOi3zc2brqmsXHzOeXl1dXRaCei0UrC4WgqND2JRIJEIkYs1kwstp2WlsYmSP4duK1A7zJbM17AtclkwpFOCvPacl3n7NkfBUHn95qaGu9dvHjB1KVLF5/ds2fvqt69e9OtWxeqq6soKyv7bHqssbGJLVvqWL9+PRs3rm9OJOIPJBKJW0KhkKc6R48e3VxbW3vt7Nmzf79kyYKpy5aJzr59+9K1axeqqqooK4sYnXGamprYurWOtWvXfqYzHo/fcvDBBy+ur3dlDe0B4IK0h/8tdo2Vtg14Gjg5bXrhWWBL2jUvmYe5j/n/duDJNvksM2lPSM1Smryt8hDwtbT/rwX+16bxeQE4Ju29D4AFaf9/BPhhm3T/GgoliSdCJBIhQqHkQgjNZdczZF4Mgs42/1+IhBpq7zqLWj9Dr732oSWVGzcuqgFOBI4ExiNHgXZN61EtB+YArwDP9Ow5vMFKuo890p07fpH9qN4pV6wF4PAjZ1stUFs621js7K1vUwVnnT056+cPPvAvACqrdpS8zlAoRDKZJBwOk0gkbOkMh8MNiUTiszSc6sxH/wGDHNXPVSs/yZtHLp1p9bQ/cAdwGLAIOXnxjTaX7WOu2Q+YB1wOzG8zw/BN4BpTPx4Brmd3J4pDgNuB4cBMYModv+i7ykp5TblibYVpdA4HVgFnAR+1uawbcs7954y+s8216ZwN3Gx0PgR8Z/v2MHv2j3Hc5K0kEhCPhwYCjyIHyP0POGfixFGbvdS5vSG8qv/AFo6bXEc8DvF4aDedGbJzVWcsFvooGk0y+YSt9OjRSlNTuKDydFPnrFnzi1o/Q9+9fE034H7gWKwdL9oCPAycf/qXN7cYY1GJnEP9lSxziW1pNVb+bKDOiqExlaognUDLhIPfAzmWtGCdFhtGRzrNe6rTBZ39BwxqMcbEM52KouQnDPwCmIz1M6zLzVDx+sce6c5jj3QH+IF5L2oxjTKT5502tBasM+091dmBdK5a+UlqxOKHTkVRchiaQrtr6fcd50Iabl6rOlWn3zoVRclhaHoWeG+ftNdupJEP1ak6g6xTUZQchkZRlCzo+oyiqKFRFEVR1NAoiqIoamgURVEURQ2NoiiKooZGURRFUdTQKIqiKGpoFEVRlHZlaOoKvDc9mJsbaeRDdarOIOtUFCWHoXm0wHsfS3vtRhr5UJ2qM8g6FUXJQhlwFVALfAFrx3a2mgfw9rT3bgX6IefXWwl+mEDOUvieDa2qU3UGWaeiKDkMTR0SPt0JLcC3zJ9XqE7VGWSdiqLkMDQdgrdm7+c4jbPO9jZ9t/BDpznfR1EUxZKh6QLci/WpiTgyNXE5Ow/AKgfuAk6zODWRRA6WuhjrC7WqU3UGWaeiKDkMzQzgTJv3XYwcRXqT+f9U4CKbaXwFOafa6n2qU3UGWaeiKFkIA2cUeO/paa/dSCMfqlN1Blmnoig5DE2XAu/t3mZ6w2ka+VCdqjPIOhVFyWFoFEVRFEUNjaIoiqKGRlEURVHU0CiKoihqaBRFURQ1NIqiKIqihkZRFEVRQ6MoiqJ0BEOzscB716W9diONfKhO1RlknYqi5DA0/yrw3mfTXj/nQhr5UJ2qM8g6FUXJYWguNw9zq8V7WoC/Ajenvfdj4G/sjJabj1bzEE+xoVV1qs4g61QUJQv/PwAlukJhy2ScjQAAAABJRU5ErkJggg==";Uo={border:{"border-top":" iconfont luckysheet-iconfont-shangbiankuang","border-bottom":" iconfont luckysheet-iconfont-xiabiankuang","border-left":" iconfont luckysheet-iconfont-zuobiankuang","border-right":" iconfont luckysheet-iconfont-youbiankuang","border-none":" iconfont luckysheet-iconfont-wubiankuang","border-all":" iconfont luckysheet-iconfont-quanjiabiankuang","border-outside":" iconfont luckysheet-iconfont-sizhoujiabiankuang","border-inside":" iconfont luckysheet-iconfont-neikuangxian","border-horizontal":" iconfont luckysheet-iconfont-neikuanghengxian","border-vertical":" iconfont luckysheet-iconfont-neikuangshuxian"},align:{left:" iconfont luckysheet-iconfont-wenbenzuoduiqi",center:" iconfont luckysheet-iconfont-wenbenjuzhongduiqi",right:" iconfont luckysheet-iconfont-wenbenyouduiqi",top:" iconfont luckysheet-iconfont-dingbuduiqi",middle:" iconfont luckysheet-iconfont-shuipingduiqi",bottom:" iconfont luckysheet-iconfont-dibuduiqi"},textWrap:{overflow:" iconfont luckysheet-iconfont-yichu1",wrap:" iconfont luckysheet-iconfont-zidonghuanhang",clip:" iconfont luckysheet-iconfont-jieduan"},rotation:{none:" iconfont luckysheet-iconfont-wuxuanzhuang",angleup:" iconfont luckysheet-iconfont-xiangshangqingxie",angledown:" iconfont luckysheet-iconfont-xiangxiaqingxie",vertical:" iconfont luckysheet-iconfont-shupaiwenzi","rotation-up":" iconfont luckysheet-iconfont-wenbenxiangshang","rotation-down":" iconfont luckysheet-iconfont-xiangxia90"}}});function $e(e){for(let n=0;n<h.luckysheetfile.length;n++)if(h.luckysheetfile[n].index==e)return n;return null}function Al(e,n,t){let l="";t==null&&(t=h.currentSheetIndex),e!=t&&(l=h.luckysheetfile[$e(e)].name.replace(/'/g,"''"),/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/.test(l)?l=l+"!":l="'"+l+"'!");let o=n.row[0],a=n.row[1],s=n.column[0],u=n.column[1];return o==null&&a==null?l+Qt(s)+":"+Qt(u):s==null&&u==null?l+(o+1)+":"+(a+1):s==u&&o==a?l+Qt(s)+(o+1):l+Qt(s)+(o+1)+":"+Qt(u)+(a+1)}function x0(){return h.luckysheet_select_save}function Yl(e){return e&&h.luckysheetfile.forEach(n=>{n.chart&&n.chart.forEach(t=>{let l=h.getChartJson(t.chart_id);t.chartOptions=l})}),h.luckysheetfile}function _0(){return h.config}function jf(){return h.visibledatarow}function Vf(){return h.visibledatacolumn}var import_plugin,ql=Tt(()=>{import_plugin=Le(Be());gl();Ut()});function C0(e){h.luckysheet_select_save=e}function Go(e){h.luckysheet_scroll_status=e}function vs(e){h.luckysheetfile=e}var import_plugin,Ea=Tt(()=>{import_plugin=Le(Be());ql();Ut()});var import_plugin,Sw,Ni,sc=Tt(()=>{import_plugin=Le(Be()),Sw={mobilecheck:function(){var e=!1;return function(n){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),document.body&&document.body.clientWidth&&document.body.clientHeight&&document.body.clientWidth<350&&document.body.clientHeight<500&&(e=!0),e},iphoneCheck:function(){var e=!1;return/iPhone/i.test(navigator.userAgent)&&(e=!0),!0},isWeixin:function(){var e=navigator.userAgent.toLowerCase();return e.match(/MicroMessenger/i)=="micromessenger"},isAndroid:function(){var e=navigator.userAgent,n=(navigator.appVersion,e.indexOf("Android")>-1||e.indexOf("Linux")>-1);return n},tabletCheck:function(){var e=/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase());return e},BrowserType:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,l=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1,a=e.indexOf("Firefox")>-1,s=e.indexOf("Safari")>-1&&e.indexOf("Chrome")==-1,u=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(t){var f=new RegExp("MSIE (\\d+\\.\\d+);");f.test(e);var m=parseFloat(RegExp.$1);return m==7?"IE7":m==8?"IE8":m==9?"IE9":m==10?"IE10":"0"}if(a)return"FF";if(n)return"Opera";if(s)return"Safari";if(u)return"Chrome";if(o)return"Edge";if(l)return"IE11"},isIE:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,l=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1;return t||l?"1":"-1"},IEVersion:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,l=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Windows NT 6.1; Trident/7.0;")>-1&&!t;if(t){var a=new RegExp("MSIE (\\d+\\.\\d+);");a.test(e);var s=parseFloat(RegExp.$1);return s==7?"IE7":s==8?"IE8":s==9?"IE9":s==10?"IE10":"0"}else return o?"Edge":l?"IE11":"-1"},luckysheetrefreshfixednum:null,luckysheetrefreshfixed:function(){var e=this;return e.luckysheetrefreshfixednum==null&&(e.BrowserType()=="FF"?e.luckysheetrefreshfixednum=5:e.luckysheetrefreshfixednum=0),e.luckysheetrefreshfixednum},detectOS(){var e=navigator.userAgent,n=navigator.platform=="Win32"||navigator.platform=="Windows",t=navigator.platform=="Mac68K"||navigator.platform=="MacPPC"||navigator.platform=="Macintosh"||navigator.platform=="MacIntel";if(t)return"Mac";var l=navigator.platform=="X11"&&!n&&!t;if(l)return"Unix";var o=String(navigator.platform).indexOf("Linux")>-1;if(o)return"Linux";if(n){var a=e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1;if(a)return"Win2000";var s=e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1;if(s)return"WinXP";var u=e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1;if(u)return"Win2003";var f=e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1;if(f)return"WinVista";var m=e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1;if(m)return"Win7"}return"other"}},Ni=Sw});var da=fn(ci=>{var import_plugin=Le(Be());"use strict";var Iw=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function Tw(e,n){return Object.prototype.hasOwnProperty.call(e,n)}ci.assign=function(e){for(var n=Array.prototype.slice.call(arguments,1);n.length;){var t=n.shift();if(!!t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(var l in t)Tw(t,l)&&(e[l]=t[l])}}return e};ci.shrinkBuf=function(e,n){return e.length===n?e:e.subarray?e.subarray(0,n):(e.length=n,e)};var Rw={arraySet:function(e,n,t,l,o){if(n.subarray&&e.subarray){e.set(n.subarray(t,t+l),o);return}for(var a=0;a<l;a++)e[o+a]=n[t+a]},flattenChunks:function(e){var n,t,l,o,a,s;for(l=0,n=0,t=e.length;n<t;n++)l+=e[n].length;for(s=new Uint8Array(l),o=0,n=0,t=e.length;n<t;n++)a=e[n],s.set(a,o),o+=a.length;return s}},Fw={arraySet:function(e,n,t,l,o){for(var a=0;a<l;a++)e[o+a]=n[t+a]},flattenChunks:function(e){return[].concat.apply([],e)}};ci.setTyped=function(e){e?(ci.Buf8=Uint8Array,ci.Buf16=Uint16Array,ci.Buf32=Int32Array,ci.assign(ci,Rw)):(ci.Buf8=Array,ci.Buf16=Array,ci.Buf32=Array,ci.assign(ci,Fw))};ci.setTyped(Iw)});var Y0=fn(fc=>{var import_plugin=Le(Be());"use strict";var Mw=da(),Dw=4,$0=0,S0=1,Aw=2;function cc(e){for(var n=e.length;--n>=0;)e[n]=0}var zw=0,I0=1,Ow=2,Pw=3,Ew=258,Vd=29,du=256,mu=du+1+Vd,uc=30,Wd=19,T0=2*mu+1,ys=15,Ud=16,Nw=7,Gd=256,R0=16,F0=17,M0=18,Yd=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Wf=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Lw=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],D0=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Hw=512,ma=new Array((mu+2)*2);cc(ma);var gu=new Array(uc*2);cc(gu);var pu=new Array(Hw);cc(pu);var vu=new Array(Ew-Pw+1);cc(vu);var qd=new Array(Vd);cc(qd);var Uf=new Array(uc);cc(Uf);function Xd(e,n,t,l,o){this.static_tree=e,this.extra_bits=n,this.extra_base=t,this.elems=l,this.max_length=o,this.has_stree=e&&e.length}var A0,z0,O0;function Zd(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}function P0(e){return e<256?pu[e]:pu[256+(e>>>7)]}function yu(e,n){e.pending_buf[e.pending++]=n&255,e.pending_buf[e.pending++]=n>>>8&255}function wi(e,n,t){e.bi_valid>Ud-t?(e.bi_buf|=n<<e.bi_valid&65535,yu(e,e.bi_buf),e.bi_buf=n>>Ud-e.bi_valid,e.bi_valid+=t-Ud):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=t)}function Yo(e,n,t){wi(e,t[n*2],t[n*2+1])}function E0(e,n){var t=0;do t|=e&1,e>>>=1,t<<=1;while(--n>0);return t>>>1}function Bw(e){e.bi_valid===16?(yu(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function jw(e,n){var t=n.dyn_tree,l=n.max_code,o=n.stat_desc.static_tree,a=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,u=n.stat_desc.extra_base,f=n.stat_desc.max_length,m,d,g,b,y,p,x=0;for(b=0;b<=ys;b++)e.bl_count[b]=0;for(t[e.heap[e.heap_max]*2+1]=0,m=e.heap_max+1;m<T0;m++)d=e.heap[m],b=t[t[d*2+1]*2+1]+1,b>f&&(b=f,x++),t[d*2+1]=b,!(d>l)&&(e.bl_count[b]++,y=0,d>=u&&(y=s[d-u]),p=t[d*2],e.opt_len+=p*(b+y),a&&(e.static_len+=p*(o[d*2+1]+y)));if(x!==0){do{for(b=f-1;e.bl_count[b]===0;)b--;e.bl_count[b]--,e.bl_count[b+1]+=2,e.bl_count[f]--,x-=2}while(x>0);for(b=f;b!==0;b--)for(d=e.bl_count[b];d!==0;)g=e.heap[--m],!(g>l)&&(t[g*2+1]!==b&&(e.opt_len+=(b-t[g*2+1])*t[g*2],t[g*2+1]=b),d--)}}function N0(e,n,t){var l=new Array(ys+1),o=0,a,s;for(a=1;a<=ys;a++)l[a]=o=o+t[a-1]<<1;for(s=0;s<=n;s++){var u=e[s*2+1];u!==0&&(e[s*2]=E0(l[u]++,u))}}function Vw(){var e,n,t,l,o,a=new Array(ys+1);for(t=0,l=0;l<Vd-1;l++)for(qd[l]=t,e=0;e<1<<Yd[l];e++)vu[t++]=l;for(vu[t-1]=l,o=0,l=0;l<16;l++)for(Uf[l]=o,e=0;e<1<<Wf[l];e++)pu[o++]=l;for(o>>=7;l<uc;l++)for(Uf[l]=o<<7,e=0;e<1<<Wf[l]-7;e++)pu[256+o++]=l;for(n=0;n<=ys;n++)a[n]=0;for(e=0;e<=143;)ma[e*2+1]=8,e++,a[8]++;for(;e<=255;)ma[e*2+1]=9,e++,a[9]++;for(;e<=279;)ma[e*2+1]=7,e++,a[7]++;for(;e<=287;)ma[e*2+1]=8,e++,a[8]++;for(N0(ma,mu+1,a),e=0;e<uc;e++)gu[e*2+1]=5,gu[e*2]=E0(e,5);A0=new Xd(ma,Yd,du+1,mu,ys),z0=new Xd(gu,Wf,0,uc,ys),O0=new Xd(new Array(0),Lw,0,Wd,Nw)}function L0(e){var n;for(n=0;n<mu;n++)e.dyn_ltree[n*2]=0;for(n=0;n<uc;n++)e.dyn_dtree[n*2]=0;for(n=0;n<Wd;n++)e.bl_tree[n*2]=0;e.dyn_ltree[Gd*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function H0(e){e.bi_valid>8?yu(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Ww(e,n,t,l){H0(e),l&&(yu(e,t),yu(e,~t)),Mw.arraySet(e.pending_buf,e.window,n,t,e.pending),e.pending+=t}function B0(e,n,t,l){var o=n*2,a=t*2;return e[o]<e[a]||e[o]===e[a]&&l[n]<=l[t]}function Kd(e,n,t){for(var l=e.heap[t],o=t<<1;o<=e.heap_len&&(o<e.heap_len&&B0(n,e.heap[o+1],e.heap[o],e.depth)&&o++,!B0(n,l,e.heap[o],e.depth));)e.heap[t]=e.heap[o],t=o,o<<=1;e.heap[t]=l}function j0(e,n,t){var l,o,a=0,s,u;if(e.last_lit!==0)do l=e.pending_buf[e.d_buf+a*2]<<8|e.pending_buf[e.d_buf+a*2+1],o=e.pending_buf[e.l_buf+a],a++,l===0?Yo(e,o,n):(s=vu[o],Yo(e,s+du+1,n),u=Yd[s],u!==0&&(o-=qd[s],wi(e,o,u)),l--,s=P0(l),Yo(e,s,t),u=Wf[s],u!==0&&(l-=Uf[s],wi(e,l,u)));while(a<e.last_lit);Yo(e,Gd,n)}function Jd(e,n){var t=n.dyn_tree,l=n.stat_desc.static_tree,o=n.stat_desc.has_stree,a=n.stat_desc.elems,s,u,f=-1,m;for(e.heap_len=0,e.heap_max=T0,s=0;s<a;s++)t[s*2]!==0?(e.heap[++e.heap_len]=f=s,e.depth[s]=0):t[s*2+1]=0;for(;e.heap_len<2;)m=e.heap[++e.heap_len]=f<2?++f:0,t[m*2]=1,e.depth[m]=0,e.opt_len--,o&&(e.static_len-=l[m*2+1]);for(n.max_code=f,s=e.heap_len>>1;s>=1;s--)Kd(e,t,s);m=a;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Kd(e,t,1),u=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=u,t[m*2]=t[s*2]+t[u*2],e.depth[m]=(e.depth[s]>=e.depth[u]?e.depth[s]:e.depth[u])+1,t[s*2+1]=t[u*2+1]=m,e.heap[1]=m++,Kd(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],jw(e,n),N0(t,f,e.bl_count)}function V0(e,n,t){var l,o=-1,a,s=n[0*2+1],u=0,f=7,m=4;for(s===0&&(f=138,m=3),n[(t+1)*2+1]=65535,l=0;l<=t;l++)a=s,s=n[(l+1)*2+1],!(++u<f&&a===s)&&(u<m?e.bl_tree[a*2]+=u:a!==0?(a!==o&&e.bl_tree[a*2]++,e.bl_tree[R0*2]++):u<=10?e.bl_tree[F0*2]++:e.bl_tree[M0*2]++,u=0,o=a,s===0?(f=138,m=3):a===s?(f=6,m=3):(f=7,m=4))}function W0(e,n,t){var l,o=-1,a,s=n[0*2+1],u=0,f=7,m=4;for(s===0&&(f=138,m=3),l=0;l<=t;l++)if(a=s,s=n[(l+1)*2+1],!(++u<f&&a===s)){if(u<m)do Yo(e,a,e.bl_tree);while(--u!=0);else a!==0?(a!==o&&(Yo(e,a,e.bl_tree),u--),Yo(e,R0,e.bl_tree),wi(e,u-3,2)):u<=10?(Yo(e,F0,e.bl_tree),wi(e,u-3,3)):(Yo(e,M0,e.bl_tree),wi(e,u-11,7));u=0,o=a,s===0?(f=138,m=3):a===s?(f=6,m=3):(f=7,m=4)}}function Uw(e){var n;for(V0(e,e.dyn_ltree,e.l_desc.max_code),V0(e,e.dyn_dtree,e.d_desc.max_code),Jd(e,e.bl_desc),n=Wd-1;n>=3&&e.bl_tree[D0[n]*2+1]===0;n--);return e.opt_len+=3*(n+1)+5+5+4,n}function Gw(e,n,t,l){var o;for(wi(e,n-257,5),wi(e,t-1,5),wi(e,l-4,4),o=0;o<l;o++)wi(e,e.bl_tree[D0[o]*2+1],3);W0(e,e.dyn_ltree,n-1),W0(e,e.dyn_dtree,t-1)}function Yw(e){var n=4093624447,t;for(t=0;t<=31;t++,n>>>=1)if(n&1&&e.dyn_ltree[t*2]!==0)return $0;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return S0;for(t=32;t<du;t++)if(e.dyn_ltree[t*2]!==0)return S0;return $0}var U0=!1;function qw(e){U0||(Vw(),U0=!0),e.l_desc=new Zd(e.dyn_ltree,A0),e.d_desc=new Zd(e.dyn_dtree,z0),e.bl_desc=new Zd(e.bl_tree,O0),e.bi_buf=0,e.bi_valid=0,L0(e)}function G0(e,n,t,l){wi(e,(zw<<1)+(l?1:0),3),Ww(e,n,t,!0)}function Xw(e){wi(e,I0<<1,3),Yo(e,Gd,ma),Bw(e)}function Zw(e,n,t,l){var o,a,s=0;e.level>0?(e.strm.data_type===Aw&&(e.strm.data_type=Yw(e)),Jd(e,e.l_desc),Jd(e,e.d_desc),s=Uw(e),o=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=o&&(o=a)):o=a=t+5,t+4<=o&&n!==-1?G0(e,n,t,l):e.strategy===Dw||a===o?(wi(e,(I0<<1)+(l?1:0),3),j0(e,ma,gu)):(wi(e,(Ow<<1)+(l?1:0),3),Gw(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),j0(e,e.dyn_ltree,e.dyn_dtree)),L0(e),l&&H0(e)}function Kw(e,n,t){return e.pending_buf[e.d_buf+e.last_lit*2]=n>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=n&255,e.pending_buf[e.l_buf+e.last_lit]=t&255,e.last_lit++,n===0?e.dyn_ltree[t*2]++:(e.matches++,n--,e.dyn_ltree[(vu[t]+du+1)*2]++,e.dyn_dtree[P0(n)*2]++),e.last_lit===e.lit_bufsize-1}fc._tr_init=qw;fc._tr_stored_block=G0;fc._tr_flush_block=Zw;fc._tr_tally=Kw;fc._tr_align=Xw});var Qd=fn((c4,q0)=>{var import_plugin=Le(Be());"use strict";function Jw(e,n,t,l){for(var o=e&65535|0,a=e>>>16&65535|0,s=0;t!==0;){s=t>2e3?2e3:t,t-=s;do o=o+n[l++]|0,a=a+o|0;while(--s);o%=65521,a%=65521}return o|a<<16|0}q0.exports=Jw});var em=fn((u4,X0)=>{var import_plugin=Le(Be());"use strict";function Qw(){for(var e,n=[],t=0;t<256;t++){e=t;for(var l=0;l<8;l++)e=e&1?3988292384^e>>>1:e>>>1;n[t]=e}return n}var e2=Qw();function t2(e,n,t,l){var o=e2,a=l+t;e^=-1;for(var s=l;s<a;s++)e=e>>>8^o[(e^n[s])&255];return e^-1}X0.exports=t2});var Gf=fn((f4,Z0)=>{var import_plugin=Le(Be());"use strict";Z0.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var iv=fn(Zo=>{var import_plugin=Le(Be());"use strict";var ui=da(),Ji=Y0(),K0=Qd(),Na=em(),l2=Gf(),ks=0,r2=1,n2=3,La=4,J0=5,qo=0,Q0=1,Qi=-2,i2=-3,tm=-5,o2=-1,a2=1,Yf=2,s2=3,c2=4,u2=0,f2=2,qf=8,h2=9,d2=15,m2=8,g2=29,p2=256,lm=p2+1+g2,v2=30,y2=19,k2=2*lm+1,b2=15,tr=3,Ha=258,bo=Ha+tr+1,w2=32,Xf=42,rm=69,Zf=73,Kf=91,Jf=103,bs=113,ku=666,Rn=1,bu=2,ws=3,hc=4,x2=3;function Ba(e,n){return e.msg=l2[n],n}function ev(e){return(e<<1)-(e>4?9:0)}function ja(e){for(var n=e.length;--n>=0;)e[n]=0}function Va(e){var n=e.state,t=n.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(ui.arraySet(e.output,n.pending_buf,n.pending_out,t,e.next_out),e.next_out+=t,n.pending_out+=t,e.total_out+=t,e.avail_out-=t,n.pending-=t,n.pending===0&&(n.pending_out=0))}function Gn(e,n){Ji._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,Va(e.strm)}function ur(e,n){e.pending_buf[e.pending++]=n}function wu(e,n){e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=n&255}function _2(e,n,t,l){var o=e.avail_in;return o>l&&(o=l),o===0?0:(e.avail_in-=o,ui.arraySet(n,e.input,e.next_in,o,t),e.state.wrap===1?e.adler=K0(e.adler,n,o,t):e.state.wrap===2&&(e.adler=Na(e.adler,n,o,t)),e.next_in+=o,e.total_in+=o,o)}function tv(e,n){var t=e.max_chain_length,l=e.strstart,o,a,s=e.prev_length,u=e.nice_match,f=e.strstart>e.w_size-bo?e.strstart-(e.w_size-bo):0,m=e.window,d=e.w_mask,g=e.prev,b=e.strstart+Ha,y=m[l+s-1],p=m[l+s];e.prev_length>=e.good_match&&(t>>=2),u>e.lookahead&&(u=e.lookahead);do if(o=n,!(m[o+s]!==p||m[o+s-1]!==y||m[o]!==m[l]||m[++o]!==m[l+1])){l+=2,o++;do;while(m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&l<b);if(a=Ha-(b-l),l=b-Ha,a>s){if(e.match_start=n,s=a,a>=u)break;y=m[l+s-1],p=m[l+s]}}while((n=g[n&d])>f&&--t!=0);return s<=e.lookahead?s:e.lookahead}function xs(e){var n=e.w_size,t,l,o,a,s;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-bo)){ui.arraySet(e.window,e.window,n,n,0),e.match_start-=n,e.strstart-=n,e.block_start-=n,l=e.hash_size,t=l;do o=e.head[--t],e.head[t]=o>=n?o-n:0;while(--l);l=n,t=l;do o=e.prev[--t],e.prev[t]=o>=n?o-n:0;while(--l);a+=n}if(e.strm.avail_in===0)break;if(l=_2(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=l,e.lookahead+e.insert>=tr)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+tr-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<tr)););}while(e.lookahead<bo&&e.strm.avail_in!==0)}function C2(e,n){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(xs(e),e.lookahead===0&&n===ks)return Rn;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var l=e.block_start+t;if((e.strstart===0||e.strstart>=l)&&(e.lookahead=e.strstart-l,e.strstart=l,Gn(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-bo&&(Gn(e,!1),e.strm.avail_out===0))return Rn}return e.insert=0,n===La?(Gn(e,!0),e.strm.avail_out===0?ws:hc):(e.strstart>e.block_start&&(Gn(e,!1),e.strm.avail_out===0),Rn)}function nm(e,n){for(var t,l;;){if(e.lookahead<bo){if(xs(e),e.lookahead<bo&&n===ks)return Rn;if(e.lookahead===0)break}if(t=0,e.lookahead>=tr&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+tr-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-bo&&(e.match_length=tv(e,t)),e.match_length>=tr)if(l=Ji._tr_tally(e,e.strstart-e.match_start,e.match_length-tr),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=tr){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+tr-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else l=Ji._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(l&&(Gn(e,!1),e.strm.avail_out===0))return Rn}return e.insert=e.strstart<tr-1?e.strstart:tr-1,n===La?(Gn(e,!0),e.strm.avail_out===0?ws:hc):e.last_lit&&(Gn(e,!1),e.strm.avail_out===0)?Rn:bu}function dc(e,n){for(var t,l,o;;){if(e.lookahead<bo){if(xs(e),e.lookahead<bo&&n===ks)return Rn;if(e.lookahead===0)break}if(t=0,e.lookahead>=tr&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+tr-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=tr-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-bo&&(e.match_length=tv(e,t),e.match_length<=5&&(e.strategy===a2||e.match_length===tr&&e.strstart-e.match_start>4096)&&(e.match_length=tr-1)),e.prev_length>=tr&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-tr,l=Ji._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-tr),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+tr-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=tr-1,e.strstart++,l&&(Gn(e,!1),e.strm.avail_out===0))return Rn}else if(e.match_available){if(l=Ji._tr_tally(e,0,e.window[e.strstart-1]),l&&Gn(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Rn}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(l=Ji._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<tr-1?e.strstart:tr-1,n===La?(Gn(e,!0),e.strm.avail_out===0?ws:hc):e.last_lit&&(Gn(e,!1),e.strm.avail_out===0)?Rn:bu}function $2(e,n){for(var t,l,o,a,s=e.window;;){if(e.lookahead<=Ha){if(xs(e),e.lookahead<=Ha&&n===ks)return Rn;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=tr&&e.strstart>0&&(o=e.strstart-1,l=s[o],l===s[++o]&&l===s[++o]&&l===s[++o])){a=e.strstart+Ha;do;while(l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&o<a);e.match_length=Ha-(a-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=tr?(t=Ji._tr_tally(e,1,e.match_length-tr),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=Ji._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(Gn(e,!1),e.strm.avail_out===0))return Rn}return e.insert=0,n===La?(Gn(e,!0),e.strm.avail_out===0?ws:hc):e.last_lit&&(Gn(e,!1),e.strm.avail_out===0)?Rn:bu}function S2(e,n){for(var t;;){if(e.lookahead===0&&(xs(e),e.lookahead===0)){if(n===ks)return Rn;break}if(e.match_length=0,t=Ji._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(Gn(e,!1),e.strm.avail_out===0))return Rn}return e.insert=0,n===La?(Gn(e,!0),e.strm.avail_out===0?ws:hc):e.last_lit&&(Gn(e,!1),e.strm.avail_out===0)?Rn:bu}function Xo(e,n,t,l,o){this.good_length=e,this.max_lazy=n,this.nice_length=t,this.max_chain=l,this.func=o}var mc;mc=[new Xo(0,0,0,0,C2),new Xo(4,4,8,4,nm),new Xo(4,5,16,8,nm),new Xo(4,6,32,32,nm),new Xo(4,4,16,16,dc),new Xo(8,16,32,32,dc),new Xo(8,16,128,128,dc),new Xo(8,32,128,256,dc),new Xo(32,128,258,1024,dc),new Xo(32,258,258,4096,dc)];function I2(e){e.window_size=2*e.w_size,ja(e.head),e.max_lazy_match=mc[e.level].max_lazy,e.good_match=mc[e.level].good_length,e.nice_match=mc[e.level].nice_length,e.max_chain_length=mc[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=tr-1,e.match_available=0,e.ins_h=0}function T2(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=qf,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new ui.Buf16(k2*2),this.dyn_dtree=new ui.Buf16((2*v2+1)*2),this.bl_tree=new ui.Buf16((2*y2+1)*2),ja(this.dyn_ltree),ja(this.dyn_dtree),ja(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new ui.Buf16(b2+1),this.heap=new ui.Buf16(2*lm+1),ja(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new ui.Buf16(2*lm+1),ja(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function lv(e){var n;return!e||!e.state?Ba(e,Qi):(e.total_in=e.total_out=0,e.data_type=f2,n=e.state,n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?Xf:bs,e.adler=n.wrap===2?0:1,n.last_flush=ks,Ji._tr_init(n),qo)}function rv(e){var n=lv(e);return n===qo&&I2(e.state),n}function R2(e,n){return!e||!e.state||e.state.wrap!==2?Qi:(e.state.gzhead=n,qo)}function nv(e,n,t,l,o,a){if(!e)return Qi;var s=1;if(n===o2&&(n=6),l<0?(s=0,l=-l):l>15&&(s=2,l-=16),o<1||o>h2||t!==qf||l<8||l>15||n<0||n>9||a<0||a>c2)return Ba(e,Qi);l===8&&(l=9);var u=new T2;return e.state=u,u.strm=e,u.wrap=s,u.gzhead=null,u.w_bits=l,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+tr-1)/tr),u.window=new ui.Buf8(u.w_size*2),u.head=new ui.Buf16(u.hash_size),u.prev=new ui.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=u.lit_bufsize*4,u.pending_buf=new ui.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=(1+2)*u.lit_bufsize,u.level=n,u.strategy=a,u.method=t,rv(e)}function F2(e,n){return nv(e,n,qf,d2,m2,u2)}function M2(e,n){var t,l,o,a;if(!e||!e.state||n>J0||n<0)return e?Ba(e,Qi):Qi;if(l=e.state,!e.output||!e.input&&e.avail_in!==0||l.status===ku&&n!==La)return Ba(e,e.avail_out===0?tm:Qi);if(l.strm=e,t=l.last_flush,l.last_flush=n,l.status===Xf)if(l.wrap===2)e.adler=0,ur(l,31),ur(l,139),ur(l,8),l.gzhead?(ur(l,(l.gzhead.text?1:0)+(l.gzhead.hcrc?2:0)+(l.gzhead.extra?4:0)+(l.gzhead.name?8:0)+(l.gzhead.comment?16:0)),ur(l,l.gzhead.time&255),ur(l,l.gzhead.time>>8&255),ur(l,l.gzhead.time>>16&255),ur(l,l.gzhead.time>>24&255),ur(l,l.level===9?2:l.strategy>=Yf||l.level<2?4:0),ur(l,l.gzhead.os&255),l.gzhead.extra&&l.gzhead.extra.length&&(ur(l,l.gzhead.extra.length&255),ur(l,l.gzhead.extra.length>>8&255)),l.gzhead.hcrc&&(e.adler=Na(e.adler,l.pending_buf,l.pending,0)),l.gzindex=0,l.status=rm):(ur(l,0),ur(l,0),ur(l,0),ur(l,0),ur(l,0),ur(l,l.level===9?2:l.strategy>=Yf||l.level<2?4:0),ur(l,x2),l.status=bs);else{var s=qf+(l.w_bits-8<<4)<<8,u=-1;l.strategy>=Yf||l.level<2?u=0:l.level<6?u=1:l.level===6?u=2:u=3,s|=u<<6,l.strstart!==0&&(s|=w2),s+=31-s%31,l.status=bs,wu(l,s),l.strstart!==0&&(wu(l,e.adler>>>16),wu(l,e.adler&65535)),e.adler=1}if(l.status===rm)if(l.gzhead.extra){for(o=l.pending;l.gzindex<(l.gzhead.extra.length&65535)&&!(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>o&&(e.adler=Na(e.adler,l.pending_buf,l.pending-o,o)),Va(e),o=l.pending,l.pending===l.pending_buf_size));)ur(l,l.gzhead.extra[l.gzindex]&255),l.gzindex++;l.gzhead.hcrc&&l.pending>o&&(e.adler=Na(e.adler,l.pending_buf,l.pending-o,o)),l.gzindex===l.gzhead.extra.length&&(l.gzindex=0,l.status=Zf)}else l.status=Zf;if(l.status===Zf)if(l.gzhead.name){o=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>o&&(e.adler=Na(e.adler,l.pending_buf,l.pending-o,o)),Va(e),o=l.pending,l.pending===l.pending_buf_size)){a=1;break}l.gzindex<l.gzhead.name.length?a=l.gzhead.name.charCodeAt(l.gzindex++)&255:a=0,ur(l,a)}while(a!==0);l.gzhead.hcrc&&l.pending>o&&(e.adler=Na(e.adler,l.pending_buf,l.pending-o,o)),a===0&&(l.gzindex=0,l.status=Kf)}else l.status=Kf;if(l.status===Kf)if(l.gzhead.comment){o=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>o&&(e.adler=Na(e.adler,l.pending_buf,l.pending-o,o)),Va(e),o=l.pending,l.pending===l.pending_buf_size)){a=1;break}l.gzindex<l.gzhead.comment.length?a=l.gzhead.comment.charCodeAt(l.gzindex++)&255:a=0,ur(l,a)}while(a!==0);l.gzhead.hcrc&&l.pending>o&&(e.adler=Na(e.adler,l.pending_buf,l.pending-o,o)),a===0&&(l.status=Jf)}else l.status=Jf;if(l.status===Jf&&(l.gzhead.hcrc?(l.pending+2>l.pending_buf_size&&Va(e),l.pending+2<=l.pending_buf_size&&(ur(l,e.adler&255),ur(l,e.adler>>8&255),e.adler=0,l.status=bs)):l.status=bs),l.pending!==0){if(Va(e),e.avail_out===0)return l.last_flush=-1,qo}else if(e.avail_in===0&&ev(n)<=ev(t)&&n!==La)return Ba(e,tm);if(l.status===ku&&e.avail_in!==0)return Ba(e,tm);if(e.avail_in!==0||l.lookahead!==0||n!==ks&&l.status!==ku){var f=l.strategy===Yf?S2(l,n):l.strategy===s2?$2(l,n):mc[l.level].func(l,n);if((f===ws||f===hc)&&(l.status=ku),f===Rn||f===ws)return e.avail_out===0&&(l.last_flush=-1),qo;if(f===bu&&(n===r2?Ji._tr_align(l):n!==J0&&(Ji._tr_stored_block(l,0,0,!1),n===n2&&(ja(l.head),l.lookahead===0&&(l.strstart=0,l.block_start=0,l.insert=0))),Va(e),e.avail_out===0))return l.last_flush=-1,qo}return n!==La?qo:l.wrap<=0?Q0:(l.wrap===2?(ur(l,e.adler&255),ur(l,e.adler>>8&255),ur(l,e.adler>>16&255),ur(l,e.adler>>24&255),ur(l,e.total_in&255),ur(l,e.total_in>>8&255),ur(l,e.total_in>>16&255),ur(l,e.total_in>>24&255)):(wu(l,e.adler>>>16),wu(l,e.adler&65535)),Va(e),l.wrap>0&&(l.wrap=-l.wrap),l.pending!==0?qo:Q0)}function D2(e){var n;return!e||!e.state?Qi:(n=e.state.status,n!==Xf&&n!==rm&&n!==Zf&&n!==Kf&&n!==Jf&&n!==bs&&n!==ku?Ba(e,Qi):(e.state=null,n===bs?Ba(e,i2):qo))}function A2(e,n){var t=n.length,l,o,a,s,u,f,m,d;if(!e||!e.state||(l=e.state,s=l.wrap,s===2||s===1&&l.status!==Xf||l.lookahead))return Qi;for(s===1&&(e.adler=K0(e.adler,n,t,0)),l.wrap=0,t>=l.w_size&&(s===0&&(ja(l.head),l.strstart=0,l.block_start=0,l.insert=0),d=new ui.Buf8(l.w_size),ui.arraySet(d,n,t-l.w_size,l.w_size,0),n=d,t=l.w_size),u=e.avail_in,f=e.next_in,m=e.input,e.avail_in=t,e.next_in=0,e.input=n,xs(l);l.lookahead>=tr;){o=l.strstart,a=l.lookahead-(tr-1);do l.ins_h=(l.ins_h<<l.hash_shift^l.window[o+tr-1])&l.hash_mask,l.prev[o&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=o,o++;while(--a);l.strstart=o,l.lookahead=tr-1,xs(l)}return l.strstart+=l.lookahead,l.block_start=l.strstart,l.insert=l.lookahead,l.lookahead=0,l.match_length=l.prev_length=tr-1,l.match_available=0,e.next_in=f,e.input=m,e.avail_in=u,l.wrap=s,qo}Zo.deflateInit=F2;Zo.deflateInit2=nv;Zo.deflateReset=rv;Zo.deflateResetKeep=lv;Zo.deflateSetHeader=R2;Zo.deflate=M2;Zo.deflateEnd=D2;Zo.deflateSetDictionary=A2;Zo.deflateInfo="pako deflate (from Nodeca project)"});var im=fn(gc=>{var import_plugin=Le(Be());"use strict";var Qf=da(),ov=!0,av=!0;try{String.fromCharCode.apply(null,[0])}catch(e){ov=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){av=!1}var xu=new Qf.Buf8(256);for(var Wa=0;Wa<256;Wa++)xu[Wa]=Wa>=252?6:Wa>=248?5:Wa>=240?4:Wa>=224?3:Wa>=192?2:1;xu[254]=xu[254]=1;gc.string2buf=function(e){var n,t,l,o,a,s=e.length,u=0;for(o=0;o<s;o++)t=e.charCodeAt(o),(t&64512)==55296&&o+1<s&&(l=e.charCodeAt(o+1),(l&64512)==56320&&(t=65536+(t-55296<<10)+(l-56320),o++)),u+=t<128?1:t<2048?2:t<65536?3:4;for(n=new Qf.Buf8(u),a=0,o=0;a<u;o++)t=e.charCodeAt(o),(t&64512)==55296&&o+1<s&&(l=e.charCodeAt(o+1),(l&64512)==56320&&(t=65536+(t-55296<<10)+(l-56320),o++)),t<128?n[a++]=t:t<2048?(n[a++]=192|t>>>6,n[a++]=128|t&63):t<65536?(n[a++]=224|t>>>12,n[a++]=128|t>>>6&63,n[a++]=128|t&63):(n[a++]=240|t>>>18,n[a++]=128|t>>>12&63,n[a++]=128|t>>>6&63,n[a++]=128|t&63);return n};function sv(e,n){if(n<65534&&(e.subarray&&av||!e.subarray&&ov))return String.fromCharCode.apply(null,Qf.shrinkBuf(e,n));for(var t="",l=0;l<n;l++)t+=String.fromCharCode(e[l]);return t}gc.buf2binstring=function(e){return sv(e,e.length)};gc.binstring2buf=function(e){for(var n=new Qf.Buf8(e.length),t=0,l=n.length;t<l;t++)n[t]=e.charCodeAt(t);return n};gc.buf2string=function(e,n){var t,l,o,a,s=n||e.length,u=new Array(s*2);for(l=0,t=0;t<s;){if(o=e[t++],o<128){u[l++]=o;continue}if(a=xu[o],a>4){u[l++]=65533,t+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&t<s;)o=o<<6|e[t++]&63,a--;if(a>1){u[l++]=65533;continue}o<65536?u[l++]=o:(o-=65536,u[l++]=55296|o>>10&1023,u[l++]=56320|o&1023)}return sv(u,l)};gc.utf8border=function(e,n){var t;for(n=n||e.length,n>e.length&&(n=e.length),t=n-1;t>=0&&(e[t]&192)==128;)t--;return t<0||t===0?n:t+xu[e[t]]>n?t:n}});var om=fn((m4,cv)=>{var import_plugin=Le(Be());"use strict";function z2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}cv.exports=z2});var dv=fn($u=>{var import_plugin=Le(Be());"use strict";var _u=iv(),Cu=da(),am=im(),sm=Gf(),O2=om(),uv=Object.prototype.toString,P2=0,cm=4,pc=0,fv=1,hv=2,E2=-1,N2=0,L2=8;function _s(e){if(!(this instanceof _s))return new _s(e);this.options=Cu.assign({level:E2,method:L2,chunkSize:16384,windowBits:15,memLevel:8,strategy:N2,to:""},e||{});var n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new O2,this.strm.avail_out=0;var t=_u.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(t!==pc)throw new Error(sm[t]);if(n.header&&_u.deflateSetHeader(this.strm,n.header),n.dictionary){var l;if(typeof n.dictionary=="string"?l=am.string2buf(n.dictionary):uv.call(n.dictionary)==="[object ArrayBuffer]"?l=new Uint8Array(n.dictionary):l=n.dictionary,t=_u.deflateSetDictionary(this.strm,l),t!==pc)throw new Error(sm[t]);this._dict_set=!0}}_s.prototype.push=function(e,n){var t=this.strm,l=this.options.chunkSize,o,a;if(this.ended)return!1;a=n===~~n?n:n===!0?cm:P2,typeof e=="string"?t.input=am.string2buf(e):uv.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new Cu.Buf8(l),t.next_out=0,t.avail_out=l),o=_u.deflate(t,a),o!==fv&&o!==pc)return this.onEnd(o),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(a===cm||a===hv))&&(this.options.to==="string"?this.onData(am.buf2binstring(Cu.shrinkBuf(t.output,t.next_out))):this.onData(Cu.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&o!==fv);return a===cm?(o=_u.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===pc):(a===hv&&(this.onEnd(pc),t.avail_out=0),!0)};_s.prototype.onData=function(e){this.chunks.push(e)};_s.prototype.onEnd=function(e){e===pc&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Cu.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function um(e,n){var t=new _s(n);if(t.push(e,!0),t.err)throw t.msg||sm[t.err];return t.result}function H2(e,n){return n=n||{},n.raw=!0,um(e,n)}function B2(e,n){return n=n||{},n.gzip=!0,um(e,n)}$u.Deflate=_s;$u.deflate=um;$u.deflateRaw=H2;$u.gzip=B2});var gv=fn((p4,mv)=>{var import_plugin=Le(Be());"use strict";var eh=30,j2=12;mv.exports=function(n,t){var l,o,a,s,u,f,m,d,g,b,y,p,x,_,S,I,O,F,D,k,w,C,T,z,A;l=n.state,o=n.next_in,z=n.input,a=o+(n.avail_in-5),s=n.next_out,A=n.output,u=s-(t-n.avail_out),f=s+(n.avail_out-257),m=l.dmax,d=l.wsize,g=l.whave,b=l.wnext,y=l.window,p=l.hold,x=l.bits,_=l.lencode,S=l.distcode,I=(1<<l.lenbits)-1,O=(1<<l.distbits)-1;e:do{x<15&&(p+=z[o++]<<x,x+=8,p+=z[o++]<<x,x+=8),F=_[p&I];t:for(;;){if(D=F>>>24,p>>>=D,x-=D,D=F>>>16&255,D===0)A[s++]=F&65535;else if(D&16){k=F&65535,D&=15,D&&(x<D&&(p+=z[o++]<<x,x+=8),k+=p&(1<<D)-1,p>>>=D,x-=D),x<15&&(p+=z[o++]<<x,x+=8,p+=z[o++]<<x,x+=8),F=S[p&O];l:for(;;){if(D=F>>>24,p>>>=D,x-=D,D=F>>>16&255,D&16){if(w=F&65535,D&=15,x<D&&(p+=z[o++]<<x,x+=8,x<D&&(p+=z[o++]<<x,x+=8)),w+=p&(1<<D)-1,w>m){n.msg="invalid distance too far back",l.mode=eh;break e}if(p>>>=D,x-=D,D=s-u,w>D){if(D=w-D,D>g&&l.sane){n.msg="invalid distance too far back",l.mode=eh;break e}if(C=0,T=y,b===0){if(C+=d-D,D<k){k-=D;do A[s++]=y[C++];while(--D);C=s-w,T=A}}else if(b<D){if(C+=d+b-D,D-=b,D<k){k-=D;do A[s++]=y[C++];while(--D);if(C=0,b<k){D=b,k-=D;do A[s++]=y[C++];while(--D);C=s-w,T=A}}}else if(C+=b-D,D<k){k-=D;do A[s++]=y[C++];while(--D);C=s-w,T=A}for(;k>2;)A[s++]=T[C++],A[s++]=T[C++],A[s++]=T[C++],k-=3;k&&(A[s++]=T[C++],k>1&&(A[s++]=T[C++]))}else{C=s-w;do A[s++]=A[C++],A[s++]=A[C++],A[s++]=A[C++],k-=3;while(k>2);k&&(A[s++]=A[C++],k>1&&(A[s++]=A[C++]))}}else if((D&64)==0){F=S[(F&65535)+(p&(1<<D)-1)];continue l}else{n.msg="invalid distance code",l.mode=eh;break e}break}}else if((D&64)==0){F=_[(F&65535)+(p&(1<<D)-1)];continue t}else if(D&32){l.mode=j2;break e}else{n.msg="invalid literal/length code",l.mode=eh;break e}break}}while(o<a&&s<f);k=x>>3,o-=k,x-=k<<3,p&=(1<<x)-1,n.next_in=o,n.next_out=s,n.avail_in=o<a?5+(a-o):5-(o-a),n.avail_out=s<f?257+(f-s):257-(s-f),l.hold=p,l.bits=x}});var xv=fn((v4,wv)=>{var import_plugin=Le(Be());"use strict";var pv=da(),vc=15,vv=852,yv=592,kv=0,fm=1,bv=2,V2=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],W2=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],U2=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],G2=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];wv.exports=function(n,t,l,o,a,s,u,f){var m=f.bits,d=0,g=0,b=0,y=0,p=0,x=0,_=0,S=0,I=0,O=0,F,D,k,w,C,T=null,z=0,A,M=new pv.Buf16(vc+1),P=new pv.Buf16(vc+1),N=null,E=0,B,U,X;for(d=0;d<=vc;d++)M[d]=0;for(g=0;g<o;g++)M[t[l+g]]++;for(p=m,y=vc;y>=1&&M[y]===0;y--);if(p>y&&(p=y),y===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,f.bits=1,0;for(b=1;b<y&&M[b]===0;b++);for(p<b&&(p=b),S=1,d=1;d<=vc;d++)if(S<<=1,S-=M[d],S<0)return-1;if(S>0&&(n===kv||y!==1))return-1;for(P[1]=0,d=1;d<vc;d++)P[d+1]=P[d]+M[d];for(g=0;g<o;g++)t[l+g]!==0&&(u[P[t[l+g]]++]=g);if(n===kv?(T=N=u,A=19):n===fm?(T=V2,z-=257,N=W2,E-=257,A=256):(T=U2,N=G2,A=-1),O=0,g=0,d=b,C=s,x=p,_=0,k=-1,I=1<<p,w=I-1,n===fm&&I>vv||n===bv&&I>yv)return 1;for(;;){B=d-_,u[g]<A?(U=0,X=u[g]):u[g]>A?(U=N[E+u[g]],X=T[z+u[g]]):(U=32+64,X=0),F=1<<d-_,D=1<<x,b=D;do D-=F,a[C+(O>>_)+D]=B<<24|U<<16|X|0;while(D!==0);for(F=1<<d-1;O&F;)F>>=1;if(F!==0?(O&=F-1,O+=F):O=0,g++,--M[d]==0){if(d===y)break;d=t[l+u[g]]}if(d>p&&(O&w)!==k){for(_===0&&(_=p),C+=b,x=d-_,S=1<<x;x+_<y&&(S-=M[x+_],!(S<=0));)x++,S<<=1;if(I+=1<<x,n===fm&&I>vv||n===bv&&I>yv)return 1;k=O&w,a[k]=p<<24|x<<16|C-s|0}}return O!==0&&(a[C+O]=d-_<<24|64<<16|0),f.bits=p,0}});var ry=fn(wo=>{var import_plugin=Le(Be());"use strict";var Li=da(),hm=Qd(),Ko=em(),Y2=gv(),Su=xv(),q2=0,_v=1,Cv=2,$v=4,X2=5,th=6,Cs=0,Z2=1,K2=2,eo=-2,Sv=-3,dm=-4,J2=-5,Iv=8,Tv=1,Rv=2,Fv=3,Mv=4,Dv=5,Av=6,zv=7,Ov=8,Pv=9,Ev=10,lh=11,ga=12,mm=13,Nv=14,gm=15,Lv=16,Hv=17,Bv=18,jv=19,rh=20,nh=21,Vv=22,Wv=23,Uv=24,Gv=25,Yv=26,pm=27,qv=28,Xv=29,Gr=30,vm=31,Q2=32,ex=852,tx=592,lx=15,rx=lx;function Zv(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function nx(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Li.Buf16(320),this.work=new Li.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Kv(e){var n;return!e||!e.state?eo:(n=e.state,e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=n.wrap&1),n.mode=Tv,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Li.Buf32(ex),n.distcode=n.distdyn=new Li.Buf32(tx),n.sane=1,n.back=-1,Cs)}function Jv(e){var n;return!e||!e.state?eo:(n=e.state,n.wsize=0,n.whave=0,n.wnext=0,Kv(e))}function Qv(e,n){var t,l;return!e||!e.state||(l=e.state,n<0?(t=0,n=-n):(t=(n>>4)+1,n<48&&(n&=15)),n&&(n<8||n>15))?eo:(l.window!==null&&l.wbits!==n&&(l.window=null),l.wrap=t,l.wbits=n,Jv(e))}function ey(e,n){var t,l;return e?(l=new nx,e.state=l,l.window=null,t=Qv(e,n),t!==Cs&&(e.state=null),t):eo}function ix(e){return ey(e,rx)}var ty=!0,ym,km;function ox(e){if(ty){var n;for(ym=new Li.Buf32(512),km=new Li.Buf32(32),n=0;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(Su(_v,e.lens,0,288,ym,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;Su(Cv,e.lens,0,32,km,0,e.work,{bits:5}),ty=!1}e.lencode=ym,e.lenbits=9,e.distcode=km,e.distbits=5}function ly(e,n,t,l){var o,a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Li.Buf8(a.wsize)),l>=a.wsize?(Li.arraySet(a.window,n,t-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(o=a.wsize-a.wnext,o>l&&(o=l),Li.arraySet(a.window,n,t-l,o,a.wnext),l-=o,l?(Li.arraySet(a.window,n,t-l,l,0),a.wnext=l,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}function ax(e,n){var t,l,o,a,s,u,f,m,d,g,b,y,p,x,_=0,S,I,O,F,D,k,w,C,T=new Li.Buf8(4),z,A,M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return eo;t=e.state,t.mode===ga&&(t.mode=mm),s=e.next_out,o=e.output,f=e.avail_out,a=e.next_in,l=e.input,u=e.avail_in,m=t.hold,d=t.bits,g=u,b=f,C=Cs;e:for(;;)switch(t.mode){case Tv:if(t.wrap===0){t.mode=mm;break}for(;d<16;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(t.wrap&2&&m===35615){t.check=0,T[0]=m&255,T[1]=m>>>8&255,t.check=Ko(t.check,T,2,0),m=0,d=0,t.mode=Rv;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((m&255)<<8)+(m>>8))%31){e.msg="incorrect header check",t.mode=Gr;break}if((m&15)!==Iv){e.msg="unknown compression method",t.mode=Gr;break}if(m>>>=4,d-=4,w=(m&15)+8,t.wbits===0)t.wbits=w;else if(w>t.wbits){e.msg="invalid window size",t.mode=Gr;break}t.dmax=1<<w,e.adler=t.check=1,t.mode=m&512?Ev:ga,m=0,d=0;break;case Rv:for(;d<16;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(t.flags=m,(t.flags&255)!==Iv){e.msg="unknown compression method",t.mode=Gr;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=Gr;break}t.head&&(t.head.text=m>>8&1),t.flags&512&&(T[0]=m&255,T[1]=m>>>8&255,t.check=Ko(t.check,T,2,0)),m=0,d=0,t.mode=Fv;case Fv:for(;d<32;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.head&&(t.head.time=m),t.flags&512&&(T[0]=m&255,T[1]=m>>>8&255,T[2]=m>>>16&255,T[3]=m>>>24&255,t.check=Ko(t.check,T,4,0)),m=0,d=0,t.mode=Mv;case Mv:for(;d<16;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.head&&(t.head.xflags=m&255,t.head.os=m>>8),t.flags&512&&(T[0]=m&255,T[1]=m>>>8&255,t.check=Ko(t.check,T,2,0)),m=0,d=0,t.mode=Dv;case Dv:if(t.flags&1024){for(;d<16;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.length=m,t.head&&(t.head.extra_len=m),t.flags&512&&(T[0]=m&255,T[1]=m>>>8&255,t.check=Ko(t.check,T,2,0)),m=0,d=0}else t.head&&(t.head.extra=null);t.mode=Av;case Av:if(t.flags&1024&&(y=t.length,y>u&&(y=u),y&&(t.head&&(w=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),Li.arraySet(t.head.extra,l,a,y,w)),t.flags&512&&(t.check=Ko(t.check,l,y,a)),u-=y,a+=y,t.length-=y),t.length))break e;t.length=0,t.mode=zv;case zv:if(t.flags&2048){if(u===0)break e;y=0;do w=l[a+y++],t.head&&w&&t.length<65536&&(t.head.name+=String.fromCharCode(w));while(w&&y<u);if(t.flags&512&&(t.check=Ko(t.check,l,y,a)),u-=y,a+=y,w)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Ov;case Ov:if(t.flags&4096){if(u===0)break e;y=0;do w=l[a+y++],t.head&&w&&t.length<65536&&(t.head.comment+=String.fromCharCode(w));while(w&&y<u);if(t.flags&512&&(t.check=Ko(t.check,l,y,a)),u-=y,a+=y,w)break e}else t.head&&(t.head.comment=null);t.mode=Pv;case Pv:if(t.flags&512){for(;d<16;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(m!==(t.check&65535)){e.msg="header crc mismatch",t.mode=Gr;break}m=0,d=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=ga;break;case Ev:for(;d<32;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}e.adler=t.check=Zv(m),m=0,d=0,t.mode=lh;case lh:if(t.havedict===0)return e.next_out=s,e.avail_out=f,e.next_in=a,e.avail_in=u,t.hold=m,t.bits=d,K2;e.adler=t.check=1,t.mode=ga;case ga:if(n===X2||n===th)break e;case mm:if(t.last){m>>>=d&7,d-=d&7,t.mode=pm;break}for(;d<3;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}switch(t.last=m&1,m>>>=1,d-=1,m&3){case 0:t.mode=Nv;break;case 1:if(ox(t),t.mode=rh,n===th){m>>>=2,d-=2;break e}break;case 2:t.mode=Hv;break;case 3:e.msg="invalid block type",t.mode=Gr}m>>>=2,d-=2;break;case Nv:for(m>>>=d&7,d-=d&7;d<32;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if((m&65535)!=(m>>>16^65535)){e.msg="invalid stored block lengths",t.mode=Gr;break}if(t.length=m&65535,m=0,d=0,t.mode=gm,n===th)break e;case gm:t.mode=Lv;case Lv:if(y=t.length,y){if(y>u&&(y=u),y>f&&(y=f),y===0)break e;Li.arraySet(o,l,a,y,s),u-=y,a+=y,f-=y,s+=y,t.length-=y;break}t.mode=ga;break;case Hv:for(;d<14;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(t.nlen=(m&31)+257,m>>>=5,d-=5,t.ndist=(m&31)+1,m>>>=5,d-=5,t.ncode=(m&15)+4,m>>>=4,d-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=Gr;break}t.have=0,t.mode=Bv;case Bv:for(;t.have<t.ncode;){for(;d<3;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.lens[M[t.have++]]=m&7,m>>>=3,d-=3}for(;t.have<19;)t.lens[M[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,z={bits:t.lenbits},C=Su(q2,t.lens,0,19,t.lencode,0,t.work,z),t.lenbits=z.bits,C){e.msg="invalid code lengths set",t.mode=Gr;break}t.have=0,t.mode=jv;case jv:for(;t.have<t.nlen+t.ndist;){for(;_=t.lencode[m&(1<<t.lenbits)-1],S=_>>>24,I=_>>>16&255,O=_&65535,!(S<=d);){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(O<16)m>>>=S,d-=S,t.lens[t.have++]=O;else{if(O===16){for(A=S+2;d<A;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(m>>>=S,d-=S,t.have===0){e.msg="invalid bit length repeat",t.mode=Gr;break}w=t.lens[t.have-1],y=3+(m&3),m>>>=2,d-=2}else if(O===17){for(A=S+3;d<A;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}m>>>=S,d-=S,w=0,y=3+(m&7),m>>>=3,d-=3}else{for(A=S+7;d<A;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}m>>>=S,d-=S,w=0,y=11+(m&127),m>>>=7,d-=7}if(t.have+y>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=Gr;break}for(;y--;)t.lens[t.have++]=w}}if(t.mode===Gr)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=Gr;break}if(t.lenbits=9,z={bits:t.lenbits},C=Su(_v,t.lens,0,t.nlen,t.lencode,0,t.work,z),t.lenbits=z.bits,C){e.msg="invalid literal/lengths set",t.mode=Gr;break}if(t.distbits=6,t.distcode=t.distdyn,z={bits:t.distbits},C=Su(Cv,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,z),t.distbits=z.bits,C){e.msg="invalid distances set",t.mode=Gr;break}if(t.mode=rh,n===th)break e;case rh:t.mode=nh;case nh:if(u>=6&&f>=258){e.next_out=s,e.avail_out=f,e.next_in=a,e.avail_in=u,t.hold=m,t.bits=d,Y2(e,b),s=e.next_out,o=e.output,f=e.avail_out,a=e.next_in,l=e.input,u=e.avail_in,m=t.hold,d=t.bits,t.mode===ga&&(t.back=-1);break}for(t.back=0;_=t.lencode[m&(1<<t.lenbits)-1],S=_>>>24,I=_>>>16&255,O=_&65535,!(S<=d);){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(I&&(I&240)==0){for(F=S,D=I,k=O;_=t.lencode[k+((m&(1<<F+D)-1)>>F)],S=_>>>24,I=_>>>16&255,O=_&65535,!(F+S<=d);){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}m>>>=F,d-=F,t.back+=F}if(m>>>=S,d-=S,t.back+=S,t.length=O,I===0){t.mode=Yv;break}if(I&32){t.back=-1,t.mode=ga;break}if(I&64){e.msg="invalid literal/length code",t.mode=Gr;break}t.extra=I&15,t.mode=Vv;case Vv:if(t.extra){for(A=t.extra;d<A;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.length+=m&(1<<t.extra)-1,m>>>=t.extra,d-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Wv;case Wv:for(;_=t.distcode[m&(1<<t.distbits)-1],S=_>>>24,I=_>>>16&255,O=_&65535,!(S<=d);){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if((I&240)==0){for(F=S,D=I,k=O;_=t.distcode[k+((m&(1<<F+D)-1)>>F)],S=_>>>24,I=_>>>16&255,O=_&65535,!(F+S<=d);){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}m>>>=F,d-=F,t.back+=F}if(m>>>=S,d-=S,t.back+=S,I&64){e.msg="invalid distance code",t.mode=Gr;break}t.offset=O,t.extra=I&15,t.mode=Uv;case Uv:if(t.extra){for(A=t.extra;d<A;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.offset+=m&(1<<t.extra)-1,m>>>=t.extra,d-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=Gr;break}t.mode=Gv;case Gv:if(f===0)break e;if(y=b-f,t.offset>y){if(y=t.offset-y,y>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=Gr;break}y>t.wnext?(y-=t.wnext,p=t.wsize-y):p=t.wnext-y,y>t.length&&(y=t.length),x=t.window}else x=o,p=s-t.offset,y=t.length;y>f&&(y=f),f-=y,t.length-=y;do o[s++]=x[p++];while(--y);t.length===0&&(t.mode=nh);break;case Yv:if(f===0)break e;o[s++]=t.length,f--,t.mode=nh;break;case pm:if(t.wrap){for(;d<32;){if(u===0)break e;u--,m|=l[a++]<<d,d+=8}if(b-=f,e.total_out+=b,t.total+=b,b&&(e.adler=t.check=t.flags?Ko(t.check,o,b,s-b):hm(t.check,o,b,s-b)),b=f,(t.flags?m:Zv(m))!==t.check){e.msg="incorrect data check",t.mode=Gr;break}m=0,d=0}t.mode=qv;case qv:if(t.wrap&&t.flags){for(;d<32;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(m!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=Gr;break}m=0,d=0}t.mode=Xv;case Xv:C=Z2;break e;case Gr:C=Sv;break e;case vm:return dm;case Q2:default:return eo}return e.next_out=s,e.avail_out=f,e.next_in=a,e.avail_in=u,t.hold=m,t.bits=d,(t.wsize||b!==e.avail_out&&t.mode<Gr&&(t.mode<pm||n!==$v))&&ly(e,e.output,e.next_out,b-e.avail_out)?(t.mode=vm,dm):(g-=e.avail_in,b-=e.avail_out,e.total_in+=g,e.total_out+=b,t.total+=b,t.wrap&&b&&(e.adler=t.check=t.flags?Ko(t.check,o,b,e.next_out-b):hm(t.check,o,b,e.next_out-b)),e.data_type=t.bits+(t.last?64:0)+(t.mode===ga?128:0)+(t.mode===rh||t.mode===gm?256:0),(g===0&&b===0||n===$v)&&C===Cs&&(C=J2),C)}function sx(e){if(!e||!e.state)return eo;var n=e.state;return n.window&&(n.window=null),e.state=null,Cs}function cx(e,n){var t;return!e||!e.state||(t=e.state,(t.wrap&2)==0)?eo:(t.head=n,n.done=!1,Cs)}function ux(e,n){var t=n.length,l,o,a;return!e||!e.state||(l=e.state,l.wrap!==0&&l.mode!==lh)?eo:l.mode===lh&&(o=1,o=hm(o,n,t,0),o!==l.check)?Sv:(a=ly(e,n,t,t),a?(l.mode=vm,dm):(l.havedict=1,Cs))}wo.inflateReset=Jv;wo.inflateReset2=Qv;wo.inflateResetKeep=Kv;wo.inflateInit=ix;wo.inflateInit2=ey;wo.inflate=ax;wo.inflateEnd=sx;wo.inflateGetHeader=cx;wo.inflateSetDictionary=ux;wo.inflateInfo="pako inflate (from Nodeca project)"});var bm=fn((k4,ny)=>{var import_plugin=Le(Be());"use strict";ny.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var oy=fn((b4,iy)=>{var import_plugin=Le(Be());"use strict";function fx(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}iy.exports=fx});var sy=fn(Tu=>{var import_plugin=Le(Be());"use strict";var yc=ry(),Iu=da(),ih=im(),hn=bm(),wm=Gf(),hx=om(),dx=oy(),ay=Object.prototype.toString;function $s(e){if(!(this instanceof $s))return new $s(e);this.options=Iu.assign({chunkSize:16384,windowBits:0,to:""},e||{});var n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(e&&e.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15)==0&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new hx,this.strm.avail_out=0;var t=yc.inflateInit2(this.strm,n.windowBits);if(t!==hn.Z_OK)throw new Error(wm[t]);if(this.header=new dx,yc.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=ih.string2buf(n.dictionary):ay.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(t=yc.inflateSetDictionary(this.strm,n.dictionary),t!==hn.Z_OK)))throw new Error(wm[t])}$s.prototype.push=function(e,n){var t=this.strm,l=this.options.chunkSize,o=this.options.dictionary,a,s,u,f,m,d=!1;if(this.ended)return!1;s=n===~~n?n:n===!0?hn.Z_FINISH:hn.Z_NO_FLUSH,typeof e=="string"?t.input=ih.binstring2buf(e):ay.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new Iu.Buf8(l),t.next_out=0,t.avail_out=l),a=yc.inflate(t,hn.Z_NO_FLUSH),a===hn.Z_NEED_DICT&&o&&(a=yc.inflateSetDictionary(this.strm,o)),a===hn.Z_BUF_ERROR&&d===!0&&(a=hn.Z_OK,d=!1),a!==hn.Z_STREAM_END&&a!==hn.Z_OK)return this.onEnd(a),this.ended=!0,!1;t.next_out&&(t.avail_out===0||a===hn.Z_STREAM_END||t.avail_in===0&&(s===hn.Z_FINISH||s===hn.Z_SYNC_FLUSH))&&(this.options.to==="string"?(u=ih.utf8border(t.output,t.next_out),f=t.next_out-u,m=ih.buf2string(t.output,u),t.next_out=f,t.avail_out=l-f,f&&Iu.arraySet(t.output,t.output,u,f,0),this.onData(m)):this.onData(Iu.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(d=!0)}while((t.avail_in>0||t.avail_out===0)&&a!==hn.Z_STREAM_END);return a===hn.Z_STREAM_END&&(s=hn.Z_FINISH),s===hn.Z_FINISH?(a=yc.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===hn.Z_OK):(s===hn.Z_SYNC_FLUSH&&(this.onEnd(hn.Z_OK),t.avail_out=0),!0)};$s.prototype.onData=function(e){this.chunks.push(e)};$s.prototype.onEnd=function(e){e===hn.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Iu.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function xm(e,n){var t=new $s(n);if(t.push(e,!0),t.err)throw t.msg||wm[t.err];return t.result}function mx(e,n){return n=n||{},n.raw=!0,xm(e,n)}Tu.Inflate=$s;Tu.inflate=xm;Tu.inflateRaw=mx;Tu.ungzip=xm});var fy=fn((x4,uy)=>{var import_plugin=Le(Be());"use strict";var gx=da().assign,px=dv(),vx=sy(),yx=bm(),cy={};gx(cy,px,vx,yx);uy.exports=cy});function kc(e){$("#luckysheet-cell-loading").find("span").text(e).end().show()}function Ru(){$("#luckysheet-cell-loading").hide()}var import_plugin,_m=Tt(()=>{import_plugin=Le(Be())});var import_plugin,kx,pt,br=Tt(()=>{import_plugin=Le(Be());sc();ir();mr();fr();ql();Ut();kx={deepCopyFlowDataState:!1,deepCopyFlowDataCache:"",deepCopyFlowDataWorker:null,deepCopyFlowData:function(e){let n=this;return n.deepCopyFlowDataState?(n.deepCopyFlowDataWorker!=null&&n.deepCopyFlowDataWorker.terminate(),n.deepCopyFlowDataCache):(e==null&&(e=h.flowdata),$.extend(!0,[],e))},webWorkerFlowDataCache:function(e){let n=this;try{n.deepCopyFlowDataWorker!=null&&n.deepCopyFlowDataWorker.terminate();let t="data:text/javascript;chartset=US-ASCII,onmessage = function (e) { postMessage(e.data); };";n.deepCopyFlowDataState=!1;let l;if(Ni.isIE()==1){let o="self.onmessage=function(e){postMessage(e.data);}";l=new Worker("./plugins/Worker-helper.js"),l.postMessage(o)}else l=new Worker(t);n.deepCopyFlowDataWorker=l,l.postMessage(e),l.onmessage=function(o){n.deepCopyFlowDataCache=o.data,n.deepCopyFlowDataState=!0}}catch(t){n.deepCopyFlowDataCache=$.extend(!0,[],e)}},controlHandler:function(e,n){let l=this.deepCopyFlowData(h.flowdata),o=n||h.luckysheet_select_save[h.luckysheet_select_save.length-1],a=o.row==null?0:o.row[0],s=o.column==null?0:o.column[0],u=e.length,f=e[0].length,m=a+u-l.length,d=s+f-l[0].length;(m>0||d>0)&&(l=Hr([].concat(l),m,d,!0));for(let g=0;g<u;g++){let b=[].concat(l[g+a]);for(let y=0;y<f;y++){let p="";e[g]!=null&&e[g][y]!=null&&(p=e[g][y]),b[y+s]=p}l[g+a]=b}m>0||d>0?fi(l[0].length,l.length,l,null,h.luckysheet_select_save,"datachangeAll"):bc(l,h.luckysheet_select_save)},clearRangeByindex:function(e,n,t,l,o){let a=$e(o),s=$.extend(!0,[],h.luckysheetfile[a].data);for(let u=e;u<=n;u++){let f=[].concat(s[u]);for(let m=t;m<=l;m++)v.delFunctionGroup(u,m),v.execFunctionGroup(u,m,""),f[m]=null;s[u]=f}if(o==h.currentSheetIndex){let u=n-e+1,f=l-t+1;u>5e3?Gt(s,[{row:[e,n],column:[t,l]}]):bc(s,{row:[e,n],column:[t,l]})}else h.luckysheetfile[a].data=s},controlHandlerD:function(e){let t=this.deepCopyFlowData(h.flowdata),l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],o=l.row[0],a=l.row[1],s=l.column[0],u=l.column[1],f=e.length,m=e[0].length,d=o+f-t.length,g=s+m-t[0].length;(d>0||g>0)&&(t=Hr([].concat(t),d,g,!0));for(let y=o;y<=a;y++)for(let p=s;p<=u;p++)t[y][p]=null;for(let y=0;y<f;y++)for(let p=0;p<m;p++)t[o+y][s+p]=e[y][p];let b=[{row:[o,a],column:[s,u]},{row:[o,o+f-1],column:[s,s+m-1]}];Gt(t,b)}},pt=kx});function Fu(e){let n={};if(V(e)=="array")for(let t=0;t<e.length;t++){let l=e[t].r,o=e[t].c,a=e[t].f;if(h.flowdata[l][o]!=null&&h.flowdata[l][o].f!=null&&h.flowdata[l][o].f==a){l+"_"+o in n&&(n=bx(n,l,o));let s=e[t].data,u=s.length,f=1;if(V(s[0])=="array"&&(f=s[0].length),wx({row:[l,l+u-1],column:[o,o+f-1]},h.flowdata))for(let m=0;m<u;m++)for(let d=0;d<f;d++){let g=l+m,b=o+d;V(s[0])=="array"?n[g+"_"+b]={v:s[m][d],r:l,c:o}:n[g+"_"+b]={v:s[m],r:l,c:o}}else n[l+"_"+o]={v:"#SPILL!",r:l,c:o}}}return n}function bx(e,n,t){let l=e[n+"_"+t].r,o=e[n+"_"+t].c;for(let a in e)a==l+"_"+o?e[a].v="#SPILL!":e[a].r==l&&e[a].c==o&&delete e[a];return e}function wx(e,n){let t=e.row[0],l=e.row[1],o=e.column[0],a=e.column[1],s=!0;for(let u=t;u<=l;u++)for(let f=o;f<=a;f++)if(!(u==t&&f==o)&&n[u][f]!=null&&n[u][f].v!=null&&n[u][f].v.toString()!=""){s=!1;break}return s}function hy(e,n){let t=h.luckysheetfile[$e(h.currentSheetIndex)].dynamicArray==null?[]:h.luckysheetfile[$e(h.currentSheetIndex)].dynamicArray,l=Fu(t);if(e+"_"+n in l&&l[e+"_"+n].v!="#SPILL!"){let o=l[e+"_"+n].r,a=l[e+"_"+n].c,s=h.flowdata[o][a].f,u,f;for(let x=0;x<t.length;x++)t[x].f==s&&(u=t[x].data.length,V(t[x].data[0])=="array"?f=t[x].data[0].length:f=1);let m=o+u-1,d=a+f-1,g=h.visibledatarow[m],b=o-1==-1?0:h.visibledatarow[o-1],y=h.visibledatacolumn[d],p=a-1==-1?0:h.visibledatacolumn[a-1];$("#luckysheet-dynamicArray-hightShow").css({left:p,width:y-p-1,top:b,height:g-b-1,display:"block"})}else $("#luckysheet-dynamicArray-hightShow").hide()}var import_plugin,oh=Tt(()=>{import_plugin=Le(Be());gl();ql();Ut()});function to(e){let n;if(document.createRange)if(e.innerHTML!=e.innerText||e.innerHTML=="")e.focus(),n=window.getSelection(),n.selectAllChildren(e),n.collapseToEnd();else{let t=e.innerText.length;n=document.createRange(),n.selectNodeContents(e),n.setStart(e.childNodes[0],t),n.collapse(!0);let l=window.getSelection();l.removeAllRanges(),l.addRange(n)}else document.selection&&(n=document.body.createTextRange(),n.moveToElementText(e),n.collapse(!1),n.select())}function lo(e){e.target.classList&&(e.target.classList.contains("luckysheet-cols-rows-shift-left")||e.target.classList.contains("luckysheet-cols-rows-shift-right"))||!$(e.target).hasClass("luckysheet-mousedown-cancel")&&$(e.target).filter("[class*='sp-palette']").length==0&&$(e.target).filter("[class*='sp-thumb']").length==0&&$(e.target).filter("[class*='sp-']").length==0&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide(),h.luckysheet_cols_menu_status=!1)}function dy(e){if(window.getSelection){let n=document.createRange();n.selectNodeContents(e),n.startContainer&&ah(n.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(n))}else if(document.selection){let n=document.body.createTextRange();n.moveToElementText(e),n.select()}}function my(e){if(window.getSelection){let t=document.createRange();var n=e.firstChild;t.setStart(n,0),t.setEnd(n,n.length),t.startContainer&&ah(t.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(t))}else if(document.selection){let t=document.body.createTextRange();t.moveToElementText(e),t.select()}}function gy(e,n){if(window.getSelection){let o=document.createRange();var t=e.firstChild,l=n.firstChild;o.setStart(t,0),o.setEnd(l,l.length),o.startContainer&&ah(o.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(o))}}function py(e,n){if(window.getSelection){let l=document.createRange();var t=e.firstChild;n>t.length?n=t.length:n<0&&(n=0),l.setStart(t,n),l.collapse(!0),l.startContainer&&ah(l.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(l))}}function ah(e){return e===document.body?!1:document.body.contains(e)}var import_plugin,pa=Tt(()=>{import_plugin=Le(Be());Ut()});function wn(e){return e&&e.ct!=null&&e.ct.t=="inlineStr"&&e.ct.s!=null&&e.ct.s.length>0}function wc(e){return e!=null&&e.t=="inlineStr"&&e.s!=null&&e.s.length>0}function ky(e,n,t,l){var o=window.getSelection(),a;o.type=="None"?a=h.inlineStringEditRange:a=o.getRangeAt(0);let s=a.commonAncestorContainer,u;s.id=="luckysheet-rich-text-editor"?u=$(s):u=$(s).closest("#luckysheet-rich-text-editor");let f=$(s).closest("#luckysheet-functionbox-cell");if(u.length==0&&f.length==0&&h.inlineStringEditRange!=null&&(a=h.inlineStringEditRange,s=a.commonAncestorContainer,s.id=="luckysheet-rich-text-editor"?u=$(s):u=$(s).closest("#luckysheet-rich-text-editor"),f=$(s).closest("#luckysheet-functionbox-cell")),a.collapsed===!0)return;let m=a.endContainer,d=a.startContainer,g=a.endOffset,b=a.startOffset;if(u.length>0){if(d===m){let y=d.parentNode,p,x=!1,_=y.innerText;u.html().substr(0,5)!="<span"&&(x=!0);let I="",O="",F="",D=0,k=b,w=g,C=_.length;I=_.substring(D,k),O=_.substring(k,w),F=_.substring(w,C);let T="";if(I!=""){let A=y.style.cssText;if(x){let M=$(y).closest("#luckysheet-input-box").get(0);M!=null&&(A=$m(M.style.cssText,A))}T+="<span style='"+A+"'>"+I+"</span>"}if(O!=""){let A=sh(y.style.cssText,n,t);if(x){let M=$(y).closest("#luckysheet-input-box").get(0);M!=null&&(A=$m(M.style.cssText,A))}T+="<span style='"+A+"'>"+O+"</span>"}if(F!=""){let A=y.style.cssText;if(x){let M=$(y).closest("#luckysheet-input-box").get(0);M!=null&&(A=$m(M.style.cssText,A))}T+="<span style='"+A+"'>"+F+"</span>"}d.parentNode.tagName=="SPAN"?(p=u.find("span").index(y),$(y).replaceWith(T)):(p=0,$(y).html(T));let z=0;D==k?z=p:z=p+1,my(u.find("span").get(z))}else if(d.parentNode.tagName=="SPAN"&&m.parentNode.tagName=="SPAN"){let y=d.parentNode,p,x=m.parentNode,_;p=u.find("span").index(y),_=u.find("span").index(x);let S=y.innerHTML,I=x.innerHTML,O="",F="",D="",k="",w=0,C=b,T=g,z=I.length;O=S.substring(w,C),F=S.substring(C,S.length),D=I.substring(0,T),k=I.substring(T,z);let A=u.find("span"),M=A.slice(p,_+1),P="";for(let B=0;B<p;B++){let U=A.get(B),X=U.innerHTML;P+="<span style='"+U.style.cssText+"'>"+X+"</span>"}if(O!=""&&(P+="<span style='"+y.style.cssText+"'>"+O+"</span>"),F!=""){let B=sh(y.style.cssText,n,t);P+="<span style='"+B+"'>"+F+"</span>"}if(p<_)for(let B=p+1;B<_;B++){let U=A.get(B),X=U.innerHTML,le=sh(U.style.cssText,n,t);P+="<span style='"+le+"'>"+X+"</span>"}if(D!=""){let B=sh(x.style.cssText,n,t);P+="<span style='"+B+"'>"+D+"</span>"}k!=""&&(P+="<span style='"+x.style.cssText+"'>"+k+"</span>");for(let B=_+1;B<A.length;B++){let U=A.get(B),X=U.innerHTML;P+="<span style='"+U.style.cssText+"'>"+X+"</span>"}u.html(P);let N,E;w==C?(N=p,E=_):(N=p+1,E=_+1),A=u.find("span"),gy(A.get(N),A.get(E))}}else f.length>0}function by(e){var n=window.getSelection();if(n.type=="None")return;var t=n.getRangeAt(0);let l=t.commonAncestorContainer,o;l.id=="luckysheet-rich-text-editor"?o=$(l):o=$(l).closest("#luckysheet-rich-text-editor");let a=$(l).closest("#luckysheet-functionbox-cell"),s=t.endContainer,u=t.startContainer,f=t.endOffset,m=t.startOffset;if(o.length>0){let d=u.parentNode;u.id=="luckysheet-rich-text-editor"&&(d=$(u).find("span"),d.length==0&&(u.innerHTML=`<span>${u.innerText}</span>`,d=$(u).find("span")),d=d.get(d.length-1),m=d.innerHTML.length),t.collapsed===!1&&t.deleteContents();let g=d.innerText,b="",y="",p=0,x=m;b=g.substring(p,x),y=g.substring(x,g.length);let _,S;if(u.parentNode.tagName=="SPAN"){let I=o.find("span");if(_=I.index(d),_==I.length-1&&y==""){let O=I[_].innerHTML;O.substr(O.length-1,1)==`
`?S="<span style='"+d.style.cssText+"'>"+b+`
</span>`:S="<span style='"+d.style.cssText+"'>"+b+`

</span>`}else S="<span style='"+d.style.cssText+"'>"+b+`
`+y+"</span>";$(d).replaceWith(S)}else{let I=d.style.cssText;if(y==""?S="<span style='"+I+"'>"+b+`

</span>`:S="<span style='"+I+"'>"+b+`
`+y+"</span>",u.id=="luckysheet-rich-text-editor"){$(d).replaceWith(S);let O=o.find("span");_=O.length-1,m=O.get(_).innerHTML.length-1}else $(d).html(S),_=0}py(o.find("span").get(_),m+1)}else a.length>0}function wy(e,n,t){if(e.ct==null)return;let l=e.ct.s;if(l!=null)for(let o=0;o<l.length;o++){let a=l[o];a[n]=t}}function xy(e){let n=[],t,l=null;for(let o=0;o<e.length;o++){let a=e.get(o),s=Cm(a.style.cssText),u=JSON.stringify(s),f=a.innerText;f=f.replace(/\n/g,`\r
`),u==l?t.v+=f:(s.v=f,n.push(s),l=u,t=s)}return n}function Cm(e){if(e==null||e.length==0)return{};let n=e.split(";"),t=Oe(),l=t.fontarray,o=t.fontjson,a={ff:l[0],fc:"#000000",fs:10,cl:0,un:0,bl:0,it:0};return n.forEach(s=>{s=s.toLowerCase();let u=Yn(s.substr(0,s.indexOf(":"))),f=Yn(s.substr(s.indexOf(":")+1));if(u=="font-weight"&&(f=="bold"?a.bl=1:a.bl=0),u=="font-style"&&(f=="italic"?a.it=1:a.it=0),u=="font-family"){let m=o[f];m==null?a.ff=f:a.ff=m}u=="font-size"&&(a.fs=parseInt(f)),u=="color"&&(a.fc=f),u=="text-decoration"&&(a.cl=1),u=="border-bottom"&&(a.un=1),u=="lucky-strike"&&(a.cl=f),u=="lucky-underline"&&(a.un=f)}),a}function Cy(e,n){let t=e.split(";");if(n==null||n.length==0)return e;if(e.indexOf(n)>-1)for(let l=0;l<t.length;l++){let o=t[l];o=o.toLowerCase();let a=Yn(o.substr(0,o.indexOf(":"))),s=Yn(o.substr(o.indexOf(":")+1));if(a==n)return s}return""}function xx(e,n,t){let l=e.split(";"),o="";if(n==null||n.length==0)return e;if(e.indexOf(n)>-1)for(let a=0;a<l.length;a++){let s=l[a];s=s.toLowerCase();let u=Yn(s.substr(0,s.indexOf(":"))),f=Yn(s.substr(s.indexOf(":")+1));u==n?o+=u+":"+t+";":u.length>0&&(o+=u+":"+f+";")}else n.length>0&&(e+=n+":"+t+";",o=e);return o}function _x(e,n){let t=e.split(";"),l="",o=n;if(n==null||n.length==0)return e;if(n in _y&&(n=_y[n]),e.indexOf(n)>-1)for(let a=0;a<t.length;a++){let s=t[a];s=s.toLowerCase();let u=Yn(s.substr(0,s.indexOf(":"))),f=Yn(s.substr(s.indexOf(":")+1));u==n||o=="cl"&&u=="lucky-strike"||o=="un"&&u=="lucky-underline"||u.length>0&&(l+=u+":"+f+";")}else l=e;return l}function sh(e,n,t){let l={};if(l[n]=t,n=="un"){let u=Cy(e,"color");u==""&&(u="#000000");let f=Cy(e,"font-size");f==""&&(f=11),f=parseInt(f),l._fontSize=f,l._color=u}let o=Mu(l,void 0,void 0,!1),a=Yn(o.substr(0,o.indexOf(":"))),s=Yn(o.substr(o.indexOf(":")+1));return s=s.substr(0,s.length-1),e=_x(e,n),e=xx(e,a,s),e}function $m(e,n,t=!0){let l=e.split(";"),o=n.split(";"),a="",s={};for(let u=0;u<l.length;u++){let f=l[u],m=!0;f=f.toLowerCase();let d=Yn(f.substr(0,f.indexOf(":")));if(d=="font-size")continue;let g=Yn(f.substr(f.indexOf(":")+1));if(!(t&&!(d in yy))){for(let b=0;b<o.length;b++){let y=o[b];y=y.toLowerCase();let p=Yn(y.substr(0,y.indexOf(":"))),x=Yn(y.substr(y.indexOf(":")+1));if(d==p){a+=p+":"+x+";",m=!1;continue}}m&&(a+=d+":"+g+";"),s[d]=1}}for(let u=0;u<o.length;u++){let f=o[u];f=f.toLowerCase();let m=Yn(f.substr(0,f.indexOf(":"))),d=Yn(f.substr(f.indexOf(":")+1));t&&!(m in yy)||m in s||(a+=m+":"+d+";")}return a}var import_plugin,vy,yy,_y,va=Tt(()=>{import_plugin=Le(Be());mr();pa();Rl();Ut();vy={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1},yy={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1};_y={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",cl:"text-decoration",un:"border-bottom"}});function Xl(e,n){if(e==null&&(e=h.luckysheet_select_save[0]),e.row==null||e.row.length==0)return[];let t,l;n!=null&&n!=h.currentSheetIndex?(t=h.luckysheetfile[$e(n)].data,l=h.luckysheetfile[$e(n)].config):(t=pt.deepCopyFlowData(h.flowdata),l=h.config);let o=[];for(let a=e.row[0];a<=e.row[1];a++){if(t[a]==null||l.rowhidden!=null&&l.rowhidden[a]!=null)continue;let s=[];for(let u=e.column[0];u<=e.column[1];u++)s.push(t[a][u]);o.push(s)}return o}function Du(e,n){if(n==null||n.row==null||n.row.length==0)return[];let t=Fu(h.luckysheetfile[$e(h.currentSheetIndex)].dynamicArray),l=[];if(e==null)return l;for(let o=n.row[0];o<=n.row[1];o++){if(e[o]==null)continue;let a=[];for(let s=n.column[0];s<=n.column[1];s++){let u;o+"_"+s in t?u=t[o+"_"+s]:u=e[o][s],a.push(u)}l.push(a)}return l}function $y(e){if(e==null||e.row==null||e.row.length==0)return[];let n=[];for(let t=e.row[0];t<=e.row[1];t++){let l=[];if(!(h.config.rowhidden!=null&&h.config.rowhidden[t]!=null)){for(let o=e.column[0];o<=e.column[1];o++){let a="";h.flowdata[t]!=null&&h.flowdata[t][o]!=null&&(a=h.flowdata[t][o]),l.push(a)}n.push(l)}}return n}function Mt(e,n,t,l){l==null&&(l="v"),t==null&&(t=h.flowdata);let o;if(e!=null&&n!=null)o=t[e][n];else if(e!=null)o=t[e];else if(n!=null)o=t[0].map(function(u,f){return t.map(function(m){return m[f]})})[n];else return t;let a=o;return V(o)=="object"&&(a=o[l],l=="f"&&a!=null?a=v.functionHTMLGenerate(a):l=="f"?a=o.v:o&&o.ct&&o.ct.t=="d"&&(a=o.m)),a==null&&(a=null),a}function Hr(e,n,t,l){if(n<=0&&t<=0)return e;n<=0&&(n=0),t<=0&&(t=0);let o=0;e.length==0?(e=[],o=0):o=e[0].length;let a=[];for(let u=0;u<t;u++)a.push(null);let s=[];for(let u=0;u<o+t;u++)s.push(null);for(let u=0;u<e.length;u++)e[u]=[].concat(e[u].concat(a));for(let u=0;u<n;u++)e.push([].concat(s));return l&&(He.saveParam("all",h.currentSheetIndex,e.length,{k:"row"}),He.saveParam("all",h.currentSheetIndex,e[0].length,{k:"column"})),e}function Jn(e,n,t,l){let o;return l!=null?o=l[e][n]:o=Cx(e,n,t),o==null?null:o.f}function Cx(e,n,t){if(e==null||n==null)return;let l;if(t==null?l=h.flowdata:l=ct.getSheetByIndex(t).data,!(!l||!l[e]||!l[e][n]))return l[e][n]}function Sm(e,n){let t=Mt(e,n,null,"m");if(t==null&&(t=Mt(e,n),t==null)){let l=Mt(e,n,null,"ct");wc(l)&&(t=l.s)}return t}function Sy(e,n){let t=Mt(e,n,null,"ct");if(wc(t)){let l=t.s,o="";for(let a=0;a<l.length;a++){let s=l[a];s.v!=null&&(o+=s.v)}return o}return""}function Iy(e,n,t){let l=Mt(e,n,t,"ct");t==null&&(t=h.flowdata);let o=t[e][n];if(wc(l)){let a=l.s,s="";for(let u=0;u<a.length;u++){let f=a[u];if(f.v!=null){let m=Mu(f);s+="<span index='"+u+"' style='"+m+"'>"+f.v+"</span>"}}return s}return""}function Mu(e,n,t,l=!0){if(e==null)return;let o="",s=Oe().fontarray;for(let u in e){let f=e[u];if(l&&(f=ro(e,u)),u=="bl"&&f!="0"&&(o+="font-weight: bold;"),u=="it"&&f!="0"&&(o+="font-style:italic;"),u=="ff"){let m=f;isNaN(parseInt(f))?m=f:m=s[parseInt(f)],o+="font-family: "+m+";"}u=="fs"&&f!="10"&&(o+="font-size: "+f+"pt;"),(u=="fc"&&f!="#000000"||n!=null||t!=null&&t.textColor!=null)&&(t!=null&&t.textColor!=null?o+="color: "+t.textColor+";":n!=null?o+="color: "+n[0]+";":o+="color: "+f+";"),u=="cl"&&f!="0"&&(o+="text-decoration: line-through;")}return o}function ro(e,n){let t=e;return n in{bl:1,it:1,ff:1,cl:1,un:1}||n=="fs"&&wn(e)?t==null?t="0":(t=t[n],t==null&&(t="0")):n=="fc"?t==null?t="#000000":(t=t[n],t==null&&(t="#000000"),t.indexOf("rgba")>-1&&(t=Ua(t))):n=="bg"?t==null?t=null:(t=t[n],t==null?t=null:t.toString().indexOf("rgba")>-1&&(t=Ua(t))):n.substr(0,2)=="bs"?t==null?t="none":(t=t[n],t==null&&(t="none")):n.substr(0,2)=="bc"?t==null?t="#000000":(t=t[n],t==null&&(t="#000000")):n=="ht"?(t==null?t="1":(t=t[n],t==null&&(t="1")),["0","1","2"].indexOf(t.toString())==-1&&(t="1")):n=="vt"?(t==null?t="0":(t=t[n],t==null&&(t="0")),["0","1","2"].indexOf(t.toString())==-1&&(t="0")):n=="ct"?t==null?t=null:(t=t[n],t==null&&(t=null)):n=="fs"?t==null?t="10":(t=t[n],t==null&&(t="10")):n=="tb"||n=="tr"?t==null?t="0":(t=t[n],t==null&&(t="0")):n=="rt"&&(t==null?t=null:(t=t[n],t==null&&(t=null))),t}function Yn(e){return e==null||e.length==0?e:e.replace(/^\s+|\s+$/gm,"")}var import_plugin,mr=Tt(()=>{import_plugin=Le(Be());gl();ql();wr();ir();br();oh();Yr();va();Rl();Ut()});function $x(e,n){let t=0,l=e.length-1;for(;t<=l;){let o=parseInt((l+t)/2);if(n<e[o]&&(o==0||n>=e[o-1]))return o;if(n>=e[o])t=o+1;else if(n<e[o])l=o-1;else return-1}}function Sx(e,n){let t=0,l=0,o=0,a=-1,s=e.length-1;for(;t<e.length&&s>=0&&s>=t;){if(l=e[s],s==0?o=0:o=e[s-1],n>=o&&n<l){a=s;break}if(l=e[t],t==0?o=0:o=e[t-1],n>=o&&n<l){a=t;break}t++,s--}return a}function al(e,n){let t=e.length-1;return e.length<40||n<=e[20]||n>=e[t-20]?t=Sx(e,n):t=$x(e,n),t}var import_plugin,xo=Tt(()=>{import_plugin=Le(Be())});function $r(e){let n=0,t=0;return n=h.visibledatarow[e],e==0?t=0:t=h.visibledatarow[e-1],[t,n,e]}function zl(e){let n=al(h.visibledatarow,e);return n==-1&&e>0?n=h.visibledatarow.length-1:n==-1&&e<=0&&(n=0),$r(n)}function Vl(e){let n=0,t=0;return n=h.visibledatacolumn[e],e==0?t=0:t=h.visibledatacolumn[e-1],[t,n,e]}function Ty(e,n){let t=0,l=0;return t=h.visibledatacolumn[e+n-1],e==0?l=0:l=h.visibledatacolumn[e-1],[l,t,e]}function Ml(e){let n=al(h.visibledatacolumn,e);return n==-1&&e>0?n=h.visibledatacolumn.length-1:n==-1&&e<=0&&(n=0),Vl(n)}function ll(e,n){let t=$("#"+h.container).offset(),l=e-t.left-h.rowHeaderWidth,o=n-t.top-h.infobarHeight-h.toolbarHeight-h.calculatebarHeight-h.columnHeaderHeight;return[l,o]}var import_plugin,Qn=Tt(()=>{import_plugin=Le(Be());xo();Ut()});function tn(e,n,t,l){let o=$.extend(!0,{},l);o.rowlen==null&&(o.rowlen={}),o.customHeight==null&&(o.customHeight={});let a=$("#luckysheetTableContent").get(0).getContext("2d");a.textBaseline="top";for(let s=n;s<=t;s++){if(o.rowhidden!=null&&o.rowhidden[s]!=null)continue;let u=h.defaultrowlen;if(o.customHeight[s]!=1){delete o.rowlen[s];for(let f=0;f<e[s].length;f++){let m=e[s][f];if(m!=null&&m!=null&&(m.v!=null||wn(m))){let d;if(m.mc)if(f===m.mc.c){let y=Vl(f)[0];d=Vl(m.mc.c+m.mc.cs-1)[1]-y-2}else continue;else d=Vl(f)[1]-Vl(f)[0]-2;let g=no(m,a,{r:s,c:f,cellWidth:d}),b=0;g!=null&&(b=g.textHeightAll+2),b>u&&(u=b)}}u=u/h.zoomRatio,u!=h.defaultrowlen?o.rowlen[s]=u:l.rowlen?.[s]&&(o.rowlen[s]=l.rowlen[s])}}return o}function Ry(e,n){let t=0,l=$("#luckysheetTableContent").get(0).getContext("2d");l.textBaseline="top";for(let o=0;o<e[n].length;o++){let a=e[n][o];if(a!=null&&!(a.mc!=null&&a.mc.rs!==1)&&!(h.config.colhidden!=null&&h.config.colhidden[o]!=null)&&a!=null&&(a.v!=null||wn(a))){let s=Ix(a,o),u=no(a,l,{r:n,c:o,cellWidth:s}),f=0;u!=null&&(f=u.textHeightAll+2),f>t&&(t=f)}}return t}function Ix(e,n){let t=Vl(n);return e.mc&&e.mc.cs!==1&&(t=Ty(n,e.mc.cs)),t[1]-t[0]-2}function Fy(e,n,t){let l=0,o=ch(t,n),a=$("#luckysheetTableContent").get(0).getContext("2d");a.textBaseline="top";for(var s=0;s<e.length;s++){var u=e[s][n];if(u!=null&&(u.v!=null||wn(u))){let f=o[n],m=no(u,a,{r:s,c:n,cellHeight:f}),d=0;m!=null&&(d=m.textWidthAll+2),d>l&&(l=d)}}return l}function ch(e,n){let t=[],l=0;for(let o=0;o<e;o++){let a=h.defaultrowlen;if(n.rowlen!=null&&n.rowlen[o]!=null&&(a=n.rowlen[o]),n.rowhidden!=null&&n.rowhidden[o]!=null){a=n.rowhidden[o],t.push(l);continue}else l+=a+1;t.push(l)}return t}function _o(e,n,t){let l=h.measureTextCache[e+"_"+n.font];if(t!=null&&(l=h.measureTextCache[e+"_"+t]),l!=null)return l;{if(t!=null){let s=n.font;n.font=t}let o=n.measureText(e),a={};if(a.width=o.width,t!=null&&(n.font=t),a.actualBoundingBoxDescent=o.actualBoundingBoxDescent,a.actualBoundingBoxAscent=o.actualBoundingBoxAscent,a.actualBoundingBoxDescent==null||a.actualBoundingBoxAscent==null||isNaN(a.actualBoundingBoxDescent)||isNaN(a.actualBoundingBoxAscent)){let s="M";Oa(e)&&(s="\u7530");let u=ht.getTextSize(s,n.font)[1]*.8;n.textBaseline=="top"?(a.actualBoundingBoxDescent=u,a.actualBoundingBoxAscent=0):n.textBaseline=="middle"?(a.actualBoundingBoxDescent=u/2,a.actualBoundingBoxAscent=u/2):(a.actualBoundingBoxDescent=0,a.actualBoundingBoxAscent=u)}if(n.textBaseline=="alphabetic"){let s="gjpqy",u="abcdABCD",f=h.measureTextCache[s+"_"+n.font];t!=null&&(f=h.measureTextCache[s+"_"+t]);let m=h.measureTextCache[u+"_"+n.font];t!=null&&(m=h.measureTextCache[u+"_"+t]),f==null&&(f=n.measureText(s)),m==null&&(m=n.measureText(u)),a.actualBoundingBoxDescent<=m.actualBoundingBoxDescent&&(a.actualBoundingBoxDescent=f.actualBoundingBoxDescent,a.actualBoundingBoxDescent==null&&(a.actualBoundingBoxDescent=0))}return a.width*=h.zoomRatio,a.actualBoundingBoxDescent*=h.zoomRatio,a.actualBoundingBoxAscent*=h.zoomRatio,h.measureTextCache[e+"_"+h.zoomRatio+"_"+n.font]=a,a}}function Tx(e){return e.measureText("\u7530").actualBoundingBoxAscent!=null}function no(e,n,t){let l=t.cellWidth,o=t.cellHeight,a="",s="";l==null&&(a="onlyWidth",s="_");let u=h.measureTextCellInfoCache[t.r+"_"+t.c+s+a];if(u!=null)return u;let f=t.space_width,m=t.space_height;f==null&&(f=2),m==null&&(m=2);let d=ro(e,"ht"),g=ro(e,"vt"),b=ro(e,"tb"),y=ro(e,"tr"),p=ro(e,"rt"),x=1,_=0;p==null&&(y=="0"?p=0:y=="1"?p=45:y=="4"?p=90:y=="2"?p=135:y=="5"&&(p=180),p==null&&(p=0)),(p>180||p<0)&&(p=0),p=parseInt(p),p>90&&(p=90-p,x=0,_=1),n.textAlign="start";let S={};S.values=[];let I,O="0",F="0",D=11,k=!1,w,C=[];if(wn(e)){let T=e.ct.s,z=0;for(let A=0;A<T.length;A++){let M=T[A],P=Ss(M),N=M.fc,E=M.cl,B=M.un,U=M.v,X=M.fs;U=U.replace(/\r\n/g,"_x000D_").replace(/&#13;&#10;/g,"_x000D_").replace(/\r/g,"_x000D_").replace(/\n/g,"_x000D_");let le=U.split("_x000D_");for(let he=0;he<le.length;he++){let Z=le[he];if(Z==""&&he!=le.length-1)C.push({fontset:P,fc:N??"#000",cl:E??0,un:B??0,wrap:!0,fs:X??11}),z++;else{let ae=Z.split("");for(let J=0;J<ae.length;J++){let pe=ae[J];C.push({fontset:P,fc:N??"#000",cl:E??0,un:B??0,v:pe,si:z,fs:X??11})}he!=le.length-1&&(C.push({fontset:P,fc:N??"#000",cl:E??0,un:B??0,wrap:!0,fs:X??11}),z++)}}z++}k=!0}else if(I=Ss(e),n.font=I,O=ro(e,"cl"),F=ro(e,"un"),D=ro(e,"fs"),e instanceof Object?(w=e.m,w==null&&(w=e.v)):w=e,rt(w))return null;if(y=="3"){n.textBaseline="top";let T=0,z=0,A=0,M=0,P={},N=[];if(k){let U=null;for(let X=0;X<C.length;X++){let le=C[X],he=le.v,Z=le.v;if(le.wrap===!0&&(he="M",Z="",U!=null&&U.wrap!==!0&&X<C.length-1)){N.push(M),M=0,A+=1,U=le;continue}let ae=_o(he,n,le.fontset),J=ae.width+f,pe=ae.actualBoundingBoxAscent+ae.actualBoundingBoxDescent+m;M+=pe,b=="2"&&!le.wrap&&M>o&&P[A]!=null&&(N.push(M-pe),M=pe,A+=1),X==C.length-1&&N.push(M),P[A]==null&&(P[A]=[]);let K={content:Z,style:le,width:J,height:pe,left:0,top:0,colIndex:A,asc:ae.actualBoundingBoxAscent,desc:ae.actualBoundingBoxDescent,inline:!0};le.wrap===!0&&(K.wrap=!0),P[A].push(K),console.log("normal",X,A,le,U,P),U=le}}else{let U=_o(w,n),X=U.actualBoundingBoxDescent+U.actualBoundingBoxAscent;w=w.toString();let le=[];w.length>1?le=w.split(""):le.push(w);let he=_o(le[0],n).width;for(let Z=0;Z<le.length;Z++){let ae=he+f,J=X+m;M+=J,b=="2"&&M>o&&P[A]!=null&&(N.push(M-J),M=J,A+=1),Z==le.length-1&&N.push(M),P[A]==null&&(P[A]=[]),P[A].push({content:le[Z],style:I,width:ae,height:J,left:0,top:0,colIndex:A,asc:U.actualBoundingBoxAscent,desc:U.actualBoundingBoxDescent})}}let E=[];for(let U=0;U<N.length;U++){let X=N[U],le=P[U],he=0;for(let Z=0;Z<le.length;Z++){let ae=le[Z];he=Math.max(he,ae.width)}E.push(he),T+=he,z=Math.max(z,X)}if(S.type="verticalWrap",S.textWidthAll=T,S.textHeightAll=z,a=="onlyWidth")return S;let B=0;for(let U=0;U<N.length;U++){let X=N[U],le=E[U],he=P[U],Z=0;for(let ae=0;ae<he.length;ae++){let J=he[ae],pe=f+B;d=="0"?pe=l/2+B-T/2+f*N.length:d=="2"&&(pe=l+B-T+f);let K=o-m+Z-X;g=="0"?K=o/2+Z-X/2:g=="1"&&(K=m+Z),Z+=J.height,J.left=pe,J.top=K,Au(J,O,F,{width:le,height:J.height,left:pe,top:K+J.height-m,asc:J.height,desc:0,fs:D}),S.values.push(J)}B+=le}}else{let T=Tx(n);if(T?n.textBaseline="alphabetic":n.textBaseline="bottom",b=="2"||k){let z=0,A=0,M=0,P=0,N=0,E={},B=[];S.rotate=p,p=Math.abs(p);let U=0,X=0,le=0,he,Z,ae,J,pe=1,K={},se=null,te=null;if(k)for(;pe<=C.length;){let be=C.slice(U,pe);if(be[be.length-1].wrap===!0){if(U=pe,be.length>1)for(let De=0;De<be.length-1;De++){let Fe=be[De],Ze={content:Fe.v,style:Fe,width:Fe.measureText.width,height:Fe.measureText.actualBoundingBoxAscent+Fe.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:P,asc:Fe.measureText.actualBoundingBoxAscent,desc:Fe.measureText.actualBoundingBoxDescent,inline:!0,fs:Fe.fs};E[P].push(Ze)}if(be.length==1||pe==C.length){let De=be[0],Fe=_o("M",n,De.fontset);E[P]==null&&(E[P]=[]),E[P].push({content:"",style:De,width:Fe.width,height:Fe.actualBoundingBoxAscent+Fe.actualBoundingBoxDescent,left:0,top:0,splitIndex:P,asc:Fe.actualBoundingBoxAscent,desc:Fe.actualBoundingBoxDescent,inline:!0,wrap:!0,fs:De.fs})}P+=1,pe++;continue}let Q=0,me=0;for(let De=0;De<be.length;De++){let Fe=be[De];Fe.measureText==null&&(Fe.measureText=_o(Fe.v,n,Fe.fontset)),Q+=Fe.measureText.width,me=Math.max(Fe.measureText.actualBoundingBoxAscent+Fe.measureText.actualBoundingBoxDescent)}let xe=Q*Math.cos(p*Math.PI/180)+me*Math.sin(p*Math.PI/180),Te=Q*Math.sin(p*Math.PI/180)+me*Math.cos(p*Math.PI/180),je=be[be.length-1];if((je.v==" "||Ld(je.v)==2)&&(te=pe),p!=0)if(console.log(Te,m,o,be,Te+m>o),Te+m>o&&E[P]!=null&&b=="2"&&pe!=C.length)if(te!=null&&te<pe){for(let De=0;De<te-U;De++){let Fe=be[De];E[P].push({content:Fe.v,style:Fe,width:Fe.measureText.width,height:Fe.measureText.actualBoundingBoxAscent+Fe.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:P,asc:Fe.measureText.actualBoundingBoxAscent,desc:Fe.measureText.actualBoundingBoxDescent,inline:!0,fs:Fe.fs})}U=te,pe=te+1,P+=1,te=null}else{U=pe-1;for(let De=0;De<be.length-1;De++){let Fe=be[De];E[P].push({content:Fe.v,style:Fe,width:Fe.measureText.width,height:Fe.measureText.actualBoundingBoxAscent+Fe.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:P,asc:Fe.measureText.actualBoundingBoxAscent,desc:Fe.measureText.actualBoundingBoxDescent,inline:!0,fs:Fe.fs})}P+=1}else if(pe==C.length){E[P]==null&&(E[P]=[]);for(let De=0;De<be.length;De++){let Fe=be[De];E[P].push({content:Fe.v,style:Fe,width:Fe.measureText.width,height:Fe.measureText.actualBoundingBoxAscent+Fe.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:P,asc:Fe.measureText.actualBoundingBoxAscent,desc:Fe.measureText.actualBoundingBoxDescent,inline:!0,fs:Fe.fs})}break}else E[P]==null&&(E[P]=[]),pe++;else if(xe+f>l&&E[P]!=null&&b=="2"&&pe!=C.length)if(te!=null&&te<pe){for(let De=0;De<te-U;De++){let Fe=be[De];E[P].push({content:Fe.v,style:Fe,width:Fe.measureText.width,height:Fe.measureText.actualBoundingBoxAscent+Fe.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:P,asc:Fe.measureText.actualBoundingBoxAscent,desc:Fe.measureText.actualBoundingBoxDescent,inline:!0,fs:Fe.fs})}U=te,pe=te+1,P+=1,te=null}else{U=pe-1;for(let De=0;De<be.length-1;De++){let Fe=be[De];E[P].push({content:Fe.v,style:Fe,width:Fe.measureText.width,height:Fe.measureText.actualBoundingBoxAscent+Fe.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:P,asc:Fe.measureText.actualBoundingBoxAscent,desc:Fe.measureText.actualBoundingBoxDescent,inline:!0,fs:Fe.fs})}P+=1}else if(pe==C.length){E[P]==null&&(E[P]=[]);for(let De=0;De<be.length;De++){let Fe=be[De];E[P].push({content:Fe.v,style:Fe,width:Fe.measureText.width,height:Fe.measureText.actualBoundingBoxAscent+Fe.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:P,asc:Fe.measureText.actualBoundingBoxAscent,desc:Fe.measureText.actualBoundingBoxDescent,inline:!0,fs:Fe.fs})}break}else E[P]==null&&(E[P]=[]),pe++}else for(w=w.toString();pe<=w.length;){let be=w.substring(U,pe),Q=_o(be,n),me=Q.width,xe=Q.actualBoundingBoxAscent+Q.actualBoundingBoxDescent,Te=me*Math.cos(p*Math.PI/180)+xe*Math.sin(p*Math.PI/180),je=me*Math.sin(p*Math.PI/180)+xe*Math.cos(p*Math.PI/180),De=be.substr(be.length-1,1);if((De==" "||Ld(De)==2)&&J!=null&&(se={index:pe,str:he+De,width:ae,height:Z,asc:J.actualBoundingBoxAscent,desc:J.actualBoundingBoxDescent}),p!=0)if(je+m>o&&E[P]!=null&&pe!=w.length)se!=null&&se.index<pe?(U=se.index,pe=se.index+1,E[P].push({content:se.str,style:I,width:se.width,height:se.height,left:0,top:0,splitIndex:P,asc:se.asc,desc:se.desc,fs:D}),P+=1,se=null):(U=pe-1,E[P].push({content:he,style:I,left:0,top:0,splitIndex:P,height:Z,width:ae,asc:Q.actualBoundingBoxAscent,desc:Q.actualBoundingBoxDescent,fs:D}),P+=1);else if(pe==w.length){E[P]==null&&(E[P]=[]),E[P].push({content:be,style:I,left:0,top:0,splitIndex:P,height:xe,width:me,asc:Q.actualBoundingBoxAscent,desc:Q.actualBoundingBoxDescent,fs:D});break}else E[P]==null&&(E[P]=[]),pe++;else if(Te+f>l&&E[P]!=null&&pe!=w.length)se!=null&&se.index<pe?(U=se.index,pe=se.index+1,E[P].push({content:se.str,style:I,width:se.width,height:se.height,left:0,top:0,splitIndex:P,asc:se.asc,desc:se.desc,fs:D}),P+=1,se=null):(se=null,U=pe-1,E[P].push({content:he,style:I,width:ae,height:Z,left:0,top:0,splitIndex:P,asc:Q.actualBoundingBoxAscent,desc:Q.actualBoundingBoxDescent,fs:D}),P+=1);else if(pe==w.length){E[P]==null&&(E[P]=[]),E[P].push({content:be,style:I,width:me,height:xe,left:0,top:0,splitIndex:P,asc:Q.actualBoundingBoxAscent,desc:Q.actualBoundingBoxDescent,fs:D});break}else E[P]==null&&(E[P]=[]),pe++;he=be,Z=xe,ae=me,J=Q}let re=[],fe=0,Me=Object.keys(E).length;for(let be=0;be<Me;be++){let Q=E[be];if(Q==null)continue;let me=0,xe=0,Te=0,je=0,De=0,Fe=0;for(let Ze=0;Ze<Q.length;Ze++){let Ve=Q[Ze];p!=0,me+=Ve.width,xe=Math.max(xe,Ve.height-(T?Ve.desc:0)),Te=Math.max(Te,T?Ve.desc:0),je=Math.max(je,Ve.asc),Fe++}De=xe/2,fe=Math.max(fe,Fe),p!=0?(xe+=De,M=Math.max(M,me),A+=xe):(xe+=De,z=Math.max(z,me),A+=xe),re.push({width:me,height:xe,desc:Te,asc:je,lineHeight:De,wordCount:Fe})}let ye=0,Ye=0,Ce=p*Math.PI/180,Ke=re[Me-1],ft=Ke.lineHeight;A=A-ft+Ke.desc;let et=A/Math.sin(Ce)+M*Math.cos(Ce),vt=M*Math.sin(Ce),wt=0;if(p!=0?(Me==1?(z=M+2*(A/Math.tan(Ce)),wt=A/Math.tan(Ce)):z=M+A/Math.tan(Ce),S.textWidthAll=et,S.textHeightAll=vt):(S.textWidthAll=z,S.textHeightAll=A),a=="onlyWidth")return S;if(p!=0&&x=="1"){n.textAlign="end";for(let be=0;be<Me;be++){let Q=E[be];if(Q==null)continue;let me=re[be];Ye=0;for(let xe=Q.length-1;xe>=0;xe--){let Te=Q[xe],je,De;if(p!=0){let Fe,Ze=ye+me.asc;if(Fe=ye/Math.tan(Ce)-Ye+M,d=="0"){let Ve=A/Math.sin(Ce);g=="0"?(je=Fe+l/2-z/2+ft*Math.cos(Ce)/2,De=Ze+o/2-A/2-ft*Math.cos(Ce)/2):g=="1"?(je=Fe+l/2-z/2,De=Ze-(A/2-vt/2)):g=="2"&&(je=Fe+l/2-z/2+ft*Math.cos(Ce),De=Ze+o-vt/2-A/2-ft*Math.cos(Ce))}else d=="1"?g=="0"?(je=Fe-vt*Math.sin(Ce)/2+ft*Math.cos(Ce)/2,De=Ze+o/2+vt*Math.cos(Ce)/2-ft*Math.cos(Ce)/2):g=="1"?(je=Fe-vt*Math.sin(Ce),De=Ze+vt*Math.cos(Ce)):g=="2"&&(je=Fe+ft*Math.cos(Ce),De=Ze+o-ft*Math.cos(Ce)):d=="2"&&(g=="0"?(je=Fe+l-et/2-(M/2+A/2/Math.tan(Ce))+ft*Math.cos(Ce)/2,De=Ze+o/2-A/2-ft*Math.cos(Ce)/2):g=="1"?(je=Fe+l-z+wt,De=Ze-A):g=="2"&&(je=Fe+l-et*Math.cos(Ce)+ft*Math.cos(Ce),De=Ze+o-et*Math.sin(Ce)-ft*Math.cos(Ce)))}Te.left=je,Te.top=De,Au(Te,O,F,{width:Te.width,height:Te.height,left:je-Te.width,top:De,asc:me.asc,desc:me.desc,fs:Te.fs}),S.values.push(Te),Ye+=Te.width}ye+=me.height}}else for(let be=0;be<Me;be++){let Q=E[be];if(Q==null)continue;let me=re[be];Ye=0;for(let xe=0;xe<Q.length;xe++){let Te=Q[xe],je,De;if(p!=0){let Fe,Ze=ye+me.asc;if(Fe=(A-ye)/Math.tan(Ce)+Ye,d=="0"){let Ve=A/Math.sin(Ce);g=="0"?(je=Fe+l/2-z/2-ft*Math.cos(Ce)/2,De=Ze+o/2-A/2+ft*Math.cos(Ce)/2):g=="1"?(je=Fe+l/2-z/2-ft*Math.cos(Ce)/2,De=Ze-(A/2-vt/2)+ft*Math.cos(Ce)/2):g=="2"&&(je=Fe+l/2-z/2-ft*Math.cos(Ce),De=Ze+o-vt/2-A/2-ft*Math.cos(Ce))}else d=="1"?g=="0"?(je=Fe-vt*Math.sin(Ce)/2-ft*Math.cos(Ce)/2,De=Ze-A+o/2-vt*Math.cos(Ce)/2-ft*Math.cos(Ce)/2):g=="1"?(je=Fe,De=Ze-A):g=="2"&&(je=Fe-vt*Math.sin(Ce)-ft*Math.cos(Ce),De=Ze-A+o-vt*Math.cos(Ce)-ft*Math.cos(Ce)):d=="2"&&(g=="0"?(je=Fe+l-et/2-z/2-ft*Math.cos(Ce)/2,De=Ze+o/2-A/2-ft*Math.cos(Ce)/2):g=="1"?(je=Fe+l-et*Math.cos(Ce),De=Ze+vt*Math.cos(Ce)):g=="2"&&(je=Fe+l-z-ft*Math.cos(Ce)+wt,De=Ze+o-ft*Math.cos(Ce)));Au(Te,O,F,{width:Te.width,height:Te.height,left:je,top:De,asc:me.asc,desc:me.desc,fs:Te.fs})}else je=f+Ye,d=="0"?je=l/2+Ye-me.width/2:d=="2"&&(je=l+Ye-me.width),De=o-m+ye+me.asc-A,g=="0"?De=o/2+ye-A/2+me.asc:g=="1"&&(De=m+ye+me.asc),Au(Te,O,F,{width:Te.width,height:Te.height,left:je,top:De,asc:me.asc,desc:me.desc,fs:Te.fs});Te.left=je,Te.top=De,S.values.push(Te),Ye+=Te.width}ye+=me.height}S.type="plainWrap",p!=0&&(d=="0"?g=="0"?(S.textLeftAll=l/2,S.textTopAll=o/2):g=="1"?(S.textLeftAll=l/2,S.textTopAll=vt/2):g=="2"&&(S.textLeftAll=l/2,S.textTopAll=o-vt/2):d=="1"?g=="0"?(S.textLeftAll=0,S.textTopAll=o/2):g=="1"?(S.textLeftAll=0,S.textTopAll=0):g=="2"&&(S.textLeftAll=0,S.textTopAll=o):d=="2"&&(g=="0"?(S.textLeftAll=l-et/2,S.textTopAll=o/2):g=="1"?(S.textLeftAll=l,S.textTopAll=0):g=="2"&&(S.textLeftAll=l,S.textTopAll=o)))}else{let z=_o(w,n),A=z.width,M=z.actualBoundingBoxDescent+z.actualBoundingBoxAscent;S.rotate=p,p=Math.abs(p);let P=p*Math.PI/180,N=A*Math.cos(P)+M*Math.sin(P),E=A*Math.sin(P)+M*Math.cos(P);if(p!=0?S.textHeightAll=E:S.textHeightAll=E+M/2-z.actualBoundingBoxDescent-m,S.textWidthAll=N,a=="onlyWidth")return S;let B=N,U=E,X=f+M*Math.sin(P)*x;d=="0"?X=l/2-B/2+M*Math.sin(P)*x:d=="2"&&(X=l-f-B+M*Math.sin(P)*x);let le=o-m-U+z.actualBoundingBoxAscent*Math.cos(P)+A*Math.sin(P)*x;g=="0"?le=o/2-U/2+z.actualBoundingBoxAscent*Math.cos(P)+A*Math.sin(P)*x:g=="1"&&(le=m+z.actualBoundingBoxAscent*Math.cos(P)+A*Math.sin(P)*x),S.type="plain";let he={content:w,style:I,width:B,height:U,left:X,top:le};Au(he,O,F,{width:A,height:M,left:X,top:le,asc:z.actualBoundingBoxAscent,desc:z.actualBoundingBoxDescent,fs:D}),S.values.push(he),S.textLeftAll=X,S.textTopAll=le,S.asc=z.actualBoundingBoxAscent,S.desc=z.actualBoundingBoxDescent}}return S}function Au(e,n,t,l){let o=l.left,a=l.top,s=l.width,u=l.height,f=l.asc,m=l.desc,d=l.fs;if(e.wrap!==!0&&(e.inline==!0&&e.style!=null&&(n=e.style.cl,t=e.style.un),n!="0"&&(e.cancelLine={},e.cancelLine.startX=o,e.cancelLine.startY=a-f/2+1,e.cancelLine.endX=o+s,e.cancelLine.endY=a-f/2+1,e.cancelLine.fs=d),t!="0")){if(e.underLine=[],t=="1"||t=="2"){let g={};g.startX=o,g.startY=a+3,g.endX=o+s,g.endY=a+3,g.fs=d,e.underLine.push(g)}if(t=="2"){let g={};g.startX=o,g.startY=a+m,g.endX=o+s,g.endY=a+m,g.fs=d,e.underLine.push(g)}if(t=="3"||t=="4"){let g={};g.startX=o,g.startY=a+m,g.endX=o+s,g.endY=a+m,g.fs=d,e.underLine.push(g)}if(t=="4"){let g={};g.startX=o,g.startY=a+m+2,g.endX=o+s,g.endY=a+m+2,g.fs=d,e.underLine.push(g)}}}var import_plugin,Hi=Tt(()=>{import_plugin=Le(Be());gl();Mr();mr();Qn();Gl();va();Ut()});function ya(e,n){if(Rx(),e!=null){h.visibledatarow=[],h.rh_height=0;for(let t=0;t<e;t++){let l=h.defaultrowlen;if(h.config.rowlen!=null&&h.config.rowlen[t]!=null&&(l=h.config.rowlen[t]),h.config.rowhidden!=null&&h.config.rowhidden[t]!=null){h.visibledatarow.push(h.rh_height);continue}l==="auto"&&(l=Ry(h.flowdata,t)),h.rh_height+=Math.round((l+1)*h.zoomRatio),h.visibledatarow.push(h.rh_height)}!lt.enableAddRow&&!lt.enableAddBackTop?h.rh_height+=29:h.rh_height+=80}if(n!=null){h.visibledatacolumn=[],h.ch_width=0;let t=120;for(let l=0;l<n;l++){let o=h.defaultcollen;if(h.config.columnlen!=null&&h.config.columnlen[l]!=null?o=h.config.columnlen[l]:h.flowdata[0]!=null&&h.flowdata[0][l]!=null&&(o>300?o=300:o<h.defaultcollen&&(o=h.defaultcollen),o!=h.defaultcollen&&(h.config.columnlen==null&&(h.config.columnlen={}),h.config.columnlen[l]=o)),h.config.colhidden!=null&&h.config.colhidden[l]!=null){h.visibledatacolumn.push(h.ch_width);continue}o==="auto"&&(o=Fy(h.flowdata,l,e)),h.ch_width+=Math.round((o+1)*h.zoomRatio),h.visibledatacolumn.push(h.ch_width)}h.ch_width+=t}}function Rx(){h.rowHeaderWidth=lt.rowHeaderWidth*h.zoomRatio,h.columnHeaderHeight=lt.columnHeaderHeight*h.zoomRatio,$("#luckysheet-rows-h").width(h.rowHeaderWidth-1.5),$("#luckysheet-cols-h-c").height(h.columnHeaderHeight-1.5),$("#luckysheet-left-top").css({width:h.rowHeaderWidth-1.5,height:h.columnHeaderHeight-1.5})}var import_plugin,zu=Tt(()=>{import_plugin=Le(Be());Ut();Hi();bn()});var ka=fn((Im,Tm)=>{var import_plugin=Le(Be());(function(e,n){typeof Im=="object"&&typeof Tm!="undefined"?Tm.exports=n():typeof define=="function"&&define.amd?define(n):e.dayjs=n()})(Im,function(){"use strict";var e="millisecond",n="second",t="minute",l="hour",o="day",a="week",s="month",u="quarter",f="year",m="date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},y=function(w,C,T){var z=String(w);return!z||z.length>=C?w:""+Array(C+1-z.length).join(T)+w},p={s:y,z:function(w){var C=-w.utcOffset(),T=Math.abs(C),z=Math.floor(T/60),A=T%60;return(C<=0?"+":"-")+y(z,2,"0")+":"+y(A,2,"0")},m:function w(C,T){if(C.date()<T.date())return-w(T,C);var z=12*(T.year()-C.year())+(T.month()-C.month()),A=C.clone().add(z,s),M=T-A<0,P=C.clone().add(z+(M?-1:1),s);return+(-(z+(T-A)/(M?A-P:P-A))||0)},a:function(w){return w<0?Math.ceil(w)||0:Math.floor(w)},p:function(w){return{M:s,y:f,w:a,d:o,D:m,h:l,m:t,s:n,ms:e,Q:u}[w]||String(w||"").toLowerCase().replace(/s$/,"")},u:function(w){return w===void 0}},x="en",_={};_[x]=b;var S=function(w){return w instanceof D},I=function(w,C,T){var z;if(!w)return x;if(typeof w=="string")_[w]&&(z=w),C&&(_[w]=C,z=w);else{var A=w.name;_[A]=w,z=A}return!T&&z&&(x=z),z||!T&&x},O=function(w,C){if(S(w))return w.clone();var T=typeof C=="object"?C:{};return T.date=w,T.args=arguments,new D(T)},F=p;F.l=I,F.i=S,F.w=function(w,C){return O(w,{locale:C.$L,utc:C.$u,x:C.$x,$offset:C.$offset})};var D=function(){function w(T){this.$L=I(T.locale,null,!0),this.parse(T)}var C=w.prototype;return C.parse=function(T){this.$d=function(z){var A=z.date,M=z.utc;if(A===null)return new Date(NaN);if(F.u(A))return new Date;if(A instanceof Date)return new Date(A);if(typeof A=="string"&&!/Z$/i.test(A)){var P=A.match(d);if(P){var N=P[2]-1||0,E=(P[7]||"0").substring(0,3);return M?new Date(Date.UTC(P[1],N,P[3]||1,P[4]||0,P[5]||0,P[6]||0,E)):new Date(P[1],N,P[3]||1,P[4]||0,P[5]||0,P[6]||0,E)}}return new Date(A)}(T),this.$x=T.x||{},this.init()},C.init=function(){var T=this.$d;this.$y=T.getFullYear(),this.$M=T.getMonth(),this.$D=T.getDate(),this.$W=T.getDay(),this.$H=T.getHours(),this.$m=T.getMinutes(),this.$s=T.getSeconds(),this.$ms=T.getMilliseconds()},C.$utils=function(){return F},C.isValid=function(){return this.$d.toString()!=="Invalid Date"},C.isSame=function(T,z){var A=O(T);return this.startOf(z)<=A&&A<=this.endOf(z)},C.isAfter=function(T,z){return O(T)<this.startOf(z)},C.isBefore=function(T,z){return this.endOf(z)<O(T)},C.$g=function(T,z,A){return F.u(T)?this[z]:this.set(A,T)},C.unix=function(){return Math.floor(this.valueOf()/1e3)},C.valueOf=function(){return this.$d.getTime()},C.startOf=function(T,z){var A=this,M=!!F.u(z)||z,P=F.p(T),N=function(ae,J){var pe=F.w(A.$u?Date.UTC(A.$y,J,ae):new Date(A.$y,J,ae),A);return M?pe:pe.endOf(o)},E=function(ae,J){return F.w(A.toDate()[ae].apply(A.toDate("s"),(M?[0,0,0,0]:[23,59,59,999]).slice(J)),A)},B=this.$W,U=this.$M,X=this.$D,le="set"+(this.$u?"UTC":"");switch(P){case f:return M?N(1,0):N(31,11);case s:return M?N(1,U):N(0,U+1);case a:var he=this.$locale().weekStart||0,Z=(B<he?B+7:B)-he;return N(M?X-Z:X+(6-Z),U);case o:case m:return E(le+"Hours",0);case l:return E(le+"Minutes",1);case t:return E(le+"Seconds",2);case n:return E(le+"Milliseconds",3);default:return this.clone()}},C.endOf=function(T){return this.startOf(T,!1)},C.$set=function(T,z){var A,M=F.p(T),P="set"+(this.$u?"UTC":""),N=(A={},A[o]=P+"Date",A[m]=P+"Date",A[s]=P+"Month",A[f]=P+"FullYear",A[l]=P+"Hours",A[t]=P+"Minutes",A[n]=P+"Seconds",A[e]=P+"Milliseconds",A)[M],E=M===o?this.$D+(z-this.$W):z;if(M===s||M===f){var B=this.clone().set(m,1);B.$d[N](E),B.init(),this.$d=B.set(m,Math.min(this.$D,B.daysInMonth())).$d}else N&&this.$d[N](E);return this.init(),this},C.set=function(T,z){return this.clone().$set(T,z)},C.get=function(T){return this[F.p(T)]()},C.add=function(T,z){var A,M=this;T=Number(T);var P=F.p(z),N=function(U){var X=O(M);return F.w(X.date(X.date()+Math.round(U*T)),M)};if(P===s)return this.set(s,this.$M+T);if(P===f)return this.set(f,this.$y+T);if(P===o)return N(1);if(P===a)return N(7);var E=(A={},A[t]=6e4,A[l]=36e5,A[n]=1e3,A)[P]||1,B=this.$d.getTime()+T*E;return F.w(B,this)},C.subtract=function(T,z){return this.add(-1*T,z)},C.format=function(T){var z=this;if(!this.isValid())return"Invalid Date";var A=T||"YYYY-MM-DDTHH:mm:ssZ",M=F.z(this),P=this.$locale(),N=this.$H,E=this.$m,B=this.$M,U=P.weekdays,X=P.months,le=function(J,pe,K,se){return J&&(J[pe]||J(z,A))||K[pe].substr(0,se)},he=function(J){return F.s(N%12||12,J,"0")},Z=P.meridiem||function(J,pe,K){var se=J<12?"AM":"PM";return K?se.toLowerCase():se},ae={YY:String(this.$y).slice(-2),YYYY:this.$y,M:B+1,MM:F.s(B+1,2,"0"),MMM:le(P.monthsShort,B,X,3),MMMM:le(X,B),D:this.$D,DD:F.s(this.$D,2,"0"),d:String(this.$W),dd:le(P.weekdaysMin,this.$W,U,2),ddd:le(P.weekdaysShort,this.$W,U,3),dddd:U[this.$W],H:String(N),HH:F.s(N,2,"0"),h:he(1),hh:he(2),a:Z(N,E,!0),A:Z(N,E,!1),m:String(E),mm:F.s(E,2,"0"),s:String(this.$s),ss:F.s(this.$s,2,"0"),SSS:F.s(this.$ms,3,"0"),Z:M};return A.replace(g,function(J,pe){return pe||ae[J]||M.replace(":","")})},C.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},C.diff=function(T,z,A){var M,P=F.p(z),N=O(T),E=6e4*(N.utcOffset()-this.utcOffset()),B=this-N,U=F.m(this,N);return U=(M={},M[f]=U/12,M[s]=U,M[u]=U/3,M[a]=(B-E)/6048e5,M[o]=(B-E)/864e5,M[l]=B/36e5,M[t]=B/6e4,M[n]=B/1e3,M)[P]||B,A?U:F.a(U)},C.daysInMonth=function(){return this.endOf(s).$D},C.$locale=function(){return _[this.$L]},C.locale=function(T,z){if(!T)return this.$L;var A=this.clone(),M=I(T,z,!0);return M&&(A.$L=M),A},C.clone=function(){return F.w(this.$d,this)},C.toDate=function(){return new Date(this.valueOf())},C.toJSON=function(){return this.isValid()?this.toISOString():null},C.toISOString=function(){return this.$d.toISOString()},C.toString=function(){return this.$d.toUTCString()},w}(),k=D.prototype;return O.prototype=k,[["$ms",e],["$s",n],["$m",t],["$H",l],["$W",o],["$M",s],["$y",f],["$D",m]].forEach(function(w){k[w[1]]=function(C){return this.$g(C,w[0],w[1])}}),O.extend=function(w,C){return w.$i||(w(C,D,O),w.$i=!0),O},O.locale=I,O.isDayjs=S,O.unix=function(w){return O(1e3*w)},O.en=_[x],O.Ls=_,O.p={},O})});function Zl(e){if(e==null||e.toString().length<5)return!1;return!!n(e);function n(t){var l=/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/,o=/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/;if(!l.test(t)&&!o.test(t))return!1;var a=RegExp.$1,s=RegExp.$2,u=RegExp.$3;if(a<1900||s>12||u>31)return!1;if(s==2){if(new Date(a,1,29).getDate()==29&&u>29)return!1;if(new Date(a,1,29).getDate()!=29&&u>28)return!1}return!0}}function Br(e,n){return(0,Rm.default)(e).diff((0,Rm.default)(n))}function Ga(e){let n={};return Zl(e)&&(n.date=!0),!isNaN(parseFloat(e))&&!Oa(e)&&(n.num=!0),n}function xi(e){let n="string";return Zl(e)?n="date":!isNaN(parseFloat(e))&&!Oa(e)&&(n="num"),n}var import_plugin,Rm,Co=Tt(()=>{import_plugin=Le(Be());Gl();Rm=Le(ka())});var Is=fn((My,uh)=>{var import_plugin=Le(Be());(function(e,n){typeof define=="function"&&define.amd?define(n):typeof uh=="object"&&uh.exports?uh.exports=n():e.numeral=n()})(My,function(){var e,n,t="2.0.6",l={},o={},a={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},s={currentLocale:a.currentLocale,zeroFormat:a.zeroFormat,nullFormat:a.nullFormat,defaultFormat:a.defaultFormat,scalePercentBy100:a.scalePercentBy100};function u(f,m){this._input=f,this._value=m}return e=function(f){var m,d,g,b;if(e.isNumeral(f))m=f.value();else if(f===0||typeof f=="undefined")m=0;else if(f===null||n.isNaN(f))m=null;else if(typeof f=="string")if(s.zeroFormat&&f===s.zeroFormat)m=0;else if(s.nullFormat&&f===s.nullFormat||!f.replace(/[^0-9]+/g,"").length)m=null;else{for(d in l)if(b=typeof l[d].regexps.unformat=="function"?l[d].regexps.unformat():l[d].regexps.unformat,b&&f.match(b)){g=l[d].unformat;break}g=g||e._.stringToNumber,m=g(f)}else m=Number(f)||null;return new u(f,m)},e.version=t,e.isNumeral=function(f){return f instanceof u},e._=n={numberToFormat:function(f,m,d){var g=o[e.options.currentLocale],b=!1,y=!1,p=0,x="",_=1e12,S=1e9,I=1e6,O=1e3,F="",D=!1,k,w,C,T,z,A,M,P,N,E;if(f=f||0,w=Math.abs(f),e._.includes(m,"(")?(b=!0,m=m.replace(/[\(|\)]/g,"")):(e._.includes(m,"+")||e._.includes(m,"-"))&&(P=e._.includes(m,"+")?m.indexOf("+"):f<0?m.indexOf("-"):-1,m=m.replace(/[\+|\-]/g,"")),e._.includes(m,"a")&&(k=m.match(/a(k|m|b|t)?/),k=k?k[1]:!1,e._.includes(m," a")&&(x=" "),m=m.replace(new RegExp(x+"a[kmbt]?"),""),w>=_&&!k||k==="t"?(x+=g.abbreviations.trillion,f=f/_):w<_&&w>=S&&!k||k==="b"?(x+=g.abbreviations.billion,f=f/S):w<S&&w>=I&&!k||k==="m"?(x+=g.abbreviations.million,f=f/I):(w<I&&w>=O&&!k||k==="k")&&(x+=g.abbreviations.thousand,f=f/O)),e._.includes(m,"[.]")&&(y=!0,m=m.replace("[.]",".")),A=f.toString().split(".")[0],M=m.split(".")[1],N=m.indexOf(","),p=(m.split(".")[0].split(",")[0].match(/0/g)||[]).length,M?(e._.includes(M,"[")?(M=M.replace("]",""),M=M.split("["),F=e._.toFixed(f,M[0].length+M[1].length,d,M[1].length)):F=e._.toFixed(f,M.length,d),A=F.split(".")[0],e._.includes(F,".")?F=g.delimiters.decimal+F.split(".")[1]:F="",y&&Number(F.slice(1))===0&&(F="")):A=e._.toFixed(f,0,d),x&&!k&&Number(A)>=1e3&&x!==g.abbreviations.trillion)switch(A=String(Number(A)/1e3),x){case g.abbreviations.thousand:x=g.abbreviations.million;break;case g.abbreviations.million:x=g.abbreviations.billion;break;case g.abbreviations.billion:x=g.abbreviations.trillion;break}if(e._.includes(A,"-")&&(A=A.slice(1),D=!0),A.length<p)for(var B=p-A.length;B>0;B--)A="0"+A;return N>-1&&(A=A.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+g.delimiters.thousands)),m.indexOf(".")===0&&(A=""),E=A+F+(x||""),b?E=(b&&D?"(":"")+E+(b&&D?")":""):P>=0?E=P===0?(D?"-":"+")+E:E+(D?"-":"+"):D&&(E="-"+E),E},stringToNumber:function(f){var m=o[s.currentLocale],d=f,g={thousand:3,million:6,billion:9,trillion:12},b,y,p,x;if(s.zeroFormat&&f===s.zeroFormat)y=0;else if(s.nullFormat&&f===s.nullFormat||!f.replace(/[^0-9]+/g,"").length)y=null;else{y=1,m.delimiters.decimal!=="."&&(f=f.replace(/\./g,"").replace(m.delimiters.decimal,"."));for(b in g)if(x=new RegExp("[^a-zA-Z]"+m.abbreviations[b]+"(?:\\)|(\\"+m.currency.symbol+")?(?:\\))?)?$"),d.match(x)){y*=Math.pow(10,g[b]);break}y*=(f.split("-").length+Math.min(f.split("(").length-1,f.split(")").length-1))%2?1:-1,f=f.replace(/[^0-9\.]+/g,""),y*=Number(f)}return y},isNaN:function(f){return typeof f=="number"&&isNaN(f)},includes:function(f,m){return f.indexOf(m)!==-1},insert:function(f,m,d){return f.slice(0,d)+m+f.slice(d)},reduce:function(f,m){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof m!="function")throw new TypeError(m+" is not a function");var d=Object(f),g=d.length>>>0,b=0,y;if(arguments.length===3)y=arguments[2];else{for(;b<g&&!(b in d);)b++;if(b>=g)throw new TypeError("Reduce of empty array with no initial value");y=d[b++]}for(;b<g;b++)b in d&&(y=m(y,d[b],b,d));return y},multiplier:function(f){var m=f.toString().split(".");return m.length<2?1:Math.pow(10,m[1].length)},correctionFactor:function(){var f=Array.prototype.slice.call(arguments);return f.reduce(function(m,d){var g=n.multiplier(d);return m>g?m:g},1)},toFixed:function(f,m,d,g){var b=f.toString().split("."),y=m-(g||0),p,x,_,S;return b.length===2?p=Math.min(Math.max(b[1].length,y),m):p=y,_=Math.pow(10,p),S=(d(f+"e+"+p)/_).toFixed(p),g>m-p&&(x=new RegExp("\\.?0{1,"+(g-(m-p))+"}$"),S=S.replace(x,"")),S}},e.options=s,e.formats=l,e.locales=o,e.locale=function(f){return f&&(s.currentLocale=f.toLowerCase()),s.currentLocale},e.localeData=function(f){if(!f)return o[s.currentLocale];if(f=f.toLowerCase(),!o[f])throw new Error("Unknown locale : "+f);return o[f]},e.reset=function(){for(var f in a)s[f]=a[f]},e.zeroFormat=function(f){s.zeroFormat=typeof f=="string"?f:null},e.nullFormat=function(f){s.nullFormat=typeof f=="string"?f:null},e.defaultFormat=function(f){s.defaultFormat=typeof f=="string"?f:"0.0"},e.register=function(f,m,d){if(m=m.toLowerCase(),this[f+"s"][m])throw new TypeError(m+" "+f+" already registered.");return this[f+"s"][m]=d,d},e.validate=function(f,m){var d,g,b,y,p,x,_,S;if(typeof f!="string"&&(f+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",f)),f=f.trim(),f.match(/^\d+$/))return!0;if(f==="")return!1;try{_=e.localeData(m)}catch(I){_=e.localeData(e.locale())}return b=_.currency.symbol,p=_.abbreviations,d=_.delimiters.decimal,_.delimiters.thousands==="."?g="\\.":g=_.delimiters.thousands,S=f.match(/^[^\d]+/),S!==null&&(f=f.substr(1),S[0]!==b)||(S=f.match(/[^\d]+$/),S!==null&&(f=f.slice(0,-1),S[0]!==p.thousand&&S[0]!==p.million&&S[0]!==p.billion&&S[0]!==p.trillion))?!1:(x=new RegExp(g+"{2}"),f.match(/[^\d.,]/g)?!1:(y=f.split(d),y.length>2?!1:y.length<2?!!y[0].match(/^\d+.*\d$/)&&!y[0].match(x):y[0].length===1?!!y[0].match(/^\d+$/)&&!y[0].match(x)&&!!y[1].match(/^\d+$/):!!y[0].match(/^\d+.*\d$/)&&!y[0].match(x)&&!!y[1].match(/^\d+$/)))},e.fn=u.prototype={clone:function(){return e(this)},format:function(f,m){var d=this._value,g=f||s.defaultFormat,b,y,p;if(m=m||Math.round,d===0&&s.zeroFormat!==null)y=s.zeroFormat;else if(d===null&&s.nullFormat!==null)y=s.nullFormat;else{for(b in l)if(g.match(l[b].regexps.format)){p=l[b].format;break}p=p||e._.numberToFormat,y=p(d,g,m)}return y},value:function(){return this._value},input:function(){return this._input},set:function(f){return this._value=Number(f),this},add:function(f){var m=n.correctionFactor.call(null,this._value,f);function d(g,b,y,p){return g+Math.round(m*b)}return this._value=n.reduce([this._value,f],d,0)/m,this},subtract:function(f){var m=n.correctionFactor.call(null,this._value,f);function d(g,b,y,p){return g-Math.round(m*b)}return this._value=n.reduce([f],d,Math.round(this._value*m))/m,this},multiply:function(f){function m(d,g,b,y){var p=n.correctionFactor(d,g);return Math.round(d*p)*Math.round(g*p)/Math.round(p*p)}return this._value=n.reduce([this._value,f],m,1),this},divide:function(f){function m(d,g,b,y){var p=n.correctionFactor(d,g);return Math.round(d*p)/Math.round(g*p)}return this._value=n.reduce([this._value,f],m),this},difference:function(f){return Math.abs(e(this._value).subtract(f).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(f){var m=f%10;return~~(f%100/10)==1?"th":m===1?"st":m===2?"nd":m===3?"rd":"th"},currency:{symbol:"$"}}),function(){e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(f,m,d){var g=e._.includes(m," BPS")?" ":"",b;return f=f*1e4,m=m.replace(/\s?BPS/,""),b=e._.numberToFormat(f,m,d),e._.includes(b,")")?(b=b.split(""),b.splice(-1,0,g+"BPS"),b=b.join("")):b=b+g+"BPS",b},unformat:function(f){return+(e._.stringToNumber(f)*1e-4).toFixed(15)}})}(),function(){var f={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},m={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},d=f.suffixes.concat(m.suffixes.filter(function(b){return f.suffixes.indexOf(b)<0})),g=d.join("|");g="("+g.replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(g)},format:function(b,y,p){var x,_=e._.includes(y,"ib")?m:f,S=e._.includes(y," b")||e._.includes(y," ib")?" ":"",I,O,F;for(y=y.replace(/\s?i?b/,""),I=0;I<=_.suffixes.length;I++)if(O=Math.pow(_.base,I),F=Math.pow(_.base,I+1),b===null||b===0||b>=O&&b<F){S+=_.suffixes[I],O>0&&(b=b/O);break}return x=e._.numberToFormat(b,y,p),x+S},unformat:function(b){var y=e._.stringToNumber(b),p,x;if(y){for(p=f.suffixes.length-1;p>=0;p--){if(e._.includes(b,f.suffixes[p])){x=Math.pow(f.base,p);break}if(e._.includes(b,m.suffixes[p])){x=Math.pow(m.base,p);break}}y*=x||1}return y}})}(),function(){e.register("format","currency",{regexps:{format:/(\$)/},format:function(f,m,d){var g=e.locales[e.options.currentLocale],b={before:m.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:m.match(/([\+|\-|\)|\s|\$]*)$/)[0]},y,p,x;for(m=m.replace(/\s?\$\s?/,""),y=e._.numberToFormat(f,m,d),f>=0?(b.before=b.before.replace(/[\-\(]/,""),b.after=b.after.replace(/[\-\)]/,"")):f<0&&!e._.includes(b.before,"-")&&!e._.includes(b.before,"(")&&(b.before="-"+b.before),x=0;x<b.before.length;x++)switch(p=b.before[x],p){case"$":y=e._.insert(y,g.currency.symbol,x);break;case" ":y=e._.insert(y," ",x+g.currency.symbol.length-1);break}for(x=b.after.length-1;x>=0;x--)switch(p=b.after[x],p){case"$":y=x===b.after.length-1?y+g.currency.symbol:e._.insert(y,g.currency.symbol,-(b.after.length-(1+x)));break;case" ":y=x===b.after.length-1?y+" ":e._.insert(y," ",-(b.after.length-(1+x)+g.currency.symbol.length-1));break}return y}})}(),function(){e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(f,m,d){var g,b=typeof f=="number"&&!e._.isNaN(f)?f.toExponential():"0e+0",y=b.split("e");return m=m.replace(/e[\+|\-]{1}0/,""),g=e._.numberToFormat(Number(y[0]),m,d),g+"e"+y[1]},unformat:function(f){var m=e._.includes(f,"e+")?f.split("e+"):f.split("e-"),d=Number(m[0]),g=Number(m[1]);g=e._.includes(f,"e-")?g*=-1:g;function b(y,p,x,_){var S=e._.correctionFactor(y,p),I=y*S*(p*S)/(S*S);return I}return e._.reduce([d,Math.pow(10,g)],b,1)}})}(),function(){e.register("format","ordinal",{regexps:{format:/(o)/},format:function(f,m,d){var g=e.locales[e.options.currentLocale],b,y=e._.includes(m," o")?" ":"";return m=m.replace(/\s?o/,""),y+=g.ordinal(f),b=e._.numberToFormat(f,m,d),b+y}})}(),function(){e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(f,m,d){var g=e._.includes(m," %")?" ":"",b;return e.options.scalePercentBy100&&(f=f*100),m=m.replace(/\s?\%/,""),b=e._.numberToFormat(f,m,d),e._.includes(b,")")?(b=b.split(""),b.splice(-1,0,g+"%"),b=b.join("")):b=b+g+"%",b},unformat:function(f){var m=e._.stringToNumber(f);return e.options.scalePercentBy100?m*.01:m}})}(),function(){e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(f,m,d){var g=Math.floor(f/60/60),b=Math.floor((f-g*60*60)/60),y=Math.round(f-g*60*60-b*60);return g+":"+(b<10?"0"+b:b)+":"+(y<10?"0"+y:y)},unformat:function(f){var m=f.split(":"),d=0;return m.length===3?(d=d+Number(m[0])*60*60,d=d+Number(m[1])*60,d=d+Number(m[2])):m.length===2&&(d=d+Number(m[0])*60,d=d+Number(m[1])),Number(d)}})}(),e})});function Fm(e,n){var t=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()),l=Date.UTC(1899,11,31,0,0,0);return n?t-=1461*24*60*60*1e3:e>=Dx&&(t+=24*60*60*1e3),(t-l)/(24*60*60*1e3)}function zx(e,n){var t=new Date(e);if(Ax)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(fh.getFullYear()==1917&&!isNaN(t.getFullYear())){var l=t.getFullYear();return e.indexOf(""+l)>-1||t.setFullYear(t.getFullYear()+100),t}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ox(e){var n=Number(e);if(typeof e=="number")return e;if(!isNaN(n))return n;var t=1,l=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(l))||(l=l.replace(/[(](.*)[)]/,function(o,a){return t=-t,a}),!isNaN(n=Number(l)))?n/t:n}function nl(e){var n=[],t=null,l={},o=e;if(e==null)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(e)){t=e,o=Number(e.split(".")[0].replace(",",""));let S="#,##0";if(e.split(".")[1]){S="#,##0.";for(let I=0;I<e.split(".")[1].length;I++)S+=0}l={fa:S,t:"n"}}else if(e.toString().substr(0,1)==="'")t=e.toString().substr(1),l={fa:"@",t:"s"};else if(e.toString().toUpperCase()==="TRUE")t="TRUE",l={fa:"General",t:"b"},o=!0;else if(e.toString().toUpperCase()==="FALSE")t="FALSE",l={fa:"General",t:"b"},o=!1;else if(q(e))t=e.toString(),l={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))t=e.toString(),l={fa:"@",t:"s"};else if(Y(e)&&Math.abs(parseFloat(e))>0&&(Math.abs(parseFloat(e))>=1e11||Math.abs(parseFloat(e))<1e-9)){o=(0,$o.default)(e).value();var a=o.toExponential();if(a.indexOf(".")>-1){var s=a.split(".")[1].split("e")[0].length;s>5&&(s=5),l={fa:"#0."+new Array(s+1).join("0")+"E+00",t:"n"}}else l={fa:"#0.E+00",t:"n"};t=dn.format(l.fa,o)}else if(e.toString().indexOf("%")>-1){var u=e.toString().indexOf("%"),f=e.toString().substr(0,u),m=f.replace(/,/g,"");if(u==e.toString().length-1&&Y(m))if(f.indexOf(".")>-1)if(f.indexOf(".")==f.lastIndexOf(".")){var d=f.split(".")[0],g=f.split(".")[1],b=g.length;if(b>9&&(b=9),d.indexOf(",")>-1){for(var y=!0,p=d.split(","),x=1;x<p.length;x++)if(p[x].length<3){y=!1;break}y?(l={fa:"#,##0."+new Array(b+1).join("0")+"%",t:"n"},o=(0,$o.default)(e).value(),t=dn.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else l={fa:"0."+new Array(b+1).join("0")+"%",t:"n"},o=(0,$o.default)(e).value(),t=dn.format(l.fa,o)}else t=e.toString(),l={fa:"@",t:"s"};else if(f.indexOf(",")>-1){for(var y=!0,p=f.split(","),x=1;x<p.length;x++)if(p[x].length<3){y=!1;break}y?(l={fa:"#,##0%",t:"n"},o=(0,$o.default)(e).value(),t=dn.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else l={fa:"0%",t:"n"},o=(0,$o.default)(e).value(),t=dn.format(l.fa,o);else t=e.toString(),l={fa:"@",t:"s"}}else if(e.toString().indexOf(".")>-1)if(e.toString().indexOf(".")==e.toString().lastIndexOf(".")){var _=e.toString().split(".")[0],f=e.toString().split(".")[1],b=f.length;if(b>9&&(b=9),_.indexOf(",")>-1){for(var y=!0,p=_.split(","),x=1;x<p.length;x++)if(!Y(p[x])||p[x].length<3){y=!1;break}y?(l={fa:"#,##0."+new Array(b+1).join("0"),t:"n"},o=(0,$o.default)(e).value(),t=dn.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else Y(_)&&Y(f)?(l={fa:"0."+new Array(b+1).join("0"),t:"n"},o=(0,$o.default)(e).value(),t=dn.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else t=e.toString(),l={fa:"@",t:"s"};else Y(e)?(t=e.toString(),l={fa:"General",t:"n"},o=parseFloat(e)):Zl(e)&&(e.toString().indexOf(".")>-1||e.toString().indexOf(":")>-1||e.toString().length<16)?(o=Fm(zx(e.toString().replace(/-/g,"/"))),o.toString().indexOf(".")>-1?e.toString().length>18?l.fa="yyyy-MM-dd hh:mm:ss":e.toString().length>11?l.fa="yyyy-MM-dd hh:mm":l.fa="yyyy-MM-dd":l.fa="yyyy-MM-dd",l.t="d",t=dn.format(l.fa,o)):(t=e,l.fa="General",l.t="g");return[t,l,o]}function $l(e,n){return dn.format(e,n)}function Dy(e,n){return dn.is_date(e,n)}function ba(e,n,t){var l=Mt(e,n,t,"m");return l==null?l=Mt(e,n,t,"v"):isNaN(Ox(l))?t[e][n].ct!=null&&t[e][n].ct.t=="d"||t[e][n].ct!=null&&t[e][n].ct.t=="b"||(l=Mt(e,n,t,"v")):typeof l=="string"&&l.indexOf("%")>-1||(l=Mt(e,n,t,"v")),l}var import_plugin,$o,dn,Fx,w6,x6,Mx,_6,Dx,fh,Ax,Hn=Tt(()=>{import_plugin=Le(Be());Gl();Co();mr();$o=Le(Is()),dn={},Fx=function(n){n.version="0.11.2";function t(te){for(var re="",fe=te.length-1;fe>=0;)re+=te.charAt(fe--);return re}function l(te,re){for(var fe="";fe.length<re;)fe+=te;return fe}function o(te,re){var fe=""+te;return fe.length>=re?fe:l("0",re-fe.length)+fe}function a(te,re){var fe=""+te;return fe.length>=re?fe:l(" ",re-fe.length)+fe}function s(te,re){var fe=""+te;return fe.length>=re?fe:fe+l(" ",re-fe.length)}function u(te,re){var fe=""+Math.round(te);return fe.length>=re?fe:l("0",re-fe.length)+fe}function f(te,re){var fe=""+te;return fe.length>=re?fe:l("0",re-fe.length)+fe}var m=Math.pow(2,32);function d(te,re){if(te>m||te<-m)return u(te,re);var fe=Math.round(te);return f(fe,re)}function g(te,re){return re=re||0,te.length>=7+re&&(te.charCodeAt(re)|32)==103&&(te.charCodeAt(re+1)|32)==101&&(te.charCodeAt(re+2)|32)==110&&(te.charCodeAt(re+3)|32)==101&&(te.charCodeAt(re+4)|32)==114&&(te.charCodeAt(re+5)|32)==97&&(te.charCodeAt(re+6)|32)==108}var b=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],y=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function p(te){te[0]="General",te[1]="0",te[2]="0.00",te[3]="#,##0",te[4]="#,##0.00",te[9]="0%",te[10]="0.00%",te[11]="0.00E+00",te[12]="# ?/?",te[13]="# ??/??",te[14]="m/d/yy",te[15]="d-mmm-yy",te[16]="d-mmm",te[17]="mmm-yy",te[18]="h:mm AM/PM",te[19]="h:mm:ss AM/PM",te[20]="h:mm",te[21]="h:mm:ss",te[22]="m/d/yy h:mm",te[37]="#,##0 ;(#,##0)",te[38]="#,##0 ;[Red](#,##0)",te[39]="#,##0.00;(#,##0.00)",te[40]="#,##0.00;[Red](#,##0.00)",te[45]="mm:ss",te[46]="[h]:mm:ss",te[47]="mmss.0",te[48]="##0.0E+0",te[49]="@",te[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',te[65535]="General"}var x={};p(x);var _=[],S=0;for(S=5;S<=8;++S)_[S]=32+S;for(S=23;S<=26;++S)_[S]=0;for(S=27;S<=31;++S)_[S]=14;for(S=50;S<=58;++S)_[S]=14;for(S=59;S<=62;++S)_[S]=S-58;for(S=67;S<=68;++S)_[S]=S-58;for(S=72;S<=75;++S)_[S]=S-58;for(S=67;S<=68;++S)_[S]=S-57;for(S=76;S<=78;++S)_[S]=S-56;for(S=79;S<=81;++S)_[S]=S-34;var I=[];I[5]=I[63]='"$"#,##0_);\\("$"#,##0\\)',I[6]=I[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',I[7]=I[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',I[8]=I[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',I[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',I[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',I[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',I[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function O(te,re,fe){for(var Me=te<0?-1:1,ye=te*Me,Ye=0,Ce=1,Ke=0,ft=1,et=0,vt=0,wt=Math.floor(ye);et<re&&(wt=Math.floor(ye),Ke=wt*Ce+Ye,vt=wt*et+ft,!(ye-wt<5e-8));)ye=1/(ye-wt),Ye=Ce,Ce=Ke,ft=et,et=vt;if(vt>re&&(et>re?(vt=ft,Ke=Ye):(vt=et,Ke=Ce)),!fe)return[0,Me*Ke,vt];var be=Math.floor(Me*Ke/vt);return[be,Me*Ke-be*vt,vt]}function F(te,re,fe){if(te>2958465||te<0)return null;var Me=te|0,ye=Math.floor(86400*(te-Me)),Ye=0,Ce=[],Ke={D:Me,T:ye,u:86400*(te-Me)-ye,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(Ke.u)<1e-6&&(Ke.u=0),re&&re.date1904&&(Me+=1462),Ke.u>.9999&&(Ke.u=0,++ye==86400&&(Ke.T=ye=0,++Me,++Ke.D)),Me===60)Ce=fe?[1317,10,29]:[1900,2,29],Ye=3;else if(Me===0)Ce=fe?[1317,8,29]:[1900,1,0],Ye=6;else{Me>60&&--Me;var ft=new Date(1900,0,1);ft.setDate(ft.getDate()+Me-1),Ce=[ft.getFullYear(),ft.getMonth()+1,ft.getDate()],Ye=ft.getDay(),Me<60&&(Ye=(Ye+6)%7),fe&&(Ye=M(ft,Ce))}return Ke.y=Ce[0],Ke.m=Ce[1],Ke.d=Ce[2],Ke.S=ye%60,ye=Math.floor(ye/60),Ke.M=ye%60,ye=Math.floor(ye/60),Ke.H=ye,Ke.q=Ye,Ke}n.parse_date_code=F;var D=new Date(1899,11,31,0,0,0),k=D.getTime(),w=new Date(1900,2,1,0,0,0);function C(te,re){var fe=te.getTime();return re?fe-=1461*24*60*60*1e3:te>=w&&(fe+=24*60*60*1e3),(fe-(k+(te.getTimezoneOffset()-D.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function T(te){return te.toString(10)}n._general_int=T;var z=function(){var re=/(?:\.0*|(\.\d*[1-9])0+)$/;function fe(et){return et.indexOf(".")==-1?et:et.replace(re,"$1")}var Me=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,ye=/(E[+-])(\d)$/;function Ye(et){return et.indexOf("E")==-1?et:et.replace(Me,"$1E").replace(ye,"$10$2")}function Ce(et){var vt=et<0?12:11,wt=fe(et.toFixed(12));return wt.length<=vt||(wt=et.toPrecision(10),wt.length<=vt)?wt:et.toExponential(5)}function Ke(et){var vt=fe(et.toFixed(11));return vt.length>(et<0?12:11)||vt==="0"||vt==="-0"?et.toPrecision(6):vt}function ft(et){var vt=Math.floor(Math.log(Math.abs(et))*Math.LOG10E),wt;return vt>=-4&&vt<=-1?wt=et.toPrecision(10+vt):Math.abs(vt)<=9?wt=Ce(et):vt===10?wt=et.toFixed(10).substr(0,12):wt=Ke(et),fe(Ye(wt.toUpperCase()))}return ft}();n._general_num=z;function A(te,re){switch(typeof te){case"string":return te;case"boolean":return te?"TRUE":"FALSE";case"number":return(te|0)===te?te.toString(10):z(te);case"undefined":return"";case"object":if(te==null)return"";if(te instanceof Date)return K(14,C(te,re&&re.date1904),re)}throw new Error("unsupported value in General format: "+te)}n._general=A;function M(te,re){re[0]-=581;var fe=te.getDay();return te<60&&(fe=(fe+6)%7),fe}var P="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function N(te,re,fe,Me){var ye="",Ye=0,Ce=0,Ke=fe.y,ft,et=0;switch(te){case 98:Ke=fe.y+543;case 121:switch(re.length){case 1:case 2:ft=Ke%100,et=2;break;default:ft=Ke%1e4,et=4;break}break;case 109:switch(re.length){case 1:case 2:ft=fe.m,et=re.length;break;case 3:return y[fe.m-1][1];case 5:return y[fe.m-1][0];default:return y[fe.m-1][2]}break;case 100:switch(re.length){case 1:case 2:ft=fe.d,et=re.length;break;case 3:return b[fe.q][0];default:return b[fe.q][1]}break;case 104:switch(re.length){case 1:case 2:ft=1+(fe.H+11)%12,et=re.length;break;default:throw"bad hour format: "+re}break;case 72:switch(re.length){case 1:case 2:ft=fe.H,et=re.length;break;default:throw"bad hour format: "+re}break;case 77:switch(re.length){case 1:case 2:ft=fe.M,et=re.length;break;default:throw"bad minute format: "+re}break;case 115:if(re!="s"&&re!="ss"&&re!=".0"&&re!=".00"&&re!=".000")throw"bad second format: "+re;return fe.u===0&&(re=="s"||re=="ss")?o(fe.S,re.length):(Me>=2?Ce=Me===3?1e3:100:Ce=Me===1?10:1,Ye=Math.round(Ce*(fe.S+fe.u)),Ye>=60*Ce&&(Ye=0),re==="s"?Ye===0?"0":""+Ye/Ce:(ye=o(Ye,2+Me),re==="ss"?ye.substr(0,2):"."+ye.substr(2,re.length-1)));case 90:switch(re){case"[h]":case"[hh]":ft=fe.D*24+fe.H;break;case"[m]":case"[mm]":ft=(fe.D*24+fe.H)*60+fe.M;break;case"[s]":case"[ss]":ft=((fe.D*24+fe.H)*60+fe.M)*60+Math.round(fe.S+fe.u);break;default:throw"bad abstime format: "+re}et=re.length===3?1:2;break;case 101:ft=Ke,et=1;break}var vt=et>0?o(ft,et):"";return vt}function E(te){var re=3;if(te.length<=re)return te;for(var fe=te.length%re,Me=te.substr(0,fe);fe!=te.length;fe+=re)Me+=(Me.length>0?",":"")+te.substr(fe,re);return Me}var B=function(){var re=/%/g;function fe(Ve,Ie,ve){var Ge=Ie.replace(re,""),Ue=Ie.length-Ge.length;return B(Ve,Ge,ve*Math.pow(10,2*Ue))+l("%",Ue)}function Me(Ve,Ie,ve){for(var Ge=Ie.length-1;Ie.charCodeAt(Ge-1)===44;)--Ge;return B(Ve,Ie.substr(0,Ge),ve/Math.pow(10,3*(Ie.length-Ge)))}function ye(Ve,Ie){var ve,Ge=Ve.indexOf("E")-Ve.indexOf(".")-1;if(Ve.match(/^#+0.0E\+0$/)){if(Ie==0)return"0.0E+0";if(Ie<0)return"-"+ye(Ve,-Ie);var Ue=Ve.indexOf(".");Ue===-1&&(Ue=Ve.indexOf("E"));var We=Math.floor(Math.log(Ie)*Math.LOG10E)%Ue;if(We<0&&(We+=Ue),ve=(Ie/Math.pow(10,We)).toPrecision(Ge+1+(Ue+We)%Ue),ve.indexOf("e")===-1){var it=Math.floor(Math.log(Ie)*Math.LOG10E);for(ve.indexOf(".")===-1?ve=ve.charAt(0)+"."+ve.substr(1)+"E+"+(it-ve.length+We):ve+="E+"+(it-We);ve.substr(0,2)==="0.";)ve=ve.charAt(0)+ve.substr(2,Ue)+"."+ve.substr(2+Ue),ve=ve.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");ve=ve.replace(/\+-/,"-")}ve=ve.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(St,Kt,bl,hl){return Kt+bl+hl.substr(0,(Ue+We)%Ue)+"."+hl.substr(We)+"E"})}else ve=Ie.toExponential(Ge);return Ve.match(/E\+00$/)&&ve.match(/e[+-]\d$/)&&(ve=ve.substr(0,ve.length-1)+"0"+ve.charAt(ve.length-1)),Ve.match(/E\-/)&&ve.match(/e\+/)&&(ve=ve.replace(/e\+/,"e")),ve.replace("e","E")}var Ye=/# (\?+)( ?)\/( ?)(\d+)/;function Ce(Ve,Ie,ve){var Ge=parseInt(Ve[4],10),Ue=Math.round(Ie*Ge),We=Math.floor(Ue/Ge),it=Ue-We*Ge,St=Ge;return ve+(We===0?"":""+We)+" "+(it===0?l(" ",Ve[1].length+1+Ve[4].length):a(it,Ve[1].length)+Ve[2]+"/"+Ve[3]+o(St,Ve[4].length))}function Ke(Ve,Ie,ve){return ve+(Ie===0?"":""+Ie)+l(" ",Ve[1].length+2+Ve[4].length)}var ft=/^#*0*\.([0#]+)/,et=/\).*[0#]/,vt=/\(###\) ###\\?-####/;function wt(Ve){for(var Ie="",ve,Ge=0;Ge!=Ve.length;++Ge)switch(ve=Ve.charCodeAt(Ge)){case 35:break;case 63:Ie+=" ";break;case 48:Ie+="0";break;default:Ie+=String.fromCharCode(ve)}return Ie}function be(Ve,Ie){var ve=Math.pow(10,Ie);return""+Math.round(Ve*ve)/ve}function Q(Ve,Ie){var ve=Ve-Math.floor(Ve),Ge=Math.pow(10,Ie);return Ie<(""+Math.round(ve*Ge)).length?0:Math.round(ve*Ge)}function me(Ve,Ie){return Ie<(""+Math.round((Ve-Math.floor(Ve))*Math.pow(10,Ie))).length?1:0}function xe(Ve){return Ve<2147483647&&Ve>-2147483648?""+(Ve>=0?Ve|0:Ve-1|0):""+Math.floor(Ve)}function Te(Ve,Ie,ve){if(Ve.charCodeAt(0)===40&&!Ie.match(et)){var Ge=Ie.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return ve>=0?Te("n",Ge,ve):"("+Te("n",Ge,-ve)+")"}if(Ie.charCodeAt(Ie.length-1)===44)return Me(Ve,Ie,ve);if(Ie.indexOf("%")!==-1)return fe(Ve,Ie,ve);if(Ie.indexOf("E")!==-1)return ye(Ie,ve);if(Ie.charCodeAt(0)===36)return"$"+Te(Ve,Ie.substr(Ie.charAt(1)==" "?2:1),ve);var Ue,We,it,St,Kt=Math.abs(ve),bl=ve<0?"-":"";if(Ie.match(/^00+$/))return bl+d(Kt,Ie.length);if(Ie.match(/^[#?]+$/))return Ue=d(ve,0),Ue==="0"&&(Ue=""),Ue.length>Ie.length?Ue:wt(Ie.substr(0,Ie.length-Ue.length))+Ue;if(We=Ie.match(Ye))return Ce(We,Kt,bl);if(Ie.match(/^#+0+$/))return bl+d(Kt,Ie.length-Ie.indexOf("0"));if(We=Ie.match(ft))return Ue=be(ve,We[1].length).replace(/^([^\.]+)$/,"$1."+wt(We[1])).replace(/\.$/,"."+wt(We[1])).replace(/\.(\d*)$/,function(_e,Ne){return"."+Ne+l("0",wt(We[1]).length-Ne.length)}),Ie.indexOf("0.")!==-1?Ue:Ue.replace(/^0\./,".");if(Ie=Ie.replace(/^#+([0.])/,"$1"),We=Ie.match(/^(0*)\.(#*)$/))return bl+be(Kt,We[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,We[1].length?"0.":".");if(We=Ie.match(/^#{1,3},##0(\.?)$/))return bl+E(d(Kt,0));if(We=Ie.match(/^#,##0\.([#0]*0)$/))return ve<0?"-"+Te(Ve,Ie,-ve):E(""+(Math.floor(ve)+me(ve,We[1].length)))+"."+o(Q(ve,We[1].length),We[1].length);if(We=Ie.match(/^#,#*,#0/))return Te(Ve,Ie.replace(/^#,#*,/,""),ve);if(We=Ie.match(/^([0#]+)(\\?-([0#]+))+$/))return Ue=t(Te(Ve,Ie.replace(/[\\-]/g,""),ve)),it=0,t(t(Ie.replace(/\\/g,"")).replace(/[0#]/g,function(_e){return it<Ue.length?Ue.charAt(it++):_e==="0"?"0":""}));if(Ie.match(vt))return Ue=Te(Ve,"##########",ve),"("+Ue.substr(0,3)+") "+Ue.substr(3,3)+"-"+Ue.substr(6);var hl="";if(We=Ie.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return it=Math.min(We[4].length,7),St=O(Kt,Math.pow(10,it)-1,!1),Ue=""+bl,hl=B("n",We[1],St[1]),hl.charAt(hl.length-1)==" "&&(hl=hl.substr(0,hl.length-1)+"0"),Ue+=hl+We[2]+"/"+We[3],hl=s(St[2],it),hl.length<We[4].length&&(hl=wt(We[4].substr(We[4].length-hl.length))+hl),Ue+=hl,Ue;if(We=Ie.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return it=Math.min(Math.max(We[1].length,We[4].length),7),St=O(Kt,Math.pow(10,it)-1,!0),bl+(St[0]||(St[1]?"":"0"))+" "+(St[1]?a(St[1],it)+We[2]+"/"+We[3]+s(St[2],it):l(" ",2*it+1+We[2].length+We[3].length));if(We=Ie.match(/^[#0?]+$/))return Ue=d(ve,0),Ie.length<=Ue.length?Ue:wt(Ie.substr(0,Ie.length-Ue.length))+Ue;if(We=Ie.match(/^([#0?]+)\.([#0]+)$/)){Ue=""+ve.toFixed(Math.min(We[2].length,10)).replace(/([^0])0+$/,"$1"),it=Ue.indexOf(".");var Rr=Ie.indexOf(".")-it,Di=Ie.length-Ue.length-Rr;return wt(Ie.substr(0,Rr)+Ue+Ie.substr(Ie.length-Di))}if(We=Ie.match(/^00,000\.([#0]*0)$/))return it=Q(ve,We[1].length),ve<0?"-"+Te(Ve,Ie,-ve):E(xe(ve)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_e){return"00,"+(_e.length<3?o(0,3-_e.length):"")+_e})+"."+o(it,We[1].length);switch(Ie){case"###,##0.00":return Te(Ve,"#,##0.00",ve);case"###,###":case"##,###":case"#,###":var ln=E(d(Kt,0));return ln!=="0"?bl+ln:"";case"###,###.00":return Te(Ve,"###,##0.00",ve).replace(/^0\./,".");case"#,###.00":return Te(Ve,"#,##0.00",ve).replace(/^0\./,".");default:}throw new Error("unsupported format |"+Ie+"|")}function je(Ve,Ie,ve){for(var Ge=Ie.length-1;Ie.charCodeAt(Ge-1)===44;)--Ge;return B(Ve,Ie.substr(0,Ge),ve/Math.pow(10,3*(Ie.length-Ge)))}function De(Ve,Ie,ve){var Ge=Ie.replace(re,""),Ue=Ie.length-Ge.length;return B(Ve,Ge,ve*Math.pow(10,2*Ue))+l("%",Ue)}function Fe(Ve,Ie){var ve,Ge=Ve.indexOf("E")-Ve.indexOf(".")-1;if(Ve.match(/^#+0.0E\+0$/)){if(Ie==0)return"0.0E+0";if(Ie<0)return"-"+Fe(Ve,-Ie);var Ue=Ve.indexOf(".");Ue===-1&&(Ue=Ve.indexOf("E"));var We=Math.floor(Math.log(Ie)*Math.LOG10E)%Ue;if(We<0&&(We+=Ue),ve=(Ie/Math.pow(10,We)).toPrecision(Ge+1+(Ue+We)%Ue),!ve.match(/[Ee]/)){var it=Math.floor(Math.log(Ie)*Math.LOG10E);ve.indexOf(".")===-1?ve=ve.charAt(0)+"."+ve.substr(1)+"E+"+(it-ve.length+We):ve+="E+"+(it-We),ve=ve.replace(/\+-/,"-")}ve=ve.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(St,Kt,bl,hl){return Kt+bl+hl.substr(0,(Ue+We)%Ue)+"."+hl.substr(We)+"E"})}else ve=Ie.toExponential(Ge);return Ve.match(/E\+00$/)&&ve.match(/e[+-]\d$/)&&(ve=ve.substr(0,ve.length-1)+"0"+ve.charAt(ve.length-1)),Ve.match(/E\-/)&&ve.match(/e\+/)&&(ve=ve.replace(/e\+/,"e")),ve.replace("e","E")}function Ze(Ve,Ie,ve){if(Ve.charCodeAt(0)===40&&!Ie.match(et)){var Ge=Ie.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return ve>=0?Ze("n",Ge,ve):"("+Ze("n",Ge,-ve)+")"}if(Ie.charCodeAt(Ie.length-1)===44)return je(Ve,Ie,ve);if(Ie.indexOf("%")!==-1)return De(Ve,Ie,ve);if(Ie.indexOf("E")!==-1)return Fe(Ie,ve);if(Ie.charCodeAt(0)===36)return"$"+Ze(Ve,Ie.substr(Ie.charAt(1)==" "?2:1),ve);var Ue,We,it,St,Kt=Math.abs(ve),bl=ve<0?"-":"";if(Ie.match(/^00+$/))return bl+o(Kt,Ie.length);if(Ie.match(/^[#?]+$/))return Ue=""+ve,ve===0&&(Ue=""),Ue.length>Ie.length?Ue:wt(Ie.substr(0,Ie.length-Ue.length))+Ue;if(We=Ie.match(Ye))return Ke(We,Kt,bl);if(Ie.match(/^#+0+$/))return bl+o(Kt,Ie.length-Ie.indexOf("0"));if(We=Ie.match(ft))return Ue=(""+ve).replace(/^([^\.]+)$/,"$1."+wt(We[1])).replace(/\.$/,"."+wt(We[1])),Ue=Ue.replace(/\.(\d*)$/,function(_e,Ne){return"."+Ne+l("0",wt(We[1]).length-Ne.length)}),Ie.indexOf("0.")!==-1?Ue:Ue.replace(/^0\./,".");if(Ie=Ie.replace(/^#+([0.])/,"$1"),We=Ie.match(/^(0*)\.(#*)$/))return bl+(""+Kt).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,We[1].length?"0.":".");if(We=Ie.match(/^#{1,3},##0(\.?)$/))return bl+E(""+Kt);if(We=Ie.match(/^#,##0\.([#0]*0)$/))return ve<0?"-"+Ze(Ve,Ie,-ve):E(""+ve)+"."+l("0",We[1].length);if(We=Ie.match(/^#,#*,#0/))return Ze(Ve,Ie.replace(/^#,#*,/,""),ve);if(We=Ie.match(/^([0#]+)(\\?-([0#]+))+$/))return Ue=t(Ze(Ve,Ie.replace(/[\\-]/g,""),ve)),it=0,t(t(Ie.replace(/\\/g,"")).replace(/[0#]/g,function(_e){return it<Ue.length?Ue.charAt(it++):_e==="0"?"0":""}));if(Ie.match(vt))return Ue=Ze(Ve,"##########",ve),"("+Ue.substr(0,3)+") "+Ue.substr(3,3)+"-"+Ue.substr(6);var hl="";if(We=Ie.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return it=Math.min(We[4].length,7),St=O(Kt,Math.pow(10,it)-1,!1),Ue=""+bl,hl=B("n",We[1],St[1]),hl.charAt(hl.length-1)==" "&&(hl=hl.substr(0,hl.length-1)+"0"),Ue+=hl+We[2]+"/"+We[3],hl=s(St[2],it),hl.length<We[4].length&&(hl=wt(We[4].substr(We[4].length-hl.length))+hl),Ue+=hl,Ue;if(We=Ie.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return it=Math.min(Math.max(We[1].length,We[4].length),7),St=O(Kt,Math.pow(10,it)-1,!0),bl+(St[0]||(St[1]?"":"0"))+" "+(St[1]?a(St[1],it)+We[2]+"/"+We[3]+s(St[2],it):l(" ",2*it+1+We[2].length+We[3].length));if(We=Ie.match(/^[#0?]+$/))return Ue=""+ve,Ie.length<=Ue.length?Ue:wt(Ie.substr(0,Ie.length-Ue.length))+Ue;if(We=Ie.match(/^([#0]+)\.([#0]+)$/)){Ue=""+ve.toFixed(Math.min(We[2].length,10)).replace(/([^0])0+$/,"$1"),it=Ue.indexOf(".");var Rr=Ie.indexOf(".")-it,Di=Ie.length-Ue.length-Rr;return wt(Ie.substr(0,Rr)+Ue+Ie.substr(Ie.length-Di))}if(We=Ie.match(/^00,000\.([#0]*0)$/))return ve<0?"-"+Ze(Ve,Ie,-ve):E(""+ve).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_e){return"00,"+(_e.length<3?o(0,3-_e.length):"")+_e})+"."+o(0,We[1].length);switch(Ie){case"###,###":case"##,###":case"#,###":var ln=E(""+Kt);return ln!=="0"?bl+ln:"";default:if(Ie.match(/\.[0#?]*$/))return Ze(Ve,Ie.slice(0,Ie.lastIndexOf(".")),ve)+wt(Ie.slice(Ie.lastIndexOf(".")))}throw new Error("unsupported format |"+Ie+"|")}return function(Ie,ve,Ge){return(Ge|0)===Ge?Ze(Ie,ve,Ge):Te(Ie,ve,Ge)}}();function U(te){for(var re=[],fe=!1,Me=0,ye=0;Me<te.length;++Me)switch(te.charCodeAt(Me)){case 34:fe=!fe;break;case 95:case 42:case 92:++Me;break;case 59:re[re.length]=te.substr(ye,Me-ye),ye=Me+1}if(re[re.length]=te.substr(ye),fe===!0)throw new Error("Format |"+te+"| unterminated string ");return re}n._split=U;var X=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function le(te){for(var re=0,fe="",Me="";re<te.length;)switch(fe=te.charAt(re)){case"G":g(te,re)&&(re+=6),re++;break;case'"':for(;te.charCodeAt(++re)!==34&&re<te.length;);++re;break;case"\\":re+=2;break;case"_":re+=2;break;case"@":++re;break;case"B":case"b":if(te.charAt(re+1)==="1"||te.charAt(re+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(te.substr(re,3).toUpperCase()==="A/P"||te.substr(re,5).toUpperCase()==="AM/PM"||te.substr(re,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++re;break;case"[":for(Me=fe;te.charAt(re++)!=="]"&&re<te.length;)Me+=te.charAt(re);if(Me.match(X))return!0;break;case".":case"0":case"#":for(;re<te.length&&("0#?.,E+-%".indexOf(fe=te.charAt(++re))>-1||fe=="\\"&&te.charAt(re+1)=="-"&&"0#".indexOf(te.charAt(re+2))>-1););break;case"?":for(;te.charAt(++re)===fe;);break;case"*":++re,(te.charAt(re)==" "||te.charAt(re)=="*")&&++re;break;case"(":case")":++re;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;re<te.length&&"0123456789".indexOf(te.charAt(++re))>-1;);break;case" ":++re;break;default:++re;break}return!1}n.is_date=le;function he(te,re,fe,Me){for(var ye=[],Ye="",Ce=0,Ke="",ft="t",et,vt,wt,be="H";Ce<te.length;)switch(Ke=te.charAt(Ce)){case"G":if(!g(te,Ce))throw new Error("unrecognized character "+Ke+" in "+te);ye[ye.length]={t:"G",v:"General"},Ce+=7;break;case'"':for(Ye="";(wt=te.charCodeAt(++Ce))!==34&&Ce<te.length;)Ye+=String.fromCharCode(wt);ye[ye.length]={t:"t",v:Ye},++Ce;break;case"\\":var Q=te.charAt(++Ce),me=Q==="("||Q===")"?Q:"t";ye[ye.length]={t:me,v:Q},++Ce;break;case"_":ye[ye.length]={t:"t",v:" "},Ce+=2;break;case"@":ye[ye.length]={t:"T",v:re},++Ce;break;case"B":case"b":if(te.charAt(Ce+1)==="1"||te.charAt(Ce+1)==="2"){if(et==null&&(et=F(re,fe,te.charAt(Ce+1)==="2"),et==null))return"";ye[ye.length]={t:"X",v:te.substr(Ce,2)},ft=Ke,Ce+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":Ke=Ke.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(re<0)return"";if(et==null&&(et=F(re,fe),et==null))return"#####";for(Ye=Ke;++Ce<te.length&&te.charAt(Ce).toLowerCase()===Ke;)Ye+=Ke;Ke==="m"&&ft.toLowerCase()==="h"&&(Ke="M"),Ke==="h"&&(Ke=be),ye[ye.length]={t:Ke,v:Ye},ft=Ke;break;case"A":case"a":case"\u4E0A":var xe={t:Ke,v:Ke};if(et==null&&(et=F(re,fe)),te.substr(Ce,3).toUpperCase()==="A/P"?(et!=null&&(xe.v=et.H>=12?"P":"A"),xe.t="T",be="h",Ce+=3):te.substr(Ce,5).toUpperCase()==="AM/PM"?(et!=null&&(xe.v=et.H>=12?"PM":"AM"),xe.t="T",Ce+=5,be="h"):te.substr(Ce,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(et!=null&&(xe.v=et.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),xe.t="T",Ce+=5,be="h"):(xe.t="t",++Ce),et==null&&xe.t==="T")return"";ye[ye.length]=xe,ft=Ke;break;case"[":for(Ye=Ke;te.charAt(Ce++)!=="]"&&Ce<te.length;)Ye+=te.charAt(Ce);if(Ye.slice(-1)!=="]")throw'unterminated "[" block: |'+Ye+"|";if(Ye.match(X)){if(et==null&&(et=F(re,fe),et==null))return"";ye[ye.length]={t:"Z",v:Ye.toLowerCase()},ft=Ye.charAt(1)}else Ye.indexOf("$")>-1&&(Ye=(Ye.match(/\$([^-\[\]]*)/)||[])[1]||"$",le(te)||(ye[ye.length]={t:"t",v:Ye}));break;case".":if(et!=null){for(Ye=Ke;++Ce<te.length&&(Ke=te.charAt(Ce))==="0";)Ye+=Ke;ye[ye.length]={t:"s",v:Ye};break}case"0":case"#":for(Ye=Ke;++Ce<te.length&&"0#?.,E+-%".indexOf(Ke=te.charAt(Ce))>-1;)Ye+=Ke;ye[ye.length]={t:"n",v:Ye};break;case"?":for(Ye=Ke;te.charAt(++Ce)===Ke;)Ye+=Ke;ye[ye.length]={t:Ke,v:Ye},ft=Ke;break;case"*":++Ce,(te.charAt(Ce)==" "||te.charAt(Ce)=="*")&&++Ce;break;case"(":case")":ye[ye.length]={t:Me===1?"t":Ke,v:Ke},++Ce;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(Ye=Ke;Ce<te.length&&"0123456789".indexOf(te.charAt(++Ce))>-1;)Ye+=te.charAt(Ce);ye[ye.length]={t:"D",v:Ye};break;case" ":ye[ye.length]={t:Ke,v:Ke},++Ce;break;case"$":ye[ye.length]={t:"t",v:"$"},++Ce;break;default:if("\xA4\u0E3FBsBr\u20B5\u20A1\u20AB\u0192FtRs.\u20ADkr\xA3\u20A4Lm\u20A5\u20A6\u20B1PQRSkRp\u09F2\u09F3R$S/.\u3012\u20AE\u20A9\xA5NT\uFFE5z\u0142\u20B4\u20AA\u17DB\u0440\u0443\u0431\u20AC\uFF04,$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP$\uFFE5LekdinAf$dhAflRial?\uFFE1BirrKzMOPPGKRsGsB/R$\u0440\u0440levkrKMzBsPNuFBuKPkrRD$NfkCFA?CVEGMDFrCDHTGNAfLFdjKGSFGGHSRielKCFknKshLSLL\uFFE1LtRFRONArRfMWKRMMURsMROS/KMDLMTnRC$kr\u20ACGELCHFSLLSCRDbSZLSDGSOSSomFCFPTShT$VUVQUGX\u0433\u0440\u043DsomWSTNT$FtDramRpZMWFCFA".indexOf(Ke)===-1)throw new Error("unrecognized character "+Ke+" in "+te);ye[ye.length]={t:"t",v:Ke},++Ce;break}var Te=0,je=0,De;for(Ce=ye.length-1,ft="t";Ce>=0;--Ce)switch(ye[Ce].t){case"h":case"H":ye[Ce].t=be,ft="h",Te<1&&(Te=1);break;case"s":(De=ye[Ce].v.match(/\.0+$/))&&(je=Math.max(je,De[0].length-1)),Te<3&&(Te=3);case"d":case"y":case"M":case"e":ft=ye[Ce].t;break;case"m":ft==="s"&&(ye[Ce].t="M",Te<2&&(Te=2));break;case"X":break;case"Z":Te<1&&ye[Ce].v.match(/[Hh]/)&&(Te=1),Te<2&&ye[Ce].v.match(/[Mm]/)&&(Te=2),Te<3&&ye[Ce].v.match(/[Ss]/)&&(Te=3)}switch(Te){case 0:break;case 1:et.u>=.5&&(et.u=0,++et.S),et.S>=60&&(et.S=0,++et.M),et.M>=60&&(et.M=0,++et.H);break;case 2:et.u>=.5&&(et.u=0,++et.S),et.S>=60&&(et.S=0,++et.M);break}var Fe="",Ze;for(Ce=0;Ce<ye.length;++Ce)switch(ye[Ce].t){case"t":case"T":case" ":case"D":break;case"X":ye[Ce].v="",ye[Ce].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":ye[Ce].v=N(ye[Ce].t.charCodeAt(0),ye[Ce].v,et,je),ye[Ce].t="t";break;case"n":case"?":for(Ze=Ce+1;ye[Ze]!=null&&((Ke=ye[Ze].t)==="?"||Ke==="D"||(Ke===" "||Ke==="t")&&ye[Ze+1]!=null&&(ye[Ze+1].t==="?"||ye[Ze+1].t==="t"&&ye[Ze+1].v==="/")||ye[Ce].t==="("&&(Ke===" "||Ke==="n"||Ke===")")||Ke==="t"&&(ye[Ze].v==="/"||ye[Ze].v===" "&&ye[Ze+1]!=null&&ye[Ze+1].t=="?"));)ye[Ce].v+=ye[Ze].v,ye[Ze]={v:"",t:";"},++Ze;Fe+=ye[Ce].v,Ce=Ze-1;break;case"G":ye[Ce].t="t",ye[Ce].v=A(re,fe);break}var Ve="",Ie,ve;if(Fe.length>0){Fe.charCodeAt(0)==40?(Ie=re<0&&Fe.charCodeAt(0)===45?-re:re,ve=B("n",Fe,Ie)):(Ie=re<0&&Me>1?-re:re,ve=B("n",Fe,Ie),Ie<0&&ye[0]&&ye[0].t=="t"&&(ve=ve.substr(1),ye[0].v="-"+ye[0].v)),Ze=ve.length-1;var Ge=ye.length;for(Ce=0;Ce<ye.length;++Ce)if(ye[Ce]!=null&&ye[Ce].t!="t"&&ye[Ce].v.indexOf(".")>-1){Ge=Ce;break}var Ue=ye.length;if(Ge===ye.length&&ve.indexOf("E")===-1){for(Ce=ye.length-1;Ce>=0;--Ce)ye[Ce]==null||"n?".indexOf(ye[Ce].t)===-1||(Ze>=ye[Ce].v.length-1?(Ze-=ye[Ce].v.length,ye[Ce].v=ve.substr(Ze+1,ye[Ce].v.length)):Ze<0?ye[Ce].v="":(ye[Ce].v=ve.substr(0,Ze+1),Ze=-1),ye[Ce].t="t",Ue=Ce);Ze>=0&&Ue<ye.length&&(ye[Ue].v=ve.substr(0,Ze+1)+ye[Ue].v)}else if(Ge!==ye.length&&ve.indexOf("E")===-1){for(Ze=ve.indexOf(".")-1,Ce=Ge;Ce>=0;--Ce)if(!(ye[Ce]==null||"n?".indexOf(ye[Ce].t)===-1)){for(vt=ye[Ce].v.indexOf(".")>-1&&Ce===Ge?ye[Ce].v.indexOf(".")-1:ye[Ce].v.length-1,Ve=ye[Ce].v.substr(vt+1);vt>=0;--vt)Ze>=0&&(ye[Ce].v.charAt(vt)==="0"||ye[Ce].v.charAt(vt)==="#")&&(Ve=ve.charAt(Ze--)+Ve);ye[Ce].v=Ve,ye[Ce].t="t",Ue=Ce}for(Ze>=0&&Ue<ye.length&&(ye[Ue].v=ve.substr(0,Ze+1)+ye[Ue].v),Ze=ve.indexOf(".")+1,Ce=Ge;Ce<ye.length;++Ce)if(!(ye[Ce]==null||"n?(".indexOf(ye[Ce].t)===-1&&Ce!==Ge)){for(vt=ye[Ce].v.indexOf(".")>-1&&Ce===Ge?ye[Ce].v.indexOf(".")+1:0,Ve=ye[Ce].v.substr(0,vt);vt<ye[Ce].v.length;++vt)Ze<ve.length&&(Ve+=ve.charAt(Ze++));ye[Ce].v=Ve,ye[Ce].t="t",Ue=Ce}}}for(Ce=0;Ce<ye.length;++Ce)ye[Ce]!=null&&"n?".indexOf(ye[Ce].t)>-1&&(Ie=Me>1&&re<0&&Ce>0&&ye[Ce-1].v==="-"?-re:re,ye[Ce].v=B(ye[Ce].t,ye[Ce].v,Ie),ye[Ce].t="t");var We="";for(Ce=0;Ce!==ye.length;++Ce)ye[Ce]!=null&&(We+=ye[Ce].v);return We}n._eval=he;var Z=/\[[=<>]/,ae=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function J(te,re){if(re==null)return!1;var fe=parseFloat(re[2]);switch(re[1]){case"=":if(te==fe)return!0;break;case">":if(te>fe)return!0;break;case"<":if(te<fe)return!0;break;case"<>":if(te!=fe)return!0;break;case">=":if(te>=fe)return!0;break;case"<=":if(te<=fe)return!0;break}return!1}function pe(te,re){var fe=U(te),Me=fe.length,ye=fe[Me-1].indexOf("@");if(Me<4&&ye>-1&&--Me,fe.length>4)throw new Error("cannot find right format for |"+fe.join("|")+"|");if(typeof re!="number")return[4,fe.length===4||ye>-1?fe[fe.length-1]:"@"];switch(fe.length){case 1:fe=ye>-1?["General","General","General",fe[0]]:[fe[0],fe[0],fe[0],"@"];break;case 2:fe=ye>-1?[fe[0],fe[0],fe[0],fe[1]]:[fe[0],fe[1],fe[0],"@"];break;case 3:fe=ye>-1?[fe[0],fe[1],fe[0],fe[2]]:[fe[0],fe[1],fe[2],"@"];break;case 4:break}var Ye=re>0?fe[0]:re<0?fe[1]:fe[2];if(fe[0].indexOf("[")===-1&&fe[1].indexOf("[")===-1)return[Me,Ye];if(fe[0].match(Z)!=null||fe[1].match(Z)!=null){var Ce=fe[0].match(ae),Ke=fe[1].match(ae);return J(re,Ce)?[Me,fe[0]]:J(re,Ke)?[Me,fe[1]]:[Me,fe[Ce!=null&&Ke!=null?2:1]]}return[Me,Ye]}function K(te,re,fe){fe==null&&(fe={});var Me="";switch(typeof te){case"string":te=="m/d/yy"&&fe.dateNF?Me=fe.dateNF:Me=te;break;case"number":te==14&&fe.dateNF?Me=fe.dateNF:Me=(fe.table!=null?fe.table:x)[te],Me==null&&(Me=fe.table&&fe.table[_[te]]||x[_[te]]),Me==null&&(Me=I[te]||"General");break}var ye=/^(w|W)((0?)|(0\.0+))$/;if(Me.match(ye)){if(isNaN(re))return re;var Ye=Me.slice(1),Ce=!1;!isNaN(re)&&Number(re)<0&&(Ce=!0,re=Math.abs(re));var Ke=parseInt(re),ft=Ke.toString().length;if(ft>4){if(ft>8){var et=parseInt(re/1e8),vt=parseInt(parseFloat(re).subtract(et*1e8)/1e4),wt=parseFloat(re).subtract(et*1e8+vt*1e4);Ye!=""&&(wt=(0,$o.default)(wt).format(Ye)),re=et+"\u4EBF"+vt+"\u4E07"+wt}else{var vt=parseInt(re/1e4),wt=parseFloat(re).subtract(vt*1e4);Ye!=""&&(wt=(0,$o.default)(wt).format(Ye)),re=vt+"\u4E07"+wt}if(re.indexOf("\u4EBF0\u4E070")!=-1?re=re.replace("0\u4E070",""):re.indexOf("\u4EBF0\u4E07")!=-1?re=re.replace("0\u4E07",""):re.indexOf("\u4E070")!=-1&&(re=re.replace("\u4E070","\u4E07")),re.indexOf("\u4EBF")!=-1&&re.indexOf("\u4E07")==-1){var be=re.substring(re.indexOf("\u4EBF")+1);if(be.substring(0,1)!=="."&&be!=""){switch((parseInt(be)+"").length){case 1:be="000"+be;break;case 2:be="00"+be;break;case 3:be="0"+be;break}re=re.substring(0,re.indexOf("\u4EBF")+1)+be}}else if(re.indexOf("\u4EBF")==-1&&re.indexOf("\u4E07")!=-1){var Q=re.substring(re.indexOf("\u4E07")+1);if(Q.substring(0,1)!=="."&&Q!=""){switch((parseInt(Q)+"").length){case 1:Q="000"+Q;break;case 2:Q="00"+Q;break;case 3:Q="0"+Q;break}re=re.substring(0,re.indexOf("\u4E07")+1)+Q}}else if(re.indexOf("\u4EBF")!=-1&&re.indexOf("\u4E07")!=-1){var be=re.substring(re.indexOf("\u4EBF")+1,re.indexOf("\u4E07")),Q=re.substring(re.indexOf("\u4E07")+1);switch((parseInt(be)+"").length){case 1:be="000"+be;break;case 2:be="00"+be;break;case 3:be="0"+be;break}if(re=re.substring(0,re.indexOf("\u4EBF")+1)+be+re.substring(re.indexOf("\u4E07")),Q.substring(0,1)!=="."&&Q!=""){switch((parseInt(Q)+"").length){case 1:Q="000"+Q;break;case 2:Q="00"+Q;break;case 3:Q="0"+Q;break}re=re.substring(0,re.indexOf("\u4E07")+1)+Q}}}else Ye!=""&&(re=(0,$o.default)(re).format(Ye));return Ce?"-"+re:re}if(g(Me,0))return A(re,fe);re instanceof Date&&(re=C(re,fe.date1904));var me=pe(Me,re);if(g(me[1]))return A(re,fe);if(re===!0)re="TRUE";else if(re===!1)re="FALSE";else if(re===""||re==null)return"";return he(me[1],re,fe,me[0])}function se(te,re){if(typeof re!="number"){re=+re||-1;for(var fe=0;fe<392;++fe){if(x[fe]==null){re<0&&(re=fe);continue}if(x[fe]==te){re=fe;break}}re<0&&(re=391)}return x[re]=te,re}n.load=se,n._table=x,n.get_table=function(){return x},n.load_table=function(re){for(var fe=0;fe!=392;++fe)re[fe]!==void 0&&se(re[fe],fe)},n.init_table=p,n.format=K};Fx(dn);w6={"General Number":"General","General Date":dn._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":dn._table[15],"Short Date":dn._table[14],"Long Time":dn._table[19],"Medium Time":dn._table[18],"Short Time":dn._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:dn._table[2],Standard:dn._table[4],Percent:dn._table[10],Scientific:dn._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'},x6=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,n=/_x([\da-fA-F]{4})_/g;return function t(l){var o=l+"",a=o.indexOf("<![CDATA[");if(a==-1)return o.replace(e,function(u,f){return encodings[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(n,function(u,f){return String.fromCharCode(parseInt(f,16))});var s=o.indexOf("]]>");return t(o.slice(0,a))+o.slice(a+9,s)+t(o.slice(s+3))}}(),Mx=new Date(1899,11,31,0,0,0),_6=Mx.getTime(),Dx=new Date(1900,2,1,0,0,0);fh=new Date("2017-02-19T19:06:09.000Z");isNaN(fh.getFullYear())&&(fh=new Date("2/19/17"));Ax=fh.getFullYear()==2017});function er(e,n,t,l){t==null&&(t=h.flowdata);let o=t[e][n],a;if(V(l)=="object"?(o==null?o=l:(l.f!=null?o.f=l.f:o.hasOwnProperty("f")&&delete o.f,l.spl!=null&&(o.spl=l.spl),l.ct!=null&&(o.ct=l.ct)),V(l.v)=="object"?a=l.v.v:a=l.v):a=l,rt(a)){V(o)=="object"?(delete o.m,delete o.v):o=null,t[e][n]=o;return}(rt(o)||(V(o)==="string"||V(o)==="number")&&o===l)&&(o={});let s=a.toString();if(s.substr(0,1)=="'")o.m=s.substr(1),o.ct={fa:"@",t:"s"},o.v=s.substr(1),o.qp=1;else if(o.qp==1)o.m=s,o.ct={fa:"@",t:"s"},o.v=s;else if(s.toUpperCase()==="TRUE")o.m="TRUE",o.ct={fa:"General",t:"b"},o.v=!0;else if(s.toUpperCase()==="FALSE")o.m="FALSE",o.ct={fa:"General",t:"b"},o.v=!1;else if(s.substr(-1)==="%"&&Y(s.substring(0,s.length-1)))o.ct={fa:"0%",t:"n"},o.v=s.substring(0,s.length-1)/100,o.m=a;else if(q(a))o.m=s,o.ct!=null?o.ct.t="e":o.ct={fa:"General",t:"e"},o.v=a;else if(o.f!=null&&Y(a)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(a))if(o.v=parseFloat(a),o.ct==null&&(o.ct={fa:"General",t:"n"}),o.v==Infinity||o.v==-Infinity)o.m=o.v.toString();else if(o.v.toString().indexOf("e")>-1){let u;o.v.toString().split(".").length==1?u=0:u=o.v.toString().split(".")[1].split("e")[0].length,u>5&&(u=5),o.m=o.v.toExponential(u).toString()}else{let u=Math.round(o.v*1e9)/1e9;if(o.ct==null){let f=nl(u);o.m=f[0].toString()}else{let f=$l(o.ct.fa,u);o.m=f.toString()}}else if(o.ct!=null&&o.ct.fa=="@")o.m=s,o.v=a;else if(o.ct!=null&&o.ct.fa!=null&&o.ct.fa!="General"){Y(a)&&(a=parseFloat(a));let u=$l(o.ct.fa,a);u===a?(u=nl(a),o.m=u[0].toString(),o.ct=u[1],o.v=u[2]):(o.m=u.toString(),o.v=a)}else if(Y(a)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(a))if(typeof a=="string"&&a.split("").every(f=>f=="0"||f==".")&&(a=parseFloat(a)),o.v=a,o.ct={fa:"General",t:"n"},o.v==Infinity||o.v==-Infinity)o.m=o.v.toString();else{let u=nl(o.v);o.m=u[0].toString()}else{let u=nl(a);o.m=u[0].toString(),o.ct=u[1],o.v=u[2]}if(!He.allowUpdate&&!lt.pointEdit&&o.ct!=null&&/^(w|W)((0?)|(0\.0+))$/.test(o.ct.fa)==!1&&o.ct.t=="n"&&o.v!=null&&parseInt(o.v).toString().length>4){let u=lt.autoFormatw.toString().toUpperCase(),f=lt.accuracy,m=Px(u,f);m!="General"&&(o.ct.fa=m,o.m=$l(m,o.v))}t[e][n]=o}function Px(e,n){let t="0.",l;if(e=="TRUE"){if(n==null)return"w";{let o=parseInt(n);if(o==0)return"w0";t="w0.";for(let a=0;a<o;a++)t+="0";l=t}}else{if(n==null)return"General";{let o=parseInt(n);if(o==0)return"0";for(let a=0;a<o;a++)t+="0";l=t}}return l.toString()}var import_plugin,io=Tt(()=>{import_plugin=Le(Be());gl();Gl();Hn();wr();bn();Ut()});function mn(){if(h.luckysheet_select_save.length==0)return;let e=Infinity,n=-Infinity,t=0,l=0,o=0;for(let u=0;u<h.luckysheet_select_save.length;u++){let f=$y(h.luckysheet_select_save[u]);for(let m=0;m<f.length;m++)for(let d=0;d<f[0].length;d++){if(rt(f[m][d])||(l++,f[m][d].ct!=null&&f[m][d].ct.t=="d"))continue;let g=f[m][d].v;!Y(g)||(g=parseFloat(g),t+=g,g<e&&(e=g),g>n&&(n=g))}}let a=Oe().formula,s="";s+="<span>"+a.count+":"+l+"</span>",(isFinite(n)||isFinite(e))&&(s+="<span>"+a.sum+":"+$l("w",t)+"</span>",s+="<span>"+a.average+":"+$l("w",Math.round(t/l*1e4)/1e4)+"</span>"),isFinite(n)&&(s+="<span>"+a.max+":"+$l("w",n)+"</span>"),isFinite(e)&&(s+="<span>"+a.min+":"+$l("w",e)+"</span>"),$("#luckysheet-sta-content").html(s)}var import_plugin,xc=Tt(()=>{import_plugin=Le(Be());Ut();mr();Gl();Hn();Rl()});function _c(e,n,t,l,o){t==null&&(t=!0),e||(e="down"),n||(n="cell"),o==null&&(o=!1);let a=h.luckysheet_select_save[h.luckysheet_select_save.length-1],s=a.row==null?0:a.row[0],u=a.column==null?0:a.column[0],f=a.row==null?0:a.row[0],m=a.column==null?0:a.column[0],d=a.row==null?0:a.row[1],g=a.column==null?0:a.column[1];if(v.fucntionboxshow(s,u),n=="range"){var b=h.luckysheet_shiftpositon.row[0],y=h.luckysheet_shiftpositon.column[0];let O=h.luckysheet_shiftpositon.row[1],F=h.luckysheet_shiftpositon.column[1];e=="down"||e=="up"?O<d?s=a.row==null?0:a.row[1]:b>f?s=a.row==null?0:a.row[0]:O==d&&b==f&&(e=="down"?s=a.row==null?0:a.row[1]:s=a.row==null?0:a.row[0]):(e=="right"||e=="left")&&(F<g?u=a.column==null?0:a.column[1]:y>m?u=a.column==null?0:a.column[0]:F==g&&y==m&&(e=="right"?u=a.column==null?0:a.column[1]:u=a.column==null?0:a.column[0]))}let p=h.flowdata.length,x=h.flowdata[0].length,_=h.flowdata,S="",I=0;if(e=="up"){if(s==0)return;{let O=[],F=null,D=0,k=null;for(let w=m;w<=g;w++){O=[],D=0;for(let C=s-1;C>=0;C--){let T=_[C][w];if(V(T)=="object"&&rt(T.v)||rt(T)?O.push(!1):O.push(!0),O.length>1){if(O[D]==!0&&O[D-1]==!1){F=C;break}else if(O[D]==!1&&O[D-1]==!0){F=C+1;break}}D++}F==null&&(F=0),(k==null||F<k)&&(k=F)}S="down",I=k-s}}else if(e=="down"){if(s==p-1)return;{let O=[],F=null,D=0,k=null;for(let w=m;w<=g;w++){O=[],D=0;for(let C=s+1;C<_.length;C++){let T=_[C][w];if(V(T)=="object"&&rt(T.v)||rt(T)?O.push(!1):O.push(!0),O.length>1){if(O[D]==!0&&O[D-1]==!1){F=C;break}else if(O[D]==!1&&O[D-1]==!0){F=C-1;break}}D++}F==null&&(F=_.length-1),(k==null||F>k)&&(k=F)}S="down",I=k-s}}else if(e=="left"){if(u==0)return;{let O=[],F=null,D=0,k=null;for(let w=f;w<=d;w++){O=[],D=0;for(let C=u-1;C>=0;C--){let T=_[w][C];if(V(T)=="object"&&rt(T.v)||rt(T)?O.push(!1):O.push(!0),O.length>1){if(O[D]==!0&&O[D-1]==!1){F=C;break}else if(O[D]==!1&&O[D-1]==!0){F=C+1;break}}D++}F==null&&(F=0),(k==null||F<k)&&(k=F)}S="right",I=k-u}}else if(e=="right"){if(u==x-1)return;{let O=[],F=null,D=0,k=null;for(let w=f;w<=d;w++){O=[],D=0;for(let C=u+1;C<_[0].length;C++){let T=_[w][C];if(V(T)=="object"&&rt(T.v)||rt(T)?O.push(!1):O.push(!0),O.length>1){if(O[D]==!0&&O[D-1]==!1){F=C;break}else if(O[D]==!1&&O[D-1]==!0){F=C-1;break}}D++}F==null&&(F=_[0].length-1),(k==null||F>k)&&(k=F)}S="right",I=k-u}}if(n=="range"&&(e=="up"?p_endR<d&&I+s<p_endR&&(I=p_endR-s):e=="down"?b>f&&I+s>b&&(I=b-s):e=="left"?p_endC<g&&I+u<p_endC&&(I=p_endC-u):e=="right"&&y>m&&I+u>y&&(I=y-u),l!=null&&Math.abs(I)>Math.abs(l)&&(I=l)),!o)n=="cell"?lr(S,I,"rangeOfSelect",t):n=="range"&&Ya(S,I,"rangeOfSelect",t);else return I}function lr(e,n,t,l){l==null&&(l=!0),e||e=="down";let o=h.flowdata.length,a=h.flowdata[0].length,s,u,f,m,d,g,b,y;if(t=="rangeOfSelect"){let F=h.luckysheet_select_save[h.luckysheet_select_save.length-1],D;F.row_focus==null?D=F.row[0]:D=F.row_focus;let k;F.column_focus==null?k=F.column[0]:k=F.column_focus;let w=ht.mergeborer(h.flowdata,D,k);if(w){let A=w.row[2],M=w.row[3],P=w.column[2],N=w.column[3];n>0?e=="down"?(D=M,k=P):e=="right"&&(D=A,k=N):(D=A,k=P)}let C=F.moveXY==null?D:F.moveXY.x,T=F.moveXY==null?k:F.moveXY.y;e=="down"?(D+=n,C=D):e=="right"&&(k+=n,T=k),D>=o&&(D=o-1,C=D),D<0&&(D=0,C=D),k>=a&&(k=a-1,T=k),k<0&&(k=0,T=k);let z=ht.mergeborer(h.flowdata,D,k);z?(s=z.row[1],u=z.row[0],f=z.row[2],m=z.row[3],d=z.column[1],g=z.column[0],b=z.column[2],y=z.column[3]):(s=h.visibledatarow[C],u=C-1==-1?0:h.visibledatarow[C-1],d=h.visibledatacolumn[T],g=T-1==-1?0:h.visibledatacolumn[T-1],f=m=D,b=y=k),F.row=[f,m],F.column=[b,y],F.row_focus=f,F.column_focus=b,F.moveXY={x:C,y:T},Zt(),Pt.pivotclick(f,b),v.fucntionboxshow(f,b)}else if(t=="rangeOfFormula"){let F=v.func_selectedrange,D;F.row_focus==null?D=F.row[0]:D=F.row_focus;let k;F.column_focus==null?k=F.column[0]:k=F.column_focus;let w=ht.mergeborer(h.flowdata,D,k);if(w){let A=w.row[2],M=w.row[3],P=w.column[2],N=w.column[3];n>0?e=="down"?(D=M,k=P):e=="right"&&(D=A,k=N):(D=A,k=P)}let C=F.moveXY==null?D:F.moveXY.x,T=F.moveXY==null?k:F.moveXY.y;e=="down"?(D+=n,C=D):e=="right"&&(k+=n,T=k),D>=o&&(D=o-1,C=D),D<0&&(D=0,C=D),k>=a&&(k=a-1,T=k),k<0&&(k=0,T=k);let z=ht.mergeborer(h.flowdata,D,k);z?(s=z.row[1],u=z.row[0],f=z.row[2],m=z.row[3],d=z.column[1],g=z.column[0],b=z.column[2],y=z.column[3]):(s=h.visibledatarow[C],u=C-1==-1?0:h.visibledatarow[C-1],f=C,m=C,d=h.visibledatacolumn[T],g=T-1==-1?0:h.visibledatacolumn[T-1],b=T,y=T),v.func_selectedrange={left:g,width:d-g-1,top:u,height:s-u-1,left_move:g,width_move:d-g-1,top_move:u,height_move:s-u-1,row:[f,m],column:[b,y],row_focus:f,column_focus:b,moveXY:{x:C,y:T}},$("#luckysheet-formula-functionrange-select").css({left:g,width:d-g-1,top:u,height:s-u-1}).show(),v.rangeSetValue({row:[f,m],column:[b,y]})}let p=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),_=$("#luckysheet-cell-main").height(),S=$("#luckysheet-cell-main").width(),I=0,O=0;d-p-S+20>0?(I=d-S+20,l&&$("#luckysheet-scrollbar-x").scrollLeft(I)):g-p-20<0&&(I=g-20,l&&$("#luckysheet-scrollbar-x").scrollLeft(I)),s-x-_+20>0?(O=s-_+20,l&&$("#luckysheet-scrollbar-y").scrollTop(O)):u-x-20<0&&(O=u-20,l&&$("#luckysheet-scrollbar-y").scrollTop(O)),clearTimeout(h.countfuncTimeout),mn(),He.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save)}function Ts(e,n,t){t||(t=!0);let l,o,a,s;if(n=="rangeOfSelect"){let y=h.luckysheet_select_save[h.luckysheet_select_save.length-1],p=y.row_focus,x=y.column_focus,_=!1,S={};if(h.config.merge!=null&&p+"_"+x in h.config.merge&&(_=!0,S=h.config.merge[p+"_"+x]),e=="down"){if(p==h.flowdata.length-1)return;_?p=Sl("down",x,S.r+S.rs-1,h.flowdata.length-1):p=Sl("down",x,p,h.flowdata.length-1)}else if(e=="up"){if(p==0)return;_?p=Sl("up",x,0,S.r):p=Sl("up",x,0,p)}else if(e=="right"){if(x==h.flowdata[0].length-1)return;_?x=Sl("right",p,S.c+S.cs-1,h.flowdata[0].length-1):x=Sl("right",p,x,h.flowdata[0].length-1)}else if(e=="left"){if(x==0)return;_?x=Sl("left",p,0,S.c):x=Sl("left",p,0,x)}let I=[p,p],O=[x,x];l=h.visibledatarow[p],o=p-1==-1?0:h.visibledatarow[p-1],a=h.visibledatacolumn[x],s=x-1==-1?0:h.visibledatacolumn[x-1];let F=ht.mergeMoveMain(O,I,y,o,l-o-1,s,a-s-1);F!=null&&(O=F[0],I=F[1]),h.luckysheet_select_save=[{row:I,column:O}],Zt(),Pt.pivotclick(p,x),v.fucntionboxshow(p,x)}else if(n=="rangeOfFormula"){let y=v.func_selectedrange,p=y.row_focus,x=y.column_focus,_=!1,S={};if(h.config.merge!=null&&p+"_"+x in h.config.merge&&(_=!0,S=h.config.merge[p+"_"+x]),e=="down"){if(p==h.flowdata.length-1)return;_?p=Sl("down",x,S.r+S.rs-1,h.flowdata.length-1):p=Sl("down",x,p,h.flowdata.length-1)}else if(e=="up"){if(p==0)return;_?p=Sl("up",x,0,S.r):p=Sl("up",x,0,p)}else if(e=="right"){if(x==h.flowdata[0].length-1)return;_?x=Sl("right",p,S.c+S.cs-1,h.flowdata[0].length-1):x=Sl("right",p,x,h.flowdata[0].length-1)}else if(e=="left"){if(x==0)return;_?x=Sl("left",p,0,S.c):x=Sl("left",p,0,x)}let I=[p,p],O=[x,x];l=h.visibledatarow[p],o=p-1==-1?0:h.visibledatarow[p-1],a=h.visibledatacolumn[x],s=x-1==-1?0:h.visibledatacolumn[x-1];let F=o,D=l-o-1,k=s,w=a-s-1,C=ht.mergeMoveMain(O,I,y,F,D,k,w);C!=null&&(O=C[0],I=C[1],F=C[2],D=C[3],k=C[4],w=C[5]),v.func_selectedrange={left:k,width:w,top:F,height:D,left_move:k,width_move:w,top_move:F,height_move:D,row:I,column:O,row_focus:p,column_focus:x},$("#luckysheet-formula-functionrange-select").css({left:k,width:w,top:F,height:D}).show(),v.rangeSetValue({row:I,column:O})}let u=$("#luckysheet-cell-main").scrollLeft(),f=$("#luckysheet-cell-main").scrollTop(),m=$("#luckysheet-cell-main").height(),d=$("#luckysheet-cell-main").width(),g=0,b=0;a-u-d+20>0?(g=a-d+20,t&&$("#luckysheet-scrollbar-x").scrollLeft(g)):s-u-20<0&&(g=s-20,t&&$("#luckysheet-scrollbar-x").scrollLeft(g)),l-f-m+20>0?(b=l-m+20,t&&$("#luckysheet-scrollbar-y").scrollTop(b)):o-f-20<0&&(b=o-20,t&&$("#luckysheet-scrollbar-y").scrollTop(b)),clearTimeout(h.countfuncTimeout),mn()}function Ya(e,n,t,l){l==null&&(l=!0),e||e=="down";let o,a,s,u;if(t=="rangeOfSelect"){let p=h.luckysheet_select_save[h.luckysheet_select_save.length-1],x=p.row[0],_=p.row[1],S=p.column[0],I=p.column[1],O=p.row_focus,F=p.column_focus,D=h.flowdata.length,k=h.flowdata[0].length;if(e=="down"){if(ei(O,S,I)){let z=_i(O,S,I),A=z[0],M=z[1];A>x&&M==_?(n>0&&ei(x,S,I)&&(x=_i(x,S,I)[1]),x+=n):M<_&&A==x?(n<0&&ei(_,S,I)&&(_=_i(_,S,I)[0]),_+=n):n>0?_+=n:x+=n}else O>x&&O==_?(n>0&&ei(x,S,I)&&(x=_i(x,S,I)[1]),x+=n):O<_&&O==x?(n<0&&ei(_,S,I)&&(_=_i(_,S,I)[0]),_+=n):O==x&&O==_&&(n>0?_+=n:x+=n);_>=D&&(_=D-1),_<0&&(_=0),x>=D&&(x=D-1),x<0&&(x=0)}else{if(ti(F,x,_)){let z=Ci(F,x,_),A=z[0],M=z[1];A>S&&M==I?(n>0&&ti(S,x,_)&&(S=Ci(S,x,_)[1]),S+=n):M<I&&A==S?(n<0&&ti(I,x,_)&&(I=Ci(I,x,_)[0]),I+=n):n>0?I+=n:S+=n}else F>S&&F==I?(n>0&&ti(S,x,_)&&(S=Ci(S,x,_)[1]),S+=n):F<I&&F==S?(n<0&&ti(I,x,_)&&(I=Ci(I,x,_)[0]),I+=n):F==S&&F==I&&(n>0?I+=n:S+=n);I>=k&&(I=k-1),I<0&&(I=0),S>=k&&(S=k-1),S<0&&(S=0)}let w=[x,_],C=[S,I];o=h.visibledatarow[_],a=x-1==-1?0:h.visibledatarow[x-1],s=h.visibledatacolumn[I],u=S-1==-1?0:h.visibledatacolumn[S-1];let T=ht.mergeMoveMain(C,w,p,a,o-a-1,u,s-u-1);T!=null&&(C=T[0],w=T[1]),p.row=w,p.column=C,Zt()}else if(t=="rangeOfFormula"){let p=v.func_selectedrange,x=p.row[0],_=p.row[1],S=p.column[0],I=p.column[1],O=p.row_focus,F=p.column_focus,D=h.flowdata.length,k=h.flowdata[0].length;if(e=="down"){if(ei(O,S,I)){let N=_i(O,S,I),E=N[0],B=N[1];E>x&&B==_?(n>0&&ei(x,S,I)&&(x=_i(x,S,I)[1]),x+=n):B<_&&E==x?(n<0&&ei(_,S,I)&&(_=_i(_,S,I)[0]),_+=n):n>0?_+=n:x+=n}else O>x&&O==_?(n>0&&ei(x,S,I)&&(x=_i(x,S,I)[1]),x+=n):O<_&&O==x?(n<0&&ei(_,S,I)&&(_=_i(_,S,I)[0]),_+=n):O==x&&O==_&&(n>0?_+=n:x+=n);_>=D&&(_=D-1),_<0&&(_=0),x>=D&&(x=D-1),x<0&&(x=0)}else{if(ti(F,x,_)){let N=Ci(F,x,_),E=N[0],B=N[1];E>S&&B==I?(n>0&&ti(S,x,_)&&(S=Ci(S,x,_)[1]),S+=n):B<I&&E==S?(n<0&&ti(I,x,_)&&(I=Ci(I,x,_)[0]),I+=n):n>0?I+=n:S+=n}else F>S&&F==I?(n>0&&ti(S,x,_)&&(S=Ci(S,x,_)[1]),S+=n):F<I&&F==S?(n<0&&ti(I,x,_)&&(I=Ci(I,x,_)[0]),I+=n):F==S&&F==I&&(n>0?I+=n:S+=n);I>=k&&(I=k-1),I<0&&(I=0),S>=k&&(S=k-1),S<0&&(S=0)}let w=[x,_],C=[S,I];o=h.visibledatarow[_],a=x-1==-1?0:h.visibledatarow[x-1],s=h.visibledatacolumn[I],u=S-1==-1?0:h.visibledatacolumn[S-1];let T=a,z=o-a-1,A=u,M=s-u-1,P=ht.mergeMoveMain(C,w,p,T,z,A,M);P!=null&&(C=P[0],w=P[1],T=P[2],z=P[3],A=P[4],M=P[5]),v.func_selectedrange={left:A,width:M,top:T,height:z,left_move:A,width_move:M,top_move:T,height_move:z,row:w,column:C,row_focus:O,column_focus:F},$("#luckysheet-formula-functionrange-select").css({left:A,width:M,top:T,height:z}).show(),v.rangeSetValue({row:w,column:C})}let f=$("#luckysheet-cell-main").scrollLeft(),m=$("#luckysheet-cell-main").scrollTop(),d=$("#luckysheet-cell-main").height(),g=$("#luckysheet-cell-main").width(),b=0,y=0;s-f-g+20>0?(b=s-g+20,l&&$("#luckysheet-scrollbar-x").scrollLeft(b)):u-f-20<0&&(b=u-20,l&&$("#luckysheet-scrollbar-x").scrollLeft(b)),o-m-d+20>0?(y=o-d+20,l&&$("#luckysheet-scrollbar-y").scrollTop(y)):a-m-20<0&&(y=a-20,l&&$("#luckysheet-scrollbar-y").scrollTop(y)),clearTimeout(h.countfuncTimeout),mn()}function Jo(e,n,t){t||(t=!0);let l,o,a,s;if(n=="rangeOfSelect"){let y=h.luckysheet_select_save[h.luckysheet_select_save.length-1],p=y.row_focus,x=y.column_focus,_=y.row[0],S=y.row[1],I=y.column[0],O=y.column[1];if(e=="down"){if(S==h.flowdata.length-1)return;if(ei(p,I,O)){let w=_i(p,I,O),C=w[0],T=w[1];C>_&&T==S?_=Sl("down",x,_,S):S=Sl("down",x,S,h.flowdata.length-1)}else p>_&&p==S?_=Sl("down",x,_,S):S=Sl("down",x,S,h.flowdata.length-1)}else if(e=="up"){if(_==0)return;if(ei(p,I,O)){let w=_i(p,I,O),C=w[0];w[1]<S&&C==_?S=Sl("up",x,_,S):_=Sl("up",x,0,_)}else p<S&&p==_?S=Sl("up",x,_,S):_=Sl("up",x,0,_)}else if(e=="right"){if(O==h.flowdata[0].length-1)return;if(ti(x,_,S)){let w=Ci(x,_,S),C=w[0],T=w[1];C>I&&T==O?I=Sl("right",p,I,O):O=Sl("right",p,O,h.flowdata[0].length-1)}else x>I&&x==O?I=Sl("right",p,I,O):O=Sl("right",p,O,h.flowdata[0].length-1)}else if(e=="left"){if(I==0)return;if(ti(x,_,S)){let w=Ci(x,_,S),C=w[0];w[1]<O&&C==I?O=Sl("left",p,I,O):I=Sl("left",p,0,I)}else x<O&&x==I?O=Sl("left",p,I,O):I=Sl("left",p,0,I)}let F=[_,S],D=[I,O];l=h.visibledatarow[S],o=_-1==-1?0:h.visibledatarow[_-1],a=h.visibledatacolumn[O],s=I-1==-1?0:h.visibledatacolumn[I-1];let k=ht.mergeMoveMain(D,F,y,o,l-o-1,s,a-s-1);k!=null&&(D=k[0],F=k[1]),y.row=F,y.column=D,Zt()}else if(n=="rangeOfFormula"){let y=v.func_selectedrange,p=y.row_focus,x=y.column_focus,_=y.row[0],S=y.row[1],I=y.column[0],O=y.column[1];if(e=="down"){if(S==h.flowdata.length-1)return;if(ei(p,I,O)){let A=_i(p,I,O),M=A[0],P=A[1];M>_&&P==S?_=Sl("down",x,_,S):S=Sl("down",x,S,h.flowdata.length-1)}else p>_&&p==S?_=Sl("down",x,_,S):S=Sl("down",x,S,h.flowdata.length-1)}else if(e=="up"){if(_==0)return;if(ei(p,I,O)){let A=_i(p,I,O),M=A[0];A[1]<S&&M==_?S=Sl("up",x,_,S):_=Sl("up",x,0,_)}else p<S&&p==_?S=Sl("up",x,_,S):_=Sl("up",x,0,_)}else if(e=="right"){if(O==h.flowdata[0].length-1)return;if(ti(x,_,S)){let A=Ci(x,_,S),M=A[0],P=A[1];M>I&&P==O?I=Sl("right",p,I,O):O=Sl("right",p,O,h.flowdata[0].length-1)}else x>I&&x==O?I=Sl("right",p,I,O):O=Sl("right",p,O,h.flowdata[0].length-1)}else if(e=="left"){if(I==0)return;if(ti(x,_,S)){let A=Ci(x,_,S),M=A[0];A[1]<O&&M==I?O=Sl("left",p,I,O):I=Sl("left",p,0,I)}else x<O&&x==I?O=Sl("left",p,I,O):I=Sl("left",p,0,I)}let F=[_,S],D=[I,O];l=h.visibledatarow[S],o=_-1==-1?0:h.visibledatarow[_-1],a=h.visibledatacolumn[O],s=I-1==-1?0:h.visibledatacolumn[I-1];let k=o,w=l-o-1,C=s,T=a-s-1,z=ht.mergeMoveMain(D,F,y,k,w,C,T);z!=null&&(D=z[0],F=z[1],k=z[2],w=z[3],C=z[4],T=z[5]),v.func_selectedrange={left:C,width:T,top:k,height:w,left_move:C,width_move:T,top_move:k,height_move:w,row:F,column:D,row_focus:p,column_focus:x},$("#luckysheet-formula-functionrange-select").css({left:C,width:T,top:k,height:w}).show(),v.rangeSetValue({row:F,column:D})}let u=$("#luckysheet-cell-main").scrollLeft(),f=$("#luckysheet-cell-main").scrollTop(),m=$("#luckysheet-cell-main").height(),d=$("#luckysheet-cell-main").width(),g=0,b=0;a-u-d+20>0?(g=a-d+20,t&&$("#luckysheet-scrollbar-x").scrollLeft(g)):s-u-20<0&&(g=s-20,t&&$("#luckysheet-scrollbar-x").scrollLeft(g)),l-f-m+20>0?(b=l-m+20,t&&$("#luckysheet-scrollbar-y").scrollTop(b)):o-f-20<0&&(b=o-20,t&&$("#luckysheet-scrollbar-y").scrollTop(b)),clearTimeout(h.countfuncTimeout),mn()}function ei(e,n,t){let l=!1;for(let o=n;o<=t;o++){let a=h.flowdata[e][o];if(V(a)=="object"&&"mc"in a){l=!0;break}}return l}function ti(e,n,t){let l=!1;for(let o=n;o<=t;o++){let a=h.flowdata[o][e];if(V(a)=="object"&&"mc"in a){l=!0;break}}return l}function _i(e,n,t){let l=0,o=h.flowdata.length-1,a=null;if(e>l)for(let u=e;u>=l;u--){for(let f=n;f<=t;f++){let m=h.flowdata[u][f];if(V(m)=="object"&&"mc"in m){let d=h.config.merge[m.mc.r+"_"+m.mc.c];(a==null||d.r<a)&&(a=d.r)}}if(ei(a-1,n,t)&&a>l)u=a-1;else break}else a=l;let s=null;if(e<o)for(let u=e;u<=o;u++){for(let f=n;f<=t;f++){let m=h.flowdata[u][f];if(V(m)=="object"&&"mc"in m){let d=h.config.merge[m.mc.r+"_"+m.mc.c];(s==null||d.r+d.rs-1>s)&&(s=d.r+d.rs-1)}}if(ei(s+1,n,t)&&s<o)u=s+1;else break}else s=o;return[a,s]}function Ci(e,n,t){let l=0,o=h.flowdata[0].length-1,a=null;if(e>l)for(let u=e;u>=l;u--){for(let f=n;f<=t;f++){let m=h.flowdata[f][u];if(V(m)=="object"&&"mc"in m){let d=h.config.merge[m.mc.r+"_"+m.mc.c];(a==null||d.c<a)&&(a=d.c)}}if(ti(a-1,n,t)&&a>l)u=a-1;else break}else a=l;let s=null;if(e<o)for(let u=e;u<=o;u++){for(let f=n;f<=t;f++){let m=h.flowdata[f][u];if(V(m)=="object"&&"mc"in m){let d=h.config.merge[m.mc.r+"_"+m.mc.c];(s==null||d.c+d.cs-1>s)&&(s=d.c+d.cs-1)}}if(ti(s+1,n,t)&&s<o)u=s+1;else break}else s=o;return[a,s]}function Sl(e,n,t,l){let o=null,a;if(e=="down"){let s=h.flowdata[t][n];V(s)=="object"&&rt(s.v)||rt(s)?a=!0:a=!1,console.log(a,"stNull");let u=[],f=0;for(let m=t+1;m<=l;m++){let d=h.flowdata[m][n];if(V(d)=="object"&&rt(d.v)||rt(d)?u.push(!0):u.push(!1),u.length==1&&a==!0&&u[f]==!1){o=t+f+1;break}else if(u.length>1){if(a&&u[f]==!1){o=t+f+1;break}else if(!a){if(u[f]==!1&&u[f-1]==!0){o=t+f+1;break}else if(u[f]==!0&&u[f-1]==!1){o=t+f;break}}}m==l&&(o=l),f++}}else if(e=="up"){let s=h.flowdata[l][n];V(s)=="object"&&rt(s.v)||rt(s)?a=!0:a=!1;let u=[],f=0;for(let m=l-1;m>=t;m--){let d=h.flowdata[m][n];if(V(d)=="object"&&rt(d.v)||rt(d)?u.push(!0):u.push(!1),u.length==1&&a&&u[f]==!1){o=l-(f+1);break}else if(u.length>1){if(a&&u[f]==!1){o=l-(f+1);break}else if(!a){if(u[f]==!1&&u[f-1]==!0){o=l-(f+1);break}else if(u[f]==!0&&u[f-1]==!1){o=l-f;break}}}m==t&&(o=t),f++}}else if(e=="right"){let s=h.flowdata[n][t];V(s)=="object"&&rt(s.v)||rt(s)?a=!0:a=!1;let u=[],f=0;for(let m=t+1;m<=l;m++){let d=h.flowdata[n][m];if(V(d)=="object"&&rt(d.v)||rt(d)?u.push(!0):u.push(!1),u.length==1&&a&&u[f]==!1){o=t+f+1;break}else if(u.length>1){if(a&&u[f]==!1){o=t+f+1;break}else if(!a){if(u[f]==!1&&u[f-1]==!0){o=t+f+1;break}else if(u[f]==!0&&u[f-1]==!1){o=t+f;break}}}m==l&&(o=l),f++}}else if(e=="left"){let s=h.flowdata[n][l];V(s)=="object"&&rt(s.v)||rt(s)?a=!0:a=!1;let u=[],f=0;for(let m=l-1;m>=t;m--){let d=h.flowdata[n][m];if(V(d)=="object"&&rt(d.v)||rt(d)?u.push(!0):u.push(!1),u.length==1&&a&&u[f]==!1){o=l-(f+1);break}else if(u.length>1){if(a&&u[f]==!1){o=l-(f+1);break}else if(!a){if(u[f]==!1&&u[f-1]==!0){o=l-(f+1);break}else if(u[f]==!0&&u[f-1]==!1){o=l-f;break}}}m==t&&(o=t),f++}}return o}var import_plugin,Cc=Tt(()=>{import_plugin=Le(Be());gl();ir();Gl();xc();Mr();vr();Qo();Ut();wr()});var import_plugin,Ex,xr,$c=Tt(()=>{import_plugin=Le(Be());ql();gl();ir();Gl();Sr();fr();ar();Bi();wr();vr();Ut();Rl();Ex={rangefocus:!1,modelfocusIndex:null,FixedModelColor:[{head:{fc:"#000",bc:"#bfbdbe"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f3f7"},foot:{fc:"#000",bc:"#dde2de"}},{head:{fc:"#000",bc:"#4bd4e7"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eaf7ff"},foot:{fc:"#000",bc:"#aae9f8"}},{head:{fc:"#000",bc:"#5ed593"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#e5fbee"},foot:{fc:"#000",bc:"#a5efcc"}},{head:{fc:"#000",bc:"#f6cb4b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fff9e7"},foot:{fc:"#000",bc:"#ffebac"}},{head:{fc:"#000",bc:"#f96420"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ffe5d9"},foot:{fc:"#000",bc:"#ffcfba"}},{head:{fc:"#000",bc:"#5599fc"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ecf2fe"},foot:{fc:"#000",bc:"#afcbfa"}},{head:{fc:"#000",bc:"#22a69b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#dff2f8"},foot:{fc:"#000",bc:"#8dd4d0"}},{head:{fc:"#000",bc:"#7a939a"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0eff7"},foot:{fc:"#000",bc:"#bdcad0"}},{head:{fc:"#000",bc:"#d7a270"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fdf3f1"},foot:{fc:"#000",bc:"#ead2b6"}},{head:{fc:"#000",bc:"#89c54b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f1f7e9"},foot:{fc:"#000",bc:"#c5e3a7"}},{head:{fc:"#000",bc:"#8f88f0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0e5ff"},foot:{fc:"#000",bc:"#c6c4f6"}},{head:{fc:"#000",bc:"#fd1664"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#feddee"},foot:{fc:"#000",bc:"#f98ab5"}},{head:{fc:"#000",bc:"#da96d3"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fce8fb"},foot:{fc:"#000",bc:"#f2caee"}},{head:{fc:"#000",bc:"#b49191"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f5ebe8"},foot:{fc:"#000",bc:"#d8c3c3"}},{head:{fc:"#000",bc:"#91b493"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0fbf0"},foot:{fc:"#000",bc:"#b4cfb6"}},{head:{fc:"#000",bc:"#b4a891"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f6f1"},foot:{fc:"#000",bc:"#d3cab8"}},{head:{fc:"#000",bc:"#91abb4"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eff7fa"},foot:{fc:"#000",bc:"#b7cbd3"}},{head:{fc:"#000",bc:"#b7ba82"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fafbeb"},foot:{fc:"#000",bc:"#dadcb4"}},{head:{fc:"#000",bc:"#df3e3e"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fde9e9"},foot:{fc:"#000",bc:"#f89292"}},{head:{fc:"#000",bc:"#f2711c"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fef0d7"},foot:{fc:"#000",bc:"#fbb335"}},{head:{fc:"#000",bc:"#b5cc18"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f9fbd4"},foot:{fc:"#000",bc:"#e2ed2a"}},{head:{fc:"#000",bc:"#00b5ad"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ccfaf9"},foot:{fc:"#000",bc:"#00e4df"}},{head:{fc:"#000",bc:"#2185d0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#d8f3fc"},foot:{fc:"#000",bc:"#3cc4f0"}},{head:{fc:"#000",bc:"#a5673f"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f6ede5"},foot:{fc:"#000",bc:"#d3a47c"}}],getModelBox:function(e,n){let t=this;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").empty(),$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").empty();let l="";for(let a=0;a<t.FixedModelColor.length;a++){let s=t.FixedModelColor[a],u,f,m,d;e&&n?(u=s.head,f=s.one,m=s.two,d=s.foot):e?(u=s.head,f=s.one,m=s.two,d=s.one):n?(u=s.one,f=s.two,m=s.one,d=s.foot):(u=s.one,f=s.two,m=s.one,d=s.two),l+='<div class="modelbox"><div class="box"><span style="color:'+u.fc+";background-color:"+u.bc+'"> \u2014 </span><span style="color:'+f.fc+";background-color:"+f.bc+'"> \u2014 </span><span style="color:'+m.fc+";background-color:"+m.bc+'"> \u2014 </span><span style="color:'+d.fc+";background-color:"+d.bc+'"> \u2014 </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").append(l);let o=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(o!=null&&o.length>0){let a="";for(let s=0;s<o.length;s++){let u=o[s],f,m,d,g;e&&n?(f=u.head,m=u.one,d=u.two,g=u.foot):e?(f=u.head,m=u.one,d=u.two,g=u.one):n?(f=u.one,m=u.two,d=u.one,g=u.foot):(f=u.one,m=u.two,d=u.one,g=u.two),a+='<div class="modelbox"><div class="box"><span style="color:'+f.fc+";background-color:"+f.bc+'"> \u2014 </span><span style="color:'+m.fc+";background-color:"+m.bc+'"> \u2014 </span><span style="color:'+d.fc+";background-color:"+d.bc+'"> \u2014 </span><span style="color:'+g.fc+";background-color:"+g.bc+'"> \u2014 </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").append(a)}},init:function(){let e=this;$("#luckysheet-modal-dialog-slider-alternateformat").remove(),$("body").first().append(y0()),Kl(),$("#luckysheet-modal-dialog-slider-alternateformat .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),Kl()}),$(document).off("focus.AFrangeInput").on("focus.AFrangeInput","#luckysheet-alternateformat-range input",function(){e.rangefocus=!0}),$(document).off("blur.AFrangeInput").on("blur.AFrangeInput","#luckysheet-alternateformat-range input",function(){e.rangefocus=!1}),$(document).off("keydown.AFrangeInput").on("keydown.AFrangeInput","#luckysheet-alternateformat-range input",function(n){let t=$(this).val().trim();n.keyCode==13&&e.update()}),$(document).off("click.AFrangeIcon").on("click.AFrangeIcon","#luckysheet-alternateformat-range .fa-table",function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),Kl();let n=$(this).parents("#luckysheet-alternateformat-range").find("input").val().trim();e.rangeDialog(n)}),$(document).off("click.AFrDCf").on("click.AFrDCf","#luckysheet-alternateformat-rangeDialog-confirm",function(){let n=$(this).parents("#luckysheet-alternateformat-rangeDialog").find("input").val().trim();$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val(n),$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),Kl(),e.update()}),$(document).off("click.AFrDCl").on("click.AFrDCl","#luckysheet-alternateformat-rangeDialog-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),Kl()}),$(document).off("click.AFrDTitle").on("click.AFrDTitle","#luckysheet-alternateformat-rangeDialog .luckysheet-modal-dialog-title-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),Kl()}),$(document).off("change.AFrowHeader").on("change.AFrowHeader","#luckysheet-alternateformat-rowHeader",function(){let n;$(this).is(":checked")?n=!0:n=!1;let t;$("#luckysheet-alternateformat-rowFooter").is(":checked")?t=!0:t=!1,e.checkboxChange(n,t),e.modelboxOn(),e.update()}),$(document).off("change.AFrowFooter").on("change.AFrowFooter","#luckysheet-alternateformat-rowFooter",function(){let n;$("#luckysheet-alternateformat-rowHeader").is(":checked")?n=!0:n=!1;let t;$(this).is(":checked")?t=!0:t=!1,e.checkboxChange(n,t),e.modelboxOn(),e.update()}),$(document).off("click.AFmodelbox").on("click.AFmodelbox","#luckysheet-modal-dialog-slider-alternateformat .modelbox",function(){let n=$(this).index(),t=$(this).parents(".cf").attr("id");if(t=="luckysheet-alternateformat-modelList")e.modelfocusIndex=n;else if(t=="luckysheet-alternateformat-modelCustom"){let l=e.FixedModelColor.length;e.modelfocusIndex=n+l}e.modelboxOn(),e.update()}),$(document).off("click.AFselectColor").on("click.AFselectColor","#luckysheet-modal-dialog-slider-alternateformat .luckysheet-color-menu-button-indicator",function(){let n=$(this).closest(".toningbox"),t,l;$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-text-color")?(t="fc",l=n.find(".toningShow").data("fc")):$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-cell-color")&&(t="bc",l=n.find(".toningShow").data("bc"));let o;n.hasClass("header")?o="0":n.hasClass("ctOne")?o="1":n.hasClass("ctTwo")?o="2":n.hasClass("footer")&&(o="3"),e.colorSelectDialog(l,t,o)}),$(document).off("click.AFselectColorConfirm").on("click.AFselectColorConfirm","#luckysheet-alternateformat-colorSelect-dialog-confirm",function(){let n=$(this).parents("#luckysheet-alternateformat-colorSelect-dialog"),l=Oe().alternatingColors;$("#luckysheet-modal-dialog-mask").hide(),n.hide();let o=n.find(".currenColor span").attr("title"),a;n.find(".luckysheet-modal-dialog-title-text").text()==l.selectionTextColor?a="fc":n.find(".luckysheet-modal-dialog-title-text").text()==l.selectionCellColor&&(a="bc");let s=n.find(".currenColor").attr("data-source");s=="0"?(a=="fc"&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o))):s=="1"?(a=="fc"&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o))):s=="2"?(a=="fc"&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o))):s=="3"&&(a=="fc"&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)));let u;$("#luckysheet-alternateformat-rowHeader").is(":checked")?u=!0:u=!1;let f;$("#luckysheet-alternateformat-rowFooter").is(":checked")?f=!0:f=!1;let m=e.modelfocusIndex,d=e.FixedModelColor.length,g,b;if(m<d)g=$.extend(!0,{},e.getFormatByIndex());else{b=h.luckysheetfile[$e(h.currentSheetIndex)];let y=b.luckysheet_alternateformat_save_modelCustom;g=$.extend(!0,{},y[m-d])}s=="0"?a=="fc"?g.head.fc=o:a=="bc"&&(g.head.bc=o):s=="1"?a=="fc"?g.one.fc=o:a=="bc"&&(g.one.bc=o):s=="2"?a=="fc"?g.two.fc=o:a=="bc"&&(g.two.bc=o):s=="3"&&(a=="fc"&&(g.foot.fc=o),a=="bc"&&(g.foot.bc=o)),e.modelfocusIndex<d?(e.addCustomModel(g),e.modelfocusIndex=e.getIndexByFormat(g)):(b.luckysheet_alternateformat_save_modelCustom[m-d]=g,He.allowUpdate&&He.saveParam("all",h.currentSheetIndex,b.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})),e.getModelBox(u,f),e.modelboxOn(),e.update()}),$(document).off("click.AFremove").on("click.AFremove","#luckysheet-alternateformat-remove",function(){let n=$(this).data("index"),l=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_alternateformat_save,o=$.extend(!0,[],l);l.length>1?l.splice(n,1):l=[];let a=$.extend(!0,[],l);e.ref(o,a),He.allowUpdate&&He.saveParam("all",h.currentSheetIndex,l,{k:"luckysheet_alternateformat_save"}),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").hide(),Kl()})},perfect:function(){let e=this,n=$.extend(!0,{},h.luckysheet_select_save[0]),t=e.rangeIsExists(n)[1],l=$.extend(!0,{},h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_alternateformat_save[t]),o=l.cellrange;$("#luckysheet-alternateformat-range input").val(Al(h.currentSheetIndex,{row:o.row,column:o.column},h.currentSheetIndex)),h.luckysheet_select_save=[{row:o.row,column:o.column}],Zt();let a=l.hasRowHeader,s=l.hasRowFooter,u=l.format;e.modelfocusIndex=e.getIndexByFormat(u),e.modelfocusIndex==null&&(e.addCustomModel(u),e.modelfocusIndex=e.getIndexByFormat(u)),e.checkboxChange(a,s),e.modelboxOn(),$("#luckysheet-alternateformat-remove").data("index",t)},checkboxChange:function(e,n){e?($("#luckysheet-alternateformat-rowHeader").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .header").show()):($("#luckysheet-alternateformat-rowHeader").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .header").hide()),n?($("#luckysheet-alternateformat-rowFooter").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .footer").show()):($("#luckysheet-alternateformat-rowFooter").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .footer").hide()),this.getModelBox(e,n)},modelboxOn:function(){let e=this;$("#luckysheet-modal-dialog-slider-alternateformat .modelbox").removeClass("on");let n=e.modelfocusIndex,t=e.FixedModelColor.length;n<t?$("#luckysheet-alternateformat-modelList .modelbox").eq(n).addClass("on"):$("#luckysheet-alternateformat-modelCustom .modelbox").eq(n-t).addClass("on"),e.modelToningColor()},modelToningColor:function(){let e=this.getFormatByIndex();$("#luckysheet-alternateformat-modelToning .header .toningShow").css({color:e.head.fc,"background-color":e.head.bc}),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",e.head.fc).data("bc",e.head.bc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.fc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.bc),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css({color:e.one.fc,"background-color":e.one.bc}),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",e.one.fc).data("bc",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.fc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css({color:e.two.fc,"background-color":e.two.bc}),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",e.two.fc).data("bc",e.two.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.fc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.bc),$("#luckysheet-alternateformat-modelToning .footer .toningShow").css({color:e.foot.fc,"background-color":e.foot.bc}),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",e.foot.fc).data("bc",e.foot.bc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.fc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.bc)},addCustomModel:function(e){let n=h.luckysheetfile[$e(h.currentSheetIndex)];n.luckysheet_alternateformat_save_modelCustom==null&&(n.luckysheet_alternateformat_save_modelCustom=[]),n.luckysheet_alternateformat_save_modelCustom.push(e),He.allowUpdate&&He.saveParam("all",h.currentSheetIndex,n.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})},colorSelectDialog:function(e,n,t){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-alternateformat-colorSelect-dialog").remove();let l=Oe(),o=l.alternatingColors,a=l.button,s=l.toolbar,u;n=="fc"?u=o.selectionTextColor:n=="bc"&&(u=o.selectionCellColor),$("body").first().append(yt(kl,{id:"luckysheet-alternateformat-colorSelect-dialog",addclass:"luckysheet-alternateformat-colorSelect-dialog",title:u,content:"<div class='currenColor' data-source='"+t+"'>"+o.currentColor+"\uFF1A<span title='"+e+"' style='background-color:"+e+"'></span></div><div class='colorshowbox'></div>",botton:'<button id="luckysheet-alternateformat-colorSelect-dialog-confirm" class="btn btn-primary">'+a.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+a.cancel+"</button>",style:"z-index:100003"}));let f=$("#luckysheet-alternateformat-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),m=f.outerHeight(),d=f.outerWidth(),g=$(window).width(),b=$(window).height(),y=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-alternateformat-colorSelect-dialog").css({left:(g+y-d)/2,top:(b+p-m)/3}).show(),$("#luckysheet-alternateformat-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:a.cancel,chooseText:s.confirmColor,togglePaletteMoreText:s.customColor,togglePaletteLessText:s.collapse,togglePaletteOnly:!0,clearText:s.clearText,noColorSelectedText:s.noColorSelectedText,localStorageKey:"spectrum.textcolor"+He.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(x){x!=null?x=x.toHexString():x="#000",$("#luckysheet-alternateformat-colorSelect-dialog .currenColor span").css("background-color",x).attr("title",x)}})},rangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-alternateformat-rangeDialog").remove();let n=Oe(),t=n.alternatingColors,l=n.button;$("body").first().append(yt(kl,{id:"luckysheet-alternateformat-rangeDialog",addclass:"luckysheet-alternateformat-rangeDialog",title:t.selectRange,content:'<input readonly="readonly" placeholder="'+t.tipSelectRange+'" value="'+e+'"/>',botton:'<button id="luckysheet-alternateformat-rangeDialog-confirm" class="btn btn-primary">'+l.confirm+'</button><button id="luckysheet-alternateformat-rangeDialog-close" class="btn btn-default">'+l.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-alternateformat-rangeDialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-alternateformat-rangeDialog").css({left:(u+m-s)/2,top:(f+d-a)/3}).show()},rangeIsExists:function(e,n){let t=this,l=!1,o=null,a=$.extend(!0,[],h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_alternateformat_save);if(n!=null&&n!=null&&(a.length>1?a.splice(n,1):a=[]),a.length>0){let s=[];for(let f=0;f<a.length;f++){let m={index:f,map:t.getRangeMap(a[f].cellrange.row,a[f].cellrange.column)};s.push(m)}let u=t.getRangeMap(e.row,e.column);for(let f in u){if(l)break;for(let m=0;m<s.length;m++)if(f in s[m].map){l=!0,o=s[m].index;break}}}return[l,o]},getRangeMap:function(e,n){let t={},l=e[0],o=e[1],a=n[0],s=n[1];for(let u=l;u<=o;u++)for(let f=a;f<=s;f++)t[u+"_"+f]=0;return t},getIndexByFormat:function(e){let n=this,t=null,l=n.FixedModelColor;for(let a=0;a<l.length;a++){let s=l[a];if(e.head.fc==s.head.fc&&e.head.bc==s.head.bc&&e.one.fc==s.one.fc&&e.one.bc==s.one.bc&&e.two.fc==s.two.fc&&e.two.bc==s.two.bc&&e.foot.fc==s.foot.fc&&e.foot.bc==s.foot.bc){t=a;break}}let o=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(o!=null&&o.length>0)for(let a=0;a<o.length;a++){let s=o[a];if(e.head.fc==s.head.fc&&e.head.bc==s.head.bc&&e.one.fc==s.one.fc&&e.one.bc==s.one.bc&&e.two.fc==s.two.fc&&e.two.bc==s.two.bc&&e.foot.fc==s.foot.fc&&e.foot.bc==s.foot.bc){t=l.length+a;break}}return t},getFormatByIndex:function(){let e=this,n=e.modelfocusIndex,t=e.FixedModelColor.length,l={};return n<t?l=e.FixedModelColor[n]:l=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom[n-t],l},new:function(e){let n=this,t=n.getFormatByIndex(),o=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_alternateformat_save;o==null&&(o=[]);let a=$.extend(!0,[],o),s={cellrange:{row:e.row,column:e.column},format:t,hasRowHeader:!0,hasRowFooter:!1};o.push(s);let u=$.extend(!0,[],o);n.ref(a,u),He.allowUpdate&&He.saveParam("all",h.currentSheetIndex,o,{k:"luckysheet_alternateformat_save"})},update:function(){let e=this,t=Oe().alternatingColors,l=$("#luckysheet-alternateformat-remove").data("index"),o=$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val().trim();if(!v.iscelldata(o)){Qe()?alert(t.errorNoRange):de.info(t.errorNoRange,"");return}let a=v.getcellrange(o);if(e.rangeIsExists(a,l)[0]){Qe()?alert(t.errorExistColors):de.info(t.errorExistColors,"");return}let u;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowHeader").is(":checked")?u=!0:u=!1;let f;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowFooter").is(":checked")?f=!0:f=!1;let m=e.getFormatByIndex(),g=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_alternateformat_save;g==null&&(g=[]);let b=$.extend(!0,[],g),y={cellrange:{row:a.row,column:a.column},format:m,hasRowHeader:u,hasRowFooter:f};g[l]=y;let p=$.extend(!0,[],g);e.ref(b,p),He.allowUpdate&&He.saveParam("all",h.currentSheetIndex,g,{k:"luckysheet_alternateformat_save"})},checksAF:function(e,n,t){return e+"_"+n in t?t[e+"_"+n]:null},getComputeMap:function(){let n=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_alternateformat_save;return this.compute(n)},compute:function(e){let n={};if(e!=null&&e.length>0)for(let t=0;t<e.length;t++){let l=e[t].cellrange,o=e[t].format,a=e[t].hasRowHeader,s=e[t].hasRowFooter,u=l.row[0],f=l.row[1],m=l.column[0],d=l.column[1];if(a&&s){for(let g=m;g<=d;g++)n[u+"_"+g]=[o.head.fc,o.head.bc];if(f-u>1)for(let g=u+1;g<f;g++){let b,y;(g-u)%2!=0?(b=o.one.fc,y=o.one.bc):(b=o.two.fc,y=o.two.bc);for(let p=m;p<=d;p++)n[g+"_"+p]=[b,y]}if(f>u)for(let g=m;g<=d;g++)n[f+"_"+g]=[o.foot.fc,o.foot.bc]}else if(a){for(let g=m;g<=d;g++)n[u+"_"+g]=[o.head.fc,o.head.bc];if(f>u)for(let g=u+1;g<=f;g++){let b,y;(g-u)%2!=0?(b=o.one.fc,y=o.one.bc):(b=o.two.fc,y=o.two.bc);for(let p=m;p<=d;p++)n[g+"_"+p]=[b,y]}}else if(s){if(f>u)for(let g=u;g<f;g++){let b,y;(g-u)%2==0?(b=o.one.fc,y=o.one.bc):(b=o.two.fc,y=o.two.bc);for(let p=m;p<=d;p++)n[g+"_"+p]=[b,y]}for(let g=m;g<=d;g++)n[f+"_"+g]=[o.foot.fc,o.foot.bc]}else for(let g=u;g<=f;g++){let b,y;(g-u)%2==0?(b=o.one.fc,y=o.one.bc):(b=o.two.fc,y=o.two.bc);for(let p=m;p<=d;p++)n[g+"_"+p]=[b,y]}}return n},ref:function(e,n){if(h.clearjfundo){h.jfundo.length=0;let l={};l.type="updateAF",l.sheetIndex=h.currentSheetIndex,l.data={historyRules:e,currentRules:n},h.jfredo.push(l)}let t=$e(h.currentSheetIndex);h.luckysheetfile[t].luckysheet_alternateformat_save=n,setTimeout(function(){Et()},1)}},xr=Ex});var import_plugin,Nx,qa,Sc=Tt(()=>{import_plugin=Le(Be());gl();Nx={parseJsonParm:function(e){if(e==null)return{};if(V(e)=="string")try{return new Function("return "+e)()}catch(n){return{}}else return e},hasKey:function(e){let t=this.parseJsonParm(e);for(let l in t)return!0;return!1}},qa=Nx});function Xa(e,n,t,l,o,a,s,u,f,m){if(n?(e.addClass("luckysheet-filter-options-active").data("rowhidden",JSON.stringify(t)).data("caljs",JSON.stringify(l)).html('<i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i>'),l!=null&&(e.data("byconditionvalue",l.value).data("byconditiontype",l.type).data("byconditiontext",l.text),l.value1!=null&&e.data("byconditionvalue1",l.value1),l.value2!=null&&e.data("byconditionvalue2",l.value2))):(e.removeClass("luckysheet-filter-options-active").data("rowhidden","").data("caljs","").html('<i class="fa fa-caret-down luckysheet-mousedown-cancel" aria-hidden="true"></i>'),e.data("byconditionvalue","null").data("byconditiontype","0").data("byconditiontext","\u65E0").data("byconditionvalue1","").data("byconditionvalue2","")),o){let d=h.luckysheetfile[$e(h.currentSheetIndex)];if(d.filter==null&&(d.filter={}),n){let g={caljs:l,rowhidden:t,optionstate:n,str:a,edr:s,cindex:u,stc:f,edc:m};d.filter[u-f]=g}else delete d.filter[u-f];He.saveParam("all",h.currentSheetIndex,d.filter,{k:"filter"})}}function Ay(e,n,t,l,o,a){let s=pt.deepCopyFlowData(h.flowdata);e=e+1;let u=!1,f=[];for(let d=e;d<=t;d++){let g=[];for(let b=n;b<=l;b++){if(s[d][b]!=null&&s[d][b].mc!=null){u=!0;break}g.push(s[d][b])}f.push(g)}if(u){let d=Oe().filter;Qe()?alert(d.mergeError):de.info(d.mergeError,"");return}f=So(f,o-n,a);for(let d=e;d<=t;d++)for(let g=n;g<=l;g++)s[d][g]=f[d-e][g-n];let m={};if(h.config.rowlen!=null){let d=$.extend(!0,{},h.config);d=tn(s,e,t,d),m={cfg:d,RowlChange:!0}}Gt(s,[{row:[e,t],column:[n,l]}],m)}function Ou(){if(!Hl(h.currentSheetIndex,"filter"))return;if(h.luckysheet_select_save.length>1){$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#"+h.container).attr("tabindex",0).focus();let n=Oe().splitText;Qe()?alert(n.tipNoMulti):de.info(n.tipNoMulti,"");return}if(h.luckysheetfile[$e(h.currentSheetIndex)].isPivotTable)return;$("#luckysheet-filter-selected-sheet"+h.currentSheetIndex+", #luckysheet-filter-options-sheet"+h.currentSheetIndex).remove();let e=h.luckysheet_select_save[0];if(e.row[0]==e.row[1]&&e.column[0]==e.column[1]){let n,t,l=e.row[1];for(let o=0;o<h.flowdata[l].length;o++){let a=h.flowdata[l][o];if(a!=null&&!rt(a.v))n==null&&(n=o);else if(n!=null){t=o-1;break}}t==null&&(t=h.flowdata[l].length-1),h.luckysheet_select_save=[{row:[l,l],column:[n,t]}],Zt(),h.luckysheet_shiftpositon=$.extend(!0,{},e),_c("down","range")}else e.row[1]-e.row[0]<2&&(h.luckysheet_shiftpositon=$.extend(!0,{},e),_c("down","range"));h.luckysheet_filter_save=$.extend(!0,{},h.luckysheet_select_save[0]),Bn(h.luckysheet_filter_save),He.saveParam("all",h.currentSheetIndex,h.luckysheet_filter_save,{k:"filter_select"}),h.filterchage&&h.jfredo.push({type:"filtershow",data:[],curdata:[],sheetIndex:h.currentSheetIndex,filter_save:h.luckysheet_filter_save})}function Bn(e,n){if($("#luckysheet-filter-selected-sheet"+h.currentSheetIndex).remove(),$("#luckysheet-filter-options-sheet"+h.currentSheetIndex).remove(),e==null||JSON.stringify(e)=="{}")return;let t=e.row[0],l=e.row[1],o=e.column[0],a=e.column[1],s=h.visibledatarow[l],u=t-1==-1?0:h.visibledatarow[t-1],f=h.visibledatacolumn[a],m=o-1==-1?0:h.visibledatacolumn[o-1],d='<div id="luckysheet-filter-selected-sheet'+h.currentSheetIndex+'" class="luckysheet-cell-selected luckysheet-filter-selected"  style="left:'+m+"px;width:"+(f-m-1)+"px;top:"+u+"px;height:"+(s-u-1)+'px;display:block;border-color:#897BFF;z-index:20;background:none;"></div>';$("#luckysheet-cell-main").append(d);let g="";for(let y=o;y<=a;y++)if(n==null||n[y-o]==null)g+='<div data-rowhidden="" data-str="'+t+'" data-edr="'+l+'" data-cindex="'+y+'" data-stc="'+o+'" data-edc="'+a+'" class="luckysheet-filter-options" style="left:'+(h.visibledatacolumn[y]-20)+"px;top:"+u+'px;display:block;"><i class="fa fa-caret-down" aria-hidden="true"></i></div>';else{let p;if(n[y-o].caljs!=null){let x;n[y-o].caljs.value1!=null?x='data-byconditionvalue1="'+n[y-o].caljs.value1+'" ':x="";let _;n[y-o].caljs.value2!=null?_='data-byconditionvalue2="'+n[y-o].caljs.value2+'" ':_="",p='data-caljs="'+JSON.stringify(n[y-o].caljs)+'" data-byconditionvalue="'+n[y-o].caljs.value+'" data-byconditiontype="'+n[y-o].caljs.type+'" data-byconditiontext="'+n[y-o].caljs.text+'" '+x+_}else p="";g+='<div data-rowhidden="'+JSON.stringify(n[y-o].rowhidden).replace(/\"/g,"'")+'" '+p+' data-str="'+t+'" data-edr="'+l+'" data-cindex="'+y+'" data-stc="'+o+'" data-edc="'+a+'" class="luckysheet-filter-options luckysheet-filter-options-active" style="left:'+(h.visibledatacolumn[y]-20)+"px;top:"+u+'px;display:block;"><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i></div>'}$("#luckysheet-cell-main").append('<div id="luckysheet-filter-options-sheet'+h.currentSheetIndex+'" class="luckysheet-filter-options-c">'+g+"</div>"),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#luckysheet-cell-main").scrollTop()>e.top_move&&$("#luckysheet-scrollbar-y").scrollTop(e.top_move);let b=h.luckysheetfile[$e(h.currentSheetIndex)];b.filter_select=e}function zy(){let e=null,n=Oe(),t=n.filter,l=n.button;$("#luckysheetfilter").click(Ou);let o=null,a=null;$(".luckysheet-cols-menu .luckysheet-cols-submenu").hover(function(){let s=$(this),u=s.attr("id"),f=$("#"+u+"_sub"),m=s.parent(),d=$(window).width(),g=$(window).height(),b=m.width(),y=f.height()+25,p=f.width()+5,x=s.offset(),_=x.top,S=x.left+b;S+p>d&&(S=x.left-p),_+y>g&&(_=g-y),f.css({top:_,left:S}).show(),a=s},function(){let s=$(this),u=s.attr("id"),f=$("#"+u+"_sub");o=setTimeout(function(){f.hide()},200)}),$(".luckysheet-rightgclick-menu-sub").hover(function(){a.addClass("luckysheet-cols-menuitem-hover"),clearTimeout(o)},function(){a.removeClass("luckysheet-cols-menuitem-hover"),$(this).hide()}),$("#luckysheet-filter-menu").mouseover(function(){clearTimeout(e),e=setTimeout(function(){$("#luckysheet-filter-submenu").hide()},500)}),$("#luckysheet-filter-submenu").mouseover(function(){clearTimeout(e)}).find(".luckysheet-cols-menuitem").click(function(s){$("#luckysheet-filter-selected span").html($(this).find(".luckysheet-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide();let u=$(this).data("type"),f=$(this).attr("data-value");u=="2"?($("#luckysheet-filter-selected span").data("type","2"),$("#luckysheet-filter-menu .luckysheet-filter-selected-input2").show(),$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","number")):u=="0"?$("#luckysheet-filter-selected span").data("type","0"):($("#luckysheet-filter-selected span").data("type","1"),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).show(),f=="dateequal"||f=="datelessthan"||f=="datemorethan"?$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","date"):f=="morethan"||f=="moreequalthan"||f=="lessthan"||f=="lessequalthan"||f=="equal"||f=="noequal"?$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","number"):$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","text")),$("#luckysheet-filter-byvalue").next().slideUp(),$("#luckysheet-filter-submenu").hide()}),$("#luckysheet-filter-bycondition, #luckysheet-filter-byvalue").click(function(){let s=$(this);s.next().slideToggle(200),setTimeout(function(){s.attr("id")=="luckysheet-filter-bycondition"&&$("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-selected span").text()!=t.filiterInputNone&&$("#luckysheet-filter-byvalue").next().slideUp(200),s.is($("#luckysheet-filter-bycondition"))&&$("#luckysheet-filter-bycondition").next().is(":hidden")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-byvalue").next().slideDown(200)},300)}),$("#luckysheet-filter-selected").click(function(){let s=$(this),u=s.offset(),f=$("#luckysheet-filter-submenu");f.hide();let m=$(window).height(),d=$(window).width(),g=f.width(),b=f.height(),y=u.top,p=u.left,x=m-u.top-20;u.left+g>d&&(p=u.left-g),u.top>m/2&&(y=m-u.top,y<0&&(y=0),x=u.top-20),f.css({top:y,left:p,height:x}).show(),clearTimeout(e)}),$("#luckysheet-cell-main").on("click",".luckysheet-filter-options",function(s){if(!Hl(h.currentSheetIndex,"filter"))return;let u=$(s.currentTarget),f=u.offset(),m=$("#luckysheet-filter-menu"),d=$(window).height(),g=$(window).width(),b=u.data("str"),y=u.data("edr"),p=u.data("cindex"),x=u.data("stc"),_=u.data("edc"),S=u.data("rowhidden")==""?{}:JSON.parse(u.data("rowhidden").replace(/\'/g,'"'));$("body .luckysheet-cols-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#luckysheet-filter-byvalue-input").val(""),$("#luckysheet-filter-bycondition").next().hide(),$("#luckysheet-filter-byvalue").next().show(),m.data("str",b),m.data("edr",y),m.data("cindex",p),m.data("stc",x),m.data("edc",_),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text(t.filiterInputNone);let I=u.data("byconditiontype");if($("#luckysheet-filter-selected span").data("value",u.data("byconditionvalue")).data("type",I).text(u.data("byconditiontext")),I=="2"){let k=$("#luckysheet-filter-menu .luckysheet-filter-selected-input2").show().find("input");k.eq(0).val(u.data("byconditionvalue1")),k.eq(1).val(u.data("byconditionvalue2"))}else I=="1"&&$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).show().find("input").val(u.data("byconditionvalue1"));$("#luckysheet-filter-orderby-asc").off("click").on("click",function(){Ay(b,x,y,_,p,!0)}),$("#luckysheet-filter-orderby-desc").off("click").on("click",function(){Ay(b,x,y,_,p,!1)});let O=ko("#luckysheet-filter-byvalue-select",{text:t.filiterMoreDataTip});$("#luckysheet-filter-byvalue-select").empty().append(O.el);let F={};$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").not(this).each(function(){let k=$(this),w=k.data("rowhidden");if(w=="")return!0;w=JSON.parse(w.replace(/\'/g,'"'));for(let C in w)F[C]=0});let D=h.flowdata;return setTimeout(function(){let k={},w={},C={},T={};for(let M=b+1;M<=y;M++){if(M in F||h.flowdata[M]==null)continue;let P=h.flowdata[M][p];if(P!=null&&!rt(P.v)&&P.ct!=null&&P.ct.t=="d"){let N=$l("YYYY-MM-DD",P.v),E=N.split("-")[0],B=N.split("-")[1],U=N.split("-")[2];E in k||(k[E]={}),B in k[E]||(k[E][B]={}),U in k[E][B]||(k[E][B][U]=0),k[E][B][U]++,M in S&&(w[E]=0,w[B]=0,w[U]=0)}else{let N,E;P==null||rt(P.v)?(N=null,E=null):(N=P.v,E=P.m),N in C||(C[N]={}),E in C[N]||(C[N][E]=0),C[N][E]++,M in S&&(T[N+"#$$$#"+E]=0)}}let z=[];if(JSON.stringify(k).length>2)for(let M in k){let P=0,N="";for(let B in k[M]){let U=0,X="";for(let he in k[M][B]){let Z=k[M][B][he];U+=Z;let ae;Number(B)<10?ae="0"+Number(B):ae=B;let J;Number(he)<10?J="0"+Number(he):J=he,M in w&&B in w&&he in w?X+='<div class="day luckysheet-mousedown-cancel cf" data-check="false" title="'+M+"-"+ae+"-"+J+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+he+'</label><span class="count luckysheet-mousedown-cancel">( '+Z+" )</span></div>":X+='<div class="day luckysheet-mousedown-cancel cf" data-check="true" title="'+M+"-"+ae+"-"+J+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+he+'</label><span class="count luckysheet-mousedown-cancel">( '+Z+" )</span></div>"}P+=U;let le;Number(B)<10?le="0"+Number(B):le=B,M in w&&B in w?N+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="false" title="'+M+"-"+le+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+B+""+t.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+U+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+X+"</div></div>":N+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="true" title="'+M+"-"+le+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+B+""+t.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+U+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+X+"</div></div>"}let E;M in w?E='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="false" title="'+M+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+M+""+t.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+P+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+N+"</div></div>":E='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="true" title="'+M+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+M+""+t.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+P+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+N+"</div></div>",z.unshift(E)}if(JSON.stringify(C).length>2){let M=Object.keys(C);M=hh(M,!0);for(let P=0;P<M.length;P++){let N=M[P];for(let E in C[N]){let B;N+"#$$$#"+E=="null#$$$#null"?B=t.valueBlank:B=E;let U;N+"#$$$#"+E in T?U='<div class="textBox luckysheet-mousedown-cancel cf" data-check="false" data-filter="'+(N+"#$$$#"+E)+'" title="'+B+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+B+'</label><span class="luckysheet-mousedown-cancel count">( '+C[N][E]+" )</span></div>":U='<div class="textBox luckysheet-mousedown-cancel cf" data-check="true" data-filter="'+(N+"#$$$#"+E)+'" title="'+B+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+B+'</label><span class="luckysheet-mousedown-cancel count">( '+C[N][E]+" )</span></div>",z.push(U)}}}let A=d-f.top-350;A<0&&(A=100),$("#luckysheet-filter-byvalue-select").append("<div class='ListBox luckysheet-mousedown-cancel' style='min-height: 100px; max-height: "+A+"px; overflow-y: auto; overflow-x: hidden;'><table cellspacing='0' style='width:100%;' class='luckysheet-mousedown-cancel'>"+z.join("")+"</table></div>"),O.close()},1),ea(m,f.left,f.top+20),s.stopPropagation(),!1}),$("#luckysheet-filter-orderby-color").hover(function(){let s=$("#luckysheet-filter-menu"),u=s.data("str"),f=s.data("edr"),m=s.data("cindex"),d=s.data("stc"),g=s.data("edc"),b={},y={},p=xr.getComputeMap(),x=xt.getComputeMap();for(let P=u+1;P<=f;P++){let N=h.flowdata[P][m],E=ht.checkstatus(h.flowdata,P,m,"bg");E==null&&(E="#ffffff");let B=xr.checksAF(P,m,p);B!=null&&(E=B[1]);let U=xt.checksCF(P,m,x);U!=null&&U.cellColor!=null&&(E=U.cellColor),E.indexOf("rgb")>-1&&(E=Ua(E)),E.length==4&&(E=E.substr(0,1)+E.substr(1,1).repeat(2)+E.substr(2,1).repeat(2)+E.substr(3,1).repeat(2));let X=ht.checkstatus(h.flowdata,P,m,"fc");B!=null&&(X=B[0]),U!=null&&U.textColor!=null&&(X=U.textColor),X.indexOf("rgb")>-1&&(X=Ua(X)),X.length==4&&(X=X.substr(0,1)+X.substr(1,1).repeat(2)+X.substr(2,1).repeat(2)+X.substr(3,1).repeat(2)),h.config!=null&&h.config.rowhidden!=null&&P in h.config.rowhidden?(b[E]=1,N!=null&&!rt(N.v)&&(y[X]=1)):(b[E]=0,N!=null&&!rt(N.v)&&(y[X]=0))}let _="";if(JSON.stringify(b).length>2&&Object.keys(b).length>1){let P="";for(let N in b)b[N]==0?P+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+N+'" title="'+N+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/></div>':P+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+N+'" title="'+N+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox"/></div>';_='<div id="filterBgColor" class="box luckysheet-mousedown-cancel"><div class="title luckysheet-mousedown-cancel">'+t.filiterByColorTip+'</div><div style="max-height:128px;overflow:auto;" class="luckysheet-mousedown-cancel">'+P+"</div></div>"}let S="";if(JSON.stringify(y).length>2&&Object.keys(y).length>1){let P="";for(let N in y)y[N]==0?P+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+N+'" title="'+N+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/></div>':P+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+N+'" title="'+N+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox"/></div>';S='<div id="filterFcColor" class="box luckysheet-mousedown-cancel"><div class="title luckysheet-mousedown-cancel">'+t.filiterByTextColorTip+'</div><div style="max-height:128px;overflow:auto;" class="luckysheet-mousedown-cancel">'+P+"</div></div>"}let I;_==""&&S==""?I='<div class="luckysheet-mousedown-cancel" style="padding: 10px 30px;text-align: center;">'+t.filterContainerOneColorTip+"</div>":I=_+S+'<div class="luckysheet-mousedown-cancel"><button id="luckysheet-filter-orderby-color-confirm" class="btn btn-primary luckysheet-mousedown-cancel" style="margin: 5px 20px;width: 70px;">'+l.confirm+"</button></div>",$("#luckysheet-filter-orderby-color-submenu").remove(),$("body").first().append('<div id="luckysheet-filter-orderby-color-submenu" class="luckysheet-cols-menu luckysheet-mousedown-cancel">'+I+"</div>");let O=$("#luckysheet-filter-orderby-color-submenu").end(),F=$(this).parent(),D=$(window).width(),k=$(window).height(),w=F.width(),C=O.height()+25,T=O.width()+5,z=$(this).offset(),A=z.top,M=z.left+w;M+T>D&&(M=z.left-T),A+C>k&&(A=k-C),$("#luckysheet-filter-orderby-color-submenu").css({top:A,left:M}).show()},function(){o=setTimeout(function(){$("#luckysheet-filter-orderby-color-submenu").hide()},200)}),$(document).on("mouseover mouseleave","#luckysheet-filter-orderby-color-submenu",function(s){s.type==="mouseover"?clearTimeout(o):$(this).hide()}),$(document).on("click","#luckysheet-filter-orderby-color-submenu .item label",function(){$(this).siblings("input[type='checkbox']").click()}),$(document).off("click.orderbyColorConfirm").on("click.orderbyColorConfirm","#luckysheet-filter-orderby-color-submenu #luckysheet-filter-orderby-color-confirm",function(){let s={},u={};$("#luckysheet-filter-orderby-color-submenu .item").each(function(A,M){if($(M).find("input[type='checkbox']").is(":checked")){let P=$(this).find("label").attr("title"),N=$(this).closest(".box").attr("id");N=="filterBgColor"?s[P]=0:N=="filterFcColor"&&(u[P]=0)}});let f;$("#luckysheet-filter-orderby-color-submenu #filterBgColor").length>0?f=!0:f=!1;let m;$("#luckysheet-filter-orderby-color-submenu #filterFcColor").length>0?m=!0:m=!1;let d=$("#luckysheet-filter-menu"),g=d.data("str"),b=d.data("edr"),y=d.data("cindex"),p=d.data("stc"),x=d.data("edc"),_={};$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").not($("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(y-p).get(0)).each(function(){let A=$(this),M=A.data("rowhidden");if(M=="")return!0;M=JSON.parse(M);for(let P in M)_[P]=0});let S={},I={},O={},F=xr.getComputeMap(),D=xt.getComputeMap();for(let A=g+1;A<=b;A++){if(A in _||h.flowdata[A]==null)continue;let M=h.flowdata[A][y],P=ht.checkstatus(h.flowdata,A,y,"bg"),N=xr.checksAF(A,y,F);N!=null&&(P=N[1]);let E=xt.checksCF(A,y,D);E!=null&&E.cellColor!=null&&(P=E.cellColor),P=P??"#ffffff",P.indexOf("rgb")>-1&&(P=Ua(P)),P.length==4&&(P=P.substr(0,1)+P.substr(1,1).repeat(2)+P.substr(2,1).repeat(2)+P.substr(3,1).repeat(2));let B=ht.checkstatus(h.flowdata,A,y,"fc");N!=null&&(B=N[0]),E!=null&&E.textColor!=null&&(B=E.textColor),B.indexOf("rgb")>-1&&(B=Ua(B)),B.length==4&&(B=B.substr(0,1)+B.substr(1,1).repeat(2)+B.substr(2,1).repeat(2)+B.substr(3,1).repeat(2)),f&&m?!(P in s)&&(!(B in u)||M==null||rt(M.v))&&(I[A]=0):f?P in s||(I[A]=0):m&&(!(B in u)||M==null||rt(M.v))&&(I[A]=0)}let k=$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(y-p),w=Object.keys(I).length>0,C=$.extend(!0,_,I),T=qa.parseJsonParm(k.data("rowhidden"));Xa(k,w,I,O,!0,g,b,y,p,x);let z=$.extend(!0,{},h.config);if(z.rowhidden=C,h.clearjfundo){let A={};A.type="datachangeAll_filter",A.sheetIndex=h.currentSheetIndex,A.config=$.extend(!0,{},h.config),A.curconfig=z,A.optionstate=w,A.optionsindex=y-p,A.rowhidden=$.extend(!0,{},I),A.rowhidenPre=$.extend(!0,{},T),O!=null&&(A.caljs=O),h.jfundo.length=0,h.jfredo.push(A)}h.config=z,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,z.rowhidden,{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu, #luckysheet-filter-orderby-color-submenu").hide(),Ir()}),$(document).off("click.filterCheckbox1").on("click.filterCheckbox1","#luckysheet-filter-byvalue-select .textBox",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox2").on("click.filterCheckbox2","#luckysheet-filter-byvalue-select .year",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox3").on("click.filterCheckbox3","#luckysheet-filter-byvalue-select .month",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));let s=!0;$(this).parents(".yearBox").find(".day").each(function(f,m){$(m).attr("data-check")=="true"||(s=!1)}),s?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterCheckbox4").on("click.filterCheckbox4","#luckysheet-filter-byvalue-select .day",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));let s=!0;$(this).parents(".monthBox").find(".day").each(function(d,g){$(g).attr("data-check")=="true"||(s=!1)}),s?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));let f=!0;$(this).parents(".yearBox").find(".day").each(function(d,g){$(g).attr("data-check")=="true"||(f=!1)}),f?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterYearDropdown").on("click.filterYearDropdown","#luckysheet-filter-byvalue-select .yearBox .fa-caret-right",function(s){let u=$(this).parents(".luckysheet-mousedown-cancel");u.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),u.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle(),s.stopPropagation()}),$("#luckysheet-filter-byvalue-btn-all").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","true")}),$("#luckysheet-filter-byvalue-btn-clear").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","false")}),$("#luckysheet-filter-byvalue-btn-contra").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(m,d){$(d).is(":checked")?($(d).removeAttr("checked"),$(d).parents(".luckysheet-mousedown-cancel").attr("data-check","false")):($(d).prop("checked",!0),$(d).parents(".luckysheet-mousedown-cancel").attr("data-check","true"))}),$("#luckysheet-filter-byvalue-select .ListBox .monthBox").each(function(m,d){let g=!0;$(d).find(".day input[type='checkbox']").each(function(y,p){$(p).is(":checked")||(g=!1)}),g?($(d).find(".month input[type='checkbox']").prop("checked",!0),$(d).attr("data-check","true")):($(d).find(".month input[type='checkbox']").removeAttr("checked"),$(d).attr("data-check","false"))}),$("#luckysheet-filter-byvalue-select .ListBox .yearBox").each(function(m,d){let g=!0;$(d).find(".day input[type='checkbox']").each(function(y,p){$(p).is(":checked")||(g=!1)}),g?($(d).find(".year input[type='checkbox']").prop("checked",!0),$(d).attr("data-check","true")):($(d).find(".year input[type='checkbox']").removeAttr("checked"),$(d).attr("data-check","false"))})}),$("#luckysheet-filter-initial").click(function(){if(!Hl(h.currentSheetIndex,"filter"))return;$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text(t.conditionNone);let s={};s.type="datachangeAll_filter_clear",s.sheetIndex=h.currentSheetIndex,s.config=$.extend(!0,{},h.config),h.config.rowhidden={},s.curconfig=$.extend(!0,{},h.config),s.filter_save=$.extend(!0,{},h.luckysheet_filter_save);let u=[];$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(){let f=$(this),m=f.hasClass("luckysheet-filter-options-active"),d=qa.parseJsonParm(f.data("rowhidden")),g=qa.parseJsonParm(f.data("caljs"));u.push({optionstate:m,rowhidden:d,caljs:g,str:f.data("str"),edr:f.data("edr"),cindex:f.data("cindex"),stc:f.data("stc"),edc:f.data("edc")})}),s.optiongroups=u,h.jfundo.length=0,h.jfredo.push(s),$("#luckysheet-filter-selected-sheet"+h.currentSheetIndex+", #luckysheet-filter-options-sheet"+h.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),h.luckysheetfile[$e(h.currentSheetIndex)].filter=null,h.luckysheetfile[$e(h.currentSheetIndex)].filter_select=null,He.saveParam("fsc",h.currentSheetIndex,null),h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,{},{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length)}),$("#luckysheet-filter-byvalue-input").on("input propertychange",function(){let s=$(this).val().toString();$("#luckysheet-filter-byvalue-select .ListBox .luckysheet-mousedown-cancel").show(),s!=""&&$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(u,f){if($(f).closest(".day").length>0){let m=$(f).siblings("label").text().toString(),d=$(f).closest(".monthBox").find(".month label").text().toString();($(f).closest(".yearBox").find(".year label").text().toString()+"-"+d+"-"+m).indexOf(s)==-1&&($(f).closest(".day").hide(),$(f).closest(".dayList").find(".day:visible").length==0&&$(f).closest(".monthBox").find(".month").hide(),$(f).closest(".monthList").find(".day:visible").length==0&&$(f).closest(".yearBox").find(".year").hide())}$(f).closest(".textBox").length>0&&$(f).siblings("label").text().toString().indexOf(s)==-1&&$(f).parents(".textBox").hide()})}),$("#luckysheet-filter-cancel").click(function(){$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}),$("#luckysheet-filter-confirm").click(function(){let s=$("#luckysheet-filter-menu"),u=s.data("str"),f=s.data("edr"),m=s.data("cindex"),d=s.data("stc"),g=s.data("edc"),b={};$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").not($("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(m-d).get(0)).each(function(){let D=$(this),k=D.data("rowhidden");if(k=="")return!0;k=JSON.parse(k.replace(/\'/g,'"'));for(let w in k)b[w]=0});let y={},p={},x={};if($("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-selected span").data("value")!="null"){let D=$("#luckysheet-filter-selected span"),k=D.data("type"),w=D.data("value");if(x.value=w,x.text=D.text(),k=="0")x.type="0";else if(k=="2"){let C=$("#luckysheet-filter-menu .luckysheet-filter-selected-input2 input");x.type="2",x.value1=C.eq(0).val(),x.value2=C.eq(1).val()}else x.type="1",x.value1=$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).find("input").val();for(let C=u+1;C<=f;C++){if(C in b||h.flowdata[C]==null)continue;let T=h.flowdata[C][m];if(w=="cellnull")T!=null&&!rt(T.v)&&(p[C]=0);else if(w=="cellnonull")(T==null||rt(T.v))&&(p[C]=0);else if(w=="textinclude"){let z=x.value1;(T==null||rt(T.v)||T.m.indexOf(z)==-1)&&(p[C]=0)}else if(w=="textnotinclude"){let z=x.value1;T==null||rt(T.v)||T.m.indexOf(z)>-1&&(p[C]=0)}else if(w=="textstart"){let z=x.value1,A=z.length;(T==null||rt(T.v)||T.m.substr(0,A)!=z)&&(p[C]=0)}else if(w=="textend"){let z=x.value1,A=z.length;(T==null||rt(T.v)||A>T.m.length||T.m.substr(T.m.length-A,A)!=z)&&(p[C]=0)}else if(w=="textequal"){let z=x.value1;(T==null||rt(T.v)||T.m!=z)&&(p[C]=0)}else if(w=="dateequal"){let z=nl(x.value1)[2];T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="d"?parseInt(T.v)!=z&&(p[C]=0):p[C]=0}else if(w=="datelessthan"){let z=nl(x.value1)[2];T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="d"?parseInt(T.v)>=z&&(p[C]=0):p[C]=0}else if(w=="datemorethan"){let z=nl(x.value1)[2];T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="d"?parseInt(T.v)<=z&&(p[C]=0):p[C]=0}else if(w=="morethan"){let z=parseFloat(x.value1);T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="n"?T.v<=z&&(p[C]=0):p[C]=0}else if(w=="moreequalthan"){let z=parseFloat(x.value1);T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="n"?T.v<z&&(p[C]=0):p[C]=0}else if(w=="lessthan"){let z=parseFloat(x.value1);T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="n"?T.v>=z&&(p[C]=0):p[C]=0}else if(w=="lessequalthan"){let z=parseFloat(x.value1);T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="n"?T.v>z&&(p[C]=0):p[C]=0}else if(w=="equal"){let z=parseFloat(x.value1);T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="n"?T.v!=z&&(p[C]=0):p[C]=0}else if(w=="noequal"){let z=parseFloat(x.value1);T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="n"?T.v==z&&(p[C]=0):p[C]=0}else if(w=="include"){let z=parseFloat(x.value1),A=parseFloat(x.value2),M,P;z<A?(M=z,P=A):(P=z,M=A),T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="n"?(T.v<M||T.v>P)&&(p[C]=0):p[C]=0}else if(w=="noinclude"){let z=parseFloat(x.value1),A=parseFloat(x.value2),M,P;z<A?(M=z,P=A):(P=z,M=A),T==null||rt(T.v)?p[C]=0:T.ct!=null&&T.ct.t=="n"?T.v>=M&&T.v<=P&&(p[C]=0):p[C]=0}}}else{$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(D,k){if($(k).is(":visible")&&$(k).is(":checked"))return!0;if($(k).closest(".day").length>0){let w=$(k).siblings("label").text();Number(w)<10&&(w="0"+Number(w));let C=$(k).closest(".monthBox").find(".month label").text().replace(t.filiterMonthText,"");Number(C)<10&&(C="0"+Number(C));let T=$(k).closest(".yearBox").find(".year label").text().replace(t.filiterYearText,""),z=t.filterDateFormatTip+"#$$$#"+T+"-"+C+"-"+w;y[z]="1"}if($(k).closest(".textBox").length>0){let w=$(k).closest(".textBox").data("filter");y[w]="1"}});for(let D=u+1;D<=f;D++){if(D in b||h.flowdata[D]==null)continue;let k=h.flowdata[D][m],w;if(k==null||rt(k.v))w="null#$$$#null";else if(k.ct!=null&&k.ct.t=="d"){let C=$l("YYYY-MM-DD",k.v);w=t.filterDateFormatTip+"#$$$#"+C}else w=k.v+"#$$$#"+k.m;w in y&&(p[D]=0)}}let _=$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(m-d),S=$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible").length||$("#luckysheet-filter-byvalue-input").val().length>0||$("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-selected span").data("value")!="null",I=$.extend(!0,b,p),O=qa.parseJsonParm(_.data("rowhidden"));Xa(_,S,p,x,!0,u,f,m,d,g);let F=$.extend(!0,{},h.config);if(F.rowhidden=I,h.clearjfundo){let D={};D.type="datachangeAll_filter",D.sheetIndex=h.currentSheetIndex,D.config=$.extend(!0,{},h.config),D.curconfig=F,D.optionstate=S,D.optionsindex=m-d,D.rowhidden=$.extend(!0,{},p),D.rowhidenPre=$.extend(!0,{},O),x!=null&&(D.caljs=x),h.jfundo.length=0,h.jfredo.push(D)}h.config=F,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,F.rowhidden,{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),Ir()})}var import_plugin,wa=Tt(()=>{import_plugin=Le(Be());ql();br();Gl();Sr();Hi();vr();Cc();ar();wr();Rl();Ut();Mr();ji();$c();jn();gl();Io();fr();Rs();Sc();Hn()});var import_plugin,Mm,$t,To=Tt(()=>{import_plugin=Le(Be());Qn();wr();Bi();ar();jn();ql();Ea();gl();Ut();Rl();Sr();qn();Mm={imgItem:{type:"3",src:"",originWidth:null,originHeight:null,default:{width:null,height:null,left:null,top:null},crop:{width:null,height:null,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:null,fixedTop:null,border:{width:0,radius:0,style:"solid",color:"#000"}},images:null,currentImgId:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,cropChange:null,cropChangeXY:null,cropChangeObj:null,copyImgItemObj:null,insertImg:function(e){let n=h.toJsonOptions&&h.toJsonOptions.uploadImage;if(typeof n=="function")n(e).then(t=>{Mm._insertImg(t)}).catch(t=>{de.info('<i class="fa fa-exclamation-triangle"></i>',"\u56FE\u7247\u4E0A\u4F20\u5931\u8D25")});else{let t=new FileReader;t.readAsDataURL(e),t.onload=function(l){let o=l.target.result;Mm._insertImg(o),$("#luckysheet-imgUpload").val("")}}},_insertImg:function(e){let n=this,t=h.luckysheet_select_save[h.luckysheet_select_save.length-1],l=t.row_focus||0,o=t.column_focus||0,a=o==0?0:h.visibledatacolumn[o-1],s=l==0?0:h.visibledatarow[l-1],u=new Image;u.onload=function(){let m=u.width,d=u.height,g={src:e,left:a,top:s,originWidth:m,originHeight:d};n.addImgItem(g)};let f=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle;u.src=typeof f=="function"?f(e):e},generateRandomId:function(e){e==null&&(e="img");let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="";for(let o=0;o<12;o++)t+=n[Math.round(Math.random()*(n.length-1))];let l=new Date().getTime();return e+"_"+t+"_"+l},modelHtml:function(e,n){let t=this,l=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,o=typeof l=="function"?l(n.src):n.src,a=t.getImgItemParam(n),s=a.width*h.zoomRatio,u=a.height*h.zoomRatio,f=a.left*h.zoomRatio,m=a.top*h.zoomRatio,d=a.position,g=n.border.width;return`<div id="${e}" class="luckysheet-modal-dialog luckysheet-modal-dialog-image" style="width:${s}px;height:${u}px;padding:0;position:${d};left:${f}px;top:${m}px;z-index:200;">
                    <div class="luckysheet-modal-dialog-content" style="width:100%;height:100%;overflow:hidden;position:relative;">
                        <img src="${o}" style="position:absolute;width:${n.default.width*h.zoomRatio}px;height:${n.default.height*h.zoomRatio}px;left:${-n.crop.offsetLeft*h.zoomRatio}px;top:${-n.crop.offsetTop*h.zoomRatio}px;" />
                    </div>
                    <div class="luckysheet-modal-dialog-border" style="border:${g}px ${n.border.style} ${n.border.color};border-radius:${n.border.radius*h.zoomRatio}px;position:absolute;left:${-g}px;right:${-g}px;top:${-g}px;bottom:${-g}px;"></div>
                </div>`},getSliderHtml:function(){let e=Oe().imageText;return`<div id="luckysheet-modal-dialog-slider-imageCtrl" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-imageCtrl" style="display:block;">
                    <div class="luckysheet-modal-dialog-slider-title">
                        <span>${e.imageSetting}</span>
                        <span class="luckysheet-model-close-btn" title="${e.close}">
                            <i class="fa fa-times" aria-hidden="true"></i>
                        </span>
                    </div>
                    <div class="luckysheet-modal-dialog-slider-content">
                        <div class="slider-box">
                            <div class="slider-box-title">${e.conventional}</div>
                            <div class="slider-box-radios">
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType1" name="imgItemType" value="1">
                                    <label for="imgItemType1">${e.moveCell1}</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType2" name="imgItemType" value="2">
                                    <label for="imgItemType2">${e.moveCell2}</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType3" name="imgItemType" value="3">
                                    <label for="imgItemType3">${e.moveCell3}</label>
                                </div>
                            </div>
                            <div class="slider-box-checkbox">
                                <input type="checkbox" id="imgItemIsFixedPos">
                                <label for="imgItemIsFixedPos">${e.fixedPos}</label>
                            </div>
                        </div>
                        <div class="slider-box">
                            <div class="slider-box-title">${e.border}</div>
                            <div class="slider-box-borderConfig">
                                <div class="border-item">
                                    <label>${e.width}</label>
                                    <input type="number" id="imgItemBorderWidth" min="0">
                                </div>
                                <div class="border-item">
                                    <label>${e.radius}</label>
                                    <input type="number" id="imgItemBorderRadius" min="0">
                                </div>
                                <div class="border-item">
                                    <label>${e.style}</label>
                                    <select id="imgItemBorderStyle">
                                        <option value="solid">${e.solid}</option>
                                        <option value="dashed">${e.dashed}</option>
                                        <option value="dotted">${e.dotted}</option>
                                        <option value="double">${e.double}</option>
                                    </select>
                                </div>
                                <div class="border-item">
                                    <label>${e.color}</label>
                                    <div id="imgItemBorderColor" class="imgItemBorderColor">
                                        <span></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`},sliderHtmlShow:function(){let e=this;$("#luckysheet-modal-dialog-slider-imageCtrl").remove();let n=e.getSliderHtml();$("body").first().append(n),Kl();let t=e.images[e.currentImgId],l=t.type;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemType"+l).prop("checked",!0);let o=t.isFixedPos;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemIsFixedPos").prop("checked",o);let a=t.border;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderWidth").val(a.width),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderRadius").val(a.radius),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderStyle").val(a.style),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span").css("background-color",a.color).attr("title",a.color),e.init()},colorSelectDialog:function(e){let n=Oe(),t=n.button,l=n.toolbar,o=n.imageCtrl;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-imageCtrl-colorSelect-dialog").remove(),$("body").first().append(yt(kl,{id:"luckysheet-imageCtrl-colorSelect-dialog",addclass:"luckysheet-imageCtrl-colorSelect-dialog",title:o.borderTile,content:`<div class="currenColor">
                            ${o.borderCur}:<span title="${e}" style="background-color:${e}"></span>
                        </div>
                        <div class="colorshowbox"></div>`,botton:`<button id="luckysheet-imageCtrl-colorSelect-dialog-confirm" class="btn btn-primary">${t.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${t.cancel}</button>`,style:"z-index:100003"}));let a=$("#luckysheet-imageCtrl-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),s=a.outerHeight(),u=a.outerWidth(),f=$(window).width(),m=$(window).height(),d=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-imageCtrl-colorSelect-dialog").css({left:(f+d-u)/2,top:(m+g-s)/3}).show(),$("#luckysheet-imageCtrl-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:t.cancel,chooseText:l.confirmColor,togglePaletteMoreText:l.customColor,togglePaletteLessText:l.collapse,togglePaletteOnly:!0,clearText:l.clearText,noColorSelectedText:l.noColorSelectedText,localStorageKey:"spectrum.textcolor"+He.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(b){b!=null?b=b.toHexString():b="#000",$("#luckysheet-imageCtrl-colorSelect-dialog .currenColor span").css("background-color",b).attr("title",b)}})},init:function(){let e=this;$("#luckysheet-modal-dialog-slider-imageCtrl .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),Kl()}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.radio").on("change.radio",".radio-item input[type=radio][name=imgItemType]",function(){e.configChange("type",this.value)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.checkbox").on("change.checkbox",".slider-box-checkbox input[type=checkbox]",function(){e.configChange("fixedPos",this.checked)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderWidth").on("change.borderWidth","#imgItemBorderWidth",function(){e.configChange("border-width",this.valueAsNumber)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderRadius").on("change.borderRadius","#imgItemBorderRadius",function(){e.configChange("border-radius",this.valueAsNumber)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderStyle").on("change.borderStyle","#imgItemBorderStyle",function(){e.configChange("border-style",this.value)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("click.color").on("click.color","#imgItemBorderColor",function(){let n=$(this).find("span").attr("title");e.colorSelectDialog(n)}),$(document).off("click.selectColorConfirm").on("click.selectColorConfirm","#luckysheet-imageCtrl-colorSelect-dialog-confirm",function(){let n=$(this).parents("#luckysheet-imageCtrl-colorSelect-dialog");$("#luckysheet-modal-dialog-mask").hide(),n.hide();let t=n.find(".currenColor span").attr("title");$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span").css("background-color",t).attr("title",t),e.configChange("border-color",t)}),$("#luckysheet-image-showBoxs").off("mousedown.active").on("mousedown.active",".luckysheet-modal-dialog-image",function(n){if(!Hl(h.currentSheetIndex,"editObjects",!1))return;$(this).hide();let t=$(this).attr("id");e.currentImgId!=null&&e.currentImgId!=t&&e.cancelActiveImgItem(),e.currentImgId=t;let l=e.images[t],o=e.getImgItemParam(l),a=o.width*h.zoomRatio,s=o.height*h.zoomRatio,u=o.left*h.zoomRatio,f=o.top*h.zoomRatio,m=o.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:a,height:s,left:u,top:f,position:m});let d=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,g=typeof d=="function"?d(l.src):l.src;$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+g+")","background-size":l.default.width*h.zoomRatio+"px "+l.default.height*h.zoomRatio+"px","background-position":-l.crop.offsetLeft*h.zoomRatio+"px "+-l.crop.offsetTop*h.zoomRatio+"px"}),$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css({"border-width":l.border.width*h.zoomRatio,"border-style":l.border.style,"border-color":l.border.color,"border-radius":l.border.radius*h.zoomRatio,left:-l.border.width*h.zoomRatio,right:-l.border.width*h.zoomRatio,top:-l.border.width*h.zoomRatio,bottom:-l.border.width*h.zoomRatio}),e.sliderHtmlShow(),n.stopPropagation()}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.move").on("mousedown.move",".luckysheet-modal-dialog-content",function(n){if(!Hl(h.currentSheetIndex,"editObjects",!1))return;$("#luckysheet-modal-dialog-slider-imageCtrl").is(":visible")||e.sliderHtmlShow(),e.move=!0,e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight;let t=$("#luckysheet-modal-dialog-activeImage").offset();e.moveXY=[n.pageX-t.left,n.pageY-t.top],Go(!0),n.stopPropagation()}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.resize").on("mousedown.resize",".luckysheet-modal-dialog-resize-item",function(n){if(!Hl(h.currentSheetIndex,"editObjects",!1))return;e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.resize=$(this).data("type");let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=ll(n.pageX,n.pageY),a=o[0]+l,s=o[1]+t,u=$("#luckysheet-modal-dialog-activeImage").position(),f=$("#luckysheet-modal-dialog-activeImage").width(),m=$("#luckysheet-modal-dialog-activeImage").height();e.resizeXY=[a,s,f,m,u.left+l,u.top+t,l,t],Go(!0),n.stopPropagation()}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.croppingEnter").on("mousedown.croppingEnter",".luckysheet-modal-controll-crop",function(n){e.croppingEnter(),n.stopPropagation()}),$("#luckysheet-modal-dialog-cropping").off("mousedown.croppingExit").on("mousedown.croppingExit",".luckysheet-modal-controll-crop",function(n){e.croppingExit(),n.stopPropagation()}),$("#luckysheet-modal-dialog-cropping").off("mousedown.cropChange").on("mousedown.cropChange",".resize-item",function(n){e.cropChange=$(this).data("type");let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=ll(n.pageX,n.pageY),a=o[0]+l,s=o[1]+t;e.cropChangeXY=[a,s],Go(!0),n.stopPropagation()}),$("#luckysheet-image-showBoxs").off("mousedown.restore").on("mousedown.restore",".luckysheet-modal-controll-restore",function(n){e.restoreImgItem(),n.stopPropagation()}),$("#luckysheet-image-showBoxs").off("mousedown.delete").on("mousedown.delete",".luckysheet-modal-controll-del",function(n){e.removeImgItem(),n.stopPropagation()})},configChange:function(e,n){let t=this,l=t.images[t.currentImgId];switch(e){case"type":l.type=n;break;case"fixedPos":l.isFixedPos=n;let o=t.getImgItemParam(l),a=o.width,s=o.height,u=o.left,f=o.top,m=o.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:a,height:s,left:u,top:f,position:m});break;case"border-width":l.border.width=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css({"border-width":n,left:-n,right:-n,top:-n,bottom:-n});break;case"border-radius":l.border.radius=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-radius",n);break;case"border-style":l.border.style=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-style",n);break;case"border-color":l.border.color=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-color",n);break}t.ref()},getImgItemParam(e){let n=e.isFixedPos,t=e.default.width,l=e.default.height,o=e.default.left,a=e.default.top;(e.crop.width!=t||e.crop.height!=l)&&(t=e.crop.width,l=e.crop.height,o+=e.crop.offsetLeft,a+=e.crop.offsetTop);let s="absolute";return n&&(s="fixed",o=e.fixedLeft+e.crop.offsetLeft,a=e.fixedTop+e.crop.offsetTop),{width:t,height:l,left:o,top:a,position:s}},cancelActiveImgItem:function(){let e=this;$("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide();let n=e.images[e.currentImgId],t=e.getImgItemParam(n),l=t.width*h.zoomRatio,o=t.height*h.zoomRatio,a=t.left*h.zoomRatio,s=t.top*h.zoomRatio,u=t.position;$("#"+e.currentImgId).show().css({width:l,height:o,left:a,top:s,position:u}),$("#"+e.currentImgId+" img").css({width:n.default.width*h.zoomRatio,height:n.default.height*h.zoomRatio,left:-n.crop.offsetLeft*h.zoomRatio,top:-n.crop.offsetTop*h.zoomRatio}),$("#"+e.currentImgId+" .luckysheet-modal-dialog-border").css({"border-width":n.border.width*h.zoomRatio,"border-style":n.border.style,"border-color":n.border.color,"border-radius":n.border.radius*h.zoomRatio,left:-n.border.width*h.zoomRatio,right:-n.border.width*h.zoomRatio,top:-n.border.width*h.zoomRatio,bottom:-n.border.width*h.zoomRatio}),e.currentImgId=null},addImgItem:function(e){let n=this,t,l,o=400;e.originHeight<e.originWidth?(l=Math.round(e.originHeight*(o/e.originWidth)),t=o):(t=Math.round(e.originWidth*(o/e.originHeight)),l=o),n.images==null&&(n.images={});let a=$.extend(!0,{},n.imgItem);a.src=e.src,a.originWidth=e.originWidth,a.originHeight=e.originHeight,a.default.width=t,a.default.height=l,a.default.left=e.left,a.default.top=e.top,a.crop.width=t,a.crop.height=l;let s=$("#luckysheet-cell-main").scrollTop(),u=$("#luckysheet-cell-main").scrollLeft();a.fixedLeft=e.left-u+h.rowHeaderWidth,a.fixedTop=e.top-s+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight;let f=n.generateRandomId(),m=n.modelHtml(f,a);$("#luckysheet-image-showBoxs .img-list").append(m),n.images[f]=a,n.ref(),n.init()},moveImgItem:function(){let e=this;e.move=!1;let n=$("#luckysheet-modal-dialog-activeImage")[0],t=e.images[e.currentImgId];t.isFixedPos?(t.fixedLeft=n.offsetLeft-t.crop.offsetLeft,t.fixedTop=n.offsetTop-t.crop.offsetTop):(t.default.left=n.offsetLeft-t.crop.offsetLeft,t.default.top=n.offsetTop-t.crop.offsetTop),e.ref()},resizeImgItem:function(){let e=this;e.resize=null;let n=$("#luckysheet-modal-dialog-activeImage")[0],t=e.images[e.currentImgId],l=n.clientWidth/t.crop.width,o=n.clientHeight/t.crop.height;t.default.width=Math.round(t.default.width*l),t.default.height=Math.round(t.default.height*o),t.crop.width=Math.round(t.crop.width*l),t.crop.height=Math.round(t.crop.height*o),t.crop.offsetLeft=Math.round(t.crop.offsetLeft*l),t.crop.offsetTop=Math.round(t.crop.offsetTop*o),t.isFixedPos?(t.fixedLeft=n.offsetLeft,t.fixedTop=n.offsetTop):(t.default.left=n.offsetLeft-t.crop.offsetLeft,t.default.top=n.offsetTop-t.crop.offsetTop),e.ref()},croppingEnter:function(){let e=this;if(e.cropping=!0,!Hl(h.currentSheetIndex,"editObjects",!1))return;$("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide();let n=e.images[e.currentImgId],t=e.getImgItemParam(n),l=t.width,o=t.height,a=t.left,s=t.top,u=t.position;$("#luckysheet-modal-dialog-cropping").show().css({width:l,height:o,left:a,top:s,position:u});let f=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,m=typeof f=="function"?f(n.src):n.src;$("#luckysheet-modal-dialog-cropping .cropping-mask").css({width:n.default.width,height:n.default.height,"background-image":"url("+m+")",left:-n.crop.offsetLeft,top:-n.crop.offsetTop}),$("#luckysheet-modal-dialog-cropping .cropping-content").css({"background-image":"url("+m+")","background-size":n.default.width+"px "+n.default.height+"px","background-position":-n.crop.offsetLeft+"px "+-n.crop.offsetTop+"px"}),$("#luckysheet-modal-dialog-cropping .luckysheet-modal-dialog-border").css({"border-width":n.border.width,"border-style":n.border.style,"border-color":n.border.color,"border-radius":n.border.radius,left:-n.border.width,right:-n.border.width,top:-n.border.width,bottom:-n.border.width})},croppingExit:function(){let e=this;e.cropping=!1,$("#luckysheet-modal-dialog-cropping").hide();let n=e.images[e.currentImgId],t=e.getImgItemParam(n),l=t.width,o=t.height,a=t.left,s=t.top,u=t.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:l,height:o,left:a,top:s,position:u});let f=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,m=typeof f=="function"?f(n.src):n.src;$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+m+")","background-size":n.default.width+"px "+n.default.height+"px","background-position":-n.crop.offsetLeft+"px "+-n.crop.offsetTop+"px"})},cropChangeImgItem:function(){let e=this;e.cropChange=null;let n=e.images[e.currentImgId];n.crop.width=e.cropChangeObj.width,n.crop.height=e.cropChangeObj.height,n.crop.offsetLeft=e.cropChangeObj.offsetLeft,n.crop.offsetTop=e.cropChangeObj.offsetTop,e.ref()},restoreImgItem:function(){let e=this,n=e.images[e.currentImgId];n.default.width=n.originWidth,n.default.height=n.originHeight,n.crop.width=n.originWidth,n.crop.height=n.originHeight,n.crop.offsetLeft=0,n.crop.offsetTop=0;let t=e.getImgItemParam(n),l=t.width,o=t.height,a=t.left,s=t.top,u=t.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:l,height:o,left:a,top:s,position:u});let f=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,m=typeof f=="function"?f(n.src):n.src;$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+m+")","background-size":n.default.width+"px "+n.default.height+"px","background-position":-n.crop.offsetLeft+"px "+-n.crop.offsetTop+"px"}),e.ref()},removeImgItem:function(){let e=this,n=e.images[e.currentImgId];!Yt.createHookFunction("imageDeleteBefore",n)||($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),$("#"+e.currentImgId).remove(),delete e.images[e.currentImgId],e.currentImgId=null,Yt.createHookFunction("imageDeleteAfter",n),e.ref())},copyImgItem:function(e){let n=this;n.copyImgItemObj=$.extend(!0,{},n.images[n.currentImgId]);let t=window.clipboardData;t||(t=e.originalEvent.clipboardData);let l='<table data-type="luckysheet_copy_action_image"><tr><td><td></tr></table>';if(t)return t.setData("Text",l),!1;{let o=$("#luckysheet-copy-content");o.html(l),o.focus(),o.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){$("#luckysheet-copy-content").blur()},10)}},pasteImgItem:function(){let e=this;e.images==null&&(e.images={});let n=h.luckysheet_select_save[0].row_focus||0,t=h.luckysheet_select_save[0].column_focus||0,l=t==0?0:h.visibledatacolumn[t-1],o=n==0?0:h.visibledatarow[n-1],a=$.extend(!0,{},e.copyImgItemObj);a.default.left=l-a.crop.offsetLeft,a.default.top=o-a.crop.offsetTop;let s=$("#luckysheet-cell-main").scrollTop(),u=$("#luckysheet-cell-main").scrollLeft();a.fixedLeft=a.default.left-u+h.rowHeaderWidth,a.fixedTop=a.default.top-s+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight;let f=e.generateRandomId(),m=e.modelHtml(f,a);$("#luckysheet-image-showBoxs .img-list").append(m),e.images[f]=a,e.ref(),e.init()},allImagesShow:function(){let e=this;if($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),$("#luckysheet-image-showBoxs .img-list").empty(),e.images!=null)for(let n in e.images){let t=e.images[n],l=e.modelHtml(n,t);$("#luckysheet-image-showBoxs .img-list").append(l)}},moveChangeSize:function(e,n,t){let l=this,o=$.extend(!0,{},l.images);if(e=="row"){let a=h.visibledatarow[n],s=n-1==-1?0:h.visibledatarow[n-1],u=t-(a-s-1);for(let f in o){let m=o[f],d=l.getImgItemParam(m),g=m.type;if(g=="1"){if(d.top>=a)m.default.top=d.top+u-m.crop.offsetTop;else if(d.top+d.height>=a-2)if(d.top<a+u){let b=(d.height+u)/d.height;m.default.height=Math.round(m.default.height*b),m.crop.height=Math.round(m.crop.height*b),m.crop.offsetTop=Math.round(m.crop.offsetTop*b)}else{let b=(d.top+d.height-a)/d.height;m.default.height=Math.round(m.default.height*b),m.crop.height=Math.round(m.crop.height*b),m.crop.offsetTop=Math.round(m.crop.offsetTop*b),m.default.top=a+u-m.crop.offsetTop}else if(d.top>a+u){let b=1/d.height;m.default.height=Math.round(m.default.height*b),m.crop.height=Math.round(m.crop.height*b),m.crop.offsetTop=Math.round(m.crop.offsetTop*b),m.default.top=a+u-m.crop.offsetTop}else if(d.top+d.height>a+u){let b=(a+u-d.top)/d.height;m.default.height=Math.round(m.default.height*b),m.crop.height=Math.round(m.crop.height*b),m.crop.offsetTop=Math.round(m.crop.offsetTop*b)}}else g=="2"&&(d.top>=a?m.default.top=d.top+u-m.crop.offsetTop:d.top>a+u&&(m.default.top=a+u-m.crop.offsetTop))}}else if(e=="column"){let a=h.visibledatacolumn[n],s=n-1==-1?0:h.visibledatacolumn[n-1],u=t-(a-s-1);for(let f in o){let m=o[f],d=l.getImgItemParam(m),g=m.type;if(g=="1"){if(d.left>=a)m.default.left=d.left+u-m.crop.offsetLeft;else if(d.left+d.width>=a-2)if(d.left<a+u){let b=(d.width+u)/d.width;m.default.width=Math.round(m.default.width*b),m.crop.width=Math.round(m.crop.width*b),m.crop.offsetLeft=Math.round(m.crop.offsetLeft*b)}else{let b=(d.left+d.width-a)/d.width;m.default.width=Math.round(m.default.width*b),m.crop.width=Math.round(m.crop.width*b),m.crop.offsetLeft=Math.round(m.crop.offsetLeft*b),m.default.left=a+u-m.crop.offsetLeft}else if(d.left>a+u){let b=1/d.width;m.default.width=Math.round(m.default.width*b),m.crop.width=Math.round(m.crop.width*b),m.crop.offsetLeft=Math.round(m.crop.offsetLeft*b),m.default.left=a+u-m.crop.offsetLeft}else if(d.left+d.width>a+u){let b=(a+u-d.left)/d.width;m.default.width=Math.round(m.default.width*b),m.crop.width=Math.round(m.crop.width*b),m.crop.offsetLeft=Math.round(m.crop.offsetLeft*b)}}else g=="2"&&(d.left>=a?m.default.left=d.left+u-m.crop.offsetLeft:d.left>a+u&&(m.default.left=a+u-m.crop.offsetLeft))}}return o},ref:function(){let e=this,n=h.luckysheetfile[$e(h.currentSheetIndex)],t=e.images;h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"imageCtrl",sheetIndex:h.currentSheetIndex,images:n.images==null?null:$.extend(!0,{},n.images),curImages:t})),n.images=$.extend(!0,{},t),He.saveParam("all",h.currentSheetIndex,n.images,{k:"images"})}},$t=Mm});function Hx(e){var n=/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/;if(n.test(e)){if(e.length==18){for(var t=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),l=new Array(1,0,10,9,8,7,6,5,4,3,2),o=0,a=0;a<17;a++)o+=e.substring(a,a+1)*t[a];var s=o%11,u=e.substring(17);return s==2?u=="X"||u=="x":u==l[s]}}else return!1}var import_plugin,Lx,Vt,Vi=Tt(()=>{import_plugin=Le(Be());gl();ir();Gl();Co();fr();Sr();io();mr();br();ar();vr();wr();Mr();Yr();ql();Rl();Ut();Lx={defaultItem:{type:"dropdown",type2:null,value1:"",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},curItem:null,dataVerification:null,selectRange:[],selectStatus:!1,optionLabel:{number:"\u6570\u503C",number_integer:"\u6574\u6570",number_decimal:"\u5C0F\u6570",bw:"\u4ECB\u4E8E",nb:"\u4E0D\u4ECB\u4E8E",eq:"\u7B49\u4E8E",ne:"\u4E0D\u7B49\u4E8E",gt:"\u5927\u4E8E",lt:"\u5C0F\u4E8E",gte:"\u5927\u4E8E\u7B49\u4E8E",lte:"\u5C0F\u4E8E\u7B49\u4E8E",include:"\u5305\u62EC",exclude:"\u4E0D\u5305\u62EC",equal:"\u7B49\u4E8E",bf:"\u65E9\u4E8E",nbf:"\u4E0D\u65E9\u4E8E",af:"\u665A\u4E8E",naf:"\u4E0D\u665A\u4E8E",card:"\u8EAB\u4EFD\u8BC1\u53F7\u7801",phone:"\u624B\u673A\u53F7"},optionLabel_en:{number:"numeric",number_integer:"integer",number_decimal:"decimal",bw:"between",nb:"not between",eq:"equal to",ne:"not equal to",gt:"greater",lt:"less than",gte:"greater or equal to",lte:"less than or equal to",include:"include",exclude:"not include",equal:"equal to",bf:"earlier than",nbf:"not earlier than",af:"later than",naf:"not later than",card:"identification number",phone:"phone number"},createDialog:function(){let e=this,n=Oe(),t=n.dataVerification,l=n.toolbar,o=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").remove();let a=`<div class="box">
                            <div class="box-item" style="border-top:1px solid #E1E4E8;">
                                <div class="box-item-title">${t.cellRange}</div>
                                <div id="data-verification-range" class="range">
                                    <input class="formulaInputFocus" spellcheck="false">
                                    <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>
                                </div>
                            </div>
                            <div class="box-item">
                                <div class="box-item-title">${t.verificationCondition}</div>
                                <select id="data-verification-type-select">
                                    <option value="dropdown">${t.dropdown}</option>
                                    <option value="checkbox">${t.checkbox}</option>
                                    <option value="number">${t.number}</option>
                                    <option value="number_integer">${t.number_integer}</option>
                                    <option value="number_decimal">${t.number_decimal}</option>
                                    <option value="text_content">${t.text_content}</option>
                                    <option value="text_length">${t.text_length}</option>
                                    <option value="date">${t.date}</option>
                                    <option value="validity">${t.validity}</option>
                                </select>
                                <div class="show-box">
                                    <div class="show-box-item show-box-item-dropdown">
                                        <div class="range">
                                            <input class="formulaInputFocus data-verification-value1" placeholder="${t.placeholder1}" spellcheck="false">
                                            <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>
                                        </div>
                                        <div class="multi">
                                            <input type="checkbox" id="data-verification-multi" class="data-verification-multi">
                                            <label for="data-verification-multi">${t.allowMultiSelect}</label>
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-checkbox">
                                        <div class="check-box">
                                            <span>${t.selected} \u2014\u2014</span>
                                            <input type="text" class="data-verification-value1" placeholder="${t.placeholder2}">
                                        </div>
                                        <div class="check-box">
                                            <span>${t.notSelected} \u2014\u2014</span>
                                            <input type="text" class="data-verification-value2" placeholder="${t.placeholder2}">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-number">
                                        <select id="data-verification-number-select">
                                            <option value="bw">${t.between}</option>
                                            <option value="nb">${t.notBetween}</option>
                                            <option value="eq">${t.equal}</option>
                                            <option value="ne">${t.notEqualTo}</option>
                                            <option value="gt">${t.moreThanThe}</option>
                                            <option value="lt">${t.lessThan}</option>
                                            <option value="gte">${t.greaterOrEqualTo}</option>
                                            <option value="lte">${t.lessThanOrEqualTo}</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="number" class="data-verification-value1" placeholder="1">
                                            <span>-</span>
                                            <input type="number" class="data-verification-value2" placeholder="100">
                                        </div>
                                        <div class="input input2">
                                            <input type="number" class="data-verification-value1" placeholder="${t.placeholder3}">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-text">
                                        <select id="data-verification-text-select">
                                            <option value="include">${t.include}</option>
                                            <option value="exclude">${t.exclude}</option>
                                            <option value="equal">${t.equal}</option>
                                        </select>
                                        <div class="input input2">
                                            <input type="text" class="data-verification-value1" placeholder="${t.placeholder4}"/>
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-textLength">
                                        <select id="data-verification-textLength-select">
                                            <option value="bw">${t.between}</option>
                                            <option value="nb">${t.notBetween}</option>
                                            <option value="eq">${t.equal}</option>
                                            <option value="ne">${t.notEqualTo}</option>
                                            <option value="gt">${t.moreThanThe}</option>
                                            <option value="lt">${t.lessThan}</option>
                                            <option value="gte">${t.greaterOrEqualTo}</option>
                                            <option value="lte">${t.lessThanOrEqualTo}</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="number" class="data-verification-value1" placeholder="1">
                                            <span>-</span>
                                            <input type="number" class="data-verification-value2" placeholder="100">
                                        </div>
                                        <div class="input input2">
                                            <input type="number" class="data-verification-value1" placeholder="${t.placeholder3}">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-date">
                                        <select id="data-verification-date-select">
                                            <option value="bw">${t.between}</option>
                                            <option value="nb">${t.notBetween}</option>
                                            <option value="eq">${t.equal}</option>
                                            <option value="ne">${t.notEqualTo}</option>
                                            <option value="bf">${t.earlierThan}</option>
                                            <option value="nbf">${t.noEarlierThan}</option>
                                            <option value="af">${t.laterThan}</option>
                                            <option value="naf">${t.noLaterThan}</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="date" class="data-verification-value1" placeholder="2020/9/10">
                                            <span>-</span>
                                            <input type="date" class="data-verification-value2" placeholder="2020/9/10">
                                        </div>
                                        <div class="input input2">
                                            <input type="date" class="data-verification-value1" placeholder="2020/9/10">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-validity">
                                        <select id="data-verification-validity-select">
                                            <option value="card">${t.identificationNumber}</option>
                                            <option value="phone">${t.phoneNumber}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="box-item">
                                <div class="check">
                                    <input type="checkbox" id="data-verification-remote" class="data-verification-remote">
                                    <label for="data-verification-remote">${t.remote}</label>
                                </div>
                                <div class="check">
                                    <input type="checkbox" id="data-verification-prohibitInput">
                                    <label for="data-verification-prohibitInput">${t.prohibitInput}</label>
                                </div>
                                <div class="check">
                                    <input type="checkbox" id="data-verification-hint-show">
                                    <label for="data-verification-hint-show">${t.hintShow}</label>
                                </div>
                                <div class="data-verification-hint-text">
                                    <input type="text" placeholder="${t.placeholder5}">
                                </div>
                            </div>
                        </div>`;$("body").first().append(yt(kl,{id:"luckysheet-dataVerification-dialog",addclass:"luckysheet-dataVerification-dialog",title:l.dataVerification,content:a,botton:`<button id="luckysheet-dataVerification-dialog-confirm" class="btn btn-primary">${o.confirm}</button>
                        <button id="luckysheet-dataVerification-dialog-delete" class="btn btn-default">${t.deleteVerification}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${o.cancel}</button>`,style:"z-index:100003"}));let s=$("#luckysheet-dataVerification-dialog").find(".luckysheet-modal-dialog-content").css("min-width",350).end(),u=s.outerHeight(),f=s.outerWidth(),m=$(window).width(),d=$(window).height(),g=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-dataVerification-dialog").css({left:(m+g-f)/2,top:(d+b-u)/3}).show(),e.dataAllocation()},init:function(){let e=this,n=Oe().dataVerification;$(document).off("click.dropdownBtn").on("click.dropdownBtn","#luckysheet-dataVerification-dropdown-btn",function(t){e.dropdownListShow(),t.stopPropagation()}),$(document).off("click.dropdownListItem").on("click.dropdownListItem","#luckysheet-dataVerification-dropdown-List .dropdown-List-item",function(t){var l=$(this);let o=t.target.innerText;l.hasClass("multi")?(l.toggleClass("checked"),o=$.map($("#luckysheet-dataVerification-dropdown-List").children().filter(".checked"),function(f){return f.innerText}).join(",")):$("#luckysheet-dataVerification-dropdown-List").hide();let a=h.luckysheet_select_save[h.luckysheet_select_save.length-1],s=a.row_focus,u=a.column_focus;$("#luckysheet-rich-text-editor").text(o),v.updatecell(s,u),t.stopPropagation()}),$(document).off("click.dvRange").on("click.dvRange","#data-verification-range .fa-table",function(t){$("#luckysheet-dataVerification-dialog").hide();let l="0",o=$(this).siblings("input").val().trim();e.rangeDialog(l,o),e.selectRange=[];let a=e.getRangeByTxt(o);if(v.rangetosheet=h.currentSheetIndex,a[0].sheetIndex!=h.currentSheetIndex&&ct.changeSheetExec(a[0].sheetIndex),a.length>0)for(let s=0;s<a.length;s++){let u=a[s].row[0],f=a[s].row[1],m=a[s].column[0],d=a[s].column[1],g=h.visibledatarow[f],b=u-1==-1?0:h.visibledatarow[u-1],y=h.visibledatacolumn[d],p=m-1==-1?0:h.visibledatacolumn[m-1];e.selectRange.push({left:p,width:y-p-1,top:b,height:g-b-1,left_move:p,width_move:y-p-1,top_move:b,height_move:g-b-1,row:[u,f],column:[m,d],row_focus:u,column_focus:m})}Jl(e.selectRange)}),$(document).off("click.dvRange2").on("click.dvRange2","#luckysheet-dataVerification-dialog .show-box-item-dropdown .range .fa-table",function(t){$("#luckysheet-dataVerification-dialog").hide();let l="1",o=$(this).siblings("input").val().trim();e.rangeDialog(l,o),e.selectRange=[];let a=e.getRangeByTxt(o);if(v.rangetosheet=h.currentSheetIndex,a[0].sheetIndex!=h.currentSheetIndex&&ct.changeSheetExec(a[0].sheetIndex),a.length>0)for(let s=0;s<a.length;s++){let u=a[s].row[0],f=a[s].row[1],m=a[s].column[0],d=a[s].column[1],g=h.visibledatarow[f],b=u-1==-1?0:h.visibledatarow[u-1],y=h.visibledatacolumn[d],p=m-1==-1?0:h.visibledatacolumn[m-1];e.selectRange.push({left:p,width:y-p-1,top:b,height:g-b-1,left_move:p,width_move:y-p-1,top_move:b,height_move:g-b-1,row:[u,f],column:[m,d],row_focus:u,column_focus:m})}Jl(e.selectRange)}),$(document).off("click.dvRangeConfirm").on("click.dvRangeConfirm","#luckysheet-dataVerificationRange-dialog-confirm",function(t){let l=$(this).attr("data-source"),o=$(this).parents("#luckysheet-dataVerificationRange-dialog").find("input").val();if(e.getRangeByTxt(o).length>1){de.info('<i class="fa fa-exclamation-triangle"></i>',"\u4E0D\u80FD\u5BF9\u591A\u91CD\u9009\u62E9\u533A\u57DF\u6267\u884C\u6B64\u64CD\u4F5C\uFF0C\u8BF7\u9009\u62E9\u5355\u4E2A\u533A\u57DF\uFF0C\u7136\u540E\u518D\u8BD5");return}l=="0"?$("#luckysheet-dataVerification-dialog #data-verification-range input").val(o):l=="1"&&$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .range input").val(o),$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),v.rangetosheet!=null&&v.rangetosheet!=h.currentSheetIndex&&(ct.changeSheetExec(v.rangetosheet),v.rangetosheet=null),Jl([])}),$(document).off("click.dvRangeClose").on("click.dvRangeClose","#luckysheet-dataVerificationRange-dialog-close",function(t){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),v.rangetosheet!=null&&v.rangetosheet!=h.currentSheetIndex&&(ct.changeSheetExec(v.rangetosheet),v.rangetosheet=null),Jl([])}),$(document).on("click","#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close",function(t){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),v.rangetosheet!=null&&v.rangetosheet!=h.currentSheetIndex&&(ct.changeSheetExec(v.rangetosheet),v.rangetosheet=null),Jl([])}),$(document).off("change.typeSelect").on("change.typeSelect","#data-verification-type-select",function(t){$("#luckysheet-dataVerification-dialog .show-box .show-box-item").hide();let l=this.value,o=e.curItem;if(l=="dropdown"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown").show();let a="";l==o.type&&(a=o.value1),$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val(a),$("#luckysheet-dataVerification-dialog #data-verification-multi").prop("checked",!!o.type2)}else if(l=="checkbox"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox").show();let a="",s="";l==o.type&&(a=o.value1,s=o.value2),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val(a),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val(s)}else if(l=="number"||l=="number_integer"||l=="number_decimal"){$("#luckysheet-dataVerification-dialog .show-box-item-number").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide();let a="bw",s="",u="";(o.type=="number"||o.type=="number_integer"||o.type=="number_decimal")&&(a=o.type2,s=o.value1,u=o.value2),$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(a),a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1").val(s),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2").val(u)}else if(l=="text_content"){$("#luckysheet-dataVerification-dialog .show-box-item-text").show();let a="include",s="";l==o.type&&(a=o.type2,s=o.value1),$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(a),$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val(s)}else if(l=="text_length"){$("#luckysheet-dataVerification-dialog .show-box-item-textLength").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide();let a="bw",s="",u="";l==o.type&&(a=o.type2,s=o.value1,u=o.value2),$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(a),a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1").val(s),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2").val(u)}else if(l=="date"){$("#luckysheet-dataVerification-dialog .show-box-item-date").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide();let a="bw",s="",u="";l==o.type&&(a=o.type2,s=o.value1,u=o.value2),$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(a),a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1").val(s),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2").val(u)}else if(l=="validity"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-validity").show();let a="card";l==o.type&&(a=o.type2),$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val(a)}}),$(document).off("change.numberSelect").on("change.numberSelect","#data-verification-number-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide();let l=this.value;l=="bw"||l=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show()}),$(document).off("change.textLengthSelect").on("change.textLengthSelect","#data-verification-textLength-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide();let l=this.value;l=="bw"||l=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show()}),$(document).off("change.dateSelect").on("change.dateSelect","#data-verification-date-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide();let l=this.value;l=="bw"||l=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show()}),$(document).off("change.hintShow").on("change.hintShow","#data-verification-hint-show",function(t){this.checked?$("#luckysheet-dataVerification-dialog .data-verification-hint-text").show():$("#luckysheet-dataVerification-dialog .data-verification-hint-text").hide()}),$(document).off("click.dvSaveConfirm").on("click.dvSaveConfirm","#luckysheet-dataVerification-dialog-confirm",function(t){let l=$("#luckysheet-dataVerification-dialog #data-verification-range input").val().trim(),o=e.getRangeByTxt(l);if(o.length==0){de.info('<i class="fa fa-exclamation-triangle"></i>',n.selectCellRange2);return}let a=o[o.length-1].row[0],s=o[o.length-1].row[1],u=o[o.length-1].column[0],f=o[o.length-1].column[1],m=pt.deepCopyFlowData(h.flowdata);a<0&&(a=0),s>m.length-1&&(s=m.length-1),u<0&&(u=0),f>m[0].length-1&&(f=m[0].length-1);let d=$("#luckysheet-dataVerification-dialog #data-verification-type-select").val(),g=null,b="",y="";if(d=="dropdown"){if(b=$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val().trim(),b.length==0){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo1);return}g=$("#luckysheet-dataVerification-dialog #data-verification-multi").is(":checked")}else if(d=="checkbox"){if(b=$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val().trim(),y=$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val().trim(),b.length==0||y.length==0){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo2);return}}else if(d=="number"||d=="number_integer"||d=="number_decimal"){if(g=$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(),b=$("#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value1").val().trim(),!Y(b)){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(g=="bw"||g=="nb"){if(y=$("#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value2").val().trim(),!Y(y)){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(Number(y)<Number(b)){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo4);return}}}else if(d=="text_content"){if(g=$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(),b=$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val().trim(),b.length==0){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo5);return}}else if(d=="text_length"){if(g=$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(),b=$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value1").val().trim(),!Y(b)){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(!Number.isInteger(Number(b))||Number(b)<0){de.info('<i class="fa fa-exclamation-triangle"></i>',n.textlengthInteger);return}if(g=="bw"||g=="nb"){if(y=$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value2").val().trim(),!Y(y)){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(!Number.isInteger(Number(y))||Number(y)<0){de.info('<i class="fa fa-exclamation-triangle"></i>',n.textlengthInteger);return}if(Number(y)<Number(b)){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo4);return}}}else if(d=="date"){if(g=$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(),b=$("#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value1").val().trim(),!Zl(b)){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo6);return}if(g=="bw"||g=="nb"){if(y=$("#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value2").val().trim(),!Zl(y)){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo6);return}if(Br(b,y)>0){de.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo7);return}}}else d=="validity"&&(g=$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val());let p=$("#luckysheet-dataVerification-dialog #data-verification-remote").is(":checked"),x=$("#luckysheet-dataVerification-dialog #data-verification-prohibitInput").is(":checked"),_=$("#luckysheet-dataVerification-dialog #data-verification-hint-show").is(":checked"),S="";_&&(S=$("#luckysheet-dataVerification-dialog .data-verification-hint-text input").val().trim());let I={type:d,type2:g,value1:b,value2:y,checked:!1,remote:p,prohibitInput:x,hintShow:_,hintText:S},O=$.extend(!0,{},e.dataVerification),F=$.extend(!0,{},e.dataVerification);for(let D=a;D<=s;D++)for(let k=u;k<=f;k++)F[D+"_"+k]=I,d=="checkbox"&&er(D,k,m,I.value2);d=="checkbox"?e.refOfCheckbox(O,F,h.currentSheetIndex,m,o[o.length-1]):e.ref(O,F,h.currentSheetIndex),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerification-dialog").hide()}),$(document).off("click.delete").on("click.delete","#luckysheet-dataVerification-dialog-delete",function(t){let l=$("#luckysheet-dataVerification-dialog #data-verification-range input").val().trim(),o=e.getRangeByTxt(l);if(o.length==0){de.info('<i class="fa fa-exclamation-triangle"></i>',n.selectCellRange2);return}let a=$.extend(!0,{},e.dataVerification),s=$.extend(!0,{},e.dataVerification),u=o[o.length-1].row[0],f=o[o.length-1].row[1],m=o[o.length-1].column[0],d=o[o.length-1].column[1];for(let g=u;g<=f;g++)for(let b=m;b<=d;b++)delete s[g+"_"+b];e.ref(a,s,h.currentSheetIndex),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerification-dialog").hide()}),$(document).on("click","#luckysheet-info .luckysheet-modal-dialog-title-close, #luckysheet-info .luckysheet-model-close-btn",function(t){$(this).parents("#luckysheet-info").hide(),$("#luckysheet-dataVerification-dialog").is(":visible")&&$("#luckysheet-modal-dialog-mask").show(),t.stopPropagation()})},dataAllocation:function(){let e=this,n=h.luckysheet_select_save[h.luckysheet_select_save.length-1],t=Al(h.currentSheetIndex,n,h.currentSheetIndex);$("#luckysheet-dataVerification-dialog #data-verification-range input").val(t);let l=n.row_focus||n.row[0],o=n.column_focus||n.column[0],s=$.extend(!0,{},e.dataVerification)[l+"_"+o];s==null&&(s=$.extend(!0,{},e.defaultItem)),e.curItem=s,$("#luckysheet-dataVerification-dialog #data-verification-type-select").val(s.type),$("#luckysheet-dataVerification-dialog .show-box .show-box-item").hide(),s.type=="dropdown"?($("#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown").show(),$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog #data-verification-multi").prop("checked",!!s.type2)):s.type=="checkbox"?($("#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox").show(),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val(s.value2)):s.type=="number"||s.type=="number_integer"||s.type=="number_decimal"?($("#luckysheet-dataVerification-dialog .show-box-item-number").show(),$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide(),s.type2=="bw"||s.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2").val(s.value2)):s.type=="text_content"?($("#luckysheet-dataVerification-dialog .show-box-item-text").show(),$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val(s.value1)):s.type=="text_length"?($("#luckysheet-dataVerification-dialog .show-box-item-textLength").show(),$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide(),s.type2=="bw"||s.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2").val(s.value2)):s.type=="date"?($("#luckysheet-dataVerification-dialog .show-box-item-date").show(),$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide(),s.type2=="bw"||s.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2").val(s.value2)):s.type=="validity"&&($("#luckysheet-dataVerification-dialog .show-box .show-box-item-validity").show(),$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val(s.type2)),$("#luckysheet-dataVerification-dialog #data-verification-remote").prop("checked",s.remote),$("#luckysheet-dataVerification-dialog #data-verification-prohibitInput").prop("checked",s.prohibitInput),$("#luckysheet-dataVerification-dialog #data-verification-hint-show").prop("checked",s.hintShow),s.hintShow?$("#luckysheet-dataVerification-dialog .data-verification-hint-text").show():$("#luckysheet-dataVerification-dialog .data-verification-hint-text").hide(),$("#luckysheet-dataVerification-dialog .data-verification-hint-text input").val(s.hintText)},rangeDialog:function(e,n){let t=this,l=Oe(),o=l.dataVerification,a=l.button;$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerificationRange-dialog").remove(),$("body").first().append(yt(kl,{id:"luckysheet-dataVerificationRange-dialog",addclass:"luckysheet-dataVerificationRange-dialog",title:o.selectCellRange,content:`<input readonly="readonly" placeholder="${o.selectCellRange2}" value="${n}"/>`,botton:`<button id="luckysheet-dataVerificationRange-dialog-confirm" class="btn btn-primary" data-source="${e}">${a.confirm}</button>
                        <button id="luckysheet-dataVerificationRange-dialog-close" class="btn btn-default">${a.close}</button>`,style:"z-index:100003"}));let s=$("#luckysheet-dataVerificationRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),u=s.outerHeight(),f=s.outerWidth(),m=$(window).width(),d=$(window).height(),g=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-dataVerificationRange-dialog").css({left:(m+g-f)/2,top:(d+b-u)/3}).show()},getTxtByRange:function(e){if(e.length>0){let n=[];for(let t=0;t<e.length;t++){let l=e[t].row[0],o=e[t].row[1],a=e[t].column[0],s=e[t].column[1];n.push(Al(h.currentSheetIndex,{row:[l,o],column:[a,s]},h.currentSheetIndex))}return n.join(",")}},getRangeByTxt:function(e){let n=[];if(e.indexOf(",")!=-1){let t=e.split(",");for(let l=0;l<t.length;l++)if(v.iscelldata(t[l]))n.push(v.getcellrange(t[l]));else{n=[];break}}else v.iscelldata(e)&&n.push(v.getcellrange(e));return n},cellFocus:function(e,n,t){$("#luckysheet-dataVerification-dropdown-btn").hide(),$("#luckysheet-dataVerification-showHintBox").hide();let l=this;if(l.dataVerification==null||l.dataVerification[e+"_"+n]==null){$("#luckysheet-dataVerification-dropdown-List").hide();return}let o=h.visibledatarow[e],a=e==0?0:h.visibledatarow[e-1],s=h.visibledatacolumn[n],u=n==0?0:h.visibledatacolumn[n-1],f=ht.mergeborer(h.flowdata,e,n);f&&(o=f.row[1],a=f.row[0],s=f.column[1],u=f.column[0]);let m=l.dataVerification[e+"_"+n];if(t&&m.type=="checkbox"){l.checkboxChange(e,n);return}if(m.type=="dropdown"?($("#luckysheet-dataVerification-dropdown-btn").show().css({"max-width":s-u,"max-height":o-a,left:s-20,top:a+(o-a-20)/2}),$("#luckysheet-dataVerification-dropdown-List").is(":visible")&&$("#luckysheet-dataVerification-dropdown-List").prop("data-index")!=e+"_"+n&&$("#luckysheet-dataVerification-dropdown-List").hide()):$("#luckysheet-dataVerification-dropdown-List").hide(),m.hintShow){let b;h.lang=="en"?b='<span style="color:#f5a623;">Hint: </span>':b='<span style="color:#f5a623;">\u63D0\u793A\uFF1A</span>',b+=l.getHintText(m),$("#luckysheet-dataVerification-showHintBox").html(b).show().css({left:u,top:o});return}let d=Mt(e,n,null);if(rt(d))return;if(!l.validateCellData(d,m)){let b;h.lang=="en"?b='<span style="color:#f72626;">Failure: </span>':b='<span style="color:#f72626;">\u5931\u6548\uFF1A</span>',b+=l.getFailureText(m),$("#luckysheet-dataVerification-showHintBox").html(b).show().css({left:u,top:o})}},getHintText:function(e){let n=this,t=e.hintText||"";return t.length==0&&(h.lang=="en"?e.type=="dropdown"?t+="please select an option in the drop-down list":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="please enter a "+n.optionLabel_en[e.type]+" "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="text_content"?t+="please enter text "+n.optionLabel_en[e.type2]+" "+e.value1:e.type=="text_length"?(t+="please enter text with length "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="date"?(t+="please enter a date "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="validity"&&(t+="please enter the correct "+n.optionLabel_en[e.type2])):e.type=="dropdown"?t+="\u8BF7\u9009\u62E9\u4E0B\u62C9\u5217\u8868\u4E2D\u7684\u9009\u9879":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="\u8BF7\u8F93\u5165"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684"+n.optionLabel[e.type]):e.type=="text_content"?t+="\u8BF7\u8F93\u5165\u5185\u5BB9"+n.optionLabel[e.type2]+e.value1+"\u7684\u6587\u672C":e.type=="text_length"?(t+="\u8BF7\u8F93\u5165\u957F\u5EA6"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u6587\u672C"):e.type=="date"?(t+="\u8BF7\u8F93\u5165"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u65E5\u671F"):e.type=="validity"&&(t+="\u8BF7\u8F93\u5165\u6B63\u786E\u7684"+n.optionLabel[e.type2]))),t},getFailureText:function(e){let n=this,t="";return h.lang=="en"?e.type=="dropdown"?t+="what you selected is not an option in the drop-down list":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="what you entered is not a "+n.optionLabel_en[e.type]+" "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="text_content"?t+="what you entered is not text that "+n.optionLabel_en[e.type2]+" "+e.value1:e.type=="text_length"?(t+="the text you entered is not length "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="date"?(t+="the date you entered is not "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="validity"&&(t+="what you entered is not a correct "+n.optionLabel_en[e.type2])):e.type=="dropdown"?t+="\u4F60\u9009\u62E9\u7684\u4E0D\u662F\u4E0B\u62C9\u5217\u8868\u4E2D\u7684\u9009\u9879":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684"+n.optionLabel[e.type]):e.type=="text_content"?t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F\u5185\u5BB9"+n.optionLabel[e.type2]+e.value1+"\u7684\u6587\u672C":e.type=="text_length"?(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F\u957F\u5EA6"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u6587\u672C"):e.type=="date"?(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u65E5\u671F"):e.type=="validity"&&(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F\u4E00\u4E2A\u6B63\u786E\u7684"+n.optionLabel[e.type2])),t},validateCellData:function(e,n){let t=this,l=n.type,o=n.type2,a=n.value1,s=n.value2;if(l=="dropdown"){let u=t.getDropdownList(a);if(o&&e)return e.split(",").every(function(m){return u.indexOf(m)!==-1});let f=!1;for(let m=0;m<u.length;m++)if(u[m]==e){f=!0;break}return f}else if(l!="checkbox"){if(l=="number"||l=="number_integer"||l=="number_decimal"){if(!Y(e)||(e=Number(e),l=="number_integer"&&e%1!=0)||l=="number_decimal"&&e%1==0||(a=Number(a),s=Number(s),o=="bw"&&(e<a||e>s))||o=="nb"&&e>=a&&e<=s||o=="eq"&&e!=a||o=="ne"&&e==a||o=="gt"&&e<=a||o=="lt"&&e>=a||o=="gte"&&e<a||o=="lte"&&e>a)return!1}else if(l=="text_content"){if(e=e.toString(),a=a.toString(),o=="include"&&e.indexOf(a)==-1||o=="exclude"&&e.indexOf(a)>-1||o=="equal"&&e!=a)return!1}else if(l=="text_length"){if(e=e.toString().length,a=Number(a),s=Number(s),o=="bw"&&(e<a||e>s)||o=="nb"&&e>=a&&e<=s||o=="eq"&&e!=a||o=="ne"&&e==a||o=="gt"&&e<=a||o=="lt"&&e>=a||o=="gte"&&e<a||o=="lte"&&e>a)return!1}else if(l=="date"){if(!Zl(e)||o=="bw"&&(Br(e,a)<0||Br(e,s)>0)||o=="nb"&&Br(e,a)>=0&&Br(e,s)<=0||o=="eq"&&Br(e,a)!=0||o=="ne"&&Br(e,a)==0||o=="bf"&&Br(e,a)>=0||o=="nbf"&&Br(e,a)<0||o=="af"&&Br(e,a)<=0||o=="naf"&&Br(e,a)>0)return!1}else if(l=="validity"&&(o=="card"&&!Hx(e)||o=="phone"&&!/^1[3456789]\d{9}$/.test(e)))return!1}return!0},dropdownListShow:function(){$("#luckysheet-dataVerification-showHintBox").hide();let e=this,n=h.luckysheet_select_save[h.luckysheet_select_save.length-1],t=n.row_focus,l=n.column_focus,o=h.visibledatarow[t],a=t==0?0:h.visibledatarow[t-1],s=h.visibledatacolumn[l],u=l==0?0:h.visibledatacolumn[l-1],f=ht.mergeborer(h.flowdata,t,l);f&&(o=f.row[1],a=f.row[0],s=f.column[1],u=f.column[0]);let m=e.dataVerification[t+"_"+l],d=e.getDropdownList(m.value1),g="";if(m.type==="dropdown"&&m.type2){let p=Mt(t,l,null),x=rt(p)?[]:p.split(",");d.forEach(_=>{g+=`<div class="dropdown-List-item  luckysheet-mousedown-cancel multi${x.indexOf(_)!==-1?" checked":""}">${_}</div>`})}else d.forEach(p=>{g+=`<div class="dropdown-List-item luckysheet-mousedown-cancel">${p}</div>`});$("#luckysheet-dataVerification-dropdown-List").html(g).prop("data-index",t+"_"+l).show().css({width:s-u-1,left:u,top:o});let b=$("#luckysheet-dataVerification-dropdown-List").outerHeight(),y=$("#luckysheet-cell-main")[0].scrollHeight;o+b>y-42-6&&$("#luckysheet-dataVerification-dropdown-List").css({top:a-b})},getDropdownList:function(e){let n=[];if(v.iscelldata(e)){let t=v.getcellrange(e),l=h.luckysheetfile[$e(t.sheetIndex)].data;for(let o=t.row[0];o<=t.row[1];o++)for(let a=t.column[0];a<=t.column[1];a++){if(l[o]==null)continue;let s=l[o][a];if(s==null||s.v==null)continue;let u=s.m||s.v;n.includes(u)||n.push(u)}}else{let t=e.split(",");for(let l=0;l<t.length;l++){let o=t[l];o.length!=0&&(n.includes(o)||n.push(o))}}return n},checkboxChange:function(e,n){let t=this,l=$.extend(!0,{},t.dataVerification),o=$.extend(!0,{},t.dataVerification),a=o[e+"_"+n];a.checked=!a.checked;let s=a.value2;a.checked&&(s=a.value1);let u=pt.deepCopyFlowData(h.flowdata);er(e,n,u,s),t.refOfCheckbox(l,o,h.currentSheetIndex,u,{row:[e,e],column:[n,n]})},ref:function(e,n,t){let l=this;if(h.clearjfundo){h.jfundo.length=0;let o={};o.type="updateDataVerification",o.sheetIndex=t,o.historyDataVerification=e,o.currentDataVerification=n,h.jfredo.push(o)}l.dataVerification=n,h.luckysheetfile[$e(t)].dataVerification=n,He.allowUpdate&&He.saveParam("all",t,n,{k:"dataVerification"}),setTimeout(function(){Et()},1)},refOfCheckbox:function(e,n,t,l,o){let a=this;if(h.clearjfundo){h.jfundo.length=0;let s={};s.type="updateDataVerificationOfCheckbox",s.sheetIndex=t,s.historyDataVerification=e,s.currentDataVerification=n,s.data=h.flowdata,s.curData=l,s.range=o,h.jfredo.push(s)}a.dataVerification=n,h.luckysheetfile[$e(t)].dataVerification=n,h.flowdata=l,pt.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[$e(t)].data=h.flowdata,He.allowUpdate&&(He.saveParam("all",t,n,{k:"dataVerification"}),He.historyParam(h.flowdata,t,o)),setTimeout(function(){Et()},1)}};Vt=Lx});function oo(e,n,t,l,o){if(o=o||h.currentSheetIndex,e=="row"&&!Hl(o,"insertRows"))return;if(e=="column"&&!Hl(o,"insertColumns"))return;let a=$e(o),s=h.luckysheetfile[a],u=$.extend(!0,[],s.data);t=Math.floor(t);let f=$.extend(!0,{},s.config);f.merge==null&&(f.merge={});let m={};for(let M in f.merge){let P=f.merge[M],N=P.r,E=P.c,B=P.rs,U=P.cs;e=="row"?n<N?m[N+t+"_"+E]={r:N+t,c:E,rs:B,cs:U}:n==N&&B!=1?l=="lefttop"?m[N+t+"_"+E]={r:N+t,c:E,rs:B,cs:U}:m[N+"_"+E]={r:N,c:E,rs:B+t,cs:U}:n<N+B-1?m[N+"_"+E]={r:N,c:E,rs:B+t,cs:U}:n==N+B-1?l=="lefttop"?B==1?m[N+t+"_"+E]={r:N+t,c:E,rs:B,cs:U}:m[N+"_"+E]={r:N,c:E,rs:B+t,cs:U}:m[N+"_"+E]={r:N,c:E,rs:B,cs:U}:m[N+"_"+E]={r:N,c:E,rs:B,cs:U}:e=="column"&&(n<E?m[N+"_"+(E+t)]={r:N,c:E+t,rs:B,cs:U}:n==E&&U!=1?l=="lefttop"?m[N+"_"+(E+t)]={r:N,c:E+t,rs:B,cs:U}:m[N+"_"+E]={r:N,c:E,rs:B,cs:U+t}:n<E+U-1?m[N+"_"+E]={r:N,c:E,rs:B,cs:U+t}:n==E+U-1?l=="lefttop"?U==1?m[N+"_"+(E+t)]={r:N,c:E+t,rs:B,cs:U}:m[N+"_"+E]={r:N,c:E,rs:B,cs:U+t}:m[N+"_"+E]={r:N,c:E,rs:B,cs:U}:m[N+"_"+E]={r:N,c:E,rs:B,cs:U})}f.merge=m;let d=s.calcChain,g=[];if(d!=null&&d.length>0)for(let M=0;M<d.length;M++){let P=$.extend(!0,{},d[M]),N=P.r,E=P.c,B=P.index,U=Jn(N,E,B);if(e=="row"){let X="="+v.functionStrChange(U,"add","row",l,n,t);u[N][E]&&u[N][E].f==U&&(u[N][E].f=X),l=="lefttop"?N>=n&&(P.r+=t):l=="rightbottom"&&N>n&&(P.r+=t),g.push(P)}else if(e=="column"){let X="="+v.functionStrChange(U,"add","col",l,n,t);u[N][E]&&u[N][E].f==U&&(u[N][E].f=X),l=="lefttop"?E>=n&&(P.c+=t):l=="rightbottom"&&E>n&&(P.c+=t),g.push(P)}}let b=s.filter_select,y=s.filter,p=null;if(b!=null&&JSON.stringify(b)!="{}"){p={filter_select:null,filter:null};let M=b.row[0],P=b.row[1],N=b.column[0],E=b.column[1];if(e=="row"){if(M<n?(P==n&&l=="lefttop"||P>n)&&(P+=t):M==n?l=="lefttop"?(M+=t,P+=t):l=="rightbottom"&&P>n&&(P+=t):(M+=t,P+=t),y!=null){p.filter={};for(let B in y){let U=y[B].rowhidden,X={};for(let le in U)le=parseFloat(le),le<n?X[le]=0:le==n?l=="lefttop"?X[le+t]=0:l=="rightbottom"&&(X[le]=0):X[le+t]=0;p.filter[B]=$.extend(!0,{},y[B]),p.filter[B].rowhidden=X,p.filter[B].str=M,p.filter[B].edr=P}}}else if(e=="column"&&(N<n?(E==n&&l=="lefttop"||E>n)&&(E+=t):N==n?l=="lefttop"?(N+=t,E+=t):l=="rightbottom"&&E>n&&(E+=t):(N+=t,E+=t),y!=null)){p.filter={};for(let B in y){let U=y[B].cindex;(U==n&&l=="lefttop"||U>n)&&(U+=t),p.filter[U-N]=$.extend(!0,{},y[B]),p.filter[U-N].cindex=U,p.filter[U-N].stc=N,p.filter[U-N].edc=E}}p.filter_select={row:[M,P],column:[N,E]}}if(p!=null&&p.filter!=null){f.rowhidden==null&&(f.rowhidden={});for(let M in p.filter){let P=p.filter[M].rowhidden;for(let N in P)f.rowhidden[N]=0}}let x=s.luckysheet_conditionformat_save,_=[];if(x!=null&&x.length>0)for(let M=0;M<x.length;M++){let P=x[M].cellrange,N=[];for(let B=0;B<P.length;B++){let U=P[B].row[0],X=P[B].row[1],le=P[B].column[0],he=P[B].column[1];e=="row"?U<n?(X==n&&l=="lefttop"||X>n)&&(X+=t):U==n?l=="lefttop"?(U+=t,X+=t):l=="rightbottom"&&X>n&&(X+=t):(U+=t,X+=t):e=="column"&&(le<n?(he==n&&l=="lefttop"||he>n)&&(he+=t):le==n?l=="lefttop"?(le+=t,he+=t):l=="rightbottom"&&he>n&&(he+=t):(le+=t,he+=t)),N.push({row:[U,X],column:[le,he]})}let E=$.extend(!0,{},x[M]);E.cellrange=N,_.push(E)}let S=s.luckysheet_alternateformat_save,I=[];if(S!=null&&S.length>0)for(let M=0;M<S.length;M++){let P=S[M].cellrange.row[0],N=S[M].cellrange.row[1],E=S[M].cellrange.column[0],B=S[M].cellrange.column[1],U=$.extend(!0,{},S[M]);e=="row"?P<n?(N==n&&l=="lefttop"||N>n)&&(N+=t):P==n?l=="lefttop"?(P+=t,N+=t):l=="rightbottom"&&N>n&&(N+=t):(P+=t,N+=t):e=="column"&&(E<n?(B==n&&l=="lefttop"||B>n)&&(B+=t):E==n?l=="lefttop"?(E+=t,B+=t):l=="rightbottom"&&B>n&&(B+=t):(E+=t,B+=t)),U.cellrange={row:[P,N],column:[E,B]},I.push(U)}let O={freezenhorizontaldata:null,freezenverticaldata:null};if(we.freezenhorizontaldata!=null&&e=="row"){let M=we.freezenhorizontaldata[2],P=we.freezenhorizontaldata[1]-1;(P==n&&l=="lefttop"||P>n)&&(P+=t);let N=h.visibledatarow[P]-2-M+h.columnHeaderHeight;O.freezenhorizontaldata=[h.visibledatarow[P],P+1,M,we.cutVolumn(h.visibledatarow,P+1),N]}else O.freezenhorizontaldata=we.freezenhorizontaldata;if(we.freezenverticaldata!=null&&e=="column"){let M=we.freezenverticaldata[2],P=we.freezenverticaldata[1]-1;(P==n&&l=="lefttop"||P>n)&&(P+=t);let N=h.visibledatacolumn[P]-2-M+h.rowHeaderWidth;O.freezenverticaldata=[h.visibledatacolumn[P],P+1,M,we.cutVolumn(h.visibledatacolumn,P+1),N]}else O.freezenverticaldata=we.freezenverticaldata;let F=s.dataVerification,D={};if(F!=null)for(let M in F){let P=Number(M.split("_")[0]),N=Number(M.split("_")[1]),E=F[M];if(e=="row")if(n<P)D[P+t+"_"+N]=E;else if(n==P)if(l=="lefttop"){D[P+t+"_"+N]=E;for(let B=0;B<t;B++)D[P+B+"_"+N]=E}else{D[P+"_"+N]=E;for(let B=0;B<t;B++)D[P+B+1+"_"+N]=E}else D[P+"_"+N]=E;else if(e=="column")if(n<N)D[P+"_"+(N+t)]=E;else if(n==N)if(l=="lefttop"){D[P+"_"+(N+t)]=E;for(let B=0;B<t;B++)D[P+"_"+(N+B)]=E}else{D[P+"_"+N]=E;for(let B=0;B<t;B++)D[P+"_"+(N+B+1)]=E}else D[P+"_"+N]=E}let k=s.hyperlink,w={};if(k!=null)for(let M in k){let P=Number(M.split("_")[0]),N=Number(M.split("_")[1]),E=k[M];e=="row"?n<P||n==P&&l=="lefttop"?w[P+t+"_"+N]=E:w[P+"_"+N]=E:e=="column"&&(n<N||n==N&&l=="lefttop"?w[P+"_"+(N+t)]=E:w[P+"_"+N]=E)}let C;if(e=="row"){if(C="r",f.rowlen!=null){let N={};for(let E in f.rowlen)E=parseFloat(E),E<n?N[E]=f.rowlen[E]:E==n?l=="lefttop"?N[E+t]=f.rowlen[E]:l=="rightbottom"&&(N[E]=f.rowlen[E]):N[E+t]=f.rowlen[E];f.rowlen=N}if(f.rowhidden!=null){let N={};for(let E in f.rowhidden)E=parseFloat(E),E<n?N[E]=f.rowhidden[E]:E==n?l=="lefttop"?N[E+t]=f.rowhidden[E]:l=="rightbottom"&&(N[E]=f.rowhidden[E]):N[E+t]=f.rowhidden[E];f.rowhidden=N}let M=[];for(let N=0;N<u[0].length;N++)M.push(null);var T=[];if(f.borderInfo&&f.borderInfo.length>0){let N=[];for(let E=0;E<f.borderInfo.length;E++){let B=f.borderInfo[E].rangeType;if(B=="range"){let U=f.borderInfo[E].range,X=[];for(let le=0;le<U.length;le++){let he=U[le].row[0],Z=U[le].row[1];l=="lefttop"?n<=he?(he+=t,Z+=t):n<=Z&&(Z+=t):n<he?(he+=t,Z+=t):n<Z&&(Z+=t),Z>=he&&X.push({row:[he,Z],column:U[le].column})}if(X.length>0){let le={rangeType:"range",borderType:f.borderInfo[E].borderType,style:f.borderInfo[E].style,color:f.borderInfo[E].color,range:X};N.push(le)}}else if(B=="cell"){let U=f.borderInfo[E].value.row_index;U===n&&T.push(JSON.parse(JSON.stringify(f.borderInfo[E]))),l=="lefttop"?n<=U&&(U+=t):n<U&&(U+=t),f.borderInfo[E].value.row_index=U,N.push(f.borderInfo[E])}}f.borderInfo=N}let P=[];for(let N=0;N<t;N++)if(P.push(JSON.stringify(M)),T.length){var z=JSON.parse(JSON.stringify(T));z.forEach(E=>{l==="rightbottom"?E.value.row_index+=N+1:l==="lefttop"&&(E.value.row_index+=N)}),f.borderInfo.push(...z)}l=="lefttop"?n==0?new Function("d","return d.unshift("+P.join(",")+")")(u):new Function("d","return d.splice("+n+", 0, "+P.join(",")+")")(u):new Function("d","return d.splice("+(n+1)+", 0, "+P.join(",")+")")(u)}else{if(C="c",f.columnlen!=null){let N={};for(let E in f.columnlen)E=parseFloat(E),E<n?N[E]=f.columnlen[E]:E==n?l=="lefttop"?N[E+t]=f.columnlen[E]:l=="rightbottom"&&(N[E]=f.columnlen[E]):N[E+t]=f.columnlen[E];f.columnlen=N}if(f.colhidden!=null){let N={};for(let E in f.colhidden)E=parseFloat(E),E<n?N[E]=f.colhidden[E]:E==n?l=="lefttop"?N[E+t]=f.colhidden[E]:l=="rightbottom"&&(N[E]=f.colhidden[E]):N[E+t]=f.colhidden[E];f.colhidden=N}let M=[];for(let N=0;N<u.length;N++)M.push(null);var T=[];if(f.borderInfo&&f.borderInfo.length>0){let N=[];for(let E=0;E<f.borderInfo.length;E++){let B=f.borderInfo[E].rangeType;if(B=="range"){let U=f.borderInfo[E].range,X=[];for(let le=0;le<U.length;le++){let he=U[le].column[0],Z=U[le].column[1];l=="lefttop"?n<=he?(he+=t,Z+=t):n<=Z&&(Z+=t):n<he?(he+=t,Z+=t):n<Z&&(Z+=t),Z>=he&&X.push({row:U[le].row,column:[he,Z]})}if(X.length>0){let le={rangeType:"range",borderType:f.borderInfo[E].borderType,style:f.borderInfo[E].style,color:f.borderInfo[E].color,range:X};N.push(le)}}else if(B=="cell"){let U=f.borderInfo[E].value.col_index;U===n&&T.push(JSON.parse(JSON.stringify(f.borderInfo[E]))),l=="lefttop"?n<=U&&(U+=t):n<U&&(U+=t),f.borderInfo[E].value.col_index=U,N.push(f.borderInfo[E])}}f.borderInfo=N}if(T.length)for(let N=0;N<t;N++){var z=JSON.parse(JSON.stringify(T));z.forEach(B=>{l==="rightbottom"?B.value.col_index+=N+1:l==="lefttop"&&(B.value.col_index+=N)}),f.borderInfo.push(...z)}for(let N=0;N<u.length;N++){let E=u[N];for(let B=0;B<t;B++){let U=JSON.parse(JSON.stringify(M[N]));l=="lefttop"?n==0?E.unshift(U):E.splice(n,0,U):E.splice(n+1,0,U)}}}s.index==h.currentSheetIndex?Ka(u,f,"addRC",{index:n,len:t,direction:l,rc:C,restore:!1},g,p,_,I,O,D,w):(s.data=u,s.config=f,s.calcChain=g,s.filter=p.filter,s.filter_select=p.filter_select,s.luckysheet_conditionformat_save=_,s.luckysheet_alternateformat_save=I,s.dataVerification=D,s.hyperlink=w);let A=null;if(e=="row"?l=="lefttop"?A=[{row:[n,n+t-1],column:[0,u[0].length-1]}]:A=[{row:[n+1,n+t],column:[0,u[0].length-1]}]:l=="lefttop"?A=[{row:[0,u.length-1],column:[n,n+t-1]}]:A=[{row:[0,u.length-1],column:[n+1,n+t]}],s.luckysheet_select_save=A,s.index==h.currentSheetIndex&&(h.luckysheet_select_save=A,Zt()),e=="row"){let M=$("#luckysheet-cell-main").scrollLeft(),P=$("#luckysheet-cell-main").scrollTop(),N=$("#luckysheet-cell-main").height(),E=$("#luckysheet-cell-main").width(),B=h.visibledatarow[A[0].row[1]],U=A[0].row[0]-1==-1?0:h.visibledatarow[A[0].row[0]-1];B-P-N+20>0?$("#luckysheet-scrollbar-y").scrollTop(B-N+20):U-P-20<0&&$("#luckysheet-scrollbar-y").scrollTop(U-20),t>30&&($("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide())}}function dh(e,n){let t=pt.deepCopyFlowData(h.flowdata),l=$.extend(!0,{},h.config);l.merge==null&&(l.merge={});let o=t[0].length,a=Hr([],e,o);t=t.concat(a);for(let s=0;s<n.length;s++){let u=n[s].r,f=n[s].c,m=n[s].v;er(u,f,t,m),m!=null&&m.mc!=null&&m.mc.rs!=null&&(l.merge[m.mc.r+"_"+m.mc.c]=$.extend(!0,{},m.mc))}h.flowdata=t,pt.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[$e(h.currentSheetIndex)].data=t,h.config=l,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,Nl(h.flowdata.length,h.flowdata[0].length)}function Za(e,n,t,l){if(l=l||h.currentSheetIndex,e=="row"&&!Hl(l,"deleteRows"))return;if(e=="column"&&!Hl(l,"deleteColumns"))return;let o=$e(l),a=h.luckysheetfile[o],s=$.extend(!0,[],a.data);if(n<0&&(n=0),t<0&&(t=0),e=="row"?(n>s.length-1&&(n=s.length-1),t>s.length-1&&(t=s.length-1)):(n>s[0].length-1&&(n=s[0].length-1),t>s[0].length-1&&(t=s[0].length-1)),n>t)return;let u=t-n+1,f=$.extend(!0,{},a.config);f.merge==null&&(f.merge={});let m={};for(let T in f.merge){let z=f.merge[T],A=z.r,M=z.c,P=z.rs,N=z.cs;e=="row"?A<n?A+P-1<n?m[A+"_"+M]={r:A,c:M,rs:P,cs:N}:A+P-1>=n&&A+P-1<t?m[A+"_"+M]={r:A,c:M,rs:n-A,cs:N}:A+P-1>=t&&(m[A+"_"+M]={r:A,c:M,rs:P-u,cs:N}):A>=n&&A<=t?A+P-1>t&&(m[n+"_"+M]={r:n,c:M,rs:A+P-1-t,cs:N}):A>t&&(m[A-u+"_"+M]={r:A-u,c:M,rs:P,cs:N}):e=="column"&&(M<n?M+N-1<n?m[A+"_"+M]={r:A,c:M,rs:P,cs:N}:M+N-1>=n&&M+N-1<t?m[A+"_"+M]={r:A,c:M,rs:P,cs:n-M}:M+N-1>=t&&(m[A+"_"+M]={r:A,c:M,rs:P,cs:N-u}):M>=n&&M<=t?M+N-1>t&&(m[A+"_"+n]={r:A,c:n,rs:P,cs:M+N-1-t}):M>t&&(m[A+"_"+(M-u)]={r:A,c:M-u,rs:P,cs:N}))}f.merge=m;let d=a.calcChain,g=[];if(d!=null&&d.length>0)for(let T=0;T<d.length;T++){let z=$.extend(!0,{},d[T]),A=z.r,M=z.c,P=z.index,N=Jn(A,M,P);if(e=="row"){if(A<n||A>t){let E="="+v.functionStrChange(N,"del","row",null,n,u);s[A][M]&&s[A][M].f==N&&(s[A][M].f=E),A>t&&(z.r=A-u),g.push(z)}}else if(e=="column"&&(M<n||M>t)){let E="="+v.functionStrChange(N,"del","col",null,n,u);s[A][M]&&s[A][M].f==N&&(s[A][M].f=E),M>t&&(z.c=M-u),g.push(z)}}let b=a.filter_select,y=a.filter,p=null;if(b!=null&&JSON.stringify(b)!="{}"){p={filter_select:null,filter:null};let T=b.row[0],z=b.row[1],A=b.column[0],M=b.column[1];if(e=="row"){if(T>t?(T-=u,z-=u,p.filter_select={row:[T,z],column:[A,M]}):T<n&&(z<n||(z<=t?z=n-1:z-=u),p.filter_select={row:[T,z],column:[A,M]}),p.filter_select!=null&&y!=null)for(let P in y){let N=y[P].rowhidden,E={};for(let B in N)B<n?E[B]=0:B>t&&(E[B-u]=0);JSON.stringify(E)!="{}"&&(p.filter==null&&(p.filter={}),p.filter[P]=$.extend(!0,{},y[P]),p.filter[P].rowhidden=E,p.filter[P].str=T,p.filter[P].edr=z)}}else if(e=="column"&&(A>t?(A-=u,M-=u,p.filter_select={row:[T,z],column:[A,M]}):A<n?(M<n||(M<=t?M=n-1:M-=u),p.filter_select={row:[T,z],column:[A,M]}):M>t&&(A=n,M-=u,p.filter_select={row:[T,z],column:[A,M]}),p.filter_select!=null&&y!=null))for(let P in y){let N=y[P].cindex;N<n?(p.filter==null&&(p.filter={}),p.filter[N-A]=$.extend(!0,{},y[P]),p.filter[N-A].edc=M):N>t&&(N-=u,p.filter==null&&(p.filter={}),p.filter[N-A]=$.extend(!0,{},y[P]),p.filter[N-A].cindex=N,p.filter[N-A].stc=A,p.filter[N-A].edc=M)}}if(p!=null&&p.filter!=null){f.rowhidden==null&&(f.rowhidden={});for(let T in p.filter){let z=p.filter[T].rowhidden;for(let A in z)f.rowhidden[A]=0}}let x=a.luckysheet_conditionformat_save,_=[];if(x!=null&&x.length>0)for(let T=0;T<x.length;T++){let z=x[T].cellrange,A=[];for(let M=0;M<z.length;M++){let P=z[M].row[0],N=z[M].row[1],E=z[M].column[0],B=z[M].column[1];e=="row"?P>=n&&N<=t||(P>t?(P-=u,N-=u):P<n?N<n||(N<=t?N=n-1:N-=u):N>t&&(P=n,N-=u),A.push({row:[P,N],column:[E,B]})):e=="column"&&(E>=n&&B<=t||(E>t?(E-=u,B-=u):E<n?B<n||(B<=t?B=n-1:B-=u):B>t&&(E=n,B-=u),A.push({row:[P,N],column:[E,B]})))}if(A.length>0){let M=$.extend(!0,{},x[T]);M.cellrange=A,_.push(M)}}let S=a.luckysheet_alternateformat_save,I=[];if(S!=null&&S.length>0)for(let T=0;T<S.length;T++){let z=S[T].cellrange.row[0],A=S[T].cellrange.row[1],M=S[T].cellrange.column[0],P=S[T].cellrange.column[1];if(e=="row"){if(!(z>=n&&A<=t)){let N=$.extend(!0,{},S[T]);z>t?(z-=u,A-=u):z<n?A<n||(A<=t?A=n-1:A-=u):A>t&&(z=n,A-=u),N.cellrange={row:[z,A],column:[M,P]},I.push(N)}}else if(e=="column"&&!(M>=n&&P<=t)){let N=$.extend(!0,{},S[T]);M>t?(M-=u,P-=u):M<n?P<n||(P<=t?P=n-1:P-=u):P>t&&(M=n,P-=u),N.cellrange={row:[z,A],column:[M,P]},I.push(N)}}let O={freezenhorizontaldata:null,freezenverticaldata:null};if(we.freezenhorizontaldata!=null&&e=="row"){let T=we.freezenhorizontaldata[2],z=al(h.visibledatarow,T);z==-1&&(z=0);let A=we.freezenhorizontaldata[1]-1;A>=n&&(A<t?A=n-1:A-=u),A<z&&(A=z);let M=h.visibledatarow[A]-2-T+h.columnHeaderHeight;O.freezenhorizontaldata=[h.visibledatarow[A],A+1,T,we.cutVolumn(h.visibledatarow,A+1),M]}else O.freezenhorizontaldata=we.freezenhorizontaldata;if(we.freezenverticaldata!=null&&e=="column"){let T=we.freezenverticaldata[2],z=al(h.visibledatacolumn,T);z==-1&&(z=0);let A=we.freezenverticaldata[1]-1;A>=n&&(A<t?A=n-1:A-=u),A<z&&(A=z);let M=h.visibledatacolumn[A]-2-T+h.rowHeaderWidth;O.freezenverticaldata=[h.visibledatacolumn[A],A+1,T,we.cutVolumn(h.visibledatacolumn,A+1),M]}else O.freezenverticaldata=we.freezenverticaldata;let F=a.dataVerification,D={};if(F!=null)for(let T in F){let z=Number(T.split("_")[0]),A=Number(T.split("_")[1]),M=F[T];e=="row"?z<n?D[z+"_"+A]=M:z>t&&(D[z-u+"_"+A]=M):e=="column"&&(A<n?D[z+"_"+A]=M:A>t&&(D[z+"_"+(A-u)]=M))}let k=a.hyperlink,w={};if(k!=null)for(let T in k){let z=Number(T.split("_")[0]),A=Number(T.split("_")[1]),M=k[T];e=="row"?z<n?w[z+"_"+A]=M:z>t&&(w[z-u+"_"+A]=M):e=="column"&&(A<n?w[z+"_"+A]=M:A>t&&(w[z+"_"+(A-u)]=M))}let C;if(e=="row"){C="r",f.rowlen==null&&(f.rowlen={});let T={};for(let A in f.rowlen)A<n?T[A]=f.rowlen[A]:A>t&&(T[A-u]=f.rowlen[A]);f.rowlen=T,f.rowhidden==null&&(f.rowhidden={});let z={};for(let A in f.rowhidden)A<n?z[A]=f.rowhidden[A]:A>t&&(z[A-u]=f.rowhidden[A]);if(f.rowhidden=z,f.borderInfo&&f.borderInfo.length>0){let A=[];for(let M=0;M<f.borderInfo.length;M++){let P=f.borderInfo[M].rangeType;if(P=="range"){let N=f.borderInfo[M].range,E=[];for(let B=0;B<N.length;B++){let U=N[B].row[0],X=N[B].row[1];for(let le=n;le<=t;le++)le<N[B].row[0]?(U-=1,X-=1):le<=N[B].row[1]&&(X-=1);X>=U&&E.push({row:[U,X],column:N[B].column})}if(E.length>0){let B={rangeType:"range",borderType:f.borderInfo[M].borderType,style:f.borderInfo[M].style,color:f.borderInfo[M].color,range:E};A.push(B)}}else if(P=="cell"){let N=f.borderInfo[M].value.row_index;N<n?A.push(f.borderInfo[M]):N>t&&(f.borderInfo[M].value.row_index=N-(t-n+1),A.push(f.borderInfo[M]))}}f.borderInfo=A}s.splice(n,u);for(let A=0;A<u;A++){let M=[];for(let P=0;P<s[0].length;P++)M.push(null);s.push(M)}}else{C="c",f.columnlen==null&&(f.columnlen={});let T={};for(let M in f.columnlen)M<n?T[M]=f.columnlen[M]:M>t&&(T[M-u]=f.columnlen[M]);f.columnlen=T,f.colhidden==null&&(f.colhidden={});let z={};for(let M in f.colhidden)M<n?z[M]=f.colhidden[M]:M>t&&(z[M-u]=f.colhidden[M]);if(f.colhidden=z,f.borderInfo&&f.borderInfo.length>0){let M=[];for(let P=0;P<f.borderInfo.length;P++){let N=f.borderInfo[P].rangeType;if(N=="range"){let E=f.borderInfo[P].range,B=[];for(let U=0;U<E.length;U++){let X=E[U].column[0],le=E[U].column[1];for(let he=n;he<=t;he++)he<E[U].column[0]?(X-=1,le-=1):he<=E[U].column[1]&&(le-=1);le>=X&&B.push({row:E[U].row,column:[X,le]})}if(B.length>0){let U={rangeType:"range",borderType:f.borderInfo[P].borderType,style:f.borderInfo[P].style,color:f.borderInfo[P].color,range:B};M.push(U)}}else if(N=="cell"){let E=f.borderInfo[P].value.col_index;E<n?M.push(f.borderInfo[P]):E>t&&(f.borderInfo[P].value.col_index=E-(t-n+1),M.push(f.borderInfo[P]))}}f.borderInfo=M}let A=[];for(let M=0;M<u;M++)A.push(null);for(let M=0;M<s.length;M++){let P=[].concat(s[M]);P.splice(n,u),s[M]=P.concat(A)}}a.index==h.currentSheetIndex?Ka(s,f,"delRC",{index:n,len:t-n+1,rc:C},g,p,_,I,O,D,w):(a.data=s,a.config=f,a.calcChain=g,a.filter=p.filter,a.filter_select=p.filter_select,a.luckysheet_conditionformat_save=_,a.luckysheet_alternateformat_save=I,a.dataVerification=D,a.hyperlink=w)}function Fs(e,n,t,l,o,a){if(a=a||h.currentSheetIndex,!Ro(a))return;let s=$e(a),u=h.luckysheetfile[s],f=$.extend(!0,[],u.data),m=t-n+1,d=o-l+1,g=$.extend(!0,{},h.config);g.merge==null&&(g.merge={});let b={};for(let T in g.merge){let z=g.merge[T],A=z.r,M=z.c,P=z.rs,N=z.cs;if(e=="moveLeft")if(n>A+P-1||t<A||l>M+N-1)b[A+"_"+M]={r:A,c:M,rs:P,cs:N};else if(n<=A&&t>=A+P-1&&o<M)b[A+"_"+(M-d)]={r:A,c:M-d,rs:P,cs:N};else for(let E=A;E<=A+P-1;E++)for(let B=M;B<=M+N-1;B++)delete f[E][B].mc;else if(e=="moveUp")if(l>M+N-1||o<M||n>A+P-1)b[A+"_"+M]={r:A,c:M,rs:P,cs:N};else if(l<=M&&o>=M+N-1&&t<A)b[A-m+"_"+M]={r:A-m,c:M,rs:P,cs:N};else for(let E=A;E<=A+P-1;E++)for(let B=M;B<=M+N-1;B++)delete f[E][B].mc}g.merge=b;let y=u.calcChain,p=[];if(y!=null&&y.length>0)for(let T=0;T<y.length;T++){let z=$.extend(!0,{},y[T]),A=z.r,M=z.c,P=z.index,N=Jn(A,M,P);if(A<n||A>t||M<l||M>o){let E;e=="moveLeft"?(E="="+v.functionStrChange(N,"del","col",null,l,d),M>o&&A>=n&&A<=t&&(z.c=M-d)):e=="moveUp"&&(E="="+v.functionStrChange(N,"del","row",null,n,m),A>t&&M>=l&&M<=o&&(z.r=A-m)),f[A][M]&&f[A][M].f==N&&(f[A][M].f=E),p.push(z)}}let x=u.filter_select,_=u.filter,S=null;if(x!=null&&JSON.stringify(x)!="{}"){S={filter_select:null,filter:null};let T=x.row[0],z=x.row[1],A=x.column[0],M=x.column[1];if(e=="moveUp")if(A>=l&&M<=o){if(T>t?S.filter_select={row:[T-m,z-m],column:[A,M]}:z<n?S.filter_select={row:[T,z],column:[A,M]}:T<n&&(z>t?S.filter_select={row:[T,z-m],column:[A,M]}:S.filter_select={row:[T,n-1],column:[A,M]}),S.filter_select!=null&&_!=null)for(let P in _){let N=_[P].rowhidden,E={};for(let B in N)B<n?E[B]=0:B>t&&(E[B-slen]=0);S.filter==null&&(S.filter={}),S.filter[P]=$.extend(!0,{},_[P]),JSON.stringify(E)!="{}"&&(S.filter[P].rowhidden=E),S.filter[P].str=S.filter_select.row[0],S.filter[P].edr=S.filter_select.row[1]}}else if(T>=n&&z<=t){if(A>o?S.filter_select={row:[T,z],column:[A,M]}:A>=l?M>o&&(S.filter_select={row:[T,z],column:[l,M-d]}):M<l?S.filter_select={row:[T,z],column:[A,M]}:M<=o?S.filter_select={row:[T,z],column:[A,l-1]}:S.filter_select={row:[T,z],column:[A,M-d]},S.filter_select!=null&&_!=null)for(let P in _){let N=S.filter_select.column[0],E=S.filter_select.column[1],B=_[P].cindex;if(B<l||B>o){S.filter==null&&(S.filter={}),B>o&&(B-=d);let U=B-N;S.filter[U]=$.extend(!0,{},_[P]),S.filter[U].cindex=B,S.filter[U].stc=N,S.filter[U].edc=E}}}else S.filter_select={row:[T,z],column:[A,M]},_!=null&&(S.filter=_);else if(e=="moveLeft")if(T>=n&&z<=t){if(A>o?S.filter_select={row:[T,z],column:[A-d,M-d]}:M<l?S.filter_select={row:[T,z],column:[A,M]}:A<l&&(M>o?S.filter_select={row:[T,z],column:[A,M-d]}:S.filter_select={row:[T,z],column:[A,l-1]}),S.filter_select!=null&&_!=null)for(let P in _){let N=S.filter_select.column[0],E=S.filter_select.column[1],B=_[P].cindex;if(B<l||B>o){S.filter==null&&(S.filter={}),B>o&&(B-=d);let U=B-N;S.filter[U]=$.extend(!0,{},_[P]),S.filter[U].cindex=B,S.filter[U].stc=N,S.filter[U].edc=E}}}else A>=l&&M<=o?(T<n||T>t)&&(S.filter_select={row:[T,z],column:[A,M]},_!=null&&(S.filter=_)):(S.filter_select={row:[T,z],column:[A,M]},_!=null&&(S.filter=_))}if(S!=null&&S.filter!=null){g.rowhidden==null&&(g.rowhidden={});for(let T in S.filter){let z=S.filter[T].rowhidden;for(let A in z)g.rowhidden[A]=0}}let I=u.luckysheet_conditionformat_save,O=[];if(I!=null&&I.length>0)for(let T=0;T<I.length;T++){let z=I[T].cellrange,A=[];for(let M=0;M<z.length;M++){let P=z[M].row[0],N=z[M].row[1],E=z[M].column[0],B=z[M].column[1];n<=P&&t>=N&&l<=E&&o>=B||(A=Oy(e,n,t,l,o,P,N,E,B,m,d))}if(A.length>0){let M=$.extend(!0,{},I[T]);M.cellrange=A,O.push(M)}}let F=u.dataVerification,D={};if(F!=null)for(let T in F){let z=Number(T.split("_")[0]),A=Number(T.split("_")[1]),M=F[T];(z<n||z>t||A<l||A>o)&&(e=="moveLeft"?A>o&&z>=n&&z<=t?D[z+"_"+(A-d)]=M:D[z+"_"+A]=M:e=="moveUp"&&(z>t&&A>=l&&A<=o?D[z-m+"_"+A]=M:D[z+"_"+A]=M))}let k=u.hyperlink,w={};if(k!=null)for(let T in k){let z=Number(T.split("_")[0]),A=Number(T.split("_")[1]),M=k[T];(z<n||z>t||A<l||A>o)&&(e=="moveLeft"?A>o&&z>=n&&z<=t?w[z+"_"+(A-d)]=M:w[z+"_"+A]=M:e=="moveUp"&&(z>t&&A>=l&&A<=o?w[z-m+"_"+A]=M:w[z+"_"+A]=M))}if(g.borderInfo&&g.borderInfo.length>0){let T=[];for(let z=0;z<g.borderInfo.length;z++){let A=g.borderInfo[z].rangeType;if(A=="range"){let M=g.borderInfo[z].range,P=[];for(let N=0;N<M.length;N++){let E=M[N].row[0],B=M[N].row[1],U=M[N].column[0],X=M[N].column[1];n<=E&&t>=B&&l<=U&&o>=X||(P=Oy(e,n,t,l,o,E,B,U,X,m,d))}if(P.length>0){let N={rangeType:"range",borderType:g.borderInfo[z].borderType,style:g.borderInfo[z].style,color:g.borderInfo[z].color,range:P};T.push(N)}}else if(A=="cell"){let M=g.borderInfo[z].value.row_index,P=g.borderInfo[z].value.col_index;(M<n||M>t||P<l||P>o)&&(e=="moveLeft"?P>o&&M>=n&&M<=t&&(P-=d,g.borderInfo[z].value.col_index=P):e=="moveUp"&&M>t&&P>=l&&P<=o&&(M-=m,g.borderInfo[z].value.row_index=M),T.push(g.borderInfo[z]))}}g.borderInfo=T}let C=[];for(let T=l;T<=o;T++)C.push(null);if(e=="moveUp"){let T=[];for(let A=n;A<=f.length-1;A++){let M=[];for(let P=l;P<=o;P++)M.push(f[A][P]);T.push(M)}T.splice(0,m);let z=[];for(let A=n;A<=t;A++)z.push(C);T=T.concat(z);for(let A=n;A<=f.length-1;A++)for(let M=l;M<=o;M++)f[A][M]=T[A-n][M-l]}else if(e=="moveLeft")for(let T=n;T<=t;T++)f[T].splice(l,d),f[T]=f[T].concat(C);u.index==h.currentSheetIndex?Pu(f,g,{type:e,str:n,edr:t,stc:l,edc:o},p,S,O,D,w):(u.data=f,u.config=g,u.calcChain=p,u.filter=S.filter,u.filter_select=S.filter_select,u.luckysheet_conditionformat_save=O,u.dataVerification=D,u.hyperlink=w)}function Oy(e,n,t,l,o,a,s,u,f,m,d){let g=[];if(e=="moveLeft"){if(n>s||t<a||l>f)g.push({row:[a,s],column:[u,f]});else if(o<u){if(n<=a&&t>=s)g.push({row:[a,s],column:[u-d,f-d]});else if(n>a&&t<s){let b=[{row:[a,n-1],column:[u,f]},{row:[t+1,s],column:[u,f]},{row:[n,t],column:[u-d,f-d]}];g=g.concat(b)}else if(n>a){let b=[{row:[a,n-1],column:[u,f]},{row:[n,s],column:[u-d,f-d]}];g=g.concat(b)}else if(t<s){let b=[{row:[a,t],column:[u-d,f-d]},{row:[t+1,s],column:[u,f]}];g=g.concat(b)}}else if(o>=u){if(l<=u&&o>=f){if(n>a&&t<s){let b=[{row:[a,n-1],column:[u,f]},{row:[t+1,s],column:[u,f]}];g=g.concat(b)}else if(n>a){let b=[{row:[a,n-1],column:[u,f]}];g=g.concat(b)}else if(t<s){let b=[{row:[t+1,s],column:[u,f]}];g=g.concat(b)}}else if(l>u&&o<f){if(n<=a&&t>=s)g.push({row:[a,s],column:[u,f-d]});else if(n>a&&t<s){let b=[{row:[a,n-1],column:[u,f]},{row:[t+1,s],column:[u,f]},{row:[n,t],column:[u,f-d]}];g=g.concat(b)}else if(n>a){let b=[{row:[a,n-1],column:[u,f]},{row:[n,s],column:[u,f-d]}];g=g.concat(b)}else if(t<s){let b=[{row:[a,t],column:[u,f-d]},{row:[t+1,s],column:[u,f]}];g=g.concat(b)}}else if(l>u){if(n<=a&&t>=s)g.push({row:[a,s],column:[u,l-1]});else if(n>a&&t<s){let b=[{row:[a,n-1],column:[u,f]},{row:[t+1,s],column:[u,f]},{row:[n,t],column:[u,l-1]}];g=g.concat(b)}else if(n>a){let b=[{row:[a,n-1],column:[u,f]},{row:[n,s],column:[u,l-1]}];g=g.concat(b)}else if(t<s){let b=[{row:[a,t],column:[u,l-1]},{row:[t+1,s],column:[u,f]}];g=g.concat(b)}}else if(o<f){if(n<=a&&t>=s)g.push({row:[a,s],column:[u-d,f-d]});else if(n>a&&t<s){let b=[{row:[a,n-1],column:[u,f]},{row:[t+1,s],column:[u,f]},{row:[n,t],column:[u-d,f-d]}];g=g.concat(b)}else if(n>a){let b=[{row:[a,n-1],column:[u,f]},{row:[n,s],column:[u-d,f-d]}];g=g.concat(b)}else if(t<s){let b=[{row:[a,t],column:[u-d,f-d]},{row:[t+1,s],column:[u,f]}];g=g.concat(b)}}}}else if(e=="moveUp"){if(l>f||o<u||n>s)g.push({row:[a,s],column:[u,f]});else if(t<a){if(l<=u&&o>=f)g.push({row:[a-m,s-m],column:[u,f]});else if(l>u&&o<f){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,f]},{row:[a-m,s-m],column:[l,o]}];g=g.concat(b)}else if(l>u){let b=[{row:[a,s],column:[u,l-1]},{row:[a-m,s-m],column:[l,f]}];g=g.concat(b)}else if(o<f){let b=[{row:[a-m,s-m],column:[u,o]},{row:[a,s],column:[o+1,f]}];g=g.concat(b)}}else if(t>=a){if(n<=a&&t>=s){if(l>u&&o<f){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,f]}];g=g.concat(b)}else if(l>u){let b=[{row:[a,s],column:[u,l-1]}];g=g.concat(b)}else if(o<f){let b=[{row:[a,s],column:[o+1,f]}];g=g.concat(b)}}else if(n>a&&t<s){if(l<=u&&o>=f)g.push({row:[a,s-m],column:[u,f]});else if(l>u&&o<f){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,f]},{row:[a,s-m],column:[l,o]}];g=g.concat(b)}else if(l>u){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s-m],column:[l,f]}];g=g.concat(b)}else if(o<f){let b=[{row:[a,s-m],column:[u,o]},{row:[a,s],column:[o+1,f]}];g=g.concat(b)}}else if(n>a){if(l<=u&&o>=f)g.push({row:[a,n-1],column:[u,f]});else if(l>u&&o<f){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,f]},{row:[a,n-1],column:[l,o]}];g=g.concat(b)}else if(l>u){let b=[{row:[a,s],column:[u,l-1]},{row:[a,n-1],column:[l,f]}];g=g.concat(b)}else if(o<f){let b=[{row:[a,n-1],column:[u,o]},{row:[a,s],column:[o+1,f]}];g=g.concat(b)}}else if(t<s){if(l<=u&&o>=f)g.push({row:[a-m,s-m],column:[u,f]});else if(l>u&&o<f){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,f]},{row:[a-m,s-m],column:[l,o]}];g=g.concat(b)}else if(l>u){let b=[{row:[a,s],column:[u,l-1]},{row:[a-m,s-m],column:[l,f]}];g=g.concat(b)}else if(o<f){let b=[{row:[a-m,s-m],column:[u,o]},{row:[a,s],column:[o+1,f]}];g=g.concat(b)}}}}return g}var import_plugin,Ms=Tt(()=>{import_plugin=Le(Be());br();ir();fr();mr();io();ji();li();vr();xo();jn();ql();Ut()});function Dm(e,n,t,l,o){o==null&&(o=!0),h.visibledatarow=[],h.visibledatacolumn=[],h.ch_width=0,h.rh_height=0,h.zoomRatio=1,l!=null?h.config=l:h.config={},t.length==0?h.flowdata=Hr(t,n,e):t.length<n&&t[0].length<e?h.flowdata=Hr(t,n-t.length,e-t[0].length):t.length<n?h.flowdata=Hr(t,n-t.length,0):t[0].length<e?h.flowdata=Hr(t,0,e-t[0].length):h.flowdata=t,pt.webWorkerFlowDataCache(h.flowdata),ya(n,e),o&&(ct.showSheet(),setTimeout(function(){ct.restoreCache(),v.execFunctionGroup(),ct.restoreSheetAll(h.currentSheetIndex),Et()},1))}var import_plugin,Py=Tt(()=>{import_plugin=Le(Be());mr();br();zu();ir();fr();Yr();Ut()});var import_plugin,Ic,Bx,Yt,qn=Tt(()=>{import_plugin=Le(Be());wr();ar();Yr();ir();To();Vi();Qo();li();ql();Ms();bn();br();Py();Ut();Ic={defaultStore:{container:null,luckysheetfile:null,defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:!0,devicePixelRatio:1,currentSheetIndex:0,calculateSheetIndex:0,flowdata:[],config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:0,infobarHeight:0,calculatebarHeight:0,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,jfcountfuncTimeout:null,jfautoscrollTimeout:null,luckysheet_select_status:!1,luckysheet_select_save:[{row:[0,0],column:[0,0]}],luckysheet_selection_range:[],luckysheet_copy_save:{},luckysheet_paste_iscut:!1,filterchage:!0,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:!1,luckysheet_sheet_move_data:[],luckysheet_scroll_status:!1,luckysheetisrefreshdetail:!0,luckysheetisrefreshtheme:!0,luckysheetcurrentisPivotTable:!1,luckysheet_rows_selected_status:!1,luckysheet_cols_selected_status:!1,luckysheet_rows_change_size:!1,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:!1,luckysheet_cols_change_size_start:[],luckysheet_cols_dbclick_timeout:null,luckysheet_cols_dbclick_times:0,luckysheetCellUpdate:[],luckysheet_shiftpositon:null,iscopyself:!0,orderbyindex:0,luckysheet_model_move_state:!1,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:!1,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:!1,luckysheet_cell_selected_extend_index:[],luckysheet_cell_selected_extend_time:null,clearjfundo:!0,jfredo:[],jfundo:[],lang:"en",createChart:"",highlightChart:"",zIndex:15,chartparam:{luckysheetCurrentChart:null,luckysheetCurrentChartActive:!1,luckysheetCurrentChartMove:null,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:null,luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetCurrentChartResize:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheetInsertChartTosheetChange:!0,luckysheetCurrentChartZIndexRank:100,luckysheet_chart_redo_click:!1,luckysheetCurrentChartMaxState:!1,jfrefreshchartall:"",changeChartCellData:"",renderChart:"",getChartJson:""},functionList:null,luckysheet_function:null,chart_selection:{},currentChart:"",scrollRefreshSwitch:!0,measureTextCache:{},measureTextCellInfoCache:{},measureTextCacheTimeOut:null,cellOverflowMapCache:{},zoomRatio:1,visibledatacolumn_unique:null,visibledatarow_unique:null,showGridLines:!0,toobarObject:{},inlineStringEditCache:null,inlineStringEditRange:null,fontList:[],currentSheetView:"viewNormal"},defaultFormula:{searchFunctionCell:null,functionlistPosition:{},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangedrag_column_start:!1,rangedrag_row_start:!1,rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,functionHTMLIndex:0,functionRangeIndex:null,execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},cellTextToIndexList:{},isFunctionRangeSave:!1,execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},formulaContainCellList:{},cellTextToIndexList:{},execFunctionGlobalData:{},groupValuesRefreshData:[],functionResizeData:{},functionResizeStatus:!1,functionResizeTimeout:null,data_parm_index:0},defaultSheet:{sheetMaxIndex:0,nulldata:null,mergeCalculationSheet:{},checkLoadSheetIndexToDataIndex:{},CacheNotLoadControll:[]},defaultPivotTable:{pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,luckysheet_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},drawPivotTable:!0,pivotTableBoundary:[12,6]},defaultImage:{imgItem:{type:"3",src:"",originWidth:null,originHeight:null,default:{width:null,height:null,left:null,top:null},crop:{width:null,height:null,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:null,fixedTop:null,border:{width:0,radius:0,style:"solid",color:"#000"}},images:null,currentImgId:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,cropChange:null,cropChangeXY:null,cropChangeObj:null,copyImgItemObj:null},defaultDataVerification:{defaultItem:{type:"dropdown",type2:null,value1:"",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},curItem:null,dataVerification:null,selectRange:[],selectStatus:!1}},Bx={addDataAjax:function(e,n,t,l){let o=this;n==null&&(n=h.currentSheetIndex),t==null&&(t=He.loadSheetUrl),$("#luckysheet-grid-window-1").append(ko()),e.currentPage++;let a="application/json;charset=UTF-8",s=sessionStorage.getItem("x-auth-token");$.ajax({method:"POST",url:t,headers:{"x-auth-token":s},data:JSON.stringify(e),contentType:a,success:function(u){typeof u=="string"&&(u=JSON.parse(u));let f=u.data,m=f.celldata;dh(f.row,m),setTimeout(function(){h.loadingObj.close()},500),l&&typeof l=="function"&&l(f)}})},reload:function(e,n,t,l){let o=this;n==null&&(n=h.currentSheetIndex),t==null&&(t=He.loadSheetUrl),$("#luckysheet-grid-window-1").append(ko());let a={gridKey:He.gridKey,index:n};e=$.extend(!0,e,a);let s=h.luckysheetfile[$e(n)];$.post(t,e,function(u){let f=new Function("return "+u)();s.celldata=f[n.toString()];let m=ct.buildGridData(s);setTimeout(function(){h.loadingObj.close()},500),s.data=m,h.flowdata=m,pt.webWorkerFlowDataCache(m),Dm(m[0].length,m.length,m,null,!1),s.load="1",h.luckysheet_select_save.length=0,h.luckysheet_selection_range=[],He.saveParam("shs",null,h.currentSheetIndex),ct.changeSheet(n),l&&typeof l=="function"&&l()})},clearSheetByIndex:function(e){let n=$e(e),t=h.luckysheetfile[n];t.isPivotTable?delete h.luckysheetfile[n]:(t.data=[],t.row=h.defaultrowNum,t.column=h.defaultcolumnNum,t.chart=[],t.config=null,t.filter=null,t.filter_select=null,t.celldata=[],t.pivotTable={},t.calcChain=[],t.status=0,t.load=0,h.flowdata=[],pt.webWorkerFlowDataCache(h.flowdata),$("#"+h.container+" .luckysheet-data-visualization-chart").remove(),$("#"+h.container+" .luckysheet-datavisual-selection-set").remove(),$("#luckysheet-row-count-show, #luckysheet-formula-functionrange-select, #luckysheet-row-count-show, #luckysheet-column-count-show, #luckysheet-change-size-line, #luckysheet-cell-selected-focus, #luckysheet-selection-copy, #luckysheet-cell-selected-extend, #luckysheet-cell-selected-move, #luckysheet-cell-selected").hide(),delete t.load)},clear:function(e){let n=this;if(e=="all")for(let t=0;t<h.luckysheetfile.length;t++){let l=h.luckysheetfile[t];n.clearSheetByIndex(l.index)}else e==null&&(e=h.currentSheetIndex),n.clearSheetByIndex(e);ct.changeSheet(h.luckysheetfile[0].index)},destroy:function(){$("#"+h.container).empty(),$("body > .luckysheet-cols-menu").remove(),$("#luckysheet-modal-dialog-mask, #luckysheetTextSizeTest, #luckysheet-icon-morebtn-div").remove(),$("#luckysheet-input-box").parent().remove(),$("#luckysheet-formula-help-c").remove(),$(".chartSetting, .luckysheet-modal-dialog-slider").remove(),$(document).off(".luckysheetEvent"),$(document).off(".luckysheetProtection"),we.initialHorizontal=!0,we.initialVertical=!0;let e=$.extend(!0,{},Ic.defaultStore);for(let s in e)s in h&&(h[s]=e[s]);let n=$.extend(!0,{},Ic.defaultFormula);for(let s in n)s in v&&(v[s]=n[s]);let t=$.extend(!0,{},Ic.defaultSheet);for(let s in t)s in ct&&(ct[s]=t[s]);let l=$.extend(!0,{},Ic.defaultPivotTable);for(let s in l)s in Pt&&(Pt[s]=l[s]);let o=$.extend(!0,{},Ic.defaultImage);for(let s in o)s in $t&&($t[s]=o[s]);let a=$.extend(!0,{},Ic.defaultDataVerification);for(let s in a)s in Vt&&(Vt[s]=a[s]);h.asyncLoad=["core"]},editorChart:function(e){let n=si[0],t="luckysheetEditMode-datav-chart",l=t+"_selection";e.chart_id=t;let o=e.chartTheme;o=o??"default0000",luckysheet.insertChartTosheet(e.sheetIndex,e.dataSheetIndex,e.option,e.chartType,e.selfOption,e.defaultOption,e.row,e.column,n,t,l,e.chartStyle,e.rangeConfigCheck,e.rangeRowCheck,e.rangeColCheck,e.chartMarkConfig,e.chartTitleConfig,e.winWidth,e.winHeight,e.scrollLeft,e.scrollTop,o,e.myWidth,e.myHeight,e.myLeft!=null?parseFloat(e.myLeft):null,e.myTop!=null?parseFloat(e.myTop):null,e.myindexrank,!0),$("#"+t).find(".luckysheet-modal-controll-update").click()},createHookFunction:function(){let e=arguments[0];if(lt.hook&&lt.hook[e]!=null&&typeof lt.hook[e]=="function"){var n=Array.prototype.slice.apply(arguments);return n.shift(),lt.hook[e].apply(this,n)!==!1}return!0}},Yt=Bx});var import_plugin,jx,Nt,Fo=Tt(()=>{import_plugin=Le(Be());Qn();br();ir();pa();fr();Ea();ql();gl();li();Mr();jn();wr();Ut();qn();jx={defaultWidth:144,defaultHeight:84,currentObj:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,init:function(){let e=this;$("#luckysheet-postil-showBoxs").off("mousedown.showPs").on("mousedown.showPs",".luckysheet-postil-show",function(n){if(!!Hl(h.currentSheetIndex,"editObjects",!1)){if(e.currentObj=$(this).find(".luckysheet-postil-show-main"),$(this).hasClass("luckysheet-postil-show-active")){n.stopPropagation();return}e.removeActivePs(),$(this).addClass("luckysheet-postil-show-active"),$(this).find(".luckysheet-postil-dialog-resize").show(),$(this).find(".arrowCanvas").css("z-index",200),$(this).find(".luckysheet-postil-show-main").css("z-index",200),n.stopPropagation()}}),$("#luckysheet-postil-showBoxs").off("mouseup.showPs").on("mouseup.showPs",".luckysheet-postil-show",function(n){n.which=="3"&&n.stopPropagation()}),$("#luckysheet-postil-showBoxs").off("mousedown.resize").on("mousedown.resize",".luckysheet-postil-show .luckysheet-postil-dialog-resize .luckysheet-postil-dialog-resize-item",function(n){if(!Hl(h.currentSheetIndex,"editObjects",!1))return;e.currentObj=$(this).closest(".luckysheet-postil-show-main"),e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.resize=$(this).data("type");let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=ll(n.pageX,n.pageY),a=o[0]+l,s=o[1]+t,u=e.currentObj.position(),f=e.currentObj.width(),m=e.currentObj.height();if(e.resizeXY=[a,s,f,m,u.left+l,u.top+t,l,t],Go(!0),$(this).closest(".luckysheet-postil-show").hasClass("luckysheet-postil-show-active")){n.stopPropagation();return}e.removeActivePs(),$(this).closest(".luckysheet-postil-show").addClass("luckysheet-postil-show-active"),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-dialog-resize").show(),$(this).closest(".luckysheet-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-show-main").css("z-index",200),n.stopPropagation()}),$("#luckysheet-postil-showBoxs").off("mousedown.move").on("mousedown.move",".luckysheet-postil-show .luckysheet-postil-dialog-move .luckysheet-postil-dialog-move-item",function(n){if(!Hl(h.currentSheetIndex,"editObjects",!1))return;e.currentObj=$(this).closest(".luckysheet-postil-show-main"),e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.move=!0;let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=e.currentObj.offset(),a=e.currentObj.position();if(e.moveXY=[n.pageX-o.left,n.pageY-o.top,a.left,a.top,l,t],Go(!0),$(this).closest(".luckysheet-postil-show").hasClass("luckysheet-postil-show-active")){n.stopPropagation();return}e.removeActivePs(),$(this).closest(".luckysheet-postil-show").addClass("luckysheet-postil-show-active"),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-dialog-resize").show(),$(this).closest(".luckysheet-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-show-main").css("z-index",200),n.stopPropagation()})},overshow:function(e){let n=this;if($("#luckysheet-postil-overshow").remove(),$(e.target).closest("#luckysheet-cell-main").length==0)return;let t=ll(e.pageX,e.pageY),l=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").scrollTop(),a=t[0],s=t[1],u=0,f=0;we.freezenverticaldata!=null&&t[0]<we.freezenverticaldata[0]-we.freezenverticaldata[2]?u=l:a+=l,we.freezenhorizontaldata!=null&&t[1]<we.freezenhorizontaldata[0]-we.freezenhorizontaldata[2]?f=o:s+=o;let m=zl(s)[2],d=Ml(a)[2],g=ht.mergeborer(h.flowdata,m,d);if(g&&(m=g.row[2],d=g.column[2]),h.flowdata[m]==null||h.flowdata[m][d]==null||h.flowdata[m][d].ps==null)return;let b=h.flowdata[m][d].ps;if(b.isshow||$("#luckysheet-postil-show_"+m+"_"+d).length>0)return;let y=b.value==null?"":b.value,p=h.visibledatarow[m],x=m-1==-1?0:h.visibledatarow[m-1],_=h.visibledatacolumn[d],S=d-1==-1?0:h.visibledatacolumn[d-1];g&&(p=g.row[1],x=g.row[0],_=g.column[1],S=g.column[0]);let I=_+u,O=x+f,F=I+18*h.zoomRatio,D=O-18*h.zoomRatio;D<0&&(D=2);let k=b.width==null?n.defaultWidth*h.zoomRatio:b.width*h.zoomRatio,w=b.height==null?n.defaultHeight*h.zoomRatio:b.height*h.zoomRatio,C=n.getArrowCanvasSize(F,D,I,O),T="",z=y.split(`
`);for(let P of z)T+="<div>"+n.htmlEscape(P)+"</div>";let A='<div id="luckysheet-postil-overshow"><canvas class="arrowCanvas" width="'+C[2]+'" height="'+C[3]+'" style="position:absolute;left:'+C[0]+"px;top:"+C[1]+'px;z-index:100;pointer-events:none;"></canvas><div style="width:'+(k-12)+"px;min-height:"+(w-12)+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+F+"px;top:"+D+'px;z-index:100;">'+T+"</div></div>";$(A).appendTo($("#luckysheet-cell-main"));let M=$("#luckysheet-postil-overshow .arrowCanvas").get(0).getContext("2d");n.drawArrow(M,C[4],C[5],C[6],C[7])},getArrowCanvasSize:function(e,n,t,l){let o=t-5;e<t&&(o=e-5);let a=l-5;n<l&&(a=n-5);let s=Math.abs(e-t)+10,u=Math.abs(n-l)+10,f=s-5,m=5;e<t&&(f=5,m=s-5);let d=u-5,g=5;return n<l&&(d=5,g=u-5),[o,a,s,u,f,d,m,g]},drawArrow:function(e,n,t,l,o,a,s,u,f){a=V(a)=="undefined"?30:a,s=V(s)=="undefined"?6:s,u=V(u)=="undefined"?1:u,f=V(f)=="undefined"?"#000":f;let m=Math.atan2(t-o,n-l)*180/Math.PI,d=(m+a)*Math.PI/180,g=(m-a)*Math.PI/180,b=s*Math.cos(d),y=s*Math.sin(d),p=s*Math.cos(g),x=s*Math.sin(g);e.save(),e.beginPath();let _=n-b,S=t-y;e.moveTo(_,S),e.moveTo(n,t),e.lineTo(l,o),e.lineWidth=u,e.strokeStyle=f,e.stroke(),_=l+b,S=o+y,e.moveTo(_,S),e.lineTo(l,o),_=l+p,S=o+x,e.lineTo(_,S),e.fillStyle=f,e.fill(),e.restore()},buildAllPs:function(e){let n=this;$("#luckysheet-cell-main #luckysheet-postil-showBoxs").empty();for(let t=0;t<e.length;t++)for(let l=0;l<e[0].length;l++)if(e[t][l]!=null&&e[t][l].ps!=null){let o=e[t][l].ps;n.buildPs(t,l,o)}n.init()},buildPs:function(e,n,t){if($("#luckysheet-postil-show_"+e+"_"+n).length>0&&$("#luckysheet-postil-show_"+e+"_"+n).remove(),t==null)return;let l=this;if(t.isshow==null?!1:t.isshow){let a=h.visibledatarow[e],s=e-1==-1?0:h.visibledatarow[e-1],u=h.visibledatacolumn[n],f=n-1==-1?0:h.visibledatacolumn[n-1],m=ht.mergeborer(h.flowdata,e,n);m&&(a=m.row[1],s=m.row[0],u=m.column[1],f=m.column[0]);let d=u,g=s,b=t.left==null?d+18*h.zoomRatio:t.left*h.zoomRatio,y=t.top==null?g-18*h.zoomRatio:t.top*h.zoomRatio,p=t.width==null?l.defaultWidth*h.zoomRatio:t.width*h.zoomRatio,x=t.height==null?l.defaultHeight*h.zoomRatio:t.height*h.zoomRatio,_=t.value==null?"":t.value;y<0&&(y=2);let S=l.getArrowCanvasSize(b,y,d,g),I="",O=_.split(`
`);for(let k of O)I+="<div>"+l.htmlEscape(k)+"</div>";let F='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+S[2]+'" height="'+S[3]+'" style="position:absolute;left:'+S[0]+"px;top:"+S[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+p+"px;height:"+x+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+b+"px;top:"+y+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(p-12)+"px;height:"+(x-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+I+"</div></div></div></div>";$(F).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let D=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");l.drawArrow(D,S[4],S[5],S[6],S[7])}},newPs:function(e,n){if(!Hl(h.currentSheetIndex,"editObjects")||!Yt.createHookFunction("commentInsertBefore",e,n))return;let t=this,l=h.visibledatarow[e],o=e-1==-1?0:h.visibledatarow[e-1],a=h.visibledatacolumn[n],s=n-1==-1?0:h.visibledatacolumn[n-1],u=ht.mergeborer(h.flowdata,e,n);u&&(l=u.row[1],o=u.row[0],a=u.column[1],s=u.column[0]);let f=a,m=o,d=f+18*h.zoomRatio,g=m-18*h.zoomRatio;g<0&&(g=2);let b=t.defaultWidth*h.zoomRatio,y=t.defaultHeight*h.zoomRatio,p=t.getArrowCanvasSize(d,g,f,m),x='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show luckysheet-postil-show-active"><canvas class="arrowCanvas" width="'+p[2]+'" height="'+p[3]+'" style="position:absolute;left:'+p[0]+"px;top:"+p[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+b+"px;height:"+y+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+d+"px;top:"+g+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:132px;height:72px;line-height:20px;box-sizing:border-box;text-align: center;word-break:break-all;" spellcheck="false" contenteditable="true"></div></div></div></div>';$(x).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let _=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");t.drawArrow(_,p[4],p[5],p[6],p[7]),$("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").focus(),t.init();let S=pt.deepCopyFlowData(h.flowdata),I=[];S[e][n]==null&&(S[e][n]={}),S[e][n].ps={left:null,top:null,width:null,height:null,value:"",isshow:!1},I.push(e+"_"+n),t.ref(S,I),setTimeout(()=>{Yt.createHookFunction("commentInsertAfter",e,n,S[e][n])},0)},editPs:function(e,n){let t=this;if(!!Hl(h.currentSheetIndex,"editObjects")){if($("#luckysheet-postil-show_"+e+"_"+n).length>0)$("#luckysheet-postil-show_"+e+"_"+n).show(),$("#luckysheet-postil-show_"+e+"_"+n).addClass("luckysheet-postil-show-active"),$("#luckysheet-postil-show_"+e+"_"+n).find(".luckysheet-postil-dialog-resize").show();else{let l=h.flowdata[e][n].ps,o=h.visibledatarow[e],a=e-1==-1?0:h.visibledatarow[e-1],s=h.visibledatacolumn[n],u=n-1==-1?0:h.visibledatacolumn[n-1],f=ht.mergeborer(h.flowdata,e,n);f&&(o=f.row[1],a=f.row[0],s=f.column[1],u=f.column[0]);let m=s,d=a,g=l.left==null?m+18*h.zoomRatio:l.left*h.zoomRatio,b=l.top==null?d-18*h.zoomRatio:l.top*h.zoomRatio,y=l.width==null?t.defaultWidth*h.zoomRatio:l.width*h.zoomRatio,p=l.height==null?t.defaultHeight*h.zoomRatio:l.height*h.zoomRatio,x=l.value==null?"":l.value;b<0&&(b=2);let _=t.getArrowCanvasSize(g,b,m,d),S="",I=x.split(`
`);for(let D of I)S+="<div>"+t.htmlEscape(D)+"</div>";let O='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show luckysheet-postil-show-active"><canvas class="arrowCanvas" width="'+_[2]+'" height="'+_[3]+'" style="position:absolute;left:'+_[0]+"px;top:"+_[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+y+"px;height:"+p+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+g+"px;top:"+b+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(y-12)+"px;height:"+(p-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+S+"</div></div></div></div>";$(O).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let F=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");t.drawArrow(F,_[4],_[5],_[6],_[7])}$("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").focus(),to($("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").get(0)),t.init()}},delPs:function(e,n){if(!Hl(h.currentSheetIndex,"editObjects")||!Yt.createHookFunction("commentDeleteBefore",e,n,h.flowdata[e][n]))return;$("#luckysheet-postil-show_"+e+"_"+n).length>0&&$("#luckysheet-postil-show_"+e+"_"+n).remove();let t=pt.deepCopyFlowData(h.flowdata),l=[];delete t[e][n].ps,l.push(e+"_"+n),this.ref(t,l),setTimeout(()=>{Yt.createHookFunction("commentDeleteAfter",e,n,h.flowdata[e][n])},0)},showHidePs:function(e,n){let t=this,l=h.flowdata[e][n].ps,o=l.isshow,a=pt.deepCopyFlowData(h.flowdata),s=[];if(o)a[e][n].ps.isshow=!1,$("#luckysheet-postil-show_"+e+"_"+n).remove();else{a[e][n].ps.isshow=!0;let u=h.visibledatarow[e],f=e-1==-1?0:h.visibledatarow[e-1],m=h.visibledatacolumn[n],d=n-1==-1?0:h.visibledatacolumn[n-1],g=ht.mergeborer(h.flowdata,e,n);g&&(u=g.row[1],f=g.row[0],m=g.column[1],d=g.column[0]);let b=$("#luckysheet-cell-main").scrollLeft(),y=$("#luckysheet-cell-main").scrollTop(),p=m,x=f;we.freezenverticaldata!=null&&p<we.freezenverticaldata[0]-we.freezenverticaldata[2]&&(p+=b),we.freezenhorizontaldata!=null&&x<we.freezenhorizontaldata[0]-we.freezenhorizontaldata[2]&&(x+=y);let _=l.left==null?p+18*h.zoomRatio:l.left*h.zoomRatio,S=l.top==null?x-18*h.zoomRatio:l.top*h.zoomRatio,I=l.width==null?t.defaultWidth*h.zoomRatio:l.width*h.zoomRatio,O=l.height==null?t.defaultHeight*h.zoomRatio:l.height*h.zoomRatio,F=l.value==null?"":l.value;S<0&&(S=2);let D=t.getArrowCanvasSize(_,S,p,x),k="",w=F.split(`
`);for(let z of w)k+="<div>"+t.htmlEscape(z)+"</div>";let C='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+D[2]+'" height="'+D[3]+'" style="position:absolute;left:'+D[0]+"px;top:"+D[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+I+"px;height:"+O+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+_+"px;top:"+S+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(I-12)+"px;height:"+(O-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+k+"</div></div></div></div>";$(C).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let T=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");t.drawArrow(T,D[4],D[5],D[6],D[7]),t.init()}s.push(e+"_"+n),t.ref(a,s)},showHideAllPs:function(){let e=this,n=pt.deepCopyFlowData(h.flowdata),t=!0,l=[];for(let a=0;a<n.length;a++)for(let s=0;s<n[0].length;s++)n[a]!=null&&n[a][s]!=null&&n[a][s].ps!=null&&(l.push(a+"_"+s),n[a][s].ps.isshow||(t=!1));let o=[];if(l.length>0)if(t){$("#luckysheet-cell-main #luckysheet-postil-showBoxs").empty();for(let a=0;a<l.length;a++){let s=l[a].split("_")[0],u=l[a].split("_")[1];n[s][u].ps.isshow&&(n[s][u].ps.isshow=!1,o.push(l[a]))}}else for(let a=0;a<l.length;a++){let s=l[a].split("_")[0],u=l[a].split("_")[1],f=n[s][u].ps;if(!f.isshow){let m=h.visibledatarow[s],d=s-1==-1?0:h.visibledatarow[s-1],g=h.visibledatacolumn[u],b=u-1==-1?0:h.visibledatacolumn[u-1],y=ht.mergeborer(h.flowdata,s,u);y&&(m=y.row[1],d=y.row[0],g=y.column[1],b=y.column[0]);let p=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),_=g,S=d;we.freezenverticaldata!=null&&_<we.freezenverticaldata[0]-we.freezenverticaldata[2]&&(_+=p),we.freezenhorizontaldata!=null&&S<we.freezenhorizontaldata[0]-we.freezenhorizontaldata[2]&&(S+=x);let I=f.left==null?_+18*h.zoomRatio:f.left*h.zoomRatio,O=f.top==null?S-18*h.zoomRatio:f.top*h.zoomRatio,F=f.width==null?e.defaultWidth*h.zoomRatio:f.width*h.zoomRatio,D=f.height==null?e.defaultHeight*h.zoomRatio:f.height*h.zoomRatio,k=f.value==null?"":f.value;O<0&&(O=2);let w=e.getArrowCanvasSize(I,O,_,S),C="",T=k.split(`
`);for(let M of T)C+="<div>"+e.htmlEscape(M)+"</div>";let z='<div id="luckysheet-postil-show_'+s+"_"+u+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+w[2]+'" height="'+w[3]+'" style="position:absolute;left:'+w[0]+"px;top:"+w[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+F+"px;height:"+D+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+I+"px;top:"+O+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(F-12)+"px;height:"+(D-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+C+"</div></div></div></div>";$(z).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let A=$("#luckysheet-postil-show_"+s+"_"+u+" .arrowCanvas").get(0).getContext("2d");e.drawArrow(A,w[4],w[5],w[6],w[7]),n[s][u].ps.isshow=!0,o.push(l[a])}}e.ref(n,o),e.init()},removeActivePs:function(){if($("#luckysheet-postil-showBoxs .luckysheet-postil-show-active").length>0){let e=$("#luckysheet-postil-showBoxs .luckysheet-postil-show-active").attr("id"),n=e.split("luckysheet-postil-show_")[1].split("_")[0],t=e.split("luckysheet-postil-show_")[1].split("_")[1],l=$("#"+e).find(".formulaInputFocus").html().replaceAll("<div>",`
`).replaceAll(/<(.*)>.*?|<(.*) \/>/g,"").trim();if(!Yt.createHookFunction("commentUpdateBefore",n,t,l)){h.flowdata[n][t].ps.isshow||$("#"+e).remove();return}let o=$.extend(!0,{},h.flowdata[n][t]);$("#"+e).removeClass("luckysheet-postil-show-active"),$("#"+e).find(".luckysheet-postil-dialog-resize").hide(),$("#"+e).find(".arrowCanvas").css("z-index",100),$("#"+e).find(".luckysheet-postil-show-main").css("z-index",100);let a=pt.deepCopyFlowData(h.flowdata),s=[];a[n][t].ps.value=l,s.push(n+"_"+t),this.ref(a,s),a[n][t].ps.isshow||$("#"+e).remove(),setTimeout(()=>{Yt.createHookFunction("commentUpdateAfter",n,t,o,a[n][t])},0)}},ref:function(e,n){if(h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"postil",data:h.flowdata,curdata:e,sheetIndex:h.currentSheetIndex,rc:n})),h.flowdata=e,pt.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[$e(h.currentSheetIndex)].data=h.flowdata,He.allowUpdate)for(let t=0;t<n.length;t++){let l=n[t].split("_")[0],o=n[t].split("_")[1];He.saveParam("v",h.currentSheetIndex,h.flowdata[l][o],{r:l,c:o})}setTimeout(function(){Et()},1)},positionSync:function(){let e=this;$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(n,t){let l=$(t).attr("id"),o=l.split("luckysheet-postil-show_")[1].split("_")[0],a=l.split("luckysheet-postil-show_")[1].split("_")[1],s=h.flowdata[o][a];s!=null&&s.ps!=null?e.buildPs(o,a,s.ps):$("#"+l).hide()})},htmlEscape:function(e){return e.replace(/[<>"&]/g,function(n,t,l){switch(console.log(n,t,l),n){case"<":return"&lt";case">":return"&gt";case"&":return"&amp";case'"':return"&quot;"}})}},Nt=jx});function Am(e,n,t,l,o){let a={},s,u;o==null?(s=h.config,u=h.flowdata):(s=h.luckysheetfile[$e(o)].config,u=h.luckysheetfile[$e(o)].data);let f=s.borderInfo;if(f!=null&&f.length>0)for(let m=0;m<f.length;m++){let d=f[m].rangeType;if(d=="range"){let g=f[m].borderType,b=f[m].color,y=f[m].style,p=f[m].range;for(let x=0;x<p.length;x++){let _=p[x].row[0],S=p[x].row[1],I=p[x].column[0],O=p[x].column[1];if(_<e&&(_=e),S>n&&(S=n),I<t&&(I=t),O>l&&(O=l),g=="border-left")for(let F=_;F<=S;F++){if(s.rowhidden!=null&&s.rowhidden[F]!=null)continue;a[F+"_"+I]==null&&(a[F+"_"+I]={}),a[F+"_"+I].l={color:b,style:y};let D=I-1;if(D>=0&&a[F+"_"+D])if(u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null){let w=u[F][D],C=s.merge[w.mc.r+"_"+w.mc.c];C.c+C.cs-1==D&&(a[F+"_"+D].r={color:b,style:y})}else a[F+"_"+D].r={color:b,style:y};let k=s.merge||{};for(let w in k){let{c:C,r:T,cs:z,rs:A}=k[w];I<=C+z-1&&I>C&&F>=T&&F<=T+A-1&&(a[F+"_"+I].l=null)}}else if(g=="border-right")for(let F=_;F<=S;F++){if(s.rowhidden!=null&&s.rowhidden[F]!=null)continue;a[F+"_"+O]==null&&(a[F+"_"+O]={}),a[F+"_"+O].r={color:b,style:y};let D=O+1;if(D<u[0].length&&a[F+"_"+D])if(u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null){let w=u[F][D];s.merge[w.mc.r+"_"+w.mc.c].c==D&&(a[F+"_"+D].l={color:b,style:y})}else a[F+"_"+D].l={color:b,style:y};let k=s.merge||{};for(let w in k){let{c:C,r:T,cs:z,rs:A}=k[w];O<C+z-1&&O>=C&&F>=T&&F<=T+A-1&&(a[F+"_"+O].r=null)}}else if(g=="border-top"){if(s.rowhidden!=null&&s.rowhidden[_]!=null)continue;for(let F=I;F<=O;F++){a[_+"_"+F]==null&&(a[_+"_"+F]={}),a[_+"_"+F].t={color:b,style:y};let D=_-1;if(D>=0&&a[D+"_"+F])if(u[D]!=null&&V(u[D][F])=="object"&&u[D][F].mc!=null){let w=u[D][F],C=s.merge[w.mc.r+"_"+w.mc.c];C.r+C.rs-1==D&&(a[D+"_"+F].b={color:b,style:y})}else a[D+"_"+F].b={color:b,style:y};let k=s.merge||{};for(let w in k){let{c:C,r:T,cs:z,rs:A}=k[w];_<=T+A-1&&_>T&&F>=C&&F<=C+z-1&&(a[_+"_"+F].t=null)}}}else if(g=="border-bottom"){if(s.rowhidden!=null&&s.rowhidden[S]!=null)continue;for(let F=I;F<=O;F++){a[S+"_"+F]==null&&(a[S+"_"+F]={}),a[S+"_"+F].b={color:b,style:y};let D=S+1;if(D<u.length&&a[D+"_"+F])if(u[D]!=null&&V(u[D][F])=="object"&&u[D][F].mc!=null){let w=u[D][F];s.merge[w.mc.r+"_"+w.mc.c].r==D&&(a[D+"_"+F].t={color:b,style:y})}else a[D+"_"+F].t={color:b,style:y};let k=s.merge||{};for(let w in k){let{c:C,r:T,cs:z,rs:A}=k[w];S<T+A-1&&S>=T&&F>=C&&F<=C+z-1&&(a[S+"_"+F].b=null)}}}else if(g=="border-all"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null))for(let D=I;D<=O;D++){if(u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.r==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:y}),w.r+w.rs-1==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:y}),w.c==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y}),w.c+w.cs-1==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:y})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y},a[F+"_"+D].r={color:b,style:y},a[F+"_"+D].t={color:b,style:y},a[F+"_"+D].b={color:b,style:y};if(F==_){let k=_-1;if(k>=0&&a[k+"_"+D])if(u[k]!=null&&V(u[k][D])=="object"&&u[k][D].mc!=null){let w=u[k][D],C=s.merge[w.mc.r+"_"+w.mc.c];C.r+C.rs-1==k&&(a[k+"_"+D].b={color:b,style:y})}else a[k+"_"+D].b={color:b,style:y}}if(F==S){let k=S+1;if(k<u.length&&a[k+"_"+D])if(u[k]!=null&&V(u[k][D])=="object"&&u[k][D].mc!=null){let w=u[k][D];s.merge[w.mc.r+"_"+w.mc.c].r==k&&(a[k+"_"+D].t={color:b,style:y})}else a[k+"_"+D].t={color:b,style:y}}if(D==I){let k=I-1;if(k>=0&&a[F+"_"+k])if(u[F]!=null&&V(u[F][k])=="object"&&u[F][k].mc!=null){let w=u[F][k],C=s.merge[w.mc.r+"_"+w.mc.c];C.c+C.cs-1==k&&(a[F+"_"+k].r={color:b,style:y})}else a[F+"_"+k].r={color:b,style:y}}if(D==O){let k=O+1;if(k<u[0].length&&a[F+"_"+k])if(u[F]!=null&&V(u[F][k])=="object"&&u[F][k].mc!=null){let w=u[F][k];s.merge[w.mc.r+"_"+w.mc.c].c==k&&(a[F+"_"+k].l={color:b,style:y})}else a[F+"_"+k].l={color:b,style:y}}}}else if(g=="border-outside"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null)){for(let D=I;D<=O;D++)if(F==_||F==S||D==I||D==O){if(F==_){a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:y};let k=_-1;if(k>=0&&a[k+"_"+D])if(u[k]!=null&&V(u[k][D])=="object"&&u[k][D].mc!=null){let w=u[k][D],C=s.merge[w.mc.r+"_"+w.mc.c];C.r+C.rs-1==k&&(a[k+"_"+D].b={color:b,style:y})}else a[k+"_"+D].b={color:b,style:y}}if(F==S){a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:y};let k=S+1;if(k<u.length&&a[k+"_"+D])if(u[k]!=null&&V(u[k][D])=="object"&&u[k][D].mc!=null){let w=u[k][D];s.merge[w.mc.r+"_"+w.mc.c].r==k&&(a[k+"_"+D].t={color:b,style:y})}else a[k+"_"+D].t={color:b,style:y}}if(D==I){a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y};let k=I-1;if(k>=0&&a[F+"_"+k])if(u[F]!=null&&V(u[F][k])=="object"&&u[F][k].mc!=null){let w=u[F][k],C=s.merge[w.mc.r+"_"+w.mc.c];C.c+C.cs-1==k&&(a[F+"_"+k].r={color:b,style:y})}else a[F+"_"+k].r={color:b,style:y}}if(D==O){a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:y};let k=O+1;if(k<u[0].length&&a[F+"_"+k])if(u[F]!=null&&V(u[F][k])=="object"&&u[F][k].mc!=null){let w=u[F][k];s.merge[w.mc.r+"_"+w.mc.c].c==k&&(a[F+"_"+k].l={color:b,style:y})}else a[F+"_"+k].l={color:b,style:y}}}}}else if(g=="border-inside"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null))for(let D=I;D<=O;D++)if(F==_&&D==I)u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:y},a[F+"_"+D].b={color:b,style:y});else if(F==S&&D==I)u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:y},a[F+"_"+D].t={color:b,style:y});else if(F==_&&D==O)u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y},a[F+"_"+D].b={color:b,style:y});else if(F==S&&D==O)u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y},a[F+"_"+D].t={color:b,style:y});else if(F==_)if(u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.c==D?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y}):w.c+w.cs-1==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:y})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y},a[F+"_"+D].r={color:b,style:y},a[F+"_"+D].b={color:b,style:y};else if(F==S)if(u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.c==D?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y}):w.c+w.cs-1==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:y})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y},a[F+"_"+D].r={color:b,style:y},a[F+"_"+D].t={color:b,style:y};else if(D==I)if(u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.r==F?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:y}):w.r+w.rs-1==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:y})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:y},a[F+"_"+D].t={color:b,style:y},a[F+"_"+D].b={color:b,style:y};else if(D==O)if(u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.r==F?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:y}):w.r+w.rs-1==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:y})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y},a[F+"_"+D].t={color:b,style:y},a[F+"_"+D].b={color:b,style:y};else if(u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.r==F?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:y}):w.r+w.rs-1==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:y}),w.c==D?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y}):w.c+w.cs-1==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:y})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y},a[F+"_"+D].r={color:b,style:y},a[F+"_"+D].t={color:b,style:y},a[F+"_"+D].b={color:b,style:y}}else if(g=="border-horizontal"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null))for(let D=I;D<=O;D++)if(F==_)u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:y});else if(F==S)u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:y});else if(u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.r==F?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:y}):w.r+w.rs-1==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:y})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:y},a[F+"_"+D].b={color:b,style:y}}else if(g=="border-vertical"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null))for(let D=I;D<=O;D++)if(D==I)u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:y});else if(D==O)u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y});else if(u[F]!=null&&V(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c]||{};w.c==D?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y}):w.c+w.cs-1==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:y})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:y},a[F+"_"+D].r={color:b,style:y}}else if(g=="border-none"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null))for(let D=I;D<=O;D++){if(a[F+"_"+D]!=null&&delete a[F+"_"+D],F==_){let k=_-1;k>=0&&a[k+"_"+D]&&delete a[k+"_"+D].b}if(F==S){let k=S+1;k<u.length&&a[k+"_"+D]&&delete a[k+"_"+D].t}if(D==I){let k=I-1;k>=0&&a[F+"_"+k]&&delete a[F+"_"+k].r}if(D==O){let k=O+1;k<u[0].length&&a[F+"_"+k]&&delete a[F+"_"+k].l}}}}}else if(d=="cell"){let g=f[m].value,b=g.row_index,y=g.col_index;if(b<e||b>n||y<t||y>l||s.rowhidden!=null&&s.rowhidden[b]!=null)continue;if(g.l!=null||g.r!=null||g.t!=null||g.b!=null)if(a[b+"_"+y]==null&&(a[b+"_"+y]={}),u[b]!=null&&V(u[b][y])=="object"&&u[b][y].mc!=null){let p=u[b][y],x=s.merge[p.mc.r+"_"+p.mc.c]||{};if(g.l!=null&&y==x.c){a[b+"_"+y].l={color:g.l.color,style:g.l.style};let _=y-1;if(_>=0&&a[b+"_"+_])if(u[b]!=null&&V(u[b][_])=="object"&&u[b][_].mc!=null){let S=u[b][_],I=s.merge[S.mc.r+"_"+S.mc.c];I.c+I.cs-1==_&&(a[b+"_"+_].r={color:g.l.color,style:g.l.style})}else a[b+"_"+_].r={color:g.l.color,style:g.l.style}}else a[b+"_"+y].l=null;if(g.r!=null&&y==x.c+x.cs-1){a[b+"_"+y].r={color:g.r.color,style:g.r.style};let _=y+1;if(_<u[0].length&&a[b+"_"+_])if(u[b]!=null&&V(u[b][_])=="object"&&u[b][_].mc!=null){let S=u[b][_];s.merge[S.mc.r+"_"+S.mc.c].c==_&&(a[b+"_"+_].l={color:g.r.color,style:g.r.style})}else a[b+"_"+_].l={color:g.r.color,style:g.r.style}}else a[b+"_"+y].r=null;if(g.t!=null&&b==x.r){a[b+"_"+y].t={color:g.t.color,style:g.t.style};let _=b-1;if(_>=0&&a[_+"_"+y])if(u[_]!=null&&V(u[_][y])=="object"&&u[_][y].mc!=null){let S=u[_][y],I=s.merge[S.mc.r+"_"+S.mc.c];I.r+I.rs-1==_&&(a[_+"_"+y].b={color:g.t.color,style:g.t.style})}else a[_+"_"+y].b={color:g.t.color,style:g.t.style}}else a[b+"_"+y].t=null;if(g.b!=null&&b==x.r+x.rs-1){a[b+"_"+y].b={color:g.b.color,style:g.b.style};let _=b+1;if(_<u.length&&a[_+"_"+y])if(u[_]!=null&&V(u[_][y])=="object"&&u[_][y].mc!=null){let S=u[_][y];s.merge[S.mc.r+"_"+S.mc.c].r==_&&(a[_+"_"+y].t={color:g.b.color,style:g.b.style})}else a[_+"_"+y].t={color:g.b.color,style:g.b.style}}else a[b+"_"+y].b=null}else{if(g.l!=null){a[b+"_"+y].l={color:g.l.color,style:g.l.style};let p=y-1;if(p>=0&&a[b+"_"+p])if(u[b]!=null&&V(u[b][p])=="object"&&u[b][p].mc!=null){let x=u[b][p],_=s.merge[x.mc.r+"_"+x.mc.c];_.c+_.cs-1==p&&(a[b+"_"+p].r={color:g.l.color,style:g.l.style})}else a[b+"_"+p].r={color:g.l.color,style:g.l.style}}else a[b+"_"+y].l=null;if(g.r!=null){a[b+"_"+y].r={color:g.r.color,style:g.r.style};let p=y+1;if(p<u[0].length&&a[b+"_"+p])if(u[b]!=null&&V(u[b][p])=="object"&&u[b][p].mc!=null){let x=u[b][p];s.merge[x.mc.r+"_"+x.mc.c].c==p&&(a[b+"_"+p].l={color:g.r.color,style:g.r.style})}else a[b+"_"+p].l={color:g.r.color,style:g.r.style}}else a[b+"_"+y].r=null;if(g.t!=null){a[b+"_"+y].t={color:g.t.color,style:g.t.style};let p=b-1;if(p>=0&&a[p+"_"+y])if(u[p]!=null&&V(u[p][y])=="object"&&u[p][y].mc!=null){let x=u[p][y],_=s.merge[x.mc.r+"_"+x.mc.c];_.r+_.rs-1==p&&(a[p+"_"+y].b={color:g.t.color,style:g.t.style})}else a[p+"_"+y].b={color:g.t.color,style:g.t.style}}else a[b+"_"+y].t=null;if(g.b!=null){a[b+"_"+y].b={color:g.b.color,style:g.b.style};let p=b+1;if(p<u.length&&a[p+"_"+y])if(u[p]!=null&&V(u[p][y])=="object"&&u[p][y].mc!=null){let x=u[p][y];s.merge[x.mc.r+"_"+x.mc.c].r==p&&(a[p+"_"+y].t={color:g.b.color,style:g.b.style})}else a[p+"_"+y].t={color:g.b.color,style:g.b.style}}else a[b+"_"+y].b=null}else delete a[b+"_"+y]}}return a}function Mo(e){let n={},t,l;return e==null?(t=h.config,l=h.flowdata):(t=h.luckysheetfile[$e(e)].config,l=h.luckysheetfile[$e(e)].data),n=Am(0,l.length,0,l[0].length,e),n}var import_plugin,Tc=Tt(()=>{import_plugin=Le(Be());ql();gl();Ut()});var import_plugin,Ct,Vx,Tr,zm=Tt(()=>{import_plugin=Le(Be());Qn();xc();Tc();Gl();Hn();fr();br();ir();ji();jn();vr();ql();gl();Ut();Rl();Ct=Le(ka()),Vx={iconHtml:'<div id="luckysheet-dropCell-icon" style="position: absolute;padding: 2px;background-color: #f1f1f1;z-index: 990;cursor: pointer;"><div id="icon_dropCell"></div></div>',typeListHtml:'<div id="luckysheet-dropCell-typeList" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${copyCell}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="1"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${sequence}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${onlyFormat}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="3"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${noFormat}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="4"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${day}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="5"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${workDay}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="6"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${month}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="7"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${year}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="8"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${chineseNumber}</div></div></div>',copyRange:{},applyRange:{},applyType:null,direction:null,chnNumChar:{\u96F6:0,\u4E00:1,\u4E8C:2,\u4E09:3,\u56DB:4,\u4E94:5,\u516D:6,\u4E03:7,\u516B:8,\u4E5D:9},chnNameValue:{\u5341:{value:10,secUnit:!1},\u767E:{value:100,secUnit:!1},\u5343:{value:1e3,secUnit:!1},\u4E07:{value:1e4,secUnit:!0},\u4EBF:{value:1e8,secUnit:!0}},ChineseToNumber:function(e){let n=this,t=0,l=0,o=0,a=!1,s=e.split("");for(let u=0;u<s.length;u++){let f=n.chnNumChar[s[u]];if(typeof f!="undefined")o=f,u==s.length-1&&(l+=o);else{let m=n.chnNameValue[s[u]].value;a=n.chnNameValue[s[u]].secUnit,a?(l=(l+o)*m,t+=l,l=0):l+=o*m,o=0}}return t+l},chnNumChar2:["\u96F6","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D"],chnUnitSection:["","\u4E07","\u4EBF","\u4E07\u4EBF","\u4EBF\u4EBF"],chnUnitChar:["","\u5341","\u767E","\u5343"],SectionToChinese:function(e){let n=this,t="",l="",o=0,a=!0;for(;e>0;){let s=e%10;s==0?a||(a=!0,l=n.chnNumChar2[s]+l):(a=!1,t=n.chnNumChar2[s],t+=n.chnUnitChar[o],l=t+l),o++,e=Math.floor(e/10)}return l},NumberToChinese:function(e){let n=this,t=0,l="",o="",a=!1;if(e==0)return n.chnNumChar2[0];for(;e>0;){let s=e%1e4;a&&(o=n.chnNumChar2[0]+o),l=n.SectionToChinese(s),l+=s!=0?n.chnUnitSection[t]:n.chnUnitSection[0],o=l+o,a=s<1e3&&s>0,e=Math.floor(e/1e4),t++}return o},isChnNumber:function(e){let n=this,t=!0;if(e.length==1)e=="\u65E5"||e in n.chnNumChar?t=!0:t=!1;else{let l=e.split("");for(let o=0;o<l.length;o++)if(!(l[o]in n.chnNumChar||l[o]in n.chnNameValue)){t=!1;break}}return t},isExtendNumber:function(e){let n=/0|([1-9]+[0-9]*)/g,t=n.test(e);if(t){let l=e.match(n),o=l[l.length-1],a=e.lastIndexOf(o),s=e.substr(0,a),u=e.substr(a+o.length);return[t,Number(o),s,u]}else return[t]},isChnWeek1:function(e){let n=this,t;return e.length==1&&(e=="\u65E5"||n.ChineseToNumber(e)<7)?t=!0:t=!1,t},isChnWeek2:function(e){let n;return e.length==2&&(e=="\u5468\u4E00"||e=="\u5468\u4E8C"||e=="\u5468\u4E09"||e=="\u5468\u56DB"||e=="\u5468\u4E94"||e=="\u5468\u516D"||e=="\u5468\u65E5")?n=!0:n=!1,n},isChnWeek3:function(e){let n;return e.length==3&&(e=="\u661F\u671F\u4E00"||e=="\u661F\u671F\u4E8C"||e=="\u661F\u671F\u4E09"||e=="\u661F\u671F\u56DB"||e=="\u661F\u671F\u4E94"||e=="\u661F\u671F\u516D"||e=="\u661F\u671F\u65E5")?n=!0:n=!1,n},createIcon:function(){let e=this,n=e.copyRange.row[1],t=e.copyRange.column[1],l=e.applyRange.row[1],o=e.applyRange.column[1],a,s;l>=n&&o>=t?(a=l,s=o):(a=n,s=t);let u=$r(a)[1],f=$r(a)[0],m=Vl(s)[1],d=Vl(s)[0];$("#luckysheet-dropCell-icon").remove(),$("#luckysheet-cell-main").append(e.iconHtml),$("#luckysheet-dropCell-icon").css({left:m,top:u}),$("#luckysheet-dropCell-icon").mouseover(function(){$(this).css("background-color","#ffe8e8")}).mouseleave(function(){$(this).css("background-color","#f1f1f1")}).mousedown(function(g){$("#luckysheet-dropCell-typeList").remove();let y=Oe().dropCell;$("body").first().append(yt(e.typeListHtml,{copyCell:y.copyCell,sequence:y.sequence,onlyFormat:y.onlyFormat,noFormat:y.noFormat,day:y.day,workDay:y.workDay,month:y.month,year:y.year,chineseNumber:y.chineseNumber}));let p=e.typeItemHide();!p[0]&&!p[1]&&!p[2]&&!p[3]&&!p[4]&&!p[5]&&!p[6]&&($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=1]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide()),p[2]||($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide()),p[3]||$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide();let x=$(this).offset().left,_=$(this).offset().top+25,S=$(window).height(),I=$(window).width(),O=$("#luckysheet-dropCell-typeList").width(),F=$("#luckysheet-dropCell-typeList").height();x+O>I&&(x=x-O),_+F>S&&(_=_-F-38),_<0&&(_=0),$("#luckysheet-dropCell-typeList").css({left:x,top:_}).show(),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#ffe8e8")});let D=e.applyType;$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type="+D+"]").find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'),g.stopPropagation()}),$(document).off("click.dCtypeList").on("click.dCtypeList","#luckysheet-dropCell-typeList .luckysheet-cols-menuitem",function(){$("#luckysheet-dropCell-typeList .fa-check").remove(),$(this).find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>');let g=$(this).attr("data-type");e.applyType=g,e.update(),$("#luckysheet-dropCell-typeList").hide(),$("#luckysheet-dropCell-icon").css("backgroundColor","#f1f1f1"),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#f1f1f1")}),mn()})},typeItemHide:function(){let e=this,n=e.copyRange,t=n.row[0],l=n.row[1],o=n.column[0],a=n.column[1],s=!1,u=!1,f=!1,m=!1,d=!1,g=!1,b=!1;for(let y=t;y<=l;y++)for(let p=o;p<=a;p++)if(h.flowdata[y][p]){let x=h.flowdata[y][p];V(x)=="object"&&x.v!=null&&x.f==null&&(x.ct!=null&&x.ct.t=="n"?s=!0:x.ct!=null&&x.ct.t=="d"?f=!0:e.isExtendNumber(x.m)[0]?u=!0:e.isChnNumber(x.m)&&x.m!="\u65E5"?m=!0:x.m=="\u65E5"?d=!0:e.isChnWeek2(x.m)?g=!0:e.isChnWeek3(x.m)&&(b=!0))}return[s,u,f,m,d,g,b]},update:function(){let e=this;if(!Wi([e.applyRange],h.currentSheetIndex)||h.allowEdit===!1)return;let n=pt.deepCopyFlowData(h.flowdata),t=h.luckysheetfile[$e(h.currentSheetIndex)],l=$.extend(!0,{},h.config),o=Mo(),a=$.extend(!0,{},t.dataVerification),s=e.direction,u=e.applyType,f=e.copyRange,m=f.row[0],d=f.row[1],g=f.column[0],b=f.column[1],y=e.getCopyData(n,m,d,g,b,s),p;s=="down"||s=="up"?p=d-m+1:(s=="right"||s=="left")&&(p=b-g+1);let x=e.applyRange,_=x.row[0],S=x.row[1],I=x.column[0],O=x.column[1];if(s=="down"||s=="up"){let k=S-_+1;for(let w=I;w<=O;w++){let C=y[w-I],T=e.getApplyData(C,p,k);if(s=="down")for(let z=_;z<=S;z++){let A=T[z-_];if(A.f!=null){let N="="+v.functionCopy(A.f,"down",z-_+1),E=v.execfunction(N,z,w);if(v.execFunctionGroup(z,w,E[1],void 0,n),A.f=E[2],A.v=E[1],A.spl!=null)A.spl=E[3].data;else if(Y(A.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(A.v)){if(A.v==Infinity||A.v==-Infinity)A.m=A.v.toString();else if(A.v.toString().indexOf("e")>-1){let B=A.v.toString().split(".")[1].split("e")[0].length;B>5&&(B=5),A.m=A.v.toExponential(B).toString()}else{let B;A.ct.fa==="##0.00"?(B=nl(Math.round(A.v*1e9)/1e9+".00"),A.m=B[0].toString()):(B=nl(Math.round(A.v*1e9)/1e9),A.m=B[0].toString())}A.ct=A.ct||{fa:"General",t:"n"}}else{let B=nl(A.v);A.m=B[0].toString(),A.ct=B[1]}}n[z][w]=A;let M=m+(z-_)%p,P=w;if(o[M+"_"+P]){let N={rangeType:"cell",value:{row_index:z,col_index:w,l:o[M+"_"+P].l,r:o[M+"_"+P].r,t:o[M+"_"+P].t,b:o[M+"_"+P].b}};l.borderInfo.push(N)}else if(o[z+"_"+w]){let N={rangeType:"cell",value:{row_index:z,col_index:w,l:null,r:null,t:null,b:null}};l.borderInfo.push(N)}a[M+"_"+P]&&(a[z+"_"+w]=a[M+"_"+P])}if(s=="up")for(let z=S;z>=_;z--){let A=T[S-z];if(A.f!=null){let N="="+v.functionCopy(A.f,"up",S-z+1),E=v.execfunction(N,z,w);if(v.execFunctionGroup(z,w,E[1],void 0,n),A.f=E[2],A.v=E[1],A.spl!=null)A.spl=E[3].data;else if(Y(A.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(A.v)){if(A.v==Infinity||A.v==-Infinity)A.m=A.v.toString();else if(A.v.toString().indexOf("e")>-1){let B=A.v.toString().split(".")[1].split("e")[0].length;B>5&&(B=5),A.m=A.v.toExponential(B).toString()}else{let B=nl(Math.round(A.v*1e9)/1e9);A.m=B[0].toString()}A.ct={fa:"General",t:"n"}}else{let B=nl(A.v);A.m=B[0].toString(),A.ct=B[1]}}n[z][w]=A;let M=d-(S-z)%p,P=w;if(o[M+"_"+P]){let N={rangeType:"cell",value:{row_index:z,col_index:w,l:o[M+"_"+P].l,r:o[M+"_"+P].r,t:o[M+"_"+P].t,b:o[M+"_"+P].b}};l.borderInfo.push(N)}else if(o[z+"_"+w]){let N={rangeType:"cell",value:{row_index:z,col_index:w,l:null,r:null,t:null,b:null}};l.borderInfo.push(N)}a[M+"_"+P]&&(a[z+"_"+w]=a[M+"_"+P])}}}else if(s=="right"||s=="left"){let k=O-I+1;for(let w=_;w<=S;w++){let C=y[w-_],T=e.getApplyData(C,p,k);if(s=="right")for(let z=I;z<=O;z++){let A=T[z-I];if(A.f!=null){let N="="+v.functionCopy(A.f,"right",z-I+1),E=v.execfunction(N,w,z);if(v.execFunctionGroup(w,z,E[1],void 0,n),A.f=E[2],A.v=E[1],A.spl!=null)A.spl=E[3].data;else if(Y(A.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(A.v)){if(A.v==Infinity||A.v==-Infinity)A.m=A.v.toString();else if(A.v.toString().indexOf("e")>-1){let B=A.v.toString().split(".")[1].split("e")[0].length;B>5&&(B=5),A.m=A.v.toExponential(B).toString()}else{let B=nl(Math.round(A.v*1e9)/1e9);A.m=B[0].toString()}A.ct={fa:"General",t:"n"}}else{let B=nl(A.v);A.m=B[0].toString(),A.ct=B[1]}}n[w][z]=A;let M=w,P=g+(z-I)%p;if(o[M+"_"+P]){let N={rangeType:"cell",value:{row_index:w,col_index:z,l:o[M+"_"+P].l,r:o[M+"_"+P].r,t:o[M+"_"+P].t,b:o[M+"_"+P].b}};l.borderInfo.push(N)}else if(o[w+"_"+z]){let N={rangeType:"cell",value:{row_index:w,col_index:z,l:null,r:null,t:null,b:null}};l.borderInfo.push(N)}a[M+"_"+P]&&(a[w+"_"+z]=a[M+"_"+P])}if(s=="left")for(let z=O;z>=I;z--){let A=T[O-z];if(A.f!=null){let N="="+v.functionCopy(A.f,"left",O-z+1),E=v.execfunction(N,w,z);if(v.execFunctionGroup(w,z,E[1],void 0,n),A.f=E[2],A.v=E[1],A.spl!=null)A.spl=E[3].data;else if(Y(A.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(A.v)){if(A.v==Infinity||A.v==-Infinity)A.m=A.v.toString();else if(A.v.toString().indexOf("e")>-1){let B=A.v.toString().split(".")[1].split("e")[0].length;B>5&&(B=5),A.m=A.v.toExponential(B).toString()}else{let B=nl(Math.round(A.v*1e9)/1e9);A.m=B[0].toString()}A.ct={fa:"General",t:"n"}}else{let B=nl(A.v);A.m=B[0].toString(),A.ct=B[1]}}n[w][z]=A;let M=w,P=b-(O-z)%p;if(o[M+"_"+P]){let N={rangeType:"cell",value:{row_index:w,col_index:z,l:o[M+"_"+P].l,r:o[M+"_"+P].r,t:o[M+"_"+P].t,b:o[M+"_"+P].b}};l.borderInfo.push(N)}else if(o[w+"_"+z]){let N={rangeType:"cell",value:{row_index:w,col_index:z,l:null,r:null,t:null,b:null}};l.borderInfo.push(N)}a[M+"_"+P]&&(a[w+"_"+z]=a[M+"_"+P])}}}let F=$.extend(!0,[],t.luckysheet_conditionformat_save);if(F!=null&&F.length>0)for(let k=0;k<F.length;k++){let w=F[k].cellrange,C=[];for(let T=0;T<w.length;T++){let z=xt.CFSplitRange(w[T],{row:f.row,column:f.column},{row:x.row,column:x.column},"operatePart");z.length>0&&(C=C.concat(z))}C.length>0&&F[k].cellrange.push(x)}let D={cfg:l,cdformat:F,dataVerification:a};Gt(n,h.luckysheet_select_save,D),Zt()},getCopyData:function(e,n,t,l,o,a){let s=this,u=[],f,m,d,g;a=="down"||a=="up"?(f=l,m=o,d=n,g=t):(a=="right"||a=="left")&&(f=n,m=t,d=l,g=o);for(let b=f;b<=m;b++){let y={},p=[],x=[],_="",S=null,I=null,O=!0;for(let F=d;F<=g;F++){let D;a=="down"||a=="up"?D=e[F][b]:(a=="right"||a=="left")&&(D=e[b][F]);let k;if(!!D&&!!D.v&&D.f==null)if(!!D.ct&&D.ct.t=="n")k="number",S=null,I=null;else if(!!D.ct&&D.ct.t=="d")k="date",S=null,I=null;else if(s.isExtendNumber(D.m)[0]){k="extendNumber";let w=s.isExtendNumber(D.m);S==null||I==null?(O=!0,S=w[2],I=w[3]):w[2]!=S||w[3]!=I?(O=!1,S=w[2],I=w[3]):O=!0}else s.isChnNumber(D.m)?(k="chnNumber",S=null,I=null):s.isChnWeek2(D.m)?(k="chnWeek2",S=null,I=null):s.isChnWeek3(D.m)?(k="chnWeek3",S=null,I=null):(k="other",S=null,I=null);else k="other",S=null,I=null;k=="extendNumber"?F==d?d==g?(_=k,p.push(D),x.push(F-d+1),y[_]=[],y[_].push({data:p,index:x})):(_=k,p.push(D),x.push(F-d+1)):F==g?_==k&&O?(p.push(D),x.push(F-d+1),_ in y?y[_].push({data:p,index:x}):(y[_]=[],y[_].push({data:p,index:x}))):(_ in y?y[_].push({data:p,index:x}):(y[_]=[],y[_].push({data:p,index:x})),_=k,p=[],p.push(D),x=[],x.push(F-d+1),_ in y?y[_].push({data:p,index:x}):(y[_]=[],y[_].push({data:p,index:x}))):_==k&&O?(p.push(D),x.push(F-d+1)):(_ in y?y[_].push({data:p,index:x}):(y[_]=[],y[_].push({data:p,index:x})),_=k,p=[],p.push(D),x=[],x.push(F-d+1)):F==d?d==g?(_=k,p.push(D),x.push(F-d+1),y[_]=[],y[_].push({data:p,index:x})):(_=k,p.push(D),x.push(F-d+1)):F==g?_==k?(p.push(D),x.push(F-d+1),_ in y?y[_].push({data:p,index:x}):(y[_]=[],y[_].push({data:p,index:x}))):(_ in y?y[_].push({data:p,index:x}):(y[_]=[],y[_].push({data:p,index:x})),_=k,p=[],p.push(D),x=[],x.push(F-d+1),_ in y?y[_].push({data:p,index:x}):(y[_]=[],y[_].push({data:p,index:x}))):_==k?(p.push(D),x.push(F-d+1)):(_ in y?y[_].push({data:p,index:x}):(y[_]=[],y[_].push({data:p,index:x})),_=k,p=[],p.push(D),x=[],x.push(F-d+1))}u.push(y)}return u},getApplyData:function(e,n,t){let l=this,o=[],a=l.direction,s=l.applyType,u=Math.floor(t/n),f=t%n,m=e.number,d=[];if(m)for(let w=0;w<m.length;w++){let C=l.getLenS(m[w].index,f),T=m[w].index.length*u+C,z;s=="1"||s=="3"?z=l.getDataByType(m[w].data,T,a,s,"number"):s=="2"?z=l.getDataByType(m[w].data,T,a,s):z=l.getDataByType(m[w].data,T,a,"0");let A=l.getDataIndex(n,t,m[w].index);d.push({data:z,index:A})}let g=e.extendNumber,b=[];if(g)for(let w=0;w<g.length;w++){let C=l.getLenS(g[w].index,f),T=g[w].index.length*u+C,z;s=="1"||s=="3"?z=l.getDataByType(g[w].data,T,a,s,"extendNumber"):s=="2"?z=l.getDataByType(g[w].data,T,a,s):z=l.getDataByType(g[w].data,T,a,"0");let A=l.getDataIndex(n,t,g[w].index);b.push({data:z,index:A})}let y=e.date,p=[];if(y)for(let w=0;w<y.length;w++){let C=l.getLenS(y[w].index,f),T=y[w].index.length*u+C,z;s=="1"||s=="3"?z=l.getDataByType(y[w].data,T,a,s,"date"):s=="8"?z=l.getDataByType(y[w].data,T,a,"0"):z=l.getDataByType(y[w].data,T,a,s);let A=l.getDataIndex(n,t,y[w].index);p.push({data:z,index:A})}let x=e.chnNumber,_=[];if(x)for(let w=0;w<x.length;w++){let C=l.getLenS(x[w].index,f),T=x[w].index.length*u+C,z;s=="1"||s=="3"?z=l.getDataByType(x[w].data,T,a,s,"chnNumber"):s=="2"||s=="8"?z=l.getDataByType(x[w].data,T,a,s):z=l.getDataByType(x[w].data,T,a,"0");let A=l.getDataIndex(n,t,x[w].index);_.push({data:z,index:A})}let S=e.chnWeek2,I=[];if(S)for(let w=0;w<S.length;w++){let C=l.getLenS(S[w].index,f),T=S[w].index.length*u+C,z;s=="1"||s=="3"?z=l.getDataByType(S[w].data,T,a,s,"chnWeek2"):s=="2"?z=l.getDataByType(S[w].data,T,a,s):z=l.getDataByType(S[w].data,T,a,"0");let A=l.getDataIndex(n,t,S[w].index);I.push({data:z,index:A})}let O=e.chnWeek3,F=[];if(O)for(let w=0;w<O.length;w++){let C=l.getLenS(O[w].index,f),T=O[w].index.length*u+C,z;s=="1"||s=="3"?z=l.getDataByType(O[w].data,T,a,s,"chnWeek3"):s=="2"?z=l.getDataByType(O[w].data,T,a,s):z=l.getDataByType(O[w].data,T,a,"0");let A=l.getDataIndex(n,t,O[w].index);F.push({data:z,index:A})}let D=e.other,k=[];if(D)for(let w=0;w<D.length;w++){let C=l.getLenS(D[w].index,f),T=D[w].index.length*u+C,z;s=="2"||s=="3"?z=l.getDataByType(D[w].data,T,a,s):z=l.getDataByType(D[w].data,T,a,"0");let A=l.getDataIndex(n,t,D[w].index);k.push({data:z,index:A})}for(let w=1;w<=t;w++){if(d.length>0)for(let C=0;C<d.length;C++)w in d[C].index&&o.push(d[C].data[d[C].index[w]]);if(b.length>0)for(let C=0;C<b.length;C++)w in b[C].index&&o.push(b[C].data[b[C].index[w]]);if(p.length>0)for(let C=0;C<p.length;C++)w in p[C].index&&o.push(p[C].data[p[C].index[w]]);if(_.length>0)for(let C=0;C<_.length;C++)w in _[C].index&&o.push(_[C].data[_[C].index[w]]);if(I.length>0)for(let C=0;C<I.length;C++)w in I[C].index&&o.push(I[C].data[I[C].index[w]]);if(F.length>0)for(let C=0;C<F.length;C++)w in F[C].index&&o.push(F[C].data[F[C].index[w]]);if(k.length>0)for(let C=0;C<k.length;C++)w in k[C].index&&o.push(k[C].data[k[C].index[w]])}return o},getLenS:function(e,n){let t=0;for(let l=0;l<e.length&&e[l]<=n;l++)t++;return t},getDataIndex:function(e,n,t){let l={},o=Math.floor(n/e),a=n%e,s=0;if(o>0){for(let u=1;u<=o;u++)for(let f=0;f<t.length;f++)l[t[f]+(u-1)*e]=s,s++;for(let u=0;u<t.length&&t[u]<=a;u++)l[t[u]+e*o]=s,s++}else for(let u=0;u<t.length&&t[u]<=a;u++)l[t[u]]=s,s++;return l},getDataByType:function(e,n,t,l,o){let a=this,s=[];if(l=="0")(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n);else if(l=="1")if(o=="number")s=a.FillSeries(e,n,t);else if(o=="extendNumber")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillExtendNumber(e,n,u)}else{let u=[];for(let f=0;f<e.length;f++){let m=e[f].m;u.push(Number(a.isExtendNumber(m)[1]))}if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let f=u[1]-u[0];s=a.FillExtendNumber(e,n,f)}else s=a.FillCopy(e,n)}else if(o=="date")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillDays(e,n,u)}else{(t=="up"||t=="left")&&e.reverse();let u=a.judgeDate(e);if(u[0]&&u[3]){let f=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"months");s=a.FillMonths(e,n,f)}else if(!u[0]&&u[2]){let f=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"days");s=a.FillDays(e,n,f)}else s=a.FillCopy(e,n)}else if(o=="chnNumber")if(e.length==1)if(e[0].m=="\u65E5"||a.ChineseToNumber(e[0].m)<7){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnWeek(e,n,u)}else{let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnNumber(e,n,u)}else{let u=!1;for(let d=0;d<e.length;d++)if(e[d].m=="\u65E5"){u=!0;break}let f=[],m=0;for(let d=0;d<e.length;d++)e[d].m=="\u65E5"?d==0?f.push(0):(m++,f.push(m*7)):u&&a.ChineseToNumber(e[d].m)>0&&a.ChineseToNumber(e[d].m)<7?f.push(a.ChineseToNumber(e[d].m)+m*7):f.push(a.ChineseToNumber(e[d].m));if((t=="up"||t=="left")&&(e.reverse(),f.reverse()),a.isEqualDiff(f))if(u||f[f.length-1]<6&&f[0]>0||f[0]<6&&f[f.length-1]>0){let d=f[1]-f[0];s=a.FillChnWeek(e,n,d)}else{let d=f[1]-f[0];s=a.FillChnNumber(e,n,d)}else s=a.FillCopy(e,n)}else if(o=="chnWeek2")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnWeek2(e,n,u)}else{let u=[],f=0;for(let m=0;m<e.length;m++){let d=e[m].m.substr(e[m].m.length-1,1);e[m].m=="\u5468\u65E5"?m==0?u.push(0):(f++,u.push(f*7)):u.push(a.ChineseToNumber(d)+f*7)}if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let m=u[1]-u[0];s=a.FillChnWeek2(e,n,m)}else s=a.FillCopy(e,n)}else if(o=="chnWeek3")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnWeek3(e,n,u)}else{let u=[],f=0;for(let m=0;m<e.length;m++){let d=e[m].m.substr(e[m].m.length-1,1);e[m].m=="\u661F\u671F\u65E5"?m==0?u.push(0):(f++,u.push(f*7)):u.push(a.ChineseToNumber(d)+f*7)}if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let m=u[1]-u[0];s=a.FillChnWeek3(e,n,m)}else s=a.FillCopy(e,n)}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n);else if(l=="2")(t=="up"||t=="left")&&e.reverse(),s=a.FillOnlyFormat(e,n);else if(l=="3"){let u=a.getDataByType(e,n,t,"1",o);s=a.FillWithoutFormat(u)}else if(l=="4")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillDays(e,n,u)}else if(e.length==2){(t=="up"||t=="left")&&e.reverse();let u=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"days");s=a.FillDays(e,n,u)}else{(t=="up"||t=="left")&&e.reverse();let u=a.judgeDate(e);if(u[0]&&u[3]){let f=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"months");s=a.FillMonths(e,n,f)}else if(!u[0]&&u[2]){let f=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"days");s=a.FillDays(e,n,f)}else s=a.FillCopy(e,n)}else if(l=="5")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1);let f=Math.round(n*1.5);for(let m=1;m<=f;m++){let d=$.extend(!0,{},e[0]),g=(0,Ct.default)(d.m).add(m,"days").day();if(g==0||g==6)continue;let b=(0,Ct.default)(d.m).add(u*m,"days").format("YYYY-MM-DD");if(d.m=b,d.v=nl(b)[2],s.push(d),s.length==n)break}}else if(e.length==2)if((0,Ct.default)(e[1].m).date()==(0,Ct.default)(e[0].m).date()&&(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"months")!=0){(t=="up"||t=="left")&&e.reverse();let u=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"months");for(let f=1;f<=n;f++){let m=(f-1)%e.length,d=$.extend(!0,{},e[m]),g=(0,Ct.default)(e[e.length-1]).add(u*f,"months").day(),b;g==0?b=(0,Ct.default)(e[e.length-1]).add(u*f,"months").subtract(2,"days").format("YYYY-MM-DD"):g==6?b=(0,Ct.default)(e[e.length-1]).add(u*f,"months").subtract(1,"days").format("YYYY-MM-DD"):b=(0,Ct.default)(e[e.length-1]).add(u*f,"months").format("YYYY-MM-DD"),d.m=b,d.v=nl(b)[2],s.push(d)}}else if(Math.abs((0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m)))>7){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1,e.reverse());let f;for(let m=1;m<=n;m++){let d=(m-1)%e.length,g=$.extend(!0,{},e[d]),b=Math.ceil(m/e.length);d==0&&(f=(0,Ct.default)(g.m).add(u*b,"months").diff((0,Ct.default)(g.m),"days"));let y=(0,Ct.default)(g.m).add(f,"days").day(),p;y==0?p=(0,Ct.default)(g.m).add(f,"days").subtract(2,"days").format("YYYY-MM-DD"):y==6?p=(0,Ct.default)(g.m).add(f,"days").subtract(1,"days").format("YYYY-MM-DD"):p=(0,Ct.default)(g.m).add(f,"days").format("YYYY-MM-DD"),g.m=p,g.v=nl(p)[2],s.push(g)}}else{let u;t=="down"||t=="right"?u=7:(t=="up"||t=="left")&&(u=-7,e.reverse());let f;for(let m=1;m<=n;m++){let d=(m-1)%e.length,g=$.extend(!0,{},e[d]),b=Math.ceil(m/e.length);d==0&&(f=(0,Ct.default)(g.m).add(u*b,"days").diff((0,Ct.default)(g.m),"days"));let y=(0,Ct.default)(g.m).add(f,"days").day(),p;y==0?p=(0,Ct.default)(g.m).add(f,"days").subtract(2,"days").format("YYYY-MM-DD"):y==6?p=(0,Ct.default)(g.m).add(f,"days").subtract(1,"days").format("YYYY-MM-DD"):p=(0,Ct.default)(g.m).add(f,"days").format("YYYY-MM-DD"),g.m=p,g.v=nl(p)[2],s.push(g)}}else{let u=a.judgeDate(e);if(u[0]&&u[3]){(t=="up"||t=="left")&&e.reverse();let f=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"months");for(let m=1;m<=n;m++){let d=(m-1)%e.length,g=$.extend(!0,{},e[d]),b=(0,Ct.default)(e[e.length-1].m).add(f*m,"months").day(),y;b==0?y=(0,Ct.default)(e[e.length-1].m).add(f*m,"months").subtract(2,"days").format("YYYY-MM-DD"):b==6?y=(0,Ct.default)(e[e.length-1].m).add(f*m,"months").subtract(1,"days").format("YYYY-MM-DD"):y=(0,Ct.default)(e[e.length-1].m).add(f*m,"months").format("YYYY-MM-DD"),g.m=y,g.v=nl(y)[2],s.push(g)}}else if(!u[0]&&u[2])if(Math.abs((0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m)))>7){let f;t=="down"||t=="right"?f=1:(t=="up"||t=="left")&&(f=-1,e.reverse());let m;for(let d=1;d<=n;d++){let g=(d-1)%e.length,b=$.extend(!0,{},e[g]),y=Math.ceil(d/e.length);g==0&&(m=(0,Ct.default)(b.m).add(f*y,"months").diff((0,Ct.default)(b.m),"days"));let p=(0,Ct.default)(b.m).add(m,"days").day(),x;p==0?x=(0,Ct.default)(b.m).add(m,"days").subtract(2,"days").format("YYYY-MM-DD"):p==6?x=(0,Ct.default)(b.m).add(m,"days").subtract(1,"days").format("YYYY-MM-DD"):x=(0,Ct.default)(b.m).add(m,"days").format("YYYY-MM-DD"),b.m=x,b.v=nl(x)[2],s.push(b)}}else{let f;t=="down"||t=="right"?f=7:(t=="up"||t=="left")&&(f=-7,e.reverse());let m;for(let d=1;d<=n;d++){let g=(d-1)%e.length,b=$.extend(!0,{},e[g]),y=Math.ceil(d/e.length);g==0&&(m=(0,Ct.default)(b.m).add(f*y,"days").diff((0,Ct.default)(b.m),"days"));let p=(0,Ct.default)(b.m).add(m,"days").day(),x;p==0?x=(0,Ct.default)(b.m).add(m,"days").subtract(2,"days").format("YYYY-MM-DD"):p==6?x=(0,Ct.default)(b.m).add(m,"days").subtract(1,"days").format("YYYY-MM-DD"):x=(0,Ct.default)(b.m).add(m,"days").format("YYYY-MM-DD"),b.m=x,b.v=nl(x)[2],s.push(b)}}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n)}else if(l=="6")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillMonths(e,n,u)}else if(e.length==2)if((0,Ct.default)(e[1].m).date()==(0,Ct.default)(e[0].m).date()&&(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"months")!=0){(t=="up"||t=="left")&&e.reverse();let u=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"months");s=a.FillMonths(e,n,u)}else{let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1,e.reverse());let f;for(let m=1;m<=n;m++){let d=(m-1)%e.length,g=$.extend(!0,{},e[d]),b=Math.ceil(m/e.length);d==0&&(f=(0,Ct.default)(g.m).add(u*b,"months").diff((0,Ct.default)(g.m),"days"));let y=(0,Ct.default)(g.m).add(f,"days").format("YYYY-MM-DD");g.m=y,g.v=nl(y)[2],s.push(g)}}else{let u=a.judgeDate(e);if(u[0]&&u[3]){(t=="up"||t=="left")&&e.reverse();let f=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"months");s=a.FillMonths(e,n,f)}else if(!u[0]&&u[2]){let f;t=="down"||t=="right"?f=1:(t=="up"||t=="left")&&(f=-1,e.reverse());let m;for(let d=1;d<=n;d++){let g=(d-1)%e.length,b=$.extend(!0,{},e[g]),y=Math.ceil(d/e.length);g==0&&(m=(0,Ct.default)(b.m).add(f*y,"months").diff((0,Ct.default)(b.m),"days"));let p=(0,Ct.default)(b.m).add(m,"days").format("YYYY-MM-DD");b.m=p,b.v=nl(p)[2],s.push(b)}}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n)}else if(l=="7")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillYears(e,n,u)}else if(e.length==2)if((0,Ct.default)(e[1].m).date()==(0,Ct.default)(e[0].m).date()&&(0,Ct.default)(e[1].m).month()==(0,Ct.default)(e[0].m).month()&&(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"years")!=0){(t=="up"||t=="left")&&e.reverse();let u=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"years");s=a.FillYears(e,n,u)}else{let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1,e.reverse());let f;for(let m=1;m<=n;m++){let d=(m-1)%e.length,g=$.extend(!0,{},e[d]),b=Math.ceil(m/e.length);d==0&&(f=(0,Ct.default)(g.m).add(u*b,"years").diff((0,Ct.default)(g.m),"days"));let y=(0,Ct.default)(g.m).add(f,"days").format("YYYY-MM-DD");g.m=y,g.v=nl(y)[2],s.push(g)}}else{let u=a.judgeDate(e);if(u[0]&&u[1]&&u[4]){(t=="up"||t=="left")&&e.reverse();let f=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"years");s=a.FillYears(e,n,f)}else if(u[0]&&u[3]||u[2]){let f;t=="down"||t=="right"?f=1:(t=="up"||t=="left")&&(f=-1,e.reverse());let m;for(let d=1;d<=n;d++){let g=(d-1)%e.length,b=$.extend(!0,{},e[g]),y=Math.ceil(d/e.length);g==0&&(m=(0,Ct.default)(b.m).add(f*y,"years").diff((0,Ct.default)(b.m),"days"));let p=(0,Ct.default)(b.m).add(m,"days").format("YYYY-MM-DD");b.m=p,b.v=nl(p)[2],s.push(b)}}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n)}else if(l=="8")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnNumber(e,n,u)}else{let u=[];for(let f=0;f<e.length;f++)u.push(a.ChineseToNumber(e[f].m));if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let f=u[1]-u[0];s=a.FillChnNumber(e,n,f)}else s=a.FillCopy(e,n)}return s},FillCopy:function(e,n){let t=[];for(let l=1;l<=n;l++){let o=(l-1)%e.length,a=$.extend(!0,{},e[o]);t.push(a)}return t},FillSeries:function(e,n,t){let l=this,o=[],a=[];for(let s=0;s<e.length;s++)a.push(Number(e[s].v));if(e.length>2&&l.isEqualRatio(a))for(let s=1;s<=n;s++){let u=(s-1)%e.length,f=$.extend(!0,{},e[u]),m;t=="down"||t=="right"?m=Number(e[e.length-1].v)*Math.pow(Number(e[1].v)/Number(e[0].v),s):(t=="up"||t=="left")&&(m=Number(e[0].v)/Math.pow(Number(e[1].v)/Number(e[0].v),s)),f.v=m,f.m=$l(f.ct.fa,m),o.push(f)}else{let s=l.getXArr(e.length);for(let u=1;u<=n;u++){let f=(u-1)%e.length,m=$.extend(!0,{},e[f]),d;t=="down"||t=="right"?d=l.forecast(e.length+u,a,s):(t=="up"||t=="left")&&(d=l.forecast(1-u,a,s)),m.v=d,m.m=$l(m.ct.fa,d),o.push(m)}}return o},FillExtendNumber:function(e,n,t){let l=this,o=[],a=/0|([1-9]+[0-9]*)/g;for(let s=1;s<=n;s++){let u=(s-1)%e.length,f=$.extend(!0,{},e[u]),m=e[e.length-1].m,d=m.match(a),g=d[d.length-1],b=Math.abs(Number(g)+t*s),y=m.lastIndexOf(g),p=m.substr(0,y)+b.toString()+m.substr(y+g.length);f.v=p,f.m=p,o.push(f)}return o},FillOnlyFormat:function(e,n){let t=[];for(let l=1;l<=n;l++){let o=(l-1)%e.length,a=$.extend(!0,{},e[o]);delete a.f,delete a.m,delete a.v,t.push(a)}return t},FillWithoutFormat:function(e){let n=[];for(let t=0;t<e.length;t++){let l=$.extend(!0,{},e[t]),o;l.f==null?o={m:l.v.toString(),v:l.v}:o={f:l.f,m:l.v.toString(),v:l.v},n.push(o)}return n},FillDays:function(e,n,t){let l=[];for(let o=1;o<=n;o++){let a=(o-1)%e.length,s=$.extend(!0,{},e[a]),u=$l("yyyy-MM-dd",s.v);u=(0,Ct.default)(u).add(t*o,"days").format("YYYY-MM-DD"),s.v=nl(u)[2],s.m=$l(s.ct.fa,s.v),l.push(s)}return l},FillMonths:function(e,n,t){let l=[];for(let o=1;o<=n;o++){let a=(o-1)%e.length,s=$.extend(!0,{},e[a]),u=$l("yyyy-MM-dd",s.v);u=(0,Ct.default)(u).add(t*o,"months").format("YYYY-MM-DD"),s.v=nl(u)[2],s.m=$l(s.ct.fa,s.v),l.push(s)}return l},FillYears:function(e,n,t){let l=[];for(let o=1;o<=n;o++){let a=(o-1)%e.length,s=$.extend(!0,{},e[a]),u=$l("yyyy-MM-dd",s.v);u=(0,Ct.default)(u).add(t*o,"years").format("YYYY-MM-DD"),s.v=nl(u)[2],s.m=$l(s.ct.fa,s.v),l.push(s)}return l},FillChnWeek:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),f;e[e.length-1].m=="\u65E5"?f=7+t*a:f=l.ChineseToNumber(e[e.length-1].m)+t*a,f<0&&(f=Math.ceil(Math.abs(f)/7)*7+f);let m=f%7;m==0?(u.m="\u65E5",u.v="\u65E5"):m==1?(u.m="\u4E00",u.v="\u4E00"):m==2?(u.m="\u4E8C",u.v="\u4E8C"):m==3?(u.m="\u4E09",u.v="\u4E09"):m==4?(u.m="\u56DB",u.v="\u56DB"):m==5?(u.m="\u4E94",u.v="\u4E94"):m==6&&(u.m="\u516D",u.v="\u516D"),o.push(u)}return o},FillChnWeek2:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),f;if(e[e.length-1].m=="\u5468\u65E5")f=7+t*a;else{let d=e[e.length-1].m,g=d.substr(d.length-1,1);f=l.ChineseToNumber(g)+t*a}f<0&&(f=Math.ceil(Math.abs(f)/7)*7+f);let m=f%7;m==0?(u.m="\u5468\u65E5",u.v="\u5468\u65E5"):m==1?(u.m="\u5468\u4E00",u.v="\u5468\u4E00"):m==2?(u.m="\u5468\u4E8C",u.v="\u5468\u4E8C"):m==3?(u.m="\u5468\u4E09",u.v="\u5468\u4E09"):m==4?(u.m="\u5468\u56DB",u.v="\u5468\u56DB"):m==5?(u.m="\u5468\u4E94",u.v="\u5468\u4E94"):m==6&&(u.m="\u5468\u516D",u.v="\u5468\u516D"),o.push(u)}return o},FillChnWeek3:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),f;if(e[e.length-1].m=="\u661F\u671F\u65E5")f=7+t*a;else{let d=e[e.length-1].m,g=d.substr(d.length-1,1);f=l.ChineseToNumber(g)+t*a}f<0&&(f=Math.ceil(Math.abs(f)/7)*7+f);let m=f%7;m==0?(u.m="\u661F\u671F\u65E5",u.v="\u661F\u671F\u65E5"):m==1?(u.m="\u661F\u671F\u4E00",u.v="\u661F\u671F\u4E00"):m==2?(u.m="\u661F\u671F\u4E8C",u.v="\u661F\u671F\u4E8C"):m==3?(u.m="\u661F\u671F\u4E09",u.v="\u661F\u671F\u4E09"):m==4?(u.m="\u661F\u671F\u56DB",u.v="\u661F\u671F\u56DB"):m==5?(u.m="\u661F\u671F\u4E94",u.v="\u661F\u671F\u4E94"):m==6&&(u.m="\u661F\u671F\u516D",u.v="\u661F\u671F\u516D"),o.push(u)}return o},FillChnNumber:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),f=l.ChineseToNumber(e[e.length-1].m)+t*a,m;f<=0?m="\u96F6":m=l.NumberToChinese(f),u.v=m,u.m=m.toString(),o.push(u)}return o},isEqualDiff:function(e){let n=!0,t=e[1]-e[0];for(let l=1;l<e.length;l++)if(e[l]-e[l-1]!=t){n=!1;break}return n},isEqualRatio:function(e){let n=!0,t=e[1]/e[0];for(let l=1;l<e.length;l++)if(e[l]/e[l-1]!=t){n=!1;break}return n},getXArr:function(e){let n=[];for(let t=1;t<=e;t++)n.push(t);return n},forecast:function(e,n,t){function l(d){let g=0;for(let b=0;b<d.length;b++)g+=d[b];return g/d.length}let o=l(t),a=l(n),s=0,u=0;for(let d=0;d<t.length;d++)s+=(t[d]-o)*(n[d]-a),u+=(t[d]-o)*(t[d]-o);let f;u==0?f=1:f=s/u;let m=a-f*o;return Math.round((m+f*e)*1e5)/1e5},judgeDate:function(e){let n=!0,t=!0,l=!0,o=!0,a=!0,s=(0,Ct.default)(e[0].m).date(),u=(0,Ct.default)(e[0].m).month(),f=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"days"),m=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"months"),d=(0,Ct.default)(e[1].m).diff((0,Ct.default)(e[0].m),"years");for(let g=1;g<e.length;g++)(0,Ct.default)(e[g].m).date()!=s&&(n=!1),(0,Ct.default)(e[g].m).month()!=u&&(t=!1),(0,Ct.default)(e[g].m).diff((0,Ct.default)(e[g-1].m),"days")!=f&&(l=!1),(0,Ct.default)(e[g].m).diff((0,Ct.default)(e[g-1].m),"months")!=m&&(o=!1),(0,Ct.default)(e[g].m).diff((0,Ct.default)(e[g-1].m),"years")!=d&&(a=!1);return f==0&&(l=!1),m==0&&(o=!1),d==0&&(a=!1),[n,t,l,o,a]}},Tr=Vx});var import_plugin,ta,we,li=Tt(()=>{import_plugin=Le(Be());ql();xo();vr();wa();wr();Mr();Fo();zm();Qn();Ut();Rl();fr();ta={freezenHorizontalHTML:'<div id="luckysheet-freezebar-horizontal" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-horizontal-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-horizontal-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-bar" >&nbsp;</div></div></div>',freezenVerticalHTML:'<div id="luckysheet-freezebar-vertical" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-vertical-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-vertical-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-bar" >&nbsp;</div></div></div>',initialHorizontal:!0,initialVertical:!0,horizontalmovestate:!1,horizontalmoveposition:null,verticalmovestate:!1,verticalmoveposition:null,windowHeight:null,windowWidth:null,freezenhorizontaldata:null,freezenverticaldata:null,freezenRealFirstRowColumn:!0,cutVolumn:function(e,n){if(n<=0)return e;let t=e.slice(0,n),l=t[t.length-1];return e.slice(n)},cancelFreezenVertical:function(e){let n=this,l=Oe().freezen,o=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${l.default}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(o),$("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> '+l.freezenColumn),n.freezenverticaldata=null;let a=$("#luckysheet-freezebar-vertical").is(":visible");$("#luckysheet-freezebar-vertical").hide(),e==null&&(e=h.currentSheetIndex);let s=h.luckysheetfile[$e(e)];s.freezen!=null&&(s.freezen.vertical=null),s.frozen!=null&&a&&He.saveParam("all",e,s.frozen,{k:"frozen"})},createFreezenVertical:function(e,n){let t=this;if(t.initialVertical){t.initialVertical=!1,$("#luckysheet-grid-window-1").append(t.freezenVerticalHTML),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").mousedown(function(){t.verticalmovestate=!0,t.verticalmoveposition=$(this).position().left,t.windowWidth=$("#luckysheet-grid-window-1").width(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grabbing")});let o=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:o-10,width:"4px",cursor:"-webkit-grab",top:"0px"}).end().find(".luckysheet-freezebar-vertical-drop").css({height:o-10,width:"4px",top:"0px",cursor:"-webkit-grab"})}if(e==null){if(t.freezenRealFirstRowColumn){let o=0;n=h.visibledatacolumn[o]-2+h.rowHeaderWidth,e=[h.visibledatacolumn[o],o+1,0,t.cutVolumn(h.visibledatacolumn,o+1),n]}else{let o=$("#luckysheet-cell-main").scrollLeft(),a=al(h.visibledatacolumn,o);a==-1&&(a=0),n=h.visibledatacolumn[a]-2-o+h.rowHeaderWidth,e=[h.visibledatacolumn[a],a+1,o,t.cutVolumn(h.visibledatacolumn,a+1),n]}t.saveFreezen(null,null,e,n)}t.freezenverticaldata=e;let l=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${Oe().freezen.freezenCancel}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(l),$("#luckysheet-freezebar-vertical").show().find(".luckysheet-freezebar-vertical-handle").css({left:n}).end().find(".luckysheet-freezebar-vertical-drop").css({left:n})},saveFreezen:function(e,n,t,l){let o=h.luckysheetfile[$e(h.currentSheetIndex)];o.freezen==null&&(o.freezen={}),e!=null&&(o.freezen.horizontal==null&&(o.freezen.horizontal={}),o.freezen.horizontal.freezenhorizontaldata=e,o.freezen.horizontal.top=n),t!=null&&(o.freezen.vertical==null&&(o.freezen.vertical={}),o.freezen.vertical.freezenverticaldata=t,o.freezen.vertical.left=l),o.frozen!=null&&He.saveParam("all",h.currentSheetIndex,o.frozen,{k:"frozen"})},initialFreezen:function(e){let n=this;n.frozenTofreezen();let t=h.luckysheetfile[$e(e)];t.freezen!=null&&t.freezen.horizontal!=null&&t.freezen.horizontal.freezenhorizontaldata!=null?n.createFreezenHorizontal(t.freezen.horizontal.freezenhorizontaldata,t.freezen.horizontal.top):n.cancelFreezenHorizontal(e),t.freezen!=null&&t.freezen.vertical!=null&&t.freezen.vertical.freezenverticaldata!=null?n.createFreezenVertical(t.freezen.vertical.freezenverticaldata,t.freezen.vertical.left):n.cancelFreezenVertical(e),n.createAssistCanvas()},changeFreezenIndex:function(e,n){let t=this;if(n=="v"&&t.freezenverticaldata!=null){let l=t.freezenverticaldata[1],o=al(h.visibledatacolumn,$("#luckysheet-cell-main").scrollLeft());e-o<l&&(e=e-o)}else if(n=="h"&&t.freezenhorizontaldata!=null){let l=t.freezenhorizontaldata[1],o=al(h.visibledatarow,$("#luckysheet-cell-main").scrollTop());e-o<l&&(e=e-o)}return e},scrollFreezen:function(){let e=this,n,t=h.luckysheet_select_save[0].row_focus;t==h.luckysheet_select_save[0].row[0]?n=h.luckysheet_select_save[0].row[1]:t==h.luckysheet_select_save[0].row[1]&&(n=h.luckysheet_select_save[0].row[0]);let l,o=h.luckysheet_select_save[0].column_focus;if(o==h.luckysheet_select_save[0].column[0]?l=h.luckysheet_select_save[0].column[1]:o==h.luckysheet_select_save[0].column[1]&&(l=h.luckysheet_select_save[0].column[0]),e.freezenverticaldata!=null){let a=e.freezenverticaldata[1],s=al(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()),u=e.freezenverticaldata[4];a+=s,l>=h.visibledatacolumn.length&&(l=h.visibledatacolumn.length-1),a>=h.visibledatacolumn.length&&(a=h.visibledatacolumn.length-1);let f=h.visibledatacolumn[l],m=h.visibledatacolumn[a];f<=m+u&&setTimeout(function(){$("#luckysheet-scrollbar-x").scrollLeft(0)},100)}if(e.freezenhorizontaldata!=null){let a=e.freezenhorizontaldata[1],s=al(e.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()),u=e.freezenhorizontaldata[4];a+=s,n>=h.visibledatarow.length&&(n=h.visibledatarow.length-1),a>=h.visibledatarow.length&&(a=h.visibledatarow.length-1);let f=h.visibledatarow[n],m=h.visibledatarow[a];f<=m+u&&setTimeout(function(){$("#luckysheet-scrollbar-y").scrollTop(0)},100)}},cancelFreezenHorizontal:function(e){let n=this,t=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${Oe().freezen.default}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(t),n.freezenhorizontaldata=null;let l=$("#luckysheet-freezebar-horizontal").is(":visible");$("#luckysheet-freezebar-horizontal").hide(),e==null&&(e=h.currentSheetIndex);let o=h.luckysheetfile[$e(e)];o.freezen!=null&&(o.freezen.horizontal=null),o.frozen!=null&&l&&He.saveParam("all",e,o.frozen,{k:"frozen"})},createFreezenHorizontal:function(e,n){let t=this;if(t.initialHorizontal){t.initialHorizontal=!1,$("#luckysheet-grid-window-1").append(t.freezenHorizontalHTML),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").mousedown(function(){t.horizontalmovestate=!0,t.horizontalmoveposition=$(this).position().top,t.windowHeight=$("#luckysheet-grid-window-1").height(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grabbing")});let o=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:o-10,height:"4px",cursor:"-webkit-grab",left:"0px"}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:o-10,height:"4px",left:"0px",cursor:"-webkit-grab"})}if(e==null){let o;if(t.freezenRealFirstRowColumn)o=0,n=h.visibledatarow[o]-2+h.columnHeaderHeight,e=[h.visibledatarow[o],o+1,0,t.cutVolumn(h.visibledatarow,o+1),n],t.saveFreezen(e,n,null,null),setTimeout(()=>{ta.createAssistCanvas(),Et()});else{let a=$("#luckysheet-cell-main").scrollTop();o=al(h.visibledatarow,a),o==-1&&(o=0),n=h.visibledatarow[o]-2-a+h.columnHeaderHeight,e=[h.visibledatarow[o],o+1,a,t.cutVolumn(h.visibledatarow,o+1),n],t.saveFreezen(e,n,null,null)}}t.freezenhorizontaldata=e;let l=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${Oe().freezen.freezenCancel}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(l),$("#luckysheet-freezebar-horizontal").show().find(".luckysheet-freezebar-horizontal-handle").css({top:n}).end().find(".luckysheet-freezebar-horizontal-drop").css({top:n})},createAssistCanvas:function(){let e=this;if(e.removeAssistCanvas(),e.freezenverticaldata!=null||e.freezenhorizontaldata!=null){let n,t,l,o,a,s,u=h.luckysheetTableContentHW[0],f=h.luckysheetTableContentHW[1];e.freezenverticaldata!=null&&e.freezenhorizontaldata!=null?(n=e.freezenhorizontaldata[0],t=e.freezenhorizontaldata[1],l=e.freezenhorizontaldata[2],o=e.freezenverticaldata[0],a=e.freezenverticaldata[1],s=e.freezenverticaldata[2],e.createCanvas("freezen_3",o-s,n-l+1,h.rowHeaderWidth-1,h.columnHeaderHeight-1),e.createCanvas("freezen_4",u-o+s,n-l+1,o-s+h.rowHeaderWidth-1,h.columnHeaderHeight-1),e.createCanvas("freezen_7",o-s,f-n+l-h.columnHeaderHeight,h.rowHeaderWidth-1,n-l+h.columnHeaderHeight-1)):e.freezenhorizontaldata!=null?(n=e.freezenhorizontaldata[0],t=e.freezenhorizontaldata[1],l=e.freezenhorizontaldata[2],e.createCanvas("freezen_h",u,n-l+1,h.rowHeaderWidth-1,h.columnHeaderHeight-1)):e.freezenverticaldata!=null&&(o=e.freezenverticaldata[0],a=e.freezenverticaldata[1],s=e.freezenverticaldata[2],e.createCanvas("freezen_v",o-s,f,h.rowHeaderWidth-1,h.columnHeaderHeight-1)),e.scrollAdapt()}},createCanvas:function(e,n,t,l,o){let a=$("<canvas/>").appendTo("#luckysheet-grid-window-1").attr({id:e,width:Math.ceil(n*h.devicePixelRatio),height:Math.ceil(t*h.devicePixelRatio)}).css({"user-select":"none",postion:"absolute",left:l,top:o,width:n,height:t,"z-index":10,"pointer-events":"none"})},removeAssistCanvas:function(){$("#luckysheet-grid-window-1 > canvas").not($("#luckysheetTableContent")).remove(),$("#luckysheet-cell-selected").css("z-index",15)},scrollAdapt:function(){let e=this;if(h.luckysheet_select_save!=null&&h.luckysheet_select_save.length>0&&e.scrollAdaptOfselect(),$("#luckysheet-cell-main .luckysheet-data-visualization-chart").length>0){let n=h.luckysheetfile[$e(h.currentSheetIndex)].chart;n!=null&&n.length>0&&e.scrollAdaptOfchart()}$("#luckysheet-postil-showBoxs .luckysheet-postil-show").length>0&&e.scrollAdaptOfpostil(),$("#luckysheet-dropCell-icon").length>0&&e.scrollAdaptOfdpicon(),$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").length>0&&e.scrollAdaptOffilteroptions()},scrollAdaptOfselect:function(){let e=this;$("#luckysheet-row-count-show").is(":visible")&&$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").is(":visible")&&$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty();let n=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let l=e.freezenhorizontaldata[0],o=e.freezenhorizontaldata[1],a=n-e.freezenhorizontaldata[2],s=e.freezenverticaldata[0],u=e.freezenverticaldata[1],f=t-e.freezenverticaldata[2];for(let m=0;m<h.luckysheet_select_save.length;m++){let d=$.extend(!0,{},h.luckysheet_select_save[m]),g=d.row[0],b=d.row[1],y=h.visibledatarow[b],p=g-1==-1?0:h.visibledatarow[g-1],x=p,_=y-p-1,S=!0;g>=o?x+_<l+a?S=!1:x<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({top:l+a,height:_-(l+a-x)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({top:x,height:_}):b>=o?x+_<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({top:x+a,height:l-x}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({top:x+a,height:_-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css("top",x+a);let I=d.column[0],O=d.column[1],F=h.visibledatacolumn[O],D=I-1==-1?0:h.visibledatacolumn[I-1],k=D,w=F-D-1;if(I>=u?k+w<s+f?S=!1:k<s+f?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({left:s+f,width:w-(s+f-k)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({left:k,width:w}):O>=u?k+w<s+f?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({left:k+f,width:s-k}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({left:k+f,width:w-f}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css("left",k+f),S||$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).hide(),m==h.luckysheet_select_save.length-1){let C=d.row_focus==null?g:d.row_focus,T=d.column_focus==null?I:d.column_focus,z=h.visibledatarow[C],A=C-1==-1?0:h.visibledatarow[C-1],M=h.visibledatacolumn[T],P=T-1==-1?0:h.visibledatacolumn[T-1],N=ht.mergeborer(h.flowdata,C,T);N&&(z=N.row[1],A=N.row[0],M=N.column[1],P=N.column[0]);let E=A,B=z-A-1,U=P,X=M-P-1,le=!0;E>=l?E+B<l+a?le=!1:E<l+a?$("#luckysheet-cell-selected-focus").show().css({top:l+a,height:B-(l+a-E)}):$("#luckysheet-cell-selected-focus").show().css({top:E,height:B}):E+B>=l?E+B<l+a?$("#luckysheet-cell-selected-focus").show().css({top:E+a,height:l-E}):$("#luckysheet-cell-selected-focus").show().css({top:E+a,height:B-a}):$("#luckysheet-cell-selected-focus").show().css("top",E+a),U>=s?U+X<s+f?le=!1:U<s+f?$("#luckysheet-cell-selected-focus").show().css({left:s+f,width:X-(s+f-U)}):$("#luckysheet-cell-selected-focus").show().css({left:U,width:X}):U+X>=s?U+X<s+f?$("#luckysheet-cell-selected-focus").show().css({left:U+f,width:s-U}):$("#luckysheet-cell-selected-focus").show().css({left:U+f,width:X-f}):$("#luckysheet-cell-selected-focus").show().css("left",U+f),le||$("#luckysheet-cell-selected-focus").hide()}}}else if(e.freezenhorizontaldata!=null){let l=e.freezenhorizontaldata[0],o=e.freezenhorizontaldata[1],a=n-e.freezenhorizontaldata[2];for(let s=0;s<h.luckysheet_select_save.length;s++){let u=$.extend(!0,{},h.luckysheet_select_save[s]),f=u.row[0],m=u.row[1],d=h.visibledatarow[m],g=f-1==-1?0:h.visibledatarow[f-1],b=g,y=d-g-1;if(f>=o?b+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).hide():b<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:l+a,height:y-(l+a-b)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:b,height:y}):m>=o?b+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:b+a,height:l-b}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:b+a,height:y-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css("top",b+a),s==h.luckysheet_select_save.length-1){let p=u.row_focus==null?f:u.row_focus,x=u.column_focus==null?u.column[0]:u.column_focus,_=h.visibledatarow[p],S=p-1==-1?0:h.visibledatarow[p-1],I=ht.mergeborer(h.flowdata,p,x);I&&(_=I.row[1],S=I.row[0]);let O=S,F=_-S-1;O>=l?O+F<l+a?$("#luckysheet-cell-selected-focus").hide():O<l+a?$("#luckysheet-cell-selected-focus").show().css({top:l+a,height:F-(l+a-O)}):$("#luckysheet-cell-selected-focus").show().css({top:O,height:F}):O+F>=l?O+F<l+a?$("#luckysheet-cell-selected-focus").show().css({top:O+a,height:l-O}):$("#luckysheet-cell-selected-focus").show().css({top:O+a,height:F-a}):$("#luckysheet-cell-selected-focus").show().css("top",O+a)}}}else if(e.freezenverticaldata!=null){let l=e.freezenverticaldata[0],o=e.freezenverticaldata[1],a=t-e.freezenverticaldata[2];for(let s=0;s<h.luckysheet_select_save.length;s++){let u=$.extend(!0,{},h.luckysheet_select_save[s]),f=u.column[0],m=u.column[1],d=h.visibledatacolumn[m],g=f-1==-1?0:h.visibledatacolumn[f-1],b=g,y=d-g-1;if(f>=o?b+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).hide():b<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:l+a,width:y-(l+a-b)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:b,width:y}):m>=o?b+y<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:b+a,width:l-b}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:b+a,width:y-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css("left",b+a),s==h.luckysheet_select_save.length-1){let p=u.row_focus==null?u.row[0]:u.row_focus,x=u.column_focus==null?f:u.column_focus,_=h.visibledatacolumn[x],S=x-1==-1?0:h.visibledatacolumn[x-1],I=ht.mergeborer(h.flowdata,p,x);I&&(_=I.column[1],S=I.column[0]);let O=S,F=_-S-1;O>=l?O+F<l+a?$("#luckysheet-cell-selected-focus").hide():O<l+a?$("#luckysheet-cell-selected-focus").show().css({left:l+a,width:F-(l+a-O)}):$("#luckysheet-cell-selected-focus").show().css({left:O,width:F}):O+F>=l?O+F<l+a?$("#luckysheet-cell-selected-focus").show().css({left:O+a,width:l-O}):$("#luckysheet-cell-selected-focus").show().css({left:O+a,width:F-a}):$("#luckysheet-cell-selected-focus").show().css("left",O+a)}}}else Zt()},scrollAdaptOfchart:function(){let e=this,n=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let l=e.freezenhorizontaldata[0]-e.freezenhorizontaldata[2],o=e.freezenverticaldata[0]-e.freezenverticaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(a,s){let u=$(s).position(),f=$(s).width(),m=$(s).height(),d=$(s).find("canvas").width(),g=$(s).find("canvas").height(),b=g-m,y=d-f;if(u.top-b<l){let p=l-(u.top-b);p>g+40+2?$(s).css("visibility","hidden"):($(s).css({top:l+n,height:g-p,visibility:"visible"}),$(s).find("canvas").css("top",-p))}else $(s).css({top:u.top-b+n,height:g,visibility:"visible"}),$(s).find("canvas").css("top",0);if(u.left-y<o){let p=o-(u.left-y);p>d+20+2?$(s).css("visibility","hidden"):($(s).css({left:o+t,width:d-p,visibility:"visible"}),$(s).find("canvas").css("left",-p))}else $(s).css({left:u.left-y+t,width:d,visibility:"visible"}),$(s).find("canvas").css("left",0)})}else if(e.freezenhorizontaldata!=null){let l=e.freezenhorizontaldata[0]-e.freezenhorizontaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(o,a){let s=$(a).position(),u=$(a).height(),f=$(a).find("canvas").height(),m=f-u;if(s.top-m<l){let d=l-(s.top-m);d>f+40+2?$(a).css("visibility","hidden"):($(a).css({top:l+n,height:f-d,visibility:"visible"}),$(a).find("canvas").css("top",-d))}else $(a).css({top:s.top-m+n,height:f,visibility:"visible"}),$(a).find("canvas").css("top",0)})}else if(e.freezenverticaldata!=null){let l=e.freezenverticaldata[0]-e.freezenverticaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(o,a){let s=$(a).position(),u=$(a).width(),f=$(a).find("canvas").width(),m=f-u;if(s.left-m<l){let d=l-(s.left-m);d>f+20+2?$(a).css("visibility","hidden"):($(a).css({left:l+t,width:f-d,visibility:"visible"}),$(a).find("canvas").css("left",-d))}else $(a).css({left:s.left-m+t,width:f,visibility:"visible"}),$(a).find("canvas").css("left",0)})}else $("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(l,o){let a=$(o).position(),s=$(o).width(),u=$(o).height(),f=$(o).find("canvas").width(),m=$(o).find("canvas").height(),d=m-u,g=f-s;$(o).css({top:a.top-d+n,height:m,left:a.left-g+t,width:f,visibility:"visible"}),$(o).find("canvas").css({top:0,left:0})})},scrollAdaptOfpostil:function(){let e=this,n=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let l=e.freezenhorizontaldata[0],o=e.freezenverticaldata[0],a=n-e.freezenhorizontaldata[2],s=t-e.freezenverticaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(u,f){let m=$(f).attr("id"),d=m.split("luckysheet-postil-show_")[1].split("_")[0],g=m.split("luckysheet-postil-show_")[1].split("_")[1],b=h.flowdata[d][g].ps,y=h.visibledatarow[d],p=d-1==-1?0:h.visibledatarow[d-1],x=h.visibledatacolumn[g],_=g-1==-1?0:h.visibledatacolumn[g-1],S=ht.mergeborer(h.flowdata,d,g);S&&(y=S.row[1],p=S.row[0],x=S.column[1],_=S.column[0]);let I=x,O=p,F=b.left==null?I+18:b.left,D=b.top==null?O-18:b.top,k=b.width==null?Nt.defaultWidth:b.width,w=b.height==null?Nt.defaultHeight:b.height;D<0&&(D=2);let C=Nt.getArrowCanvasSize(F,D,I,O),T=!0,z=!0;d>=e.freezenhorizontaldata[1]?D+w<l?($(f).show().find(".luckysheet-postil-show-main").css("top",D+a),$(f).show().find(".arrowCanvas").css("top",C[1]+a)):D<l+a?D+w<=l+a?T=!1:($(f).show().find(".luckysheet-postil-show-main").css({top:l+a,height:w-(l+a-D)}),$(f).show().find(".formulaInputFocus").css("margin-top",-(l+a-D)),$(f).show().find(".arrowCanvas").hide(),z=!1):($(f).show().find(".luckysheet-postil-show-main").css({top:D,height:w}),$(f).show().find(".formulaInputFocus").css("margin-top",0),$(f).show().find(".arrowCanvas").css("top",C[1])):($(f).show().find(".luckysheet-postil-show-main").css("top",D+a),$(f).show().find(".arrowCanvas").css("top",C[1]+a)),g>=e.freezenverticaldata[1]?F+k<o?($(f).show().find(".luckysheet-postil-show-main").css("left",F+s),$(f).show().find(".arrowCanvas").css("left",C[0]+s)):F<o+s?F+k<=o+s?T=!1:($(f).show().find(".luckysheet-postil-show-main").css({left:o+s,width:k-(o+s-F)}),$(f).show().find(".formulaInputFocus").css("margin-left",-(o+s-F)),$(f).show().find(".arrowCanvas").hide(),z=!1):($(f).show().find(".luckysheet-postil-show-main").css({left:F,width:k}),$(f).show().find(".formulaInputFocus").css("margin-left",0),$(f).show().find(".arrowCanvas").css("left",C[0])):($(f).show().find(".luckysheet-postil-show-main").css("left",F+s),$(f).show().find(".arrowCanvas").css("left",C[0]+s)),T||$(f).hide(),T&&z&&$(f).show().find(".arrowCanvas").show()})}else if(e.freezenhorizontaldata!=null){let l=e.freezenhorizontaldata[0],o=n-e.freezenhorizontaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(a,s){let u=$(s).attr("id"),f=u.split("luckysheet-postil-show_")[1].split("_")[0],m=u.split("luckysheet-postil-show_")[1].split("_")[1],d=h.flowdata[f][m].ps,g=h.visibledatarow[f],b=f-1==-1?0:h.visibledatarow[f-1],y=h.visibledatacolumn[m],p=m-1==-1?0:h.visibledatacolumn[m-1],x=ht.mergeborer(h.flowdata,f,m);x&&(g=x.row[1],b=x.row[0],y=x.column[1],p=x.column[0]);let _=y,S=b,I=d.left==null?_+18:d.left,O=d.top==null?S-18:d.top,F=d.width==null?Nt.defaultWidth:d.width,D=d.height==null?Nt.defaultHeight:d.height;O<0&&(O=2);let k=Nt.getArrowCanvasSize(I,O,_,S);f>=e.freezenhorizontaldata[1]?O+D<l?($(s).show().find(".luckysheet-postil-show-main").css("top",O+o),$(s).show().find(".arrowCanvas").css("top",k[1]+o)):O<l+o?O+D<=l+o?$(s).hide():($(s).show().find(".luckysheet-postil-show-main").css({top:l+o,height:D-(l+o-O)}),$(s).show().find(".formulaInputFocus").css("margin-top",-(l+o-O)),$(s).show().find(".arrowCanvas").hide()):Nt.buildPs(f,m,d):($(s).show().find(".luckysheet-postil-show-main").css("top",O+o),$(s).show().find(".arrowCanvas").css("top",k[1]+o))})}else if(e.freezenverticaldata!=null){let l=e.freezenverticaldata[0],o=t-e.freezenverticaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(a,s){let u=$(s).attr("id"),f=u.split("luckysheet-postil-show_")[1].split("_")[0],m=u.split("luckysheet-postil-show_")[1].split("_")[1],d=h.flowdata[f][m].ps,g=h.visibledatarow[f],b=f-1==-1?0:h.visibledatarow[f-1],y=h.visibledatacolumn[m],p=m-1==-1?0:h.visibledatacolumn[m-1],x=ht.mergeborer(h.flowdata,f,m);x&&(g=x.row[1],b=x.row[0],y=x.column[1],p=x.column[0]);let _=y,S=b,I=d.left==null?_+18:d.left,O=d.top==null?S-18:d.top,F=d.width==null?Nt.defaultWidth:d.width,D=d.height==null?Nt.defaultHeight:d.height;O<0&&(O=2);let k=Nt.getArrowCanvasSize(I,O,_,S);m>=e.freezenverticaldata[1]?I+F<l?($(s).show().find(".luckysheet-postil-show-main").css("left",I+o),$(s).show().find(".arrowCanvas").css("left",k[0]+o)):I<l+o?I+F<=l+o?$(s).hide():($(s).show().find(".luckysheet-postil-show-main").css({left:l+o,width:F-(l+o-I)}),$(s).show().find(".formulaInputFocus").css("margin-left",-(l+o-I)),$(s).show().find(".arrowCanvas").hide()):Nt.buildPs(f,m,d):($(s).show().find(".luckysheet-postil-show-main").css("left",I+o),$(s).show().find(".arrowCanvas").css("left",k[0]+o))})}else $("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(l,o){let a=$(o).attr("id"),s=a.split("luckysheet-postil-show_")[1].split("_")[0],u=a.split("luckysheet-postil-show_")[1].split("_")[1],f=h.flowdata[s][u].ps;Nt.buildPs(s,u,f)})},scrollAdaptOfdpicon:function(){let e=this,n=Tr.copyRange.row[1],t=Tr.copyRange.column[1],l=Tr.applyRange.row[1],o=Tr.applyRange.column[1],a,s;if(l>=n&&o>=t?(a=l,s=o):(a=n,s=t),e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let u=e.freezenhorizontaldata[1],f=al(e.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-e.freezenhorizontaldata[2]),m=e.freezenverticaldata[1],d=al(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);if(a>=u&&s>=m)a<u+f-1||s<m+d-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else if(a>=u)if(a<u+f-1)$("#luckysheet-dropCell-icon").hide();else{let g=Vl(s+d)[1];$("#luckysheet-dropCell-icon").show().css("left",g)}else if(s>=m)if(s<m+d-1)$("#luckysheet-dropCell-icon").hide();else{let g=$r(a+f)[1];$("#luckysheet-dropCell-icon").show().css("top",g)}else{let g=$r(a+f)[1],b=Vl(s+d)[1];$("#luckysheet-dropCell-icon").show().css({left:b,top:g})}}else if(e.freezenhorizontaldata!=null){let u=e.freezenhorizontaldata[1],f=al(e.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-e.freezenhorizontaldata[2]);if(a>=u)a<u+f-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else{let m=$r(a+f)[1];$("#luckysheet-dropCell-icon").show().css("top",m)}}else if(e.freezenverticaldata!=null){let u=e.freezenverticaldata[1],f=al(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);if(s>=u)s<u+f-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else{let m=Vl(s+f)[1];$("#luckysheet-dropCell-icon").show().css("left",m)}}else{let u=$r(a)[1],f=Vl(s)[1];$("#luckysheet-dropCell-icon").show().css({left:f,top:u})}},scrollAdaptOffilteroptions:function(){let e=this;if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let n=e.freezenhorizontaldata[1],t=e.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop(),l=e.freezenverticaldata[1],o=al(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(a,s){let u=$(s).data("str"),f=u-1==-1?0:h.visibledatarow[u-1],m=$(s).data("cindex");if(u>=n&&m>=l)f<t||m<l+o?$(s).hide():$(s).show();else if(u>=n)if(f<t)$(s).hide();else{let d=h.visibledatacolumn[m+o]-20;$(s).show().css("left",d)}else if(m>=l)m<l+o?$(s).hide():$(s).show().css("top",f+$("#luckysheet-cell-main").scrollTop());else{let d=h.visibledatacolumn[m+o]-20;$(s).show().css({left:d,top:f+$("#luckysheet-cell-main").scrollTop()})}})}else if(e.freezenhorizontaldata!=null){let n=e.freezenhorizontaldata[1],t=e.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop();$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(l,o){let a=$(o).data("str"),s=a-1==-1?0:h.visibledatarow[a-1];a>=n?s<t?$(o).hide():$(o).show():$(o).show().css("top",s+$("#luckysheet-cell-main").scrollTop())})}else if(e.freezenverticaldata!=null){let n=e.freezenverticaldata[1],t=al(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(l,o){let a=$(o).data("cindex");if(a>=n)a<n+t?$(o).hide():$(o).show();else{let s=h.visibledatacolumn[a+t]-20;$(o).show().css("left",s)}})}else $("#luckysheet-filter-options-sheet"+h.currentSheetIndex).empty(),Bn(h.luckysheetfile[$e(h.currentSheetIndex)].filter_select)},saveFrozen:function(e,n,t={}){n==null&&(n=$e(h.currentSheetIndex));let l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],o=l.row_focus==null?l.row[0]:l.row_focus,a=l.column_focus==null?l.column[0]:l.column_focus,s={row_focus:t.row_focus||o,column_focus:t.column_focus||a},u={freezenRow:{type:"row"},freezenColumn:{type:"column"},freezenRC:{type:"both"},freezenRowRange:{type:"rangeRow",range:s},freezenColumnRange:{type:"rangeColumn",range:s},freezenRCRange:{type:"rangeBoth",range:s},freezenCancel:{type:"cancel"}};h.luckysheetfile[n].frozen=u[e]},frozenTofreezen:function(){let e=h.luckysheetfile[$e(h.currentSheetIndex)],n=e.frozen;if(n==null)return;let t=null;if(n.type==="row"){let l=0,o=al(h.visibledatarow,l);o==-1&&(o=0);let a=h.visibledatarow[o]-2-l+h.columnHeaderHeight;t={horizontal:{freezenhorizontaldata:[h.visibledatarow[o],o+1,l,ta.cutVolumn(h.visibledatarow,o+1),a],top:a}}}else if(n.type==="column"){let l=0,o=al(h.visibledatacolumn,l);o==-1&&(o=0);let a=h.visibledatacolumn[o]-2-l+h.rowHeaderWidth;t={vertical:{freezenverticaldata:[h.visibledatacolumn[o],o+1,l,ta.cutVolumn(h.visibledatacolumn,o+1),a],left:a}}}else if(n.type==="both"){let l=0,o=al(h.visibledatarow,l);o==-1&&(o=0);let a=h.visibledatarow[o]-2-l+h.columnHeaderHeight,s=[h.visibledatarow[o],o+1,l,ta.cutVolumn(h.visibledatarow,o+1),a],u=0,f=al(h.visibledatacolumn,u);f==-1&&(f=0);let m=h.visibledatacolumn[f]-2-u+h.rowHeaderWidth,d=[h.visibledatacolumn[f],f+1,u,ta.cutVolumn(h.visibledatacolumn,f+1),m];t={horizontal:{freezenhorizontaldata:s,top:a},vertical:{freezenverticaldata:d,left:m}}}else if(n.type==="rangeRow"){let l=0,o=al(h.visibledatarow,l),a=n.range.row_focus;a>o&&(o=a),o==-1&&(o=0);let s=h.visibledatarow[o]-2-l+h.columnHeaderHeight;t={horizontal:{freezenhorizontaldata:[h.visibledatarow[o],o+1,l,ta.cutVolumn(h.visibledatarow,o+1),s],top:s}}}else if(n.type==="rangeColumn"){let l=0,o=al(h.visibledatacolumn,l),a=n.range.column_focus;a>o&&(o=a),o==-1&&(o=0);let s=h.visibledatacolumn[o]-2-l+h.rowHeaderWidth;t={vertical:{freezenverticaldata:[h.visibledatacolumn[o],o+1,l,ta.cutVolumn(h.visibledatacolumn,o+1),s],left:s}}}else if(n.type==="rangeBoth"){let l=0,o=al(h.visibledatarow,l),a=n.range.row_focus;a>o&&(o=a),o==-1&&(o=0);let s=h.visibledatarow[o]-2-l+h.columnHeaderHeight,u=[h.visibledatarow[o],o+1,l,ta.cutVolumn(h.visibledatarow,o+1),s],f=0,m=al(h.visibledatacolumn,f),d=n.range.column_focus;d>m&&(m=d),m==-1&&(m=0);let g=h.visibledatacolumn[m]-2-f+h.rowHeaderWidth,b=[h.visibledatacolumn[m],m+1,f,ta.cutVolumn(h.visibledatacolumn,m+1),g];t={horizontal:{freezenhorizontaldata:u,top:s},vertical:{freezenverticaldata:b,left:g}}}else n.type==="cancel"&&(t={horizontal:null,vertical:null});e.freezen=t}},we=ta});function Kl(e=!0){lt.showinfobar?($("#luckysheet_info_detail").show(),h.infobarHeight=document.querySelector("#luckysheet_info_detail").offsetHeight):(h.infobarHeight=0,$("#luckysheet_info_detail").hide()),!!h.toobarObject&&!!h.toobarObject.toobarElements&&h.toobarObject.toobarElements.length===0?($("#"+h.container).find(".luckysheet-wa-editor").hide(),h.toolbarHeight=0):($("#"+h.container).find(".luckysheet-wa-editor").show(),h.toolbarHeight=document.querySelector("#"+h.container+" .luckysheet-wa-editor").offsetHeight),Wx(),Ux();let n=document.querySelector("#"+h.container+" .luckysheet-wa-calculate");lt.sheetFormulaBar?(n.style.display="block",h.calculatebarHeight=n.offsetHeight):(n.style.display="none",h.calculatebarHeight=0),$("#"+h.container).find(".luckysheet-grid-container").css("top",h.toolbarHeight+h.infobarHeight+h.calculatebarHeight),Ja=$("#"+h.container).width(),lt.showConfigWindowResize&&($("#luckysheet-modal-dialog-slider-pivot").is(":visible")?Ja-=$("#luckysheet-modal-dialog-slider-pivot").outerWidth():$(".chartSetting").is(":visible")?Ja-=$(".chartSetting").outerWidth():$("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")&&(Ja-=$("#luckysheet-modal-dialog-slider-alternateformat").outerWidth()),$("#luckysheet-modal-dialog-slider-protection").is(":visible")&&(Ja-=$("#luckysheet-modal-dialog-slider-protection").outerWidth()));let l=Oe().toolbar,o=!1,a=0,s=`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${l.toolMoreTip}" id="luckysheet-icon-morebtn" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;">

                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                        ${l.toolMore}
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige" style="user-select: none;font-size:12px;">
                    </div>

                </div>
            </div>
         </div>`,u='<div id="luckysheet-icon-morebtn-div" class="luckysheet-wa-editor" style="position:absolute;top:'+(h.infobarHeight+h.toolbarHeight+$("#"+h.container).offset().top+$("body").first().scrollTop())+'px;right:0px;z-index:1003;padding:5.5px;visibility:hidden;height:auto;white-space:initial;"></div>';$("#luckysheet-icon-morebtn-div").length==0&&$("body").first().append(u),jt("#luckysheet-icon-morebtn-div").style.visibility="hidden",$("#luckysheet-icon-morebtn-div > div").each(function(){let g=$(this)[0],b=$("#luckysheet-wa-editor")[0];b.appendChild(document.createTextNode(" ")),b.appendChild(g)}),$("#luckysheet-icon-morebtn").remove();let f=h.toobarObject.toobarWidths,m=h.toobarObject.toobarElements,d=0;if(f!=null){for(let g=f.length-1;g>=0;g--)if(f[g]<Ja-90){d=g,d<f.length-1&&(o=!0);break}for(let g=d;g<m.length;g++){let b=m[g];if(b instanceof Array)for(let y of b)$("#luckysheet-icon-morebtn-div").append($(`${y}`));else $("#luckysheet-icon-morebtn-div").append($(`${b}`))}o&&($("#luckysheet-wa-editor").append(s),$("#luckysheet-icon-morebtn").click(function(){jt("#luckysheet-icon-morebtn-div").style.left="";let g=jt(`#${h.container}`).getBoundingClientRect?jt(`#${h.container}`).getBoundingClientRect().left:0;jt("#luckysheet-icon-morebtn-div").getBoundingClientRect().left<g&&(jt("#luckysheet-icon-morebtn-div").style.left=g+"px");let y=$(window).width()-$("#luckysheet-icon-morebtn").offset().left-$("#luckysheet-icon-morebtn").width()+$("body").first().scrollLeft();if(jt("#luckysheet-icon-morebtn-div").style.right=y<0?0:y+"px",jt("#luckysheet-icon-morebtn-div").style.visibility==="hidden"?jt("#luckysheet-icon-morebtn-div").style.visibility="visible":jt("#luckysheet-icon-morebtn-div").style.visibility="hidden",$(this).find(".luckysheet-toolbar-menu-button-caption").text().indexOf(l.toolMore)>-1){let x=`
                <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                    ${l.toolClose}
                </div>
                <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-shangyige" style="user-select: none;font-size:12px;">
                </div>
                `;$(this).find(".luckysheet-toolbar-button-inner-box").html(x)}else{let x=`
                <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                    ${l.toolMore}
                </div>
                <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige" style="user-select: none;font-size:12px;">
                </div>
                `;$(this).find(".luckysheet-toolbar-button-inner-box").html(x)}}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")}),de.createHoverTip("#luckysheet-icon-morebtn-div",".luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button")),$("#"+h.container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#"+h.container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")}),Om=$("#"+h.container).height(),$("#"+h.container).find(".luckysheet").height(Om-2).width(Ja-2),Pm(Ja,Om),e&&Et($("#luckysheet-cell-main").scrollLeft(),$("#luckysheet-cell-main").scrollTop()),ct.sheetArrowShowAndHide(),ct.sheetBarShowAndHide()}}function Pm(e,n){e==null&&(e=$("#"+h.container).width()),n==null&&(n=$("#"+h.container).height()),h.cellmainHeight=n-(h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight+h.sheetBarHeight+h.statisticBarHeight),h.cellmainWidth=e-h.rowHeaderWidth,$("#luckysheet-cols-h-c, #luckysheet-cell-main").width(h.cellmainWidth),$("#luckysheet-cell-main").height(h.cellmainHeight),$("#luckysheet-rows-h").height(h.cellmainHeight-h.cellMainSrollBarSize),$("#luckysheet-scrollbar-y").height(h.cellmainHeight+h.columnHeaderHeight-h.cellMainSrollBarSize-3),$("#luckysheet-scrollbar-x").height(h.cellMainSrollBarSize),$("#luckysheet-scrollbar-y").width(h.cellMainSrollBarSize),$("#luckysheet-scrollbar-x").width(h.cellmainWidth).css("left",h.rowHeaderWidth-2),h.luckysheetTableContentHW=[h.cellmainWidth+h.rowHeaderWidth-h.cellMainSrollBarSize,h.cellmainHeight+h.columnHeaderHeight-h.cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(h.luckysheetTableContentHW[0]*h.devicePixelRatio),height:Math.ceil(h.luckysheetTableContentHW[1]*h.devicePixelRatio)}).css({width:h.luckysheetTableContentHW[0],height:h.luckysheetTableContentHW[1]}),$("#"+h.container).find("#luckysheet-grid-window-1").css("bottom",h.sheetBarHeight),$("#"+h.container).find(".luckysheet-grid-window").css("bottom",h.statisticBarHeight);let t=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:t-10}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:t-10});let l=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:l-10}).end().find(".luckysheet-freezebar-vertical-drop").css({height:l-10}),we.createAssistCanvas()}function Ey(){let e=lt.showtoolbar,n=lt.showtoolbarConfig,t=h.toobarObject.toobarWidths=[],l=h.toobarObject.toobarElements=[],o=h.toobarObject.toolbarConfig=a();function a(){let f={};function m(g){let b={},y,p,x=0;for(let _=0;_<g.length;_++)y=g[_],p=g[_+1],y!=="|"&&(b[y]={ele:Bd[y],index:x++}),p==="|"&&(V(b[y].ele)==="array"?b[y].ele.push(`#toolbar-separator-${Pa(y)}`):b[y].ele=[b[y].ele,`#toolbar-separator-${Pa(y)}`]);return b}if(V(n)==="array")return e?m(n):f;let d=yo.reduce(function(g,b){return b!=="|"&&(g[b]=!0),g},{});if(!e)for(let g in d)d[g]=!1;if(JSON.stringify(n)!=="{}"){n.hasOwnProperty("undoRedo")&&(d.undo=d.redo=n.undoRedo),Object.assign(d,n);let g,b,y=0;for(let p=0;p<yo.length;p++)g=yo[p],b=yo[p+1],d[g]!==!1&&(g!=="|"&&d[g]&&(f[g]={ele:Bd[g],index:y++}),b==="|"&&(V(f[g].ele)==="array"?f[g].ele.push(`#toolbar-separator-${Pa(g)}`):f[g].ele=[f[g].ele,`#toolbar-separator-${Pa(g)}`]))}else f=e?m(yo):{};return f}for(let f in o)Object.prototype.hasOwnProperty.call(o,f)&&l.push($.extend(!0,{},o[f]));l.sort(s);function s(f,m){return f.index>m.index?1:-1}l.forEach((f,m,d)=>{d[m]=f.ele,m!==l.length-1?f.ele instanceof Array?t.push($(f.ele[0]).offset().left):t.push($(f.ele).offset().left):f.ele instanceof Array?(t.push($(f.ele[0]).offset().left),t.push($(f.ele[0]).offset().left+$(f.ele[0]).outerWidth()+5)):(t.push($(f.ele).offset().left),t.push($(f.ele).offset().left+$(f.ele).outerWidth()+5))});let u=$("#"+h.container).offset().left;t.forEach((f,m)=>{t[m]-=u})}function Wx(){if(!lt.initShowsheetbarConfig){lt.initShowsheetbarConfig=!0;let t={add:!0,menu:!0,sheet:!0};if(!lt.showsheetbar)for(let l in t)t[l]=!1;JSON.stringify(lt.showsheetbarConfig)!=="{}"&&Object.assign(t,lt.showsheetbarConfig),lt.showsheetbarConfig=t}let e=lt.showsheetbarConfig,n=0;for(let t in e)if(!e[t])switch(t){case"add":$("#luckysheet-sheets-add").hide(),n++;break;case"menu":$("#luckysheet-sheets-m").hide(),n++;break;case"sheet":$("#luckysheet-sheet-container").hide(),$("#luckysheet-sheets-leftscroll").hide(),$("#luckysheet-sheets-rightscroll").hide(),n++;break;default:break}n===3?($("#"+h.container).find("#luckysheet-sheet-area").hide(),h.sheetBarHeight=0):($("#"+h.container).find("#luckysheet-sheet-area").show(),h.sheetBarHeight=31)}function Ux(){if(!lt.initStatisticBarConfig){lt.initStatisticBarConfig=!0;let t={count:!0,view:!0,zoom:!0};if(!lt.showstatisticBar)for(let l in t)t[l]=!1;JSON.stringify(lt.showstatisticBarConfig)!=="{}"&&Object.assign(t,lt.showstatisticBarConfig),lt.showstatisticBarConfig=t}let e=lt.showstatisticBarConfig,n=0;for(let t in e)if(!e[t])switch(t){case"count":$("#luckysheet-sta-content").hide(),n++;break;case"view":$(".luckysheet-print-viewList").hide(),n++;break;case"zoom":$("#luckysheet-zoom-content").hide(),n++;break;default:break}n===3?($("#"+h.container).find(".luckysheet-stat-area").hide(),h.statisticBarHeight=0):($("#"+h.container).find(".luckysheet-stat-area").show(),h.statisticBarHeight=23)}var import_plugin,Ja,Om,Bi=Tt(()=>{import_plugin=Le(Be());bn();li();fr();Ut();Rl();Yr();Sr();gl();jd();Ja=0,Om=0});function Vy(e){let n=Oe(),t=n.protection,l=n.button,o=e.name,a=e.sqref,s=e.password,u="";s!=null&&s.length>0&&(u='<i class="icon iconfont luckysheet-iconfont-bianji2" title="'+t.rangeItemHasPassword+'"></i>');let f=`
        <div class="luckysheet-protection-rangeItem" title="${t.rangeItemDblclick}">
            <div class="luckysheet-protection-rangeItem-del" title="${l.delete}">
                <i class="icon iconfont luckysheet-iconfont-shanchu"></i>
            </div>
            <div class="luckysheet-protection-rangeItem-name" title="${o}">
                ${o}${u}
            </div>
            <div class="luckysheet-protection-rangeItem-range" title="${a}">
                ${a}
            </div>
            <div class="luckysheet-protection-rangeItem-update" title="${l.update}">
                <i class="icon iconfont luckysheet-iconfont-bianji"></i>
            </div>
        </div>
    `;$("#luckysheet-protection-rangeItem-container").append(f)}function Gx(e){let n=Oe(),t=n.protection,l=n.button;$("#luckysheet-slider-protection-ok").click(function(){let o=$("#protection-password").val(),a=$("#protection-swichProtectionState").is(":checked"),s=$("#protection-hint").val(),u=By,f={};u!=null&&u.config!=null&&u.config.authority!=null&&(f=u.config.authority);let m={},d="None";o!="\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"?(m.password=o,m.algorithmName="None",m.saltValue=null):f!=null?(m.algorithmName=f.algorithmName,m.saltValue=f.saltValue,m.password=f.password):(m.algorithmName="None",m.saltValue=null,m.password=""),m.hintText=s,m.sheet=a==!0?1:0;for(let g=0;g<Rc.length;g++){let b=Rc[g],y="luckysheet-protection-check-"+b,p=$("#"+y).is(":checked");m[b]=p==!0?1:0}m.allowRangeList=la,la=[],Nm=!0,u.config==null&&(u.config={}),u.config.authority=m,Lm={},Gy()}),$("#luckysheet-slider-protection-cancel, #luckysheet-modal-dialog-protection-close").click(function(){Gy()}),$("#luckysheet-slider-protection-addRange").click(function(){Wy(),Em=!0,$("#luckysheet-protection-rangeItem-confirm").html(l.insert),Ds("luckysheet-protection-rangeItem-dialog"),$("#protection-allowRangeAdd-title").val("Default"+la.length),$("#protection-allowRangeAdd-range input").val(""),$("#protection-allowRangeAdd-password").val(""),$("#protection-allowRangeAdd-hint").val("")}),$(document).off("click.luckysheetProtection.rangeItemUpdate").on("click.luckysheetProtection.rangeItemUpdate","#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-update",function(o){Wy(),Em=!1,$("#luckysheet-protection-rangeItem-confirm").html(l.update),Ds("luckysheet-protection-rangeItem-dialog");let a=$(o.target).closest(".luckysheet-protection-rangeItem"),u=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").index(a),f=la[u];Hy=u,$("#protection-allowRangeAdd-title").val(f.name),$("#protection-allowRangeAdd-range input").val(f.sqref),f.algorithmName=="None"?$("#protection-allowRangeAdd-password").val(f.password):$("#protection-allowRangeAdd-password").val("\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"),$("#protection-allowRangeAdd-hint").val(f.hintText)}),$(document).off("click.luckysheetProtection.rangeItemDelete").on("click.luckysheetProtection.rangeItemDelete","#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-del",function(o){let a=$(o.target).closest(".luckysheet-protection-rangeItem"),u=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").index(a),f=la[u];la.splice(u,1),a.remove()}),$(document).off("click.luckysheetProtection.rangeItemConfirm").on("click.luckysheetProtection.rangeItemConfirm","#luckysheet-protection-rangeItem-confirm",function(){let o=$("#protection-allowRangeAdd-title").val(),a=$("#protection-allowRangeAdd-range input").val(),s=$("#protection-allowRangeAdd-password").val(),u=$("#protection-allowRangeAdd-hint").val();if(o.length==0){alert(t.rangeItemErrorTitleNull);return}let f=Vt.getRangeByTxt(a);if(a.length==0){alert(t.rangeItemErrorRangeNull);return}if(f.length==0){alert(t.rangeItemErrorRange);return}if(a=Yy(a),Em){let m={name:o,password:s,hintText:u,algorithmName:"None",saltValue:null,checkRangePasswordUrl:null,sqref:a};Vy(m),la.push(m)}else{let m=Hy,d=la[m];d.name=o,d.sqref=a,d.hintText=u,s!="\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"&&(d.password=s,d.algorithmName="None");let b=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").eq(m),y=b.find(".luckysheet-protection-rangeItem-name"),p="";s!=null&&s.length>0&&(p='<i class="icon iconfont luckysheet-iconfont-bianji2" title="'+t.rangeItemHasPassword+'"></i>'),y.html(o+p).attr("title",o),b.find(".luckysheet-protection-rangeItem-range").html(a).attr("title",a)}$("#luckysheet-protection-rangeItem-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide()}),$(document).off("click.luckysheetProtection.validationConfirm").on("click.luckysheetProtection.validationConfirm","#luckysheet-protection-sheet-validation-confirm",function(o){let a=$("#luckysheet-protection-sheet-validation"),s=mh;if(s==null){Hm(mh),a.hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-protection").show(),Kl();return}let f=a.find("input").val();if(f==null||f.length==0){alert(t.checkPasswordNullalert);return}if(s.algorithmName!=null&&s.algorithmName!="None")if(s.saltValue!=null&&s.saltValue.length>0){var m=CryptoApi.getHasher(s.algorithmName);f=CryptoApi.hmac(s.saltValue,f,m)}else f=CryptoApi.hash(s.algorithmName,f);f==s.password?(Hm(mh),a.hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-protection").show(),Kl(),Nm=!1):alert(t.checkPasswordWrongalert)}),$("#luckysheet-protection-check-selectLockedCells").change(function(){let o=$("#luckysheet-protection-check-selectLockedCells"),a=$("#luckysheet-protection-check-selectunLockedCells"),s=o.is(":checked"),u=a.is(":checked");s&&a.prop("checked",!0)}),$("#luckysheet-protection-check-selectunLockedCells").change(function(){let o=$("#luckysheet-protection-check-selectLockedCells"),a=$("#luckysheet-protection-check-selectunLockedCells"),s=o.is(":checked");a.is(":checked")||o.prop("checked",!1)}),$(document).off("click.luckysheetProtection.dvRange").on("click.luckysheetProtection.dvRange","#protection-allowRangeAdd-range .fa-table",function(o){$("#luckysheet-protection-rangeItem-dialog").hide();let a="0",s=$(this).siblings("input").val().trim();Vt.rangeDialog(a,s),Vt.selectRange=[];let u=Vt.getRangeByTxt(s);if(u.length>0)for(let f=0;f<u.length;f++){let m=u[f].row[0],d=u[f].row[1],g=u[f].column[0],b=u[f].column[1],y=h.visibledatarow[d],p=m-1==-1?0:h.visibledatarow[m-1],x=h.visibledatacolumn[b],_=g-1==-1?0:h.visibledatacolumn[g-1];Vt.selectRange.push({left:_,width:x-_-1,top:p,height:y-p-1,left_move:_,width_move:x-_-1,top_move:p,height_move:y-p-1,row:[m,d],column:[g,b],row_focus:m,column_focus:g})}Jl(Vt.selectRange)}),$(document).off("click.luckysheetProtection.dvRange2").on("click.luckysheetProtection.dvRange2","#luckysheet-protection-rangeItem-dialog .show-box-item-dropdown .range .fa-table",function(o){$("#luckysheet-protection-rangeItem-dialog").hide();let a="1",s=$(this).siblings("input").val().trim();Vt.rangeDialog(a,s),Vt.selectRange=[];let u=Vt.getRangeByTxt(s);if(u.length>0)for(let f=0;f<u.length;f++){let m=u[f].row[0],d=u[f].row[1],g=u[f].column[0],b=u[f].column[1],y=h.visibledatarow[d],p=m-1==-1?0:h.visibledatarow[m-1],x=h.visibledatacolumn[b],_=g-1==-1?0:h.visibledatacolumn[g-1];Vt.selectRange.push({left:_,width:x-_-1,top:p,height:y-p-1,left_move:_,width_move:x-_-1,top_move:p,height_move:y-p-1,row:[m,d],column:[g,b],row_focus:m,column_focus:g})}Jl(Vt.selectRange)}),$(document).off("click.luckysheetProtection.dvRangeConfirm").on("click.luckysheetProtection.dvRangeConfirm","#luckysheet-dataVerificationRange-dialog-confirm",function(o){let a=$(this).parents("#luckysheet-dataVerificationRange-dialog").find("input").val(),s=$("#protection-allowRangeAdd-range input"),u=s.val();u.substr(u.length-1,1)==","?s.val(u+a):s.val(a),$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),Jl([])}),$(document).off("click.luckysheetProtection.dvRangeClose").on("click.dvRangeClose","#luckysheet-dataVerificationRange-dialog-close",function(o){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),Jl([])}),$(document).on("click.luckysheetProtection.luckysheetProtection","#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close",function(o){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),Jl([])})}function Wy(e){if(Ly)return;Ly=!0;let n=Oe(),t=n.protection,l=n.button;$("body").first().append(yt(kl,{id:"luckysheet-protection-rangeItem-dialog",addclass:"luckysheet-protection-rangeItem-dialog",title:t.allowRangeTitle,content:`
            <div class="luckysheet-protection-rangeItem-content">
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddTitle}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <input class="luckysheet-protection-rangeItemiInput" id="protection-allowRangeAdd-title"  placeHolder="${t.allowRangeAddtitleDefault}">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddSqrf}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <div id="protection-allowRangeAdd-range" class="range">
                            <input class="formulaInputFocus" spellcheck="false" placeHolder="${t.selectCellRangeHolder}">
                            <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>
                        </div>
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddTitlePassword}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <input class="luckysheet-protection-rangeItemiInput" id="protection-allowRangeAdd-password"  placeHolder="${t.enterPassword}">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddTitleHint}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <textarea class="luckysheet-protection-rangeItemTextarea" id="protection-allowRangeAdd-hint"  placeHolder="${t.allowRangeAddTitleHintTitle}"></textarea>
                    </div>
                </div>
            </div>
        `,botton:`<button id="luckysheet-protection-rangeItem-confirm" class="btn btn-primary">${l.insert}</button>
                    <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:100003"}))}function Yx(e){let n=Oe(),t=n.protection,l=n.button,o="";for(let s=0;s<Rc.length;s++){let u=Rc[s];o+=`
            <div class="luckysheet-slider-protection-row" style="height:18px;">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                <label for="luckysheet-protection-check-${u}"><input id="luckysheet-protection-check-${u}" name="luckysheet-protection-check-${u}" type="checkbox">${t[u]}</label>
                </div>
            </div>
        `}let a=`
    <div id="luckysheet-modal-dialog-slider-protection" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot" style="display:none;">
        <div class="luckysheet-modal-dialog-slider-title"> <span>${t.protectiontTitle}</span> <span id="luckysheet-modal-dialog-protection-close" title="${l.close}"><i class="fa fa-times" aria-hidden="true"></i></span> </div>
        <div class="luckysheet-modal-dialog-slider-content">
            <div class="luckysheet-slider-protection-config" style="top:10px;height:115px">
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    <label for="protection-swichProtectionState"><input id="protection-swichProtectionState" name="protection-swichProtectionState" type="checkbox">${t.swichProtectionTip}</label>
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="height:23px;">
                    <div class="luckysheet-slider-protection-column" style="width:98%;">
                        <input class="luckysheet-protection-input" id="protection-password"  placeHolder="${t.enterPassword}">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="height:47px;margin-top:4px;">
                    <div class="luckysheet-slider-protection-column" style="width:98%;">
                        <textarea class="luckysheet-protection-textarea" id="protection-hint"  placeHolder="${t.enterHint}"></textarea>
                    </div>
                </div>
            </div>
            <div class="luckysheet-slider-protection-config" style="top:130px;height:290px;border-top:1px solid #c5c5c5">
                <div class="luckysheet-slider-protection-row" style="height:20px;">
                    ${t.authorityTitle}
                </div>
                ${o}
            </div>
            <div class="luckysheet-slider-protection-config" style="top:440px;bottom:45px;border-top:1px solid #c5c5c5">
                <div class="luckysheet-slider-protection-row" style="height:25px;">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:0px;line-height: 25px;">
                        ${t.allowRangeTitle}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x" style="left:70%;">
                        <div class="luckysheet-slider-protection-ok luckysheet-slider-protection-addRange" id="luckysheet-slider-protection-addRange">
                            ${t.allowRangeAdd}
                        </div>
                    </div>
                </div>

                <div id="luckysheet-protection-rangeItem-container" class="luckysheet-slider-protection-row" style="top:25px;bottom:0px;position:absolute">
                   
                </div>
            </div>
            <div class="luckysheet-slider-protection-config" style="bottom:0px;height:45px">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-5x" style="left:0px;">
                    <div class="luckysheet-slider-protection-ok" id="luckysheet-slider-protection-ok">
                        ${l.confirm}
                    </div>
                </div>
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-5x" style="left:50%;">
                    <div class="luckysheet-slider-protection-cancel" id="luckysheet-slider-protection-cancel">
                        ${l.cancel}
                    </div>
                </div>
            </div>
        </div>
    </div>
    `;$("body").first().append(a),$("body").first().append(yt(kl,{id:"luckysheet-protection-sheet-validation",addclass:"luckysheet-protection-sheet-validation",title:t.validationTitle,content:`
            <div class="luckysheet-slider-protection-row">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    ${t.validationTips}
                </div>
            </div>
            <div class="luckysheet-slider-protection-row" style="margin-top:20px">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    <input type="password" class="luckysheet-protection-rangeItemiInput" placeHolder="${t.validationInputHint}">
                </div>
            </div>
        `,botton:`<button id="luckysheet-protection-sheet-validation-confirm" class="btn btn-primary">${l.confirm}</button>
                    <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:100003"}))}function Hm(e){e==null&&(e={});for(let o=0;o<Rc.length;o++){let a=Rc[o],s="luckysheet-protection-check-"+a,u=e[a];u==null&&(u=0),u==null&&a in{selectLockedCells:1,selectunLockedCells:1}&&(u=1),$("#"+s).prop("checked",u==1)}e.password!=null&&e.password.length>0?e.algorithmName=="None"||e.algorithmName==null?$("#protection-password").val(e.password):$("#protection-password").val("\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"):$("#protection-password").val("");let n=e.sheet;e.sheet==null&&(n=0),$("#protection-swichProtectionState").prop("checked",n==1);let t=e.hintText;t==null&&(t=""),$("#protection-hint").val(t),la=[],$("#luckysheet-protection-rangeItem-container").empty();let l=e.allowRangeList;if(l!=null&&l.length>0)for(let o=0;o<l.length;o++){let a=l[o];Vy(a),la.push(a)}}function Uy(e){if(Ny||(Yx(e),Gx(e),Ny=!0),By=e,e!=null&&e.config!=null&&e.config.authority!=null){let n=e.config.authority;if(Nm&&n.sheet==1&&n.password!=null&&n.password.length>0){mh=n,$("#luckysheet-protection-sheet-validation input").val(""),Ds("luckysheet-protection-sheet-validation");return}else Hm(n)}else $("#luckysheet-protection-check-selectLockedCells").prop("checked",!0),$("#luckysheet-protection-check-selectunLockedCells").prop("checked",!0);$("#luckysheet-modal-dialog-slider-protection").show(),Kl()}function Gy(){$("#luckysheet-protection-rangeItem-dialog").hide(),$("#luckysheet-modal-dialog-slider-protection").hide(),Kl()}function Bm(e,n,t,l,o=!0,a=!0){let s=!1,u=t.allowRangeList;if(u!=null&&u.length>0){let f=!1;for(let m=0;m<u.length;m++){let d=u[m],g=d.sqref,b=Vt.getRangeByTxt(g);if(b.length>0)for(let y=0;y<b.length;y++){let p=b[y].row[0],x=b[y].row[1],_=b[y].column[0],S=b[y].column[1];if(e>=p&&e<=x&&n>=_&&n<=S){f=!0;break}}if(f){let y=d.password;if(y!=null&&y.length>0&&!(g in Lm))return o&&(qx(d),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide()),!1;s=!0;break}}}if(!s&&!a&&(s=!0),!s&&o){let f;t.hintText!=null&&t.hintText.length>0?f=t.hintText:f=l.defaultSheetHintText,de.info("",f),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide()}return s}function qx(e){let n=Oe(),t=n.protection,l=n.button;jy||$("body").first().append(yt(kl,{id:"luckysheet-protection-range-validation",addclass:"luckysheet-protection-sheet-validation",title:t.validationTitle,content:`
                <div class="luckysheet-slider-protection-row">
                    <div id="luckysheet-protection-range-validation-hint" class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                        
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="margin-top:20px">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                        <input type="password" class="luckysheet-protection-rangeItemiInput" placeHolder="${t.validationInputHint}">
                    </div>
                </div>
            `,botton:`<button id="luckysheet-protection-range-validation-confirm" class="btn btn-primary">${l.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:100003"})),jy=!0,Ds("luckysheet-protection-range-validation");let o=$("#luckysheet-protection-range-validation-hint");e.hintText!=null&&e.hintText.length>0?o.html(e.hintText):o.html(t.defaultRangeHintText);let a=$("#luckysheet-protection-range-validation"),s=a.find("input");s.val(""),$("#luckysheet-protection-range-validation-confirm").off("click").on("click",function(){let u=s.val();if(u==null||u.length==0){alert(t.checkPasswordNullalert);return}if(e.algorithmName!=null&&e.algorithmName!="None")if(e.saltValue!=null&&e.saltValue.length>0){var f=CryptoApi.getHasher(e.algorithmName);u=CryptoApi.hmac(e.saltValue,u,f)}else u=CryptoApi.hash(e.algorithmName,u);u==e.password?(Lm[e.sqref]=1,a.hide(),$("#luckysheet-modal-dialog-mask").hide(),alert(t.checkPasswordSucceedalert)):alert(t.checkPasswordWrongalert)})}function Ro(e){let n=ct.getSheetByIndex(e);if(n==null||n.config==null||n.config.authority==null)return!0;let t=n.config.authority;if(t==null||t.sheet==null||t.sheet==0)return!0;let o=Oe().protection,a;return t.hintText!=null&&t.hintText.length>0?a=t.hintText:a=o.defaultSheetHintText,de.info("",a),!1}function xa(e,n,t,l=!0,o=!0){let a=ct.getSheetByIndex(t);if(a==null||a.config==null||a.config.authority==null)return!0;let s=a.data,u=s[e][n],f=a.config.authority;if(f==null||f.sheet==null||f.sheet==0||u&&u.lo===0)return!0;let d=Oe().protection;return Bm(e,n,f,d,l,o)}function gh(e,n,t){let l=ct.getSheetByIndex(t);if(!l||l.data&&!l.data[e]||l.data&&!l.data[e][n]||l.config==null||l.config.authority==null)return!0;let o=l.data,a=o[e][n],s=l.config.authority;return s==null||s.sheet==null||s.sheet==0||a==null||a.hi==null||a.hi==0}function Wi(e,n){let t=ct.getSheetByIndex(n);if(t==null||t.config==null||t.config.authority==null)return!0;let l=t.config.authority;if(l==null||l.sheet==null||l.sheet==0||e==null||e.length==0)return!0;let a=Oe().protection;for(let s=0;s<e.length;s++){let u=e[s].row[0],f=e[s].row[1],m=e[s].column[0],d=e[s].column[1];for(let g=u;g<=f;g++)for(let b=m;b<=d;b++){let y=t.data[g][b]||{},p=y.lo===void 0||y.lo===1;if(!Bm(g,b,l,a,!0,p))return!1}}return!0}function jm(e,n,t){let o=Oe().protection,a=ct.getSheetByIndex(t);if(a==null||a.config==null||a.config.authority==null)return!0;let s=a.data,u=s[e][n],f=a.config.authority;return f==null||f.sheet==null||f.sheet==0?!0:u&&u.lo===0||Bm(e,n,f,o,!1)?f.selectunLockedCells==1||f.selectunLockedCells==null:f.selectLockedCells==1||f.selectLockedCells==null}function Eu(e){let t=Oe().protection,l=ct.getSheetByIndex(e);if(l==null||l.config==null||l.config.authority==null)return!0;let o=l.config.authority;if(o==null||o.sheet==null||o.sheet==0)return!0;let a=!1;(o.selectunLockedCells==1||o.selectunLockedCells==null)&&(a=!0);let s=!1;return(o.selectLockedCells==1||o.selectLockedCells==null)&&(s=!0),!!(a&&s)}function ao(e){let n=ct.getSheetByIndex(e);if(n==null||n.config==null||n.config.authority==null)return!0;let t=n.config.authority;if(t==null||t.sheet==null||t.sheet==0||t.formatCells==1||t.formatCells==null)return!0;let o=Oe().protection,a;return t.hintText!=null&&t.hintText.length>0?a=t.hintText:a=o.defaultSheetHintText,de.info("",a),!1}function Hl(e,n="formatColumns",t=!0){let l=ct.getSheetByIndex(e);if(l==null||l.config==null||l.config.authority==null)return!0;let o=l.config.authority;if(o==null||o.sheet==null||o.sheet==0||o[n]==1||o[n]==null)return!0;if(t){let s=Oe().protection,u;o.hintText!=null&&o.hintText.length>0?u=o.hintText:u=s.defaultSheetHintText,de.info("",u)}return!1}var import_plugin,Ny,Ly,la,Em,Hy,mh,By,Nm,Lm,jy,Rc,jn=Tt(()=>{import_plugin=Le(Be());Ut();Rl();ar();ql();Ea();Yr();Bi();Vi();gl();vr();Sr();Io();Ny=!1,Ly=!1,la=[],Em=!0,Hy=null,mh=null,By=null,Nm=!0,Lm={},jy=!1,Rc=["selectLockedCells","selectunLockedCells","formatCells","formatColumns","formatRows","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","filter","usePivotTablereports","editObjects","editScenarios"]});function So(e,n,t){t==null&&(t=!0);let l=function(a,s){let u=a[n],f=s[n];if(V(a[n])=="object"&&(u=a[n].v),V(s[n])=="object"&&(f=s[n].v),rt(u))return 1;if(rt(f))return-1;if(Zl(u)&&Zl(f))return Br(u,f);if(Y(u)&&Y(f))return(0,_a.default)(u).value()-(0,_a.default)(f).value();if(!Y(u)&&!Y(f))return u.localeCompare(f,"zh");if(Y(u)){if(!Y(f))return-1}else return 1},o=function(a,s){let u=a[n],f=s[n];if(V(a[n])=="object"&&(u=a[n].v),V(s[n])=="object"&&(f=s[n].v),rt(u))return 1;if(rt(f))return-1;if(Zl(u)&&Zl(f))return Br(f,u);if(Y(u)&&Y(f))return(0,_a.default)(f).value()-(0,_a.default)(u).value();if(!Y(u)&&!Y(f))return f.localeCompare(u,"zh");if(Y(u)){if(!Y(f))return 1}else return-1};return t?e.sort(l):e.sort(o)}function hh(e,n){n==null&&(n=!0);let t=function(o,a){let s=o,u=a;if(V(o)=="object"&&(s=o.v),V(a)=="object"&&(u=a.v),s==null&&(s=""),u==null&&(u=""),Zl(s)&&Zl(u))return Br(s,u);if(Y(s)&&Y(u))return(0,_a.default)(s).value()-(0,_a.default)(u).value();if(!Y(s)&&!Y(u))return s.localeCompare(u,"zh");if(Y(s)){if(!Y(u))return-1}else return 1},l=function(o,a){let s=o,u=a;if(V(o)=="object"&&(s=o.v),V(a)=="object"&&(u=a.v),s==null&&(s=""),u==null&&(u=""),Zl(s)&&Zl(u))return Br(u,s);if(Y(s)&&Y(u))return(0,_a.default)(u).value()-(0,_a.default)(s).value();if(!Y(s)&&!Y(u))return u.localeCompare(s,"zh");if(Y(s)){if(!Y(u))return 1}else return-1};return n?e.sort(t):e.sort(l)}function Vm(e){if(!Hl(h.currentSheetIndex,"sort"))return;let t=Oe().sort;if(h.luckysheet_select_save.length>1){Qe()?alert(t.noRangeError):de.info(t.noRangeError,"");return}e==null&&(e=!0);let l=pt.deepCopyFlowData(h.flowdata),o=h.luckysheet_select_save[0].row[0],a=h.luckysheet_select_save[0].row[1],s=h.luckysheet_select_save[0].column[0],u=h.luckysheet_select_save[0].column[1],f,m;for(let y=o;y<=a;y++)if(l[y]!=null&&l[y][s]!=null){let p=l[y][s];if(p.mc!=null||rt(p.v))continue;if(f==null&&/[\u4e00-\u9fa5]+/g.test(p.v)){f=y+1,m=y+1;continue}f==null&&(f=y),m=y}if(f==null||f>a)return;let d=!1,g=[];for(let y=f;y<=m;y++){let p=[];for(let x=s;x<=u;x++){if(l[y][x]!=null&&l[y][x].mc!=null){d=!0;break}p.push(l[y][x])}g.push(p)}if(d){Qe()?alert(t.mergeError):de.info(t.mergeError,"");return}g=So(g,0,e);for(let y=f;y<=m;y++)for(let p=s;p<=u;p++)l[y][p]=g[y-f][p-s];let b={};if(h.config.rowlen!=null){let y=$.extend(!0,{},h.config);y=tn(l,f,m,y),b={cfg:y,RowlChange:!0}}Gt(l,[{row:[f,m],column:[s,u]}],b)}function Wm(e,n){if(!Hl(h.currentSheetIndex,"sort"))return;n==null&&(n=!0);let t=pt.deepCopyFlowData(h.flowdata),l=0,o=t.length-1,a=0,s=t[0].length-1,u,f;for(let b=l;b<=o;b++)if(!(t[b][e]!=null&&t[b][e].mc!=null)){if(t[b][e]!=null&&!rt(t[b][e].v)&&/[\u4e00-\u9fa5]+/g.test(t[b][e].v)&&u==null){u=b+1,f=b+1;continue}u==null&&(u=b),t[b][e]!=null&&!rt(t[b][e].v)&&(f=b)}if(u==null||u>o)return;let m=!1,d=[];for(let b=u;b<=f;b++){let y=[];for(let p=a;p<=s;p++){if(t[b][p]!=null&&t[b][p].mc!=null){m=!0;break}y.push(t[b][p])}d.push(y)}if(m){Qe()?alert("\u5217\u6392\u5E8F\u4F1A\u6269\u5C55\u81F3\u6574\u4E2A\u8868\u683C\u9009\u533A\uFF0C\u9009\u533A\u6709\u5408\u5E76\u5355\u5143\u683C\uFF0C\u65E0\u6CD5\u6267\u884C\u6B64\u64CD\u4F5C\uFF0C\u8BF7\u9009\u62E9\u529F\u80FD\u680F\u6392\u5E8F\u529F\u80FD\uFF01"):de.info("\u5217\u6392\u5E8F\u4F1A\u6269\u5C55\u81F3\u6574\u4E2A\u8868\u683C\u9009\u533A\uFF0C\u9009\u533A\u6709\u5408\u5E76\u5355\u5143\u683C\uFF0C\u65E0\u6CD5\u6267\u884C\u6B64\u64CD\u4F5C\uFF0C\u8BF7\u9009\u62E9\u529F\u80FD\u680F\u6392\u5E8F\u529F\u80FD\uFF01","");return}d=So(d,e,n);for(let b=u;b<=f;b++)for(let y=a;y<=s;y++)t[b][y]=d[b-u][y-a];let g={};if(h.config.rowlen!=null){let b=$.extend(!0,{},h.config);b=tn(t,u,f,b),g={cfg:b,RowlChange:!0}}Gt(t,[{row:[u,f],column:[a,s]}],g)}var import_plugin,_a,Rs=Tt(()=>{import_plugin=Le(Be());gl();Gl();Co();Sr();br();Hi();fr();jn();Ut();Rl();_a=Le(Is())});var import_plugin,Xx,qy,Xy=Tt(()=>{import_plugin=Le(Be());mr();Xx={transpose:function(e,n=!0){let t=[];if(e.length==0)return[];if(e[0].length==0)return[];for(let l=0;l<e[0].length;l++){let o=[];for(let a=0;a<e.length;a++){let s="";e[a]!=null&&e[a][l]!=null&&(n?s=Mt(a,l,e):s=e[a][l]),o.push(s)}t.push(o)}return t},minusClear:function(e,n){if(n.row[0]>e.row[1]||n.row[1]<e.row[0]||n.column[0]>e.column[1]||n.column[1]<e.column[0])return null;if(n.row[0]==e.row[0]&&n.row[1]<e.row[1]&&n.column[0]>e.column[0]&&n.column[1]<e.column[1])return[];let t=[],l={row:[],column:[]},o=null,a=[e.column[0],e.column[1]];n.row[1]>e.row[0]&&n.row[1]<e.row[1]?o=[n.row[1]+1,e.row[1]]:n.row[0]>e.row[0]&&n.row[0]<e.row[1]&&(o=[e.row[0],n.row[0]-1]),o!=null&&t.push({row:o,column:a});let s=[e.row[0],e.row[1]],u=null;return n.column[1]>e.column[0]&&n.column[1]<e.column[1]?u=[n.column[1]+1,e.column[1]]:n.column[0]>e.column[0]&&n.column[0]<e.column[1]&&(u=[e.column[0],n.column[0]-1]),u!=null&&t.push({row:s,column:u}),t}},qy=Xx});var import_plugin,Zx,Nu,Zy=Tt(()=>{import_plugin=Le(Be());gl();Zx={STDEVP:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Fn(Math.sqrt(t/n.length))},STDEV:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Fn(Math.sqrt(t/(n.length-1)))},VARP:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Fn(t/n.length)},let:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Fn(t/(n.length-1))}},Nu=Zx});var import_plugin,Lu,Ky,Pt,Qo=Tt(()=>{import_plugin=Le(Be());ql();gl();mr();Co();Hn();Gl();Rs();fr();Sr();br();Io();Xy();Zy();vr();xo();ar();Yr();Bi();wr();jn();Ut();Rl();Lu=Le(Is());ar();Ky={pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,getCellData:function(e,n,t){let l=this,o;e!=null?o=e:o=h.currentSheetIndex;let a=$e(o);V(h.luckysheetfile[a].pivotTable)!="object"&&(h.luckysheetfile[a].pivotTable=new Function("return "+h.luckysheetfile[a].pivotTable)()),h.luckysheetfile[a].pivotTable!=null?(l.column=h.luckysheetfile[a].pivotTable.column,l.row=h.luckysheetfile[a].pivotTable.row,l.values=h.luckysheetfile[a].pivotTable.values,l.filter=h.luckysheetfile[a].pivotTable.filter,l.showType=h.luckysheetfile[a].pivotTable.showType,l.filterparm=h.luckysheetfile[a].pivotTable.filterparm,h.luckysheetfile[a].pivotTable.drawPivotTable!=null?l.drawPivotTable=h.luckysheetfile[a].pivotTable.drawPivotTable:l.drawPivotTable=!0,h.luckysheetfile[a].pivotTable.pivotTableBoundary!=null?l.pivotTableBoundary=h.luckysheetfile[a].pivotTable.pivotTableBoundary:l.pivotTableBoundary=[12,6],t!=null?l.pivot_select_save=t:l.pivot_select_save=h.luckysheetfile[a].pivotTable.pivot_select_save,n!=null?l.pivotDataSheetIndex=n:l.pivotDataSheetIndex=h.luckysheetfile[a].pivotTable.pivotDataSheetIndex):(l.column=null,l.row=null,l.values=null,l.filter=null,l.showType=null,l.filterparm=null,l.drawPivotTable=!0,l.pivotTableBoundary=[12,6],t!=null?l.pivot_select_save=t:l.pivot_select_save=h.luckysheet_select_save,n!=null?l.pivotDataSheetIndex=n:l.pivotDataSheetIndex=o);let s=$e(l.pivotDataSheetIndex),u=h.luckysheetfile[s];u.data==null&&(u.data=ct.buildGridData(u)),l.origindata=Du(u.data,l.pivot_select_save);let f={};if(l.filterparm!=null)for(let d in l.filterparm)for(let g in l.filterparm[d])g==="rowhidden"&&l.filterparm[d][g]!=null&&(f=$.extend(!0,f,l.filterparm[d][g]));l.rowhidden=f,l.pivotSheetIndex=o;let m=[];for(let d=0;d<l.origindata.length;d++)l.rowhidden!=null&&l.rowhidden[d]!=null||m.push([].concat(l.origindata[d]));l.celldata=m,l.pivot_data_type={};for(let d=0;d<l.celldata[1].length;d++){let g=xi(l.celldata[1][d]);l.pivot_data_type[d.toString()]=g}},pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,luckysheet_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},showvaluecolrow:function(){let e=this;$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").length>=2?($("#luckysheetpivottablevaluecolrowshow").show(),e.showType=="column"?($("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#luckysheetpivottablevaluecolrow1").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").removeClass("ui-state-active"))):$("#luckysheetpivottablevaluecolrowshow").hide()},resetOrderby:function(e){let n=$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").index(e);$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("orderby")==n&&$(this).data("orderby","self")})},luckysheetsliderlistclearfilter:function(e){let n=this,t=e.parent(),l=t.data("index"),o={},a={},s=n.origindata,u={};t.data("rowhidden","").find(".luckysheet-slider-list-item-filtered").hide(),n.setDatatojsfile("selected",{},l),n.setDatatojsfile("rowhidden",null,l);let f=[];for(let m=0;m<s.length;m++)o[m]==null&&f.push([].concat(s[m]));n.celldata=f,n.refreshPivotTable(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide()},luckysheetsliderlistitemfilter:function(e){let n=this,l=Oe().filter,o=e.parent(),a=o.offset(),s=$("#luckysheet-pivotTableFilter-menu"),u=$(window).height(),f=$(window).width(),m=o.data("index"),d=o.data("rowhidden");d==null||d==""?d={}:V(d)=="string"&&(d=JSON.parse(d)),$("body .luckysheet-cols-menu").hide(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),$("#luckysheet-pivotTableFilter-byvalue-input").val(""),$("#luckysheet-pivotTableFilter-bycondition").next().hide(),$("#luckysheet-pivotTableFilter-byvalue").next().show(),s.data("index",m),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide().find("input").val(),$("#luckysheet-pivotTableFilter-selected span").data("type","0").data("type",null).text(l.filiterInputNone);let g=o.data("byconditiontype");if($("#luckysheet-pivotTableFilter-selected span").data("value",o.data("byconditionvalue")).data("type",g).text(o.data("byconditiontext")),g=="2"){let x=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2").show().find("input");x.eq(0).val(o.data("byconditionvalue1")),x.eq(1).val(o.data("byconditionvalue2"))}else g=="1"&&$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).show().find("input").val(o.data("byconditionvalue1"));let b=ko("#luckysheet-pivotTableFilter-byvalue-select",{text:l.filiterMoreDataTip});$("#luckysheet-pivotTableFilter-byvalue-select").empty().append(b.el);let y={};$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").not(o.get(0)).each(function(){let x=$(this),_=x.data("rowhidden");if(_==null||_=="")return!0;V(_)=="string"&&(_=JSON.parse(_));for(let S in _)y[S]=0});let p=n.origindata;setTimeout(function(){let x={},_={},S={},I={};for(let D=1;D<p.length;D++){if(D in y||p[D]==null)continue;let k=p[D][m];if(k!=null&&k.ct!=null&&k.ct.t=="d"){let w=$l("YYYY-MM-DD",k.v),C=w.split("-")[0],T=w.split("-")[1],z=w.split("-")[2];C in x||(x[C]={}),T in x[C]||(x[C][T]={}),z in x[C][T]||(x[C][T][z]=0),x[C][T][z]++,D in d&&(_[C]=0,_[T]=0,_[z]=0)}else{let w,C;k==null||rt(k.v)?(w=null,C=null):(w=k.v,C=k.m),w in S||(S[w]={}),C in S[w]||(S[w][C]=0),S[w][C]++,D in d&&(I[w+"#$$$#"+C]=0)}}let O=[];if(JSON.stringify(x).length>2)for(let D in x){let k=0,w="";for(let T in x[D]){let z=0,A="";for(let P in x[D][T]){let N=x[D][T][P];z+=N;let E;Number(T)<10?E="0"+Number(T):E=T;let B;Number(P)<10?B="0"+Number(P):B=P,D in _&&T in _&&P in _?A+='<div class="day luckysheet-mousedown-cancel cf" data-check="false" title="'+D+"-"+E+"-"+B+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+P+'</label><span class="count luckysheet-mousedown-cancel">( '+N+" )</span></div>":A+='<div class="day luckysheet-mousedown-cancel cf" data-check="true" title="'+D+"-"+E+"-"+B+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+P+'</label><span class="count luckysheet-mousedown-cancel">( '+N+" )</span></div>"}k+=z;let M;Number(T)<10?M="0"+Number(T):M=T,D in _&&T in _?w+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="false" title="'+D+"-"+M+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+T+""+l.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+z+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+A+"</div></div>":w+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="true" title="'+D+"-"+M+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+T+""+l.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+z+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+A+"</div></div>"}let C;D in _?C='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="false" title="'+D+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+D+""+l.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+k+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+w+"</div></div>":C='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="true" title="'+D+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+D+""+l.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+k+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+w+"</div></div>",O.unshift(C)}if(JSON.stringify(S).length>2){let D=Object.keys(S);D=hh(D,!0);for(let k=0;k<D.length;k++){let w=D[k];for(let C in S[w]){let T;w+"#$$$#"+C=="null#$$$#null"?T=l.valueBlank:T=C;let z;w+"#$$$#"+C in I?z='<div class="textBox luckysheet-mousedown-cancel cf" data-check="false" data-filter="'+(w+"#$$$#"+C)+'" title="'+C+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+T+'</label><span class="luckysheet-mousedown-cancel count">( '+S[w][C]+" )</span></div>":z='<div class="textBox luckysheet-mousedown-cancel cf" data-check="true" data-filter="'+(w+"#$$$#"+C)+'" title="'+C+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+T+'</label><span class="luckysheet-mousedown-cancel count">( '+S[w][C]+" )</span></div>",O.push(z)}}}let F=u-a.top-350;F<0&&(F=100),$("#luckysheet-pivotTableFilter-byvalue-select").append("<div class='ListBox luckysheet-mousedown-cancel' style='max-height:"+F+"px;overflow-y:auto;overflow-x:hidden;'>"+O.join("")+"</div>"),b.close()},1),ea(s,a.left-250,a.top)},getSumTypeName:function(e){let n="",l=Oe().pivotTable;return e=="SUM"?n=l.valueStatisticsSUM:e=="COUNT"?n=l.valueStatisticsCOUNT:e=="COUNTA"?n=l.valueStatisticsCOUNTA:e=="COUNTUNIQUE"?n=l.valueStatisticsCOUNTUNIQUE:e=="AVERAGE"?n=l.valueStatisticsAVERAGE:e=="MAX"?n=l.valueStatisticsMAX:e=="MIN"?n=l.valueStatisticsMIN:e=="MEDIAN"?n=l.valueStatisticsMEDIAN:e=="PRODUCT"?n=l.valueStatisticsPRODUCT:e=="STDEV"?n=l.valueStatisticsSTDEV:e=="STDEVP"?n=l.valueStatisticsSTDEVP:e=="let"?n=l.valueStatisticslet:e=="VARP"&&(n=l.valueStatisticsVARP),n},setDatatojsfile:function(e,n,t){let l=this,o=$e(l.pivotSheetIndex);h.luckysheetfile[o].pivotTable==null&&(h.luckysheetfile[o].pivotTable={}),t==null?(h.luckysheetfile[o].pivotTable[e]=n,l[e]=n):(h.luckysheetfile[o].pivotTable.filterparm==null&&(h.luckysheetfile[o].pivotTable.filterparm={}),h.luckysheetfile[o].pivotTable.filterparm[t.toString()]==null&&(h.luckysheetfile[o].pivotTable.filterparm[t.toString()]={}),h.luckysheetfile[o].pivotTable.filterparm[t.toString()][e]=n,l.filterparm==null&&(l.filterparm={}),l.filterparm[t.toString()]==null&&(l.filterparm[t.toString()]={}),l.filterparm[t.toString()][e]=n)},createPivotTable:function(e){if(Qe()||h.allowEdit===!1)return;let n=this,t=h.currentSheetIndex,o=Oe().pivotTable;if(Qe()){alert(o.errorNotAllowEdit);return}if(h.luckysheet_select_save.length>1){de.info("",o.errorNotAllowMulti);return}if(h.luckysheet_select_save.length==0||h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]||h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]){de.info("",o.errorSelectRange);return}let a=$.extend(!0,{},h.luckysheet_select_save[0]);ct.addNewSheet(e,!0),n.getCellData(h.currentSheetIndex,t,a),n.setDatatojsfile("pivot_select_save",a),n.setDatatojsfile("pivotDataSheetIndex",t),n.initialPivotManage()},changePivotTable:function(e){let n=this,l=Oe().pivotTable,o=h.luckysheetfile[$e(e)].pivotTable.pivotDataSheetIndex;if($e(o)==null){de.info(l.errorIsDamage,"");return}n.getCellData(e),n.initialPivotManage(!0),n.refreshPivotTable()},refreshPivotTable:function(e=!0){let n=this,t={};t.pivotTable=Ky,t.data=pt.deepCopyFlowData(h.flowdata),n.storePivotTableParam();let l=n.dataHandler(n.column,n.row,n.values,n.showType,n.celldata);n.setDatatojsfile("pivotDatas",l);let o=$.extend(!0,[],ct.nulldata),a=o,s=0,u=0;if(l.length==0)n.setDatatojsfile("drawPivotTable",!0),n.setDatatojsfile("pivotTableBoundary",[12,6]);else{n.setDatatojsfile("drawPivotTable",!1),n.setDatatojsfile("pivotTableBoundary",[l.length,l[0].length]);let f=l.length,m=l[0].length;s=f-o.length,u=m-o[0].length,a=Hr(o,s+20,u+10,!0);for(let d=0;d<f;d++){let g=[].concat(a[d]);for(let b=0;b<m;b++){let y="";l[d]!=null&&l[d][b]!=null&&(y=Mt(d,b,l)),g[b]=y}a[d]=g}}t.type="pivotTable_change",t.curdata=$.extend(!0,[],a),t.sheetIndex=h.currentSheetIndex,t.pivotTablecur=n.getPivotTableData(),h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push(t)),Ir(),h.clearjfundo=!1,s>0||u>0?fi(a[0].length,a.length,a,null,h.luckysheet_select_save,"datachangeAll",void 0,void 0,e):(Gt(a,h.luckysheet_select_save,{},null,e),Zt()),h.clearjfundo=!0},drawPivotTable:!0,pivotTableBoundary:[12,6],pivotclick:function(e,n,t){t==null&&(t=h.currentSheetIndex);let l=h.luckysheetfile[$e(t)];if(!l.isPivotTable)return;let o=l.pivotTable.pivotDataSheetIndex;if($e(o)==null)return;let s=$("#luckysheet-modal-dialog-slider-pivot"),u=this.isPivotRange(e,n);if(u&&s.is(":hidden")){if(!Hl(t,"usePivotTablereports",!1))return;s.show(),Kl(),$("#luckysheet-sta-content").css("padding-right",260)}else!u&&s.is(":visible")&&(s.hide(),Kl(),$("#luckysheet-sta-content").css("padding-right",10))},isPivotRange:function(e,n){let t=this;if(h.luckysheetcurrentisPivotTable)return e<t.pivotTableBoundary[0]&&n<t.pivotTableBoundary[1]},storePivotTableParam:function(){let e=this,n=[],t=[],l=[],o=[];$("#luckysheet-modal-dialog-config-filter .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),l.push(u)}),$("#luckysheet-modal-dialog-config-row .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),u.order=$(this).data("order"),u.orderby=$(this).data("orderby"),u.stastic=$(this).data("stastic"),t.push(u)}),$("#luckysheet-modal-dialog-config-column .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),u.order=$(this).data("order"),u.orderby=$(this).data("orderby"),u.stastic=$(this).data("stastic"),n.push(u)}),$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),u.sumtype=$(this).data("sumtype"),u.nameindex=$(this).data("nameindex"),o.push(u)}),e.setDatatojsfile("column",n),e.setDatatojsfile("row",t),e.setDatatojsfile("filter",l),e.setDatatojsfile("values",o);let a=$("#luckysheetpivottablevaluecolrow:checked, #luckysheetpivottablevaluecolrow1:checked").val();e.setDatatojsfile("showType",a=="0"?"row":"column");let s=e.getPivotTableData();delete s.pivotDatas,He.saveParam("all",e.pivotSheetIndex,s,{k:"pivotTable"})},getPivotTableData:function(e){e==null&&(e=this.pivotSheetIndex);let n=$e(e),t=h.luckysheetfile[n].pivotTable;return V(t)=="object"?t=$.extend(!0,{},h.luckysheetfile[n].pivotTable):t=new Function("return "+t)(),t},addValuesToTitle:function(e,n){let t=e.length*n.length,l=e[0].length+1,o=[];if(e.length==0&&n.length>0){for(let a=0;a<n.length;a++)o.push(n[a].fullname);return o}if(n.length==0&&e.length>0)return e;for(let a=0;a<t;a++){o[a]=new Array(l);for(let s=0;s<l-1;s++)o[a][s]=e[Math.floor(a/n.length)][s];o[a][l-1]=n[a%n.length].fullname}return o},initialPivotManage:function(e){let n=this,t=Oe(),l=t.pivotTable,o=t.button,a=t.filter;if(n.initial){n.initial=!1,$("body").first().append(v0()),$("#luckysheet-modal-dialog-slider-close").click(function(){$("#luckysheet-modal-dialog-slider-pivot").hide(),Kl()}),$("body").first().append(yt(kl,{id:"luckysheet-data-pivotTable-selection",addclass:"luckysheet-data-pivotTable-selection",title:l.titleSelectionDataRange,content:'<input id="luckysheet-pivotTable-range-selection-input" class="luckysheet-datavisual-range-container" style="font-size: 14px;padding:5px;max-width:none;" spellcheck="false" aria-label="'+l.titleDataRange+'" placeholder="'+l.titleDataRange+'">',botton:'<button id="luckysheet-pivotTable-selection-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>"})),$("body").first().append(yt(Hf(),{menuid:"pivotTableFilter"})),$("body").first().append(yt(Bf(),{menuid:"pivotTableFilter"})),$("body").first().append(c0()),$("body").first().append(u0()),$("#luckysheet-pivotTableFilter-orderby-asc").remove(),$("#luckysheet-pivotTableFilter-orderby-desc").next().remove(),$("#luckysheet-pivotTableFilter-orderby-desc").remove(),$("#luckysheet-pivotTableFilter-orderby-color").next().remove(),$("#luckysheet-pivotTableFilter-orderby-color").remove(),$("#luckysheetpivottablevaluecolrow, #luckysheetpivottablevaluecolrow1").checkboxradio({icon:!1}).change(function(){n.refreshPivotTable()});let d=null;$("#luckysheet-pivotTableFilter-menu").mouseover(function(){clearTimeout(d),d=setTimeout(function(){$("#luckysheet-pivotTableFilter-submenu").hide()},500)}),$(document).off("click.ptFilterCheckbox1").on("click.ptFilterCheckbox1","#luckysheet-pivotTableFilter-byvalue-select .textBox",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox2").on("click.ptFilterCheckbox2","#luckysheet-pivotTableFilter-byvalue-select .year",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox3").on("click.ptFilterCheckbox3","#luckysheet-pivotTableFilter-byvalue-select .month",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));let g=!0;$(this).parents(".yearBox").find(".day").each(function(y,p){$(p).attr("data-check")=="true"||(g=!1)}),g?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterCheckbox4").on("click.ptFilterCheckbox4","#luckysheet-pivotTableFilter-byvalue-select .day",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));let g=!0;$(this).parents(".monthBox").find(".day").each(function(x,_){$(_).attr("data-check")=="true"||(g=!1)}),g?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));let y=!0;$(this).parents(".yearBox").find(".day").each(function(x,_){$(_).attr("data-check")=="true"||(y=!1)}),y?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterYearDropdown").on("click.ptFilterYearDropdown","#luckysheet-pivotTableFilter-byvalue-select .yearBox .fa-caret-right",function(){let g=$(this).parents(".luckysheet-mousedown-cancel");g.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),g.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle()}),$("#luckysheet-pivotTableFilter-byvalue-btn-all").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","true")}),$("#luckysheet-pivotTableFilter-byvalue-btn-contra").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(p,x){$(x).is(":checked")?($(x).removeAttr("checked"),$(x).parents(".luckysheet-mousedown-cancel").attr("data-check","false")):($(x).prop("checked",!0),$(x).parents(".luckysheet-mousedown-cancel").attr("data-check","true"))}),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .monthBox").each(function(p,x){let _=!0;$(x).find(".day input[type='checkbox']").each(function(I,O){$(O).is(":checked")||(_=!1)}),_?($(x).find(".month input[type='checkbox']").prop("checked",!0),$(x).attr("data-check","true")):($(x).find(".month input[type='checkbox']").removeAttr("checked"),$(x).attr("data-check","false"))}),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .yearBox").each(function(p,x){let _=!0;$(x).find(".day input[type='checkbox']").each(function(I,O){$(O).is(":checked")||(_=!1)}),_?($(x).find(".year input[type='checkbox']").prop("checked",!0),$(x).attr("data-check","true")):($(x).find(".year input[type='checkbox']").removeAttr("checked"),$(x).attr("data-check","false"))})}),$("#luckysheet-pivotTableFilter-byvalue-btn-clear").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","false")}),$("#luckysheet-pivotTableFilter-byvalue-input").on("input propertychange",function(){let g=$(this).val().toString();$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .luckysheet-mousedown-cancel").show(),g!=""&&$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(y,p){let x=$(p).parents(".luckysheet-mousedown-cancel");if(x.hasClass("day")){let _=$(p).siblings("label").text().toString(),S=$(p).parents(".monthBox").find(".month label").text().toString();($(p).parents(".yearBox").find(".year label").text().toString()+"-"+S+"-"+_).indexOf(g)==-1&&($(p).parents(".day").hide(),$(p).parents(".dayList").find(".day:visible").length==0&&$(p).parents(".monthBox").find(".month").hide(),$(p).parents(".monthList").find(".day:visible").length==0&&$(p).parents(".yearBox").find(".year").hide())}x.hasClass("textBox")&&$(p).siblings("label").text().toString().indexOf(g)==-1&&$(p).parents(".textBox").hide()})}),$("#luckysheet-pivotTableFilter-bycondition, #luckysheet-pivotTableFilter-byvalue").click(function(){let g=$(this);g.next().slideToggle(200),setTimeout(function(){g.attr("id")=="luckysheet-pivotTableFilter-bycondition"&&$("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-selected span").text()!=a.filiterInputNone&&$("#luckysheet-pivotTableFilter-byvalue").next().slideUp(200),g.is($("#luckysheet-pivotTableFilter-bycondition"))&&$("#luckysheet-pivotTableFilter-bycondition").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-byvalue").next().slideDown(200)},300)}),$("#luckysheet-pivotTableFilter-cancel").click(function(){$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide()}),$("#luckysheet-pivotTableFilter-selected").click(function(){let g=$(this),b=g.offset(),y=$("#luckysheet-pivotTableFilter-submenu");y.hide();let p=$(window).height(),x=$(window).width(),_=y.width(),S=y.height(),I=b.top,O=b.left,F=p-b.top-20;b.left+_>x&&(O=b.left-_),b.top>p/2&&(I=p-b.top,I<0&&(I=0),F=b.top-20),y.css({top:I,left:O,height:F}).show(),clearTimeout(d)}),$("#luckysheet-pivotTableFilter-submenu").mouseover(function(){clearTimeout(d)}).find(".luckysheet-cols-menuitem").click(function(g){$("#luckysheet-pivotTableFilter-selected span").html($(this).find(".luckysheet-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide(),$(this).data("type")=="2"?($("#luckysheet-pivotTableFilter-selected span").data("type","2"),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2").show()):$(this).data("type")=="0"?$("#luckysheet-pivotTableFilter-selected span").data("type","0"):($("#luckysheet-pivotTableFilter-selected span").data("type","1"),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).show(),$(this).attr("data-value")=="dateequal"||$(this).attr("data-value")=="datelessthan"||$(this).attr("data-value")=="datemorethan"?$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input").prop("type","date"):$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input").prop("type","text")),$("#luckysheet-pivotTableFilter-byvalue").next().slideUp(),$("#luckysheet-pivotTableFilter-submenu").hide()}),$("#luckysheet-modal-dialog-pivotTable-list").on("click"," .luckysheet-slider-list-item-filter",function(g){return n.luckysheetsliderlistitemfilter($(this)),g.stopPropagation(),!1}),$("#luckysheet-modal-dialog-pivotTable-list").on("click"," .luckysheet-slider-list-item-filtered",function(g){return n.luckysheetsliderlistclearfilter($(this).next()),g.stopPropagation(),!1}),$("#luckysheet-dialog-pivotTable-range-seleted").click(function(){$("#luckysheet-modal-dialog-slider-pivot").hide(),Kl();let g=$("#luckysheet-data-pivotTable-selection"),b=g.outerHeight(),y=g.outerWidth(),p=$(window).width(),x=$(window).height(),_=$(document).scrollLeft(),S=$(document).scrollTop();$("#luckysheet-data-pivotTable-selection").css({left:(p+_-y)/2,top:(x+S-b)/4}).show(),n.jgridCurrentPivotInput=$("#luckysheet-dialog-pivotTable-range").html(),$("#luckysheet-pivotTable-range-selection-input").val(n.jgridCurrentPivotInput),n.luckysheet_pivotTable_select_state=!0}),$("#luckysheet-pivotTableFilter-initial").click(function(){$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-slider-list-item-filtered").hide(),$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").data("rowhidden",""),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide().find("input").val(),$("#luckysheet-pivotTableFilter-selected span").data("type","0").data("type",null).text(a.filiterInputNone),n.setDatatojsfile("filterparm",null),n.celldata=n.origindata,n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(g){let b=$(g.target),y=b.closest(".luckysheet-modal-dialog-slider-config-item"),p=y.data("index"),x=y.offset(),_=y.data("order"),S=y.data("orderby"),I=y.data("stastic");_==null&&(_="default");let O='<option value="self">'+y.find(".luckysheet-modal-dialog-slider-config-item-txt").data("name")+"</option>";return $("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").each(function(F){O+='<option value="'+F+'">'+$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text()+"</option>"}),$("#luckysheet-pivotTable-config-option-orderby").empty().html(O),S==null&&(S="self"),I==null&&(I="1"),$("#luckysheet-pivotTable-config-option-order").val(_).data("index",p),$("#luckysheet-pivotTable-config-option-orderby").val(S).data("index",p),$("#luckysheet-pivotTable-config-option-stastic").val(I).data("index",p),qr($("#luckysheet-pivotTable-config-option"),x.left+y.outerWidth(),x.top-13,"rightbottom"),g.stopPropagation(),!1}),$("#luckysheet-pivotTable-config-option-order,#luckysheet-pivotTable-config-option-orderby,#luckysheet-pivotTable-config-option-stastic").change(function(){let g=$(this),b=g.data("index");$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==b&&$(this).data(g.attr("id").replace("luckysheet-pivotTable-config-option-",""),g.val())}),n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-value").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(g){let b=$(g.target),y=b.closest(".luckysheet-modal-dialog-slider-config-item"),p=y.data("index"),x=y.offset(),_=y.data("sumtype"),S=n.pivot_data_type[p.toString()];_==null&&(S=="num"?_="SUM":_="COUNTA");let I=$("#luckysheet-pivotTable-config-option-sumtype");return I.find(".luckysheet-submenu-arrow").hide(),I.find(".luckysheet-cols-menuitem[sumtype='"+_+"'] .luckysheet-submenu-arrow").css("display","inline"),I.data("item",y),qr(I,x.left+y.outerWidth(),x.top-13,"rightbottom"),g.stopPropagation(),!1}),$("#luckysheet-pivotTable-config-option-sumtype .luckysheet-cols-menuitem").click(function(){let g=$("#luckysheet-pivotTable-config-option-sumtype").data("item"),b=$(this).attr("sumtype");g.data("sumtype",$(this).attr("sumtype"));let y=n.getSumTypeName(b)+":"+g.data("name");g.attr("title",y).find(".luckysheet-modal-dialog-slider-config-item-txt").html(y),$("#luckysheet-pivotTable-config-option-sumtype").hide(),n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-filter").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(g){let b=$(g.target),y=b.closest(".luckysheet-modal-dialog-slider-config-item").data("index");return n.luckysheetsliderlistitemfilter($("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(y).find(".luckysheet-slider-list-item-filter")),g.stopPropagation(),!1}),$("#luckysheet-pivotTableFilter-confirm").click(function(){let b=$("#luckysheet-pivotTableFilter-menu").data("index"),y={};$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").each(function(){let F=$(this),D=F.data("rowhidden");if(F.data("index")!=b){if(D==null||D=="")return!0;V(D)=="string"&&(D=JSON.parse(D));for(let k in D)y[k]=0}});let p=n.origindata,x={},_={},S={};if($("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-selected span").data("value")!="null"){let F=$("#luckysheet-pivotTableFilter-selected span"),D=F.data("type"),k=F.data("value");if(S.value=k,S.text=F.text(),D=="0")S.type="0";else if(D=="2"){let w=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2 input");S.type="2",S.value1=w.eq(0).val(),S.value2=w.eq(1).val()}else S.type="1",S.value1=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).find("input").val();for(let w=1;w<p.length;w++){if(w in y||p[w]==null)continue;let C=p[w][b];if(k=="cellnull")C!=null&&!rt(C.v)&&(_[w]=0);else if(k=="cellnonull")(C==null||rt(C.v))&&(_[w]=0);else if(k=="textinclude"){let T=S.value1;(C==null||rt(C.v)||C.m.indexOf(T)==-1)&&(_[w]=0)}else if(k=="textnotinclude"){let T=S.value1;C==null||rt(C.v)||C.m.indexOf(T)>-1&&(_[w]=0)}else if(k=="textstart"){let T=S.value1,z=T.length;(C==null||rt(C.v)||C.m.substr(0,z)!=T)&&(_[w]=0)}else if(k=="textend"){let T=S.value1,z=T.length;(C==null||rt(C.v)||z>C.m.length||C.m.substr(C.m.length-z,z)!=T)&&(_[w]=0)}else if(k=="textequal"){let T=S.value1;(C==null||rt(C.v)||C.m!=T)&&(_[w]=0)}else if(k=="dateequal"){let T=nl(S.value1)[2];C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="d"?parseInt(C.v)!=T&&(_[w]=0):_[w]=0}else if(k=="datelessthan"){let T=nl(S.value1)[2];C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="d"?parseInt(C.v)>=T&&(_[w]=0):_[w]=0}else if(k=="datemorethan"){let T=nl(S.value1)[2];C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="d"?parseInt(C.v)<=T&&(_[w]=0):_[w]=0}else if(k=="morethan"){let T=parseFloat(S.value1);C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v<=T&&(_[w]=0):_[w]=0}else if(k=="moreequalthan"){let T=parseFloat(S.value1);C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v<T&&(_[w]=0):_[w]=0}else if(k=="lessthan"){let T=parseFloat(S.value1);C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v>=T&&(_[w]=0):_[w]=0}else if(k=="lessequalthan"){let T=parseFloat(S.value1);C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v>T&&(_[w]=0):_[w]=0}else if(k=="equal"){let T=parseFloat(S.value1);C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v!=T&&(_[w]=0):_[w]=0}else if(k=="noequal"){let T=parseFloat(S.value1);C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v==T&&(_[w]=0):_[w]=0}else if(k=="include"){let T=parseFloat(S.value1),z=parseFloat(S.value2),A,M;T<z?(A=T,M=z):(M=T,A=z),C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?(C.v<A||C.v>M)&&(_[w]=0):_[w]=0}else if(k=="noinclude"){let T=parseFloat(S.value1),z=parseFloat(S.value2),A,M;T<z?(A=T,M=z):(M=T,A=z),C==null||rt(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v>=A&&C.v<=M&&(_[w]=0):_[w]=0}}}else{$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(F,D){if($(D).is(":visible")&&$(D).is(":checked"))return!0;if($(D).closest(".day").length>0){let k=$(D).siblings("label").text();Number(k)<10&&(k="0"+k);let w=$(D).closest(".monthBox").find(".month label").text().replace(a.filiterMonthText,"");Number(w)<10&&(w="0"+w);let C=$(D).closest(".yearBox").find(".year label").text().replace(a.filiterYearText,""),T=a.filterDateFormatTip+"#$$$#"+C+"-"+w+"-"+k;x[T]="1"}if($(D).closest(".textBox").length>0){let k=$(D).closest(".textBox").data("filter");x[k]="1"}});for(let F=1;F<p.length;F++){if(F in y||p[F]==null)continue;let D=p[F][b],k;if(D==null||rt(D.v))k="null#$$$#null";else if(D.ct!=null&&D.ct.t=="d"){let w=$l("YYYY-MM-DD",D.v);k=a.filterDateFormatTip+"#$$$#"+w}else k=D.v+"#$$$#"+D.m;k in x&&(_[F]=0)}}let I=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(b);$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible").length||$("#luckysheet-pivotTableFilter-byvalue-input").val().length>0||$("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-selected span").data("value")!="null"?(I.data("rowhidden",JSON.stringify(_)).find(".luckysheet-slider-list-item-filtered").show(),n.setDatatojsfile("rowhidden",_,b),S!=null&&(I.data("byconditionvalue",S.value).data("byconditiontype",S.type).data("byconditiontext",S.text),S.value1!=null&&I.data("byconditionvalue1",S.value1),S.value2!=null&&I.data("byconditionvalue2",S.value2),n.setDatatojsfile("caljs",S,b))):(I.data("rowhidden","").find(".luckysheet-slider-list-item-filtered").hide(),n.setDatatojsfile("rowhidden",null,b));let O=[];for(let F=0;F<p.length;F++)F in _||F in y||O.push([].concat(p[F]));n.celldata=O,n.refreshPivotTable(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),Ir()}),$("#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn, #luckysheet-data-pivotTable-selection .luckysheet-modal-dialog-title-close").click(function(){$("#luckysheet-modal-dialog-slider-pivot").show(),Kl(),$("#luckysheet-cell-main .luckysheet-pivotTable-selection-set div").show(),$("#luckysheet-data-pivotTable-selection").hide(),ct.changeSheetExec(n.pivotSheetIndex),n.luckysheet_pivotTable_select_state=!1,Ir()}),$("#luckysheet-pivotTable-selection-confirm").click(function(){let g=$("#luckysheet-pivotTable-range-selection-input"),b=g.val();if($.trim(b).length==0||$.trim(b).toUpperCase()==n.jgridCurrentPivotInput.toUpperCase()){g.val(n.jgridCurrentPivotInput),$("#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn").click();return}else{let y=b.split("!"),p="",x="",_=-1;if(y.length>1){p=y[0],x=y[1];for(let O in h.luckysheetfile)if(p==h.luckysheetfile[O].name){_=h.luckysheetfile[O].index;break}_==-1&&(_=0)}else{let O=$e(h.currentSheetIndex);p=h.luckysheetfile[O].name,_=h.luckysheetfile[O].index,x=y[0]}if(h.luckysheetfile[$e(_)].isPivotTable){Qe()?alert(l.errorNotAllowPivotData):de.info("",l.errorNotAllowPivotData),g.val(n.jgridCurrentPivotInput);return}if(x.indexOf(":")==-1){Qe()?alert(l.errorSelectionRange):de.info("",l.errorSelectionRange),g.val(n.jgridCurrentPivotInput);return}x=x.split(":");let S=[],I=[];if(S[0]=parseInt(x[0].replace(/[^0-9]/g,""))-1,S[1]=parseInt(x[1].replace(/[^0-9]/g,""))-1,S[0]>S[1]){Qe()?alert(l.errorSelectionRange):de.info("",l.errorSelectionRange),g.val(n.jgridCurrentPivotInput);return}if(I[0]=jr(x[0].replace(/[^A-Za-z]/g,"")),I[1]=jr(x[1].replace(/[^A-Za-z]/g,"")),I[0]>I[1]){Qe()?alert(l.errorSelectionRange):de.info(l.errorSelectionRange),g.val(n.jgridCurrentPivotInput);return}ct.changeSheetExec(n.pivotSheetIndex),n.setDatatojsfile("pivot_select_save",{row:S,column:I}),n.setDatatojsfile("pivotDataSheetIndex",_),n.getCellData(n.pivotSheetIndex,_,{row:S,column:I}),n.initialPivotManage(),$("#luckysheet-dialog-pivotTable-range").html(b),$("#luckysheet-modal-dialog-slider-pivot").show(),$("#luckysheet-data-pivotTable-selection").hide(),n.luckysheet_pivotTable_select_state=!1,n.refreshPivotTable(),Kl(),Ir()}}),$("#luckysheet-modal-dialog-slider-pivot").on("mousedown",".luckysheet-slider-list-item-name, .luckysheet-modal-dialog-slider-config-item-txt",function(g){let b=$(g.target);n.movestate=!0,n.movesave.obj=b.parent(),n.movesave.name=b.data("name"),n.movesave.containerid=b.parent().parent().attr("id"),n.movesave.index=b.data("index"),$("#luckysheet-modal-dialog-slider-pivot-move").length==0&&$("body").first().append('<div id="luckysheet-modal-dialog-slider-pivot-move">'+n.movesave.name+"</div>"),n.movesave.width=$("#luckysheet-modal-dialog-slider-pivot-move").outerWidth(),n.movesave.height=$("#luckysheet-modal-dialog-slider-pivot-move").outerHeight(),$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default")}),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").mousemove(function(g){if(n.movestate){n.moveitemposition.length==0&&(n.moveitemposition=[0],$(this).find(".luckysheet-modal-dialog-slider-config-item").each(function(I){let O=$(this),F=O.outerHeight();n.moveitemposition.push(n.moveitemposition[I]+F+2)}),$(this).append('<div id="luckysheet-modal-dialog-config-order-help" style="position:absolute;height:3px;width:100%;background:#007ACC;z-index:1;pointer-events: none;user-select:none;"></div>')),$("#luckysheet-modal-dialog-slider-pivot-move").css({background:"#FD8585",color:"#fff",border:"1px solid #FD7070"});let b=event.pageX,y=event.pageY,p=$(this),x=y-p.offset().top+p.scrollTop(),_=n.moveitemposition,S=al(_,x);S==-1?$("#luckysheet-modal-dialog-config-order-help").css({top:_[_.length-1]}):x-_[S-1]>(_[S]-_[S-1])/2?$("#luckysheet-modal-dialog-config-order-help").css({top:_[S]}):$("#luckysheet-modal-dialog-config-order-help").css({top:_[S-1]})}}).mouseleave(function(){n.movestate&&($("#luckysheet-modal-dialog-slider-pivot-move").css({background:"#fff",color:"#000",border:"1px dotted #000"}),n.moveitemposition=[],$("#luckysheet-modal-dialog-config-order-help").remove())}).mouseup(function(g){if(n.movestate){let b=$(this),y;if(n.movesave.containerid==b.attr("id"))y=n.movesave.obj.clone();else{let F=n.movesave.name,D="",k="";b.attr("id")=="luckysheet-modal-dialog-config-value"&&(n.pivot_data_type[n.movesave.index.toString()]=="num"?(F=l.valueStatisticsSUM+":"+F,D="data-sumtype='SUM'",k="data-nameindex='0'"):(F=l.valueStatisticsCOUNTA+":"+F,D="data-sumtype='COUNTA'",k="data-nameindex='0'"),$("#luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){if($(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text()==F){let C=parseFloat($(this).data("nameindex"))+1;return F=F+C.toString(),$(this).data("nameindex",C),!1}})),y='<div title="'+F+'" class="luckysheet-modal-dialog-slider-config-item" '+k+" "+D+' data-index="'+n.movesave.index+'" data-name="'+n.movesave.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+k+" "+D+' data-index="'+n.movesave.index+'" data-name="'+n.movesave.name+'">'+F+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'}let p=event.pageX,x=event.pageY,_=$(this),S=x-_.offset().top+_.scrollTop(),I=n.moveitemposition,O=al(I,S);(n.movesave.containerid=="luckysheet-modal-dialog-pivotTable-list"||n.movesave.containerid=="luckysheet-modal-dialog-config-value"&&n.movesave.containerid!=b.attr("id"))&&$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==n.movesave.index&&$(this).remove()}),O==-1?b.find(".luckysheet-modal-dialog-slider-config-item").length==0?b.append(y):b.find(".luckysheet-modal-dialog-slider-config-item").last().after(y):S-I[O-1]>(I[O]-I[O-1])/2?b.find(".luckysheet-modal-dialog-slider-config-item").eq(O-1).after(y):b.find(".luckysheet-modal-dialog-slider-config-item").eq(O-1).before(y),n.movesave.containerid=="luckysheet-modal-dialog-pivotTable-list"||n.movesave.containerid=="luckysheet-modal-dialog-config-value"&&n.movesave.containerid!=b.attr("id")||n.movesave.obj.remove(),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){let F=$(this).find(".luckysheet-slider-list-item-selected");$(this).data("index")==n.movesave.index&&F.find("i").length==0&&F.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}),n.refreshPivotTable(),$("#luckysheet-modal-dialog-slider-pivot-move").remove(),n.movestate=!1,$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default"),n.moveitemposition=[],$("#luckysheet-modal-dialog-config-order-help").remove(),n.showvaluecolrow(),g.stopPropagation()}}),$("#luckysheet-modal-dialog-pivotTable-list").on("click",".luckysheet-slider-list-item-selected",function(){let g=$(this),b=g.parent(),y=b.data("index"),p=b.data("name");if(g.find("i").length==0){g.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>');let x=n.pivot_data_type[y.toString()],_;if(x=="num")_='<div title="'+p+'" class="luckysheet-modal-dialog-slider-config-item" data-nameindex="0" data-sumtype="SUM" data-index="'+y+'" data-name="'+p+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-nameindex="0" data-sumtype="SUM" data-index="'+y+'" data-name="'+p+'">\u6C42\u548C:'+p+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>',$("#luckysheet-modal-dialog-config-value").append(_);else{_='<div title="'+p+'" class="luckysheet-modal-dialog-slider-config-item" data-index="'+y+'" data-name="'+p+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-index="'+y+'" data-name="'+p+'">'+p+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';let S=$("#luckysheet-modal-dialog-config-column"),I=$("#luckysheet-modal-dialog-config-row"),O=S.find(".luckysheet-modal-dialog-slider-config-item"),F=I.find(".luckysheet-modal-dialog-slider-config-item");O.length<2?S.append(_):F.length<2?I.append(_):S.append(_)}}else g.find("i").remove(),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==y&&($(this).parent().attr("id")=="luckysheet-modal-dialog-config-value"&&n.resetOrderby($(this)),$(this).remove())});n.refreshPivotTable(),n.showvaluecolrow()}),$("#luckysheet-dialog-pivotTable-clearitem").click(function(){$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).remove()}),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){$(this).find(".luckysheet-slider-list-item-selected").find("i").remove()}),n.refreshPivotTable(),n.showvaluecolrow()})}e==null&&(e=!1),n.celldata.length<=1&&n.celldata[0].length<=1&&(Qe()?alert(l.errorIncreaseRange):de.info("",l.errorIncreaseRange));let s="",u=1,f={},m=1;for(let d=0;d<n.celldata[0].length;d++){let g;!!n.celldata[0][d]&&!!n.celldata[0][d].m?g=n.celldata[0][d].m:g=Mt(0,d,n.celldata),g!=null&&(g=g.toString()),(g==null||$.trim(g.toString()).length==0)&&(g=l.titleColumn+" "+m),m++,g in f&&(g=g+u++,g in f&&(g=g+u++,g in f&&(g=g+u++))),f[g]=1;let b="",y="";if(e&&n.filterparm!=null&&n.filterparm[d.toString()]!=null){let p=n.filterparm[d.toString()];if(p.rowhidden!=null&&(b+="data-rowhidden='"+JSON.stringify(p.rowhidden)+"'"),p.selected!=null&&(b+="data-selected='"+JSON.stringify(p.selected)+"'"),p.caljs!=null){let x=p.caljs;x.value!=null&&(b+="data-byconditionvalue='"+x.value+"'"),x.type!=null&&(b+="data-byconditiontype='"+x.type+"'"),x.text!=null&&(b+="data-byconditiontext='"+x.text+"'"),x.value1!=null&&(b+="data-byconditionvalue1='"+x.value1+"'"),x.value2!=null&&(b+="data-byconditionvalue2='"+x.value2+"'")}}b.length>0&&(y="display:block;"),s+='<div class="luckysheet-modal-dialog-slider-list-item" '+b+' data-index="'+d+'" data-name="'+g+'"><div title="'+l.titleAddColumn+'" class="luckysheet-slider-list-item-selected"><div></div></div><div title="'+l.titleMoveColumn+'" class="luckysheet-slider-list-item-name" '+b+' data-index="'+d+'" data-name="'+g+'">'+g+'</div><div title="'+l.titleClearColumnFilter+'" class="luckysheet-slider-list-item-filtered" style="'+y+'"><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i><i class="fa fa-times" aria-hidden="true"></i></div><div title="'+l.titleFilterColumn+'" class="luckysheet-slider-list-item-filter"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'}if($("#luckysheet-modal-dialog-pivotTable-list").html(s),$("#luckysheetpivottablevaluecolrowshow").hide(),$("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").empty(),e){if(n.filter!=null&&n.filter.length>0)for(let d=0;d<n.filter.length;d++){let g=n.filter[d],b='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" data-index="'+g.index+'" data-name="'+g.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-index="'+g.index+'" data-name="'+g.name+'">'+g.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-filter").append(b);let y=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(g.index).find(".luckysheet-slider-list-item-selected");y.find("i").length==0&&y.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.row!=null&&n.row.length>0)for(let d=0;d<n.row.length;d++){let g=n.row[d],b="";g.order!=null&&(b+="data-order = '"+g.order+"'"),g.orderby!=null&&(b+="data-orderby = '"+g.orderby+"'"),g.order!=null&&(b+="data-stastic = '"+g.stastic+"'");let y='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+b+' data-index="'+g.index+'" data-name="'+g.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+b+' data-index="'+g.index+'" data-name="'+g.name+'">'+g.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-row").append(y);let p=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(g.index).find(".luckysheet-slider-list-item-selected");p.find("i").length==0&&p.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.column!=null&&n.column.length>0)for(let d=0;d<n.column.length;d++){let g=n.column[d],b="";g.order!=null&&(b+="data-order = '"+g.order+"'"),g.orderby!=null&&(b+="data-orderby = '"+g.orderby+"'"),g.order!=null&&(b+="data-stastic = '"+g.stastic+"'");let y='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+b+' data-index="'+g.index+'" data-name="'+g.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+b+' data-index="'+g.index+'" data-name="'+g.name+'">'+g.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-column").append(y);let p=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(g.index).find(".luckysheet-slider-list-item-selected");p.find("i").length==0&&p.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.values!=null&&n.values.length>0){for(let d=0;d<n.values.length;d++){let g=n.values[d],b="";g.sumtype!=null&&(b+="data-sumtype = '"+g.sumtype+"'"),g.nameindex!=null&&(b+="data-nameindex = '"+g.nameindex+"'");let y='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+b+' data-index="'+g.index+'" data-name="'+g.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+b+' data-index="'+g.index+'" data-name="'+g.name+'">'+n.getSumTypeName(g.sumtype)+":"+g.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-value").append(y);let p=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(g.index).find(".luckysheet-slider-list-item-selected");p.find("i").length==0&&p.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}n.values.length>=2&&($("#luckysheetpivottablevaluecolrowshow").show(),n.showType=="column"?($("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#luckysheetpivottablevaluecolrow1").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").removeClass("ui-state-active")))}}$("#luckysheet-dialog-pivotTable-range").html(Al(n.pivotDataSheetIndex,n.pivot_select_save)),$("#luckysheet-modal-dialog-slider-pivot").show(),Kl(!1)},getComposeArray:function(e){if(e.length==0)return[];let n=[];for(let t=0;t<e.length;t++){let l="";for(let o=0;o<=t;o++)!!e[o]&&!!e[o].m?l+=e[o].m:l+=Mt(o,null,e);n.push(l)}return n},getnameArray:function(e,n){if(e.length==0)return[];if(n.length==0)return[];let t=[];for(let l=0;l<n.length;l++){let o;!!e[n[l].index]&&!!e[n[l].index].m?o=e[n[l].index].m:o=Mt(n[l].index,null,e),t.push(o)}return t},getTitleFromGroup:function(e,n,t){let l=this,o=l.orderbygroup(e,n,t);return l.generategrouparraymain(o,n)},orderbygroup:function(e,n,t){let l=this,o=[];if(e.length==0)return[];o=e;let a=null,s=o.length,u=o.length,f=0;for(;s!=0;)if(a=o[f++],s--,a.children!=null&&a.children.length>0){a.children=l.orderbygroupchildren(a.children,n[a.index].orderby,n[a.index].order,t);for(let m=0;m<a.children.length;m++)o.push(a.children[m]),s++}return e.splice(0,u)},orderbygroupchildren:function(e,n,t,l){if(e.length==0)return[];let o=!1;(t==null||t=="asc")&&(o=!0);let s=Oe().filter,u=function(m,d){let g=null,b=null;if(n=="self"||n==null){if(m.name==null?g=s.valueBlank:g=m.name.toString(),d.name==null?b=s.valueBlank:b=d.name.toString(),Zl(g)&&Zl(b))return Br(g,b)}else g=parseFloat(l[m.orderby].result),b=parseFloat(l[d.orderby].result);if(!isNaN(g)&&!isNaN(b))return(0,Lu.default)(g).value()-(0,Lu.default)(b).value();if(isNaN(g)&&isNaN(b))return g.localeCompare(b);if(isNaN(g))return 1;if(isNaN(b))return-1},f=function(m,d){let g=null,b=null;if(n=="self"||n==null){if(m.name==null?g=s.valueBlank:g=m.name.toString(),d.name==null?b=s.valueBlank:b=d.name.toString(),Zl(g)&&Zl(b))return Br(g,b)}else g=parseFloat(l[m.orderby].result),b=parseFloat(l[d.orderby].result);if(!isNaN(g)&&!isNaN(b))return(0,Lu.default)(b).value()-(0,Lu.default)(g).value();if(isNaN(g)&&isNaN(b))return b.localeCompare(g);if(isNaN(g))return-1;if(isNaN(b))return 1};return o?e.sort(u):e.sort(f)},generategroupaddstatic:function(e,n){let t=[],o=Oe().pivotTable;for(let a=0;a<e[0].length;a++)a==0?n==o.valueSum?t.push(n):t.push({name:n,issum:!0}):t.push("");return t},generategrouparraymain:function(e,n){let t=this,l=[];for(let o=0;o<e.length;o++){let a=e[o].name,s=t.generategrouparray(e[o].children,n,1);(n[0].stastic=="1"||n[0].stastic==null)&&s.push(t.generategroupaddstatic(s,a)),l=l.concat(s)}return l},generategrouparray:function(e,n,t){let l=this,o=[];for(let a=0;a<e.length;a++){let s=e[a].name,u;if(e[a].children==0||e[a].children.length==0)u=[s],o.push(u);else{u=l.generategrouparray(e[a].children,n,t+1);for(let f=0;f<u.length;f++)u[f].unshift(s);(n[t].stastic=="1"||n[t].stastic==null)&&u.push(l.generategroupaddstatic(u,s)),o=o.concat(u)}}return o},addStatisticsData:function(e,n,t,l){if(e[t]==null&&(e[t]={data:[],count:0,max:-Infinity,min:Infinity,counta:0,countunique:0,countuniquedata:{},sum:0,digitaldata:[],sumtype:n.sumtype,index:n.index,name:n.fullname,acc:0}),Ga(l).num===!0){let o=Fn(l,6);e[t].digitaldata.push(o),e[t].count+=1,e[t].sum+=o,o>e[t].max&&(e[t].max=o),o<e[t].min&&(e[t].min=o);let a=Um(o);a>e[t].acc&&(e[t].acc=a)}l!=""&&(e[t].data.push(l),e[t].counta+=1,l in e[t].countuniquedata||(e[t].countuniquedata[l]=1,e[t].countunique+=1))},dataHandler:function(e,n,t,l,o){let a=this,s=Oe(),u=s.filter,f=s.pivotTable;if(l==null&&(l="column"),e.length==0&&n.length==0&&t.length==0||o.length==0)return a.pivotDatas=[],[];let m={},d=o,g=[],b=[],y={},p=0,x=[],_=[],S={},I=0;for(let z=1;z<d.length;z++){let A=d[z],M="",P="",N="",E=[],B=[],U="",X=[],le=[];B=a.getnameArray(A,n),le=a.getnameArray(A,e),E=a.getComposeArray(B),X=a.getComposeArray(le),E.length>0&&E.unshift(f.valueSum),X.length>0&&X.unshift(f.valueSum);let he=y,Z=b;for(let K=0;K<E.length;K++){let se=E[K],te=K==0?f.valueSum:B[K-1];if(he[K.toString()]!=null&&he[K.toString()][se]!=null)Z=Z[he[K.toString()][se]].children;else{let re=K==0?"self":n[K-1].orderby=="self"||n[K-1].orderby==null?se:l=="column"?se+t[parseInt(n[K-1].orderby)].fullname:se+f.valueSum;te==null&&(te=u.valueBlank),Z.push({name:te,fullname:se,index:K,orderby:re,children:[]}),he[K.toString()]==null&&(he[K.toString()]={}),he[K.toString()][se]==null&&(he[K.toString()][se]=Z.length-1),Z=Z[Z.length-1].children}}let ae=S,J=_;for(let K=0;K<X.length;K++){let se=X[K],te=K==0?f.valueSum:le[K-1];if(ae[K.toString()]!=null&&ae[K.toString()][se]!=null)J=J[ae[K.toString()][se]].children;else{let re=K==0?"self":e[K-1].orderby=="self"||e[K-1].orderby==null?se:l=="column"?f.valueSum+se:t[parseInt(e[K-1].orderby)].fullname+se;te==null&&(te=u.valueBlank),J.push({name:te,fullname:se,index:K,orderby:re,children:[]}),ae[K.toString()]==null&&(ae[K.toString()]={}),ae[K.toString()][se]==null&&(ae[K.toString()][se]=J.length-1),J=J[J.length-1].children}}let pe="";for(let K=0;K<t.length;K++){let se=Mt(t[K].index,null,A),te=[].concat(X),re=[].concat(E);l=="column"?te.length>0?(te.push(""),te=te.join(t[K].fullname+"|||").split("|||").slice(0,te.length-1)):te.push(t[K].fullname):re.length>0?(re.push(""),re=re.join(t[K].fullname+"|||").split("|||").slice(0,re.length-1)):re.push(t[K].fullname),te.length==0&&te.push(""),re.length==0&&re.push("");for(let fe=0;fe<re.length;fe++)for(let Me=0;Me<te.length;Me++){let ye=re[fe]+te[Me];a.addStatisticsData(m,t[K],ye,se)}}}for(let z in m){let A=m[z];if(A.sumtype=="SUM")A.result=A.sum;else if(A.sumtype=="COUNT")A.result=A.count;else if(A.sumtype=="COUNTA")A.result=A.counta;else if(A.sumtype=="COUNTUNIQUE")A.result=A.countunique;else if(A.sumtype=="AVERAGE")A.result=Fn(A.sum/A.count);else if(A.sumtype=="MAX")A.result=A.max;else if(A.sumtype=="MIN")A.result=A.min;else if(A.sumtype=="MEDIAN"){let P=A.digitaldata.sort(function(B,U){return B-U}),N=P.length,E=parseInt(N/2);N%2==0?A.result=(P[E-1]+P[E])/2:A.result=P[E]}else if(A.sumtype=="PRODUCT")A.result=new Function("return "+A.digitaldata.join("*"))();else if(A.sumtype=="STDEV"){let P=A.sum/A.count;A.result=Nu.STDEV(P,A.digitaldata)}else if(A.sumtype=="STDEVP"){let P=A.sum/A.count;A.result=Nu.STDEVP(P,A.digitaldata)}else if(A.sumtype=="let"){let P=A.sum/A.count;A.result=Nu.let(P,A.digitaldata)}else if(A.sumtype=="VARP"){let P=A.sum/A.count;A.result=Nu.VARP(P,A.digitaldata)}let M=Um(A.result);M>A.acc&&(A.acc=M),A.result=Fn(A.result,A.acc)}if(g=a.getTitleFromGroup(b,n,m),x=a.getTitleFromGroup(_,e,m),l=="column")if(x.length>0&&x[0].length>0)x=a.addValuesToTitle(x,t);else for(let z=0;z<t.length;z++)x.push([t[z].fullname]);else if(g.length>0&&g[0].length>0)g=a.addValuesToTitle(g,t);else for(let z=0;z<t.length;z++)g.push([t[z].fullname]);let O=x;x=qy.transpose(x,!1);let F=t.length==0?0:1,D=(x.length==0?F:x.length)+(g.length==0?F:g.length),k=(x.length==0?F:x[0].length)+(g.length==0?F:g[0].length),w=x.length,C=g.length==0?0:g[0].length,T=[];for(let z=0;z<D;z++){T[z]=new Array(k);for(let A=0;A<k;A++){let M=g[z-w];if(z<w&&A<C)T[z][A]="";else if(z<w&&A>=C)x[z]!=null?V(x[z][A-C])=="object"?T[z][A]=x[z][A-C].name+f.valueSum:T[z][A]=x[z][A-C]:T[z][A]="";else if(z>=w&&A<C)M!=null?V(M[A])=="object"?T[z][A]=M[A].name+f.valueSum:T[z][A]=M[A]:T[z][A]="";else{let P="";if(M!=null)if(!(M instanceof Array)||M.length==1)M instanceof Array?P=M[0]:P=M;else for(let U=0;U<M.length;U++)V(M[U])=="object"?P+=M[U].name:P+=M[U];let N="",E=O[A-C];if(E!=null)if(!(E instanceof Array)||E.length==1)E instanceof Array?N=E[0]:N=E;else for(let U=0;U<E.length;U++)V(E[U])=="object"?N+=E[U].name:N+=E[U];let B=P;P!=""&&N!=""?B=P+N:P==""&&(B=N),m[B]==null?T[z][A]="":T[z][A]=m[B].result}}}if(t.length==1&&e.length>0&&n.length>0)T[0][0]=t[0].fullname,T.splice(e.length,1);else if(t.length==1&&e.length>0){let z=T.splice(e.length,1),A=[];for(let M=0;M<T.length;M++){let P=[];M==T.length-1?P.push(z[0][0]):P.push("");for(let N=0;N<T[M].length-1;N++)P.push(T[M][N]);A.push(P)}T=A}return a.pivotDatas=T,T},drillDown:function(e,n){if(!Hl(h.currentSheetIndex,"usePivotTablereports"))return;let t=this,l=t.pivotDatas[e][n],o=$.extend(!0,[],ct.nulldata),a=Oe(),s=a.filter,u=a.pivotTable,f=1;for(let g=0;g<t.celldata[0].length;g++){let b;!!t.celldata[0][g]&&!!t.celldata[0][g].m?b=t.celldata[0][g].m:b=Mt(0,g,t.celldata),b!=null&&(b=b.toString()),(b==null||$.trim(b.toString()).length==0)&&(b=u.titleColumn+" "+f),f++,o[0][g]=b}let m={};if(t.row!=null&&t.row.length>0)for(let g=0;g<t.row.length;g++)m[t.row[g].index]=t.pivotDatas[e][g];if(t.column!=null&&t.column.length>0)for(let g=0;g<t.column.length;g++)m[t.column[g].index]=t.pivotDatas[g][n];let d=[];for(let g=1;g<t.celldata.length;g++){let b=!0;for(let y in m){let p;if(!!t.celldata[g][y]&&!!t.celldata[g][y].m?p=t.celldata[g][y].m:p=Mt(g,y,t.celldata),p!=null?p=p.toString():p=s.valueBlank,p!=m[y]){b=!1;break}}b&&d.push(g)}for(let g=0;g<d.length;g++)for(let b=0;b<t.celldata[0].length;b++){let y;!!t.celldata[d[g]][b]&&!!t.celldata[d[g]][b].m?y=t.celldata[d[g]][b].m:y=Mt(d[g],b,t.celldata),y!=null?y=y.toString():y="",o[g+1][b]=y}h.luckysheet_select_save=[{row:[0,d.length],column:[0,t.celldata[0].length-1]}],h.clearjfundo=!1,Gt(o,h.luckysheet_select_save),Zt(),h.clearjfundo=!0}},Pt=Ky});var import_plugin,Jy,Kx,Hu,Gm,Ym,qm,ph,Qy,Jx,Qx,Bu,so,e1,e3,t3,hi,Xm=Tt(()=>{import_plugin=Le(Be());Ut();Jy=function(){let e,n;return e=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(e.prototype=$.extend(new arguments[0],arguments[arguments.length-1]),e._super=arguments[0].prototype):e.prototype=arguments[arguments.length-1],arguments.length>2&&(n=Array.prototype.slice.call(arguments,1,-1),n.unshift(e.prototype),$.extend.apply($,n))):e.prototype=arguments[0],e.prototype.cls=e,e},Kx=Jy({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(e,n){this.format=e,this.fclass=n},render:function(e,n,t){let l=this,o=e,a,s,u,f,m;return this.format.replace(this.fre,function(){let d;return s=arguments[1],u=arguments[3],a=l.precre.exec(s),a?(m=a[2],s=a[1]):m=!1,f=o[s],f===void 0?"":u&&n&&n[u]?(d=n[u],d.get?n[u].get(f)||f:n[u][f]||f):(Jx(f)&&(t.get("numberFormatter")?f=t.get("numberFormatter")(f):f=Qx(f,m,t.get("numberDigitGroupCount"),t.get("numberDigitGroupSep"),t.get("numberDecimalMark"))),f)})}});$.spformat=function(e,n){return new Kx(e,n)};Hu=function(e,n,t){return e<n?n:e>t?t:e},Gm=function(e,n){let t;return n===2?(t=Math.floor(e.length/2),e.length%2?e[t]:(e[t-1]+e[t])/2):e.length%2?(t=(e.length*n+n)/4,t%1?(e[Math.floor(t)]+e[Math.floor(t)-1])/2:e[t-1]):(t=(e.length*n+2)/4,t%1?(e[Math.floor(t)]+e[Math.floor(t)-1])/2:e[t-1])},Ym=function(e){let n;switch(e){case"undefined":e=void 0;break;case"null":e=null;break;case"true":e=!0;break;case"false":e=!1;break;default:n=parseFloat(e),e==n&&(e=n)}return e},qm=function(e){let n,t=[];for(n=e.length;n--;)t[n]=Ym(e[n]);return t},ph=function(e,n,t){let l;for(l=n.length;l--;)if(!(t&&n[l]===null)&&n[l]!==e)return!1;return!0},Qy=function(e,n){let t,l,o=[];for(t=0,l=e.length;t<l;t++)e[t]!==n&&o.push(e[t]);return o},Jx=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},Qx=function(e,n,t,l,o){let a,s;for(e=(n===!1?parseFloat(e).toString():e.toFixed(n)).split(""),a=(a=$.inArray(".",e))<0?e.length:a,a<e.length&&(e[a]=o),s=a-t;s>0;s-=t)e.splice(s,0,l);return e.join("")},Bu=Jy({init:function(e){let n,t,l=[];for(n in e)e.hasOwnProperty(n)&&typeof n=="string"&&n.indexOf(":")>-1&&(t=n.split(":"),t[0]=t[0].length===0?-Infinity:parseFloat(t[0]),t[1]=t[1].length===0?Infinity:parseFloat(t[1]),t[2]=e[n],l.push(t));this.map=e,this.rangelist=l||!1},get:function(e){let n=this.rangelist,t,l,o;if((o=this.map[e])!==void 0)return o;if(n){for(t=n.length;t--;)if(l=n[t],l[0]<=e&&l[1]>=e)return l[2]}}});$.range_map=function(e){return new Bu(e)};so={defaultOption:{common:{type:"line",lineColor:"#2ec7c9",fillColor:"#CCF3F4",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!0,disableInteraction:!0,offsetX:0,offsetY:0},line:{spotColor:0,highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:0,maxSpotColor:0,lineWidth:1,normalRangeMin:void 0,normalRangeMax:void 0,normalRangeColor:"#ccc",drawNormalOnTop:!0,chartRangeMin:void 0,chartRangeMax:void 0,chartRangeMinX:void 0,chartRangeMaxX:void 0},bar:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},column:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},tristate:{barWidth:4,barSpacing:1,posBarColor:"#fc5c5c",negBarColor:"#97b552",zeroBarColor:"#999",colorMap:{}},discrete:{lineHeight:"auto",thresholdColor:"#fc5c5c",thresholdValue:0,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff","#6D87FF","#5876FF","#4465FF","#2F54FF","#1A43FF","#0532FF"],base:void 0},pie:{offset:0,sliceColors:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],borderWidth:0,borderColor:"#000"},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#5E5E5E",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:void 0,targetColor:"#4a2",chartRangeMax:void 0,chartRangeMin:void 0}},line:{type:"line",init:function(e,n,t,l,o){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null},getRegion:function(e,n,t){let l,o=this.regionMap;for(l=o.length;l--;)if(o[l]!==null&&n>=o[l][0]&&n<=o[l][1])return o[l][2]},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.yvalues[e]===null,x:this.xvalues[e],y:this.yvalues[e],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:e}},renderHighlight:function(){let e=this.currentRegion,n=this.target,t=this.vertices[e],l=this.options,o=l.get("spotRadius"),a=l.get("highlightSpotColor"),s=l.get("highlightLineColor"),u,f;!t||(o&&a&&(u=n.drawCircle(t[0],t[1],o,void 0,a),this.highlightSpotId=u.id,n.insertAfterShape(this.lastShapeId,u)),s&&(f=n.drawLine(t[0],this.canvasTop,t[0],this.canvasTop+this.canvasHeight,s),this.highlightLineId=f.id,n.insertAfterShape(this.lastShapeId,f)))},removeHighlight:function(){let e=this.target;this.highlightSpotId&&(e.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(e.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){let e=this.values,n=e.length,t=this.xvalues,l=this.yvalues,o=this.yminmax,a,s,u,f,m;for(a=0;a<n;a++)s=e[a],u=typeof e[a]=="string",f=typeof e[a]=="object"&&e[a]instanceof Array,m=u&&e[a].split(":"),u&&m.length===2?(t.push(Number(m[0])),l.push(Number(m[1])),o.push(Number(m[1]))):f?(t.push(s[0]),l.push(s[1]),o.push(s[1])):(t.push(a),e[a]===null||e[a]==="null"?l.push(null):(l.push(Number(s)),o.push(Number(s))));this.options.get("xvalues")&&(t=this.options.get("xvalues")),this.maxy=this.maxyorg=Math.max.apply(Math,o),this.miny=this.minyorg=Math.min.apply(Math,o),this.maxx=Math.max.apply(Math,t),this.minx=Math.min.apply(Math,t),this.xvalues=t,this.yvalues=l,this.yminmax=o},processRangeOptions:function(){let e=this.options,n=e.get("normalRangeMin"),t=e.get("normalRangeMax");n!==void 0&&(n<this.miny&&(this.miny=n),t>this.maxy&&(this.maxy=t)),e.get("chartRangeMin")!==void 0&&(e.get("chartRangeClip")||e.get("chartRangeMin")<this.miny)&&(this.miny=e.get("chartRangeMin")),e.get("chartRangeMax")!==void 0&&(e.get("chartRangeClip")||e.get("chartRangeMax")>this.maxy)&&(this.maxy=e.get("chartRangeMax")),e.get("chartRangeMinX")!==void 0&&(e.get("chartRangeClipX")||e.get("chartRangeMinX")<this.minx)&&(this.minx=e.get("chartRangeMinX")),e.get("chartRangeMaxX")!==void 0&&(e.get("chartRangeClipX")||e.get("chartRangeMaxX")>this.maxx)&&(this.maxx=e.get("chartRangeMaxX"))},drawNormalRange:function(e,n,t,l,o){let a=this.options.get("normalRangeMin"),s=this.options.get("normalRangeMax"),u=n+Math.round(t-t*((s-this.miny)/o)),f=Math.round(t*(s-a)/o);f==0&&a==s&&(f=1),this.target.drawRect(e,u,l,f,void 0,this.options.get("normalRangeColor")).append()},render:function(e,n){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.values=n;let t=this.options,l=this.target,o=e.mergedOptions.width,a=e.mergedOptions.height,s=this.vertices,u=t.get("spotRadius"),f=this.regionMap,m,d,g,b,y,p,x,_,S,I,O,F,D,k,w,C,T,z,A,M,P,N,E,B,U;if(this.scanValues(),this.processRangeOptions(),E=this.xvalues,B=this.yvalues,!(!this.yminmax.length||this.yvalues.length<2)){for(b=y=0,m=this.maxx-this.minx==0?1:this.maxx-this.minx,d=this.maxy-this.miny==0?1:this.maxy-this.miny,g=this.yvalues.length-1,u&&(o<u*4||a<u*4)&&(u=0),u&&(P=t.get("highlightSpotColor")&&!t.get("disableInteraction"),(P||t.get("minSpotColor")||t.get("spotColor")&&B[g]===this.miny)&&(a-=Math.ceil(u)),(P||t.get("maxSpotColor")||t.get("spotColor")&&B[g]===this.maxy)&&(a-=Math.ceil(u),b+=Math.ceil(u)),(P||(t.get("minSpotColor")||t.get("maxSpotColor"))&&(B[0]===this.miny||B[0]===this.maxy))&&(y+=Math.ceil(u),o-=Math.ceil(u)),(P||t.get("spotColor")||t.get("minSpotColor")||t.get("maxSpotColor")&&(B[g]===this.miny||B[g]===this.maxy))&&(o-=Math.ceil(u))),a--,t.get("normalRangeMin")!==void 0&&!t.get("drawNormalOnTop")&&this.drawNormalRange(y,b,a,o,d),x=[],_=[x],k=w=null,C=B.length,U=0;U<C;U++)S=E[U],O=E[U+1],I=B[U],F=y+Math.round((S-this.minx)*(o/m)),D=U<C-1?y+Math.round((O-this.minx)*(o/m)):o,w=F+(D-F)/2,f[U]=[k||0,w,U],k=w,I===null?U&&(B[U-1]!==null&&(x=[],_.push(x)),s.push(null)):(I<this.miny&&(I=this.miny),I>this.maxy&&(I=this.maxy),x.length||x.push([F,b+a]),p=[F,b+Math.round(a-a*((I-this.miny)/d))],x.push(p),s.push(p));for(T=[],z=[],A=_.length,U=0;U<A;U++)x=_[U],x.length&&(t.get("fillColor")&&(x.push([x[x.length-1][0],b+a]),z.push(x.slice(0)),x.pop()),x.length>2&&(x[0]=[x[0][0],x[1][1]]),T.push(x));for(A=z.length,U=0;U<A;U++)l.drawShape(z[U],t.get("fillColor"),t.get("fillColor")).append();for(A=T.length,U=0;U<A;U++)l.drawShape(T[U],t.get("lineColor"),void 0,t.get("lineWidth")).append();if(t.get("normalRangeMin")!==void 0&&t.get("drawNormalOnTop")&&this.drawNormalRange(y,b,a,o,d),u&&t.get("valueSpots"))for(M=t.get("valueSpots"),M.get===void 0&&(M=new Bu(M)),U=0;U<C;U++)N=M.get(B[U]),N&&l.drawCircle(y+Math.round((E[U]-this.minx)*(o/m)),b+Math.round(a-a*((B[U]-this.miny)/d)),u,void 0,N).append();u&&t.get("spotColor")&&B[g]!==null&&l.drawCircle(y+Math.round((E[E.length-1]-this.minx)*(o/m)),b+Math.round(a-a*((B[g]-this.miny)/d)),u,void 0,t.get("spotColor")).append(),this.maxy!==this.minyorg&&(u&&t.get("minSpotColor")&&(S=E[$.inArray(this.minyorg,B)],l.drawCircle(y+Math.round((S-this.minx)*(o/m)),b+Math.round(a-a*((this.minyorg-this.miny)/d)),u,void 0,t.get("minSpotColor")).append()),u&&t.get("maxSpotColor")&&(S=E[$.inArray(this.maxyorg,B)],l.drawCircle(y+Math.round((S-this.minx)*(o/m)),b+Math.round(a-a*((this.maxyorg-this.miny)/d)),u,void 0,t.get("maxSpotColor")).append()))}}},bar:{type:"bar",init:function(e,n){let t=this.options,l=e.mergedOptions.height,o=e.mergedOptions.width;this.canvasWidth=e.mergedOptions.height,this.canvasHeight=e.mergedOptions.width;let a=parseInt(t.get("barWidth"),10),s=parseInt(t.get("barSpacing"),10),u=t.get("chartRangeMin"),f=t.get("chartRangeMax"),m=t.get("chartRangeClip"),d=Infinity,g=-Infinity,b,y,p,x,_,S,I,O,F,D,k,w,C,T,z,A,M,P,N,E,B,U,X;for(this.values=n,S=0,I=n.length;S<I;S++)E=n[S],b=typeof E=="string"&&E.indexOf(":")>-1,(b||$.isArray(E))&&(z=!0,b&&(E=n[S]=qm(E.split(":"))),E=Qy(E,null),y=Math.min.apply(Math,E),p=Math.max.apply(Math,E),y<d&&(d=y),p>g&&(g=p));this.stacked=z,this.regionShapes={},this.barWidth=Math.floor(l/n.length)-s,this.barSpacing=s,this.totalBarWidth=this.barWidth+s,this.width=l,m&&(C=u===void 0?-Infinity:u,T=f===void 0?Infinity:f),_=[],x=z?[]:_;let le=[],he=[];for(S=0,I=n.length;S<I;S++)if(z)for(A=n[S],n[S]=N=[],le[S]=0,x[S]=he[S]=0,M=0,P=A.length;M<P;M++)E=N[M]=m?Hu(A[M],C,T):A[M],E!==null&&(E>0&&(le[S]+=E),d<0&&g>0?E<0?he[S]+=Math.abs(E):x[S]+=E:x[S]+=Math.abs(E),_.push(E));else E=m?Hu(n[S],C,T):n[S],E=n[S]=Ym(E),E!==null&&_.push(E);this.max=w=Math.max.apply(Math,_),this.min=k=Math.min.apply(Math,_),this.stackMax=g=z?Math.max.apply(Math,le):w,this.stackMin=d=z?Math.min.apply(Math,_):k,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<k)&&(k=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>w)&&(w=t.get("chartRangeMax")),this.zeroAxis=F=t.get("zeroAxis",!0),k<=0&&w>=0&&F?D=0:F==!1?D=k:k>0?D=0:D=w,this.xaxisOffset=D,O=z?Math.max.apply(Math,x)+Math.max.apply(Math,he):w-D,this.canvasHeightEf=F&&k<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,k<D?(B=Math.floor(this.canvasHeight/2),this.isNeg=!0,B!==Math.ceil(B)&&(this.canvasHeightEf-=2,B=Math.ceil(B))):B=0,this.yoffset=B,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new Bu(this.colorMapByValue))),this.range=O},getRegion:function(e,n,t){let l=Math.floor(n/this.totalBarWidth);return l<0||l>=this.values.length?void 0:l},getCurrentRegionFields:function(){let e=this.currentRegion,n=ensureArray(this.values[e]),t=[],l,o;for(o=n.length;o--;)l=n[o],t.push({isNull:l===null,value:l,color:this.calcColor(o,l,e),offset:e});return t},calcColor:function(e,n,t){let l=this.colorMapByIndex,o=this.colorMapByValue,a=this.options,s,u;return this.stacked?s=a.get("stackedBarColor"):s=n<0?a.get("negBarColor"):a.get("barColor"),n===0&&a.get("zeroColor")!==void 0&&(s=a.get("zeroColor")),o&&(u=o.get(n))?s=u:l&&l.length>t&&(s=l[t]),$.isArray(s)?s[e%s.length]:s},renderRegion:function(e,n){let t=this.values[e],l=this.options,o=this.xaxisOffset,a=[],s=this.range,u=this.stacked,f=this.target,m=e*this.totalBarWidth,d=this.canvasHeightEf,g=this.yoffset,b,y,p,x,_,S,I,O,F,D;if(t=$.isArray(t)?t:[t],I=t.length,O=t[0],x=ph(null,t),D=ph(o,t,!0),x)return l.get("nullColor")?(p=n?l.get("nullColor"):this.calcHighlightColor(l.get("nullColor"),l),b=g>0?g-1:g,f.drawRect(b,m,0,this.barWidth-1,p,p)):void 0;for(_=g,this.isNeg&&(d=Math.floor(d/2)),S=0;S<I;S++){if(O=t[S],u&&O===o){if(!D||F)continue;F=!0}s>0?y=Math.floor(d*(Math.abs(O-o)/s)):y=d,O<o||O===o&&g===0?(b=_-y,_+=y):u?(b=g,g+=y):(b=g,g-=y),p=this.calcColor(S,O,e),n&&(p=this.calcHighlightColor(p,l)),a.push(f.drawRect(b,m,y-1,this.barWidth-1,p,p))}return a.length===1?a[0]:a}},column:{type:"column",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a=parseInt(t.get("barWidth"),10),s=parseInt(t.get("barSpacing"),10),u=t.get("chartRangeMin"),f=t.get("chartRangeMax"),m=t.get("chartRangeClip"),d=Infinity,g=-Infinity,b,y,p,x,_,S,I,O,F,D,k,w,C,T,z,A,M,P,N,E,B,U,X;for(this.values=n,S=0,I=n.length;S<I;S++)E=n[S],b=typeof E=="string"&&E.indexOf(":")>-1,(b||$.isArray(E))&&(z=!0,b&&(E=n[S]=qm(E.split(":"))),E=Qy(E,null),y=Math.min.apply(Math,E),p=Math.max.apply(Math,E),y<d&&(d=y),p>g&&(g=p));this.stacked=z,this.regionShapes={},this.barWidth=Math.floor(l/n.length)-s,this.barSpacing=s,this.totalBarWidth=this.barWidth+s,this.width=l,m&&(C=u===void 0?-Infinity:u,T=f===void 0?Infinity:f),_=[],x=z?[]:_;let le=[],he=[];for(S=0,I=n.length;S<I;S++)if(z)for(A=n[S],n[S]=N=[],le[S]=0,x[S]=he[S]=0,M=0,P=A.length;M<P;M++)E=N[M]=m?Hu(A[M],C,T):A[M],E!==null&&(E>0&&(le[S]+=E),d<0&&g>0?E<0?he[S]+=Math.abs(E):x[S]+=E:x[S]+=Math.abs(E),_.push(E));else E=m?Hu(n[S],C,T):n[S],E=n[S]=Ym(E),E!==null&&_.push(E);this.max=w=Math.max.apply(Math,_),this.min=k=Math.min.apply(Math,_),this.stackMax=g=z?Math.max.apply(Math,le):w,this.stackMin=d=z?Math.min.apply(Math,_):k,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<k)&&(k=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>w)&&(w=t.get("chartRangeMax")),this.zeroAxis=F=t.get("zeroAxis",!0),k<=0&&w>=0&&F?D=0:F==!1?D=k:k>0?D=0:D=w,this.xaxisOffset=D,O=z?Math.max.apply(Math,x)+Math.max.apply(Math,he):w-D,this.canvasHeightEf=F&&k<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,k<D?(B=Math.floor(this.canvasHeight/2),this.isNeg=!0,B!==Math.ceil(B)&&(this.canvasHeightEf-=2,B=Math.ceil(B))):B=this.canvasHeight,this.yoffset=B,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new Bu(this.colorMapByValue))),this.range=O},getRegion:function(e,n,t){let l=Math.floor(n/this.totalBarWidth);return l<0||l>=this.values.length?void 0:l},getCurrentRegionFields:function(){let e=this.currentRegion,n=ensureArray(this.values[e]),t=[],l,o;for(o=n.length;o--;)l=n[o],t.push({isNull:l===null,value:l,color:this.calcColor(o,l,e),offset:e});return t},calcColor:function(e,n,t){let l=this.colorMapByIndex,o=this.colorMapByValue,a=this.options,s,u;return this.stacked?s=a.get("stackedBarColor"):s=n<0?a.get("negBarColor"):a.get("barColor"),n===0&&a.get("zeroColor")!==void 0&&(s=a.get("zeroColor")),o&&(u=o.get(n))?s=u:l&&l.length>t&&(s=l[t]),$.isArray(s)?s[e%s.length]:s},renderRegion:function(e,n){let t=this.values[e],l=this.options,o=this.xaxisOffset,a=[],s=this.range,u=this.stacked,f=this.target,m=e*this.totalBarWidth,d=this.canvasHeightEf,g=this.yoffset,b,y,p,x,_,S,I,O,F,D;if(t=$.isArray(t)?t:[t],I=t.length,O=t[0],x=ph(null,t),D=ph(o,t,!0),x)return l.get("nullColor")?(p=n?l.get("nullColor"):this.calcHighlightColor(l.get("nullColor"),l),b=g>0?g-1:g,f.drawRect(m,b,this.barWidth-1,0,p,p)):void 0;for(_=g,this.isNeg&&(d=Math.floor(d/2)),S=0;S<I;S++){if(O=t[S],u&&O===o){if(!D||F)continue;F=!0}s>0?y=Math.floor(d*(Math.abs(O-o)/s)):y=d,O<o||O===o&&g===0?(b=_,_+=y):(b=g-y,g-=y),p=this.calcColor(S,O,e),n&&(p=this.calcHighlightColor(p,l)),a.push(f.drawRect(m,b,this.barWidth-1,y-1,p,p))}return a.length===1?a[0]:a}},tristate:{type:"tristate",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a=parseInt(t.get("barWidth"),10),s=parseInt(t.get("barSpacing"),10);this.regionShapes={},this.barWidth=a,this.barSpacing=s,this.totalBarWidth=a+s,this.values=$.map(n,Number),this.width=l=n.length*a+(n.length-1)*s,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new Bu(this.colorMapByValue)))},getRegion:function(e,n,t){return Math.floor(n/this.totalBarWidth)},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],color:this.calcColor(this.values[e],e),offset:e}},calcColor:function(e,n){let t=this.values,l=this.options,o=this.colorMapByIndex,a=this.colorMapByValue,s,u;return a&&(u=a.get(e))?s=u:o&&o.length>n?s=o[n]:t[n]<0?s=l.get("negBarColor"):t[n]>0?s=l.get("posBarColor"):s=l.get("zeroBarColor"),s},renderRegion:function(e,n){let t=this.values,l=this.options,o=this.target,a,s,u,f,m,d;if(a=this.canvasHeight,u=Math.round(a/2),f=e*this.totalBarWidth,t[e]<0?(m=u,s=u-1):t[e]>0?(m=0,s=u-1):(m=u-1,s=2),d=this.calcColor(t[e],e),d!==null)return n&&(d=this.calcHighlightColor(d,l)),o.drawRect(f,m,this.barWidth-1,s-1,d,d)}},discrete:{type:"discrete",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.regionShapes={},this.values=n=$.map(n,Number),this.min=Math.min.apply(Math,n),this.max=Math.max.apply(Math,n),this.range=this.max-this.min,this.width=l,this.interval=Math.floor(l/n.length),this.itemWidth=l/n.length,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.min)&&(this.min=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.max)&&(this.max=t.get("chartRangeMax")),this.target&&(this.lineHeight=t.get("lineHeight")==="auto"?Math.round(this.canvasHeight*.3):t.get("lineHeight"))},getRegion:function(e,n,t){return Math.floor(n/this.itemWidth)},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],offset:e}},renderRegion:function(e,n){let t=this.values,l=this.options,o=this.min,a=this.max,s=this.range,u=this.interval,f=this.target,m=this.canvasHeight,d=this.lineHeight,g=m-d,b,y,p,x;return y=Hu(t[e],o,a),x=e*u,b=Math.round(g-g*((y-o)/s)),p=l.get("thresholdColor")&&y<l.get("thresholdValue")?l.get("thresholdColor"):l.get("lineColor"),n&&(p=this.calcHighlightColor(p,l)),this.target.drawRect(x,b,u<=2?1:u-2,d,p,p)}},bullet:{type:"bullet",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a,s,u;this.values=n=qm(n),u=n.slice(),u[0]=u[0]===null?u[2]:u[0],u[1]=n[1]===null?u[2]:u[1],a=Math.min.apply(Math,n),s=Math.max.apply(Math,n),t.get("base")===void 0?a=a<0?a:0:a=t.get("base"),this.min=a,this.max=s,this.range=s-a,this.shapes={},this.valueShapes={},this.regiondata={},this.width=l,n.length||(this.disabled=!0)},getRegion:function(e,n,t){let l=this.target.getShapeAt(e,n,t);return l!==void 0&&this.shapes[l]!==void 0?this.shapes[l]:void 0},getCurrentRegionFields:function(){let e=this.currentRegion;return{fieldkey:e.substr(0,1),value:this.values[e.substr(1)],region:e}},changeHighlight:function(e){let n=this.currentRegion,t=this.valueShapes[n],l;switch(delete this.shapes[t],n.substr(0,1)){case"r":l=this.renderRange(n.substr(1),e);break;case"p":l=this.renderPerformance(e);break;case"t":l=this.renderTarget(e);break}this.valueShapes[n]=l.id,this.shapes[l.id]=n,this.target.replaceWithShape(t,l)},renderRange:function(e,n){let t=this.values[e],l=Math.round(this.canvasWidth*((t-this.min)/this.range)),o=this.options.get("rangeColors")[e-2];return n&&(o=this.calcHighlightColor(o,this.options)),this.target.drawRect(0,0,l-1,this.canvasHeight-1,o,o)},renderPerformance:function(e){let n=this.values[1],t=Math.round(this.canvasWidth*((n-this.min)/this.range)),l=this.options.get("performanceColor");return e&&(l=this.calcHighlightColor(l,this.options)),this.target.drawRect(0,Math.round(this.canvasHeight*.3),t-1,Math.round(this.canvasHeight*.4)-1,l,l)},renderTarget:function(e){let n=this.values[0],t=Math.round(this.canvasWidth*((n-this.min)/this.range)-this.options.get("targetWidth")/2),l=Math.round(this.canvasHeight*.1),o=this.canvasHeight-l*2,a=this.options.get("targetColor");return e&&(a=this.calcHighlightColor(a,this.options)),this.target.drawRect(t,l,this.options.get("targetWidth")-1,o-1,a,a)},render:function(e,n){this.init(e,n);let t=this.values.length,l=this.target,o,a;for(o=2;o<t;o++)a=this.renderRange(o).append(),this.shapes[a.id]="r"+o,this.valueShapes["r"+o]=a.id;this.values[1]!==null&&(a=this.renderPerformance().append(),this.shapes[a.id]="p1",this.valueShapes.p1=a.id),this.values[0]!==null&&(a=this.renderTarget().append(),this.shapes[a.id]="t0",this.valueShapes.t0=a.id)}},pie:{type:"pie",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a=0,s;if(this.shapes={},this.valueShapes={},this.values=n=$.map(n,Number),t.get("width")==="auto"&&(this.width=this.height),n.length>0)for(s=n.length;s--;)a+=n[s];this.total=a,this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(e,n,t){let l=this.target.getShapeAt(e,n,t);return l!==void 0&&this.shapes[l]!==void 0?this.shapes[l]:void 0},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],percent:this.values[e]/this.total*100,color:this.options.get("sliceColors")[e%this.options.get("sliceColors").length],offset:e}},changeHighlight:function(e){let n=this.currentRegion,t=this.renderSlice(n,e),l=this.valueShapes[n];delete this.shapes[l],this.target.replaceWithShape(l,t),this.valueShapes[n]=t.id,this.shapes[t.id]=n},renderSlice:function(e,n){let t=this.target,l=this.options,o=this.radius,a=l.get("borderWidth"),s=l.get("offset"),u=2*Math.PI,f=this.values,m=this.total,d=s?2*Math.PI*(s/360):0,g,b,y,p,x;for(p=f.length,y=0;y<p;y++){if(g=d,b=d,m>0&&(b=d+u*(f[y]/m)),e===y)return x=l.get("sliceColors")[y%l.get("sliceColors").length],n&&(x=this.calcHighlightColor(x,l)),t.drawPieSlice(o,o,o-a,g,b,void 0,x);d=b}},render:function(e,n){this.init(e,n);let t=this.target,l=this.values,o=this.options,a=this.radius,s=o.get("borderWidth"),u,f;for(s&&t.drawCircle(a,a,Math.floor(a-s/2),o.get("borderColor"),void 0,s).append(),f=l.length;f--;)l[f]&&(u=this.renderSlice(f).append(),this.valueShapes[f]=u.id,this.shapes[u.id]=f)}},box:{type:"box",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.values=$.map(n,Number),this.width=t.get("width")==="auto"?"4.0em":l,this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){let e=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==void 0&&e.push({field:"lo",value:this.loutlier}),this.routlier!==void 0&&e.push({field:"ro",value:this.routlier}),this.lwhisker!==void 0&&e.push({field:"lw",value:this.lwhisker}),this.rwhisker!==void 0&&e.push({field:"rw",value:this.rwhisker}),e},render:function(e,n){this.init(e,n);let t=this.target,l=this.values,o=l.length,a=this.options,s=this.canvasWidth,u=this.canvasHeight,f=a.get("chartRangeMin")===void 0?Math.min.apply(Math,l):a.get("chartRangeMin"),m=a.get("chartRangeMax")===void 0?Math.max.apply(Math,l):a.get("chartRangeMax"),d=0,g,b,y,p,x,_,S,I,O,F,D;if(a.get("raw"))a.get("showOutliers")&&l.length>5?(b=l[0],g=l[1],p=l[2],x=l[3],_=l[4],S=l[5],I=l[6]):(g=l[0],p=l[1],x=l[2],_=l[3],S=l[4]);else if(l.sort(function(k,w){return k-w}),p=Gm(l,1),x=Gm(l,2),_=Gm(l,3),y=_-p,a.get("showOutliers")){for(g=S=void 0,O=0;O<o;O++)g===void 0&&l[O]>p-y*a.get("outlierIQR")&&(g=l[O]),l[O]<_+y*a.get("outlierIQR")&&(S=l[O]);b=l[0],I=l[o-1]}else g=l[0],S=l[o-1];this.quartiles=[p,x,_],this.lwhisker=g,this.rwhisker=S,this.loutlier=b,this.routlier=I,D=s/(m-f+1),a.get("showOutliers")&&(d=Math.ceil(a.get("spotRadius")),s-=2*Math.ceil(a.get("spotRadius")),D=s/(m-f+1),b<g&&t.drawCircle((b-f)*D+d,u/2,a.get("spotRadius"),a.get("outlierLineColor"),a.get("outlierFillColor")).append(),I>S&&t.drawCircle((I-f)*D+d,u/2,a.get("spotRadius"),a.get("outlierLineColor"),a.get("outlierFillColor")).append()),t.drawRect(Math.round((p-f)*D+d),Math.round(u*.1),Math.round((_-p)*D),Math.round(u*.8),a.get("boxLineColor"),a.get("boxFillColor")).append(),t.drawLine(Math.round((g-f)*D+d),Math.round(u/2),Math.round((p-f)*D+d),Math.round(u/2),a.get("lineColor")).append(),t.drawLine(Math.round((g-f)*D+d),Math.round(u/4),Math.round((g-f)*D+d),Math.round(u-u/4),a.get("whiskerColor")).append(),t.drawLine(Math.round((S-f)*D+d),Math.round(u/2),Math.round((_-f)*D+d),Math.round(u/2),a.get("lineColor")).append(),t.drawLine(Math.round((S-f)*D+d),Math.round(u/4),Math.round((S-f)*D+d),Math.round(u-u/4),a.get("whiskerColor")).append(),t.drawLine(Math.round((x-f)*D+d),Math.round(u*.1),Math.round((x-f)*D+d),Math.round(u*.9),a.get("medianColor")).append(),a.get("target")&&(F=Math.ceil(a.get("spotRadius")),t.drawLine(Math.round((a.get("target")-f)*D+d),Math.round(u/2-F),Math.round((a.get("target")-f)*D+d),Math.round(u/2+F),a.get("targetColor")).append(),t.drawLine(Math.round((a.get("target")-f)*D+d-F),Math.round(u/2),Math.round((a.get("target")-f)*D+d+F),Math.round(u/2),a.get("targetColor")).append())}},shapeCount:0,shapes:{},shapeseq:[],lastShapeId:null,mergedOptions:null,init:function(e,n){let t,l,o;n=n||{};let a=this;return l=this.defaultOption,o=l.common,t=l[n.type||o.type],a.shapeCount=0,a.shapes={},a.shapeseq=[],a.lastShapeId=null,a.mergedOptions=$.extend({},o,t,n),a.mergedOptions.width=a.mergedOptions.width,a.mergedOptions.height=a.mergedOptions.height,a[a.mergedOptions.type].render(a,e),{shapes:a.shapes,shapeseq:a.shapeseq,offsetX:a.mergedOptions.offsetX,offsetY:a.mergedOptions.offsetY,pixelWidth:a.mergedOptions.width,pixelHeight:a.mergedOptions.height}},_getContext:function(e,n,t){let l;return this.ctx!=null?l=this.ctx:l=$("#"+this._canvasID).get(0).getContext("2d"),e!==void 0&&(l.strokeStyle=e),l.lineWidth=t===void 0?1:t,n!==void 0&&(l.fillStyle=n),l},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0},_drawShape:function(e,n,t,l,o){let a=this._getContext(t,l,o),s,u;for(a.beginPath(),a.moveTo(n[0][0]+.5+this.offsetX,n[0][1]+.5+this.offsetY),s=1,u=n.length;s<u;s++)a.lineTo(n[s][0]+.5+this.offsetX,n[s][1]+.5+this.offsetY);t!==void 0&&a.stroke(),l!==void 0&&a.fill(),this.targetX!==void 0&&this.targetY!==void 0&&a.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawCircle:function(e,n,t,l,o,a,s){let u=this._getContext(o,a,s);u.beginPath(),n+=this.offsetX,t+=this.offsetY,u.arc(n,t,l,0,2*Math.PI,!1),this.targetX!==void 0&&this.targetY!==void 0&&u.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e),o!==void 0&&u.stroke(),a!==void 0&&u.fill()},_drawPieSlice:function(e,n,t,l,o,a,s,u){let f=this._getContext(s,u);n+=this.offsetX,t+=this.offsetY,f.beginPath(),f.moveTo(n,t),f.arc(n,t,l,o,a,!1),f.lineTo(n,t),f.closePath(),s!==void 0&&f.stroke(),u&&f.fill(),this.targetX!==void 0&&this.targetY!==void 0&&f.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawRect:function(e,n,t,l,o,a,s){return this._drawShape(e,[[n,t],[n+l,t],[n+l,t+o],[n,t+o],[n,t]],a,s)},appendShape:function(e){return this.shapes[e.id]=e,this.shapeseq.push(e.id),this.lastShapeId=e.id,e.id},replaceWithShape:function(e,n){let t=this.shapeseq,l;for(this.shapes[n.id]=n,l=t.length;l--;)t[l]==e&&(t[l]=n.id);delete this.shapes[e]},replaceWithShapes:function(e,n){let t=this.shapeseq,l={},o,a,s;for(a=e.length;a--;)l[e[a]]=!0;for(a=t.length;a--;)o=t[a],l[o]&&(t.splice(a,1),delete this.shapes[o],s=a);for(a=n.length;a--;)t.splice(s,0,n[a].id),this.shapes[n[a].id]=n[a]},insertAfterShape:function(e,n){let t=this.shapeseq,l;for(l=t.length;l--;)if(t[l]===e){t.splice(l+1,0,n.id),this.shapes[n.id]=n;return}},removeShapeId:function(e){let n=this.shapeseq,t;for(t=n.length;t--;)if(n[t]===e){n.splice(t,1);break}delete this.shapes[e]},getShapeAt:function(e,n,t){return this.targetX=n,this.targetY=t,this.render(),this.currentTargetShapeId},_canvasID:"luckysheetTableContent",render:function(e,n,t,l,o,a,s,u){s==null&&(s="luckysheetTableContent"),this._canvasID=s,u!=null&&(this.ctx=u);let f=e.length,m=this._getContext(),d,g,b;for(this.offsetX=t,this.offsetY=l,this.pixelWidth=o,this.pixelHeight=a,b=0;b<f;b++)d=e[b],g=n[d],this["_draw"+g.type].apply(this,g.args)},drawLine:function(e,n,t,l,o,a){return this.drawShape([[e,n],[t,l]],o,a)},drawShape:function(e,n,t,l){return this._genShape("Shape",[e,n,t,l])},drawCircle:function(e,n,t,l,o,a){return this._genShape("Circle",[e,n,t,l,o,a])},drawPieSlice:function(e,n,t,l,o,a,s){return this._genShape("PieSlice",[e,n,t,l,o,a,s])},drawRect:function(e,n,t,l,o,a){return this._genShape("Rect",[e,n,t,l,o,a])},_genShape:function(e,n){let t=this.shapeCount++;n.unshift(t);let l={id:t,type:e,args:n};return this.shapes[t]=l,this.shapeseq.push(t),this.lastShapeId=t,{append:function(){return l},get:function(){return t}}}},e1={changeHighlight:function(e){let n=this.currentRegion,t=this.target,l=this.regionShapes[n],o;l&&(o=this.renderRegion(n,e),$.isArray(o)||$.isArray(l)?(t.replaceWithShapes(l,o),this.regionShapes[n]=$.map(o,function(a){return a.id})):(t.replaceWithShape(l,o),this.regionShapes[n]=o.id))},render:function(e,n){this.init(e,n);let t=this.values,l=this.target,o=this.regionShapes,a,s,u,f;for(u=t.length;u--;)if(a=this.renderRegion(u),a)if($.isArray(a)){for(s=[],f=a.length;f--;)a[f].append(),s.push(a[f].id);o[u]=s}else a.append(),o[u]=a.id;else o[u]=null}},e3={get:function(e){return so.mergedOptions[e]}},t3={drawLine:function(e,n,t,l,o,a){return so.drawLine(e,n,t,l,o,a)},drawShape:function(e,n,t,l){return so.drawShape(e,n,t,l)},drawCircle:function(e,n,t,l,o,a){return so.drawCircle(e,n,t,l,o,a)},drawPieSlice:function(e,n,t,l,o,a,s){return so.drawPieSlice(e,n,t,l,o,a,s)},drawRect:function(e,n,t,l,o,a){return so.drawRect(e,n,t,l,o,a)}};for(let e in so)e in{line:null,bar:null,column:null,tristate:null,discrete:null,bullet:null,pie:null,box:null}&&(so[e].options=e3,so[e].target=t3),e in{bar:null,column:null,tristate:null,discrete:null}&&(so[e].changeHighlight=e1.changeHighlight,so[e].render=e1.render);hi=so});function As(e,n,t){e==null&&(e=$("#luckysheet-cell-main").scrollTop()),n==null&&(n=h.luckysheetTableContentHW[1]),t==null&&(t=h.columnHeaderHeight);let l=$("#luckysheetTableContent").get(0).getContext("2d");l.save(),l.scale(h.devicePixelRatio,h.devicePixelRatio),l.clearRect(0,t,h.rowHeaderWidth-1,n),l.font=ps(),l.textBaseline=Tn.textBaseline,l.fillStyle=Tn.fillStyle;let o,a;o=al(h.visibledatarow,e),a=al(h.visibledatarow,e+n),o==-1&&(o=0),a==-1&&(a=h.visibledatarow.length-1),l.save(),l.beginPath(),l.rect(0,t-1,h.rowHeaderWidth-1,n-2),l.clip();let s,u,f=.5,m;for(let d=o;d<=a;d++){d==0?u=-e-1:u=h.visibledatarow[d-1]-e-1,s=h.visibledatarow[d]-e;let g=o==d?-2:0,b=a==d?-2:0;if(!!Yt.createHookFunction("rowTitleCellRenderBefore",d+1,{r:d,top:u+t+g,width:h.rowHeaderWidth-1,height:s-u+1+b-g},l)){if(!(h.config.rowhidden!=null&&h.config.rowhidden[d]!=null)){l.fillStyle="#ffffff",l.fillRect(0,u+t+g,h.rowHeaderWidth-1,s-u+1+b-g),l.fillStyle="#000000",l.save(),l.scale(h.zoomRatio,h.zoomRatio);let y=_o(d+1,l),p=(h.rowHeaderWidth-y.width)/2,x=u+(s-u)/2+t;l.fillText(d+1,p/h.zoomRatio,x/h.zoomRatio),l.restore()}l.beginPath(),l.moveTo(h.rowHeaderWidth-2+f,u+t-2),l.lineTo(h.rowHeaderWidth-2+f,s+t-2),l.lineWidth=1,l.strokeStyle=Tn.strokeStyle,l.stroke(),l.closePath(),h.config.rowhidden!=null&&h.config.rowhidden[d]==null&&h.config.rowhidden[d+1]!=null?(l.beginPath(),l.moveTo(-1,s+t-4+f),l.lineTo(h.rowHeaderWidth-1,s+t-4+f),l.closePath(),l.stroke()):(h.config.rowhidden==null||h.config.rowhidden[d]==null)&&(l.beginPath(),l.moveTo(-1,s+t-2+f),l.lineTo(h.rowHeaderWidth-1,s+t-2+f),l.closePath(),l.stroke()),h.config.rowhidden!=null&&h.config.rowhidden[d-1]!=null&&m!=null&&(l.beginPath(),l.moveTo(-1,m+t+f),l.lineTo(h.rowHeaderWidth-1,m+t+f),l.closePath(),l.stroke()),m=s,Yt.createHookFunction("rowTitleCellRenderAfter",d+1,{r:d,top:u+t+g,width:h.rowHeaderWidth-1,height:s-u+1+b-g},l)}}l.restore(),l.restore()}function zs(e,n,t){e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=h.luckysheetTableContentHW[0]),t==null&&(t=h.rowHeaderWidth);let l=$("#luckysheetTableContent").get(0).getContext("2d");l.save(),l.scale(h.devicePixelRatio,h.devicePixelRatio),l.clearRect(t,0,n,h.columnHeaderHeight-1),l.font=ps(),l.textBaseline=Tn.textBaseline,l.fillStyle=Tn.fillStyle;let o,a;o=al(h.visibledatacolumn,e),a=al(h.visibledatacolumn,e+n),o==-1&&(o=0),a==-1&&(a=h.visibledatacolumn.length-1),l.save(),l.beginPath(),l.rect(t-1,0,n,h.columnHeaderHeight-1),l.clip();let s,u,f=.5,m;for(let d=o;d<=a;d++){d==0?u=-e:u=h.visibledatacolumn[d-1]-e,s=h.visibledatacolumn[d]-e;let g=Qt(d);if(!!Yt.createHookFunction("columnTitleCellRenderBefore",g,{c:d,left:u+t-1,width:s-u,height:h.columnHeaderHeight-1},l)){if(!(h.config.colhidden!=null&&h.config.colhidden[d]!=null)){l.fillStyle="#ffffff",l.fillRect(u+t-1,0,s-u,h.columnHeaderHeight-1),l.fillStyle="#000000",l.save(),l.scale(h.zoomRatio,h.zoomRatio);let b=_o(g,l),y=Math.round(u+(s-u)/2+t-b.width/2),p=Math.round(h.columnHeaderHeight/2);l.fillText(g,y/h.zoomRatio,p/h.zoomRatio),l.restore()}h.config.colhidden!=null&&h.config.colhidden[d]==null&&h.config.colhidden[d+1]!=null?(l.beginPath(),l.moveTo(s+t-4+f,0),l.lineTo(s+t-4+f,h.columnHeaderHeight-2),l.lineWidth=1,l.strokeStyle=Tn.strokeStyle,l.closePath(),l.stroke()):(h.config.colhidden==null||h.config.colhidden[d]==null)&&(l.beginPath(),l.moveTo(s+t-2+f,0),l.lineTo(s+t-2+f,h.columnHeaderHeight-2),l.lineWidth=1,l.strokeStyle=Tn.strokeStyle,l.closePath(),l.stroke()),h.config.colhidden!=null&&h.config.colhidden[d-1]!=null&&m!=null&&(l.beginPath(),l.moveTo(m+t+f,0),l.lineTo(m+t+f,h.columnHeaderHeight-2),l.closePath(),l.stroke()),l.beginPath(),l.moveTo(u+t-1,h.columnHeaderHeight-2+f),l.lineTo(s+t-1,h.columnHeaderHeight-2+f),l.stroke(),l.closePath(),m=s,Yt.createHookFunction("columnTitleCellRenderAfter",g,{c:d,left:u+t-1,width:s-u,height:h.columnHeaderHeight-1},l)}}l.restore(),l.restore()}function $i(e,n,t,l,o,a,s,u,f){if(h.flowdata==null)return;let m=ct.getSheetByIndex();clearTimeout(h.measureTextCacheTimeOut),e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=$("#luckysheet-cell-main").scrollTop()),t==null&&(t=h.luckysheetTableContentHW[0]),l==null&&(l=h.luckysheetTableContentHW[1]),o==null&&(o=h.rowHeaderWidth),a==null&&(a=h.columnHeaderHeight),s==null&&(s=0),u==null&&(u=0);let d=null;if(f==null)d=$("#luckysheetTableContent").get(0).getContext("2d");else if(V(f)=="object")try{d=f.get(0).getContext("2d")}catch(M){d=f}else d=$("#"+f).get(0).getContext("2d");d.save(),d.scale(h.devicePixelRatio,h.devicePixelRatio),d.clearRect(0,0,h.luckysheetTableContentHW[0],h.luckysheetTableContentHW[1]);let g,b,y,p;g=al(h.visibledatarow,n),b=al(h.visibledatarow,n+l),g==-1&&(g=0),g+=u,b==-1&&(b=h.visibledatarow.length-1),b+=u,b>=h.visibledatarow.length&&(b=h.visibledatarow.length-1),y=al(h.visibledatacolumn,e),p=al(h.visibledatacolumn,e+t),y==-1&&(y=0),y+=s,p==-1&&(p=h.visibledatacolumn.length-1),p+=s,p>=h.visibledatacolumn.length&&(p=h.visibledatacolumn.length-1);let x,_,S,I;g==0?x=0:x=h.visibledatarow[g-1],_=h.visibledatarow[b],y==0?S=0:S=h.visibledatacolumn[y-1],I=h.visibledatacolumn[p],d.fillStyle="#ffffff",d.fillRect(o-1,a-1,I-e,_-n),d.font=ps(),d.fillStyle=Tn.fillStyle;let O=[],F={},D={},k=.5;Yt.createHookFunction("cellAllRenderBefore",h.flowdata,m,d);for(let M=g;M<=b;M++){let P;M==0?P=-n-1:P=h.visibledatarow[M-1]-n-1;let N=h.visibledatarow[M]-n;if(!(h.config.rowhidden!=null&&h.config.rowhidden[M]!=null))for(let E=y;E<=p;E++){let B;E==0?B=-e:B=h.visibledatacolumn[E-1]-e;let U=h.visibledatacolumn[E]-e;if(h.config.colhidden!=null&&h.config.colhidden[E]!=null)continue;let X=h.defaultcollen;if(h.config.columnlen!=null&&h.config.columnlen[E]!=null&&(X=h.config.columnlen[E]),h.flowdata[M]!=null&&h.flowdata[M][E]!=null){let le=h.flowdata[M][E];if(V(le)=="object"&&"mc"in le)if(D[M+"_"+E]={start_r:P,start_c:B,end_r:N,end_c:U},"rs"in le.mc){let he="r"+M+"c"+E;F[he]=O.length}else{let he="r"+le.mc.r+"c"+le.mc.c,Z=O[F[he]];Z==null?(F[he]=O.length,O.push({r:M,c:E,start_c:B,start_r:P,end_r:N,end_c:U,firstcolumnlen:X})):(Z.c==E&&(Z.end_r+=N-P-1),Z.r==M&&(Z.end_c+=U-B,Z.firstcolumnlen+=X));continue}}O.push({r:M,c:E,start_r:P,start_c:B,end_r:N,end_c:U,firstcolumnlen:X}),D[M+"_"+E]={start_r:P,start_c:B,end_r:N,end_c:U}}}let w=Fu(h.luckysheetfile[$e(h.currentSheetIndex)].dynamicArray),C=xr.getComputeMap(),T=xt.getComputeMap(),z=l3(d,y,p,g,b),A=[];for(let M=0;M<O.length;M++){let P=O[M],N=P.r,E=P.c,B=P.start_r,U=P.start_c,X=P.end_r,le=P.end_c,he=P.firstcolumnlen;if(h.flowdata[N]!=null)if(h.flowdata[N][E]==null)Zm(N,E,B,U,X,le,d,C,T,o,a,w,z,y,p,n,e,k);else{let Z=h.flowdata[N][E],ae=null;if(typeof Z=="object"&&"mc"in Z?A.push(O[M]):ae=Sm(N,E),ae==null||ae.toString().length==0){Zm(N,E,B,U,X,le,d,C,T,o,a,w,z,y,p,n,e,k);let J=ht.borderfix(h.flowdata,N,E),pe=[U+o+J[0],B+a+J[1],le-U-3+J[2],X-B-3-1+J[3]];t1(N,E,pe[0],pe[1],"luckysheetTableContent",d)}else N+"_"+E in w&&(ae=w[N+"_"+E].v),l1(N,E,B,U,X,le,ae,d,C,T,o,a,w,z,y,p,n,e,k)}}for(let M=0;M<A.length;M++){let P=A[M],N=P.r,E=P.c,B=P.start_r,U=P.start_c,X=P.end_r-1,le=P.end_c-1,he=P.firstcolumnlen,Z=h.flowdata[N][E],ae=null,J=Z.mc;ae=Sm(J.r,J.c),N=J.r,E=J.c;let pe=h.flowdata[N][E];if(E==0?U=-e:U=h.visibledatacolumn[E-1]-e,N==0?B=-n-1:B=h.visibledatarow[N-1]-n-1,X=h.visibledatarow[N+pe.mc.rs-1]-n,le=h.visibledatacolumn[E+pe.mc.cs-1]-e,ae==null||ae.toString().length==0){Zm(N,E,B,U,X,le,d,C,T,o,a,w,z,y,p,n,e,k,!0);let K=ht.borderfix(h.flowdata,N,E),se=[U+o+K[0],B+a+K[1],le-U-3+K[2],X-B-3-1+K[3]];t1(N,E,se[0],se[1],"luckysheetTableContent",d)}else N+"_"+E in w&&(ae=w[N+"_"+E].v),l1(N,E,B,U,X,le,ae,d,C,T,o,a,w,z,y,p,n,e,k,!0)}for(let M=g;M<=b;M++){let P;M==0?P=-n-1:P=h.visibledatarow[M-1]-n-1;let N=h.visibledatarow[M]-n;for(let E=y;E<=p;E++){let B;E==0?B=-e:B=h.visibledatacolumn[E-1]-e;let U=h.visibledatacolumn[E]-e;!!h.luckysheetcurrentisPivotTable&&Pt.drawPivotTable?((E==0||E==5)&&M<=11&&(d.beginPath(),d.moveTo(U-2+k+o,P+a),d.lineTo(U-2+k+o,N-2+k+a),d.lineWidth=1,d.strokeStyle="#000000",d.closePath(),d.stroke()),(M==2||M==11)&&E<=5&&(d.beginPath(),d.moveTo(B-1+o,N-2+k+a),d.lineTo(U-2+k+o,N-2+k+a),d.lineWidth=1,d.strokeStyle="#000000",d.closePath(),d.stroke()),M==6&&E==3&&(d.save(),d.font="bold 30px Arial",d.fillStyle="#626675",d.textAlign="center",d.fillText(Oe().pivotTable.title,B+(U-B)/2+4+o,P+(N-P)/2-1+a),d.restore())):h.luckysheetcurrentisPivotTable&&E<Pt.pivotTableBoundary[1]&&M<Pt.pivotTableBoundary[0]&&(d.beginPath(),d.moveTo(U-2+k+o,P+a),d.lineTo(U-2+k+o,N-2+k+a),d.lineWidth=1,d.strokeStyle="#000000",d.closePath(),d.stroke(),d.beginPath(),d.moveTo(B-1+o,N-2+k+a),d.lineTo(U-2+o,N-2+k+a),d.lineWidth=1,d.strokeStyle="#000000",d.closePath(),d.stroke())}}if(h.config.borderInfo!=null&&h.config.borderInfo.length>0){let M=function(U,X,le,he,Z,ae,J,pe,K){let se=U,te=he-2+k+J,re=le+pe-1,fe=he-2+k+J,Me=Z-2+k+pe;K.save(),ht.setLineDash(K,se,"v",te,re,fe,Me),K.strokeStyle=X,K.stroke(),K.closePath(),K.restore()},P=function(U,X,le,he,Z,ae,J,pe,K){let se=U,te=ae-2+k+J,re=le+pe-1,fe=ae-2+k+J,Me=Z-2+k+pe;K.save(),ht.setLineDash(K,se,"v",te,re,fe,Me),K.strokeStyle=X,K.stroke(),K.closePath(),K.restore()},N=function(U,X,le,he,Z,ae,J,pe,K){let se=U,te=he-2+k+J,re=Z-2+k+pe,fe=ae-2+k+J,Me=Z-2+k+pe;K.save(),ht.setLineDash(K,se,"h",te,re,fe,Me),K.strokeStyle=X,K.stroke(),K.closePath(),K.restore()},E=function(U,X,le,he,Z,ae,J,pe,K){let se=U,te=he-2+k+J,re=le-1+k+pe,fe=ae-2+k+J,Me=le-1+k+pe;K.save(),ht.setLineDash(K,se,"h",te,re,fe,Me),K.strokeStyle=X,K.stroke(),K.closePath(),K.restore()},B=Am(g,b,y,p);for(let U in B){let X=U.substr(0,U.indexOf("_")),le=U.substr(U.indexOf("_")+1);if(D[X+"_"+le]){let he=D[X+"_"+le].start_r,Z=D[X+"_"+le].start_c,ae=D[X+"_"+le].end_r,J=D[X+"_"+le].end_c,pe=Km(z,X,le,y,p),K=B[U].l;K!=null&&(!pe.colIn||pe.stc==le)&&M(K.style,K.color,he,Z,ae,J,o,a,d);let se=B[U].r;se!=null&&(!pe.colIn||pe.colLast)&&P(se.style,se.color,he,Z,ae,J,o,a,d);let te=B[U].t;te!=null&&E(te.style,te.color,he,Z,ae,J,o,a,d);let re=B[U].b;re!=null&&N(re.style,re.color,he,Z,ae,J,o,a,d)}}}p==h.visibledatacolumn.length-1&&d.clearRect(I-e+o-1,a-1,h.ch_width-h.visibledatacolumn[p],_-n),d.restore(),h.measureTextCacheTimeOut=setTimeout(()=>{h.measureTextCache={},h.measureTextCellInfoCache={},h.cellOverflowMapCache={}},100)}function l3(e,n,t,l,o){let a={},s=h.flowdata;for(let u=l;u<=o;u++){if(s[u]==null)continue;if(h.cellOverflowMapCache[u]!=null){a[u]=h.cellOverflowMapCache[u];continue}let f=!1;for(let m=0;m<s[u].length;m++){let d=s[u][m];if(!(h.config.colhidden!=null&&h.config.colhidden[m]!=null)&&d!=null&&(!rt(d.v)||wn(d))&&d.mc==null&&d.tb=="1"){let g=ht.checkstatus(s,u,m,"ht"),b=no(d,e,{r:u,c:m}),y=0;b!=null&&(y=b.textWidthAll);let p=m-1<0?0:h.visibledatacolumn[m-1],x=h.visibledatacolumn[m],_,S;if(x-p<y){if(g=="0"){let I=Fc(u,m,m-1,"forward",g,y),O=Fc(u,m,m+1,"backward",g,y);I.success?_=I.c:_=I.c+1,O.success?S=O.c:S=O.c-1}else if(g=="1"){let I=Fc(u,m,m+1,"backward",g,y);_=m,I.success?S=I.c:S=I.c-1}else if(g=="2"){let I=Fc(u,m,m-1,"forward",g,y);S=m,I.success?_=I.c:_=I.c+1}}else _=m,S=m;if((_<=t||S>=n)&&_<S){let I={r:u,stc:_,edc:S};a[u]==null&&(a[u]={}),a[u][m]=I,f=!0}}}f&&(h.cellOverflowMapCache[u]=a[u])}return a}function Fc(e,n,t,l,o,a){let s=h.flowdata;if(l=="forward"&&t<0)return{success:!1,r:e,c:t};if(l=="backward"&&t>s[e].length-1)return{success:!1,r:e,c:t};let u=s[e][t];if(u!=null&&(!rt(u.v)||u.mc!=null))return{success:!1,r:e,c:t};let f=n-1<0?0:h.visibledatacolumn[n-1],m=h.visibledatacolumn[n],d=a-(m-f);o=="0"?(f-=d/2,m+=d/2):o=="1"?m+=d:o=="2"&&(f-=d);let g=t-1<0?0:h.visibledatacolumn[t-1],b=h.visibledatacolumn[t];if(l=="forward")return f<g?Fc(e,n,t-1,l,o,a):f<b?{success:!0,r:e,c:t}:{success:!1,r:e,c:t};if(l=="backward")return m>b?Fc(e,n,t+1,l,o,a):m>g?{success:!0,r:e,c:t}:{success:!1,r:e,c:t}}function Km(e,n,t,l,o){let a=!1,s=!1,u,f,m,d;for(let g in e){for(let b in e[g]){u=g,f=b;let y=e[g][b];if(m=y.stc,d=y.edc,u==n&&t>=m&&t<=d&&(a=!0,t==d||t==o)){s=!0;break}}if(s)break}return{colIn:a,colLast:s,rowIndex:u,colIndex:f,stc:m,edc:d}}function n1(e,n,t){if(e==null)return;let l=e.values,o=t.pos_x,a=t.pos_y;if(l!=null){e.rotate!=0&&e.type!="verticalWrap"&&(n.save(),n.translate((o+e.textLeftAll)/h.zoomRatio,(a+e.textTopAll)/h.zoomRatio),n.rotate(-e.rotate*Math.PI/180),n.translate(-(e.textLeftAll+o)/h.zoomRatio,-(a+e.textTopAll)/h.zoomRatio));for(let s=0;s<l.length;s++){let u=l[s];u.inline===!0&&u.style!=null?(n.font=u.style.fontset,n.fillStyle=u.style.fc):n.font=u.style;let f=typeof u.content=="object"?u.content.m:u.content;if(n.fillText(f,(o+u.left)/h.zoomRatio,(a+u.top)/h.zoomRatio),u.cancelLine!=null){let m=u.cancelLine;n.beginPath(),n.moveTo(Math.floor((o+m.startX)/h.zoomRatio)+.5,Math.floor((a+m.startY)/h.zoomRatio)+.5),n.lineTo(Math.floor((o+m.endX)/h.zoomRatio)+.5,Math.floor((a+m.endY)/h.zoomRatio)+.5),n.lineWidth=Math.floor(m.fs/9),n.strokeStyle=n.fillStyle,n.stroke(),n.closePath()}if(u.underLine!=null){let m=u.underLine;for(let d=0;d<m.length;d++){let g=m[d];n.beginPath(),n.moveTo(Math.floor((o+g.startX)/h.zoomRatio)+.5,Math.floor((a+g.startY)/h.zoomRatio)),n.lineTo(Math.floor((o+g.endX)/h.zoomRatio)+.5,Math.floor((a+g.endY)/h.zoomRatio)+.5),n.lineWidth=Math.floor(g.fs/9),n.strokeStyle=n.fillStyle,n.stroke(),n.closePath()}}}e.rotate!=0&&e.type!="verticalWrap"&&n.restore()}}var import_plugin,t1,Zm,l1,r1,vh=Tt(()=>{import_plugin=Le(Be());Qo();ji();$c();Xm();Mr();Vi();ar();xo();oh();sc();Gl();Hi();mr();Tc();ql();gl();va();qn();Ut();Rl();Yr();t1=function(e,n,t,l,o,a){if(h.flowdata[e]==null||h.flowdata[e][n]==null)return;let s=h.flowdata[e][n].spl;if(s!=null){if(typeof s=="string"&&(s=new Function("return "+s)()),V(s)=="object"){let u=s,f=u.offsetX,m=u.offsetY;f=f??0,m=m??0,hi.render(u.shapeseq,u.shapes,t+f,l+m,u.pixelWidth,u.pixelHeight,o,a)}else if(V(s)=="array"&&V(s[0])=="object")for(let u=0;u<s.length;u++){let f=s[u],m=f.offsetX,d=f.offsetY;m=m??0,d=d??0,hi.render(f.shapeseq,f.shapes,t+m,l+d,f.pixelWidth,f.pixelHeight,o,a)}}},Zm=function(e,n,t,l,o,a,s,u,f,m,d,g,b,y,p,x,_,S,I){let O=xr.checksAF(e,n,u),F=xt.checksCF(e,n,f),D=ht.borderfix(h.flowdata,e,n),k=ht.checkstatus(h.flowdata,e,n,"bg");O!=null&&O[1]!=null&&(k=O[1]),F!=null&&F.cellColor!=null&&(k=F.cellColor),h.flowdata[e][n]!=null&&h.flowdata[e][n].tc!=null&&(k=h.flowdata[e][n].tc),k==null?s.fillStyle="#FFFFFF":s.fillStyle=k;let w=[l+m+D[0]+1,t+d+D[1]+1,a-l+D[2]-(I?1:0)-1,o-t+D[3]-1];if(!Yt.createHookFunction("cellRenderBefore",h.flowdata[e][n],{r:e,c:n,start_r:w[1],start_c:w[0],end_r:w[3]+w[1],end_c:w[2]+w[0]},ct.getSheetByIndex(),s))return;if(s.fillRect(w[0],w[1],w[2],w[3]),e+"_"+n in g){let T=g[e+"_"+n].v;s.fillStyle="#000000";let z=ps();s.font=z;let A=l+4+m,M=Ni.luckysheetrefreshfixed(),P=o+d-2;s.textBaseline="bottom",s.fillText(T??"",A,P)}if(h.flowdata[e][n]!=null&&h.flowdata[e][n].ps!=null){let T=8*h.zoomRatio,z=8*h.zoomRatio;s.beginPath(),s.moveTo(a+m-1-T,t+d),s.lineTo(a+m-1,t+d),s.lineTo(a+m-1,t+d+z),s.fillStyle="#FC6666",s.fill(),s.closePath()}let C=Km(b,e,n,y,p);C.colLast&&r1(C.rowIndex,C.colIndex,C.stc,C.edc,s,x,_,m,d,u,f),(!C.colIn||C.colLast)&&!h.luckysheetcurrentisPivotTable&&h.showGridLines&&(s.beginPath(),s.moveTo(a+m-2+S,t+d),s.lineTo(a+m-2+S,o+d),s.lineWidth=1,s.strokeStyle=Tn.strokeStyle,s.stroke(),s.closePath()),!h.luckysheetcurrentisPivotTable&&h.showGridLines&&(s.beginPath(),s.moveTo(l+m-1,o+d-2+S),s.lineTo(a+m-1,o+d-2+S),s.lineWidth=1,s.strokeStyle=Tn.strokeStyle,s.stroke(),s.closePath()),Yt.createHookFunction("cellRenderAfter",h.flowdata[e][n],{r:e,c:n,start_r:w[1],start_c:w[0],end_r:w[3]+w[1],end_c:w[2]+w[0]},ct.getSheetByIndex(),s)},l1=function(e,n,t,l,o,a,s,u,f,m,d,g,b,y,p,x,_,S,I,O){let F=h.flowdata[e][n],D=a-l-2,k=o-t-2,w=2,C=2,T=ht.checkstatus(h.flowdata,e,n,"ht"),z=ht.checkstatus(h.flowdata,e,n,"vt"),A=xr.checksAF(e,n,f),M=xt.checksCF(e,n,m),P=ht.checkstatus(h.flowdata,e,n,"bg");A!=null&&A[1]!=null&&(P=A[1]),M!=null&&M.cellColor!=null&&(P=M.cellColor),P==null?u.fillStyle="#FFFFFF":u.fillStyle=P;let N=ht.borderfix(h.flowdata,e,n),E=[l+d+N[0]+1,t+g+N[1]+1,a-l+N[2]-(O?1:0)-1,o-t+N[3]+1];if(!Yt.createHookFunction("cellRenderBefore",h.flowdata[e][n],{r:e,c:n,start_r:E[1],start_c:E[0],end_r:E[3]+E[1],end_c:E[2]+E[0]},ct.getSheetByIndex(),u))return;u.fillRect(E[0],E[1],E[2],E[3]);let B=Vt.dataVerification;if(B!=null&&B[e+"_"+n]!=null&&!Vt.validateCellData(s,B[e+"_"+n])){let le=5*h.zoomRatio,he=5*h.zoomRatio;u.beginPath(),u.moveTo(l+d,t+g),u.lineTo(l+d+le,t+g),u.lineTo(l+d,t+g+he),u.fillStyle="#FC6666",u.fill(),u.closePath()}if(F.ps!=null){let le=8*h.zoomRatio,he=8*h.zoomRatio;u.beginPath(),u.moveTo(a+d-le,t+g),u.lineTo(a+d,t+g),u.lineTo(a+d,t+g+he),u.fillStyle="#FC6666",u.fill(),u.closePath()}if(F.qp==1&&Y(F.v)){let le=6*h.zoomRatio,he=6*h.zoomRatio;u.beginPath(),u.moveTo(l+d+le-1,t+g),u.lineTo(l+d-1,t+g),u.lineTo(l+d-1,t+g+he),u.fillStyle="#487f1e",u.fill(),u.closePath()}let U=!0,X=Km(y,e,n,p,x);if(F.tb=="1"&&X.colIn)X.colLast?r1(X.rowIndex,X.colIndex,X.stc,X.edc,u,_,S,d,g,f,m):U=!1;else if(B!=null&&B[e+"_"+n]!=null&&B[e+"_"+n].type=="checkbox"){let le=l+d,he=t+g+1;u.save(),u.beginPath(),u.rect(le,he,D,k),u.clip(),u.scale(h.zoomRatio,h.zoomRatio);let Z=_o(s,u),ae=Z.width+14,J=Z.actualBoundingBoxDescent+Z.actualBoundingBoxAscent,pe=le+w;T=="0"?pe=le+D/2-ae/2:T=="2"&&(pe=le+D-w-ae);let K=k>J?k:J,se=he+K-C;u.textBaseline="bottom";let te=se-13*h.zoomRatio;z=="0"?(se=he+K/2,u.textBaseline="middle",te=se-6*h.zoomRatio):z=="1"&&(se=he+C,u.textBaseline="top",te=se+1*h.zoomRatio),pe=pe/h.zoomRatio,se=se/h.zoomRatio,te=te/h.zoomRatio,u.lineWidth=1,u.strokeStyle="#000",u.strokeRect(pe,te,10,10),B[e+"_"+n].checked&&(u.beginPath(),u.lineTo(pe+1,te+6),u.lineTo(pe+4,te+9),u.lineTo(pe+9,te+2),u.stroke(),u.closePath()),u.fillStyle=ht.checkstatus(h.flowdata,e,n,"fc"),u.fillText(s??"",pe+14,se),u.restore()}else{if(M!=null&&M.dataBar!=null&&M.dataBar.valueLen&&M.dataBar.valueLen.toString()!=="NaN"){let ae=l+d+w,J=t+g+C,pe=D-w*2,K=k-C*2,se=M.dataBar.valueType,te=M.dataBar.valueLen,re=M.dataBar.format;if(se=="minus"){let fe=M.dataBar.minusLen;if(re.length>1){let Me=u.createLinearGradient(ae+pe*fe*(1-te),J,ae+pe*fe,J);Me.addColorStop(0,"#ffffff"),Me.addColorStop(1,"#ff0000"),u.fillStyle=Me}else u.fillStyle="#ff0000";u.fillRect(ae+pe*fe*(1-te),J,pe*fe*te,K),u.beginPath(),u.moveTo(ae+pe*fe*(1-te),J),u.lineTo(ae+pe*fe*(1-te),J+K),u.lineTo(ae+pe*fe,J+K),u.lineTo(ae+pe*fe,J),u.lineTo(ae+pe*fe*(1-te),J),u.lineWidth=1,u.strokeStyle="#ff0000",u.stroke(),u.closePath()}else if(se=="plus"){let fe=M.dataBar.plusLen;if(fe==1){if(re.length>1){let Me=u.createLinearGradient(ae,J,ae+pe*te,J);Me.addColorStop(0,re[0]),Me.addColorStop(1,re[1]),u.fillStyle=Me}else u.fillStyle=re[0];u.fillRect(ae,J,pe*te,K),u.beginPath(),u.moveTo(ae,J),u.lineTo(ae,J+K),u.lineTo(ae+pe*te,J+K),u.lineTo(ae+pe*te,J),u.lineTo(ae,J),u.lineWidth=1,u.strokeStyle=re[0],u.stroke(),u.closePath()}else{let Me=M.dataBar.minusLen;if(re.length>1){let ye=u.createLinearGradient(ae+pe*Me,J,ae+pe*Me+pe*fe*te,J);ye.addColorStop(0,re[0]),ye.addColorStop(1,re[1]),u.fillStyle=ye}else u.fillStyle=re[0];u.fillRect(ae+pe*Me,J,pe*fe*te,K),u.beginPath(),u.moveTo(ae+pe*Me,J),u.lineTo(ae+pe*Me,J+K),u.lineTo(ae+pe*Me+pe*fe*te,J+K),u.lineTo(ae+pe*Me+pe*fe*te,J),u.lineTo(ae+pe*Me,J),u.lineWidth=1,u.strokeStyle=re[0],u.stroke(),u.closePath()}}}let le=l+d,he=t+g+1;u.save(),u.beginPath(),u.rect(le,he,D,k),u.clip(),u.scale(h.zoomRatio,h.zoomRatio);let Z=no(F,u,{cellWidth:D,cellHeight:k,space_width:w,space_height:C,r:e,c:n});if(M!=null&&M.icons!=null&&Z.type=="plain"){let ae=M.icons.left,J=M.icons.top,pe=Z.values[0],K=le+pe.left,se=he+pe.top-Z.textHeightAll;z=="0"?se=he+k/2-Z.textHeightAll/2:z=="1"?se=he:z=="2"&&(se=se-Z.desc),se=se/h.zoomRatio,K=K/h.zoomRatio,u.drawImage(ac,ae*42,J*32,32,32,le/h.zoomRatio,se,Z.textHeightAll/h.zoomRatio,Z.textHeightAll/h.zoomRatio),T!="0"&&T!="2"&&(K=K+Z.textHeightAll/h.zoomRatio)}u.fillStyle=ht.checkstatus(h.flowdata,e,n,"fc"),A!=null&&A[0]!=null&&(u.fillStyle=A[0]),M!=null&&M.textColor!=null&&(u.fillStyle=M.textColor),F.ct&&F.ct.fa&&F.ct.fa.indexOf("[Red]")>-1&&F.ct.t=="n"&&F.v<0&&(u.fillStyle="#ff0000"),n1(Z,u,{pos_x:le,pos_y:he}),u.restore()}U&&!h.luckysheetcurrentisPivotTable&&h.showGridLines&&(u.beginPath(),u.moveTo(a+d-2+I,t+g),u.lineTo(a+d-2+I,o+g),u.lineWidth=1,u.strokeStyle=Tn.strokeStyle,u.stroke(),u.closePath()),!h.luckysheetcurrentisPivotTable&&h.showGridLines&&(u.beginPath(),u.moveTo(l+d-1,o+g-2+I),u.lineTo(a+d-1,o+g-2+I),u.lineWidth=1,u.strokeStyle=Tn.strokeStyle,u.stroke(),u.closePath()),Yt.createHookFunction("cellRenderAfter",h.flowdata[e][n],{r:e,c:n,start_r:E[1],start_c:E[0],end_r:E[3]+E[1],end_c:E[2]+E[0]},ct.getSheetByIndex(),u)},r1=function(e,n,t,l,o,a,s,u,f,m,d){let g;e==0?g=-a-1:g=h.visibledatarow[e-1]-a-1;let b=h.visibledatarow[e]-a,y;t==0?y=-s:y=h.visibledatacolumn[t-1]-s;let p=h.visibledatacolumn[l]-s,x=h.flowdata[e][n],_=p-y-2,S=b-g-2,I=2,O=2,F=y+u,D=g+f+1,k=Ss(x);o.font=k,o.save(),o.beginPath(),o.rect(F,D,_,S),o.clip(),o.scale(h.zoomRatio,h.zoomRatio);let w=no(x,o,{cellWidth:_,cellHeight:S,space_width:I,space_height:O,r:e,c:n}),C=xr.checksAF(e,n,m),T=xt.checksCF(e,n,d);o.fillStyle=ht.checkstatus(h.flowdata,e,n,"fc"),C!=null&&C[0]!=null&&(o.fillStyle=C[0]),T!=null&&T.textColor!=null&&(o.fillStyle=T.textColor),n1(w,o,{pos_x:F,pos_y:D}),o.restore()}});var import_plugin,r3,Mn,Mc=Tt(()=>{import_plugin=Le(Be());gl();mr();fr();Qn();ir();Sr();br();ar();vr();wr();Yr();li();Mr();ql();Rl();Ut();r3={item:{linkType:"external",linkAddress:"",linkTooltip:""},hyperlink:null,createDialog:function(){let e=this,n=Oe(),t=n.insertLink,l=n.toolbar,o=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-insertLink-dialog").remove();let a="";h.luckysheetfile.forEach(p=>{a+=`<option value="${p.name}">${p.name}</option>`});let s=`<div class="box">
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkText">${t.linkText}\uFF1A</label>
                                <input type="text" id="luckysheet-insertLink-dialog-linkText"/>
                            </div>
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkType">${t.linkType}\uFF1A</label>
                                <select id="luckysheet-insertLink-dialog-linkType">
                                    <option value="external">${t.external}</option>
                                    <option value="internal">${t.internal}</option>
                                </select>
                            </div>
                            <div class="show-box show-box-external">
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkAddress">${t.linkAddress}\uFF1A</label>
                                    <input type="text" id="luckysheet-insertLink-dialog-linkAddress" placeholder="${t.placeholder1}" />
                                </div>
                            </div>
                            <div class="show-box show-box-internal">
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkSheet">${t.linkSheet}\uFF1A</label>
                                    <select id="luckysheet-insertLink-dialog-linkSheet">
                                        ${a}
                                    </select>
                                </div>
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkCell">${t.linkCell}\uFF1A</label>
                                    <input type="text" id="luckysheet-insertLink-dialog-linkCell" value="A1" placeholder="${t.placeholder2}" />
                                </div>
                            </div>
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkTooltip">${t.linkTooltip}\uFF1A</label>
                                <input type="text" id="luckysheet-insertLink-dialog-linkTooltip" placeholder="${t.placeholder3}" />
                            </div>
                        </div>`;$("body").first().append(yt(kl,{id:"luckysheet-insertLink-dialog",addclass:"luckysheet-insertLink-dialog",title:l.insertLink,content:s,botton:`<button id="luckysheet-insertLink-dialog-confirm" class="btn btn-primary">${o.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${o.cancel}</button>`,style:"z-index:100003"}));let u=$("#luckysheet-insertLink-dialog").find(".luckysheet-modal-dialog-content").css("min-width",350).end(),f=u.outerHeight(),m=u.outerWidth(),d=$(window).width(),g=$(window).height(),b=$(document).scrollLeft(),y=$(document).scrollTop();$("#luckysheet-insertLink-dialog").css({left:(d+b-m)/2,top:(g+y-f)/3}).show(),e.dataAllocation()},init:function(){let e=this,t=Oe().insertLink;$(document).off("change.linkType").on("change.linkType","#luckysheet-insertLink-dialog-linkType",function(l){let o=this.value;$("#luckysheet-insertLink-dialog .show-box").hide(),$("#luckysheet-insertLink-dialog .show-box-"+o).show()}),$(document).off("click.confirm").on("click.confirm","#luckysheet-insertLink-dialog-confirm",function(l){let o=h.luckysheet_select_save[h.luckysheet_select_save.length-1],a=o.row_focus||o.row[0],s=o.column_focus||o.column[0],u=$("#luckysheet-insertLink-dialog-linkText").val(),f=$("#luckysheet-insertLink-dialog-linkType").val(),m=$("#luckysheet-insertLink-dialog-linkAddress").val(),d=$("#luckysheet-insertLink-dialog-linkSheet").val(),g=$("#luckysheet-insertLink-dialog-linkCell").val(),b=$("#luckysheet-insertLink-dialog-linkTooltip").val();if(f=="external"){if(/^http[s]?:\/\//.test(m)||(m="https://"+m),!/^http[s]?:\/\/([\w\-\.]+)+[\w-]*([\w\-\.\/\?%&=]+)?$/ig.test(m)){de.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo1);return}}else{if(!v.iscelldata(g)){de.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo2);return}m=d+"!"+g}(u==null||u.replace(/\s/g,"")=="")&&(u=m);let y={linkType:f,linkAddress:m,linkTooltip:b},p=$.extend(!0,{},e.hyperlink),x=$.extend(!0,{},e.hyperlink);x[a+"_"+s]=y;let _=pt.deepCopyFlowData(h.flowdata),S=_[a][s];S==null&&(S={}),S.fc="rgb(0, 0, 255)",S.un=1,S.v=S.m=u,_[a][s]=S,e.ref(p,x,h.currentSheetIndex,_,[{row:[a,a],column:[s,s]}]),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-insertLink-dialog").hide()})},dataAllocation:function(){let e=this,n=h.luckysheet_select_save[h.luckysheet_select_save.length-1],t=n.row_focus||n.row[0],l=n.column_focus||n.column[0],a=(e.hyperlink||{})[t+"_"+l]||{},s=Mt(t,l,null,"m");$("#luckysheet-insertLink-dialog-linkText").val(s);let u=a.linkType||"external";$("#luckysheet-insertLink-dialog-linkType").val(u),$("#luckysheet-insertLink-dialog .show-box").hide(),$("#luckysheet-insertLink-dialog .show-box-"+u).show();let f=a.linkAddress||"";if(u=="external")$("#luckysheet-insertLink-dialog-linkAddress").val(f);else if(v.iscelldata(f)){let d=f.split("!")[0],g=f.split("!")[1];$("#luckysheet-insertLink-dialog-linkSheet").val(d),$("#luckysheet-insertLink-dialog-linkCell").val(g)}let m=a.linkTooltip||"";$("#luckysheet-insertLink-dialog-linkTooltip").val(m)},cellFocus:function(e,n){let t=this;if(t.hyperlink==null||t.hyperlink[e+"_"+n]==null)return;let l=t.hyperlink[e+"_"+n];if(l.linkType=="external")window.open(l.linkAddress);else{let o=v.getcellrange(l.linkAddress),a=o.sheetIndex,s=[{row:o.row,column:o.column}];a!=h.currentSheetIndex&&($("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),ct.changeSheet(a)),h.luckysheet_select_save=s,Zt(!0);let u=o.row[0]-1==-1?0:h.visibledatarow[o.row[0]-1],f=o.column[0]-1==-1?0:h.visibledatacolumn[o.column[0]-1];$("#luckysheet-scrollbar-x").scrollLeft(f),$("#luckysheet-scrollbar-y").scrollTop(u)}},overshow:function(e){let n=this;if($("#luckysheet-hyperlink-overshow").remove(),$(e.target).closest("#luckysheet-cell-main").length==0)return;let t=ll(e.pageX,e.pageY),l=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").scrollTop(),a=t[0]+l,s=t[1]+o;if(we.freezenverticaldata!=null&&t[0]<we.freezenverticaldata[0]-we.freezenverticaldata[2]||we.freezenhorizontaldata!=null&&t[1]<we.freezenhorizontaldata[0]-we.freezenhorizontaldata[2])return;let u=zl(s)[2],f=Ml(a)[2],m=ht.mergeborer(h.flowdata,u,f);if(m&&(u=m.row[2],f=m.column[2]),n.hyperlink==null||n.hyperlink[u+"_"+f]==null)return;let d=n.hyperlink[u+"_"+f],g=d.linkTooltip;(g==null||g.replace(/\s/g,"")=="")&&(g=d.linkAddress);let b=h.visibledatarow[u],y=u-1==-1?0:h.visibledatarow[u-1],p=h.visibledatacolumn[f],x=f-1==-1?0:h.visibledatacolumn[f-1];m&&(b=m.row[1],y=m.row[0],p=m.column[1],x=m.column[0]);let _=`<div id="luckysheet-hyperlink-overshow" style="background:#fff;padding:5px 10px;border:1px solid #000;box-shadow:2px 2px #999;position:absolute;left:${x}px;top:${b+5}px;z-index:100;">
                        <div>${g}</div>
                        <div>\u5355\u51FB\u9F20\u6807\u53EF\u4EE5\u8FFD\u8E2A</div>
                    </div>`;$(_).appendTo($("#luckysheet-cell-main"))},ref:function(e,n,t,l,o){let a=this;if(h.clearjfundo){h.jfundo.length=0;let s={};s.type="updateHyperlink",s.sheetIndex=t,s.historyHyperlink=e,s.currentHyperlink=n,s.data=h.flowdata,s.curData=l,s.range=o,h.jfredo.push(s)}a.hyperlink=n,h.luckysheetfile[$e(t)].hyperlink=n,h.flowdata=l,pt.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[$e(t)].data=h.flowdata,He.allowUpdate&&(He.saveParam("all",t,n,{k:"hyperlink"}),He.historyParam(h.flowdata,t,o[0])),setTimeout(function(){Et()},1)}},Mn=r3});function Jm(e,n,t){v.execFunctionExist=[];for(let l=0;l<e.length;l++)for(let o=e[l].row[0];o<=e[l].row[1];o++)for(let a=e[l].column[0];a<=e[l].column[1];a++)v.execFunctionExist.push({r:o,c:a,i:n});v.execFunctionExist.reverse(),v.execFunctionGroup(null,null,null,null,t),v.execFunctionGlobalData=null}function Gt(e,n,t,l=!0,o=!0){e==null&&(e=h.flowdata),n==null&&(n=h.luckysheet_select_save),n=JSON.parse(JSON.stringify(n)),clearTimeout(co),t==null&&(t={});let a=t.cfg,s=t.RowlChange,u=t.cdformat,f=t.dataVerification,m=t.dynamicArray,d=h.luckysheetfile[$e(h.currentSheetIndex)];if(h.clearjfundo){h.jfundo.length=0;let g;a==null?g=$.extend(!0,{},h.config):g=$.extend(!0,{},a);let b;u==null?b=$.extend(!0,[],d.luckysheet_conditionformat_save):b=u;let y;f==null?y=$.extend(!0,{},d.dataVerification):y=f;let p;m==null?p=$.extend(!0,[],d.dynamicArray):p=m,h.jfredo.push({type:"datachange",data:h.flowdata,curdata:e,sheetIndex:h.currentSheetIndex,config:$.extend(!0,{},h.config),curConfig:g,cdformat:$.extend(!0,[],d.luckysheet_conditionformat_save),curCdformat:b,RowlChange:s,dataVerification:$.extend(!0,[],d.dataVerification),curDataVerification:y,dynamicArray:$.extend(!0,[],d.dynamicArray),curDynamicArray:p,range:n,dataRange:[...d.luckysheet_select_save]})}h.flowdata=e,pt.webWorkerFlowDataCache(h.flowdata),d.data=h.flowdata,a!=null&&(h.config=a,d.config=h.config,He.saveParam("all",h.currentSheetIndex,a,{k:"config"}),s!=null&&Nl(h.flowdata.length,h.flowdata[0].length)),u!=null&&u.length!==0&&(d.luckysheet_conditionformat_save=u,He.saveParam("all",h.currentSheetIndex,u,{k:"luckysheet_conditionformat_save"})),f!=null&&Object.keys(f).length!==0&&(Vt.dataVerification=f,d.dataVerification=f,He.saveParam("all",h.currentSheetIndex,f,{k:"dataVerification"})),m!=null&&(d.dynamicArray=m,He.saveParam("all",h.currentSheetIndex,m,{k:"dynamicArray"}));for(let g=0;g<n.length;g++){let b=n[g].row[0],y=n[g].column[0];if(h.flowdata[b][y]!=null&&h.flowdata[b][y].spl!=null){window.luckysheetCurrentRow=b,window.luckysheetCurrentColumn=y,window.luckysheetCurrentFunction=h.flowdata[b][y].f;let p=$.trim(v.functionParserExe(h.flowdata[b][y].f)),x=new Function("return "+p)();h.flowdata[b][y].spl=x}He.allowUpdate&&He.historyParam(h.flowdata,h.currentSheetIndex,n[g]),typeof h.chartparam.jfrefreshchartall=="function"&&h.chartparam.jfrefreshchartall(h.flowdata,n[g].row[0],n[g].row[1],n[g].column[0],n[g].column[1])}l&&Jm(n,h.currentSheetIndex,e),o&&(co=setTimeout(function(){Et()},1)),Zt(),window.luckysheet_getcelldata_cache=null}function fi(e,n,t,l,o,a,s,u,f=!0){let m={},d=!1;if(clearTimeout(co),a=="cellRowChange"){m.type="cellRowChange",m.config=$.extend(!0,{},h.config),m.curconfig=$.extend(!0,{},l),m.range=$.extend(!0,[],h.luckysheet_select_save),m.currange=o,m.ctrlType=a,m.ctrlValue=s;let g=l.rowlen;g==null&&(g={}),He.saveParam("cg",h.currentSheetIndex,g,{k:"rowlen"})}else if(a=="resizeC"){m.type="resize",m.config=$.extend(!0,{},h.config),m.curconfig=$.extend(!0,{},l),m.range=$.extend(!0,[],h.luckysheet_select_save),m.currange=o,m.ctrlType=a,m.ctrlValue=s;let g=l.columnlen;g==null&&(g={}),He.saveParam("cg",h.currentSheetIndex,g,{k:"columnlen"})}else if(a.indexOf("extend")>-1)m.type="extend",m.config=$.extend(!0,{},h.config),m.curconfig=$.extend(!0,{},l),m.range=$.extend(!0,[],h.luckysheet_select_save),m.currange=o,m.ctrlType=a,m.ctrlValue=s,He.saveParam("arc",h.currentSheetIndex,{index:s.index,len:s.len,direction:s.direction,mc:l.merge},{rc:s.type});else if(a.indexOf("dele")>-1)m.type="dele",m.config=$.extend(!0,{},h.config),m.curconfig=$.extend(!0,{},l),m.range=$.extend(!0,[],h.luckysheet_select_save),m.currange=o,m.ctrlType=a,m.ctrlValue=s,He.saveParam("drc",h.currentSheetIndex,{index:s.index,len:s.len,mc:l.merge,borderInfo:l.borderInfo},{rc:s.type});else{m.type="datachangeAll",m.range=$.extend(!0,[],h.luckysheet_select_save),m.currange=o,m.ctrlType=a,m.ctrlValue=s,d=!0;for(let g=0;g<o.length;g++)He.historyParam(t,h.currentSheetIndex,o[g])}h.clearjfundo&&(h.jfundo.length=0,m.data=h.flowdata,m.curdata=t,m.sheetIndex=h.currentSheetIndex,m.cdformat=$.extend(!0,[],h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save),m.curCdformat=u,h.jfredo.push(m)),h.flowdata=t,pt.webWorkerFlowDataCache(t),h.luckysheetfile[$e(h.currentSheetIndex)].data=h.flowdata,l!=null&&(h.config=l,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("all",h.currentSheetIndex,l,{k:"config"})),u!=null&&(h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save=u,He.saveParam("all",h.currentSheetIndex,u,{k:"luckysheet_conditionformat_save"})),h.luckysheet_select_save=$.extend(!0,[],o),h.luckysheet_select_save.length>0&&Zt(),d&&Jm(o,h.currentSheetIndex,t),Nl(n,e),f&&(co=setTimeout(function(){Et()},1)),ct.storeSheetParamALL(),window.luckysheet_getcelldata_cache=null}function bc(e,n,t){clearTimeout(co),h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"rangechange",data:h.flowdata,curdata:e,range:n,sheetIndex:h.currentSheetIndex,cdformat:$.extend(!0,[],h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save),curCdformat:t})),h.flowdata=e,pt.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[$e(h.currentSheetIndex)].data=h.flowdata,t!=null&&(h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save=t),Jm(n,h.currentSheetIndex,e),co=setTimeout(function(){Et()},1);for(let l=0;l<n.length;l++)He.historyParam(h.flowdata,h.currentSheetIndex,n[l])}function Ka(e,n,t,l,o,a,s,u,f,m,d){let g=h.luckysheetfile[$e(h.currentSheetIndex)];Qa();let b=[];for(let S in n.merge){let I=n.merge[S];for(let O=I.r;O<=I.r+I.rs-1;O++)for(let F=I.c;F<=I.c+I.cs-1;F++)e[O][F]==null&&(e[O][F]={}),O==I.r&&F==I.c?e[O][F].mc=I:e[O][F].mc={r:I.r,c:I.c},b.push({r:O,c:F})}let y=[];h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:t,sheetIndex:h.currentSheetIndex,data:h.flowdata,curData:e,config:$.extend(!0,{},h.config),curConfig:n,ctrlValue:l,mcData:b,calc:$.extend(!0,[],g.calcChain),curCalc:o,funcData:y,filterObj:{filter_select:$.extend(!0,{},g.filter_select),filter:$.extend(!0,{},g.filter)},curFilterObj:a,cf:$.extend(!0,[],g.luckysheet_conditionformat_save),curCf:s,af:$.extend(!0,[],g.luckysheet_alternateformat_save),curAf:u,freezen:{freezenhorizontaldata:we.freezenhorizontaldata,freezenverticaldata:we.freezenverticaldata},curFreezen:f,dataVerification:$.extend(!0,{},g.dataVerification),curDataVerification:m,hyperlink:$.extend(!0,{},g.hyperlink),curHyperlink:d,range:g.luckysheet_select_save,dataRange:[...g.luckysheet_select_save]}));let p=l.index,x=l.len,_=l.rc;if(t=="addRC"){let S=l.direction,I=l.restore,O=[];if(I){if(_=="r"){let F;S=="lefttop"?F=p:S=="rightbottom"&&(F=p+1);let D=F+x-1;for(let k=F;k<=D;k++){let w=[];for(let C=0;C<e[0].length;C++){let T=e[k][C];w.push(T)}O.push(w)}}else if(_=="c"){let F;S=="lefttop"?F=p:S=="rightbottom"&&(F=p+1);let D=F+x-1;for(let k=0;k<e.length;k++){let w=[];for(let C=F;C<=D;C++){let T=e[k][C];w.push(T)}O.push(w)}}}He.saveParam("arc",h.currentSheetIndex,{index:p,len:x,direction:S,data:O},{rc:_})}else t=="delRC"&&He.saveParam("drc",h.currentSheetIndex,{index:p,len:x},{rc:_});h.flowdata=e,pt.webWorkerFlowDataCache(h.flowdata),g.data=e,h.config=n,g.config=h.config,He.saveParam("all",h.currentSheetIndex,n,{k:"config"});for(let S=0;S<b.length;S++){let I=b[S].r,O=b[S].c;He.saveParam("v",h.currentSheetIndex,h.flowdata[I][O],{r:I,c:O})}if(o.length>0)for(let S=0;S<o.length;S++){let I=o[S],O=I.r,F=I.c,D=I.index,k=Jn(O,F,D,e),w=v.execfunction(k,O,F,D,null,!0);I.func=w,e[O][F].f==k&&er(O,F,e,w[1])}g.calcChain=o,He.saveParam("all",h.currentSheetIndex,o,{k:"calcChain"});for(let S=0;S<y.length;S++){let I=y[S].r,O=y[S].c;He.saveParam("v",h.currentSheetIndex,h.flowdata[I][O],{r:I,c:O})}a!=null?(g.filter_select=a.filter_select,g.filter=a.filter):(g.filter_select=null,g.filter=null),Bn(g.filter_select,g.filter),He.saveParam("all",h.currentSheetIndex,g.filter_select,{k:"filter_select"}),He.saveParam("all",h.currentSheetIndex,g.filter,{k:"filter"}),g.luckysheet_conditionformat_save=s,He.saveParam("all",h.currentSheetIndex,g.luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"}),g.luckysheet_alternateformat_save=u,He.saveParam("all",h.currentSheetIndex,g.luckysheet_alternateformat_save,{k:"luckysheet_alternateformat_save"}),f!=null?(we.freezenhorizontaldata=f.freezenhorizontaldata,we.freezenverticaldata=f.freezenverticaldata):(we.freezenhorizontaldata=null,we.freezenverticaldata=null),Vt.dataVerification=m,g.dataVerification=m,He.saveParam("all",h.currentSheetIndex,g.dataVerification,{k:"dataVerification"}),Mn.hyperlink=d,g.hyperlink=d,He.saveParam("all",h.currentSheetIndex,g.hyperlink,{k:"hyperlink"}),Nl(h.flowdata.length,h.flowdata[0].length)}function Pu(e,n,t,l,o,a,s,u){let f=h.luckysheetfile[$e(h.currentSheetIndex)];clearTimeout(co),Qa();let m=[];if(JSON.stringify(n.merge)=="{}")for(let g=0;g<e.length;g++)for(let b=0;b<e[0].length;b++){let y=e[g][b];y!=null&&y.mc!=null&&(delete y.mc,m.push({r:g,c:b}))}else for(let g in n.merge){let b=n.merge[g];for(let y=b.r;y<=b.r+b.rs-1;y++)for(let p=b.c;p<=b.c+b.cs-1;p++)if(e[y][p]==null&&(e[y][p]={}),y==b.r&&p==b.c)JSON.stringify(e[y][p].mc)!=JSON.stringify(b)&&(e[y][p].mc=b,m.push({r:y,c:p}));else{let x={r:b.r,c:b.c};JSON.stringify(e[y][p].mc)!=JSON.stringify(x)&&(e[y][p].mc=x,m.push({r:y,c:p}))}}let d=[];if(h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"deleteCell",sheetIndex:h.currentSheetIndex,ctrl:t,data:h.flowdata,curData:e,config:$.extend(!0,{},h.config),curConfig:n,mcData:m,calc:$.extend(!0,[],f.calcChain),curCalc:l,funcData:d,filterObj:{filter_select:$.extend(!0,{},f.filter_select),filter:$.extend(!0,{},f.filter)},curFilterObj:o,cf:$.extend(!0,[],f.luckysheet_conditionformat_save),curCf:a,dataVerification:$.extend(!0,{},f.dataVerification),curDataVerification:s,hyperlink:$.extend(!0,{},f.hyperlink),curHyperlink:u,range:f.luckysheet_select_save,dataRange:[...f.luckysheet_select_save]})),h.flowdata=e,pt.webWorkerFlowDataCache(h.flowdata),f.data=e,He.allowUpdate){let g=t.type,b=t.str,y=t.edr,p=t.stc,x=t.edc,_;g=="moveUp"?_={row:[b,e.length-1],column:[p,x]}:g=="moveLeft"&&(_={row:[b,y],column:[p,e[0].length-1]}),He.historyParam(h.flowdata,h.currentSheetIndex,_)}h.config=n,f.config=h.config,He.saveParam("all",h.currentSheetIndex,n,{k:"config"});for(let g=0;g<m.length;g++){let b=m[g].r,y=m[g].c;He.saveParam("v",h.currentSheetIndex,h.flowdata[b][y],{r:b,c:y})}if(l.length>0)for(let g=0;g<l.length;g++){let b=l[g],y=b.r,p=b.c,x=b.index,_=Jn(y,p,x,e),S=v.execfunction(_,y,p,x,null,!0);b.func=S,e[y][p].f==_&&er(y,p,e,S[1])}f.calcChain=l,He.saveParam("all",h.currentSheetIndex,l,{k:"calcChain"});for(let g=0;g<d.length;g++){let b=d[g].r,y=d[g].c;He.saveParam("v",h.currentSheetIndex,h.flowdata[b][y],{r:b,c:y})}o!=null?(f.filter_select=o.filter_select,f.filter=o.filter):(f.filter_select=null,f.filter=null),Bn(f.filter_select,f.filter),He.saveParam("all",h.currentSheetIndex,f.filter_select,{k:"filter_select"}),He.saveParam("all",h.currentSheetIndex,f.filter,{k:"filter"}),f.luckysheet_conditionformat_save=a,He.saveParam("all",h.currentSheetIndex,f.luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"}),Vt.dataVerification=s,f.dataVerification=s,He.saveParam("all",h.currentSheetIndex,f.dataVerification,{k:"dataVerification"}),Mn.hyperlink=u,f.hyperlink=u,He.saveParam("all",h.currentSheetIndex,f.hyperlink,{k:"hyperlink"}),co=setTimeout(function(){Et()},1)}function Dc(e,n,t){let l={};v.execFunctionExist=[],clearTimeout(co);for(let u=e.range.row[0];u<=e.range.row[1];u++)for(let f=e.range.column[0];f<=e.range.column[1];f++)u+"_"+f+"_"+e.sheetIndex in l||(l[u+"_"+f+"_"+e.sheetIndex]=0,v.execFunctionExist.push({r:u,c:f,i:e.sheetIndex}));for(let u=n.range.row[0];u<=n.range.row[1];u++)for(let f=n.range.column[0];f<=n.range.column[1];f++)u+"_"+f+"_"+n.sheetIndex in l||(l[u+"_"+f+"_"+n.sheetIndex]=0,v.execFunctionExist.push({r:u,c:f,i:n.sheetIndex}));h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"pasteCut",source:e,target:n,RowlChange:t}));let o;if(h.currentSheetIndex==e.sheetIndex?(h.config=e.curConfig,o=e.curData.length,h.luckysheetfile[$e(n.sheetIndex)].config=n.curConfig):h.currentSheetIndex==n.sheetIndex&&(h.config=n.curConfig,o=n.curData.length,h.luckysheetfile[$e(e.sheetIndex)].config=e.curConfig),t){h.visibledatarow=[],h.rh_height=0;for(let u=0;u<o;u++){let f=h.defaultrowlen;if(h.config.rowlen!=null&&h.config.rowlen[u]!=null&&(f=h.config.rowlen[u]),h.config.rowhidden!=null&&h.config.rowhidden[u]!=null){f=h.config.rowhidden[u],h.visibledatarow.push(h.rh_height);continue}else h.rh_height+=f+1;h.visibledatarow.push(h.rh_height)}if(h.rh_height+=80,h.currentSheetIndex==e.sheetIndex){let u=ch(n.curData.length,n.curConfig);h.luckysheetfile[$e(n.sheetIndex)].visibledatarow=u}else if(h.currentSheetIndex==n.sheetIndex){let u=ch(e.curData.length,e.curConfig);h.luckysheetfile[$e(e.sheetIndex)].visibledatarow=u}}h.currentSheetIndex==e.sheetIndex?(h.flowdata=e.curData,h.luckysheetfile[$e(n.sheetIndex)].data=n.curData):h.currentSheetIndex==n.sheetIndex&&(h.flowdata=n.curData,h.luckysheetfile[$e(e.sheetIndex)].data=e.curData),pt.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[$e(h.currentSheetIndex)].data=h.flowdata,h.currentSheetIndex==n.sheetIndex?h.luckysheet_select_save=[{row:n.range.row,column:n.range.column}]:h.luckysheet_select_save=[{row:e.range.row,column:e.range.column}],h.luckysheet_select_save.length>0&&Zt(),h.luckysheetfile[$e(e.sheetIndex)].luckysheet_conditionformat_save=e.curCdformat,h.luckysheetfile[$e(n.sheetIndex)].luckysheet_conditionformat_save=n.curCdformat,h.currentSheetIndex==e.sheetIndex?Vt.dataVerification=e.curDataVerification:h.currentSheetIndex==n.sheetIndex&&(Vt.dataVerification=n.curDataVerification),h.luckysheetfile[$e(e.sheetIndex)].dataVerification=e.curDataVerification,h.luckysheetfile[$e(n.sheetIndex)].dataVerification=n.curDataVerification,v.execFunctionExist.reverse(),v.execFunctionGroup(null,null,null,null,n.curData),v.execFunctionGlobalData=null;let a=$e(h.currentSheetIndex),s=h.luckysheetfile[a];s.scrollTop=$("#luckysheet-cell-main").scrollTop(),s.scrollLeft=$("#luckysheet-cell-main").scrollLeft(),ct.showSheet(),co=setTimeout(function(){Et()},1),ct.storeSheetParamALL(),He.saveParam("all",e.sheetIndex,e.curConfig,{k:"config"}),He.saveParam("all",n.sheetIndex,n.curConfig,{k:"config"}),He.historyParam(e.curData,e.sheetIndex,{row:e.range.row,column:e.range.column}),He.historyParam(n.curData,n.sheetIndex,{row:n.range.row,column:n.range.column}),He.saveParam("all",e.sheetIndex,e.curCdformat,{k:"luckysheet_conditionformat_save"}),He.saveParam("all",n.sheetIndex,n.curCdformat,{k:"luckysheet_conditionformat_save"}),He.saveParam("all",e.sheetIndex,e.curDataVerification,{k:"dataVerification"}),He.saveParam("all",n.sheetIndex,n.curDataVerification,{k:"dataVerification"})}function Nl(e,n,t=!0){ya(e,n),clearTimeout(co),ct.storeSheetParam();let l=h.luckysheetfile[$e(h.currentSheetIndex)].calcChain;if(l!=null&&l.length>0){h.config.rowlen==null&&(h.config.rowlen={}),h.config.columnlen==null&&(h.config.columnlen={});for(let o=0;o<l.length;o++){let a=l[o].r,s=l[o].c;if(l[o].index==h.currentSheetIndex&&h.flowdata[a][s]!=null&&h.flowdata[a][s].spl!=null&&(a in h.config.rowlen||s in h.config.columnlen)){window.luckysheetCurrentRow=a,window.luckysheetCurrentColumn=s,window.luckysheetCurrentFunction=h.flowdata[a][s].f;let f=$.trim(v.functionParserExe(h.flowdata[a][s].f)),m=new Function("return "+f)();h.flowdata[a][s].spl=m,He.saveParam("v",h.currentSheetIndex,h.flowdata[a][s],{r:a,c:s})}}h.luckysheetfile[$e(h.currentSheetIndex)].data=h.flowdata}if(Nt.positionSync(),Zt(),Qa(),$(".luckysheet-selection-copy").is(":visible")&&Jl(),$("#luckysheet-dropCell-icon").is(":visible")&&$("#luckysheet-dropCell-icon").remove(),we.freezenhorizontaldata!=null&&we.freezenverticaldata!=null){let o=we.freezenhorizontaldata[1]-1,a=we.freezenverticaldata[1]-1,s=we.freezenhorizontaldata[2],u=we.freezenverticaldata[2],f=h.visibledatarow[o]-2-s+h.columnHeaderHeight,m=[h.visibledatarow[o],o+1,s,we.cutVolumn(h.visibledatarow,o+1),f],d=h.visibledatacolumn[a]-2-u+h.rowHeaderWidth,g=[h.visibledatacolumn[a],a+1,u,we.cutVolumn(h.visibledatacolumn,a+1),d];we.saveFreezen(m,f,g,d),we.createFreezenHorizontal(m,f),we.createFreezenVertical(g,d),we.createAssistCanvas()}else if(we.freezenhorizontaldata!=null){let o=we.freezenhorizontaldata[1]-1,a=we.freezenhorizontaldata[2],s=h.visibledatarow[o]-2-a+h.columnHeaderHeight,u=[h.visibledatarow[o],o+1,a,we.cutVolumn(h.visibledatarow,o+1),s];we.saveFreezen(u,s,null,null),we.createFreezenHorizontal(u,s),we.createAssistCanvas()}else if(we.freezenverticaldata!=null){let o=we.freezenverticaldata[1]-1,a=we.freezenverticaldata[2],s=h.visibledatacolumn[o]-2-a+h.rowHeaderWidth,u=[h.visibledatacolumn[o],o+1,a,we.cutVolumn(h.visibledatacolumn,o+1),s];we.saveFreezen(null,null,u,s),we.createFreezenVertical(u,s),we.createAssistCanvas()}else $("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").length>0&&$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(o,a){let s=$(a).data("str"),u=$(a).data("cindex"),f=h.visibledatacolumn[u]-20,m=s-1==-1?0:h.visibledatarow[s-1];$(a).css({left:f,top:m})});if($("#luckysheet-filter-selected-sheet"+h.currentSheetIndex).length>0){let o=h.luckysheetfile[$e(h.currentSheetIndex)].filter_select,a=o.row[0],s=o.row[1],u=o.column[0],f=o.column[1],m=h.visibledatarow[s],d=a-1==-1?0:h.visibledatarow[a-1],g=h.visibledatacolumn[f],b=u-1==-1?0:h.visibledatacolumn[u-1];$("#luckysheet-filter-selected-sheet"+h.currentSheetIndex).css({left:b,width:g-b-1,top:d,height:m-d-1})}ct.showSheet(),t&&(co=setTimeout(function(){Et()},1))}function Et(e,n){if(v.groupValuesRefresh(),e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=$("#luckysheet-cell-main").scrollTop()),we.freezenverticaldata!=null||we.freezenhorizontaldata!=null){let t,l,o,a,s,u,f=h.luckysheetTableContentHW[0],m=h.luckysheetTableContentHW[1];we.freezenverticaldata!=null&&we.freezenhorizontaldata!=null?(t=we.freezenhorizontaldata[0],l=we.freezenhorizontaldata[1],o=we.freezenhorizontaldata[2],a=we.freezenverticaldata[0],s=we.freezenverticaldata[1],u=we.freezenverticaldata[2],$i(u,o,a,t,1,1,null,null,"freezen_3"),$i(e+a-u,o,f-a+u,t,1,1,null,null,"freezen_4"),$i(u,n+t-o,a,m-t+o,1,1,null,null,"freezen_7"),$i(e+a-u,n+t-o,f-a+u,m-t+o,a-u+h.rowHeaderWidth,t-o+h.columnHeaderHeight),zs(u,a,h.rowHeaderWidth),zs(e+a-u,f-a+u,a-u+h.rowHeaderWidth),As(o,t,h.columnHeaderHeight),As(n+t-o,m-t+o,t-o+h.columnHeaderHeight)):we.freezenhorizontaldata!=null?(t=we.freezenhorizontaldata[0],l=we.freezenhorizontaldata[1],o=we.freezenhorizontaldata[2],$i(e,o,f,t,1,1,null,null,"freezen_h"),$i(e,n+t-o,f,m-t+o,null,t-o+h.columnHeaderHeight),zs(e,f,null),As(o,t,h.columnHeaderHeight),As(n+t-o,m-t+o,t-o+h.columnHeaderHeight)):we.freezenverticaldata!=null&&(a=we.freezenverticaldata[0],s=we.freezenverticaldata[1],u=we.freezenverticaldata[2],$i(u,n,a,m,1,1,null,null,"freezen_v"),$i(e+a-u,n,f-a+u,m,a-u+h.rowHeaderWidth,null),As(n,m,null),zs(u,a,h.rowHeaderWidth),zs(e+a-u,f-a+u,a-u+h.rowHeaderWidth))}else{if($("#luckysheetTableContent").length==0)return;let t=$("#luckysheetTableContent").get(0).getContext("2d");$i(e,n),zs(e),As(n),t.clearRect(0,0,h.rowHeaderWidth*h.devicePixelRatio-1,h.columnHeaderHeight*h.devicePixelRatio-1)}}var import_plugin,co,fr=Tt(()=>{import_plugin=Le(Be());zu();ir();br();io();mr();Hi();vh();li();wr();Yr();Fo();Vi();Mc();vr();wa();ql();Ut();co=null});function i1(e,n,t){return new Promise((l,o)=>{let a=new XMLHttpRequest||new ActiveXObject("Microsoft.XMLHTTP");a.open(e,n),a.send(JSON.stringify(t)),a.onreadystatechange=function(){a.readyState==4&&(a.status==200?l(a.responseText):o("error"))}})}var import_plugin,o1=Tt(()=>{import_plugin=Le(Be())});var import_plugin,Qm,ju,Os,He,wr=Tt(()=>{import_plugin=Le(Be()),Qm=Le(fy());_m();fr();br();ar();Yr();Mr();wa();li();Fo();To();Vi();Mc();gl();ql();Ut();vr();Rl();ju=Le(ka());Sc();bn();o1();qn();Os={gridKey:null,loadUrl:null,updateUrl:null,updateImageUrl:null,title:null,loadSheetUrl:null,retryTimer:null,allowUpdate:!1,historyParam:function(e,n,t){let l=this,o=t.row[0],a=t.row[1],s=t.column[0],u=t.column[1];if(o==a&&s==u){let f=e[o][s];l.saveParam("v",n,f,{r:o,c:s})}else{let f=a-o+1,m=u-s+1,d=Math.floor(1e3/m),g=Math.ceil(f/d);for(let b=0;b<g;b++){let y=o+d*b,p;b==g-1?p=a:p=o+d*(b+1)-1;let x=[];for(let _=y;_<=p;_++){let S=[];for(let I=s;I<=u;I++)e[_]==null?S.push(null):S.push(e[_][I]);x.push(S)}l.saveParam("rv",n,x,{range:{row:[y,p],column:[s,u]}}),b==g-1&&l.saveParam("rv_end",n,null)}}},saveParam:function(e,n,t,l){let o=this;if(!o.allowUpdate)return;t==null&&(t=null);let a={};if(a.t=e,a.i=n,a.v=t,e==="shs")return;e=="rv"?a.range=l.range:e=="v"||e=="fu"||e=="fm"?(a.r=l.r,a.c=l.c):e=="fc"?(a.op=l.op,a.pos=l.pos):e=="drc"||e=="arc"||e=="h"||e=="wh"?a.rc=l.rc:e=="c"?(a.cid=l.cid,a.op=l.op):e=="f"?(a.op=l.op,a.pos=l.pos):e=="s"||(e=="sh"?(a.op=l.op,l.cur!=null&&(a.cur=l.cur)):(e=="cg"||e=="all")&&(a.k=l.k));let s=lt.imageUpdateMethodConfig;if(JSON.stringify(s)!=="{}")if(a.k!="images"){let u=Qm.default.gzip(encodeURIComponent(JSON.stringify(a)),{to:"string"});o.websocket!=null&&o.websocket.send(u)}else i1(s.method,s.url,a).then(u=>{console.log(u)}).catch(u=>{console.log(u)});else{let u=Qm.default.gzip(encodeURIComponent(JSON.stringify(a)),{to:"string"});o.websocket!=null&&o.websocket.send(u)}},websocket:null,wxErrorCount:0,openWebSocket:function(){let e=this;if("WebSocket"in window){let n=e.updateUrl+"?t=111&g="+encodeURIComponent(e.gridKey);e.updateUrl.indexOf("?")>-1&&(n=e.updateUrl+"&t=111&g="+encodeURIComponent(e.gridKey)),e.websocket=new WebSocket(n),e.websocket.onopen=function(){console.info(Oe().websocket.success),Ru(),e.wxErrorCount=0,e.retryTimer=setInterval(function(){e.websocket.send("rub")},6e4)},e.websocket.onmessage=function(t){h.result=t;let l=new Function("return "+t.data)();Yt.createHookFunction("cooperativeMessage",l),console.info(l);let o=l.type,{message:a,id:s}=l;if(a==="\u7528\u6237\u9000\u51FA"&&($("#luckysheet-multipleRange-show-"+s).hide(),h.cooperativeEdit.changeCollaborationSize=h.cooperativeEdit.changeCollaborationSize.filter(u=>u.id!=s),h.cooperativeEdit.checkoutData=h.cooperativeEdit.checkoutData.filter(u=>u.id!=s)),o==1){let u=l.data.v.index,f=h.luckysheetfile.filter(m=>m.index===u)[0];f!==null&&setTimeout(()=>{let m=l.data.i;f.index=m,h.currentSheetIndex=m,$(`#luckysheet-sheets-item${u}`).attr("data-index",m),$(`#luckysheet-sheets-item${u}`).prop("id",`luckysheet-sheets-item${m}`),$(`#luckysheet-datavisual-selection-set-${u}`).prop("id",`luckysheet-datavisual-selection-set-${m}`)},1)}else if(o==2){let u=JSON.parse(l.data);e.wsUpdateMsg(u);let f=JSON.parse(l.data);f.k=="columnlen"?Qa(f.v,null):f.k=="rowlen"&&Qa(null,f.v)}else if(o==3){let u=l.id,f=l.username,m=JSON.parse(l.data),d=m.t,g=m.i,b=m.v;h.cooperativeEdit.changeCollaborationSize.length===0&&h.cooperativeEdit.changeCollaborationSize.push({id:u,v:m.v[0],i:g}),h.cooperativeEdit.changeCollaborationSize.some(S=>S.id==u)?h.cooperativeEdit.changeCollaborationSize.forEach(S=>{S.id==u&&(S.v=m.v[0]||m.range[0],S.i=g)}):h.cooperativeEdit.changeCollaborationSize.push({id:u,v:m.v[0],i:g}),V(b)!="array"&&V(b)!=="object"&&(b=JSON.parse(b));let p=0,x=0;if(g==h.currentSheetIndex?V(b)==="object"&&b.op==="enterEdit"?(p=b.range[b.range.length-1].row[0],x=b.range[b.range.length-1].column[0],e.multipleRangeShow(u,f,p,x,b.op)):(p=b[b.length-1].row[0],x=b[b.length-1].column[0],e.multipleRangeShow(u,f,p,x)):V(b)==="object"&&b.op==="enterEdit"?(p=b.range[b.range.length-1].row[0],x=b.range[b.range.length-1].column[0]):(p=b[b.length-1].row[0],x=b[b.length-1].column[0]),h.cooperativeEdit.checkoutData.length===0&&(b.op?h.cooperativeEdit.checkoutData.push({id:u,username:f,r:p,c:x,op:b.op,index:g}):h.cooperativeEdit.checkoutData.push({id:u,username:f,r:p,c:x,index:g})),h.cooperativeEdit.checkoutData.some(S=>S.id==u)?h.cooperativeEdit.checkoutData.forEach(S=>{S.id==u&&(S.username=f,S.r=p,S.c=x,S.index=g,b.op==="enterEdit"&&(S.op=b.op))}):b.op==="enterEdit"?h.cooperativeEdit.checkoutData.push({id:u,username:f,r:p,c:x,op:b.op,index:g}):h.cooperativeEdit.checkoutData.push({id:u,username:f,r:p,c:x,index:g}),h.cooperativeEdit.checkoutData.forEach(S=>{S.index!=h.currentSheetIndex&&($("#luckysheet-multipleRange-show-"+S.id).hide(),S.op=="")}),$("#luckysheet-multipleRange-show-"+u)[0]){let S=$("#luckysheet-multipleRange-show-"+u)[0].offsetHeight-1;$("#luckysheet-multipleRange-show-"+u+">.username").css({bottom:S+"px"})}}else if(o==4){let u=l.data===""?l.data:JSON.parse(l.data);for(let f=0;f<u.length;f++)e.wsUpdateMsg(item[f])}else o==5?kc(l.data):o==6&&Ru()},e.websocket.onerror=function(){e.wxErrorCount++,e.wxErrorCount>3?kc(Oe().websocket.refresh):(kc(Oe().websocket.wait),e.openWebSocket())},e.websocket.onclose=function(t){console.info(Oe().websocket.close),t.code===1e3?(clearInterval(e.retryTimer),e.retryTimer=null):alert(Oe().websocket.contact)}}else alert(Oe().websocket.support)},wsUpdateMsg:function(e){let n=e.t,t=e.i,l=e.v,o=h.luckysheetfile[$e(t)];if(!(["v","rv","cg","all","fc","drc","arc","f","fsc","fsr","sh","c"].includes(n)&&o==null))if(n=="v"){if(o.data==null||o.data.length==0)return;let a=e.r,s=e.c;o.data[a][s]=l,t==h.currentSheetIndex&&(h.flowdata=o.data,pt.webWorkerFlowDataCache(h.flowdata),l!=null&&l.ps!=null?Nt.buildPs(a,s,l.ps):Nt.buildPs(a,s,null),setTimeout(function(){Et()},1))}else if(n=="rv"){if(Object.keys(e.range).length>0&&(h.cooperativeEdit.merge_range=e.range,h.cooperativeEdit.merge_range.v=e.v,Qa()),o.data==null||o.data.length==0)return;let a=e.range.row[0],s=e.range.row[1],u=e.range.column[0],f=e.range.column[1];for(let m=a;m<=s;m++)for(let d=u;d<=f;d++)o.data[m][d]=l[m-a][d-u];if(t==h.currentSheetIndex){h.flowdata=o.data,pt.webWorkerFlowDataCache(h.flowdata);for(let m=a;m<=s;m++)for(let d=u;d<=f;d++)l[m-a][d-u]!=null&&l[m-a][d-u].ps!=null?Nt.buildPs(m,d,l[m-a][d-u].ps):Nt.buildPs(m,d,null);setTimeout(function(){Et()},1)}}else if(n=="cg"){let a=e.k;a=="borderInfo"?o.config.borderInfo=l:(a in o.config||(o.config[a]={}),l&&typeof l=="object"&&(o.config[a]=l)),t==h.currentSheetIndex&&(h.config=o.config,(a=="rowlen"||a=="columnlen"||a=="rowhidden")&&Nl(h.flowdata.length,h.flowdata[0].length),setTimeout(function(){Et()},1))}else if(n=="all"){let a=e.k;if(o[a]=l,a=="name")$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+t).find("span.luckysheet-sheets-item-name").html(l);else if(a=="color"){let s=$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+t);s.find(".luckysheet-sheets-item-color").remove(),(l!=null||l!="")&&s.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+l+';"></div>')}else if(a!="pivotTable")if(a=="frozen"){if(we.frozenTofreezen(),t==h.currentSheetIndex){let u=Oe().freezen;o.freezen.horizontal==null?($("#luckysheet-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> '+u.freezenRow),we.freezenhorizontaldata=null,$("#luckysheet-freezebar-horizontal").hide()):we.createFreezenHorizontal(o.freezen.horizontal.freezenhorizontaldata,o.freezen.horizontal.top),o.freezen.vertical==null?($("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> '+u.freezenColumn),we.freezenverticaldata=null,$("#luckysheet-freezebar-vertical").hide()):we.createFreezenVertical(o.freezen.vertical.freezenverticaldata,o.freezen.vertical.left),we.createAssistCanvas()}}else a=="filter_select"?t==h.currentSheetIndex&&Bn(l):a=="filter"?t==h.currentSheetIndex&&Bn(o.filter_select,l):a=="luckysheet_conditionformat_save"?t==h.currentSheetIndex&&setTimeout(function(){Et()},1):a=="luckysheet_alternateformat_save"?t==h.currentSheetIndex&&setTimeout(function(){Et()},1):a=="config"?t==h.currentSheetIndex&&(h.config=l,Nl(h.flowdata.length,h.flowdata[0].length)):a=="dynamicArray"?t==h.currentSheetIndex&&setTimeout(function(){Et()},1):a=="images"?t==h.currentSheetIndex&&($t.images=l,$t.allImagesShow(),$t.init()):a=="dataVerification"?t==h.currentSheetIndex&&(Vt.dataVerification=l,Vt.init()):a=="hyperlink"&&t==h.currentSheetIndex&&(Mn.hyperlink=l,Mn.init())}else if(n=="fc"){let a=e.op,s=e.pos;V(l)!="object"&&(l=new Function("return "+l)());let u=l.r,f=l.c,m=o.calcChain==null?[]:o.calcChain;if(a=="add")m.push(l);else if(a=="del")for(let d=0;d<m.length;d++)u==m[d].r&&f==m[d].c&&t==m[d].index&&m.splice(d,1);setTimeout(function(){Et()},1)}else if(n=="drc"){if(o.data==null||o.data.length==0)return;let a=e.rc,s=l.index,u=l.len,f=l.mc,m=l.borderInfo,d=o.data;if(a=="r"){o.row-=u,d.splice(s,u);let g=[];for(let b=0;b<d[0].length;b++)g.push(null);for(let b=0;b<u;b++)d.push(g)}else{o.column-=u;let g=[];for(let b=0;b<u;b++)g.push(null);for(let b=0;b<d.length;b++)d[b].splice(s,u),d[b]=d[b].concat(g)}for(let g in f){let b=f[g].r,y=f[g].c;d[b][y].mc=f[g]}o.config.merge=f,o.config.borderInfo=m,t==h.currentSheetIndex&&(h.flowdata=d,pt.webWorkerFlowDataCache(h.flowdata),h.config.merge=f,h.config.borderInfo=m,setTimeout(function(){Et()},1))}else if(n=="arc"){if(o.data==null||o.data.length==0)return;let a=e.rc,s=l.index,u=l.len,f=l.data,m=l.direction,d=l.mc,g=l.borderInfo,b=$.extend(!0,[],o.data);if(a=="r"){o.row+=u;let y=[];for(let x=0;x<b[0].length;x++)y.push(null);let p=[];for(let x=0;x<u;x++)f[x]==null?p.push(JSON.stringify(y)):p.push(JSON.stringify(f[x]));m=="lefttop"?s==0?new Function("data","return data.unshift("+p.join(",")+")")(b):new Function("data","return data.splice("+s+", 0, "+p.join(",")+")")(b):new Function("data","return data.splice("+(s+1)+", 0, "+p.join(",")+")")(b)}else{o.column+=u;for(let y=0;y<b.length;y++)for(let p=0;p<u;p++)m=="lefttop"?b[y].splice(s,0,f[p]):b[y].splice(s+1,0,f[p])}for(let y in d){let p=d[y].r,x=d[y].c;b[p][x].mc=d[y]}o.data=b,o.config.merge=d,o.config.borderInfo=g,t==h.currentSheetIndex&&(h.flowdata=b,pt.webWorkerFlowDataCache(h.flowdata),h.config.merge=d,h.config.borderInfo=g,setTimeout(function(){Et()},1))}else if(n=="f"){let a=e.op,s=e.pos,u=o.filter;u==null&&(u={}),a=="upOrAdd"?u[s]=l:a=="del"&&delete u[s],t==h.currentSheetIndex&&Bn(o.filter_select,u)}else if(n=="fsc")o.filter=null,o.filter_select=null,t==h.currentSheetIndex&&($("#luckysheet-filter-selected-sheet"+h.currentSheetIndex+", #luckysheet-filter-options-sheet"+h.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide());else if(n=="fsr")o.filter=l.filter,o.filter_select=l.filter_select,t==h.currentSheetIndex&&Bn(o.filter_select,o.filter);else if(n=="sha"){h.luckysheetfile.push(l);let a="";l.color!=null&&(a='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+l.color+';"></div>'),$("#luckysheet-sheet-container-c").append(yt(bi,{index:l.index,active:"",name:l.name,style:"",colorset:a})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+l.index+'" class="luckysheet-datavisual-selection-set"></div>'),ct.locationSheet()}else if(n=="shc"){let a=l.copyindex,s=l.name,u=$e(a),f=$.extend(!0,{},h.luckysheetfile[u]);f.index=t,f.name=s,h.luckysheetfile.splice(u+1,0,f);let m=$("#luckysheet-sheets-item"+a);$("#luckysheet-sheet-container-c").append(yt(bi,{index:f.index,active:"",name:f.name,style:"",colorset:""})),$("#luckysheet-sheets-item"+f.index).insertAfter(m),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+f.index+'" class="luckysheet-datavisual-selection-set"></div>')}else if(n=="shd"){for(let a=0;a<h.luckysheetfile.length;a++)if(h.luckysheetfile[a].index==l.deleIndex){if(h.currentSheetIndex===l.deleIndex){let s=l.deleIndex;h.luckysheetfile[ct.getSheetIndex(s)].hide=1;let u=$("#luckysheet-sheets-item"+s);u.hide(),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active");let f=u.nextAll(":visible");u.nextAll(":visible").length>0?f=f.eq(0).data("index"):f=u.prevAll(":visible").eq(0).data("index"),$("#luckysheet-sheets-item"+f).addClass("luckysheet-sheets-item-active"),ct.changeSheetExec(f)}Os.sheetDeleSave.push(h.luckysheetfile[a]),h.luckysheetfile.splice(a,1);break}$("#luckysheet-sheets-item"+l.deleIndex).remove(),$("#luckysheet-datavisual-selection-set-"+l.deleIndex).remove(),ct.locationSheet()}else if(n=="shr")for(let a in l)h.luckysheetfile[$e(a)].order=l[a];else if(n=="shre"){for(let a=0;a<Os.sheetDeleSave.length;a++)if(Os.sheetDeleSave[a].index==l.reIndex){let s=Os.sheetDeleSave[a];h.luckysheetfile.push(s);let u="";l.color!=null&&(u='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+s.color+';"></div>'),$("#luckysheet-sheet-container-c").append(yt(bi,{index:s.index,active:"",name:s.name,style:"",colorset:u})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+s.index+'" class="luckysheet-datavisual-selection-set"></div>');break}}else if(n=="sh"){let a=e.op,s=e.cur;a=="hide"?(o.hide=1,$("#luckysheet-sheets-item"+t).hide(),t==h.currentSheetIndex&&($("#luckysheet-sheets-item"+s).addClass("luckysheet-sheets-item-active"),ct.changeSheetExec(s))):a=="show"&&(o.hide=0,$("#luckysheet-sheets-item"+t).show()),ct.locationSheet()}else if(n=="c"){let a=e.op,s=e.cid;if(a=="add")o.chart.push(l),luckysheet.insertChartTosheet(l.sheetIndex,l.dataSheetIndex,l.option,l.chartType,l.selfOption,l.defaultOption,l.row,l.column,l.chart_selection_color,l.chart_id,l.chart_selection_id,l.chartStyle,l.rangeConfigCheck,l.rangeRowCheck,l.rangeColCheck,l.chartMarkConfig,l.chartTitleConfig,l.winWidth,l.winHeight,l.scrollLeft1,l.scrollTop1,l.chartTheme,l.myWidth,l.myHeight,l.myLeft,l.myTop,l.myindexrank1,!0);else if(a=="xy"||a=="wh"||a=="update")for(let u=0;u<o.chart.length;u++){let f=o.chart[u];if(f.chart_id==s){for(let m in f)for(let d in l)m==d&&(f[m]=l[d]);ct.saveChart(f);return}}else if(a=="del"){for(let u=0;u<o.chart.length;u++)if(o.chart[u].chart_id==s){o.chart.splice(u,1),$("#"+s).remove(),ct.delChart($("#"+s).attr("chart_id"),$("#"+s).attr("sheetIndex"));return}}}else n=="na"&&$("#luckysheet_info_detail_input").val(l).css("width",Ps(l)*10)},multipleIndex:0,multipleRangeShow:function(e,n,t,l,o){let a=this,s=n,u=h.visibledatarow[t],f=t-1==-1?0:h.visibledatarow[t-1],m=h.visibledatacolumn[l],d=l-1==-1?0:h.visibledatacolumn[l-1],g=ht.mergeborer(h.flowdata,t,l);if(g&&(u=g.row[1],f=g.row[0],m=g.column[1],d=g.column[0]),d<=0&&(d+=1),f<=0&&(f+=1),Ps(n)>16&&(n=Ps(n,16)+"..."),o==="enterEdit"&&(n+=" "+Oe().edit.typing),$("#luckysheet-multipleRange-show-"+e).length>0)$("#luckysheet-multipleRange-show-"+e).css({position:"absolute",left:d-1,width:m-d-1,top:f-1,height:u-f-1}),$("#luckysheet-multipleRange-show-"+e+" .username").text(n),$("#luckysheet-multipleRange-show-"+e+" .username").show(),h.cooperativeEdit.usernameTimeout["user"+e]!=null&&clearTimeout(h.cooperativeEdit.usernameTimeout["user"+e]),h.cooperativeEdit.usernameTimeout["user"+e]=setTimeout(()=>{clearTimeout(h.cooperativeEdit.usernameTimeout["user"+e]),h.cooperativeEdit.usernameTimeout["user"+e]=null},10*1e3);else{let b=`<div
								id="luckysheet-multipleRange-show-${e}"
								class="luckysheet-multipleRange-show"
								data-color="${si[a.multipleIndex]}"
								title="${s}"
								style="position: absolute;left: ${d-1}px;width: ${m-d-1}px;top: ${f-1}px;height: ${u-f-1}px;border: 1px solid ${si[a.multipleIndex]};z-index: 15;">

								<div class="username" style="height: 19px;line-height:19px;width: max-content;position: absolute;bottom: ${u-f-1}px;right: 0;background-color: ${si[a.multipleIndex]};color:#ffffff;padding:0 10px;">
								${n}
								</div>

								<div style="width: 100%;height: 100%;position: absolute;top: 0;right: 0;bottom: 0;left: 0;opacity: 0.03;background-color: ${si[a.multipleIndex]}">
								</div>

							</div>`;$(b).appendTo($("#luckysheet-cell-main #luckysheet-multipleRange-show")),a.multipleIndex++,h.cooperativeEdit.usernameTimeout["user"+e]!=null&&clearTimeout(h.cooperativeEdit.usernameTimeout["user"+e]),h.cooperativeEdit.usernameTimeout["user"+e]=setTimeout(()=>{clearTimeout(h.cooperativeEdit.usernameTimeout["user"+e]),h.cooperativeEdit.usernameTimeout["user"+e]=null},10*1e3)}},sheetDeleSave:[],submitInterval:1e3,imagesubmitInterval:5e3,submitdatalimit:50,submitcompresslimit:1e3,checksubmit:function(e){let n=this;n.submitTimeout(),clearTimeout(n.imageRequestTimeout),n.imageRequestTimeout=setTimeout(function(){n.imageRequest()},n.imagesubmitInterval)},submitTimeout:function(){let e=this;clearTimeout(e.requestTimeOut),!e.requestLock&&e.requestlast!=null&&e.requestlast.clone().add(1,"seconds").isBefore((0,ju.default)())&&e.request(),e.requestTimeOut=setTimeout(function(){e.submitTimeout()},e.submitInterval)},requestLock:!1,requestlast:null,firstchange:!0,requestTimeOut:null,request:function(){let e=this,t=this.gridKey+"__qkcache";e.cachelocaldata(function(l,o){if(o.length==0)return;o=encodeURIComponent(JSON.stringify(o));let a=o.length,s=!1;e.requestLock=!0,e.updateUrl!=""&&$.post(e.updateUrl,{compress:s,gridKey:e.gridKey,data:o},function(u){new Function("return "+u)().status?($("#luckysheet_info_detail_update").html("\u6700\u8FD1\u5B58\u6863\u65F6\u95F4:"+(0,ju.default)().format("M-D H:m:s")),$("#luckysheet_info_detail_save").html("\u540C\u6B65\u6210\u529F"),e.clearcachelocaldata()):($("#luckysheet_info_detail_save").html("<span style='color:#ff2121'>\u540C\u6B65\u5931\u8D25</span>"),e.restorecachelocaldata()),e.requestlast=(0,ju.default)(),e.requestLock=!1})})},imageRequestLast:null,imageRequestLock:!1,imageRequestTimeout:null,imageRequest:function(){let e=this;html2canvas($("#"+container).find(".luckysheet-grid-window").get(0),{onrendered:function(n){let t=$(n).appendTo("body");t.hide();let l=t.width(),o=t.height(),a=t.get(0).getContext("2d").getImageData(0,0,l,o),s=l,u=o;s*.54>u?s=u/.54:u=s*.54;let f=$("<canvas>").attr("width",s).attr("height",u)[0];f.getContext("2d").putImageData(a,0,0),t.attr("width",350),t.attr("height",189),t.get(0).getContext("2d").drawImage(f,0,0,350,189);let m=t.get(0).toDataURL("image/jpeg",.9),d=luckysheet.sheetmanage.getCurSheetnoset();e.imageRequestLock=!0;let g=encodeURIComponent(JSON.stringify({t:"thumb",img:m,curindex:d}));t.remove(),e.updateImageUrl!=""&&$.post(e.updateImageUrl,{compress:!1,gridKey:e.gridKey,data:g},function(b){new Function("return "+b)().status?imageRequestLast=(0,ju.default)():$("#luckysheet_info_detail_save").html("<span style='color:#ff2121'>\u7F51\u7EDC\u4E0D\u7A33\u5B9A</span>"),e.imageRequestLock=!0})}})},localdata:[],matchOpt:function(e,n){for(let t in e){if(t=="t"&&e.t in{drc:1,arc:1,sha:1,shc:1,shd:1})return!1;if(t!="v"&&(!(t in n)||n[t]!=e[t]))return!1}return!0},deleteRepeatOpt:function(e,n){let t=e,l=this;if(n instanceof Array)for(let a=0;a<n.length;a++){let s=n[a];for(let u=0;u<t.length;u++){let f=e[a];l.matchOpt(s,f)&&delete t[u]}}else for(let a=0;a<t.length;a++){let s=t[a];l.matchOpt(n,s)&&delete t[a]}let o=[];for(let a=0;a<t.length;a++)t[a]!=null&&o.push(t[a]);return o},setlocaldata:function(e,n){let t=this.gridKey,l=this;l.getlocaldata(function(o){o==null&&(o=[]),e instanceof Array?o=o.concat(e):o.push(e),l.localdata=o,n(l.localdata)})},getlocaldata:function(e){let n=this.gridKey;e(this.localdata)},clearlocaldata:function(e){let n=this.gridKey;this.localdata=[],e()},cachelocaldata:function(e){let n=this.gridKey,t=this,l=n+"__qkcache",o=t.localdata,a=o.length;if(a>1){let s=[];s[0]=o[0];for(let u=1;u<a;u++){let f=o[u],m=!0;for(let d=0;d<s.length;d++){let g=s[d];if(t.matchOpt(f,g)){s.splice(d,1,f),m=!1;break}}m&&(s=s.concat(f))}o=s}o==null||o.length==0||t.clearlocaldata(function(){localforage.setItem(l,o).then(function(){e(l,o)})})},clearcachelocaldata:function(e){let t=this.gridKey+"__qkcache";localforage.removeItem(t,function(l,o){e&&typeof e=="function"&&e()})},restorecachelocaldata:function(e){let t=this.gridKey+"__qkcache",l=this;localforage.getItem(t).then(function(o){let a=o;l.getlocaldata(function(s){s==null&&(s=[]);let u=a.concat(s);l.localdata=u,e instanceof Function&&e(l.localdata)})})},keepHighLightBox:function(){h.cooperativeEdit.checkoutData.forEach(e=>{e.index==h.currentSheetIndex&&(e.op==="enterEdit"?Os.multipleRangeShow(e.id,e.username,e.r,e.c,e.op):Os.multipleRangeShow(e.id,e.username,e.r,e.c))})}},He=Os});var import_plugin,n3,de,Sr=Tt(()=>{import_plugin=Le(Be());ar();sc();gl();Rl();wr();n3={info:function(e,n){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-info").remove();let l=Oe().button;$("body").first().append(yt(kl,{id:"luckysheet-info",addclass:"",title:e,content:n,botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;'+l.close+"&nbsp;&nbsp;</button>",style:"z-index:100003"}));let o=$("#luckysheet-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-info").css({left:(u+m-s)/2,top:(f+d-a)/3}).show()},confirm:function(e,n,t,l,o,a){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove();let u=Oe().button;o==null&&(o=u.confirm),a==null&&(a=u.cancel),$("body").first().append(yt(kl,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:e,content:n,botton:'<button class="btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+o+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+a+"&nbsp;&nbsp;</button>"}));let f=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),m=f.outerHeight(),d=f.outerWidth(),g=$(window).width(),b=$(window).height(),y=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-confirm").css({left:(g+y-d)/2,top:(b+p-m)/3}).show(),f.find(".luckysheet-model-conform-btn").click(function(){typeof t=="function"&&t(),He.keepHighLightBox(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),f.find(".luckysheet-model-cancel-btn").click(function(){typeof l=="function"&&l(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()})},screenshot:function(e,n,t){let o=Oe().screenshot;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove(),$("body").first().append(yt(kl,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:e,content:n,botton:'<a style="text-decoration:none;color:#fff;" class="download btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+o.downLoadBtn+'&nbsp;&nbsp;</a>&nbsp;&nbsp;<button class="btn btn-primary luckysheet-model-copy-btn">&nbsp;&nbsp;'+o.downLoadCopy+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+o.downLoadClose+"&nbsp;&nbsp;</button>"}));let a=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),s=a.outerHeight(),u=a.outerWidth(),f=$(window).width(),m=$(window).height(),d=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-confirm").css({left:(f+d-u)/2,top:(m+g-s)/3}).show(),a.find(".luckysheet-model-conform-btn").click(function(){Ni.isIE()=="1"?alert(o.browserNotTip):(!!window.ActiveXObject||"ActiveXObject"in window)&&($("#IframeReportImg").length===0&&$('<iframe style="display:none;" id="IframeReportImg" name="IframeReportImg" onload="downloadImg();" width="0" height="0" src="about:blank"></iframe>').appendTo("body"),$("#IframeReportImg").attr("src")!=t?$("#IframeReportImg").attr("src",t):$("#IframeReportImg").src!="about:blank"&&window.frames.IframeReportImg.document.execCommand("SaveAs"))}),a.find(".luckysheet-model-cancel-btn").click(function(){$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#luckysheet-confirm .luckysheet-model-copy-btn").click(function(){let b=new clipboard.DT;b.setData("text/html","<img src='"+t+"'>"),Ni.isIE()=="1"?alert(o.rightclickTip):(clipboard.write(b),alert(o.successTip))})},chartPointConfig:function(e,n,t){$("body").first().append(yt(kl,{id:e,addclass:"luckysheet-chart-point-config-c",title:"\u6570\u636E\u70B9\u6279\u91CF\u8BBE\u7F6E",content:k0,botton:'<button class="btn btn-danger luckysheet-model-save-btn">&nbsp;&nbsp;\u4FDD\u5B58\u8BBE\u7F6E&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;\u53D6\u6D88&nbsp;&nbsp;</button>',style:"z-index:100003;height:80%;width:80%;top:10%;left:10%;"})),$("#luckysheet-modal-dialog-mask").show();let l=$(window).width(),o=$(window).height();$("#"+e).find(".luckysheet-chart-point-config").css("height",o-160),$("#"+e).css({height:o-90,width:l-100,left:7,top:14}).show().find(".luckysheet-model-save-btn").click(function(){typeof n=="function"&&n(),$("#"+e).hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#"+e).find(".luckysheet-model-save-btn").click(function(){typeof t=="function"&&t(),$("#"+e).hide(),$("#luckysheet-modal-dialog-mask").hide()})},sheetConfig:function(){},hoverTipshowState:!1,hoverTipshowTimeOut:null,createHoverTip:function(e,n){let t=this;$(e).on("mouseover",n,function(l){t.hoverTipshowState||(clearTimeout(t.hoverTipshowTimeOut),t.hoverTipshowTimeOut=setTimeout(function(){let o=$(l.currentTarget),a=o.offset(),s=$("#luckysheet-tooltip-up"),u=o.data("tips");if((u==null||u.length==0)&&(u=o.prev().data("tips"),u==null||u.length==0))return;s.length==0&&($("body").first().append(b0),s=$("#luckysheet-tooltip-up")),s.removeClass("jfk-tooltip-hide").find("div.jfk-tooltip-contentId").html(u);let f=s.outerWidth();s.find("div.jfk-tooltip-arrow").css("left",f/2);let m=a.left+(o.outerWidth()-f)/2;m<2&&(m=2,s.find("div.jfk-tooltip-arrow").css("left",o.outerWidth()/2)),s.css({top:a.top+o.outerHeight()+1,left:m})},300))}).on("mouseout",n,function(l){t.hoverTipshowState=!1,clearTimeout(t.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")}).on("click",n,function(l){t.hoverTipshowState=!0,clearTimeout(t.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")})},popover:function(e,n,t,l,o,a){let s=Oe(),u=s.button,f=s.paint;o==null&&(o=u.close);let m='<div id="luckysheetpopover" class="luckysheetpopover"><div class="luckysheetpopover-content">'+f.start+'</div><div class="luckysheetpopover-btn">'+o+"</div></div>";$("#luckysheetpopover").remove(),$("body").first().append(m),$("#luckysheetpopover .luckysheetpopover-content").html(e);let d=$("#luckysheetpopover").outerWidth(),g=$("#luckysheetpopover").outerHeight(),b={};n=="topLeft"?(b.top="20px",b.left="20px"):n=="topCenter"?(b.top="20px",b.left="50%",b["margin-left"]=-d/2):n=="topRight"?(b.top="20px",b.right="20px"):n=="midLeft"?(b.top="50%",b["margin-top"]=-g/2,b.left="20px"):n=="center"?(b.top="50%",b["margin-top"]=-g/2,b.left="50%",b["margin-left"]=-d/2):n=="midRight"?(b.top="50%",b["margin-top"]=-g/2,b.right="20px"):n=="bottomLeft"?(b.bottom="20px",b.left="20px"):n=="bottomCenter"?(b.bottom="20px",b.left="50%",b["margin-left"]=-d/2):n=="bottomRight"?(b.bottom="20px",b.right="20px"):(b.top="20px",b.left="50%",b["margin-left"]=-d/2),l=="white"&&(b.background="rgba(255, 255, 255, 0.65)",b.color="#000",$("#luckysheetpopover .luckysheetpopover-btn").css({border:"1px solid #000"})),setTimeout(function(){$("#luckysheetpopover .luckysheetpopover-content").css({"margin-left":-$("#luckysheetpopover .luckysheetpopover-btn").outerWidth()/2})},1),$("#luckysheetpopover").css(b).fadeIn(),$("#luckysheetpopover .luckysheetpopover-btn").click(function(){typeof a=="function"&&a()}),t!=null&&typeof t=="number"&&setTimeout(function(){$("#luckysheetpopover").fadeOut().remove(),typeof a=="function"&&a()},t)}},de=n3});var import_plugin,yh,i3,xt,ji=Tt(()=>{import_plugin=Le(Be());ql();gl();ir();Gl();Sr();fr();mr();Hn();ar();wr();vr();Yr();Rl();jn();Ut();yh=Le(ka()),i3={fileClone:[],editorRule:null,ruleTypeHtml:function(){let e=Oe().conditionformat;return`<div class="ruleTypeBox">
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem1}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem2}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem3}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem4}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem5}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem6}</span>
                    </div>
                </div>`},textCellColorHtml:function(){let e=Oe().conditionformat;return`<div id="textCellColor">
                    <div class="colorbox">
                        <input id="checkTextColor" type="checkbox" checked="checked">
                        <label for="checkTextColor">${e.textColor}\uFF1A</label>
                        <input id="textcolorshow" data-tips="${e.textColor}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#9c0006" style="display: none;">
                    </div>
                    <div class="colorbox">
                        <input id="checkCellColor" type="checkbox" checked="checked">
                        <label for="checkCellColor">${e.cellColor}\uFF1A</label>
                        <input id="cellcolorshow" data-tips="${e.cellColor}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#ffc7ce" style="display: none;">
                    </div>
                </div>`},selectRange:[],selectStatus:!1,dataBarList:[{format:["#638ec6","#ffffff"]},{format:["#63c384","#ffffff"]},{format:["#ff555a","#ffffff"]},{format:["#ffb628","#ffffff"]},{format:["#008aef","#ffffff"]},{format:["#d6007b","#ffffff"]},{format:["#638ec6"]},{format:["#63c384"]},{format:["#ff555a"]},{format:["#ffb628"]},{format:["#008aef"]},{format:["#d6007b"]}],colorGradationList:[{format:["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(255, 235, 132)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(90, 138, 198)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(90, 138, 198)"]},{format:["rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)"]},{format:["rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(255, 235, 132)"]},{format:["rgb(255, 235, 132)","rgb(99, 190, 123)"]}],init:function(){let e=this,n=Oe().conditionformat;$(document).off("change.CFchooseSheet").on("change.CFchooseSheet","#luckysheet-administerRule-dialog .chooseSheet",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();e.getConditionRuleList(t)}),$(document).off("click.CFadministerRuleItem").on("click.CFadministerRuleItem","#luckysheet-administerRule-dialog .ruleList .listBox .item",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.CFadministerRuleConfirm").on("click.CFadministerRuleConfirm","#luckysheet-administerRule-dialog-confirm",function(){if(!ao(h.currentSheetIndex))return;let t=$.extend(!0,[],h.luckysheetfile),l=e.getHistoryRules(t),o=$.extend(!0,[],e.fileClone);for(let u=0;u<o.length;u++){let f=o[u].index;h.luckysheetfile[$e(f)].luckysheet_conditionformat_save=o[$e(f)].luckysheet_conditionformat_save}let a=$.extend(!0,[],h.luckysheetfile),s=e.getCurrentRules(a);if(e.ref(l,s),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-administerRule-dialog").hide(),He.allowUpdate){let u=$.extend(!0,[],h.luckysheetfile);for(let f=0;f<u.length;f++)He.saveParam("all",u[f].index,u[f].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}}),$(document).off("click.CFadministerRuleClose").on("click.CFadministerRuleClose","#luckysheet-administerRule-dialog-close",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-administerRule-dialog").hide(),e.fileClone=[]}),$(document).off("click.CFadministerRuleFa").on("click.CFadministerRuleFa","#luckysheet-administerRule-dialog .item .fa-table",function(){$(this).parents("#luckysheet-administerRule-dialog").hide();let t=$("#luckysheet-administerRule-dialog .chooseSheet select option:selected").val();t!=h.currentSheetIndex&&ct.changeSheetExec(t);let l=$(this).siblings("input").val().trim(),o=$(this).parents(".item").attr("data-item");e.multiRangeDialog(o,l),e.selectRange=[];let a=e.getRangeByTxt(l);if(a.length>0)for(let s=0;s<a.length;s++){let u=a[s].row[0],f=a[s].row[1],m=a[s].column[0],d=a[s].column[1],g=h.visibledatarow[f],b=u-1==-1?0:h.visibledatarow[u-1],y=h.visibledatacolumn[d],p=m-1==-1?0:h.visibledatacolumn[m-1];e.selectRange.push({left:p,width:y-p-1,top:b,height:g-b-1,left_move:p,width_move:y-p-1,top_move:b,height_move:g-b-1,row:[u,f],column:[m,d],row_focus:u,column_focus:m})}Jl(e.selectRange)}),$(document).off("click.CFmultiRangeConfirm").on("click.CFmultiRangeConfirm","#luckysheet-multiRange-dialog-confirm",function(){$(this).parents("#luckysheet-multiRange-dialog").hide();let t=$(this).attr("data-item"),l=$(this).parents("#luckysheet-multiRange-dialog").find("input").val();$("#luckysheet-administerRule-dialog .item[data-item="+t+"] input").val(l);let o=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();e.fileClone[$e(o)].luckysheet_conditionformat_save[t].cellrange=e.getRangeByTxt(l),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),Jl([])}),$(document).off("click.CFmultiRangeClose").on("click.CFmultiRangeClose","#luckysheet-multiRange-dialog-close",function(){$(this).parents("#luckysheet-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),Jl([])}),$(document).off("click.CFnewConditionRule").on("click.CFnewConditionRule","#newConditionRule",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(!!ao(t)){if(h.luckysheet_select_save.length==0){Qe()?alert(n.pleaseSelectRange):de.info(n.pleaseSelectRange,"");return}e.newConditionRuleDialog(1)}}),$(document).off("click.CFnewConditionRuleConfirm").on("click.CFnewConditionRuleConfirm","#luckysheet-newConditionRule-dialog-confirm",function(){if(!ao(h.currentSheetIndex))return;let t=$("#luckysheet-newConditionRule-dialog .ruleTypeItem.on").index(),l=$("#luckysheet-newConditionRule-dialog #type1 option:selected").val(),o=$("#luckysheet-newConditionRule-dialog ."+l+"Box #type2 option:selected").val(),a,s;if(t==0){if(l=="dataBar"){let f=$(this).parents("#luckysheet-newConditionRule-dialog").find(".dataBarBox .luckysheet-conditionformat-config-color").spectrum("get").toHexString();o=="gradient"?a=[f,"#ffffff"]:o=="solid"&&(a=[f]),s={type:"dataBar",cellrange:$.extend(!0,[],h.luckysheet_select_save),format:a}}else if(l=="colorGradation"){let f=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),m=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),d=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString();o=="threeColor"?a=[f,m,d]:o=="twoColor"&&(a=[f,d]),s={type:"colorGradation",cellrange:$.extend(!0,[],h.luckysheet_select_save),format:a}}else if(l=="icons"){let f=$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-len"),m=$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),d=$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-top");a={len:f,leftMin:m,top:d},s={type:"icons",cellrange:$.extend(!0,[],h.luckysheet_select_save),format:a}}}else{let f="",m=[],d=[];if(t==1){if(l=="number")if(f=o,o=="betweenness"){let y=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),p=$("#luckysheet-newConditionRule-dialog #conditionVal2 input").val().trim(),x=e.getRangeByTxt(y);if(x.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(x.length==1){let S=x[0].row[0],I=x[0].row[1],O=x[0].column[0],F=x[0].column[1];if(S==I&&O==F)y=Mt(S,O,h.flowdata),m.push({row:x[0].row,column:x[0].column}),d.push(y);else{e.infoDialog(n.onlySingleCell,"");return}}else if(x.length==0)if(isNaN(y)||y==""){e.infoDialog(n.conditionValueCanOnly,"");return}else d.push(y);let _=e.getRangeByTxt(p);if(_.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(_.length==1){let S=_[0].row[0],I=_[0].row[1],O=_[0].column[0],F=_[0].column[1];if(S==I&&O==F)p=Mt(S,O,h.flowdata),m.push({row:_[0].row,column:_[0].column}),d.push(p);else{e.infoDialog(n.onlySingleCell,"");return}}else if(_.length==0)if(isNaN(p)||p==""){e.infoDialog(n.conditionValueCanOnly,"");return}else d.push(p)}else{let y=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),p=e.getRangeByTxt(y);if(p.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(p.length==1){let x=p[0].row[0],_=p[0].row[1],S=p[0].column[0],I=p[0].column[1];if(x==_&&S==I)y=Mt(x,S,h.flowdata),m.push({row:p[0].row,column:p[0].column}),d.push(y);else{e.infoDialog(n.onlySingleCell,"");return}}else if(p.length==0)if(isNaN(y)||y==""){e.infoDialog(n.conditionValueCanOnly,"");return}else d.push(y)}else if(l=="text"){f="textContains";let y=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),p=e.getRangeByTxt(y);if(p.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(p.length==1){let x=p[0].row[0],_=p[0].row[1],S=p[0].column[0],I=p[0].column[1];if(x==_&&S==I)y=Mt(x,S,h.flowdata),m.push({row:p[0].row,column:p[0].column}),d.push(y);else{e.infoDialog(n.onlySingleCell,"");return}}else if(p.length==0)if(y==""){e.infoDialog(n.conditionValueCanOnly,"");return}else d.push(y)}else if(l=="date"){f="occurrenceDate";let y=$("#luckysheet-newConditionRule-dialog #daterange-btn").val();if(y==""||y==null){e.infoDialog(n.pleaseSelectADate,"");return}d.push(y)}}else if(t==2){l=="top"?$("#luckysheet-newConditionRule-dialog #isPercent").is(":selected")?f="top10%":f="top10":l=="last"&&($("#luckysheet-newConditionRule-dialog #isPercent").is(":selected")?f="last10%":f="last10");let y=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim();if(parseInt(y)!=y||parseInt(y)<1||parseInt(y)>1e3){e.infoDialog(n.pleaseEnterInteger,"");return}d.push(parseInt(y))}else if(t==3)l=="AboveAverage"?(f="AboveAverage",d.push("AboveAverage")):l=="SubAverage"&&(f="SubAverage",d.push("SubAverage"));else if(t==4)f="duplicateValue",d.push(l);else if(t==5){f="formula";let y=$("#luckysheet-newConditionRule-dialog #formulaConditionVal input").val().trim();if(y==""){e.infoDialog("Condition value cannot be empty!","");return}d.push(y)}let g;$("#luckysheet-newConditionRule-dialog #checkTextColor").is(":checked")?g=$("#luckysheet-newConditionRule-dialog #textcolorshow").spectrum("get").toHexString():g=null;let b;$("#luckysheet-newConditionRule-dialog #checkCellColor").is(":checked")?b=$("#luckysheet-newConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():b=null,a={textColor:g,cellColor:b},s={type:"default",cellrange:$.extend(!0,[],h.luckysheet_select_save),format:a,conditionName:f,conditionRange:m,conditionValue:d}}$("#luckysheet-newConditionRule-dialog").hide();let u=$(this).attr("data-source");if(u==0){$("#luckysheet-modal-dialog-mask").hide();let f=$.extend(!0,[],h.luckysheetfile),m=e.getHistoryRules(f),d=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save==null?[]:h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save;d.push(s),h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save=d;let g=$.extend(!0,[],h.luckysheetfile),b=e.getCurrentRules(g);e.ref(m,b),He.allowUpdate&&He.saveParam("all",h.currentSheetIndex,d,{k:"luckysheet_conditionformat_save"})}else if(u==1){let f=e.fileClone[$e(h.currentSheetIndex)].luckysheet_conditionformat_save?e.fileClone[$e(h.currentSheetIndex)].luckysheet_conditionformat_save:[];f.push(s),e.fileClone[$e(h.currentSheetIndex)].luckysheet_conditionformat_save=f,e.administerRuleDialog()}}),$(document).off("click.CFnewConditionRuleClose").on("click.CFnewConditionRuleClose","#luckysheet-newConditionRule-dialog-close",function(){let t=$(this).attr("data-source");t==0&&$("#luckysheet-modal-dialog-mask").hide(),t==1&&$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-newConditionRule-dialog").hide(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()}),$(document).off("click.CFeditorConditionRule").on("click.CFeditorConditionRule","#editorConditionRule",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(!ao(t))return;let l=$("#luckysheet-administerRule-dialog .ruleList .listBox .item.on").attr("data-item"),o={sheetIndex:t,itemIndex:l,data:e.fileClone[$e(t)].luckysheet_conditionformat_save[l]};e.editorRule=o,e.editorConditionRuleDialog()}),$(document).off("click.CFeditorConditionRuleConfirm").on("click.CFeditorConditionRuleConfirm","#luckysheet-editorConditionRule-dialog-confirm",function(){let t=$("#luckysheet-editorConditionRule-dialog .ruleTypeItem.on").index(),l=$("#luckysheet-editorConditionRule-dialog #type1 option:selected").val(),o=$("#luckysheet-editorConditionRule-dialog ."+l+"Box #type2 option:selected").val(),a=e.editorRule.data.cellrange,s,u;if(t==0){if(l=="dataBar"){let d=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".dataBarBox .luckysheet-conditionformat-config-color").spectrum("get").toHexString();o=="gradient"?s=[d,"#ffffff"]:o=="solid"&&(s=[d]),u={type:"dataBar",cellrange:a,format:s}}else if(l=="colorGradation"){let d=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),g=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),b=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString();o=="threeColor"?s=[d,g,b]:o=="twoColor"&&(s=[d,b]),u={type:"colorGradation",cellrange:a,format:s}}else if(l=="icons"){let d=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-len"),g=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),b=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-top");s={len:d,leftMin:g,top:b},u={type:"icons",cellrange:a,format:s}}}else{let d="",g=[],b=[];if(t==1){if(l=="number")if(d=o,o=="betweenness"){let x=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),_=$("#luckysheet-editorConditionRule-dialog #conditionVal2 input").val().trim(),S=e.getRangeByTxt(x);if(S.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(S.length==1){let O=S[0].row[0],F=S[0].row[1],D=S[0].column[0],k=S[0].column[1];if(O==F&&D==k)x=Mt(O,D,h.flowdata),g.push({row:S[0].row,column:S[0].column}),b.push(x);else{e.infoDialog(n.onlySingleCell,"");return}}else if(S.length==0)if(isNaN(x)||x==""){e.infoDialog(n.conditionValueCanOnly,"");return}else b.push(x);let I=e.getRangeByTxt(_);if(I.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(I.length==1){let O=I[0].row[0],F=I[0].row[1],D=I[0].column[0],k=I[0].column[1];if(O==F&&D==k)_=Mt(O,D,h.flowdata),g.push({row:I[0].row,column:I[0].column}),b.push(_);else{e.infoDialog(n.onlySingleCell,"");return}}else if(I.length==0)if(isNaN(_)||_==""){e.infoDialog(n.conditionValueCanOnly,"");return}else b.push(_)}else{let x=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),_=e.getRangeByTxt(x);if(_.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(_.length==1){let S=_[0].row[0],I=_[0].row[1],O=_[0].column[0],F=_[0].column[1];if(S==I&&O==F)x=Mt(S,O,h.flowdata),g.push({row:_[0].row,column:_[0].column}),b.push(x);else{e.infoDialog(n.onlySingleCell,"");return}}else if(_.length==0)if(isNaN(x)||x==""){e.infoDialog(n.conditionValueCanOnly,"");return}else b.push(x)}else if(l=="text"){d="textContains";let x=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),_=e.getRangeByTxt(x);if(_.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(_.length==1){let S=_[0].row[0],I=_[0].row[1],O=_[0].column[0],F=_[0].column[1];if(S==I&&O==F)x=Mt(S,O,h.flowdata),g.push({row:_[0].row,column:_[0].column}),b.push(x);else{e.infoDialog(n.onlySingleCell,"");return}}else if(_.length==0)if(isNaN(x)||x==""){e.infoDialog(n.conditionValueCanOnly,"");return}else b.push(x)}else if(l=="date"){d="occurrenceDate";let x=$("#luckysheet-editorConditionRule-dialog #daterange-btn").val();if(x==""||x==null){e.infoDialog(n.pleaseSelectADate,"");return}b.push(x)}}else if(t==2){l=="top"?$("#luckysheet-editorConditionRule-dialog #isPercent").is(":selected")?d="top10%":d="top10":l=="last"&&($("#luckysheet-editorConditionRule-dialog #isPercent").is(":selected")?d="last10%":d="last10");let x=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim();if(parseInt(x)!=x||parseInt(x)<1||parseInt(x)>1e3){e.infoDialog(n.pleaseEnterInteger,"");return}b.push(x)}else if(t==3)l=="AboveAverage"?(d="AboveAverage",b.push("AboveAverage")):l=="SubAverage"&&(d="SubAverage",b.push("SubAverage"));else if(t==4)d="duplicateValue",b.push(l);else if(t==5){d="formula";let x=$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val().trim();if(console.log(x),x==""){e.infoDialog("Condition value cannot be empty!","");return}b.push(x)}let y;$("#luckysheet-editorConditionRule-dialog #checkTextColor").is(":checked")?y=$("#luckysheet-editorConditionRule-dialog #textcolorshow").spectrum("get").toHexString():y=null;let p;$("#luckysheet-editorConditionRule-dialog #checkCellColor").is(":checked")?p=$("#luckysheet-editorConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():p=null,s={textColor:y,cellColor:p},u={type:"default",cellrange:a,format:s,conditionName:d,conditionRange:g,conditionValue:b}}let f=e.editorRule.sheetIndex,m=e.editorRule.itemIndex;e.fileClone[$e(f)].luckysheet_conditionformat_save[m]=u,$("#luckysheet-editorConditionRule-dialog").hide(),e.administerRuleDialog()}),$(document).off("click.CFeditorConditionRuleClose").on("click.CFeditorConditionRuleClose","#luckysheet-editorConditionRule-dialog-close",function(){$("#luckysheet-editorConditionRule-dialog").hide(),$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()}),$(document).off("click.CFnewEditorRuleItem").on("click.CFnewEditorRuleItem",".luckysheet-newEditorRule-dialog .ruleTypeItem",function(){$(this).addClass("on").siblings().removeClass("on");let t=$(this).index();$(this).parents(".luckysheet-newEditorRule-dialog").find(".ruleExplainBox").html(e.getRuleExplain(t)),e.colorSelectInit()}),$(document).off("change.CFnewEditorRuleType1").on("change.CFnewEditorRuleType1",".luckysheet-newEditorRule-dialog #type1",function(){let t=$(this).find("option:selected").val();(t=="dataBar"||t=="colorGradation"||t=="icons"||t=="number"||t=="text"||t=="date")&&$(this).parents(".luckysheet-newEditorRule-dialog").find("."+t+"Box").show().siblings().hide(),t=="date"&&e.daterangeInit($(this).parents(".luckysheet-newEditorRule-dialog").attr("id"))}),$(document).off("change.CFnewEditorRuleType2").on("change.CFnewEditorRuleType2",".luckysheet-newEditorRule-dialog #type2",function(){let t=$(this).parents(".luckysheet-newEditorRule-dialog").find("#type1 option:selected").val();t=="colorGradation"?$(this).find("option:selected").val()=="threeColor"?$(this).parents(".luckysheet-newEditorRule-dialog").find(".midVal").show():$(this).parents(".luckysheet-newEditorRule-dialog").find(".midVal").hide():t=="number"&&($(this).find("option:selected").val()=="betweenness"?($(this).parents(".luckysheet-newEditorRule-dialog").find(".txt").show(),$(this).parents(".luckysheet-newEditorRule-dialog").find("#conditionVal2").show()):($(this).parents(".luckysheet-newEditorRule-dialog").find(".txt").hide(),$(this).parents(".luckysheet-newEditorRule-dialog").find("#conditionVal2").hide()))}),$(document).off("click.CFiconsShowbox").on("click.CFiconsShowbox",".luckysheet-newEditorRule-dialog .iconsBox .showbox",function(){$(this).parents(".iconsBox").find("ul").toggle()}),$(document).off("click.CFiconsLi").on("click.CFiconsLi",".luckysheet-newEditorRule-dialog .iconsBox li",function(){let t=$(this).find("div").attr("data-len"),l=$(this).find("div").attr("data-leftmin"),o=$(this).find("div").attr("data-top"),a=$(this).find("div").attr("title"),s=$(this).find("div").css("background-position");$(this).parents(".iconsBox").find(".showbox .model").css("background-position",s),$(this).parents(".iconsBox").find(".showbox .model").attr("data-len",t),$(this).parents(".iconsBox").find(".showbox .model").attr("data-leftmin",l),$(this).parents(".iconsBox").find(".showbox .model").attr("data-top",o),$(this).parents(".iconsBox").find(".showbox .model").attr("title",a),$(this).parents("ul").hide()}),$(document).off("click.CFdeleteConditionRule").on("click.CFdeleteConditionRule","#deleteConditionRule",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(!ao(t))return;let l=$("#luckysheet-administerRule-dialog .ruleList .listBox .item.on").attr("data-item");e.fileClone[$e(t)].luckysheet_conditionformat_save.splice(l,1),e.administerRuleDialog()}),$(document).off("click.CFdefault").on("click.CFdefault","#luckysheet-conditionformat-dialog-confirm",function(){if(!ao(h.currentSheetIndex))return;let t=$("#luckysheet-conditionformat-dialog .box").attr("data-itemvalue"),l=[],o=[];if(t=="greaterThan"||t=="lessThan"||t=="equal"||t=="textContains"){let y=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim(),p=e.getRangeByTxt(y);if(p.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(p.length==1){let x=p[0].row[0],_=p[0].row[1],S=p[0].column[0],I=p[0].column[1];if(x==_&&S==I)y=Mt(x,S,h.flowdata),l.push({row:p[0].row,column:p[0].column}),o.push(y);else{e.infoDialog(n.onlySingleCell,"");return}}else if(p.length==0)if(isNaN(y)||y==""){e.infoDialog(n.conditionValueCanOnly,"");return}else o.push(y)}else if(t=="betweenness"){let y=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim(),p=$("#luckysheet-conditionformat-dialog #conditionVal2").val().trim(),x=e.getRangeByTxt(y);if(x.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(x.length==1){let S=x[0].row[0],I=x[0].row[1],O=x[0].column[0],F=x[0].column[1];if(S==I&&O==F)y=Mt(S,O,h.flowdata),l.push({row:x[0].row,column:x[0].column}),o.push(y);else{e.infoDialog(n.onlySingleCell,"");return}}else if(x.length==0)if(isNaN(y)||y==""){e.infoDialog(n.conditionValueCanOnly,"");return}else o.push(y);let _=e.getRangeByTxt(p);if(_.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(_.length==1){let S=_[0].row[0],I=_[0].row[1],O=_[0].column[0],F=_[0].column[1];if(S==I&&O==F)p=Mt(S,O,h.flowdata),l.push({row:_[0].row,column:_[0].column}),o.push(p);else{e.infoDialog(n.onlySingleCell,"");return}}else if(_.length==0)if(isNaN(p)||p==""){e.infoDialog(n.conditionValueCanOnly,"");return}else o.push(p)}else if(t=="occurrenceDate"){let y=$("#luckysheet-conditionformat-dialog #daterange-btn").val();if(y==""||y==null){e.infoDialog(n.pleaseSelectADate,"");return}o.push(y)}else if(t=="duplicateValue")o.push($("#luckysheet-conditionformat-dialog #conditionVal option:selected").val());else if(t=="top10"||t=="top10%"||t=="last10"||t=="last10%"){let y=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim();if(parseInt(y)!=y||parseInt(y)<1||parseInt(y)>1e3){e.infoDialog(n.pleaseEnterInteger,"");return}o.push(y)}else t=="AboveAverage"?o.push("AboveAverage"):t=="SubAverage"&&o.push("SubAverage");let a;$("#checkTextColor").is(":checked")?a=$("#textcolorshow").spectrum("get").toHexString():a=null;let s;$("#checkCellColor").is(":checked")?s=$("#cellcolorshow").spectrum("get").toHexString():s=null;let u=$.extend(!0,[],h.luckysheetfile),f=e.getHistoryRules(u),m={type:"default",cellrange:$.extend(!0,[],h.luckysheet_select_save),format:{textColor:a,cellColor:s},conditionName:t,conditionRange:l,conditionValue:o},d=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save==null?[]:h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save;d.push(m),h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save=d;let g=$.extend(!0,[],h.luckysheetfile),b=e.getCurrentRules(g);e.ref(f,b),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-conditionformat-dialog").hide(),He.allowUpdate&&He.saveParam("all",h.currentSheetIndex,d,{k:"luckysheet_conditionformat_save"})}),$(document).off("click.CFicons").on("click.CFicons","#luckysheet-CFicons-dialog .item",function(){if($("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-CFicons-dialog").hide(),h.luckysheet_select_save.length>0){let t=$.extend(!0,[],h.luckysheet_select_save),l={len:$(this).attr("data-len"),leftMin:$(this).attr("data-leftMin"),top:$(this).attr("data-top")};e.updateItem("icons",t,l)}}),$(document).on("click",".range .fa-table",function(){let t=$(this).parents(".luckysheet-modal-dialog").attr("id");$("#"+t).hide();let l;if(t=="luckysheet-conditionformat-dialog")$(this).siblings("input").attr("id")=="conditionVal"?l="0_1":l="0_2";else if(t=="luckysheet-newConditionRule-dialog"){let a=$(this).parents(".range").attr("id");a=="formulaConditionVal"?l="1_0":a=="conditionVal"?l="1_1":l="1_2"}else if(t=="luckysheet-editorConditionRule-dialog"){let a=$(this).parents(".range").attr("id");a=="formulaConditionVal"?l="2_0":a=="conditionVal"?l="2_1":l="2_2"}let o=$(this).siblings("input").val();e.singleRangeDialog(l,o),Jl(e.getRangeByTxt(o))}),$(document).on("click","#luckysheet-singleRange-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").show(),$(this).parents("#luckysheet-singleRange-dialog").hide();let t=$(this).attr("data-source"),l=$(this).parents("#luckysheet-singleRange-dialog").find("input").val();t=="0_1"?($("#luckysheet-conditionformat-dialog").show(),$("#luckysheet-conditionformat-dialog #conditionVal").val(l)):t=="0_2"?($("#luckysheet-conditionformat-dialog").show(),$("#luckysheet-conditionformat-dialog #conditionVal2").val(l)):t=="1_0"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #formulaConditionVal input").val(l)):t=="1_1"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #conditionVal input").val(l)):t=="1_2"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #conditionVal2 input").val(l)):t=="2_0"?($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val(l)):t=="2_1"?($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #conditionVal input").val(l)):t=="2_2"&&($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #conditionVal2 input").val(l)),Jl([])}),$(document).on("click","#luckysheet-singleRange-dialog-close",function(){$("#luckysheet-modal-dialog-mask").show(),$(this).parents("#luckysheet-singleRange-dialog").hide();let t=$(this).attr("data-source");t=="0_1"||t=="0_2"?$("#luckysheet-conditionformat-dialog").show():t=="1_0"||t=="1_1"||t=="1_2"?$("#luckysheet-newConditionRule-dialog").show():(t=="2_0"||t=="2_1"||t=="2_2")&&$("#luckysheet-editorConditionRule-dialog").show(),Jl([])}),$(document).on("click",".luckysheet-modal-dialog-title-close",function(){let t=$(this).parents(".luckysheet-modal-dialog").attr("id");if(t=="luckysheet-newConditionRule-dialog"&&$("#"+t).find("#luckysheet-newConditionRule-dialog-close").attr("data-source")==1&&$("#luckysheet-administerRule-dialog").show(),t=="luckysheet-editorConditionRule-dialog"&&$("#luckysheet-administerRule-dialog").show(),t=="luckysheet-singleRange-dialog"){$("#luckysheet-modal-dialog-mask").show();let l=$(this).parents("#luckysheet-singleRange-dialog").find("#luckysheet-singleRange-dialog-confirm").attr("data-source");l=="0_1"||l=="0_2"?$("#luckysheet-conditionformat-dialog").show():l=="1_1"||l=="1_2"?$("#luckysheet-newConditionRule-dialog").show():(l=="2_1"||l=="2_2")&&$("#luckysheet-editorConditionRule-dialog").show(),Jl([])}t=="luckysheet-multiRange-dialog"&&($("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),Jl([])),t=="luckysheet-conditionformat-info-dialog"&&$("#luckysheet-modal-dialog-mask").show()}),$(document).on("click","#luckysheet-conditionformat-info-dialog-close",function(){$(this).parents("#luckysheet-conditionformat-info-dialog").hide()})},singleRangeDialog:function(e,n){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-singleRange-dialog").remove();let t=Oe().conditionformat;$("body").first().append(yt(kl,{id:"luckysheet-singleRange-dialog",addclass:"luckysheet-singleRange-dialog",title:t.selectCell,content:`<input readonly="readonly" placeholder="${t.pleaseSelectCell}" value="${n}"/>`,botton:`<button id="luckysheet-singleRange-dialog-confirm" class="btn btn-primary" data-source="${e}">${t.confirm}</button>
                        <button id="luckysheet-singleRange-dialog-close" class="btn btn-default" data-source="${e}">${t.cancel}</button>`,style:"z-index:100003"}));let l=$("#luckysheet-singleRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),f=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-singleRange-dialog").css({left:(s+f-a)/2,top:(u+m-o)/3}).show()},multiRangeDialog:function(e,n){let t=this;$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-multiRange-dialog").remove();let l=Oe().conditionformat;$("body").first().append(yt(kl,{id:"luckysheet-multiRange-dialog",addclass:"luckysheet-multiRange-dialog",title:l.selectRange,content:`<input readonly="readonly" placeholder="${l.pleaseSelectRange}" value="${n}"/>`,botton:`<button id="luckysheet-multiRange-dialog-confirm" class="btn btn-primary" data-item="${e}">${l.confirm}</button>
                        <button id="luckysheet-multiRange-dialog-close" class="btn btn-default">${l.cancel}</button>`,style:"z-index:100003"}));let o=$("#luckysheet-multiRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-multiRange-dialog").css({left:(u+m-s)/2,top:(f+d-a)/3}).show(),Jl(t.getRangeByTxt(n))},getTxtByRange:function(e){if(e.length>0){let n=[];for(let t=0;t<e.length;t++){let l=e[t].row[0],o=e[t].row[1],a=e[t].column[0],s=e[t].column[1];n.push(Al(h.currentSheetIndex,{row:[l,o],column:[a,s]},h.currentSheetIndex))}return n.join(",")}},getRangeByTxt:function(e){let n=[];if(e=e.toString(),e.indexOf(",")!=-1){let t=e.split(",");for(let l=0;l<t.length;l++)if(v.iscelldata(t[l]))n.push(v.getcellrange(t[l]));else{n=[];break}}else v.iscelldata(e)&&n.push(v.getcellrange(e));return n},colorSelectInit:function(){let e=Oe().conditionformat;$(".luckysheet-conditionformat-config-color").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:e.cancel,chooseText:e.confirmColor,togglePaletteMoreText:"\u81EA\u5B9A\u4E49",togglePaletteLessText:"\u6536\u8D77",togglePaletteOnly:!0,clearText:e.clearColorSelect,noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",localStorageKey:"spectrum.textcolor"+He.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(n){n!=null&&(n=n.toHexString())}})},conditionformatDialog:function(e,n){let t=this;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-conditionformat-dialog").remove();let l=Oe().conditionformat;$("body").first().append(yt(kl,{id:"luckysheet-conditionformat-dialog",addclass:"luckysheet-conditionformat-dialog",title:e,content:n,botton:`<button id="luckysheet-conditionformat-dialog-confirm" class="btn btn-primary">${l.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:9999"}));let o=$("#luckysheet-conditionformat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-conditionformat-dialog").css({left:(u+m-s)/2,top:(f+d-a)/3}).show(),t.init(),t.colorSelectInit(),e==Oe().conditionformat.conditionformat_occurrenceDate&&t.daterangeInit("luckysheet-conditionformat-dialog")},CFiconsDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-CFicons-dialog").remove();let e=Oe().conditionformat,n=`<div class="box">
                            <div style="margin-bottom: 10px;">${e.pleaseSelectIcon}</div>
                            <div class="title">${e.direction}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="0" title="${e.threeWayArrow}(${e.multicolor})"><div style="background-position:0 0;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="1" title="${e.threeTriangles}"><div style="background-position:0 -20px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="0" data-top="2" title="${e.fourWayArrow}(${e.multicolor})"><div style="background-position:0 -40px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="3" title="${e.fiveWayArrow}(${e.multicolor})"><div style="background-position:0 -60px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="0" title="${e.threeWayArrow}(${e.grayColor})"><div style="background-position:-131px 0;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="5" data-top="1" title="${e.fourWayArrow}(${e.grayColor})"><div style="background-position:-131px -20px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="5" data-top="2" title="${e.fiveWayArrow}(${e.grayColor})"><div style="background-position:-131px -40px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">${e.shape}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="4" title="${e.threeColorTrafficLight}(${e.rimless})"><div style="background-position:0 -80px;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="5" title="${e.threeSigns}"><div style="background-position:0 -100px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="0" data-top="6" title="${e.greenRedBlackGradient}"><div style="background-position:0 -120px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="4" title="${e.threeColorTrafficLight}(${e.bordered})"><div style="background-position:-131px -80px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="5" data-top="5" title="${e.fourColorTrafficLight}"><div style="background-position:-131px -100px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">${e.mark}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="7" title="${e.threeSymbols}(${e.circled})"><div style="background-position:0 -140px;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="8" title="${e.tricolorFlag}"><div style="background-position:0 -160px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="7" title="${e.threeSymbols}(${e.noCircle})"><div style="background-position:-131px -140px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">${e.grade}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="9" title="${e.threeStars}"><div style="background-position:0 -180px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="10" title="${e.fiveQuadrantDiagram}"><div style="background-position:0 -200px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="11" title="${e.fiveBoxes}"><div style="background-position:0 -220px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="4" data-leftMin="5" data-top="9" title="${e.grade4}"><div style="background-position:-131px -180px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="5" data-top="10" title="${e.grade5}"><div style="background-position:-131px -200px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                        </div>`;$("body").first().append(yt(kl,{id:"luckysheet-CFicons-dialog",addclass:"luckysheet-CFicons-dialog",title:e.icons,content:n,botton:`<button class="btn btn-default luckysheet-model-close-btn">${e.close}</button>`,style:"z-index:100003"}));let t=$("#luckysheet-CFicons-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),l=t.outerHeight(),o=t.outerWidth(),a=$(window).width(),s=$(window).height(),u=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-CFicons-dialog").css({left:(a+u-o)/2,top:(s+f-l)/3}).show()},administerRuleDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").remove();let e=Oe().conditionformat,n="";for(let g=0;g<h.luckysheetfile.length;g++)h.luckysheetfile[g].status=="1"?n+=`<option value="${h.luckysheetfile[g].index}" selected="selected">
                                ${e.currentSheet}\uFF1A${h.luckysheetfile[g].name}
                            </option>`:n+=`<option value="${h.luckysheetfile[g].index}">
                                ${e.sheet}\uFF1A${h.luckysheetfile[g].name}
                            </option>`;let t=`<div class="chooseSheet">
                            <label>${e.showRules}\uFF1A</label>
                            <select>${n}</select>
                        </div>
                        <div class="ruleBox">
                            <div class="ruleBtn">
                                <button id="newConditionRule" class="btn btn-default">${e.newRule}</button>
                                <button id="editorConditionRule" class="btn btn-default">${e.editRule}</button>
                                <button id="deleteConditionRule" class="btn btn-default">${e.deleteRule}</button>
                            </div>
                            <div class="ruleList">
                                <div class="listTitle">
                                    <span>${e.rule}</span>
                                    <span>${e.format}</span>
                                    <span>${e.applyRange}</span>
                                </div>
                                <div class="listBox"></div>
                            </div>
                        </div>`;$("body").first().append(yt(kl,{id:"luckysheet-administerRule-dialog",addclass:"luckysheet-administerRule-dialog",title:e.conditionformatManageRules,content:t,botton:`<button id="luckysheet-administerRule-dialog-confirm" class="btn btn-primary">${e.confirm}</button>
                        <button id="luckysheet-administerRule-dialog-close" class="btn btn-default">${e.close}</button>`,style:"z-index:100003"}));let l=$("#luckysheet-administerRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),f=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-administerRule-dialog").css({left:(s+f-a)/2,top:(u+m-o)/3}).show();let d=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();this.getConditionRuleList(d)},getConditionRuleList:function(e){let n=this;$("#luckysheet-administerRule-dialog .ruleList .listBox").empty();let t=n.fileClone[$e(e)].luckysheet_conditionformat_save;if(t!=null&&t.length>0){let l=Oe().conditionformat;for(let o=0;o<t.length;o++){let a=t[o].type,s=t[o].format,u=t[o].cellrange,f,m="";a=="dataBar"?(f=l.dataBar,m='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):a=="colorGradation"?(f=l.colorGradation,m='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):a=="icons"?(f=l.icons,m='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):(f=n.getConditionRuleName(t[o].conditionName,t[o].conditionRange,t[o].conditionValue),s.textColor!=null&&(m+='<span class="colorbox" title="'+l.textColor+'" style="background-color:'+s.textColor+'"></span>'),s.cellColor!=null&&(m+='<span class="colorbox" title="'+l.cellColor+'" style="background-color:'+s.cellColor+'"></span>'));let d=[];for(let b=0;b<u.length;b++){let y=u[b].row[0],p=u[b].row[1],x=u[b].column[0],_=u[b].column[1];d.push(Qt(x)+(y+1)+":"+Qt(_)+(p+1))}let g='<div class="item" data-item="'+o+'"><div class="ruleName" title="'+f+'">'+f+'</div><div class="format">'+m+'</div><div class="ruleRange"><input class="formulaInputFocus" readonly="true" value="'+d.join(",")+'"/><i class="fa fa-table" aria-hidden="true" title="'+l.selectRange+'"></i></div></div>';$("#luckysheet-administerRule-dialog .ruleList .listBox").prepend(g)}$("#luckysheet-administerRule-dialog .ruleList .listBox .item canvas").each(function(o){let a=$(this).closest(".item").attr("data-item"),s=t[a].type,u=t[a].format,f=$(this).get(0).getContext("2d");if(s=="dataBar")if(u.length==2){let m=f.createLinearGradient(0,0,46,0);m.addColorStop(0,u[0]),m.addColorStop(1,u[1]),f.fillStyle=m,f.fillRect(0,0,46,18),f.beginPath(),f.moveTo(0,0),f.lineTo(0,18),f.lineTo(46,18),f.lineTo(46,0),f.lineTo(0,0),f.lineWidth=h.devicePixelRatio,f.strokeStyle=u[0],f.stroke(),f.closePath()}else u.length==1&&(f.fillStyle=u[0],f.fillRect(0,0,46,18),f.beginPath(),f.moveTo(0,0),f.lineTo(0,18),f.lineTo(46,18),f.lineTo(46,0),f.lineTo(0,0),f.lineWidth=h.devicePixelRatio,f.strokeStyle=u[0],f.stroke(),f.closePath());else if(s=="colorGradation"){let m=f.createLinearGradient(0,0,46,0);u.length==3?(m.addColorStop(0,u[0]),m.addColorStop(.5,u[1]),m.addColorStop(1,u[2])):u.length==2&&(m.addColorStop(0,u[0]),m.addColorStop(1,u[1])),f.fillStyle=m,f.fillRect(0,0,46,18)}else if(s=="icons"){let m=u.len,d=u.leftMin,g=u.top,b=32*m+10*(m-1),y=32,p=46,x=46*32/b;d=="0"?f.drawImage(ac,0,g*32,b,y,0,(18-x)/2,p,x):d=="5"&&f.drawImage(ac,210,g*32,b,y,0,(18-x)/2,p,x)}}),$("#luckysheet-administerRule-dialog .ruleList .listBox .item").eq(0).addClass("on")}},getConditionRuleName:function(e,n,t){let l;n[0]!=null?l=Qt(n[0].column[0])+(n[0].row[0]+1):l=t[0];let o=Oe().conditionformat;if(e=="greaterThan")return o.cellValue+" > "+l;if(e=="lessThan")return o.cellValue+" < "+l;if(e=="betweenness"){let a;return n[1]!=null?a=Qt(n[1].column[0])+(n[1].row[0]+1):a=t[1],o.cellValue+" "+o.between+" "+l+" "+o.in+" "+a+" "+o.between2}else{if(e=="equal")return o.cellValue+" = "+l;if(e=="textContains")return o.cellValue+o.contain+" ="+l;if(e=="occurrenceDate")return t;if(e=="duplicateValue"){if(t=="0")return o.duplicateValue;if(t=="1")return o.uniqueValue}else{if(e=="top10")return o.top+" "+l+" "+o.oneself;if(e=="top10%")return o.top+" "+l+"% "+o.oneself;if(e=="last10")return o.last+" "+l+" "+o.oneself;if(e=="last10%")return o.last+" "+l+"% "+o.oneself;if(e=="AboveAverage")return o.aboveAverage;if(e=="SubAverage")return o.belowAverage;if(e=="formula")return l.slice(0,1)!="="&&(l="="+l),o.formula+": "+l}}},newConditionRuleDialog:function(e){let n=this,t=Oe().conditionformat,l=n.getRuleExplain(0);$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").hide(),$("#luckysheet-newConditionRule-dialog").remove();let o='<div><div class="boxTitle">'+t.chooseRuleType+"\uFF1A</div>"+n.ruleTypeHtml()+'<div class="boxTitle">'+t.editRuleDescription+'\uFF1A</div><div class="ruleExplainBox">'+l+"</div></div>";$("body").first().append(yt(kl,{id:"luckysheet-newConditionRule-dialog",addclass:"luckysheet-newEditorRule-dialog",title:t.newFormatRule,content:o,botton:`<button id="luckysheet-newConditionRule-dialog-confirm" class="btn btn-primary" data-source="${e}">${t.confirm}</button>
                        <button id="luckysheet-newConditionRule-dialog-close" class="btn btn-default" data-source="${e}">${t.cancel}</button>`,style:"z-index:100003"}));let a=$("#luckysheet-newConditionRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),s=a.outerHeight(),u=a.outerWidth(),f=$(window).width(),m=$(window).height(),d=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-newConditionRule-dialog").css({left:(f+d-u)/2,top:(m+g-s)/3}).show(),$("#luckysheet-newConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq(0)").addClass("on").siblings().removeClass("on"),n.colorSelectInit()},editorConditionRuleDialog:function(){let e=this,n=Oe().conditionformat,t=e.editorRule.data;if(t==null)return;let l=t.type,o=t.format,a=t.conditionName,s,u;l=="dataBar"||l=="colorGradation"||l=="icons"?(s=0,u=l):a=="greaterThan"||a=="lessThan"||a=="betweenness"||a=="equal"||a=="textContains"||a=="occurrenceDate"?(s=1,a=="greaterThan"||a=="lessThan"||a=="betweenness"||a=="equal"?u="number":a=="textContains"?u="text":a=="occurrenceDate"&&(u="date")):a=="top10"||a=="top10%"||a=="last10"||a=="last10%"?(s=2,a=="top10"||a=="top10%"?u="top":(a=="last10"||a=="last10%")&&(u="last")):a=="AboveAverage"||a=="SubAverage"?(s=3,u=a):a=="duplicateValue"?(s=4,u=t.conditionValue):a=="formula"&&(s=5);let f=e.getRuleExplain(s);$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").hide(),$("#luckysheet-editorConditionRule-dialog").remove();let m='<div><div class="boxTitle">'+n.chooseRuleType+"\uFF1A</div>"+e.ruleTypeHtml()+'<div class="boxTitle">'+n.editRuleDescription+'\uFF1A</div><div class="ruleExplainBox">'+f+"</div></div>";$("body").first().append(yt(kl,{id:"luckysheet-editorConditionRule-dialog",addclass:"luckysheet-newEditorRule-dialog",title:n.editFormatRule,content:m,botton:`<button id="luckysheet-editorConditionRule-dialog-confirm" class="btn btn-primary">${n.confirm}</button>
                        <button id="luckysheet-editorConditionRule-dialog-close" class="btn btn-default">${n.cancel}</button>`,style:"z-index:100003"}));let d=$("#luckysheet-editorConditionRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),g=d.outerHeight(),b=d.outerWidth(),y=$(window).width(),p=$(window).height(),x=$(document).scrollLeft(),_=$(document).scrollTop();if($("#luckysheet-editorConditionRule-dialog").css({left:(y+x-b)/2,top:(p+_-g)/3}).show(),e.colorSelectInit(),$("#luckysheet-editorConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq("+s+")").addClass("on").siblings().removeClass("on"),$("#luckysheet-editorConditionRule-dialog #type1").val(u),(u=="dataBar"||u=="colorGradation"||u=="icons"||u=="number"||u=="text"||u=="date")&&($("#luckysheet-editorConditionRule-dialog ."+u+"Box").show(),$("#luckysheet-editorConditionRule-dialog ."+u+"Box").siblings().hide()),u=="date"&&e.daterangeInit("luckysheet-editorConditionRule-dialog"),l=="dataBar"||l=="colorGradation"||l=="icons"){if(u=="dataBar")o.length==2?$("#luckysheet-editorConditionRule-dialog .dataBarBox #type2").val("gradient"):o.length==1&&$("#luckysheet-editorConditionRule-dialog .dataBarBox #type2").val("solid"),$("#luckysheet-editorConditionRule-dialog .dataBarBox .luckysheet-conditionformat-config-color").spectrum("set",o[0]);else if(u=="colorGradation")o.length==3?($("#luckysheet-editorConditionRule-dialog .colorGradationBox #type2").val("threeColor"),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal").show(),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("set",o[0]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("set",o[1]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("set",o[2])):o.length==2&&($("#luckysheet-editorConditionRule-dialog .colorGradationBox #type2").val("twoColor"),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal").hide(),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("set",o[0]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("set",o[1]));else if(u=="icons"){let S=o.len,I=o.leftMin,O=o.top;$("#luckysheet-editorConditionRule-dialog .iconsBox li").each(function(F,D){if($(D).find("div").attr("data-len")==S&&$(D).find("div").attr("data-leftmin")==I&&$(D).find("div").attr("data-top")==O)return $("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").css("background-position",$(D).find("div").css("background-position")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-len",$(D).find("div").attr("data-len")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-leftmin",$(D).find("div").attr("data-leftmin")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-top",$(D).find("div").attr("data-leftmin")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("title",$(D).find("div").attr("title")),!0})}}else{if(u=="number"){$("#luckysheet-editorConditionRule-dialog .numberBox #type2").val(a);let S;if(t.conditionRange[0]!=null?S=Al(h.currentSheetIndex,{row:t.conditionRange[0].row,column:t.conditionRange[0].column},h.currentSheetIndex):S=t.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal input").val(S),a=="betweenness"){$("#luckysheet-editorConditionRule-dialog .numberBox .txt").show(),$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2").show();let I;t.conditionRange[1]!=null?I=Al(h.currentSheetIndex,{row:t.conditionRange[1].row,column:t.conditionRange[1].column},h.currentSheetIndex):I=t.conditionValue[1],$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2 input").val(I)}else $("#luckysheet-editorConditionRule-dialog .numberBox .txt").hide(),$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2").hide()}else if(u=="text"){let S;t.conditionRange[0]!=null?S=Al(h.currentSheetIndex,{row:t.conditionRange[0].row,column:t.conditionRange[0].column},h.currentSheetIndex):S=t.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .textBox #conditionVal input").val(S)}else if(u=="date"){e.daterangeInit("luckysheet-editorConditionRule-dialog");let S=t.conditionValue[0];$("#luckysheet-editorConditionRule-dialog .dateBox #daterange-btn").val(S)}else if(u=="top"||u=="last"){let S=t.conditionValue[0];(a=="top10%"||a=="last10%")&&$("#luckysheet-editorConditionRule-dialog #isPercent").attr("checked","checked")}else if(a=="formula"){let S=t.conditionValue[0];$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val(S)}$("#luckysheet-editorConditionRule-dialog #textcolorshow").spectrum("set",o.textColor),$("#luckysheet-editorConditionRule-dialog #cellcolorshow").spectrum("set",o.cellColor)}},infoDialog:function(e,n){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-conditionformat-info-dialog").remove(),$("body").first().append(yt(kl,{id:"luckysheet-conditionformat-info-dialog",addclass:"",title:e,content:n,botton:`<button id="luckysheet-conditionformat-info-dialog-close" class="btn btn-default">${Oe().conditionformat.close}</button>`,style:"z-index:100003"}));let t=$("#luckysheet-conditionformat-info-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=t.outerHeight(),o=t.outerWidth(),a=$(window).width(),s=$(window).height(),u=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-conditionformat-info-dialog").css({left:(a+u-o)/2,top:(s+f-l)/3}).show()},getRuleExplain:function(e){let n=Oe().conditionformat,t=this.textCellColorHtml(),l;switch(e){case 0:l=`<div class="title">${n.ruleTypeItem1}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 5px;">
                                        <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.formatStyle}\uFF1A</label>
                                        <select id="type1">
                                            <option value="dataBar">${n.dataBar}</option>
                                            <option value="colorGradation">${n.colorGradation}</option>
                                            <option value="icons">${n.icons}</option>
                                        </select>
                                    </div>
                                    <div>
                                        <div class="type1Box dataBarBox">
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.fillType}\uFF1A</label>
                                                <select id="type2">
                                                    <option value="gradient">${n.gradient}</option>
                                                    <option value="solid">${n.solid}</option>
                                                </select>
                                            </div>
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.color}\uFF1A</label>
                                                <input data-tips="${n.dataBarColor}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#638ec6" style="display: none;"> 
                                            </div>
                                        </div>
                                        <div class="type1Box colorGradationBox" style="display: none;">
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.fillType}\uFF1A</label>
                                                <select id="type2">
                                                    <option value="threeColor">${n.tricolor}</option>
                                                    <option value="twoColor">${n.twocolor}</option>
                                                </select>
                                            </div>
                                            <div class="maxVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.maxValue}\uFF1A</label>
                                                <input data-tips="${n.maxValue} ${n.color}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(99, 190, 123)" style="display: none;">
                                            </div>
                                            <div class="midVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.medianValue}\uFF1A</label>
                                                <input data-tips="${n.medianValue} ${n.color}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(255, 235, 132)" style="display: none;">
                                            </div>
                                            <div class="minVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.minValue}\uFF1A</label>
                                                <input data-tips="${n.minValue} ${n.color}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(248, 105, 107)" style="display: none;">
                                            </div>
                                        </div>
                                        <div class="type1Box iconsBox" style="display: none;">
                                            <label>${n.fillType}\uFF1A</label>
                                            <div class="showbox">
                                                <div class="model" data-len="3" data-leftmin="0" data-top="0" title="${n.threeWayArrow}(${n.multicolor})" style="background-position: 0 0;"></div>
                                                <span class="ui-selectmenu-icon ui-icon ui-icon-triangle-1-s" style="margin-top: 2px;"></span>
                                            </div>
                                            <ul>
                                                <li><div data-len="3" data-leftmin="0" data-top="0" title="${n.threeWayArrow}(${n.multicolor})" style="background-position: 0 0;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="0" title="${n.threeWayArrow}(${n.grayColor})" style="background-position: -131px 0;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="1" title="${n.threeTriangles}" style="background-position: 0 -20px;"></div></li>
                                                <li><div data-len="4" data-leftmin="0" data-top="2" title="${n.fourWayArrow}(${n.multicolor})" style="background-position: 0 -40px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="1" title="${n.fourWayArrow}(${n.grayColor})" style="background-position: -131px -20px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="3" title="${n.fiveWayArrow}(${n.multicolor})" style="background-position: 0 -60px;"></div></li>
                                                <li><div data-len="5" data-leftmin="5" data-top="2" title="${n.fiveWayArrow}(${n.grayColor})" style="background-position: -131px -40px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="4" title="${n.threeColorTrafficLight}(${n.rimless})" style="background-position: 0 -80px;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="4" title="${n.threeColorTrafficLight}(${n.bordered})" style="background-position: -131px -80px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="5" title="${n.threeSigns}" style="background-position: 0 -100px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="5" title="${n.fourColorTrafficLight}" style="background-position: -131px -100px;"></div></li>
                                                <li><div data-len="4" data-leftmin="0" data-top="6" title="${n.greenRedBlackGradient}" style="background-position: 0 -120px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="7" title="${n.threeSymbols}(${n.circled})" style="background-position: 0 -140px;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="7" title="${n.threeSymbols}(${n.noCircle})" style="background-position: -131px -140px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="8" title="${n.tricolorFlag}" style="background-position: 0 -160px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="9" title="${n.threeStars}" style="background-position: 0 -180px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="10" title="${n.fiveQuadrantDiagram}" style="background-position: 0 -200px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="11" title="${n.fiveBoxes}" style="background-position: 0 -220px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="9" title="${n.grade4}" style="background-position: -131px -180px;"></div></li>
                                                <li><div data-len="5" data-leftmin="5" data-top="10" title="${n.grade5}" style="background-position: -131px -200px;"></div></li>
                                            </ul>
                                        </div>
                                    </div>`;break;case 1:l=`<div class="title">${n.ruleTypeItem2_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="number">${n.cellValue}</option>
                                            <option value="text">${n.specificText}</option>
                                            <option value="date">${n.occurrence}</option>
                                        </select>
                                        <div>
                                            <div class="type1Box numberBox">
                                                <select id="type2">
                                                    <option value="greaterThan">${n.greaterThan}</option>
                                                    <option value="lessThan">${n.lessThan}</option>
                                                    <option value="betweenness">${n.between}</option>
                                                    <option value="equal">${n.equal}</option>
                                                </select>
                                                <div class="inpbox range" id="conditionVal">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${n.selectCell}"></i>
                                                </div>
                                                <span class="txt" style="display: none;">${n.in}</span>
                                                <div class="inpbox range" id="conditionVal2" style="display: none;">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${n.selectDataRange}"></i>
                                                </div>
                                            </div>
                                            <div class="type1Box textBox" style="display: none;">
                                                <select id="type2">
                                                    <option value="">${n.contain}</option>
                                                </select>
                                                <div class="inpbox range" id="conditionVal">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${n.selectCell}"></i>
                                                </div>
                                            </div>
                                            <div class="type1Box dateBox" style="display: none;">
                                                <div style="width: 162px;" class="inpbox">
                                                    <input style="width: 150px;" id="daterange-btn" readonly="readonly" placeholder="${n.pleaseSelectADate}"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="title">${n.setFormat}: </div>${t}`;break;case 2:l=`<div class="title">${n.ruleTypeItem3_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="top">${n.top}</option>
                                            <option value="last">${n.last}</option>
                                        </select>
                                        <div class="inpbox" id="conditionVal">
                                            <input class="formulaInputFocus" type="number" value="10"/>
                                        </div>
                                        <input id="isPercent" type="checkbox"/>
                                        <label for="isPercent" class="txt">${n.selectRange_percent}</label>
                                    </div>
                                    <div class="title">${n.setFormat}\uFF1A</div>${t}`;break;case 3:l=`<div class="title">${n.ruleTypeItem4_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="AboveAverage">${n.above}</option>
                                            <option value="SubAverage">${n.below}</option>
                                        </select>
                                        <span class="txt">${n.selectRange_average}</span>
                                    </div>
                                    <div class="title">${n.setFormat}\uFF1A</div>${t}`;break;case 4:l=`<div class="title">${n.all}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="0">${n.duplicateValue}</option>
                                            <option value="1">${n.uniqueValue}</option>
                                        </select>
                                        <span class="txt">${n.selectRange_value}</span>
                                    </div>
                                    <div class="title">${n.setFormat}\uFF1A</div>${t}`;break;case 5:l=`<div class="title">${n.ruleTypeItem2_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <div class="inpbox range" id="formulaConditionVal" style="width: 250px;">
                                            <input class="formulaInputFocus" style="width: 200px;"/>
                                            <i class="fa fa-table" aria-hidden="true" title="${n.selectCell}"></i>
                                        </div>
                                    </div>
                                    <div class="title">${n.setFormat}: </div>${t}`;break}return l},daterangeInit:function(e){let n=Oe().conditionformat;$(".ranges_1 ul").remove(),$("#"+e).find("#daterange-btn").flatpickr({mode:"range",onChange:function(t,l){let[o,a]=t,s=[n.yesterday,n.today],u=[n.lastWeek,n.thisWeek,n.lastMonth,n.thisMonth,n.lastYear,n.thisYear,n.last7days,n.last30days];l==n.all?$("#daterange-btn").val(""):s.indexOf(l)>-1?$("#daterange-btn").val((0,yh.default)(o).format("YYYY/MM/DD")):u.indexOf(l)>-1&&$("#daterange-btn").val((0,yh.default)(o).format("YYYY/MM/DD")+"-"+(0,yh.default)(a).format("YYYY/MM/DD"))}})},CFSplitRange:function(e,n,t,l){let o=[],a=t.row[0]-n.row[0],s=t.column[0]-n.column[0],u=e.row[0],f=e.row[1],m=e.column[0],d=e.column[1];return u>=n.row[0]&&f<=n.row[1]&&m>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u+a,f+a],column:[m+s,d+s]}]:l=="restPart"?o=[]:l=="operatePart"&&(o=[{row:[u+a,f+a],column:[m+s,d+s]}]):u>=n.row[0]&&u<=n.row[1]&&m>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[n.row[1]+1,f],column:[m,d]},{row:[u+a,n.row[1]+a],column:[m+s,d+s]}]:l=="restPart"?o=[{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[m+s,d+s]}]):f>=n.row[0]&&f<=n.row[1]&&m>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0]+a,f+a],column:[m+s,d+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,f+a],column:[m+s,d+s]}]):u<n.row[0]&&f>n.row[1]&&m>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[1]+1,f],column:[m,d]},{row:[n.row[0]+a,n.row[1]+a],column:[m+s,d+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[m+s,d+s]}]):m>=n.column[0]&&m<=n.column[1]&&u>=n.row[0]&&f<=n.row[1]?l=="allPart"?o=[{row:[u,f],column:[n.column[1]+1,d]},{row:[u+a,f+a],column:[m+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,f],column:[n.column[1]+1,d]}]:l=="operatePart"&&(o=[{row:[u+a,f+a],column:[m+s,n.column[1]+s]}]):d>=n.column[0]&&d<=n.column[1]&&u>=n.row[0]&&f<=n.row[1]?l=="allPart"?o=[{row:[u,f],column:[m,n.column[0]-1]},{row:[u+a,f+a],column:[n.column[0]+s,d+s]}]:l=="restPart"?o=[{row:[u,f],column:[m,n.column[0]-1]}]:l=="operatePart"&&(o=[{row:[u+a,f+a],column:[n.column[0]+s,d+s]}]):m<n.column[0]&&d>n.column[1]&&u>=n.row[0]&&f<=n.row[1]?l=="allPart"?o=[{row:[u,f],column:[m,n.column[0]-1]},{row:[u,f],column:[n.column[1]+1,d]},{row:[u+a,f+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,f],column:[m,n.column[0]-1]},{row:[u,f],column:[n.column[1]+1,d]}]:l=="operatePart"&&(o=[{row:[u+a,f+a],column:[n.column[0]+s,n.column[1]+s]}]):u>=n.row[0]&&u<=n.row[1]&&m>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]},{row:[u+a,n.row[1]+a],column:[m+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[m+s,n.column[1]+s]}]):u>=n.row[0]&&u<=n.row[1]&&d>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[1]+1,f],column:[m,d]},{row:[u+a,n.row[1]+a],column:[n.column[0]+s,d+s]}]:l=="restPart"?o=[{row:[u,n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[n.column[0]+s,d+s]}]):f>=n.row[0]&&f<=n.row[1]&&m>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[n.column[1]+1,d]},{row:[n.row[0]+a,f+a],column:[m+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[n.column[1]+1,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,f+a],column:[m+s,n.column[1]+s]}]):f>=n.row[0]&&f<=n.row[1]&&d>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[m,n.column[0]-1]},{row:[n.row[0]+a,f+a],column:[n.column[0]+s,d+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[m,n.column[0]-1]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,f+a],column:[n.column[0]+s,d+s]}]):u<n.row[0]&&f>n.row[1]&&m>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]},{row:[n.row[0]+a,n.row[1]+a],column:[m+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[m+s,n.column[1]+s]}]):u<n.row[0]&&f>n.row[1]&&d>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[1]+1,f],column:[m,d]},{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,d+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,d+s]}]):m<n.column[0]&&d>n.column[1]&&u>=n.row[0]&&u<=n.row[1]?l=="allPart"?o=[{row:[u,n.row[1]],column:[m,n.column[0]-1]},{row:[u,n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]},{row:[u+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[1]],column:[m,n.column[0]-1]},{row:[u,n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]):m<n.column[0]&&d>n.column[1]&&f>=n.row[0]&&f<=n.row[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[m,n.column[0]-1]},{row:[n.row[0],f],column:[n.column[1]+1,d]},{row:[n.row[0]+a,f+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[m,n.column[0]-1]},{row:[n.row[0],f],column:[n.column[1]+1,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,f+a],column:[n.column[0]+s,n.column[1]+s]}]):u<n.row[0]&&f>n.row[1]&&m<n.column[0]&&d>n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]},{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]):l=="allPart"?o=[{row:[u,f],column:[m,d]}]:l=="restPart"?o=[{row:[u,f],column:[m,d]}]:l=="operatePart"&&(o=[]),o},getcolorGradation:function(e,n,t,l,o){let a=e.split(","),s=parseInt(a[0].split("(")[1]),u=parseInt(a[1]),f=parseInt(a[2].split(")")[0]),m=n.split(","),d=parseInt(m[0].split("(")[1]),g=parseInt(m[1]),b=parseInt(m[2].split(")")[0]),y=Math.round(s-(s-d)/(t-l)*(t-o)),p=Math.round(u-(u-g)/(t-l)*(t-o)),x=Math.round(f-(f-b)/(t-l)*(t-o));return"rgb("+y+", "+p+", "+x+")"},getCFPartRange:function(e,n,t){let l=[],o=h.luckysheetfile[$e(e)].luckysheet_conditionformat_save;if(o!=null&&o.length>0){e:for(let a=0;a<o.length;a++){let s=o[a].cellrange;for(let u=0;u<s.length;u++){let f=s[u].row[0],m=s[u].row[1],d=s[u].column[0],g=s[u].column[1];for(let b=0;b<range.length;b++)if(range[b].row[0]>=f&&range[b].row[0]<=m||range[b].row[1]>=f&&range[b].row[1]<=m||range[b].column[0]>=d&&range[b].column[0]<=g||range[b].column[1]>=d&&range[b].column[1]<=g){l.push(o[a]);continue e}}}}return l},checksCF:function(e,n,t){return t!=null&&e+"_"+n in t?t[e+"_"+n]:null},getComputeMap:function(e){let n=$e(h.currentSheetIndex);e!=null&&(n=$e(e));let t=h.luckysheetfile[n].luckysheet_conditionformat_save,l=h.luckysheetfile[n].data;return l==null?null:this.compute(t,l)},compute:function(e,n){let t=this;e==null&&(e=[]);let l={};if(e.length>0)for(let o=0;o<e.length;o++){let a=e[o].type,s=e[o].cellrange,u=e[o].format;if(a=="dataBar"){let f=null,m=null;for(let d=0;d<s.length;d++)for(let g=s[d].row[0];g<=s[d].row[1];g++)for(let b=s[d].column[0];b<=s[d].column[1];b++){if(n[g]==null||n[g][b]==null)continue;let y=n[g][b];V(y)=="object"&&y.ct!=null&&y.ct.t=="n"&&y.v!=null&&((f==null||parseInt(y.v)>f)&&(f=parseInt(y.v)),(m==null||parseInt(y.v)<m)&&(m=parseInt(y.v)))}if(f!=null&&m!=null)if(m<0){let d=Math.round(f/(f-m)*10)/10,g=Math.round(Math.abs(m)/(f-m)*10)/10;for(let b=0;b<s.length;b++)for(let y=s[b].row[0];y<=s[b].row[1];y++)for(let p=s[b].column[0];p<=s[b].column[1];p++){if(n[y]==null||n[y][p]==null)continue;let x=n[y][p];if(V(x)=="object"&&x.ct!=null&&x.ct.t=="n"&&x.v!=null){if(parseInt(x.v)<0){let _=Math.round(Math.abs(parseInt(x.v))/Math.abs(m)*100)/100;y+"_"+p in l?l[y+"_"+p].dataBar={valueType:"minus",minusLen:g,valueLen:_,format:u}:l[y+"_"+p]={dataBar:{valueType:"minus",minusLen:g,valueLen:_,format:u}}}if(parseInt(x.v)>0){let _=Math.round(parseInt(x.v)/f*100)/100;y+"_"+p in l?l[y+"_"+p].dataBar={valueType:"plus",plusLen:d,minusLen:g,valueLen:_,format:u}:l[y+"_"+p]={dataBar:{valueType:"plus",plusLen:d,minusLen:g,valueLen:_,format:u}}}}}}else{let d=1;for(let g=0;g<s.length;g++)for(let b=s[g].row[0];b<=s[g].row[1];b++)for(let y=s[g].column[0];y<=s[g].column[1];y++){if(n[b]==null||n[b][y]==null)continue;let p=n[b][y];if(V(p)=="object"&&p.ct!=null&&p.ct.t=="n"&&p.v!=null){let x;f==0?x=1:x=Math.round(parseInt(p.v)/f*100)/100,b+"_"+y in l?l[b+"_"+y].dataBar={valueType:"plus",plusLen:d,valueLen:x,format:u}:l[b+"_"+y]={dataBar:{valueType:"plus",plusLen:d,valueLen:x,format:u}}}}}}else if(a=="colorGradation"){let f=null,m=null,d=0,g=0;for(let b=0;b<s.length;b++)for(let y=s[b].row[0];y<=s[b].row[1];y++)for(let p=s[b].column[0];p<=s[b].column[1];p++){if(n[y]==null||n[y][p]==null)continue;let x=n[y][p];V(x)=="object"&&x.ct!=null&&x.ct.t=="n"&&x.v!=null&&(g++,d+=parseInt(x.v),(f==null||parseInt(x.v)>f)&&(f=parseInt(x.v)),(m==null||parseInt(x.v)<m)&&(m=parseInt(x.v)))}if(f!=null&&m!=null){if(u.length==3){let b=Math.floor(d/g);for(let y=0;y<s.length;y++)for(let p=s[y].row[0];p<=s[y].row[1];p++)for(let x=s[y].column[0];x<=s[y].column[1];x++){if(n[p]==null||n[p][x]==null)continue;let _=n[p][x];V(_)=="object"&&_.ct!=null&&_.ct.t=="n"&&_.v!=null&&(parseInt(_.v)==m?p+"_"+x in l?l[p+"_"+x].cellColor=u[2]:l[p+"_"+x]={cellColor:u[2]}:parseInt(_.v)>m&&parseInt(_.v)<b?p+"_"+x in l?l[p+"_"+x].cellColor=t.getcolorGradation(u[2],u[1],m,b,parseInt(_.v)):l[p+"_"+x]={cellColor:t.getcolorGradation(u[2],u[1],m,b,parseInt(_.v))}:parseInt(_.v)==b?p+"_"+x in l?l[p+"_"+x].cellColor=u[1]:l[p+"_"+x]={cellColor:u[1]}:parseInt(_.v)>b&&parseInt(_.v)<f?p+"_"+x in l?l[p+"_"+x].cellColor=t.getcolorGradation(u[1],u[0],b,f,parseInt(_.v)):l[p+"_"+x]={cellColor:t.getcolorGradation(u[1],u[0],b,f,parseInt(_.v))}:parseInt(_.v)==f&&(p+"_"+x in l?l[p+"_"+x].cellColor=u[0]:l[p+"_"+x]={cellColor:u[0]}))}}else if(u.length==2)for(let b=0;b<s.length;b++)for(let y=s[b].row[0];y<=s[b].row[1];y++)for(let p=s[b].column[0];p<=s[b].column[1];p++){if(n[y]==null||n[y][p]==null)continue;let x=n[y][p];V(x)=="object"&&x.ct!=null&&x.ct.t=="n"&&x.v!=null&&(parseInt(x.v)==m?y+"_"+p in l?l[y+"_"+p].cellColor=u[1]:l[y+"_"+p]={cellColor:u[1]}:parseInt(x.v)>m&&parseInt(x.v)<f?y+"_"+p in l?l[y+"_"+p].cellColor=t.getcolorGradation(u[1],u[0],m,f,parseInt(x.v)):l[y+"_"+p]={cellColor:t.getcolorGradation(u[1],u[0],m,f,parseInt(x.v))}:parseInt(x.v)==f&&(y+"_"+p in l?l[y+"_"+p].cellColor=u[0]:l[y+"_"+p]={cellColor:u[0]}))}}}else if(a=="icons"){let f=parseInt(u.len),m=parseInt(u.leftMin),d=parseInt(u.top),g=null,b=null;for(let y=0;y<s.length;y++)for(let p=s[y].row[0];p<=s[y].row[1];p++)for(let x=s[y].column[0];x<=s[y].column[1];x++){if(n[p]==null||n[p][x]==null)continue;let _=n[p][x];V(_)=="object"&&_.ct!=null&&_.ct.t=="n"&&_.v!=null&&((g==null||parseInt(_.v)>g)&&(g=parseInt(_.v)),(b==null||parseInt(_.v)<b)&&(b=parseInt(_.v)))}if(g!=null&&b!=null){let y=Math.floor((g-b+1)/f),p=(g-b+1)%f;if(f==3){let x,_,S;p==2?(x=[b,b+y],_=[b+y+1,b+y*2],S=[b+y*2+1,g]):(x=[b,b+y-1],_=[b+y,b+y*2-1],S=[b+y*2,g]);for(let I=0;I<s.length;I++)for(let O=s[I].row[0];O<=s[I].row[1];O++)for(let F=s[I].column[0];F<=s[I].column[1];F++){if(n[O]==null||n[O][F]==null)continue;let D=n[O][F];V(D)=="object"&&D.ct!=null&&D.ct.t=="n"&&D.v!=null&&(parseInt(D.v)>=x[0]&&parseInt(D.v)<=x[1]?O+"_"+F in l?l[O+"_"+F].icons={left:m+2,top:d}:l[O+"_"+F]={icons:{left:m+2,top:d}}:parseInt(D.v)>=_[0]&&parseInt(D.v)<=_[1]?O+"_"+F in l?l[O+"_"+F].icons={left:m+1,top:d}:l[O+"_"+F]={icons:{left:m+1,top:d}}:parseInt(D.v)>=S[0]&&parseInt(D.v)<=S[1]&&(O+"_"+F in l?l[O+"_"+F].icons={left:m,top:d}:l[O+"_"+F]={icons:{left:m,top:d}}))}}else if(f==4){let x,_,S,I;p==2?(x=[b,b+y],_=[b+y+1,b+y*2],S=[b+y*2+1,b+y*3],I=[b+y*3+1,g]):p==3?(x=[b,b+y],_=[b+y+1,b+y*2],S=[b+y*2+1,b+y*3+1],I=[b+y*3+2,g]):(x=[b,b+y-1],_=[b+y,b+y*2-1],S=[b+y*2,b+y*3-1],I=[b+y*3,g]);for(let O=0;O<s.length;O++)for(let F=s[O].row[0];F<=s[O].row[1];F++)for(let D=s[O].column[0];D<=s[O].column[1];D++){if(n[F]==null||n[F][D]==null)continue;let k=n[F][D];V(k)=="object"&&k.ct!=null&&k.ct.t=="n"&&k.v!=null&&(parseInt(k.v)>=x[0]&&parseInt(k.v)<=x[1]?F+"_"+D in l?l[F+"_"+D].icons={left:m+3,top:d}:l[F+"_"+D]={icons:{left:m+3,top:d}}:parseInt(k.v)>=_[0]&&parseInt(k.v)<=_[1]?F+"_"+D in l?l[F+"_"+D].icons={left:m+2,top:d}:l[F+"_"+D]={icons:{left:m+2,top:d}}:parseInt(k.v)>=S[0]&&parseInt(k.v)<=S[1]?F+"_"+D in l?l[F+"_"+D].icons={left:m+1,top:d}:l[F+"_"+D]={icons:{left:m+1,top:d}}:parseInt(k.v)>=I[0]&&parseInt(k.v)<=I[1]&&(F+"_"+D in l?l[F+"_"+D].icons={left:m,top:d}:l[F+"_"+D]={icons:{left:m,top:d}}))}}else if(f==5){let x,_,S,I,O;p==2?(x=[b,b+y],_=[b+y+1,b+y*2],S=[b+y*2+1,b+y*3],I=[b+y*3+1,b+y*4],O=[b+y*4+1,g]):p==3?(x=[b,b+y],_=[b+y+1,b+y*2],S=[b+y*2+1,b+y*3+1],I=[b+y*3+2,b+y*4+1],O=[b+y*4+2,g]):p==4?(x=[b,b+y],_=[b+y+1,b+y*2+1],S=[b+y*2+2,b+y*3+1],I=[b+y*3+2,b+y*4+2],O=[b+y*4+3,g]):(x=[b,b+y-1],_=[b+y,b+y*2-1],S=[b+y*2,b+y*3-1],I=[b+y*3,b+y*4-1],O=[b+y*4,g]);for(let F=0;F<s.length;F++)for(let D=s[F].row[0];D<=s[F].row[1];D++)for(let k=s[F].column[0];k<=s[F].column[1];k++){if(n[D]==null||n[D][k]==null)continue;let w=n[D][k];V(w)=="object"&&w.ct!=null&&w.ct.t=="n"&&w.v!=null&&(parseInt(w.v)>=x[0]&&parseInt(w.v)<=x[1]?D+"_"+k in l?l[D+"_"+k].icons={left:m+4,top:d}:l[D+"_"+k]={icons:{left:m+4,top:d}}:parseInt(w.v)>=_[0]&&parseInt(w.v)<=_[1]?D+"_"+k in l?l[D+"_"+k].icons={left:m+3,top:d}:l[D+"_"+k]={icons:{left:m+3,top:d}}:parseInt(w.v)>=S[0]&&parseInt(w.v)<=S[1]?D+"_"+k in l?l[D+"_"+k].icons={left:m+2,top:d}:l[D+"_"+k]={icons:{left:m+2,top:d}}:parseInt(w.v)>=I[0]&&parseInt(w.v)<=I[1]?D+"_"+k in l?l[D+"_"+k].icons={left:m+1,top:d}:l[D+"_"+k]={icons:{left:m+1,top:d}}:parseInt(w.v)>=O[0]&&parseInt(w.v)<=O[1]&&(D+"_"+k in l?l[D+"_"+k].icons={left:m,top:d}:l[D+"_"+k]={icons:{left:m,top:d}}))}}}}else{let f=e[o].conditionName,m=e[o].conditionValue[0],d=e[o].conditionValue[1],g=u.textColor,b=u.cellColor;for(let y=0;y<s.length;y++)if(f=="greaterThan"||f=="lessThan"||f=="equal"||f=="textContains")for(let p=s[y].row[0];p<=s[y].row[1];p++)for(let x=s[y].column[0];x<=s[y].column[1];x++){if(n[p]==null||n[p][x]==null)continue;let _=n[p][x];V(_)!="object"||rt(_.v)||(f=="greaterThan"&&_.v>m?p+"_"+x in l?(l[p+"_"+x].textColor=g,l[p+"_"+x].cellColor=b):l[p+"_"+x]={textColor:g,cellColor:b}:f=="lessThan"&&_.v<m?p+"_"+x in l?(l[p+"_"+x].textColor=g,l[p+"_"+x].cellColor=b):l[p+"_"+x]={textColor:g,cellColor:b}:f=="equal"&&_.v==m?p+"_"+x in l?(l[p+"_"+x].textColor=g,l[p+"_"+x].cellColor=b):l[p+"_"+x]={textColor:g,cellColor:b}:f=="textContains"&&_.v.toString().indexOf(m)!=-1&&(p+"_"+x in l?(l[p+"_"+x].textColor=g,l[p+"_"+x].cellColor=b):l[p+"_"+x]={textColor:g,cellColor:b}))}else if(f=="betweenness"){let p,x;m>d?(p=m,x=d):(p=d,x=m);for(let _=s[y].row[0];_<=s[y].row[1];_++)for(let S=s[y].column[0];S<=s[y].column[1];S++){if(n[_]==null||n[_][S]==null)continue;let I=n[_][S];V(I)!="object"||rt(I.v)||I.v>=x&&I.v<=p&&(_+"_"+S in l?(l[_+"_"+S].textColor=g,l[_+"_"+S].cellColor=b):l[_+"_"+S]={textColor:g,cellColor:b})}}else if(f=="occurrenceDate"){let p,x;if(m.toString().indexOf("-")==-1)p=nl(m)[2],x=nl(m)[2];else{let _=m.toString().split("-");p=nl(_[1].trim())[2],x=nl(_[0].trim())[2]}for(let _=s[y].row[0];_<=s[y].row[1];_++)for(let S=s[y].column[0];S<=s[y].column[1];S++)if(!(n[_]==null||n[_][S]==null)&&n[_][S].ct!=null&&n[_][S].ct.t=="d"){let I=Mt(_,S,n);I>=x&&I<=p&&(_+"_"+S in l?(l[_+"_"+S].textColor=g,l[_+"_"+S].cellColor=b):l[_+"_"+S]={textColor:g,cellColor:b})}}else if(f=="duplicateValue"){let p={};for(let x=s[y].row[0];x<=s[y].row[1];x++)for(let _=s[y].column[0];_<=s[y].column[1];_++){let S=Mt(x,_,n);S in p||(p[S]=[]),p[S].push({r:x,c:_})}if(m=="0"){for(let x in p)if(x!="null"&&x!="undefined"&&p[x].length>1)for(let _=0;_<p[x].length;_++)p[x][_].r+"_"+p[x][_].c in l?(l[p[x][_].r+"_"+p[x][_].c].textColor=g,l[p[x][_].r+"_"+p[x][_].c].cellColor=b):l[p[x][_].r+"_"+p[x][_].c]={textColor:g,cellColor:b}}if(m=="1")for(let x in p)x!="null"&&x!="undefined"&&p[x].length==1&&(p[x][0].r+"_"+p[x][0].c in l?(l[p[x][0].r+"_"+p[x][0].c].textColor=g,l[p[x][0].r+"_"+p[x][0].c].cellColor=b):l[p[x][0].r+"_"+p[x][0].c]={textColor:g,cellColor:b})}else if(f=="top10"||f=="top10%"||f=="last10"||f=="last10%"||f=="AboveAverage"||f=="SubAverage"){let p=[];for(let x=s[y].row[0];x<=s[y].row[1];x++)for(let _=s[y].column[0];_<=s[y].column[1];_++)n[x]==null||n[x][_]==null||n[x][_].ct!=null&&n[x][_].ct.t=="n"&&p.push(Mt(x,_,n));if(f=="top10"||f=="top10%"||f=="last10"||f=="last10%"){for(let _=0;_<p.length;_++)for(let S=0;S<p.length-1-_;S++)if(p[S]<p[S+1]){let I=p[S];p[S]=p[S+1],p[S+1]=I}let x;f=="top10"?x=p.slice(0,m):f=="top10%"?x=p.slice(0,Math.floor(m*p.length/100)):f=="last10"?x=p.slice(p.length-m,p.length):f=="last10%"&&(x=p.slice(p.length-Math.floor(m*p.length/100),p.length));for(let _=s[y].row[0];_<=s[y].row[1];_++)for(let S=s[y].column[0];S<=s[y].column[1];S++){if(n[_]==null||n[_][S]==null)continue;let I=Mt(_,S,n);x.indexOf(I)!=-1&&(_+"_"+S in l?(l[_+"_"+S].textColor=g,l[_+"_"+S].cellColor=b):l[_+"_"+S]={textColor:g,cellColor:b})}}else if(f=="AboveAverage"||f=="SubAverage"){let x=0;for(let S=0;S<p.length;S++)x+=p[S];let _=x/p.length;if(f=="AboveAverage")for(let S=s[y].row[0];S<=s[y].row[1];S++)for(let I=s[y].column[0];I<=s[y].column[1];I++){if(n[S]==null||n[S][I]==null)continue;Mt(S,I,n)>_&&(S+"_"+I in l?(l[S+"_"+I].textColor=g,l[S+"_"+I].cellColor=b):l[S+"_"+I]={textColor:g,cellColor:b})}else if(f=="SubAverage")for(let S=s[y].row[0];S<=s[y].row[1];S++)for(let I=s[y].column[0];I<=s[y].column[1];I++){if(n[S]==null||n[S][I]==null)continue;Mt(S,I,n)<_&&(S+"_"+I in l?(l[S+"_"+I].textColor=g,l[S+"_"+I].cellColor=b):l[S+"_"+I]={textColor:g,cellColor:b})}}}else if(f=="formula"){let p=s[y].row[0],x=s[y].row[1],_=s[y].column[0],S=s[y].column[1],I=m;m.toString().slice(0,1)!="="&&(I="="+m);for(let O=p;O<=x;O++)for(let F=_;F<=S;F++){let D=I,k=O-p,w=F-_;k>0&&(D="="+v.functionCopy(D,"down",k)),w>0&&(D="="+v.functionCopy(D,"right",w));let T=v.execfunction(D)[1];typeof T!="boolean"&&(T=!!Number(T)),!!T&&(O+"_"+F in l?(l[O+"_"+F].textColor=g,l[O+"_"+F].cellColor=b):l[O+"_"+F]={textColor:g,cellColor:b})}}}}return l},updateItem:function(e,n,t){if(!ao(h.currentSheetIndex))return;let l=this,o=$e(h.currentSheetIndex),a=$.extend(!0,[],h.luckysheetfile),s=l.getHistoryRules(a),u;if(e=="delSheet")u=[];else{let d={type:e,cellrange:n,format:t};u=h.luckysheetfile[o].luckysheet_conditionformat_save==null?[]:h.luckysheetfile[o].luckysheet_conditionformat_save,u.push(d)}h.luckysheetfile[o].luckysheet_conditionformat_save=u;let f=$.extend(!0,[],h.luckysheetfile),m=l.getCurrentRules(f);l.ref(s,m),He.allowUpdate&&He.saveParam("all",h.currentSheetIndex,u,{k:"luckysheet_conditionformat_save"})},getHistoryRules:function(e){let n=[];for(let t=0;t<e.length;t++)n.push({sheetIndex:e[t].index,luckysheet_conditionformat_save:e[t].luckysheet_conditionformat_save});return n},getCurrentRules:function(e){let n=[];for(let t=0;t<e.length;t++)n.push({sheetIndex:e[t].index,luckysheet_conditionformat_save:e[t].luckysheet_conditionformat_save});return n},ref:function(e,n){if(h.clearjfundo){h.jfundo.length=0;let t={};t.type="updateCF",t.data={historyRules:e,currentRules:n},h.jfredo.push(t)}setTimeout(function(){Et()},1)}},xt=i3});var import_plugin,o3,Ol,Ac=Tt(()=>{import_plugin=Le(Be());vr();Mr();ji();jn();br();Sr();ir();Tc();mr();Hi();Gl();fr();Hn();ql();gl();Ut();Rl();To();o3={clearcopy:function(e){let n=window.clipboardData;n||e&&(n=e.originalEvent.clipboardData);let t=" ";if(h.luckysheet_selection_range=[],Jl(),n)return n.setData("Text",t),!1;{let l=$("#luckysheet-copy-content").css("visibility","hidden");l.val(t),l.focus(),l.select(),setTimeout(function(){l.blur().css("visibility","visible")},10)}},getHtmlBorderStyle:function(e,n){let t="";return e={"0":"none","1":"Thin","2":"Hair","3":"Dotted","4":"Dashed","5":"DashDot","6":"DashDotDot","7":"Double","8":"Medium","9":"MediumDashed","10":"MediumDashDot","11":"MediumDashDotDot","12":"SlantedDashDot","13":"Thick"}[e.toString()],e.indexOf("Medium")>-1?t+="1pt ":e=="Thick"?t+="1.5pt ":t+="0.5pt ",e=="Hair"?t+="double ":e.indexOf("DashDotDot")>-1?t+="dotted ":e.indexOf("DashDot")>-1?t+="dashed ":e.indexOf("Dotted")>-1?t+="dotted ":e.indexOf("Dashed")>-1?t+="dashed ":t+="solid ",t+n+";"},copy:function(e){let n=window.clipboardData;n||(n=e.originalEvent.clipboardData),h.luckysheet_selection_range=[];let t=[],l=[],o=[],a=!1,s=!1;for(let b=0;b<h.luckysheet_select_save.length;b++){let y=h.luckysheet_select_save[b],p=y.row[0],x=y.row[1],_=y.column[0],S=y.column[1];for(let I=p;I<=x;I++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[I]!=null)){t.includes(I)||t.push(I),h.config.rowlen!=null&&I in h.config.rowlen&&(a=!0);for(let O=_;O<=S;O++){if(h.config.colhidden!=null&&h.config.colhidden[O]!=null)continue;l.includes(O)||l.push(O);let F=h.flowdata[I][O];V(F)=="object"&&"mc"in F&&F.mc.rs!=null&&(s=!0)}}h.luckysheet_selection_range.push({row:y.row,column:y.column}),o.push({row:y.row,column:y.column})}Jl(),h.luckysheet_copy_save={dataSheetIndex:h.currentSheetIndex,copyRange:o,RowlChange:a,HasMC:s};let u=this,f;h.config.borderInfo&&h.config.borderInfo.length>0&&(f=Mo());let m="",d=pt.deepCopyFlowData(h.flowdata),g="";for(let b=0;b<t.length;b++){let y=t[b];if(!(h.config.rowhidden!=null&&h.config.rowhidden[y]!=null)){h.config==null||h.config.rowlen==null||h.config.rowlen[y.toString()]==null?m+='<tr height="19">':m+=`<tr height="${h.config.rowlen[y.toString()]}">`;for(let p=0;p<l.length;p++){let x=l[p];if(y==t[0]&&(h.config==null||h.config.columnlen==null||h.config.columnlen[x.toString()]==null?g+='<col width="72px"></col>':g+='<col width="'+h.config.columnlen[x.toString()]+'px"></col>'),h.config.colhidden!=null&&h.config.colhidden[x]!=null)continue;let _='<td ${span} style="${style}">';if(d[y]!=null&&d[y][x]!=null){let S="",I="",O=/^(w|W)((0?)|(0\.0+))$/,F;if(d[y][x].ct!=null&&d[y][x].ct.fa!=null&&d[y][x].ct.fa.match(O)?F=Mt(y,x,d):F=Mt(y,x,d,"m"),S+=ht.getStyleByCell(d,y,x),V(d[y][x])=="object"&&"mc"in d[y][x])if("rs"in d[y][x].mc){if(I='rowspan="'+d[y][x].mc.rs+'" colspan="'+d[y][x].mc.cs+'"',f&&f[y+"_"+x]){let D={color:{},style:{}},k={color:{},style:{}},w={color:{},style:{}},C={color:{},style:{}};for(let A=y;A<y+d[y][x].mc.rs;A++)for(let M=x;M<x+d[y][x].mc.cs;M++){if(A==y&&f[A+"_"+M]&&f[A+"_"+M].t){let P=f[A+"_"+M].t.style,N=f[A+"_"+M].t.color;w.style[P]==null?w.style[P]=1:w.style[P]=w.style[P]+1,w.color[N]==null?w.color[N]=1:w.color[N]=w.color[N]+1}if(A==y+d[y][x].mc.rs-1&&f[A+"_"+M]&&f[A+"_"+M].b){let P=f[A+"_"+M].b.style,N=f[A+"_"+M].b.color;C.style[P]==null?C.style[P]=1:C.style[P]=C.style[P]+1,C.color[N]==null?C.color[N]=1:C.color[N]=C.color[N]+1}if(M==x&&f[A+"_"+M]&&f[A+"_"+M].l){let P=f[y+"_"+x].l.style,N=f[A+"_"+M].l.color;D.style[P]==null?D.style[P]=1:D.style[P]=D.style[P]+1,D.color[N]==null?D.color[N]=1:D.color[N]=D.color[N]+1}if(M==x+d[y][x].mc.cs-1&&f[A+"_"+M]&&f[A+"_"+M].r){let P=f[A+"_"+M].r.style,N=f[A+"_"+M].r.color;k.style[P]==null?k.style[P]=1:k.style[P]=k.style[P]+1,k.color[N]==null?k.color[N]=1:k.color[N]=k.color[N]+1}}let T=d[y][x].mc.rs,z=d[y][x].mc.cs;if(JSON.stringify(D).length>23){let A=null,M=null;for(let P in D.color)D.color[P]>=T/2&&(A=P);for(let P in D.style)D.style[P]>=T/2&&(M=P);A!=null&&M!=null&&(S+="border-left:"+u.getHtmlBorderStyle(M,A))}if(JSON.stringify(k).length>23){let A=null,M=null;for(let P in k.color)k.color[P]>=T/2&&(A=P);for(let P in k.style)k.style[P]>=T/2&&(M=P);A!=null&&M!=null&&(S+="border-right:"+u.getHtmlBorderStyle(M,A))}if(JSON.stringify(w).length>23){let A=null,M=null;for(let P in w.color)w.color[P]>=z/2&&(A=P);for(let P in w.style)w.style[P]>=z/2&&(M=P);A!=null&&M!=null&&(S+="border-top:"+u.getHtmlBorderStyle(M,A))}if(JSON.stringify(C).length>23){let A=null,M=null;for(let P in C.color)C.color[P]>=z/2&&(A=P);for(let P in C.style)C.style[P]>=z/2&&(M=P);A!=null&&M!=null&&(S+="border-bottom:"+u.getHtmlBorderStyle(M,A))}}}else continue;else if(f&&f[y+"_"+x]){if(f[y+"_"+x].l){let D=f[y+"_"+x].l.style,k=f[y+"_"+x].l.color;S+="border-left:"+u.getHtmlBorderStyle(D,k)}if(f[y+"_"+x].r){let D=f[y+"_"+x].r.style,k=f[y+"_"+x].r.color;S+="border-right:"+u.getHtmlBorderStyle(D,k)}if(f[y+"_"+x].b){let D=f[y+"_"+x].b.style,k=f[y+"_"+x].b.color;S+="border-bottom:"+u.getHtmlBorderStyle(D,k)}if(f[y+"_"+x].t){let D=f[y+"_"+x].t.style,k=f[y+"_"+x].t.color;S+="border-top:"+u.getHtmlBorderStyle(D,k)}}_=yt(_,{style:S,span:I}),F==null&&(F=Mt(y,x,d)),F==null&&d[y][x]&&d[y][x].ct&&d[y][x].ct.t=="inlineStr"&&(F=d[y][x].ct.s.map(D=>{let k=$('<br style="mso-data-placement:same-cell;">');return D.v.split(`\r
`).map(C=>{if(!C)return"";let T=$("<font></font>");return D.fs&&T.css("font-size",`${D.fs}pt`),D.bl&&T.css("font-weight","bold"),D.it&&T.css("font-style","italic"),D.un&&T.css("text-decoration","underline"),D.fc&&T.css("color",D.fc),D.cl?T.append(`<s>${C}</s>`):T.text(C),T[0].outerHTML}).join(k[0].outerHTML)}).join("")),F==null&&(F=""),F=v.ltGtSignDeal(F),_+=F}else{let S="";if(f&&f[y+"_"+x]){if(f[y+"_"+x].l){let I=f[y+"_"+x].l.style,O=f[y+"_"+x].l.color;S+="border-left:"+u.getHtmlBorderStyle(I,O)}if(f[y+"_"+x].r){let I=f[y+"_"+x].r.style,O=f[y+"_"+x].r.color;S+="border-right:"+u.getHtmlBorderStyle(I,O)}if(f[y+"_"+x].b){let I=f[y+"_"+x].b.style,O=f[y+"_"+x].b.color;S+="border-bottom:"+u.getHtmlBorderStyle(I,O)}if(f[y+"_"+x].t){let I=f[y+"_"+x].t.style,O=f[y+"_"+x].t.color;S+="border-top:"+u.getHtmlBorderStyle(I,O)}}_+="",_=yt(_,{style:S,span:""}),_+=""}_+="</td>",m+=_}m+="</tr>"}}if(m=`<table data-type="luckysheet_copy_action_table"><colgroup>${g}</colgroup>`+m+"</table>",h.iscopyself=!0,n)return n.setData("Text",m),!1;{let b=$("#luckysheet-copy-content");b.html(m),b.focus(),b.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){$("#luckysheet-copy-content").blur()},10)}},copybyformat:function(e,n){let t=window.clipboardData;t||(t=e.originalEvent&&e.originalEvent.clipboardData),h.luckysheet_selection_range=[{row:h.luckysheet_select_save[0].row,column:h.luckysheet_select_save[0].column}],Jl();let l=n;if(h.iscopyself=!0,t)return t.setData("Text",l),!1;{let o=$("#luckysheet-copy-content");o.text(l),o.focus(),o.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){o.blur()},10)}},isPasteAction:!1,paste:function(e,n){let t=this;if(h.allowEdit===!1)return;let o=Oe().drag,a=$("#luckysheet-copy-content");a.focus(),a.select(),setTimeout(function(){let s=a.html();s.indexOf("luckysheet_copy_action_table")>-1&&h.luckysheet_copy_save.copyRange!=null&&h.luckysheet_copy_save.copyRange.length>0?h.luckysheet_paste_iscut?(h.luckysheet_paste_iscut=!1,t.pasteHandlerOfCutPaste(h.luckysheet_copy_save),t.clearcopy(e)):t.pasteHandlerOfCopyPaste(h.luckysheet_copy_save):s.indexOf("luckysheet_copy_action_image")>-1?$t.pasteImgItem():n!="btn"?t.pasteHandler(s):Qe()?alert(o.pasteMustKeybordAlert):de.info(o.pasteMustKeybordAlertHTMLTitle,o.pasteMustKeybordAlertHTML)},10)},pasteHandler:function(e,n){if(!Wi(h.luckysheet_select_save,h.currentSheetIndex)||h.allowEdit===!1)return;let l=Oe().paste;if(h.luckysheet_select_save.length>1&&(Qe()?alert(l.errorNotAllowMulti):de.info(`<i class="fa fa-exclamation-triangle"></i>${l.warning}`,l.errorNotAllowMulti)),typeof e=="object"){if(e.length==0)return;let o=$.extend(!0,{},h.config);o.merge==null&&(o.merge={}),JSON.stringify(n).length>2&&o.borderInfo==null&&(o.borderInfo=[]);let a=e.length,s=e[0].length,u=h.luckysheet_select_save[0].row[0],f=u+a-1,m=h.luckysheet_select_save[0].column[0],d=m+s-1,g=!1;if(o.merge!=null&&(g=Ul(o,u,f,m,d)),g){Qe()?alert(l.errorNotAllowMerged):de.info(`<i class="fa fa-exclamation-triangle"></i>${l.warning}`,l.errorNotAllowMerged);return}let b=pt.deepCopyFlowData(h.flowdata),y=b.length,p=b[0].length,x=f-y+1,_=d-p+1;(x>0||_>0)&&(b=Hr([].concat(b),x,_,!0)),o.rowlen==null&&(o.rowlen={});let S=!1,I={};for(let O=u;O<=f;O++){let F=[].concat(b[O]),D=h.defaultrowlen;o.rowlen[O]!=null&&(D=o.rowlen[O]);for(let k=m;k<=d;k++){V(F[k])=="object"&&"mc"in F[k]&&("rs"in F[k].mc&&delete o.merge[F[k].mc.r+"_"+F[k].mc.c],delete F[k].mc);let w=null;if(e[O-u]!=null&&e[O-u][k-m]!=null&&(w=e[O-u][k-m]),F[k]=$.extend(!0,{},w),w!=null&&"mc"in F[k]&&(F[k].mc.rs!=null?(F[k].mc.r=O,F[k].mc.c=k,o.merge[F[k].mc.r+"_"+F[k].mc.c]=F[k].mc,I[w.mc.r+"_"+w.mc.c]=[F[k].mc.r,F[k].mc.c]):F[k]={mc:{r:I[w.mc.r+"_"+w.mc.c][0],c:I[w.mc.r+"_"+w.mc.c][1]}}),n[O-u+"_"+(k-m)]){let z={rangeType:"cell",value:{row_index:O,col_index:k,l:n[O-u+"_"+(k-m)].l,r:n[O-u+"_"+(k-m)].r,t:n[O-u+"_"+(k-m)].t,b:n[O-u+"_"+(k-m)].b}};o.borderInfo.push(z)}let C=Ss(F[k]),T=ht.getTextSize("\u7530",C)[1];T>D&&(D=T,S=!0)}b[O]=F,D!=h.defaultrowlen&&(o.rowlen[O]=D)}if(h.luckysheet_select_save=[{row:[u,f],column:[m,d]}],x>0||_>0||S){let O={cfg:o,RowlChange:!0};Gt(b,h.luckysheet_select_save,O)}else{let O={cfg:o};Gt(b,h.luckysheet_select_save,O),Zt()}}else{e=e.replace(/\r/g,"");let o=[],a=e.split(`
`),s=a[0].split("	").length;for(let _=0;_<a.length;_++)a[_].split("	").length<s||o.push(a[_].split("	"));let u=pt.deepCopyFlowData(h.flowdata),f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row==null?0:f.row[0],d=f.column==null?0:f.column[0],g=o.length,b=o[0].length,y=!1;if(h.config.merge!=null&&(y=Ul(h.config,m,m+g-1,d,d+b-1)),y){Qe()?alert(l.errorNotAllowMerged):de.info(`<i class="fa fa-exclamation-triangle"></i>${l.warning}`,l.errorNotAllowMerged);return}let p=m+g-u.length,x=d+b-u[0].length;(p>0||x>0)&&(u=Hr([].concat(u),p,x,!0));for(let _=0;_<g;_++){let S=[].concat(u[_+m]);for(let I=0;I<b;I++){let O=S[I+d],F=o[_][I];if(Y(F)&&(O&&O.ct&&O.ct.fa==="@"?F=String(F):F=parseFloat(F)),O instanceof Object)O.v=F,O.ct!=null&&O.ct.fa!=null?O.m=$l(O.ct.fa,F):O.m=F,O.f!=null&&O.f.length>0&&(O.f="",v.delFunctionGroup(_+m,I+d,h.currentSheetIndex));else{let D={},k=nl(F);D.v=k[2],D.ct=k[1],D.m=k[0],S[I+d]=D}}u[_+m]=S}if(f.row=[m,m+g-1],f.column=[d,d+b-1],p>0||x>0){let _={RowlChange:!0};Gt(u,h.luckysheet_select_save,_)}else Gt(u,h.luckysheet_select_save),Zt()}},pasteHandlerOfCutPaste:function(e){if(!Wi(h.luckysheet_select_save,h.currentSheetIndex)||h.allowEdit===!1)return;let t=Oe().paste,l=$.extend(!0,{},h.config);l.merge==null&&(l.merge={});let o=e.HasMC,a=e.RowlChange,s=e.dataSheetIndex,u=e.copyRange[0].row[0],f=e.copyRange[0].row[1],m=e.copyRange[0].column[0],d=e.copyRange[0].column[1],g=$.extend(!0,[],Xl({row:[u,f],column:[m,d]},s)),b=g.length,y=g[0].length,p=h.luckysheet_select_save[h.luckysheet_select_save.length-1],x=p.row_focus,_=x+b-1,S=p.column_focus,I=S+y-1,O=!1;if(l.merge!=null&&(O=Ul(l,x,_,S,I)),O){Qe()?alert(t.errorNotAllowMerged):de.info(`<i class="fa fa-exclamation-triangle"></i>${t.warning}`,t.errorNotAllowMerged);return}let F=pt.deepCopyFlowData(h.flowdata),D=F.length,k=F[0].length,w=b+x-D,C=y+S-k;(w>0||C>0)&&(F=Hr([].concat(F),w,C,!0));let T=Mo(s),z=$.extend(!0,{},h.luckysheetfile[$e(s)].dataVerification),A=$.extend(!0,{},h.luckysheetfile[$e(h.currentSheetIndex)].dataVerification);if(h.currentSheetIndex==s){for(let E=u;E<=f;E++)for(let B=m;B<=d;B++){let U=F[E][B];V(U)=="object"&&"mc"in U&&("rs"in U.mc&&delete l.merge[U.mc.r+"_"+U.mc.c],delete U.mc),F[E][B]=null,delete A[E+"_"+B]}if(l.borderInfo&&l.borderInfo.length>0){let E=[];for(let B=0;B<l.borderInfo.length;B++){let U=l.borderInfo[B].rangeType;if(U=="range"){let X=l.borderInfo[B].range,le=[];for(let he=0;he<X.length;he++)le=le.concat(xt.CFSplitRange(X[he],{row:[u,f],column:[m,d]},{row:[x,_],column:[S,I]},"restPart"));l.borderInfo[B].range=le,E.push(l.borderInfo[B])}else if(U=="cell"){let X=l.borderInfo[B].value.row_index,le=l.borderInfo[B].value.col_index;X>=u&&X<=f&&le>=m&&le<=d||E.push(l.borderInfo[B])}}l.borderInfo=E}}let M={};for(let E=x;E<=_;E++){let B=[].concat(F[E]);for(let U=S;U<=I;U++){if(T[u+E-x+"_"+(m+U-S)]){let le={rangeType:"cell",value:{row_index:E,col_index:U,l:T[u+E-x+"_"+(m+U-S)].l,r:T[u+E-x+"_"+(m+U-S)].r,t:T[u+E-x+"_"+(m+U-S)].t,b:T[u+E-x+"_"+(m+U-S)].b}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(le)}else if(T[E+"_"+U]){let le={rangeType:"cell",value:{row_index:E,col_index:U,l:null,r:null,t:null,b:null}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(le)}z[u+E-x+"_"+(m+U-S)]&&(A[E+"_"+U]=z[u+E-x+"_"+(m+U-S)]),V(B[U])=="object"&&"mc"in B[U]&&("rs"in B[U].mc&&delete l.merge[B[U].mc.r+"_"+B[U].mc.c],delete B[U].mc);let X=null;g[E-x]!=null&&g[E-x][U-S]!=null&&(X=g[E-x][U-S]),B[U]=$.extend(!0,{},X),X!=null&&o&&"mc"in B[U]&&(B[U].mc.rs!=null?(B[U].mc.r=E,B[U].mc.c=U,l.merge[B[U].mc.r+"_"+B[U].mc.c]=B[U].mc,M[X.mc.r+"_"+X.mc.c]=[B[U].mc.r,B[U].mc.c]):B[U]={mc:{r:M[X.mc.r+"_"+X.mc.c][0],c:M[X.mc.r+"_"+X.mc.c][1]}})}F[E]=B}p.row=[x,_],p.column=[S,I],a&&(h.currentSheetIndex!=s?l=tn(F,x,_,l):(l=tn(F,u,f,l),l=tn(F,x,_,l)));let P,N;if(h.currentSheetIndex!=s){let E=$.extend(!0,[],h.luckysheetfile[$e(s)].data),B=$.extend(!0,{},h.luckysheetfile[$e(s)].config),U=$.extend(!0,[],E),X=$.extend(!0,{},B);X.merge==null&&(X.merge={});for(let pe=u;pe<=f;pe++)for(let K=m;K<=d;K++){let se=U[pe][K];V(se)=="object"&&"mc"in se&&("rs"in se.mc&&delete X.merge[se.mc.r+"_"+se.mc.c],delete se.mc),U[pe][K]=null}if(a&&(X=tn(U,u,f,X)),X.borderInfo&&X.borderInfo.length>0){let pe=[];for(let K=0;K<X.borderInfo.length;K++){let se=X.borderInfo[K].rangeType;if(se=="range"){let te=X.borderInfo[K].range,re=[];for(let fe=0;fe<te.length;fe++)re=re.concat(xt.CFSplitRange(te[fe],{row:[u,f],column:[m,d]},{row:[x,_],column:[S,I]},"restPart"));X.borderInfo[K].range=re,pe.push(X.borderInfo[K])}else if(se=="cell"){let te=X.borderInfo[K].value.row_index,re=X.borderInfo[K].value.col_index;te>=u&&te<=f&&re>=m&&re<=d||pe.push(X.borderInfo[K])}}X.borderInfo=pe}let le=$.extend(!0,[],h.luckysheetfile[$e(s)].luckysheet_conditionformat_save),he=$.extend(!0,[],le),Z=[];if(he!=null&&he.length>0)for(let pe=0;pe<he.length;pe++){let K=he[pe].cellrange,se=[],te=[];for(let re=0;re<K.length;re++){let fe=xt.CFSplitRange(K[re],{row:[u,f],column:[m,d]},{row:[x,_],column:[S,I]},"restPart");se=se.concat(fe);let Me=xt.CFSplitRange(K[re],{row:[u,f],column:[m,d]},{row:[x,_],column:[S,I]},"operatePart");Me.length>0&&(te=te.concat(Me))}if(he[pe].cellrange=se,te.length>0){let re=$.extend(!0,{},he[pe]);re.cellrange=te,Z.push(re)}}let ae=$.extend(!0,[],h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save),J=$.extend(!0,[],ae);Z.length>0&&(J=J.concat(Z));for(let pe=u;pe<=f;pe++)for(let K=m;K<=d;K++)delete z[pe+"_"+K];P={sheetIndex:s,data:E,curData:U,config:B,curConfig:X,cdformat:le,curCdformat:he,dataVerification:$.extend(!0,{},h.luckysheetfile[$e(s)].dataVerification),curDataVerification:z,range:{row:[u,f],column:[m,d]}},N={sheetIndex:h.currentSheetIndex,data:h.flowdata,curData:F,config:$.extend(!0,{},h.config),curConfig:l,cdformat:ae,curCdformat:J,dataVerification:$.extend(!0,{},h.luckysheetfile[$e(h.currentSheetIndex)].dataVerification),curDataVerification:A,range:{row:[x,_],column:[S,I]}}}else{let E=$.extend(!0,[],h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save),B=$.extend(!0,[],E);if(B!=null&&B.length>0)for(let U=0;U<B.length;U++){let X=B[U].cellrange,le=[];for(let he=0;he<X.length;he++){let Z=xt.CFSplitRange(X[he],{row:[u,f],column:[m,d]},{row:[x,_],column:[S,I]},"allPart");le=le.concat(Z)}B[U].cellrange=le}P={sheetIndex:h.currentSheetIndex,data:h.flowdata,curData:F,config:$.extend(!0,{},h.config),curConfig:l,cdformat:E,curCdformat:B,dataVerification:$.extend(!0,{},h.luckysheetfile[$e(h.currentSheetIndex)].dataVerification),curDataVerification:A,range:{row:[u,f],column:[m,d]}},N={sheetIndex:h.currentSheetIndex,data:h.flowdata,curData:F,config:$.extend(!0,{},h.config),curConfig:l,cdformat:E,curCdformat:B,dataVerification:$.extend(!0,{},h.luckysheetfile[$e(h.currentSheetIndex)].dataVerification),curDataVerification:A,range:{row:[x,_],column:[S,I]}}}w>0||C>0?Dc(P,N,!0):Dc(P,N,a)},pasteHandlerOfCopyPaste:function(e){if(!Wi(h.luckysheet_select_save,h.currentSheetIndex))return;let t=Oe().paste,l=$.extend(!0,{},h.config);l.merge==null&&(l.merge={});let o=e.HasMC,a=e.RowlChange,s=e.dataSheetIndex,u=e.copyRange[0].row[0],f=e.copyRange[0].row[1],m=e.copyRange[0].column[0],d=e.copyRange[0].column[1],g=[],b=!1;for(let J=0;J<e.copyRange.length;J++){let pe=Xl({row:e.copyRange[J].row,column:e.copyRange[J].column},s);e.copyRange.length>1?u==e.copyRange[1].row[0]&&f==e.copyRange[1].row[1]?(pe=pe[0].map(function(K,se){return pe.map(function(te){return te[se]})}),g=g.concat(pe),b=!0):m==e.copyRange[1].column[0]&&d==e.copyRange[1].column[1]&&(g=g.concat(pe)):g=pe}b&&(g=g[0].map(function(J,pe){return g.map(function(K){return K[pe]})}));let y=$.extend(!0,[],g);if(e.copyRange.length>1)for(let J=0;J<y.length;J++)for(let pe=0;pe<y[J].length;pe++)y[J][pe]!=null&&y[J][pe].f!=null&&(delete y[J][pe].f,delete y[J][pe].spl);let p=y.length,x=y[0].length,_=h.luckysheet_select_save[h.luckysheet_select_save.length-1],S=_.row[0],I=_.row[1],O=_.column[0],F=_.column[1],D=(I-S+1)%p,k=(F-O+1)%x;(D!=0||k!=0)&&(I=S+p-1,F=O+x-1);let w=!1;if(l.merge!=null&&(w=Ul(l,S,I,O,F)),w){Qe()?alert(t.errorNotAllowMerged):de.info(`<i class="fa fa-exclamation-triangle"></i>${t.warning}`,t.errorNotAllowMerged);return}let C=(I-S+1)/p,T=(F-O+1)/x,z=pt.deepCopyFlowData(h.flowdata),A=z.length,M=z[0].length,P=p+S-A,N=x+O-M;(P>0||N>0)&&(z=Hr([].concat(z),P,N,!0));let E=Mo(s),B=$.extend(!0,{},h.luckysheetfile[$e(s)].dataVerification),U=null,X=0,le=0,he=0,Z=0;for(let J=1;J<=C;J++)for(let pe=1;pe<=T;pe++){X=S+(J-1)*p,le=O+(pe-1)*x,Z=S+J*p,he=O+pe*x;let K=X-u,se=le-m,te={};for(let re=X;re<Z;re++){let fe=[].concat(z[re]);for(let Me=le;Me<he;Me++){if(E[u+re-X+"_"+(m+Me-le)]){let Ye={rangeType:"cell",value:{row_index:re,col_index:Me,l:E[u+re-X+"_"+(m+Me-le)].l,r:E[u+re-X+"_"+(m+Me-le)].r,t:E[u+re-X+"_"+(m+Me-le)].t,b:E[u+re-X+"_"+(m+Me-le)].b}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(Ye)}else if(E[re+"_"+Me]){let Ye={rangeType:"cell",value:{row_index:re,col_index:Me,l:null,r:null,t:null,b:null}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(Ye)}B[u+re-X+"_"+(m+Me-le)]&&(U==null&&(U=$.extend(!0,{},h.luckysheetfile[$e(h.currentSheetIndex)].dataVerification)),U[re+"_"+Me]=B[u+re-X+"_"+(m+Me-le)]),V(fe[Me])=="object"&&"mc"in fe[Me]&&("rs"in fe[Me].mc&&delete l.merge[fe[Me].mc.r+"_"+fe[Me].mc.c],delete fe[Me].mc);let ye=null;if(y[re-X]!=null&&y[re-X][Me-le]!=null&&(ye=$.extend(!0,{},y[re-X][Me-le])),ye!=null&&ye.f!=null){let Ye=ye.f;K>0&&(Ye="="+v.functionCopy(Ye,"down",K)),K<0&&(Ye="="+v.functionCopy(Ye,"up",Math.abs(K))),se>0&&(Ye="="+v.functionCopy(Ye,"right",se)),se<0&&(Ye="="+v.functionCopy(Ye,"left",Math.abs(se)));let Ce=v.execfunction(Ye,re,Me,void 0,!0);ye.spl!=null?(ye.f=Ce[2],ye.v=Ce[1],ye.spl=Ce[3].data):(ye.f=Ce[2],ye.v=Ce[1],ye.ct!=null&&ye.ct.fa!=null&&(ye.m=$l(ye.ct.fa,Ce[1])))}fe[Me]=$.extend(!0,{},ye),ye!=null&&o&&"mc"in fe[Me]&&(fe[Me].mc.rs!=null?(fe[Me].mc.r=re,fe[Me].mc.c=Me,l.merge[fe[Me].mc.r+"_"+fe[Me].mc.c]=fe[Me].mc,te[ye.mc.r+"_"+ye.mc.c]=[fe[Me].mc.r,fe[Me].mc.c]):fe[Me]={mc:{r:te[ye.mc.r+"_"+ye.mc.c][0],c:te[ye.mc.r+"_"+ye.mc.c][1]}})}z[re]=fe}}let ae=null;if(e.copyRange.length==1){let J=h.luckysheetfile[$e(s)],pe=h.luckysheetfile[$e(h.currentSheetIndex)],K=$.extend(!0,[],J.luckysheet_conditionformat_save);if(K!=null&&K.length>0){ae=$.extend(!0,[],pe.luckysheet_conditionformat_save);for(let se=0;se<K.length;se++){let te=K[se].cellrange,re=[];for(let fe=1;fe<=C;fe++)for(let Me=1;Me<=T;Me++){X=S+(fe-1)*p,le=O+(Me-1)*x,Z=S+fe*p,he=O+Me*x;for(let ye=0;ye<te.length;ye++){let Ye=xt.CFSplitRange(te[ye],{row:[u,f],column:[m,d]},{row:[X,Z-1],column:[le,he-1]},"operatePart");Ye.length>0&&(re=re.concat(Ye))}}re.length>0&&(K[se].cellrange=re,ae.push(K[se]))}}}if(_.row=[S,I],_.column=[O,F],a||P>0||N>0){l=tn(z,S,I,l);let J={cfg:l,RowlChange:!0,cdformat:ae,dataVerification:U};Gt(z,h.luckysheet_select_save,J)}else{let J={cfg:l,cdformat:ae,dataVerification:U};Gt(z,h.luckysheet_select_save,J),Zt()}},pasteHandlerOfPaintModel:function(e){if(!Wi(h.luckysheet_select_save,h.currentSheetIndex))return;let t=Oe().paste,l=$.extend(!0,{},h.config);l.merge==null&&(l.merge={});let o=e.HasMC,a=e.RowlChange,s=e.dataSheetIndex,u=e.copyRange[0].row[0],f=e.copyRange[0].row[1],m=e.copyRange[0].column[0],d=e.copyRange[0].column[1],g=$.extend(!0,[],Xl({row:[u,f],column:[m,d]},s)),b=h.luckysheet_select_save[h.luckysheet_select_save.length-1],y=b.row[0],p=b.row[1],x=b.column[0],_=b.column[1],S=g.length,I=g[0].length;if(y==p&&x==_){let U=!1;if(l.merge!=null&&(U=Ul(l,y,y+S-1,x,x+I-1)),U){Qe()?alert(t.errorNotAllowMerged):de.info(`<i class="fa fa-exclamation-triangle"></i>${t.warning}`,t.errorNotAllowMerged);return}p=y+S-1,_=x+I-1}let O=Math.ceil((p-y+1)/S),F=Math.ceil((_-x+1)/I),D=pt.deepCopyFlowData(h.flowdata),k=D[0].length,w=D.length,C=Mo(s),T=$.extend(!0,{},h.luckysheetfile[$e(s)].dataVerification),z=null,A=0,M=0,P=0,N=0;for(let U=1;U<=O;U++)for(let X=1;X<=F;X++){A=y+(U-1)*S,M=x+(X-1)*I,N=y+U*S>w?w:y+U*S,N>p+1&&(N=p+1),P=x+X*I>k?k:x+X*I,P>_+1&&(P=_+1);let le={};for(let he=A;he<N;he++){let Z=[].concat(D[he]);for(let ae=M;ae<P;ae++){if(C[u+he-A+"_"+(m+ae-M)]){let pe={rangeType:"cell",value:{row_index:he,col_index:ae,l:C[u+he-A+"_"+(m+ae-M)].l,r:C[u+he-A+"_"+(m+ae-M)].r,t:C[u+he-A+"_"+(m+ae-M)].t,b:C[u+he-A+"_"+(m+ae-M)].b}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(pe)}else if(C[he+"_"+ae]){let pe={rangeType:"cell",value:{row_index:he,col_index:ae,l:null,r:null,t:null,b:null}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(pe)}T[u+he-A+"_"+(m+ae-M)]&&(z==null&&(z=$.extend(!0,{},h.luckysheetfile[$e(h.currentSheetIndex)].dataVerification)),z[he+"_"+ae]=T[u+he-A+"_"+(m+ae-M)]),V(Z[ae])=="object"&&"mc"in Z[ae]&&("rs"in Z[ae].mc&&delete l.merge[Z[ae].mc.r+"_"+Z[ae].mc.c],delete Z[ae].mc);let J=null;if(g[he-A]!=null&&g[he-A][ae-M]!=null&&(J=g[he-A][ae-M]),J!=null&&(delete J.v,delete J.m,delete J.f,delete J.spl,J.ct&&J.ct.t=="inlineStr"&&delete J.ct,V(Z[ae])=="object"?Z[ae].ct&&Z[ae].ct.t==="inlineStr"?delete J.ct:["bg","fc","ct","ht","vt","bl","it","cl","un","fs","ff","tb"].forEach(K=>{Reflect.deleteProperty(Z[ae],K)}):Z[ae]={v:Z[ae]},Z[ae]=$.extend(!0,Z[ae],J),Z[ae].ct&&Z[ae].ct.t==="inlineStr"&&Z[ae].ct.s.forEach(pe=>pe=$.extend(!0,pe,J)),o&&"mc"in Z[ae]&&(Z[ae].mc.rs!=null?(Z[ae].mc.r=he,Z[ae].mc.rs+he>=N&&(Z[ae].mc.rs=N-he),Z[ae].mc.c=ae,Z[ae].mc.cs+ae>=P&&(Z[ae].mc.cs=P-ae),l.merge[Z[ae].mc.r+"_"+Z[ae].mc.c]=Z[ae].mc,le[J.mc.r+"_"+J.mc.c]=[Z[ae].mc.r,Z[ae].mc.c]):Z[ae]={mc:{r:le[J.mc.r+"_"+J.mc.c][0],c:le[J.mc.r+"_"+J.mc.c][1]}}),Z[ae].v!=null&&J.ct!=null&&J.ct.fa!=null)){let pe=$l(J.ct.fa,Z[ae].v);Z[ae].m=pe}}D[he]=Z}}let E=null,B=$.extend(!0,[],h.luckysheetfile[$e(s)].luckysheet_conditionformat_save);if(B!=null&&B.length>0){E=$.extend(!0,[],h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save);for(let U=0;U<B.length;U++){let X=B[U].cellrange,le=[];for(let he=0;he<X.length;he++){let Z=xt.CFSplitRange(X[he],{row:[u,f],column:[m,d]},{row:[y,p],column:[x,_]},"operatePart");Z.length>0&&(le=le.concat(Z))}le.length>0&&(B[U].cellrange=[{row:[y,p],column:[x,_]}],E.push(B[U]))}}if(b.row=[y,p],b.column=[x,_],a){l=tn(D,y,p,l);let U={cfg:l,RowlChange:!0,cdformat:E,dataVerification:z};Gt(D,h.luckysheet_select_save,U)}else{p>=D.length&&(p=D.length-1),l=tn(D,y,p,l);let U={cfg:l,RowlChange:!0,cdformat:E,dataVerification:z};Gt(D,h.luckysheet_select_save,U),Zt()}},matchcopy:function(e,n){let t=[],l=[],o,a;if(typeof e=="object")t=e;else{t=e.split(`
`);for(let s=0;s<t.length;s++)t[s]=t[s].split("	")}if(o=t.length,typeof n=="object")l=n;else{l=n.split(`
`);for(let s=0;s<l.length;s++)l[s]=l[s].split("	")}if(a=l.length,o!=a)return!1;for(let s=0;s<o;s++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[s]!=null)){for(let u=0;u<a;u++)if(t[s].length!=l[u].length)return!1}for(let s=0;s<o;s++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[s]!=null)){for(let u=0;u<t[0].length;u++)if(Mt(s,u,t)!=Mt(s,u,l))return!1}return!0}},Ol=o3});function Ir(e){$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cell-selected-boxs .luckysheet-cell-selected").hide(),$("#luckysheet-cols-h-selected .luckysheet-cols-h-selected").hide(),$("#luckysheet-rows-h-selected .luckysheet-rows-h-selected").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),e||Ol.clearcopy(e),$("#luckysheet-dropCell-icon").is(":visible")&&e&&$("#luckysheet-dropCell-icon").remove(),ht.luckysheetPaintModelOn&&!e&&ht.cancelPaintModel()}var import_plugin,Io=Tt(()=>{import_plugin=Le(Be());Ac();Mr()});function eg(e,n,t,l,o){let a=i0();a=yt(a,{logotitle:o}),a=yt(a,{menu:w0()});let s=o0;h.config==null&&(h.config={}),ya(n,e);let f=Oe().info,m='<button id="luckysheet-bottom-add-row" class="btn btn-default">'+f.add+'</button><input id="luckysheet-bottom-add-row-input" type="text" class="luckysheet-datavisual-config-input luckysheet-mousedown-cancel" placeholder="'+(lt.addRowCount||100)+'"><span style="font-size: 14px;">'+f.row+'</span><span style="font-size: 14px;color: #9c9c9c;">('+f.addLast+")</span>",d=' <button id="luckysheet-bottom-bottom-top" class="btn btn-default" style="">'+f.backTop+"</button>",g=yt(f.pageInfo,{total:lt.total?lt.total:"",totalPage:lt.pageInfo.totalPage?lt.pageInfo.totalPage:"",currentPage:lt.pageInfo.currentPage?lt.pageInfo.currentPage:""}),b=' <span id="luckysheet-bottom-page-info" style="font-size: 14px;color: #f34141;">'+g+'</span> <button id="luckysheet-bottom-page-next" class="btn btn-danger" style="">\u4E0B\u4E00\u9875</button>',y=' <span id="luckysheet-bottom-page-info" style="font-size: 14px;color: #f34141;">'+g+"</span>",p="";lt.enableAddRow&&(p+=m),lt.enablePage&&(parseInt(lt.pageInfo.totalPage)==1?p+=y:p+=b),lt.enableAddBackTop&&(p+=d);let x=yt('<div id="luckysheetcoltable_0" class="luckysheet-cell-flow-col"> <div id ="luckysheet-sheettable_0" class="luckysheet-cell-sheettable" style="height:${height}px;width:${width}px;"></div><div id="luckysheet-bottom-controll-row" class="luckysheet-bottom-controll-row"> '+p+" </div> </div>",{height:h.rh_height,width:h.ch_width-1}),_=yt(f0,{width:h.ch_width,index:0,column:""});s=yt(s,{width:h.ch_width,flow:x,index:0}),a=yt(a,{flow:s,rowHeader:"<div style='height:"+h.rh_height+"px' id='luckysheetrowHeader_0' class='luckysheetsheetchange'></div>",columnHeader:_,functionButton:lt.functionButton}),$("#"+h.container).append(a),$("#luckysheet-scrollbar-x div").width(h.ch_width),$("#luckysheet-scrollbar-y div").height(h.rh_height+h.columnHeaderHeight-h.cellMainSrollBarSize-3),$("body").first().append(g0),$("body").first().append(a0),$("body").first().append(s0()),$("body").first().append(m0),$("body").first().append(yt(Hf(),{menuid:"filter"})),$("body").first().append(yt(Bf(),{menuid:"filter"})),$("body").first().append(p0()),$("#luckysheet-rows-h").width(h.rowHeaderWidth-1.5),$("#luckysheet-cols-h-c").height(h.columnHeaderHeight-1.5),$("#luckysheet-left-top").css({width:h.rowHeaderWidth-1.5,height:h.columnHeaderHeight-1.5}),$("#luckysheet_info_detail_input").val(lt.title)}var import_plugin,s1=Tt(()=>{import_plugin=Le(Be());ar();bn();Fo();mr();br();zu();gl();Ut();Rl()});function c1(e){e==null&&(e="chart");for(var n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="",l=0;l<12;l++)t+=n[Math.round(Math.random()*(n.length-1))];var o=new Date().getTime();return e+"_"+t+"_"+o}function tg(e,n){return e.replace(/\$\{([\w]+)\}/g,function(t,l){var o=n[l];return typeof o!="undefined"?o:t})}var import_plugin,u1=Tt(()=>{import_plugin=Le(Be())});var import_plugin,Ui,Ca,a3,j,Vu=Tt(()=>{import_plugin=Le(Be());gl();Gl();Hn();ir();Ui=Le(ka()),Ca={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},a3={getCellDataArr:function(e,n,t){let l=[];if(e.data==null)t||(n==="number"?l.push(0):n==="text"&&l.push(""));else if(V(e.data)==="array")for(let o=0;o<e.data.length;o++)for(let a=0;a<e.data[o].length;a++){let s=e.data[o][a],u=s;V(s)==="object"&&(u=s.v),u==null?t||(n==="number"?u=0:n==="text"&&(u=""),l.push(u)):l.push(u)}else rt(e.data.v)?t||(n=="number"?l.push(0):n=="text"&&l.push("")):l.push(e.data.v);return l},getCellDataDyadicArr:function(e,n){let t=[];if(e.data==null){let l=[];n=="number"?l.push(0):n=="text"&&l.push(""),t.push(l)}else if(V(e.data)=="array")for(let l=0;l<e.data.length;l++){let o=[];for(let a=0;a<e.data[l].length;a++){let s=e.data[l][a],u=s;V(s)==="object"&&(u=s.v),u==null&&(n==="number"?u=0:n==="text"&&(u="")),o.push(u)}t.push(o)}else{let l=[],o=e.data.v;rt(o)&&(n=="number"?o=0:n=="text"&&(o="")),l.push(o),t.push(l)}return t},getDataArr:function(e,n){let t=[];if(n==null&&(n=!1),V(e[0])=="array")for(let l=0;l<e.length;l++)for(let o=0;o<e[l].length;o++)n&&!Y(e[l][o])||t.push(e[l][o]);else for(let l=0;l<e.length;l++)n&&!Y(e[l])||t.push(e[l]);return t},getDataDyadicArr:function(e){let n=[];if(V(e[0])=="array")for(let t=0;t<e.length;t++){let l=[];for(let o=0;o<e[t].length;o++)l.push(e[t][o]);n.push(l)}else{let t=[];for(let l=0;l<e.length;l++)t.push(e[l]);n.push(t)}return n},isDyadicArr:function(e){let n=!0;if(e.length>1){let t=e[0].length;for(let l=1;l<e.length;l++)if(e[l].length!=t){n=!1;break}}return n},getFirstValue:function(e,n){let t=this;n==null&&(n="number");let l;if(V(e)=="array")if(V(e[0])=="array"){if(!t.isDyadicArr(e))return Ca.v;l=e[0][0]}else l=e[0];else if(V(e)=="object"&&e.startCell!=null)if(e.data==null)n=="number"?l=0:n=="text"&&(l="");else{let o=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn;if(e.rowl==1&&e.coll==1)l=e.data,l==null||rt(l.v)?n=="number"?l=0:n=="text"&&(l=""):l=l.v;else if(e.data[0][0].mc!=null&&e.data[0][0].mc.rs==e.rowl&&e.data[0][0].mc.cs==e.coll)l=e.data[0][0],l==null||rt(l.v)?n=="number"?l=0:n=="text"&&(l=""):l=l.v;else if(e.rowl==1||e.coll==1){let s=v.getcellrange(e.startCell),u=s.row[0],f=u+e.rowl-1,m=s.column[0],d=m+e.coll-1;if(e.rowl==1){if(a<m||a>d)return Ca.v;l=e.data[0][a-m]}else if(e.coll==1){if(o<u||o>f)return Ca.v;l=e.data[o-u][0]}l==null||rt(l.v)||l.mc!=null?n=="number"?l=0:n=="text"&&(l=""):l=l.v}else return Ca.v}else l=e;return l},getCellBoolen:function(e){let t=this.getFirstValue(e);if(q(t))return t;if(V(t)!="boolean")if(V(t)=="string"&&(t.toLowerCase()=="true"||t.toLowerCase()=="false"))t.toLowerCase()=="true"?t=!0:t.toLowerCase()=="false"&&(t=!1);else if(Y(t))t=parseFloat(t),t=t!=0;else return Ca.v;return t},getCellDate:function(e){let n=this,t;if(V(e)=="array")if(V(e[0])=="array"){if(!n.isDyadicArr(e))return Ca.v;t=e[0][0]}else t=e[0];else if(V(e)=="object"&&e.startCell!=null){if(e.data==null||V(e.data)=="array"||rt(e.data.v))return Ca.v;t=e.data.v,e.data.ct!=null&&e.data.ct.t=="d"&&(t=$l("YYYY-MM-DD h:mm:ss",t))}else t=e;return t},getCellrangeDate:function(e){let n=this,t=[];if(V(e)=="array"){if(V(e[0])=="array"&&!n.isDyadicArr(e))return Ca.v;t=t.concat(n.getDataArr(e,!1))}else if(V(e)=="object"&&e.startCell!=null)if(e.data==null)t.push(0);else if(V(e.data)=="array")for(let l=0;l<e.data.length;l++)for(let o=0;o<e.data[l].length;o++)if(e.data[l][o]!=null&&!rt(e.data[l][o].v)){let a=e.data[l][o].v;e.data[l][o].ct!=null&&e.data[l][o].ct.t=="d"&&(a=$l("YYYY-MM-DD h:mm:ss",a)),t.push(a)}else t.push(0);else{let l=e.data.v;e.data.ct!=null&&e.data.ct.t=="d"&&(l=$l("YYYY-MM-DD h:mm:ss",l)),t.push(l)}else t.push(e);return t},getRegExpStr:function(e){return e.replace("~*","\\*").replace("~?","\\?").replace(".","\\.").replace("*",".*").replace("?",".")},factorial:function(e){return e==0||e==1?1:e*this.factorial(e-1)},factorialDouble:function(e){return e<=0?1:e*this.factorialDouble(e-2)},variance:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return o/t},variance_s:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return o/(t-1)},standardDeviation:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return Math.sqrt(o/t)},standardDeviation_s:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return Math.sqrt(o/(t-1))},isLeapYear:function(e){return new Date(e,1,29).getMonth()===1},feb29Between:function(e,n){let t=this,l=(0,Ui.default)(e).year(),o=(0,Ui.default)().set({year:l,month:2,date:1});if(t.isLeapYear(l)&&(0,Ui.default)(e)<(0,Ui.default)(o)&&(0,Ui.default)(n)>=(0,Ui.default)(o))return!0;let a=(0,Ui.default)(n).year(),s=(0,Ui.default)().set({year:a,month:2,date:1});return t.isLeapYear(a)&&(0,Ui.default)(n)>=(0,Ui.default)(s)&&(0,Ui.default)(e)<(0,Ui.default)(s)},findResultIndex:function(e,n){let t={};for(let a=1;a<e[0].length;++a)t[a]=!0;let l=n[0].length;for(i=1;i<n.length;++i)n[i].length>l&&(l=n[i].length);for(let a=1;a<e.length;++a)for(let s=1;s<e[a].length;++s){let u=!1,f=!1;for(let m=0;m<n.length;++m){let d=n[m];if(d.length<l)continue;let g=d[0];if(e[a][0]===g){f=!0;for(let b=1;b<d.length;++b)u=u||new Function("return "+e[a][s]+d[b])()}}f&&(t[s]=t[s]&&u)}let o=[];for(let a=0;a<e[0].length;++a)t[a]&&o.push(a-1);return o},findField:function(e,n){let t=null;for(let l=0;l<e.length;l++)if(e[l][0]==n){t=l;break}return t??Ca.v},rest:function(e,n){return n=n||1,!e||typeof e.slice!="function"?e:e.slice(n)},compact:function(e){if(!e)return e;let n=[];for(let t=0;t<e.length;++t)!e[t]||n.push(e[t]);return n}},j=a3});function kh(e){var n=f1.sylvester_matrix.create(e);return n.inverse().elements}var import_plugin,f1,s3,lg=Tt(()=>{import_plugin=Le(Be()),f1={},s3=function(n){var t=function(){};t.precision=1e-6,t.create=function(o){var a=new t;return a.setElements(o)};var l=t.create;t.I=function(o){for(var a=[],s=o,u;s--;)for(u=o,a[s]=[];u--;)a[s][u]=s===u?1:0;return t.create(a)},t.prototype={e:function(o,a){return o<1||o>this.elements.length||a<1||a>this.elements[0].length?null:this.elements[o-1][a-1]},dimensions:function(){var o=this.elements.length===0?0:this.elements[0].length;return{rows:this.elements.length,cols:o}},rows:function(){return this.elements.length},cols:function(){return this.elements.length===0?0:this.elements[0].length},eql:function(o){var a=o.elements||o;if((!a[0]||typeof a[0][0]=="undefined")&&(a=t.create(a).elements),this.elements.length===0||a.length===0)return this.elements.length===a.length;if(this.elements.length!==a.length||this.elements[0].length!==a[0].length)return!1;for(var s=this.elements.length,u=this.elements[0].length,f;s--;)for(f=u;f--;)if(Math.abs(this.elements[s][f]-a[s][f])>t.precision)return!1;return!0},dup:function(){return t.create(this.elements)},map:function(o,a){if(this.elements.length===0)return t.create([]);for(var s=[],u=this.elements.length,f=this.elements[0].length,m;u--;)for(m=f,s[u]=[];m--;)s[u][m]=o.call(a,this.elements[u][m],u+1,m+1);return t.create(s)},isSameSizeAs:function(o){var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.elements.length===0?a.length===0:this.elements.length===a.length&&this.elements[0].length===a[0].length},add:function(o){if(this.elements.length===0)return this.map(function(s){return s});var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.isSameSizeAs(a)?this.map(function(s,u,f){return s+a[u-1][f-1]}):null},subtract:function(o){if(this.elements.length===0)return this.map(function(s){return s});var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.isSameSizeAs(a)?this.map(function(s,u,f){return s-a[u-1][f-1]}):null},canMultiplyFromLeft:function(o){if(this.elements.length===0)return!1;var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.elements[0].length===a.length},multiply:function(o){if(this.elements.length===0)return null;if(!o.elements)return this.map(function(p){return p*o});var a=!!o.modulus,s=o.elements||o;if(typeof s[0][0]=="undefined"&&(s=t.create(s).elements),!this.canMultiplyFromLeft(s))return null;for(var u=this.elements.length,f=s[0].length,m,d=this.elements[0].length,g,b=[],y;u--;)for(m=f,b[u]=[];m--;){for(g=d,y=0;g--;)y+=this.elements[u][g]*s[g][m];b[u][m]=y}var s=t.create(b);return a?s.col(1):s},minor:function(o,a,s,u){if(this.elements.length===0)return null;for(var f=[],m=s,d,g,b,y=this.elements.length,p=this.elements[0].length;m--;)for(d=s-m-1,f[d]=[],g=u;g--;)b=u-g-1,f[d][b]=this.elements[(o+d-1)%y][(a+b-1)%p];return t.create(f)},transpose:function(){if(this.elements.length===0)return t.create([]);for(var o=this.elements.length,a,s=this.elements[0].length,u,f=[],a=s;a--;)for(u=o,f[a]=[];u--;)f[a][u]=this.elements[u][a];return t.create(f)},isSquare:function(){var o=this.elements.length===0?0:this.elements[0].length;return this.elements.length===o},max:function(){if(this.elements.length===0)return null;for(var o=0,a=this.elements.length,s=this.elements[0].length,u;a--;)for(u=s;u--;)Math.abs(this.elements[a][u])>Math.abs(o)&&(o=this.elements[a][u]);return o},indexOf:function(o){if(this.elements.length===0)return null;var a=null,s=this.elements.length,u,f=this.elements[0].length,m;for(u=0;u<s;u++)for(m=0;m<f;m++)if(this.elements[u][m]===o)return{i:u+1,j:m+1};return null},diagonal:function(){if(!this.isSquare)return null;for(var o=[],a=this.elements.length,s=0;s<a;s++)o.push(this.elements[s][s]);return t.create(o)},toRightTriangular:function(){if(this.elements.length===0)return t.create([]);var o=this.dup(),a,s=this.elements.length,u,f,m=this.elements[0].length,d;for(u=0;u<s;u++){if(o.elements[u][u]===0){for(f=u+1;f<s;f++)if(o.elements[f][u]!==0){for(a=[],d=0;d<m;d++)a.push(o.elements[u][d]+o.elements[f][d]);o.elements[u]=a;break}}if(o.elements[u][u]!==0)for(f=u+1;f<s;f++){var g=o.elements[f][u]/o.elements[u][u];for(a=[],d=0;d<m;d++)a.push(d<=u?0:o.elements[f][d]-o.elements[u][d]*g);o.elements[f]=a}}return o},determinant:function(){if(this.elements.length===0)return 1;if(!this.isSquare())return null;for(var o=this.toRightTriangular(),a=o.elements[0][0],s=o.elements.length,u=1;u<s;u++)a=a*o.elements[u][u];return a},isSingular:function(){return this.isSquare()&&this.determinant()===0},trace:function(){if(this.elements.length===0)return 0;if(!this.isSquare())return null;for(var o=this.elements[0][0],a=this.elements.length,s=1;s<a;s++)o+=this.elements[s][s];return o},rank:function(){if(this.elements.length===0)return 0;for(var o=this.toRightTriangular(),a=0,s=this.elements.length,u=this.elements[0].length,f;s--;)for(f=u;f--;)if(Math.abs(o.elements[s][f])>t.precision){a++;break}return a},augment:function(o){if(this.elements.length===0)return this.dup();var a=o.elements||o;typeof a[0][0]=="undefined"&&(a=t.create(a).elements);var s=this.dup(),u=s.elements[0].length,f=s.elements.length,m=a[0].length,d;if(f!==a.length)return null;for(;f--;)for(d=m;d--;)s.elements[f][u+d]=a[f][d];return s},inverse:function(){if(this.elements.length===0||!this.isSquare()||this.isSingular())return null;for(var o=this.elements.length,a=o,s,u=this.augment(t.I(o)).toRightTriangular(),f=u.elements[0].length,m,d,g,b=[],y;a--;){for(d=[],b[a]=[],g=u.elements[a][a],m=0;m<f;m++)y=u.elements[a][m]/g,d.push(y),m>=o&&b[a].push(y);for(u.elements[a]=d,s=a;s--;){for(d=[],m=0;m<f;m++)d.push(u.elements[s][m]-u.elements[a][m]*u.elements[s][a]);u.elements[s]=d}}return t.create(b)},round:function(){return this.map(function(o){return Math.round(o)})},snapTo:function(o){return this.map(function(a){return Math.abs(a-o)<=t.precision?o:a})},setElements:function(o){var a,s,u=o.elements||o;if(u[0]&&typeof u[0][0]!="undefined"){for(a=u.length,this.elements=[];a--;)for(s=u[a].length,this.elements[a]=[];s--;)this.elements[a][s]=u[a][s];return this}var f=u.length;for(this.elements=[],a=0;a<f;a++)this.elements.push([u[a]]);return this}},n.sylvester_matrix=t};s3(f1)});function zc(){let e=arguments[1],n=arguments[0],t;V(n)=="object"&&n.startCell!=null?(e=="&"?t=j.getCellDataDyadicArr(n,"text"):t=j.getCellDataDyadicArr(n,"number"),t.length==1&&t[0].length==1&&(t=t[0][0])):t=n;let l=arguments[2],o;if(V(l)=="object"&&l.startCell!=null?(e=="&"?o=j.getCellDataDyadicArr(l,"text"):o=j.getCellDataDyadicArr(l,"number"),o.length==1&&o[0].length==1&&(o=o[0][0])):o=l,q(t))return t;if(q(o))return o;if(V(t)=="array"&&V(t[0])=="array"&&!j.isDyadicArr(t))return It.v;if(V(o)=="array"&&V(o[0])=="array"&&!j.isDyadicArr(o))return It.v;if(e=="<>"&&(e="!="),e=="="&&(e="=="),t==null&&o==null)return"#INVERSE!";if(t=="#INVERSE!")t=0,e=="-"?e="+":e=="+"&&(e="-");else if(e=="-"&&t==null)t=0;else if(e=="/"&&(o==0||o==null))return It.d;function a(u,f,m){if(Y(u)&&(u=parseFloat(u)),Y(m)&&(m=parseFloat(m)),f=="==")return u==m;if(f=="!=")return u!=m;if(f==">=")return u>=m;if(f=="<=")return u<=m;if(f==">")return u>m;if(f=="<")return u<m}function s(u){return u==null?u:u.toString().toLowerCase()=="true"?1:u.toString().toLowerCase()=="false"?0:u}if(e=="*")if(V(t)=="array"&&V(o)=="array"){let u=[];if(V(t[0])=="array"&&V(o[0])=="array")if(t.length==o.length&&t[0].length==o[0].length)for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[f][d]=s(o[f][d]);let g;Y(t[f][d])&&Y(o[f][d])?g=Pl(t[f][d],e,o[f][d]):g=It.v,m.push(g)}u.push(m)}else if(t[0].length==o.length){let f=t.length,m=o[0].length;for(let d=0;d<f;d++){let g=[];for(let b=0;b<m;b++){let y=0;for(let p=0;p<t[0].length;p++)t[d][p]=s(t[d][p]),o[p][b]=s(o[p][b]),Y(t[d][p])&&Y(o[p][b])?y+=Pl(t[d][p],e,o[p][b]):y+=It.v;y.toString()=="NaN"&&(y=It.v),g.push(y)}u.push(g)}}else if(t.length==o[0].length){let f=o.length,m=t[0].length;for(let d=0;d<f;d++){let g=[];for(let b=0;b<m;b++){let y=0;for(let p=0;p<o[0].length;p++)t[p][b]=s(t[p][b]),o[d][p]=s(o[d][p]),Y(o[d][p])&&Y(t[p][b])?y+=Pl(t[p][b],e,o[d][p]):y+=It.v;y.toString()=="NaN"&&(y=It.v),g.push(y)}u.push(g)}}else return It.na;else if(V(t[0])=="array")if(t[0].length==o.length)for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[d]=s(o[d]);let g;Y(t[f][d])&&Y(o[d])?g=Pl(t[f][d],e,o[d]):g=It.v,m.push(g)}u.push(m)}else if(t[0].length==1){let f=t.length,m=o.length;for(let d=0;d<f;d++){let g=[];for(let b=0;b<m;b++){t[d][0]=s(t[d][0]),o[b]=s(o[b]);let y;Y(t[d][0])&&Y(o[b])?y=Pl(t[d][0],e,o[b]):y=It.v,g.push(y)}u.push(g)}}else return It.na;else if(V(o[0])=="array")if(o[0].length==t.length)for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){t[d]=s(t[d]),o[f][d]=s(o[f][d]);let g;Y(t[d])&&Y(o[f][d])?g=Pl(t[d],e,o[f][d]):g=It.v,m.push(g)}u.push(m)}else if(o[0].length==1){let f=o.length,m=t.length;for(let d=0;d<f;d++){let g=[];for(let b=0;b<m;b++){t[b]=s(t[b]),o[d][0]=s(o[d][0]);let y;Y(t[b])&&Y(o[d][0])?y=Pl(t[b],e,o[d][0]):y=It.v,g.push(y)}u.push(g)}}else return It.na;else{if(t.length!=o.length)return It.na;for(let f=0;f<t.length;f++){t[f]=s(t[f]),o[f]=s(o[f]);let m;Y(t[f])&&Y(o[f])?m=Pl(t[f],e,o[f]):m=It.v,u.push(m)}}return u}else if(V(t)=="array"){o=s(o);let u=[];if(V(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]);let g;Y(t[f][d])&&Y(o)?g=Pl(t[f][d],e,o):g=It.v,m.push(g)}u.push(m)}else for(let f=0;f<t.length;f++){t[f]=s(t[f]);let m;Y(t[f])&&Y(o)?m=Pl(t[f],e,o):m=It.v,u.push(m)}return u}else if(V(o)=="array"){t=s(t);let u=[];if(V(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){o[f][d]=s(o[f][d]);let g;Y(t)&&Y(o[f][d])?g=Pl(t,e,o[f][d]):g=It.v,m.push(g)}u.push(m)}else for(let f=0;f<o.length;f++){o[f]=s(o[f]);let m;Y(t)&&Y(o[f])?m=Pl(t,e,o[f]):m=It.v,u.push(m)}return u}else{t=s(t),o=s(o);let u;return Y(t)&&Y(o)?u=Pl(t,e,o):u=It.v,u}else if(e=="/")if(V(t)=="array"&&V(o)=="array"){let u=[];if(V(t[0])=="array"&&V(o[0])=="array")if(t.length==o.length&&t[0].length==o[0].length)for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[f][d]=s(o[f][d]);let g;Y(t[f][d])&&Y(o[f][d])?parseFloat(o[f][d])==0?g=It.d:g=Pl(t[f][d],e,o[f][d]):g=It.v,m.push(g)}u.push(m)}else if(t[0].length==o.length){let f=kh(o),m=t.length,d=f[0].length;for(let g=0;g<m;g++){let b=[];for(let y=0;y<d;y++){let p=0;for(let x=0;x<t[0].length;x++)t[g][x]=s(t[g][x]),f[x][y]=s(f[x][y]),Y(t[g][x])&&Y(f[x][y])?p+=Pl(t[g][x],"*",f[x][y]):p+=It.v;p.toString()=="NaN"&&(p=It.v),b.push(p)}u.push(b)}}else return It.na;else if(V(t[0])=="array")if(t[0].length==o.length)for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[d]=s(o[d]);let g;Y(t[f][d])&&Y(o[d])?parseFloat(o[d])==0?g=It.d:g=Pl(t[f][d],e,o[d]):g=It.v,m.push(g)}u.push(m)}else if(t[0].length==1){let f=t.length,m=o.length;for(let d=0;d<f;d++){let g=[];for(let b=0;b<m;b++){t[d][0]=s(t[d][0]),o[b]=s(o[b]);let y;Y(t[d][0])&&Y(o[b])?parseFloat(o[b])==0?y=It.d:y=Pl(t[d][0],e,o[b]):y=It.v,g.push(y)}u.push(g)}}else return It.na;else if(V(o[0])=="array")if(o[0].length==t.length)for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){t[d]=s(t[d]),o[f][d]=s(o[f][d]);let g;Y(t[d])&&Y(o[f][d])?parseFloat(o[f][d])==0?g=It.d:g=Pl(t[d],e,o[f][d]):g=It.v,m.push(g)}u.push(m)}else if(o[0].length==1){let f=o.length,m=t.length;for(let d=0;d<f;d++){let g=[];for(let b=0;b<m;b++){t[b]=s(t[b]),o[d][0]=s(o[d][0]);let y;Y(t[b])&&Y(o[d][0])?parseFloat(o[d][0])==0?y=It.d:y=Pl(t[b],e,o[d][0]):y=It.v,g.push(y)}u.push(g)}}else return It.na;else{if(t.length!=o.length)return It.na;for(let f=0;f<t.length;f++){t[f]=s(t[f]),o[f]=s(o[f]);let m;Y(t[f])&&Y(o[f])?parseFloat(o[f])==0?m=It.d:m=Pl(t[f],e,o[f]):m=It.v,u.push(m)}}return u}else if(V(t)=="array"){o=s(o);let u=[];if(V(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]);let g;Y(t[f][d])&&Y(o)?parseFloat(o)==0?g=It.d:g=Pl(t[f][d],e,o):g=It.v,m.push(g)}u.push(m)}else for(let f=0;f<t.length;f++){t[f]=s(t[f]);let m;Y(t[f])&&Y(o)?parseFloat(o)==0?m=It.d:m=Pl(t[f],e,o):m=It.v,u.push(m)}return u}else if(V(o)=="array"){t=s(t);let u=[];if(V(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){o[f][d]=s(o[f][d]);let g;Y(t)&&Y(o[f][d])?parseFloat(o[f][d])==0?g=It.d:g=Pl(t,e,o[f][d]):g=It.v,m.push(g)}u.push(m)}else for(let f=0;f<o.length;f++){o[f]=s(o[f]);let m;Y(t)&&Y(o[f])?parseFloat(o[f])==0?m=It.d:m=Pl(t,e,o[f]):m=It.v,u.push(m)}return u}else{t=s(t),o=s(o);let u;return Y(t)&&Y(o)?parseFloat(o)==0?u=It.d:u=Pl(t,e,o):u=It.v,u}else if(e=="+"||e=="-"||e=="%")if(V(t)=="array"&&V(o)=="array"){let u=[];if(V(t[0])=="array"&&V(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return It.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[f][d]=s(o[f][d]);let g;Y(t[f][d])&&Y(o[f][d])?e=="%"&&parseFloat(o[f][d])==0?g=It.d:g=Pl(t[f][d],e,o[f][d]):g=It.v,m.push(g)}u.push(m)}}else if(V(t[0])=="array"){if(t[0].length!=o.length)return It.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[d]=s(o[d]);let g;Y(t[f][d])&&Y(o[d])?e=="%"&&parseFloat(o[d])==0?g=It.d:g=Pl(t[f][d],e,o[d]):g=It.v,m.push(g)}u.push(m)}}else if(V(o[0])=="array"){if(o[0].length!=t.length)return It.na;for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){t[d]=s(t[d]),o[f][d]=s(o[f][d]);let g;Y(t[d])&&Y(o[f][d])?e=="%"&&parseFloat(o[f][d])==0?g=It.d:g=Pl(t[d],e,o[f][d]):g=It.v,m.push(g)}u.push(m)}}else{if(t.length!=o.length)return It.na;for(let f=0;f<t.length;f++){t[f]=s(t[f]),o[f]=s(o[f]);let m;Y(t[f])&&Y(o[f])?e=="%"&&parseFloat(o[f])==0?m=It.d:m=Pl(t[f],e,o[f]):m=It.v,u.push(m)}}return u}else if(V(t)=="array"){o=s(o);let u=[];if(V(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]);let g;Y(t[f][d])&&Y(o)?e=="%"&&parseFloat(o)==0?g=It.d:g=Pl(t[f][d],e,o):g=It.v,m.push(g)}u.push(m)}else for(let f=0;f<t.length;f++){t[f]=s(t[f]);let m;Y(t[f])&&Y(o)?e=="%"&&parseFloat(o)==0?m=It.d:m=Pl(t[f],e,o):m=It.v,u.push(m)}return u}else if(V(o)=="array"){t=s(t);let u=[];if(V(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){o[f][d]=s(o[f][d]);let g;Y(t)&&Y(o[f][d])?e=="%"&&parseFloat(o[f][d])==0?g=It.d:g=Pl(t,e,o[f][d]):g=It.v,m.push(g)}u.push(m)}else for(let f=0;f<o.length;f++){o[f]=s(o[f]);let m;Y(t)&&Y(o[f])?e=="%"&&parseFloat(o[f])==0?m=It.d:m=Pl(t,e,o[f]):m=It.v,u.push(m)}return u}else{t=s(t),o=s(o);let u;return Y(t)&&Y(o)?e=="%"&&parseFloat(o)==0?u=It.d:u=Pl(t,e,o):u=It.v,u}else if(e=="=="||e=="!="||e==">="||e=="<="||e==">"||e=="<")if(V(t)=="array"&&V(o)=="array"){let u=[];if(V(t[0])=="array"&&V(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return It.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){let g=a(t[f][d],e,o[f][d]);m.push(g)}u.push(m)}}else if(V(t[0])=="array"){if(t[0].length!=o.length)return It.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){let g=a(t[f][d],e,o[d]);m.push(g)}u.push(m)}}else if(V(o[0])=="array"){if(o[0].length!=t.length)return It.na;for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){let g=a(t[d],e,o[f][d]);m.push(g)}u.push(m)}}else{if(t.length!=o.length)return It.na;for(let f=0;f<t.length;f++){let m=a(t[f],e,o[f]);u.push(m)}}return u}else if(V(t)=="array"){let u=[];if(V(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){let g=a(t[f][d],e,o);m.push(g)}u.push(m)}else for(let f=0;f<t.length;f++){let m=a(t[f],e,o);u.push(m)}return u}else if(V(o)=="array"){let u=[];if(V(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){let g=a(t,e,o[f][d]);m.push(g)}u.push(m)}else for(let f=0;f<o.length;f++){let m=a(t,e,o[f]);u.push(m)}return u}else return a(t,e,o);else if(e=="&")if(V(t)=="array"&&V(o)=="array"){let u=[];if(V(t[0])=="array"&&V(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return It.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++)m.push(t[f][d]+""+o[f][d]);u.push(m)}}else if(V(t[0])=="array"){if(t[0].length!=o.length)return It.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++)m.push(t[f][d]+""+o[d]);u.push(m)}}else if(V(o[0])=="array"){if(o[0].length!=t.length)return It.na;for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++)m.push(t[d]+""+o[f][d]);u.push(m)}}else{if(t.length!=o.length)return It.na;for(let f=0;f<t.length;f++)u.push(t[f]+""+o[f])}return u}else if(V(t)=="array"){let u=[];if(V(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++)m.push(t[f][d]+""+o);u.push(m)}else for(let f=0;f<t.length;f++)u.push(t[f]+""+o);return u}else if(V(o)=="array"){let u=[];if(V(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++)m.push(t+""+o[f][d]);u.push(m)}else for(let f=0;f<o.length;f++)u.push(t+""+o[f]);return u}else return t+""+o;else if(e=="^")if(V(t)=="array"&&V(o)=="array"){let u=[];if(V(t[0])=="array"&&V(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return It.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[f][d]=s(o[f][d]);let g;Y(t[f][d])&&Y(o[f][d])?g=Math.pow(parseFloat(t[f][d]),parseFloat(o[f][d])):g=It.v,m.push(g)}u.push(m)}}else if(V(t[0])=="array"){if(t[0].length!=o.length)return It.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[d]=s(o[d]);let g;Y(t[f][d])&&Y(o[d])?g=Math.pow(parseFloat(t[f][d]),parseFloat(o[d])):g=It.v,m.push(g)}u.push(m)}}else if(V(o[0])=="array"){if(o[0].length!=t.length)return It.na;for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){t[d]=s(t[d]),o[f][d]=s(o[f][d]);let g;Y(t[d])&&Y(o[f][d])?g=Math.pow(parseFloat(t[d]),parseFloat(o[f][d])):g=It.v,m.push(g)}u.push(m)}}else{if(t.length!=o.length)return It.na;for(let f=0;f<t.length;f++){t[f]=s(t[f]),o[f]=s(o[f]);let m;Y(t[f])&&Y(o[f])?m=Math.pow(parseFloat(t[f]),parseFloat(o[f])):m=It.v,u.push(m)}}return u}else if(V(t)=="array"){o=s(o);let u=[];if(V(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]);let g;Y(t[f][d])&&Y(o)?g=Math.pow(parseFloat(t[f][d]),parseFloat(o)):g=It.v,m.push(g)}u.push(m)}else for(let f=0;f<t.length;f++){t[f]=s(t[f]);let m;Y(t[f])&&Y(o)?m=Math.pow(parseFloat(t[f]),parseFloat(o)):m=It.v,u.push(m)}return u}else if(V(o)=="array"){t=s(t);let u=[];if(V(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){o[f][d]=s(o[f][d]);let g;Y(t)&&Y(o[f][d])?g=Math.pow(parseFloat(t),parseFloat(o[f][d])):g=It.v,m.push(g)}u.push(m)}else for(let f=0;f<o.length;f++){o[f]=s(o[f]);let m;Y(t)&&Y(o[f])?m=Math.pow(parseFloat(t),parseFloat(o[f])):m=It.v,u.push(m)}return u}else{t=s(t),o=s(o);let u;return Y(t)&&Y(o)?u=Math.pow(parseFloat(t),parseFloat(o)):u=It.v,u}}function rg(){let e=arguments[0];e=e.replace("{","").replace("}","").replace(/\"/g,"");let n=[];if(e.indexOf(";")>-1){n=e.split(";");for(let t=0;t<n.length;t++)n[t]=n[t].split(",")}else n=e.split(",");return n}function Pl(e,n,t){let l;return n=="+"?l=(0,Wu.default)(e).add(t).value():n=="-"?l=(0,Wu.default)(e).subtract(t).value():n=="%"?l=new Function("return "+parseFloat(e)+n+"("+parseFloat(t)+")")():n=="/"?l=(0,Wu.default)(e).divide(t).value():n=="*"&&(l=(0,Wu.default)(e).multiply(t).value()),l}function Si(e){if(window.luckysheet_getcelldata_cache==null&&(window.luckysheet_getcelldata_cache={}),e in window.luckysheet_getcelldata_cache)return window.luckysheet_getcelldata_cache[e];let n=Yl(),t=e.split("!"),l="",o="",a=-1,s=null;if(t.length>1){l=t[0].replace(/''/g,"'"),o=t[1],l.substr(0,1)=="'"&&l.substr(l.length-1,1)=="'"&&(l=l.substring(1,l.length-1));for(let u in n)if(l==n[u].name){a=n[u].index,s=n[u].data;break}a==-1&&(a=0)}else{let u=$e(h.calculateSheetIndex);l=n[u].name,a=n[u].index,s=n[u].data,o=t[0]}if(o.indexOf(":")==-1){let u=parseInt(o.replace(/[^0-9]/g,""))-1,f=jr(o.replace(/[^A-Za-z]/g,""));if(!isNaN(u)&&!isNaN(f)){let m=Du(s,{row:[u,u],column:[f,f]})[0][0];if(v.execFunctionGlobalData!=null){let y=v.execFunctionGlobalData[u+"_"+f+"_"+a];y!=null&&(m=y)}let b={sheetName:l,startCell:o,rowl:1,coll:1,data:m};return window.luckysheet_getcelldata_cache[e]=b,b}else return[]}else{o=o.split(":");let u=[],f=[];if(u[0]=parseInt(o[0].replace(/[^0-9]/g,""))-1,u[1]=parseInt(o[1].replace(/[^0-9]/g,""))-1,isNaN(u[0])&&(u[0]=0),isNaN(u[1])&&(u[1]=s.length-1),u[0]>u[1])return de.info("\u9009\u62E9\u5931\u8D25","\u8F93\u5165\u8303\u56F4\u9519\u8BEF\uFF01"),[];if(f[0]=jr(o[0].replace(/[^A-Za-z]/g,"")),f[1]=jr(o[1].replace(/[^A-Za-z]/g,"")),isNaN(f[0])&&(f[0]=0),isNaN(f[1])&&(f[1]=s[0].length-1),f[0]>f[1])return de.info("\u9009\u62E9\u5931\u8D25","\u8F93\u5165\u8303\u56F4\u9519\u8BEF\uFF01"),[];let m=Du(s,{row:u,column:f});if(v.execFunctionGlobalData!=null)for(let y=u[0];y<=u[1];y++)for(let p=f[0];p<=f[1];p++){let x=v.execFunctionGlobalData[y+"_"+p+"_"+a];x!=null&&(m[y-u[0]][p-f[0]]=x)}let d=u[1]-u[0]+1,g=f[1]-f[0]+1,b={sheetName:l,startCell:o[0],rowl:d,coll:g,data:m};return window.luckysheet_getcelldata_cache[e]=b,b}}function Oc(e){if(typeof e=="object")return e==null?"":Array.isArray(e)?nl(e[0])[2]:Array.isArray(e.data)?It.v:e.data.v===void 0?"":e.data.v;if(v.isCompareOperator(e).flag){if(typeof e=="string"||typeof e=="number")return e}else return nl(e)[2];return It.v}function $a(){let e=arguments[0];for(let n=0;n<e.length;n++){let t=e[n];typeof t=="object"?t==null?t="":Array.isArray(t)?t=nl(t[0])[2]:Array.isArray(t.data)?t=t.data:t.data.v===void 0?t="":t=t.data.v:v.isCompareOperator(t).flag||(t=nl(t)[2]),e[n]=t}}function ng(){let e=arguments[0];return e==null||e.length==0?null:e}function ig(e){return e}function og(){if(!(V(arguments[0])=="object"&&arguments[0].startCell!=null))return v.error.v;var e=arguments[0].startCell,n=j.getFirstValue(arguments[1]);if(q(n))return n;if(!Y(n))return v.error.v;n=parseInt(n);var t=j.getFirstValue(arguments[2]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=arguments[0].rowl;if(arguments.length>=4){if(l=j.getFirstValue(arguments[3]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}var o=arguments[0].coll;if(arguments.length==5){if(o=j.getFirstValue(arguments[4]),q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o)}if(l<1||o<1)return v.error.r;var a=v.getcellrange(e),s=a.row[0],u=a.column[0];s+=n,u+=t;var f=s+l-1,m=u+o-1;return s<0||f>=h.flowdata.length||u<0||m>=h.flowdata[0].length?v.error.r:Al(h.calculateSheetIndex,{row:[s,f],column:[u,m]})}function ag(e,n,t){let l,o;if(e?(o=n,l=t):(l=n,o=t),l.startCell.indexOf(":")>-1||o.indexOf(":")>-1)return It.v;if(e)return Si(o+":"+l.startCell);{let a=o,s="";if(o.indexOf("!")>-1){let u=o.split("!");s=u[0]+"!",a=u[1]}return Si(s+l.startCell+":"+a)}}var import_plugin,Wu,Uu=Tt(()=>{import_plugin=Le(Be());Vu();ir();Sr();Gl();mr();Hn();lg();ql();gl();Ut();Wu=Le(Is())});function m1(e,n){xh(u3),wh(c3,null,function(){let t=new Vuex.Store;console.info("chartmix::",chartmix.default),Vue.use(chartmix.default,{store:t});let l=document.getElementsByTagName("body")[0];chartmix.default.initChart(l,h.lang),$(".chartSetting").css({top:"1px",bottom:"1px",position:"absolute",right:"0px",width:"350px",background:"#fff",border:"1px solid #E5E5E5","z-index":1004,"box-shadow":"0px 2px 4px rgba(0,0,0,0.2)","-webkit-box-shadow":"0px 2px 4px rgba(0,0,0,0.2)","-moz-box-shadow":"0px 2px 4px rgba(0,0,0,0.2)","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none","padding-left":"30px",display:"none"}),h.createChart=chartmix.default.createChart,h.highlightChart=chartmix.default.highlightChart,h.deleteChart=chartmix.default.deleteChart,h.resizeChart=chartmix.default.resizeChart,h.changeChartRange=chartmix.default.changeChartRange,h.changeChartCellData=chartmix.default.changeChartCellData,h.getChartJson=chartmix.default.getChartJson,h.chart_selection=d3(),h.chartparam.jfrefreshchartall=h3,h.chartparam.changeChartCellData=chartmix.default.changeChartCellData,h.chartparam.renderChart=chartmix.default.renderChart,h.chartparam.getChartJson=chartmix.default.getChartJson,h.chartparam.insertToStore=chartmix.default.insertToStore;for(let o=0;o<e.length;o++)f3(e[o].chart,n);for(let o=0;o<e.length;o++)e[o].status=="1"&&ug(e[o].index);_h(h.asyncLoad,"chart")})}function f3(e,n){if(e!=null)for(let t=0;t<e.length;t++){let l=e[t];n&&h.chartparam.insertToStore({chart_id:l.chart_id,chartOptions:l.chartOptions});let o=l.chart_id,a=o+"_c",s='<div id="${id}"class="luckysheet-modal-dialog luckysheet-modal-dialog-chart ${addclass}"tabindex="0"role="dialog"aria-labelledby=":41e"dir="ltr"><div class="luckysheet-modal-dialog-resize"><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt"data-type="lt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt"data-type="mt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm"data-type="lm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm"data-type="rm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt"data-type="rt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb"data-type="lb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb"data-type="mb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb"data-type="rb"></div></div><div class="luckysheet-modal-dialog-controll"><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-update"role="button"tabindex="0"aria-label="\u4FEE\u6539\u56FE\u8868"title="\u4FEE\u6539\u56FE\u8868"><i class="fa fa-pencil"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-max"role="butluckysheet_chartIns_indexton"tabindex="0"aria-label="\u6700\u5927\u5316"title="\u6700\u5927\u5316"><i class="fa fa-window-maximize"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del"role="button"tabindex="0"aria-label="\u5220\u9664"title="\u5220\u9664"><i class="fa fa-trash"aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-content">${content}</div></div>',u=$(tg(s,{id:a,addclass:"luckysheet-data-visualization-chart",title:"\u56FE\u8868\u751F\u6210",content:""})).appendTo($(".luckysheet-cell-main"));g1(u),$(`#${a}`).children(".luckysheet-modal-dialog-content")[0].id=o;let f=document.getElementById(a),m;m=h.chartparam.getChartJson(l.chart_id),h.chartparam.renderChart({chart_id:l.chart_id,chartOptions:m}),h.currentChart=m,Pc(o),$(`#${o}_c .luckysheet-modal-controll-del`).click(function(p){p1(o)}),$(`#${o}_c .luckysheet-modal-controll-update`).click(function(p){k1()}),u.children(".luckysheet-modal-dialog-content").mousedown(function(p){h.chartparam.luckysheetCurrentChartMaxState||Pc(o),p.stopPropagation()}),u.mousedown(function(p){if(!h.chartparam.luckysheetCurrentChartMaxState){Pc(o),Go(!0),!$(p.target).is(".luckysheet-modal-dialog-controll")&&!$(p.target).is(".luckysheet-modal-controll-btn")&&!$(p.target).is("i")&&(h.chartparam.luckysheetCurrentChartMoveTimeout=setTimeout(function(){h.chartparam.luckysheetCurrentChartMove=!0},100));var x=h.chartparam.luckysheetCurrentChartMoveObj.offset(),_=h.chartparam.luckysheetCurrentChartMoveObj.position();h.chartparam.luckysheetCurrentChartMoveXy=[p.pageX-x.left,p.pageY-x.top,_.left,_.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()],h.chartparam.luckysheetCurrentChartMoveWinH=$("#luckysheet-cell-main")[0].scrollHeight,h.chartparam.luckysheetCurrentChartMoveWinW=$("#luckysheet-cell-main")[0].scrollWidth,!$(p.target).hasClass("luckysheet-mousedown-cancel")&&$(p.target).filter("[class*='sp-palette']").length==0&&$(p.target).filter("[class*='sp-thumb']").length==0&&$(p.target).filter("[class*='sp-']").length==0&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide()),p.stopPropagation()}}).find(".luckysheet-modal-dialog-resize-item").mousedown(function(p){if(h.chartparam.luckysheetCurrentChartActive){h.chartparam.luckysheetCurrentChartResize=$(this).data("type");var x=ll(p.pageX,p.pageY),_=$("#luckysheet-scrollbar-x").scrollLeft(),S=$("#luckysheet-scrollbar-y").scrollTop(),I=x[0]+_,O=x[1]+S,F=h.chartparam.luckysheetCurrentChartResizeObj.position();h.chartparam.luckysheetCurrentChartResizeXy=[I,O,u.width(),u.height(),F.left+_,F.top+S,_,S],h.chartparam.luckysheetCurrentChartResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,h.chartparam.luckysheetCurrentChartResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,h.chartparam.luckysheetCurrentChart=o,p.stopPropagation()}});let d=l.width,g=l.height,b=l.left,y=l.top;f.style.width=d+"px",f.style.height=g+"px",f.style.position="absolute",f.style.background="#fff",f.style.left=b+"px",f.style.top=y+"px",f.style.zIndex=h.zIndex?h.zIndex:15,h.zIndex++}}function h3(e,n,t,l,o){let a=h.currentChart;if(!!a&&a.rangeArray.length==1){var s=a.rangeArray[0].row,u=a.rangeArray[0].column;if(n>s[1]||t<s[0]||l>u[1]||o<u[0])return;var f=v.getcellrange(a.rangeTxt),m=f.sheetIndex==-1?0:f.sheetIndex,d={row:f.row,column:f.column,dataSheetIndex:m},g=Si(a.rangeTxt);if(typeof g=="object"&&g.length!=0&&g.data.length!=null){var b=g.data;h.chartparam.changeChartCellData(a.chart_id,b)}}}function d3(){return{create:function(){var e=h.currentChart;if(e.rangeArray.length>1)return;$("#luckysheet-chart-rangeShow").empty(),$("#luckysheet-cell-selected-boxs").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide();var n=e.rangeArray[0].row[0],t=e.rangeArray[0].column[0],l=e.rangeSplitArray,o=e.rangeRowCheck;if(o.exits)var a=m("rowtitle",l.rowtitle.row[0]+n,l.rowtitle.row[1]+n,l.rowtitle.column[0]+t,l.rowtitle.column[1]+t);else var a="";var s=e.rangeColCheck;if(s.exits)var u=m("coltitle",l.coltitle.row[0]+n,l.coltitle.row[1]+n,l.coltitle.column[0]+t,l.coltitle.column[1]+t);else var u="";var f=m("content",l.content.row[0]+n,l.content.row[1]+n,l.content.column[0]+t,l.content.column[1]+t);$("#luckysheet-chart-rangeShow").append(a+u+f);function m(d,g,b,y,p){var x=jf(),_=Vf(),S=x[b],I=g-1==-1?0:x[g-1],O=_[p],F=y-1==-1?0:_[y-1];if(d=="rowtitle")var D="#C65151";if(d=="coltitle")var D="#9667C0";if(d=="content")var D="#4970D1";var k='<div id="luckysheet-chart-rangeShow-'+d+'" style="left: '+F+"px;width: "+(O-F-1)+"px;top: "+I+"px;height: "+(S-I-1)+'px;border: none;margin: 0;position: absolute;z-index: 14;"><div class="luckysheet-chart-rangeShow-move" data-type="top" style="height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: '+D+';position: absolute;left: 0;right: 0;top: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="right" style="width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: '+D+';position: absolute;top: 0;bottom: 0;right: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="bottom" style="height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: '+D+';position: absolute;left: 0;right: 0;bottom: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="left" style="width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: '+D+';position: absolute;top: 0;bottom: 0;left: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div style="border: 2px solid #85c0fc;background: '+D+';position: absolute;top: 0;right: 0;bottom: 0;left: 0;z-index: 15;opacity: 0.1;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="lt" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+D+';position: absolute;left: -3px;top: -3px;z-index: 19;cursor: se-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="rt" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+D+';position: absolute;right: -3px;top: -3px;z-index: 19;cursor: ne-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="lb" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+D+';position: absolute;left: -3px;bottom: -3px;z-index: 19;cursor: ne-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="rb" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+D+';position: absolute;right: -3px;bottom: -3px;z-index: 19;cursor: se-resize;"></div></div>';return k}},rangeMove:!1,rangeMovexy:null,rangeMoveIndex:null,rangeMoveObj:null,rangeMoveDraging:function(e,n,t){var l=h.currentChart,o=l.rangeArray[0].row[0],a=l.rangeArray[0].column[0],s=l.rangeRowCheck,u=l.rangeColCheck,f=l.rangeSplitArray,m=ll(e.pageX,e.pageY),d=$("#luckysheet-cell-main").scrollLeft(),g=$("#luckysheet-cell-main").scrollTop(),b=m[0]+d,y=m[1]+g,p=$(window).height()+g-n-t,x=$(window).width()+d,_=h1(y),S=_[2],I=d1(b),O=I[2],F=jf(),D=Vf(),k=h.chart_selection.rangeMoveObj.attr("id");if(k=="luckysheet-chart-rangeShow-content"){var w=h.chart_selection.rangeMoveIndex[0]-h.chart_selection.rangeMovexy[0]+S;s.exits?(w<o+s.range[1]+1||y<0)&&(w=o+s.range[1]+1):(w<0||y<0)&&(w=0);var C=f.content.row[1]-f.content.row[0]+w;(C>=F.length-1||y>p)&&(w=F.length-1-f.content.row[1]+f.content.row[0],C=F.length-1);var T=h.chart_selection.rangeMoveIndex[1]-h.chart_selection.rangeMovexy[1]+O;u.exits?(T<a+u.range[1]+1||b<0)&&(T=a+u.range[1]+1):(T<0||b<0)&&(T=0);var z=f.content.column[1]-f.content.column[0]+T;(z>=D.length-1||b>x)&&(T=D.length-1-f.content.column[1]+f.content.column[0],z=D.length-1),s.exits&&u.exits?(l.rangeArray=[{row:[o,C],column:[a,z]}],l.rangeSplitArray.range={row:[o,C],column:[a,z]},l.rangeSplitArray.content={row:[w-o,C-o],column:[T-a,z-a]},l.rangeSplitArray.rowtitle={row:l.rangeSplitArray.rowtitle.row,column:[T-a,z-a]},l.rangeSplitArray.coltitle={row:[w-o,C-o],column:l.rangeSplitArray.coltitle.column}):s.exits?(l.rangeArray=[{row:[o,C],column:[T,z]}],l.rangeSplitArray.range={row:[o,C],column:[T,z]},l.rangeSplitArray.content={row:[w-o,C-o],column:l.rangeSplitArray.content.column}):u.exits?(l.rangeArray=[{row:[w,C],column:[a,z]}],l.rangeSplitArray.range={row:[w,C],column:[a,z]},l.rangeSplitArray.content={row:l.rangeSplitArray.content.row,column:[T-a,z-a]}):(l.rangeArray=[{row:[w,C],column:[T,z]}],l.rangeSplitArray.range={row:[w,C],column:[T,z]})}else if(k=="luckysheet-chart-rangeShow-rowtitle"){var T=h.chart_selection.rangeMoveIndex[1]-h.chart_selection.rangeMovexy[1]+O;u.exits?(T<a+u.range[1]+1||b<0)&&(T=a+u.range[1]+1):(T<0||b<0)&&(T=0);var z=f.rowtitle.column[1]-f.rowtitle.column[0]+T;(z>=D.length-1||b>x)&&(T=D.length-1-f.rowtitle.column[1]+f.rowtitle.column[0],z=D.length-1),u.exits?(l.rangeArray=[{row:l.rangeArray[0].row,column:[a,z]}],l.rangeSplitArray.range={row:l.rangeArray[0].row,column:[a,z]},l.rangeSplitArray.rowtitle={row:l.rangeSplitArray.rowtitle.row,column:[T-a,z-a]},l.rangeSplitArray.content={row:l.rangeSplitArray.content.row,column:[T-a,z-a]}):(l.rangeArray=[{row:l.rangeArray[0].row,column:[T,z]}],l.rangeSplitArray.range={row:l.rangeArray[0].row,column:[T,z]})}else if(k=="luckysheet-chart-rangeShow-coltitle"){var w=h.chart_selection.rangeMoveIndex[0]-h.chart_selection.rangeMovexy[0]+S;s.exits?(w<o+s.range[1]+1||y<0)&&(w=o+s.range[1]+1):(w<0||y<0)&&(w=0);var C=f.coltitle.row[1]-f.coltitle.row[0]+w;(C>=F.length-1||y>p)&&(w=F.length-1-f.coltitle.row[1]+f.coltitle.row[0],C=F.length-1),s.exits?(l.rangeArray=[{row:[o,C],column:l.rangeArray[0].column}],l.rangeSplitArray.range={row:[o,C],column:l.rangeArray[0].column},l.rangeSplitArray.coltitle={row:[w-o,C-o],column:l.rangeSplitArray.coltitle.column},l.rangeSplitArray.content={row:[w-o,C-o],column:l.rangeSplitArray.content.column}):(l.rangeArray=[{row:[w,C],column:l.rangeArray[0].column}],l.rangeSplitArray.range={row:[w,C],column:l.rangeArray[0].column})}h.chart_selection.create()},rangeMoveDragged:function(){h.chart_selection.rangeMove=!1;var e=h.currentChart;e.rangeTxt=Al(h.currentSheetIndex,e.rangeArray[0],h.currentSheetIndex),e.chartData=Xl(e.rangeArray[0],h.currentSheetIndex),h.changeChartRange(e.chart_id,e.chartData,e.rangeArray,e.rangeTxt)},rangeResize:!1,rangeResizexy:null,rangeResizeIndex:null,rangeResizeObj:null,rangeResizeDraging:function(e,n,t){var l=h.currentChart,o=l.rangeArray[0].row[0],a=l.rangeArray[0].column[0],s=l.rangeRowCheck,u=l.rangeColCheck,f=l.rangeSplitArray,m=ll(e.pageX,e.pageY),d=$("#luckysheet-cell-main").scrollLeft(),g=$("#luckysheet-cell-main").scrollTop(),b=m[0]+d,y=m[1]+g,p=$(window).height()+g-n-t,x=$(window).width()+d,_=h1(y),S=_[2],I=d1(b),O=I[2],F=jf(),D=Vf(),k=h.chart_selection.rangeResizeObj.attr("id");if(k=="luckysheet-chart-rangeShow-content"){var w,C,T,z;if(h.chart_selection.rangeResize=="lt"?(w=h.chart_selection.rangeResizeIndex.row[0],T=h.chart_selection.rangeResizeIndex.column[0],C=h.chart_selection.rangeResizeIndex.row[1],z=h.chart_selection.rangeResizeIndex.column[1]):h.chart_selection.rangeResize=="lb"?(w=h.chart_selection.rangeResizeIndex.row[1],T=h.chart_selection.rangeResizeIndex.column[0],C=h.chart_selection.rangeResizeIndex.row[0],z=h.chart_selection.rangeResizeIndex.column[1]):h.chart_selection.rangeResize=="rt"?(w=h.chart_selection.rangeResizeIndex.row[0],T=h.chart_selection.rangeResizeIndex.column[1],C=h.chart_selection.rangeResizeIndex.row[1],z=h.chart_selection.rangeResizeIndex.column[0]):h.chart_selection.rangeResize=="rb"&&(w=h.chart_selection.rangeResizeIndex.row[1],T=h.chart_selection.rangeResizeIndex.column[1],C=h.chart_selection.rangeResizeIndex.row[0],z=h.chart_selection.rangeResizeIndex.column[0]),s.exits){var A=w-h.chart_selection.rangeResizexy[0]+S;A<o+s.range[1]+1||y<0?A=o+s.range[1]+1:(A>=F.length-1||y>p)&&(A=F.length-1)}else{var A=o-h.chart_selection.rangeResizexy[0]+S;A<0||y<0?A=0:(A>=F.length-1||y>p)&&(A=F.length-1)}if(u.exits){var M=T-h.chart_selection.rangeResizexy[1]+O;M<a+u.range[1]+1||b<0?M=a+u.range[1]+1:(M>=D.length-1||b>x)&&(M=D.length-1)}else{var M=a-h.chart_selection.rangeResizexy[1]+O;M<0||b<0?M=0:(M>=D.length-1||b>x)&&(M=D.length-1)}var P,N,E,B;A>C?(P=C,N=A):(P=A,N=C),M>z?(E=z,B=M):(E=M,B=z),!s.exits&&!u.exits?(l.rangeArray=[{row:[P,N],column:[E,B]}],l.rangeSplitArray.range={row:[P,N],column:[E,B]}):(l.rangeArray=[{row:[o,N],column:[a,B]}],l.rangeSplitArray.range={row:[o,N],column:[a,B]},l.rangeSplitArray.content={row:[P-o,N-o],column:[E-a,B-a]},s.exits&&(l.rangeSplitArray.rowtitle={row:l.rangeSplitArray.rowtitle.row,column:[E-a,B-a]}),u.exits&&(l.rangeSplitArray.coltitle={row:[P-o,N-o],column:l.rangeSplitArray.coltitle.column}))}else if(k=="luckysheet-chart-rangeShow-rowtitle"){var T,z;if(h.chart_selection.rangeResize=="lt"||h.chart_selection.rangeResize=="lb"?(T=h.chart_selection.rangeResizeIndex.column[0],z=h.chart_selection.rangeResizeIndex.column[1]):(h.chart_selection.rangeResize=="rt"||h.chart_selection.rangeResize=="rb")&&(T=h.chart_selection.rangeResizeIndex.column[1],z=h.chart_selection.rangeResizeIndex.column[0]),u.exits){var M=T-h.chart_selection.rangeResizexy[1]+O;M<a+u.range[1]+1||b<0?M=a+u.range[1]+1:(M>=D.length-1||b>x)&&(M=D.length-1)}else{var M=a-h.chart_selection.rangeResizexy[1]+O;M<0||b<0?M=0:(M>=D.length-1||b>x)&&(M=D.length-1)}var E,B;M>z?(E=z,B=M):(E=M,B=z),u.exits?(l.rangeArray=[{row:l.rangeArray[0].row,column:[a,B]}],l.rangeSplitArray.range={row:l.rangeArray[0].row,column:[a,B]},l.rangeSplitArray.rowtitle={row:l.rangeSplitArray.rowtitle.row,column:[E-a,B-a]},l.rangeSplitArray.content={row:l.rangeSplitArray.content.row,column:[E-a,B-a]}):(l.rangeArray=[{row:l.rangeArray[0].row,column:[E,B]}],l.rangeSplitArray.range={row:l.rangeArray[0].row,column:[E,B]})}else if(k=="luckysheet-chart-rangeShow-coltitle"){var w,C;if(h.chart_selection.rangeResize=="lt"||h.chart_selection.rangeResize=="rt"?(w=h.chart_selection.rangeResizeIndex.row[0],C=h.chart_selection.rangeResizeIndex.row[1]):(h.chart_selection.rangeResize=="lb"||h.chart_selection.rangeResize=="rb")&&(w=h.chart_selection.rangeResizeIndex.row[1],C=h.chart_selection.rangeResizeIndex.row[0]),s.exits){var A=w-h.chart_selection.rangeResizexy[0]+S;A<o+s.range[1]+1||y<0?A=o+s.range[1]+1:(A>=F.length-1||y>p)&&(A=F.length-1)}else{var A=o-h.chart_selection.rangeResizexy[0]+S;A<0||y<0?A=0:(A>=F.length-1||y>p)&&(A=F.length-1)}var P,N;A>C?(P=C,N=A):(P=A,N=C),s.exits?(l.rangeArray=[{row:[o,N],column:l.rangeArray[0].column}],l.rangeSplitArray.range={row:[o,N],column:l.rangeArray[0].column},l.rangeSplitArray.coltitle={row:[P-o,N-o],column:l.rangeSplitArray.coltitle.column},l.rangeSplitArray.content={row:[P-o,N-o],column:l.rangeSplitArray.content.column}):(l.rangeArray=[{row:[P,N],column:l.rangeArray[0].column}],l.rangeSplitArray.range={row:[P,N],column:l.rangeArray[0].column})}h.chart_selection.create()},rangeResizeDragged:function(){h.chart_selection.rangeResize=null;var e=h.currentChart;e.rangeTxt=Al(h.currentSheetIndex,e.rangeArray[0],h.currentSheetIndex),e.chartData=Xl(e.rangeArray[0],h.currentSheetIndex),h.changeChartRange(e.chart_id,e.chartData,e.rangeArray,e.rangeTxt)}}}function sg(e,n,t,l){var o=luckysheet.getluckysheet_select_save();o.length==1&&o[0].row[0]==o[0].row[1]&&o[0].column[0]==o[0].column[1]&&(Jo("right","rangeOfSelect"),Jo("down","rangeOfSelect"),o=luckysheet.getluckysheet_select_save());for(var a=-1,s=o[0].row[1]-o[0].row[0],u=o[0].row[0];u<=o[0].row[1];u++){for(var f=o[0].column[0];f<=o[0].column[1];f++){var m=Mt(u,f,luckysheet.flowdata());if(m!=null&&m.toString().length>0){a=u;break}}if(a!==-1)break}a==-1&&(a=0),o[0].row=[a,a],o[0].row_focus=a,luckysheet.setluckysheet_select_save(o),h.luckysheet_shiftpositon=$.extend(!0,{},o[0]),_c("down","range",!1,s),o=luckysheet.getluckysheet_select_save();for(var d=-1,g=o[0].column[1]-o[0].column[0],f=o[0].column[0];f<=o[0].column[1];f++){for(var u=o[0].row[0];u<=o[0].row[1];u++){var m=Mt(u,f,luckysheet.flowdata());if(m!=null&&m.toString().length>0){d=f;break}}if(d!==-1)break}d==-1&&(d=0),o[0].column=[d,d],o[0].column_focus=d,luckysheet.setluckysheet_select_save(o),h.luckysheet_shiftpositon=$.extend(!0,{},o[0]),_c("right","range",!1,g),o=luckysheet.getluckysheet_select_save();var b=$.extend(!0,[],o),y=Al(h.currentSheetIndex,b[0],h.currentSheetIndex);let p=Xl();console.dir(p);let x=c1("chart"),_=x+"_c",S='<div id="${id}"class="luckysheet-modal-dialog luckysheet-modal-dialog-chart ${addclass}"tabindex="0"role="dialog"aria-labelledby=":41e"dir="ltr"><div class="luckysheet-modal-dialog-resize"><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt"data-type="lt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt"data-type="mt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm"data-type="lm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm"data-type="rm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt"data-type="rt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb"data-type="lb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb"data-type="mb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb"data-type="rb"></div></div><div class="luckysheet-modal-dialog-controll"><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-update"role="button"tabindex="0"aria-label="\u4FEE\u6539\u56FE\u8868"title="\u4FEE\u6539\u56FE\u8868"><i class="fa fa-pencil"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-max"role="butluckysheet_chartIns_indexton"tabindex="0"aria-label="\u6700\u5927\u5316"title="\u6700\u5927\u5316"><i class="fa fa-window-maximize"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del"role="button"tabindex="0"aria-label="\u5220\u9664"title="\u5220\u9664"><i class="fa fa-trash"aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-content">${content}</div></div>',I=$(tg(S,{id:_,addclass:"luckysheet-data-visualization-chart",title:"\u56FE\u8868\u751F\u6210",content:""})).appendTo($(".luckysheet-cell-main")),O=document.getElementById(_),{render:F,chart_json:D}=h.createChart($(`#${_}`).children(".luckysheet-modal-dialog-content")[0],p,x,b,y);console.dir(JSON.stringify(D)),e=e||400,n=n||250,t=t||0,l=l||0,O.style.width=e+"px",O.style.height=n+"px",O.style.position="absolute",O.style.background="#fff",O.style.left=t+"px",O.style.top=l+"px",F.style.width="100%",F.style.height="100%",O.style.zIndex=h.zIndex?h.zIndex:15,h.zIndex++;let k=h.luckysheetfile[$e(h.currentSheetIndex)];k.chart||(k.chart=[]),k.chart.push({chart_id:x,width:e,height:n,left:t,top:l,sheetIndex:k.index}),Pc(x),$(`#${x}_c .luckysheet-modal-controll-del`).click(function(w){p1(x)}),g1(I),$(`#${x}_c .luckysheet-modal-controll-update`).click(function(w){k1()}),I.children(".luckysheet-modal-dialog-content").mousedown(function(w){h.chartparam.luckysheetCurrentChartMaxState||Pc(x),w.stopPropagation()}),I.mousedown(function(w){if(!h.chartparam.luckysheetCurrentChartMaxState){Pc(x),Go(!0),!$(w.target).is(".luckysheet-modal-dialog-controll")&&!$(w.target).is(".luckysheet-modal-controll-btn")&&!$(w.target).is("i")&&(h.chartparam.luckysheetCurrentChartMoveTimeout=setTimeout(function(){h.chartparam.luckysheetCurrentChartMove=!0},100));var C=h.chartparam.luckysheetCurrentChartMoveObj.offset(),T=h.chartparam.luckysheetCurrentChartMoveObj.position();h.chartparam.luckysheetCurrentChartMoveXy=[w.pageX-C.left,w.pageY-C.top,T.left,T.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()],h.chartparam.luckysheetCurrentChartMoveWinH=$("#luckysheet-cell-main")[0].scrollHeight,h.chartparam.luckysheetCurrentChartMoveWinW=$("#luckysheet-cell-main")[0].scrollWidth,!$(w.target).hasClass("luckysheet-mousedown-cancel")&&$(w.target).filter("[class*='sp-palette']").length==0&&$(w.target).filter("[class*='sp-thumb']").length==0&&$(w.target).filter("[class*='sp-']").length==0&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide()),w.stopPropagation()}}).find(".luckysheet-modal-dialog-resize-item").mousedown(function(w){if(h.chartparam.luckysheetCurrentChartActive){h.chartparam.luckysheetCurrentChartResize=$(this).data("type");var C=ll(w.pageX,w.pageY),T=$("#luckysheet-scrollbar-x").scrollLeft(),z=$("#luckysheet-scrollbar-y").scrollTop(),A=C[0]+T,M=C[1]+z,P=h.chartparam.luckysheetCurrentChartResizeObj.position();h.chartparam.luckysheetCurrentChartResizeXy=[A,M,I.width(),I.height(),P.left+T,P.top+z,T,z],h.chartparam.luckysheetCurrentChartResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,h.chartparam.luckysheetCurrentChartResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,h.chartparam.luckysheetCurrentChart=x,w.stopPropagation()}})}function g1(e){e.find(".luckysheet-modal-dialog-content").hover(function(){e.removeClass("chart-moveable")},function(){e.addClass("chart-moveable")}),e.hover(function(){e.addClass("chart-moveable")},function(){e.removeClass("chart-moveable")})}function p1(e){$(`.luckysheet-cell-main #${e}_c`).remove(),cg();let n=h.luckysheetfile[$e(h.currentSheetIndex)],t=n.chart.findIndex(l=>l.chart_id==e);n.chart.splice(t,1),h.deleteChart(e)}function Pc(e){let n=h.luckysheetfile[$e(h.currentSheetIndex)].chart;for(let t in n)n[t].needRangeShow=!1,n[t].chart_id==e&&(n[t].needRangeShow=!0,h.currentChart=h.getChartJson(e));v1(e)}function cg(){let e=h.luckysheetfile[$e(h.currentSheetIndex)].chart;for(let n in e)e[n].needRangeShow=!1;y1()}function v1(e){let n=$("#"+e+"_c");h.chart_selection.create(),h.chartparam.luckysheetCurrentChartActive=!0,h.chartparam.luckysheetCurrentChartMoveObj=n,h.chartparam.luckysheetCurrentChartResizeObj=n,h.chartparam.luckysheetCurrentChart=e,$("#luckysheet-cell-main").find(".luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize").hide(),$("#luckysheet-cell-main").find(".luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll").hide(),n.css("z-index",h.chartparam.luckysheetCurrentChartZIndexRank++),n.find(".luckysheet-modal-dialog-resize").show(),n.find(".luckysheet-modal-dialog-controll").show(),($(".chartSetting").is(":visible")||h.chartparam.luckysheet_chart_redo_click)&&e!=h.chartparam.luckysheetCurrentChart&&$("body .luckysheet-cols-menu").hide(),h.currentChart=h.highlightChart(e)}function y1(e){$("#luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize, #luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll").hide(),$("#luckysheet-cell-main").find(".luckysheet-datavisual-selection-set div").remove(),h.chartparam.luckysheetCurrentChartActive=!1,$("#luckysheet-chart-rangeShow").empty(),!e&&$(".chartSetting").is(":visible")&&!Qe()&&m3()}function k1(e,n){$(".chartSetting").is(":visible")||($(".chartSetting").show(),$("#luckysheet-cell-main").find(".luckysheet-datavisual-selection-set div").show(),h.chartparam.luckysheetCurrentChartActive=!0,setTimeout(function(){Kl()},0))}function m3(e){$(".chartSetting").is(":visible")&&($(".chartSetting").hide(),$("#luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize, #luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll").hide(),$("#luckysheet-cell-main").find(".luckysheet-datavisual-selection-set div").remove(),h.chartparam.luckysheetCurrentChartActive=!1,!Qe()&&!e&&setTimeout(function(){Kl()},0))}function ug(e){y1("true"),h.luckysheetfile.forEach(t=>{t.index==e?(t.chart||[]).forEach(o=>{o.isShow=!0,$("#"+o.chart_id+"_c").show(),h.resizeChart(o.chart_id),o.needRangeShow==!0&&(h.currentChart=h.getChartJson(o.chart_id),v1(o.chart_id))}):(t.chart||[]).forEach(o=>{o.isShow=!1,$("#"+o.chart_id+"_c").hide()})})}var import_plugin,h1,d1,c3,u3,bh=Tt(()=>{import_plugin=Le(Be());gl();u1();mr();Ut();ir();Uu();ql();Qn();Ea();Cc();Gl();Bi();h1=zl,d1=Ml,c3=["https://cdn.jsdelivr.net/npm/vue@2.6.11","https://unpkg.com/vuex@3.4.0","https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.2/index.js","https://cdn.bootcdn.net/ajax/libs/echarts/4.8.0/echarts.min.js","expendPlugins/chart/chartmix.umd.min.js"],u3=["https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.2/theme-chalk/index.css","expendPlugins/chart/chartmix.css"]});function Sa(e){h.flowdata==null||h.flowdata.length==0||(clearTimeout(b1),b1=setTimeout(()=>{h.clearjfundo&&h.jfredo.push({type:"zoomChange",zoomRatio:h.zoomRatio,curZoomRatio:e,sheetIndex:h.currentSheetIndex}),Do=null,h.zoomRatio=e;let n=ct.getSheetByIndex();Nt.buildAllPs(n.data),$t.images=n.images,$t.allImagesShow(),$t.init(),n.config==null&&(n.config={}),n.config.sheetViewZoom==null&&(n.config.sheetViewZoom={});let t=n.config.curentsheetView;t==null&&(t="viewNormal"),n.config.sheetViewZoom[t+"ZoomScale"]=e,He.saveParam("all",h.currentSheetIndex,h.zoomRatio,{k:"zoomRatio"}),He.saveParam("cg",h.currentSheetIndex,n.config.sheetViewZoom,{k:"sheetViewZoom"}),Ec()},100))}function Ec(){Nl(h.flowdata.length,h.flowdata[0].length),Pm()}function w1(){let e=.02,n=.1,t=4,l=.1;$("#luckysheet-zoom-minus").click(function(){let o;h.zoomRatio==null?o=h.zoomRatio=1:o=Math.ceil(h.zoomRatio*10)/10,o=o-n,o==h.zoomRatio&&(o=o-n),o<=l&&(o=l),Sa(o),Ii(o)}),$("#luckysheet-zoom-plus").click(function(){let o;h.zoomRatio==null?o=h.zoomRatio=1:o=Math.floor(h.zoomRatio*10)/10,o=o+n,o==h.zoomRatio&&(o=o+n),o>=t&&(o=t),Sa(o),Ii(o)}),$("#luckysheet-zoom-slider").mousedown(function(o){let a=$(this).offset().left,s=o.pageX,u=x1(s-a);Sa(u),Ii(u)}),$("#luckysheet-zoom-cursor").mousedown(function(o){let a=o.pageX,s=parseFloat($("#luckysheet-zoom-cursor").css("left"));$("#luckysheet-zoom-cursor").css("transition","none"),$(document).off("mousemove.zoomCursor").on("mousemove.zoomCursor",function(u){let m=u.pageX-a,d=s+m,g=x1(d);g>t&&(g=t,d=100),g<l&&(g=l,d=0),Sa(g);let b=Math.round(g*100)+"%";$("#luckysheet-zoom-ratioText").html(b),$("#luckysheet-zoom-cursor").css("left",d-4)}),$(document).off("mouseup.zoomCursor").on("mouseup.zoomCursor",function(u){$(document).off(".zoomCursor"),$("#luckysheet-zoom-cursor").css("transition","all 0.3s")}),o.stopPropagation()}).click(function(o){o.stopPropagation()}),$("#luckysheet-zoom-ratioText").click(function(){Sa(1),Ii(1)}),Ii(h.zoomRatio),Do=null,document.addEventListener("wheel",function(o){!o.ctrlKey||!o.deltaY||(Do===null&&(Do=h.zoomRatio||1),Do+=o.deltaY<0?e:-e,Do>=t?Do=t:Do<l&&(Do=l),Sa(Do),Ii(Do),o.preventDefault(),o.stopPropagation())},{capture:!0,passive:!1}),document.addEventListener("keydown",function(o){if(!o.ctrlKey)return;let a=!1,s=h.zoomRatio||1;o.key==="-"||o.which===189?(s-=n,a=!0):o.key==="+"||o.which===187?(s+=n,a=!0):(o.key==="0"||o.which===48)&&(s=1,a=!0),a&&(o.preventDefault(),s>=t?s=t:s<l&&(s=l),Sa(s),Ii(s))},{capture:!0})}function x1(e){let n=1;return e<50?n=Math.round((e*1.8/100+.1)*100)/100:e>50&&(n=Math.round(((e-50)*6/100+1)*100)/100),n}function g3(e){let n=50;e<1?n=Math.round((e-.1)*100/.18)/10:e>1&&(n=Math.round((e-1)*100/.6)/10+50),$("#luckysheet-zoom-cursor").css("left",n-4)}function Ii(e){let n=Math.round(e*100)+"%";$("#luckysheet-zoom-ratioText").html(n),g3(e)}var import_plugin,b1,Do,Nc=Tt(()=>{import_plugin=Le(Be());Ut();Rl();gl();Yr();Bi();fr();wr();Fo();To();b1=null;Do=null});var import_plugin,p3,ct,Yr=Tt(()=>{import_plugin=Le(Be());Gl();Io();mr();io();s1();Sr();ir();fr();zu();br();Ms();Gl();gl();ar();wr();bn();Qo();Bi();Fo();To();Vi();Mc();li();wa();vr();Ut();Rl();bh();Bi();Nc();Mr();qn();p3={generateRandomSheetIndex:function(e){e==null&&(e="Sheet");let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="";for(let o=0;o<12;o++)t+=n[Math.round(Math.random()*(n.length-1))];let l=new Date().getTime();return e+"_"+t+"_"+l},generateRandomSheetName:function(e,n){let t=e.length,o=Oe().pivotTable.title;for(let a=0;a<e.length;a++)if(e[a].name.indexOf("Sheet")>-1||e[a].name.indexOf(o)>-1){let s=parseFloat(e[a].name.replace("Sheet","").replace(o,""));s!="NaN"&&Math.ceil(s)>t&&(t=Math.ceil(s))}return n?o+(t+1):"Sheet"+(t+1)},generateCopySheetName:function(e,n){let t="",o=Oe().info;if(n.toString().indexOf("("+o.copy)>-1){let a=n.toString().indexOf("("+o.copy),s=n.toString().substring(0,a)+"("+o.copy,u=null;for(let f=0;f<e.length;f++){let m=e[f].name.toString(),d=m.indexOf(s);if(d>-1){let g=m.indexOf(")",d+s.length),b=m.substring(d+s.length,g);Y(b)&&(u==null||parseInt(b)>u)&&(u=parseInt(b))}}u==null?t=s+"2)":(u++,t=s+u+")")}else{let a=null,s=!1,u=n+"("+o.copy;for(let f=0;f<e.length;f++){let m=e[f].name.toString(),d=m.indexOf(u);if(d>-1){s=!0;let g=m.indexOf(")",d+u.length),b=m.substring(d+u.length,g);Y(b)&&(a==null||parseInt(b)>a)&&(a=parseInt(b))}}s?a==null?t=n+"("+o.copy+"2)":(a++,t=n+"("+o.copy+""+a+")"):t=n+"("+o.copy+")"}return t},getSheetByIndex:function(e){let n=this;e==null&&(e=h.currentSheetIndex);let t=n.getSheetIndex(e);return h.luckysheetfile[t]},getSheetByName:function(e){let n=this;if(e==null)return null;for(let t=0;t<h.luckysheetfile.length;t++){let l=h.luckysheetfile[t];if(l.name==e)return l}return null},getCurSheetnoset:function(){let e=0;for(let n=0;n<h.luckysheetfile.length;n++)if(h.luckysheetfile[n].status==1){e=h.luckysheetfile[n].index;break}return e},getCurSheet:function(){if(h.luckysheetfile.length){let e=!1,n=[];h.luckysheetfile.forEach(t=>{typeof t.index=="undefined"&&(t.index=this.generateRandomSheetIndex()),n.includes(t.index)?t.index=this.generateRandomSheetIndex():n.push(t.index),typeof t.status=="undefined"&&(t.status=0),t.status==1&&(e?t.status=0:e=!0)}),e||(h.luckysheetfile[0].status=1)}h.currentSheetIndex=h.luckysheetfile[0].index;for(let e=0;e<h.luckysheetfile.length;e++)if(h.luckysheetfile[e].status==1){h.currentSheetIndex=h.luckysheetfile[e].index;break}return h.currentSheetIndex},addNewSheet:function(e,n){if(Qe()||h.allowEdit===!1||!Yt.createHookFunction("sheetCreateBefore"))return;let t=this,l=h.luckysheetfile.length,o=t.generateRandomSheetIndex(),a=t.generateRandomSheetName(h.luckysheetfile,n);$("#luckysheet-sheet-container-c").append(yt(bi,{index:o,active:"",name:a,style:"",colorset:""}));let s={name:a,color:"",status:"0",order:l,index:o,celldata:[],row:h.defaultrowNum,column:h.defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!!n};if(h.luckysheetfile.push(s),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+o).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+o+'" class="luckysheet-datavisual-selection-set"></div>'),Ir(e),He.saveParam("sha",null,$.extend(!0,{},s)),h.clearjfundo){h.jfundo.length=0;let u={};u.type="addSheet",u.sheetconfig=$.extend(!0,{},s),u.index=o,u.currentSheetIndex=h.currentSheetIndex,h.jfredo.push(u)}t.changeSheetExec(o,n,!0)},setSheetHide:function(e,n){let t=this,l=t.getSheetIndex(e);if(!n&&!Yt.createHookFunction("sheetHideBefore",{sheet:h.luckysheetfile[l]}))return;h.luckysheetfile[l].hide=1;let o=$("#luckysheet-sheets-item"+e);o.hide(),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active");let a;if(lt.showsheetbarConfig.sheet)a=o.nextAll(":visible"),o.nextAll(":visible").length>0?a=a.eq(0).data("index"):a=o.prevAll(":visible").eq(0).data("index");else{let s,u=[];h.luckysheetfile.forEach((m,d)=>{m.hide!==1&&u.push(d)});let f=u.length;f===1?s=u[0]:s=u[f-1]>l?u.find(m=>m>l):u[f-1],a=h.luckysheetfile[s].index}$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),t.changeSheetExec(a),t.locationSheet(),He.saveParam("sh",o.data("index"),1,{op:"hide",cur:a}),n||Yt.createHookFunction("sheetHideAfter",{sheet:h.luckysheetfile[l]})},setSheetShow:function(e){let n=this,t=h.luckysheetfile[n.getSheetIndex(e)];!Yt.createHookFunction("sheetShowBefore",{sheet:t})||(t.hide=0,n.changeSheetExec(e),He.saveParam("sh",e,0,{op:"show",cur:null}),Yt.createHookFunction("sheetShowAfter",{sheet:t}))},sheetMaxIndex:0,ordersheet:function(e){return function(n,t){let l=n[e],o=t[e];return l-o}},getCurrentOrder:function(){let e={};return $("#luckysheet-sheet-area div.luckysheet-sheets-item").each(function(n){let t=$(this).data("index");for(let l=0;l<h.luckysheetfile.length;l++)if(h.luckysheetfile[l].index==t){e[t.toString()]=n;break}}),e},reOrderAllSheet:function(){let e={};$("#luckysheet-sheet-area div.luckysheet-sheets-item").each(function(n){let t=$(this).data("index");for(let l=0;l<h.luckysheetfile.length;l++)if(h.luckysheetfile[l].index==t){h.luckysheetfile[l].order=n,e[t.toString()]=n;break}}),He.saveParam("shr",null,e),h.luckysheetfile.sort((n,t)=>{let l=n.order,o=t.order;return l!=null&&o!=null?l-o:l!=null?-1:(o!=null,1)})},createSheet:function(){let e=this,n=[];h.luckysheetfile.sort(e.ordersheet("order"));for(let t=0;t<h.luckysheetfile.length;t++){let l="",o=h.luckysheetfile[t].index,a="";h.luckysheetfile[t].color!=null&&(a='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+h.luckysheetfile[t].color+';"></div>'),h.currentSheetIndex==o?n.push(yt(bi,{index:o,active:"luckysheet-sheets-item-active",name:h.luckysheetfile[t].name,style:"",colorset:a})):(h.luckysheetfile[t].hide==1?n.push(yt(bi,{index:o,active:"",name:h.luckysheetfile[t].name,style:"display:none;",colorset:a})):n.push(yt(bi,{index:o,active:"",name:h.luckysheetfile[t].name,style:"",colorset:a})),l="style='display:none;'"),$("#luckysheet-cell-main").append("<div "+l+' id="luckysheet-datavisual-selection-set-'+o+'" class="luckysheet-datavisual-selection-set"></div>')}$("#luckysheet-sheet-container-c").append(n.join("")),e.locationSheet()},locationSheet:function(){let e=$("#luckysheet-sheet-container-c"),n=$("#"+h.container).width(),t=$("#luckysheet-sheet-container-c > div.luckysheet-sheets-item-active").eq(0),l=0,o=0;$("#luckysheet-sheet-container-c > div.luckysheet-sheets-item:visible").each(function(){$(this).hasClass("luckysheet-sheets-item-active")&&(l=o),o+=$(this).outerWidth()}),setTimeout(function(){e.scrollLeft(l-10),lt.showsheetbarConfig.sheet&&(o>=n*.7?($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","inline-block"),$("#luckysheet-sheet-container .docs-sheet-fade-left").show()):($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","none"),$("#luckysheet-sheet-container .docs-sheet-fade-left").hide()))},1)},copySheet:function(e,n){if(Qe()||h.allowEdit===!1)return;let t=this,l=h.luckysheetfile.length,o=t.generateRandomSheetIndex(),a=t.getSheetIndex(e),s=$.extend(!0,{},h.luckysheetfile[a]);if(s.order=l,s.index=o,s.name=t.generateCopySheetName(h.luckysheetfile,s.name),!Yt.createHookFunction("sheetCopyBefore",{targetSheet:h.luckysheetfile[a],copySheet:s}))return;let u="";s.color!=null&&(u='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+s.color+';"></div>');let f=$("#luckysheet-sheets-item"+e);if($("#luckysheet-sheet-container-c").append(yt(bi,{index:s.index,active:"",name:s.name,order:s.order,style:"",colorset:u})),$("#luckysheet-sheets-item"+s.index).insertAfter(f),h.luckysheetfile.splice(a+1,0,s),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+o).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+o+'" class="luckysheet-datavisual-selection-set"></div>'),Ir(n),He.saveParam("shc",o,{copyindex:e,name:s.name}),t.changeSheetExec(o,void 0,void 0,!0),t.reOrderAllSheet(),h.clearjfundo)h.jfredo.push({type:"copySheet",copyindex:e,index:s.index,sheetIndex:s.index});else if(h.jfredo.length>0){let m=h.jfredo[h.jfredo.length-1];m.type=="copySheet"&&(m.index=s.index,m.sheetIndex=s.index)}},hasSheet:function(e){return!(e==null||(e=this.getSheetIndex(e),e==null))},createSheetbydata:function(e,n,t=!0){let l=this,o="";if(e.color!=null&&(o='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e.color+';"></div>'),$("#luckysheet-sheet-container-c").append(yt(bi,{index:e.index,active:"",name:e.name,order:e.order,style:"",colorset:o})),t){let a=e.order;a>=h.luckysheetfile.length?(a=h.luckysheetfile.length-1,$("#luckysheet-sheets-item"+e.index).insertAfter($("#luckysheet-sheets-item"+h.luckysheetfile[a].index))):$("#luckysheet-sheets-item"+e.index).insertBefore($("#luckysheet-sheets-item"+h.luckysheetfile[a].index))}h.luckysheetfile.push(e),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+e.index).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+e.index+'" class="luckysheet-datavisual-selection-set"></div>'),Ir(),n!=null?(He.saveParam("shre",null,{reIndex:e.index}),e.hide=0,He.saveParam("sh",e.index,0,{op:"show",cur:null})):He.saveParam("sha",null,e),l.changeSheetExec(e.index,e.isPivotTable,!0),l.reOrderAllSheet()},deleteSheet:function(e){let n=this;if(h.allowEdit===!1)return;let t=n.getSheetIndex(e),l=h.luckysheetfile[t];if(!Yt.createHookFunction("sheetDeleteBefore",{sheet:l}))return;n.setSheetHide(e,!0),$("#luckysheet-sheets-item"+e).remove(),$("#luckysheet-datavisual-selection-set-"+e).remove();let o=h.luckysheetfile.splice(t,1);n.reOrderAllSheet(),He.saveParam("shd",null,{deleIndex:e}),h.clearjfundo&&(o[0].type="deleteSheet",h.jfredo.push(o[0])),Yt.createHookFunction("sheetDeleteAfter",{sheet:l})},nulldata:null,getGridData:function(e){let n=[];for(let t=0;t<e.length;t++)for(let l=0;l<e[0].length;l++)e[t][l]!=null&&n.push({r:t,c:l,v:e[t][l]});return n},buildGridData:function(e){let n=e.row==null?h.defaultrowNum:e.row,t=e.column==null?h.defaultcolumnNum:e.column,l=e.data&&e.data.length>0?e.data:Hr([],n,t),o=e.celldata;if(e.data&&e.data.length>0)for(let a=0;a<l.length;a++)for(let s=0;s<l[0].length;s++)er(a,s,l,l[a][s]);else if(o&&o.length>0)for(let a=0;a<o.length;a++){let s=o[a],u=s.r,f=s.c,m=s.v;u>=l.length&&(l=Hr(l,u-l.length+1,0)),f>=l[0].length&&(l=Hr(l,0,f-l[0].length+1)),er(u,f,l,m)}return lt.autoFormatw=!1,lt.accuracy=void 0,l},cutGridData:function(e){let n=0;for(let t=e.length-1;t>=0;t--){let l=!0;for(let o=0;o<e[0].length;o++){let a=Mt(t,o);if(a!=null&&$.trim(a).length>0){l=!1;break}}if(l)n=t;else break}return e.slice(0,n)},addGridData:function(e,n,t){let l=Hr([],n,t);if(e!=null)for(let o=0;o<e.length;o++){let a=e[o],s=a.r,u=a.c,f=a.v;s>=l.length&&(l=Hr(l,s-l.length+1,0)),u>=l[0].length&&(l=Hr(l,0,u-l[0].length+1)),er(s,u,l,f)}return l},sheetParamRestore:function(e,n){if(h.luckysheet_select_save=e.luckysheet_select_save,(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0)&&(n[0]!=null&&n[0][0]!=null&&n[0][0].mc!=null?h.luckysheet_select_save=[{row:[0,n[0][0].mc.rs-1],column:[0,n[0][0].mc.cs-1]}]:h.luckysheet_select_save=[{row:[0,0],column:[0,0]}]),h.luckysheet_selection_range=e.luckysheet_selection_range==null?[]:e.luckysheet_selection_range,h.config=e.config==null?{}:e.config,h.zoomRatio=e.zoomRatio==null?1:e.zoomRatio,e.defaultRowHeight!=null?h.defaultrowlen=parseFloat(e.defaultRowHeight):h.defaultrowlen=lt.defaultRowHeight,e.defaultColWidth!=null?h.defaultcollen=parseFloat(e.defaultColWidth):h.defaultcollen=lt.defaultColWidth,e.showGridLines!=null){let t=e.showGridLines;t==0||t==!1?h.showGridLines=!1:h.showGridLines=!0}else h.showGridLines=!0},initialjfFile:function(e,n){let t=this;t.getCurSheet();let l=h.luckysheetfile[t.getSheetIndex(h.currentSheetIndex)];t.nulldata=Hr([],h.defaultrowNum,h.defaultcolumnNum);let o=t.buildGridData(l),a=[];l.jfgird_select_save=l.jfgird_select_save||[],l.jfgird_select_save.forEach(d=>a.push({row:d.row,column:d.column})),l.luckysheet_select_save=a,this.sheetParamRestore(l,o);let s=h.luckysheet_select_save[0].row[1],u=h.luckysheet_select_save[0].column[1];if(h.luckysheet_select_save.length>1)for(let d=0;d<h.luckysheet_select_save.length;d++)h.luckysheet_select_save[d].row[1]>s&&(s=h.luckysheet_select_save[d].row[1]),h.luckysheet_select_save[d].column[1]>u&&(u=h.luckysheet_select_save[d].column[1]);ht.fontInitial(h.fontList),l.data=o;let f=o.length;s>f-1&&(f=s+1);let m=o[0].length;u>m-1&&(m=u+1),typeof lt.beforeCreateDom=="function"&&lt.beforeCreateDom(luckysheet),typeof lt.workbookCreateBefore=="function"&&lt.workbookCreateBefore(luckysheet),eg(m,f,o,e,n),setTimeout(function(){de.createHoverTip("#luckysheet_info_detail",".luckysheet_info_detail_back, .luckysheet_info_detail_input, .luckysheet_info_detail_update"),de.createHoverTip("#luckysheet-wa-editor",".luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button"),h.luckysheetTableContentHW=[$("#luckysheet-cell-main").width()+h.rowHeaderWidth-h.cellMainSrollBarSize,$("#luckysheet-cell-main").height()+h.columnHeaderHeight-h.cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(h.luckysheetTableContentHW[0]*h.devicePixelRatio),height:Math.ceil(h.luckysheetTableContentHW[1]*h.devicePixelRatio)}).css({width:h.luckysheetTableContentHW[0],height:h.luckysheetTableContentHW[1]}).get(0).getContext("2d");let d=Oe().info,b=He.gridKey+"__qkcache",y=function(){l.load="1",t.createSheet();let p=function(){t.mergeCalculation(l.index),t.setSheetParam(!1),t.storeSheetParam(),t.restoreselect(),t.CacheNotLoadControll=[],t.restoreCache(),v.execFunctionGroupForce(lt.forceCalculation),t.restoreSheetAll(h.currentSheetIndex),$("#luckysheet_info_detail_save").html(d.detailSave),l.isPivotTable?h.luckysheetcurrentisPivotTable=!0:(h.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide()),Ey(),Kl(),l.scrollLeft!=null&&l.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(l.scrollLeft):$("#luckysheet-scrollbar-x").scrollLeft(0),l.scrollTop!=null&&l.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(l.scrollTop):$("#luckysheet-scrollbar-y").scrollTop(0),_h(h.asyncLoad,"core"),lt.pointEdit?setTimeout(function(){h.loadingObj.close()},0):setTimeout(function(){h.loadingObj.close()},500)},x=He.loadSheetUrl;if(x=="")t.loadOtherFile(l),p();else{let _=t.checkLoadSheetIndex(l),S=[];for(let I=0;I<_.length;I++){let O=_[I];O!=l.index&&S.push(O)}if(S.length===0){p();return}$.post(x,{gridKey:He.gridKey,index:S.join(",")},function(I){let O=new Function("return "+I)();for(let F in O){if(F==l.index)continue;let D=h.luckysheetfile[t.getSheetIndex(F)];(D.load==null||D.load=="0")&&(D.celldata=O[F.toString()],D.data=t.buildGridData(D),D.load="1")}p()})}};try{localforage.getItem(b).then(function(p){p!=null&&(t.CacheNotLoadControll=p),He.clearcachelocaldata(function(){y()})})}catch(p){y(),console.log("\u7F13\u5B58\u64CD\u4F5C\u5931\u8D25")}},1)},storeSheetParam:function(){let e=this.getSheetIndex(h.currentSheetIndex),n=h.luckysheetfile[e];n.config=h.config,n.visibledatarow=h.visibledatarow,n.visibledatacolumn=h.visibledatacolumn,n.ch_width=h.ch_width,n.rh_height=h.rh_height,n.luckysheet_select_save=$.extend(!0,[],h.luckysheet_select_save),n.luckysheet_selection_range=$.extend(!0,[],h.luckysheet_selection_range),$("#luckysheet-scrollbar-x")[0].scrollWidth>$("#luckysheet-scrollbar-x")[0].offsetWidth&&(n.scrollLeft=$("#luckysheet-scrollbar-x").scrollLeft()),$("#luckysheet-scrollbar-y")[0].scrollHeight>$("#luckysheet-scrollbar-y")[0].offsetHeight&&(n.scrollTop=$("#luckysheet-scrollbar-y").scrollTop()),n.zoomRatio=h.zoomRatio},setSheetParam:function(e=!0){let n=this.getSheetIndex(h.currentSheetIndex),t=h.luckysheetfile[n];h.flowdata=t.data,pt.webWorkerFlowDataCache(h.flowdata),v.execFunctionGlobalData=null,window.luckysheet_getcelldata_cache=null,this.sheetParamRestore(t,h.flowdata),t.freezen==null?(we.freezenhorizontaldata=null,we.freezenverticaldata=null):(we.freezenhorizontaldata=t.freezen.horizontal==null?null:t.freezen.horizontal.freezenhorizontaldata,we.freezenverticaldata=t.freezen.vertical==null?null:t.freezen.vertical.freezenverticaldata),e&&ya(h.flowdata.length,h.flowdata[0].length),Nt.buildAllPs(h.flowdata),$t.currentImgId=null,$t.images=t.images,$t.allImagesShow(),$t.init(),Vt.dataVerification=t.dataVerification,Vt.init(),Mn.hyperlink=t.hyperlink,Mn.init(),Bn(t.filter_select,t.filter)},restoreselect:function(){let e=this.getSheetIndex(h.currentSheetIndex),n=h.luckysheetfile[e];Zt(!0),Jl(),n.scrollLeft!=null&&n.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft):$("#luckysheet-scrollbar-x").scrollLeft(0),n.scrollTop!=null&&n.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop):$("#luckysheet-scrollbar-y").scrollTop(0)},storeSheetParamALL:function(){let e=this;e.storeSheetParam();let n=e.getSheetIndex(h.currentSheetIndex);h.luckysheetfile[n].data=h.flowdata,h.luckysheetfile[n].config=$.extend(!0,{},h.config)},mergeCalculationSheet:{},mergeCalculation:function(e){let n=h.luckysheetfile[this.getSheetIndex(e)],t=n.config,l=n.data;if(t==null)return;let o=t.merge;if(!(o==null||e in this.mergeCalculationSheet||n.autoCalculationMerge===!1)){this.mergeCalculationSheet[e]=1;for(let a in o){let s=parseInt(a.substr(0,a.indexOf("_"))),u=parseInt(a.substr(a.indexOf("_")+1)),f=o[a];l[s][u]==null&&(l[s][u]={}),l[s][u].mc={r:s,c:u,rs:f.rs,cs:f.cs};for(let m=s;m<s+f.rs;m++)for(let d=u;d<u+f.cs;d++)m==s&&d==u||(l[m][d]==null&&(l[m][d]={}),l[m][d].mc={r:s,c:u})}}},loadOtherFile:function(e){let n=this;for(let t=0;t<h.luckysheetfile.length;t++){let l=h.luckysheetfile[t];l.index!=e.index&&(l.load==null||l.load=="0")&&(l.data=n.buildGridData(l),l.load="1")}},changeSheet:function(e,n,t,l){if(Qe())return;let o=this;if(e==h.currentSheetIndex)return;He.allowUpdate&&($("#luckysheet-cell-main #luckysheet-multipleRange-show").empty(),He.multipleIndex=0);let a=h.luckysheetfile[o.getSheetIndex(e)];if(t&&Yt.createHookFunction("sheetCreateAfter",{sheet:a}),l&&Yt.createHookFunction("sheetCopyAfter",{sheet:a}),Yt.createHookFunction("sheetActivate",e,n,t),$("#luckysheet-filter-selected-sheet"+h.currentSheetIndex+", #luckysheet-filter-options-sheet"+h.currentSheetIndex).hide(),$("#luckysheet-filter-selected-sheet"+e+", #luckysheet-filter-options-sheet"+e).show(),o.storeSheetParamALL(),o.setCurSheet(e),a.isPivotTable?(h.luckysheetcurrentisPivotTable=!0,n||Pt.changePivotTable(e)):(h.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide(),Kl(!1)),a.load!=null){let u=o.buildGridData(a);a.data=u,o.mergeCalculation(e),o.setSheetParam(!0),o.showSheet(),setTimeout(function(){v.execFunctionGroup(),Et(),He.saveParam("shs",null,h.currentSheetIndex)},1)}else{let u=He.loadSheetUrl;if(u==""||h.luckysheetcurrentisPivotTable||!!t){let f=o.buildGridData(a);a.data=f,a.load="1",o.mergeCalculation(e),o.setSheetParam(),o.showSheet(),setTimeout(function(){o.restoreCache(),v.execFunctionGroupForce(lt.forceCalculation),o.restoreSheetAll(h.currentSheetIndex),Et()},1),He.saveParam("shs",null,h.currentSheetIndex)}else{$("#luckysheet-grid-window-1").append(ko());let f=o.checkLoadSheetIndex(a);$.post(u,{gridKey:He.gridKey,index:f.join(",")},function(m){let d=new Function("return "+m)();a.celldata=d[e.toString()];let g=o.buildGridData(a);setTimeout(function(){h.loadingObj.close()},500);for(let b in d){if(b==e)continue;let y=h.luckysheetfile[o.getSheetIndex(b)];(y.load==null||y.load=="0")&&(y.celldata=d[b.toString()],y.data=o.buildGridData(y),y.load="1")}a.data=g,a.load="1",o.mergeCalculation(e),o.setSheetParam(),o.showSheet(),setTimeout(function(){o.restoreCache(),v.execFunctionGroupForce(lt.forceCalculation),o.restoreSheetAll(h.currentSheetIndex),Et()},1),He.saveParam("shs",null,h.currentSheetIndex)})}}$("#luckysheet-cell-main .luckysheet-datavisual-selection-set").hide(),$("#luckysheet-datavisual-selection-set-"+e).show(),ug(e),we.initialFreezen(e),o.restoreselect()},checkLoadSheetIndexToDataIndex:{},checkLoadSheetIndex:function(e){let n=v.getAllFunctionGroup(),t=e.chart,l=e.pivotTable,o=[],a={};if(e.index in this.checkLoadSheetIndexToDataIndex)return[];if(o.push(e.index),a[e.index.toString()]=1,this.checkLoadSheetIndexToDataIndex[e.index]=1,n!=null){let s={};for(let u=0;u<n.length;u++){let f=n[u],m=f.index,d=Jn(f.r,f.c,m);if(d==null){let g=h.luckysheetfile[this.getSheetIndex(m)];if(g.data=this.buildGridData(g),d=Jn(f.r,f.c,m),d==null)continue}if(d.indexOf("!")==-1)v.addToSheetIndexList(d,m);else if(v.formulaContainSheetList!=null&&v.formulaContainSheetList[d]!=null)for(let g in v.formulaContainSheetList[d])s[g]=1;else v.functionParser(d,g=>{if(v.addToCellList(d,g),g.indexOf("!")>-1){let b=g.substr(0,g.indexOf("!")),y=this.getSheetByName(b);if(y!=null){let p=y.index;s[p]=1,v.addToSheetIndexList(d,p)}}}),v.formulaContainSheetList[d]==null&&v.addToSheetIndexList(d,m);m!=null}for(let u in s){let f=u;a[f.toString()]==null&&(o.push(f),a[f.toString()]=1,this.checkLoadSheetIndexToDataIndex[f]=1)}}if(t!=null)for(let s=0;s<t.length;s++){let f=t[s].dataSheetIndex;f!=null&&a[f.toString()]==null&&(o.push(f),a[f.toString()]=1)}if(l!=null){let s=l.pivotDataSheetIndex;s!=null&&a[s.toString()]==null&&(o.push(s),a[s.toString()]=1)}return o},showSheet:function(){$("#luckysheet-cell-flow_0").css({width:h.ch_width,top:"-1px"}),$("#luckysheet-sheettable_0").css({width:h.ch_width-1,height:h.rh_height}),$("#luckysheetrowHeader_0").css("height",h.rh_height),$("#luckysheet-cols-h-cells_0").css("width",h.ch_width),$("#luckysheet-scrollbar-x div").width(h.ch_width),$("#luckysheet-scrollbar-y div").height(h.rh_height+h.columnHeaderHeight-h.cellMainSrollBarSize-3);let e=this.getSheetIndex(h.currentSheetIndex),n=h.luckysheetfile[e];h.scrollRefreshSwitch=!1,n.scrollLeft!=null&&n.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft*h.zoomRatio):$("#luckysheet-scrollbar-x").scrollLeft(0),n.scrollTop!=null&&n.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop*h.zoomRatio):$("#luckysheet-scrollbar-y").scrollTop(0),setTimeout(()=>{h.scrollRefreshSwitch=!0},0),Ii(h.zoomRatio)},setCurSheet:function(e){for(let n=0;n<h.luckysheetfile.length;n++)h.luckysheetfile[n].index==e?h.luckysheetfile[n].status=1:h.luckysheetfile[n].status=0;h.currentSheetIndex=e},getSheetIndex:function(e){for(let n=0;n<h.luckysheetfile.length;n++)if(h.luckysheetfile[n].index==e)return n;return null},changeSheetExec:function(e,n,t,l){let o=$("#luckysheet-sheets-item"+e);window.luckysheet_getcelldata_cache=null,$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),o.addClass("luckysheet-sheets-item-active").show(),Ir(),this.changeSheet(e,n,t,l),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),v.rangestart&&v.createRangeHightlight(),this.sheetBarShowAndHide(e)},sheetArrowShowAndHide(){let e=$("#luckysheet-sheet-container-c");if(!!e.length){var n=e[0].scrollWidth,t=Math.ceil(e.width());n>t?lt.showsheetbarConfig.sheet&&($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","inline-block"),$("#luckysheet-sheet-container .docs-sheet-fade-left").show()):($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","none"),$("#luckysheet-sheet-container .docs-sheet-fade-left").hide())}},sheetBarShowAndHide(e){let n=$("#luckysheet-sheet-container-c");if(e!=null){let a=$("#luckysheet-sheets-item"+e);n.scrollLeft(a.offset().left)}let t=n.width(),l=n[0].scrollWidth,o=n.scrollLeft();o<=0?$("#luckysheet-sheet-container .docs-sheet-fade-left").hide():$("#luckysheet-sheet-container .docs-sheet-fade-left").show(),t+o>=l?$("#luckysheet-sheet-container .docs-sheet-fade-right").hide():$("#luckysheet-sheet-container .docs-sheet-fade-right").show()},delChart:function(e,n){let t=this.getSheetIndex(n),l=h.luckysheetfile[t];if(l.chart==null)l.chart=[];else for(let o=0;o<l.chart.length;o++)if(l.chart[o].chart_id==e){h.luckysheetfile[t].chart.splice(o,1);break}},saveChart:function(e){let n=this.getSheetIndex(e.sheetIndex),t=h.luckysheetfile[n];if(t.chart==null)t.chart=[],t.chart.push(e);else{for(let l=0;l<t.chart.length;l++)if(t.chart[l].chart_id==e.chart_id){let o=$.extend(!0,{},t.chart[l]);t.chart[l]=$.extend(!0,{},o,e);return}t.chart.push(e)}},getChart:function(e,n){let t=this.getSheetIndex(e),l=h.luckysheetfile[t];if(l.chart==null)return null;for(let o=0;o<l.chart.length;o++)if(l.chart[o].chart_id==n)return l.chart[o];return null},getRangetxt:function(e,n,t){let l="";t==null&&(t=h.currentSheetIndex),e!=t&&(l=h.luckysheetfile[this.getSheetIndex(e)].name+"!");let o=n.row[0],a=n.row[1],s=n.column[0],u=n.column[1];return o==null&&a==null?l+Qt(s)+":"+Qt(u):s==null&&u==null?l+(o+1)+":"+(a+1):s==u&&o==a?l+Qt(s)+(o+1):l+Qt(s)+(o+1)+":"+Qt(u)+(a+1)},getSheetName:function(e){return e==null&&(e=h.currentSheetIndex),h.luckysheetfile[this.getSheetIndex(e)].name},getSheetMerge:function(){return h.config.merge==null?null:h.config.merge},getSheetData:function(e){return e==null&&(e=h.currentSheetIndex),h.luckysheetfile[this.getSheetIndex(e)].data},getSheetConfig:function(e){let n=this;return e==null&&(e=h.currentSheetIndex),h.luckysheetfile[n.getSheetIndex(e)].config==null&&(h.luckysheetfile[n.getSheetIndex(e)].config={}),h.luckysheetfile[n.getSheetIndex(e)].config},restoreFilter:function(e){let n=this.getSheetIndex(e),t=h.luckysheetfile[n];if(V(t.filter_select)=="string"&&(t.filter_select=JSON.parse(t.filter_select)),t.filter_select==null||t.filter_select.row==null||t.filter_select.column==null)return;Bn(t.filter_select),V(t.filter)!="object"&&t.filter!=null&&V(t.filter)=="string"&&(t.filter=JSON.parse(t.filter));let l={};t.config!=null&&t.config.rowhidden!=null&&(l=t.config.rowhidden),$("#luckysheet-filter-options-sheet"+e+" .luckysheet-filter-options").each(function(o){if(t.filter==null)return!1;let a=$(this),s=t.filter[o];if(s==null)return!0;V(s)!="object"&&(s=JSON.parse(s)),Xa(a,s.optionstate,s.rowhidden,s.caljs,!1,s.st_r,s.ed_r,s.cindex,s.st_c,s.ed_c),l=$.extend(!0,l,s.rowhidden)}),t.config==null&&(t.config={}),t.config.rowhidden=l,h.config=t.config,Nl(h.flowdata.length,h.flowdata[0].length,!1)},restorePivot:function(e){let n=this.getSheetIndex(e);!h.luckysheetfile[n].isPivotTable||(Pt.getCellData(e),Pt.initialPivotManage(!0),Pt.refreshPivotTable(!1))},restoreSheetAll:function(e){let n=this;n.restorePivot(e),n.restoreFilter(e),n.restoreFreezen(e)},restoreFreezen:function(e){we.initialFreezen(e)},restoreCache:function(){let e=this,n=e.CacheNotLoadControll;if(e.CacheNotLoadControll=[],n.length!=0)for(let t=0;t<n.length;t++){let l=n[t];e.execCache(l)}},CacheNotLoadControll:[],execCache:function(e){let n=this,t=e.t,l=e.i,o=e.v,a=h.luckysheetfile[n.getSheetIndex(l)];if(t=="sha")h.luckysheetfile.push(o);else if(t=="shc"){let s=$.extend(!0,{},h.luckysheetfile[n.getSheetIndex(o.copyindex)]);s.index=l,h.luckysheetfile.push(s)}else if(t=="shd")h.luckysheetfile.splice(o.deleIndex,1);else if(t=="shr")for(let s in o)h.luckysheetfile[n.getSheetIndex(s)].order=o[s];if((a==null||a.load!="1")&&!(t in{sha:0,shc:0,shd:0,shr:0})){n.CacheNotLoadControll.push(e);return}if(t=="v"){let s=e.r,u=e.c,f=e.v,m=n.getSheetData(l);a.data[s][u]=f}else if(t=="fc"){let s=e.op,u=e.pos;V(o)!="object"&&(o=new Function("return "+o)());let f=o.r,m=o.c;s=="del"?v.delFunctionGroup(f,m,l):v.insertUpdateFunctionGroup(f,m,l)}else if(t=="cg"){let s=o,u=e.k,f=n.getSheetConfig(l);u in f||(f[u]={});for(let m in s)f[u][m]=s[m];h.config=f}else if(t=="f"){let s=o,u=e.op,f=e.pos,m=a.filter;m==null&&(m={}),u=="upOrAdd"?m[f]=s:u=="del"&&delete m[f]}else if(t=="fsc")a.filter=null,a.filter_select=null;else if(t=="fsr"){let s=o;a.filter=s.filter,a.filter_select=s.filter_select}else if(t=="sh"){let s=e.op,u=e.cur,f=o;if(s=="hide")a.status=0,h.luckysheetfile[n.getSheetIndex(u)].status=1;else if(s=="show"){for(let m=0;m<h.luckysheetfile.length;m++)h.luckysheetfile[m].status=0;a.status=1}}else if(t=="all"){let s=e.k;e.s&&V(o)!="object"?a[s]=JSON.stringify(o):a[s]=o}else if(t=="c"){let s=e.op,u=e.cid;if(s=="add")a.chart.push(o);else if(s=="xy"||s=="wh"||s=="update"){for(let f=0;f<a.chart.length;f++)if(a.chart[f].chart_id==u){for(let m in a.chart[f])for(let d in o)m==d&&(a.chart[f][m]=o[d]);return}}else if(s=="del"){for(let f=0;f<a.chart.length;f++)if(a.chart[f].chart_id==u){a.chart.splice(f,1);return}}}else if(t=="drc"){let s=e.rc,u=o.index,f=o.len,m=a.celldata;if(s=="r"){for(let p=0;m.length==0;p++){let x=m[p];x.r>=u&&x.r<u+f?delete m[p]:x.r>=u+f&&(x.r-=f)}a.row-=f}else{for(let p=0;m.length==0;p++){let x=m[p];x.c>=u&&x.c<u+f?delete m[p]:x.c>=u+f&&(x.c-=f)}a.column-=f}let d=[];for(let p=0;p<m.length;p++)m[p]!=null&&d.push(m[p]);a.celldata=d;let g,b,y;s=="r"?g="row":g="column",b=u,y=u+f-1,Za(g,b,y,!0)}else if(t=="arc"){let s=e.rc,u=o.index,f=o.len,m=a.celldata;if(s=="r"){for(let g=0;g<m.length;g++){let b=m[g];b.r>u&&(b.r+=f)}a.row+=f}else{for(let g=0;g<m.length;g++){let b=m[g];b.c>u&&(b.c+=f)}a.column+=f}let d;s=="r"?d="row":d="column",oo(d,u,f,!0)}else t=="na"?He.saveParam("na",null,o):t=="thumb"&&setTimeout(function(){n.imageRequest()},2e3)}},ct=p3});var import_plugin,v3,v,ir=Tt(()=>{import_plugin=Le(Be());gl();ql();Ea();ar();Yr();Mr();wr();li();jn();Vi();vr();Gl();Co();Hi();mr();io();Hn();br();Sr();Qn();pa();fr();va();Uu();Ut();Rl();Sc();qn();v3={error:{v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},errorInfo:function(e){return e},errorParamCheck:function(e,n,t){let l,o,s=Oe().formulaMore;return t<e.length?(l=e[t].type,o=e[t].require):(l=e[e.length-1].type,o=e[e.length-1].require),o=="o"&&(n==null||n=="")?[!0,s.tipSuccessText]:l.indexOf("all")>-1?[!0,s.tipSuccessText]:l.indexOf("range")>-1&&(V(n)=="object"||V(n)=="array")?[!0,s.tipSuccessText]:l.indexOf("number")>-1&&(Y(n)||V(n)=="boolean")?[!0,s.tipSuccessText]:l.indexOf("string")>-1&&V(n)=="string"?[!0,s.tipSuccessText]:l.indexOf("date")>-1&&Zl(n)?[!0,s.tipSuccessText]:[!1,s.tipParamErrorText]},getPureValueByData:function(e){if(e.length==0)return[];let n=[];if(V(e)=="array")if(V(e[0])=="array")for(let t=0;t<e.length;t++){let l=[];for(let o=0;o<e[0].length;o++){let a=e[t][o];V(a)=="object"?l.push(a.v):l.push(a)}n.push(l)}else for(let t=0;t<e.length;t++){let l=e[t];V(l)=="object"?n.push(l.v):n.push(l)}else{let t=e;V(t)=="object"?n.push(t.v):n.push(t)}return n},readCellDataToOneArray:function(e){let n=this;if(e==null)return[];if(V(e)!="object")return[e];let t=[],l=[];if(e!=null&&e.data!=null)l=e.data;else return e!=null&&!rt(e.v)?[e.v]:[];if(V(l)=="array")l=n.getPureValueByData(l);else{if(V(l)=="object")return l=l.v,[l];/\{.*?\}/.test(l)&&(l=l.replace(/\{/g,"[").replace(/\}/g,"]")),l=new Function("return "+l)()}if(V(l[0])=="array")for(let o=0;o<l.length;o++)t=t.concat(l[o]);else t=l;return t},getValueByFuncData:function(e,n){if(e==null)return null;let t=this;return V(e)=="array"?n=="avg"?luckysheet_function.AVERAGE.f.apply(luckysheet_function.AVERAGE,e):n=="sum"?luckysheet_function.SUM.f.apply(luckysheet_function.SUM,e):V(e[0])=="object"?luckysheet.mask.getValueByFormat(e[0]):e[0]:V(e)=="object"?luckysheet.mask.getValueByFormat(e):e},sparklinesColorMap:function(e,n){let t=this,l=null;n==null&&(n=5);let o=0;if(e.length>n)for(let a=n;a<e.length;a++){let s=e[a],u=t.readCellDataToOneArray(s);for(let f=0;f<u.length;f++){let m=u[f];if(m.indexOf(":")>-1){l||(l={});let d=m.split(":");d.length==2?l[d[0]]=d[1]:d.length>1&&(l[d[0]+":"+d[1]]=d[2])}else l||(l=[]),l.push(m)}o++}return l},colorList:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],classlist:{province:{11:"\u5317\u4EAC",12:"\u5929\u6D25",13:"\u6CB3\u5317",14:"\u5C71\u897F",15:"\u5185\u8499\u53E4",21:"\u8FBD\u5B81",22:"\u5409\u6797",23:"\u9ED1\u9F99\u6C5F",31:"\u4E0A\u6D77",32:"\u6C5F\u82CF",33:"\u6D59\u6C5F",34:"\u5B89\u5FBD",35:"\u798F\u5EFA",36:"\u6C5F\u897F",37:"\u5C71\u4E1C",41:"\u6CB3\u5357",42:"\u6E56\u5317",43:"\u6E56\u5357",44:"\u5E7F\u4E1C",45:"\u5E7F\u897F",46:"\u6D77\u5357",50:"\u91CD\u5E86",51:"\u56DB\u5DDD",52:"\u8D35\u5DDE",53:"\u4E91\u5357",54:"\u897F\u85CF",61:"\u9655\u897F",62:"\u7518\u8083",63:"\u9752\u6D77",64:"\u5B81\u590F",65:"\u65B0\u7586",71:"\u53F0\u6E7E",81:"\u9999\u6E2F",82:"\u6FB3\u95E8",91:"\u56FD\u5916"}},oldvalue:null,dontupdate:function(){let e=this;h.luckysheetCellUpdate.length=0,$("#luckysheet-functionbox-cell, #luckysheet-rich-text-editor").html(e.oldvalue),e.cancelNormalSelected(),e.rangetosheet!=h.currentSheetIndex&&ct.changeSheetExec(e.rangetosheet)},xssDeal:function(e){return typeof e!="string"?e:e.replace(/<script>/g,"&lt;script&gt;").replace(/<\/script>/,"&lt;/script&gt;")},ltGtSignDeal:function(e){return typeof e!="string"||e.substr(0,5)==="<span"||e.startsWith("=")?e:e.replace(/</g,"&lt;").replace(/>/g,"&gt;")},fucntionboxshow:function(e,n){if(!gh(e,n,h.currentSheetIndex)){$("#luckysheet-functionbox-cell").html("");return}let t=this,l=h.flowdata,o="";if(l[e]!=null&&l[e][n]!=null){let a=$.extend(!0,{},l[e][n]);wn(a)?o=Sy(e,n):a.f!=null?o=Mt(e,n,l,"f"):o=ba(e,n,l)}o=this.xssDeal(o),t.oldvalue=o,$("#luckysheet-functionbox-cell").html(o)},cellOffset:function(e,n,t,l,o){let a=e.startCell,s=e.rowl,u=e.coll,f=parseInt(a.replace(/[^0-9]/g,"")),m=jr(a.replace(/[^A-Za-z]/g,"")),d=[],g=[],b;d[0]=f+n,g[0]=m+t,d[1]=d[0]+l-1,g[1]=g[0]+o-1,g[0]=Qt(g[0]),g[1]=Qt(g[1]);let y=g[0]+d[0],p=g[1]+d[1];return y==p?b=e.sheetName+"!"+y:b=e.sheetName+"!"+y+":"+p,b},parseDatetoNum:function(e){let n=this;if(typeof e=="object"&&typeof e.v=="number")e=e.v;else if(xi(e)=="num")e=parseFloat(e);else if(xi(e)=="date")e=nl(e)[2];else return n.error.v;return e},getRangeArray:function(e){let n=[],t="General";if(e.length==1)for(let l=0;l<e[0].length;l++)if(e[0][l]!=null&&e[0][l].v){n.push(e[0][l].v);let o=e[0][l].ct.fa;t=t=="General"?o:t}else n.push(null);else if(e[0].length==1)for(let l=0;l<e.length;l++)if(e[l][0]!=null&&e[l][0].v){n.push(e[l][0].v);let o=e[l][0].ct.fa;t=t=="General"?o:t}else n.push(null);else for(let l=0;l<e.length;l++)for(let o=0;o<e[l].length;o++)if(e[l][o]!=null&&e[l][o].v){n.push(e[l][o].v);let a=e[l][o].ct.fa;t=t=="General"?a:t}else n.push(null);return e=n,[e,t]},getRangeArrayTwo:function(e){let n=$.extend(!0,[],e);if(n.length==1)for(let t=0;t<n[0].length;t++)n[0][t]instanceof Object&&(n[0][t]!=null&&n[0][t]instanceof Object&&!!n[0][t].m?n[0][t]=n[0][t].m:n[0][t]!=null&&n[0][t]instanceof Object&&!!n[0][t].v?n[0][t]=n[0][t].v:n[0][t]=null);else if(n[0].length==1)for(let t=0;t<n.length;t++)n[t][0]instanceof Object&&(n[t][0]!=null&&n[t][0]instanceof Object&&!!n[t][0].m?n[t][0]=n[t][0].m:n[t][0]!=null&&n[t][0]instanceof Object&&!!n[t][0].v?n[t][0]=n[t][0].v:n[t][0]=null);else for(let t=0;t<n.length;t++)for(let l=0;l<n[t].length;l++)n[t][l]instanceof Object&&(n[t][l]!=null&&n[t][l]instanceof Object&&!!n[t][l].m?n[t][l]=n[t][l].m:n[t][l]!=null&&n[t][l]instanceof Object&&!!n[t][l].v?n[t][l]=n[t][l].v:n[t][l]=null);return n},isWildcard:function(e,n){let t=this;e=e.toString(),n=n.toString(),t.isCompareOperator(n).flag&&(n=t.isCompareOperator(n).num);let l="";for(let a=0;a<n.length;a++){let s=n.charAt(a);s=="*"?l+=".*":s=="?"?l+=".":s=="~"?n.charAt(a+1)=="*"?(l+="\\*",a++):n.charAt(a+1)=="?"?(l+="\\?",a++):l+="~":l+=s}let o=new RegExp("^"+l+"$","g");return!!e.match(o)},isCompareOperator:function(e){e=e.toString();let n="",t="",l=e.substr(0,1),o=e.substr(1,1),a=!1,s;return l==">"?o=="="?(n=e.substr(0,2),t=e.substr(2),a=!0):o!="="&&(n=e.substr(0,1),t=e.substr(1),a=!0):l=="<"?o=="="||o==">"?(n=e.substr(0,2),t=e.substr(2),a=!0):o!="="&&o!=">"&&(n=e.substr(0,1),t=e.substr(1),a=!0):l=="="&&o!="="&&(n=e.substr(0,1),t=e.substr(1),a=!0),s={flag:a,ope:n,num:t},s},acompareb:function(e,n){let t=this,l=!1;if(Y(n))l=zc(e,"==",n);else if(typeof n=="string"){if(n.indexOf("*")!=-1||n.indexOf("?")!=-1)return t.isWildcard(e,n);if(t.isCompareOperator(n).flag){let o=t.isCompareOperator(n).ope,a=t.isCompareOperator(n).num;l=zc(e,o,a)}else l=zc(e,"==",n)}return l},compareParams:function(e,n,t){let l=!1,o=toString.call(e),a=toString.call(n);if((t==">"&&e>n||t==">="&&e>=n||t=="<"&&e<n||t=="<="&&e<=n||t=="="&&e==n||t=="<>"&&e!=n)&&(l=!0),o=="[object Object]"&&a=="[object Object]"){let s=Object.getOwnPropertyNames(e),u=Object.getOwnPropertyNames(n);if(s.length!=u.length)return!1;for(let f=0;f<s.length;f++){let m=s[f];if(e[m]!==n[m])return!1}return!0}return o=="[object Array]"&&a=="[object Array]"?e.toString()==n.toString():l},parseDecimal:function(e){e=parseFloat(e);let n=parseInt(e,10);return n==0||(e=e%n),e},getcellrange:function(e,n){if(e==null||e.length==0)return;let t="",l="",o=null,a=null,s=Yl();if(e.indexOf("!")>-1){if(e in this.cellTextToIndexList)return this.cellTextToIndexList[e];let u=e.split("!");t=u[0],l=u[1],t=t.replace(/\\'/g,"'").replace(/''/g,"'"),t.substr(0,1)=="'"&&t.substr(t.length-1,1)=="'"&&(t=t.substring(1,t.length-1));for(let f in s)if(t==s[f].name){o=s[f].index,a=s[f].data;break}}else{let u=n;if(u==null&&(u=h.currentSheetIndex),e+"_"+u in this.cellTextToIndexList)return this.cellTextToIndexList[e+"_"+u];let f=$e(u);t=s[f].name,o=s[f].index,a=h.flowdata,l=e}if(l.indexOf(":")==-1){let u=parseInt(l.replace(/[^0-9]/g,""))-1,f=jr(l.replace(/[^A-Za-z]/g,""));if(!isNaN(u)&&!isNaN(f)){let m={row:[u,u],column:[f,f],sheetIndex:o};return this.addToCellIndexList(e,m),m}else return null}else{l=l.split(":");let u=[],f=[];if(u[0]=parseInt(l[0].replace(/[^0-9]/g,""))-1,u[1]=parseInt(l[1].replace(/[^0-9]/g,""))-1,isNaN(u[0])&&(u[0]=0),isNaN(u[1])&&(u[1]=a.length-1),u[0]>u[1]||(f[0]=jr(l[0].replace(/[^A-Za-z]/g,"")),f[1]=jr(l[1].replace(/[^A-Za-z]/g,"")),isNaN(f[0])&&(f[0]=0),isNaN(f[1])&&(f[1]=a[0].length-1),f[0]>f[1]))return null;let m={row:u,column:f,sheetIndex:o};return this.addToCellIndexList(e,m),m}},rangeHightlightHTML:'<div id="luckysheet-formula-functionrange-highlight-${id}" rangeindex="${id}"  class="luckysheet-selection-highlight luckysheet-formula-functionrange-highlight"><div data-type="top" class="luckysheet-selection-copy-top luckysheet-copy"></div><div data-type="right" class="luckysheet-selection-copy-right luckysheet-copy"></div><div data-type="bottom" class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div data-type="left" class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div><div data-type="lt" class="luckysheet-selection-highlight-topleft luckysheet-highlight"></div><div data-type="rt" class="luckysheet-selection-highlight-topright luckysheet-highlight"></div><div data-type="lb" class="luckysheet-selection-highlight-bottomleft luckysheet-highlight"></div><div data-type="rb" class="luckysheet-selection-highlight-bottomright luckysheet-highlight"></div></div>',createRangeHightlight:function(){let e=this,n=$("#luckysheet-rich-text-editor").find("span.luckysheet-formula-functionrange-cell");$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),n.each(function(){let t=$(this).attr("rangeindex"),l=$(this).text();$("#luckysheet-formula-functionrange").append(yt(e.rangeHightlightHTML,{id:t}));let o=e.getcellrange(l),a="luckysheet-formula-functionrange-highlight-"+t;o==null||(o.sheetIndex==h.currentSheetIndex||o.sheetIndex==-1&&e.rangetosheet==h.currentSheetIndex)&&($("#"+a).data("range",o).find(".luckysheet-copy").css({background:si[t]}).end().find(".luckysheet-highlight").css({background:si[t]}).end().find(".luckysheet-selection-copy-hc").css({background:si[t]}),_1(a,o.row[0],o.row[1],o.column[0],o.column[1]))}),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").show()},searchHTML:'<div id="luckysheet-formula-search-c" class="luckysheet-formula-search-c"></div>',helpHTML:'<div id="luckysheet-formula-help-c" class="luckysheet-formula-help-c"> <div class="luckysheet-formula-help-close" title="${helpClose}"><i class="fa fa-times" aria-hidden="true"></i></div> <div class="luckysheet-formula-help-collapse" title="${helpCollapse}"><i class="fa fa-angle-up" aria-hidden="true"></i></div> <div class="luckysheet-formula-help-title"><div class="luckysheet-formula-help-title-formula"> <span class="luckysheet-arguments-help-function-name">SUM</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> <span class="luckysheet-arguments-help-parameter luckysheet-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="luckysheet-arguments-help-parameter" dir="auto">101</span> </span> <span class="luckysheet-arguments-paren">)</span> </div></div> <div class="luckysheet-formula-help-content"> <div class="luckysheet-formula-help-content-example"> <div class="luckysheet-arguments-help-section-title">${helpExample}</div> <div class="luckysheet-arguments-help-formula"> <span class="luckysheet-arguments-help-function-name">SUM</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> <span class="luckysheet-arguments-help-parameter luckysheet-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="luckysheet-arguments-help-parameter" dir="auto">101</span> </span> <span class="luckysheet-arguments-paren">)</span> </div> </div> <div class="luckysheet-formula-help-content-detail"> <div class="luckysheet-arguments-help-section"> <div class="luckysheet-arguments-help-section-title luckysheet-arguments-help-parameter-name">${helpAbstract}</div> <span class="luckysheet-arguments-help-parameter-content">${helpAbstract}</span> </div> </div> <div class="luckysheet-formula-help-content-param"> ${param} </div> </div> <div class="luckysheet-formula-help-foot"></div></div>',getrangeseleciton:function(){let e=window.getSelection(),n=$(e.anchorNode),t=e.anchorOffset;if(n.parent().is("span")&&t!=0){let l=$.trim(n.text()),o="";if(l.length==0&&n.parent().prev().length>0){let a=n.parent().prev();return l=$.trim(a.text()),o=l.substr(l.length-1,1),a}else return o=l.substr(t-1,1),n.parent()}else if(n.is("#luckysheet-rich-text-editor")||n.is("#luckysheet-functionbox-cell")){let l=$.trim(n.find("span").last().text());if(l.length==0&&n.find("span").length>1){let o=n.find("span");return l=$.trim(o.eq(o.length-2).text()),o}else return n.find("span").last()}else if((n.parent().is("#luckysheet-rich-text-editor")||n.parent().is("#luckysheet-functionbox-cell")||t==0)&&(t==0&&(n=n.parent()),n.prev().length>0)){let l=$.trim(n.prev().text()),o=l.substr(l.length-1,1);return n.prev()}return null},searchFunctionPosition:function(e,n,t,l,o){let a=$(window).height(),s=$(window).width(),u=e.outerWidth(),f=e.outerHeight();o==null&&(o=!1);let m=t;t+u>s?m=t-u+n.outerWidth():m=t;let d=l;l+f>a?d=l-f:(d=l+n.outerHeight(),o||e.html(e.find(".luckysheet-formula-search-item").get().reverse())),d<0&&(d=0),m<0&&(m=0),e.css({top:d,left:m}).show()},searchFunctionCell:null,searchFunction:function(e){let n=this,t=h.functionlist,l=n.getrangeseleciton();if(n.searchFunctionCell=l,l==null||e==null)return;let o=e.text(),a=l.text().toUpperCase();if(!/^[a-zA-Z]|[a-zA-Z_]+$/.test(a)||o.substr(0,1)!="=")return;let u={f:[],s:[],t:[]},f=0;for(let y=0;y<t.length;y++){let p=t[y],x=p.n;if(x==a?(u.f.unshift(p),f++):x.substr(0,a.length)==a?(u.s.unshift(p),f++):x.indexOf(a)>-1&&(u.t.unshift(p),f++),f>=10)break}let m=u.t.concat(u.s.concat(u.f));if(m.length<=0)return;let d=n.searchFunctionHTML(m);$("#luckysheet-formula-search-c").html(d).show(),$("#luckysheet-formula-help-c").hide();let g=e.parent(),b=g.offset();n.searchFunctionPosition($("#luckysheet-formula-search-c"),g,b.left,b.top)},searchFunctionEnter:function(e){let n=this,t=e.data("func");n.searchFunctionCell.text(t).after('<span dir="auto" class="luckysheet-formula-text-color">(</span>'),n.setCaretPosition(n.searchFunctionCell.next().get(0),0,1),$("#luckysheet-formula-search-c").hide(),n.helpFunctionExe(n.searchFunctionCell.closest("div"),n.searchFunctionCell.next())},searchFunctionHTML:function(e){let n=this;$("#luckysheet-formula-search-c").length==0&&($("body").first().append(n.searchHTML),$("#luckysheet-formula-search-c").on("mouseover",".luckysheet-formula-search-item",function(){$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),$(this).addClass("luckysheet-formula-search-item-active")}).on("mouseout",".luckysheet-formula-search-item",function(){}).on("click",".luckysheet-formula-search-item",function(){n.searchFunctionCell!=null&&n.searchFunctionEnter($(this))}));let t='<div data-func="${n}" class="luckysheet-formula-search-item ${class}"><div class="luckysheet-formula-search-func">${n}</div><div class="luckysheet-formula-search-detail">${a}</div></div>',l="";for(let o=0;o<e.length;o++){let a=e[o];o==e.length-1?l+=yt(t,{class:"luckysheet-formula-search-item-active",n:a.n,a:a.a}):l+=yt(t,{class:"",n:a.n,a:a.a})}return l},functionlistPosition:{},helpFunction:function(e,n,t){let l=this,a=h.functionlist[l.functionlistPosition[$.trim(n).toUpperCase()]];if(a==null)return;let u=Oe().formulaMore;$("#luckysheet-formula-help-c .luckysheet-arguments-help-function-name").html(a.n),$("#luckysheet-formula-help-c .luckysheet-arguments-help-parameter-content").html(a.d);let f='<span class="luckysheet-arguments-help-function-name">${name}</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> ${param} </span> <span class="luckysheet-arguments-paren">)</span>',m='<span class="luckysheet-arguments-help-parameter" dir="auto">${param}</span>',d='<div class="luckysheet-arguments-help-section"><div class="luckysheet-arguments-help-section-title">${param}</div><span class="luckysheet-arguments-help-parameter-content">${content}</span></div>',g="",b="",y="";for(let _=0;_<a.p.length;_++){let S=a.p[_],I=S.name,O=S.name;S.repeat=="y"&&(I+=", ...",O+='<span class="luckysheet-arguments-help-argument-info">...-'+u.allowRepeatText+"</span>"),S.require=="o"&&(I="["+I+"]",O+='<span class="luckysheet-arguments-help-argument-info">-['+u.allowOptionText+"]</span>"),g+='<span class="luckysheet-arguments-help-parameter" dir="auto">'+I+"</span>, ",b+='<span class="luckysheet-arguments-help-parameter" dir="auto">'+S.example+"</span>, ",y+=yt(d,{param:O,content:S.detail})}if(g=g.substr(0,g.length-2),b=b.substr(0,b.length-2),$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder").html(g),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder").html(b),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param").html(y),t==null)$("#luckysheet-formula-help-c .luckysheet-formula-help-title-formula .luckysheet-arguments-help-function-name").css("font-weight","bold");else{$("#luckysheet-formula-help-c .luckysheet-formula-help-title-formula .luckysheet-arguments-help-function-name").css("font-weight","normal");let _=t>=a.p.length?a.p.length-1:t;$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").eq(_).addClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").eq(_).addClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param .luckysheet-arguments-help-section").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param .luckysheet-arguments-help-section").eq(_).addClass("luckysheet-arguments-help-parameter-active")}let p=e.parent(),x=p.offset();l.searchFunctionPosition($("#luckysheet-formula-help-c"),p,x.left,x.top,!0)},helpFunctionExe:function(e,n){let t=this,l=h.functionlist,a=Oe().formulaMore;if($("#luckysheet-formula-help-c").length==0){$("body").first().after(yt(t.helpHTML,{helpClose:a.helpClose,helpCollapse:a.helpCollapse,helpExample:a.helpExample,helpAbstract:a.helpAbstract})),$("#luckysheet-formula-help-c .luckysheet-formula-help-close").click(function(){$("#luckysheet-formula-help-c").hide()}),$("#luckysheet-formula-help-c .luckysheet-formula-help-collapse").click(function(){let y=$("#luckysheet-formula-help-c .luckysheet-formula-help-content");y.slideToggle(100,function(){let p=t.rangeResizeTo.parent(),x=p.offset();t.searchFunctionPosition($("#luckysheet-formula-help-c"),p,x.left,x.top,!0)}),y.is(":hidden")?$(this).html('<i class="fa fa-angle-up" aria-hidden="true"></i>'):$(this).html('<i class="fa fa-angle-down" aria-hidden="true"></i>')});for(let y=0;y<l.length;y++)t.functionlistPosition[l[y].n]=y}if(!n)return;let s=n,u=e.length,f=e.find("span"),m=n.index(),d=m;if(s==null)return;let g=null,b=null;if(f.eq(d).is(".luckysheet-formula-text-func"))g=f.eq(d).text();else{let y=null,p=[-1,-1];for(;--d>0;)if(y=f.eq(d),y.is(".luckysheet-formula-text-func")||$.trim(y.text()).toUpperCase()in t.functionlistPosition){g=y.text(),b=null;let x=!0;for(let _=d;_<=m;_++)if(b||(b=0),!(_>=p[0]&&_<=p[1])){if(y=f.eq(_),y.is(".luckysheet-formula-text-rpar")){p=[d,_],g=null,x=!1;break}y.is(".luckysheet-formula-text-comma")&&b++}if(x)break}}g!=null&&t.helpFunction(e,g,b)},rangeHightlightselected:function(e,n){let t=this,l=t.getrangeseleciton();if($("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide(),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight .luckysheet-selection-copy-hc").css("opacity","0.03"),$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide(),t.helpFunctionExe(e,l),$(l).closest(".luckysheet-formula-functionrange-cell").length==0){t.searchFunction(e);return}let a=$(l).closest(".luckysheet-formula-functionrange-cell").attr("rangeindex"),s="luckysheet-formula-functionrange-highlight-"+a;$("#"+s).find(".luckysheet-selection-copy-hc").css({opacity:"0.13"})},updatecell:function(e,n,t,l=!0){let o=this,a=$("#luckysheet-rich-text-editor"),s=a.text(),u=a.html();if(o.rangetosheet!=null&&o.rangetosheet!=h.currentSheetIndex&&ct.changeSheetExec(o.rangetosheet),!xa(e,n,h.currentSheetIndex))return;if(Vt.dataVerification!=null){let F=Vt.dataVerification[e+"_"+n];if(F!=null&&F.prohibitInput&&!Vt.validateCellData(s,F)){let D=Vt.getFailureText(F);de.info(D,""),o.cancelNormalSelected();return}}let f=h.flowdata[e][n],m=JSON.stringify(f),d=wn(f),g=s.slice(0,1)!="="&&u.substr(0,5)=="<span",b=!1;if(!g&&s&&s.length>0){let F=s.replace(/\r\n/g,"_x000D_").replace(/&#13;&#10;/g,"_x000D_").replace(/\r/g,"_x000D_").replace(/\n/g,"_x000D_").split("_x000D_");F.length>1&&(b=!0,g=!0,s=F.join(`\r
`))}if(!t&&!g&&d?(delete f.ct.s,f.ct.t="g",f.ct.fa="General",t=""):g&&(V(f)!="object"&&(f={}),delete f.f,delete f.v,delete f.m,f.ct==null&&(f.ct={},f.ct.fa="General"),f.ct.t="inlineStr",f.ct.s=xy(a.find("span")),b&&(f.ct.s=[{v:s}])),t=t||a.text(),!Yt.createHookFunction("cellUpdateBefore",e,n,t,l)){o.cancelNormalSelected();return}if(!g){if(rt(t)&&!d){if(f==null||rt(f.v)&&f.spl==null&&f.f==null){o.cancelNormalSelected();return}}else if(f!=null&&f.qp!=1){if(V(f)=="object"&&(t==f.f||t==f.v||t==f.m)){o.cancelNormalSelected();return}else if(t==f){o.cancelNormalSelected();return}}V(t)=="string"&&t.slice(0,1)=="="&&t.length>1||V(f)=="object"&&f.ct!=null&&f.ct.fa!=null&&f.ct.fa!="@"&&!rt(t)&&(delete f.m,f.f!=null&&(delete f.f,delete f.spl))}window.luckysheet_getcelldata_cache=null;let y=!0,p=pt.deepCopyFlowData(h.flowdata),x=null;if(V(f)=="object"){if(!g)if(V(t)=="string"&&t.slice(0,1)=="="&&t.length>1){let F=o.execfunction(t,e,n,void 0,!0);if(y=!1,f=$.extend(!0,{},p[e][n]),f.v=F[1],f.f=F[2],F.length==4&&F[3].type=="sparklines"){delete f.m,delete f.v;let D=F[3].data;V(D)=="array"&&V(D[0])!="object"?f.v=D[0]:f.spl=F[3].data}else F.length==4&&F[3].type=="dynamicArrayItem"&&(x=F[3].data)}else if(V(t)=="object"){let F=t.f;if(V(F)=="string"&&F.slice(0,1)=="="&&F.length>1){let D=o.execfunction(F,e,n,void 0,!0);if(y=!1,f=$.extend(!0,{},p[e][n]),f.v=D[1],f.f=D[2],D.length==4&&D[3].type=="sparklines"){delete f.m,delete f.v;let k=D[3].data;V(k)=="array"&&V(k[0])!="object"?f.v=k[0]:f.spl=D[3].data}else D.length==4&&D[3].type=="dynamicArrayItem"&&(x=D[3].data)}else for(let D in t)f[D]=t[D]}else o.delFunctionGroup(e,n),o.execFunctionGroup(e,n,t),y=!1,f=$.extend(!0,{},p[e][n]),f.v=t,delete f.f,delete f.spl,f.qp==1&&(""+t).substr(0,1)!="'"&&(f.qp=0,f.ct!=null&&(f.ct.fa="General",f.ct.t="n"));t=f}else if(V(t)=="string"&&t.slice(0,1)=="="&&t.length>1){let F=o.execfunction(t,e,n,void 0,!0);if(y=!1,t={v:F[1],f:F[2]},F.length==4&&F[3].type=="sparklines"){let D=F[3].data;V(D)=="array"&&V(D[0])!="object"?t.v=D[0]:t.spl=F[3].data}else F.length==4&&F[3].type=="dynamicArrayItem"&&(x=F[3].data)}else if(V(t)=="object"){let F=t.f;if(V(F)=="string"&&F.slice(0,1)=="="&&F.length>1){let D=o.execfunction(F,e,n,void 0,!0);if(y=!1,t.v=D[1],t.f=D[2],D.length==4&&D[3].type=="sparklines"){let k=D[3].data;V(k)=="array"&&V(k[0])!="object"?t.v=k[0]:t.spl=D[3].data}else D.length==4&&D[3].type=="dynamicArrayItem"&&(x=D[3].data)}else{let D=f;t.v==null&&(t.v=D)}}else o.delFunctionGroup(e,n),o.execFunctionGroup(e,n,t),y=!1;er(e,n,p,t),o.cancelNormalSelected();let _=!1,S=$.extend(!0,{},Yl()[$e(h.currentSheetIndex)].config);if(S.rowlen==null&&(S.rowlen={}),p[e][n].tb=="2"&&p[e][n].v!=null||wn(p[e][n])&&typeof p[e][n].mc=="undefined"){let F=h.defaultrowlen,D=$("#luckysheetTableContent").get(0).getContext("2d");if(!(S.customHeight&&S.customHeight[e]==1)){let k=Vl(n)[1]-Vl(n)[0]-2,w=no(p[e][n],D,{r:e,c:n,cellWidth:k}),C=F;w!=null&&(C=w.textHeightAll+2),C>F&&(S.rowlen[e]=C,_=!0)}}let I=null;x&&(I=$.extend(!0,[],this.insertUpdateDynamicArray(x)));let O={dynamicArray:I};if(_&&(O={cfg:S,dynamicArray:I,RowlChange:_}),setTimeout(()=>{Yt.createHookFunction("cellUpdated",e,n,JSON.parse(m),h.flowdata[e][n],l)},0),l)Gt(p,[{row:[e,e],column:[n,n]}],O,y),o.execFunctionGlobalData=null;else return{data:p,allParam:O}},cancelNormalSelected:function(){let e=this;e.canceFunctionrangeSelected(),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-input-box-index").hide(),$("#luckysheet-wa-functionbox-cancel, #luckysheet-wa-functionbox-confirm").removeClass("luckysheet-wa-calculate-active"),e.rangestart=!1,e.rangedrag_column_start=!1,e.rangedrag_row_start=!1},canceFunctionrangeSelected:function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide()},iscellformat:function(e){let n=/[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ][123456789]/},iscelldata:function(e){let n=e.split("!"),t;n.length>1?t=n[1]:t=n[0];let l=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g,o=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(t.indexOf(":")==-1){let a=parseInt(t.replace(/[^0-9]/g,""))-1,s=jr(t.replace(/[^A-Za-z]/g,""));return!isNaN(a)&&!isNaN(s)&&t.toString().match(l)?!0:(isNaN(a)&&isNaN(s),!1)}else{o=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,t=t.split(":");let a=[],s=[];return a[0]=parseInt(t[0].replace(/[^0-9]/g,""))-1,a[1]=parseInt(t[1].replace(/[^0-9]/g,""))-1,a[0]>a[1]||(s[0]=jr(t[0].replace(/[^A-Za-z]/g,"")),s[1]=jr(t[1].replace(/[^A-Za-z]/g,"")),s[0]>s[1])?!1:!!(t[0].toString().match(o)&&t[1].toString().match(o))}},operator:"==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",operatorjson:null,functionCopy:function(e,n,t){let l=this;if(l.operatorjson==null){let d=l.operator.split("|"),g={};for(let b=0;b<d.length;b++)g[d[b].toString()]=1;l.operatorjson=g}n==null&&(n="down"),t==null&&(t=1),e.substr(0,1)=="="&&(e=e.substr(1));let o=e.split(""),a=0,s="",u="",f=!0,m={bracket:0,comma:0,squote:0,dquote:0};for(;a<o.length;){let d=o[a];if(d=="("&&m.dquote==0)m.bracket+=1,s.length>0?u+=s+"(":u+="(",s="";else if(d==")"&&m.dquote==0)m.bracket-=1,u+=l.functionCopy(s,n,t)+")",s="";else if(d=='"'&&m.squote==0)m.dquote>0?(u+=s+'"',m.dquote-=1,s=""):(m.dquote+=1,s+='"');else if(d==","&&m.dquote==0)u+=l.functionCopy(s,n,t)+",",s="";else if(d=="&"&&m.dquote==0)s.length>0?(u+=l.functionCopy(s,n,t)+"&",s=""):u+="&";else if(d in l.operatorjson&&m.dquote==0){let g="";a+1<o.length&&(g=o[a+1]);let b=a-1,y=null;if(b>=0)do y=o[b--];while(b>=0&&y==" ");d+g in l.operatorjson?(s.length>0?(u+=l.functionCopy(s,n,t)+d+g,s=""):u+=d+g,a++):!/[^0-9]/.test(g)&&d=="-"&&(y=="("||y==null||y==","||y==" "||y in l.operatorjson)?s+=d:s.length>0?(u+=l.functionCopy(s,n,t)+d,s=""):u+=d}else s+=d;a==o.length-1&&(l.iscelldata($.trim(s))?n=="down"?u+=l.downparam($.trim(s),t):n=="up"?u+=l.upparam($.trim(s),t):n=="left"?u+=l.leftparam($.trim(s),t):n=="right"&&(u+=l.rightparam($.trim(s),t)):u+=$.trim(s)),a++}return u},isfreezonFuc:function(e){let n=e.replace(/[^0-9]/g,""),t=e.replace(/[^A-Za-z]/g,""),l=e.substr(e.indexOf(n)-1,1),o=e.substr(e.indexOf(t)-1,1),a=[!1,!1];return l=="$"&&(a[0]=!0),o=="$"&&(a[1]=!0),a},setfreezonFuceExe:function(e){let n=parseInt(e.replace(/[^0-9]/g,"")),t=jr(e.replace(/[^A-Za-z]/g,"")),l="$",o="$";return!isNaN(n)&&!isNaN(t)?o+Qt(t)+l+n:isNaN(n)?isNaN(t)?e:o+Qt(t):l+n},setfreezonFuc:function(e){let n=this,t=n.getrangeseleciton();if(!n.iscelldata(t.text()))return;let l=t.text(),o=window.getSelection().anchorOffset,a=l.split("!"),s,u="";a.length>1?(s=a[1],u=a[0]+"!"):s=a[0];let f="",m="",d=s.indexOf(":");if(d==-1)f=u+n.setfreezonFuceExe(s),m=f.length;else if(s=s.split(":"),o>d){let g=u+s[0]+":"+n.setfreezonFuceExe(s[1]);f=g,m=g.length}else{let g=u+n.setfreezonFuceExe(s[0]);f=g+":"+s[1],m=g.length}t.text(u+f),n.setCaretPosition(t.get(0),0,m)},updateparam:function(e,n,t){let l=this,o=n.split("!"),a,s="";if(o.length>1?(a=o[1],s=o[0]+"!"):a=o[0],a.indexOf(":")==-1){let u=parseInt(a.replace(/[^0-9]/g,"")),f=jr(a.replace(/[^A-Za-z]/g,"")),m=l.isfreezonFuc(a),d=m[0]?"$":"",g=m[1]?"$":"";return e=="u"&&!m[0]?u-=t:e=="r"&&!m[1]?f+=t:e=="l"&&!m[1]?f-=t:e=="d"&&!m[0]&&(u+=t),u[0]<0||f[0]<0?l.error.r:!isNaN(u)&&!isNaN(f)?s+g+Qt(f)+d+u:isNaN(u)?isNaN(f)?n:s+g+Qt(f):s+d+u}else{a=a.split(":");let u=[],f=[];if(u[0]=parseInt(a[0].replace(/[^0-9]/g,"")),u[1]=parseInt(a[1].replace(/[^0-9]/g,"")),u[0]>u[1]||(f[0]=jr(a[0].replace(/[^A-Za-z]/g,"")),f[1]=jr(a[1].replace(/[^A-Za-z]/g,"")),f[0]>f[1]))return n;let m=l.isfreezonFuc(a[0]),d=l.isfreezonFuc(a[1]),g=m[0]?"$":"",b=m[1]?"$":"",y=d[0]?"$":"",p=d[1]?"$":"";return e=="u"?(m[0]||(u[0]-=t),d[0]||(u[1]-=t)):e=="r"?(m[1]||(f[0]+=t),d[1]||(f[1]+=t)):e=="l"?(m[1]||(f[0]-=t),d[1]||(f[1]-=t)):e=="d"&&(m[0]||(u[0]+=t),d[0]||(u[1]+=t)),u[0]<0||f[0]<0?l.error.r:isNaN(f[0])&&isNaN(f[1])?s+g+u[0]+":"+y+u[1]:isNaN(u[0])&&isNaN(u[1])?s+b+Qt(f[0])+":"+p+Qt(f[1]):s+b+Qt(f[0])+g+u[0]+":"+p+Qt(f[1])+y+u[1]}},downparam:function(e,n){return this.updateparam("d",e,n)},upparam:function(e,n){return this.updateparam("u",e,n)},leftparam:function(e,n){return this.updateparam("l",e,n)},rightparam:function(e,n){return this.updateparam("r",e,n)},functionStrChange:function(e,n,t,l,o,a){let s=this;if(s.operatorjson==null){let y=s.operator.split("|"),p={};for(let x=0;x<y.length;x++)p[y[x].toString()]=1;s.operatorjson=p}e.substr(0,1)=="="&&(e=e.substr(1));let u=e.split(""),f=0,m="",d="",g=!0,b={bracket:0,comma:0,squote:0,dquote:0};for(;f<u.length;){let y=u[f];if(y=="("&&b.dquote==0)b.bracket+=1,m.length>0?d+=m+"(":d+="(",m="";else if(y==")"&&b.dquote==0)b.bracket-=1,d+=s.functionStrChange(m,n,t,l,o,a)+")",m="";else if(y=='"'&&b.squote==0)b.dquote>0?(d+=m+'"',b.dquote-=1,m=""):(b.dquote+=1,m+='"');else if(y==","&&b.dquote==0)d+=s.functionStrChange(m,n,t,l,o,a)+",",m="";else if(y=="&"&&b.dquote==0)m.length>0?(d+=s.functionStrChange(m,n,t,l,o,a)+"&",m=""):d+="&";else if(y in s.operatorjson&&b.dquote==0){let p="";f+1<u.length&&(p=u[f+1]);let x=f-1,_=null;if(x>=0)do _=u[x--];while(x>=0&&_==" ");y+p in s.operatorjson?(m.length>0?(d+=s.functionStrChange(m,n,t,l,o,a)+y+p,m=""):d+=y+p,f++):!/[^0-9]/.test(p)&&y=="-"&&(_=="("||_==null||_==","||_==" "||_ in s.operatorjson)?m+=y:m.length>0?(d+=s.functionStrChange(m,n,t,l,o,a)+y,m=""):d+=y}else m+=y;f==u.length-1&&(s.iscelldata($.trim(m))?d+=s.functionStrChange_range($.trim(m),n,t,l,o,a):d+=$.trim(m)),f++}return d},functionStrChange_range:function(e,n,t,l,o,a){let s=this,u=e.split("!"),f,m="";u.length>1?(f=u[1],m=u[0]+"!"):f=u[0];let d,g,b,y,p,x,_,S;if(f.indexOf(":")==-1){d=g=parseInt(f.replace(/[^0-9]/g,""))-1,b=y=jr(f.replace(/[^A-Za-z]/g,""));let I=s.isfreezonFuc(f);p=x=I[0]?"$":"",_=S=I[1]?"$":""}else{if(f=f.split(":"),d=parseInt(f[0].replace(/[^0-9]/g,""))-1,g=parseInt(f[1].replace(/[^0-9]/g,""))-1,d>g||(b=jr(f[0].replace(/[^A-Za-z]/g,"")),y=jr(f[1].replace(/[^A-Za-z]/g,"")),b>y))return e;let I=s.isfreezonFuc(f[0]);p=I[0]?"$":"",_=I[1]?"$":"";let O=s.isfreezonFuc(f[1]);x=O[0]?"$":"",S=O[1]?"$":""}if(n=="del"){if(t=="row"){if(d>=o&&g<=o+a-1)return s.error.r;d>o+a-1?d-=a:d>=o&&(d=o),g>o+a-1?g-=a:g>=o&&(g=o-1),d<0&&(d=0),g<d&&(g=d)}else if(t=="col"){if(b>=o&&y<=o+a-1)return s.error.r;b>o+a-1?b-=a:b>=o&&(b=o),y>o+a-1?y-=a:y>=o&&(y=o-1),b<0&&(b=0),y<b&&(y=b)}return d==g&&b==y?!isNaN(d)&&!isNaN(b)?m+_+Qt(b)+p+(d+1):isNaN(d)?isNaN(b)?e:m+_+Qt(b):m+p+(d+1):isNaN(b)&&isNaN(y)?m+p+(d+1)+":"+x+(g+1):isNaN(d)&&isNaN(g)?m+_+Qt(b)+":"+S+Qt(y):m+_+Qt(b)+p+(d+1)+":"+S+Qt(y)+x+(g+1)}else if(n=="add")return t=="row"?l=="lefttop"?(d>=o&&(d+=a),g>=o&&(g+=a)):l=="rightbottom"&&(d>o&&(d+=a),g>o&&(g+=a)):t=="col"&&(l=="lefttop"?(b>=o&&(b+=a),y>=o&&(y+=a)):l=="rightbottom"&&(b>o&&(b+=a),y>o&&(y+=a))),d==g&&b==y?!isNaN(d)&&!isNaN(b)?m+_+Qt(b)+p+(d+1):isNaN(d)?isNaN(b)?e:m+_+Qt(b):m+p+(d+1):isNaN(b)&&isNaN(y)?m+p+(d+1)+":"+x+(g+1):isNaN(d)&&isNaN(g)?m+_+Qt(b)+":"+S+Qt(y):m+_+Qt(b)+p+(d+1)+":"+S+Qt(y)+x+(g+1)},israngeseleciton:function(e){let n=this;if(n.operatorjson==null){let a=n.operator.split("|"),s={};for(let u=0;u<a.length;u++)s[a[u].toString()]=1;n.operatorjson=s}e==null&&(e=!1);let t=window.getSelection(),l=$(t.anchorNode),o=t.anchorOffset;if(l.parent().is("span")&&o!=0){let a=$.trim(l.text()),s="";if(a.length==0&&l.parent().prev().length>0){let u=l.parent().prev();a=$.trim(u.text()),s=a.substr(a.length-1,1),n.rangeSetValueTo=u}else s=a.substr(o-1,1),n.rangeSetValueTo=l.parent();if(e&&(s=="("||s==",")||!e&&(s=="("||s==","||s=="="||s in n.operatorjson||s=="&"))return!0}else if(l.is("#luckysheet-rich-text-editor")||l.is("#luckysheet-functionbox-cell")){let a=$.trim(l.find("span").last().text()),s;if(n.rangeSetValueTo=l.find("span").last(),a.length==0&&l.find("span").length>1){let u=l.find("span");a=$.trim(u.eq(u.length-2).text()),n.rangeSetValueTo=u}if(s=a.substr(a.length-1,1),e&&(s=="("||s==",")||!e&&(s=="("||s==","||s=="="||s in n.operatorjson||s=="&"))return!0}else if((l.parent().is("#luckysheet-rich-text-editor")||l.parent().is("#luckysheet-functionbox-cell")||o==0)&&(o==0&&(l=l.parent()),l.prev().length>0)){let a=$.trim(l.prev().text()),s=a.substr(a.length-1,1);if(n.rangeSetValueTo=l.prev(),e&&(s=="("||s==",")||!e&&(s=="("||s==","||s=="="||s in n.operatorjson||s=="&"))return!0}return!1},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangeSetValue:function(e,n){let t=this,l="",o=e.row[0],a=e.column[0];h.config.merge!=null&&o+"_"+a in h.config.merge?l=Al(h.currentSheetIndex,{column:[a,a],row:[o,o]},t.rangetosheet):l=Al(h.currentSheetIndex,e,t.rangetosheet);let s;if(t.rangestart||t.rangedrag_column_start||t.rangedrag_row_start)if($("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")){s=$("#luckysheet-rich-text-editor"),$("#luckysheet-search-formula-parm-select-input").val(l),$("#luckysheet-search-formula-parm .parmBox").eq(t.data_parm_index).find(".txt input").val(l);let u=Si(l).data;if(u instanceof Array){let y=[];for(let p=0;p<u.length;p++)for(let x=0;x<u[p].length;x++)u[p][x]==null?y.push(null):y.push(u[p][x].v);$("#luckysheet-search-formula-parm .parmBox").eq(t.data_parm_index).find(".val").text(" = {"+y.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(t.data_parm_index).find(".val").text(" = {"+u.v+"}");let f=!0,m=[],d=-1;$("#luckysheet-search-formula-parm .parmBox").each(function(y,p){let x=$(p).find(".txt input").val();x==""&&$(p).find(".txt input").attr("data_parm_require")=="m"&&(f=!1),x!=""&&(d=y)});let g;if(d==-1)g="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"()";else if(d==0)g="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+$("#luckysheet-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(let y=0;y<=d;y++)m.push($("#luckysheet-search-formula-parm .parmBox").eq(y).find(".txt input").val());g="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+m.join(",")+")"}let b=t.functionHTMLGenerate(g);if($("#luckysheet-rich-text-editor").html(b),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),f){let y=$.trim(t.functionParserExe($("#luckysheet-rich-text-editor").text())),p=new Function("return "+y)();$("#luckysheet-search-formula-parm .result span").text(p)}}else{let f=window.getSelection().anchorNode;s=$(f).closest("div");let m=s.find("span[rangeindex='"+t.rangechangeindex+"']").html(l);t.setCaretPosition(m.get(0),0,l.length)}else{let u='<span class="luckysheet-formula-functionrange-cell" rangeindex="'+t.functionHTMLIndex+'" dir="auto" style="color:'+si[t.functionHTMLIndex]+';">'+l+"</span>",f=$(u).insertAfter(t.rangeSetValueTo);t.rangechangeindex=t.functionHTMLIndex,s=$(t.rangeSetValueTo).closest("div"),t.setCaretPosition(s.find("span[rangeindex='"+t.rangechangeindex+"']").get(0),0,l.length),t.functionHTMLIndex++}s.attr("id")=="luckysheet-rich-text-editor"?$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()):$("#luckysheet-rich-text-editor").html($("#luckysheet-functionbox-cell").html())},rangedrag:function(e){let n=this,t=ll(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),o=t[1]+$("#luckysheet-cell-main").scrollTop(),a=zl(o),s=a[1],u=a[0],f=a[2],m=Ml(l),d=m[1],g=m[0],b=m[2],y=0,p=0,x=[];n.func_selectedrange.top>u?(y=u,p=n.func_selectedrange.top+n.func_selectedrange.height-u,x=[f,n.func_selectedrange.row[1]]):n.func_selectedrange.top==u?(y=u,p=n.func_selectedrange.top+n.func_selectedrange.height-u,x=[f,n.func_selectedrange.row[0]]):(y=n.func_selectedrange.top,p=s-n.func_selectedrange.top-1,x=[n.func_selectedrange.row[0],f]);let _=0,S=0,I=[];n.func_selectedrange.left>g?(_=g,S=n.func_selectedrange.left+n.func_selectedrange.width-g,I=[b,n.func_selectedrange.column[1]]):n.func_selectedrange.left==g?(_=g,S=n.func_selectedrange.left+n.func_selectedrange.width-g,I=[b,n.func_selectedrange.column[0]]):(_=n.func_selectedrange.left,S=d-n.func_selectedrange.left-1,I=[n.func_selectedrange.column[0],b]),x[0]=we.changeFreezenIndex(x[0],"h"),x[1]=we.changeFreezenIndex(x[1],"h"),I[0]=we.changeFreezenIndex(I[0],"v"),I[1]=we.changeFreezenIndex(I[1],"v");let O=ht.mergeMoveMain(I,x,n.func_selectedrange,y,p,_,S);if(O!=null&&(I=O[0],x=O[1],y=O[2],p=O[3],_=O[4],S=O[5]),n.func_selectedrange.row=x,n.func_selectedrange.column=I,n.func_selectedrange.left_move=_,n.func_selectedrange.width_move=S,n.func_selectedrange.top_move=y,n.func_selectedrange.height_move=p,Ti(_,y,S,p,x,I),$("#luckysheet-formula-functionrange-select").css({left:_,width:S,top:y,height:p}).show(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let F=Al(h.currentSheetIndex,{row:x,column:I},h.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(F)}else n.rangeSetValue({row:x,column:I});we.scrollFreezen(x,I)},rangedrag_column_start:!1,rangedrag_row_start:!1,rangedrag_column:function(e){let n=this,t=ll(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),o=t[1]+$("#luckysheet-cell-main").scrollTop(),a=h.visibledatarow,s=a.length-1,u=a[s],f=0,m=Ml(l),d=m[1],g=m[0],b=m[2],y=0,p=0,x=[];n.func_selectedrange.left>g?(y=g,p=n.func_selectedrange.left+n.func_selectedrange.width-g,x=[b,n.func_selectedrange.column[1]]):n.func_selectedrange.left==g?(y=g,p=n.func_selectedrange.left+n.func_selectedrange.width-g,x=[b,n.func_selectedrange.column[0]]):(y=n.func_selectedrange.left,p=d-n.func_selectedrange.left-1,x=[n.func_selectedrange.column[0],b]),x[0]=we.changeFreezenIndex(x[0],"v"),x[1]=we.changeFreezenIndex(x[1],"v");let _=ht.mergeMoveMain(x,[0,s],n.func_selectedrange,f,u-f-1,y,p);_!=null&&(x=_[0],y=_[4],p=_[5]),n.func_selectedrange.column=x,n.func_selectedrange.left_move=y,n.func_selectedrange.width_move=p,Ti(y,f,p,u-f-1,[0,s],x),n.rangeSetValue({row:[null,null],column:x}),$("#luckysheet-formula-functionrange-select").css({left:y,width:p,top:f,height:u-f-1}).show(),we.scrollFreezen([0,s],x)},rangedrag_row:function(e){let n=this,t=ll(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),o=t[1]+$("#luckysheet-cell-main").scrollTop(),a=zl(o),s=a[1],u=a[0],f=a[2],m=h.visibledatacolumn,d=m.length-1,g=m[d],b=0,y=0,p=0,x=[];n.func_selectedrange.top>u?(y=u,p=n.func_selectedrange.top+n.func_selectedrange.height-u,x=[f,n.func_selectedrange.row[1]]):n.func_selectedrange.top==u?(y=u,p=n.func_selectedrange.top+n.func_selectedrange.height-u,x=[f,n.func_selectedrange.row[0]]):(y=n.func_selectedrange.top,p=s-n.func_selectedrange.top-1,x=[n.func_selectedrange.row[0],f]),x[0]=we.changeFreezenIndex(x[0],"h"),x[1]=we.changeFreezenIndex(x[1],"h");let _=ht.mergeMoveMain([0,d],x,n.func_selectedrange,y,p,b,g-b-1);_!=null&&(x=_[1],y=_[2],p=_[3]),n.func_selectedrange.row=x,n.func_selectedrange.top_move=y,n.func_selectedrange.height_move=p,Ti(b,y,g-b-1,p,x,[0,d]),n.rangeSetValue({row:x,column:[null,null]}),$("#luckysheet-formula-functionrange-select").css({left:b,width:g-b-1,top:y,height:p}).show(),we.scrollFreezen(x,[0,d])},rangedragged:function(){},rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeResizeDraging:function(e,n,t,l,o,a,s,u){let f=this,m=$("#luckysheet-scrollbar-y").scrollTop(),d=$("#luckysheet-scrollbar-x").scrollLeft(),g=ll(e.pageX,e.pageY),b=g[0]+d,y=g[1]+m,p=zl(y),x=p[1],_=p[0],S=p[2],I=Ml(b),O=I[1],F=I[0],D=I[2];if(b<0||y<0)return!1;let k=_-t[1],w=F-t[0],C=t[5],T=t[3],z=t[4],A=t[2];if(l=="lt"||l=="lb"){if(t[0]+t[2]<F)return;z=F,A=t[2]-w,z>t[2]+t[4]-O+F?(z=t[2]+t[4]-O+F,A=t[2]-(t[2]+t[4]-O+F-t[0])):z<=0&&(z=0,A=t[2]+t[0])}if(l=="rt"||l=="rb"){if(t[6]-t[2]>O)return;A=t[2]+O-t[6],A<O-F-1?A=O-F-1:A>=s-z&&(A=s-z)}if(l=="lt"||l=="rt"){if(t[1]+t[3]<_)return;C=_,T=t[3]-k,C>t[3]+t[5]-x+_?(C=t[3]+t[5]-x+_,T=t[3]-(t[3]+t[5]-x+_-t[1])):C<=0&&(C=0,T=t[3]+t[1])}if(l=="lb"||l=="rb"){if(t[7]-t[3]>x)return;T=t[3]+x-t[7],T<x-_-1?T=x-_-1:T>=u-C&&(T=u-C)}let M=f.rangeResizeIndex,P={top:C,left:z,height:T,width:A},N=f.getSelectedFromRange(P),E=Al(h.currentSheetIndex,N,f.rangetosheet),B=f.rangeResizeTo.find("span[rangeindex='"+M+"']").html(E);to(f.rangeResizeTo[0]),n.css(P).data("range",N)},getSelectedFromRange:function(e){let n=e.top+2,t=e.top+e.height-2,l=e.left+2,o=e.left+e.width-2;return{row:[zl(n)[2],zl(t)[2]],column:[Ml(l)[2],Ml(o)[2]]}},rangeResizeDragged:function(e,n,t,l,o,a){let s=this;s.rangeResize=null,$("#luckysheet-formula-functionrange-highlight-"+s.rangeResizeIndex).find(".luckysheet-selection-copy-hc").css("opacity",.03)},rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,rangeMoveDraging:function(e,n,t,l,o,a){let s=this,u=ll(e.pageX,e.pageY),f=$("#luckysheet-scrollbar-x").scrollLeft(),m=$("#luckysheet-scrollbar-y").scrollTop(),d=u[0]+f,g=u[1]+m,b=$(window).height()+m-o-a,y=$(window).width()+f,p=n[0],x=n[1],_=t.row[0]-p+zl(g)[2],S=t.row[1]-p+zl(g)[2],I=t.column[0]-x+Ml(d)[2],O=t.column[1]-x+Ml(d)[2];(_<0||g<0)&&(_=0,S=t.row[1]-t.row[0]),(I<0||d<0)&&(I=0,O=t.column[1]-t.column[0]);let F=h.visibledatarow;(S>=F[F.length-1]||g>b)&&(_=F.length-1-t.row[1]+t.row[0],S=F.length-1);let D=h.visibledatacolumn;(O>=D[D.length-1]||d>y)&&(I=D.length-1-t.column[1]+t.column[0],O=D.length-1);let k=I-1==-1?0:D[I-1],w=D[O],C=_-1==-1?0:F[_-1],T=F[S],z=s.rangeMoveIndex,A={left:k,width:w-k-2,top:C,height:T-C-2,display:"block"},M=s.getSelectedFromRange(A),P=Al(h.currentSheetIndex,M,s.rangetosheet),N=s.rangeResizeTo.find("span[rangeindex='"+z+"']").html(P);to(s.rangeResizeTo[0]),s.rangeMoveRangedata=M,l.css(A)},rangeMoveDragged:function(e){let n=this;n.rangeMove=!1,$("#luckysheet-formula-functionrange-highlight-"+n.rangeMoveIndex).data("range",n.rangeMoveRangedata).find(".luckysheet-selection-copy-hc").css("opacity",.03)},functionHTMLIndex:0,functionRangeIndex:null,findrangeindex:function(e,n){let t=this,l=/<span.*?>/g,o=e.replace(l,""),a=n.replace(l,"");o=o.split("</span>"),a=a.split("</span>"),o.pop(),a.pop();let s=t.functionRangeIndex,u=0,f=a.length>o.length?o.length:a.length,m=a.length,d=o.length;if(m==d){let g=s[0],b=a[g],y=o[g];if(b==null)return a.length<=g?s=[a.length-1,a.length-1]:o.length<=g&&(s=[o.length-1,o.length-1]),s;if(b.length==y.length)return a[g+1]!=null&&o[g+1]!=null&&a[g+1].length<o[g+1].length&&(s[0]=s[0]+1,s[1]=1),s;if(b.length>y.length)return b!=null&&o[g+1]!=null&&o[g+1].substr(0,1)=='"'&&(b.indexOf("{")>-1||b.indexOf("}")>-1)&&(s[0]=s[0]+1,s[1]=1),s;if(b.length<y.length)return s[1]>y.length&&(s[1]=y.length),s}else if(m>d){let g=s[0],b=a[g],y=o[g];if(y==null)if(o[g-1].indexOf("{")>-1){s[0]=s[0]-1;let p=o[g-1].search("{");s[1]=s[1]+p}else s[0]=0,s[1]=0;else{if(b.length==y.length)return o[g+1]!=null&&(o[g+1].substr(0,1)=='"'||o[g+1].substr(0,1)=="{"||o[g+1].substr(0,1)=="}")?(s[0]=s[0]+1,s[1]=1):b!=null&&b.length>2&&b.substr(0,1)=='"'&&b.substr(b.length-1,1)=='"'||(o[g]!=null&&o[g]=='")'||o[g]!=null&&o[g]=='"}'||o[g]!=null&&o[g]=="{)"?s[1]=1:s[1]=y.length),s;if(b.length>y.length)return o[g+1]!=null&&(o[g+1].substr(0,1)=='"'||o[g+1].substr(0,1)=="{"||o[g+1].substr(0,1)=="}")&&(s[0]=s[0]+1,s[1]=1),s;if(b.length<y.length)return s}return s}else if(m<d){let g=s[0],b=a[g],y=o[g];if(b==null)s[0]=o.length-1,y!=null?s[1]=y.length:s[1]=1;else{if(b.length==y.length)return a[g+1]!=null&&(a[g+1].substr(0,1)=='"'||a[g+1].substr(0,1)=="{"||a[g+1].substr(0,1)=="}")?s[1]=y.length:o[g+1]!=null&&o[g+1].substr(0,1)=='"'&&(o[g+1].substr(0,1)=="{"||o[g+1].substr(0,1)=="}")?(s[0]=s[0]+1,s[1]=1):y!=null&&y.substr(0,1)=='"'&&y.substr(y.length-1,1)=='"'&&b.substr(0,1)=='"'&&b.substr(b.length-1,1)==")"||y!=null&&y.substr(0,1)=="{"&&y.substr(y.length-1,1)=="}"&&b.substr(0,1)=="{"&&b.substr(b.length-1,1)==")"?s[1]=y.length:(s[0]=s[0]+d-m,o.length>a.length?s[1]=o[g+1].length:s[1]=1),s;if(b.length>y.length)return b!=null&&b.substr(0,1)=='"'?s[1]=y.length:o[g+1]!=null&&/{.*?}/.test(o[g+1])?(s[0]=s[0]+1,s[1]=o[g+1].length):b!=null&&o[g+1].substr(0,1)=='"'&&(b.indexOf("{")>-1||b.indexOf("}")>-1)?(s[0]=s[0]+1,s[1]=1):b!=null&&(b.indexOf("{")>-1||b.indexOf("}")>-1)||(s[0]=s[0]+d-m-1,s[1]=o[g-1].length),s;if(b.length<y.length)return s}return s}return null},setCaretPosition:function(e,n,t){try{let l=e,o=document.createRange(),a=window.getSelection();o.setStart(l.childNodes[n],t),o.collapse(!0),a.removeAllRanges(),a.addRange(o),l.focus()}catch(l){to(this.rangeResizeTo[0])}},functionRange:function(e,n,t){let l=this;if(window.getSelection){let o=window.getSelection(),a=l.findrangeindex(n,t);a==null?(o.selectAllChildren(e.get(0)),o.collapseToEnd()):l.setCaretPosition(e.find("span").get(a[0]),0,a[1])}else document.selection&&(l.functionRangeIndex.moveToElementText(e),l.functionRangeIndex.collapse(!1),l.functionRangeIndex.select())},functionInputHanddler:function(e,n,t){if(Qe())return;let l=this,o=e,a=n,s=a.html(),u=a.text(),f=this.xssDeal;setTimeout(function(){let m=a.text(),d=m;if(m=f(m),m.length>0&&m.substr(0,1)=="="&&(t!=229||m.length==1)){if(m=l.functionHTMLGenerate(m),s=l.functionHTMLGenerate(u),window.getSelection){let g=window.getSelection();if($(g.anchorNode).is("div")){let b=$("#luckysheet-rich-text-editor span").length;l.functionRangeIndex=[b-1,$("#luckysheet-rich-text-editor").find("span").eq(b-1).text().length]}else l.functionRangeIndex=[$(g.anchorNode).parent().index(),g.anchorOffset]}else{let g=document.selection.createRange();l.functionRangeIndex=g}a.html(m),l.functionRange(a,m,s),l.canceFunctionrangeSelected(),t!=46&&l.createRangeHightlight(),o.html(m),l.rangestart=!1,l.rangedrag_column_start=!1,l.rangedrag_row_start=!1,l.rangeHightlightselected(a,t)}else u.substr(0,1)!="="&&(o.attr("id")=="luckysheet-rich-text-editor"&&o.html().substr(0,5)=="<span"||(m=l.ltGtSignDeal(m),o.html(m)))},1)},functionHTMLGenerate:function(e){let n=this;return e.length==0||e.substr(0,1)!="="?e:(n.functionHTMLIndex=0,'<span dir="auto" class="luckysheet-formula-text-color">=</span>'+n.functionHTML(e))},functionHTML:function(e){let n=this;if(n.operatorjson==null){let f=n.operator.split("|"),m={};for(let d=0;d<f.length;d++)m[f[d].toString()]=1;n.operatorjson=m}e.substr(0,1)=="="&&(e=e.substr(1));let t=e.split(""),l=0,o="",a="",s=!0,u={bracket:0,comma:0,squote:0,dquote:0,braces:0};for(;l<t.length;){let f=t[l];if(f=="("&&u.squote==0&&u.dquote==0&&u.braces==0)u.bracket+=1,o.length>0?a+='<span dir="auto" class="luckysheet-formula-text-func">'+o+'</span><span dir="auto" class="luckysheet-formula-text-lpar">(</span>':a+='<span dir="auto" class="luckysheet-formula-text-lpar">(</span>',o="";else if(f==")"&&u.squote==0&&u.dquote==0&&u.braces==0)u.bracket-=1,a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-rpar">)</span>',o="";else if(f=="{"&&u.squote==0&&u.dquote==0)o+="{",u.braces+=1;else if(f=="}"&&u.squote==0&&u.dquote==0)o+="}",u.braces-=1;else if(f=='"'&&u.squote==0)u.dquote>0?(o.length>0?a+=o+'"</span>':a+='"</span>',u.dquote-=1,o=""):(u.dquote+=1,o.length>0?a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-string">"':a+='<span dir="auto" class="luckysheet-formula-text-string">"',o="");else if(f=="'"&&u.dquote==0)o+="'",u.squote=u.squote==0?1:0;else if(f==","&&u.squote==0&&u.dquote==0&&u.braces==0)a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-comma">,</span>',o="";else if(f=="&"&&u.squote==0&&u.dquote==0&&u.braces==0)o.length>0?(a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-calc">&</span>',o=""):a+='<span dir="auto" class="luckysheet-formula-text-calc">&</span>';else if(f in n.operatorjson&&u.squote==0&&u.dquote==0&&u.braces==0){let m="";l+1<t.length&&(m=t[l+1]);let d=l-1,g=null;if(d>=0)do g=t[d--];while(d>=0&&g==" ");f+m in n.operatorjson?(o.length>0?(a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-calc">'+f+m+"</span>",o=""):a+='<span dir="auto" class="luckysheet-formula-text-calc">'+f+m+"</span>",l++):!/[^0-9]/.test(m)&&f=="-"&&(g=="("||g==null||g==","||g==" "||g in n.operatorjson)?o+=f:o.length>0?(a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-calc">'+f+"</span>",o=""):a+='<span dir="auto" class="luckysheet-formula-text-calc">'+f+"</span>"}else o+=f;if(l==t.length-1){if(n.iscelldata($.trim(o)))a+='<span class="luckysheet-formula-functionrange-cell" rangeindex="'+n.functionHTMLIndex+'" dir="auto" style="color:'+si[n.functionHTMLIndex]+';">'+o+"</span>",n.functionHTMLIndex++;else if(u.dquote>0)a+=o+"</span>";else if(o.indexOf("</span>")==-1&&o.length>0){let m=/{.*?}/;if(m.test($.trim(o))){let d=m.exec(o)[0],g=o.search(m),b="";g>0&&(b+='<span dir="auto" class="luckysheet-formula-text-color">'+o.substr(0,g)+"</span>"),b+='<span dir="auto" style="color:#959a05" class="luckysheet-formula-text-array">'+d+"</span>",g+d.length<o.length&&(b+='<span dir="auto" class="luckysheet-formula-text-color">'+o.substr(g+d.length,o.length)+"</span>"),a+=b}else a+='<span dir="auto" class="luckysheet-formula-text-color">'+o+"</span>"}}l++}return a},getfunctionParam:function(e){let n=this;if(n.operatorjson==null){let d=n.operator.split("|"),g={};for(let b=0;b<d.length;b++)g[d[b].toString()]=1;n.operatorjson=g}e.substr(0,1)=="="&&(e=e.substr(1));let t=e.split(""),l=0,o="",a="",s={bracket:0,comma:0,squote:0,dquote:0,compare:0},u=null,f=[],m=[];for(;l<t.length;){let d=t[l];if(d=="("&&s.dquote==0)o.length>0&&m.length==0?(u=o.toUpperCase(),m.push(1),o=""):m.length==0?(m.push(0),o=""):(m.push(0),o+=d);else if(d==")"&&s.dquote==0){let g=m.pop();m.length==0?(f.push(o),o=""):o+=d}else if(d=='"')o+='"',s.dquote>0?(s.dquote-=1,o=""):s.dquote+=1;else if(d==","&&s.dquote==0)m.length<=1?(f.push(o),o=""):o+=",";else if(d in n.operatorjson&&s.dquote==0){let g="";l+1<t.length&&(g=t[l+1]);let b=l-1,y=null;if(b>=0)do y=t[b--];while(b>=0&&y==" ");!/[^0-9]/.test(g)&&d=="-"&&(y=="("||y==null||y==","||y==" "||y in n.operatorjson)?s.dquote==0?o+=$.trim(d):o+=d:(a="",o="")}else s.dquote==0?o+=$.trim(d):o+=d;l++}return{fn:u,param:f}},calPostfixExpression:function(e){if(e.length==0)return"";let n=[];for(let t=e.length-1;t>=0;t--){let l=e[t];if(l in this.operatorjson){let o=n.pop(),a=n.pop(),s="luckysheet_compareWith("+a+",'"+l+"', "+o+")";n.push(s)}else n.push(l)}return n.length>0?n[0]:""},checkBracketNum:function(e){let n=e.match(/\(/g),t=e.match(/\)/g),l=e.match(/(['"])(?:(?!\1).)*?\1/g),o=e.match(/(['"])(?:(?!\1).)*?\1/g),a=0,s=0;n!=null&&(a+=n.length),t!=null&&(s+=t.length);let u=0,f=0;if(l!=null)for(let m=0;m<l.length;m++){let d=l[m].match(/\(/g);d!=null&&(u+=d.length)}if(o!=null)for(let m=0;m<o.length;m++){let d=o[m].match(/\)/g);d!=null&&(f+=d.length)}return a-=u,s-=f,a==s},operatorPriority:{"^":0,"%":1,"*":1,"/":1,"+":2,"-":2},functionParserExe:function(e){let n=this;return this.functionParser(e)},functionParser:function(e,n){let t=this;if(t.operatorjson==null){let b=t.operator.split("|"),y={};for(let p=0;p<b.length;p++)y[b[p].toString()]=1;t.operatorjson=y}if(e==null)return"";e.substr(0,2)=="=+"?e=e.substr(2):e.substr(0,1)=="="&&(e=e.substr(1));let l=e.split(""),o=0,a="",s="",u={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0},f=[],m=[],d=[],g=-1;for(;o<l.length;){let b=l[o];if(b=="("&&u.squote==0&&u.dquote==0&&u.braces==0)if(a.length>0&&d.length==0){if(a=a.toUpperCase(),a.indexOf(":")>-1){let y=a.split(":");s+="luckysheet_getSpecialReference(true,'"+$.trim(y[0]).replace(/'/g,"\\'")+"', luckysheet_function."+y[1]+".f(#lucky#"}else s+="luckysheet_function."+a+".f(";d.push(1),a=""}else d.length==0?(s+="(",d.push(0),a=""):(d.push(0),a+=b);else if(b==")"&&u.squote==0&&u.dquote==0&&u.braces==0){let y=d.pop();if(d.length==0){let p=t.functionParser(a,n);p.indexOf("#lucky#")>-1&&(p=p.replace(/#lucky#/g,"")+")"),s+=p+")",a=""}else a+=b}else if(b=="{"&&u.squote==0&&u.dquote==0)a+="{",u.braces+=1;else if(b=="}"&&u.squote==0&&u.dquote==0)a+="}",u.braces-=1;else if(b=='"'&&u.squote==0)u.dquote>0?o<l.length-1&&l[o+1]=='"'?(o++,a+="\x7F"):(u.dquote-=1,a+='"'):(u.dquote+=1,a+='"');else if(b=="'"&&u.dquote==0)if(a+="'",u.squote>0){if(g==o-1)return"";if(o<l.length-1&&l[o+1]=="'")o++,a+="'";else{if(l[o-1]=="'")return"";u.squote-=1}}else u.squote+=1,g=o;else if(b==","&&u.squote==0&&u.dquote==0&&u.braces==0)if(d.length<=1){let y=t.functionParser(a,n);y.indexOf("#lucky#")>-1&&(y=y.replace(/#lucky#/g,"")+")"),s+=y+",",a=""}else a+=",";else if(b in t.operatorjson&&u.squote==0&&u.dquote==0&&u.braces==0){let y="",p=t.operatorPriority;if(o+1<l.length&&(y=l[o+1]),b+y in t.operatorjson){if(d.length==0){if($.trim(a).length>0?m.unshift(t.functionParser($.trim(a),n)):$.trim(s).length>0&&m.unshift($.trim(s)),f[0]in t.operatorjson){let x=p[f[0]];for(;f.length>0&&x!=null;)m.unshift(f.shift()),x=p[f[0]]}f.unshift(b+y),s="",a=""}else a+=b+y;o++}else if(d.length==0){if($.trim(a).length>0?m.unshift(t.functionParser($.trim(a),n)):$.trim(s).length>0&&m.unshift($.trim(s)),f[0]in t.operatorjson){let x=p[f[0]];x=x??1e3;let _=p[b];for(_=_??1e3;f.length>0&&_>=x;)m.unshift(f.shift()),x=p[f[0]],x=x??1e3}f.unshift(b),s="",a=""}else a+=b}else u.dquote==0&&u.squote==0,a+=b;if(o==l.length-1){let y="",p=$.trim(a).replace(/'/g,"\\'");if(t.iscelldata(p)&&p.substr(0,1)!=":")y="luckysheet_getcelldata('"+p+"')",typeof n=="function"&&n(p);else if(p.substr(0,1)==":")p=p.substr(1),t.iscelldata(p)&&(y="luckysheet_getSpecialReference(false,"+s+",'"+p+"')");else{a=$.trim(a);let x=/{.*?}/;if(x.test(a)&&a.substr(0,1)!='"'&&a.substr(a.length-1,1)!='"'){let _=x.exec(a)[0],S=a.search(x),I="";S>0&&(y+=a.substr(0,S)),y+="luckysheet_getarraydata('"+_+"')",S+_.length<a.length&&(y+=a.substr(S+_.length,a.length))}else y=a}if(y.length>0&&m.unshift(y),f.length>0)for(s.length>0&&(m.unshift(s),s="");f.length>0;)m.unshift(f.shift());m.length>0?s=t.calPostfixExpression(m):s+=y}o++}return s},insertUpdateDynamicArray:function(e){let n=e.r,t=e.c,l=e.index;l==null&&(l=h.currentSheetIndex);let s=Yl()[$e(l)].dynamicArray;s==null&&(s=[]);for(let u=0;u<s.length;u++){let f=s[u];if(f.r==n&&f.c==t&&f.index==l)return f.data=e.data,f.f=e.f,s}return s.push(e),s},addFunctionGroup:function(e,n,t,l){l==null&&(l=h.currentSheetIndex);let o=Yl(),a=o[$e(l)];a.calcChain==null&&(a.calcChain=[]);let s={r:e,c:n,index:l,func:t};a.calcChain.push(s),He.saveParam("fc",l,JSON.stringify(s),{op:"add",pos:a.calcChain.length-1}),vs(o)},getAllFunctionGroup:function(){let e=Yl(),n=[];for(let t=0;t<e.length;t++){let l=e[t],o=l.calcChain;if(o){let s=[];o.forEach((u,f)=>{typeof u=="string"?s.push(JSON.parse(u)):s.push(u)}),o=l.calcChain=s}let a=l.dynamicArray_compute;o==null&&(o=[]),a==null&&(a=[]),n=n.concat(o);for(let s=0;s<a.length;s++){let u=a[0];n.push({r:u.r,c:u.c,index:u.index})}}return n},getFunctionGroup:function(e){e==null&&(e=h.currentSheetIndex);let t=Yl()[$e(e)];return t.calcChain==null?[]:t.calcChain},updateFunctionGroup:function(e,n,t){t==null&&(t=h.currentSheetIndex);let l=Yl(),a=l[$e(t)].calcChain;if(a!=null)for(let s=0;s<a.length;s++){let u=a[s];if(u.r==e&&u.c==n&&u.index==t){He.saveParam("fc",t,JSON.stringify(u),{op:"update",pos:s});break}}vs(l)},insertUpdateFunctionGroup:function(e,n,t){t==null&&(t=h.currentSheetIndex);let l=Yl(),o=l[$e(t)],a=o.calcChain;a==null&&(a=[]);for(let u=0;u<a.length;u++){let f=a[u];if(f.r==e&&f.c==n&&f.index==t){He.saveParam("fc",t,JSON.stringify(f),{op:"update",pos:u});return}}let s={r:e,c:n,index:t};a.push(s),o.calcChain=a,He.saveParam("fc",t,JSON.stringify(s),{op:"add",pos:o.calcChain.length-1}),vs(l)},isFunctionRangeSave:!1,isFunctionRangeSimple:function(e,n,t,l,o){if(e==null||e.length==0)return;let a=e.split(/==|!=|<>|<=|>=|[,()=+-\/*%&^><]/g);if(a.length>0)for(let s=0;s<a.length;s++){let u=a[s];u.length<=1||u.substr(0,1)=='"'&&u.substr(u.length-1,1)=='"'||this.isFunctionRangeSaveChange(u,n,t,l,o)}},isFunctionRangeSimple1:function(e,n,t,l,o){let a=this;if(a.operatorjson==null){let y=a.operator.split("|"),p={};for(let x=0;x<y.length;x++)p[y[x].toString()]=1;a.operatorjson=p}e.substr(0,1)=="="&&(e=e.substr(1));let s=e.split(""),u=0,f="",m="",d=!0,g={bracket:0,comma:0,squote:0,dquote:0},b=Yl();for(;u<s.length;){let y=s[u];if(y=="("&&g.dquote==0)g.bracket+=1,f.length>0?m+="luckysheet_function."+f.toUpperCase()+".f(":m+="(",f="";else if(y==")"&&g.dquote==0)g.bracket-=1,m+=a.isFunctionRangeSimple(f,n,t,l,o)+")",f="";else if(y==","&&g.dquote==0)m+=a.isFunctionRangeSimple(f,n,t,l,o)+",",f="";else if(y in a.operatorjson&&g.dquote==0){let p="";u+1<s.length&&(p=s[u+1]),y+p in a.operatorjson?(f.length>0?(m+=a.isFunctionRangeSimple(f,n,t,l,o)+y+p,f=""):m+=y+p,u++):f.length>0?(m+=a.isFunctionRangeSimple(f,n,t,l,o)+y,f=""):m+=y}else f+=y;u==s.length-1&&a.iscelldata($.trim(f))&&a.isFunctionRangeSaveChange(f,n,t,l,o),u++}return m},isFunctionRangeSelect:function(e,n,t,l,o){if(e==null||e=="")return;l==null&&(l=h.currentSheetIndex),o==null&&(o={});let a=this,s=e.toUpperCase(),u=s.indexOf("INDIRECT(")>-1||s.indexOf("OFFSET(")>-1||s.indexOf("INDEX(")>-1;if(e in this.formulaContainCellList){let f=this.formulaContainCellList[e];if(u)if(f.__LuckyisOff__==!0)for(let d in f)d!="__LuckyisOff__"&&this.isFunctionRangeSaveChange(d,n,t,l,o);else this.isFunctionRange(e,n,t,l,o,function(d){a.addToCellList(e,d)}),f.__LuckyisOff__=!0;else for(let m in f)m!="__LuckyisOff__"&&this.isFunctionRangeSaveChange(m,n,t,l,o);return}u?this.isFunctionRange(e,n,t,l,o):this.isFunctionRangeSimple(e,n,t,l,o)},isFunctionRange:function(e,n,t,l,o,a){let s=this;if(s.operatorjson==null){let S=s.operator.split("|"),I={};for(let O=0;O<S.length;O++)I[S[O].toString()]=1;s.operatorjson=I}e.substr(0,1)=="="&&(e=e.substr(1));let u=e.split(""),f=0,m="",d="",g=!0,b={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0},y=[],p=[],x=[],_=-1;for(;f<u.length;){let S=u[f];if(S=="("&&b.squote==0&&b.dquote==0&&b.braces==0)if(m.length>0&&x.length==0){if(m=m.toUpperCase(),m.indexOf(":")>-1){let I=m.split(":");d+="luckysheet_getSpecialReference(true,'"+$.trim(I[0]).replace(/'/g,"\\'")+"', luckysheet_function."+I[1]+".f(#lucky#"}else d+="luckysheet_function."+m+".f(";x.push(1),m=""}else x.length==0?(d+="(",x.push(0),m=""):(x.push(0),m+=S);else if(S==")"&&b.squote==0&&b.dquote==0&&b.braces==0){let I=x.pop();if(x.length==0){let O=s.isFunctionRange(m,n,t,l,o,a);O.indexOf("#lucky#")>-1&&(O=O.replace(/#lucky#/g,"")+")"),d+=O+")",m=""}else m+=S}else if(S=="{"&&b.squote==0&&b.dquote==0)m+="{",b.braces+=1;else if(S=="}"&&b.squote==0&&b.dquote==0)m+="}",b.braces-=1;else if(S=='"'&&b.squote==0)b.dquote>0?f<u.length-1&&u[f+1]=='"'?(f++,m+="\x7F"):(b.dquote-=1,m+='"'):(b.dquote+=1,m+='"');else if(S=="'"&&b.dquote==0)m+="'",b.squote>0?f<u.length-1&&u[f+1]=="'"?(f++,m+="'"):b.squote-=1:(b.squote+=1,_=f);else if(S==","&&b.squote==0&&b.dquote==0&&b.braces==0)if(x.length<=1){let I=s.isFunctionRange(m,n,t,l,o,a);I.indexOf("#lucky#")>-1&&(I=I.replace(/#lucky#/g,"")+")"),d+=I+",",m=""}else m+=",";else if(S in s.operatorjson&&b.squote==0&&b.dquote==0&&b.braces==0){let I="",O=s.operatorPriority;if(f+1<u.length&&(I=u[f+1]),S+I in s.operatorjson){if(x.length==0){if($.trim(m).length>0?p.unshift(s.isFunctionRange($.trim(m),n,t,l,o,a)):$.trim(d).length>0&&p.unshift($.trim(d)),y[0]in s.operatorjson){let F=O[y[0]];for(;y.length>0&&F!=null;)p.unshift(y.shift()),F=O[y[0]]}y.unshift(S+I),d="",m=""}else m+=S+I;f++}else if(x.length==0){if($.trim(m).length>0?p.unshift(s.isFunctionRange($.trim(m),n,t,l,o,a)):$.trim(d).length>0&&p.unshift($.trim(d)),y[0]in s.operatorjson){let F=O[y[0]];F=F??1e3;let D=O[S];for(D=D??1e3;y.length>0&&D>=F;)p.unshift(y.shift()),F=O[y[0]],F=F??1e3}y.unshift(S),d="",m=""}else m+=S}else b.dquote==0&&b.squote==0?m+=$.trim(S):m+=S;if(f==u.length-1){let I="",O=$.trim(m).replace(/'/g,"\\'");if(s.iscelldata(O)&&O.substr(0,1)!=":")I="luckysheet_getcelldata('"+O+"')",s.isFunctionRangeSaveChange(m,n,t,l,o);else if(O.substr(0,1)==":")O=O.substr(1),s.iscelldata(O)&&(I="luckysheet_getSpecialReference(false,"+d+",'"+O+"')");else{m=$.trim(m);let F=/{.*?}/;if(F.test(m)&&m.substr(0,1)!='"'&&m.substr(m.length-1,1)!='"'){let D=F.exec(m)[0],k=m.search(F),w="";k>0&&(I+=m.substr(0,k)),I+="luckysheet_getarraydata('"+D+"')",k+D.length<m.length&&(I+=m.substr(k+D.length,m.length))}else I=m}if(I.length>0&&p.unshift(I),y.length>0)for(d.length>0&&(p.unshift(d),d="");y.length>0;)p.unshift(y.shift());p.length>0?d=s.calPostfixExpression(p):d+=I}f++}return s.checkSpecialFunctionRange(d,n,t,l,o,a),d},isFunctionRangeSaveChange:function(e,n,t,l,o){let a=this;if(n!=null&&t!=null){let s=a.getcellrange($.trim(e),l);if(s==null)return;let u=s.row,f=s.column,m=s.sheetIndex;if(n+"_"+t in o&&(l==m||l==null)){let d=!1;for(let g=u[0];g<=u[1];g++)for(let b=f[0];b<=f[1];b++)g+"_"+b in o&&o[g+"_"+b].r==n&&o[g+"_"+b].c==t&&(d=!0);d?a.isFunctionRangeSave=a.isFunctionRangeSave||!0:a.isFunctionRangeSave=a.isFunctionRangeSave||!1}else n>=u[0]&&n<=u[1]&&t>=f[0]&&t<=f[1]&&(l==m||l==null)?a.isFunctionRangeSave=a.isFunctionRangeSave||!0:a.isFunctionRangeSave=a.isFunctionRangeSave||!1}else a.isFunctionRangeSave=a.isFunctionRangeSave||!1},checkSpecialFunctionRange:function(e,n,t,l,o,a){if(e.substr(0,30)=="luckysheet_getSpecialReference"||e.substr(0,20)=="luckysheet_function."){if(e.substr(0,20)=="luckysheet_function."){let s=e.split(".")[1];if(s!=null&&(s=s.toUpperCase(),s!="INDIRECT"&&s!="OFFSET"&&s!="INDEX"))return}try{h.calculateSheetIndex=l;let s=new Function("return "+e)();s instanceof Object&&s.startCell!=null&&(s=s.startCell);let u=$.trim(s);this.iscelldata(u)&&typeof a=="function"&&a(u)}catch{}}},execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},formulaContainCellList:{},cellTextToIndexList:{},addToCellList:function(e,n){e==null||e.length==0||n==null||n.length==0||(this.formulaContainCellList==null&&(this.formulaContainCellList={}),this.formulaContainCellList[e]==null&&(this.formulaContainCellList[e]={}),this.formulaContainCellList[e][n]=1)},addToCellIndexList:function(e,n){e==null||e.length==0||n==null||(this.cellTextToIndexList==null&&(this.cellTextToIndexList={}),e.indexOf("!")>-1?(e=e.replace(/\\'/g,"'").replace(/''/g,"'"),this.cellTextToIndexList[e]=n):this.cellTextToIndexList[e+"_"+n.sheetIndex]=n)},addToSheetIndexList:function(e,n,t){e==null||e.length==0||((n==null||n.length==0)&&(n=h.currentSheetIndex),(t==null||t.length==0)&&(t=""),this.formulaContainSheetList==null&&(this.formulaContainSheetList={}),this.formulaContainSheetList[e]==null&&(this.formulaContainSheetList[e]={}),this.formulaContainSheetList[e][n]=t)},execFunctionGlobalData:{},execFunctionGroupForce:function(e){e?this.execFunctionGroup(void 0,void 0,void 0,void 0,void 0,!0):this.execFunctionGroup()},execFunctionGroup:function(e,n,t,l,o,a=!1){let s=this;if(o==null&&(o=h.flowdata),window.luckysheet_compareWith||(window.luckysheet_compareWith=zc,window.luckysheet_getarraydata=rg,window.luckysheet_getcelldata=Si,window.luckysheet_parseData=Oc,window.luckysheet_getValue=$a,window.luckysheet_indirect_check=ng,window.luckysheet_indirect_check_return=ig,window.luckysheet_offset_check=og,window.luckysheet_calcADPMM=Pl,window.luckysheet_getSpecialReference=ag),s.execFunctionGlobalData==null&&(s.execFunctionGlobalData={}),l==null&&(l=h.currentSheetIndex),t!=null){let F=[[{v:null}]];er(0,0,F,t),s.execFunctionGlobalData[e+"_"+n+"_"+l]=F[0][0]}let u=s.getAllFunctionGroup(),f={},m=Yl(),d={};for(let F=0;F<m.length;F++){let D=m[F];d[D.index]=D.data}let g={},b=[];if(s.execFunctionExist==null){let F="r"+e+"c"+n+"i"+l;g[F]=1}else for(let F=0;F<s.execFunctionExist.length;F++){let D=s.execFunctionExist[F],k="r"+D.r+"c"+D.c+"i"+D.i;g[k]=1}let y={},p=function(F,D,k,w){for(let C=0;C<F.length;C++){let T=F[C],z="r"+T.row[0]+""+T.row[1]+"c"+T.column[0]+""+T.column[1]+"index"+T.sheetIndex;if(z in y)y[z].forEach(M=>{w(M.key,M.r,M.c,M.sheetIndex)});else{let A=[];for(let M=T.row[0];M<=T.row[1];M++)for(let P=T.column[0];P<=T.column[1];P++){let N="r"+M+"c"+P+"i"+T.sheetIndex;w(N,M,P,T.sheetIndex),(D&&N in D||k&&N in k)&&A.push({key:N,r:M,c:P,sheetIndex:T.sheetIndex})}(D||k)&&(y[z]=A)}}},x={},_=0;for(let F=0;F<u.length;F++){let D=u[F],k="r"+D.r+"c"+D.c+"i"+D.index,w=Jn(D.r,D.c,D.index);if(w==null)continue;let C=w.toUpperCase(),T=C.indexOf("INDIRECT(")>-1||C.indexOf("OFFSET(")>-1||C.indexOf("INDEX(")>-1,z=[];if(T)this.isFunctionRange(w,null,null,D.index,null,function(M){let P=s.getcellrange($.trim(M),D.index);P!=null&&z.push(P)});else if(!(w.substr(0,2)=='="'&&w.substr(w.length-1,1)=='"')){let M=0,P=-1,N=-1,E=[],B=[],U=w.length;for(let X=0;X<U;X++){let le=w.charAt(X);le=="'"&&N==-1&&(P==-1?(M!=X&&E.push(...w.substring(M,X).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/)),P=X,M=X):X<U-1&&w.charAt(X+1)=="'"?X++:(M=X+1,E.push(w.substring(P,M)),B.push(E.length-1),P=-1)),le=='"'&&P==-1&&(N==-1?(M!=X&&E.push(...w.substring(M,X).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/)),N=X,M=X):X<U-1&&w.charAt(X+1)=='"'?X++:(M=X+1,E.push(w.substring(N,M)),N=-1))}M!=U&&E.push(...w.substring(M,U).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/));for(let X=B.length-1;X>=0;X--)B[X]!=E.length-1&&(E[B[X]]=E[B[X]]+E[B[X]+1],E.splice(B[X]+1,1));for(let X=0;X<E.length;X++){let le=E[X];if(le.length<=1||le.substr(0,1)=='"'&&le.substr(le.length-1,1)=='"'&&!s.iscelldata(le))continue;let he=s.getcellrange($.trim(le),D.index);he!=null&&z.push(he)}}let A={formulaArray:z,calc_funcStr:w,key:k,r:D.r,c:D.c,index:D.index,parents:{},chidren:{},color:"w"};f[k]=A}Object.keys(f).forEach(F=>{let D=f[F];p(D.formulaArray,f,g,function(k){if(k in f){let w=f[k];D.chidren[k]=1,w.parents[F]=1}!a&&k in g&&b.push(D)}),a&&b.push(D)});let S=[],I=b,O={};for(;I.length>0;){let F=I.pop();if(F==null||F.key in O)continue;if(F.color=="b"){S.push(F),O[F.key]=1;continue}let D=[];Object.keys(F.parents).forEach(k=>{let w=f[k];w!=null&&D.push(w)}),_++,D.length==0?(S.push(F),O[F.key]=1):(F.color="b",I.push(F),I=I.concat(D))}S.reverse();for(let F=0;F<S.length;F++){let D=S[F];if(D.level==Math.max)continue;window.luckysheet_getcelldata_cache=null;let k=D.calc_funcStr,w=s.execfunction(k,D.r,D.c,D.index);s.groupValuesRefreshData.push({r:D.r,c:D.c,v:w[1],f:w[2],spe:w[3],index:D.index}),s.execFunctionGlobalData[D.r+"_"+D.c+"_"+D.index]={v:w[1],f:w[2]}}s.execFunctionExist=null},execFunctionGroup1:function(e,n,t,l,o,a=!1){let s=this;o==null&&(o=h.flowdata),window.luckysheet_compareWith||(window.luckysheet_compareWith=zc,window.luckysheet_getarraydata=rg,window.luckysheet_getcelldata=Si,window.luckysheet_parseData=Oc,window.luckysheet_getValue=$a,window.luckysheet_indirect_check=ng,window.luckysheet_indirect_check_return=ig,window.luckysheet_offset_check=og,window.luckysheet_calcADPMM=Pl,window.luckysheet_getSpecialReference=ag),s.execFunctionGlobalData==null&&(s.execFunctionGlobalData={});let u=Yl(),f=u[$e(h.currentSheetIndex)].dynamicArray_compute==null?{}:u[$e(h.currentSheetIndex)].dynamicArray_compute;if(l==null&&(l=h.currentSheetIndex),t!=null){let p=[[{v:null}]];er(0,0,p,t),s.execFunctionGlobalData[e+"_"+n+"_"+l]=p[0][0]}let m=s.getAllFunctionGroup(),d={},g=[],b=0;if(s.execvertex={},s.execFunctionExist==null)for(let p=0;p<m.length;p++){let x=m[p],_=u[$e(x.index)];if(_==null)continue;let S=_.data[x.r][x.c],I=Jn(x.r,x.c,x.index);S!=null&&S.f!=null&&S.f==I&&(x instanceof Object||(x=new Function("return "+x)()),x.color="w",x.parent=null,x.chidren={},x.times=0,d["r"+x.r+"c"+x.c+"i"+x.index]=x,s.isFunctionRangeSave=!1,a?s.isFunctionRangeSave=!0:e!=null&&n!=null&&s.isFunctionRangeSelect(I,e,n,l,f),s.isFunctionRangeSave&&(g.push(x),s.execvertex["r"+x.r+"c"+x.c+"i"+x.index]=x,b++))}else for(let p=0;p<s.execFunctionExist.length;p++){let x=s.execFunctionExist[p];if(!("r"+x.r+"c"+x.c+"i"+x.i in d))for(let _=0;_<m.length;_++){let S=m[_],I=Jn(S.r,S.c,S.index);S.color="w",S.parent=null,S.chidren={},S.times=0,d["r"+S.r+"c"+S.c+"i"+S.index]=S,s.isFunctionRangeSave=!1,a?s.isFunctionRangeSave=!0:s.isFunctionRangeSelect(I,x.r,x.c,x.i,f),s.isFunctionRangeSave&&(g.push(S),s.execvertex["r"+S.r+"c"+S.c+"i"+S.index]=S,b++)}}for(;g.length>0;){let p=g.shift(),x={};s.getChildrenVertex(p,d,x);for(let _ in d){let S=d[_];if(S==null)continue;let I="r"+p.r+"c"+p.c+"i"+p.index;if(_ in x)continue;s.isFunctionRangeSave=!1;let O=Jn(S.r,S.c,S.index);s.isFunctionRangeSelect(O,p.r,p.c,p.index,f),s.isFunctionRangeSave&&(_ in s.execvertex||(g.push(S),s.execvertex[_]=S),b++,s.execvertex[_].chidren[I]=1)}}s.groupValuesRefreshData=[];let y=0;for(;y<b;)for(let p in s.execvertex){let x=s.execvertex[p];x.color=="w"?s.functionDFS(x):x.color=="b"&&y++}s.execFunctionExist=null},getChildrenVertex:function(e,n,t){let l="r"+e.r+"c"+e.c+"i"+e.index;if(t[l]=1,e.chidren!=null)for(let o in e.chidren)n[o]&&!(o in t)&&this.getChildrenVertex(n[o],n,t)},functionDFS:function(e){let n=this;e.color="g",e.times+=1;for(let o in e.chidren){let a=n.execvertex[o];a.color=="w"&&(a.parent="r"+e.r.toString()+"c"+e.c.toString()+"i"+e.index,n.functionDFS(a))}e.color="b",window.luckysheet_getcelldata_cache=null;let t=Jn(e.r,e.c,e.index),l=n.execfunction(t,e.r,e.c,e.index);n.groupValuesRefreshData.push({r:e.r,c:e.c,v:l[1],f:l[2],spe:l[3],index:e.index}),n.execFunctionGlobalData[e.r+"_"+e.c+"_"+e.index]={v:l[1],f:l[2]}},groupValuesRefreshData:[],groupValuesRefresh:function(){let e=this,n=Yl();if(e.groupValuesRefreshData.length>0){for(let t=0;t<e.groupValuesRefreshData.length;t++){let l=e.groupValuesRefreshData[t],o=n[$e(l.index)],a=o.data;if(a==null)continue;let s={};l.spe!=null&&(l.spe.type=="sparklines"?s.spl=l.spe.data:l.spe.type=="dynamicArrayItem"&&(o.dynamicArray=e.insertUpdateDynamicArray(l.spe.data))),s.v=l.v,s.f=l.f,er(l.r,l.c,a,s),He.saveParam("v",l.index,l.v,{r:l.r,c:l.c})}pt.webWorkerFlowDataCache(h.flowdata),e.groupValuesRefreshData=[]}},delFunctionGroup:function(e,n,t){t==null&&(t=h.currentSheetIndex);let l=Yl(),o=l[$e(t)],a=o.calcChain;if(a!=null)for(let u=0;u<a.length;u++){let f=a[u];if(f.r==e&&f.c==n&&f.index==t){a.splice(u,1),He.saveParam("fc",t,null,{op:"del",pos:u});break}}let s=o.dynamicArray;if(s!=null)for(let u=0;u<s.length;u++){let f=s[u];if(f.r==e&&f.c==n&&(f.index==null||f.index==t)){s.splice(u,1),He.saveParam("ac",t,null,{op:"del",pos:u});break}}vs(l)},execfunction:function(e,n,t,l,o,a){let s=this,f=Oe().formulaMore;if(e.indexOf(s.error.r)>-1)return[!1,s.error.r,e];s.checkBracketNum(e)||(e+=")"),l==null&&(l=h.currentSheetIndex),h.calculateSheetIndex=l;let m=$.trim(s.functionParserExe(e));if((m.substr(0,20)=="luckysheet_function."||m.substr(0,22)=="luckysheet_compareWith")&&(s.functionHTMLIndex=0),!s.testFunction(e,m)||m=="")return de.info("",f.execfunctionError),[!1,s.error.n,e];let d=null;window.luckysheetCurrentRow=n,window.luckysheetCurrentColumn=t,window.luckysheetCurrentIndex=l,window.luckysheetCurrentFunction=e;let g=null;try{if(m.indexOf("luckysheet_getcelldata")>-1){let y=m.split("luckysheet_getcelldata('");for(let p=1;p<y.length;p++){let x=y[p].split("')")[0],_=s.getcellrange(x);if(_.row[0]<0||_.column[0]<0)return[!0,s.error.r,e];if(_.sheetIndex==h.calculateSheetIndex&&n>=_.row[0]&&n<=_.row[1]&&t>=_.column[0]&&t<=_.column[1])return Qe()?alert(f.execfunctionSelfError):de.info("",f.execfunctionSelfErrorResult),[!1,0,e]}}d=new Function("return "+m)(),typeof d=="string"&&(d=d.replace(/\x7F/g,'"')),m.indexOf("SPLINES")>-1&&(g=d,d="")}catch(y){let p=y;console.log(y,m),p=s.errorInfo(p),d=[s.error.n,p]}V(d)=="object"&&d.startCell!=null&&(V(d.data)=="array"?d=s.error.v:V(d.data)=="object"&&!rt(d.data.v)?d=d.data.v:rt(d.data)?d=0:d.cell>1||d.rowl>1?d=d.data:d=0);let b=null;if(V(d)=="array"){let y=!1;V(d[0])!="array"&&d.length==2&&(y=q(d[0])),y?d=d[0]:V(d[0])=="array"&&d.length==1&&d[0].length==1?d=d[0][0]:(b={r:n,c:t,f:e,index:l,data:d},d="")}return window.luckysheetCurrentRow=null,window.luckysheetCurrentColumn=null,window.luckysheetCurrentIndex=null,window.luckysheetCurrentFunction=null,n!=null&&t!=null&&(o&&s.execFunctionGroup(n,t,d,l),a||s.insertUpdateFunctionGroup(n,t,l)),g?[!0,d,e,{type:"sparklines",data:g}]:b?[!0,d,e,{type:"dynamicArrayItem",data:b}]:[!0,d,e]},testFunction:function(e,n){return e.substr(0,1)=="="},execstringformula:function(e,n,t,l){let o=this;return this.execfunction(e,n,t,l)},functionResizeData:{},functionResizeStatus:!1,functionResizeTimeout:null,data_parm_index:0},v=v3});function Ch(e,n="redo"){if(e==null)return;let t=e.data;n=="undo"&&(t=e.curdata);for(let l=0;l<e.range.length;l++){let o=e.range[l].row[0],a=e.range[l].row[1],s=e.range[l].column[0],u=e.range[l].column[1];for(let f=o;f<a+1;f++)for(let m=s;m<u+1&&!(f>t.length-1);m++)t[f][m]==null||t[f][m].f==null||t[f][m].f==""?v.delFunctionGroup(f,m,e.sheetIndex):t[f][m]!=null&&t[f][m].f!=null&&t[f][m].f.length>0&&v.insertUpdateFunctionGroup(f,m,e.sheetIndex)}}var import_plugin,y3,Ia,$h=Tt(()=>{import_plugin=Le(Be());Yr();wr();Qo();ji();Fo();To();Vi();Mc();Nc();wa();ir();Sc();Io();fr();ql();Ut();vr();qn();y3={redo:function(e){if(h.jfredo.length==0)return;let n=h.jfredo.pop();if(h.jfundo.push(n),h.clearjfundo=!1,ct.hasSheet(n.sheetIndex)&&h.currentSheetIndex!=n.sheetIndex&&ct.changeSheetExec(n.sheetIndex),n.type=="datachange"){Ch(n);let l={cfg:n.config,RowlChange:n.RowlChange,cdformat:n.cdformat,dataVerification:n.dataVerification,dynamicArray:n.dynamicArray};Gt(n.data,n.dataRange,l)}else if(n.type=="pasteCut"){let l={sheetIndex:n.source.sheetIndex,data:n.source.curData,curData:n.source.data,config:n.source.curConfig,curConfig:n.source.config,cdformat:n.source.curCdformat,curCdformat:n.source.cdformat,dataVerification:n.source.curDataVerification,curDataVerification:n.source.dataVerification,range:n.source.range},o={sheetIndex:n.target.sheetIndex,data:n.target.curData,curData:n.target.data,config:n.target.curConfig,curConfig:n.target.config,cdformat:n.target.curCdformat,curCdformat:n.target.cdformat,dataVerification:n.target.curDataVerification,curDataVerification:n.target.dataVerification,range:n.target.range};Dc(l,o,n.RowlChange)}else if(n.type=="rangechange")Ch(n),bc(n.data,n.range,n.cdformat);else if(n.type=="resize"){h.config=n.config,h.luckysheetfile[$e(n.sheetIndex)].config=h.config,n.ctrlType=="resizeR"?He.saveParam("cg",n.sheetIndex,n.config.rowlen,{k:"rowlen"}):n.ctrlType=="resizeC"&&He.saveParam("cg",n.sheetIndex,n.config.columnlen,{k:"columnlen"});let l=$.extend(!0,{},n.images);h.luckysheetfile[$e(n.sheetIndex)].images=l,He.saveParam("all",n.sheetIndex,l,{k:"images"}),$t.images=l,$t.allImagesShow(),Nl(h.flowdata.length,h.flowdata[0].length)}else if(n.type=="cellRowChange")fi(n.data[0].length,n.data.length,n.data,n.config,n.range,n.ctrlType,n.ctrlValue,n.cdformat);else if(n.type=="extend")fi(n.data[0].length,n.data.length,n.data,n.config,n.range,"dele",n.ctrlValue);else if(n.type=="dele"){let l=$.extend(!0,{},n.ctrlValue);l.restore=!0,fi(n.data[0].length,n.data.length,n.data,n.config,n.range,"extend",l)}else if(n.type=="addRC"){let l=$.extend(!0,{},n.ctrlValue);l.direction=="rightbottom"&&(l.index=l.index+1),Ka(n.data,n.config,"delRC",l,n.calc,n.filterObj,n.cf,n.af,n.freezen,n.dataVerification,n.hyperlink)}else if(n.type=="delRC"){let l=$.extend(!0,{},n.ctrlValue);l.restore=!0,l.direction="lefttop",Ka(n.data,n.config,"addRC",l,n.calc,n.filterObj,n.cf,n.af,n.freezen,n.dataVerification,n.hyperlink)}else if(n.type=="deleteCell")Pu(n.data,n.config,n.ctrl,n.calc,n.filterObj,n.cf,n.dataVerification,n.hyperlink);else if(n.type=="showHidRows")h.config=n.config,h.luckysheetfile[$e(n.sheetIndex)].config=n.config,He.saveParam("cg",n.sheetIndex,n.config.rowhidden,{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length);else if(n.type=="showHidCols")h.config=n.config,h.luckysheetfile[$e(n.sheetIndex)].config=n.config,He.saveParam("cg",n.sheetIndex,n.config.colhidden,{k:"colhidden"}),Nl(h.flowdata.length,h.flowdata[0].length);else if(n.type=="datachangeAll")v.execFunctionGroup(),fi(n.data[0].length,n.data.length,n.data,null,n.range,"datachangeAll",n.ctrlValue);else if(n.type=="datachangeAll_filter_clear")Bn(n.filter_save),$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(l){let o=$(this),a=n.optiongroups[l];Xa(o,a.optionstate,a.rowhidden,a.caljs,!1,a.st_r,a.ed_r,a.cindex,a.st_c,a.ed_c)}),He.saveParam("fsr",h.currentSheetIndex,{filter:n.optiongroups,filter_select:n.filter_save}),h.config=n.config,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,h.config.rowhidden==null&&(h.config.rowhidden={}),He.saveParam("cg",h.currentSheetIndex,h.config.rowhidden,{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();else if(n.type=="datachangeAll_filter"){let l=$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(n.optionsindex),o=l.data("str"),a=l.data("edr"),s=l.data("cindex"),u=l.data("stc"),f=l.data("edc");Xa(l,qa.hasKey(n.rowhidenPre),n.rowhidenPre,n.caljs,!0,o,a,s,u,f),h.config=n.config,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,h.config.rowhidden==null&&(h.config.rowhidden={}),He.saveParam("cg",h.currentSheetIndex,h.config.rowhidden,{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}else if(n.type=="filtershow")$("#luckysheet-filter-selected-sheet"+n.sheetIndex+", #luckysheet-filter-options-sheet"+n.sheetIndex).remove(),He.allowUpdate&&He.saveParam("all",n.sheetIndex,null,{k:"filter_select"});else if(n.type=="pivotTable_change")h.luckysheetfile[$e(n.sheetIndex)].pivotTable=n.pivotTable,Pt.getCellData(n.sheetIndex),Pt.initialPivotManage(!0),Pt.refreshPivotTable();else if(n.type=="addSheet")ct.deleteSheet(n.index),ct.changeSheetExec(n.currentSheetIndex),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(n.type=="copySheet")ct.deleteSheet(n.index),ct.changeSheetExec(n.copyindex);else if(n.type=="deleteSheet"){let l=!1;for(let o=0;o<h.luckysheetfile.length;o++)h.luckysheetfile[o].name==n.name&&(l=!0);l||(ct.createSheetbydata(n,"isrenew"),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide())}else if(n.type=="sheetName")h.luckysheetfile[$e(n.sheetIndex)].name=n.oldtxt,$("#luckysheet-sheets-item"+n.sheetIndex).find(".luckysheet-sheets-item-name").html(n.oldtxt),He.saveParam("all",n.sheetIndex,n.oldtxt,{k:"name"});else if(n.type=="sheetColor"){h.luckysheetfile[$e(n.sheetIndex)].color=n.oldcolor;let l=$("#luckysheet-sheets-item"+n.sheetIndex);l.find(".luckysheet-sheets-item-color").remove(),n.oldcolor!=null&&l.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+n.oldcolor+';"></div>'),He.saveParam("all",n.sheetIndex,n.oldcolor,{k:"color"})}else if(n.type=="mergeChange"){let l={cfg:n.config};Gt(n.data,n.range,l)}else if(n.type=="updateDataVerification")Vt.ref(n.currentDataVerification,n.historyDataVerification,n.sheetIndex);else if(n.type=="updateDataVerificationOfCheckbox")Vt.refOfCheckbox(n.currentDataVerification,n.historyDataVerification,n.sheetIndex,n.data,n.range);else if(n.type=="updateHyperlink")Mn.ref(n.currentHyperlink,n.historyHyperlink,n.sheetIndex,n.data,n.range);else if(n.type=="updateCF"){let l=n.data.historyRules;for(let o=0;o<l.length;o++){let a=l[o].sheetIndex;h.luckysheetfile[$e(a)].luckysheet_conditionformat_save=l[o].luckysheet_conditionformat_save,He.allowUpdate&&He.saveParam("all",a,l[o].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}xt.ref()}else if(n.type=="updateAF"){let l=n.data.historyRules,o=$e(n.sheetIndex);h.luckysheetfile[o].luckysheet_alternateformat_save=$.extend(!0,[],l),setTimeout(function(){Et()},1)}else if(n.type=="borderChange")n.config.borderInfo==null?He.saveParam("cg",n.sheetIndex,[],{k:"borderInfo"}):He.saveParam("cg",n.sheetIndex,n.config.borderInfo,{k:"borderInfo"}),h.config=n.config,h.luckysheetfile[$e(n.sheetIndex)].config=h.config,setTimeout(function(){Et()},1);else if(n.type=="postil"){Nt.ref(n.data,n.rc);for(let l=0;l<n.rc.length;l++){let o=n.rc[l].split("_")[0],a=n.rc[l].split("_")[1];n.data[o][a]!=null&&n.data[o][a].ps!=null?Nt.buildPs(o,a,n.data[o][a].ps):Nt.buildPs(o,a,null)}}else n.type=="imageCtrl"?($t.images=$.extend(!0,{},n.images),$t.allImagesShow(),$t.ref()):n.type=="zoomChange"&&(h.zoomRatio=n.zoomRatio,He.saveParam("all",n.currentSheetIndex,n.zoomRatio,{k:"zoomRatio"}),Ii(),Ec());Ir(e),n.range&&(h.luckysheet_select_save=n.range,Zt()),h.clearjfundo=!0;let t={...n,data:n.curdata,curdata:n.data};Yt.createHookFunction("updated",t)},undo:function(){if(h.jfundo.length==0)return;let e=h.jfundo.pop();if(h.jfredo.push(e),h.clearjfundo=!1,ct.hasSheet(e.sheetIndex)&&h.currentSheetIndex!=e.sheetIndex&&ct.changeSheetExec(e.sheetIndex),e.type=="datachange"){v.execFunctionGroup();let n={cfg:e.curConfig,RowlChange:e.RowlChange,cdformat:e.curCdformat,dataVerification:e.curDataVerification,dynamicArray:e.curDynamicArray};Ch(e,"undo"),Gt(e.curdata,e.range,n)}else if(e.type=="pasteCut")Dc(e.source,e.target,e.RowlChange);else if(e.type=="rangechange")Ch(e,"undo"),bc(e.curdata,e.range,e.curCdformat);else if(e.type=="resize"){h.config=e.curconfig,h.luckysheetfile[$e(e.sheetIndex)].config=h.config,e.ctrlType=="resizeR"?He.saveParam("cg",e.sheetIndex,e.curconfig.rowlen,{k:"rowlen"}):e.ctrlType=="resizeC"&&He.saveParam("cg",e.sheetIndex,e.curconfig.columnlen,{k:"columnlen"});let n=$.extend(!0,{},e.curImages);h.luckysheetfile[$e(e.sheetIndex)].images=n,He.saveParam("all",e.sheetIndex,n,{k:"images"}),$t.images=n,$t.allImagesShow(),Nl(h.flowdata.length,h.flowdata[0].length)}else if(e.type=="cellRowChange")fi(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue,e.curCdformat);else if(e.type=="extend")fi(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue);else if(e.type=="dele"){let n=$.extend(!0,{},e.ctrlValue);n.restore=!0,fi(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue)}else if(e.type=="addRC")Ka(e.curData,e.curConfig,"addRC",e.ctrlValue,e.curCalc,e.curFilterObj,e.curCf,e.curAf,e.curFreezen,e.curDataVerification,e.curHyperlink);else if(e.type=="delRC")Ka(e.curData,e.curConfig,"delRC",e.ctrlValue,e.curCalc,e.curFilterObj,e.curCf,e.curAf,e.curFreezen,e.curDataVerification,e.curHyperlink);else if(e.type=="deleteCell")Pu(e.curData,e.curConfig,e.ctrl,e.curCalc,e.curFilterObj,e.curCf,e.curDataVerification,e.curHyperlink);else if(e.type=="showHidRows")h.config=e.curconfig,h.luckysheetfile[$e(e.sheetIndex)].config=e.curconfig,He.saveParam("cg",e.sheetIndex,e.curconfig.rowhidden,{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length);else if(e.type=="showHidCols")h.config=e.curconfig,h.luckysheetfile[$e(e.sheetIndex)].config=e.curconfig,He.saveParam("cg",e.sheetIndex,e.curconfig.colhidden,{k:"colhidden"}),Nl(h.flowdata.length,h.flowdata[0].length);else if(e.type=="datachangeAll")v.execFunctionGroup(),fi(e.curdata[0].length,e.curdata.length,e.curdata,null,e.currange,"datachangeAll",e.ctrlValue);else if(e.type=="datachangeAll_filter_clear")He.saveParam("fsc",h.currentSheetIndex,null),h.config=e.curconfig,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,{},{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text("\u65E0"),$("#luckysheet-filter-selected-sheet"+h.currentSheetIndex+", #luckysheet-filter-options-sheet"+h.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();else if(e.type=="datachangeAll_filter"){let n=$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(e.optionsindex),t=n.data("str"),l=n.data("edr"),o=n.data("cindex"),a=n.data("stc"),s=n.data("edc");Xa(n,qa.hasKey(e.rowhidden),e.rowhidden,e.caljs,!0,t,l,o,a,s),h.config=e.curconfig,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,h.config.rowhidden,{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}else if(e.type=="filtershow")h.luckysheet_select_save=[e.filter_save],h.filterchage=!1,Ou(),h.filterchage=!0,He.saveParam("all",e.sheetIndex,e.filter_save,{k:"filter_select"});else if(e.type=="pivotTable_change")h.luckysheetfile[$e(e.sheetIndex)].pivotTable=e.pivotTablecur,Pt.getCellData(e.sheetIndex),Pt.initialPivotManage(!0),Pt.refreshPivotTable();else if(e.type=="addSheet")ct.createSheetbydata(e.sheetconfig),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(e.type=="copySheet")ct.copySheet(e.copyindex);else if(e.type=="deleteSheet")ct.deleteSheet(e.index),e.order==0?ct.changeSheetExec(h.luckysheetfile[0].index):ct.changeSheetExec(h.luckysheetfile[e.order-1].index),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(e.type=="sheetName")h.luckysheetfile[$e(e.sheetIndex)].name=e.txt,$("#luckysheet-sheets-item"+e.sheetIndex).find(".luckysheet-sheets-item-name").html(e.txt),He.saveParam("all",e.sheetIndex,e.txt,{k:"name"});else if(e.type=="sheetColor"){h.luckysheetfile[$e(e.sheetIndex)].color=e.color;let n=$("#luckysheet-sheets-item"+e.sheetIndex);n.find(".luckysheet-sheets-item-color").remove(),e.color!=null&&n.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e.color+';"></div>'),He.saveParam("all",e.sheetIndex,e.color,{k:"color"})}else if(e.type=="mergeChange"){let n={cfg:e.curConfig};Gt(e.curData,e.range,n)}else if(e.type=="updateDataVerification")Vt.ref(e.historyDataVerification,e.currentDataVerification,e.sheetIndex);else if(e.type=="updateDataVerificationOfCheckbox")Vt.refOfCheckbox(e.historyDataVerification,e.currentDataVerification,e.sheetIndex,e.curData,e.range);else if(e.type=="updateHyperlink")Mn.ref(e.historyHyperlink,e.currentHyperlink,e.sheetIndex,e.curData,e.range);else if(e.type=="updateCF"){let n=e.data.currentRules;for(let t=0;t<n.length;t++){let l=n[t].sheetIndex;h.luckysheetfile[$e(l)].luckysheet_conditionformat_save=n[t].luckysheet_conditionformat_save,He.allowUpdate&&He.saveParam("all",l,n[t].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}xt.ref()}else if(e.type=="updateAF"){let n=e.data.currentRules,t=$e(e.sheetIndex);h.luckysheetfile[t].luckysheet_alternateformat_save=$.extend(!0,[],n),setTimeout(function(){Et()},1)}else if(e.type=="borderChange")He.saveParam("cg",e.sheetIndex,e.curconfig.borderInfo,{k:"borderInfo"}),h.config=e.curconfig,h.luckysheetfile[$e(e.sheetIndex)].config=h.config,setTimeout(function(){Et()},1);else if(e.type=="postil"){Nt.ref(e.curdata,e.rc);for(let n=0;n<e.rc.length;n++){let t=e.rc[n].split("_")[0],l=e.rc[n].split("_")[1];e.curdata[t][l]!=null&&e.curdata[t][l].ps!=null?Nt.buildPs(t,l,e.curdata[t][l].ps):Nt.buildPs(t,l,null)}}else e.type=="imageCtrl"?($t.images=$.extend(!0,{},e.curImages),$t.allImagesShow(),$t.ref()):e.type=="zoomChange"&&(h.zoomRatio=e.curZoomRatio,He.saveParam("all",e.currentSheetIndex,e.curZoomRatio,{k:"zoomRatio"}),Ii(),Ec());e.range&&(h.luckysheet_select_save=e.range,Zt()),h.clearjfundo=!0}},Ia=y3});var import_plugin,Sh,es,fg=Tt(()=>{import_plugin=Le(Be()),Sh=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],es={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:e=>typeof console!="undefined"&&console.warn(e),getWeek:e=>{let n=new Date(e.getTime());n.setHours(0,0,0,0),n.setDate(n.getDate()+3-(n.getDay()+6)%7);var t=new Date(n.getFullYear(),0,4);return 1+Math.round(((n.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1}});var import_plugin,Ih,Th,hg=Tt(()=>{import_plugin=Le(Be()),Ih={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:e=>{let n=e%100;if(n>3&&n<21)return"th";switch(n%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Th=Ih});function dg(e,n){let t;return function(){clearTimeout(t),t=setTimeout(()=>e.apply(this,arguments),n)}}var import_plugin,ri,Ri,Rh,mg=Tt(()=>{import_plugin=Le(Be()),ri=(e,n=2)=>`000${e}`.slice(n*-1),Ri=e=>e===!0?1:0;Rh=e=>e instanceof Array?e:[e]});function ni(e,n,t){if(t===!0)return e.classList.add(n);e.classList.remove(n)}function hr(e,n,t){let l=window.document.createElement(e);return n=n||"",t=t||"",l.className=n,t!==void 0&&(l.textContent=t),l}function Gu(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function gg(e,n){if(n(e))return e;if(e.parentNode)return gg(e.parentNode,n)}function Yu(e,n){let t=hr("div","numInputWrapper"),l=hr("input","numInput "+e),o=hr("span","arrowUp"),a=hr("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?l.type="number":(l.type="text",l.pattern="\\d*"),n!==void 0)for(let s in n)l.setAttribute(s,n[s]);return t.appendChild(l),t.appendChild(o),t.appendChild(a),t}function Fi(e){try{return typeof e.composedPath=="function"?e.composedPath()[0]:e.target}catch(n){return e.target}}var import_plugin,C1=Tt(()=>{import_plugin=Le(Be())});var import_plugin,pg,qu,$1,Xu,Lc,vg=Tt(()=>{import_plugin=Le(Be());mg();pg=()=>{},qu=(e,n,t)=>t.months[n?"shorthand":"longhand"][e],$1={D:pg,F:function(e,n,t){e.setMonth(t.months.longhand.indexOf(n))},G:(e,n)=>{e.setHours(parseFloat(n))},H:(e,n)=>{e.setHours(parseFloat(n))},J:(e,n)=>{e.setDate(parseFloat(n))},K:(e,n,t)=>{e.setHours(e.getHours()%12+12*Ri(new RegExp(t.amPM[1],"i").test(n)))},M:function(e,n,t){e.setMonth(t.months.shorthand.indexOf(n))},S:(e,n)=>{e.setSeconds(parseFloat(n))},U:(e,n)=>new Date(parseFloat(n)*1e3),W:function(e,n,t){let l=parseInt(n),o=new Date(e.getFullYear(),0,2+(l-1)*7,0,0,0,0);return o.setDate(o.getDate()-o.getDay()+t.firstDayOfWeek),o},Y:(e,n)=>{e.setFullYear(parseFloat(n))},Z:(e,n)=>new Date(n),d:(e,n)=>{e.setDate(parseFloat(n))},h:(e,n)=>{e.setHours(parseFloat(n))},i:(e,n)=>{e.setMinutes(parseFloat(n))},j:(e,n)=>{e.setDate(parseFloat(n))},l:pg,m:(e,n)=>{e.setMonth(parseFloat(n)-1)},n:(e,n)=>{e.setMonth(parseFloat(n)-1)},s:(e,n)=>{e.setSeconds(parseFloat(n))},u:(e,n)=>new Date(parseFloat(n)),w:pg,y:(e,n)=>{e.setFullYear(2e3+parseFloat(n))}},Xu={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},Lc={Z:e=>e.toISOString(),D:function(e,n,t){return n.weekdays.shorthand[Lc.w(e,n,t)]},F:function(e,n,t){return qu(Lc.n(e,n,t)-1,!1,n)},G:function(e,n,t){return ri(Lc.h(e,n,t))},H:e=>ri(e.getHours()),J:function(e,n){return n.ordinal!==void 0?e.getDate()+n.ordinal(e.getDate()):e.getDate()},K:(e,n)=>n.amPM[Ri(e.getHours()>11)],M:function(e,n){return qu(e.getMonth(),!0,n)},S:e=>ri(e.getSeconds()),U:e=>e.getTime()/1e3,W:function(e,n,t){return t.getWeek(e)},Y:e=>ri(e.getFullYear(),4),d:e=>ri(e.getDate()),h:e=>e.getHours()%12?e.getHours()%12:12,i:e=>ri(e.getMinutes()),j:e=>e.getDate(),l:function(e,n){return n.weekdays.longhand[e.getDay()]},m:e=>ri(e.getMonth()+1),n:e=>e.getMonth()+1,s:e=>e.getSeconds(),u:e=>e.getTime(),w:e=>e.getDay(),y:e=>String(e.getFullYear()).substring(2)}});function Mi(e,n,t=!0){return t!==!1?new Date(e.getTime()).setHours(0,0,0,0)-new Date(n.getTime()).setHours(0,0,0,0):e.getTime()-n.getTime()}function Mh(e){let n=e.defaultHour,t=e.defaultMinute,l=e.defaultSeconds;if(e.minDate!==void 0){let o=e.minDate.getHours(),a=e.minDate.getMinutes(),s=e.minDate.getSeconds();n<o&&(n=o),n===o&&t<a&&(t=a),n===o&&t===a&&l<s&&(l=e.minDate.getSeconds())}if(e.maxDate!==void 0){let o=e.maxDate.getHours(),a=e.maxDate.getMinutes();n=Math.min(n,o),n===o&&(t=Math.min(a,t)),n===o&&t===a&&(l=e.maxDate.getSeconds())}return{hours:n,minutes:t,seconds:l}}var import_plugin,yg,Fh,S1,I1,T1=Tt(()=>{import_plugin=Le(Be());vg();fg();hg();yg=({config:e=es,l10n:n=Ih,isMobile:t=!1})=>(l,o,a)=>{let s=a||n;return e.formatDate!==void 0&&!t?e.formatDate(l,o,s):o.split("").map((u,f,m)=>Lc[u]&&m[f-1]!=="\\"?Lc[u](l,s,e):u!=="\\"?u:"").join("")},Fh=({config:e=es,l10n:n=Ih})=>(t,l,o,a)=>{if(t!==0&&!t)return;let s=a||n,u,f=t;if(t instanceof Date)u=new Date(t.getTime());else if(typeof t!="string"&&t.toFixed!==void 0)u=new Date(t);else if(typeof t=="string"){let m=l||(e||es).dateFormat,d=String(t).trim();if(d==="today")u=new Date,o=!0;else if(/Z$/.test(d)||/GMT$/.test(d))u=new Date(t);else if(e&&e.parseDate)u=e.parseDate(t,m);else{u=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0));let g,b=[];for(let y=0,p=0,x="";y<m.length;y++){let _=m[y],S=_==="\\",I=m[y-1]==="\\"||S;if(Xu[_]&&!I){x+=Xu[_];let O=new RegExp(x).exec(t);O&&(g=!0)&&b[_!=="Y"?"push":"unshift"]({fn:$1[_],val:O[++p]})}else S||(x+=".");b.forEach(({fn:O,val:F})=>u=O(u,F,s)||u)}u=g?u:void 0}}if(!(u instanceof Date&&!isNaN(u.getTime()))){e.errorHandler(new Error(`Invalid date provided: ${f}`));return}return o===!0&&u.setHours(0,0,0,0),u};S1=(e,n,t)=>e>Math.min(n,t)&&e<Math.max(n,t),I1={DAY:864e5}});var import_plugin,R1=Tt(()=>{import_plugin=Le(Be());"use strict";typeof Object.assign!="function"&&(Object.assign=function(e,...n){if(!e)throw TypeError("Cannot convert undefined or null to object");for(let t of n)t&&Object.keys(t).forEach(l=>e[l]=t[l]);return e})});function b3(e,n){let t={config:Object.assign(Object.assign({},es),xn.defaultConfig),l10n:Th};t.parseDate=Fh({config:t.config,l10n:t.l10n}),t._handlers=[],t.pluginElements=[],t.loadedPlugins=[],t._bind=p,t._setHoursFromDate=g,t._positionCalendar=wt,t.changeMonth=he,t.changeYear=se,t.clear=Z,t.close=ae,t._createElement=hr,t.destroy=J,t.isEnabled=te,t.jumpToDate=S,t.open=Ce,t.redraw=me,t.set=De,t.setDate=Ze,t.toggle=Ue;function l(){t.utils={getDaysInMonth(_e=t.currentMonth,Ne=t.currentYear){return _e===1&&(Ne%4==0&&Ne%100!=0||Ne%400==0)?29:t.l10n.daysInMonth[_e]}}}function o(){t.element=t.input=e,t.isOpen=!1,ft(),vt(),ve(),Ie(),l(),t.isMobile||F(),_(),(t.selectedDates.length||t.config.noCalendar)&&(t.config.enableTime&&g(t.config.noCalendar?t.latestSelectedDateObj:void 0),Rr(!1)),s();let _e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!t.isMobile&&_e&&wt(),We("onReady")}function a(_e){return _e.bind(t)}function s(){let _e=t.config;_e.weekNumbers===!1&&_e.showMonths===1||_e.noCalendar!==!0&&window.requestAnimationFrame(function(){if(t.calendarContainer!==void 0&&(t.calendarContainer.style.visibility="hidden",t.calendarContainer.style.display="block"),t.daysContainer!==void 0){let Ne=(t.days.offsetWidth+1)*_e.showMonths;t.daysContainer.style.width=Ne+"px",t.calendarContainer.style.width=Ne+(t.weekWrapper!==void 0?t.weekWrapper.offsetWidth:0)+"px",t.calendarContainer.style.removeProperty("visibility"),t.calendarContainer.style.removeProperty("display")}})}function u(_e){if(t.selectedDates.length===0){let nt=t.config.minDate===void 0||Mi(new Date,t.config.minDate)>=0?new Date:new Date(t.config.minDate.getTime()),mt=Mh(t.config);nt.setHours(mt.hours,mt.minutes,mt.seconds,nt.getMilliseconds()),t.selectedDates=[nt],t.latestSelectedDateObj=nt}_e!==void 0&&_e.type!=="blur"&&ln(_e);let Ne=t._input.value;d(),Rr(),t._input.value!==Ne&&t._debouncedChange()}function f(_e,Ne){return _e%12+12*Ri(Ne===t.l10n.amPM[1])}function m(_e){switch(_e%24){case 0:case 12:return 12;default:return _e%12}}function d(){if(t.hourElement===void 0||t.minuteElement===void 0)return;let _e=(parseInt(t.hourElement.value.slice(-2),10)||0)%24,Ne=(parseInt(t.minuteElement.value,10)||0)%60,nt=t.secondElement!==void 0?(parseInt(t.secondElement.value,10)||0)%60:0;t.amPM!==void 0&&(_e=f(_e,t.amPM.textContent));let mt=t.config.minTime!==void 0||t.config.minDate&&t.minDateHasTime&&t.latestSelectedDateObj&&Mi(t.latestSelectedDateObj,t.config.minDate,!0)===0;if(t.config.maxTime!==void 0||t.config.maxDate&&t.maxDateHasTime&&t.latestSelectedDateObj&&Mi(t.latestSelectedDateObj,t.config.maxDate,!0)===0){let _t=t.config.maxTime!==void 0?t.config.maxTime:t.config.maxDate;_e=Math.min(_e,_t.getHours()),_e===_t.getHours()&&(Ne=Math.min(Ne,_t.getMinutes())),Ne===_t.getMinutes()&&(nt=Math.min(nt,_t.getSeconds()))}if(mt){let _t=t.config.minTime!==void 0?t.config.minTime:t.config.minDate;_e=Math.max(_e,_t.getHours()),_e===_t.getHours()&&Ne<_t.getMinutes()&&(Ne=_t.getMinutes()),Ne===_t.getMinutes()&&(nt=Math.max(nt,_t.getSeconds()))}b(_e,Ne,nt)}function g(_e){let Ne=_e||t.latestSelectedDateObj;Ne&&b(Ne.getHours(),Ne.getMinutes(),Ne.getSeconds())}function b(_e,Ne,nt){t.latestSelectedDateObj!==void 0&&t.latestSelectedDateObj.setHours(_e%24,Ne,nt||0,0),!(!t.hourElement||!t.minuteElement||t.isMobile)&&(t.hourElement.value=ri(t.config.time_24hr?_e:(12+_e)%12+12*Ri(_e%12==0)),t.minuteElement.value=ri(Ne),t.amPM!==void 0&&(t.amPM.textContent=t.l10n.amPM[Ri(_e>=12)]),t.secondElement!==void 0&&(t.secondElement.value=ri(nt)))}function y(_e){let Ne=Fi(_e),nt=parseInt(Ne.value)+(_e.delta||0);(nt/1e3>1||_e.key==="Enter"&&!/[^\d]/.test(nt.toString()))&&se(nt)}function p(_e,Ne,nt,mt){if(Ne instanceof Array)return Ne.forEach(Ft=>p(_e,Ft,nt,mt));if(_e instanceof Array)return _e.forEach(Ft=>p(Ft,Ne,nt,mt));_e.addEventListener(Ne,nt,mt),t._handlers.push({remove:()=>_e.removeEventListener(Ne,nt)})}function x(){We("onChange")}function _(){if(t.config.wrap&&["open","close","toggle","clear"].forEach(Ne=>{Array.prototype.forEach.call(t.element.querySelectorAll(`[data-${Ne}]`),nt=>p(nt,"click",t[Ne]))}),t.isMobile){Ge();return}let _e=dg(Ye,50);if(t._debouncedChange=dg(x,k3),t.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&p(t.daysContainer,"mouseover",Ne=>{t.config.mode==="range"&&ye(Fi(Ne))}),p(window.document.body,"keydown",Me),!t.config.inline&&!t.config.static&&p(window,"resize",_e),window.ontouchstart!==void 0?p(window.document,"touchstart",K):p(window.document,"mousedown",K),p(window.document,"focus",K,{capture:!0}),t.config.clickOpens===!0&&(p(t._input,"focus",t.open),p(t._input,"click",t.open)),t.daysContainer!==void 0&&(p(t.monthNav,"click",Di),p(t.monthNav,["keyup","increment"],y),p(t.daysContainer,"click",Te)),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0){let Ne=nt=>Fi(nt).select();p(t.timeContainer,["increment"],u),p(t.timeContainer,"blur",u,{capture:!0}),p(t.timeContainer,"click",I),p([t.hourElement,t.minuteElement],["focus","click"],Ne),t.secondElement!==void 0&&p(t.secondElement,"focus",()=>t.secondElement&&t.secondElement.select()),t.amPM!==void 0&&p(t.amPM,"click",nt=>{u(nt),x()})}t.config.allowInput&&p(t._input,"blur",fe)}function S(_e,Ne){let nt=_e!==void 0?t.parseDate(_e):t.latestSelectedDateObj||(t.config.minDate&&t.config.minDate>t.now?t.config.minDate:t.config.maxDate&&t.config.maxDate<t.now?t.config.maxDate:t.now),mt=t.currentYear,Ft=t.currentMonth;try{nt!==void 0&&(t.currentYear=nt.getFullYear(),t.currentMonth=nt.getMonth())}catch(_t){_t.message="Invalid date supplied: "+nt,t.config.errorHandler(_t)}Ne&&t.currentYear!==mt&&(We("onYearChange"),M()),Ne&&(t.currentYear!==mt||t.currentMonth!==Ft)&&We("onMonthChange"),t.redraw()}function I(_e){let Ne=Fi(_e);~Ne.className.indexOf("arrow")&&O(_e,Ne.classList.contains("arrowUp")?1:-1)}function O(_e,Ne,nt){let mt=_e&&Fi(_e),Ft=nt||mt&&mt.parentNode&&mt.parentNode.firstChild,_t=it("increment");_t.delta=Ne,Ft&&Ft.dispatchEvent(_t)}function F(){let _e=window.document.createDocumentFragment();if(t.calendarContainer=hr("div","flatpickr-calendar"),t.calendarContainer.tabIndex=-1,!t.config.noCalendar){if(_e.appendChild(E()),t.innerContainer=hr("div","flatpickr-innerContainer"),t.config.weekNumbers){let{weekWrapper:nt,weekNumbers:mt}=le();t.innerContainer.appendChild(nt),t.weekNumbers=mt,t.weekWrapper=nt}t.rContainer=hr("div","flatpickr-rContainer"),t.rContainer.appendChild(U()),t.daysContainer||(t.daysContainer=hr("div","flatpickr-days"),t.daysContainer.tabIndex=-1),A(),t.rContainer.appendChild(t.daysContainer),t.innerContainer.appendChild(t.rContainer),_e.appendChild(t.innerContainer)}t.config.enableTime&&_e.appendChild(B()),ni(t.calendarContainer,"rangeMode",t.config.mode==="range"),ni(t.calendarContainer,"animate",t.config.animate===!0),ni(t.calendarContainer,"multiMonth",t.config.showMonths>1),t.calendarContainer.appendChild(_e);let Ne=t.config.appendTo!==void 0&&t.config.appendTo.nodeType!==void 0;if((t.config.inline||t.config.static)&&(t.calendarContainer.classList.add(t.config.inline?"inline":"static"),t.config.inline&&(!Ne&&t.element.parentNode?t.element.parentNode.insertBefore(t.calendarContainer,t._input.nextSibling):t.config.appendTo!==void 0&&t.config.appendTo.appendChild(t.calendarContainer)),t.config.static)){let nt=hr("div","flatpickr-wrapper");t.element.parentNode&&t.element.parentNode.insertBefore(nt,t.element),nt.appendChild(t.element),t.altInput&&nt.appendChild(t.altInput),nt.appendChild(t.calendarContainer)}!t.config.static&&!t.config.inline&&(t.config.appendTo!==void 0?t.config.appendTo:window.document.body).appendChild(t.calendarContainer)}function D(_e,Ne,nt,mt){let Ft=te(Ne,!0),_t=hr("span","flatpickr-day "+_e,Ne.getDate().toString());return _t.dateObj=Ne,_t.$i=mt,_t.setAttribute("aria-label",t.formatDate(Ne,t.config.ariaDateFormat)),_e.indexOf("hidden")===-1&&Mi(Ne,t.now)===0&&(t.todayDateElem=_t,_t.classList.add("today"),_t.setAttribute("aria-current","date")),Ft?(_t.tabIndex=-1,St(Ne)&&(_t.classList.add("selected"),t.selectedDateElem=_t,t.config.mode==="range"&&(ni(_t,"startRange",t.selectedDates[0]&&Mi(Ne,t.selectedDates[0],!0)===0),ni(_t,"endRange",t.selectedDates[1]&&Mi(Ne,t.selectedDates[1],!0)===0),_e==="nextMonthDay"&&_t.classList.add("inRange")))):_t.classList.add("flatpickr-disabled"),t.config.mode==="range"&&Kt(Ne)&&!St(Ne)&&_t.classList.add("inRange"),t.weekNumbers&&t.config.showMonths===1&&_e!=="prevMonthDay"&&nt%7==1&&t.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+t.config.getWeek(Ne)+"</span>"),We("onDayCreate",_t),_t}function k(_e){_e.focus(),t.config.mode==="range"&&ye(_e)}function w(_e){let Ne=_e>0?0:t.config.showMonths-1,nt=_e>0?t.config.showMonths:-1;for(let mt=Ne;mt!=nt;mt+=_e){let Ft=t.daysContainer.children[mt],_t=_e>0?0:Ft.children.length-1,Jt=_e>0?Ft.children.length:-1;for(let qt=_t;qt!=Jt;qt+=_e){let wl=Ft.children[qt];if(wl.className.indexOf("hidden")===-1&&te(wl.dateObj))return wl}}}function C(_e,Ne){let nt=_e.className.indexOf("Month")===-1?_e.dateObj.getMonth():t.currentMonth,mt=Ne>0?t.config.showMonths:-1,Ft=Ne>0?1:-1;for(let _t=nt-t.currentMonth;_t!=mt;_t+=Ft){let Jt=t.daysContainer.children[_t],qt=nt-t.currentMonth===_t?_e.$i+Ne:Ne<0?Jt.children.length-1:0,wl=Jt.children.length;for(let Tl=qt;Tl>=0&&Tl<wl&&Tl!=(Ne>0?wl:-1);Tl+=Ft){let Wl=Jt.children[Tl];if(Wl.className.indexOf("hidden")===-1&&te(Wl.dateObj)&&Math.abs(_e.$i-Tl)>=Math.abs(Ne))return k(Wl)}}t.changeMonth(Ft),T(w(Ft),0)}function T(_e,Ne){let nt=re(document.activeElement||document.body),mt=_e!==void 0?_e:nt?document.activeElement:t.selectedDateElem!==void 0&&re(t.selectedDateElem)?t.selectedDateElem:t.todayDateElem!==void 0&&re(t.todayDateElem)?t.todayDateElem:w(Ne>0?1:-1);mt===void 0?t._input.focus():nt?C(mt,Ne):k(mt)}function z(_e,Ne){let nt=(new Date(_e,Ne,1).getDay()-t.l10n.firstDayOfWeek+7)%7,mt=t.utils.getDaysInMonth((Ne-1+12)%12,_e),Ft=t.utils.getDaysInMonth(Ne,_e),_t=window.document.createDocumentFragment(),Jt=t.config.showMonths>1,qt=Jt?"prevMonthDay hidden":"prevMonthDay",wl=Jt?"nextMonthDay hidden":"nextMonthDay",Tl=mt+1-nt,Wl=0;for(;Tl<=mt;Tl++,Wl++)_t.appendChild(D(qt,new Date(_e,Ne-1,Tl),Tl,Wl));for(Tl=1;Tl<=Ft;Tl++,Wl++)_t.appendChild(D("",new Date(_e,Ne,Tl),Tl,Wl));for(let Vr=Ft+1;Vr<=42-nt&&(t.config.showMonths===1||Wl%7!=0);Vr++,Wl++)_t.appendChild(D(wl,new Date(_e,Ne+1,Vr%Ft),Vr,Wl));let sn=hr("div","dayContainer");return sn.appendChild(_t),sn}function A(){if(t.daysContainer===void 0)return;Gu(t.daysContainer),t.weekNumbers&&Gu(t.weekNumbers);let _e=document.createDocumentFragment();for(let Ne=0;Ne<t.config.showMonths;Ne++){let nt=new Date(t.currentYear,t.currentMonth,1);nt.setMonth(t.currentMonth+Ne),_e.appendChild(z(nt.getFullYear(),nt.getMonth()))}t.daysContainer.appendChild(_e),t.days=t.daysContainer.firstChild,t.config.mode==="range"&&t.selectedDates.length===1&&ye()}function M(){if(t.config.showMonths>1||t.config.monthSelectorType!=="dropdown")return;let _e=function(Ne){return t.config.minDate!==void 0&&t.currentYear===t.config.minDate.getFullYear()&&Ne<t.config.minDate.getMonth()?!1:!(t.config.maxDate!==void 0&&t.currentYear===t.config.maxDate.getFullYear()&&Ne>t.config.maxDate.getMonth())};t.monthsDropdownContainer.tabIndex=-1,t.monthsDropdownContainer.innerHTML="";for(let Ne=0;Ne<12;Ne++){if(!_e(Ne))continue;let nt=hr("option","flatpickr-monthDropdown-month");nt.value=new Date(t.currentYear,Ne).getMonth().toString(),nt.textContent=qu(Ne,t.config.shorthandCurrentMonth,t.l10n),nt.tabIndex=-1,t.currentMonth===Ne&&(nt.selected=!0),t.monthsDropdownContainer.appendChild(nt)}}function P(){let _e=hr("div","flatpickr-month"),Ne=window.document.createDocumentFragment(),nt;t.config.showMonths>1||t.config.monthSelectorType==="static"?nt=hr("span","cur-month"):(t.monthsDropdownContainer=hr("select","flatpickr-monthDropdown-months"),t.monthsDropdownContainer.setAttribute("aria-label",t.l10n.monthAriaLabel),p(t.monthsDropdownContainer,"change",Jt=>{let qt=Fi(Jt),wl=parseInt(qt.value,10);t.changeMonth(wl-t.currentMonth),We("onMonthChange")}),M(),nt=t.monthsDropdownContainer);let mt=Yu("cur-year",{tabindex:"-1"}),Ft=mt.getElementsByTagName("input")[0];Ft.setAttribute("aria-label",t.l10n.yearAriaLabel),t.config.minDate&&Ft.setAttribute("min",t.config.minDate.getFullYear().toString()),t.config.maxDate&&(Ft.setAttribute("max",t.config.maxDate.getFullYear().toString()),Ft.disabled=!!t.config.minDate&&t.config.minDate.getFullYear()===t.config.maxDate.getFullYear());let _t=hr("div","flatpickr-current-month");return _t.appendChild(nt),_t.appendChild(mt),Ne.appendChild(_t),_e.appendChild(Ne),{container:_e,yearElement:Ft,monthElement:nt}}function N(){Gu(t.monthNav),t.monthNav.appendChild(t.prevMonthNav),t.config.showMonths&&(t.yearElements=[],t.monthElements=[]);for(let _e=t.config.showMonths;_e--;){let Ne=P();t.yearElements.push(Ne.yearElement),t.monthElements.push(Ne.monthElement),t.monthNav.appendChild(Ne.container)}t.monthNav.appendChild(t.nextMonthNav)}function E(){return t.monthNav=hr("div","flatpickr-months"),t.yearElements=[],t.monthElements=[],t.prevMonthNav=hr("span","flatpickr-prev-month"),t.prevMonthNav.innerHTML=t.config.prevArrow,t.nextMonthNav=hr("span","flatpickr-next-month"),t.nextMonthNav.innerHTML=t.config.nextArrow,N(),Object.defineProperty(t,"_hidePrevMonthArrow",{get:()=>t.__hidePrevMonthArrow,set(_e){t.__hidePrevMonthArrow!==_e&&(ni(t.prevMonthNav,"flatpickr-disabled",_e),t.__hidePrevMonthArrow=_e)}}),Object.defineProperty(t,"_hideNextMonthArrow",{get:()=>t.__hideNextMonthArrow,set(_e){t.__hideNextMonthArrow!==_e&&(ni(t.nextMonthNav,"flatpickr-disabled",_e),t.__hideNextMonthArrow=_e)}}),t.currentYearElement=t.yearElements[0],bl(),t.monthNav}function B(){t.calendarContainer.classList.add("hasTime"),t.config.noCalendar&&t.calendarContainer.classList.add("noCalendar");let _e=Mh(t.config);t.timeContainer=hr("div","flatpickr-time"),t.timeContainer.tabIndex=-1;let Ne=hr("span","flatpickr-time-separator",":"),nt=Yu("flatpickr-hour",{"aria-label":t.l10n.hourAriaLabel});t.hourElement=nt.getElementsByTagName("input")[0];let mt=Yu("flatpickr-minute",{"aria-label":t.l10n.minuteAriaLabel});if(t.minuteElement=mt.getElementsByTagName("input")[0],t.hourElement.tabIndex=t.minuteElement.tabIndex=-1,t.hourElement.value=ri(t.latestSelectedDateObj?t.latestSelectedDateObj.getHours():t.config.time_24hr?_e.hours:m(_e.hours)),t.minuteElement.value=ri(t.latestSelectedDateObj?t.latestSelectedDateObj.getMinutes():_e.minutes),t.hourElement.setAttribute("step",t.config.hourIncrement.toString()),t.minuteElement.setAttribute("step",t.config.minuteIncrement.toString()),t.hourElement.setAttribute("min",t.config.time_24hr?"0":"1"),t.hourElement.setAttribute("max",t.config.time_24hr?"23":"12"),t.hourElement.setAttribute("maxlength","2"),t.minuteElement.setAttribute("min","0"),t.minuteElement.setAttribute("max","59"),t.minuteElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(nt),t.timeContainer.appendChild(Ne),t.timeContainer.appendChild(mt),t.config.time_24hr&&t.timeContainer.classList.add("time24hr"),t.config.enableSeconds){t.timeContainer.classList.add("hasSeconds");let Ft=Yu("flatpickr-second");t.secondElement=Ft.getElementsByTagName("input")[0],t.secondElement.value=ri(t.latestSelectedDateObj?t.latestSelectedDateObj.getSeconds():_e.seconds),t.secondElement.setAttribute("step",t.minuteElement.getAttribute("step")),t.secondElement.setAttribute("min","0"),t.secondElement.setAttribute("max","59"),t.secondElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(hr("span","flatpickr-time-separator",":")),t.timeContainer.appendChild(Ft)}return t.config.time_24hr||(t.amPM=hr("span","flatpickr-am-pm",t.l10n.amPM[Ri((t.latestSelectedDateObj?t.hourElement.value:t.config.defaultHour)>11)]),t.amPM.title=t.l10n.toggleTitle,t.amPM.tabIndex=-1,t.timeContainer.appendChild(t.amPM)),t.timeContainer}function U(){t.weekdayContainer?Gu(t.weekdayContainer):t.weekdayContainer=hr("div","flatpickr-weekdays");for(let _e=t.config.showMonths;_e--;){let Ne=hr("div","flatpickr-weekdaycontainer");t.weekdayContainer.appendChild(Ne)}return X(),t.weekdayContainer}function X(){if(!t.weekdayContainer)return;let _e=t.l10n.firstDayOfWeek,Ne=[...t.l10n.weekdays.shorthand];_e>0&&_e<Ne.length&&(Ne=[...Ne.splice(_e,Ne.length),...Ne.splice(0,_e)]);for(let nt=t.config.showMonths;nt--;)t.weekdayContainer.children[nt].innerHTML=`
      <span class='flatpickr-weekday'>
        ${Ne.join("</span><span class='flatpickr-weekday'>")}
      </span>
      `}function le(){t.calendarContainer.classList.add("hasWeeks");let _e=hr("div","flatpickr-weekwrapper");_e.appendChild(hr("span","flatpickr-weekday",t.l10n.weekAbbreviation));let Ne=hr("div","flatpickr-weeks");return _e.appendChild(Ne),{weekWrapper:_e,weekNumbers:Ne}}function he(_e,Ne=!0){let nt=Ne?_e:_e-t.currentMonth;nt<0&&t._hidePrevMonthArrow===!0||nt>0&&t._hideNextMonthArrow===!0||(t.currentMonth+=nt,(t.currentMonth<0||t.currentMonth>11)&&(t.currentYear+=t.currentMonth>11?1:-1,t.currentMonth=(t.currentMonth+12)%12,We("onYearChange"),M()),A(),We("onMonthChange"),bl())}function Z(_e=!0,Ne=!0){if(t.input.value="",t.altInput!==void 0&&(t.altInput.value=""),t.mobileInput!==void 0&&(t.mobileInput.value=""),t.selectedDates=[],t.latestSelectedDateObj=void 0,Ne===!0&&(t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth()),t.config.enableTime===!0){let{hours:nt,minutes:mt,seconds:Ft}=Mh(t.config);b(nt,mt,Ft)}t.redraw(),_e&&We("onChange")}function ae(){t.isOpen=!1,t.isMobile||(t.calendarContainer!==void 0&&t.calendarContainer.classList.remove("open"),t._input!==void 0&&t._input.classList.remove("active")),We("onClose")}function J(){t.config!==void 0&&We("onDestroy");for(let _e=t._handlers.length;_e--;)t._handlers[_e].remove();if(t._handlers=[],t.mobileInput)t.mobileInput.parentNode&&t.mobileInput.parentNode.removeChild(t.mobileInput),t.mobileInput=void 0;else if(t.calendarContainer&&t.calendarContainer.parentNode)if(t.config.static&&t.calendarContainer.parentNode){let _e=t.calendarContainer.parentNode;if(_e.lastChild&&_e.removeChild(_e.lastChild),_e.parentNode){for(;_e.firstChild;)_e.parentNode.insertBefore(_e.firstChild,_e);_e.parentNode.removeChild(_e)}}else t.calendarContainer.parentNode.removeChild(t.calendarContainer);t.altInput&&(t.input.type="text",t.altInput.parentNode&&t.altInput.parentNode.removeChild(t.altInput),delete t.altInput),t.input&&(t.input.type=t.input._type,t.input.classList.remove("flatpickr-input"),t.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(_e=>{try{delete t[_e]}catch(Ne){}})}function pe(_e){return t.config.appendTo&&t.config.appendTo.contains(_e)?!0:t.calendarContainer.contains(_e)}function K(_e){if(t.isOpen&&!t.config.inline){let Ne=Fi(_e),nt=pe(Ne),mt=Ne===t.input||Ne===t.altInput||t.element.contains(Ne)||_e.path&&_e.path.indexOf&&(~_e.path.indexOf(t.input)||~_e.path.indexOf(t.altInput)),Ft=_e.type==="blur"?mt&&_e.relatedTarget&&!pe(_e.relatedTarget):!mt&&!nt&&!pe(_e.relatedTarget),_t=!t.config.ignoredFocusElements.some(Jt=>Jt.contains(Ne));Ft&&_t&&(t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0&&t.input.value!==""&&t.input.value!==void 0&&u(),t.close(),t.config&&t.config.mode==="range"&&t.selectedDates.length===1&&(t.clear(!1),t.redraw()))}}function se(_e){if(!_e||t.config.minDate&&_e<t.config.minDate.getFullYear()||t.config.maxDate&&_e>t.config.maxDate.getFullYear())return;let Ne=_e,nt=t.currentYear!==Ne;t.currentYear=Ne||t.currentYear,t.config.maxDate&&t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth=Math.min(t.config.maxDate.getMonth(),t.currentMonth):t.config.minDate&&t.currentYear===t.config.minDate.getFullYear()&&(t.currentMonth=Math.max(t.config.minDate.getMonth(),t.currentMonth)),nt&&(t.redraw(),We("onYearChange"),M())}function te(_e,Ne=!0){var nt;let mt=t.parseDate(_e,void 0,Ne);if(t.config.minDate&&mt&&Mi(mt,t.config.minDate,Ne!==void 0?Ne:!t.minDateHasTime)<0||t.config.maxDate&&mt&&Mi(mt,t.config.maxDate,Ne!==void 0?Ne:!t.maxDateHasTime)>0)return!1;if(!t.config.enable&&t.config.disable.length===0)return!0;if(mt===void 0)return!1;let Ft=!!t.config.enable,_t=(nt=t.config.enable)!==null&&nt!==void 0?nt:t.config.disable;for(let Jt=0,qt;Jt<_t.length;Jt++){if(qt=_t[Jt],typeof qt=="function"&&qt(mt))return Ft;if(qt instanceof Date&&mt!==void 0&&qt.getTime()===mt.getTime())return Ft;if(typeof qt=="string"){let wl=t.parseDate(qt,void 0,!0);return wl&&wl.getTime()===mt.getTime()?Ft:!Ft}else if(typeof qt=="object"&&mt!==void 0&&qt.from&&qt.to&&mt.getTime()>=qt.from.getTime()&&mt.getTime()<=qt.to.getTime())return Ft}return!Ft}function re(_e){return t.daysContainer!==void 0?_e.className.indexOf("hidden")===-1&&_e.className.indexOf("flatpickr-disabled")===-1&&t.daysContainer.contains(_e):!1}function fe(_e){_e.target===t._input&&(t.selectedDates.length>0||t._input.value.length>0)&&!(_e.relatedTarget&&pe(_e.relatedTarget))&&t.setDate(t._input.value,!0,_e.target===t.altInput?t.config.altFormat:t.config.dateFormat)}function Me(_e){let Ne=Fi(_e),nt=t.config.wrap?e.contains(Ne):Ne===t._input,mt=t.config.allowInput,Ft=t.isOpen&&(!mt||!nt),_t=t.config.inline&&nt&&!mt;if(_e.keyCode===13&&nt){if(mt)return t.setDate(t._input.value,!0,Ne===t.altInput?t.config.altFormat:t.config.dateFormat),Ne.blur();t.open()}else if(pe(Ne)||Ft||_t){let Jt=!!t.timeContainer&&t.timeContainer.contains(Ne);switch(_e.keyCode){case 13:Jt?(_e.preventDefault(),u(),xe()):Te(_e);break;case 27:_e.preventDefault(),xe();break;case 8:case 46:nt&&!t.config.allowInput&&(_e.preventDefault(),t.clear());break;case 37:case 39:if(!Jt&&!nt){if(_e.preventDefault(),t.daysContainer!==void 0&&(mt===!1||document.activeElement&&re(document.activeElement))){let wl=_e.keyCode===39?1:-1;_e.ctrlKey?(_e.stopPropagation(),he(wl),T(w(1),0)):T(void 0,wl)}}else t.hourElement&&t.hourElement.focus();break;case 38:case 40:_e.preventDefault();let qt=_e.keyCode===40?1:-1;t.daysContainer&&Ne.$i!==void 0||Ne===t.input||Ne===t.altInput?_e.ctrlKey?(_e.stopPropagation(),se(t.currentYear-qt),T(w(1),0)):Jt||T(void 0,qt*7):Ne===t.currentYearElement?se(t.currentYear-qt):t.config.enableTime&&(!Jt&&t.hourElement&&t.hourElement.focus(),u(_e),t._debouncedChange());break;case 9:if(Jt){let wl=[t.hourElement,t.minuteElement,t.secondElement,t.amPM].concat(t.pluginElements).filter(Wl=>Wl),Tl=wl.indexOf(Ne);if(Tl!==-1){let Wl=wl[Tl+(_e.shiftKey?-1:1)];_e.preventDefault(),(Wl||t._input).focus()}}else!t.config.noCalendar&&t.daysContainer&&t.daysContainer.contains(Ne)&&_e.shiftKey&&(_e.preventDefault(),t._input.focus());break;default:break}}if(t.amPM!==void 0&&Ne===t.amPM)switch(_e.key){case t.l10n.amPM[0].charAt(0):case t.l10n.amPM[0].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[0],d(),Rr();break;case t.l10n.amPM[1].charAt(0):case t.l10n.amPM[1].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[1],d(),Rr();break}(nt||pe(Ne))&&We("onKeyDown",_e)}function ye(_e){if(t.selectedDates.length!==1||_e&&(!_e.classList.contains("flatpickr-day")||_e.classList.contains("flatpickr-disabled")))return;let Ne=_e?_e.dateObj.getTime():t.days.firstElementChild.dateObj.getTime(),nt=t.parseDate(t.selectedDates[0],void 0,!0).getTime(),mt=Math.min(Ne,t.selectedDates[0].getTime()),Ft=Math.max(Ne,t.selectedDates[0].getTime()),_t=!1,Jt=0,qt=0;for(let wl=mt;wl<Ft;wl+=I1.DAY)te(new Date(wl),!0)||(_t=_t||wl>mt&&wl<Ft,wl<nt&&(!Jt||wl>Jt)?Jt=wl:wl>nt&&(!qt||wl<qt)&&(qt=wl));for(let wl=0;wl<t.config.showMonths;wl++){let Tl=t.daysContainer.children[wl];for(let Wl=0,sn=Tl.children.length;Wl<sn;Wl++){let Vr=Tl.children[Wl],zn=Vr.dateObj.getTime(),On=Jt>0&&zn<Jt||qt>0&&zn>qt;if(On){Vr.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(Dr=>{Vr.classList.remove(Dr)});continue}else if(_t&&!On)continue;["startRange","inRange","endRange","notAllowed"].forEach(Dr=>{Vr.classList.remove(Dr)}),_e!==void 0&&(_e.classList.add(Ne<=t.selectedDates[0].getTime()?"startRange":"endRange"),nt<Ne&&zn===nt?Vr.classList.add("startRange"):nt>Ne&&zn===nt&&Vr.classList.add("endRange"),zn>=Jt&&(qt===0||zn<=qt)&&S1(zn,nt,Ne)&&Vr.classList.add("inRange"))}}}function Ye(){t.isOpen&&!t.config.static&&!t.config.inline&&wt()}function Ce(_e,Ne=t._positionElement){if(t.isMobile===!0){if(_e){_e.preventDefault();let mt=Fi(_e);mt&&mt.blur()}t.mobileInput!==void 0&&(t.mobileInput.focus(),t.mobileInput.click()),We("onOpen");return}else if(t._input.disabled||t.config.inline)return;let nt=t.isOpen;t.isOpen=!0,nt||(t.calendarContainer.classList.add("open"),t._input.classList.add("active"),We("onOpen"),wt(Ne)),t.config.enableTime===!0&&t.config.noCalendar===!0&&t.config.allowInput===!1&&(_e===void 0||!t.timeContainer.contains(_e.relatedTarget))&&setTimeout(()=>t.hourElement.select(),50)}function Ke(_e){return Ne=>{let nt=t.config[`_${_e}Date`]=t.parseDate(Ne,t.config.dateFormat),mt=t.config[`_${_e==="min"?"max":"min"}Date`];nt!==void 0&&(t[_e==="min"?"minDateHasTime":"maxDateHasTime"]=nt.getHours()>0||nt.getMinutes()>0||nt.getSeconds()>0),t.selectedDates&&(t.selectedDates=t.selectedDates.filter(Ft=>te(Ft)),!t.selectedDates.length&&_e==="min"&&g(nt),Rr()),t.daysContainer&&(me(),nt!==void 0?t.currentYearElement[_e]=nt.getFullYear().toString():t.currentYearElement.removeAttribute(_e),t.currentYearElement.disabled=!!mt&&nt!==void 0&&mt.getFullYear()===nt.getFullYear())}}function ft(){let _e=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],Ne=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e.dataset||{}))),n),nt={};t.config.parseDate=Ne.parseDate,t.config.formatDate=Ne.formatDate,Object.defineProperty(t.config,"enable",{get:()=>t.config._enable,set:_t=>{t.config._enable=Ve(_t)}}),Object.defineProperty(t.config,"disable",{get:()=>t.config._disable,set:_t=>{t.config._disable=Ve(_t)}});let mt=Ne.mode==="time";if(!Ne.dateFormat&&(Ne.enableTime||mt)){let _t=xn.defaultConfig.dateFormat||es.dateFormat;nt.dateFormat=Ne.noCalendar||mt?"H:i"+(Ne.enableSeconds?":S":""):_t+" H:i"+(Ne.enableSeconds?":S":"")}if(Ne.altInput&&(Ne.enableTime||mt)&&!Ne.altFormat){let _t=xn.defaultConfig.altFormat||es.altFormat;nt.altFormat=Ne.noCalendar||mt?"h:i"+(Ne.enableSeconds?":S K":" K"):_t+` h:i${Ne.enableSeconds?":S":""} K`}Object.defineProperty(t.config,"minDate",{get:()=>t.config._minDate,set:Ke("min")}),Object.defineProperty(t.config,"maxDate",{get:()=>t.config._maxDate,set:Ke("max")});let Ft=_t=>Jt=>{t.config[_t==="min"?"_minTime":"_maxTime"]=t.parseDate(Jt,"H:i:S")};Object.defineProperty(t.config,"minTime",{get:()=>t.config._minTime,set:Ft("min")}),Object.defineProperty(t.config,"maxTime",{get:()=>t.config._maxTime,set:Ft("max")}),Ne.mode==="time"&&(t.config.noCalendar=!0,t.config.enableTime=!0),Object.assign(t.config,nt,Ne);for(let _t=0;_t<_e.length;_t++)t.config[_e[_t]]=t.config[_e[_t]]===!0||t.config[_e[_t]]==="true";Sh.filter(_t=>t.config[_t]!==void 0).forEach(_t=>{t.config[_t]=Rh(t.config[_t]||[]).map(a)}),t.isMobile=!t.config.disableMobile&&!t.config.inline&&t.config.mode==="single"&&!t.config.disable.length&&!t.config.enable&&!t.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(let _t=0;_t<t.config.plugins.length;_t++){let Jt=t.config.plugins[_t](t)||{};for(let qt in Jt)Sh.indexOf(qt)>-1?t.config[qt]=Rh(Jt[qt]).map(a).concat(t.config[qt]):typeof Ne[qt]=="undefined"&&(t.config[qt]=Jt[qt])}Ne.altInputClass||(t.config.altInputClass=et().className+" "+t.config.altInputClass),We("onParseConfig")}function et(){return t.config.wrap?e.querySelector("[data-input]"):e}function vt(){typeof t.config.locale!="object"&&typeof xn.l10ns[t.config.locale]=="undefined"&&t.config.errorHandler(new Error(`flatpickr: invalid locale ${t.config.locale}`)),t.l10n=Object.assign(Object.assign({},xn.l10ns.default),typeof t.config.locale=="object"?t.config.locale:t.config.locale!=="default"?xn.l10ns[t.config.locale]:void 0),Xu.K=`(${t.l10n.amPM[0]}|${t.l10n.amPM[1]}|${t.l10n.amPM[0].toLowerCase()}|${t.l10n.amPM[1].toLowerCase()})`,Object.assign(Object.assign({},n),JSON.parse(JSON.stringify(e.dataset||{}))).time_24hr===void 0&&xn.defaultConfig.time_24hr===void 0&&(t.config.time_24hr=t.l10n.time_24hr),t.formatDate=yg(t),t.parseDate=Fh({config:t.config,l10n:t.l10n})}function wt(_e){if(typeof t.config.position=="function")return void t.config.position(t,_e);if(t.calendarContainer===void 0)return;We("onPreCalendarPosition");let Ne=_e||t._positionElement,nt=Array.prototype.reduce.call(t.calendarContainer.children,(Vn,ii)=>Vn+ii.offsetHeight,0),mt=t.calendarContainer.offsetWidth,Ft=t.config.position.split(" "),_t=Ft[0],Jt=Ft.length>1?Ft[1]:null,qt=Ne.getBoundingClientRect(),wl=window.innerHeight-qt.bottom,Tl=_t==="above"||_t!=="below"&&wl<nt&&qt.top>nt,Wl=window.pageYOffset+qt.top+(Tl?-nt-2:Ne.offsetHeight+2);if(ni(t.calendarContainer,"arrowTop",!Tl),ni(t.calendarContainer,"arrowBottom",Tl),t.config.inline)return;let sn=window.pageXOffset+qt.left,Vr=!1,An=!1;Jt==="center"?(sn-=(mt-qt.width)/2,Vr=!0):Jt==="right"&&(sn-=mt-qt.width,An=!0),ni(t.calendarContainer,"arrowLeft",!Vr&&!An),ni(t.calendarContainer,"arrowCenter",Vr),ni(t.calendarContainer,"arrowRight",An);let zn=window.document.body.offsetWidth-(window.pageXOffset+qt.right),On=sn+mt>window.document.body.offsetWidth,Dr=zn+mt>window.document.body.offsetWidth;if(ni(t.calendarContainer,"rightMost",On),!t.config.static)if(t.calendarContainer.style.top=`${Wl}px`,!On)t.calendarContainer.style.left=`${sn}px`,t.calendarContainer.style.right="auto";else if(!Dr)t.calendarContainer.style.left="auto",t.calendarContainer.style.right=`${zn}px`;else{let Vn=be();if(Vn===void 0)return;let ii=window.document.body.offsetWidth,na=Math.max(0,ii/2-mt/2),di=".flatpickr-calendar.centerMost:before",oi=".flatpickr-calendar.centerMost:after",gn=Vn.cssRules.length,ai=`{left:${qt.left}px;right:auto;}`;ni(t.calendarContainer,"rightMost",!1),ni(t.calendarContainer,"centerMost",!0),Vn.insertRule(`${di},${oi}${ai}`,gn),t.calendarContainer.style.left=`${na}px`,t.calendarContainer.style.right="auto"}}function be(){let _e=null;for(let Ne=0;Ne<document.styleSheets.length;Ne++){let nt=document.styleSheets[Ne];try{nt.cssRules}catch(mt){continue}_e=nt;break}return _e??Q()}function Q(){let _e=document.createElement("style");return document.head.appendChild(_e),_e.sheet}function me(){t.config.noCalendar||t.isMobile||(M(),bl(),A())}function xe(){t._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(t.close,0):t.close()}function Te(_e){_e.preventDefault(),_e.stopPropagation();let Ne=Jt=>Jt.classList&&Jt.classList.contains("flatpickr-day")&&!Jt.classList.contains("flatpickr-disabled")&&!Jt.classList.contains("notAllowed"),nt=gg(Fi(_e),Ne);if(nt===void 0)return;let mt=nt,Ft=t.latestSelectedDateObj=new Date(mt.dateObj.getTime()),_t=(Ft.getMonth()<t.currentMonth||Ft.getMonth()>t.currentMonth+t.config.showMonths-1)&&t.config.mode!=="range";if(t.selectedDateElem=mt,t.config.mode==="single")t.selectedDates=[Ft];else if(t.config.mode==="multiple"){let Jt=St(Ft);Jt?t.selectedDates.splice(parseInt(Jt),1):t.selectedDates.push(Ft)}else t.config.mode==="range"&&(t.selectedDates.length===2&&t.clear(!1,!1),t.latestSelectedDateObj=Ft,t.selectedDates.push(Ft),Mi(Ft,t.selectedDates[0],!0)!==0&&t.selectedDates.sort((Jt,qt)=>Jt.getTime()-qt.getTime()));if(d(),_t){let Jt=t.currentYear!==Ft.getFullYear();t.currentYear=Ft.getFullYear(),t.currentMonth=Ft.getMonth(),Jt&&(We("onYearChange"),M()),We("onMonthChange")}if(bl(),A(),Rr(),!_t&&t.config.mode!=="range"&&t.config.showMonths===1?k(mt):t.selectedDateElem!==void 0&&t.hourElement===void 0&&t.selectedDateElem&&t.selectedDateElem.focus(),t.hourElement!==void 0&&t.hourElement!==void 0&&t.hourElement.focus(),t.config.closeOnSelect){let Jt=t.config.mode==="single"&&!t.config.enableTime,qt=t.config.mode==="range"&&t.selectedDates.length===2&&!t.config.enableTime;(Jt||qt)&&xe()}x()}let je={locale:[vt,X],showMonths:[N,s,U],minDate:[S],maxDate:[S],clickOpens:[()=>{t.config.clickOpens===!0?(p(t._input,"focus",t.open),p(t._input,"click",t.open)):(t._input.removeEventListener("focus",t.open),t._input.removeEventListener("click",t.open))}]};function De(_e,Ne){if(_e!==null&&typeof _e=="object"){Object.assign(t.config,_e);for(let nt in _e)je[nt]!==void 0&&je[nt].forEach(mt=>mt())}else t.config[_e]=Ne,je[_e]!==void 0?je[_e].forEach(nt=>nt()):Sh.indexOf(_e)>-1&&(t.config[_e]=Rh(Ne));t.redraw(),Rr(!0)}function Fe(_e,Ne){let nt=[];if(_e instanceof Array)nt=_e.map(mt=>t.parseDate(mt,Ne));else if(_e instanceof Date||typeof _e=="number")nt=[t.parseDate(_e,Ne)];else if(typeof _e=="string")switch(t.config.mode){case"single":case"time":nt=[t.parseDate(_e,Ne)];break;case"multiple":nt=_e.split(t.config.conjunction).map(mt=>t.parseDate(mt,Ne));break;case"range":nt=_e.split(t.l10n.rangeSeparator).map(mt=>t.parseDate(mt,Ne));break;default:break}else t.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(_e)}`));t.selectedDates=t.config.allowInvalidPreload?nt:nt.filter(mt=>mt instanceof Date&&te(mt,!1)),t.config.mode==="range"&&t.selectedDates.sort((mt,Ft)=>mt.getTime()-Ft.getTime())}function Ze(_e,Ne=!1,nt=t.config.dateFormat){if(_e!==0&&!_e||_e instanceof Array&&_e.length===0)return t.clear(Ne);Fe(_e,nt),t.latestSelectedDateObj=t.selectedDates[t.selectedDates.length-1],t.redraw(),S(void 0,Ne),g(),t.selectedDates.length===0&&t.clear(!1),Rr(Ne),Ne&&We("onChange")}function Ve(_e){return _e.slice().map(Ne=>typeof Ne=="string"||typeof Ne=="number"||Ne instanceof Date?t.parseDate(Ne,void 0,!0):Ne&&typeof Ne=="object"&&Ne.from&&Ne.to?{from:t.parseDate(Ne.from,void 0),to:t.parseDate(Ne.to,void 0)}:Ne).filter(Ne=>Ne)}function Ie(){t.selectedDates=[],t.now=t.parseDate(t.config.now)||new Date;let _e=t.config.defaultDate||((t.input.nodeName==="INPUT"||t.input.nodeName==="TEXTAREA")&&t.input.placeholder&&t.input.value===t.input.placeholder?null:t.input.value);_e&&Fe(_e,t.config.dateFormat),t._initialDate=t.selectedDates.length>0?t.selectedDates[0]:t.config.minDate&&t.config.minDate.getTime()>t.now.getTime()?t.config.minDate:t.config.maxDate&&t.config.maxDate.getTime()<t.now.getTime()?t.config.maxDate:t.now,t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth(),t.selectedDates.length>0&&(t.latestSelectedDateObj=t.selectedDates[0]),t.config.minTime!==void 0&&(t.config.minTime=t.parseDate(t.config.minTime,"H:i")),t.config.maxTime!==void 0&&(t.config.maxTime=t.parseDate(t.config.maxTime,"H:i")),t.minDateHasTime=!!t.config.minDate&&(t.config.minDate.getHours()>0||t.config.minDate.getMinutes()>0||t.config.minDate.getSeconds()>0),t.maxDateHasTime=!!t.config.maxDate&&(t.config.maxDate.getHours()>0||t.config.maxDate.getMinutes()>0||t.config.maxDate.getSeconds()>0)}function ve(){if(t.input=et(),!t.input){t.config.errorHandler(new Error("Invalid input element specified"));return}t.input._type=t.input.type,t.input.type="text",t.input.classList.add("flatpickr-input"),t._input=t.input,t.config.altInput&&(t.altInput=hr(t.input.nodeName,t.config.altInputClass),t._input=t.altInput,t.altInput.placeholder=t.input.placeholder,t.altInput.disabled=t.input.disabled,t.altInput.required=t.input.required,t.altInput.tabIndex=t.input.tabIndex,t.altInput.type="text",t.input.setAttribute("type","hidden"),!t.config.static&&t.input.parentNode&&t.input.parentNode.insertBefore(t.altInput,t.input.nextSibling)),t.config.allowInput||t._input.setAttribute("readonly","readonly"),t._positionElement=t.config.positionElement||t._input}function Ge(){let _e=t.config.enableTime?t.config.noCalendar?"time":"datetime-local":"date";t.mobileInput=hr("input",t.input.className+" flatpickr-mobile"),t.mobileInput.tabIndex=1,t.mobileInput.type=_e,t.mobileInput.disabled=t.input.disabled,t.mobileInput.required=t.input.required,t.mobileInput.placeholder=t.input.placeholder,t.mobileFormatStr=_e==="datetime-local"?"Y-m-d\\TH:i:S":_e==="date"?"Y-m-d":"H:i:S",t.selectedDates.length>0&&(t.mobileInput.defaultValue=t.mobileInput.value=t.formatDate(t.selectedDates[0],t.mobileFormatStr)),t.config.minDate&&(t.mobileInput.min=t.formatDate(t.config.minDate,"Y-m-d")),t.config.maxDate&&(t.mobileInput.max=t.formatDate(t.config.maxDate,"Y-m-d")),t.input.getAttribute("step")&&(t.mobileInput.step=String(t.input.getAttribute("step"))),t.input.type="hidden",t.altInput!==void 0&&(t.altInput.type="hidden");try{t.input.parentNode&&t.input.parentNode.insertBefore(t.mobileInput,t.input.nextSibling)}catch(Ne){}p(t.mobileInput,"change",Ne=>{t.setDate(Fi(Ne).value,!1,t.mobileFormatStr),We("onChange"),We("onClose")})}function Ue(_e){if(t.isOpen===!0)return t.close();t.open(_e)}function We(_e,Ne){if(t.config===void 0)return;let nt=t.config[_e];if(nt!==void 0&&nt.length>0)for(let mt=0;nt[mt]&&mt<nt.length;mt++)nt[mt](t.selectedDates,t.input.value,t,Ne);_e==="onChange"&&(t.input.dispatchEvent(it("change")),t.input.dispatchEvent(it("input")))}function it(_e){let Ne=document.createEvent("Event");return Ne.initEvent(_e,!0,!0),Ne}function St(_e){for(let Ne=0;Ne<t.selectedDates.length;Ne++)if(Mi(t.selectedDates[Ne],_e)===0)return""+Ne;return!1}function Kt(_e){return t.config.mode!=="range"||t.selectedDates.length<2?!1:Mi(_e,t.selectedDates[0])>=0&&Mi(_e,t.selectedDates[1])<=0}function bl(){t.config.noCalendar||t.isMobile||!t.monthNav||(t.yearElements.forEach((_e,Ne)=>{let nt=new Date(t.currentYear,t.currentMonth,1);nt.setMonth(t.currentMonth+Ne),t.config.showMonths>1||t.config.monthSelectorType==="static"?t.monthElements[Ne].textContent=qu(nt.getMonth(),t.config.shorthandCurrentMonth,t.l10n)+" ":t.monthsDropdownContainer.value=nt.getMonth().toString(),_e.value=nt.getFullYear().toString()}),t._hidePrevMonthArrow=t.config.minDate!==void 0&&(t.currentYear===t.config.minDate.getFullYear()?t.currentMonth<=t.config.minDate.getMonth():t.currentYear<t.config.minDate.getFullYear()),t._hideNextMonthArrow=t.config.maxDate!==void 0&&(t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth+1>t.config.maxDate.getMonth():t.currentYear>t.config.maxDate.getFullYear()))}function hl(_e){return t.selectedDates.map(Ne=>t.formatDate(Ne,_e)).filter((Ne,nt,mt)=>t.config.mode!=="range"||t.config.enableTime||mt.indexOf(Ne)===nt).join(t.config.mode!=="range"?t.config.conjunction:t.l10n.rangeSeparator)}function Rr(_e=!0){t.mobileInput!==void 0&&t.mobileFormatStr&&(t.mobileInput.value=t.latestSelectedDateObj!==void 0?t.formatDate(t.latestSelectedDateObj,t.mobileFormatStr):""),t.input.value=hl(t.config.dateFormat),t.altInput!==void 0&&(t.altInput.value=hl(t.config.altFormat)),_e!==!1&&We("onValueUpdate")}function Di(_e){let Ne=Fi(_e),nt=t.prevMonthNav.contains(Ne),mt=t.nextMonthNav.contains(Ne);nt||mt?he(nt?-1:1):t.yearElements.indexOf(Ne)>=0?Ne.select():Ne.classList.contains("arrowUp")?t.changeYear(t.currentYear+1):Ne.classList.contains("arrowDown")&&t.changeYear(t.currentYear-1)}function ln(_e){_e.preventDefault();let Ne=_e.type==="keydown",nt=Fi(_e),mt=nt;t.amPM!==void 0&&nt===t.amPM&&(t.amPM.textContent=t.l10n.amPM[Ri(t.amPM.textContent===t.l10n.amPM[0])]);let Ft=parseFloat(mt.getAttribute("min")),_t=parseFloat(mt.getAttribute("max")),Jt=parseFloat(mt.getAttribute("step")),qt=parseInt(mt.value,10),wl=_e.delta||(Ne?_e.which===38?1:-1:0),Tl=qt+Jt*wl;if(typeof mt.value!="undefined"&&mt.value.length===2){let Wl=mt===t.hourElement,sn=mt===t.minuteElement;Tl<Ft?(Tl=_t+Tl+Ri(!Wl)+(Ri(Wl)&&Ri(!t.amPM)),sn&&O(void 0,-1,t.hourElement)):Tl>_t&&(Tl=mt===t.hourElement?Tl-_t-Ri(!t.amPM):Ft,sn&&O(void 0,1,t.hourElement)),t.amPM&&Wl&&(Jt===1?Tl+qt===23:Math.abs(Tl-qt)>Jt)&&(t.amPM.textContent=t.l10n.amPM[Ri(t.amPM.textContent===t.l10n.amPM[0])]),mt.value=ri(Tl)}}return o(),t}function Hc(e,n){let t=Array.prototype.slice.call(e).filter(o=>o instanceof HTMLElement),l=[];for(let o=0;o<t.length;o++){let a=t[o];try{if(a.getAttribute("data-fp-omit")!==null)continue;a._flatpickr!==void 0&&(a._flatpickr.destroy(),a._flatpickr=void 0),a._flatpickr=b3(a,n||{}),l.push(a._flatpickr)}catch(s){console.error(s)}}return l.length===1?l[0]:l}var import_plugin,k3,xn,Dh,kg=Tt(()=>{import_plugin=Le(Be());fg();hg();mg();C1();T1();vg();R1();k3=300;typeof HTMLElement!="undefined"&&typeof HTMLCollection!="undefined"&&typeof NodeList!="undefined"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return Hc(this,e)},HTMLElement.prototype.flatpickr=function(e){return Hc([this],e)});xn=function(e,n){return typeof e=="string"?Hc(window.document.querySelectorAll(e),n):e instanceof Node?Hc([e],n):Hc(e,n)};xn.defaultConfig={};xn.l10ns={en:Object.assign({},Th),default:Object.assign({},Th)};xn.localize=e=>{xn.l10ns.default=Object.assign(Object.assign({},xn.l10ns.default),e)};xn.setDefaults=e=>{xn.defaultConfig=Object.assign(Object.assign({},xn.defaultConfig),e)};xn.parseDate=Fh({});xn.formatDate=yg({});xn.compareDates=Mi;typeof jQuery!="undefined"&&typeof jQuery.fn!="undefined"&&(jQuery.fn.flatpickr=function(e){return Hc(this,e)});Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof e=="string"?parseInt(e,10):e))};typeof window!="undefined"&&(window.flatpickr=xn);Dh=xn});var import_plugin,Ah,w3,x3,F1,M1=Tt(()=>{import_plugin=Le(Be());Mr();ir();Ut();kg();Ah=Le(ka());Hn();Es();w3=e=>{let n=e.replace(/y/g,"Y");return n=n.replace(/d/g,"D"),n=n.replace(/h/g,"H"),n=n.replace(/\//g,"A"),n=n.replace(//g,"A"),n=n.replace(//g,"A"),n=n.replace(/AM\/PM/g,"A"),n=n.replace(/AM/g,"A"),n=n.replace(/PM/g,"A"),n=n.replace(/\"/g,""),n.includes("A")&&(n=n.replace(/H/g,"h")),n},x3={cellFocus:function(e,n,t){let l=h.visibledatarow[e],o=e==0?0:h.visibledatarow[e-1],a=h.visibledatacolumn[n],s=n==0?0:h.visibledatacolumn[n-1],u=ht.mergeborer(h.flowdata,e,n),f=t.ct.fa||"YYYY-MM-DD",m=$l("yyyy-MM-dd hh:mm:ss",t.v),d=w3(f),g=!1,b=!1,y=!1,p=!0,x=!1;u&&(l=u.row[1],o=u.row[0],a=u.column[1],s=u.column[0]),$(".cell-date-picker").show().css({width:a-s+1,height:l-o+1,left:s,top:o}),/[]/.test(f)&&(x=!0),/[Hhms]/.test(d)&&(g=!0),/[YMD]/.test(d)||(b=!0),/s/.test(d)&&(y=!0),/A/.test(d)&&(p=!1);let _=Dh("#luckysheet-input-box",{allowInput:!1,noCalendar:b,enableSeconds:y,enableTime:g,dateFormat:d,time_24hr:p,defaultDate:m,onClose(){setTimeout(()=>{_.destroy()},0)},parseDate:(S,I)=>(0,Ah.default)(S).toDate(),formatDate:(S,I,O)=>x?(0,Ah.default)(S).format(I).replace("AM","\u4E0A\u5348").replace("PM","\u4E0B\u5348"):(0,Ah.default)(S).format(I),onChange:function(S,I){let O=Fm(new Date(S));$("#luckysheet-rich-text-editor").html(I),Bc(e,n,O,{isRefresh:!1}),bg(e,n,"ct",t.ct),g||v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1])}});$("#luckysheet-input-box").click()}},F1=x3});function Dn(e,n,t,l,o){if(!xa(e,n,h.currentSheetIndex)){$("#luckysheet-functionbox-cell").blur();return}if(Qe()||h.allowEdit===!1||!Yt.createHookFunction("cellEditBefore",h.luckysheet_select_save))return;if(He.saveParam("mv",h.currentSheetIndex,{op:"enterEdit",range:h.luckysheet_select_save}),Vt.dataVerification!=null&&Vt.dataVerification[e+"_"+n]!=null){let z=Vt.dataVerification[e+"_"+n];if(z.type=="dropdown")Vt.dropdownListShow();else if(z.type=="checkbox")return}let a=A1(e,n,t),s=a.row,u=a.row_pre,f=a.col,m=a.col_pre,d=a.row_index,g=a.col_index;$("#luckysheet-dropCell-icon").is(":visible")&&$("#luckysheet-dropCell-icon").remove();let b=$(window).height(),y=$(window).width(),p=$("#"+h.container).offset(),x=$("#luckysheet-cell-main").scrollLeft(),_=$("#luckysheet-cell-main").scrollTop();if(Pt.isPivotRange(d,g))return;let S=m+p.left+h.rowHeaderWidth-x-2;we.freezenverticaldata!=null&&n<=we.freezenverticaldata[1]&&(S=m+p.left+h.rowHeaderWidth-2);let I=u+p.top+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight-_-2;we.freezenhorizontaldata!=null&&e<=we.freezenhorizontaldata[1]&&(I=u+p.top+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight-2);let O={"min-width":f-m+1-8,"min-height":s-u+1-4,"max-width":y+x-m-20-h.rowHeaderWidth,"max-height":b+_-u-20-15-h.toolbarHeight-h.infobarHeight-h.calculatebarHeight-h.sheetBarHeight-h.statisticBarHeight,left:S,top:I},F={transform:"scale("+h.zoomRatio+")","transform-origin":"left top",width:100/h.zoomRatio+"%",height:100/h.zoomRatio+"%"};h.luckysheetCellUpdate=[d,g],o||$("#luckysheet-rich-text-editor").focus().select(),$("#luckysheet-input-box").removeAttr("style").css({"background-color":"rgb(255, 255, 255)",padding:"0px 2px","font-size":"13px",right:"auto","overflow-y":"auto","box-sizing":"initial",display:"flex"}),(we.freezenverticaldata!=null||we.freezenhorizontaldata!=null)&&$("#luckysheet-input-box").css("z-index",10002),$("#luckysheet-input-box-index").html(Qt(g)+(d+1)).hide(),$("#luckysheet-wa-functionbox-cancel, #luckysheet-wa-functionbox-confirm").addClass("luckysheet-wa-calculate-active");let D="",k=!1;if(t[d]!=null&&t[d][g]!=null){let z=t[d][g],A=z.ht,M="left",P="top";A=="0"?(O={"min-width":f-m+1-8,"min-height":s-u+1-4,"max-width":y*2/3,"max-height":b+_-u-20-15-h.toolbarHeight-h.infobarHeight-h.calculatebarHeight-h.sheetBarHeight-h.statisticBarHeight,left:m+p.left+h.rowHeaderWidth-x-2,top:u+p.top+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight-_-2},h.zoomRatio<1&&(M="center"),k=!0):A=="2"&&(O={"min-width":f-m+1-8,"min-height":s-u+1-4,"max-width":f+p.left-x-8,"max-height":b+_-u-20-15-h.toolbarHeight-h.infobarHeight-h.calculatebarHeight-h.sheetBarHeight-h.statisticBarHeight,right:y-(p.left+(h.rowHeaderWidth-1)-x)-f,top:u+p.top+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight-_-2},h.zoomRatio<1&&(M="right")),z.vt=="0"?P="center":z.vt=="2"&&(P="bottom"),F["transform-origin"]=M+" "+P,l||(wn(z)?D=Iy(d,g,t):z.f!=null?D=Mt(d,g,t,"f"):(D=ba(d,g,t),z.qp=="1"&&(D=D&&""+D)));let N=ht.getStyleByCell(t,d,g);N=$("#luckysheet-input-box").get(0).style.cssText+N,$("#luckysheet-input-box").get(0).style.cssText=N,$("#luckysheet-input-box").get(0).style.backgroundColor=="rgba(0, 0, 0, 0)"&&($("#luckysheet-input-box").get(0).style.background="rgb(255,255,255)")}else{let z=xr.getComputeMap();var w=xr.checksAF(d,g,z),C=xt.getComputeMap(),T=xt.checksCF(d,g,C);T!=null&&T.cellColor!=null?$("#luckysheet-input-box").get(0).style.background=T.cellColor:w!=null&&($("#luckysheet-input-box").get(0).style.background=w[1])}if(O["min-height"]>O["max-height"]&&(O["min-height"]=O["max-height"]),O["min-width"]>O["max-width"]&&(O["min-width"]=O["max-width"]),D=v.xssDeal(D),!gh(d,g,h.currentSheetIndex)&&D.length>0&&D.substr(0,63)=='<span dir="auto" class="luckysheet-formula-text-color">=</span>'?$("#luckysheet-rich-text-editor").html(""):(D=v.ltGtSignDeal(D),$("#luckysheet-rich-text-editor").html(D),o||to($("#luckysheet-rich-text-editor")[0])),k){let z=$("#luckysheet-input-box").width();z>O["max-width"]&&(z=O["max-width"]),z<O["min-width"]&&(z=O["min-width"]);let A=O.left-z/2+(f-m)/2;A<2&&(A=2),O.left=A-2}$("#luckysheet-input-box").css(O),$("#luckysheet-rich-text-editor").css(F),t[e][n]&&t[e][n].ct&&t[e][n].ct.t=="d"&&F1.cellFocus(e,n,t[e][n]),v.rangetosheet=h.currentSheetIndex,v.createRangeHightlight(),v.rangeResizeTo=$("#luckysheet-rich-text-editor"),Ir()}function D1(e,n,t){if(e==null||n==null)return;let l=t[e][n];if(l==null)return;let o=l.ht;if(l!=null&&o!="0")return;let a=A1(e,n,t),s=a.row,u=a.row_pre,f=a.col,m=a.col_pre,d=$(window).height(),g=$(window).width(),b=$("#"+h.container).offset(),y=$("#luckysheet-cell-main").scrollLeft(),p=$("#luckysheet-cell-main").scrollTop(),x={"min-width":f-m+1-8,"max-width":g*2/3,left:m+b.left+h.rowHeaderWidth-y-2},_=$("#luckysheet-input-box").width();_>x["max-width"]&&(_=x["max-width"]),_<x["min-width"]&&(_=x["min-width"]);let S=x.left-_/2+(f-m)/2;S<2&&(S=2),x.left=S-2,$("#luckysheet-input-box").css(x)}function A1(e,n,t){let l=h.visibledatarow[e],o=e-1==-1?0:h.visibledatarow[e-1],a=h.visibledatacolumn[n],s=n-1==-1?0:h.visibledatacolumn[n-1];t==null&&(t=h.flowdata);let u=ht.mergeborer(t,e,n);return u&&(l=u.row[1],o=u.row[0],e=u.row[2],a=u.column[1],s=u.column[0],n=u.column[2]),{row:l,row_pre:o,row_index:e,col:a,col_pre:s,col_index:n}}var import_plugin,Ns=Tt(()=>{import_plugin=Le(Be());Qo();li();Mr();ji();$c();M1();Vi();jn();gl();Gl();mr();Hn();ir();pa();Io();va();Ut();wr();qn()});var Rg={};pw(Rg,{cancelFrozen:()=>Ph,cancelRangeMerge:()=>L1,changLang:()=>X5,checkTheStatusOfTheSelectedCells:()=>jc,clearCell:()=>C3,clearRange:()=>h5,closeWebsocket:()=>Z5,deleteCell:()=>$3,deleteColumn:()=>E3,deleteDataVerification:()=>V5,deleteImage:()=>U5,deleteRange:()=>d5,deleteRangeConditionalFormat:()=>f5,deleteRow:()=>P3,deleteRowOrColumn:()=>_g,enterEditMode:()=>T3,exitEditMode:()=>I3,find:()=>z1,frozenColumnRange:()=>P1,frozenFirstColumn:()=>Oh,frozenFirstRow:()=>zh,frozenRowRange:()=>O1,getAllSheets:()=>H1,getCellValue:()=>_3,getColumnWidth:()=>U3,getConfig:()=>L5,getDefaultColWidth:()=>Y3,getDefaultRowHeight:()=>G3,getImageOption:()=>G5,getLuckysheetfile:()=>B5,getRange:()=>E1,getRangeArray:()=>J3,getRangeAxis:()=>X3,getRangeBoolean:()=>t5,getRangeByTxt:()=>K5,getRangeDiagonal:()=>e5,getRangeHtml:()=>K3,getRangeJson:()=>Q3,getRangeValue:()=>Z3,getRangeValuesWithFlatte:()=>q3,getRangeWithFlatten:()=>Sg,getRowHeight:()=>W3,getScreenshot:()=>D5,getSheet:()=>E5,getSheetData:()=>N5,getTxtByRange:()=>J5,getWorkbookName:()=>z5,hideColumn:()=>H3,hideGridLines:()=>T5,hideRow:()=>N3,hideRowOrColumn:()=>Cg,insertColumn:()=>z3,insertColumnRight:()=>O3,insertImage:()=>W5,insertRow:()=>D3,insertRowBottom:()=>A3,insertRowBottomOrColumnRight:()=>xg,insertRowOrColumn:()=>wg,matrixCalculation:()=>g5,matrixOperation:()=>m5,pagerInit:()=>Ig,redo:()=>P5,refresh:()=>R5,refreshFormula:()=>Q5,refreshMenuButtonFocus:()=>Tg,replace:()=>S3,resize:()=>M5,scroll:()=>F5,setBothFrozen:()=>M3,setCellFormat:()=>bg,setCellValue:()=>Bc,setColumnWidth:()=>V3,setConfig:()=>H5,setDataVerification:()=>j5,setHorizontalFrozen:()=>R3,setRangeConditionalFormat:()=>u5,setRangeConditionalFormatDefault:()=>c5,setRangeFilter:()=>i5,setRangeFormat:()=>n5,setRangeMerge:()=>o5,setRangeShow:()=>l5,setRangeSort:()=>a5,setRangeSortMulti:()=>s5,setRangeValue:()=>r5,setRowHeight:()=>j3,setSheetActive:()=>w5,setSheetAdd:()=>p5,setSheetColor:()=>_5,setSheetCopy:()=>y5,setSheetDelete:()=>v5,setSheetHide:()=>k5,setSheetMove:()=>C5,setSheetName:()=>x5,setSheetOrder:()=>$5,setSheetShow:()=>b5,setSheetZoom:()=>S5,setSingleRangeFormat:()=>N1,setVerticalFrozen:()=>F3,setWorkbookName:()=>A5,showColumn:()=>B3,showGridLines:()=>I5,showRow:()=>L3,showRowOrColumn:()=>$g,toJson:()=>Eh,transToCellData:()=>Y5,transToData:()=>q5,undo:()=>O5,updataSheet:()=>e_});function _3(e,n,t={}){if(!Y(e)||!Y(n))return de.info("Arguments row or column cannot be null or undefined.","");let l=$e(h.currentSheetIndex),{type:o="v",order:a=l}={...t},u=h.luckysheetfile[a].data[e][n],f;if(V(u)=="object"){if(f=u[o],o=="f"&&f!=null)f=v.functionHTMLGenerate(f);else if(o=="f")f=u.v;else if(u&&u.ct){if(u.ct.fa=="yyyy-MM-dd")f=u.m;else if(u.ct.hasOwnProperty("t")&&u.ct.t==="inlineStr"){let m=u.ct.s;m&&(f=m.map(d=>d.v).join(""))}}}return f==null&&(f=null),f}function Bc(e,n,t,l={}){let o=h.flowdata[e][n],a=JSON.stringify(o);if(!Y(e)||!Y(n))return de.info("The row or column parameter is invalid.","");let{order:s=$e(h.currentSheetIndex),isRefresh:u=!0,success:f}={...l},m=h.luckysheetfile[s];if(m==null)return de.info("The order parameter is invalid.","");if(!Yt.createHookFunction("cellUpdateBefore",e,n,t,u))return;let d=m.data;u&&(d=$.extend(!0,[],m.data)),d.length==0&&(d=ct.buildGridData(m));let g={bg:1,ff:1,fc:1,bl:1,it:1,fs:1,cl:1,un:1,vt:1,ht:1,mc:1,tr:1,tb:1,rt:1,qp:1};if(t==null||t.toString().length==0)v.delFunctionGroup(e,n),er(e,n,d,t);else if(t instanceof Object){let b={};rt(d[e][n])&&(d[e][n]={});let y=d[e][n];t.f!=null&&t.v==null?(b.f=t.f,t.ct!=null&&(b.ct=t.ct),d=v.updatecell(e,n,b,!1).data):(t.ct!=null&&(b.ct=t.ct),t.f!=null&&(b.f=t.f),t.v!=null?b.v=t.v:b.v=y.v,t.m!=null&&(b.m=t.m),v.delFunctionGroup(e,n),er(e,n,d,b));for(let p in t){let x=t[p];p in g?ht.updateFormatCell(d,p,x,e,e,n,n):y[p]=x}d[e][n]=y}else t.toString().substr(0,1)=="="||t.toString().substr(0,5)=="<span"?d=v.updatecell(e,n,t,!1).data:(v.delFunctionGroup(e,n),er(e,n,d,t));setTimeout(()=>{Yt.createHookFunction("cellUpdated",e,n,JSON.parse(a),h.flowdata[e][n],u)},0),m.index==h.currentSheetIndex&&u?Gt(d,[{row:[e,e],column:[n,n]}]):m.data=d,f&&typeof f=="function"&&f(d)}function C3(e,n,t={}){if(!Y(e)||!Y(n))return de.info("Arguments row and column cannot be null or undefined.","");let l=$e(h.currentSheetIndex),{order:o=l,success:a}={...t},s=$.extend(!0,[],h.luckysheetfile[o].data),u=s[e][n];V(u)=="object"?(delete u.m,delete u.v,u.f!=null&&(delete u.f,v.delFunctionGroup(e,n,o),delete u.spl)):u=null,o===l?Gt(s,[{row:[e,e],column:[n,n]}]):h.luckysheetfile[o].data=s,a&&typeof a=="function"&&a(u)}function $3(e,n,t,l={}){if(!e||["left","up"].indexOf(e)<0)return de.info("Arguments move cannot be null or undefined and its value must be 'left' or 'up'","");if(!Y(n)||!Y(t))return de.info("Arguments row and column cannot be null or undefined.","");let a=$e(h.currentSheetIndex),{order:s=a,success:u}={...l},f="move"+e.replace(e[0],e[0].toUpperCase()),m;s&&h.luckysheetfile[s]&&(m=h.luckysheetfile[s].index),Fs(f,n,n,t,t,m),u&&typeof u=="function"&&u()}function bg(e,n,t,l,o={}){if(!Y(e)||!Y(n))return de.info("Arguments row or column cannot be null or undefined.","");if(!t)return de.info("Arguments attr cannot be null or undefined.","");let a=$e(h.currentSheetIndex),{order:s=a,success:u}={...o},f=h.luckysheetfile[s];if(f==null)return de.info("The order parameter is invalid.","");let m=$.extend(!0,[],f.data);m.length==0&&(m=ct.buildGridData(f));let d=m[e][n]||{},g=$.extend(!0,{},f.config);if(t=="ct"&&(!l||!l.hasOwnProperty("fa")||!l.hasOwnProperty("t")))return new TypeError("While set attribute 'ct' to cell, the value must have property 'fa' and 't'");if(t=="bd"){g.borderInfo==null&&(g.borderInfo=[]);let b={rangeType:"range",borderType:"border-all",color:"#000",style:"1",range:[{column:[n,n],row:[e,e]}],...l};g.borderInfo.push(b)}else d[t]=l;m[e][n]=d,f.index==h.currentSheetIndex?(f.config=g,h.config=g,Gt(m,[{row:[e,e],column:[n,n]}])):(f.config=g,f.data=m),u&&typeof u=="function"&&u(d)}function z1(e,n={}){if(!e&&e!=0)return de.info("Search content cannot be null or empty","");let t=$e(h.currentSheetIndex),{isRegularExpression:l=!1,isWholeWord:o=!1,isCaseSensitive:a=!1,order:s=t,type:u="m"}={...n},f=h.luckysheetfile[s].data,m=[];for(let d=0;d<f.length;d++){let g=f[d];for(let b=0;b<g.length;b++){let y=g[b];if(!!y)if(y.row=d,y.column=b,o)a?e.toString()==y[u]&&m.push(y):y[u]&&e.toString().toLowerCase()==y[u].toLowerCase()&&m.push(y);else if(l){let p;a?p=new RegExp(j.getRegExpStr(e),"g"):p=new RegExp(j.getRegExpStr(e),"ig"),p.test(y[u])&&m.push(y)}else a?new RegExp(j.getRegExpStr(e),"g").test(y[u])&&m.push(y):new RegExp(j.getRegExpStr(e),"ig").test(y[u])&&m.push(y)}}return m}function S3(e,n,t={}){let l=z1(e,t),o=$e(h.currentSheetIndex),{order:a=o}={...t},s=h.luckysheetfile[a];if(s==null)return de.info("The order parameter is invalid.","");let u=$.extend(!0,[],s.data);l.forEach(m=>{m.m=n,Bc(m.row,m.column,n,{order:a,isRefresh:!1})});let f=$.extend(!0,[],s.data);return s.data.length=0,s.data.push(...u),s.index==h.currentSheetIndex&&Gt(f,void 0,void 0,!0,!1),Et(),t.success&&typeof t.success=="function"&&t.success(l),l}function I3(e={}){parseInt($("#luckysheet-input-box").css("top"))>0&&($("#luckysheet-formula-search-c").is(":visible")&&v.searchFunctionCell!=null?v.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_select_save=[{row:[h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[0]],column:[h.luckysheetCellUpdate[1],h.luckysheetCellUpdate[1]],row_focus:h.luckysheetCellUpdate[0],column_focus:h.luckysheetCellUpdate[1]}]),$("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide()),e.success&&typeof e.success=="function"&&e.success()}function T3(e={}){if(!$("#luckysheet-conditionformat-dialog").is(":visible")){if($("#luckysheet-cell-selected").is(":visible")){let n=h.luckysheet_select_save[h.luckysheet_select_save.length-1],t=n.row_focus,l=n.column_focus;Dn(t,l,h.flowdata)}e.success&&typeof e.success=="function"&&e.success()}}function zh(e){if(we.saveFrozen("freezenRow",e),!e||e==$e(h.currentSheetIndex)){let n,t,l;if(we.freezenRealFirstRowColumn){let o=0;l=h.visibledatarow[o]-2+h.columnHeaderHeight,n=[h.visibledatarow[o],o+1,0,we.cutVolumn(h.visibledatarow,o+1),l]}else{let o=$("#luckysheet-cell-main").scrollTop();t=al(h.visibledatarow,o),t==-1&&(t=0),l=h.visibledatarow[t]-2-o+h.columnHeaderHeight,n=[h.visibledatarow[t],t+1,o,we.cutVolumn(h.visibledatarow,t+1),l]}we.saveFreezen(n,l,null,null),we.freezenverticaldata!=null&&(we.cancelFreezenVertical(),we.createAssistCanvas(),Et()),we.createFreezenHorizontal(n,l),we.createAssistCanvas(),Et()}}function Oh(e){if(we.saveFrozen("freezenColumn",e),!e||e==$e(h.currentSheetIndex)){let n,t,l;if(we.freezenRealFirstRowColumn)t=0,l=h.visibledatacolumn[t]-2+h.rowHeaderWidth,n=[h.visibledatacolumn[t],t+1,0,we.cutVolumn(h.visibledatacolumn,t+1),l];else{let o=$("#luckysheet-cell-main").scrollLeft();t=al(h.visibledatacolumn,o),t==-1&&(t=0),l=h.visibledatacolumn[t]-2-o+h.rowHeaderWidth,n=[h.visibledatacolumn[t],t+1,o,we.cutVolumn(h.visibledatacolumn,t+1),l]}we.saveFreezen(null,null,n,l),we.freezenhorizontaldata!=null&&(we.cancelFreezenHorizontal(),we.createAssistCanvas(),Et()),we.createFreezenVertical(n,l),we.createAssistCanvas(),Et()}}function O1(e,n){let t=Oe().freezen;if(!e||!e.hasOwnProperty("row_focus")&&!v.iscelldata(e)){Qe()?alert(t.noSeletionError):de.info(t.noSeletionError,"");return}if(typeof e=="string"&&v.iscelldata(e)&&(e=v.getcellrange(e),e={row_focus:e.row[0],column_focus:e.column[0]}),we.saveFrozen("freezenRowRange",n,e),!n||n==$e(h.currentSheetIndex)){let l=$("#luckysheet-cell-main").scrollTop(),o=al(h.visibledatarow,l),a=e.row_focus;a>o&&(o=a),o==-1&&(o=0);let s=h.visibledatarow[o]-2-l+h.columnHeaderHeight,u=[h.visibledatarow[o],o+1,l,we.cutVolumn(h.visibledatarow,o+1),s];we.saveFreezen(u,s,null,null),we.freezenverticaldata!=null&&(we.cancelFreezenVertical(),we.createAssistCanvas(),Et()),we.createFreezenHorizontal(u,s),we.createAssistCanvas(),Et()}}function P1(e,n){let t=Oe().freezen,l=typeof e=="string"&&v.iscelldata(e);if(!e||!e.hasOwnProperty("column_focus")&&!l){Qe()?alert(t.noSeletionError):de.info(t.noSeletionError,"");return}if(l&&(e=v.getcellrange(e),e={row_focus:e.row[0],column_focus:e.column[0]}),we.saveFrozen("freezenColumnRange",n,e),!n||n==$e(h.currentSheetIndex)){let o=$("#luckysheet-cell-main").scrollLeft(),a=al(h.visibledatacolumn,o),s=e.column_focus;s>a&&(a=s),a==-1&&(a=0);let u=h.visibledatacolumn[a]-2-o+h.rowHeaderWidth,f=[h.visibledatacolumn[a],a+1,o,we.cutVolumn(h.visibledatacolumn,a+1),u];we.saveFreezen(null,null,f,u),we.freezenhorizontaldata!=null&&(we.cancelFreezenHorizontal(),we.createAssistCanvas(),Et()),we.createFreezenVertical(f,u),we.createAssistCanvas(),Et()}}function Ph(e){we.saveFrozen("freezenCancel",e),(!e||e==$e(h.currentSheetIndex))&&(we.freezenverticaldata!=null&&we.cancelFreezenVertical(),we.freezenhorizontaldata!=null&&we.cancelFreezenHorizontal(),we.createAssistCanvas(),Et())}function R3(e,n={}){let t=$e(h.currentSheetIndex),{range:l,order:o=t,success:a}={...n};Ph(o),e?O1(l,o):zh(o),a&&typeof a=="function"&&a()}function F3(e,n={}){let t=$e(h.currentSheetIndex),{range:l,order:o=t,success:a}={...n};Ph(o),e?P1(l,o):Oh(o),a&&typeof a=="function"&&a()}function M3(e,n={}){let t=$e(h.currentSheetIndex),{range:l,order:o=t,success:a}={...n},s=!o||o==$e(h.currentSheetIndex),u=Oe().freezen;if(Ph(o),e){we.saveFrozen("freezenRCRange",o,l);let f=typeof l=="string"&&v.iscelldata(l);if(s){if((!l||!(l.hasOwnProperty("column_focus")&&l.hasOwnProperty("row_focus")))&&!f){Qe()?alert(u.noSeletionError):de.info(u.noSeletionError,"");return}f&&(l=v.getcellrange(l),l={row_focus:l.row[0],column_focus:l.column[0]});let m=$("#luckysheet-cell-main").scrollTop(),d=al(h.visibledatarow,m),g=l.row_focus;g>d&&(d=g),d==-1&&(d=0);let b=h.visibledatarow[d]-2-m+h.columnHeaderHeight,y=[h.visibledatarow[d],d+1,m,we.cutVolumn(h.visibledatarow,d+1),b];we.saveFreezen(y,b,null,null),we.createFreezenHorizontal(y,b);let p=$("#luckysheet-cell-main").scrollLeft(),x=al(h.visibledatacolumn,p),_=l.column_focus;_>x&&(x=_),x==-1&&(x=0);let S=h.visibledatacolumn[x]-2-p+h.rowHeaderWidth,I=[h.visibledatacolumn[x],x+1,p,we.cutVolumn(h.visibledatacolumn,x+1),S];we.saveFreezen(null,null,I,S),we.createFreezenVertical(I,S),we.createAssistCanvas(),Et()}}else if(we.saveFrozen("freezenRC",o),s){let f=$("#luckysheet-cell-main").scrollTop(),m=al(h.visibledatarow,f);m==-1&&(m=0);let d=h.visibledatarow[m]-2-f+h.columnHeaderHeight,g=[h.visibledatarow[m],m+1,f,we.cutVolumn(h.visibledatarow,m+1),d];we.saveFreezen(g,d,null,null),we.createFreezenHorizontal(g,d);let b=$("#luckysheet-cell-main").scrollLeft(),y=al(h.visibledatacolumn,b);y==-1&&(y=0);let p=h.visibledatacolumn[y]-2-b+h.rowHeaderWidth,x=[h.visibledatacolumn[y],y+1,b,we.cutVolumn(h.visibledatacolumn,y+1),p];we.saveFreezen(null,null,x,p),we.createFreezenVertical(x,p),we.createAssistCanvas(),Et()}}function wg(e,n=0,t={}){if(!Y(n))return de.info("The index parameter is invalid.","");let l=$e(h.currentSheetIndex),{number:o=1,order:a=l,success:s}={...t},f=Oe().info;if(!Y(o)){Qe()?alert(f.tipInputNumber):de.info(f.tipInputNumber,"");return}if(o=parseInt(o),o<1||o>100){Qe()?alert(f.tipInputNumberLimit):de.info(f.tipInputNumberLimit,"");return}let m;a&&h.luckysheetfile[a]&&(m=h.luckysheetfile[a].index),oo(e,n,o,"lefttop",m),s&&typeof s=="function"&&s()}function xg(e,n=0,t={}){if(!Y(n))return de.info("The index parameter is invalid.","");let l=$e(h.currentSheetIndex),{number:o=1,order:a=l,success:s}={...t},f=Oe().info;if(!Y(o)){Qe()?alert(f.tipInputNumber):de.info(f.tipInputNumber,"");return}if(o=parseInt(o),o<1||o>100){Qe()?alert(f.tipInputNumberLimit):de.info(f.tipInputNumberLimit,"");return}let m;a&&h.luckysheetfile[a]&&(m=h.luckysheetfile[a].index),oo(e,n,o,"rightbottom",m),s&&typeof s=="function"&&s()}function D3(e=0,n={}){wg("row",e,n)}function A3(e=0,n={}){xg("row",e,n)}function z3(e=0,n={}){wg("column",e,n)}function O3(e=0,n={}){xg("column",e,n)}function _g(e,n,t,l={}){if(!Y(n)||!Y(t))return de.info("Please enter the index for deleting rows or columns correctly.","");let o=$e(h.currentSheetIndex),{order:a=o,success:s}={...l},u;a&&h.luckysheetfile[a]&&(u=h.luckysheetfile[a].index),Za(e,n,t,u),s&&typeof s=="function"&&s()}function P3(e,n,t={}){_g("row",e,n,t)}function E3(e,n,t={}){_g("column",e,n,t)}function Cg(e,n,t,l={}){if(!Y(n)||!Y(t))return de.info("Please enter the index for deleting rows or columns correctly.","");let o=$e(h.currentSheetIndex),{order:a=o,saveParam:s=!0,success:u}={...l},f=h.luckysheetfile[a],m=e==="row"?"rowhidden":"colhidden",d=$.extend(!0,{},f.config);d[m]==null&&(d[m]={});for(let g=n;g<=t;g++)d[m][g]=0;if(h.clearjfundo){let g={};g.type=e==="row"?"showHidRows":"showHidCols",g.sheetIndex=f.index,g.config=$.extend(!0,{},f.config),g.curconfig=d,h.jfundo.length=0,h.jfredo.push(g)}h.luckysheetfile[a].config=d,s&&He.saveParam("cg",f.index,d[m],{k:m}),a==o&&(h.config=d,Nl(h.flowdata.length,h.flowdata[0].length)),u&&typeof u=="function"&&u()}function $g(e,n,t,l={}){if(!Y(n)||!Y(t))return de.info("Please enter the index for deleting rows or columns correctly.","");let o=$e(h.currentSheetIndex),{order:a=o,saveParam:s=!0,success:u}={...l},f=h.luckysheetfile[a],m=e==="row"?"rowhidden":"colhidden",d=$.extend(!0,{},f.config);if(d[m]!=null){for(let g=n;g<=t;g++)delete d[m][g];if(h.clearjfundo){let g={};g.type=e==="row"?"showHidRows":"showHidCols",g.sheetIndex=f.index,g.config=$.extend(!0,{},f.config),g.curconfig=d,h.jfundo.length=0,h.jfredo.push(g)}h.luckysheetfile[a].config=h.config,s&&He.saveParam("cg",f.index,d[m],{k:m}),a===o&&(h.config=d,Nl(h.flowdata.length,h.flowdata[0].length)),u&&typeof u=="function"&&u()}}function N3(e,n,t={}){Cg("row",e,n,t)}function L3(e,n,t={}){$g("row",e,n,t)}function H3(e,n,t={}){Cg("column",e,n,t)}function B3(e,n,t={}){$g("column",e,n,t)}function j3(e,n={}){if(V(e)!="object")return de.info("The rowInfo parameter is invalid.","");let{order:t=$e(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config);a.rowlen==null&&(a.rowlen={});for(let s in e)if(parseInt(s)>=0){let u=e[s];u==="auto"?a.rowlen[parseInt(s)]=u:Number(u)>=0&&(a.rowlen[parseInt(s)]=Number(u))}o.config=a,He.saveParam("cg",o.index,a.rowlen,{k:"rowlen"}),o.index==h.currentSheetIndex&&(h.config=a,Nl(h.flowdata.length,h.flowdata[0].length)),l&&typeof l=="function"&&l()}function V3(e,n={}){if(V(e)!="object")return de.info("The columnInfo parameter is invalid.","");let{order:t=$e(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config);a.columnlen==null&&(a.columnlen={});for(let s in e)if(parseInt(s)>=0){let u=e[s];u==="auto"?a.columnlen[parseInt(s)]=u:Number(u)>=0&&(a.columnlen[parseInt(s)]=Number(u))}o.config=a,He.saveParam("cg",o.index,a.columnlen,{k:"columnlen"}),o.index==h.currentSheetIndex&&(h.config=a,Nl(h.flowdata.length,h.flowdata[0].length)),l&&typeof l=="function"&&l()}function W3(e,n={}){if(V(e)!="array"||e.length==0)return de.info("The rowInfo parameter is invalid.","");let{order:t=$e(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");let s=$.extend(!0,{},o.config).rowlen||{},u={};return e.forEach(f=>{if(parseInt(f)>=0){let m=s[parseInt(f)]||h.defaultrowlen;u[parseInt(f)]=m}}),setTimeout(()=>{l&&typeof l=="function"&&l()},1),u}function U3(e,n={}){if(V(e)!="array"||e.length==0)return de.info("The columnInfo parameter is invalid.","");let{order:t=$e(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");let s=$.extend(!0,{},o.config).columnlen||{},u={};return e.forEach(f=>{if(parseInt(f)>=0){let m=s[parseInt(f)]||h.defaultcollen;u[parseInt(f)]=m}}),setTimeout(()=>{l&&typeof l=="function"&&l()},1),u}function G3(e={}){let{order:n=$e(h.currentSheetIndex),success:t}={...e};return setTimeout(()=>{t&&typeof t=="function"&&t()},1),h.luckysheetfile[n].defaultRowHeight||h.defaultrowlen}function Y3(e={}){let{order:n=$e(h.currentSheetIndex),success:t}={...e};return setTimeout(()=>{t&&typeof t=="function"&&t()},1),h.luckysheetfile[n].defaultColWidth||h.defaultcollen}function E1(){let e=JSON.parse(JSON.stringify(h.luckysheet_select_save)),n=[];for(let t=0;t<e.length;t++){let l=e[t],o={row:l.row,column:l.column};n.push(o)}return n}function Sg(e){e=e||E1();let n=[];return e.forEach(t=>{let l=t.row,o=t.column;for(let a=l[0];a<=l[1];a++)for(let s=o[0];s<=o[1];s++)n.push({r:a,c:s})}),n}function q3(e){e=e||Sg();let n=[];return e.forEach(t=>{n.push(h.flowdata[t.r][t.c])}),n}function X3(){let e=[],n=JSON.parse(JSON.stringify(h.luckysheet_select_save)),t=h.currentSheetIndex;return n.forEach(l=>{let o=Al(t,{column:l.column,row:l.row});e.push(o)}),e}function Z3(e={}){let n=$e(h.currentSheetIndex),{range:t,order:l=n}={...e},o=h.luckysheetfile[l];if(!t||typeof t=="object")return Xl(t,o.index);if(typeof t=="string"){if(v.iscelldata(t))return Xl(v.getcellrange(t),o.index);de.info("The range is invalid, please check range parameter.","")}}function K3(e={}){let{range:n=h.luckysheet_select_save,order:t=$e(h.currentSheetIndex),success:l}={...e};if(n=JSON.parse(JSON.stringify(n)),V(n)=="string"){if(!v.iscelldata(n))return de.info("The range parameter is invalid.","");let y=v.getcellrange(n);n=[{row:y.row,column:y.column}]}else if(V(n)=="object"){if(n.row==null||n.column==null)return de.info("The range parameter is invalid.","");n=[{row:n.row,column:n.column}]}if(V(n)!="array")return de.info("The range parameter is invalid.","");let o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config);if(a.merge!=null){let y=!1;for(let p=0;p<n.length;p++){let x=n[p].row[0],_=n[p].row[1],S=n[p].column[0],I=n[p].column[1];if(y=Ul(a,x,_,S,I),y)break}if(y)return de.info("Cannot perform this operation on partially merged cells","")}let s=$.extend(!0,[],o.luckysheet_conditionformat_save);if(n.length>1&&s.length>0){let y=!1,p=xt.getComputeMap(o.index);for(let x=0;x<n.length;x++){let _=n[x].row[0],S=n[x].row[1],I=n[x].column[0],O=n[x].column[1];for(let F=_;F<=S;F++){for(let D=I;D<=O;D++)if(xt.checksCF(F,D,p)!=null){y=!0;break}if(y)break}if(y)break}if(y)return de.info("Cannot perform this operation on multiple selection areas, please select a single area","")}if(n.length>1){let y=!0,p=n[0].row[0],x=n[0].row[1],_=!0,S=n[0].column[0],I=n[0].column[1];for(let O=1;O<n.length;O++)(n[O].row[0]!=p||n[O].row[1]!=x)&&(y=!1),(n[O].column[0]!=S||n[O].column[1]!=I)&&(_=!1);if(!y&&!_||Ao(n))return de.info("Cannot perform this operation on multiple selection areas, please select a single area","")}let u=[],f=[];for(let y=0;y<n.length;y++){let p=n[y].row[0],x=n[y].row[1],_=n[y].column[0],S=n[y].column[1];for(let I=p;I<=x;I++)if(!(a.rowhidden!=null&&a.rowhidden[I]!=null)){u.includes(I)||u.push(I);for(let O=_;O<=S;O++)a.colhidden!=null&&a.colhidden[O]!=null||f.includes(O)||f.push(O)}}let m;a.borderInfo&&a.borderInfo.length>0&&(m=Mo(o.index));let d=o.data;(d==null||d.length==0)&&(d=ct.buildGridData(o));let g="",b="";u=u.sort((y,p)=>y-p),f=f.sort((y,p)=>y-p);for(let y=0;y<u.length;y++){let p=u[y];if(!(a.rowhidden!=null&&a.rowhidden[p]!=null)){g+="<tr>";for(let x=0;x<f.length;x++){let _=f[x];if(a.colhidden!=null&&a.colhidden[_]!=null)continue;let S='<td ${span} style="${style}">';if(d[p]!=null&&d[p][_]!=null){let I="",O="";p==u[0]&&(a.columnlen==null||a.columnlen[_.toString()]==null?b+='<colgroup width="72px"></colgroup>':b+='<colgroup width="'+a.columnlen[_.toString()]+'px"></colgroup>'),_==f[0]&&(a.rowlen==null||a.rowlen[p.toString()]==null?I+="height:19px;":I+="height:"+a.rowlen[p.toString()]+"px;");let F=/^(w|W)((0?)|(0\.0+))$/,D;if(d[p][_].ct!=null&&d[p][_].ct.fa!=null&&d[p][_].ct.fa.match(F)?D=Mt(p,_,d):D=Mt(p,_,d,"m"),I+=ht.getStyleByCell(d,p,_),V(d[p][_])=="object"&&"mc"in d[p][_])if("rs"in d[p][_].mc){if(O='rowspan="'+d[p][_].mc.rs+'" colspan="'+d[p][_].mc.cs+'"',m&&m[p+"_"+_]){let k={color:{},style:{}},w={color:{},style:{}},C={color:{},style:{}},T={color:{},style:{}};for(let M=p;M<p+d[p][_].mc.rs;M++)for(let P=_;P<_+d[p][_].mc.cs;P++){if(M==p&&m[M+"_"+P]&&m[M+"_"+P].t){let N=m[M+"_"+P].t.style,E=m[M+"_"+P].t.color;C.style[N]==null?C.style[N]=1:C.style[N]=C.style[N]+1,C.color[E]==null?C.color[E]=1:C.color[E]=C.color[E]+1}if(M==p+d[p][_].mc.rs-1&&m[M+"_"+P]&&m[M+"_"+P].b){let N=m[M+"_"+P].b.style,E=m[M+"_"+P].b.color;T.style[N]==null?T.style[N]=1:T.style[N]=T.style[N]+1,T.color[E]==null?T.color[E]=1:T.color[E]=T.color[E]+1}if(P==_&&m[M+"_"+P]&&m[M+"_"+P].l){let N=m[p+"_"+_].l.style,E=m[M+"_"+P].l.color;k.style[N]==null?k.style[N]=1:k.style[N]=k.style[N]+1,k.color[E]==null?k.color[E]=1:k.color[E]=k.color[E]+1}if(P==_+d[p][_].mc.cs-1&&m[M+"_"+P]&&m[M+"_"+P].r){let N=m[M+"_"+P].r.style,E=m[M+"_"+P].r.color;w.style[N]==null?w.style[N]=1:w.style[N]=w.style[N]+1,w.color[E]==null?w.color[E]=1:w.color[E]=w.color[E]+1}}let z=d[p][_].mc.rs,A=d[p][_].mc.cs;if(JSON.stringify(k).length>23){let M=null,P=null;for(let N in k.color)k.color[N]>=z/2&&(M=N);for(let N in k.style)k.style[N]>=z/2&&(P=N);M!=null&&P!=null&&(I+="border-left:"+Ol.getHtmlBorderStyle(P,M))}if(JSON.stringify(w).length>23){let M=null,P=null;for(let N in w.color)w.color[N]>=z/2&&(M=N);for(let N in w.style)w.style[N]>=z/2&&(P=N);M!=null&&P!=null&&(I+="border-right:"+Ol.getHtmlBorderStyle(P,M))}if(JSON.stringify(C).length>23){let M=null,P=null;for(let N in C.color)C.color[N]>=A/2&&(M=N);for(let N in C.style)C.style[N]>=A/2&&(P=N);M!=null&&P!=null&&(I+="border-top:"+Ol.getHtmlBorderStyle(P,M))}if(JSON.stringify(T).length>23){let M=null,P=null;for(let N in T.color)T.color[N]>=A/2&&(M=N);for(let N in T.style)T.style[N]>=A/2&&(P=N);M!=null&&P!=null&&(I+="border-bottom:"+Ol.getHtmlBorderStyle(P,M))}}}else continue;else if(m&&m[p+"_"+_]){if(m[p+"_"+_].l){let k=m[p+"_"+_].l.style,w=m[p+"_"+_].l.color;I+="border-left:"+Ol.getHtmlBorderStyle(k,w)}if(m[p+"_"+_].r){let k=m[p+"_"+_].r.style,w=m[p+"_"+_].r.color;I+="border-right:"+Ol.getHtmlBorderStyle(k,w)}if(m[p+"_"+_].b){let k=m[p+"_"+_].b.style,w=m[p+"_"+_].b.color;I+="border-bottom:"+Ol.getHtmlBorderStyle(k,w)}if(m[p+"_"+_].t){let k=m[p+"_"+_].t.style,w=m[p+"_"+_].t.color;I+="border-top:"+Ol.getHtmlBorderStyle(k,w)}}S=yt(S,{style:I,span:O}),D==null&&(D=Mt(p,_,d)),D==null&&(D=" "),S+=D}else{let I="";if(m&&m[p+"_"+_]){if(m[p+"_"+_].l){let O=m[p+"_"+_].l.style,F=m[p+"_"+_].l.color;I+="border-left:"+Ol.getHtmlBorderStyle(O,F)}if(m[p+"_"+_].r){let O=m[p+"_"+_].r.style,F=m[p+"_"+_].r.color;I+="border-right:"+Ol.getHtmlBorderStyle(O,F)}if(m[p+"_"+_].b){let O=m[p+"_"+_].b.style,F=m[p+"_"+_].b.color;I+="border-bottom:"+Ol.getHtmlBorderStyle(O,F)}if(m[p+"_"+_].t){let O=m[p+"_"+_].t.style,F=m[p+"_"+_].t.color;I+="border-top:"+Ol.getHtmlBorderStyle(O,F)}}S+="",p==u[0]&&(a.columnlen==null||a.columnlen[_.toString()]==null?b+='<colgroup width="72px"></colgroup>':b+='<colgroup width="'+a.columnlen[_.toString()]+'px"></colgroup>'),_==f[0]&&(a.rowlen==null||a.rowlen[p.toString()]==null?I+="height:19px;":I+="height:"+a.rowlen[p.toString()]+"px;"),S=yt(S,{style:I,span:""}),S+=" "}S+="</td>",g+=S}g+="</tr>"}}return g='<table data-type="luckysheet_copy_action_table">'+b+g+"</table>",g}function J3(e,n={}){if(!["oneDimensional","twoDimensional"].includes(e))return de.info("The dimensional parameter is invalid.","");let{range:l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],order:o=$e(h.currentSheetIndex)}={...n},a=h.luckysheetfile[o];if(a==null)return de.info("The order parameter is invalid.","");if(V(l)=="string"){if(!v.iscelldata(l))return de.info("The range parameter is invalid.","");l=v.getcellrange(l)}if(V(l)!="object"||l.row==null||l.column==null)return de.info("The range parameter is invalid.","");let s=l.row[0],u=l.row[1],f=l.column[0],m=l.column[1],d=$.extend(!0,{},a.config);if(d.merge!=null&&Ul(d,s,u,f,m))return de.info("Cannot perform this operation on partially merged cells","");let g=a.data;(g==null||g.length==0)&&(g=ct.buildGridData(a));let b=[];if(e=="oneDimensional")for(let y=s;y<=u;y++)for(let p=f;p<=m;p++){let x=g[y][p];x==null||x.v==null?b.push(null):b.push(x.v)}else if(e=="twoDimensional")for(let y=s;y<=u;y++){let p=[];for(let x=f;x<=m;x++){let _=g[y][x];_==null||_.v==null?p.push(null):p.push(_.v)}b.push(p)}return b}function Q3(e,n={}){let t=h.luckysheet_select_save[0],l=$e(h.currentSheetIndex),{range:o=t,order:a=l}={...n},s=h.luckysheetfile[a],u=s.config;if(o&&typeof o=="string"&&v.iscelldata(o)&&(o=v.getcellrange(o)),!o||o.length>1){Qe()?alert(locale_drag.noMulti):de.info(locale_drag.noMulti,"");return}if(u.merge!=null){let d=!1,g=o.row[0],b=o.row[1],y=o.column[0],p=o.column[1];if(d=Ul(u,g,b,y,p),d){Qe()?alert(Oe().drag.noPartMerge):de.info(Oe().drag.noPartMerge,"");return}}let f=Xl(o,s.index),m=[];if(f.length!==0){if(e)if(f.length===1){let d={};for(let g=0;g<f[0].length;g++)d[Mt(0,g,f)]="";m.push(d)}else for(let d=1;d<f.length;d++){let g={};for(let b=0;b<f[0].length;b++)Mt(0,b,f)==null?g[""]=Mt(d,b,f):g[Mt(0,b,f)]=Mt(d,b,f);m.push(g)}else{let d=o.column[0];for(let g=0;g<f.length;g++){let b={};for(let y=0;y<f[0].length;y++)b[Qt(y+d)]=Mt(g,y,f);m.push(b)}}return m}}function e5(e,n={}){if(["normal","anti","offset"].indexOf(e)<0)return de.info("The type parameter must be included in ['normal', 'anti', 'offset']","");let l=$e(h.currentSheetIndex),o=JSON.parse(JSON.stringify(h.luckysheet_select_save)),{column:a=1,range:s=o,order:u=l}={...n},m=h.luckysheetfile[u].config;if(s&&typeof s=="string"&&v.iscelldata(s)&&(s=v.getcellrange(s)),!s||s.length>1){Qe()?alert(Oe().drag.noMulti):de.info(Oe().drag.noMulti,"");return}if(m.merge!=null){let y=!1,p=s[0].row[0],x=s[0].row[1],_=s[0].column[0],S=s[0].column[1];if(y=Ul(m,p,x,_,S),y){Qe()?alert(Oe().drag.noPartMerge):de.info(Oe().drag.noPartMerge,"");return}}let d=Xl(s,u),g=[];if(d.length===0)return;let b=d[0].length;switch(e){case"normal":for(let y=0;y<d.length&&!(y>=b);y++)g.push(d[y][y]);break;case"anti":for(let y=0;y<d.length&&!(y>=b);y++)g.push(d[y][b-y-1]);break;case"offset":if(a.toString()=="NaN"){Qe()?alert(Oe().drag.inputCorrect):de.info(Oe().drag.inputCorrect,"");return}if(a<0){Qe()?alert(Oe().drag.offsetColumnLessZero):de.info(Oe().drag.offsetColumnLessZero,"");return}for(let y=0;y<d.length&&!(y+a>=b);y++)g.push(d[y][y+a]);break}Ol.copybyformat(new Event,JSON.stringify(g))}function t5(e={}){let n=$e(h.currentSheetIndex),t=JSON.parse(JSON.stringify(h.luckysheet_select_save)),{range:l=t,order:o=n}={...e},s=h.luckysheetfile[o].config;if(l&&typeof l=="string"&&v.iscelldata(l)&&(l=v.getcellrange(l)),!l||l.length>1){Qe()?alert(Oe().drag.noMulti):de.info(Oe().drag.noMulti,"");return}if(s.merge!=null){let m=!1,d=l[0].row[0],g=l[0].row[1],b=l[0].column[0],y=l[0].column[1];if(m=Ul(s,d,g,b,y),m){Qe()?alert(Oe().drag.noPartMerge):de.info(Oe().drag.noPartMerge,"");return}}let u=Xl(l,o),f=[];if(u.length!==0){for(let m=0;m<u.length;m++){let d=[];for(let g=0;g<u[0].length;g++){let b=!1,y;V(u[m][g])=="object"?y=u[m][g].v:y=u[m][g],y==null||y==""?b=!1:(y=parseInt(y),y==null||y>0?b=!0:b=!1),d.push(b)}f.push(d)}Ol.copybyformat(event,JSON.stringify(f))}}function l5(e,n={}){if(V(e)=="string"){if(!v.iscelldata(e))return de.info("The range parameter is invalid.","");let s=v.getcellrange(e);e=[{row:s.row,column:s.column}]}else if(V(e)=="object"){if(e.row==null||e.column==null)return de.info("The range parameter is invalid.","");e=[{row:e.row,column:e.column}]}if(V(e)=="array"){for(let s=0;s<e.length;s++)if(V(e[s])==="string"){if(!v.iscelldata(e[s]))return de.info("The range parameter is invalid.","");let u=v.getcellrange(e[s]);e[s]={row:u.row,column:u.column}}else if(V(e)=="object"){if(e.row==null||e.column==null)return de.info("The range parameter is invalid.","");e={row:e.row,column:e.column}}}if(V(e)!="array")return de.info("The range parameter is invalid.","");let{show:t=!0,order:l=$e(h.currentSheetIndex),success:o}={...n},a=h.luckysheetfile[l];if(a==null)return de.info("The order parameter is invalid.","");for(let s=0;s<e.length;s++){let u=ht.mergeMoveMain(e[s].column,e[s].row,e[s]);u&&(e[s]={row:u[1],column:u[0]})}a.luckysheet_select_save=e,a.index==h.currentSheetIndex&&(h.luckysheet_select_save=e,Zt(),t||($("#luckysheet-cell-selected-boxs").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty())),o&&typeof o=="function"&&o()}function r5(e,n={}){let t=$e(h.currentSheetIndex),l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],{range:o=l,isRefresh:a=!0,order:s=t,success:u}={...n};if(e==null)return de.info("The data which will be set to range cannot be null.","");if(o instanceof Array)return de.info("setRangeValue only supports a single selection.","");typeof o=="string"&&v.iscelldata(o)&&(o=v.getcellrange(o));let f=o.row[1]-o.row[0]+1,m=o.column[1]-o.column[0]+1;if(e.length!==f||e[0].length!==m)return de.info("The data to be set does not match the selection.","");let d=h.luckysheetfile[s];if(d==null)return de.info("The order parameter is invalid.","");let g=$.extend(!0,[],d.data);for(let y=0;y<f;y++)for(let p=0;p<m;p++){let x=o.row[0]+y,_=o.column[0]+p;Bc(x,_,e[y][p],{order:s,isRefresh:!1})}let b=$.extend(!0,[],d.data);d.data.length=0,d.data.push(...g),d.index==h.currentSheetIndex&&Gt(b,[{row:o.row,column:o.column}],void 0,!0,!1),a&&Et(),u&&typeof u=="function"&&u()}function N1(e,n,t={}){let l=$e(h.currentSheetIndex),o=h.luckysheet_select_save[h.luckysheet_select_save.length-1],{range:a=o,order:s=l}={...t};if(!e)return de.info("Arguments attr cannot be null or undefined.",""),"error";if(a instanceof Array)return de.info("setRangeValue only supports a single selection.",""),"error";if(V(a)=="string"){if(!v.iscelldata(a))return de.info("The range parameter is invalid.",""),"error";a=v.getcellrange(a)}if(V(a)!="object"||a.row==null||a.column==null)return de.info("The range parameter is invalid.",""),"error";for(let u=a.row[0];u<=a.row[1];u++)for(let f=a.column[0];f<=a.column[1];f++)console.log("r",u),console.log("c",f),Bc(u,f,{[e]:n},{order:s,isRefresh:!1})}function n5(e,n,t={}){let l=$e(h.currentSheetIndex),o=JSON.parse(JSON.stringify(h.luckysheet_select_save)),{range:a=o,order:s=l,success:u}={...t};if(V(a)=="string"){if(!v.iscelldata(a))return de.info("The range parameter is invalid.","");let g=v.getcellrange(a);a=[{row:g.row,column:g.column}]}else if(V(a)=="object"){if(a.row==null||a.column==null)return de.info("The range parameter is invalid.","");a=[{row:a.row,column:a.column}]}if(V(a)!="array")return de.info("The range parameter is invalid.","");let f=h.luckysheetfile[s],m=[];for(let g=0;g<a.length;g++)m.push(N1(e,n,{range:a[g],order:s}));let d=$.extend(!0,[],f.data);if(m.some(g=>g==="error"))return f.data.length=0,f.data.push(...d),!1;f.data.length=0,f.data.push(...d),f.index==h.currentSheetIndex&&Gt(d,void 0,void 0,!0,!1),Et(),u&&typeof u=="function"}function i5(e,n={}){if(!["open","close"].includes(e))return de.info("The type parameter is invalid.","");let{range:l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],order:o=$e(h.currentSheetIndex),success:a}={...n},s=h.luckysheetfile[o];if(s==null)return de.info("The order parameter is invalid.","");if(V(l)=="string"){if(!v.iscelldata(l))return de.info("The range parameter is invalid.","");l=v.getcellrange(l)}if(V(l)!="object"||l.row==null||l.column==null)return de.info("The range parameter is invalid.","");if(setTimeout(()=>{a&&typeof a=="function"&&a()},1),e=="open")return s.filter_select=l,s.index==h.currentSheetIndex&&Bn(l,s.filter),{row:l.row,column:l.column};if(e=="close"){let u=$.extend(!0,{},s.filter_select);return s.filter_select=null,$("#luckysheet-filter-selected-sheet"+s.index).remove(),$("#luckysheet-filter-options-sheet"+s.index).remove(),{row:u.row,column:u.column}}}function o5(e,n={}){if(["all","horizontal","vertical"].indexOf(e)<0)return de.info("The type parameter must be included in ['all', 'horizontal', 'vertical']","");let l=$e(h.currentSheetIndex),o=JSON.parse(JSON.stringify(h.luckysheet_select_save)),{range:a=o,order:s=l,success:u}={...n},f=h.luckysheetfile[s],m=$.extend(!0,{},f.config),d=$.extend(!0,[],f.data);if(d.length==0&&(d=$.extend(!0,[],ct.buildGridData(f))),V(a)=="string"){if(!v.iscelldata(a))return de.info("Incorrect selection format","");let b=v.getcellrange(a);a=[{row:b.row,column:b.column}]}else if(V(a)=="object"){if(!a.hasOwnProperty("row")||!a.hasOwnProperty("column"))return de.info("Incorrect selection format","");a=[{row:a.row,column:a.column}]}if(Ao(a))return de.info("Cannot merge overlapping range","");if(m.merge!=null){let b=!1;for(let y=0;y<a.length;y++){let p=a[y].row[0],x=a[y].row[1],_=a[y].column[0],S=a[y].column[1];if(b=Ul(m,p,x,_,S),b)break}if(b)return de.info("Cannot perform this operation on partially merged cells","")}else m.merge={};let g=!1;for(let b=0;b<a.length;b++){let y=a[b].row[0],p=a[b].row[1],x=a[b].column[0],_=a[b].column[1];for(let S=y;S<=p;S++){for(let I=x;I<=_;I++){let O=d[S][I];if(V(O)=="object"&&"mc"in O){g=!0;break}}if(g)break}}if(g)L1({range:a,order:s});else{for(let b=0;b<a.length;b++){let y=a[b].row[0],p=a[b].row[1],x=a[b].column[0],_=a[b].column[1];if(!(y==p&&x==_)){if(e=="all"){let S={},I=!1;for(let O=y;O<=p;O++)for(let F=x;F<=_;F++){let D=d[O][F];D!=null&&(!rt(D.v)||D.f!=null)&&!I&&(S=$.extend(!0,{},D),I=!0),d[O][F]={mc:{r:y,c:x}}}d[y][x]=S,d[y][x].mc={r:y,c:x,rs:p-y+1,cs:_-x+1},m.merge[y+"_"+x]={r:y,c:x,rs:p-y+1,cs:_-x+1}}else if(e=="vertical")for(let S=x;S<=_;S++){let I={},O=!1;for(let F=y;F<=p;F++){let D=d[F][S];D!=null&&(!rt(D.v)||D.f!=null)&&!O&&(I=$.extend(!0,{},D),O=!0),d[F][S]={mc:{r:y,c:S}}}d[y][S]=I,d[y][S].mc={r:y,c:S,rs:p-y+1,cs:1},m.merge[y+"_"+S]={r:y,c:S,rs:p-y+1,cs:1}}else if(e=="horizontal")for(let S=y;S<=p;S++){let I={},O=!1;for(let F=x;F<=_;F++){let D=d[S][F];D!=null&&(!rt(D.v)||D.f!=null)&&!O&&(I=$.extend(!0,{},D),O=!0),d[S][F]={mc:{r:S,c:x}}}d[S][x]=I,d[S][x].mc={r:S,c:x,rs:1,cs:_-x+1},m.merge[S+"_"+x]={r:S,c:x,rs:1,cs:_-x+1}}}}s==l?(h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"mergeChange",sheetIndex:f.index,data:$.extend(!0,[],f.data),curData:d,range:a,config:$.extend(!0,{},f.config),curConfig:m})),h.clearjfundo=!1,Gt(d,a,{cfg:m}),h.clearjfundo=!0):(f.data=d,f.config=m)}u&&typeof u=="function"&&u()}function L1(e={}){let n=h.luckysheet_select_save,t=$e(h.currentSheetIndex),{range:l=n,order:o=t,success:a}={...e},s=h.luckysheetfile[o],u=$.extend(!0,{},s.config),f=$.extend(!0,[],s.data);if(f.length==0&&(f=$.extend(!0,[],ct.buildGridData(s))),V(l)=="string"){if(!v.iscelldata(l))return de.info("Incorrect selection format","");let m=v.getcellrange(l);l=[{row:m.row,column:m.column}]}else if(V(l)=="object"){if(!l.hasOwnProperty("row")||!l.hasOwnProperty("column"))return de.info("Incorrect selection format","");l=[{row:l.row,column:l.column}]}if(Ao(l))return de.info("Cannot merge overlapping range","");if(u.merge!=null){let m=!1;for(let d=0;d<l.length;d++){let g=l[d].row[0],b=l[d].row[1],y=l[d].column[0],p=l[d].column[1];if(m=Ul(u,g,b,y,p),m)break}if(m)return de.info("Cannot perform this operation on partially merged cells","")}for(let m=0;m<l.length;m++){let d=l[m].row[0],g=l[m].row[1],b=l[m].column[0],y=l[m].column[1];if(d==g&&b==y)continue;let p={};for(let x=d;x<=g;x++)for(let _=b;_<=y;_++){let S=f[x][_];if(S!=null&&S.mc!=null){let I=S.mc.r,O=S.mc.c;if("rs"in S.mc)delete S.mc,delete u.merge[I+"_"+O],p[I+"_"+O]=$.extend(!0,{},S);else{let F=JSON.parse(JSON.stringify(p[I+"_"+O]));delete F.v,delete F.m,delete F.ct,delete F.f,delete F.spl,f[x][_]=F}}}}o==t?(h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"mergeChange",sheetIndex:s.index,data:$.extend(!0,[],s.data),curData:f,range:l,config:$.extend(!0,{},s.config),curConfig:u})),h.clearjfundo=!1,Gt(f,l,{cfg:u}),h.clearjfundo=!0):(s.data=f,s.config=u)}function a5(e,n={}){if(["asc","desc"].indexOf(e)<0)return de.info("The type parameter must be included in ['asc', 'desc'","");let l=$e(h.currentSheetIndex),o=h.luckysheet_select_save[0],{range:a=o,order:s=l,success:u}={...n},f=h.luckysheetfile[s],m=$.extend(!0,{},f.config),d=$.extend(!0,[],f.data);if(d.length==0&&(d=$.extend(!0,[],ct.buildGridData(f))),a instanceof Array&&a.length>1){de.info(Oe().sort.noRangeError,"");return}a&&typeof a=="string"&&v.iscelldata(a)&&(a=v.getcellrange(a));let g=a.row[0],b=a.row[1],y=a.column[0],p=a.column[1],x=!1,_=[];for(let I=g;I<=b;I++){let O=[];for(let F=y;F<=p;F++){if(d[I][F]!=null&&d[I][F].mc!=null){x=!0;break}O.push(d[I][F])}_.push(O)}if(x){de.info(Oe().sort.mergeError,"");return}_=So([].concat(_),0,e==="asc");for(let I=g;I<=b;I++)for(let O=y;O<=p;O++)d[I][O]=_[I-g][O-y];let S={};m.rowlen!=null&&(m=tn(d,g,b,m),S={cfg:m,RowlChange:!0}),f.index==h.currentSheetIndex?Gt(d,[{row:[g,b],column:[y,p]}],S):(f.data=d,f.config=m),u&&typeof u=="function"&&u()}function s5(e,n,t={}){if(!n||!(n instanceof Array))return de.info("The sort parameter is invalid.","");let l=$e(h.currentSheetIndex),o=h.luckysheet_select_save[0],{range:a=o,order:s=l,success:u}={...t},f=h.luckysheetfile[s],m=$.extend(!0,{},f.config),d=$.extend(!0,[],f.data);if(d.length==0&&(d=$.extend(!0,[],ct.buildGridData(f))),a instanceof Array&&a.length>1){de.info(Oe().sort.noRangeError,"");return}a&&typeof a=="string"&&v.iscelldata(a)&&(a=v.getcellrange(a));let g=a.row[0],b=a.row[1],y=a.column[0],p=a.column[1],x;e?x=g+1:x=g;let _=!1,S=[];for(let O=x;O<=b;O++){let F=[];for(let D=y;D<=p;D++){if(d[O][D]!=null&&d[O][D].mc!=null){_=!0;break}F.push(d[O][D])}S.push(F)}if(_){de.info(Oe().sort.mergeError,"");return}n.forEach(O=>{let F=O.i;F-=y,S=So([].concat(S),F,O.sort==="asc")});for(let O=x;O<=b;O++)for(let F=y;F<=p;F++)d[O][F]=S[O-x][F-y];let I={};m.rowlen!=null&&(m=tn(d,x,b,m),I={cfg:m,RowlChange:!0}),f.index===h.currentSheetIndex?Gt(d,[{row:[x,b],column:[y,p]}],I):(f.data=d,f.config=m),u&&typeof u=="function"&&u()}function c5(e,n,t={}){if(!e||!["greaterThan","lessThan","betweenness","equal","textContains","occurrenceDate","duplicateValue","top10","top10%","last10","last10%","AboveAverage","SubAverage"].includes(e))return de.info("The conditionName parameter is invalid.","");if(V(n)!="array"||n.length==0)return de.info("The conditionValue parameter is invalid.","");let{format:o={textColor:"#000000",cellColor:"#ff0000"},cellrange:a=h.luckysheet_select_save,order:s=$e(h.currentSheetIndex),success:u}={...t};a=JSON.parse(JSON.stringify(a));let f=h.luckysheetfile[s],m=f.data;if((m==null||m.length==0)&&(m=ct.buildGridData(f)),f==null)return de.info("Incorrect worksheet index","");let d=Oe().conditionformat,g=[],b=[];if(e=="betweenness"){let O=n[0],F=n[1],D=xt.getRangeByTxt(O);if(D.length>1){xt.infoDialog(d.onlySingleCell,"");return}else if(D.length==1){let w=D[0].row[0],C=D[0].row[1],T=D[0].column[0],z=D[0].column[1];if(w==C&&T==z)O=Mt(w,T,m),g.push({row:D[0].row,column:D[0].column}),b.push(O);else{xt.infoDialog(d.onlySingleCell,"");return}}else if(D.length==0)if(isNaN(O)||O==""){xt.infoDialog(d.conditionValueCanOnly,"");return}else b.push(O);let k=xt.getRangeByTxt(F);if(k.length>1){xt.infoDialog(d.onlySingleCell,"");return}else if(k.length==1){let w=k[0].row[0],C=k[0].row[1],T=k[0].column[0],z=k[0].column[1];if(w==C&&T==z)F=Mt(w,T,m),g.push({row:k[0].row,column:k[0].column}),b.push(F);else{xt.infoDialog(d.onlySingleCell,"");return}}else if(k.length==0)if(isNaN(F)||F==""){xt.infoDialog(d.conditionValueCanOnly,"");return}else b.push(F)}else if(e=="greaterThan"||e=="lessThan"||e=="equal"){let O=n[0],F=xt.getRangeByTxt(O);if(F.length>1){xt.infoDialog(d.onlySingleCell,"");return}else if(F.length==1){let D=F[0].row[0],k=F[0].row[1],w=F[0].column[0],C=F[0].column[1];if(D==k&&w==C)O=Mt(D,w,m),g.push({row:F[0].row,column:F[0].column}),b.push(O);else{xt.infoDialog(d.onlySingleCell,"");return}}else if(F.length==0)if(isNaN(O)||O==""){xt.infoDialog(d.conditionValueCanOnly,"");return}else b.push(O)}else if(e=="textContains"){let O=n[0],F=xt.getRangeByTxt(O);if(F.length>1){xt.infoDialog(d.onlySingleCell,"");return}else if(F.length==1){let D=F[0].row[0],k=F[0].row[1],w=F[0].column[0],C=F[0].column[1];if(D==k&&w==C)O=Mt(D,w,m),g.push({row:F[0].row,column:F[0].column}),b.push(O);else{xt.infoDialog(d.onlySingleCell,"");return}}else if(F.length==0)if(O==""){xt.infoDialog(d.conditionValueCanOnly,"");return}else b.push(O)}else if(e=="occurrenceDate"){let O=n[0],F=n[1];if(!Zl(O)||!Zl(F))return de.info("The conditionValue parameter is invalid.","");let D;Br(O,F)>0?D=(0,Zu.default)(F).format("YYYY/MM/DD")+"-"+(0,Zu.default)(O).format("YYYY/MM/DD"):D=(0,Zu.default)(O).format("YYYY/MM/DD")+"-"+(0,Zu.default)(F).format("YYYY/MM/DD"),b.push(D)}else if(e=="duplicateValue"){let O=n[0];if(O!="0"||O!="1")return de.info("The conditionValue parameter is invalid.","");b.push(O)}else if(e=="top10"||e=="top10%"||e=="last10"||e=="last10%"){let O=n[0];if(parseInt(O)!=O||parseInt(O)<1||parseInt(O)>1e3){xt.infoDialog(d.pleaseEnterInteger,"");return}b.push(parseInt(O))}else(e=="AboveAverage"||e=="SubAverage")&&b.push(e);if(!o.hasOwnProperty("textColor")||!o.hasOwnProperty("cellColor"))return de.info("The format parameter is invalid.","");if(V(a)=="string"?a=xt.getRangeByTxt(a):V(a)=="object"&&(a=[a]),V(a)!="array")return de.info("The cellrange parameter is invalid.","");let y={type:"default",cellrange:a,format:o,conditionName:e,conditionRange:g,conditionValue:b},p=$.extend(!0,[],h.luckysheetfile),x=xt.getHistoryRules(p),_=f.luckysheet_conditionformat_save||[];_.push(y),f.luckysheet_conditionformat_save=_;let S=$.extend(!0,[],h.luckysheetfile),I=xt.getCurrentRules(S);xt.ref(x,I),He.allowUpdate&&He.saveParam("all",f.index,_,{k:"luckysheet_conditionformat_save"}),u&&typeof u=="function"&&u()}function u5(e,n={}){if(!e||!["dataBar","colorGradation","icons"].includes(e))return de.info("The type parameter is invalid.","");let{format:l,cellrange:o=h.luckysheet_select_save,order:a=$e(h.currentSheetIndex),success:s}={...n};o=JSON.parse(JSON.stringify(o));let u=h.luckysheetfile[a];if(u==null)return de.info("Incorrect worksheet index","");if(e=="dataBar"){if(l==null&&(l=["#638ec6","#ffffff"]),V(l)!="array"||l.length<1||l.length>2)return de.info("The format parameter is invalid.","")}else if(e=="colorGradation"){if(l==null&&(l=["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]),V(l)!="array"||l.length<2||l.length>3)return de.info("The format parameter is invalid.","")}else if(e=="icons"){l==null&&(l="threeWayArrowMultiColor");let p=["threeWayArrowMultiColor","threeTriangles","fourWayArrowMultiColor","fiveWayArrowMultiColor","threeWayArrowGrayColor","fourWayArrowGrayColor","fiveWayArrowGrayColor","threeColorTrafficLightRimless","threeSigns","greenRedBlackGradient","threeColorTrafficLightBordered","fourColorTrafficLight","threeSymbolsCircled","tricolorFlag","threeSymbolsnoCircle","threeStars","fiveQuadrantDiagram","fiveBoxes","grade4","grade5"];if(V(l)!="string"||!p.includes(l))return de.info("The format parameter is invalid.","");switch(l){case"threeWayArrowMultiColor":l={len:3,leftMin:0,top:0};break;case"threeTriangles":l={len:3,leftMin:0,top:1};break;case"fourWayArrowMultiColor":l={len:4,leftMin:0,top:2};break;case"fiveWayArrowMultiColor":l={len:5,leftMin:0,top:3};break;case"threeWayArrowGrayColor":l={len:3,leftMin:5,top:0};break;case"fourWayArrowGrayColor":l={len:4,leftMin:5,top:1};break;case"fiveWayArrowGrayColor":l={len:5,leftMin:5,top:2};break;case"threeColorTrafficLightRimless":l={len:3,leftMin:0,top:4};break;case"threeSigns":l={len:3,leftMin:0,top:5};break;case"greenRedBlackGradient":l={len:4,leftMin:0,top:6};break;case"threeColorTrafficLightBordered":l={len:3,leftMin:5,top:4};break;case"fourColorTrafficLight":l={len:4,leftMin:5,top:5};break;case"threeSymbolsCircled":l={len:3,leftMin:0,top:7};break;case"tricolorFlag":l={len:3,leftMin:0,top:8};break;case"threeSymbolsnoCircle":l={len:3,leftMin:5,top:7};break;case"threeStars":l={len:3,leftMin:0,top:9};break;case"fiveQuadrantDiagram":l={len:5,leftMin:0,top:10};break;case"fiveBoxes":l={len:5,leftMin:0,top:11};break;case"grade4":l={len:4,leftMin:5,top:9};break;case"grade5":l={len:5,leftMin:5,top:10};break}}if(V(o)=="string"?o=xt.getRangeByTxt(o):V(o)=="object"&&(o=[o]),V(o)!="array")return de.info("The cellrange parameter is invalid.","");let f={type:e,cellrange:o,format:l},m=$.extend(!0,[],h.luckysheetfile),d=xt.getHistoryRules(m),g=u.luckysheet_conditionformat_save||[];g.push(f),u.luckysheet_conditionformat_save=g;let b=$.extend(!0,[],h.luckysheetfile),y=xt.getCurrentRules(b);xt.ref(d,y),He.allowUpdate&&He.saveParam("all",u.index,g,{k:"luckysheet_conditionformat_save"}),s&&typeof s=="function"&&s()}function f5(e,n={}){if(!Y(e))return de.info("The itemIndex parameter is invalid.","");e=Number(e);let{order:t=$e(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");let a=$.extend(!0,[],o.luckysheet_conditionformat_save);if(a.length==0)return de.info("This worksheet has no conditional format to delete","");if(a[e]==null)return de.info("The conditional format of the index cannot be found","");let s=a.splice(e,1),u=$.extend(!0,[],h.luckysheetfile),f=xt.getHistoryRules(u);o.luckysheet_conditionformat_save=a;let m=$.extend(!0,[],h.luckysheetfile),d=xt.getCurrentRules(m);return xt.ref(f,d),He.allowUpdate&&He.saveParam("all",o.index,ruleArr,{k:"luckysheet_conditionformat_save"}),setTimeout(()=>{l&&typeof l=="function"&&l()},1),s}function h5(e={}){let{range:n=h.luckysheet_select_save,order:t=$e(h.currentSheetIndex),success:l}={...e};if(n=JSON.parse(JSON.stringify(n)),V(n)=="string"){if(!v.iscelldata(n))return de.info("The range parameter is invalid.","");let f=v.getcellrange(n);n=[{row:f.row,column:f.column}]}else if(V(n)=="object"){if(n.row==null||n.column==null)return de.info("The range parameter is invalid.","");n=[{row:n.row,column:n.column}]}if(V(n)!="array")return de.info("The range parameter is invalid.","");let o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config),s=!1;for(let f=0;f<n.length;f++){let m=n[f].row[0],d=n[f].row[1],g=n[f].column[0],b=n[f].column[1];if(s=Ul(a,m,d,g,b),s)break}if(s)return de.info("Cannot perform this operation on partially merged cells","");let u=$.extend(!0,[],o.data);u.length==0&&(u=$.extend(!0,[],ct.buildGridData(o)));for(let f=0;f<n.length;f++){let m=n[f].row[0],d=n[f].row[1],g=n[f].column[0],b=n[f].column[1];for(let y=m;y<=d;y++)for(let p=g;p<=b;p++){let x=u[y][p];V(x)=="object"?(delete x.m,delete x.v,x.f!=null&&(delete x.f,v.delFunctionGroup(y,p,o.index),delete x.spl),x.ct!=null&&x.ct.t=="inlineStr"&&delete x.ct):u[y][p]=null}}o.index==h.currentSheetIndex?Gt(u,n):o.data=u,l&&typeof l=="function"&&l()}function d5(e,n={}){if(!["left","up"].includes(e))return de.info("The move parameter is invalid.","");let{range:l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],order:o=$e(h.currentSheetIndex),success:a}={...n};if(V(l)=="string"){if(!v.iscelldata(l))return de.info("The range parameter is invalid.","");let g=v.getcellrange(l);l={row:g.row,column:g.column}}if(V(l)!="object"||l.row==null||l.column==null)return de.info("The range parameter is invalid.","");if(h.luckysheetfile[o]==null)return de.info("The order parameter is invalid.","");let u=l.row[0],f=l.row[1],m=l.column[0],d=l.column[1];e=="left"?Fs("moveLeft",u,f,m,d,o):e=="up"&&Fs("moveUp",u,f,m,d,o),a&&typeof a=="function"&&a()}function m5(e,n={}){if(!e||["flipUpDown","flipLeftRight","flipClockwise","flipCounterClockwise","transpose","deleteZeroByRow","deleteZeroByColumn","removeDuplicateByRow","removeDuplicateByColumn","newMatrix"].indexOf(e)<0)return de.info("The type parameter is invalid.","");let l=h.luckysheet_select_save[0],{range:o=l,success:a}={...n};if(o instanceof Array&&o.length>1){de.info(Oe().drag.noMulti,"");return}o&&typeof o=="string"&&v.iscelldata(o)&&(o=v.getcellrange(o));let s=Xl(o),u=[];if(s.length===0)return;let f,m,d;switch(e){case"flipUpDown":for(let g=s.length-1;g>=0;g--){let b=[];for(let y=0;y<s[0].length;y++){let p="";s[g]!=null&&s[g][y]!=null&&(p=s[g][y]),b.push(p)}u.push(b)}break;case"flipLeftRight":for(let g=0;g<s.length;g++){let b=[];for(let y=s[0].length-1;y>=0;y--){let p="";s[g]!=null&&s[g][y]!=null&&(p=s[g][y]),b.push(p)}u.push(b)}break;case"flipClockwise":for(let g=0;g<s[0].length;g++){let b=[];for(let y=s.length-1;y>=0;y--){let p="";s[y]!=null&&s[y][g]!=null&&(p=s[y][g]),b.push(p)}u.push(b)}break;case"flipCounterClockwise":for(let g=s[0].length-1;g>=0;g--){let b=[];for(let y=0;y<s.length;y++){let p="";s[y]!=null&&s[y][g]!=null&&(p=s[y][g]),b.push(p)}u.push(b)}break;case"transpose":for(let g=0;g<s[0].length;g++){let b=[];for(let y=0;y<s.length;y++){let p="";s[y]!=null&&s[y][g]!=null&&(p=s[y][g]),b.push(p)}u.push(b)}break;case"deleteZeroByRow":f=s[0].length;for(let g=0;g<s.length;g++){let b=[],y=!0,p=!0;for(let _=0;_<f;_++){let S="";if(s[g]!=null&&s[g][_]!=null){if(S=s[g][_],(S.v=="0"||S.v==0)&&y)continue;y=!1}b.push(S)}let x=[];if(b.length==f)x=b;else{for(let S=b.length-1;S>=0;S--){let I="";if(b[S]!=null){if(I=b[S],(I.v=="0"||I.v==0)&&p)continue;p=!1}x.unshift(I)}let _=f-x.length;for(let S=0;S<_;S++)x.push("")}u.push(x)}break;case"deleteZeroByColumn":f=s.length,m=s[0].length;for(let g=0;g<m;g++){let b=[],y=!0,p=!0;for(let _=0;_<f;_++){let S="";if(s[_]!=null&&s[_][g]!=null){if(S=s[_][g],(S.v=="0"||S.v==0)&&y)continue;y=!1}b.push(S)}let x=[];if(b.length==f)x=b;else{for(let S=b.length-1;S>=0;S--){let I="";if(b[S]!=null){if(I=b[S],(I.v=="0"||I.v==0)&&p)continue;p=!1}x.unshift(I)}let _=f-x.length;for(let S=0;S<_;S++)x.push("")}u.push(x)}d=[];for(let g=0;g<u[0].length;g++){let b=[];for(let y=0;y<u.length;y++){let p="";u[y]!=null&&u[y][g]!=null&&(p=u[y][g]),b.push(p)}d.push(b)}break;case"removeDuplicateByRow":f=s[0].length;for(let g=0;g<s.length;g++){let b=[],y={};for(let x=0;x<f;x++){let _=null;s[g]!=null&&s[g][x]!=null&&(_=s[g][x],_.v in y||(y[_.v]=[]),y[_.v].push(_))}for(let x=0;x<f;x++){let _=null;s[g]!=null&&s[g][x]!=null&&(_=s[g][x],y[_.v].length==1&&b.push(_))}let p=f-b.length;for(let x=0;x<p;x++)b.push(null);u.push(b)}break;case"removeDuplicateByColumn":m=s[0].length,f=s.length;for(let g=0;g<m;g++){let b=[],y={};for(let x=0;x<f;x++){let _=null;s[x]!=null&&s[x][g]!=null&&(_=s[x][g],_.v in y||(y[_.v]=[]),y[_.v].push(_))}for(let x=0;x<f;x++){let _=null;s[x]!=null&&s[x][g]!=null&&(_=s[x][g],y[_.v].length==1&&b.push(_))}a1=b;let p=f-a1.length;for(let x=0;x<p;x++)a1.push(null);u.push(a1)}d=[];for(let g=0;g<u[0].length;g++){let b=[];for(let y=0;y<u.length;y++){let p=null;u[y]!=null&&u[y][g]!=null&&(p=u[y][g]),b.push(p)}d.push(b)}break;case"newMatrix":console.log("TODO");break}pt.controlHandler(u,o),a&&typeof a=="function"&&a()}function g5(e,n,t={}){if(!e||["plus","minus","multiply","divided","power","root","log"].indexOf(e)<0)return de.info("The type parameter is invalid.","");if(!Y(n))return de.info("The number parameter is invalid.","");let o=h.luckysheet_select_save[0],{range:a=o,success:s}={...t};if(a instanceof Array&&a.length>1){de.info(Oe().drag.noMulti,"");return}a&&typeof a=="string"&&v.iscelldata(a)&&(a=v.getcellrange(a));let u=Xl(a);if(u.length==0)return;let f=[];for(let m=0;m<u.length;m++){let d=[];for(let g=0;g<u[0].length;g++){let b="";u[m]!=null&&u[m][g]!=null&&(b=u[m][g],parseInt(b)!=null&&u[m][g].ct!=null&&u[m][g].ct.t=="n"&&(e=="minus"?b.v=b.v-n:e=="multiply"?b.v=b.v*n:e=="divided"?b.v=numFormat(b.v/n,4):e=="power"?b.v=Math.pow(b.v,n):e=="root"?n==2?b.v=numFormat(Math.sqrt(b.v),4):n==3&&Math.cbrt?b.v=numFormat(Math.cbrt(b.v),4):b.v=numFormat(jfnqrt(b.v,n),4):e=="log"?b.v=numFormat(Math.log(b.v)*1e4/Math.log(Math.abs(n)),4):b.v=b.v+n,b.v==null?b.m="":b.m=b.v.toString())),d.push(b)}f.push(d)}pt.controlHandler(f,a),s&&typeof s=="function"&&s()}function p5(e={}){let n=h.luckysheetfile.length-1,{sheetObject:t={},order:l=n,success:o}={...e};if(!Y(l))return de.info("Parameter is not a table index","");l=Number(l);let a=ct.generateRandomSheetIndex();t.calcChain&&t.calcChain.length>0&&t.calcChain.forEach(m=>{m.index=a});let s=ct.generateRandomSheetName(h.luckysheetfile,!1);if(t.name){let m=!1;for(let d=0;d<h.luckysheetfile.length;d++)if(h.luckysheetfile[d].name==t.name){m=!0;break}m||(s=t.name)}$("#luckysheet-sheet-container-c").append(yt(bi,{index:a,active:"",name:s,style:"",colorset:""}));let u={name:"",color:"",status:"0",order:"",index:"",celldata:[],row:h.defaultrowNum,column:h.defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!1};if(u=$.extend(!0,u,t),u.index=a,u.name=s,u.order=l,l<=0){let m=h.luckysheetfile[0].index,d=$("#luckysheet-sheets-item"+m);$("#luckysheet-sheets-item"+a).insertBefore(d),h.luckysheetfile.splice(0,0,u)}else{l>h.luckysheetfile.length&&(l=h.luckysheetfile.length);let m=h.luckysheetfile[l-1].index,d=$("#luckysheet-sheets-item"+m);$("#luckysheet-sheets-item"+a).insertAfter(d),h.luckysheetfile.splice(l,0,u)}let f={};if(h.luckysheetfile.forEach((m,d,g)=>{g[d].order=d,f[m.index.toString()]=d}),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+a+'" class="luckysheet-datavisual-selection-set"></div>'),Ir(!0),He.saveParam("sha",null,$.extend(!0,{},u)),He.saveParam("shr",null,f),h.clearjfundo){h.jfundo.length=0;let m={};m.type="addSheet",m.sheetconfig=$.extend(!0,{},u),m.index=a,m.currentSheetIndex=h.currentSheetIndex,h.jfredo.push(m)}return ct.changeSheetExec(a,!1,!0),o&&typeof o=="function"&&o(),u}function v5(e={}){let{order:n=$e(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?de.info("The order parameter is invalid.",""):h.luckysheetfile.length===1?de.info(Oe().sheetconfig.noMoreSheet,""):(ct.deleteSheet(l.index),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function y5(e={}){let{targetOrder:n,order:t=$e(h.currentSheetIndex),success:l}={...e},o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");if(n==null&&(n=t+1),!Y(n))return de.info("The targetOrder parameter is invalid.","");let a=o.index,s=ct.generateRandomSheetIndex(),u=$.extend(!0,{},o);u.order=h.luckysheetfile.length,u.index=s,u.name=ct.generateCopySheetName(h.luckysheetfile,u.name);let f="";u.color!=null&&(f='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+u.color+';"></div>');let m=$("#luckysheet-sheets-item"+a);if(Y(n)&&(m=$("#luckysheet-sheets-item"+h.luckysheetfile[n-1].index)),$("#luckysheet-sheet-container-c").append(yt(bi,{index:u.index,active:"",name:u.name,order:u.order,style:"",colorset:f})),$("#luckysheet-sheets-item"+u.index).insertAfter(m),h.luckysheetfile.splice(n,0,u),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+s).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+s+'" class="luckysheet-datavisual-selection-set"></div>'),Ir(!0),He.saveParam("shc",s,{copyindex:a,name:u.name}),ct.changeSheetExec(s),ct.reOrderAllSheet(),h.clearjfundo)h.jfredo.push({type:"copySheet",copyindex:a,index:u.index,sheetIndex:u.index});else if(h.jfredo.length>0){let d=h.jfredo[h.jfredo.length-1];d.type=="copySheet"&&(d.index=u.index,d.sheetIndex=u.index)}return setTimeout(()=>{l&&typeof l=="function"&&l()},1),u}function k5(e={}){let{order:n=$e(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?de.info("The order parameter is invalid.",""):(ct.setSheetHide(l.index),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function b5(e={}){let{order:n=$e(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?de.info("The order parameter is invalid.",""):(ct.setSheetShow(l.index),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function w5(e,n={}){if(e==null||!Y(e)||h.luckysheetfile[e]==null)return de.info("The order parameter is invalid.","");let t=h.luckysheetfile[e],{success:l}={...n};return $("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+t.index).addClass("luckysheet-sheets-item-active"),ct.changeSheet(t.index),setTimeout(()=>{l&&typeof l=="function"&&l()},1),He.multipleRangeShow(),t}function x5(e,n={}){if(V(e)!="string"||e.toString().length==0)return de.info("The name parameter is invalid.","");let{order:t=$e(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");let a=o.name;if(o.name=e,$("#luckysheet-sheets-item"+o.index+" .luckysheet-sheets-item-name").text(e),He.saveParam("all",o.index,e,{k:"name"}),h.clearjfundo){let s={};s.type="sheetName",s.sheetIndex=o.index,s.oldtxt=a,s.txt=e,h.jfundo.length=0,h.jfredo.push(s)}l&&typeof l=="function"&&l()}function _5(e,n={}){if(V(e)!="string"||e.toString().length==0)return de.info("The color parameter is invalid.","");let{order:t=$e(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");let a=o.color;if(o.color=e,$("#luckysheet-sheets-item"+o.index).find(".luckysheet-sheets-item-color").remove(),$("#luckysheet-sheets-item"+o.index).append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e+';"></div>'),He.saveParam("all",o.index,e,{k:"color"}),h.clearjfundo){let s={};s.type="sheetColor",s.sheetIndex=o.index,s.oldcolor=a,s.color=e,h.jfundo.length=0,h.jfredo.push(s)}l&&typeof l=="function"&&l()}function C5(e,n={}){if(e!="left"&&e!="right"&&!Y(e))return de.info("Type parameter not available","");Y(e)&&(e=parseInt(e));let t=$e(h.currentSheetIndex),{order:l=t,success:o}={...n},a=h.luckysheetfile[l];if(a==null)return de.info("ncorrect worksheet index","");let s=a.index;if(e=="left"){if(l==0)return;let f=h.luckysheetfile[l-1].index;$("#luckysheet-sheets-item"+s).insertBefore($("#luckysheet-sheets-item"+f)),h.luckysheetfile.splice(l,1),h.luckysheetfile.splice(l-1,0,a)}else if(e=="right"){if(l==h.luckysheetfile.length-1)return;let f=h.luckysheetfile[l+1].index;$("#luckysheet-sheets-item"+s).insertAfter($("#luckysheet-sheets-item"+f)),h.luckysheetfile.splice(l,1),h.luckysheetfile.splice(l+1,0,a)}else{if(e<0&&(e=0),e>h.luckysheetfile.length-1&&(e=h.luckysheetfile.length-1),e==l)return;if(e<l){let f=h.luckysheetfile[e].index;$("#luckysheet-sheets-item"+s).insertBefore($("#luckysheet-sheets-item"+f))}else{let f=h.luckysheetfile[e].index;$("#luckysheet-sheets-item"+s).insertAfter($("#luckysheet-sheets-item"+f))}h.luckysheetfile.splice(l,1),h.luckysheetfile.splice(e,0,a)}let u={};h.luckysheetfile.forEach((f,m,d)=>{d[m].order=m,u[f.index.toString()]=m}),He.saveParam("shr",null,u),o&&typeof o=="function"&&o()}function $5(e,n={}){if(e==null||e.length==0)return de.info("Type orderList not available","");let t={};e.forEach(a=>{t[a.index.toString()]=a.order}),h.luckysheetfile.sort((a,s)=>{let u=t[a.index.toString()],f=t[s.index.toString()];return u!=null&&f!=null?u-f:u!=null?-1:(f!=null,1)});let l={};h.luckysheetfile.forEach((a,s,u)=>{if(u[s].order=s,l[a.index.toString()]=s,s>0){let f=u[s-1].index;$("#luckysheet-sheets-item"+a.index).insertAfter($("#luckysheet-sheets-item"+f))}}),He.saveParam("shr",null,l);let{success:o}={...n};o&&typeof o=="function"&&o()}function S5(e,n={}){if(!Y(e)||e<.1||e>4)return de.info("The zoom parameter is invalid.","");let{order:t=$e(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");o.zoomRatio=e,He.saveParam("all",o.index,e,{k:"zoomRatio"}),o.index==h.currentSheetIndex&&(h.zoomRatio=e,Ii(),Ec()),l&&typeof l=="function"&&l()}function I5(e={}){let{order:n=$e(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?de.info("The order parameter is invalid.",""):(l.showGridLines=!0,l.index==h.currentSheetIndex&&(h.showGridLines=!0,setTimeout(function(){Et()},1)),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function T5(e={}){let{order:n=$e(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?de.info("The order parameter is invalid.",""):(l.showGridLines=!1,l.index==h.currentSheetIndex&&(h.showGridLines=!1,setTimeout(function(){Et()},1)),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function R5(e={}){Gt();let{success:n}={...e};n&&typeof n=="function"&&n()}function F5(e={}){let{scrollLeft:n,scrollTop:t,targetRow:l,targetColumn:o,success:a}={...e};if(n!=null){if(!Y(n))return de.info("The scrollLeft parameter is invalid.","");$("#luckysheet-scrollbar-x").scrollLeft(n)}else if(o!=null){if(!Y(o))return de.info("The targetColumn parameter is invalid.","");let s=h.visibledatacolumn[o],u=o<=0?0:h.visibledatacolumn[o-1];$("#luckysheet-scrollbar-x").scrollLeft(u)}if(t!=null){if(!Y(t))return de.info("The scrollTop parameter is invalid.","");$("#luckysheet-scrollbar-y").scrollTop(t)}else if(l!=null){if(!Y(l))return de.info("The targetRow parameter is invalid.","");let s=h.visibledatarow[l],u=l<=0?0:h.visibledatarow[l-1];$("#luckysheet-scrollbar-y").scrollTop(u)}a&&typeof a=="function"&&a()}function M5(e={}){Kl();let{success:n}={...e};n&&typeof n=="function"&&n()}function D5(e={}){let{range:n=h.luckysheet_select_save[h.luckysheet_select_save.length-1]}={...e};if(V(n)=="string"){if(!v.iscelldata(n))return de.info("The range parameter is invalid.","");let _=v.getcellrange(n);n={row:_.row,column:_.column}}if(V(n)!="object"||n.row==null||n.column==null)return de.info("The range parameter is invalid.","");let t=n.row[0],l=n.row[1],o=n.column[0],a=n.column[1];if(Ul(h.config,t,l,o,a))return de.info("Cannot perform this operation on partially merged cells","");let u=h.visibledatarow,f=h.visibledatacolumn,m,d;t-1<0?(m=0,d=u[l]):(m=u[t-1],d=u[l]-u[t-1]);let g,b;o-1<0?(g=0,b=f[a]):(g=f[o-1],b=f[a]-f[o-1]);let y=$("<canvas>").attr({width:Math.ceil(b*h.devicePixelRatio),height:Math.ceil(d*h.devicePixelRatio)}).css({width:b,height:d});$i(g,m,b,d,1,1,null,null,y);let p=y.get(0).getContext("2d");return p.beginPath(),p.moveTo(0,0),p.lineTo(0,h.devicePixelRatio*d),p.lineWidth=h.devicePixelRatio*2,p.strokeStyle=Tn.strokeStyle,p.stroke(),p.closePath(),p.beginPath(),p.moveTo(0,0),p.lineTo(h.devicePixelRatio*b,0),p.lineWidth=h.devicePixelRatio*2,p.strokeStyle=Tn.strokeStyle,p.stroke(),p.closePath(),y.get(0).toDataURL("image/png")}function A5(e,n={}){if(e==null||e.toString().length==0)return de.info("The name parameter is invalid.","");$("#luckysheet_info_detail_input").val(e);let{success:t}={...n};t&&typeof t=="function"&&t()}function z5(e={}){let n="",t=$("#luckysheet_info_detail_input");if(t.length==0)return de.info("Failed to get workbook name, label loading failed!"),n;n=$.trim(t.val());let{success:l}={...e};return setTimeout(()=>{l&&typeof l=="function"&&l()},1),n}function O5(e={}){let n=$.extend(!0,{},h.jfredo[h.jfredo.length-1]);Ia.redo(new Event("custom")),uo();let{success:t}={...e};return setTimeout(()=>{t&&typeof t=="function"&&t()},1),n}function P5(e={}){let n=$.extend(!0,{},h.jfundo[h.jfundo.length-1]);Ia.undo(new Event("custom")),uo();let{success:t}={...e};return setTimeout(()=>{t&&typeof t=="function"&&t()},1),n}function H1(){let e=$.extend(!0,[],h.luckysheetfile);return e.forEach((n,t,l)=>{n.data!=null&&n.data.length>0&&(n.celldata=ct.getGridData(n.data)),delete n.load,delete n.freezen}),e}function E5(e={}){let{index:n,order:t,name:l}={...e};return n!=null?ct.getSheetByIndex(n):t!=null?h.luckysheetfile[t]:l!=null?ct.getSheetByName(l):ct.getSheetByIndex()}function N5(e={}){let{order:n=$e(h.currentSheetIndex)}={...e},t=h.luckysheetfile[n];if(t==null)return de.info("The order parameter is invalid.","");let l=$.extend(!0,[],t.data);return(l==null||l.length==0)&&(l=$.extend(!0,[],ct.buildGridData(t))),l}function L5(e={}){let{order:n=$e(h.currentSheetIndex)}={...e},t=h.luckysheetfile[n];return t==null?de.info("The order parameter is invalid.",""):$.extend(!0,{},t.config)}function H5(e,n={}){if(V(e)!="object")return de.info("The cfg parameter is invalid.","");let{order:t=$e(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");o.config=e,o.index==h.currentSheetIndex&&(h.config=e,("rowhidden"in e||"colhidden"in e||"rowlen"in e||"columnlen"in e)&&Nl(h.flowdata.length,h.flowdata[0].length),setTimeout(function(){Et()},1)),l&&typeof l=="function"&&l()}function B5(){return Yl()}function j5(e,n={}){if(V(e)!="object")return de.info("The optionItem parameter is invalid.","");let{type:t,type2:l=null,value1:o="",value2:a="",remote:s=!1,prohibitInput:u=!1,hintShow:f=!1,hintText:m="",checked:d=!1}={...e},g=["dropdown","checkbox","number","number_integer","number_decimal","text_content","text_length","date","validity"],b=["bw","nb","eq","ne","gt","lt","gte","lte"],y=["include","exclude","equal"],p=["bw","nb","eq","ne","bf","nbf","af","naf"],x=["card","phone"];if(!g.includes(t))return de.info("The optionItem.type parameter is invalid.","");let _=Oe().dataVerification;if(t=="dropdown"){if(o.length==0){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo1);return}}else if(t=="checkbox"){if(o.length==0||a.length==0){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo2);return}}else if(t=="number"||t=="number_integer"||t=="number_decimal"){if(!b.includes(l))return de.info("The optionItem.type2 parameter is invalid.","");if(!Y(o)){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo3);return}if(l=="bw"||l=="nb"){if(!Y(a)){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo3);return}if(Number(a)<Number(o)){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo4);return}}}else if(t=="text_content"){if(!y.includes(l))return de.info("The optionItem.type2 parameter is invalid.","");if(o.length==0){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo5);return}}else if(t=="text_length"){if(!b.includes(l))return de.info("The optionItem.type2 parameter is invalid.","");if(!Y(o)){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo3);return}if(l=="bw"||l=="nb"){if(!Y(a)){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo3);return}if(Number(a)<Number(o)){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo4);return}}}else if(t=="date"){if(!p.includes(l))return de.info("The optionItem.type2 parameter is invalid.","");if(!Zl(o)){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo6);return}if(l=="bw"||l=="nb"){if(!Zl(a)){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo6);return}if(Br(o,a)>0){de.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo7);return}}}else if(t=="validity"&&!x.includes(l))return de.info("The optionItem.type2 parameter is invalid.","");if(V(s)!="boolean")return de.info("The optionItem.remote parameter is invalid.","");if(V(u)!="boolean")return de.info("The optionItem.prohibitInput parameter is invalid.","");if(V(f)!="boolean")return de.info("The optionItem.hintShow parameter is invalid.","");let{range:S=h.luckysheet_select_save[h.luckysheet_select_save.length-1],order:I=$e(h.currentSheetIndex),success:O}={...n};if(V(S)=="string"){if(!v.iscelldata(S))return de.info("The range parameter is invalid.","");let M=v.getcellrange(S);S={row:M.row,column:M.column}}if(V(S)!="object"||S.row==null||S.column==null)return de.info("The range parameter is invalid.","");let F=h.luckysheetfile[I];if(F==null)return de.info("The order parameter is invalid.","");let D={type:t,type2:l,value1:o,value2:a,checked:d,remote:s,prohibitInput:u,hintShow:f,hintText:m},k=$.extend(!0,{},F.dataVerification),w=$.extend(!0,[],F.data);w.length==0&&(w=ct.buildGridData(F));let C=S.row[0],T=S.row[1],z=S.column[0],A=S.column[1];for(let M=C;M<=T;M++)for(let P=z;P<=A;P++)k[M+"_"+P]=D,t=="checkbox"&&(D.checked?er(M,P,w,D.value1):er(M,P,w,D.value2));if(F.index==h.currentSheetIndex){let M=$.extend(!0,{},F.dataVerification);t=="checkbox"?Vt.refOfCheckbox(M,k,h.currentSheetIndex,w,S):Vt.ref(M,k,h.currentSheetIndex)}else F.dataVerification=k,F.data=w;O&&typeof O=="function"&&O()}function V5(e={}){let{range:n=h.luckysheet_select_save[h.luckysheet_select_save.length-1],order:t=$e(h.currentSheetIndex),success:l}={...e};if(V(n)=="string"){if(!v.iscelldata(n))return de.info("The range parameter is invalid.","");let d=v.getcellrange(n);n={row:d.row,column:d.column}}if(V(n)!="object"||n.row==null||n.column==null)return de.info("The range parameter is invalid.","");let o=h.luckysheetfile[t];if(o==null)return de.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.dataVerification),s=n.row[0],u=n.row[1],f=n.column[0],m=n.column[1];for(let d=s;d<=u;d++)for(let g=f;g<=m;g++)delete a[d+"_"+g];if(o.index==h.currentSheetIndex){let d=$.extend(!0,{},o.dataVerification);Vt.ref(d,a,h.currentSheetIndex)}else o.dataVerification=a;l&&typeof l=="function"&&l()}function W5(e,n={}){let{order:t=$e(h.currentSheetIndex),rowIndex:l,colIndex:o,success:a}={...n},s=h.luckysheetfile[t];if(s==null)return de.info("The order parameter is invalid.","");if(s.index==h.currentSheetIndex){let u=h.luckysheet_select_save[h.luckysheet_select_save.length-1];l==null&&(l=u.row_focus||0),l<0&&(l=0),l>h.visibledatarow.length&&(l=h.visibledatarow.length),o==null&&(o=u.column_focus||0),o<0&&(o=0),o>h.visibledatacolumn.length&&(o=h.visibledatacolumn.length);let f=o==0?0:h.visibledatacolumn[o-1],m=l==0?0:h.visibledatarow[l-1],d=new Image;d.onload=function(){let g=d.width,b=d.height,y={src:e,left:f,top:m,originWidth:g,originHeight:b};$t.addImgItem(y),a&&typeof a=="function"&&a()},d.src=e}else{let u=s.images||{},f=s.config,m=s.zoomRatio||1,d=s.row,g=s.visibledatarow||[];if(g.length===0){let S=0;for(let I=0;I<d;I++){let O=h.defaultrowlen;if(f.rowlen!=null&&f.rowlen[I]!=null&&(O=f.rowlen[I]),f.rowhidden!=null&&f.rowhidden[I]!=null){g.push(S);continue}S+=Math.round((O+1)*m),g.push(S)}}let b=s.column,y=s.visibledatacolumn||[];if(y.length===0){let S=0;for(let I=0;I<b;I++){let O=h.defaultcollen;if(f.columnlen!=null&&f.columnlen[I]!=null&&(O=f.columnlen[I]),f.colhidden!=null&&f.colhidden[I]!=null){y.push(S);continue}S+=Math.round((O+1)*m),y.push(S)}}l==null&&(l=0),l<0&&(l=0),l>g.length&&(l=g.length),o==null&&(o=0),o<0&&(o=0),o>y.length&&(o=y.length);let p=o==0?0:y[o-1],x=l==0?0:g[l-1],_=new Image;_.onload=function(){let S={src:e,left:p,top:x,originWidth:_.width,originHeight:_.height},I,O,F=400;S.originHeight<S.originWidth?(O=Math.round(S.originHeight*(F/S.originWidth)),I=F):(I=Math.round(S.originWidth*(F/S.originHeight)),O=F);let D=$.extend(!0,{},$t.imgItem);D.src=S.src,D.originWidth=S.originWidth,D.originHeight=S.originHeight,D.default.width=I,D.default.height=O,D.default.left=S.left,D.default.top=S.top,D.crop.width=I,D.crop.height=O;let k=$t.generateRandomId();u[k]=D,s.images=u,a&&typeof a=="function"&&a()},_.src=e}}function U5(e={}){let{order:n=$e(h.currentSheetIndex),idList:t="all",success:l}={...e},o=h.luckysheetfile[n];if(o==null)return de.info("The order parameter is invalid.","");let a=o.images;if(a==null)return de.info("The worksheet has no pictures to delete.","");if(t!="all"&&V(t)!="array")return de.info("The idList parameter is invalid.","");V(t)=="array"?t.forEach(s=>{delete a[s]}):a=null,o.images=a,o.index==h.currentSheetIndex&&($t.currentImgId!=null&&(t=="all"||t.includes($t.currentImgId))&&($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide()),$t.images=a,$t.allImagesShow(),$t.init()),l&&typeof l=="function"&&l()}function G5(e={}){let{order:n=$e(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?de.info("The order parameter is invalid.",""):(setTimeout(function(){t&&typeof t=="function"&&t()},1),l.images)}function Y5(e,n={}){let{success:t}={...n};return setTimeout(()=>{t&&typeof t=="function"&&t()},0),ct.getGridData(e)}function q5(e,n={}){let{success:t}={...n};return setTimeout(()=>{t&&typeof t=="function"&&t()},0),ct.buildGridData({celldata:e})}function Eh(){let e=h.toJsonOptions;return e.title=$("#luckysheet_info_detail_input").val(),e.data=H1(),Yl().forEach((n,t)=>{n.data!=null&&(e.data[t].row=V(n.data)==="array"?n.data.length:0,e.data[t].column=V(n.data[0])==="array"?n.data[0].length:0)}),e}function X5(e="zh"){if(!["zh","en","es"].includes(e))return de.info("The lang parameter is invalid.","");let n=Eh();n.lang=e,luckysheet.create(n)}function Z5(){He.websocket!=null&&He.websocket.close(1e3)}function K5(e){if(e==null)return{column:h.luckysheet_select_save[h.luckysheet_select_save.length-1].column,row:h.luckysheet_select_save[h.luckysheet_select_save.length-1].row};let n=xt.getRangeByTxt(e);return{column:n[0].column,row:n[0].row}}function J5(e=h.luckysheet_select_save){return V(e)==="object"&&(e=[e]),xt.getTxtByRange(e)}function Ig(e){let{prevPage:n,nextPage:t,total:l}=Oe().button;$("#luckysheet-bottom-pager").remove(),$("#luckysheet-sheet-content").after('<div id="luckysheet-bottom-pager" style="font-size: 14px; margin-left: 10px; display: inline-block;"></div>'),$("#luckysheet-bottom-pager").sPage({page:e.pageIndex,total:e.total,selectOption:e.selectOption,pageSize:e.pageSize,showTotal:e.showTotal,showSkip:e.showSkip,showPN:e.showPN,prevPage:e.prevPage||n,nextPage:e.nextPage||t,totalTxt:e.totalTxt||l+e.total,backFun:function(o){o.pageIndex=o.page,!!Yt.createHookFunction("onTogglePager",o)}})}function Q5(e){v.execFunctionGroupForce(!0),Et(),setTimeout(()=>{e&&typeof e=="function"&&e()})}function e_(e={}){let{data:n,success:t}=e,l=h.luckysheetfile;for(let s=0;s<n.length;s++)for(let u=0;u<l.length;u++)l[u].index===n[s].index&&(l[u]=n[s]);let o=l[ct.getSheetIndex(h.currentSheetIndex)],a=ct.buildGridData(o);o.data=a,o.isPivotTable?(h.luckysheetcurrentisPivotTable=!0,isPivotInitial||Pt.changePivotTable(index)):(h.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide(),Kl(!1)),ct.mergeCalculation(o.index),ct.setSheetParam(),setTimeout(function(){ct.showSheet(),ct.restoreCache(),v.execFunctionGroupForce(lt.forceCalculation),ct.restoreSheetAll(h.currentSheetIndex),Et(),t&&typeof t=="function"&&t()},1),He.saveParam("shs",null,h.currentSheetIndex)}function Tg(e,n,t,l){if(e=e||h.flowdata,n==null&&t==null){let o=h.luckysheet_select_save[h.luckysheet_select_save.length-1];n=o.row_focus||o.row[0],t=o.column_focus||o.column[0]}ht.menuButtonFocus(e,n,t),setTimeout(()=>{l&&typeof l=="function"&&l()})}function jc(e,n){return Sg().every(({r:o,c:a})=>{let s=h.flowdata[o][a];return s==null?!1:s[e]==n})}var import_plugin,Zu,Es=Tt(()=>{import_plugin=Le(Be());Ut();gl();ql();Rl();qn();ir();Vu();Sr();Sc();br();ir();Io();Hn();io();Rs();Hi();mr();fr();Ms();Gl();Co();Tc();vh();Qo();wr();Mr();Ac();bn();li();Bi();Yr();ji();xo();vr();ar();wa();$h();Nc();Vi();To();Zu=Le(ka());ql();Ns()});function _1(e,n,t,l,o){let a=h.visibledatarow[t],s=n-1==-1?0:h.visibledatarow[n-1],u=h.visibledatacolumn[o],f=l-1==-1?0:h.visibledatacolumn[l-1];$("#"+e).css({left:f,width:u-f-1,top:s,height:a-s-1})}function Zt(e=!1){if($("#luckysheet-cell-selected-boxs").show(),$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").siblings(".luckysheet-cell-selected").remove(),h.luckysheet_select_save.length>0){for(let t=0;t<h.luckysheet_select_save.length;t++){let l=h.luckysheet_select_save[t].row[0],o=h.luckysheet_select_save[t].row[1],a=h.luckysheet_select_save[t].column[0],s=h.luckysheet_select_save[t].column[1],u,f;h.luckysheet_select_save[t].row_focus==null?u=l:u=h.luckysheet_select_save[t].row_focus,h.luckysheet_select_save[t].column_focus==null?f=a:f=h.luckysheet_select_save[t].column_focus;let m=h.visibledatarow[o],d=l-1==-1?0:h.visibledatarow[l-1],g=h.visibledatacolumn[s],b=a-1==-1?0:h.visibledatacolumn[a-1],y=h.visibledatarow[u],p=u-1==-1?0:h.visibledatarow[u-1],x=h.visibledatacolumn[f],_=f-1==-1?0:h.visibledatacolumn[f-1],S=ht.mergeborer(h.flowdata,u,f);S&&(y=S.row[1],p=S.row[0],x=S.column[1],_=S.column[0]),h.luckysheet_select_save[t].row=[l,o],h.luckysheet_select_save[t].column=[a,s],h.luckysheet_select_save[t].row_focus=u,h.luckysheet_select_save[t].column_focus=f,h.luckysheet_select_save[t].left=_,h.luckysheet_select_save[t].width=x-_-1,h.luckysheet_select_save[t].top=p,h.luckysheet_select_save[t].height=y-p-1,h.luckysheet_select_save[t].left_move=b,h.luckysheet_select_save[t].width_move=g-b-1,h.luckysheet_select_save[t].top_move=d,h.luckysheet_select_save[t].height_move=m-d-1,t==0?h.luckysheet_select_save.length==1?Ni.mobilecheck()?$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:h.luckysheet_select_save[t].left_move,width:h.luckysheet_select_save[t].width_move,top:h.luckysheet_select_save[t].top_move,height:h.luckysheet_select_save[t].height_move,display:"block",border:"1px solid #0188fb"}).find(".luckysheet-cs-draghandle").css("display","block").end().find(".luckysheet-cs-fillhandle").css("display","none").end().find(".luckysheet-cs-touchhandle").css("display","block"):$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:h.luckysheet_select_save[t].left_move,width:h.luckysheet_select_save[t].width_move,top:h.luckysheet_select_save[t].top_move,height:h.luckysheet_select_save[t].height_move,display:"block",border:"1px solid #0188fb"}).find(".luckysheet-cs-draghandle").css("display","block").end().find(".luckysheet-cs-fillhandle").css("display","block").end().find(".luckysheet-cs-touchhandle").css("display","none"):$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:h.luckysheet_select_save[t].left_move,width:h.luckysheet_select_save[t].width_move,top:h.luckysheet_select_save[t].top_move,height:h.luckysheet_select_save[t].height_move,display:"block",border:"1px solid rgba(1, 136, 251, 0.15)"}).find(".luckysheet-cs-draghandle").css("display","none").end().find(".luckysheet-cs-fillhandle").css("display","none"):$("#luckysheet-cell-selected-boxs").append('<div class="luckysheet-cell-selected" style="left: '+h.luckysheet_select_save[t].left_move+"px; width: "+h.luckysheet_select_save[t].width_move+"px; top: "+h.luckysheet_select_save[t].top_move+"px; height: "+h.luckysheet_select_save[t].height_move+'px; border: 1px solid rgba(1, 136, 251, 0.15); display: block;"></div>'),t==h.luckysheet_select_save.length-1&&($("#luckysheet-cell-selected-focus").css({left:h.luckysheet_select_save[t].left,width:h.luckysheet_select_save[t].width,top:h.luckysheet_select_save[t].top,height:h.luckysheet_select_save[t].height,display:"block"}),Ti(h.luckysheet_select_save[t].left_move,h.luckysheet_select_save[t].top_move,h.luckysheet_select_save[t].width_move,h.luckysheet_select_save[t].height_move,[l,o],[a,s]),v.fucntionboxshow(u,f),Vt.cellFocus(u,f))}t_(h.luckysheet_select_save,e),Nh(),h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]&&hy(h.luckysheet_select_save[0].row[0],h.luckysheet_select_save[0].column[0]),Tg()}h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_select_save=h.luckysheet_select_save;let n=JSON.stringify(h.luckysheet_select_save);h.luckysheet_select_save_previous==null|h.luckysheet_select_save_previous!==n&&Yt.createHookFunction("rangeSelect",h.luckysheetfile[$e(h.currentSheetIndex)],h.luckysheet_select_save),h.luckysheet_select_save_previous=n}function t_(e,n=!1){let t=$.extend(!0,[],e),l={},o={};for(let u=0;u<t.length;u++){let f=t[u].row[0],m=t[u].row[1],d=t[u].column[0],g=t[u].column[1];l=B1(l,f,m),o=B1(o,d,g)}$("#luckysheet-rows-h-selected").empty();let a=j1(l);for(let u=0;u<a.length;u++){let f=a[u][0],m=a[u][a[u].length-1],d=$r(m)[1],g=$r(f)[0];$("#luckysheet-rows-h-selected").append('<div class="luckysheet-rows-h-selected" style="top: '+g+"px; height: "+(d-g-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}$("#luckysheet-cols-h-selected").empty();let s=j1(o);for(let u=0;u<s.length;u++){let f=s[u][0],m=s[u][s[u].length-1],d=Vl(m)[1],g=Vl(f)[0];$("#luckysheet-cols-h-selected").append('<div class="luckysheet-cols-h-selected" style="left: '+g+"px; width: "+(d-g-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}}function B1(e,n,t){let l=$.extend(!0,{},e);for(let o=n;o<=t;o++)o in l||(l[o]=0);return l}function j1(e){let n=[];for(let o in e)n.push(o);n.sort(function(o,a){return o-a});let t=[],l=[];if(n.length>1)for(let o=1;o<n.length;o++)n[o]-n[o-1]==1?(l.push(n[o-1]),o==n.length-1&&(l.push(n[o]),t.push(l))):o==1?o==n.length-1?(l.push(n[o-1]),t.push(l),t.push([n[o]])):t.push(n[0]):o==n.length-1?(l.push(n[o-1]),t.push(l),t.push([n[o]])):(l.push(n[o-1]),t.push(l),l=[]);else t.push([n[0]]);return t}function Ao(e){e==null&&(e=h.luckysheet_select_save),e=JSON.parse(JSON.stringify(e));let n=!1,t={};for(let l=0;l<e.length;l++){let o=e[l].row[0],a=e[l].row[1],s=e[l].column[0],u=e[l].column[1];for(let f=o;f<=a;f++)for(let m=s;m<=u;m++)if(f+"_"+m in t){n=!0;break}else t[f+"_"+m]=0}return n}function Qa(){let e=h.visibledatacolumn,n=h.visibledatarow;h.cooperativeEdit.changeCollaborationSize.forEach(t=>{if(t.i==h.currentSheetIndex){let l=t.v.column,o=e[l[0]]-1;t.v.column[0]!==0&&(o=e[l[1]]-e[l[0]-1]-(l[1]-l[0]+1));let a=t.v.row,s=n[a[0]]-1;t.v.row[0]!==0&&(s=n[a[1]]-n[a[0]-1]-(a[1]-a[0]+1));let u=h.cooperativeEdit.merge_range,f=e[t.v.column[0]-1]-1,m=n[t.v.row[0]-1]-1;if(h.config.columnlen!==null){for(let y in h.config.columnlen)if(t.v.column[0]<=y&&y<=t.v.column[1]){h.luckysheet_cols_change_size_start[1]=y-0;break}}if(h.config.rowlen!==null){for(let y in h.config.rowlen)if(t.v.row[0]<=y&&y<=t.v.row[1]){h.luckysheet_rows_change_size_start[1]=y-0;break}}if(t.v.column[0]<=h.luckysheet_cols_change_size_start[1]&&h.luckysheet_cols_change_size_start[1]<=t.v.column[1])if(h.luckysheet_cols_change_size_start[1]==0)o=e[0]-1;else{let y=t.v.column;o=e[y[1]]-e[y[0]-1]-(y[1]-y[0]+1)}if(t.v.row[0]<=h.luckysheet_rows_change_size_start[1]&&h.luckysheet_rows_change_size_start[1]<=t.v.row[1])if(h.luckysheet_rows_change_size_start[1]==0)s=n[0]-1;else{let y=t.v.row;s=n[y[1]]-n[y[0]-1]-(y[1]-y[0]+1)}if(Object.keys(u).length>0){let y=!1;if(u.v.length>1&&(y=u.v[1][0]==null||Object.keys(u.v[1][0]).length>0),u.v[0].length>1&&(y=u.v[0][1]==null||Object.keys(u.v[0][1]).length>0),y){let p=u.column[0]<=t.v.column[0]&&u.column[1]>=t.v.column[1];if(f=e[u.column[0]-1]-1,m=n[u.row[0]-1]-1,o=e[u.column[1]]-1,s=n[u.row[1]]-1,p){if(u.column[0]!==0){let _=u.column;o=e[_[1]]-e[_[0]-1]-(_[1]-_[0]+1)}else f=0;t.v.column=u.column}if(u.row[0]<=t.v.row[0]&&u.row[1]>=t.v.row[1]){if(u.row[0]!==0){let _=u.row;s=n[_[1]]-n[_[0]-1]-(_[1]-_[0]+1)}else m=0;t.v.row=u.row}}else o=e[l[0]]-e[l[0]-1]-1,l[0]===0&&(o=e[l[0]]-1),s=n[a[0]]-n[a[0]-1]-1,a[0]===0&&(s=n[a[0]]-1)}$("#luckysheet-multipleRange-show-"+t.id).css({height:s,width:o,top:m+"px",left:f+"px"});let b=$("#luckysheet-multipleRange-show-"+t.id)[0].offsetHeight-1;$("#luckysheet-multipleRange-show-"+t.id+">.username").css({bottom:b+"px"})}})}function Jl(e){if($("#luckysheet-selection-copy").empty(),e==null&&(e=h.luckysheet_selection_range),e=JSON.parse(JSON.stringify(e)),e.length>0)for(let n=0;n<e.length;n++){let t=e[n].row[0],l=e[n].row[1],o=e[n].column[0],a=e[n].column[1],s=h.visibledatarow[l],u=t-1==-1?0:h.visibledatarow[t-1],f=h.visibledatacolumn[a],m=o-1==-1?0:h.visibledatacolumn[o-1],d='<div class="luckysheet-selection-copy" style="display: block; left: '+m+"px; width: "+(f-m-1)+"px; top: "+u+"px; height: "+(s-u-1)+'px;"><div class="luckysheet-selection-copy-top luckysheet-copy"></div><div class="luckysheet-selection-copy-right luckysheet-copy"></div><div class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div></div>';$("#luckysheet-selection-copy").append(d)}}function Ti(e,n,t,l,o,a){let s=o[1]-o[0]+1,u=a[1]-a[0]+1,f=h.luckysheetTableContentHW[0],m=h.luckysheetTableContentHW[1],d=$("#luckysheet-cell-main").scrollLeft(),g=$("#luckysheet-cell-main").scrollTop(),y=Oe().info;if(s>=4){let p=e-25;p<0&&(p=e+5),p<d&&(p=d+10);let x=n+l/2;l>m&&(x=g+m/2),$("#luckysheet-row-count-show").css({left:p,top:x,display:"block",width:"11px"}).html("<div>"+s.toString().split("").join("</div><div>")+"</div><div>"+y.row+"</div>")}else $("#luckysheet-row-count-show").hide();if(u>=4){let p=n-25;p<0&&(p=n+5),p<g&&(p=g+10);let x=e+t/2;t>f&&(x=d+f/2),$("#luckysheet-column-count-show").css({left:x,top:p,display:"block"}).text(u+y.column)}else $("#luckysheet-column-count-show").hide()}function Nh(){let e=h.luckysheet_select_save[h.luckysheet_select_save.length-1],n=e.row_focus,t=e.column_focus;h.config.merge!=null&&n+"_"+t in h.config.merge?$("#luckysheet-helpbox-cell").text(Al(h.currentSheetIndex,{column:[t,t],row:[n,n]})):$("#luckysheet-helpbox-cell").text(Al(h.currentSheetIndex,e))}var import_plugin,vr=Tt(()=>{import_plugin=Le(Be());Mr();ir();oh();Qn();sc();Vi();ql();Ut();qn();Rl();Es()});var import_plugin,l_,Fg,V1=Tt(()=>{import_plugin=Le(Be());gl();ar();Mr();br();Sr();Gl();Ut();Rl();l_={moneyFmtList:[{name:"\u4EBA\u6C11\u5E01",pos:"before",value:"\xA5"},{name:"\u7F8E\u5143",pos:"before",value:"$"},{name:"\u6B27\u5143",pos:"before",value:"\u20AC"},{name:"\u82F1\u9551",pos:"before",value:"\uFFE1"},{name:"\u6E2F\u5143",pos:"before",value:"$"},{name:"\u65E5\u5143",pos:"before",value:"\uFFE5"},{name:"\u963F\u5C14\u5DF4\u5C3C\u4E9A\u5217\u514B",pos:"before",value:"Lek"},{name:"\u963F\u5C14\u53CA\u5229\u4E9A\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u963F\u5BCC\u6C57\u5C3C",pos:"after",value:"Af"},{name:"\u963F\u6839\u5EF7\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u963F\u62C9\u4F2F\u8054\u5408\u914B\u957F\u56FD\u8FEA\u62C9\u59C6",pos:"before",value:"dh"},{name:"\u963F\u9C81\u5DF4\u5F17\u7F57\u6797",pos:"before",value:"Afl"},{name:"\u963F\u66FC\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u963F\u585E\u62DC\u7586\u9A6C\u7EB3\u7279",pos:"before",value:"?"},{name:"\u57C3\u53CA\u9551",pos:"before",value:"\uFFE1"},{name:"\u57C3\u585E\u4FC4\u6BD4\u4E9A\u6BD4\u5C14",pos:"before",value:"Birr"},{name:"\u5B89\u54E5\u62C9\u5BBD\u624E",pos:"before",value:"Kz"},{name:"\u6FB3\u5927\u5229\u4E9A\u5143",pos:"before",value:"$"},{name:"\u6FB3\u95E8\u5143",pos:"before",value:"MOP"},{name:"\u5DF4\u5DF4\u591A\u65AF\u5143",pos:"before",value:"$"},{name:"\u5DF4\u5E03\u4E9A\u65B0\u51E0\u5185\u4E9A\u57FA\u90A3",pos:"before",value:"PGK"},{name:"\u5DF4\u54C8\u9A6C\u5143",pos:"before",value:"$"},{name:"\u5DF4\u57FA\u65AF\u5766\u5362\u6BD4",pos:"before",value:"Rs"},{name:"\u5DF4\u62C9\u572D\u74DC\u62C9\u5C3C",pos:"after",value:"Gs"},{name:"\u5DF4\u6797\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u5DF4\u62FF\u9A6C\u5DF4\u6CE2\u4E9A",pos:"before",value:"B/"},{name:"\u5DF4\u897F\u91CC\u4E9A\u4F0A",pos:"before",value:"R$"},{name:"\u767D\u4FC4\u7F57\u65AF\u5362\u5E03",pos:"after",value:"\u0440"},{name:"\u767E\u6155\u5927\u5143",pos:"before",value:"$"},{name:"\u4FDD\u52A0\u5229\u4E9A\u5217\u5F17",pos:"before",value:"lev"},{name:"\u51B0\u5C9B\u514B\u6717",pos:"before",value:"kr"},{name:"\u6CE2\u9ED1\u53EF\u5151\u6362\u9A6C\u514B",pos:"before",value:"KM"},{name:"\u6CE2\u5170\u5179\u7F57\u63D0",pos:"after",value:"z?"},{name:"\u73BB\u5229\u7EF4\u4E9A\u8BFA",pos:"before",value:"Bs"},{name:"\u4F2F\u5229\u5179\u5143",pos:"before",value:"$"},{name:"\u535A\u8328\u74E6\u7EB3\u666E\u62C9",pos:"before",value:"P"},{name:"\u4E0D\u4E39\u52AA\u624E\u59C6",pos:"before",value:"Nu"},{name:"\u5E03\u9686\u8FEA\u6CD5\u90CE",pos:"before",value:"FBu"},{name:"\u671D\u9C9C\u5706",pos:"before",value:"?KP"},{name:"\u4E39\u9EA6\u514B\u6717",pos:"after",value:"kr"},{name:"\u4E1C\u52A0\u52D2\u6BD4\u5143",pos:"before",value:"$"},{name:"\u591A\u7C73\u5C3C\u52A0\u6BD4\u7D22",pos:"before",value:"RD$"},{name:"\u4FC4\u56FD\u5362\u5E03",pos:"after",value:"?"},{name:"\u5384\u7ACB\u7279\u91CC\u4E9A\u7EB3\u514B\u6CD5",pos:"before",value:"Nfk"},{name:"\u975E\u6D32\u91D1\u878D\u5171\u540C\u4F53\u6CD5\u90CE",pos:"before",value:"CFA"},{name:"\u83F2\u5F8B\u5BBE\u6BD4\u7D22",pos:"before",value:"?"},{name:"\u6590\u6D4E\u5143",pos:"before",value:"$"},{name:"\u4F5B\u5F97\u89D2\u57C3\u65AF\u5E93\u591A",pos:"before",value:"CVE"},{name:"\u798F\u514B\u5170\u7FA4\u5C9B\u9551",pos:"before",value:"\uFFE1"},{name:"\u5188\u6BD4\u4E9A\u8FBE\u62C9\u897F",pos:"before",value:"GMD"},{name:"\u521A\u679C\u6CD5\u90CE",pos:"before",value:"FrCD"},{name:"\u54E5\u4F26\u6BD4\u4E9A\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u54E5\u65AF\u8FBE\u9ECE\u52A0\u79D1\u6717",pos:"before",value:"?"},{name:"\u53E4\u5DF4\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u53E4\u5DF4\u53EF\u5151\u6362\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u572D\u4E9A\u90A3\u5143",pos:"before",value:"$"},{name:"\u54C8\u8428\u514B\u65AF\u5766\u575A\u6208",pos:"before",value:"?"},{name:"\u6D77\u5730\u53E4\u5FB7",pos:"before",value:"HTG"},{name:"\u97E9\u5143",pos:"before",value:"?"},{name:"\u8377\u5C5E\u5B89\u7684\u5217\u65AF\u76FE",pos:"before",value:"NAf."},{name:"\u6D2A\u90FD\u62C9\u65AF\u62C9\u4F26\u76AE\u62C9",pos:"before",value:"L"},{name:"\u5409\u5E03\u63D0\u6CD5\u90CE",pos:"before",value:"Fdj"},{name:"\u5409\u5C14\u5409\u65AF\u65AF\u5766\u7D22\u59C6",pos:"before",value:"KGS"},{name:"\u51E0\u5185\u4E9A\u6CD5\u90CE",pos:"before",value:"FG"},{name:"\u52A0\u62FF\u5927\u5143",pos:"before",value:"$"},{name:"\u52A0\u7EB3\u585E\u5730",pos:"before",value:"GHS"},{name:"\u67EC\u57D4\u5BE8\u745E\u5C14",pos:"before",value:"Riel"},{name:"\u6377\u514B\u514B\u6717",pos:"after",value:"K?"},{name:"\u6D25\u5DF4\u5E03\u97E6\u5143",pos:"before",value:"$"},{name:"\u5361\u5854\u5C14\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u5F00\u66FC\u7FA4\u5C9B\u5143",pos:"before",value:"$"},{name:"\u79D1\u6469\u7F57\u6CD5\u90CE",pos:"before",value:"CF"},{name:"\u79D1\u5A01\u7279\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u514B\u7F57\u5730\u4E9A\u5E93\u7EB3",pos:"before",value:"kn"},{name:"\u80AF\u5C3C\u4E9A\u5148\u4EE4",pos:"before",value:"Ksh"},{name:"\u83B1\u7D22\u6258\u6D1B\u8482",pos:"before",value:"LSL"},{name:"\u8001\u631D\u57FA\u666E",pos:"before",value:"?"},{name:"\u9ECE\u5DF4\u5AE9\u9551",pos:"before",value:"L\uFFE1"},{name:"\u7ACB\u9676\u5B9B\u7ACB\u7279",pos:"before",value:"Lt"},{name:"\u5229\u6BD4\u4E9A\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u5229\u6BD4\u4E9A\u5143",pos:"before",value:"$"},{name:"\u5362\u65FA\u8FBE\u6CD5\u90CE",pos:"before",value:"RF"},{name:"\u7F57\u9A6C\u5C3C\u4E9A\u5217\u4F0A",pos:"before",value:"RON"},{name:"\u9A6C\u8FBE\u52A0\u65AF\u52A0\u963F\u91CC\u4E9A\u91CC",pos:"before",value:"Ar"},{name:"\u9A6C\u5C14\u4EE3\u592B\u62C9\u83F2\u4E9A",pos:"before",value:"Rf"},{name:"\u9A6C\u62C9\u7EF4\u514B\u74E6\u67E5",pos:"before",value:"MWK"},{name:"\u9A6C\u6765\u897F\u4E9A\u6797\u5409\u7279",pos:"before",value:"RM"},{name:"\u9A6C\u5176\u987F\u6234\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u6BDB\u91CC\u6C42\u65AF\u5362\u6BD4",pos:"before",value:"MURs"},{name:"\u6BDB\u91CC\u5854\u5C3C\u4E9A\u4E4C\u5409\u4E9A",pos:"before",value:"MRO"},{name:"\u8499\u53E4\u56FE\u683C\u91CC\u514B",pos:"before",value:"?"},{name:"\u5B5F\u52A0\u62C9\u5854\u5361",pos:"before",value:"?"},{name:"\u79D8\u9C81\u65B0\u7D22\u5C14",pos:"before",value:"S/"},{name:"\u7F05\u7538\u5F00\u4E9A\u7279",pos:"before",value:"K"},{name:"\u6469\u5C14\u591A\u74E6\u5217\u4F0A",pos:"before",value:"MDL"},{name:"\u6469\u6D1B\u54E5\u8FEA\u62C9\u59C6",pos:"before",value:"dh"},{name:"\u83AB\u6851\u6BD4\u514B\u6885\u8482\u5361\u5C14",pos:"before",value:"MTn"},{name:"\u58A8\u897F\u54E5\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u7EB3\u7C73\u6BD4\u4E9A\u5143",pos:"before",value:"$"},{name:"\u5357\u975E\u5170\u7279",pos:"before",value:"R"},{name:"\u5357\u82CF\u4E39\u9551",pos:"before",value:"\uFFE1"},{name:"\u5C3C\u52A0\u62C9\u74DC\u79D1\u591A\u5DF4",pos:"before",value:"C$"},{name:"\u5C3C\u6CCA\u5C14\u5362\u6BD4",pos:"before",value:"Rs"},{name:"\u5C3C\u65E5\u5229\u4E9A\u5948\u62C9",pos:"before",value:"?"},{name:"\u632A\u5A01\u514B\u6717",pos:"after",value:"kr"},{name:"\u4E54\u6CBB\u4E9A\u62C9\u745E",pos:"before",value:"GEL"},{name:"\u4EBA\u6C11\u5E01\uFF08\u79BB\u5CB8\uFF09",pos:"before",value:"\uFFE5"},{name:"\u745E\u5178\u514B\u6717",pos:"after",value:"kr"},{name:"\u745E\u58EB\u6CD5\u90CE",pos:"before",value:"CHF"},{name:"\u585E\u5C14\u7EF4\u4E9A\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u585E\u62C9\u5229\u6602\u5229\u6602",pos:"before",value:"SLL"},{name:"\u585E\u820C\u5C14\u5362\u6BD4",pos:"before",value:"SCR"},{name:"\u6C99\u7279\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u5723\u591A\u7F8E\u591A\u5E03\u62C9",pos:"before",value:"Db"},{name:"\u5723\u8D6B\u52D2\u62FF\u7FA4\u5C9B\u78C5",pos:"before",value:"\uFFE1"},{name:"\u65AF\u91CC\u5170\u5361\u5362\u6BD4",pos:"before",value:"Rs"},{name:"\u65AF\u5A01\u58EB\u5170\u91CC\u5170\u5409\u5C3C",pos:"before",value:"SZL"},{name:"\u82CF\u4E39\u9551",pos:"before",value:"SDG"},{name:"\u82CF\u91CC\u5357\u5143",pos:"before",value:"$"},{name:"\u6240\u7F57\u95E8\u7FA4\u5C9B\u5143",pos:"before",value:"$"},{name:"\u7D22\u9A6C\u91CC\u5148\u4EE4",pos:"before",value:"SOS"},{name:"\u5854\u5409\u514B\u65AF\u5766\u7D22\u83AB\u5C3C",pos:"before",value:"Som"},{name:"\u592A\u5E73\u6D0B\u6CD5\u90CE",pos:"after",value:"FCFP"},{name:"\u6CF0\u56FD\u94E2",pos:"before",value:"?"},{name:"\u5766\u6851\u5C3C\u4E9A\u5148\u4EE4",pos:"before",value:"TSh"},{name:"\u6C64\u52A0\u6F58\u52A0",pos:"before",value:"T$"},{name:"\u7279\u7ACB\u5C3C\u8FBE\u548C\u591A\u5DF4\u54E5\u5143",pos:"before",value:"$"},{name:"\u7A81\u5C3C\u65AF\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u571F\u8033\u5176\u91CC\u62C9",pos:"before",value:"?"},{name:"\u74E6\u52AA\u963F\u56FE\u74E6\u56FE",pos:"before",value:"VUV"},{name:"\u5371\u5730\u9A6C\u62C9\u683C\u67E5\u5C14",pos:"before",value:"Q"},{name:"\u59D4\u5185\u745E\u62C9\u535A\u5229\u74E6",pos:"before",value:"Bs"},{name:"\u6587\u83B1\u5143",pos:"before",value:"$"},{name:"\u4E4C\u5E72\u8FBE\u5148\u4EE4",pos:"before",value:"UGX"},{name:"\u4E4C\u514B\u5170\u683C\u91CC\u592B\u5C3C\u4E9A",pos:"before",value:"\u0433\u0440\u043D."},{name:"\u4E4C\u62C9\u572D\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u4E4C\u5179\u522B\u514B\u65AF\u5766\u82CF\u59C6",pos:"before",value:"so?m"},{name:"\u897F\u8428\u6469\u4E9A\u5854\u62C9",pos:"before",value:"WST"},{name:"\u65B0\u52A0\u5761\u5143",pos:"before",value:"$"},{name:"\u65B0\u53F0\u5E01",pos:"before",value:"NT$"},{name:"\u65B0\u897F\u5170\u5143",pos:"before",value:"$"},{name:"\u5308\u7259\u5229\u798F\u6797",pos:"before",value:"Ft"},{name:"\u53D9\u5229\u4E9A\u9551",pos:"before",value:"\uFFE1"},{name:"\u7259\u4E70\u52A0\u5143",pos:"before",value:"$"},{name:"\u4E9A\u7F8E\u5C3C\u4E9A\u5FB7\u62C9\u59C6",pos:"before",value:"Dram"},{name:"\u4E5F\u95E8\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u4F0A\u62C9\u514B\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u4F0A\u6717\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u4EE5\u8272\u5217\u65B0\u8C22\u514B\u5C14",pos:"before",value:"?"},{name:"\u5370\u5EA6\u5362\u6BD4",pos:"before",value:"?"},{name:"\u5370\u5EA6\u5C3C\u897F\u4E9A\u5362\u6BD4",pos:"before",value:"Rp"},{name:"\u7EA6\u65E6\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u8D8A\u5357\u76FE",pos:"after",value:"?"},{name:"\u8D5E\u6BD4\u4E9A\u514B\u74E6\u67E5",pos:"before",value:"ZMW"},{name:"\u76F4\u5E03\u7F57\u9640\u9551",pos:"before",value:"\uFFE1"},{name:"\u667A\u5229\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u4E2D\u975E\u91D1\u878D\u5408\u4F5C\u6CD5\u90CE",pos:"before",value:"FCFA"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"1930\u5E748\u67085\u65E5",value:'yyyy"\u5E74"M"\u6708"d"\u65E5"'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"8\u67085\u65E5",value:'M"\u6708"d"\u65E5"'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"\u4E0B\u534801:30",value:"\u4E0A\u5348/\u4E0B\u5348 hh:mm"},{name:"\u4E0B\u53481:30",value:"\u4E0A\u5348/\u4E0B\u5348 h:mm"},{name:"\u4E0B\u53481:30:30",value:"\u4E0A\u5348/\u4E0B\u5348 h:mm:ss"},{name:"08-05 \u4E0B\u534801:30",value:"MM-dd \u4E0A\u5348/\u4E0B\u5348 hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],createDialog:function(e){let n=this,t=Oe().currencyDetail,l=Oe().format,o=Oe().button;this.moneyFmtList=[{name:t.RMB,pos:"before",value:"\xA5"},{name:t.USdollar,pos:"before",value:"$"},{name:t.EUR,pos:"before",value:"\u20AC"},{name:t.GBP,pos:"before",value:"\uFFE1"},{name:t.HK,pos:"before",value:"$"},{name:t.JPY,pos:"before",value:"\uFFE5"},{name:t.AlbanianLek,pos:"before",value:"Lek"},{name:t.AlgerianDinar,pos:"before",value:"din"},{name:t.Afghani,pos:"after",value:"Af"},{name:t.ArgentinePeso,pos:"before",value:"$"},{name:t.UnitedArabEmiratesDirham,pos:"before",value:"dh"},{name:t.ArubanFlorin,pos:"before",value:"Afl"},{name:t.OmaniRial,pos:"before",value:"Rial"},{name:t.Azerbaijanimanat,pos:"before",value:"?"},{name:t.EgyptianPound,pos:"before",value:"\uFFE1"},{name:t.EthiopianBirr,pos:"before",value:"Birr"},{name:t.AngolaKwanza,pos:"before",value:"Kz"},{name:t.AustralianDollar,pos:"before",value:"$"},{name:t.Patacas,pos:"before",value:"MOP"},{name:t.BarbadosDollar,pos:"before",value:"$"},{name:t.PapuaNewGuineaKina,pos:"before",value:"PGK"},{name:t.BahamianDollar,pos:"before",value:"$"},{name:t.PakistanRupee,pos:"before",value:"Rs"},{name:t.ParaguayanGuarani,pos:"after",value:"Gs"},{name:t.BahrainiDinar,pos:"before",value:"din"},{name:t.PanamanianBalboa,pos:"before",value:"B/"},{name:t.Brazilianreal,pos:"before",value:"R$"},{name:t.Belarusianruble,pos:"after",value:"\u0440"},{name:t.BermudianDollar,pos:"before",value:"$"},{name:t.BulgarianLev,pos:"before",value:"lev"},{name:t.IcelandKrona,pos:"before",value:"kr"},{name:t.BosniaHerzegovinaConvertibleMark,pos:"before",value:"KM"},{name:t.PolishZloty,pos:"after",value:"z?"},{name:t.Boliviano,pos:"before",value:"Bs"},{name:t.BelizeDollar,pos:"before",value:"$"},{name:t.BotswanaPula,pos:"before",value:"P"},{name:t.NotDannuzhamu,pos:"before",value:"Nu"},{name:t.BurundiFranc,pos:"before",value:"FBu"},{name:t.NorthKoreanWon,pos:"before",value:"?KP"},{name:t.DanishKrone,pos:"after",value:"kr"},{name:t.EastCaribbeanDollar,pos:"before",value:"$"},{name:t.DominicaPeso,pos:"before",value:"RD$"},{name:t.RussianRuble,pos:"after",value:"?"},{name:t.EritreanNakfa,pos:"before",value:"Nfk"},{name:t.CFAfranc,pos:"before",value:"CFA"},{name:t.PhilippinePeso,pos:"before",value:"?"},{name:t.FijiDollar,pos:"before",value:"$"},{name:t.CapeVerdeEscudo,pos:"before",value:"CVE"},{name:t.FalklandIslandsPound,pos:"before",value:"\uFFE1"},{name:t.GambianDalasi,pos:"before",value:"GMD"},{name:t.Congolesefranc,pos:"before",value:"FrCD"},{name:t.ColombianPeso,pos:"before",value:"$"},{name:t.CostaRicanColon,pos:"before",value:"?"},{name:t.CubanPeso,pos:"before",value:"$"},{name:t.Cubanconvertiblepeso,pos:"before",value:"$"},{name:t.GuyanaDollar,pos:"before",value:"$"},{name:t.KazakhstanTenge,pos:"before",value:"?"},{name:t.Haitiangourde,pos:"before",value:"HTG"},{name:t.won,pos:"before",value:"?"},{name:t.NetherlandsAntillesGuilder,pos:"before",value:"NAf."},{name:t.Honduraslempiras,pos:"before",value:"L"},{name:t.DjiboutiFranc,pos:"before",value:"Fdj"},{name:t.KyrgyzstanSom,pos:"before",value:"KGS"},{name:t.GuineaFranc,pos:"before",value:"FG"},{name:t.CanadianDollar,pos:"before",value:"$"},{name:t.GhanaianCedi,pos:"before",value:"GHS"},{name:t.Cambodianriel,pos:"before",value:"Riel"},{name:t.CzechKoruna,pos:"after",value:"K?"},{name:t.ZimbabweDollar,pos:"before",value:"$"},{name:t.QatariRiyal,pos:"before",value:"Rial"},{name:t.CaymanIslandsDollar,pos:"before",value:"$"},{name:t.Comorianfranc,pos:"before",value:"CF"},{name:t.KuwaitiDinar,pos:"before",value:"din"},{name:t.CroatianKuna,pos:"before",value:"kn"},{name:t.KenyanShilling,pos:"before",value:"Ksh"},{name:t.LesothoLoti,pos:"before",value:"LSL"},{name:t.LaoKip,pos:"before",value:"?"},{name:t.LebanesePound,pos:"before",value:"L\uFFE1"},{name:t.Lithuanianlitas,pos:"before",value:"Lt"},{name:t.LibyanDinar,pos:"before",value:"din"},{name:t.LiberianDollar,pos:"before",value:"$"},{name:t.RwandaFranc,pos:"before",value:"RF"},{name:t.RomanianLeu,pos:"before",value:"RON"},{name:t.MalagasyAriary,pos:"before",value:"Ar"},{name:t.MaldivianRufiyaa,pos:"before",value:"Rf"},{name:t.MalawiKwacha,pos:"before",value:"MWK"},{name:t.MalaysianRinggit,pos:"before",value:"RM"},{name:t.MacedoniawearingDinar,pos:"before",value:"din"},{name:t.MauritiusRupee,pos:"before",value:"MURs"},{name:t.MauritanianOuguiya,pos:"before",value:"MRO"},{name:t.MongolianTugrik,pos:"before",value:"?"},{name:t.BangladeshiTaka,pos:"before",value:"?"},{name:t.PeruvianNuevoSol,pos:"before",value:"S/"},{name:t.MyanmarKyat,pos:"before",value:"K"},{name:t.MoldovanLeu,pos:"before",value:"MDL"},{name:t.MoroccanDirham,pos:"before",value:"dh"},{name:t.MozambiqueMetical,pos:"before",value:"MTn"},{name:t.MexicanPeso,pos:"before",value:"$"},{name:t.NamibianDollar,pos:"before",value:"$"},{name:t.SouthAfricanRand,pos:"before",value:"R"},{name:t.SouthSudanesePound,pos:"before",value:"\uFFE1"},{name:t.NicaraguaCordoba,pos:"before",value:"C$"},{name:t.NepaleseRupee,pos:"before",value:"Rs"},{name:t.NigerianNaira,pos:"before",value:"?"},{name:t.NorwegianKrone,pos:"after",value:"kr"},{name:t.GeorgianLari,pos:"before",value:"GEL"},{name:t.RenminbiOffshore,pos:"before",value:"\uFFE5"},{name:t.SwedishKrona,pos:"after",value:"kr"},{name:t.SwissFranc,pos:"before",value:"CHF"},{name:t.SerbianDinar,pos:"before",value:"din"},{name:t.SierraLeone,pos:"before",value:"SLL"},{name:t.SeychellesRupee,pos:"before",value:"SCR"},{name:t.SaudiRiyal,pos:"before",value:"Rial"},{name:t.SaoTomeDobra,pos:"before",value:"Db"},{name:t.SaintHelenapound,pos:"before",value:"\uFFE1"},{name:t.SriLankaRupee,pos:"before",value:"Rs"},{name:t.SwazilandLilangeni,pos:"before",value:"SZL"},{name:t.SudanesePound,pos:"before",value:"SDG"},{name:t.Surinamesedollar,pos:"before",value:"$"},{name:t.SolomonIslandsDollar,pos:"before",value:"$"},{name:t.SomaliShilling,pos:"before",value:"SOS"},{name:t.TajikistanSomoni,pos:"before",value:"Som"},{name:t.PacificFranc,pos:"after",value:"FCFP"},{name:t.ThaiBaht,pos:"before",value:"?"},{name:t.TanzanianShilling,pos:"before",value:"TSh"},{name:t.TonganPaanga,pos:"before",value:"T$"},{name:t.TrinidadandTobagoDollar,pos:"before",value:"$"},{name:t.TunisianDinar,pos:"before",value:"din"},{name:t.TurkishLira,pos:"before",value:"?"},{name:t.VanuatuVatu,pos:"before",value:"VUV"},{name:t.GuatemalanQuetzal,pos:"before",value:"Q"},{name:t.CommissionBolivar,pos:"before",value:"Bs"},{name:t.BruneiDollar,pos:"before",value:"$"},{name:t.UgandanShilling,pos:"before",value:"UGX"},{name:t.UkrainianHryvnia,pos:"before",value:"\u0433\u0440\u043D."},{name:t.UruguayanPeso,pos:"before",value:"$"},{name:t.Uzbekistansom,pos:"before",value:"so?m"},{name:t.WesternSamoaTala,pos:"before",value:"WST"},{name:t.SingaporeDollar,pos:"before",value:"$"},{name:t.NT,pos:"before",value:"NT$"},{name:t.NewZealandDollar,pos:"before",value:"$"},{name:t.HungarianForint,pos:"before",value:"Ft"},{name:t.SyrianPound,pos:"before",value:"\uFFE1"},{name:t.JamaicanDollar,pos:"before",value:"$"},{name:t.ArmenianDram,pos:"before",value:"Dram"},{name:t.YemeniRial,pos:"before",value:"Rial"},{name:t.IraqiDinar,pos:"before",value:"din"},{name:t.IranianRial,pos:"before",value:"Rial"},{name:t.NewIsraeliShekel,pos:"before",value:"?"},{name:t.IndianRupee,pos:"before",value:"?"},{name:t.IndonesianRupiah,pos:"before",value:"Rp"},{name:t.JordanianDinar,pos:"before",value:"din"},{name:t.VND,pos:"after",value:"?"},{name:t.ZambianKwacha,pos:"before",value:"ZMW"},{name:t.GibraltarPound,pos:"before",value:"\uFFE1"},{name:t.ChileanPeso,pos:"before",value:"$"},{name:t.CFAFrancBEAC,pos:"before",value:"FCFA"}],this.dateFmtList=Oe().dateFmtList,this.numFmtList=[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-moreFormat-dialog").remove();let a="",s="";if(e=="morecurrency"){a=l.titleCurrency;let p="";for(let x=0;x<n.moneyFmtList.length;x++){let _=n.moneyFmtList[x].name,S=n.moneyFmtList[x].pos,I=n.moneyFmtList[x].value;p+='<div class="listItem"><div class="name">'+_+'</div><div class="value">'+I+'</div><input type="hidden" value="'+S+'"/></div>'}s='<div class="box" id="morecurrency"><div class="decimal"><label>'+l.decimalPlaces+'\uFF1A</label><input type="number" class="formulaInputFocus" value="2" min="0" max="9"/></div><div class="listbox">'+p+"</div></div>"}else if(e=="moredatetime"){a=l.titleDateTime;let p="";for(let x=0;x<n.dateFmtList.length;x++){let _=n.dateFmtList[x].name,S=n.dateFmtList[x].value;p+='<div class="listItem"><div class="name">'+_+'</div><div class="value">'+S+"</div></div>"}s='<div class="box" id="moredatetime"><div class="listbox">'+p+"</div></div>"}else if(e=="moredigit"){a=l.titleNumber;let p="";for(let x=0;x<n.numFmtList.length;x++){let _=n.numFmtList[x].name,S=n.numFmtList[x].value;p+='<div class="listItem"><div class="name">'+_+'</div><div class="value">'+S+"</div></div>"}s='<div class="box" id="moredigit"><div class="listbox">'+p+"</div></div>"}$("body").first().append(yt(kl,{id:"luckysheet-moreFormat-dialog",addclass:"luckysheet-moreFormat-dialog",title:a,content:s,botton:'<button id="luckysheet-moreFormat-dialog-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>",style:"z-index:100003"}));let u=$("#luckysheet-moreFormat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),f=u.outerHeight(),m=u.outerWidth(),d=$(window).width(),g=$(window).height(),b=$(document).scrollLeft(),y=$(document).scrollTop();$("#luckysheet-moreFormat-dialog").css({left:(d+b-m)/2,top:(g+y-f)/3}).show(),$("#luckysheet-moreFormat-dialog .listbox .listItem").eq(0).addClass("on")},init:function(){let e=this;$(document).on("click","#luckysheet-moreFormat-dialog .listbox .listItem",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.moreFormatConfirm").on("click.moreFormatConfirm","#luckysheet-moreFormat-dialog #luckysheet-moreFormat-dialog-confirm",function(){$("#luckysheet-moreFormat-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide();let n=pt.deepCopyFlowData(h.flowdata),t=$("#luckysheet-moreFormat-dialog .listbox .listItem.on .value").text(),l=$(this).parents("#luckysheet-moreFormat-dialog").find(".box").attr("id");if(l=="morecurrency"){if(t.indexOf("?")!=-1)return;let o=parseInt($("#luckysheet-moreFormat-dialog .decimal input").val().trim());if(o.toString()=="NaN"||o<0||o>9){Qe()?alert("\u5C0F\u6570\u4F4D\u6570\u5FC5\u987B\u57280-9\u4E4B\u95F4\uFF01"):de.info("\u5C0F\u6570\u4F4D\u6570\u5FC5\u987B\u57280-9\u4E4B\u95F4\uFF01","");return}let a="";if(o>0){for(let u=1;u<=o;u++)a+="0";a="0."+a}else a="#";let s=$("#luckysheet-moreFormat-dialog .listbox .listItem.on input:hidden").val();s=="before"?a='"'+t+'" '+a:s=="after"&&(a=a+' "'+t+'"'),ht.updateFormat(n,"ct",a)}else l=="moredatetime"?ht.updateFormat(n,"ct",t):l=="moredigit"&&ht.updateFormat(n,"ct",t)})}},Fg=l_});var import_plugin,r_,Ta,Mg=Tt(()=>{import_plugin=Le(Be());gl();ql();ar();vr();Yr();Gl();Hn();io();fr();br();Sr();Vu();Ut();Rl();jn();r_={createDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-replace").remove();let n=Oe(),t=n.findAndReplace,l=n.button,o='<div class="tabBox"><span id="searchTab">'+t.find+'</span><span id="replaceTab">'+t.replace+'</span></div><div class="ctBox"><div class="inputBox"><div class="textboxs" id="searchInput">'+t.findTextbox+'\uFF1A<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="textboxs" id="replaceInput">'+t.replaceTextbox+'\uFF1A<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="checkboxs"><div id="regCheck"><input type="checkbox"/><span>'+t.regexTextbox+'</span></div><div id="wordCheck"><input type="checkbox"/><span>'+t.wholeTextbox+'</span></div><div id="caseCheck"><input type="checkbox"/><span>'+t.distinguishTextbox+'</span></div></div></div><div class="btnBox"><button id="replaceAllBtn" class="btn btn-default">'+t.allReplaceBtn+'</button><button id="replaceBtn" class="btn btn-default">'+t.replaceBtn+'</button><button id="searchAllBtn" class="btn btn-default">'+t.allFindBtn+'</button><button id="searchNextBtn" class="btn btn-default">'+t.findBtn+"</button></div></div>";$("body").first().append(yt(kl,{id:"luckysheet-search-replace",addclass:"luckysheet-search-replace",title:"",content:o,botton:'<button class="btn btn-default luckysheet-model-close-btn">'+l.close+"</button>",style:"z-index:100003",close:l.close}));let a=$("#luckysheet-search-replace").find(".luckysheet-modal-dialog-content").css("min-width",500).end(),s=a.outerHeight(),u=a.outerWidth(),f=$(window).width(),m=$(window).height(),d=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-search-replace").css({left:(f+d-u)/2,top:(m+g-s)/3}).show(),e=="0"?($("#luckysheet-search-replace #searchTab").addClass("on").siblings().removeClass("on"),$("#luckysheet-search-replace #replaceInput").hide(),$("#luckysheet-search-replace #replaceAllBtn").hide(),$("#luckysheet-search-replace #replaceBtn").hide()):e=="1"&&($("#luckysheet-search-replace #replaceTab").addClass("on").siblings().removeClass("on"),$("#luckysheet-search-replace #replaceInput").show(),$("#luckysheet-search-replace #replaceAllBtn").show(),$("#luckysheet-search-replace #replaceBtn").show())},init:function(){let e=this;$(document).off("click.SRtabBoxspan").on("click.SRtabBoxspan","#luckysheet-search-replace .tabBox span",function(){$(this).addClass("on").siblings().removeClass("on");let n=$(this).attr("id");n=="searchTab"?($("#luckysheet-search-replace #replaceInput").hide(),$("#luckysheet-search-replace #replaceAllBtn").hide(),$("#luckysheet-search-replace #replaceBtn").hide(),$("#luckysheet-search-replace #searchInput input").focus()):n=="replaceTab"&&($("#luckysheet-search-replace #replaceInput").show(),$("#luckysheet-search-replace #replaceAllBtn").show(),$("#luckysheet-search-replace #replaceBtn").show(),$("#luckysheet-search-replace #replaceInput input").focus())}),$(document).off("keyup.SRsearchInput").on("keyup.SRsearchInput","#luckysheet-search-replace #searchInput input",function(n){n.keyCode==rl.ENTER&&e.searchNext()}),$(document).off("click.SRsearchNextBtn").on("click.SRsearchNextBtn","#luckysheet-search-replace #searchNextBtn",function(){e.searchNext()}),$(document).off("click.SRsearchAllBtn").on("click.SRsearchAllBtn","#luckysheet-search-replace #searchAllBtn",function(){e.searchAll()}),$(document).off("click.SRsearchAllboxItem").on("click.SRsearchAllboxItem","#luckysheet-search-replace #searchAllbox .boxItem",function(){$(this).addClass("on").siblings().removeClass("on");let n=$(this).attr("data-row"),t=$(this).attr("data-col"),l=$(this).attr("data-sheetIndex");l!=h.currentSheetIndex&&ct.changeSheetExec(l),h.luckysheet_select_save=[{row:[n,n],column:[t,t]}],Zt();let o=$("#luckysheet-cell-main").scrollLeft(),a=$("#luckysheet-cell-main").scrollTop(),s=$("#luckysheet-cell-main").height(),u=$("#luckysheet-cell-main").width(),f=h.visibledatarow[n],m=n-1==-1?0:h.visibledatarow[n-1],d=h.visibledatacolumn[t],g=t-1==-1?0:h.visibledatacolumn[t-1];d-o-u+20>0?$("#luckysheet-scrollbar-x").scrollLeft(d-u+20):g-o-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(g-20),f-a-s+20>0?$("#luckysheet-scrollbar-y").scrollTop(f-s+20):m-a-20<0&&$("#luckysheet-scrollbar-y").scrollTop(m-20)}),$(document).off("click.SRreplaceBtn").on("click.SRreplaceBtn","#luckysheet-search-replace #replaceBtn",function(){e.replace()}),$(document).off("click.SRreplaceAllBtn").on("click.SRreplaceAllBtn","#luckysheet-search-replace #replaceAllBtn",function(){e.replaceAll()})},searchNext:function(){let e=this,n=$("#luckysheet-search-replace #searchInput input").val();if(n==""||n==null)return;let l=Oe().findAndReplace,o;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?o=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:o=$.extend(!0,[],h.luckysheet_select_save);let a=e.getSearchIndexArr(n,o);if(a.length==0){Qe()?alert(l.noFindTip):de.info(l.noFindTip,"");return}let s=0;if(h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]){if(h.luckysheet_select_save.length==0)s=0;else for(let x=0;x<a.length;x++)if(a[x].r==h.luckysheet_select_save[0].row[0]&&a[x].c==h.luckysheet_select_save[0].column[0]){x==a.length-1?s=0:s=x+1;break}h.luckysheet_select_save=[{row:[a[s].r,a[s].r],column:[a[s].c,a[s].c]}]}else{let x=o[o.length-1].row_focus,_=o[o.length-1].column_focus;for(let S=0;S<a.length;S++)if(a[S].r==x&&a[S].c==_){S==a.length-1?s=0:s=S+1;break}for(let S=0;S<o.length;S++){let I=o[S].row[0],O=o[S].row[1],F=o[S].column[0],D=o[S].column[1];if(a[s].r>=I&&a[s].r<=O&&a[s].c>=F&&a[s].c<=D){let k=o[S];k.row_focus=a[s].r,k.column_focus=a[s].c,o.splice(S,1),o.push(k);break}}h.luckysheet_select_save=o}Zt();let u=$("#luckysheet-cell-main").scrollLeft(),f=$("#luckysheet-cell-main").scrollTop(),m=$("#luckysheet-cell-main").height(),d=$("#luckysheet-cell-main").width(),g=h.visibledatarow[a[s].r],b=a[s].r-1==-1?0:h.visibledatarow[a[s].r-1],y=h.visibledatacolumn[a[s].c],p=a[s].c-1==-1?0:h.visibledatacolumn[a[s].c-1];y-u-d+20>0?$("#luckysheet-scrollbar-x").scrollLeft(y-d+20):p-u-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(p-20),g-f-m+20>0?$("#luckysheet-scrollbar-y").scrollTop(g-m+20):b-f-20<0&&$("#luckysheet-scrollbar-y").scrollTop(b-20),$("#searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox .boxItem").removeClass("on")},searchAll:function(){let e=this,t=Oe().findAndReplace;$("#luckysheet-search-replace #searchAllbox").remove();let l=$("#luckysheet-search-replace #searchInput input").val();if(l==""||l==null)return;let o;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?o=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:o=$.extend(!0,[],h.luckysheet_select_save);let a=e.getSearchIndexArr(l,o);if(a.length==0){Qe()?alert(t.noFindTip):de.info(t.noFindTip,"");return}let s="";for(let u=0;u<a.length;u++){let f=ba(a[u].r,a[u].c,h.flowdata).toString();f.indexOf("</")>-1&&f.indexOf(">")>-1?s+='<div class="boxItem" data-row="'+a[u].r+'" data-col="'+a[u].c+'" data-sheetIndex="'+h.currentSheetIndex+'"><span>'+h.luckysheetfile[$e(h.currentSheetIndex)].name+"</span><span>"+Qt(a[u].c)+(a[u].r+1)+"</span><span>"+f+"</span></div>":s+='<div class="boxItem" data-row="'+a[u].r+'" data-col="'+a[u].c+'" data-sheetIndex="'+h.currentSheetIndex+'"><span>'+h.luckysheetfile[$e(h.currentSheetIndex)].name+"</span><span>"+Qt(a[u].c)+(a[u].r+1)+'</span><span title="'+f+'">'+f+"</span></div>"}$('<div id="searchAllbox"><div class="boxTitle"><span>'+t.searchTargetSheet+"</span><span>"+t.searchTargetCell+"</span><span>"+t.searchTargetValue+'</span></div><div class="boxMain">'+s+"</div></div>").appendTo($("#luckysheet-search-replace")),$("#luckysheet-search-replace #searchAllbox .boxItem").eq(0).addClass("on").siblings().removeClass("on"),h.luckysheet_select_save=[{row:[a[0].r,a[0].r],column:[a[0].c,a[0].c]}],Zt()},getSearchIndexArr:function(e,n){let t=[],l={},o=!1;$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked")&&(o=!0);let a=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(a=!0);let s=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(s=!0);for(let u=0;u<n.length;u++){let f=n[u].row[0],m=n[u].row[1],d=n[u].column[0],g=n[u].column[1];for(let b=f;b<=m;b++)for(let y=d;y<=g;y++)if(h.flowdata[b][y]!=null){let x=ba(b,y,h.flowdata);if(x==0&&(x=x.toString()),x!=null&&x!="")if(x=x.toString(),a)s?e==x&&(b+"_"+y in l||(l[b+"_"+y]=0,t.push({r:b,c:y}))):e.toLowerCase()==x.toLowerCase()&&(b+"_"+y in l||(l[b+"_"+y]=0,t.push({r:b,c:y})));else if(o){let _;s?_=new RegExp(j.getRegExpStr(e),"g"):_=new RegExp(j.getRegExpStr(e),"ig"),_.test(x)&&(b+"_"+y in l||(l[b+"_"+y]=0,t.push({r:b,c:y})))}else~x.indexOf(e)&&(b+"_"+y in l||(l[b+"_"+y]=0,t.push({r:b,c:y})))}}return t},replace:function(){let e=this,t=Oe().findAndReplace;if(!h.allowEdit){de.info(t.modeTip,"");return}let l=$("#luckysheet-search-replace #searchInput input").val();if(l==""||l==null){Qe()?alert(t.searchInputTip):de.info(t.searchInputTip,"");return}let o;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?o=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:o=$.extend(!0,[],h.luckysheet_select_save);let a=e.getSearchIndexArr(l,o);if(a.length==0){Qe()?alert(t.noReplceTip):de.info(t.noReplceTip,"");return}let s=null,u=h.luckysheet_select_save[h.luckysheet_select_save.length-1],f=u.row_focus,m=u.column_focus;for(let T=0;T<a.length;T++)if(a[T].r==f&&a[T].c==m){s=T;break}if(s==null)if(a.length==0){Qe()?alert(t.noMatchTip):de.info(t.noMatchTip,"");return}else s=0;let d=!1;$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked")&&(d=!0);let g=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(g=!0);let b=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(b=!0);let y=$("#luckysheet-search-replace #replaceInput input").val(),p=pt.deepCopyFlowData(h.flowdata),x,_;if(g){x=a[s].r,_=a[s].c;let T=y;if(!xa(x,_,h.currentSheetIndex))return;er(x,_,p,T)}else{let T;if(b?T=new RegExp(j.getRegExpStr(l),"g"):T=new RegExp(j.getRegExpStr(l),"ig"),x=a[s].r,_=a[s].c,!xa(x,_,h.currentSheetIndex))return;let z=ba(x,_,p).toString().replace(T,y);er(x,_,p,z)}h.luckysheet_select_save=[{row:[x,x],column:[_,_]}],$("#luckysheet-search-replace #searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox").hide(),Gt(p,h.luckysheet_select_save),Zt();let S=$("#luckysheet-cell-main").scrollLeft(),I=$("#luckysheet-cell-main").scrollTop(),O=$("#luckysheet-cell-main").height(),F=$("#luckysheet-cell-main").width(),D=h.visibledatarow[x],k=x-1==-1?0:h.visibledatarow[x-1],w=h.visibledatacolumn[_],C=_-1==-1?0:h.visibledatacolumn[_-1];w-S-F+20>0?$("#luckysheet-scrollbar-x").scrollLeft(w-F+20):C-S-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(C-20),D-I-O+20>0?$("#luckysheet-scrollbar-y").scrollTop(D-O+20):k-I-20<0&&$("#luckysheet-scrollbar-y").scrollTop(k-20)},replaceAll:function(){let e=this,t=Oe().findAndReplace;if(!h.allowEdit){de.info(t.modeTip,"");return}let l=$("#luckysheet-search-replace #searchInput input").val();if(l==""||l==null){Qe()?alert(t.searchInputTip):de.info(t.searchInputTip,"");return}let o;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?o=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:o=$.extend(!0,[],h.luckysheet_select_save);let a=e.getSearchIndexArr(l,o);if(a.length==0){Qe()?alert(t.noReplceTip):de.info(t.noReplceTip,"");return}let s=!1;$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked")&&(s=!0);let u=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(u=!0);let f=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(f=!0);let m=$("#luckysheet-search-replace #replaceInput input").val(),d=pt.deepCopyFlowData(h.flowdata),g=0;if(u)for(let y=0;y<a.length;y++){let p=a[y].r,x=a[y].c;if(!xa(p,x,h.currentSheetIndex,!1))continue;er(p,x,d,m),o.push({row:[p,p],column:[x,x]}),g++}else{let y;f?y=new RegExp(j.getRegExpStr(l),"g"):y=new RegExp(j.getRegExpStr(l),"ig");for(let p=0;p<a.length;p++){let x=a[p].r,_=a[p].c;if(!xa(x,_,h.currentSheetIndex,!1))continue;let S=ba(x,_,d).toString().replace(y,m);er(x,_,d,S),o.push({row:[x,x],column:[_,_]}),g++}}$("#luckysheet-search-replace #searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox").hide(),Gt(d,o),h.luckysheet_select_save=$.extend(!0,[],o),Zt();let b=yt(t.successTip,{xlength:g});Qe()?alert(b):de.info(b,"")}},Ta=r_});var import_plugin,n_,zo,W1=Tt(()=>{import_plugin=Le(Be());gl();ql();Gl();Gl();Sr();ar();vr();ji();Ut();Rl();n_={createDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-locationCell-dialog").remove();let e=Oe(),n=e.findAndReplace,t=e.button,l='<div class="listbox"><div class="listItem"><input type="radio" name="locationType" checked="checked" id="locationConstant"><label for="locationConstant">'+n.locationConstant+'</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationConstantDate"><label for="locationConstantDate">'+n.locationDate+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationConstantNumber"><label for="locationConstantNumber">'+n.locationDigital+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationConstantString"><label for="locationConstantString">'+n.locationString+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationConstantBoolean"><label for="locationConstantBoolean">'+n.locationBool+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationConstantError"><label for="locationConstantError">'+n.locationBool+'</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationFormula"><label for="locationFormula">'+n.locationFormula+'</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationFormulaDate" disabled="true"><label for="locationFormulaDate" style="color: #666">'+n.locationDate+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationFormulaNumber" disabled="true"><label for="locationFormulaNumber" style="color: #666">'+n.locationDigital+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationFormulaString" disabled="true"><label for="locationFormulaString" style="color: #666">'+n.locationString+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationFormulaBoolean" disabled="true"><label for="locationFormulaBoolean" style="color: #666">'+n.locationBool+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationFormulaError" disabled="true"><label for="locationFormulaError" style="color: #666">'+n.locationError+'</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationNull"><label for="locationNull">'+n.locationNull+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationCF"><label for="locationCF">'+n.locationCondition+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepRow"><label for="locationStepRow">'+n.locationRowSpan+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepColumn"><label for="locationStepColumn">'+n.locationColumnSpan+"</label></div></div>";$("body").first().append(yt(kl,{id:"luckysheet-locationCell-dialog",addclass:"luckysheet-locationCell-dialog",title:n.location,content:l,botton:'<button id="luckysheet-locationCell-dialog-confirm" class="btn btn-primary">'+t.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+t.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-locationCell-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-locationCell-dialog").css({left:(u+m-s)/2,top:(f+d-a)/3}).show()},init:function(){let e=this,n=Oe().findAndReplace;$(document).on("click","#luckysheet-locationCell-dialog .listItem input:radio",function(t){$("#luckysheet-locationCell-dialog .listItem input:checkbox").prop("disabled",!0),$("#luckysheet-locationCell-dialog .listItem .subbox label").css("color","#666"),$(this).siblings(".subbox").find("input:checkbox").removeAttr("disabled"),$(this).siblings(".subbox").find("label").css("color","#000")}),$(document).off("click.locationCellConfirm").on("click.locationCellConfirm","#luckysheet-locationCell-dialog #luckysheet-locationCell-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-locationCell-dialog").hide();let t=$("#luckysheet-locationCell-dialog .listItem input:radio:checked"),l=t.attr("id");if(l=="locationConstant"||l=="locationFormula"){let o=t.siblings(".subbox").find("input:checkbox:checked"),a;if(o.length==0)return;if(o.length==5)a="all";else{let u=[];for(let f=0;f<o.length;f++)$(o[f]).hasClass("date")?u.push("d"):$(o[f]).hasClass("number")?u.push("n"):$(o[f]).hasClass("string")?u.push("s,g"):$(o[f]).hasClass("boolean")?u.push("b"):$(o[f]).hasClass("error")&&u.push("e");a=u.join(",")}let s;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?s=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:s=$.extend(!0,[],h.luckysheet_select_save),e.apply(s,l,a)}else if(l=="locationStepRow"){if(h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]){Qe()?alert(n.locationTiplessTwoRow):de.info("",n.locationTiplessTwoRow);return}let o=$.extend(!0,[],h.luckysheet_select_save);e.apply(o,"locationStepRow")}else if(l=="locationStepColumn"){if(h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]){Qe()?alert(n.locationTiplessTwoColumn):de.info("",n.locationTiplessTwoColumn);return}let o=$.extend(!0,[],h.luckysheet_select_save);e.apply(o,"locationStepColumn")}else{let o;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?o=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:o=$.extend(!0,[],h.luckysheet_select_save),e.apply(o,l)}})},apply:function(e,n,t){let l=Oe().findAndReplace,o=[];if(n=="locationFormula"||n=="locationConstant"||n=="locationNull"){let a=null,s=null,u=null,f=null,m={};for(let d=0;d<e.length;d++){let g=e[d].row[0],b=e[d].row[1],y=e[d].column[0],p=e[d].column[1];(a==null||a<g)&&(a=g),(s==null||s>b)&&(s=b),(u==null||u<y)&&(u=y),(f==null||f>p)&&(f=p);for(let x=g;x<=b;x++)for(let _=y;_<=p;_++){let S=h.flowdata[x][_];S!=null&&S.mc!=null&&(S=h.flowdata[S.mc.r][S.mc.c]),(n=="locationFormula"&&S!=null&&!rt(S.v)&&S.f!=null&&(t=="all"||S.ct!=null&&t.indexOf(S.ct.t)>-1)||n=="locationConstant"&&S!=null&&!rt(S.v)&&(t=="all"||S.ct!=null&&t.indexOf(S.ct.t)>-1)||n=="locationNull"&&(S==null||rt(S.v)))&&(m[x+"_"+_]=0)}}o=this.getRangeArr(a,s,u,f,m,o)}else if(n=="locationCF"){let a=$e(h.currentSheetIndex),s=h.luckysheetfile[a].luckysheet_conditionformat_save,u=h.luckysheetfile[a].data;if(s==null||s.length==0){Qe()?alert(l.locationTipNotFindCell):de.info("",l.locationTipNotFindCell);return}if(computeMap=xt.compute(s,u),Object.keys(computeMap).length==0){Qe()?alert(l.locationTipNotFindCell):de.info("",l.locationTipNotFindCell);return}let f=null,m=null,d=null,g=null,b={};for(let y=0;y<e.length;y++){let p=e[y].row[0],x=e[y].row[1],_=e[y].column[0],S=e[y].column[1];(f==null||f<p)&&(f=p),(m==null||m>x)&&(m=x),(d==null||d<_)&&(d=_),(g==null||g>S)&&(g=S);for(let I=p;I<=x;I++)for(let O=_;O<=S;O++)I+"_"+O in computeMap&&(b[I+"_"+O]=0)}o=this.getRangeArr(f,m,d,g,b,o)}else if(n=="locationStepRow")for(let a=0;a<e.length;a++){if(e[a].row[0]==e[a].row[1])continue;let s=e[a].row[0],u=e[a].row[1],f=e[a].column[0],m=e[a].column[1];for(let d=s;d<=u;d++)(d-s)%2==0&&o.push({row:[d,d],column:[f,m]})}else if(n=="locationStepColumn")for(let a=0;a<e.length;a++){if(e[a].column[0]==e[a].column[1])continue;let s=e[a].row[0],u=e[a].row[1],f=e[a].column[0],m=e[a].column[1];for(let d=f;d<=m;d++)(d-f)%2==0&&o.push({row:[s,u],column:[d,d]})}if(o.length==0)Qe()?alert(l.locationTipNotFindCell):de.info("",l.locationTipNotFindCell);else{h.luckysheet_select_save=o,Zt();let a=$("#luckysheet-cell-main").scrollLeft(),s=$("#luckysheet-cell-main").scrollTop(),u=$("#luckysheet-cell-main").height(),f=$("#luckysheet-cell-main").width(),m=h.luckysheet_select_save[0].row[0],d=h.luckysheet_select_save[0].row[1],g=h.luckysheet_select_save[0].column[0],b=h.luckysheet_select_save[0].column[1],y=h.visibledatarow[d],p=m-1==-1?0:h.visibledatarow[m-1],x=h.visibledatacolumn[b],_=g-1==-1?0:h.visibledatacolumn[g-1];x-a-f+20>0?$("#luckysheet-scrollbar-x").scrollLeft(x-f+20):_-a-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(_-20),y-s-u+20>0?$("#luckysheet-scrollbar-y").scrollTop(y-u+20):p-s-20<0&&$("#luckysheet-scrollbar-y").scrollTop(p-20)}},getRangeArr(e,n,t,l,o,a){if(Object.keys(o).length==0)return a;let s=this,u=null,f=null,m=null,d=null;for(let g=e;g<=n;g++)for(let b=t;b<=l;b++){let y=h.flowdata[g][b];if(g+"_"+b in o)if(y!=null&&y.mc!=null)if(m==null){let p={row:[y.mc.r,y.mc.r+y.mc.rs-1],column:[y.mc.c,y.mc.c+y.mc.cs-1]};return a.push(p),o=s.deleteCellInSave(o,p),s.getRangeArr(e,n,t,l,o,a)}else if(b<d){let p={row:[u,f],column:[m,d]};return a.push(p),o=s.deleteCellInSave(o,p),s.getRangeArr(e,n,t,l,o,a)}else break;else m==null?(m=b,d=b,u=g,f=g):b>d&&(d=b);else if(m!=null){if(y!=null&&y.mc!=null)break;if(!(b<m))if(b<=d){let p={row:[u,f],column:[m,d]};return a.push(p),o=s.deleteCellInSave(o,p),s.getRangeArr(e,n,t,l,o,a)}else f=g}}if(m!=null){let g={row:[u,f],column:[m,d]};return a.push(g),o=s.deleteCellInSave(o,g),s.getRangeArr(e,n,t,l,o,a)}},deleteCellInSave(e,n){for(let t=n.row[0];t<=n.row[1];t++)for(let l=n.column[0];l<=n.column[1];l++)delete e[t+"_"+l];return e}},zo=n_});var import_plugin,i_,Vc,Dg=Tt(()=>{import_plugin=Le(Be());ir();br();Ns();ar();gl();Ut();Rl();i_={singleRangeFocus:!1,init:function(){let e=this,n=Oe(),t=n.formula,l=n.button;$(document).off("focus.IFcompareValue").on("focus.IFcompareValue","#luckysheet-ifFormulaGenerator-dialog #compareValue",function(){$("#luckysheet-modal-dialog-mask").hide(),e.singleRangeFocus=!0}),$(document).off("click.IFsingRange").on("click.IFsingRange","#luckysheet-ifFormulaGenerator-dialog .singRange",function(){let o=$("#luckysheet-ifFormulaGenerator-dialog #compareValue").val().trim();v.iscelldata(o)?e.singleRangeDialog(o):e.singleRangeDialog()}),$(document).off("click.IFsingRangeConfirm").on("click.IFsingRangeConfirm","#luckysheet-ifFormulaGenerator-singleRange-confirm",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show();let o=$(this).parents("#luckysheet-ifFormulaGenerator-singleRange-dialog").find("input").val().trim();$("#luckysheet-ifFormulaGenerator-dialog #compareValue").val(o),e.singleRangeFocus=!1}),$(document).off("click.IFsingRangeCancel").on("click.IFsingRangeCancel","#luckysheet-ifFormulaGenerator-singleRange-cancel",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show(),e.singleRangeFocus=!1}),$(document).off("click.IFsingRangeClose").on("click.IFsingRangeClose","#luckysheet-ifFormulaGenerator-singleRange-dialog .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show(),e.singleRangeFocus=!1}),$(document).off("click.IFmultiRange").on("click.IFmultiRange","#luckysheet-ifFormulaGenerator-dialog .multiRange",function(){e.multiRangeDialog(),e.singleRangeFocus=!1}),$(document).off("click.IFmultiRangeConfirm").on("click.IFmultiRangeConfirm","#luckysheet-ifFormulaGenerator-multiRange-confirm",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show();let o=$(this).parents("#luckysheet-ifFormulaGenerator-multiRange-dialog").find("input").val().trim(),a=v.getcellrange(o),s=a.row[0],u=a.row[1],f=a.column[0],m=a.column[1],d=pt.deepCopyFlowData(h.flowdata),g=[];for(let p=s;p<=u;p++)for(let x=f;x<=m;x++)d[p]!=null&&d[p][x]!=null&&d[p][x].ct!=null&&d[p][x].ct.t=="n"&&g.push(d[p][x].v);for(let p=0;p<g.length;p++)for(let x=0;x<g.length-1-p;x++)if(g[x]<g[x+1]){let _=g[x];g[x]=g[x+1],g[x+1]=_}let b=g[0],y=g[g.length-1];$("#luckysheet-ifFormulaGenerator-dialog #smallRange").val(y),$("#luckysheet-ifFormulaGenerator-dialog #largeRange").val(b)}),$(document).off("click.IFmultiRangeCancel").on("click.IFmultiRangeCancel","#luckysheet-ifFormulaGenerator-multiRange-cancel",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show()}),$(document).off("click.IFmultiRangeClose").on("click.IFmultiRangeClose","#luckysheet-ifFormulaGenerator-multiRange-dialog .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show()}),$(document).on("change","#DivisionMethod",function(){$(this).find("option:selected").val()=="2"?$("#DivisionMethodVal").hide():$("#DivisionMethodVal").show(),$("#luckysheet-ifFormulaGenerator-dialog .ifList").empty()}),$(document).off("click.IFcreateBtn").on("click.IFcreateBtn","#luckysheet-ifFormulaGenerator-dialog #createBtn",function(){let o=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#compareValue").val().trim();if(o==""){e.info(t.ifGenTipNotNullValue);return}let a=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#DivisionMethod option:selected").val();if(a=="2"){let s='<div class="item"><input type="number" class="smallNum formulaInputFocus"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+o+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus"/><span>'+t.ifGenTipLableTitile+'\uFF1A</span><input type="text" class="markText formulaInputFocus" value=""><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#luckysheet-ifFormulaGenerator-dialog .ifList").append(s)}else{let s=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#smallRange").val().trim(),u=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#largeRange").val().trim(),f=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#DivisionMethodVal").val().trim();if(s==""||u==""){e.info(t.ifGenTipRangeNotforNull);return}else if(f==""){e.info(t.ifGenTipCutValueNotforNull);return}e.getIfList(o,s,u,a,f)}}),$(document).on("click","#luckysheet-ifFormulaGenerator-dialog .item .fa-remove",function(){$(this).parents(".item").remove()}),$(document).off("click.IFconfirmBtn").on("click.IFconfirmBtn","#luckysheet-ifFormulaGenerator-dialog-confirm",function(){let o=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find(".ifList .item"),a="";if($(o.toArray().reverse()).each(function(m,d){let g=$(d).find(".smallNum").val().trim(),b=$(d).find(".largeNum").val().trim(),y=$(d).find(".operator option:selected").val(),p=$(d).find(".operator2 option:selected").val(),x=$(d).find(".compareValue").text(),_=$(d).find(".markText").val().trim();if(_==""&&(_=t.ifGenTipLableTitile+(m+1)),g==""&&b=="")return!0;let S;y=="0"?S=x+">="+g:S=x+">"+g;let I;p=="0"?I=x+"<="+b:I=x+"<"+b;let O;m==0&&b==""?O=S:m==o.length-1&&g==""?O=I:O="and("+S+","+I+")",m==0?a="if("+O+',"'+_+'")':a="if("+O+',"'+_+'",'+a+")"}),a.length==0){e.info(t.ifGenTipNotGenCondition);return}$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide();let s=h.luckysheet_select_save[h.luckysheet_select_save.length-1],u=s.row_focus,f=s.column_focus;Dn(u,f,h.flowdata),$("#luckysheet-rich-text-editor").html("="+a),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),$("#luckysheet-wa-functionbox-confirm").click()}),$(document).on("click","#luckysheet-ifFormulaGenerator-info .luckysheet-model-close-btn",function(){$("#luckysheet-modal-dialog-mask").show()}),$(document).on("click","#luckysheet-ifFormulaGenerator-info .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-modal-dialog-mask").show()})},ifFormulaDialog:function(e){let n=this,t=Oe(),l=t.formula,o=t.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").remove();let a="",s="";if(e){let x=e.split("if(");for(let _=1;_<x.length;_++){let I=x[_].replace("and(","").replace(/\)/g,"").replace(/\"/g,"").split(",");I=n.clearArr(I),a=n.splitTxt(I[0])[0];let O,F,D;I.length==3?(O=n.splitTxt(I[0])[1],F=n.splitTxt(I[1])[2],D=I[2]):(O=n.splitTxt(I[0])[1],F=n.splitTxt(I[0])[2],D=I[1]),s+='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+O+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+a+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+F+'"/><span>'+l.ifGenTipLableTitile+'\uFF1A</span><input type="text" class="markText formulaInputFocus" value="'+D+'"><i class="fa fa-remove" aria-hidden="true"></i></div>'}}let u='<div class="ifAttr"><div class="attrBox"><label for="compareValue"> '+l.ifGenCompareValueTitle+' </label><div class="inpBox"><input id="compareValue" class="formulaInputFocus" value="'+a+'"/><i class="singRange fa fa-table" aria-hidden="true" title="'+l.ifGenSelectCellTitle+'"></i></div></div><div class="attrBox"><label for="smallRange"> '+l.ifGenRangeTitle+' </label><input type="number" id="smallRange" class="formulaInputFocus"/><span class="text"> '+l.ifGenRangeTo+' </span><input type="number" id="largeRange" class="formulaInputFocus"/><div id="rangeAssess"><span> '+l.ifGenRangeEvaluate+' </span><i class="multiRange fa fa-table" aria-hidden="true" title="'+l.ifGenSelectRangeTitle+'"></i></div></div><div class="attrBox"><label for="DivisionMethod"> '+l.ifGenCutWay+' </label><select id="DivisionMethod"><option value="0"> '+l.ifGenCutSame+' </option><option value="1"> '+l.ifGenCutNpiece+' </option><option value="2"> '+l.ifGenCutCustom+' </option></select><input id="DivisionMethodVal" class="formulaInputFocus"/><div id="createBtn"> '+l.ifGenCutSame+' </div></div></div><div class="ifList">'+s+"</div>";$("body").first().append(yt(kl,{id:"luckysheet-ifFormulaGenerator-dialog",addclass:"luckysheet-ifFormulaGenerator-dialog",title:l.ifGenerate,content:u,botton:'<button id="luckysheet-ifFormulaGenerator-dialog-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>",style:"z-index:100003"}));let f=$("#luckysheet-ifFormulaGenerator-dialog").find(".luckysheet-modal-dialog-content").css("min-width",590).end(),m=f.outerHeight(),d=f.outerWidth(),g=$(window).width(),b=$(window).height(),y=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-dialog").css({left:(g+y-d)/2,top:(b+p-m)/3}).show()},clearArr:function(e){for(let n=0;n<e.length;n++)(e[n]==""||e[n]==null||e[n]==null)&&e.splice(n,1);return e},splitTxt:function(e){let n,t,l;if(e.indexOf(">=")!=-1)return n=e.split(">=")[0],t=e.split(">=")[1],[n,t,l];if(e.indexOf(">")!=-1)return n=e.split(">")[0],t=e.split(">")[1],[n,t,l];if(e.indexOf("<=")!=-1)return n=e.split("<=")[0],l=e.split("<=")[1],[n,t,l];if(e.indexOf("<")!=-1)return n=e.split("<")[0],l=e.split("<")[1],[n,t,l]},singleRangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").remove();let n=Oe(),t=n.formula,l=n.button;e==null&&(e=""),$("body").first().append(yt(kl,{id:"luckysheet-ifFormulaGenerator-singleRange-dialog",addclass:"luckysheet-ifFormulaGenerator-singleRange-dialog",title:t.ifGenTipSelectCell,content:'<input readonly="readonly" placeholder="'+t.ifGenTipSelectCellPlace+'" value="'+e+'">',botton:'<button id="luckysheet-ifFormulaGenerator-singleRange-confirm" class="btn btn-primary">'+l.confirm+'</button><button id="luckysheet-ifFormulaGenerator-singleRange-cancel" class="btn btn-default">'+l.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-ifFormulaGenerator-singleRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-singleRange-dialog").css({left:(u+m-s)/2,top:(f+d-a)/3}).show()},multiRangeDialog:function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").remove();let e=Oe(),n=e.formula,t=e.button;$("body").first().append(yt(kl,{id:"luckysheet-ifFormulaGenerator-multiRange-dialog",addclass:"luckysheet-ifFormulaGenerator-multiRange-dialog",title:n.ifGenTipSelectRange,content:'<input readonly="readonly" placeholder="'+n.ifGenTipSelectRangePlace+'" value="">',botton:'<button id="luckysheet-ifFormulaGenerator-multiRange-confirm" class="btn btn-primary">'+t.confirm+'</button><button id="luckysheet-ifFormulaGenerator-multiRange-cancel" class="btn btn-default">'+t.cancel+"</button>",style:"z-index:100003"}));let l=$("#luckysheet-ifFormulaGenerator-multiRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),f=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-multiRange-dialog").css({left:(s+f-a)/2,top:(u+m-o)/3}).show()},getIfList:function(e,n,t,l,o){let a=Oe().formula;$("#luckysheet-ifFormulaGenerator-dialog .ifList").empty(),n=parseInt(n),t=parseInt(t),o=parseInt(o);let s=[];if(l=="0"){let u=Math.ceil((t-n)/o);for(let f=0;f<=u;f++){let m=n+o*f;f==0||m>=t?s.push(""):s.push(m)}}else if(l=="1"){let u=Math.ceil((t-n)/o);for(let f=0;f<=o;f++){let m=n+u*f;f==0||m>=t?s.push(""):s.push(m)}}for(let u=0;u<s.length-1;u++){let f;u==0?f="\u5C0F\u4E8E"+s[u+1]:u==s.length-2?f="\u5927\u4E8E\u7B49\u4E8E"+s[u]:f=s[u]+"\u5230"+s[u+1];let m='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+s[u]+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+e+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+s[u+1]+'"/><span>'+a.ifGenTipLableTitile+'\uFF1A</span><input type="text" class="markText formulaInputFocus" value="'+f+'"><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#luckysheet-ifFormulaGenerator-dialog .ifList").append(m)}},info:function(e){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-info").remove();let t=Oe().button;$("body").first().append(yt(kl,{id:"luckysheet-ifFormulaGenerator-info",addclass:"",title:e,content:"",botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;'+t.close+"&nbsp;&nbsp;</button>",style:"z-index:100003"}));let l=$("#luckysheet-ifFormulaGenerator-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),f=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-info").css({left:(s+f-a)/2,top:(u+m-o)/3}).show()}},Vc=i_});var import_plugin,o_,ra,Ag=Tt(()=>{import_plugin=Le(Be());Uu();ir();Gl();ar();vr();gl();Ut();Rl();o_={init:function(){let e=this,n=Oe(),t=n.formulaMore,l=n.button;$(document).off("keyup.fxSFLI").on("keyup.fxSFLI","#searchFormulaListInput",function(){$("#formulaTypeList").empty();let o=$(this).val().toUpperCase(),a=h.functionlist;if(o=="")e.formulaListByType($("#formulaTypeSelect option:selected").val());else for(let s=0;s<a.length;s++)/^[a-zA-Z]+$/.test(o)?a[s].n.indexOf(o)!="-1"&&$('<div class="listBox" name="'+a[s].n+'"><span>'+a[s].n+"</span><span>"+a[s].a+"</span></div>").appendTo($("#formulaTypeList")):a[s].a.indexOf(o)!="-1"&&$('<div class="listBox" name="'+a[s].n+'"><span>'+a[s].n+"</span><span>"+a[s].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")}),$(document).off("change.fxFormulaTS").on("change.fxFormulaTS","#formulaTypeSelect",function(){let o=$("#formulaTypeSelect option:selected").val();e.formulaListByType(o)}),$(document).off("click.fxListbox").on("click.fxListbox","#formulaTypeList .listBox",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.fxFormulaCf").on("click.fxFormulaCf","#luckysheet-search-formula-confirm",function(){let o=$("#luckysheet-search-formula .listBox.on").attr("name"),a='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+o.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(a),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),e.formulaParmDialog(o)}),$(document).off("focus.fxParamInput").on("focus.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){let o=$(this).parents(".parmBox").index();v.data_parm_index=o;let a=$(this).parents("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-title-text").text(),s=h.luckysheet_function[a].p.length,u,f;o>=s?(u=h.luckysheet_function[a].p[s-1].detail,f=h.luckysheet_function[a].p[s-1].repeat):(u=h.luckysheet_function[a].p[o].detail,f=h.luckysheet_function[a].p[o].repeat),e.parmTxtShow($(this).val()),e.functionStrCompute(),$("#luckysheet-search-formula-parm .parmDetailsBox").empty();let m=$(this).parents(".parmBox").find(".name").text();if($("<span>"+m+":</span><span>"+u+"</span>").appendTo($("#luckysheet-search-formula-parm .parmDetailsBox")),f=="y"){let d=$("#luckysheet-search-formula-parm .parmBox").length;d<5&&o==d-1&&$('<div class="parmBox"><div class="name">'+t.valueTitle+""+(d+1)+'</div><div class="txt"><input class="formulaInputFocus" /><i class="fa fa-table" aria-hidden="true" title="'+t.tipSelectDataRange+'"></i></div><div class="val">=</div></div>').appendTo($("#luckysheet-search-formula-parm .parmListBox"))}}),$(document).off("blur.fxParamInput").on("blur.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){let o=$(this).val();v.getfunctionParam(o).fn==null&&!v.iscelldata(o)&&!Y(o)&&o!=""&&o.length<=2&&o.indexOf('"')!=0&&o.lastIndexOf('"')!=0&&(o='"'+o+'"',$(this).val(o),e.parmTxtShow(o),e.functionStrCompute())}),$(document).off("keyup.fxParamInput").on("keyup.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){e.parmTxtShow($(this).val()),e.functionStrCompute()}),$(document).off("click.fxParamI").on("click.fxParamI","#luckysheet-search-formula-parm .parmBox i",function(){v.data_parm_index=$(this).parents(".parmBox").index(),$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-formula-parm-select").remove(),$(this).parents(".parmBox").find(".txt input").val()==""?$("body").first().append(yt(kl,{id:"luckysheet-search-formula-parm-select",addclass:"luckysheet-search-formula-parm-select",title:t.tipSelectDataRange,content:"<input id='luckysheet-search-formula-parm-select-input' class='luckysheet-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='"+t.tipDataRangeTile+"' readonly='true' placeholder='"+t.tipDataRangeTile+"'>",botton:'<button id="luckysheet-search-formula-parm-select-confirm" class="btn btn-primary">'+l.confirm+"</button>",style:"z-index:100003"})):$("body").first().append(yt(kl,{id:"luckysheet-search-formula-parm-select",addclass:"luckysheet-search-formula-parm-select",title:t.tipSelectDataRange,content:"<input id='luckysheet-search-formula-parm-select-input' class='luckysheet-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='"+t.tipDataRangeTile+"' readonly='true' value='"+$(this).parents(".parmBox").find(".txt input").val()+"'>",botton:'<button id="luckysheet-search-formula-parm-select-confirm" class="btn btn-primary">'+l.confirm+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-search-formula-parm-select").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-search-formula-parm-select").css({left:(u+m-s)/2,top:(f+d-a)/3}).show(),e.parmTxtShow($(this).parents(".parmBox").find(".txt input").val())}),$(document).off("click.fxParamCf").on("click.fxParamCf","#luckysheet-search-formula-parm-confirm",function(){$("#luckysheet-wa-functionbox-confirm").click()}),$(document).off("click.fxParamSelectCf").on("click.fxParamSelectCf","#luckysheet-search-formula-parm-select-confirm",function(){let o=$("#luckysheet-search-formula-parm-select-input").attr("data_parm_index");$("#luckysheet-search-formula-parm-select").hide(),$("#luckysheet-search-formula-parm").show(),$("#luckysheet-search-formula-parm .parmBox").eq(o).find(".txt input").focus()})},formulaListDialog:function(){let e=this,n=Oe(),t=n.formulaMore,l=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-search-formula").remove(),$("body").first().append(yt(kl,{id:"luckysheet-search-formula",addclass:"luckysheet-search-formula",title:"",content:"<div class='inpbox'><label for='searchFormulaListInput'>"+t.findFunctionTitle+"\uFF1A</label><input class='formulaInputFocus' id='searchFormulaListInput' placeholder='"+t.tipInputFunctionName+"' spellcheck='false'/></div><div class='selbox'><label>"+t.selectCategory+"\uFF1A</label><select id='formulaTypeSelect'><option value='0'>"+t.Math+"</option><option value='1'>"+t.Statistical+"</option><option value='2'>"+t.Lookup+"</option><option value='3'>"+t.luckysheet+"</option><option value='4'>"+t.dataMining+"</option><option value='5'>"+t.Database+"</option><option value='6'>"+t.Date+"</option><option value='7'>"+t.Filter+"</option><option value='8'>"+t.Financial+"</option><option value='9'>"+t.Engineering+"</option><option value='10'>"+t.Logical+"</option><option value='11'>"+t.Operator+"</option><option value='12'>"+t.Text+"</option><option value='13'>"+t.Parser+"</option><option value='14'>"+t.Array+"</option><option value='-1'>"+t.other+"</option></select></div><div class='listbox'><label>"+t.selectFunctionTitle+"\uFF1A</label><div id='formulaTypeList'></div></div>",botton:'<button id="luckysheet-search-formula-confirm" class="btn btn-primary">'+l.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+l.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-search-formula").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-search-formula").css({left:(u+m-s)/2,top:(f+d-a)/3,"user-select":"none"}).show(),e.formulaListByType("0"),$("#searchFormulaListInput").focus()},formulaListByType:function(e){$("#formulaTypeList").empty();let n=h.functionlist;for(let t=0;t<n.length;t++)(e=="-1"&&n[t].t>14||n[t].t==e)&&$('<div class="listBox" name="'+n[t].n+'"><span>'+n[t].n+"</span><span>"+n[t].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")},formulaParmDialog:function(e,n){let t="",l="",o="",a=Oe(),s=a.formulaMore,u=a.button,f=h.functionlist;for(let _=0;_<f.length;_++)if(f[_].n==e.toUpperCase()){t=f[_].n;for(let S=0;S<f[_].p.length;S++)n==null?o+='<div class="parmBox"><div class="name">'+f[_].p[S].name+'</div><div class="txt"><input class="formulaInputFocus" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="'+s.tipSelectDataRange+'"></i></div><div class="val">=</div></div>':(n[S]==null&&(n[S]=""),o+='<div class="parmBox"><div class="name">'+f[_].p[S].name+'</div><div class="txt"><input class="formulaInputFocus" value="'+n[S]+'" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="'+s.tipSelectDataRange+'"></i></div><div class="val">=</div></div>');l='<div><div class="parmListBox">'+o+'</div><div class="formulaDetails">'+f[_].d+'</div><div class="parmDetailsBox"></div><div class="result">'+s.calculationResult+" = <span></span></div></div>"}$("#luckysheet-search-formula").hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-formula-parm").remove(),$("body").first().append(yt(kl,{id:"luckysheet-search-formula-parm",addclass:"luckysheet-search-formula-parm",title:t,content:l,botton:'<button id="luckysheet-search-formula-parm-confirm" class="btn btn-primary">'+u.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+u.cancel+"</button>",style:"z-index:100003"}));let m=$("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),d=m.outerHeight(),g=m.outerWidth(),b=$(window).width(),y=$(window).height(),p=$(document).scrollLeft(),x=$(document).scrollTop();$("#luckysheet-search-formula-parm").css({left:(b+p-g)/2,top:(y+x-d)/3}).show(),$("#luckysheet-search-formula-parm .parmBox:eq(0) input").focus(),$("#luckysheet-search-formula-parm .parmBox").each(function(_,S){let I=$(S).find(".txt input").val();if(v.getfunctionParam(I).fn==null)if(v.iscelldata(I)){let O=Si(I).data;if(V(O)=="array"){let F=[];for(let D=0;D<O.length;D++)for(let k=0;k<O[D].length;k++){let w=O[D][k];w==null||rt(w.v)?F.push(null):F.push(w.v)}$("#luckysheet-search-formula-parm .parmBox").eq(_).find(".val").text(" = {"+F.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(_).find(".val").text(" = {"+O.v+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(_).find(".val").text(" = {"+I+"}");else $("#luckysheet-search-formula-parm .parmBox").eq(_).find(".val").text(" = {"+new Function("return "+$.trim(v.functionParserExe("="+I)))()+"}")}),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),v.data_parm_index=0,v.rangestart=!0},parmTxtShow:function(e){if(v.getfunctionParam(e).fn==null)if(v.iscelldata(e)){let n=v.getcellrange(e),t=n.row[0],l=n.row[1],o=n.column[0],a=n.column[1],s=h.visibledatarow[l],u=t-1==-1?0:h.visibledatarow[t-1],f=h.visibledatacolumn[a],m=o-1==-1?0:h.visibledatacolumn[o-1];$("#luckysheet-formula-functionrange-select").css({left:m,width:f-m-1,top:u,height:s-u-1}).show(),$("#luckysheet-formula-help-c").hide(),Ti(m,u,f-m-1,s-u-1,n.row,n.column);let d=Si(e).data;if(V(d)=="array"){let g=[];for(let b=0;b<d.length;b++)for(let y=0;y<d[b].length;y++){let p=d[b][y];p==null||rt(p.v)?g.push(null):g.push(p.v)}$("#luckysheet-search-formula-parm .parmBox").eq(v.data_parm_index).find(".val").text(" = {"+g.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(v.data_parm_index).find(".val").text(" = {"+d.v+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(v.data_parm_index).find(".val").text(" = {"+e+"}"),$("#luckysheet-formula-functionrange-select").hide();else{let n;for(let g=0;g<v.getfunctionParam(e).param.length;g++)if(v.iscelldata(v.getfunctionParam(e).param[g])){n=v.getfunctionParam(e).param[g];break}let t=v.getcellrange(n),l=t.row[0],o=t.row[1],a=t.column[0],s=t.column[1],u=h.visibledatarow[o],f=l-1==-1?0:h.visibledatarow[l-1],m=h.visibledatacolumn[s],d=a-1==-1?0:h.visibledatacolumn[a-1];$("#luckysheet-formula-functionrange-select").css({left:d,width:m-d-1,top:f,height:u-f-1}).show(),$("#luckysheet-formula-help-c").hide(),Ti(d,f,m-d-1,u-f-1,t.row,t.column),$("#luckysheet-search-formula-parm .parmBox").eq(v.data_parm_index).find(".val").text(" = {"+new Function("return "+$.trim(v.functionParserExe("="+e)))()+"}")}},functionStrCompute:function(){let e=!0,n=[],t=-1,l=$("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-title-text").text(),o=h.luckysheet_function[l].p;$("#luckysheet-search-formula-parm .parmBox").each(function(u,f){let m=$(f).find(".txt input").val(),d;u<o.length?d=o[u].require:d=o[o.length-1].require,m==""&&d=="m"&&(e=!1),m!=""&&(t=u)});let a;if(t==-1)a="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"()";else if(t==0)a="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+$("#luckysheet-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(let u=0;u<=t;u++)n.push($("#luckysheet-search-formula-parm .parmBox").eq(u).find(".txt input").val());a="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+n.join(",")+")"}let s=v.functionHTMLGenerate(a);if($("#luckysheet-rich-text-editor").html(s),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),e){let u=$.trim(v.functionParserExe($("#luckysheet-rich-text-editor").text())),f=null;try{f=new Function("return "+u)()}catch(m){f=v.error.n}$("#luckysheet-search-formula-parm .result span").text(f)}}},ra=o_});var import_plugin,a_,ht,Mr=Tt(()=>{import_plugin=Le(Be());vr();ar();bn();V1();$c();ji();wr();xo();li();Bi();wa();Mg();W1();Dg();Ns();Ag();Yr();Fo();Gl();Sr();br();Hn();fr();Rs();ir();Qn();Co();Hi();io();mr();xc();pa();ql();Ea();va();gl();jn();Ut();Rl();Es();a_={menu:'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton ${subclass} luckysheet-mousedown-cancel" id="luckysheet-icon-${id}-menuButton">${item}</div>',item:'<div itemvalue="${value}" itemname="${name}" class="luckysheet-cols-menuitem ${sub} luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 0px 3px 1px;"><span style="margin-right:3px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span> ${name} <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel ${iconClass}" style="user-select: none;">${example}</span></div></div>',split:'<div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>',color:'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel luckysheet-menuButton ${sub}" id="${id}"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-color-reset"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${resetColor}</div></div> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" class="luckysheet-color-selected" /> </div> </div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> ${coloritem}</div>',coloritem:'<div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel ${class}"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${name}</div></div>',subcolor:'<div id="luckysheet-icon-${id}-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-menuButton-sub luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" class="luckysheet-color-selected" /> </div> </div></div>',rightclickmenu:null,submenuhide:{},focus:function(e,n){e.attr("id")=="luckysheet-icon-font-family-menuButton"&&Ga(n).num&&(n=Oe().fontarray[parseInt(n)],n==null&&(n=this.defualtFont[itemvalue])),e.find(".luckysheet-cols-menuitem").find("span.icon").html(""),n==null?e.find(".luckysheet-cols-menuitem").eq(0).find("span.icon").html('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'):e.find(".luckysheet-cols-menuitem[itemvalue='"+n+"']").find("span.icon").html('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')},createButtonMenu:function(e){let n="",t=this;for(let l=0;l<e.length;l++){let o=e[l];o.value=="split"?n+=t.split:o.example=="more"?n+=yt(t.item,{value:o.value,name:o.text,example:"",sub:"luckysheet-cols-submenu",iconClass:"iconfont luckysheet-iconfont-youjiantou"}):n+=yt(t.item,{value:o.value,name:o.text,example:o.example,sub:"",iconClass:""})}return n},cancelPaintModel:function(){let e=this;$("#luckysheet-sheettable_0").removeClass("luckysheetPaintCursor"),h.luckysheet_copy_save.dataSheetIndex==h.currentSheetIndex?(h.luckysheet_selection_range=[],Jl()):h.luckysheetfile[$e(h.luckysheet_copy_save.dataSheetIndex)].luckysheet_selection_range=[],h.luckysheet_copy_save={},e.luckysheetPaintModelOn=!1,$("#luckysheetpopover").fadeOut(200,function(){$("#luckysheetpopover").remove()})},luckysheetPaintModelOn:!1,luckysheetPaintSingle:!1,initialMenuButton:function(){let e=this;$("#luckysheet-icon-paintformat").click(function(t){if(!Un()){de.info("",Oe().pivotTable.errorNotAllowEdit);return}t.stopPropagation();let o=Oe().paint;if(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0){Qe()?alert(o.tipSelectRange):de.info("",o.tipSelectRange);return}else if(h.luckysheet_select_save.length>1){Qe()?alert(o.tipNotMulti):de.info("",o.tipNotMulti);return}let a=!1,s=h.luckysheet_select_save[0].row[0],u=h.luckysheet_select_save[0].row[1],f=h.luckysheet_select_save[0].column[0],m=h.luckysheet_select_save[0].column[1];if(a=Ul(h.config,s,u,f,m),a){de.info("\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C","");return}de.popover("<i class='fa fa-paint-brush'></i> "+o.start+"","topCenter",!0,null,o.end,function(){e.cancelPaintModel()}),$("#luckysheet-sheettable_0").addClass("luckysheetPaintCursor"),h.luckysheet_selection_range=[{row:h.luckysheet_select_save[0].row,column:h.luckysheet_select_save[0].column}],Jl();let d=!1,g=!1;for(let b=h.luckysheet_select_save[0].row[0];b<=h.luckysheet_select_save[0].row[1];b++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[b]!=null)){h.config.rowlen!=null&&b in h.config.rowlen&&(d=!0);for(let y=h.luckysheet_select_save[0].column[0];y<=h.luckysheet_select_save[0].column[1];y++){let p=h.flowdata[b][y];V(p)=="object"&&"mc"in p&&p.mc.rs!=null&&(g=!0)}}h.luckysheet_copy_save={dataSheetIndex:h.currentSheetIndex,copyRange:[{row:h.luckysheet_select_save[0].row,column:h.luckysheet_select_save[0].column}],RowlChange:d,HasMC:g},e.luckysheetPaintModelOn=!0,e.luckysheetPaintSingle=!0}),$("#luckysheet-icon-paintformat").dblclick(function(){if(!Un()){de.info("",Oe().pivotTable.errorNotAllowEdit);return}let l=Oe().paint;if(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0){Qe()?alert(l.tipSelectRange):de.info("",l.tipSelectRange);return}else if(h.luckysheet_select_save.length>1){Qe()?alert(l.tipNotMulti):de.info("",l.tipNotMulti);return}de.popover("<i class='fa fa-paint-brush'></i> "+l.start,"topCenter",!0,null,l.end,function(){e.cancelPaintModel()}),$("#luckysheet-sheettable_0").addClass("luckysheetPaintCursor"),h.luckysheet_selection_range=[{row:h.luckysheet_select_save[0].row,column:h.luckysheet_select_save[0].column}],Jl();let o=!1,a=!1;for(let s=h.luckysheet_select_save[0].row[0];s<=h.luckysheet_select_save[0].row[1];s++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[s]!=null)){h.config.rowlen!=null&&s in h.config.rowlen&&(o=!0);for(let u=h.luckysheet_select_save[0].column[0];u<=h.luckysheet_select_save[0].column[1];u++){let f=h.flowdata[s][u];V(f)=="object"&&"mc"in f&&f.mc.rs!=null&&(a=!0)}}h.luckysheet_copy_save={dataSheetIndex:h.currentSheetIndex,copyRange:[{row:h.luckysheet_select_save[0].row,column:h.luckysheet_select_save[0].column}],RowlChange:o,HasMC:a},e.luckysheetPaintModelOn=!0,e.luckysheetPaintSingle=!1}),$("#luckysheet-icon-currency").click(function(){let t=pt.deepCopyFlowData(h.flowdata);e.updateFormat(t,"ct","\xA5 #.00")}),$("#luckysheet-icon-percent").click(function(){let t=pt.deepCopyFlowData(h.flowdata);e.updateFormat(t,"ct","0.00%")}),$("#luckysheet-icon-fmt-decimal-decrease").click(function(){let t=pt.deepCopyFlowData(h.flowdata),l=h.luckysheet_select_save[0].row_focus,o=h.luckysheet_select_save[0].column_focus,a=e.checkstatus(t,l,o,"ct"),s=t[l][o];if(a==null||a.t!="n")return;if(a.fa=="General"&&(a=nl(s.v)[1]),/^(w|W)((0?)|(0\.0+))$/.test(a.fa)){a.fa.indexOf(".")>-1?a.fa.substr(-2)==".0"?e.updateFormat(t,"ct",a.fa.split(".")[0]):e.updateFormat(t,"ct",a.fa.substr(0,a.fa.length-1)):e.updateFormat(t,"ct",a.fa);return}let f="",m="",d=[];if(a.fa.indexOf(".")>-1)d=a.fa.split("."),f=d[0],m=d[1];else return;d=m.split("");let g="";for(let y=d.length-1;y>=0;y--){let p=d[y];if(p!="#"&&p!="0"&&p!=","&&isNaN(parseInt(p)))g=p+g;else break}let b="";if(a.fa.indexOf(".")>-1){let y=m;g.length>0&&(y=m.replace(g,""));let p=y.replace(/#/g,"0");p=p.substr(0,p.length-1),p==""?b=f+g:b=f+"."+p+g}e.updateFormat(t,"ct",b)}),$("#luckysheet-icon-fmt-decimal-increase").click(function(){let t=pt.deepCopyFlowData(h.flowdata),l=h.luckysheet_select_save[0].row_focus,o=h.luckysheet_select_save[0].column_focus,a=e.checkstatus(t,l,o,"ct"),s=t[l][o];if(a==null||a.t!="n")return;if(a.fa=="General"&&(a=nl(s.v)[1]),a.fa=="General"){e.updateFormat(t,"ct","#.0");return}if(/^(w|W)((0?)|(0\.0+))$/.test(a.fa)){a.fa.indexOf(".")>-1?e.updateFormat(t,"ct",a.fa+"0"):a.fa.substr(-1)=="0"?e.updateFormat(t,"ct",a.fa+".0"):e.updateFormat(t,"ct",a.fa+"0.0");return}let f="",m="",d=[];a.fa.indexOf(".")>-1?(d=a.fa.split("."),f=d[0],m=d[1]):m=a.fa,d=m.split("");let g="";for(let y=d.length-1;y>=0;y--){let p=d[y];if(p!="#"&&p!="0"&&p!=","&&isNaN(parseInt(p)))g=p+g;else break}let b="";if(a.fa.indexOf(".")>-1){let y=m;g.length>0&&(y=m.replace(g,""));let p=y.replace(/#/g,"0");p+="0",b=f+"."+p+g}else g.length>0?b=m.replace(g,"")+".0"+g:b=m+".0"+g;e.updateFormat(t,"ct",b)}),$("#luckysheet-icon-fmt-other").click(function(){let t=Oe(),l=t.format,o=t.defaultFmt,a=$(this).attr("id")+"-menuButton",s=$("#"+a);if(s.length==0){let d=o,g=e.createButtonMenu(d),b=yt(e.menu,{id:"fmt-other",item:g,subclass:"",sub:""}),y=[{text:l.moreCurrency+"...",value:"morecurrency",example:""},{text:l.moreDateTime+"...",value:"moredatetime",example:""},{text:l.moreNumber+"...",value:"moredigit",example:""}],p=e.createButtonMenu(y),x=yt(e.menu,{id:"fmtOtherSelf",item:p,subclass:"luckysheet-menuButton-sub"});$("body").first().append(b+x),s=$("#"+a).width(250),e.focus(s),s.find(".luckysheet-cols-menuitem").click(function(){s.hide(),el();let _=$(this),S=_.attr("itemvalue"),I=_.attr("itemname");if($("#luckysheet-icon-fmt-other").find(".luckysheet-toolbar-menu-button-caption").html(" "+I+" "),S=="fmtOtherSelf")return;let O=pt.deepCopyFlowData(h.flowdata);e.focus(s,S),e.updateFormat(O,"ct",S)}),$("#luckysheet-icon-fmtOtherSelf-menuButton").find(".luckysheet-cols-menuitem").click(function(){s.hide(),$("#luckysheet-icon-fmtOtherSelf-menuButton").hide(),el();let _=$(this).attr("itemvalue");Fg.createDialog(_),Fg.init()})}else{let d=$(this).find(".luckysheet-toolbar-menu-button-caption").text().trim(),g=o.find(b=>b.text===d);g&&e.focus(s,g.value)}let u=$(this).outerWidth(),f=s.outerWidth(),m=$(this).offset().left;f>u&&f+m>$("#"+h.container).width()&&(m=m-f+u),qr(s,m,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-font-family").mousedown(function(t){lo(t),t.stopPropagation()}).click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let u=e.createButtonMenu(e.fontSelectList),f=yt(e.menu,{id:"font-family",item:u,subclass:"",sub:""});$("body").first().append(f),l=$("#"+t).width(200),e.focus(l),l.on("click",".luckysheet-cols-menuitem",function(){l.hide(),el();let m=$(this),d=m.attr("itemvalue"),g=m.attr("itemname");e.focus(l,d),$("#luckysheet-icon-font-family").find(".luckysheet-toolbar-menu-button-caption").html(" "+g+" ");let b=pt.deepCopyFlowData(h.flowdata);e.updateFormat(b,"ff",d)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),qr(l,s,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-text-color").mousedown(function(t){lo(t),t.stopPropagation()}).click(function(){let t=pt.deepCopyFlowData(h.flowdata),l=$(this).attr("color");l==null&&(l="#000000"),e.updateFormat(t,"fc",l)}),$("#luckysheet-icon-text-color-menu").mousedown(function(t){lo(t),t.stopPropagation()}).click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Oe(),m=f.toolbar,d=f.button,g=f.alternatingColors,b=[{name:m.alternatingColors+"...",id:"luckysheet-color-alternate",example:""}],y=e.createButtonMenu(b),p="text-color-self",x=yt(e.coloritem,{class:"luckysheet-icon-alternateformat",name:m.alternatingColors+"..."}),_=yt(e.color,{id:t,coloritem:x,colorself:p,sub:"",resetColor:m.resetColor});$("body").first().append(_),l=$("#"+t),$("#"+t).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:d.cancel,chooseText:d.confirm,togglePaletteMoreText:m.customColor,togglePaletteLessText:m.collapse,togglePaletteOnly:!0,clearText:m.clearText,color:lt.defaultTextColor,noColorSelectedText:m.noColorSelectedText,localStorageKey:"spectrum.textcolor"+He.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(S){let I=$(this);S!=null?S=S.toHexString():S="#000";let O=null;$("#luckysheet-icon-text-color .text-color-bar").css("background-color",S),$("#luckysheet-icon-text-color").attr("color",S);let F=pt.deepCopyFlowData(h.flowdata);e.updateFormat(F,"fc",S),l.hide(),el()}}),l.find(".luckysheet-color-reset").click(function(){l.hide(),el();let S=$("#"+t).find(".luckysheet-color-selected");S.val("#000000"),$("#luckysheet-icon-text-color").attr("color",null),S.spectrum("set","#000000"),$("#luckysheet-icon-text-color .luckysheet-color-menu-button-indicator").css("border-bottom-color","#000000");let I=pt.deepCopyFlowData(h.flowdata);e.updateFormat(I,"fc",null)}),l.find(".luckysheet-icon-alternateformat").click(function(){if(l.hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(g.errorInfo):de.info(g.errorInfo,"");return}let S=$.extend(!0,{},h.luckysheet_select_save[0]);xr.rangeIsExists(S)[0]||(xr.modelfocusIndex=0,xr.new(S)),xr.init(),xr.perfect()})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o);let u=$(this).offset().top+26;setTimeout(function(){let f=$("#"+t).find(".luckysheet-color-selected");f.spectrum("set",f.val()),qr(l,s-28,u,"lefttop")},1)}),$("#luckysheet-icon-cell-color").click(function(){let t=pt.deepCopyFlowData(h.flowdata),l=$(this).attr("color");l==null&&(l="#ffffff"),e.updateFormat(t,"bg",l)}),$("#luckysheet-icon-cell-color-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f="cell-color-self",m=Oe(),d=m.toolbar,g=m.button,b=m.alternatingColors,y=yt(e.coloritem,{class:"luckysheet-icon-alternateformat",name:d.alternatingColors+"..."}),p=yt(e.color,{id:t,coloritem:y,colorself:f,sub:"",resetColor:d.resetColor});$("body").first().append(p),l=$("#"+t),$("#"+t).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:lt.defaultCellColor,cancelText:g.cancel,chooseText:g.confirm,togglePaletteMoreText:d.customColor,togglePaletteLessText:d.collapse,togglePaletteOnly:!0,clearText:d.clearText,noColorSelectedText:d.noColorSelectedText,localStorageKey:"spectrum.bgcolor"+He.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(x){let _=$(this);x!=null?x=x.toHexString():x="#fff";let S=null;$("#luckysheet-icon-cell-color .text-color-bar").css("background-color",x),$("#luckysheet-icon-cell-color").attr("color",x);let I=pt.deepCopyFlowData(h.flowdata);e.updateFormat(I,"bg",x),l.hide(),el()}}),l.find(".luckysheet-color-reset").click(function(){l.hide(),el();let x=$("#"+t).find(".luckysheet-color-selected");x.val("#ffffff"),$("#luckysheet-icon-cell-color").attr("color",null),x.spectrum("set","#ffffff"),$("#luckysheet-icon-cell-color .luckysheet-color-menu-button-indicator").css("border-bottom-color","#ffffff");let _=pt.deepCopyFlowData(h.flowdata);e.updateFormat(_,"bg",null)}),l.find(".luckysheet-icon-alternateformat").click(function(){if(!Un()){de.info("",Oe().pivotTable.errorNotAllowEdit);return}if(l.hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(b.errorInfo):de.info(b.errorInfo,"");return}let x=$.extend(!0,{},h.luckysheet_select_save[0]);xr.rangeIsExists(x)[0]||(xr.modelfocusIndex=0,xr.new(x)),xr.init(),xr.perfect()}),$("#"+t).find(".luckysheet-color-selected").val("#fff")}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o);let u=$(this).offset().top+26;setTimeout(function(){let f=$("#"+t).find(".luckysheet-color-selected");f.spectrum("set",f.val()),qr(l,s-28,u,"lefttop")},1)});let n=null;$("#luckysheet-icon-font-size").mousedown(function(t){if(parseInt($("#luckysheet-input-box").css("top"))>0){let l=window.getSelection();if(l.type!="None"){let o=l.getRangeAt(0);o.collapsed||(h.inlineStringEditRange=o.cloneRange())}}lo(t),t.stopPropagation()}).click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=[{text:"9",value:"9",example:""},{text:"10",value:"10",example:""},{text:"11",value:"11",example:""},{text:"12",value:"12",example:""},{text:"14",value:"14",example:""},{text:"16",value:"16",example:""},{text:"18",value:"18",example:""},{text:"20",value:"20",example:""},{text:"22",value:"22",example:""},{text:"24",value:"24",example:""},{text:"26",value:"26",example:""},{text:"28",value:"28",example:""},{text:"36",value:"36",example:""},{text:"48",value:"48",example:""},{text:"72",value:"72",example:""}],m=e.createButtonMenu(f),d=yt(e.menu,{id:"font-size",item:m,subclass:"",sub:""});$("body").first().append(d),l=$("#"+t).width(150),e.focus(l,10),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let g=$(this),b=g.attr("itemvalue"),y=$("#luckysheet-icon-font-size input");$("#luckysheet-icon-font-size").attr("itemvalue",b),e.focus(l,b),y.val(b);let p=pt.deepCopyFlowData(h.flowdata);e.updateFormat(p,"fs",b),clearTimeout(n)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$("#luckysheet-icon-font-size").attr("itemvalue");s==null&&(s=10),e.focus(l,s);let u=$(this).offset().left;a>o&&a+u>$("#"+h.container).width()&&(u=u-a+o),qr(l,u,$(this).offset().top+25,"lefttop")}).find("input.luckysheet-toolbar-textinput").keydown(function(t){lo(t),t.stopPropagation()}).keyup(function(t){if(t.keyCode!=13)return;let l=$(this),o=parseInt(l.val()),a=$("#luckysheet-icon-font-size-menuButton");e.focus(a,o);let s=pt.deepCopyFlowData(h.flowdata);e.updateFormat(s,"fs",o),n=setTimeout(function(){a.hide(),l.blur()},200)}),$("#luckysheet-icon-border-all").click(function(){if(!Un()){de.info("",Oe().pivotTable.errorNotAllowEdit);return}if(!ao(h.currentSheetIndex))return;let t=pt.deepCopyFlowData(h.flowdata),l=$(this).attr("type");l==null&&(l="border-all");let o="luckysheet-icon-borderColor-menuButton",a=$("#"+o).find(".luckysheet-color-selected").val(),s=$("#luckysheetborderSizepreview").attr("itemvalue");(a==null||a=="")&&(a="#000"),(s==null||s=="")&&(s="1");let u=$.extend(!0,{},h.config);u.borderInfo==null&&(u.borderInfo=[]);let f={rangeType:"range",borderType:l,color:a,style:s,range:$.extend(!0,[],h.luckysheet_select_save)};if(u.borderInfo.push(f),h.clearjfundo){h.jfundo.length=0;let m=[];m.type="borderChange",m.config=$.extend(!0,{},h.config),m.curconfig=$.extend(!0,{},u),m.sheetIndex=h.currentSheetIndex,h.jfredo.push(m)}He.saveParam("cg",h.currentSheetIndex,u.borderInfo,{k:"borderInfo"}),h.config=u,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,setTimeout(function(){Et()},1)}),$("#luckysheet-icon-border-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let u=10,f=120,m=Oe(),d=m.border,g=m.toolbar,b=m.button,y=[{text:d.borderTop,value:"border-top",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-top iconfont luckysheet-iconfont-shangbiankuang" style="user-select: none;"> </div> </div>'},{text:d.borderBottom,value:"border-bottom",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-bottom iconfont luckysheet-iconfont-xiabiankuang" style="user-select: none;"> </div> </div>'},{text:d.borderLeft,value:"border-left",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-left iconfont luckysheet-iconfont-zuobiankuang" style="user-select: none;"> </div> </div>'},{text:d.borderRight,value:"border-right",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-right iconfont luckysheet-iconfont-youbiankuang" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:d.borderNone,value:"border-none",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-none iconfont luckysheet-iconfont-wubiankuang" style="user-select: none;"> </div> </div>'},{text:d.borderAll,value:"border-all",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all iconfont luckysheet-iconfont-quanjiabiankuang" style="user-select: none;"> </div> </div>'},{text:d.borderOutside,value:"border-outside",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-outside iconfont luckysheet-iconfont-sizhoujiabiankuang" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:d.borderInside,value:"border-inside",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-inside iconfont luckysheet-iconfont-neikuangxian" style="user-select: none;"> </div> </div>'},{text:d.borderHorizontal,value:"border-horizontal",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-horizontal iconfont luckysheet-iconfont-neikuanghengxian" style="user-select: none;"> </div> </div>'},{text:d.borderVertical,value:"border-vertical",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-vertical iconfont luckysheet-iconfont-neikuangshuxian" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:"<span id='luckysheet-icon-borderColor-linecolor' class='luckysheet-mousedown-cancel' style='border-bottom:3px solid #000;'>"+d.borderColor+"</span>",value:"borderColor",example:"more"},{text:""+d.borderSize+"<img id='luckysheetborderSizepreview' width=100 height=10 src='data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' style='position:absolute;bottom:-5px;right:0px;width:100px;height:10px;'>",value:"borderSize",example:"more"}],p=Uo.border,x=e.createButtonMenu(y),_=yt(e.menu,{id:"border-menu",item:x,subclass:"",sub:""}),S=[{text:d.borderNone,value:"0",example:""},{text:"<canvas type='Thin' class='border-Thin' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"1",example:""},{text:"<canvas type='Hair' class='border-Hair' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"2",example:""},{text:"<canvas type='Dotted' class='border-Dotted' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"3",example:""},{text:"<canvas type='Dashed' class='border-Dashed' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"4",example:""},{text:"<canvas type='DashDot' class='border-DashDot' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"5",example:""},{text:"<canvas type='DashDotDot' class='border-DashDotDot' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"6",example:""},{text:"<canvas type='Medium' class='border-Medium' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"8",example:""},{text:"<canvas type='MediumDashed' class='border-MediumDashed' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"9",example:""},{text:"<canvas type='MediumDashDot' class='border-MediumDashDot' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"10",example:""},{text:"<canvas type='MediumDashDotDot' class='border-MediumDashDotDot' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"11",example:""},{text:"<canvas type='Thick' class='border-Thick' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"13",example:""}],I=e.createButtonMenu(S),O=yt(e.menu,{id:"borderSize",item:I,subclass:"luckysheet-menuButton-sub"}),F="luckysheet-icon-borderSize-menuButton",D="luckysheet-icon-borderColor-menuButton",k=yt(e.color,{id:D,coloritem:"",colorself:"",sub:"luckysheet-menuButton-sub",resetColor:g.resetColor});$("body").first().append(_+k+O),l=$("#"+t).width(170),e.focus(l,"border-all"),$("#"+F+" canvas").each(function(w){let C=$(this).attr("type"),T=$(this).closest(".luckysheet-cols-menuitem").attr("itemvalue"),z=$(this).addClass("luckysheet-mousedown-cancel").get(0).getContext("2d");z.translate(.5,.5),e.setLineDash(z,T,"h",0,5,100,5),z.strokeStyle="#000000",z.stroke(),z.closePath()}),$("#"+F+" .luckysheet-cols-menuitem").click(function(){$("#"+F).hide();let w=$(this),C=w.attr("itemvalue");if(C==0)$("#luckysheetborderSizepreview").attr("src","data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==").attr("itemvalue",null);else{let T=w.find("canvas").get(0).toDataURL("image/png");$("#luckysheetborderSizepreview").attr("src",T).attr("itemvalue",C)}e.focus($("#"+F),C)}),l.find(".luckysheet-cols-menuitem").click(function(){if(!Un()){de.info("",Oe().pivotTable.errorNotAllowEdit);return}l.hide(),el();let w=$(this),C=w.attr("itemvalue");if(C=="borderColor"||C=="borderSize"||!ao(h.currentSheetIndex))return;let T=pt.deepCopyFlowData(h.flowdata),z=$("#"+D).find(".luckysheet-color-selected").val(),A=$("#luckysheetborderSizepreview").attr("itemvalue");(z==null||z=="")&&(z="#000"),(A==null||A=="")&&(A="1");let M=$.extend(!0,{},h.config);M.borderInfo==null&&(M.borderInfo=[]);let P={rangeType:"range",borderType:C,color:z,style:A,range:$.extend(!0,[],h.luckysheet_select_save)};if(M.borderInfo.push(P),h.clearjfundo){h.jfundo.length=0;let E=[];E.type="borderChange",E.config=$.extend(!0,{},h.config),E.curconfig=$.extend(!0,{},M),E.sheetIndex=h.currentSheetIndex,h.jfredo.push(E)}He.saveParam("cg",h.currentSheetIndex,M.borderInfo,{k:"borderInfo"}),h.config=M,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,setTimeout(function(){Et()},1),$("#luckysheet-icon-border-all").attr("type",C),$("#luckysheet-icon-border-all").find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-"+C+p[C]),e.focus(l,C)}),$("#"+D).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:"#000",cancelText:b.cancel,chooseText:b.confirm,togglePaletteMoreText:g.customColor,togglePaletteLessText:g.collapse,togglePaletteOnly:!0,clearText:g.clearText,noColorSelectedText:g.noColorSelectedText,localStorageKey:"spectrum.bordercolor"+He.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(w){let C=$(this);w!=null?w=w.toHexString():w="#000";let T=null;$("#luckysheet-icon-borderColor-linecolor").css("border-bottom-color",w),$("#"+D).find(".luckysheet-color-selected").val(w)}}),$("#"+D).find(".luckysheet-color-reset").click(function(){let w=$("#"+D).find(".luckysheet-color-selected");w.val("#000"),$("#luckysheet-icon-cell-color").attr("color",null),w.spectrum("set","#000"),$("#luckysheet-icon-borderColor-linecolor").css("border-bottom-color","#000")})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),qr(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-merge-button").click(function(){if(!Ro(h.currentSheetIndex))return;if(Ao()){Qe()?alert("\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF"):de.info("\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF","");return}if(h.config.merge!=null){let l=!1;for(let o=0;o<h.luckysheet_select_save.length;o++){let a=h.luckysheet_select_save[o].row[0],s=h.luckysheet_select_save[o].row[1],u=h.luckysheet_select_save[o].column[0],f=h.luckysheet_select_save[o].column[1];if(l=Ul(h.config,a,s,u,f),l)break}if(l){Qe()?alert("\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"):de.info("\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C","");return}}let t=pt.deepCopyFlowData(h.flowdata);e.updateFormat_mc(t,"mergeAll")}),$("#luckysheet-icon-merge-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Oe().merge,m=[{text:f.mergeAll,value:"mergeAll",example:""},{text:f.mergeV,value:"mergeV",example:""},{text:f.mergeH,value:"mergeH",example:""},{text:f.mergeCancel,value:"mergeCancel",example:""}],d=e.createButtonMenu(m),g=yt(e.menu,{id:"merge-menu",item:d,subclass:"",sub:""});$("body").first().append(g),l=$("#"+t),e.focus(l),l.find(".luckysheet-cols-menuitem").click(function(){if(l.hide(),el(),Ao()){Qe()?alert(f.overlappingError):de.info(f.overlappingError,"");return}if(h.config.merge!=null){let x=!1;for(let _=0;_<h.luckysheet_select_save.length;_++){let S=h.luckysheet_select_save[_].row[0],I=h.luckysheet_select_save[_].row[1],O=h.luckysheet_select_save[_].column[0],F=h.luckysheet_select_save[_].column[1];if(x=Ul(h.config,S,I,O,F),x)break}if(x){Qe()?alert(f.partiallyError):de.info(f.partiallyError,"");return}}let b=$(this),y=b.attr("itemvalue");e.focus(l,y);let p=pt.deepCopyFlowData(h.flowdata);e.updateFormat_mc(p,y)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),qr(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-align").click(function(){let t=$("#luckysheet-icon-align").attr("type");t==null&&(t="left");let l=pt.deepCopyFlowData(h.flowdata);e.updateFormat(l,"ht",t)}),$("#luckysheet-icon-align-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Oe().align,m=[{text:f.left,value:"left",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left iconfont luckysheet-iconfont-wenbenzuoduiqi" style="user-select: none;"> </div> </div>'},{text:f.center,value:"center",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-center iconfont luckysheet-iconfont-wenbenjuzhongduiqi" style="user-select: none;"> </div> </div>'},{text:f.right,value:"right",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-right iconfont luckysheet-iconfont-wenbenyouduiqi" style="user-select: none;"> </div> </div>'}],d=Uo.align,g=e.createButtonMenu(m),b=yt(e.menu,{id:"align-menu",item:g,subclass:"",sub:""});$("body").first().append(b),l=$("#"+t).width(120),e.focus(l),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let y=$(this),p=y.attr("itemvalue");e.focus(l,p),$("#luckysheet-icon-align").attr("type",p).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-"+p+d[p]);let _=pt.deepCopyFlowData(h.flowdata);e.updateFormat(_,"ht",p)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),qr(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-valign").click(function(){let t=$("#luckysheet-icon-valign").attr("type");t==null&&(t="bottom");let l=pt.deepCopyFlowData(h.flowdata);e.updateFormat(l,"vt",t)}),$("#luckysheet-icon-valign-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Oe().align;if(l.length==0){let m=[{text:a.top,value:"top",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-top iconfont luckysheet-iconfont-dingbuduiqi" style="user-select: none;"> </div> </div>'},{text:a.middle,value:"middle",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-middle iconfont luckysheet-iconfont-shuipingduiqi" style="user-select: none;"> </div> </div>'},{text:a.bottom,value:"bottom",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom iconfont luckysheet-iconfont-dibuduiqi" style="user-select: none;"> </div> </div>'}],d=Uo.align,g=e.createButtonMenu(m),b=yt(e.menu,{id:"valign-menu",item:g,subclass:"",sub:""});$("body").first().append(b),l=$("#"+t).width(120),e.focus(l,"bottom"),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let y=$(this),p=y.attr("itemvalue");e.focus(l,p),$("#luckysheet-icon-valign").attr("type",p).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-"+p+d[p]);let _=pt.deepCopyFlowData(h.flowdata);e.updateFormat(_,"vt",p)})}let s=$(this).outerWidth(),u=l.outerWidth(),f=$(this).offset().left;u>s&&u+f>$("#"+h.container).width()&&(f=f-u+s),qr(l,f-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-textwrap-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Oe().textWrap,m=[{text:f.overflow,value:"overflow",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-overflow iconfont luckysheet-iconfont-yichu1" style="user-select: none;"> </div> </div>'},{text:f.wrap,value:"wrap",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-wrap iconfont luckysheet-iconfont-zidonghuanhang" style="user-select: none;"> </div> </div>'},{text:f.clip,value:"clip",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-clip iconfont luckysheet-iconfont-jieduan" style="user-select: none;"> </div> </div>'}],d=Uo.textWrap,g=e.createButtonMenu(m),b=yt(e.menu,{id:"textwrap-menu",item:g,subclass:"",sub:""});$("body").first().append(b),l=$("#"+t).width(120),e.focus(l,"clip"),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let y=$(this),p=y.attr("itemvalue");e.focus(l,p),$("#luckysheet-icon-textwrap").attr("type",p).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-"+p+d[p]);let _=pt.deepCopyFlowData(h.flowdata);e.updateFormat(_,"tb",p)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),qr(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-rotation-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Oe().rotation,m=[{text:f.none,value:"none",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wuxuanzhuang" style="user-select: none;"> </div> </div>'},{text:f.angleup,value:"angleup",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angleup iconfont luckysheet-iconfont-xiangshangqingxie" style="user-select: none;"> </div> </div>'},{text:f.angledown,value:"angledown",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angledown iconfont luckysheet-iconfont-xiangxiaqingxie" style="user-select: none;"> </div> </div>'},{text:f.vertical,value:"vertical",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-vertical iconfont luckysheet-iconfont-shupaiwenzi" style="user-select: none;"> </div> </div>'},{text:f.rotationUp,value:"rotation-up",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-up iconfont luckysheet-iconfont-wenbenxiangshang" style="user-select: none;"> </div> </div>'},{text:f.rotationDown,value:"rotation-down",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-down iconfont luckysheet-iconfont-xiangxia90" style="user-select: none;"> </div> </div>'}],d=Uo.rotation,g=e.createButtonMenu(m),b=yt(e.menu,{id:"rotation-menu",item:g,subclass:"",sub:""});$("body").first().append(b),l=$("#"+t).width(160),e.focus(l),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let y=$(this),p=y.attr("itemvalue");e.focus(l,p),$("#luckysheet-icon-rotation").attr("type",p).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-"+p+d[p]);let _=pt.deepCopyFlowData(h.flowdata);e.updateFormat(_,"tr",p)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),qr(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-freezen-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Oe().freezen,m=[{text:f.freezenRow,value:"freezenRow",example:""},{text:f.freezenColumn,value:"freezenColumn",example:""},{text:f.freezenRC,value:"freezenRC",example:""},{text:"",value:"split",example:""},{text:f.freezenRowRange,value:"freezenRowRange",example:""},{text:f.freezenColumnRange,value:"freezenColumnRange",example:""},{text:f.freezenRCRange,value:"freezenRCRange",example:""},{text:"",value:"split",example:""},{text:f.freezenCancel,value:"freezenCancel",example:""}],d=e.createButtonMenu(m),g=yt(e.menu,{id:"freezen-menu",item:d,subclass:"",sub:""});$("body").first().append(g),l=$("#"+t).width(170),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let b=$(this),y=b.attr("itemvalue");if(e.focus(l,y),y==="freezenCancel"&&l.find(".fa.fa-check").remove(),we.saveFrozen(y),y=="freezenRow")zh();else if(y=="freezenColumn")Oh();else if(y=="freezenRC"){if(we.freezenRealFirstRowColumn){let p=0,x=h.visibledatarow[p]-2+h.columnHeaderHeight,_=[h.visibledatarow[p],p+1,0,we.cutVolumn(h.visibledatarow,p+1),x];we.saveFreezen(_,x,null,null),we.createFreezenHorizontal(_,x);let S=0,I=h.visibledatacolumn[S]-2+h.rowHeaderWidth,O=[h.visibledatacolumn[S],S+1,0,we.cutVolumn(h.visibledatacolumn,S+1),I];we.saveFreezen(null,null,O,I),we.createFreezenVertical(O,I)}else{let p=$("#luckysheet-cell-main").scrollTop(),x=al(h.visibledatarow,p);x==-1&&(x=0);let _=h.visibledatarow[x]-2-p+h.columnHeaderHeight,S=[h.visibledatarow[x],x+1,p,we.cutVolumn(h.visibledatarow,x+1),_];we.saveFreezen(S,_,null,null),we.createFreezenHorizontal(S,_);let I=$("#luckysheet-cell-main").scrollLeft(),O=al(h.visibledatacolumn,I);O==-1&&(O=0);let F=h.visibledatacolumn[O]-2-I+h.rowHeaderWidth,D=[h.visibledatacolumn[O],O+1,I,we.cutVolumn(h.visibledatacolumn,O+1),F];we.saveFreezen(null,null,D,F),we.createFreezenVertical(D,F)}we.createAssistCanvas(),Et()}else if(y=="freezenRowRange"){if(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0){Qe()?alert(f.noSeletionError):de.info(f.noSeletionError,"");return}let p=h.luckysheet_select_save[h.luckysheet_select_save.length-1].top;if(we.freezenRealFirstRowColumn&&p>$("#luckysheet-cell-main").height())return de.info(f.rangeRCOverErrorTitle,f.rangeRCOverError);let x=$("#luckysheet-cell-main").scrollTop(),_=al(h.visibledatarow,x),S=h.luckysheet_select_save[h.luckysheet_select_save.length-1],I=S.row_focus==null?S.row[0]:S.row_focus;I>_&&(_=I),_==-1&&(_=0);let O,F;we.freezenRealFirstRowColumn?(O=h.visibledatarow[_]-2+h.columnHeaderHeight,F=[h.visibledatarow[_],_+1,0,we.cutVolumn(h.visibledatarow,_+1),O]):(O=h.visibledatarow[_]-2-x+h.columnHeaderHeight,F=[h.visibledatarow[_],_+1,x,we.cutVolumn(h.visibledatarow,_+1),O]),we.saveFreezen(F,O,null,null),we.freezenverticaldata!=null&&(we.cancelFreezenVertical(),we.createAssistCanvas(),Et()),we.createFreezenHorizontal(F,O),we.createAssistCanvas(),Et()}else if(y=="freezenColumnRange"){if(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0){Qe()?alert(f.noSeletionError):de.info(f.noSeletionError,"");return}let p=h.luckysheet_select_save[h.luckysheet_select_save.length-1].left;if(we.freezenRealFirstRowColumn&&p>$("#luckysheet-cell-main").width())return de.info(f.rangeRCOverErrorTitle,f.rangeRCOverError);let x=$("#luckysheet-cell-main").scrollLeft(),_=al(h.visibledatacolumn,x),S=h.luckysheet_select_save[h.luckysheet_select_save.length-1],I=S.column_focus==null?S.column[0]:S.column_focus;I>_&&(_=I),_==-1&&(_=0);let O,F;we.freezenRealFirstRowColumn?(O=h.visibledatacolumn[_]-2+h.rowHeaderWidth,F=[h.visibledatacolumn[_],_+1,0,we.cutVolumn(h.visibledatacolumn,_+1),O]):(O=h.visibledatacolumn[_]-2-x+h.rowHeaderWidth,F=[h.visibledatacolumn[_],_+1,x,we.cutVolumn(h.visibledatacolumn,_+1),O]),we.saveFreezen(null,null,F,O),we.freezenhorizontaldata!=null&&(we.cancelFreezenHorizontal(),we.createAssistCanvas(),Et()),we.createFreezenVertical(F,O),we.createAssistCanvas(),Et()}else if(y=="freezenRCRange"){if(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0){Qe()?alert(f.noSeletionError):de.info(f.noSeletionError,"");return}let p=h.luckysheet_select_save[h.luckysheet_select_save.length-1].top,x=h.luckysheet_select_save[h.luckysheet_select_save.length-1].left;if(we.freezenRealFirstRowColumn&&(p>$("#luckysheet-cell-main").height()||x>$("#luckysheet-cell-main").width()))return de.info(f.rangeRCOverErrorTitle,f.rangeRCOverError);let _=$("#luckysheet-cell-main").scrollTop(),S=al(h.visibledatarow,_),I=h.luckysheet_select_save[h.luckysheet_select_save.length-1],O=I.row_focus==null?I.row[0]:I.row_focus;O>S&&(S=O),S==-1&&(S=0);let F,D;we.freezenRealFirstRowColumn?(F=h.visibledatarow[S]-2+h.columnHeaderHeight,D=[h.visibledatarow[S],S+1,0,we.cutVolumn(h.visibledatarow,S+1),F],we.saveFreezen(D,F,null,null)):(F=h.visibledatarow[S]-2-_+h.columnHeaderHeight,D=[h.visibledatarow[S],S+1,_,we.cutVolumn(h.visibledatarow,S+1),F],we.saveFreezen(D,F,null,null)),we.createFreezenHorizontal(D,F);let k=$("#luckysheet-cell-main").scrollLeft(),w=al(h.visibledatacolumn,k),C=I.column_focus==null?I.column[0]:I.column_focus;C>w&&(w=C),w==-1&&(w=0);let T,z;we.freezenRealFirstRowColumn?(T=h.visibledatacolumn[w]-2+h.rowHeaderWidth,z=[h.visibledatacolumn[w],w+1,0,we.cutVolumn(h.visibledatacolumn,w+1),T]):(T=h.visibledatacolumn[w]-2-k+h.rowHeaderWidth,z=[h.visibledatacolumn[w],w+1,k,we.cutVolumn(h.visibledatacolumn,w+1),T]),we.saveFreezen(null,null,z,T),we.createFreezenVertical(z,T),we.createAssistCanvas(),Et()}else y=="freezenCancel"&&(we.freezenverticaldata!=null&&(we.cancelFreezenVertical(),we.createAssistCanvas(),Et()),we.freezenhorizontaldata!=null&&(we.cancelFreezenHorizontal(),we.createAssistCanvas(),Et()),we.scrollAdapt());setTimeout(function(){Kl()},0)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),qr(l,s-68,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-autofilter").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let u=Oe(),f=u.sort,m=u.filter,d=[{text:f.asc,value:"asc",example:'<i class="iconfont luckysheet-iconfont-shengxu" aria-hidden="true"></i>'},{text:f.desc,value:"desc",example:'<i class="iconfont luckysheet-iconfont-jiangxu" aria-hidden="true"></i>'},{text:f.custom+"...",value:"diysort",example:'<i class="iconfont luckysheet-iconfont-zidingyipaixu" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:m.filter,value:"filter",example:'<i class="iconfont luckysheet-iconfont-shaixuan2" aria-hidden="true"></i>'},{text:m.clearFilter,value:"clearfilter",example:'<i class="iconfont luckysheet-iconfont-qingchushaixuan" aria-hidden="true"></i>'}],g=e.createButtonMenu(d),b=yt(e.menu,{id:"autofilter",item:g,subclass:"",sub:""});$("body").first().append(b),l=$("#"+t).width(150),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let y=$(this),p=y.attr("itemvalue");p=="diysort"?$("#luckysheetorderby").click():p=="asc"?Vm(!0):p=="desc"?Vm(!1):p=="filter"?$("#luckysheet-filter-options-sheet"+h.currentSheetIndex).length>0?$("#luckysheet-filter-initial").click():Ou():p=="clearfilter"&&$("#luckysheet-filter-initial").click()})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),qr(l,s,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-seachmore").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Oe().findAndReplace;if(l.length==0){let m=[{text:a.find+" ...",value:"search",example:'<i class="iconfont luckysheet-iconfont-sousuo" aria-hidden="true"></i>'},{text:a.replace+" ...",value:"replace",example:'<i class="iconfont luckysheet-iconfont-tihuan" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:a.location+" ...",value:"location",example:'<i class="iconfont luckysheet-iconfont-dingwei" aria-hidden="true"></i>'},{text:a.formula,value:"locationFormula",example:a.locationExample},{text:a.date,value:"locationConstantDate",example:a.locationExample},{text:a.number,value:"locationConstantNumber",example:a.locationExample},{text:a.string,value:"locationConstantString",example:a.locationExample},{text:a.error,value:"locationConstantError",example:a.locationExample},{text:a.condition,value:"locationCF",example:a.locationExample},{text:a.rowSpan,value:"locationStepRow",example:a.locationExample},{text:a.columnSpan,value:"locationStepColumn",example:a.locationExample}],d=e.createButtonMenu(m),g=yt(e.menu,{id:"seachmore",item:d,subclass:"",sub:""});$("body").first().append(g),l=$("#"+t).width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let b=$(this),y=b.attr("itemvalue");if(y=="search"||y=="replace")y=="search"?Ta.createDialog(0):y=="replace"&&Ta.createDialog(1),Ta.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(y=="location")zo.createDialog(),zo.init();else if(y=="locationFormula"||y=="locationConstantDate"||y=="locationConstantNumber"||y=="locationConstantString"||y=="locationConstantError"||y=="locationCF"){let p=h.luckysheet_select_save[0],x;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&p.row[0]==p.row[1]&&p.column[0]==p.column[1]?x=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:x=$.extend(!0,[],h.luckysheet_select_save),y=="locationFormula"?zo.apply(x,"locationFormula","all"):y=="locationConstantDate"?zo.apply(x,"locationConstant","d"):y=="locationConstantNumber"?zo.apply(x,"locationConstant","n"):y=="locationConstantString"?zo.apply(x,"locationConstant","s,g"):y=="locationConstantError"?zo.apply(x,"locationConstant","e"):y=="locationCF"&&zo.apply(x,"locationCF")}else if(y=="locationStepRow"){if(h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]){Qe()?alert(a.lessTwoRowTip):de.info("",a.lessTwoRowTip);return}let p=$.extend(!0,[],h.luckysheet_select_save);zo.apply(p,"locationStepRow")}else if(y=="locationStepColumn"){if(h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]){Qe()?alert(a.lessTwoColumnTip):de.info("",a.lessTwoColumnTip);return}let p=$.extend(!0,[],h.luckysheet_select_save);zo.apply(p,"locationStepColumn")}})}let s=$(this).outerWidth(),u=l.outerWidth(),f=$(this).offset().left;u>s&&u+f>$("#"+h.container).width()&&(f=f-u+s),qr(l,f,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-function").click(function(){e.autoSelectionFormula("SUM")}),$("#luckysheet-icon-function-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Oe().formula;if(l.length==0){let m=[{text:a.sum,value:"SUM",example:"SUM"},{text:a.average,value:"AVERAGE",example:"AVERAGE"},{text:a.count,value:"COUNT",example:"COUNT"},{text:a.max,value:"MAX",example:"MAX"},{text:a.min,value:"MIN",example:"MIN"},{text:"",value:"split",example:""},{text:a.ifGenerate,value:"if",example:"IF"},{text:a.find+" ...",value:"formula",example:""}],d=e.createButtonMenu(m),g=yt(e.menu,{id:"function-menu",item:d,subclass:"",sub:""});$("body").first().append(g),l=$("#"+t).width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let b=$(this),y=b.attr("itemvalue");if(y=="if"){let p=h.luckysheet_select_save[h.luckysheet_select_save.length-1],x=p.row_focus==null?p.row[0]:p.row_focus,_=p.column_focus==null?p.column[0]:p.column_focus;if(!!h.flowdata[x]&&!!h.flowdata[x][_]&&!!h.flowdata[x][_].f){let S=h.flowdata[x][_].f.toString();if(S.indexOf("=if(")!=-1)Vc.ifFormulaDialog(S);else{Qe()?alert(a.tipNotBelongToIf):de.info(a.tipNotBelongToIf,"");return}}else Vc.ifFormulaDialog();Vc.init()}else if(y=="formula"){if(h.luckysheet_select_save.length==0){Qe()?alert(a.tipSelectCell):de.info(a.tipSelectCell,"");return}let p=h.luckysheet_select_save[h.luckysheet_select_save.length-1],x=p.row_focus,_=p.column_focus;Dn(x,_,h.flowdata);let S=h.flowdata[x][_];if(S!=null&&S.f!=null){let I=v.getfunctionParam(S.f);I.fn!=null?ra.formulaParmDialog(I.fn,I.param):ra.formulaListDialog()}else $("#luckysheet-rich-text-editor").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),ra.formulaListDialog();ra.init()}else e.autoSelectionFormula(y)})}let s=$(this).outerWidth(),u=l.outerWidth(),f=$(this).offset().left;u>s&&u+f>$("#"+h.container).width()&&(f=f-u+s),qr(l,f-48,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-bold").mousedown(function(t){lo(t),t.stopPropagation()}).click(function(t){let l=pt.deepCopyFlowData(h.flowdata),a=jc("bl",1)?0:1;e.updateFormat(l,"bl",a)}),$("#luckysheet-icon-italic").mousedown(function(t){lo(t),t.stopPropagation()}).click(function(){let t=pt.deepCopyFlowData(h.flowdata),o=jc("it",1)?0:1;e.updateFormat(t,"it",o)}),$("#luckysheet-icon-strikethrough").mousedown(function(t){lo(t),t.stopPropagation()}).click(function(){let t=pt.deepCopyFlowData(h.flowdata),o=jc("cl",1)?0:1;e.updateFormat(t,"cl",o)}),$("#luckysheet-icon-underline").mousedown(function(t){lo(t),t.stopPropagation()}).click(function(){let t=pt.deepCopyFlowData(h.flowdata),o=jc("un",1)?0:1;e.updateFormat(t,"un",o)}),$("#luckysheet-icon-conditionformat").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),o=Oe().conditionformat;if(l.length==0){let f=[{text:o.highlightCellRules,value:"highlightCellRule",example:"more"},{text:o.itemSelectionRules,value:"projectSelectRule",example:"more"},{text:o.dataBar,value:"dataBar",example:"more"},{text:o.colorGradation,value:"colorGradation",example:"more"},{text:o.icons,value:"icons",example:""},{text:"",value:"split",example:""},{text:o.newRule,value:"newRule",example:""},{text:o.deleteRule,value:"deleteRule",example:"more"},{text:o.manageRules,value:"administerRule",example:""}],m=e.createButtonMenu(f),d=yt(e.menu,{id:"conditionformat",item:m,subclass:"",sub:""}),g=[{text:o.greaterThan,value:"greaterThan",example:">"},{text:o.lessThan,value:"lessThan",example:"<"},{text:o.between,value:"betweenness",example:"[]"},{text:o.equal,value:"equal",example:"="},{text:o.textContains,value:"textContains",example:"()"},{text:o.occurrence,value:"occurrenceDate",example:o.yesterday},{text:o.duplicateValue,value:"duplicateValue",example:"##"}],b=e.createButtonMenu(g),y=yt(e.menu,{id:"highlightCellRule",item:b,subclass:"luckysheet-menuButton-sub"}),p=[{text:o.top10,value:"top10",example:o.top10},{text:o.top10_percent,value:"top10%",example:o.top10_percent},{text:o.last10,value:"last10",example:o.last10},{text:o.last10_percent,value:"last10%",example:o.last10_percent},{text:o.aboveAverage,value:"AboveAverage",example:o.above},{text:o.belowAverage,value:"SubAverage",example:o.below}],x=e.createButtonMenu(p),_=yt(e.menu,{id:"projectSelectRule",item:x,subclass:"luckysheet-menuButton-sub"}),S=`<div id="luckysheet-icon-dataBar-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel" style="width: 126px;padding: 5px;top: 118.5px;left: 1321.48px;display: none;">
                                    <div itemvalue="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="${o.gradientDataBar_1}"></div>
                                    </div>
                                    <div itemvalue="1" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="${o.gradientDataBar_2}"></div>
                                    </div>
                                    <div itemvalue="2" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="${o.gradientDataBar_3}"></div>
                                    </div>
                                    <div itemvalue="3" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="${o.gradientDataBar_4}"></div>
                                    </div>
                                    <div itemvalue="4" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="${o.gradientDataBar_5}"></div>
                                    </div>
                                    <div itemvalue="5" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="${o.gradientDataBar_6}"></div>
                                    </div>
                                    <div itemvalue="6" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="${o.solidColorDataBar_1}"></div>
                                    </div>
                                    <div itemvalue="7" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="${o.solidColorDataBar_2}"></div>
                                    </div>
                                    <div itemvalue="8" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="${o.solidColorDataBar_3}"></div>
                                    </div>
                                    <div itemvalue="9" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -108px;" title="${o.solidColorDataBar_4}"></div>
                                    </div>
                                    <div itemvalue="10" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -108px;" title="${o.solidColorDataBar_5}"></div>
                                    </div>
                                    <div itemvalue="11" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -108px;" title="${o.solidColorDataBar_6}"></div>
                                    </div>
                                </div>`,I=`<div id="luckysheet-icon-colorGradation-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel" style="width: 126px;padding: 5px;top: 143.5px;left: 1321.48px;display: none;">
                                    <div itemvalue="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="${o.colorGradation_1}"></div>
                                    </div>
                                    <div itemvalue="1" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="${o.colorGradation_2}"></div>
                                    </div>
                                    <div itemvalue="2" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="${o.colorGradation_3}"></div>
                                    </div>
                                    <div itemvalue="3" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px 0;" title="${o.colorGradation_4}"></div>
                                    </div>
                                    <div itemvalue="4" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="${o.colorGradation_5}"></div>
                                    </div>
                                    <div itemvalue="5" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="${o.colorGradation_6}"></div>
                                    </div>
                                    <div itemvalue="6" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="${o.colorGradation_7}"></div>
                                    </div>
                                    <div itemvalue="7" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px -36px;" title="${o.colorGradation_8}"></div>
                                    </div>
                                    <div itemvalue="8" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="${o.colorGradation_9}"></div>
                                    </div>
                                    <div itemvalue="9" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="${o.colorGradation_10}"></div>
                                    </div>
                                    <div itemvalue="10" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="${o.colorGradation_11}"></div>
                                    </div>
                                    <div itemvalue="11" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px -72px;" title="${o.colorGradation_12}"></div>
                                    </div>
                                </div>`,O=[{text:o.deleteSheetRule,value:"delSheet",example:""}],F=e.createButtonMenu(O),D=yt(e.menu,{id:"deleteRule",item:F,subclass:"luckysheet-menuButton-sub"});$("body").first().append(d+y+_+S+I+D),l=$("#"+t).width(190),$("#luckysheet-icon-highlightCellRule-menuButton").width(160),$("#luckysheet-icon-projectSelectRule-menuButton").width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let k=$(this),w=k.attr("itemvalue");if(w=="icons"){if(h.luckysheet_select_save.length==0){Qe()?alert(o.pleaseSelectRange):de.info(o.pleaseSelectRange,"");return}xt.CFiconsDialog(),xt.init()}else if(w=="newRule"){if(h.luckysheet_select_save.length==0){Qe()?alert(o.pleaseSelectRange):de.info(o.pleaseSelectRange,"");return}xt.newConditionRuleDialog(0),xt.init()}else if(w=="administerRule"){let C=He.loadSheetUrl,T=Yl();if(C!=""&&C!=null){let z=[];for(let A=0;A<T.length;A++)z.push(T[A].index);$.post(C,{gridKey:He.gridKey,index:z.join(",")},function(A){let M=new Function("return "+A)();setTimeout(function(){h.loadingObj.close()},500);for(let P in M){if(P==h.currentSheetIndex)continue;let N=T[$e(P)];N.celldata=M[P.toString()],N.data=ct.buildGridData(N)}vs(T),xt.fileClone=$.extend(!0,[],T),xt.administerRuleDialog(),xt.init()})}else xt.fileClone=$.extend(!0,[],T),xt.administerRuleDialog(),xt.init()}}),$(document).off("click.CFhighlightCellRule").on("click.CFhighlightCellRule","#luckysheet-icon-highlightCellRule-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-highlightCellRule-menuButton").hide(),el();let k=$(this),w=k.attr("itemvalue");if(h.luckysheet_select_save.length==0){Qe()?alert(o.pleaseSelectRange):de.info(o.pleaseSelectRange,"");return}else{let C=xt.textCellColorHtml(),T,z;switch(w){case"greaterThan":T=o.conditionformat_greaterThan,z=`<div class="box" data-itemvalue="greaterThan">
                                                <div class="boxTitleOne">${o.conditionformat_greaterThan_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div> 
                                                ${C} 
                                            </div>`;break;case"lessThan":T=o.conditionformat_lessThan,z=`<div class="box" data-itemvalue="lessThan">
                                                <div class="boxTitleOne">${o.conditionformat_lessThan_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"betweenness":T=o.conditionformat_betweenness,z=`<div class="box" data-itemvalue="betweenness">
                                                <div class="boxTitleOne">${o.conditionformat_betweenness_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div class="inpbox2 range">
                                                        <input id="conditionVal" class="formulaInputFocus"/>
                                                        <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.to}</div>
                                                    <div class="inpbox2 range">
                                                        <input id="conditionVal2" class="formulaInputFocus"/>
                                                        <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                    </div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"equal":T=o.conditionformat_equal,z=`<div class="box" data-itemvalue="equal">
                                                <div class="boxTitleOne">${o.conditionformat_equal_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"textContains":T=o.conditionformat_textContains,z=`<div class="box" data-itemvalue="textContains">
                                                <div class="boxTitleOne">${o.conditionformat_textContains_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"occurrenceDate":T=o.conditionformat_occurrenceDate,z=`<div class="box" data-itemvalue="occurrenceDate">
                                                <div class="boxTitleOne">${o.conditionformat_occurrenceDate_title}\uFF1A</div>
                                                <div class="inpbox">
                                                    <input id="daterange-btn" class="formulaInputFocus" readonly="readonly" placeholder="${o.pleaseSelectADate}"/>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"duplicateValue":T=o.conditionformat_duplicateValue,z=`<div class="box" data-itemvalue="duplicateValue">
                                                <div class="boxTitleOne">${o.conditionformat_duplicateValue_title}\uFF1A</div>
                                                <select id="conditionVal" class="selectbox">
                                                    <option value="0">${o.duplicateValue}</option>
                                                    <option value="1">${o.uniqueValue}</option>
                                                </select>
                                                <div style="margin:5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break}xt.conditionformatDialog(T,z)}}),$(document).off("click.CFprojectSelectRule").on("click.CFprojectSelectRule","#luckysheet-icon-projectSelectRule-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-projectSelectRule-menuButton").hide(),el();let k=$(this),w=k.attr("itemvalue");if(h.luckysheet_select_save.length==0){Qe()?alert(o.pleaseSelectRange):de.info(o.pleaseSelectRange,"");return}else{let C=xt.textCellColorHtml(),T,z;switch(w){case"top10":T=o.conditionformat_top10,z=`<div class="box" data-itemvalue="top10">
                                                <div class="boxTitleOne">${o.conditionformat_top10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.top}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.oneself}</div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"top10%":T=o.conditionformat_top10_percent,z=`<div class="box" data-itemvalue="top10%">
                                                <div class="boxTitleOne">${o.conditionformat_top10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.top}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"last10":T=o.conditionformat_last10,z=`<div class="box" data-itemvalue="last10">
                                                <div class="boxTitleOne">${o.conditionformat_last10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.last}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.oneself}</div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"last10%":T=o.conditionformat_last10_percent,z=`<div class="box" data-itemvalue="last10%">
                                                <div class="boxTitleOne">${o.conditionformat_last10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.last}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div>
                                                </div>
                                                <div style="margin:5px 0;">\u8BBE\u7F6E\u4E3A\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"AboveAverage":T=o.conditionformat_AboveAverage,z=`<div class="box" data-itemvalue="AboveAverage">
                                                <div class="boxTitleOne">${o.conditionformat_AboveAverage_title}\uFF1A</div>
                                                <div style="margin: 5px 0;">${o.setAsByArea}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"SubAverage":T=o.conditionformat_SubAverage,z=`<div class="box" data-itemvalue="SubAverage">
                                                <div class="boxTitleOne">${o.conditionformat_SubAverage_title}\uFF1A</div>
                                                <div style="margin: 5px 0;">${o.setAsByArea}\uFF1A</div>
                                                ${C}
                                            </div>`;break}xt.conditionformatDialog(T,z)}}),$(document).off("click.CFdataBar").on("click.CFdataBar","#luckysheet-icon-dataBar-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-dataBar-menuButton").hide(),el();let k=$(this),w=k.attr("itemvalue");if(h.luckysheet_select_save.length>0){let C=$.extend(!0,[],h.luckysheet_select_save),T=xt.dataBarList[w].format;xt.updateItem("dataBar",C,T)}}),$(document).off("click.CFcolorGradation").on("click.CFcolorGradation","#luckysheet-icon-colorGradation-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-colorGradation-menuButton").hide(),el();let k=$(this),w=k.attr("itemvalue");if(h.luckysheet_select_save.length>0){let C=$.extend(!0,[],h.luckysheet_select_save),T=xt.colorGradationList[w].format;xt.updateItem("colorGradation",C,T)}}),$(document).off("click.CFdeleteRule").on("click.CFdeleteRule","#luckysheet-icon-deleteRule-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-deleteRule-menuButton").hide(),el(),$(this).attr("itemvalue")=="delSheet"&&xt.updateItem("delSheet")})}let a=$(this).outerWidth(),s=l.outerWidth(),u=$(this).offset().left;s>a&&s+u>$("#"+h.container).width()&&(u=u-s+a),qr(l,u,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-postil").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),o=Oe().comment;l.remove(),Nt.removeActivePs();let a=h.luckysheet_select_save[h.luckysheet_select_save.length-1],s=a.row_focus;s==null&&(s=a.row[0]);let u=a.column_focus;u==null&&(u=a.column[0]);let f;h.flowdata[s][u]!=null&&h.flowdata[s][u].ps!=null?f=[{text:o.edit,value:"editPs",example:""},{text:o.delete,value:"delPs",example:""},{text:"",value:"split",example:""},{text:o.showOne,value:"showHidePs",example:""},{text:o.showAll,value:"showHideAllPs",example:""}]:f=[{text:o.insert,value:"newPs",example:""},{text:"",value:"split",example:""},{text:o.showAll,value:"showHideAllPs",example:""}];let m=e.createButtonMenu(f),d=yt(e.menu,{id:"postil",item:m,subclass:"",sub:""});$("body").first().append(d),l=$("#"+t).width(150),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let p=$(this),x=p.attr("itemvalue");x=="newPs"?Nt.newPs(s,u):x=="editPs"?Nt.editPs(s,u):x=="delPs"?Nt.delPs(s,u):x=="showHidePs"?Nt.showHidePs(s,u):x=="showHideAllPs"&&Nt.showHideAllPs()});let g=$(this).outerWidth(),b=l.outerWidth(),y=$(this).offset().left;b>g&&b+y>$("#"+h.container).width()&&(y=y-b+g),qr(l,y,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-protection").click(function(){let t=ct.getSheetByIndex();Uy(t)}),$("#luckysheet-icon-print").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Oe().print;if(l.length==0){let m=[{text:a.menuItemPrint,value:"print",example:'<i class="iconfont luckysheet-iconfont-dayin" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:a.menuItemAreas,value:"areas",example:'<i class="iconfont luckysheet-iconfont-tihuan" aria-hidden="true"></i>'},{text:a.menuItemRows,value:"rows",example:'<i class="iconfont luckysheet-iconfont-zhuandao1" aria-hidden="true"></i>'},{text:a.menuItemColumns,value:"columns",example:'<i class="iconfont luckysheet-iconfont-dingwei" aria-hidden="true"></i>'}],d=e.createButtonMenu(m),g=yt(e.menu,{id:"print",item:d,subclass:"",sub:""});$("body").first().append(g),l=$("#"+t).width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),el();let b=$(this),y=b.attr("itemvalue");y=="print"?alert("print"):(y=="areas"||y=="rows"||y=="columns")&&alert("areas")})}let s=$(this).outerWidth(),u=l.outerWidth(),f=$(this).offset().left;u>s&&u+f>$("#"+h.container).width()&&(f=f-u+s),qr(l,f,$(this).offset().top+25,"lefttop")}),$("body").first().on("mouseover mouseleave",".luckysheet-menuButton .luckysheet-cols-submenu",function(t){let l=$(this),o=l.attr("itemvalue"),a=$("#luckysheet-icon-"+o+"-menuButton");if(t.type==="mouseover"){let s=l.parent(),u=$(window).width(),f=$(window).height(),m=s.width(),d=a.height()+25,g=a.width()+5,b=l.offset(),y=b.top,p=b.left+m;p+g>u&&(p=b.left-g),y+d>f&&(y=f-d),a.css({top:y,left:p}).show(),e.rightclickmenu=l}else clearTimeout(e.submenuhide[a.attr("id")]),e.submenuhide[a.attr("id")]=setTimeout(function(){a.hide()},200)}).on("mouseover mouseleave",".luckysheet-menuButton-sub",function(t){t.type==="mouseover"?(e.rightclickmenu.addClass("luckysheet-cols-menuitem-hover"),clearTimeout(e.submenuhide[$(this).attr("id")])):(e.rightclickmenu.removeClass("luckysheet-cols-menuitem-hover"),$(this).hide())})},getQKBorder:function(e,n,t){let l="";e.indexOf("pt")>-1?(e=parseFloat(e),e<1||(e<1.5?l="Medium":l="Thick")):(e=parseFloat(e),e<2||(e<3?l="Medium":l="Thick"));let o=0;return n=n.toLowerCase(),n=="double"?o=2:n=="dotted"?l=="Medium"||l=="Thick"?o=3:o=10:n=="dashed"?l=="Medium"||l=="Thick"?o=4:o=9:n=="solid"&&(l=="Medium"?o=8:l=="Thick"?o=13:o=1),[o,t]},updateFormatCell:function(e,n,t,l,o,a,s){if(!(e==null||n==null))if(n=="ct"){for(let u=l;u<=o;u++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[u]!=null))for(let f=a;f<=s;f++){let m=e[u][f],d=null;V(m)=="object"?d=e[u][f].v:d=e[u][f],t!="@"&&Y(d)&&(d=parseFloat(d));let g=$l(t,d),b="n";Dy(t)||t===14||t===15||t===16||t===17||t===18||t===19||t===20||t===21||t===22||t===45||t===46||t===47?b="d":t=="@"||t===49?b="s":(t=="General"||t===0)&&(b=Y(d)?"n":"g"),V(m)=="object"?(e[u][f].m=g,e[u][f].ct==null&&(e[u][f].ct={}),e[u][f].ct.fa=t,e[u][f].ct.t=b):e[u][f]={ct:{fa:t,t:b},v:d,m:g}}}else{n=="ht"?t=="left"?t="1":t=="center"?t="0":t=="right"&&(t="2"):n=="vt"?t=="top"?t="1":t=="middle"?t="0":t=="bottom"&&(t="2"):n=="tb"?t=="overflow"?t="1":t=="clip"?t="0":t=="wrap"&&(t="2"):n=="tr"&&(t=="none"?t="0":t=="angleup"?t="1":t=="angledown"?t="2":t=="vertical"?t="3":t=="rotation-up"?t="4":t=="rotation-down"&&(t="5"));for(let u=l;u<=o;u++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[u]!=null))for(let f=a;f<=s;f++){let m=e[u][f];V(m)=="object"?(wy(m,n,t),e[u][f][n]=t):(e[u][f]={v:m},e[u][f][n]=t)}}},updateFormat:function(e,n,t){let l=this;if(!ao(h.currentSheetIndex))return;if(!Un()){de.info("",Oe().pivotTable.errorNotAllowEdit);return}let a=document.createElement("canvas").getContext("2d");if(n in vy&&parseInt($("#luckysheet-input-box").css("top"))>0&&$("#luckysheet-input-box").text().substr(0,1)!="="){let m=e[h.luckysheetCellUpdate[0]][h.luckysheetCellUpdate[1]];ky(m,n,t,v.rangeResizeTo)}let s=$.extend(!0,{},h.config);s.rowlen==null&&(s.rowlen={});for(let f=0;f<h.luckysheet_select_save.length;f++){let m=h.luckysheet_select_save[f].row[0],d=h.luckysheet_select_save[f].row[1],g=h.luckysheet_select_save[f].column[0],b=h.luckysheet_select_save[f].column[1];this.updateFormatCell(e,n,t,m,d,g,b),(n=="tb"||n=="tr"||n=="fs")&&(s=tn(e,m,d,s))}let u={};(n=="tb"||n=="tr"||n=="fs")&&(u={cfg:s,RowlChange:!0}),Gt(e,h.luckysheet_select_save,u,!1)},updateFormat_mc:function(e,n){if(!Un()){de.info("",Oe().pivotTable.errorNotAllowEdit);return}let t=$.extend(!0,{},h.config);if(t.merge==null&&(t.merge={}),!!Ro(h.currentSheetIndex)){if(n=="mergeCancel")for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l],a=o.row[0],s=o.row[1],u=o.column[0],f=o.column[1];if(a==s&&u==f)continue;let m={};for(let d=a;d<=s;d++)for(let g=u;g<=f;g++){let b=e[d][g];if(b!=null&&b.mc!=null){let y=b.mc.r,p=b.mc.c;if("rs"in b.mc)delete b.mc,delete t.merge[y+"_"+p],m[y+"_"+p]=$.extend(!0,{},b);else{let x=JSON.parse(JSON.stringify(m[y+"_"+p]));delete x.v,delete x.m,delete x.ct,delete x.f,delete x.spl,e[d][g]=x}}}}else{let l=!1;for(let o=0;o<h.luckysheet_select_save.length;o++){let a=h.luckysheet_select_save[o],s=a.row[0],u=a.row[1],f=a.column[0],m=a.column[1];for(let d=s;d<=u;d++)for(let g=f;g<=m;g++){let b=e[d][g];if(V(b)=="object"&&"mc"in b){l=!0;break}}}if(l)for(let o=0;o<h.luckysheet_select_save.length;o++){let a=h.luckysheet_select_save[o],s=a.row[0],u=a.row[1],f=a.column[0],m=a.column[1];if(s==u&&f==m)continue;let d={};for(let g=s;g<=u;g++)for(let b=f;b<=m;b++){let y=e[g][b];if(y!=null&&y.mc!=null){let p=y.mc.r,x=y.mc.c;if("rs"in y.mc)delete y.mc,delete t.merge[p+"_"+x],d[p+"_"+x]=$.extend(!0,{},y);else{let _=JSON.parse(JSON.stringify(d[p+"_"+x]));delete _.v,delete _.m,delete _.ct,delete _.f,delete _.spl,e[g][b]=_}}}}else for(let o=0;o<h.luckysheet_select_save.length;o++){let a=h.luckysheet_select_save[o],s=a.row[0],u=a.row[1],f=a.column[0],m=a.column[1];if(!(s==u&&f==m)){if(n=="mergeAll"){let d={},g=!1;for(let b=s;b<=u;b++)for(let y=f;y<=m;y++){let p=e[b][y];p!=null&&(wc(p.ct)||!rt(p.v)||p.f!=null)&&!g&&(d=$.extend(!0,{},p),g=!0),e[b][y]={mc:{r:s,c:f}}}e[s][f]=d,e[s][f].mc={r:s,c:f,rs:u-s+1,cs:m-f+1},t.merge[s+"_"+f]={r:s,c:f,rs:u-s+1,cs:m-f+1}}else if(n=="mergeV")for(let d=f;d<=m;d++){let g={},b=!1;for(let y=s;y<=u;y++){let p=e[y][d];p!=null&&(!rt(p.v)||p.f!=null)&&!b&&(g=$.extend(!0,{},p),b=!0),e[y][d]={mc:{r:s,c:d}}}e[s][d]=g,e[s][d].mc={r:s,c:d,rs:u-s+1,cs:1},t.merge[s+"_"+d]={r:s,c:d,rs:u-s+1,cs:1}}else if(n=="mergeH")for(let d=s;d<=u;d++){let g={},b=!1;for(let y=f;y<=m;y++){let p=e[d][y];p!=null&&(!rt(p.v)||p.f!=null)&&!b&&(g=$.extend(!0,{},p),b=!0),e[d][y]={mc:{r:d,c:f}}}e[d][f]=g,e[d][f].mc={r:d,c:f,rs:1,cs:m-f+1},t.merge[d+"_"+f]={r:d,c:f,rs:1,cs:m-f+1}}}}}h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"mergeChange",sheetIndex:h.currentSheetIndex,data:h.flowdata,curData:e,range:$.extend(!0,[],h.luckysheet_select_save),config:$.extend(!0,{},h.config),curConfig:t})),h.clearjfundo=!1,Gt(e,h.luckysheet_select_save,{cfg:t}),h.clearjfundo=!0}},borderfix:function(e,n,t){let l=e[n][t],o=null;return l==null?[-1,0,0,-1]:e[n][t].bg==null||e[n][t].bg==""?[-1,0,0,-1]:[-2,-1,1,0]},changeMenuButtonDom:function(e,n,t){let l=this;t==null&&(t=Oe());let o=t.fontarray,a=t.fontjson;if(e=="bl")n!="0"?$("#luckysheet-icon-bold").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-bold").removeClass("luckysheet-toolbar-button-hover");else if(e=="it")n!="0"?$("#luckysheet-icon-italic").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-italic").removeClass("luckysheet-toolbar-button-hover");else if(e=="cl")n!="0"?$("#luckysheet-icon-strikethrough").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-strikethrough").removeClass("luckysheet-toolbar-button-hover");else if(e=="un")n!="0"?$("#luckysheet-icon-underline").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-underline").removeClass("luckysheet-toolbar-button-hover");else if(e=="ff"){let s="luckysheet-icon-font-family-menuButton",u=$("#"+s),f=o[0],m=0;n!=null&&(Ga(n).num?(m=parseInt(n),f=o[m],f==null&&(m=l.defualtFont[m],f=m,m!=null&&l.addFontTolist(m))):(n=n.replace(/"/g,"").replace(/'/g,""),m=n,f=n,l.addFontTolist(m))),l.focus(u,m),$("#luckysheet-icon-font-family").find(".luckysheet-toolbar-menu-button-caption").html(" "+f+" ")}else if(e=="fs"){let s=$("#luckysheet-icon-font-size-menuButton"),u=n,f=$("#luckysheet-icon-font-size input");l.focus(s,u),$("#luckysheet-icon-font-size").attr("itemvalue",u),f.val(u)}else if(e=="ht"){let s=$("#luckysheet-icon-align-menu-menuButton"),u=$("luckysheet-icon-align"),f="left";n=="0"?f="center":n=="2"&&(f="right"),l.focus(s,f);let m=Uo.align;$("#luckysheet-icon-align").attr("type",f).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-"+f+m[f]),s.hide()}else if(e=="vt"){let s=$("#luckysheet-icon-valign-menu-menuButton"),u=$("luckysheet-icon-valign"),f="bottom";n=="1"?f="top":n=="0"&&(f="middle"),l.focus(s,f);let m=Uo.align;$("#luckysheet-icon-valign").attr("type",f).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-"+f+m[f]),s.hide()}else if(e=="tb"){let s=$("#luckysheet-icon-textwrap-menu-menuButton"),u=$("luckysheet-icon-textwrap"),f="clip";n=="1"?f="overflow":n=="2"&&(f="wrap"),l.focus(s,f);let m=Uo.textWrap;$("#luckysheet-icon-textwrap").attr("type",f).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-"+f+m[f]),s.hide()}else if(e=="tr"){let s=$("#luckysheet-icon-rotation-menu-menuButton"),u=$("luckysheet-icon-rotation"),f="none";n=="1"?f="angleup":n=="2"?f="angledown":n=="3"?f="vertical":n=="4"?f="rotation-up":n=="5"&&(f="rotation-down"),l.focus(s,f);let m=Uo.rotation;$("#luckysheet-icon-rotation").attr("type",f).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-"+f+m[f]),s.hide()}else if(e=="ct"){let s=$("#luckysheet-icon-fmt-other"),f=Oe().defaultFmt;if(!n){s.find(".luckysheet-toolbar-menu-button-caption").html(" "+f[0].text+" ");return}let{fa:m}=n,d=f.find(g=>g.value===m);if(d)s.find(".luckysheet-toolbar-menu-button-caption").html(" "+d.text+" ");else{let g=f.find(b=>b.value==="fmtOtherSelf");s.find(".luckysheet-toolbar-menu-button-caption").html(" "+g.text+" ")}}},inputMenuButtonFocus:function(e){var n=window.getSelection(),t=n.getRangeAt(0);let l=t.startContainer;h.inlineStringEditRange=null;let o=Oe();if(l.parentNode.tagName=="SPAN"){let a=l.parentNode.style.cssText,s=Cm(a);for(let u in s)this.changeMenuButtonDom(u,s[u],o)}},menuButtonFocus:function(e,n,t){let l=this,o=["bl","it","cl","ff","ht","vt","fs","tb","tr","ct","un"],a=Oe();for(let s=0;s<o.length;s++){let u=o[s],f=l.checkstatus(e,n,t,u);this.changeMenuButtonDom(u,f,a)}},checkstatus:function(e,n,t,l){if(e==null||e[n]==null)return console.warn("It's incorrect data",n,t),null;let o=e[n][t];return ro(o,l)},setLineDash:function(e,n,t,l,o,a,s){n={"0":"none","1":"Thin","2":"Hair","3":"Dotted","4":"Dashed","5":"DashDot","6":"DashDotDot","7":"Double","8":"Medium","9":"MediumDashed","10":"MediumDashDot","11":"MediumDashDotDot","12":"SlantedDashDot","13":"Thick"}[n.toString()];try{n=="Hair"?e.setLineDash([1,2]):n.indexOf("DashDotDot")>-1?e.setLineDash([2,2,5,2,2]):n.indexOf("DashDot")>-1?e.setLineDash([2,5,2]):n.indexOf("Dotted")>-1?e.setLineDash([2]):n.indexOf("Dashed")>-1?e.setLineDash([3]):e.setLineDash([0])}catch(f){console.log(f)}e.beginPath(),n.indexOf("Medium")>-1?(t=="h"?(e.moveTo(l,o-.5),e.lineTo(a,s-.5)):(e.moveTo(l-.5,o),e.lineTo(a-.5,s)),e.lineWidth=2):n=="Thick"?(e.moveTo(l,o),e.lineTo(a,s),e.lineWidth=3):(e.moveTo(l,o),e.lineTo(a,s),e.lineWidth=1)},moveMergeData:function(e,n,t){if(rt(e))return e;let l=[],o=[],a=!1;for(let s=0;s<e.length;s++)for(let u=0;u<e[0].length;u++){let f=e[s][u];V(f)=="object"&&"mc"in f&&(f.mc.rs!=null&&(l.push({rs:f.mc.rs,cs:f.mc.cs,r:f.mc.r,c:f.mc.c}),o.push({rs:f.mc.rs,cs:f.mc.cs,r:f.mc.r+n,c:f.mc.c+t}),a=!0),e[s][u].mc.r+=n,e[s][u].mc.c+=t)}return{deleMC:l,insertMC:o,hasMC:a}},getRangeInMerge:function(e,n,t,l,o){let a=this,s=[],u=null;if(o!=null?u=$.extend(!0,{},a.getSheetConfig()):u=$.extend(!0,{},h.config),u!=null&&u.merge!=null)for(let f in u.merge){let m=u.merge[f];!(e+n-1<m.r||e>m.r+m.rs-1)&&!(t+l-1<m.c||t>m.c+m.cs-1)&&s.push(m)}return s},mergeborer:function(e,n,t){if(e==null||e[n]==null)return console.warn("Merge info is null",n,t),null;let l=e[n][t];if(V(l)=="object"&&"mc"in l){let o=l.mc;if(o==null)return console.warn("Merge info is null",n,t),null;if(t=o.c,n=o.r,e[n][t]==null)return console.warn("Main merge Cell info is null",n,t),null;let a=e[n][t].mc.cs,s=e[n][t].mc.rs,u=e[n][t].mc,f,m,d,g;for(let _=n;_<u.rs+n;_++)_==0?f=-1:f=h.visibledatarow[_-1]-1,m=h.visibledatarow[_],g==null?(g=f,d=m):d+=m-f-1;let b,y,p,x;for(let _=t;_<u.cs+t;_++)_==0?b=0:b=h.visibledatacolumn[_-1],y=h.visibledatacolumn[_],x==null?(x=b,p=y):p+=y-b;return{row:[g,d,n,n+s-1],column:[x,p,t,t+a-1]}}else return null},mergeMoveData:{},mergeMoveMain:function(e,n,t,l,o,a,s){let u=this,f=ct.getSheetMerge();if(f==null)return;let m=[];for(let g in f)m.push(g);n[0]>n[1]&&(n[1]=n[0]),e[0]>e[1]&&(e[1]=e[0]);let d=!0;for(u.mergeMoveData={};d;){d=!1;for(let g=0;g<m.length;g++){let b=m[g],y=f[b];if(b in u.mergeMoveData)continue;let p=u.mergeMove(y,e,n,t,l,o,a,s);p!=null?(u.mergeMoveData[b]=y,e=p[0],n=p[1],l=p[2],o=p[3],a=p[4],s=p[5],d=!0):delete u.mergeMoveData[b]}}return[e,n,l,o,a,s]},mergeMove:function(e,n,t,l,o,a,s,u){let f=this,m=e.r,d=e.r+e.rs-1,g=e.c,b=e.c+e.cs-1,y=!1;if(n[1]<n[0]&&(n[0]=n[1]),t[1]<t[0]&&(t[0]=t[1]),n[0]<=g&&n[1]>=b&&t[0]<=m&&t[1]>=d||!(n[1]<g||n[0]>b)&&!(t[1]<m||t[0]>d)){let p=f.mergeborer(h.flowdata,e.r,e.c);if(p){let x=p.row[1],_=p.row[0],S=p.row[2],I=p.column[1],O=p.column[0],F=p.column[2];n[1]<g||n[0]>b||(t[0]<=d&&t[0]>=m&&(a+=o-_,o=_,t[0]=m),t[1]>=m&&t[1]<=d&&(l.row_focus>=m&&l.row_focus<=d,a=x-o,t[1]=d)),t[1]<m||t[0]>d||(n[0]<=b&&n[0]>=g&&(u+=s-O,s=O,n[0]=g),n[1]>=g&&n[1]<=b&&(l.column_focus>=g&&l.column_focus<=b,u=I-s,n[1]=b)),y=!0}}return y?[n,t,o,a,s,u]:null},getCellRealSize:function(e,n,t){let l=this,o=h.defaultcollen,a=h.defaultrowlen,s=e[n][t];if(!!s&&s.mc!=null){let u=s.mc,f=l.mergeborer(e,u.r,u.c);if(f){let m=f.row[1],d=f.row[0],g=f.row[2],b=f.row[3],y=f.column[1],p=f.column[0],x=f.column[2],_=f.column[3];o=y-p-1,a=m-d-1}}else{let u=Yl()[$e(h.currentSheetIndex)].config;u.columnlen!=null&&u.columnlen[t]!=null&&(o=u.columnlen[t]),u.rowlen!=null&&u.rowlen[n]!=null&&(a=u.rowlen[n])}return[o,a]},getTextHeightCache:{},getTextSize:function(e,n){let t=Oe().fontarray,l=n||"10pt "+t[0],o=this;if(l in o.getTextHeightCache)return o.getTextHeightCache[l];$("#luckysheetTextSizeTest").length==0&&$('<span id="luckysheetTextSizeTest" style="float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;">'+e+"</span>").appendTo($("body"));let a=$("#luckysheetTextSizeTest").text(e).css({font:l}),s=a.innerWidth(),u=a.innerHeight();return o.getTextHeightCache[l]=[s,u],[s,u]},activeFormulaInput:function(e,n,t,l,o,a){let s=this;if(a==null&&(a=!1),Dn(e,n,h.flowdata,!0),a){let b='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+o.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(b);let y=window.getSelection(),p=$("#luckysheet-rich-text-editor").find("span");v.setCaretPosition(p.get(p.length-2),0,1);return}let u=$r(t[0])[0],f=$r(t[1])[1],m=Vl(l[0])[0],d=Vl(l[1])[1],g='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+o.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span class="luckysheet-formula-functionrange-cell" rangeindex="0" dir="auto" style="color:'+si[0]+';">'+Al(h.currentSheetIndex,{row:t,column:l},h.currentSheetIndex)+'</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(g),v.israngeseleciton(),v.rangestart=!0,v.rangedrag_column_start=!1,v.rangedrag_row_start=!1,v.rangechangeindex=0,v.rangeSetValue({row:t,column:l}),v.func_selectedrange={left:m,width:d-m-1,top:u,height:f-u-1,left_move:m,width_move:d-m-1,top_move:u,height_move:f-u-1,row:[e,e],column:[n,n]},$("#luckysheet-formula-functionrange-select").css({left:m,width:d-m-1,top:u,height:f-u-1}).show(),$("#luckysheet-formula-help-c").hide()},backFormulaInput:function(e,n,t,l,o,a){let s=this,u="="+a.toUpperCase()+"("+Al(h.currentSheetIndex,{row:l,column:o},h.currentSheetIndex)+")",f=v.execfunction(u,n,t),m={v:f[1],f:f[2]};er(n,t,e,m),v.execFunctionExist.push({r:n,c:t,i:h.currentSheetIndex}),He.historyParam(e,h.currentSheetIndex,{row:[n,n],column:[t,t]})},checkNoNullValue:function(e){let n=e;return V(n)=="object"&&(n=n.v),!!(!rt(n)&&Ga(n).num&&(e.ct==null||e.ct.t==null||e.ct.t=="n"||e.ct.t=="g"))},checkNoNullValueAll:function(e){let n=e;return V(n)=="object"&&(n=n.v),!rt(n)},getNoNullValue:function(e,n,t,l){let o=this,a=0,s=null,u=0,f=0;for(let m=t-1;m>=0;m--){let d;if(l=="c"?d=e[n][m]:d=e[m][n],o.checkNoNullValue(d))a++,s=m;else if(d==null||d.v==null||d.v==""){if(u++,u>=40)if(f<=0)f=1;else break}else break}return s},singleFormulaInput:function(e,n,t,l,o,a,s,u,f){let m=this;s==null&&(s="r"),u==null&&(u=!0),f==null&&(f=!0);let d=!0,g=!1;for(let b=l;b<=o;b++){let y=null;s=="c"?y=e[b][t]:y=e[t][b],m.checkNoNullValue(y)?(d=!1,g=!0):m.checkNoNullValueAll(y)&&(d=!1)}if(d&&f)if(m.getNoNullValue(e,n,t,s)==null)s=="c"?m.activeFormulaInput(n,t,null,null,a,!0):m.activeFormulaInput(t,n,null,null,a,!0);else if(n==l)for(let y=l;y<=o;y++){let p=m.getNoNullValue(e,y,t,s);if(p==null)break;s=="c"?m.backFormulaInput(e,y,t,[y,y],[p,t-1],a):m.backFormulaInput(e,t,y,[p,t-1],[y,y],a)}else for(let y=o;y>=l;y--){let p=m.getNoNullValue(e,y,t,s);if(p==null)break;s=="c"?m.backFormulaInput(e,y,t,[y,y],[p,t-1],a):m.backFormulaInput(e,t,y,[p,t-1],[y,y],a)}else if(g&&u){let b=null;if(s=="c"?b=e[o+1][t]:b=e[t][o+1],b!=null&&b.v!=null&&b.v.toString().length>0){let y=o+1;for(s=="c"?b=e[o+1][t]:b=e[t][o+1];b!=null&&b.v!=null&&b.v.toString().length>0;){y++;let p=null;if(s=="c"?p=e.length:p=e[0].length,y>=p)return;s=="c"?b=e[y][t]:b=e[t][y]}s=="c"?m.backFormulaInput(e,y,t,[l,o],[t,t],a):m.backFormulaInput(e,t,y,[t,t],[l,o],a)}else s=="c"?m.backFormulaInput(e,o+1,t,[l,o],[t,t],a):m.backFormulaInput(e,t,o+1,[t,t],[l,o],a)}else return!0},autoSelectionFormula:function(e){let n=this,t=pt.deepCopyFlowData(h.flowdata),l=40,o=!0;v.execFunctionExist=[];let a=function(u,f,m,d,g,b){let y=n.getNoNullValue(u,f,g,"c");y==null?n.activeFormulaInput(f,d,null,null,b,!0):n.activeFormulaInput(f,d,[f,m],[y,g-1],b)},s=function(u,f,m,d,g,b){let y=n.getNoNullValue(u,d,m,"r");y==null?a(u,f,m,d,g,b):n.activeFormulaInput(f,d,[y,m-1],[d,g],b)};for(let u=0;u<h.luckysheet_select_save.length;u++){let f=h.luckysheet_select_save[u].row[0],m=h.luckysheet_select_save[u].row[1],d=h.luckysheet_select_save[u].column[0],g=h.luckysheet_select_save[u].column[1],b=h.luckysheet_select_save[u].row_focus,y=h.luckysheet_select_save[u].column_focus;if(f==m&&d==g){if(m-1<0&&g-1<0){n.activeFormulaInput(f,d,null,null,e,!0);return}m-1>=0&&n.checkNoNullValue(t[m-1][d])?s(t,f,m,d,g,e):g-1>=0&&n.checkNoNullValue(t[f][g-1])?a(t,f,m,d,g,e):s(t,f,m,d,g,e)}else if(f==m)o=n.singleFormulaInput(t,y,f,d,g,e,"r");else if(d==g)o=n.singleFormulaInput(t,b,d,f,m,e,"c");else{let p=!0;for(let _=f;_<=m;_++)p=n.singleFormulaInput(t,y,_,d,g,e,"r",!0,!1)&&p;let x=!0;for(let _=d;_<=g;_++)x=n.singleFormulaInput(t,b,_,f,m,e,"c",!0,!1)&&x;o=!!p&&!!x}o=o&&o}o||(v.execFunctionExist.reverse(),v.execFunctionGroup(null,null,null,null,t),Gt(t,h.luckysheet_select_save),clearTimeout(h.jfcountfuncTimeout),h.jfcountfuncTimeout=setTimeout(function(){mn()},500))},getStyleByCell:function(e,n,t){let l=this,o="",a=xr.getComputeMap(),s=xr.checksAF(n,t,a),u=xt.getComputeMap(),f=xt.checksCF(n,t,u),m=Oe().fontarray,d=e[n][t],g=d.ct,b=!1;wn(d)&&(b=!0);for(let y in d){let p=l.checkstatus(e,n,t,y);(s!=null||f!=null&&f.cellColor!=null)&&(f!=null&&f.cellColor!=null?o+="background: "+f.cellColor+";":s!=null&&(o+="background: "+s[1]+";")),V(p)!="object"&&((y=="bg"||s!=null||f!=null&&f.cellColor!=null)&&(f!=null&&f.cellColor!=null?o+="background: "+f.cellColor+";":s!=null?o+="background: "+s[1]+";":o+="background: "+p+";"),y=="ht"&&p!="1"&&(p=="0"?o+="text-align: center;":p=="2"&&(o+="text-align: right;")),y=="vt"&&(p=="0"?o+="vertical-align: middle;":p=="1"?o+="vertical-align: top;":p=="2"&&(o+="vertical-align: bottom;")),y=="un"&&p&&(o+="text-decoration:underline;"))}return b||(o+=Mu(d,s,f)),o},fontSelectList:[],defualtFont:["Times New Roman","Arial","Tahoma","Verdana","\u5FAE\u8F6F\u96C5\u9ED1","\u5B8B\u4F53","\u9ED1\u4F53","\u6977\u4F53","\u4EFF\u5B8B","\u65B0\u5B8B\u4F53","\u534E\u6587\u65B0\u9B4F","\u534E\u6587\u884C\u6977","\u534E\u6587\u96B6\u4E66"],addFontTolist:function(e){e=e.replace(/"/g,"").replace(/'/g,"");let n=!0;for(let o=0;o<this.fontSelectList.length;o++)if(this.fontSelectList[o].value==e){n=!1;break}let l=Oe().fontjson;if(e in l&&(n=!1),n){let o={};o.value=e,o.index=this.fontSelectList.length,o.type="userDefined",o.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+e+"'>"+e+"</span>",o.example="",this.fontSelectList.push(o);let a=$("#luckysheet-icon-font-family-menuButton"),s=this.createButtonMenu(this.fontSelectList);a.html(s)}},fontInitial:function(e){let n=[],t=Oe().fontarray;for(let l=0;l<t.length;l++){let o=t[l],a={};a.value=o,a.index=l,a.type="inner",a.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+o+"'>"+o+"</span>",a.example="",n.push(a)}if(e!=null){for(let l=0;l<e.length;l++){let o=e[l],a={};if(a.value=o.fontName,a.index=l,a.type="userDefined",a.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+o.fontName+"'>"+o.fontName+"</span>",a.example="",n.push(a),document.fonts&&!document.fonts.check("12px "+o.fontName)&&o.url){let s=new FontFace(o.fontName,`url(${o.url})`);document.fonts.add(s),s.load()}}document.fonts&&document.fonts.ready.then(function(){})}this.fontSelectList=n}},ht=a_});function zg(e,n){let t={};for(let l in e)t[l]=e[l];for(let l in n)n[l]!=null&&(t[l]=n[l]);return t}function yt(e,n){return e.replace(/\$\{([\w]+)\}/g,function(t,l){let o=n[l];return typeof o!="undefined"?o:t})}function V(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]}function Hh(e){let n=new Date,t=n.getFullYear(),l=n.getMonth(),o=n.getDate(),a=n.getDay(),s=n.getHours(),u=n.getMinutes(),f=n.getSeconds();l=l+1,l<10&&(l="0"+l),o<10&&(o="0"+o),s<10&&(s="0"+s),u<10&&(u="0"+u),f<10&&(f="0"+f);let m="";return e==1?m=t+"-"+l+"-"+o:e==2&&(m=t+"-"+l+"-"+o+" "+s+":"+u+":"+f),m}function Ua(e){let n;e.indexOf("rgba")>-1?n=e.replace("rgba(","").replace(")","").split(","):n=e.replace("rgb(","").replace(")","").split(",");let t=parseInt(n[0]),l=parseInt(n[1]),o=parseInt(n[2]);return"#"+((1<<24)+(t<<16)+(l<<8)+o).toString(16).slice(1)}function jr(e){if(e==null||e.length==0)return NaN;for(var n=e.toLowerCase().split(""),t=0,l=n.length,o=function(f){return f.charCodeAt()-96},a=0,s=0,u=0;u<l;u++)s=o(n[u]),a+=s*Math.pow(26,l-u-1);return a==0?NaN:a-1}function Qt(e){for(var n="a".charCodeAt(0),t="z".charCodeAt(0),l=t-n+1,o="";e>=0;)o=String.fromCharCode(e%l+n)+o,e=Math.floor(e/l)-1;return o.toUpperCase()}function Ps(e,n){if(n===0)return"";if(e==null)return 0;let t=0;for(let l=0;l<e.length;l++)if(e.charAt(l).match(/[^\x00-\xff]/ig)!=null?t+=2:t+=1,Y(n)&&t===~~n)return e.substring(0,l);return t}function Og(e){let n=[],t={};if(e.length>0)for(let l=0;l<e.length;l++){let o=e[l];t[o]||(n.push(o),t[o]=1)}return n}function Ss(e){let n=Oe().fontarray;if(V(e)=="object"){let t="";if(e.it=="0"||e.it==null?t+="normal ":t+="italic ",t+="normal ",e.bl=="0"||e.bl==null?t+="normal ":t+="bold ",e.fs?t+=Math.ceil(e.fs)+"pt ":t+=h.defaultFontSize+"pt ",!e.ff)t+=n[0]+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif';else{let l=null,o=Oe().fontjson;Ga(e.ff).num?l=n[parseInt(e.ff)]:(l=e.ff,l=l.replace(/"/g,"").replace(/'/g,""),l.indexOf(" ")>-1&&(l='"'+l+'"'),l!=null&&document.fonts&&!document.fonts.check("12px "+l)&&ht.addFontTolist(l)),l==null&&(l=n[0]),t+=l+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif'}return t}else return ps()}function ea(e,n,t){let l=$(window).height(),o=$(window).width(),a=e.width(),s=e.height(),u=t,f=n;n+a>o&&(f=n-a),t+s>l&&(u=t-s),u<0&&(u=0),e.css({top:u,left:f}).show()}function uo(){h.fullscreenmode&&setTimeout(function(){document.getElementById("luckysheet-rich-text-editor").focus({preventScroll:!0}),$("#luckysheet-rich-text-editor").select()},50)}function el(){document.getElementById(h.container).focus({preventScroll:!0})}function Fn(e,n){if(e==null||isNaN(parseFloat(e))||Oa(e)||e==-Infinity||e==Infinity)return null;let t=6,l=!1;n==null||n=="auto"?e<1?t=6:t=1:xi(n)=="num"?(t=parseInt(n),l=!0):t=6;let o="",a=null;for(let s=0;s<t;s++)o+="0";return l||(o="["+o+"]"),e>=1e21?a=parseFloat((0,Lh.default)(e).value()):a=parseFloat((0,Lh.default)(e).format("0."+o)),a}function Um(e){if(e!=null&&!isNaN(parseFloat(e))&&!Oa(e)){let t=(0,Lh.default)(e).value().toString().split(".");return t.length==1?t=0:t=t[1].length,t}else return null}function qr(e,n,t,l){let o=$(window).height(),a=$(window).width(),s=e.width(),u=e.height(),f=t,m=n;l==null&&(l="lefttop"),l=="lefttop"?e.css({top:t,left:n}).show():l=="righttop"?e.css({top:t,left:n-s}).show():l=="leftbottom"?e.css({bottom:o-t-12,left:n}).show():l=="rightbottom"&&e.css({bottom:o-t-12,left:n-s}).show()}function jt(e,n){n=n||document;var t=n.querySelectorAll(e);return t.length==1?Array.prototype.slice.call(t)[0]:Array.prototype.slice.call(t)}function wh(e,n,t){if(typeof e!="object")var e=[e];var l=document.getElementsByTagName("head")[0]||document.documentElement,o=[],a=e.length-1,s=function(u){if(o[u]=document.createElement("script"),o[u].setAttribute("type","text/javascript"),o[u].onload=o[u].onreadystatechange=function(){this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this),u!==a?s(u+1):typeof t=="function"&&t()},o[u].setAttribute("src",e[u]),typeof n=="object")for(var f in n)o[u].setAttribute(f,n[f]);l.appendChild(o[u])};s(0)}function s_(e){var n=document,t=n.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e);var l=n.getElementsByTagName("head");l.length?l[0].appendChild(t):n.documentElement.appendChild(t)}function xh(e){typeof e!="object"&&(e=[e]),e.length&&e.forEach(n=>{s_(n)})}function Yy(e){if(e==null||e.length==0)return null;let n=e.split(","),t="";for(let l=0;l<n.length;l++){let a=n[l].split("!"),s="",u="";a.length>1?(s=a[0],u=a[1]):u=a[0];let f=u.split(":"),m="";for(let d=0;d<f.length;d++){let g=f[d],b=g.replace(/[^0-9]/g,""),y=g.replace(/[^A-Za-z]/g,""),p="";y!=""&&(p+="$"+y),b!=""&&(p+="$"+b),m+=p+":"}m=m.substr(0,m.length-1),t+=s+m+","}return t.substr(0,t.length-1)}function Ds(e,n=!0){let t=$("#"+e).find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=t.outerHeight(),o=t.outerWidth(),a=$(window).width(),s=$(window).height(),u=$(document).scrollLeft(),f=$(document).scrollTop();t.css({left:(a+u-o)/2,top:(s+f-l)/3}).show(),n&&$("#luckysheet-modal-dialog-mask").show()}function c_(e,n,t,l){e[n]=new Proxy(t,{set(o,a,s,u){return setTimeout(()=>{l(o,a,s,u)},0),Reflect.set(o,a,s,u)}})}function u_(e,n,t,l){Object.defineProperty(e,n,{enumerable:!0,configurable:!1,get(){return t},set(o){t!==o&&(console.log(`\u53D1\u73B0 ${n} \u5C5E\u6027 ${t} -> ${o}`),setTimeout(()=>{l(t,o)},0),t=o)}})}function _h(e,n){e.some((t,l,o)=>{if(t===n)return o.splice(l,1),t===n})}function Pa(e){return e.replace(/([A-Z])/g,function(n,t){return"-"+t.toLowerCase()})}var import_plugin,Lh,Bh,gl=Tt(()=>{import_plugin=Le(Be());ar();Mr();Co();Gl();Ut();Rl();Lh=Le(Is());Bh=(e,n,t)=>{if(!e.hasOwnProperty(n)){console.info("No %s in data",n);return}V(e)==="object"&&(V(e[n])==="object"||V(e[n])==="array"?c_(e,n,e[n],t):u_(e,n,e[n],t))}});function Pg(){h.cellMainSrollBarSize=0;let e=!1,n={},t=!1,l=null;$(document).on("touchstart","#luckysheet-grid-window-1",function(o){clearInterval(l),e=!0;let a=o.originalEvent.targetTouches[0];n={x:a.pageX,y:a.pageY,vy:0,moveType:"y"}}),$(document).on("touchmove","#luckysheet-grid-window-1",function(o){if(o.originalEvent.targetTouches.length>1||o.scale&&o.scale!==1)return;let a=o.originalEvent.targetTouches[0];if(e){let s=a.pageX-n.x,u=a.pageY-n.y;n.x=a.pageX,n.y=a.pageY;let f=$("#luckysheet-scrollbar-x").scrollLeft(),m=$("#luckysheet-scrollbar-y").scrollTop();f-=s,m-=u,f<0&&(f=0),m<0&&(m=0),$("#luckysheet-scrollbar-y").scrollTop(m),n.vy_y=u,n.scrollTop=m,$("#luckysheet-scrollbar-x").scrollLeft(f),n.vy_x=s,n.scrollLeft=f}else if(t){let s=ll(a.pageX,a.pageY),u=s[0]+$("#luckysheet-cell-main").scrollLeft(),f=s[1]+$("#luckysheet-cell-main").scrollTop(),m=zl(f),d=m[1],g=m[0],b=m[2],y=Ml(u),p=y[1],x=y[0],_=y[2],S=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),I=0,O=0,F=[];S.top>g?(I=g,O=S.top+S.height-g,S.row[1]>S.row_focus&&(S.row[1]=S.row_focus),F=[b,S.row[1]]):S.top==g?(I=g,O=S.top+S.height-g,F=[b,S.row[0]]):(I=S.top,O=d-S.top-1,S.row[0]<S.row_focus&&(S.row[0]=S.row_focus),F=[S.row[0],b]);let D=0,k=0,w=[];S.left>x?(D=x,k=S.left+S.width-x,S.column[1]>S.column_focus&&(S.column[1]=S.column_focus),w=[_,S.column[1]]):S.left==x?(D=x,k=S.left+S.width-x,w=[_,S.column[0]]):(D=S.left,k=p-S.left-1,S.column[0]<S.column_focus&&(S.column[0]=S.column_focus),w=[S.column[0],_]);let C=ht.mergeMoveMain(w,F,S,I,O,D,k);C!=null&&(w=C[0],F=C[1],I=C[2],O=C[3],D=C[4],k=C[5]),S.row=F,S.column=w,S.left_move=D,S.width_move=k,S.top_move=I,S.height_move=O,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=S,Zt(),we.scrollFreezen()}o.stopPropagation()}),$(document).on("touchend",function(o){if(e){let a=Math.abs(n.vy_x),s=((a>>31)*2+1)*.25,u=Math.abs(n.vy_y),f=((u>>31)*2+1)*.25;(a>0||u>0)&&(l=setInterval(function(){a-=s,u-=f,a<=0&&(a=0),u<=0&&(u=0),n.vy_y>0?n.scrollTop-=u:n.scrollTop+=u,$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop),n.vy_x>0?n.scrollLeft-=a:n.scrollLeft+=a,$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft),a<=0&&u<=0&&clearInterval(l)},20))}e=!1,t=!1}),$(document).on("touchstart",".luckysheet-cs-touchhandle",function(o){t=!0,e=!1,o.stopPropagation()}),document.addEventListener("touchmove",function(o){o.preventDefault()},{passive:!1})}var import_plugin,U1=Tt(()=>{import_plugin=Le(Be());Qn();vr();Mr();li();Ut()});var import_plugin,f_,Eg,G1=Tt(()=>{import_plugin=Le(Be());gl();ar();vr();Sr();br();io();mr();fr();Ut();Rl();f_={createDialog:function(){let e=this,n=Oe(),t=n.splitText,l=n.punctuation,o=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-splitColumn-dialog").remove();let a='<div class="box"><div class="boxTitle">'+t.splitDelimiters+'</div><div class="boxMain"><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_01" type="checkbox"/><label for="splitColumn_type_01">'+l.tab+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_02" type="checkbox"/><label for="splitColumn_type_02">'+l.semicolon+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_03" type="checkbox"/><label for="splitColumn_type_03">'+l.comma+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_04" type="checkbox"/><label for="splitColumn_type_04">'+l.space+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_05" type="checkbox"/><label for="splitColumn_type_05">'+t.splitOther+'</label><input type="text" class="formulaInputFocus" maxlength="1"/></div></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_06" type="checkbox"/><label for="splitColumn_type_06">'+t.splitContinueSymbol+'</label></div><div class="boxTitle" style="margin-top: 10px;">'+t.splitDataPreview+'</div><div class="boxMain" id="splitColumnData"></div></div>';$("body").first().append(yt(kl,{id:"luckysheet-splitColumn-dialog",addclass:"luckysheet-splitColumn-dialog",title:t.splitTextTitle,content:a,botton:'<button id="luckysheet-splitColumn-dialog-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>",style:"z-index:100003"}));let s=$("#luckysheet-splitColumn-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),u=s.outerHeight(),f=s.outerWidth(),m=$(window).width(),d=$(window).height(),g=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-splitColumn-dialog").css({left:(m+g-f)/2,top:(d+b-u)/3}).show();let y=e.getDataArr();e.dataPreview(y)},init:function(){let e=this,t=Oe().splitText;$(document).off("change.SPCinpcheckbox").on("change.SPCcheckbox","#luckysheet-splitColumn-dialog .box input[type='checkbox']",function(){let l=e.getRegStr(),o=e.getDataArr(l);e.dataPreview(o)}),$(document).off("keyup.SPCinptext").on("keyup.SPCinptext","#luckysheet-splitColumn-dialog .box input[type='text']",function(){if($(this).siblings("input[type='checkbox']").is(":checked")){let l=e.getRegStr(),o=e.getDataArr(l);e.dataPreview(o)}}),$(document).off("click.SPCconfirm").on("click.SPCconfirm","#luckysheet-splitColumn-dialog #luckysheet-splitColumn-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-splitColumn-dialog").hide();let l=e.getRegStr(),o=e.getDataArr(l),a=h.luckysheet_select_save[0].row[0],s=h.luckysheet_select_save[0].column[0];if(o[0].length==1)return;let u=!1;for(let f=0;f<o.length;f++)for(let m=1;m<o[0].length;m++){let d=h.flowdata[a+f][s+m];if(d!=null&&d.v!=null){u=!0;break}}if(u){let f=function(){e.update(a,s,o)};de.confirm("",t.splitConfirmToExe,f)}else e.update(a,s,o)})},update:function(e,n,t){let l=pt.deepCopyFlowData(h.flowdata);for(let u=0;u<t.length;u++)for(let f=0;f<t[0].length;f++){let m=t[u][f];er(e+u,n+f,l,m)}let o=h.luckysheet_select_save[0].row[0],a=h.luckysheet_select_save[0].column[0],s=[{row:[o,o+t.length-1],column:[a,a+t[0].length-1]}];Gt(l,s),Zt()},dataPreview:function(e){$("#luckysheet-splitColumn-dialog #splitColumnData").empty();let n="";for(let l=0;l<e.length;l++){let o="";for(let a=0;a<e[0].length;a++)o+="<td>"+e[l][a]+"</td>";n+="<tr>"+o+"</tr>"}let t="<table>"+n+"</table>";$("#luckysheet-splitColumn-dialog #splitColumnData").append(t)},getRegStr:function(){let e="",n=0;return $("#luckysheet-splitColumn-dialog .box input[type='checkbox']:checked").each(function(t,l){let o=$(l).attr("id");if(o=="splitColumn_type_01")e+="\\t",n++;else if(o=="splitColumn_type_02")n>0&&(e+="|"),e+=";",n++;else if(o=="splitColumn_type_03")n>0&&(e+="|"),e+=",",n++;else if(o=="splitColumn_type_04")n>0&&(e+="|"),e+="\\s",n++;else if(o=="splitColumn_type_05"){let a=$(l).siblings("input[type='text']").val().trim();a!=""&&(n>0&&(e+="|"),e+=a)}else o=="splitColumn_type_06"&&(e="["+e+"]+")}),e},getDataArr:function(e){let n=this,t=[],l=h.luckysheet_select_save[0].row[0],o=h.luckysheet_select_save[0].row[1],a=h.luckysheet_select_save[0].column[0];if(e!=null&&e!=""){let s=new RegExp(e,"g"),u=[];for(let d=l;d<=o;d++){let g=[],b=h.flowdata[d][a],y;b!=null&&b.m!=null?y=b.m:y=Mt(d,a,h.flowdata),y==null&&(y=""),g=y.toString().split(s),u.push(g)}let f=u.length,m=0;for(let d=0;d<f;d++)u[d].length>m&&(m=u[d].length);t=n.getNullData(f,m);for(let d=0;d<t.length;d++)for(let g=0;g<t[0].length;g++)u[d][g]!=null&&(t[d][g]=u[d][g])}else for(let s=l;s<=o;s++){let u=[],f=h.flowdata[s][a],m;f!=null&&f.m!=null?m=f.m:m=Mt(s,a,h.flowdata),m==null&&(m=""),u.push(m),t.push(u)}return t},getNullData:function(e,n){let t=[];for(let l=0;l<e;l++){let o=[];for(let a=0;a<n;a++)o.push("");t.push(o)}return t}},Eg=f_});function h_(){let n=Oe().cellFormat;$("#luckysheet-cellFormat-confirm").click(function(){let t=$("#luckysheet-protection-check-locked").is(":checked"),l=$("#luckysheet-protection-check-hidden").is(":checked");t=t==!0?1:0,l=l==!0?1:0;let o=q1(function(a,s,u,f){a==null?er(s,u,f,{lo:t,hi:l}):(a.lo=t,a.hi=l)},function(){alert(n.sheetDataIsNullAlert)});Gt(o,void 0,void 0,!1),$("#luckysheet-cellFormat-config").hide(),$("#luckysheet-modal-dialog-mask").hide()})}function q1(e,n){if(h.luckysheet_select_save!=null&&h.luckysheet_select_save.length>0){let t=ct.getSheetByIndex(),l=t.data;if(l!=null)for(let o=0;o<h.luckysheet_select_save.length;o++){let a=h.luckysheet_select_save[o],s=a.row,u=a.column;for(let f=s[0];f<=s[1];f++)for(let m=u[0];m<=u[1];m++){let d,g=ht.mergeborer(l,f,m);if(g){let b=g.row[2],y=g.column[2];d=l[b][y]}else d=l[f][m];e(d,f,m,l)}}else n();return l}}function d_(){if(Y1)return;Y1=!0;let e=Oe(),n=e.cellFormat,t=e.button;$("body").first().append(yt(kl,{id:"luckysheet-cellFormat-config",addclass:"luckysheet-cellFormat-config",title:n.cellFormatTitle,content:`
            <div class="luckysheet-cellFormat-menu-c">
                <div class="luckysheet-cellFormat-menu luckysheet-cellFormat-menu-active" id="luckysheet-cellFormat-protection">
                    ${n.protection}
                </div>
            </div>
            <div id="luckysheet-cellFormat-protection-content" class="luckysheet-cellFormat-content">
                <div class="luckysheet-cellFormat-protection">
                    <p>
                        ${n.protectionTips}
                    </p>
                    <label for="luckysheet-protection-check-locked"><input id="luckysheet-protection-check-locked" name="luckysheet-protection-check-locked" type="checkbox">${n.locked}</label><span>\u90E8\u5206\u9009\u4E2D</span>
                    <br/>
                    <label for="luckysheet-protection-check-hidden"><input id="luckysheet-protection-check-hidden" name="luckysheet-protection-check-hidden" type="checkbox">${n.hidden}</label><span>\u5168\u90E8\u9009\u4E2D</span>
                </div>
            </div>
        `,botton:`<button id="luckysheet-cellFormat-confirm" class="btn btn-primary">${t.confirm}</button>
                    <button class="btn btn-default luckysheet-model-close-btn">${t.cancel}</button>`,style:"z-index:100003"})),h_()}function X1(){d_();let e=Oe(),n=e.cellFormat,t=e.button;if($("#luckysheet-rightclick-menu").hide(),!Ro(h.currentSheetIndex))return;let l=!1,o=!1,a=0,s=0,u=0;if(h.luckysheet_select_save!=null&&h.luckysheet_select_save.length>0)q1(function(d){(d==null||d.lo==null||d.lo==1)&&(l=!0,a++),d!=null&&d.hi==1&&(o=!0,s++),u++},function(){l=!0});else{alert(n.selectionIsNullAlert);return}let f="",m="";l&&(f=a==u?n.tipsAll:n.tipsPart),o&&(m=s==u?n.tipsAll:n.tipsPart),$("#luckysheet-protection-check-locked").prop("checked",l).parent().next().html(f),$("#luckysheet-protection-check-hidden").prop("checked",o).parent().next().html(m),Ds("luckysheet-cellFormat-config")}var import_plugin,Y1,Z1=Tt(()=>{import_plugin=Le(Be());Ut();gl();ar();Yr();Mr();jn();fr();Rl();io();Y1=!1});function jh(e){let n=$("#luckysheet-cell-main"),t=$("#luckysheet-scrollbar-x").scrollLeft(),l=$("#luckysheet-scrollbar-y").scrollTop(),o=$("#luckysheetTableContent").height();if(we.freezenhorizontaldata!=null&&l<we.freezenhorizontaldata[2]){l=we.freezenhorizontaldata[2],$("#luckysheet-scrollbar-y").scrollTop(l);return}if(we.freezenverticaldata!=null&&t<we.freezenverticaldata[2]){t=we.freezenverticaldata[2],$("#luckysheet-scrollbar-x").scrollLeft(t);return}$("#luckysheet-cols-h-c").scrollLeft(t),$("#luckysheet-rows-h").scrollTop(l),n.scrollLeft(t).scrollTop(l),$("#luckysheet-input-box-index").css({left:$("#luckysheet-input-box").css("left"),top:parseInt($("#luckysheet-input-box").css("top"))-20+"px","z-index":$("#luckysheet-input-box").css("z-index")}).show(),Et(t,l),$("#luckysheet-bottom-controll-row").css("left",t),(we.freezenhorizontaldata!=null||we.freezenverticaldata!=null)&&we.scrollAdapt(),!!Yt.createHookFunction("scroll",{scrollLeft:t,scrollTop:l,canvasHeight:o})}var import_plugin,K1=Tt(()=>{import_plugin=Le(Be());li();xo();fr();Ut();qn()});function Ng(){let e=Ni.detectOS();Ni.mobilecheck()&&Pg(),Date.now||(Date.now=function(){return new Date().getTime()}),function(){"use strict";for(var g=["webkit","moz"],b=0;b<g.length&&!window.requestAnimationFrame;++b){var y=g[b];window.requestAnimationFrame=window[y+"RequestAnimationFrame"],window.cancelAnimationFrame=window[y+"CancelAnimationFrame"]||window[y+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var p=0;window.requestAnimationFrame=function(x){var _=Date.now(),S=Math.max(p+16,_);return setTimeout(function(){x(p=S)},S-_)},window.cancelAnimationFrame=clearTimeout}}(),$("#luckysheet-sheet-container-c").mousewheel(function(g,b){let y=g.deltaFactor<40?1:g.deltaFactor<80?2:3,p=$(this).scrollLeft();g.deltaY!=0?g.deltaY<0?p=p+10*y:p=p-10*y:g.deltaX!=0&&(g.deltaX>0?p=p+10*y:p=p-10*y),$(this).scrollLeft(p),g.preventDefault()}),$("#luckysheet-cell-main").scroll(function(){}).mousewheel(function(g,b){g.preventDefault()});let t=Oe(),l=t.drag,o=t.info,a,s;$("#luckysheet-grid-window-1").mousewheel(function(g,b){let y=$("#luckysheet-scrollbar-x").scrollLeft(),p=$("#luckysheet-scrollbar-y").scrollTop(),x=h.visibledatacolumn,_=h.visibledatarow;we.freezenhorizontaldata!=null&&(_=we.freezenhorizontaldata[3]),we.freezenverticaldata!=null&&(x=we.freezenverticaldata[3]),clearTimeout(s),h.visibledatacolumn_unique!=null?x=h.visibledatacolumn_unique:(x=Og(x),h.visibledatacolumn_unique=x),h.visibledatarow_unique!=null?_=h.visibledatarow_unique:(_=Og(_),h.visibledatarow_unique=_);let S=al(x,y),I=al(_,p);we.freezenhorizontaldata!=null&&(I=al(_,p+we.freezenhorizontaldata[0]));let O=0,F=0,D=g.deltaFactor<40?1:g.deltaFactor<80?2:3;if(g.deltaY!=0){let k,w=Math.round(D/h.zoomRatio);w=w<1?1:w,g.deltaY<0?(k=I+w,k>=_.length&&(k=_.length-1)):(k=I-w,k<0&&(k=0)),F=k==0?0:_[k-1],we.freezenhorizontaldata!=null&&(F-=we.freezenhorizontaldata[0]),$("#luckysheet-scrollbar-y").scrollTop(F)}else if(g.deltaX!=0){let k;g.deltaX>0?y=y+20*h.zoomRatio:y=y-20*h.zoomRatio,$("#luckysheet-scrollbar-x").scrollLeft(y)}s=setTimeout(()=>{h.visibledatacolumn_unique=null,h.visibledatarow_unique=null},500)}),$("#luckysheet-scrollbar-x").scroll(function(){jh()}).mousewheel(function(g,b){g.preventDefault()}),$("#luckysheet-scrollbar-y").scroll(function(){jh()}).mousewheel(function(g,b){g.preventDefault()}),$(window).resize(function(){document.getElementById(h.container)&&Kl()}),$("#luckysheet-rich-text-editor").mouseup(function(g){ht.inputMenuButtonFocus(g.target)}),$("#luckysheet-cell-main, #luckysheetTableContent").mousedown(function(g){if($(g.target).hasClass("luckysheet-mousedown-cancel"))return;m_(),$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","default").end().find(".luckysheet-cs-draghandle").css("cursor","default"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","default"),Nt.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&$t.cancelActiveImgItem();let b=ll(g.pageX,g.pageY);if(b[0]>=h.cellmainWidth-h.cellMainSrollBarSize||b[1]>=h.cellmainHeight-h.cellMainSrollBarSize)return;let y=b[0]+$("#luckysheet-cell-main").scrollLeft(),p=b[1]+$("#luckysheet-cell-main").scrollTop();we.freezenverticaldata!=null&&b[0]<we.freezenverticaldata[0]-we.freezenverticaldata[2]&&(y=b[0]+we.freezenverticaldata[2]),we.freezenhorizontaldata!=null&&b[1]<we.freezenhorizontaldata[0]-we.freezenhorizontaldata[2]&&(p=b[1]+we.freezenhorizontaldata[2]);let x=ct.getSheetByIndex(),_=$("#luckysheetTableContent").get(0).getContext("2d"),S=zl(p),I=S[1],O=S[0],F=S[2],D=Ml(y),k=D[1],w=D[0],C=D[2],T=F,z=C,A=ht.mergeborer(h.flowdata,F,C);if(A&&(I=A.row[1],O=A.row[0],F=A.row[2],T=A.row[3],k=A.column[1],w=A.column[0],C=A.column[2],z=A.column[3]),!Yt.createHookFunction("cellMousedownBefore",h.flowdata[F][C],{r:F,c:C,start_r:O,start_c:w,end_r:I,end_c:k},x,_))return;if(Vt.cellFocus(F,C,!0),w<$("#luckysheet-cell-main").scrollLeft()&&$("#luckysheet-scrollbar-x").scrollLeft(w),O<$("#luckysheet-cell-main").scrollTop()&&$("#luckysheet-scrollbar-y").scrollTop(O),g.which=="3"){$("#luckysheet-dataVerification-showHintBox").hide();let P=!1;for(let N=0;N<h.luckysheet_select_save.length;N++)if(h.luckysheet_select_save[N].row!=null&&F>=h.luckysheet_select_save[N].row[0]&&F<=h.luckysheet_select_save[N].row[1]&&C>=h.luckysheet_select_save[N].column[0]&&C<=h.luckysheet_select_save[N].column[1]){P=!0;break}if(P)return}if(h.flowdata[F]!=null&&h.flowdata[F][C]!=null&&h.flowdata[F][C].dd!=null&&lt.fireMousedown!=null&&V(lt.fireMousedown)=="function"){lt.fireMousedown(h.flowdata[F][C].dd);return}if(Mn.hyperlink&&Mn.hyperlink[F+"_"+C]&&g.which!="3"){Mn.cellFocus(F,C);return}h.luckysheet_scroll_status=!0;let M=$("#luckysheet-input-box");if(parseInt(M.css("top"))>0)if(v.rangestart||v.rangedrag_column_start||v.rangedrag_row_start||v.israngeseleciton()){let P=[F,T],N=[C,z],E=w,B=k-w-1,U=O,X=I-O-1;if(g.shiftKey){let le=v.func_selectedrange,he=0,Z=0,ae=[];le.top>O?(he=O,Z=le.top+le.height-O,le.row[1]>le.row_focus&&(le.row[1]=le.row_focus),ae=[F,le.row[1]]):le.top==O?(he=O,Z=le.top+le.height-O,ae=[F,le.row[0]]):(he=le.top,Z=I-le.top-1,le.row[0]<le.row_focus&&(le.row[0]=le.row_focus),ae=[le.row[0],F]);let J=0,pe=0,K=[];le.left>w?(J=w,pe=le.left+le.width-w,le.column[1]>le.column_focus&&(le.column[1]=le.column_focus),K=[C,le.column[1]]):le.left==w?(J=w,pe=le.left+le.width-w,K=[C,le.column[0]]):(J=le.left,pe=k-le.left-1,le.column[0]<le.column_focus&&(le.column[0]=le.column_focus),K=[le.column[0],C]);let se=ht.mergeMoveMain(K,ae,le,he,Z,J,pe);se!=null&&(K=se[0],ae=se[1],he=se[2],Z=se[3],J=se[4],pe=se[5]),Ti(J,he,pe,Z,ae,K),le.row=ae,le.column=K,le.left_move=J,le.width_move=pe,le.top_move=he,le.height_move=Z,v.func_selectedrange=le}else if(g.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){let le=$("#luckysheet-rich-text-editor").text();if(le[le.length-1]===")"&&(le=le.substr(0,le.length-1)),le.length>0){let he=le.substr(le.length-1,1);he!=","&&he!="="&&he!="("&&(le+=",")}if(le.length>0&&le.substr(0,1)=="="){if(le=v.functionHTMLGenerate(le),window.getSelection){let he=window.getSelection();v.functionRangeIndex=[$(he.anchorNode).parent().index(),he.anchorOffset]}else{let he=document.selection.createRange();v.functionRangeIndex=he}$("#luckysheet-rich-text-editor").html(le+")"),v.canceFunctionrangeSelected(),v.createRangeHightlight()}v.rangestart=!1,v.rangedrag_column_start=!1,v.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(le+")"),v.rangeHightlightselected($("#luckysheet-rich-text-editor")),v.israngeseleciton(),v.func_selectedrange={left:E,width:B,top:U,height:X,left_move:E,width_move:B,top_move:U,height_move:X,row:P,column:N,row_focus:F,column_focus:C}}else v.func_selectedrange={left:E,width:B,top:U,height:X,left_move:E,width_move:B,top_move:U,height_move:X,row:P,column:N,row_focus:F,column_focus:C};v.rangeSetValue({row:P,column:N}),v.rangestart=!0,v.rangedrag_column_start=!1,v.rangedrag_row_start=!1,$("#luckysheet-formula-functionrange-select").css({left:E,width:B,top:U,height:X}).show(),$("#luckysheet-formula-help-c").hide(),Ti(E,U,B,X,P,N),setTimeout(function(){let he=window.getSelection().anchorNode,Z;$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")?(Z=$("#luckysheet-rich-text-editor"),v.rangechangeindex=v.data_parm_index):Z=$(he).closest("div");let ae=Z.find("span[rangeindex='"+v.rangechangeindex+"']");v.setCaretPosition(ae.get(0),0,ae.html().length)},1);return}else v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_select_status=!0,$("#luckysheet-info").is(":visible")&&(h.luckysheet_select_status=!1);else jm(F,C,h.currentSheetIndex)&&(h.luckysheet_select_status=!0);if($("#luckysheet-multiRange-dialog").is(":visible")){if(xt.selectStatus=!0,h.luckysheet_select_status=!1,g.shiftKey){let N=xt.selectRange[xt.selectRange.length-1],E=0,B=0,U=[];N.top>O?(E=O,B=N.top+N.height-O,N.row[1]>N.row_focus&&(N.row[1]=N.row_focus),U=[F,N.row[1]]):N.top==O?(E=O,B=N.top+N.height-O,U=[F,N.row[0]]):(E=N.top,B=I-N.top-1,N.row[0]<N.row_focus&&(N.row[0]=N.row_focus),U=[N.row[0],F]);let X=0,le=0,he=[];N.left>w?(X=w,le=N.left+N.width-w,N.column[1]>N.column_focus&&(N.column[1]=N.column_focus),he=[C,N.column[1]]):N.left==w?(X=w,le=N.left+N.width-w,he=[C,N.column[0]]):(X=N.left,le=k-N.left-1,N.column[0]<N.column_focus&&(N.column[0]=N.column_focus),he=[N.column[0],C]);let Z=ht.mergeMoveMain(he,U,N,E,B,X,le);Z!=null&&(he=Z[0],U=Z[1],E=Z[2],B=Z[3],X=Z[4],le=Z[5]),N.row=U,N.column=he,N.left_move=X,N.width_move=le,N.top_move=E,N.height_move=B,xt.selectRange[xt.selectRange.length-1]=N}else g.ctrlKey?xt.selectRange.push({left:w,width:k-w-1,top:O,height:I-O-1,left_move:w,width_move:k-w-1,top_move:O,height_move:I-O-1,row:[F,T],column:[C,z],row_focus:F,column_focus:C}):(xt.selectRange=[],xt.selectRange.push({left:w,width:k-w-1,top:O,height:I-O-1,left_move:w,width_move:k-w-1,top_move:O,height_move:I-O-1,row:[F,T],column:[C,z],row_focus:F,column_focus:C}));Jl(xt.selectRange);let P=xt.getTxtByRange(xt.selectRange);$("#luckysheet-multiRange-dialog input").val(P);return}else xt.selectStatus=!1,xt.selectRange=[];if($("#luckysheet-singleRange-dialog").is(":visible")){h.luckysheet_select_status=!1,Jl([{row:[F,F],column:[C,C]}]);let P=Al(h.currentSheetIndex,{row:[F,F],column:[C,C]},h.currentSheetIndex);$("#luckysheet-singleRange-dialog input").val(P);return}if($("#luckysheet-dataVerificationRange-dialog").is(":visible")){if(Vt.selectStatus=!0,h.luckysheet_select_status=!1,g.shiftKey){let N=Vt.selectRange[Vt.selectRange.length-1],E=0,B=0,U=[];N.top>O?(E=O,B=N.top+N.height-O,N.row[1]>N.row_focus&&(N.row[1]=N.row_focus),U=[F,N.row[1]]):N.top==O?(E=O,B=N.top+N.height-O,U=[F,N.row[0]]):(E=N.top,B=I-N.top-1,N.row[0]<N.row_focus&&(N.row[0]=N.row_focus),U=[N.row[0],F]);let X=0,le=0,he=[];N.left>w?(X=w,le=N.left+N.width-w,N.column[1]>N.column_focus&&(N.column[1]=N.column_focus),he=[C,N.column[1]]):N.left==w?(X=w,le=N.left+N.width-w,he=[C,N.column[0]]):(X=N.left,le=k-N.left-1,N.column[0]<N.column_focus&&(N.column[0]=N.column_focus),he=[N.column[0],C]);let Z=ht.mergeMoveMain(he,U,N,E,B,X,le);Z!=null&&(he=Z[0],U=Z[1],E=Z[2],B=Z[3],X=Z[4],le=Z[5]),N.row=U,N.column=he,N.left_move=X,N.width_move=le,N.top_move=E,N.height_move=B,Vt.selectRange[Vt.selectRange.length-1]=N}else Vt.selectRange=[],Vt.selectRange.push({left:w,width:k-w-1,top:O,height:I-O-1,left_move:w,width_move:k-w-1,top_move:O,height_move:I-O-1,row:[F,T],column:[C,z],row_focus:F,column_focus:C});Jl(Vt.selectRange);let P=Vt.getTxtByRange(Vt.selectRange);v.rangetosheet!=h.currentSheetIndex&&(P=h.luckysheetfile[$e(h.currentSheetIndex)].name+"!"+P),$("#luckysheet-dataVerificationRange-dialog input").val(P);return}else Vt.selectStatus=!1,Vt.selectRange=[];if(Vc.singleRangeFocus&&$("#luckysheet-ifFormulaGenerator-dialog .singRange").click(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").is(":visible")){h.luckysheet_select_status=!1,v.rangestart=!1,$("#luckysheet-formula-functionrange-select").css({left:w,width:k-w-1,top:O,height:I-O-1}).show(),$("#luckysheet-formula-help-c").hide();let P=Al(h.currentSheetIndex,{row:[F,F],column:[C,C]},h.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-singleRange-dialog input").val(P);return}if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){h.luckysheet_select_status=!1,v.func_selectedrange={left:w,width:k-w-1,top:O,height:I-O-1,left_move:w,width_move:k-w-1,top_move:O,height_move:I-O-1,row:[F,F],column:[C,C],row_focus:F,column_focus:C},v.rangestart=!0,$("#luckysheet-formula-functionrange-select").css({left:w,width:k-w-1,top:O,height:I-O-1}).show(),$("#luckysheet-formula-help-c").hide();let P=Al(h.currentSheetIndex,{row:[F,F],column:[C,C]},h.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(P),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide();return}if(h.luckysheet_select_status){if(g.shiftKey){let P=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),N=0,E=0,B=[];P.top>O?(N=O,E=P.top+P.height-O,P.row[1]>P.row_focus&&(P.row[1]=P.row_focus),B=[F,P.row[1]]):P.top==O?(N=O,E=P.top+P.height-O,B=[F,P.row[0]]):(N=P.top,E=I-P.top-1,P.row[0]<P.row_focus&&(P.row[0]=P.row_focus),B=[P.row[0],F]);let U=0,X=0,le=[];P.left>w?(U=w,X=P.left+P.width-w,P.column[1]>P.column_focus&&(P.column[1]=P.column_focus),le=[C,P.column[1]]):P.left==w?(U=w,X=P.left+P.width-w,le=[C,P.column[0]]):(U=P.left,X=k-P.left-1,P.column[0]<P.column_focus&&(P.column[0]=P.column_focus),le=[P.column[0],C]);let he=ht.mergeMoveMain(le,B,P,N,E,U,X);he!=null&&(le=he[0],B=he[1],N=he[2],E=he[3],U=he[4],X=he[5]),P.row=B,P.column=le,P.left_move=U,P.width_move=X,P.top_move=N,P.height_move=E,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=P,$("#luckysheet-alternateformat-rangeDialog").is(":visible")&&$("#luckysheet-alternateformat-rangeDialog input").val(Al(h.currentSheetIndex,h.luckysheet_select_save)),Pt.luckysheet_pivotTable_select_state&&$("#luckysheet-pivotTable-range-selection-input").val(h.luckysheetfile[$e(h.currentSheetIndex)].name+"!"+Qt(h.luckysheet_select_save[0].column[0])+(h.luckysheet_select_save[0].row[0]+1)+":"+Qt(h.luckysheet_select_save[0].column[1])+(h.luckysheet_select_save[0].row[1]+1))}else g.ctrlKey?h.luckysheet_select_save.push({left:w,width:k-w-1,top:O,height:I-O-1,left_move:w,width_move:k-w-1,top_move:O,height_move:I-O-1,row:[F,T],column:[C,z],row_focus:F,column_focus:C}):(h.luckysheet_select_save.length=0,h.luckysheet_select_save.push({left:w,width:k-w-1,top:O,height:I-O-1,left_move:w,width_move:k-w-1,top_move:O,height_move:I-O-1,row:[F,T],column:[C,z],row_focus:F,column_focus:C}),ht.menuButtonFocus(h.flowdata,F,C),v.fucntionboxshow(F,C));Zt(),(we.freezenhorizontaldata!=null||we.freezenverticaldata!=null)&&we.scrollAdaptOfselect(),Ni.mobilecheck()||uo(),He.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save)}xr.rangefocus&&(xr.rangefocus=!1,$("#luckysheet-alternateformat-range .fa-table").click()),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),Qe()||cg(),Pt.pivotclick(F,C,h.currentSheetIndex),el(),Yt.createHookFunction("cellMousedown",h.flowdata[F][C],{r:F,c:C,start_r:O,start_c:w,end_r:I,end_c:k},x,_)}).mouseup(function(g){if(g.which=="3"){if(!h.allowEdit||Qe())return;let b=g.pageX,y=g.pageY,p=h.flowdata,x=h.luckysheet_select_save[0],_=lt.cellRightClickConfig;if($("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-handleincell").show(),$("#luckysheet-cols-rows-add, #luckysheet-cols-rows-shift").hide(),jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block",jt("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="block",x.row!=null&&x.row[0]==0&&x.row[1]==h.flowdata.length-1){if(!_.copy&&!_.copyAs&&!_.paste&&!_.insertColumn&&!_.deleteColumn&&!_.hideColumn&&!_.columnWidth&&!_.clear&&!_.matrix&&!_.sort&&!_.filter&&!_.chart&&!_.image&&!_.link&&!_.data&&!_.cellFormat)return;h.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Oe().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Oe().rightclick.width),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Oe().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Oe().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),h.luckysheet_cols_menu_status=!0,jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",jt("#luckysheet-top-left-add-selected").style.display=_.insertColumn?"block":"none",jt("#luckysheet-bottom-right-add-selected").style.display=_.insertColumn?"block":"none",jt("#luckysheet-del-selected").style.display=_.deleteColumn?"block":"none",jt("#luckysheet-hide-selected").style.display=_.hideColumn?"block":"none",jt("#luckysheet-show-selected").style.display=_.hideColumn?"block":"none",jt("#luckysheet-column-row-width-selected").style.display=_.columnWidth?"block":"none",!_.copy&&!_.copyAs&&!_.paste&&(jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!_.insertColumn&&!_.deleteColumn&&!_.hideColumn&&!_.columnWidth&&(jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!_.insertColumn&&!_.deleteColumn&&!_.hideColumn&&!_.columnWidth&&(jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none");let S=$.extend(!0,{},h.config);S.columnlen==null&&(S.columnlen={});let I=S.columnlen[h.luckysheet_select_save[0].column[0]]==null?h.defaultcollen:S.columnlen[h.luckysheet_select_save[0].column[0]],O=!0;for(let F=0;F<h.luckysheet_select_save.length;F++){let D=h.luckysheet_select_save[F],k=D.column[0],w=D.column[1];for(let C=k;C<=w;C++)if((S.columnlen[C]==null?h.defaultcollen:S.columnlen[C])!=I){O=!1;break}}O?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(I):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}else if(x.column!=null&&x.column[0]==0&&x.column[1]==h.flowdata[0].length-1){if(!_.copy&&!_.copyAs&&!_.paste&&!_.insertRow&&!_.deleteRow&&!_.hideRow&&!_.rowHeight&&!_.clear&&!_.matrix&&!_.sort&&!_.filter&&!_.chart&&!_.image&&!_.link&&!_.data&&!_.cellFormat)return;h.luckysheetRightHeadClickIs="row",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Oe().rightclick.row),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Oe().rightclick.height),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Oe().rightclick.top),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Oe().rightclick.bottom),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),h.luckysheet_cols_menu_status=!0,jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",jt("#luckysheet-top-left-add-selected").style.display=_.insertRow?"block":"none",jt("#luckysheet-bottom-right-add-selected").style.display=_.insertRow?"block":"none",jt("#luckysheet-del-selected").style.display=_.deleteRow?"block":"none",jt("#luckysheet-hide-selected").style.display=_.hideRow?"block":"none",jt("#luckysheet-show-selected").style.display=_.hideRow?"block":"none",jt("#luckysheet-column-row-width-selected").style.display=_.rowHeight?"block":"none",!_.copy&&!_.copyAs&&!_.paste&&(jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!_.insertRow&&!_.deleteRow&&!_.hideRow&&!_.rowHeight&&(jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!_.insertRow&&!_.deleteRow&&!_.hideRow&&!_.rowHeight&&(jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none");let S=$.extend(!0,{},h.config);S.rowlen==null&&(S.rowlen={});let I=S.rowlen[h.luckysheet_select_save[0].row[0]]==null?h.defaultrowlen:S.rowlen[h.luckysheet_select_save[0].row[0]],O=!0;for(let F=0;F<h.luckysheet_select_save.length;F++){let D=h.luckysheet_select_save[F],k=D.row[0],w=D.row[1];for(let C=k;C<=w;C++)if((S.rowlen[C]==null?h.defaultrowlen:S.rowlen[C])!=I){O=!1;break}}O?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(I):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}else{if(!_.copy&&!_.copyAs&&!_.paste&&!_.insertRow&&!_.insertColumn&&!_.deleteRow&&!_.deleteColumn&&!_.deleteCell&&!_.clear&&!_.matrix&&!_.sort&&!_.filter&&!_.chart&&!_.image&&!_.link&&!_.data&&!_.cellFormat)return;!_.copy&&!_.copyAs&&!_.paste&&(jt("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="none",!_.insertRow&&!_.insertColumn&&!_.deleteRow&&!_.deleteColumn&&!_.deleteCell&&(jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!_.insertRow&&!_.insertColumn&&!_.deleteRow&&!_.deleteColumn&&!_.deleteCell&&(jt("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="none")}!_.clear&&!_.matrix&&!_.sort&&!_.filter&&!_.chart&&!_.image&&!_.link&&!_.data&&!_.cellFormat&&(jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),ea($("#luckysheet-rightclick-menu"),b,y)}He.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save)}).dblclick(function(g){if($(g.target).hasClass("luckysheet-mousedown-cancel")||!h.allowEdit||parseInt($("#luckysheet-input-box").css("top"))>0)return;let b=ll(g.pageX,g.pageY);if(b[0]>=h.cellmainWidth-h.cellMainSrollBarSize||b[1]>=h.cellmainHeight-h.cellMainSrollBarSize)return;let y=$("#luckysheet-cell-main").scrollLeft(),p=$("#luckysheet-cell-main").scrollTop(),x=b[0]+y,_=b[1]+p;we.freezenverticaldata!=null&&b[0]<we.freezenverticaldata[0]-we.freezenverticaldata[2]&&(x=b[0]+we.freezenverticaldata[2]),we.freezenhorizontaldata!=null&&b[1]<we.freezenhorizontaldata[0]-we.freezenhorizontaldata[2]&&(_=b[1]+we.freezenhorizontaldata[2]);let S=zl(_),I=S[2],O=Ml(x),F=O[2],D=ht.mergeborer(h.flowdata,I,F);if(D&&(I=D.row[2],F=D.column[2]),Pt.isPivotRange(I,F)){if((Pt.filter==null||Pt.filter.length==0)&&(Pt.row==null||Pt.row.length==0)&&(Pt.column==null||Pt.column.length==0)&&(Pt.values==null||Pt.values.length==0)||Pt.values==null||Pt.values.length==0||I==0||F==0)return;if(Pt.column!=null&&Pt.column.length>0){if(Pt.values.length>=2&&Pt.showType=="column"){if(I<=Pt.column.length||F>=Pt.pivotDatas[0].length-Pt.values.length)return}else if(I<=Pt.column.length-1||F>=Pt.pivotDatas[0].length-1)return}if(Pt.row!=null&&Pt.row.length>0){if(Pt.values.length>=2&&Pt.showType=="row"){if(F<=Pt.row.length||I>=Pt.pivotDatas.length-Pt.values.length)return}else if(F<=Pt.row.length-1||I>=Pt.pivotDatas.length-1)return}ct.addNewSheet(g),Pt.drillDown(I,F);return}if($("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible"))$("#luckysheet-cell-selected").hide();else{if($("#luckysheet-conditionformat-dialog").is(":visible")||$("#luckysheet-administerRule-dialog").is(":visible")||$("#luckysheet-newConditionRule-dialog").is(":visible")||$("#luckysheet-editorConditionRule-dialog").is(":visible")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;if($("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")||$("#luckysheet-alternateformat-rangeDialog").is(":visible"))return;{ht.luckysheetPaintModelOn&&ht.cancelPaintModel();let k=h.luckysheet_select_save[0].column_focus,w=h.luckysheet_select_save[0].row_focus;(k!==F||w!==I)&&(I=w,F=k),Dn(I,F,h.flowdata),Zt()}}}),document.getElementById("luckysheet-cell-main").addEventListener("drop",function(g){g.preventDefault(),g.stopPropagation();let b=g.dataTransfer.files;if(b.length==1&&b[0].type.indexOf("image")>-1){if(!Hl(h.currentSheetIndex,"editObjects"))return;$t.insertImg(b[0])}u(g)},!1),document.getElementById("luckysheet-cell-main").addEventListener("dragover",function(g){g.preventDefault(),g.stopPropagation()},!1);function u(g){if(lt&&lt.hook&&lt.hook.cellDragStop){let b=ll(g.pageX,g.pageY),y=b[0]+$("#luckysheet-cell-main").scrollLeft(),p=b[1]+$("#luckysheet-cell-main").scrollTop(),x=zl(p),_=x[1],S=x[0],I=x[2],O=Ml(y),F=O[1],D=O[0],k=O[2],w=ht.mergeborer(h.flowdata,I,k);w&&(_=w.row[1],S=w.row[0],I=w.row[2],F=w.column[1],D=w.column[0],k=w.column[2]);let C=ct.getSheetByIndex(),T=$("#luckysheetTableContent").get(0).getContext("2d");Yt.createHookFunction("cellDragStop",h.flowdata[I][k],{r:I,c:k,start_r:S,start_c:D,end_r:_,end_c:F},C,T,g)}}$(document).on("mousemove.luckysheetEvent",function(g){if(Nt.overshow(g),Mn.overshow(g),window.cancelAnimationFrame(h.jfautoscrollTimeout),lt&&lt.hook&&lt.hook.sheetMousemove){let b=ll(g.pageX,g.pageY),y=b[0]+$("#luckysheet-cell-main").scrollLeft(),p=b[1]+$("#luckysheet-cell-main").scrollTop(),x=zl(p),_=x[1],S=x[0],I=x[2],O=Ml(y),F=O[1],D=O[0],k=O[2],w=ht.mergeborer(h.flowdata,I,k);w&&(_=w.row[1],S=w.row[0],I=w.row[2],F=w.column[1],D=w.column[0],k=w.column[2]);let C=ct.getSheetByIndex(),T={functionResizeStatus:v.functionResizeStatus,horizontalmoveState:!!we.horizontalmovestate,verticalmoveState:!!we.verticalmovestate,pivotTableMoveState:!!Pt&&Pt.movestate,sheetMoveStatus:h.luckysheet_sheet_move_status,scrollStatus:!!h.luckysheet_scroll_status,selectStatus:!!h.luckysheet_select_status,rowsSelectedStatus:!!h.luckysheet_rows_selected_status,colsSelectedStatus:!!h.luckysheet_cols_selected_status,cellSelectedMove:!!h.luckysheet_cell_selected_move,cellSelectedExtend:!!h.luckysheet_cell_selected_extend,colsChangeSize:!!h.luckysheet_cols_change_size,rowsChangeSize:!!h.luckysheet_rows_change_size,chartMove:!!h.chartparam.luckysheetCurrentChartMove,chartResize:!!h.chartparam.luckysheetCurrentChartResize,rangeResize:!!v.rangeResize,rangeMove:!!v.rangeMove},z=$("#luckysheetTableContent").get(0).getContext("2d");h.flowdata&&h.flowdata[I]&&Yt.createHookFunction("sheetMousemove",h.flowdata[I][k],{r:I,c:k,start_r:S,start_c:D,end_r:_,end_c:F},C,T,z)}if(v.functionResizeStatus){let y=g.pageY-v.functionResizeData.y,p=v.functionResizeData.calculatebarHeight+y,x=Math.round($(window).height()/2);if(p<=28){if(p<=20)return;p=28}else if(p>=x){if(p>=x+8)return;p=x}h.calculatebarHeight=p,$("#luckysheet-wa-calculate").css("height",h.calculatebarHeight-2),$("#luckysheet-wa-calculate-size").css({background:"#5e5e5e",cursor:"ns-resize"}),clearTimeout(v.functionResizeTimeout),v.functionResizeTimeout=setTimeout(function(){Kl()},15)}else if(we.horizontalmovestate){let b=ll(g.pageX,g.pageY),y=$("#luckysheet-cell-main").scrollLeft(),p=$("#luckysheet-cell-main").scrollTop(),x=b[0]+y,_=b[1]+p,S=zl(_),I=S[1],O=S[0],F=S[2],D=b[1]+h.columnHeaderHeight;D<h.columnHeaderHeight&&(D=h.columnHeaderHeight),D>we.windowHeight-4&&(D=we.windowHeight-4),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({top:D}),D+p-h.columnHeaderHeight>=O+(I-O)/2?(D=I-2-p+h.columnHeaderHeight,we.freezenhorizontaldata=[I,F+1,p,we.cutVolumn(h.visibledatarow,F+1),D]):(D=O-2-p+h.columnHeaderHeight,we.freezenhorizontaldata=[O,F,p,we.cutVolumn(h.visibledatarow,F),D]),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").css({top:D}),we.saveFreezen(we.freezenhorizontaldata,D,null,null)}else if(we.verticalmovestate){let b=ll(g.pageX,g.pageY),y=$("#luckysheet-cell-main").scrollLeft(),p=$("#luckysheet-cell-main").scrollTop(),x=b[0]+y,_=b[1]+p,S=Ml(x),I=S[1],O=S[0],F=S[2],D=b[0]+h.rowHeaderWidth;D<h.rowHeaderWidth&&(D=h.rowHeaderWidth),D>we.windowWidth-4&&(D=we.windowWidth-4),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({left:D}),D+y-h.rowHeaderWidth>=O+(I-O)/2?(D=I-2-y+h.rowHeaderWidth,we.freezenverticaldata=[I,F+1,y,we.cutVolumn(h.visibledatacolumn,F+1),D]):(D=O-2-y+h.rowHeaderWidth,we.freezenverticaldata=[O,F,y,we.cutVolumn(h.visibledatacolumn,F),D]),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").css({left:D}),we.saveFreezen(null,null,we.freezenverticaldata,D),Kl()}else if(!!Pt&&Pt.movestate){let b=g.pageX,y=g.pageY;$("#luckysheet-modal-dialog-slider-pivot-move").css({left:b-Pt.movesave.width/2,top:y-Pt.movesave.height})}else if(h.luckysheet_sheet_move_status){let b=$("#luckysheet-sheet-container-c").scrollLeft(),y=g.pageX+b;if(Math.abs(g.pageX-h.luckysheet_sheet_move_data.pageX)<3)return;let p=$("#luckysheet-sheet-container").width(),x=y-h.luckysheet_sheet_move_data.curleft-$("#luckysheet-sheet-container").offset().left;h.luckysheet_sheet_move_data.activeobject.css({left:x});let _=al(h.luckysheet_sheet_move_data.widthlist,x+h.luckysheet_sheet_move_data.curleft);h.luckysheet_sheet_move_data.cursorobject.css({cursor:"move"}),x-b<=6&&$("#luckysheet-sheets-leftscroll").click(),x-b>=p-40&&$("#luckysheet-sheets-rightscroll").click(),_!=h.luckysheet_sheet_move_data.curindex&&(_==-1&&x>0?(_=h.luckysheet_sheet_move_data.widthlist.length-1,$("#luckysheet-sheets-item-clone").insertAfter($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(_))):_==-1&&x<=0?$("#luckysheet-sheets-item-clone").insertBefore($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(0)):$("#luckysheet-sheets-item-clone").insertAfter($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(_)),h.luckysheet_sheet_move_data.widthlist=[],$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").each(function(S){S==0?h.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):h.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+h.luckysheet_sheet_move_data.widthlist[S-1])}),h.luckysheet_sheet_move_data.curindex=$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").index($("#luckysheet-sheets-item-clone")))}else if(h.luckysheet_model_move_state){let b=$(document).scrollTop(),y=$(document).scrollLeft(),p=g.pageY+b,x=g.pageX+y,_=$(window).height(),S=$(window).width(),I=h.luckysheet_model_move_obj.height(),O=h.luckysheet_model_move_obj.width(),F=p-h.luckysheet_model_xy[1],D=x-h.luckysheet_model_xy[0];F<0&&(F=0),F+I+62>_&&(F=_-I-62),D<0&&(D=0),D+O+86>S&&(D=S-O-86),h.luckysheet_model_move_obj.css({top:F,left:D}),g.preventDefault()}else if(!!h.luckysheet_scroll_status||!!h.luckysheet_select_status||!!h.luckysheet_rows_selected_status||!!h.luckysheet_cols_selected_status||!!h.luckysheet_cell_selected_move||!!h.luckysheet_cell_selected_extend||!!h.luckysheet_cols_change_size||!!h.luckysheet_rows_change_size||!!h.chartparam.luckysheetCurrentChartMove||!!h.chartparam.luckysheetCurrentChartResize||!!v.rangeResize||!!v.rangeMove){let b=function(){if(h.luckysheet_scroll_status&&!h.luckysheet_cols_change_size&&!h.luckysheet_rows_change_size){let y=ll(g.pageX,g.pageY),p=$("#luckysheet-scrollbar-x").scrollLeft(),x=$("#luckysheet-scrollbar-y").scrollTop(),_=y[0],S=y[1],I=$("#luckysheet-cell-main").height()-20*h.zoomRatio,O=$("#luckysheet-cell-main").width()-60*h.zoomRatio;if(S<0||S>I){let F;S<0?F=x+S/2:F=x+(S-I)/2,$("#luckysheet-scrollbar-y").scrollTop(F)}if(_<0||_>O){let F;_<0?F=p+_/2:F=p+(_-O)/2,$("#luckysheet-scrollbar-x").scrollLeft(F)}}if(h.luckysheet_select_status){let y=ll(g.pageX,g.pageY),p=y[0]+$("#luckysheet-cell-main").scrollLeft(),x=y[1]+$("#luckysheet-cell-main").scrollTop(),_=zl(x),S=_[1],I=_[0],O=_[2],F=Ml(p),D=F[1],k=F[0],w=F[2];if(!jm(O,w,h.currentSheetIndex))return;let C=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),T=0,z=0,A=[];C.top>I?(T=I,z=C.top+C.height-I,C.row[1]>C.row_focus&&(C.row[1]=C.row_focus),A=[O,C.row[1]]):C.top==I?(T=I,z=C.top+C.height-I,A=[O,C.row[0]]):(T=C.top,z=S-C.top-1,C.row[0]<C.row_focus&&(C.row[0]=C.row_focus),A=[C.row[0],O]);let M=0,P=0,N=[];C.left>k?(M=k,P=C.left+C.width-k,C.column[1]>C.column_focus&&(C.column[1]=C.column_focus),N=[w,C.column[1]]):C.left==k?(M=k,P=C.left+C.width-k,N=[w,C.column[0]]):(M=C.left,P=D-C.left-1,C.column[0]<C.column_focus&&(C.column[0]=C.column_focus),N=[C.column[0],w]);let E=ht.mergeMoveMain(N,A,C,T,z,M,P);E!=null&&(N=E[0],A=E[1],T=E[2],z=E[3],M=E[4],P=E[5]),C.row=A,C.column=N,C.left_move=M,C.width_move=P,C.top_move=T,C.height_move=z,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=C,Zt(),we.scrollFreezen(),$("#luckysheet-alternateformat-rangeDialog").is(":visible")&&$("#luckysheet-alternateformat-rangeDialog input").val(Al(h.currentSheetIndex,h.luckysheet_select_save[h.luckysheet_select_save.length-1])),Pt.luckysheet_pivotTable_select_state&&$("#luckysheet-pivotTable-range-selection-input").val(h.luckysheetfile[$e(h.currentSheetIndex)].name+"!"+Qt(h.luckysheet_select_save[0].column[0])+(h.luckysheet_select_save[0].row[0]+1)+":"+Qt(h.luckysheet_select_save[0].column[1])+(h.luckysheet_select_save[0].row[1]+1))}else if(xt.selectStatus){let y=ll(g.pageX,g.pageY),p=y[0]+$("#luckysheet-cell-main").scrollLeft(),x=y[1]+$("#luckysheet-cell-main").scrollTop(),_=zl(x),S=_[1],I=_[0],O=_[2],F=Ml(p),D=F[1],k=F[0],w=F[2],C=xt.selectRange[xt.selectRange.length-1],T=0,z=0,A=[];C.top>I?(T=I,z=C.top+C.height-I,C.row[1]>C.row_focus&&(C.row[1]=C.row_focus),A=[O,C.row[1]]):C.top==I?(T=I,z=C.top+C.height-I,A=[O,C.row[0]]):(T=C.top,z=S-C.top-1,C.row[0]<C.row_focus&&(C.row[0]=C.row_focus),A=[C.row[0],O]);let M=0,P=0,N=[];C.left>k?(M=k,P=C.left+C.width-k,C.column[1]>C.column_focus&&(C.column[1]=C.column_focus),N=[w,C.column[1]]):C.left==k?(M=k,P=C.left+C.width-k,N=[w,C.column[0]]):(M=C.left,P=D-C.left-1,C.column[0]<C.column_focus&&(C.column[0]=C.column_focus),N=[C.column[0],w]);let E=ht.mergeMoveMain(N,A,C,T,z,M,P);E!=null&&(N=E[0],A=E[1],T=E[2],z=E[3],M=E[4],P=E[5]),C.row=A,C.column=N,C.left_move=M,C.width_move=P,C.top_move=T,C.height_move=z,xt.selectRange[xt.selectRange.length-1]=C,Jl(xt.selectRange);let B=xt.getTxtByRange(xt.selectRange);$("#luckysheet-multiRange-dialog input").val(B)}else if(Vt.selectStatus){let y=ll(g.pageX,g.pageY),p=y[0]+$("#luckysheet-cell-main").scrollLeft(),x=y[1]+$("#luckysheet-cell-main").scrollTop(),_=zl(x),S=_[1],I=_[0],O=_[2],F=Ml(p),D=F[1],k=F[0],w=F[2],C=Vt.selectRange[Vt.selectRange.length-1],T=0,z=0,A=[];C.top>I?(T=I,z=C.top+C.height-I,C.row[1]>C.row_focus&&(C.row[1]=C.row_focus),A=[O,C.row[1]]):C.top==I?(T=I,z=C.top+C.height-I,A=[O,C.row[0]]):(T=C.top,z=S-C.top-1,C.row[0]<C.row_focus&&(C.row[0]=C.row_focus),A=[C.row[0],O]);let M=0,P=0,N=[];C.left>k?(M=k,P=C.left+C.width-k,C.column[1]>C.column_focus&&(C.column[1]=C.column_focus),N=[w,C.column[1]]):C.left==k?(M=k,P=C.left+C.width-k,N=[w,C.column[0]]):(M=C.left,P=D-C.left-1,C.column[0]<C.column_focus&&(C.column[0]=C.column_focus),N=[C.column[0],w]);let E=ht.mergeMoveMain(N,A,C,T,z,M,P);E!=null&&(N=E[0],A=E[1],T=E[2],z=E[3],M=E[4],P=E[5]),C.row=A,C.column=N,C.left_move=M,C.width_move=P,C.top_move=T,C.height_move=z,Vt.selectRange[Vt.selectRange.length-1]=C,Jl(Vt.selectRange);let B=Vt.getTxtByRange(Vt.selectRange);v.rangetosheet!=h.currentSheetIndex&&(B=h.luckysheetfile[$e(h.currentSheetIndex)].name+"!"+B),$("#luckysheet-dataVerificationRange-dialog input").val(B)}else if(v.rangestart)v.rangedrag(g);else if(v.rangedrag_row_start)v.rangedrag_row(g);else if(v.rangedrag_column_start)v.rangedrag_column(g);else if(h.luckysheet_rows_selected_status){let p=ll(g.pageX,g.pageY)[1]+$("#luckysheet-rows-h").scrollTop();if(p<0)return!1;let x=zl(p),_=x[1],S=x[0],I=x[2],O=h.visibledatacolumn.length-1,F=h.visibledatacolumn[O],D=0,k=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),w=0,C=0,T=[];k.top>S?(w=S,C=k.top+k.height-S,k.row[1]>k.row_focus&&(k.row[1]=k.row_focus),T=[I,k.row[1]]):k.top==S?(w=S,C=k.top+k.height-S,T=[I,k.row[0]]):(w=k.top,C=_-k.top-1,k.row[0]<k.row_focus&&(k.row[0]=k.row_focus),T=[k.row[0],I]),k.row=T,k.top_move=w,k.height_move=C,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=k,Zt(),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){mn()},500)}else if(h.luckysheet_cols_selected_status){let p=ll(g.pageX,g.pageY)[0]+$("#luckysheet-cols-h-c").scrollLeft();if(p<0)return!1;let x=h.visibledatarow.length-1,_=h.visibledatarow[x],S=0,I=Ml(p),O=I[1],F=I[0],D=I[2],k=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),w=0,C=0,T=[];k.left>F?(w=F,C=k.left+k.width-F,k.column[1]>k.column_focus&&(k.column[1]=k.column_focus),T=[D,k.column[1]]):k.left==F?(w=F,C=k.left+k.width-F,T=[D,k.column[0]]):(w=k.left,C=O-k.left-1,k.column[0]<k.column_focus&&(k.column[0]=k.column_focus),T=[k.column[0],D]),k.column=T,k.left_move=w,k.width_move=C,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=k,Zt(),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){mn()},500)}else if(h.luckysheet_cell_selected_move){let y=ll(g.pageX,g.pageY),p=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),_=y[0]+p,S=y[1]+x,I=$(window).height()+x-h.sheetBarHeight-h.statisticBarHeight,O=$(window).width()+p,F=zl(S),D=F[1],k=F[0],w=F[2],C=Ml(_),T=C[1],z=C[0],A=C[2],M=h.luckysheet_cell_selected_move_index[0],P=h.luckysheet_cell_selected_move_index[1],N=h.luckysheet_select_save[0].row[0]-M+w,E=h.luckysheet_select_save[0].row[1]-M+w,B=h.luckysheet_select_save[0].column[0]-P+A,U=h.luckysheet_select_save[0].column[1]-P+A;(N<0||S<0)&&(N=0,E=h.luckysheet_select_save[0].row[1]-h.luckysheet_select_save[0].row[0]),(B<0||_<0)&&(B=0,U=h.luckysheet_select_save[0].column[1]-h.luckysheet_select_save[0].column[0]),(E>=h.visibledatarow[h.visibledatarow.length-1]||S>I)&&(N=h.visibledatarow.length-1-h.luckysheet_select_save[0].row[1]+h.luckysheet_select_save[0].row[0],E=h.visibledatarow.length-1),(U>=h.visibledatacolumn[h.visibledatacolumn.length-1]||_>O)&&(B=h.visibledatacolumn.length-1-h.luckysheet_select_save[0].column[1]+h.luckysheet_select_save[0].column[0],U=h.visibledatacolumn.length-1),z=B-1==-1?0:h.visibledatacolumn[B-1],T=h.visibledatacolumn[U],k=N-1==-1?0:h.visibledatarow[N-1],D=h.visibledatarow[E],$("#luckysheet-cell-selected-move").css({left:z,width:T-z-2,top:k,height:D-k-2,display:"block"})}else if(h.luckysheet_cell_selected_extend){let y=ll(g.pageX,g.pageY),p=$("#luckysheet-cell-main").scrollLeft()-5,x=$("#luckysheet-cell-main").scrollTop()-5,_=y[0]+p,S=y[1]+x,I=$(window).height()+x-h.sheetBarHeight-h.statisticBarHeight,O=$(window).width()+p,F=zl(S),D=F[1],k=F[0],w=F[2],C=Ml(_),T=C[1],z=C[0],A=C[2],M=h.luckysheet_cell_selected_extend_index[0],P=h.luckysheet_cell_selected_extend_index[1],N=h.luckysheet_select_save[0].row[0],E=h.luckysheet_select_save[0].row[1],B=h.luckysheet_select_save[0].column[0],U=h.luckysheet_select_save[0].column[1];(N<0||S<0)&&(N=0,E=h.luckysheet_select_save[0].row[1]-h.luckysheet_select_save[0].row[0]),(B<0||_<0)&&(B=0,U=h.luckysheet_select_save[0].column[1]-h.luckysheet_select_save[0].column[0]),(E>=h.visibledatarow[h.visibledatarow.length-1]||S>I)&&(N=h.visibledatarow.length-1-h.luckysheet_select_save[0].row[1]+h.luckysheet_select_save[0].row[0],E=h.visibledatarow.length-1),(U>=h.visibledatacolumn[h.visibledatacolumn.length-1]||_>O)&&(B=h.visibledatacolumn.length-1-h.luckysheet_select_save[0].column[1]+h.luckysheet_select_save[0].column[0],U=h.visibledatacolumn.length-1);let X=h.luckysheet_select_save[0].top_move,le=h.luckysheet_select_save[0].height_move,he=h.luckysheet_select_save[0].left_move,Z=h.luckysheet_select_save[0].width_move;Math.abs(M-w)>Math.abs(P-A)?w>=N&&w<=E||(h.luckysheet_select_save[0].top_move>=k?(X=k,le=h.luckysheet_select_save[0].top_move+h.luckysheet_select_save[0].height_move-k):(X=h.luckysheet_select_save[0].top_move,le=D-h.luckysheet_select_save[0].top_move-1)):A>=B&&A<=U||(h.luckysheet_select_save[0].left_move>=z?(he=z,Z=h.luckysheet_select_save[0].left_move+h.luckysheet_select_save[0].width_move-z):(he=h.luckysheet_select_save[0].left_move,Z=T-h.luckysheet_select_save[0].left_move-1)),$("#luckysheet-cell-selected-extend").css({left:he,width:Z,top:X,height:le,display:"block"})}else if(h.luckysheet_cols_change_size){let y=ll(g.pageX,g.pageY),p=$("#luckysheet-cols-h-c").scrollLeft(),x=y[0]+p,_=$(window).width(),S=h.visibledatarow.length-1,I=h.visibledatarow[S],O=0,F=Ml(x),D=F[1],k=F[0],w=F[2];x+3-h.luckysheet_cols_change_size_start[0]>30&&x<_+p-100&&($("#luckysheet-change-size-line").css({left:x}),$("#luckysheet-cols-change-size").css({left:x-2}))}else if(h.luckysheet_rows_change_size){let y=ll(g.pageX,g.pageY),p=$("#luckysheet-rows-h").scrollTop(),x=y[1]+p,_=$(window).height(),S=zl(x),I=S[1],O=S[0],F=S[2];x+3-h.luckysheet_rows_change_size_start[0]>19&&x<_+p-200&&($("#luckysheet-change-size-line").css({top:x}),$("#luckysheet-rows-change-size").css({top:x}))}else if(h.chartparam.luckysheetCurrentChartMove){let y=ll(g.pageX,g.pageY),p=y[0]+$("#luckysheet-cell-main").scrollLeft(),x=y[1]+$("#luckysheet-cell-main").scrollTop(),_=h.chartparam.luckysheetCurrentChartMoveObj.height(),S=h.chartparam.luckysheetCurrentChartMoveObj.width(),I=x-h.chartparam.luckysheetCurrentChartMoveXy[1],O=p-h.chartparam.luckysheetCurrentChartMoveXy[0];if(I<0&&(I=0),I+_+42+6>h.chartparam.luckysheetCurrentChartMoveWinH&&(I=h.chartparam.luckysheetCurrentChartMoveWinH-_-42-6),O<0&&(O=0),O+S+22+36>h.chartparam.luckysheetCurrentChartMoveWinW&&(O=h.chartparam.luckysheetCurrentChartMoveWinW-S-22-36),h.chartparam.luckysheetCurrentChartMoveObj.css({top:I,left:O}),we.freezenhorizontaldata!=null||we.freezenverticaldata!=null){we.scrollAdapt();let F=h.chartparam.luckysheetCurrentChartMoveObj.offset(),D=h.chartparam.luckysheetCurrentChartMoveObj.position();h.chartparam.luckysheetCurrentChartMoveXy=[g.pageX-F.left,g.pageY-F.top,D.left,D.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()]}}else if(h.chartparam.luckysheetCurrentChartResize){let y=$("#luckysheet-cell-main").scrollTop(),p=$("#luckysheet-cell-main").scrollLeft(),x=ll(g.pageX,g.pageY),_=x[0]+p,S=x[1]+y;if(_<0||S<0)return!1;let I=h.chartparam.luckysheetCurrentChartResizeObj.height(),O=h.chartparam.luckysheetCurrentChartResizeObj.width(),F=S-h.chartparam.luckysheetCurrentChartResizeXy[1],D=_-h.chartparam.luckysheetCurrentChartResizeXy[0],k=h.chartparam.luckysheetCurrentChartResizeXy[5],w=h.chartparam.luckysheetCurrentChartResizeXy[3],C=h.chartparam.luckysheetCurrentChartResizeXy[4],T=h.chartparam.luckysheetCurrentChartResizeXy[2];(h.chartparam.luckysheetCurrentChartResize=="lm"||h.chartparam.luckysheetCurrentChartResize=="lt"||h.chartparam.luckysheetCurrentChartResize=="lb")&&(C=_,T=h.chartparam.luckysheetCurrentChartResizeXy[2]-D,C>h.chartparam.luckysheetCurrentChartResizeXy[2]+h.chartparam.luckysheetCurrentChartResizeXy[4]-60?(C=h.chartparam.luckysheetCurrentChartResizeXy[2]+h.chartparam.luckysheetCurrentChartResizeXy[4]-60,T=h.chartparam.luckysheetCurrentChartResizeXy[2]-(h.chartparam.luckysheetCurrentChartResizeXy[2]+h.chartparam.luckysheetCurrentChartResizeXy[4]-60-h.chartparam.luckysheetCurrentChartResizeXy[0])):C<=0&&(C=0,T=h.chartparam.luckysheetCurrentChartResizeXy[2]+h.chartparam.luckysheetCurrentChartResizeXy[0])),(h.chartparam.luckysheetCurrentChartResize=="rm"||h.chartparam.luckysheetCurrentChartResize=="rt"||h.chartparam.luckysheetCurrentChartResize=="rb")&&(T=h.chartparam.luckysheetCurrentChartResizeXy[2]+D,T<60?T=60:T>=h.chartparam.luckysheetCurrentChartResizeWinW-h.chartparam.luckysheetCurrentChartResizeXy[4]-22-36&&(T=h.chartparam.luckysheetCurrentChartResizeWinW-h.chartparam.luckysheetCurrentChartResizeXy[4]-22-36)),(h.chartparam.luckysheetCurrentChartResize=="mt"||h.chartparam.luckysheetCurrentChartResize=="lt"||h.chartparam.luckysheetCurrentChartResize=="rt")&&(k=S,w=h.chartparam.luckysheetCurrentChartResizeXy[3]-F,k>h.chartparam.luckysheetCurrentChartResizeXy[3]+h.chartparam.luckysheetCurrentChartResizeXy[5]-60?(k=h.chartparam.luckysheetCurrentChartResizeXy[3]+h.chartparam.luckysheetCurrentChartResizeXy[5]-60,w=h.chartparam.luckysheetCurrentChartResizeXy[3]-(h.chartparam.luckysheetCurrentChartResizeXy[3]+h.chartparam.luckysheetCurrentChartResizeXy[5]-60-h.chartparam.luckysheetCurrentChartResizeXy[1])):k<=0&&(k=0,w=h.chartparam.luckysheetCurrentChartResizeXy[3]+h.chartparam.luckysheetCurrentChartResizeXy[1])),(h.chartparam.luckysheetCurrentChartResize=="mb"||h.chartparam.luckysheetCurrentChartResize=="lb"||h.chartparam.luckysheetCurrentChartResize=="rb")&&(w=h.chartparam.luckysheetCurrentChartResizeXy[3]+F,w<60?w=60:w>=h.chartparam.luckysheetCurrentChartResizeWinH-h.chartparam.luckysheetCurrentChartResizeXy[5]-42-6&&(w=h.chartparam.luckysheetCurrentChartResizeWinH-h.chartparam.luckysheetCurrentChartResizeXy[5]-42-6));let z={top:k,left:C,height:w,width:T};h.chartparam.luckysheetCurrentChartResizeObj.css(z),h.resizeChart(h.chartparam.luckysheetCurrentChart)}else if($t.move){let y=ll(g.pageX,g.pageY),p=y[0]+$("#luckysheet-cell-main").scrollLeft(),x=y[1]+$("#luckysheet-cell-main").scrollTop(),_=$t.images[$t.currentImgId];_.isFixedPos&&(p=g.pageX,x=g.pageY);let S=$("#luckysheet-modal-dialog-activeImage").height(),I=$("#luckysheet-modal-dialog-activeImage").width(),O=x-$t.moveXY[1],F=p-$t.moveXY[0],D=0,k=$t.currentWinH-S-42-6,w=0,C=$t.currentWinW-I-22-36;_.isFixedPos&&(D=h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight,k=D+h.cellmainHeight-h.cellMainSrollBarSize-S,w=h.rowHeaderWidth,C=w+h.cellmainWidth-h.cellMainSrollBarSize-I),O<D&&(O=D),O>k&&(O=k),F<w&&(F=w),F>C&&(F=C),$("#luckysheet-modal-dialog-activeImage").css({left:F,top:O})}else if($t.resize){let y=ll(g.pageX,g.pageY),p=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),_=y[0]+p,S=y[1]+x;if(_<0||S<0)return!1;let I=$t.resizeXY,O=S-I[1],F=_-I[0],D=I[5],k=I[3],w=I[4],C=I[2],T=$t.resize,z=$t.images[$t.currentImgId];if(z.isFixedPos){let U=h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight,X=h.rowHeaderWidth;T=="lt"?(w=I[4]-I[6]+F,w<X&&(w=X),w>I[4]-I[6]+I[2]-1&&(w=I[4]-I[6]+I[2]-1),C=I[4]-I[6]+I[2]-w,k=Math.round(C*(I[3]/I[2])),D=I[5]-I[7]+I[3]-k,D<U&&(D=U,k=I[5]-I[7]+I[3]-D,C=Math.round(k*(I[2]/I[3])),w=I[4]-I[6]+I[2]-C),D>I[5]-I[7]+I[3]-1&&(D=I[5]-I[7]+I[3]-1,k=I[5]-I[7]+I[3]-D,C=Math.round(k*(I[2]/I[3])),w=I[4]-I[6]+I[2]-C)):T=="lm"?(w=I[4]-I[6]+F,w<X&&(w=X),w>I[4]-I[6]+I[2]-1&&(w=I[4]-I[6]+I[2]-1),C=I[4]-I[6]+I[2]-w,D=I[5]-I[7],k=I[3]):T=="lb"?(w=I[4]-I[6]+F,w<X&&(w=X),w>I[4]-I[6]+I[2]-1&&(w=I[4]-I[6]+I[2]-1),C=I[4]-I[6]+I[2]-w,k=Math.round(C*(I[3]/I[2])),D=I[5]-I[7],k<1&&(k=1,C=Math.round(k*(I[2]/I[3])),w=I[4]-I[6]+I[2]-C),k>U+h.cellmainHeight-h.cellMainSrollBarSize-D&&(k=U+h.cellmainHeight-h.cellMainSrollBarSize-D,C=Math.round(k*(I[2]/I[3])),w=I[4]-I[6]+I[2]-C)):T=="rt"?(w=I[4]-I[6],C=I[2]+F,C<1&&(C=1),C>X+h.cellmainWidth-h.cellMainSrollBarSize-w&&(C=X+h.cellmainWidth-h.cellMainSrollBarSize-w),k=Math.round(C*(I[3]/I[2])),D=I[5]-I[7]+I[3]-k,D<U&&(D=U,k=I[5]-I[7]+I[3]-D,C=Math.round(k*(I[2]/I[3]))),D>I[5]-I[7]+I[3]-1&&(D=I[5]-I[7]+I[3]-1,k=I[5]-I[7]+I[3]-D,C=Math.round(k*(I[2]/I[3])))):T=="rm"?(w=I[4]-I[6],C=I[2]+F,C<1&&(C=1),C>X+h.cellmainWidth-h.cellMainSrollBarSize-w&&(C=X+h.cellmainWidth-h.cellMainSrollBarSize-w),D=I[5]-I[7],k=I[3]):T=="rb"?(w=I[4]-I[6],C=I[2]+F,C<1&&(C=1),C>X+h.cellmainWidth-h.cellMainSrollBarSize-w&&(C=X+h.cellmainWidth-h.cellMainSrollBarSize-w),k=Math.round(C*(I[3]/I[2])),D=I[5]-I[7],k<1&&(k=1,C=Math.round(k*(I[2]/I[3]))),k>U+h.cellmainHeight-h.cellMainSrollBarSize-D&&(k=U+h.cellmainHeight-h.cellMainSrollBarSize-D,C=Math.round(k*(I[2]/I[3])))):T=="mt"?(w=I[4]-I[6],C=I[2],D=I[5]-I[7]+O,D<U&&(D=U),D>I[5]-I[7]+I[3]-1&&(D=I[5]-I[7]+I[3]-1),k=I[5]-I[7]+I[3]-D):T=="mb"&&(w=I[4]-I[6],C=I[2],D=I[5]-I[7],k=I[3]+O,k<1&&(k=1),k>U+h.cellmainHeight-h.cellMainSrollBarSize-D&&(k=U+h.cellmainHeight-h.cellMainSrollBarSize-D))}else T=="lt"?(w=_,C=I[2]-F,w>I[2]+I[4]-1?(w=I[2]+I[4]-1,C=I[2]+I[0]-(I[2]+I[4]-1)):w<=0&&(w=0,C=I[2]+I[0]),k=Math.round(C*(I[3]/I[2])),D=I[3]+I[1]-k,D>I[3]+I[5]-1?(D=I[3]+I[5]-1,k=I[3]+I[1]-(I[3]+I[5]-1),C=Math.round(k*(I[2]/I[3])),w=I[2]+I[0]-C):D<=0&&(D=0,k=I[3]+I[1],C=Math.round(k*(I[2]/I[3])),w=I[2]+I[0]-C)):T=="lm"?(w=_,C=I[2]-F,w>I[2]+I[4]-1?(w=I[2]+I[4]-1,C=I[2]+I[0]-(I[2]+I[4]-1)):w<=0&&(w=0,C=I[2]+I[0])):T=="lb"?(w=_,C=I[2]-F,w>I[2]+I[4]-1?(w=I[2]+I[4]-1,C=I[2]+I[0]-(I[2]+I[4]-1)):w<=0&&(w=0,C=I[2]+I[0]),k=Math.round(C*(I[3]/I[2])),k<1?(k=1,C=Math.round(k*(I[2]/I[3])),w=I[2]+I[0]-C):k>=$t.currentWinH-I[5]-42-6&&(k=$t.currentWinH-I[5]-42-6,C=Math.round(k*(I[2]/I[3])),w=I[2]+I[0]-C)):T=="rt"?(C=I[2]+F,C<1?C=1:C>=$t.currentWinW-I[4]-22-36&&(C=$t.currentWinW-I[4]-22-36),k=Math.round(C*(I[3]/I[2])),D=I[3]+I[1]-k,D>I[3]+I[5]-1?(D=I[3]+I[5]-1,k=I[3]+I[1]-(I[3]+I[5]-1),C=Math.round(k*(I[2]/I[3]))):D<=0&&(D=0,k=I[3]+I[1],C=Math.round(k*(I[2]/I[3])))):T=="rm"?(C=I[2]+F,C<1?C=1:C>=$t.currentWinW-I[4]-22-36&&(C=$t.currentWinW-I[4]-22-36)):T=="rb"?(C=I[2]+F,C<1?C=1:C>=$t.currentWinW-I[4]-22-36&&(C=$t.currentWinW-I[4]-22-36),k=Math.round(C*(I[3]/I[2])),k<1?(k=1,C=Math.round(k*(I[2]/I[3]))):k>=$t.currentWinH-I[5]-42-6&&(k=$t.currentWinH-I[5]-42-6,C=Math.round(k*(I[2]/I[3])))):T=="mt"?(D=S,k=I[3]-O,D>I[3]+I[5]-1?(D=I[3]+I[5]-1,k=I[3]+I[1]-(I[3]+I[5]-1)):D<=0&&(D=0,k=I[3]+I[1])):T=="mb"&&(k=I[3]+O,k<1?k=1:k>=$t.currentWinH-I[5]-42-6&&(k=$t.currentWinH-I[5]-42-6));$("#luckysheet-modal-dialog-activeImage").css({width:C,height:k,left:w,top:D});let A=C/z.crop.width,M=k/z.crop.height,P=Math.round(z.default.width*A),N=Math.round(z.default.height*M),E=Math.round(z.crop.offsetLeft*A),B=Math.round(z.crop.offsetTop*M);$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-size":P+"px "+N+"px","background-position":-E+"px "+-B+"px"})}else if($t.cropChange){let y=ll(g.pageX,g.pageY),p=y[0]+$("#luckysheet-cell-main").scrollLeft(),x=y[1]+$("#luckysheet-cell-main").scrollTop();if(p<0||x<0)return!1;let _=$t.cropChangeXY,S=x-_[1],I=p-_[0],O=$t.images[$t.currentImgId],F=$t.cropChange,D,k,w,C;F=="lt"?(w=O.crop.offsetLeft+I,w<0&&(w=0),w>O.crop.width+O.crop.offsetLeft-1&&(w=O.crop.width+O.crop.offsetLeft-1),D=O.crop.width+O.crop.offsetLeft-w,C=O.crop.offsetTop+S,C<0&&(C=0),C>O.crop.height+O.crop.offsetTop-1&&(C=O.crop.height+O.crop.offsetTop-1),k=O.crop.height+O.crop.offsetTop-C):F=="lm"?(w=O.crop.offsetLeft+I,w<0&&(w=0),w>O.crop.width+O.crop.offsetLeft-1&&(w=O.crop.width+O.crop.offsetLeft-1),D=O.crop.width+O.crop.offsetLeft-w,C=O.crop.offsetTop,k=O.crop.height):F=="lb"?(w=O.crop.offsetLeft+I,w<0&&(w=0),w>O.crop.width+O.crop.offsetLeft-1&&(w=O.crop.width+O.crop.offsetLeft-1),D=O.crop.width+O.crop.offsetLeft-w,C=O.crop.offsetTop,k=O.crop.height+S,k<1&&(k=1),k>O.default.height-C&&(k=O.default.height-C)):F=="rt"?(w=O.crop.offsetLeft,D=O.crop.width+I,D<1&&(D=1),D>O.default.width-w&&(D=O.default.width-w),C=O.crop.offsetTop+S,C<0&&(C=0),C>O.crop.height+O.crop.offsetTop-1&&(C=O.crop.height+O.crop.offsetTop-1),k=O.crop.height+O.crop.offsetTop-C):F=="rm"?(w=O.crop.offsetLeft,D=O.crop.width+I,D<1&&(D=1),D>O.default.width-w&&(D=O.default.width-w),C=O.crop.offsetTop,k=O.crop.height):F=="rb"?(w=O.crop.offsetLeft,D=O.crop.width+I,D<1&&(D=1),D>O.default.width-w&&(D=O.default.width-w),C=O.crop.offsetTop,k=O.crop.height+S,k<1&&(k=1),k>O.default.height-C&&(k=O.default.height-C)):F=="mt"?(w=O.crop.offsetLeft,D=O.crop.width,C=O.crop.offsetTop+S,C<0&&(C=0),C>O.crop.height+O.crop.offsetTop-1&&(C=O.crop.height+O.crop.offsetTop-1),k=O.crop.height+O.crop.offsetTop-C):F=="mb"&&(w=O.crop.offsetLeft,D=O.crop.width,C=O.crop.offsetTop,k=O.crop.height+S,k<1&&(k=1),k>O.default.height-C&&(k=O.default.height-C));let T=O.default.left+w,z=O.default.top+C;O.isFixedPos&&(T=O.fixedLeft+w,z=O.fixedTop+C),$("#luckysheet-modal-dialog-cropping").show().css({width:D,height:k,left:T,top:z});let A=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,M=typeof A=="function"?A(O.src):O.src;$("#luckysheet-modal-dialog-cropping .cropping-mask").css({width:O.default.width,height:O.default.height,"background-image":"url("+M+")",left:-w,top:-C}),$("#luckysheet-modal-dialog-cropping .cropping-content").css({"background-image":"url("+M+")","background-size":O.default.width+"px "+O.default.height+"px","background-position":-w+"px "+-C+"px"}),$t.cropChangeObj={width:D,height:k,offsetLeft:w,offsetTop:C}}else if(Nt.move){let y=ll(g.pageX,g.pageY),p=y[0]+$("#luckysheet-cell-main").scrollLeft(),x=y[1]+$("#luckysheet-cell-main").scrollTop(),_=Nt.currentObj.outerHeight(),S=Nt.currentObj.outerWidth(),I=x-Nt.moveXY[1],O=p-Nt.moveXY[0];I<0&&(I=0),I+_+42+6>Nt.currentWinH&&(I=Nt.currentWinH-_-42-6),O<0&&(O=0),O+S+22+36>Nt.currentWinW&&(O=Nt.currentWinW-S-22-36),Nt.currentObj.css({left:O,top:I})}else if(Nt.resize){let y=ll(g.pageX,g.pageY),p=y[0]+$("#luckysheet-cell-main").scrollLeft(),x=y[1]+$("#luckysheet-cell-main").scrollTop();if(p<0||x<0)return!1;let _=Nt.resizeXY,S=x-_[1],I=p-_[0],O=_[5],F=_[3],D=_[4],k=_[2],w=Nt.resize;(w=="lm"||w=="lt"||w=="lb")&&(D=p,k=_[2]-I,D>_[2]+_[4]-60?(D=_[2]+_[4]-60,k=_[2]-(_[2]+_[4]-60-_[0])):D<=0&&(D=0,k=_[2]+_[0])),(w=="rm"||w=="rt"||w=="rb")&&(k=_[2]+I,k<60?k=60:k>=Nt.currentWinW-_[4]-22-36&&(k=Nt.currentWinW-_[4]-22-36)),(w=="mt"||w=="lt"||w=="rt")&&(O=x,F=_[3]-S,O>_[3]+_[5]-60?(O=_[3]+_[5]-60,F=_[3]-(_[3]+_[5]-60-_[1])):O<=0&&(O=0,F=_[3]+_[1])),(w=="mb"||w=="lb"||w=="rb")&&(F=_[3]+S,F<60?F=60:F>=Nt.currentWinH-_[5]-42-6&&(F=Nt.currentWinH-_[5]-42-6)),Nt.currentObj.css({width:k,height:F,left:D,top:O})}else v.rangeResize?v.rangeResizeDraging(g,v.rangeResizeObj,v.rangeResizexy,v.rangeResize,v.rangeResizeWinW,v.rangeResizeWinH,h.ch_width,h.rh_height):v.rangeMove?v.rangeMoveDraging(g,v.rangeMovexy,v.rangeMoveObj.data("range"),v.rangeMoveObj,h.sheetBarHeight,h.statisticBarHeight):h.chart_selection.rangeResize?h.chart_selection.rangeResizeDraging(g,h.sheetBarHeight,h.statisticBarHeight):h.chart_selection.rangeMove&&h.chart_selection.rangeMoveDraging(g,h.sheetBarHeight,h.statisticBarHeight);h.jfautoscrollTimeout=window.requestAnimationFrame(b)};h.luckysheet_select_status&&(clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){mn()},500)),h.jfautoscrollTimeout=window.requestAnimationFrame(b)}}),$(document).on("mouseup.luckysheetEvent",function(g){if(lt&&lt.hook&&lt.hook.sheetMouseup){let T=ll(g.pageX,g.pageY),z=T[0]+$("#luckysheet-cell-main").scrollLeft(),A=T[1]+$("#luckysheet-cell-main").scrollTop(),M=zl(A),P=M[1],N=M[0],E=M[2],B=Ml(z),U=B[1],X=B[0],le=B[2],he=ht.mergeborer(h.flowdata,E,le);he&&(P=he.row[1],N=he.row[0],E=he.row[2],U=he.column[1],X=he.column[0],le=he.column[2]);let Z=ct.getSheetByIndex(),ae={functionResizeStatus:v.functionResizeStatus,horizontalmoveState:!!we.horizontalmovestate,verticalmoveState:!!we.verticalmovestate,pivotTableMoveState:!!Pt&&Pt.movestate,sheetMoveStatus:h.luckysheet_sheet_move_status,scrollStatus:!!h.luckysheet_scroll_status,selectStatus:!!h.luckysheet_select_status,rowsSelectedStatus:!!h.luckysheet_rows_selected_status,colsSelectedStatus:!!h.luckysheet_cols_selected_status,cellSelectedMove:!!h.luckysheet_cell_selected_move,cellSelectedExtend:!!h.luckysheet_cell_selected_extend,colsChangeSize:!!h.luckysheet_cols_change_size,rowsChangeSize:!!h.luckysheet_rows_change_size,chartMove:!!h.chartparam.luckysheetCurrentChartMove,chartResize:!!h.chartparam.luckysheetCurrentChartResize,rangeResize:!!v.rangeResize,rangeMove:!!v.rangeMove},J=$("#luckysheetTableContent").get(0).getContext("2d");Yt.createHookFunction("sheetMouseup",h.flowdata[E][le],{r:E,c:le,start_r:N,start_c:X,end_r:P,end_c:U},Z,ae,J)}if(h.luckysheet_select_status&&(clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){mn()},0),ht.luckysheetPaintModelOn&&(Ol.pasteHandlerOfPaintModel(h.luckysheet_copy_save),ht.luckysheetPaintSingle&&ht.cancelPaintModel())),h.luckysheet_select_status=!1,window.cancelAnimationFrame(h.jfautoscrollTimeout),h.luckysheet_scroll_status=!1,$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","crosshair").end().find(".luckysheet-cs-draghandle").css("cursor","move"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","default"),h.luckysheet_rows_selected_status=!1,h.luckysheet_cols_selected_status=!1,h.luckysheet_model_move_state=!1,v.functionResizeStatus&&(v.functionResizeStatus=!1,$("#luckysheet-wa-calculate-size").removeAttr("style")),we.horizontalmovestate&&(we.horizontalmovestate=!1,$("#luckysheet-freezebar-horizontal").removeClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grab"),we.freezenhorizontaldata[4]<=h.columnHeaderHeight&&we.cancelFreezenHorizontal(),we.createAssistCanvas(),Et()),we.verticalmovestate&&(we.verticalmovestate=!1,$("#luckysheet-freezebar-vertical").removeClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grab"),we.freezenverticaldata[4]<=h.rowHeaderWidth&&we.cancelFreezenVertical(),we.createAssistCanvas(),Et()),!!Pt&&Pt.movestate&&($("#luckysheet-modal-dialog-slider-pivot-move").remove(),Pt.movestate=!1,$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default"),Pt.movesave.containerid!="luckysheet-modal-dialog-pivotTable-list"&&$(g.target).closest(".luckysheet-modal-dialog-slider-config-list").length==0&&(Pt.movesave.containerid=="luckysheet-modal-dialog-config-value"&&Pt.resetOrderby(Pt.movesave.obj),Pt.movesave.obj.remove(),Pt.showvaluecolrow(),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){$(this).find(".luckysheet-slider-list-item-selected").find("i").remove()}),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){let z=$(this).data("index");$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){let A=$(this).find(".luckysheet-slider-list-item-selected");$(this).data("index")==z&&A.find("i").length==0&&A.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')})}),Pt.refreshPivotTable())),h.luckysheet_sheet_move_status&&(h.luckysheet_sheet_move_status=!1,h.luckysheet_sheet_move_data.activeobject.insertBefore($("#luckysheet-sheets-item-clone")),h.luckysheet_sheet_move_data.activeobject.removeAttr("style"),$("#luckysheet-sheets-item-clone").remove(),h.luckysheet_sheet_move_data.cursorobject.css({cursor:"pointer"}),h.luckysheet_sheet_move_data={},ct.reOrderAllSheet()),clearTimeout(h.chartparam.luckysheetCurrentChartMoveTimeout),h.chartparam.luckysheetCurrentChartMove&&(h.chartparam.luckysheetCurrentChartMove=!1,h.chartparam.luckysheetInsertChartTosheetChange)){var b=h.chartparam.luckysheetCurrentChartMoveObj.css("top"),y=h.chartparam.luckysheetCurrentChartMoveObj.css("left"),p=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),_=h.chartparam.luckysheetCurrentChartMoveXy[2],S=h.chartparam.luckysheetCurrentChartMoveXy[3],I=h.chartparam.luckysheetCurrentChartMoveXy[4],O=h.chartparam.luckysheetCurrentChartMoveXy[5],F=h.chartparam.luckysheetCurrentChartMoveObj.find(".luckysheet-modal-dialog-content").attr("id");h.jfredo.push({type:"moveChart",chart_id:F,sheetIndex:h.currentSheetIndex,myTop:b,myLeft:y,scrollTop:x,scrollLeft:p,x:_,y:S,scrollTop1:O,scrollLeft1:I})}if(h.chartparam.luckysheetCurrentChartResize&&(h.chartparam.luckysheetCurrentChartResize=null,h.chartparam.luckysheetInsertChartTosheetChange)){var D=h.chartparam.luckysheetCurrentChartResizeObj.height(),k=h.chartparam.luckysheetCurrentChartResizeObj.width(),p=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),b=h.chartparam.luckysheetCurrentChartMoveObj.css("top"),y=h.chartparam.luckysheetCurrentChartMoveObj.css("left"),F=h.chartparam.luckysheetCurrentChartResizeObj.find(".luckysheet-modal-dialog-content").attr("id"),w=h.chartparam.luckysheetCurrentChartResizeXy[2],C=h.chartparam.luckysheetCurrentChartResizeXy[3],_=h.chartparam.luckysheetCurrentChartResizeXy[4],S=h.chartparam.luckysheetCurrentChartResizeXy[5],I=h.chartparam.luckysheetCurrentChartResizeXy[6],O=h.chartparam.luckysheetCurrentChartResizeXy[7];h.jfredo.push({type:"resizeChart",chart_id:F,sheetIndex:h.currentSheetIndex,myTop:b,myLeft:y,myHeight:D,myWidth:k,scrollTop:x,scrollLeft:p,x:_,y:S,myWidth1:w,myHeight1:C,scrollTop1:O,scrollLeft1:I})}if(v.rangeResize&&v.rangeResizeDragged(g,v.rangeResizeObj,v.rangeResize,v.rangeResizexy,v.rangeResizeWinW,v.rangeResizeWinH),$t.move&&$t.moveImgItem(),$t.resize&&$t.resizeImgItem(),$t.cropChange&&$t.cropChangeImgItem(),Nt.move){Nt.move=!1;let T=Nt.currentObj.closest(".luckysheet-postil-show").attr("id"),z=T.split("luckysheet-postil-show_")[1].split("_")[0],A=T.split("luckysheet-postil-show_")[1].split("_")[1],M=pt.deepCopyFlowData(h.flowdata),P=[];M[z][A].ps.left=Nt.currentObj.position().left,M[z][A].ps.top=Nt.currentObj.position().top,M[z][A].ps.value=Nt.currentObj.find(".formulaInputFocus").html().replaceAll("<div>",`
`).replaceAll(/<(.*)>.*?|<(.*) \/>/g,"").trim(),P.push(z+"_"+A),Nt.ref(M,P),$("#"+T).remove(),M[z][A].ps.isshow?(Nt.buildPs(z,A,M[z][A].ps),$("#"+T).addClass("luckysheet-postil-show-active"),$("#"+T).find(".luckysheet-postil-dialog-resize").show()):Nt.editPs(z,A)}if(Nt.resize){Nt.resize=null;let T=Nt.currentObj.closest(".luckysheet-postil-show").attr("id"),z=T.split("luckysheet-postil-show_")[1].split("_")[0],A=T.split("luckysheet-postil-show_")[1].split("_")[1],M=pt.deepCopyFlowData(h.flowdata),P=[];M[z][A].ps.left=Nt.currentObj.position().left,M[z][A].ps.top=Nt.currentObj.position().top,M[z][A].ps.width=Nt.currentObj.outerWidth(),M[z][A].ps.height=Nt.currentObj.outerHeight(),M[z][A].ps.value=Nt.currentObj.find(".formulaInputFocus").html().replaceAll("<div>",`
`).replaceAll(/<(.*)>.*?|<(.*) \/>/g,"").trim(),P.push(z+"_"+A),Nt.ref(M,P),$("#"+T).remove(),M[z][A].ps.isshow?(Nt.buildPs(z,A,M[z][A].ps),$("#"+T).addClass("luckysheet-postil-show-active"),$("#"+T).find(".luckysheet-postil-dialog-resize").show()):Nt.editPs(z,A)}if(h.luckysheet_rows_change_size){h.luckysheet_rows_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-rows-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas").css("cursor","default");let T=ll(g.pageX,g.pageY),z=$("#luckysheet-rows-h").scrollTop(),A=T[1]+z,M=$(window).height(),P=zl(A),N=P[1],E=P[0],B=P[2],U=A+3-h.luckysheet_rows_change_size_start[0];A+3-h.luckysheet_rows_change_size_start[0]<19&&(U=19),A>=M-200+z&&(U=M-200-h.luckysheet_rows_change_size_start[0]+z);let X=$.extend(!0,{},h.config);X.rowlen==null&&(X.rowlen={}),X.customHeight==null&&(X.customHeight={}),X.customHeight[h.luckysheet_rows_change_size_start[1]]=1;let le=h.luckysheet_rows_change_size_start[1],he=!1;h.luckysheet_select_save.length>0&&h.luckysheet_select_save.filter(ae=>ae.row_select).some(ae=>(le>=ae.row[0]&&le<=ae.row[1]&&(he=!0),he)),he?h.luckysheet_select_save.filter(ae=>ae.row_select).forEach(ae=>{for(let J=ae.row[0];J<=ae.row[1];J++)X.rowlen[J]=Math.ceil(U/h.zoomRatio)}):X.rowlen[h.luckysheet_rows_change_size_start[1]]=Math.ceil(U/h.zoomRatio);let Z=$t.moveChangeSize("row",h.luckysheet_rows_change_size_start[1],U);h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"resize",ctrlType:"resizeR",sheetIndex:h.currentSheetIndex,config:$.extend(!0,{},h.config),curconfig:$.extend(!0,{},X),images:$.extend(!0,{},$t.images),curImages:$.extend(!0,{},Z)})),h.config=X,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,X.rowlen,{k:"rowlen"}),h.luckysheetfile[$e(h.currentSheetIndex)].images=Z,He.saveParam("all",h.currentSheetIndex,Z,{k:"images"}),$t.images=Z,$t.allImagesShow(),Nl(h.flowdata.length,null)}if(h.luckysheet_cols_change_size){h.luckysheet_cols_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","default");let T=ll(g.pageX,g.pageY),z=$("#luckysheet-cols-h-c").scrollLeft(),A=T[0]+z,M=$(window).width(),P=h.visibledatarow.length-1,N=h.visibledatarow[P],E=0,B=Ml(A),U=B[1],X=B[0],le=B[2],he=A+3-h.luckysheet_cols_change_size_start[0],Z=h.defaultcollen;if(h.config.columnlen!=null&&h.config.columnlen[h.luckysheet_cols_change_size_start[1]]!=null&&(Z=h.config.columnlen[h.luckysheet_cols_change_size_start[1]]),Math.abs(he-Z)<3)return;A+3-h.luckysheet_cols_change_size_start[0]<30&&(he=30),A>=M-100+z&&(he=M-100-h.luckysheet_cols_change_size_start[0]+z);let ae=$.extend(!0,{},h.config);ae.columnlen==null&&(ae.columnlen={}),ae.customWidth==null&&(ae.customWidth={}),ae.customWidth[h.luckysheet_cols_change_size_start[1]]=1;let J=h.luckysheet_cols_change_size_start[1],pe=!1;h.luckysheet_select_save.length>0&&h.luckysheet_select_save.filter(se=>se.column_select).some(se=>(J>=se.column[0]&&J<=se.column[1]&&(pe=!0),pe)),pe?h.luckysheet_select_save.filter(se=>se.column_select).forEach(se=>{for(let te=se.column[0];te<=se.column[1];te++)ae.columnlen[te]=Math.ceil(he/h.zoomRatio)}):ae.columnlen[h.luckysheet_cols_change_size_start[1]]=Math.ceil(he/h.zoomRatio);let K=$t.moveChangeSize("column",h.luckysheet_cols_change_size_start[1],he);h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"resize",ctrlType:"resizeC",sheetIndex:h.currentSheetIndex,config:$.extend(!0,{},h.config),curconfig:$.extend(!0,{},ae),images:$.extend(!0,{},$t.images),curImages:$.extend(!0,{},K)})),h.config=ae,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,ae.columnlen,{k:"columnlen"}),h.luckysheetfile[$e(h.currentSheetIndex)].images=K,He.saveParam("all",h.currentSheetIndex,K,{k:"images"}),$t.images=K,$t.allImagesShow(),Nl(null,h.flowdata[0].length),setTimeout(function(){Et()},1)}if(v.rangeMove&&v.rangeMoveDragged(v.rangeMoveObj),h.luckysheet_cell_selected_move){$("#luckysheet-cell-selected-move").hide(),h.luckysheet_cell_selected_move=!1;let T=ll(g.pageX,g.pageY);if(!Wi(h.luckysheet_select_save,h.currentSheetIndex))return;let z=$("#luckysheet-cell-main").scrollLeft(),A=$("#luckysheet-cell-main").scrollTop(),M=T[0]+z,P=T[1]+A,N=$(window).height()+A-h.sheetBarHeight-h.statisticBarHeight,E=$(window).width()+z,B=zl(P)[2],U=Ml(M)[2],X=h.luckysheet_cell_selected_move_index[0],le=h.luckysheet_cell_selected_move_index[1];if(B==X&&U==le)return;let he=pt.deepCopyFlowData(h.flowdata),Z=h.luckysheet_select_save[h.luckysheet_select_save.length-1],ae=Xl(Z),J=$.extend(!0,{},h.config);if(J.merge==null&&(J.merge={}),J.rowlen==null&&(J.rowlen={}),Ul(J,Z.row[0],Z.row[1],Z.column[0],Z.column[1])){Qe()?alert(l.noMerge):de.info('<i class="fa fa-exclamation-triangle"></i>',l.noMerge);return}let pe=Z.row[0]-X+B,K=Z.row[1]-X+B,se=Z.column[0]-le+U,te=Z.column[1]-le+U;if(!Wi([{row:[pe,K],column:[se,te]}],h.currentSheetIndex))return;if((pe<0||P<0)&&(pe=0,K=Z.row[1]-Z.row[0]),(se<0||M<0)&&(se=0,te=Z.column[1]-Z.column[0]),(K>=h.visibledatarow[h.visibledatarow.length-1]||P>N)&&(pe=h.visibledatarow.length-1-Z.row[1]+Z.row[0],K=h.visibledatarow.length-1),(te>=h.visibledatacolumn[h.visibledatacolumn.length-1]||M>E)&&(se=h.visibledatacolumn.length-1-Z.column[1]+Z.column[0],te=h.visibledatacolumn.length-1),Ul(J,pe,K,se,te)){Qe()?alert(l.noMerge):de.info('<i class="fa fa-exclamation-triangle"></i>',l.noMerge);return}let re=Mo(h.currentSheetIndex),fe=null;for(let et=Z.row[0];et<=Z.row[1];et++){et in J.rowlen&&(fe=!0);for(let vt=Z.column[0];vt<=Z.column[1];vt++){let wt=he[et][vt];V(wt)=="object"&&"mc"in wt&&wt.mc.r+"_"+wt.mc.c in J.merge&&delete J.merge[wt.mc.r+"_"+wt.mc.c],he[et][vt]=null}}if(J.borderInfo&&J.borderInfo.length>0){let et=[];for(let vt=0;vt<J.borderInfo.length;vt++){let wt=J.borderInfo[vt].rangeType;if(wt=="range"){let be=J.borderInfo[vt].range,Q=[];for(let me=0;me<be.length;me++)Q=Q.concat(xt.CFSplitRange(be[me],{row:Z.row,column:Z.column},{row:[pe,K],column:[se,te]},"restPart"));J.borderInfo[vt].range=Q,et.push(J.borderInfo[vt])}else if(wt=="cell"){let be=J.borderInfo[vt].value.row_index,Q=J.borderInfo[vt].value.col_index;be>=Z.row[0]&&be<=Z.row[1]&&Q>=Z.column[0]&&Q<=Z.column[1]||et.push(J.borderInfo[vt])}}J.borderInfo=et}let Me={};for(let et=0;et<ae.length;et++)for(let vt=0;vt<ae[0].length;vt++){if(re[et+Z.row[0]+"_"+(vt+Z.column[0])]){let be={rangeType:"cell",value:{row_index:et+pe,col_index:vt+se,l:re[et+Z.row[0]+"_"+(vt+Z.column[0])].l,r:re[et+Z.row[0]+"_"+(vt+Z.column[0])].r,t:re[et+Z.row[0]+"_"+(vt+Z.column[0])].t,b:re[et+Z.row[0]+"_"+(vt+Z.column[0])].b}};J.borderInfo==null&&(J.borderInfo=[]),J.borderInfo.push(be)}let wt="";if(ae[et]!=null&&ae[et][vt]!=null&&(wt=ae[et][vt]),V(wt)=="object"&&"mc"in wt){let be=$.extend(!0,{},wt.mc);"rs"in wt.mc?(Me[be.r+"_"+be.c]=[et+pe,vt+se],wt.mc.r=et+pe,wt.mc.c=vt+se,J.merge[et+pe+"_"+(vt+se)]=wt.mc):(wt.mc.r=Me[be.r+"_"+be.c][0],wt.mc.c=Me[be.r+"_"+be.c][1])}he[et+pe][vt+se]=wt}fe&&(J=tn(he,Z.row[0],Z.row[1],J),J=tn(he,pe,K,J));let ye=$.extend(!0,[],h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save);if(ye!=null&&ye.length>0)for(let et=0;et<ye.length;et++){let vt=ye[et].cellrange,wt=[];for(let be=0;be<vt.length;be++){let Q=xt.CFSplitRange(vt[be],{row:Z.row,column:Z.column},{row:[pe,K],column:[se,te]},"allPart");wt=wt.concat(Q)}ye[et].cellrange=wt}let Ye;h.luckysheet_select_save[0].row_focus==h.luckysheet_select_save[0].row[0]?Ye=pe:Ye=K;let Ce;h.luckysheet_select_save[0].column_focus==h.luckysheet_select_save[0].column[0]?Ce=se:Ce=te;let Ke=[];Ke.push({row:Z.row,column:Z.column}),Ke.push({row:[pe,K],column:[se,te]}),Z.row=[pe,K],Z.column=[se,te],Z.row_focus=Ye,Z.column_focus=Ce,Gt(he,Ke,{cfg:J,RowlChange:fe,cdformat:ye}),Zt(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){mn()},500)}if(h.chart_selection.rangeMove&&h.chart_selection.rangeMoveDragged(),h.chart_selection.rangeResize&&h.chart_selection.rangeResizeDragged(),h.luckysheet_cell_selected_extend){if(h.luckysheet_cell_selected_extend=!1,$("#luckysheet-cell-selected-extend").hide(),!Wi(h.luckysheet_select_save,h.currentSheetIndex))return;let T=ll(g.pageX,g.pageY),z=$("#luckysheet-cell-main").scrollLeft(),A=$("#luckysheet-cell-main").scrollTop(),M=T[0]+z-5,P=T[1]+A-5,N=$(window).height()+A-h.sheetBarHeight-h.statisticBarHeight,E=$(window).width()+z,B=zl(P),U=B[1],X=B[0],le=B[2],he=Ml(M),Z=he[1],ae=he[0],J=he[2],pe=h.luckysheet_cell_selected_extend_index[0],K=h.luckysheet_cell_selected_extend_index[1],se=h.luckysheet_select_save[h.luckysheet_select_save.length-1],te=se.row[0],re=se.row[1],fe=se.column[0],Me=se.column[1];(te<0||P<0)&&(te=0,re=se.row[1]-se.row[0]),(fe<0||M<0)&&(fe=0,Me=se.column[1]-se.column[0]),(re>=h.visibledatarow[h.visibledatarow.length-1]||P>N)&&(te=h.visibledatarow.length-1-se.row[1]+se.row[0],re=h.visibledatarow.length-1),(Me>=h.visibledatacolumn[h.visibledatacolumn.length-1]||M>E)&&(fe=h.visibledatacolumn.length-1-se.column[1]+se.column[0],Me=h.visibledatacolumn.length-1),Tr.copyRange={row:$.extend(!0,[],se.row),column:$.extend(!0,[],se.column)};let ye=Tr.typeItemHide();if(!ye[0]&&!ye[1]&&!ye[2]&&!ye[3]&&!ye[4]&&!ye[5]&&!ye[6]?Tr.applyType="0":Tr.applyType="1",Math.abs(pe-le)>Math.abs(K-J)){if(le>=te&&le<=re)return;if(h.luckysheet_select_save[0].top_move>=X){if(Tr.applyRange={row:[le,se.row[0]-1],column:se.column},Tr.direction="up",te-=se.row[0]-le,Pt.isPivotRange(te,Me)){de.info(l.affectPivot,"");return}}else if(Tr.applyRange={row:[se.row[1]+1,le],column:se.column},Tr.direction="down",re+=le-se.row[1],Pt.isPivotRange(re,Me)){de.info(l.affectPivot,"");return}}else{if(J>=fe&&J<=Me)return;if(h.luckysheet_select_save[0].left_move>=ae){if(Tr.applyRange={row:se.row,column:[J,se.column[0]-1]},Tr.direction="left",fe-=se.column[0]-J,Pt.isPivotRange(re,fe)){de.info(l.affectPivot,"");return}}else if(Tr.applyRange={row:se.row,column:[se.column[1]+1,J]},Tr.direction="right",Me+=J-se.column[1],Pt.isPivotRange(re,Me)){de.info(l.affectPivot,"");return}}if(h.config.merge!=null){let Ye=!1;for(let Ce=se.row[0];Ce<=se.row[1];Ce++)for(let Ke=se.column[0];Ke<=se.column[1];Ke++){let ft=h.flowdata[Ce][Ke];if(ft!=null&&ft.mc!=null){Ye=!0;break}}if(Ye){Qe()?alert(l.noMerge):de.info(l.noMerge,"");return}for(let Ce=te;Ce<=re;Ce++)for(let Ke=fe;Ke<=Me;Ke++){let ft=h.flowdata[Ce][Ke];if(ft!=null&&ft.mc!=null){Ye=!0;break}}if(Ye){Qe()?alert(l.noMerge):de.info(l.noMerge,"");return}}se.row=[te,re],se.column=[fe,Me],Tr.update(),Tr.createIcon(),$("#luckysheet-cell-selected-move").hide(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){mn()},500)}}),$(".luckysheet-grid-container, #luckysheet-rightclick-menu").on("contextmenu",function(g){g.preventDefault()}),$("#luckysheet-cell-main div.luckysheet-cs-draghandle").mousedown(function(g){if(Qe()||h.allowEdit===!1)return;$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","move").end().find(".luckysheet-cs-draghandle").css("cursor","move"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","move"),h.luckysheet_cell_selected_move=!0,h.luckysheet_scroll_status=!0;let b=ll(g.pageX,g.pageY),y=b[0]+$("#luckysheet-cell-main").scrollLeft(),p=b[1]+$("#luckysheet-cell-main").scrollTop(),x=zl(p),_=x[0],S=x[1],I=x[2],O=Ml(y),F=O[0],D=O[1],k=O[2];h.luckysheet_cell_selected_move_index=[I,k],$("#luckysheet-cell-selected-move").css({left:F,width:D-F-1,top:_,height:S-_-1,display:"block"}),g.stopPropagation()}),$("#luckysheet-cell-main div.luckysheet-cs-fillhandle").mousedown(function(g){Qe()||h.allowEdit===!1||($("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","crosshair").end().find(".luckysheet-cs-draghandle").css("cursor","crosshair"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","crosshair"),h.luckysheet_cell_selected_extend_time=setTimeout(function(){h.luckysheet_cell_selected_extend=!0,h.luckysheet_scroll_status=!0;let b=ll(g.pageX,g.pageY),y=b[0]+$("#luckysheet-cell-main").scrollLeft()-5,p=b[1]+$("#luckysheet-cell-main").scrollTop()-5,x=zl(p),_=x[0],S=x[1],I=x[2],O=Ml(y),F=O[0],D=O[1],k=O[2];h.luckysheet_cell_selected_extend_index=[I,k],$("#luckysheet-cell-selected-extend").css({left:F,width:D-F-1,top:_,height:S-_-1,display:"block"})},100),g.stopPropagation())}).click(function(){clearTimeout(h.luckysheet_cell_selected_extend_time),event.stopPropagation()}).dblclick(function(){let g=h.luckysheet_select_save[0],b=g.row[0],y=g.row[1],p=g.column[0],x=g.column[1];if(Pt.isPivotRange(b,p))return;let _=!1,S=0;for(let O=y+1;O<h.flowdata.length;O++)if(p-1>=0&&x+1<h.flowdata[0].length){let F=h.flowdata[O][p-1],D=h.flowdata[O][x+1];if(O==y+1)if((F==null||rt(F.v))&&(D==null||rt(D.v))){_=!1;break}else _=!0,S++;else{if((F==null||rt(F.v))&&(D==null||rt(D.v)))break;S++}}else if(p-1>=0){let F=h.flowdata[O][p-1];if(O==y+1)if(F==null||rt(F.v)){_=!1;break}else _=!0,S++;else{if(F==null||rt(F.v))break;S++}}else if(x+1<h.flowdata[0].length){let F=h.flowdata[O][x+1];if(O==y+1)if(F==null||rt(F.v)){_=!1;break}else _=!0,S++;else{if(F==null||rt(F.v))break;S++}}if(!_||S==0){event.stopPropagation();return}Tr.copyRange={row:[b,y],column:[p,x]};let I=Tr.typeItemHide();!I[0]&&!I[1]&&!I[2]&&!I[3]&&!I[4]&&!I[5]&&!I[6]?Tr.applyType="0":Tr.applyType="1",Tr.applyRange={row:[y+1,y+S],column:[p,x]},Tr.direction="down",h.luckysheet_select_save=[{row:[b,y+S],column:[p,x]}],Tr.update(),Tr.createIcon(),$("#luckysheet-cell-selected-move").hide(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){mn()},500),event.stopPropagation()}),$("#luckysheet-bottom-add-row, #luckysheet-bottom-add-row-input, #luckysheet-bottom-return-top").on("mousedown dblclick mouseup",function(g){g.stopPropagation()}),$("#luckysheet-bottom-add-row").on("click",function(g){$("#luckysheet-rightclick-menu").hide(),el();let b=$(this),y=$("#luckysheet-bottom-add-row-input").val();if(y==""&&(y=lt.addRowCount||100),isNaN(parseInt(y))){Qe()?alert(o.tipInputNumber):de.info("error",o.tipInputNumber);return}if(y=parseInt(y),y<1||y>100){Qe()?alert(o.tipInputNumberLimit):de.info("error",o.tipInputNumberLimit);return}oo("row",h.flowdata.length-1,y)}),$("#luckysheet-bottom-return-top").on("click",function(g){$("#luckysheet-scrollbar-y").scrollTop(0)}),$("#luckysheet-copy-btn, #luckysheet-cols-copy-btn, #luckysheet-paste-btn-title").click(function(g){if($(this).parent().hide(),h.config.merge!=null){let y=!1;for(let p=0;p<h.luckysheet_select_save.length;p++){let x=h.luckysheet_select_save[p].row[0],_=h.luckysheet_select_save[p].row[1],S=h.luckysheet_select_save[p].column[0],I=h.luckysheet_select_save[p].column[1];if(y=Ul(h.config,x,_,S,I),y)break}if(y){Qe()?alert(l.noPartMerge):de.info(l.noPartMerge,"");return}}let b=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save;if(h.luckysheet_select_save.length>1&&b!=null&&b.length>0){let y=!1,p=xt.getComputeMap();e:for(let x=0;x<h.luckysheet_select_save.length&&!y;x++){let _=h.luckysheet_select_save[x].row[0],S=h.luckysheet_select_save[x].row[1],I=h.luckysheet_select_save[x].column[0],O=h.luckysheet_select_save[x].column[1];for(let F=_;F<=S;F++)for(let D=I;D<=O;D++)if(xt.checksCF(F,D,p)!=null){y=!0;continue e}}if(y){Qe()?alert(l.noMulti):de.info(l.noMulti,"");return}}if(h.luckysheet_select_save.length>1){let y=!0,p=h.luckysheet_select_save[0].row[0],x=h.luckysheet_select_save[0].row[1],_=!0,S=h.luckysheet_select_save[0].column[0],I=h.luckysheet_select_save[0].column[1];for(let O=1;O<h.luckysheet_select_save.length;O++)(h.luckysheet_select_save[O].row[0]!=p||h.luckysheet_select_save[O].row[1]!=x)&&(y=!1),(h.luckysheet_select_save[O].column[0]!=S||h.luckysheet_select_save[O].column[1]!=I)&&(_=!1);if(!y&&!_||Ao()){Qe()?alert(l.noMulti):de.info(l.noMulti,"");return}}Ol.copy(g)}),$("#luckysheet-copy-paste, #luckysheet-cols-paste-btn, #luckysheet-paste-btn-title").click(function(g){Ol.paste(g,"btn"),$(this).parent().hide()}),$("#luckysheet-chart-btn-title").click(function(){sg()}),$("#luckysheetdatavisual").click(function(){sg(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheet-pivot-btn-title").click(function(g){!Hl(h.currentSheetIndex,"usePivotTablereports")||Pt.createPivotTable(g)}),$("#luckysheet-chart-btn-screenshot").click(function(){let g=t.screenshot;if(h.luckysheet_select_save.length==0){Qe()?alert(g.screenshotTipNoSelection):de.info(g.screenshotTipTitle,g.screenshotTipNoSelection);return}if(h.luckysheet_select_save.length>1){Qe()?alert(g.screenshotTipHasMulti):de.info(g.screenshotTipTitle,g.screenshotTipHasMulti);return}if(h.config.merge!=null){let T=!1;for(let z=0;z<h.luckysheet_select_save.length;z++){let A=h.luckysheet_select_save[z].row[0],M=h.luckysheet_select_save[z].row[1],P=h.luckysheet_select_save[z].column[0],N=h.luckysheet_select_save[z].column[1];if(T=Ul(h.config,A,M,P,N),T)break}if(T){Qe()?alert(g.screenshotTipHasMerge):de.info(g.screenshotTipTitle,g.screenshotTipHasMerge);return}}let b=h.luckysheet_select_save[0].row[0],y=h.luckysheet_select_save[0].row[1],p=h.luckysheet_select_save[0].column[0],x=h.luckysheet_select_save[0].column[1],_,S;b-1<0?(_=0,S=h.visibledatarow[y]):(_=h.visibledatarow[b-1],S=h.visibledatarow[y]-h.visibledatarow[b-1]);let I,O;p-1<0?(I=0,O=h.visibledatacolumn[x]):(I=h.visibledatacolumn[p-1],O=h.visibledatacolumn[x]-h.visibledatacolumn[p-1]);let F=$("<canvas>").attr({width:Math.ceil(O*devicePixelRatio),height:Math.ceil(S*devicePixelRatio)}).css({width:O,height:S});$i(I,_,O,S,1,1,null,null,F);let D=F.get(0).getContext("2d");D.beginPath(),D.moveTo(0,0),D.lineTo(0,h.devicePixelRatio*S),D.lineWidth=h.devicePixelRatio*2,D.strokeStyle=Tn.strokeStyle,D.stroke(),D.closePath(),D.beginPath(),D.moveTo(0,0),D.lineTo(h.devicePixelRatio*O,0),D.lineWidth=h.devicePixelRatio*2,D.strokeStyle=Tn.strokeStyle,D.stroke(),D.closePath();let k=new Image,w=F.get(0).toDataURL("image/png");k.src=w,O>S?k.style.width="100%":k.style.height="100%";let C=$(window).height()-200;de.screenshot(g.screenshotTipSuccess,'<div id="luckysheet-confirm-screenshot-save" style="height:'+C+'px;overflow:auto;"></div>',w),$("#luckysheet-confirm-screenshot-save").append(k),F.remove()}),$(document).on("click.luckysheetEvent","a.download",function(){let g=$("#luckysheet-confirm-screenshot-save img").attr("src"),b=t.screenshot,y=atob(g.split(",")[1]),p=y.length,x=new Uint8Array(p);for(let O=0;O<p;O++)x[O]=y.charCodeAt(O);let _=new Blob([x]),S=document.createElement("a");S.setAttribute("href",URL.createObjectURL(_)),S.setAttribute("download",b.screenshotImageName+".png"),S.style.display="none",document.body.appendChild(S),S.click();let I;S.addEventListener("click",I=function(){requestAnimationFrame(function(){URL.revokeObjectURL(S.href)}),S.removeAttribute("href"),S.removeEventListener("click",I)}),document.body.removeChild(S)}),$("#luckysheet-splitColumn-btn-title").click(function(){if(!Ro(h.currentSheetIndex)||h.luckysheet_select_save==null||h.luckysheet_select_save.length==0)return;let g=t.splitText;if(h.luckysheet_select_save.length>1){de.info(g.tipNoMulti,"");return}if(h.luckysheet_select_save[0].column[0]!=h.luckysheet_select_save[0].column[1]){de.info(g.tipNoMultiColumn,"");return}Eg.createDialog(),Eg.init()}),$("#luckysheet-insertImg-btn-title").click(function(){if(!Un()){de.info("",Oe().pivotTable.errorNotAllowEdit);return}!Hl(h.currentSheetIndex,"editObjects")||$("#luckysheet-imgUpload").click()}),$("#luckysheetInsertImage").click(function(){!Hl(h.currentSheetIndex,"editObjects")||($("#luckysheet-imgUpload").click(),$("#luckysheet-rightclick-menu").hide())}),$("#luckysheet-imgUpload").click(function(g){g.stopPropagation()}),$("#luckysheet-imgUpload").on("change",function(g){if(!Hl(h.currentSheetIndex,"editObjects",!1))return;let b=g.currentTarget.files[0];$t.insertImg(b)}),$("#luckysheet-insertLink-btn-title").click(function(){if(!Un()){de.info("",Oe().pivotTable.errorNotAllowEdit);return}!Ro(h.currentSheetIndex)||h.luckysheet_select_save==null||h.luckysheet_select_save.length==0||(Mn.createDialog(),Mn.init())}),$("#luckysheetInsertLink").click(function(){$("#luckysheet-insertLink-btn-title").click(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheet-dataVerification-btn-title").click(function(){!Ro(h.currentSheetIndex)||h.luckysheet_select_save==null||h.luckysheet_select_save.length==0||(Vt.createDialog(),Vt.init())}),$("#luckysheetDataVerification").click(function(){$("#luckysheet-dataVerification-btn-title").click(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheetCellFormatRightClickMenu").click(function(){X1()}),$("#luckysheet-freezen-btn-horizontal").click(function(){$.trim($(this).text())==Oe().freezen.freezenCancel?(we.saveFrozen("freezenCancel"),we.freezenverticaldata!=null&&(we.cancelFreezenVertical(),we.createAssistCanvas(),Et()),we.freezenhorizontaldata!=null&&(we.cancelFreezenHorizontal(),we.createAssistCanvas(),Et()),we.scrollAdapt(),$("#luckysheet-icon-freezen-menu-menuButton").find(".fa.fa-check").remove()):(we.saveFrozen("freezenRow"),we.freezenverticaldata!=null&&(we.cancelFreezenVertical(),we.createAssistCanvas(),Et()),we.freezenhorizontaldata==null&&(we.createFreezenHorizontal(),we.createAssistCanvas()))}),$("#luckysheet-freezen-btn-vertical").click(function(){we.freezenverticaldata!=null?(we.saveFrozen("freezenCancel"),we.cancelFreezenVertical(),Et()):(we.saveFrozen("freezenColumn"),we.createFreezenVertical()),we.createAssistCanvas()}),$("#luckysheet-rightclick-menu input").on("keydown",function(g){g.stopPropagation()}),$("#luckysheet-modal-dialog-mask").on("click dbclick mousedown mousemove mouseup",function(g){g.stopPropagation(),g.preventDefault()});let f=function(){(document.hidden||document.webkitHidden||document.msHidden)&&(h.iscopyself=!1)};$(document).on("visibilitychange.luckysheetEvent webkitvisibilitychange.luckysheetEvent msvisibilitychange.luckysheetEvent",f).on("mouseleave.luckysheetEvent",function(){h.iscopyself=!1}).on("mousedown.luckysheetEvent",function(g){Nt.removeActivePs(),lo(g),$(g.target).closest("#luckysheet-wa-editor").length>0&&parseInt($("#luckysheet-input-box").css("top"))>0&&(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("down",0,"rangeOfSelect"))}),$("#luckysheet-left-top").click(function(g){!Eu(h.currentSheetIndex)||($("#luckysheet-wa-functionbox-confirm").click(),h.luckysheet_select_status=!1,h.luckysheet_select_save=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1],row_focus:0,column_focus:0,row_select:!0,column_select:!0}],Zt(),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){mn()},500),He.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save),g.stopPropagation())}),$("#luckysheet-icon-undo").click(function(g){$(this).hasClass("disabled")||Ia.redo(g)}),$("#luckysheet-icon-redo").click(function(g){$(this).hasClass("disabled")||Ia.undo(g)}),$(document).on("mousedown.luckysheetEvent","div.luckysheet-modal-dialog",function(g){if(!$(g.target).is(".luckysheet-modal-dialog"))return;h.luckysheet_model_move_state=!0,h.luckysheet_model_move_obj=$(g.currentTarget);let b=h.luckysheet_model_move_obj.offset();h.luckysheet_model_xy=[g.pageX-b.left,g.pageY-b.top]}),$(document).on("click.luckysheetEvent",".luckysheet-modal-dialog-title-close, .luckysheet-model-close-btn",function(g){($("#textcolorselect").is(":visible")||$("#cellcolorselect").is(":visible"))&&$("#luckysheet-conditionformat-dialog").show(),$(g.currentTarget).parents(".luckysheet-modal-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide(),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula")&&(v.dontupdate(),lr("down",0,"rangeOfSelect")),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula-parm")&&(v.dontupdate(),lr("down",0,"rangeOfSelect")),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula-parm-select")&&(v.dontupdate(),lr("down",0,"rangeOfSelect")),el()}),$("#luckysheet_info_detail_title").click(function(){window.open(lt.myFolderUrl,"_self")}),$("#luckysheet-chart-rangeShow").on("mousedown.chartRangeShowMove",".luckysheet-chart-rangeShow-move",function(g){h.chart_selection.rangeMove=!0,h.luckysheet_scroll_status=!0,h.chart_selection.rangeMoveObj=$(this).parent();let b=h.currentChart,y=$(this).parent().attr("id");if(y=="luckysheet-chart-rangeShow-content"){let F=b.rangeArray[0].row[0]+b.rangeSplitArray.content.row[0],D=b.rangeArray[0].column[0]+b.rangeSplitArray.content.column[0];h.chart_selection.rangeMoveIndex=[F,D]}else if(y=="luckysheet-chart-rangeShow-rowtitle"){let F=b.rangeArray[0].row[0]+b.rangeSplitArray.rowtitle.row[0],D=b.rangeArray[0].column[0]+b.rangeSplitArray.rowtitle.column[0];h.chart_selection.rangeMoveIndex=[F,D]}else if(y=="luckysheet-chart-rangeShow-coltitle"){let F=b.rangeArray[0].row[0]+b.rangeSplitArray.coltitle.row[0],D=b.rangeArray[0].column[0]+b.rangeSplitArray.coltitle.column[0];h.chart_selection.rangeMoveIndex=[F,D]}let p=ll(g.pageX,g.pageY),x=p[0]+$("#luckysheet-cell-main").scrollLeft(),_=p[1]+$("#luckysheet-cell-main").scrollTop(),S=$(this).data("type");S=="top"?_+=3:S=="right"?x-=3:S=="bottom"?_-=3:S=="left"&&(x+=3);let I=zl(_)[2],O=Ml(x)[2];h.chart_selection.rangeMovexy=[I,O],g.stopPropagation()}),$("#luckysheet-chart-rangeShow").on("mousedown.chartRangeShowResize",".luckysheet-chart-rangeShow-resize",function(g){h.chart_selection.rangeResize=$(this).data("type"),h.luckysheet_scroll_status=!0,h.chart_selection.rangeResizeObj=$(this).parent();let b=h.currentChart,y,p,x,_,S=$(this).parent().attr("id");if(S=="luckysheet-chart-rangeShow-content")b.rangeRowCheck.exits?(y=b.rangeArray[0].row[0]+b.rangeSplitArray.content.row[0],p=b.rangeArray[0].row[0]+b.rangeSplitArray.content.row[1]):(y=b.rangeSplitArray.content.row[0],p=b.rangeSplitArray.content.row[0]),b.rangeColCheck.exits?(x=b.rangeArray[0].column[0]+b.rangeSplitArray.content.column[0],_=b.rangeArray[0].column[0]+b.rangeSplitArray.content.column[1]):(x=b.rangeSplitArray.content.column[0],_=b.rangeSplitArray.content.column[1]),h.chart_selection.rangeResizeIndex={row:[y,p],column:[x,_]};else if(S=="luckysheet-chart-rangeShow-rowtitle"){let w=b.rangeArray[0].row[0]+b.rangeSplitArray.rowtitle.row[0],C=b.rangeArray[0].row[0]+b.rangeSplitArray.rowtitle.row[1],T=b.rangeArray[0].column[0]+b.rangeSplitArray.rowtitle.column[0],z=b.rangeArray[0].column[0]+b.rangeSplitArray.rowtitle.column[1];h.chart_selection.rangeResizeIndex={row:[w,C],column:[T,z]}}else if(S=="luckysheet-chart-rangeShow-coltitle"){let w=b.rangeArray[0].row[0]+b.rangeSplitArray.coltitle.row[0],C=b.rangeArray[0].row[0]+b.rangeSplitArray.coltitle.row[1],T=b.rangeArray[0].column[0]+b.rangeSplitArray.coltitle.column[0],z=b.rangeArray[0].column[0]+b.rangeSplitArray.coltitle.column[1];h.chart_selection.rangeResizeIndex={row:[w,C],column:[T,z]}}let I=ll(g.pageX,g.pageY),O=I[0]+$("#luckysheet-cell-main").scrollLeft(),F=I[1]+$("#luckysheet-cell-main").scrollTop();h.chart_selection.rangeResize=="lt"?(O+=3,F+=3):h.chart_selection.rangeResize=="lb"?(O+=3,F-=3):h.chart_selection.rangeResize=="rt"?(O-=3,F+=3):h.chart_selection.rangeResize=="rb"&&(O-=3,F-=3);let D=zl(F)[2],k=Ml(O)[2];h.chart_selection.rangeResizexy=[D,k],g.stopPropagation()}),$("#luckysheet-wa-calculate-size").mousedown(function(g){let b=g.pageY;v.functionResizeData.y=b,v.functionResizeStatus=!0,v.functionResizeData.calculatebarHeight=h.calculatebarHeight,v.rangetosheet!=null&&v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1])}),ht.initialMenuButton();let m=document.getElementById("testdpidiv").offsetWidth*h.devicePixelRatio,d=document.getElementById("testdpidiv").offsetHeight*h.devicePixelRatio;$(document).on("paste.luckysheetEvent",function(g){if(!Qe()){if(Ol.isPasteAction){$("#luckysheet-rich-text-editor").blur(),Ol.isPasteAction=!1;let b=window.clipboardData;b||(b=g.originalEvent.clipboardData);let y=b.getData("text/html")||b.getData("text/plain"),p=!0;if(y.indexOf("luckysheet_copy_action_table")>-1&&h.luckysheet_copy_save.copyRange!=null&&h.luckysheet_copy_save.copyRange.length>0){let _=[],S=new RegExp("<tr.*?>(.*?)</tr>","gs"),I=new RegExp("<td.*?>(.*?)</td>","gs"),O=y.match(S)||[];for(let z=0;z<O.length;z++){let A=[],M=O[z].match(I);if(M!=null)for(let P=0;P<M.length;P++){let N=M[P].replace(/<td.*?>/gs,"").replace(/<\/td>/gs,"");A.push(N)}_.push(A)}let F=h.luckysheet_copy_save.copyRange[0].row[0],D=h.luckysheet_copy_save.copyRange[0].row[1],k=h.luckysheet_copy_save.copyRange[0].column[0],w=h.luckysheet_copy_save.copyRange[0].column[1],C=h.luckysheet_copy_save.dataSheetIndex,T;C==h.currentSheetIndex?T=pt.deepCopyFlowData(h.flowdata):T=h.luckysheetfile[$e(C)].data;for(let z=F;z<=D&&!(z-F>_.length-1);z++)for(let A=k;A<=w;A++){let M=T[z][A],P=!1;if(M!=null&&M.mc!=null&&M.mc.rs==null)continue;let N;if(M!=null?M.ct!=null&&M.ct.fa.indexOf("w")>-1?N=T[z][A].v:N=T[z][A].m:N="",N==null&&T[z][A]&&T[z][A].ct&&T[z][A].ct.t=="inlineStr"&&(N=T[z][A].ct.s.map(E=>E.v).join(""),P=!0),N==null&&(N=""),P){let E=$(_[z-F][A-k]).text().replace(/\s|\n/g," "),B=N.replace(/\n/g,"").replace(/\s/g," ");if(E!=B){p=!1;break}}else if(_[z-F][A-k]!=N){p=!1;break}}}let x=Oe().fontjson;if(!Yt.createHookFunction("rangePasteBefore",h.luckysheet_select_save,y))return;if(y.indexOf("luckysheet_copy_action_table")>-1&&h.luckysheet_copy_save.copyRange!=null&&h.luckysheet_copy_save.copyRange.length>0&&p)h.luckysheet_paste_iscut?(h.luckysheet_paste_iscut=!1,Ol.pasteHandlerOfCutPaste(h.luckysheet_copy_save),Ol.clearcopy(g)):Ol.pasteHandlerOfCopyPaste(h.luckysheet_copy_save);else if(y.indexOf("luckysheet_copy_action_image")>-1)$t.pasteImgItem();else if(y.indexOf("table")>-1){$("#luckysheet-copy-content").html(y);let _=new Array($("#luckysheet-copy-content").find("table tr").length),S=0,I="th, td";$("#luckysheet-copy-content").find("table tr").eq(0).find(I).each(function(){let D=parseInt($(this).attr("colspan"));isNaN(D)&&(D=1),S+=D});for(let D=0;D<_.length;D++)_[D]=new Array(S);let O=0,F={};$("#luckysheet-copy-content").find("table tr").each(function(){let D=$(this),k=0;D.find(I).each(function(){let w=$(this),C={},T=w.text();if($.trim(T).length==0)C.v=null,C.m="";else{let he=nl(w.text());C.v=he[2],C.ct=he[1],C.m=he[0]}let z=w.css("background-color");z=="rgba(0, 0, 0, 0)"&&(z=null),C.bg=z;let A=w.css("font-weight");A==400||A=="normal"?C.bl=0:C.bl=1,w.css("text-decoration").indexOf("underline")!=-1&&(C.un=1),w.css("font-style")=="normal"?C.it=0:C.it=1;let E=w.css("font-family").split(",");for(let he=0;he<E.length;he++){let Z=$.trim(E[he].toLowerCase());if(Z=x[Z],Z==null)C.ff=0;else{C.ff=Z;break}}let B=Math.round(parseInt(w.css("font-size"))*72/96);C.fs=B;let U=w.css("color");C.fc=U;let X=w.css("text-align");X=="center"?C.ht=0:X=="right"?C.ht=2:C.ht=1;let le=w.css("vertical-align");for(le=="middle"?C.vt=0:le=="top"||le=="text-top"?C.vt=1:C.vt=2;k<S&&_[O][k]!=null;)k++;if(k==S)return!0;if(_[O][k]==null){_[O][k]=C;let he=parseInt(w.attr("rowspan")),Z=parseInt(w.attr("colspan"));isNaN(he)&&(he=1),isNaN(Z)&&(Z=1);let ae=h.luckysheet_select_save[0].row[0]+O,J=h.luckysheet_select_save[0].column[0]+k;for(let pe=0;pe<he;pe++)for(let K=0;K<Z;K++){if(pe==0){let se=w.css("border-top");if(se!=null&&se.length>0&&se.substr(0,3).toLowerCase()!="0px"){let te=w.css("border-top-width"),re=w.css("border-top-style"),fe=w.css("border-top-color"),Me=ht.getQKBorder(te,re,fe);F[O+pe+"_"+(k+K)]==null&&(F[O+pe+"_"+(k+K)]={}),F[O+pe+"_"+(k+K)].t={style:Me[0],color:Me[1]}}}if(pe==he-1){let se=w.css("border-bottom");if(se!=null&&se.length>0&&se.substr(0,3).toLowerCase()!="0px"){let te=w.css("border-bottom-width"),re=w.css("border-bottom-style"),fe=w.css("border-bottom-color"),Me=ht.getQKBorder(te,re,fe);F[O+pe+"_"+(k+K)]==null&&(F[O+pe+"_"+(k+K)]={}),F[O+pe+"_"+(k+K)].b={style:Me[0],color:Me[1]}}}if(K==0){let se=w.css("border-left");if(se!=null&&se.length>0&&se.substr(0,3).toLowerCase()!="0px"){let te=w.css("border-left-width"),re=w.css("border-left-style"),fe=w.css("border-left-color"),Me=ht.getQKBorder(te,re,fe);F[O+pe+"_"+(k+K)]==null&&(F[O+pe+"_"+(k+K)]={}),F[O+pe+"_"+(k+K)].l={style:Me[0],color:Me[1]}}}if(K==Z-1){let se=w.css("border-right");if(se!=null&&se.length>0&&se.substr(0,3).toLowerCase()!="0px"){let te=w.css("border-right-width"),re=w.css("border-right-style"),fe=w.css("border-right-color"),Me=ht.getQKBorder(te,re,fe);F[O+pe+"_"+(k+K)]==null&&(F[O+pe+"_"+(k+K)]={}),F[O+pe+"_"+(k+K)].r={style:Me[0],color:Me[1]}}}pe==0&&K==0||(_[O+pe][k+K]={mc:{r:ae,c:J}})}if(he>1||Z>1){let pe={rs:he,cs:Z,r:ae,c:J};_[O][k].mc=pe}}if(k++,k==S)return!0}),O++}),h.luckysheet_selection_range=[],Ol.pasteHandler(_,F),$("#luckysheet-copy-content").empty()}else if(b.files.length==1&&b.files[0].type.indexOf("image")>-1){$t.insertImg(b.files[0]);return}else y=b.getData("text/plain"),Ol.pasteHandler(y)}else if($(g.target).closest("#luckysheet-rich-text-editor").length>0){g.preventDefault();let b=window.clipboardData;b||(b=g.originalEvent.clipboardData);let y=b.getData("text/plain");document.execCommand("insertText",!1,y)}}}),lt.enablePage&&$("#luckysheet-bottom-page-next").click(function(){let g=lt.pageInfo.queryExps,b=lt.pageInfo.reportId,y=lt.pageInfo.fields,p=lt.pageInfo.mobile,x=lt.pageInfo.frezon,_=lt.pageInfo.currentPage,S=lt.pageInfo.totalPage,I=lt.pageInfo.pageUrl;Yt.addDataAjax({queryExps:g,reportId:b,fields:y,mobile:p,frezon:x,pageIndex:_,currentPage:_},h.currentSheetIndex,I,function(){if(lt.pageInfo.currentPage++,lt.pageInfo.totalPage==lt.pageInfo.currentPage){$("#luckysheet-bottom-page-next").hide();let O=yt(o.pageInfoFull,{total:lt.total,totalPage:lt.pageInfo.totalPage});$("#luckysheet-bottom-page-info").html(O)}else{let O=yt(o.pageInfo,{total:lt.total,totalPage:lt.pageInfo.totalPage,currentPage:lt.pageInfo.currentPage});$("#luckysheet-bottom-page-info").html(O)}})}).mousedown(function(g){g.stopPropagation()}),$("#luckysheet-bottom-bottom-top").click(function(){$("#luckysheet-scrollbar-y").scrollTop(0)}).mousedown(function(g){g.stopPropagation()}),$("#luckysheet-wa-editor,#luckysheet-icon-morebtn-div,.luckysheet-toolbar-button").click(function(g){this.id!="luckysheet-icon-paintformat"&&ht.luckysheetPaintModelOn&&ht.cancelPaintModel()})}function m_(){let e=jt(".luckysheet-multipleRange-show");e.length===void 0&&(e=[e]),e.forEach(n=>{let t=n.id.replace("luckysheet-multipleRange-show-","");h.cooperativeEdit.usernameTimeout["user"+t]===null&&(jt(".username",n).style.display="none")})}var import_plugin,J1=Tt(()=>{import_plugin=Le(Be());U1();bn();li();Qo();zm();Fo();To();Mc();Vi();Mr();ji();$c();Dg();Yr();wr();Ns();xo();Bi();Cc();vr();Ac();$h();G1();pa();ar();jn();Z1();gl();ql();Qn();Hi();Gl();xc();sc();ir();Ms();K1();fr();mr();Sr();br();Hn();qn();Tc();vh();Rl();Ut();bh()});function Q1(){let e=Oe().drag;$("#luckysheet-copy-json-head").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}if(h.config.merge!=null){let a=!1;for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].row[0],f=h.luckysheet_select_save[s].row[1],m=h.luckysheet_select_save[s].column[0],d=h.luckysheet_select_save[s].column[1];if(a=Ul(h.config,u,f,m,d),a)break}if(a){Qe()?alert(e.noPartMerge):de.info(e.noPartMerge,"");return}}let l=Xl(h.luckysheet_select_save[0]),o=[];if(l.length!=0){if(l.length==1){let a={};for(let s=0;s<l[0].length;s++)a[Mt(0,s,l)]="";o.push(a)}else for(let a=1;a<l.length;a++){let s={};for(let u=0;u<l[0].length;u++)Mt(0,u,l)==null?s[""]=Mt(a,u,l):s[Mt(0,u,l)]=Mt(a,u,l);o.push(s)}Ol.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-copy-json-nohead").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}if(h.config.merge!=null){let s=!1;for(let u=0;u<h.luckysheet_select_save.length;u++){let f=h.luckysheet_select_save[u].row[0],m=h.luckysheet_select_save[u].row[1],d=h.luckysheet_select_save[u].column[0],g=h.luckysheet_select_save[u].column[1];if(s=Ul(h.config,f,m,d,g),s)break}if(s){Qe()?alert(e.noPartMerge):de.info(e.noPartMerge,"");return}}let l=Xl(h.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=h.luckysheet_select_save[0].column[0];for(let s=0;s<l.length;s++){let u={};for(let f=0;f<l[0].length;f++)u[Qt(f+a)]=Mt(s,f,l);o.push(u)}Ol.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-array1").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}if(h.config.merge!=null){let a=!1;for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].row[0],f=h.luckysheet_select_save[s].row[1],m=h.luckysheet_select_save[s].column[0],d=h.luckysheet_select_save[s].column[1];if(a=Ul(h.config,u,f,m,d),a)break}if(a){Qe()?alert(e.noPartMerge):de.info(e.noPartMerge,"");return}}let l=Xl(h.luckysheet_select_save[0]),o=[];if(l.length!=0){for(let a=0;a<l.length;a++)for(let s=0;s<l[0].length;s++)o.push(Mt(a,s,l));Ol.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-copy-array2").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}if(h.config.merge!=null){let a=!1;for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].row[0],f=h.luckysheet_select_save[s].row[1],m=h.luckysheet_select_save[s].column[0],d=h.luckysheet_select_save[s].column[1];if(a=Ul(h.config,u,f,m,d),a)break}if(a){Qe()?alert(e.noPartMerge):de.info(e.noPartMerge,"");return}}let l=Xl(h.luckysheet_select_save[0]),o=[];if(l.length!=0){for(let a=0;a<l.length;a++){let s=[];for(let u=0;u<l[0].length;u++)s.push(Mt(a,u,l));o.push(s)}Ol.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-copy-arraymore-confirm").click(function(t){if(t.target.nodeName==="INPUT")return;if($("body .luckysheet-cols-menu").hide(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}if(h.config.merge!=null){let d=!1;for(let g=0;g<h.luckysheet_select_save.length;g++){let b=h.luckysheet_select_save[g].row[0],y=h.luckysheet_select_save[g].row[1],p=h.luckysheet_select_save[g].column[0],x=h.luckysheet_select_save[g].column[1];if(d=Ul(h.config,b,y,p,x),d)break}if(d){Qe()?alert(e.noPartMerge):de.info(e.noPartMerge,"");return}}let l=Xl(h.luckysheet_select_save[0]),o=[];if(l.length==0)return;for(let d=0;d<l.length;d++)for(let g=0;g<l[0].length;g++)o.push(l[d][g]);let a=$("#luckysheet-copy-arraymore-row").val(),s=$("#luckysheet-copy-arraymore-col").val();if(a==""&&s==""){Ol.copybyformat(t,JSON.stringify(o)),$("body .luckysheet-cols-menu").hide();return}if(a==""?a=1:(a=parseInt(a),a==null&&(a=1)),s==""?s=1:(s=parseInt(s),s==null&&(s=1)),a.toString()=="NaN"||s.toString()=="NaN"){Qe()?alert(e.inputCorrect):de.info(e.inputCorrect,"");return}if(a<1||s<1){Qe()?alert(e.notLessOne):de.info(e.notLessOne,"");return}let u=o.length,f=0,m=[];for(let d=0;d<a;d++){let g=[];for(let b=0;b<s;b++)if(g.push(o[f++]),f>=u){Ol.copybyformat(t,JSON.stringify(m)),$("body .luckysheet-cols-menu").hide();return}m.push(g)}Ol.copybyformat(t,JSON.stringify(m))}),$("#luckysheet-copy-diagonal").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}if(h.config.merge!=null){let s=!1;for(let u=0;u<h.luckysheet_select_save.length;u++){let f=h.luckysheet_select_save[u].row[0],m=h.luckysheet_select_save[u].row[1],d=h.luckysheet_select_save[u].column[0],g=h.luckysheet_select_save[u].column[1];if(s=Ul(h.config,f,m,d,g),s)break}if(s){Qe()?alert(e.noPartMerge):de.info(e.noPartMerge,"");return}}let l=Xl(h.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=l[0].length;for(let s=0;s<l.length&&!(s>=a);s++)o.push(l[s][s]);Ol.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-antidiagonal").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}if(h.config.merge!=null){let s=!1;for(let u=0;u<h.luckysheet_select_save.length;u++){let f=h.luckysheet_select_save[u].row[0],m=h.luckysheet_select_save[u].row[1],d=h.luckysheet_select_save[u].column[0],g=h.luckysheet_select_save[u].column[1];if(s=Ul(h.config,f,m,d,g),s)break}if(s){Qe()?alert(e.noPartMerge):de.info(e.noPartMerge,"");return}}let l=Xl(h.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=l[0].length;for(let s=0;s<l.length&&!(s>=a);s++)o.push(l[s][a-s-1]);Ol.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-diagonaloffset").click(function(t){if(t.target.nodeName==="INPUT")return;if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}if(h.config.merge!=null){let u=!1;for(let f=0;f<h.luckysheet_select_save.length;f++){let m=h.luckysheet_select_save[f].row[0],d=h.luckysheet_select_save[f].row[1],g=h.luckysheet_select_save[f].column[0],b=h.luckysheet_select_save[f].column[1];if(u=Ul(h.config,m,d,g,b),u)break}if(u){Qe()?alert(e.noPartMerge):de.info(e.noPartMerge,"");return}}let l=Xl(h.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=l[0].length,s=parseInt($("#luckysheet-copy-diagonaloffset-value").val());if(s.toString()=="NaN"){Qe()?alert(e.inputCorrect):de.info(e.inputCorrect,"");return}if(s<0){Qe()?alert(e.offsetColumnLessZero):de.info(e.offsetColumnLessZero,"");return}s==null&&(s=1);for(let u=0;u<l.length&&!(u+s>=a);u++)o.push(l[u][u+s]);Ol.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-boolvalue").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}if(h.config.merge!=null){let a=!1;for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].row[0],f=h.luckysheet_select_save[s].row[1],m=h.luckysheet_select_save[s].column[0],d=h.luckysheet_select_save[s].column[1];if(a=Ul(h.config,u,f,m,d),a)break}if(a){Qe()?alert(e.noPartMerge):de.info(e.noPartMerge,"");return}}let l=Xl(h.luckysheet_select_save[0]),o=[];if(l.length!=0){for(let a=0;a<l.length;a++){let s=[];for(let u=0;u<l[0].length;u++){let f=!1,m;V(l[a][u])=="object"?m=l[a][u].v:m=l[a][u],m==null||m==""?f=!1:(m=parseInt(m),m==null||m>0?f=!0:f=!1),s.push(f)}o.push(s)}Ol.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-matrix-turn-up").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}let l=Xl(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=l.length-1;a>=0;a--){let s=[];for(let u=0;u<l[0].length;u++){let f="";l[a]!=null&&l[a][u]!=null&&(f=l[a][u]),s.push(f)}o.push(s)}pt.controlHandler(o)}),$("#luckysheet-matrix-turn-left").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}let l=Xl(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=0;a<l.length;a++){let s=[];for(let u=l[0].length-1;u>=0;u--){let f="";l[a]!=null&&l[a][u]!=null&&(f=l[a][u]),s.push(f)}o.push(s)}pt.controlHandler(o)}),$("#luckysheet-matrix-turn-cw").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}let l=Xl(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=0;a<l[0].length;a++){let s=[];for(let u=l.length-1;u>=0;u--){let f="";l[u]!=null&&l[u][a]!=null&&(f=l[u][a]),s.push(f)}o.push(s)}pt.controlHandlerD(o)}),$("#luckysheet-matrix-turn-anticw").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}let l=Xl(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=l[0].length-1;a>=0;a--){let s=[];for(let u=0;u<l.length;u++){let f="";l[u]!=null&&l[u][a]!=null&&(f=l[u][a]),s.push(f)}o.push(s)}pt.controlHandlerD(o)}),$("#luckysheet-matrix-turn-trans").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}let l=Xl(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=0;a<l[0].length;a++){let s=[];for(let u=0;u<l.length;u++){let f="";l[u]!=null&&l[u][a]!=null&&(f=l[u][a]),s.push(f)}o.push(s)}pt.controlHandlerD(o)});let n=function(t,l){if(t==0)return 0;let o,a;for(o=t,a=(l-1)*o/l+t/(Math.pow(o,l-1)*l);Math.abs(a-o)>1e-6;)o=a,a=(l-1)*o/l+t/(Math.pow(o,l-1)*l);return a};$("#luckysheet-matrix-cal-confirm").click(function(t){if(t.target.nodeName==="INPUT"||t.target.nodeName==="SELECT")return;if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}let l=Xl(h.luckysheet_select_save[0]);if(l.length==0)return;let o=$("#luckysheet-matrix-cal-type").val(),a=parseInt($("#luckysheet-matrix-cal-value").val());if(a.toString()=="NaN"){Qe()?alert(e.inputCorrect):de.info(e.inputCorrect,"");return}a==null&&(a=2);let s=[];for(let u=0;u<l.length;u++){let f=[];for(let m=0;m<l[0].length;m++){let d="";l[u]!=null&&l[u][m]!=null&&(d=l[u][m],parseInt(d)!=null&&l[u][m].ct!=null&&l[u][m].ct.t=="n"&&(o=="minus"?d.v=d.v-a:o=="multiply"?d.v=d.v*a:o=="divided"?d.v=Fn(d.v/a,4):o=="power"?d.v=Math.pow(d.v,a):o=="root"?a==2?d.v=Fn(Math.sqrt(d.v),4):a==3&&Math.cbrt?d.v=Fn(Math.cbrt(d.v),4):d.v=Fn(n(d.v,a),4):o=="log"?d.v=Fn(Math.log(d.v)*1e4/Math.log(Math.abs(a)),4):d.v=d.v+a,d.v==null?d.m="":d.m=d.v.toString())),f.push(d)}s.push(f)}pt.controlHandler(s)}),$("#luckysheet-matrix-delezero-row").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}let l=Xl(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l[0].length;for(let s=0;s<l.length;s++){let u=[],f=!0,m=!0;for(let g=0;g<a;g++){let b="";if(l[s]!=null&&l[s][g]!=null){if(b=l[s][g],(b.v=="0"||b.v==0)&&f)continue;f=!1}u.push(b)}let d=[];if(u.length==a)d=u;else{for(let b=u.length-1;b>=0;b--){let y="";if(u[b]!=null){if(y=u[b],(y.v=="0"||y.v==0)&&m)continue;m=!1}d.unshift(y)}let g=a-d.length;for(let b=0;b<g;b++)d.push("")}o.push(d)}pt.controlHandler(o)}),$("#luckysheet-matrix-delezero-column").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}let l=Xl(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l.length,s=l[0].length;for(let f=0;f<s;f++){let m=[],d=!0,g=!0;for(let y=0;y<a;y++){let p="";if(l[y]!=null&&l[y][f]!=null){if(p=l[y][f],(p.v=="0"||p.v==0)&&d)continue;d=!1}m.push(p)}let b=[];if(m.length==a)b=m;else{for(let p=m.length-1;p>=0;p--){let x="";if(m[p]!=null){if(x=m[p],(x.v=="0"||x.v==0)&&g)continue;g=!1}b.unshift(x)}let y=a-b.length;for(let p=0;p<y;p++)b.push("")}o.push(b)}let u=[];for(let f=0;f<o[0].length;f++){let m=[];for(let d=0;d<o.length;d++){let g="";o[d]!=null&&o[d][f]!=null&&(g=o[d][f]),m.push(g)}u.push(m)}pt.controlHandler(u)}),$("#luckysheet-matrix-delerpt-row").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}let l=Xl(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l[0].length;for(let s=0;s<l.length;s++){let u=[],f={};for(let d=0;d<a;d++){let g=null;l[s]!=null&&l[s][d]!=null&&(g=l[s][d],g.v in f||(f[g.v]=[]),f[g.v].push(g))}for(let d=0;d<a;d++){let g=null;l[s]!=null&&l[s][d]!=null&&(g=l[s][d],f[g.v].length==1&&u.push(g))}let m=a-u.length;for(let d=0;d<m;d++)u.push(null);o.push(u)}pt.controlHandler(o)}),$("#luckysheet-matrix-delerpt-column").click(function(t){if($("body .luckysheet-cols-menu").hide(),el(),h.luckysheet_select_save.length>1){Qe()?alert(e.noMulti):de.info(e.noMulti,"");return}let l=Xl(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l.length,s=l[0].length;for(let f=0;f<s;f++){let m=[],d={};for(let b=0;b<a;b++){let y=null;l[b]!=null&&l[b][f]!=null&&(y=l[b][f],y.v in d||(d[y.v]=[]),d[y.v].push(y))}for(let b=0;b<a;b++){let y=null;l[b]!=null&&l[b][f]!=null&&(y=l[b][f],d[y.v].length==1&&m.push(y))}a1=m;let g=a-a1.length;for(let b=0;b<g;b++)a1.push(null);o.push(a1)}let u=[];for(let f=0;f<o[0].length;f++){let m=[];for(let d=0;d<o.length;d++){let g=null;o[d]!=null&&o[d][f]!=null&&(g=o[d][f]),m.push(g)}u.push(m)}pt.controlHandler(u)})}var import_plugin,ek=Tt(()=>{import_plugin=Le(Be());Ac();gl();Gl();mr();Sr();br();Rl();Ut()});function rk(){if(!Lg){Lg=!0;let t=Oe(),l=t.toolbar;$("#luckysheetsheetconfigcolorur").spectrum({showPalette:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!1,showSelectionPalette:!0,maxPaletteSize:10,cancelText:t.sheetconfig.cancelText,chooseText:t.sheetconfig.chooseText,togglePaletteMoreText:l.toolMore,togglePaletteLessText:l.toolLess,clearText:l.clearText,noColorSelectedText:l.noColorSelectedText,palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)"],["rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)"],["rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)"],["rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)"],["rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"],["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"]],change:function(o){let a=$(this);o!=null?o=o.toHexString():o="rgb(0, 0, 0)";let s=null;Xr.find(".luckysheet-sheets-item-color").length>0&&(s=Xr.find(".luckysheet-sheets-item-color").css("background-color")),Xr.find(".luckysheet-sheets-item-color").remove(),Xr.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+o+';"></div>');let u=$e(h.currentSheetIndex);if(h.luckysheetfile[u].color=o,He.saveParam("all",h.currentSheetIndex,o,{k:"color"}),h.clearjfundo){let f={};f.type="sheetColor",f.sheetIndex=h.currentSheetIndex,f.oldcolor=s,f.color=o,h.jfundo.length=0,h.jfredo.push(f)}}}),$("#luckysheetsheetconfigcolorreset").click(function(){let o=null;Xr.find(".luckysheet-sheets-item-color").length>0&&(o=Xr.find(".luckysheet-sheets-item-color").css("background-color")),Xr.find(".luckysheet-sheets-item-color").remove();let a=$e(h.currentSheetIndex);if(h.luckysheetfile[a].color=null,He.saveParam("all",h.currentSheetIndex,null,{k:"color"}),h.clearjfundo){let s={};s.type="sheetColor",s.sheetIndex=h.currentSheetIndex,s.oldcolor=o,s.color=null,h.jfundo.length=0,h.jfredo.push(s)}})}let e=$e(h.currentSheetIndex);h.luckysheetfile[e].color!=null&&h.luckysheetfile[e].color.length>0&&$("#luckysheetsheetconfigcolorur").spectrum("set",h.luckysheetfile[e].color),$("#luckysheetsheetconfigcolorur").parent().find("span, div, button, input, a").addClass("luckysheet-mousedown-cancel");let n=lt.sheetRightClickConfig;Object.values(n).every(t=>!t)||setTimeout(function(){qr($("#luckysheet-rightclick-sheet-menu"),Xr.offset().left+Xr.width(),Xr.offset().top-18,"leftbottom")},1)}function ik(){let n=Oe().sheetconfig;Lg=!1,$("#luckysheet-sheet-area").on("mousedown","div.luckysheet-sheets-item",function(m){if(Qe())return;let d=$(this),g=$(m.target),b=g.closest(".luckysheet-sheets-item");m.which=="3"&&setTimeout(()=>{nk(d,g,m),Xr=b,rk()},0),b.hasClass("luckysheet-sheets-item-active")&&b.find(".luckysheet-sheets-item-name").attr("contenteditable")=="false"&&(tk=setTimeout(function(){h.luckysheet_sheet_move_status=!0,h.luckysheet_sheet_move_data={},h.luckysheet_sheet_move_data.widthlist=[],$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").each(function(x){x==0?h.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):h.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+h.luckysheet_sheet_move_data.widthlist[x-1])}),h.luckysheet_sheet_move_data.curindex=$("#luckysheet-sheet-area div.luckysheet-sheets-item").index(b);let y=m.pageX;h.luckysheet_sheet_move_data.curleft=y-b.offset().left,h.luckysheet_sheet_move_data.pageX=y,h.luckysheet_sheet_move_data.activeobject=b,h.luckysheet_sheet_move_data.cursorobject=g;let p=b.clone().css("visibility","hidden").attr("id","luckysheet-sheets-item-clone");b.after(p),b.css({position:"absolute",opacity:.8,cursor:"move",transition:"initial","z-index":10})},200))}).on("click","div.luckysheet-sheets-item",function(m){if(Qe())return;let d=$(this),g=$(m.target);nk(d,g,m),He.keepHighLightBox()});let t=function(m){h.allowEdit!==!1&&(m.attr("contenteditable","true").addClass("luckysheet-mousedown-cancel").data("oldtxt",m.text()),setTimeout(function(){dy(m.get(0))},1))};$("#luckysheet-sheet-area").on("dblclick","span.luckysheet-sheets-item-name",function(m){t($(this))});let l=!0;$("#luckysheet-sheet-area").on("compositionstart","span.luckysheet-sheets-item-name",()=>l=!1),$("#luckysheet-sheet-area").on("compositionend","span.luckysheet-sheets-item-name",()=>l=!0),$("#luckysheet-sheet-area").on("input","span.luckysheet-sheets-item-name",function(){if(h.allowEdit===!1||h.limitSheetNameLength===!1)return;let m=h.defaultSheetNameMaxLength;m!==0&&setTimeout(()=>{l&&$(this).text().length>=m&&setTimeout(()=>{$(this).text($(this).text().substring(0,m));let d=window.getSelection();d.selectAllChildren(this),d.collapseToEnd()},0)},0)}),$("#luckysheet-sheet-area").on("blur","span.luckysheet-sheets-item-name",function(m){if(h.allowEdit===!1)return;let d=$(this),g=d.text(),b=d.data("oldtxt");if($(this).text().length===0){de.info("",n.sheetNamecannotIsEmptyError),d.text(b).attr("contenteditable","false");return}if(g.length>31||g.charAt(0)=="'"||g.charAt(g.length-1)=="'"||/[\:\\\/\?\*\[\]]+/.test(g)){de.info("",n.sheetNameSpecCharError),d.text(b).attr("contenteditable","false");return}let y=$e(h.currentSheetIndex);for(let p=0;p<h.luckysheetfile.length;p++)if(y!=p&&h.luckysheetfile[p].name==g){Qe()?alert(n.tipNameRepeat):de.info("",n.tipNameRepeat),d.text(b).attr("contenteditable","false");return}if(ct.sheetArrowShowAndHide(),h.luckysheetfile[y].name=g,He.saveParam("all",h.currentSheetIndex,g,{k:"name"}),d.attr("contenteditable","false").removeClass("luckysheet-mousedown-cancel"),h.clearjfundo){let p={};p.type="sheetName",p.sheetIndex=h.currentSheetIndex,p.oldtxt=b,p.txt=g,h.jfundo.length=0,h.jfredo.push(p)}Yt.createHookFunction("sheetEditNameAfter",{i:h.luckysheetfile[y].index,oldName:b,newName:g})}),$("#luckysheet-sheet-area").on("keydown","span.luckysheet-sheets-item-name",function(m){if(h.allowEdit===!1)return;let d=m.keyCode,g=$(this);if(d==rl.ENTER){let b=$e(h.currentSheetIndex);lk=h.luckysheetfile[b].name||lk,h.luckysheetfile[b].name=g.text(),g.attr("contenteditable","false")}}),$("#luckysheetsheetconfigrename").click(function(){var m=Xr.find("span.luckysheet-sheets-item-name");!Yt.createHookFunction("sheetEditNameBefore",{i:Xr.data("index"),name:m.text()})||(t(Xr.find("span.luckysheet-sheets-item-name")),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide())}),$("#luckysheetsheetconfigshow").click(function(){$("#luckysheet-sheets-m").click(),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigmoveleft").click(function(){Xr.prevAll(":visible").length>0&&(Xr.insertBefore(Xr.prevAll(":visible").eq(0)),ct.reOrderAllSheet()),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigmoveright").click(function(){Xr.nextAll(":visible").length>0&&(Xr.insertAfter(Xr.nextAll(":visible").eq(0)),ct.reOrderAllSheet()),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigdelete").click(function(m){if($("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),$("#luckysheet-sheet-container-c .luckysheet-sheets-item:visible").length<=1){Qe()?alert(n.noMoreSheet):de.info(n.noMoreSheet,"");return}let d=$e(h.currentSheetIndex);de.confirm(n.confirmDelete+"\u3010"+h.luckysheetfile[d].name+"\u3011\uFF1F","<span style='color:#9e9e9e;font-size:12px;'>"+n.redoDelete+"</span>",function(){ct.deleteSheet(Xr.data("index"))},null),$("#luckysheet-input-box").removeAttr("style")}),$("#luckysheetsheetconfigcopy").click(function(m){ct.copySheet(Xr.data("index"),m),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfighide").click(function(){if($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").length==1){Qe()?alert(n.noHide):de.info("",n.noHide);return}ct.setSheetHide(Xr.data("index")),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheet-sheets-add").click(function(m){parseInt($("#luckysheet-input-box").css("top"))>0&&v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),ct.addNewSheet(m),ct.locationSheet(),$("#luckysheet-input-box").removeAttr("style")});let o=null,a=0,s=0,u=150;$("#luckysheet-sheets-leftscroll").click(function(){let m=$("#luckysheet-sheet-container-c");a=m.scrollLeft(),s=m.scrollLeft()-u,s<=0&&$("#luckysheet-sheet-container .docs-sheet-fade-left").hide(),$("#luckysheet-sheet-container .docs-sheet-fade-right").show(),clearInterval(o),o=setInterval(function(){a-=4,m.scrollLeft(a),a<=s&&clearInterval(o)},1)}),$("#luckysheet-sheets-rightscroll").click(function(){let m=$("#luckysheet-sheet-container-c");a=m.scrollLeft(),s=m.scrollLeft()+u,a>0&&$("#luckysheet-sheet-container .docs-sheet-fade-right").hide(),$("#luckysheet-sheet-container .docs-sheet-fade-left").show(),clearInterval(o),o=setInterval(function(){a+=4,m.scrollLeft(a),a>=s&&clearInterval(o)},1)});let f=!0;$("#luckysheet-sheets-m").click(function(m){parseInt($("#luckysheet-input-box").css("top"))>0&&v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),$("#luckysheet-sheet-list").html("");let d="";for(let p=0;p<h.luckysheetfile.length;p++){let x=h.luckysheetfile[p],_="",S="";x.status==1&&(_='<i class="fa fa-check" aria-hidden="true"></i>'),x.hide==1&&(_='<i class="fa fa-low-vision" aria-hidden="true"></i>',S+="color:#BBBBBB;"),x.color!=null&&x.color.length>0&&(S+="border-right:4px solid "+x.color+";"),d+=yt(d0,{index:x.index,name:x.name,icon:_,style:S})}f?($("#"+h.container).append(yt(h0,{item:d})),$("#luckysheet-sheet-list").on("click",".luckysheet-cols-menuitem",function(p){if(Qe()){alert(n.chartEditNoOpt);return}let x=$(this),_=x.data("index");x.data("index")!=h.currentSheetIndex&&(ct.setSheetShow(_),ct.locationSheet()),He.keepHighLightBox()}),f=!1):$("#luckysheet-sheet-list").html(d);let g=$("#luckysheet-sheet-list"),b=$(this).offset().left-$("#"+h.container).offset().left,y=$(this).height()+$("#luckysheet-sta-content").height()+12;g.css({left:b+"px",bottom:y+"px"}).show(),$("#luckysheet-input-box").removeAttr("style")}),lt.pager&&Ig(lt.pager)}var import_plugin,Lg,Xr,tk,lk,nk,ok=Tt(()=>{import_plugin=Le(Be());Yr();wr();ar();gl();ql();Gl();ir();Io();Sr();pa();Rl();Ut();bn();Es();qn();Lg=!1,Xr=null,tk=null,lk="";nk=function(e,n,t){clearTimeout(tk),!(n.hasClass("luckysheet-sheets-item-name")&&n.attr("contenteditable")=="true")&&(v.rangestart||v.rangedrag_column_start||v.rangedrag_row_start||v.israngeseleciton()?setTimeout(function(){v.setCaretPosition(v.rangeSetValueTo.get(0),0,v.rangeSetValueTo.text().length),v.createRangeHightlight(),$("#luckysheet-input-box-index").find(".luckysheet-input-box-index-sheettxt").remove().end().prepend("<span class='luckysheet-input-box-index-sheettxt'>"+ct.getSheetName(v.rangetosheet)+"!</span>").show(),$("#luckysheet-input-box-index").css({left:$("#luckysheet-input-box").css("left"),top:parseInt($("#luckysheet-input-box").css("top"))-20+"px","z-index":$("#luckysheet-input-box").css("z-index")})},1):(parseInt($("#luckysheet-input-box").css("top"))>0&&v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove()),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),e.addClass("luckysheet-sheets-item-active"),Ir(t),ct.changeSheet(e.data("index")),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),(n.hasClass("luckysheet-sheets-item-menu")||n.hasClass("fa-sort-desc")||t.which=="3")&&(Xr=n.closest(".luckysheet-sheets-item"),rk()))}});function ak(){let n=Oe().formula;$("#luckysheet-functionbox-cell").focus(function(){if(!Qe()&&h.luckysheet_select_save.length>0){let t=h.luckysheet_select_save[h.luckysheet_select_save.length-1],l=t.row_focus,o=t.column_focus;Dn(l,o,h.flowdata,null,!0),v.rangeResizeTo=$("#luckysheet-functionbox-cell")}}).keydown(function(t){if(Qe())return;let l=t.ctrlKey,o=t.altKey,a=t.shiftKey,s=t.keyCode,u=$("#luckysheet-input-box");if(s==rl.ENTER&&parseInt(u.css("top"))>0)$("#luckysheet-formula-search-c").is(":visible")&&v.searchFunctionCell!=null?v.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_select_save=[{row:[h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[0]],column:[h.luckysheetCellUpdate[1],h.luckysheetCellUpdate[1]],row_focus:h.luckysheetCellUpdate[0],column_focus:h.luckysheetCellUpdate[1]}],lr("down",1,"rangeOfSelect"),$("#luckysheet-rich-text-editor").focus()),t.preventDefault();else if(s==rl.ESC&&parseInt(u.css("top"))>0)v.dontupdate(),lr("down",0,"rangeOfSelect"),$("#luckysheet-rich-text-editor").focus(),t.preventDefault();else if(s==rl.F4&&parseInt(u.css("top"))>0)v.setfreezonFuc(t),t.preventDefault();else if(s==rl.UP&&parseInt(u.css("top"))>0){if($("#luckysheet-formula-search-c").is(":visible")){let f=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").prev();f.length==0&&(f=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").last()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),f.addClass("luckysheet-formula-search-item-active"),t.preventDefault()}}else if(s==rl.DOWN&&parseInt(u.css("top"))>0){if($("#luckysheet-formula-search-c").is(":visible")){let f=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").next();f.length==0&&(f=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").first()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),f.addClass("luckysheet-formula-search-item-active"),t.preventDefault()}}else s==rl.LEFT&&parseInt(u.css("top"))>0?v.rangeHightlightselected($("#luckysheet-functionbox-cell")):s==rl.RIGHT&&parseInt(u.css("top"))>0?v.rangeHightlightselected($("#luckysheet-functionbox-cell")):(!(s>=112&&s<=123||s<=46||s==144||s==108||t.ctrlKey||t.altKey||t.shiftKey&&(s==37||s==38||s==39||s==40))||s==8||s==32||s==46||t.ctrlKey&&s==86)&&v.functionInputHanddler($("#luckysheet-rich-text-editor"),$("#luckysheet-functionbox-cell"),s)}).click(function(){Qe()||v.rangeHightlightselected($("#luckysheet-functionbox-cell"))}),$("#luckysheet-wa-functionbox-cancel").click(function(){!$(this).hasClass("luckysheet-wa-calculate-active")||($("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),v.dontupdate(),lr("down",0,"rangeOfSelect"))}),$("#luckysheet-wa-functionbox-confirm").click(function(){!$(this).hasClass("luckysheet-wa-calculate-active")||($("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("down",0,"rangeOfSelect"))}),$("#luckysheet-wa-functionbox-fx").click(function(){if(h.luckysheet_select_save.length==0){Qe()?alert(n.tipSelectCell):de.info(n.tipSelectCell,"");return}let t=h.luckysheet_select_save[h.luckysheet_select_save.length-1],l=t.row_focus,o=t.column_focus;Dn(l,o,h.flowdata);let a=h.flowdata[l][o];if(a!=null&&a.f!=null){let s=v.getfunctionParam(a.f);s.fn!=null?ra.formulaParmDialog(s.fn,s.param):ra.formulaListDialog()}else $("#luckysheet-rich-text-editor").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),ra.formulaListDialog();ra.init()}),$("#luckysheet-formula-functionrange").on("mousedown",".luckysheet-copy",function(t){v.rangeMove=!0,h.luckysheet_scroll_status=!0,v.rangeMoveObj=$(this).parent(),v.rangeMoveIndex=$(this).parent().attr("rangeindex");let l=ll(t.pageX,t.pageY),o=l[0]+$("#luckysheet-cell-main").scrollLeft(),a=l[1]+$("#luckysheet-cell-main").scrollTop();$("#luckysheet-formula-functionrange-highlight-"+v.rangeMoveIndex).find(".luckysheet-selection-copy-hc").css("opacity",.13);let s=$(this).data("type");s=="top"?a+=3:s=="right"?o-=3:s=="bottom"?a-=3:s=="left"&&(o+=3);let u=zl(a)[2],f=Ml(o)[2];v.rangeMovexy=[u,f],$("#luckysheet-sheettable").css("cursor","move"),t.stopPropagation()}),$("#luckysheet-formula-functionrange").on("mousedown",".luckysheet-highlight",function(t){v.rangeResize=$(this).data("type"),v.rangeResizeIndex=$(this).parent().attr("rangeindex");let l=ll(t.pageX,t.pageY),o=$("#luckysheet-cell-main").scrollLeft(),a=$("#luckysheet-cell-main").scrollTop(),s=l[0]+o,u=l[1]+a;v.rangeResizeObj=$(this).parent(),$("#luckysheet-formula-functionrange-highlight-"+v.rangeResizeIndex).find(".luckysheet-selection-copy-hc").css("opacity",.13),v.rangeResize=="lt"?(s+=3,u+=3):v.rangeResize=="lb"?(s+=3,u-=3):v.rangeResize=="rt"?(s-=3,u+=3):v.rangeResize=="rb"&&(s-=3,u-=3);let f=zl(u),m=f[1],d=f[0],g=f[2],b=Ml(s),y=b[1],p=b[0],x=b[2],_=v.rangeResizeObj.position();v.rangeResizexy=[p,d,v.rangeResizeObj.width(),v.rangeResizeObj.height(),_.left+o,_.top+a,y,m],v.rangeResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,v.rangeResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,h.luckysheet_scroll_status=!0,t.stopPropagation()})}var import_plugin,sk=Tt(()=>{import_plugin=Le(Be());Mr();Ns();ar();Cc();Ag();Qn();Gl();ir();Sr();Rl();Ut()});function ck(){$("#luckysheet-rows-h").mousedown(function(e){if(!Eu(h.currentSheetIndex))return;Nt.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&$t.cancelActiveImgItem();let t=ll(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=zl(t),o=l[1],a=l[0],s=l[2],u=h.visibledatacolumn.length-1,f=h.visibledatacolumn[u],m=0;if($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),e.which=="3"){let p=!1;for(let x=0;x<h.luckysheet_select_save.length;x++){let _=h.luckysheet_select_save[x];if(_.row!=null&&s>=_.row[0]&&s<=_.row[1]&&_.column[0]==0&&_.column[1]==h.flowdata[0].length-1){p=!0;break}}if(p)return}let d=a,g=o-a-1,b=[s,s];h.luckysheet_scroll_status=!0;let y=$("#luckysheet-input-box");if(parseInt(y.css("top"))>0)if(v.rangestart||v.rangedrag_column_start||v.rangedrag_row_start||v.israngeseleciton()||$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let p=ht.mergeMoveMain([0,u],b,{row_focus:s,column_focus:0},d,g,m,f);if(p!=null&&(b=p[1],d=p[2],g=p[3]),e.shiftKey){let x=v.func_selectedrange,_=0,S=0,I=[];x.top>a?(_=a,S=x.top+x.height-a,x.row[1]>x.row_focus&&(x.row[1]=x.row_focus),I=[s,x.row[1]]):x.top==a?(_=a,S=x.top+x.height-a,I=[s,x.row[0]]):(_=x.top,S=o-x.top-1,x.row[0]<x.row_focus&&(x.row[0]=x.row_focus),I=[x.row[0],s]);let O=ht.mergeMoveMain([0,u],I,{row_focus:s,column_focus:0},_,S,m,f);O!=null&&(I=O[1],_=O[2],S=O[3]),x.row=I,x.top_move=_,x.height_move=S,v.func_selectedrange=x}else if(e.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){let x=$("#luckysheet-rich-text-editor").text()+",";if(x.length>0&&x.substr(0,1)=="="){if(x=v.functionHTMLGenerate(x),window.getSelection){let _=window.getSelection();v.functionRangeIndex=[$(_.anchorNode).parent().index(),_.anchorOffset]}else{let _=document.selection.createRange();v.functionRangeIndex=_}$("#luckysheet-rich-text-editor").html(x),v.canceFunctionrangeSelected(),v.createRangeHightlight()}v.rangestart=!1,v.rangedrag_column_start=!1,v.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(x),v.rangeHightlightselected($("#luckysheet-rich-text-editor")),v.israngeseleciton(),v.func_selectedrange={left:Vl(0)[0],width:Vl(0)[1]-Vl(0)[0]-1,top:d,height:g,left_move:m,width_move:f-m-1,top_move:d,height_move:g,row:b,column:[0,u],row_focus:s,column_focus:0}}else v.func_selectedrange={left:Vl(0)[0],width:Vl(0)[1]-Vl(0)[0]-1,top:d,height:g,left_move:m,width_move:f-m-1,top_move:d,height_move:g,row:b,column:[0,u],row_focus:s,column_focus:0};if(v.rangestart||v.rangedrag_column_start||v.rangedrag_row_start||v.israngeseleciton())v.rangeSetValue({row:b,column:[null,null]});else if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let x=Al(h.currentSheetIndex,{row:b,column:[0,u]},h.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(x)}v.rangedrag_row_start=!0,v.rangestart=!1,v.rangedrag_column_start=!1,$("#luckysheet-formula-functionrange-select").css({left:m,width:f-m-1,top:d,height:g}).show(),$("#luckysheet-formula-help-c").hide(),Ti(m,d,f-m-1,g,b,[0,u]),setTimeout(function(){let _=window.getSelection().anchorNode,S;$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")?(S=$("#luckysheet-rich-text-editor"),v.rangechangeindex=v.data_parm_index):S=$(_).closest("div");let I=S.find("span[rangeindex='"+v.rangechangeindex+"']");v.setCaretPosition(I.get(0),0,I.html().length)},1);return}else v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_rows_selected_status=!0;else h.luckysheet_rows_selected_status=!0;if(h.luckysheet_rows_selected_status){if(e.shiftKey){let p=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),x=0,_=0,S=[];p.top>a?(x=a,_=p.top+p.height-a,p.row[1]>p.row_focus&&(p.row[1]=p.row_focus),S=[s,p.row[1]]):p.top==a?(x=a,_=p.top+p.height-a,S=[s,p.row[0]]):(x=p.top,_=o-p.top-1,p.row[0]<p.row_focus&&(p.row[0]=p.row_focus),S=[p.row[0],s]),p.row=S,p.top_move=x,p.height_move=_,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=p}else e.ctrlKey?h.luckysheet_select_save.push({left:Vl(0)[0],width:Vl(0)[1]-Vl(0)[0]-1,top:d,height:g,left_move:m,width_move:f-m-1,top_move:d,height_move:g,row:b,column:[0,u],row_focus:s,column_focus:0,row_select:!0}):(h.luckysheet_select_save.length=0,h.luckysheet_select_save.push({left:Vl(0)[0],width:Vl(0)[1]-Vl(0)[0]-1,top:d,height:g,left_move:m,width_move:f-m-1,top_move:d,height_move:g,row:b,column:[0,u],row_focus:s,column_focus:0,row_select:!0}));Zt(),He.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save)}Nh(),setTimeout(function(){clearTimeout(h.countfuncTimeout),mn()},101)}).mousemove(function(e){if(h.luckysheet_rows_selected_status||h.luckysheet_rows_change_size||h.luckysheet_select_status){$("#luckysheet-rows-h-hover").hide();return}let t=ll(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=zl(t),o=l[1],a=l[0],s=l[2];$("#luckysheet-rows-h-hover").css({top:a,height:o-a-1,display:"block"}),t<o-1&&t>=o-5?$("#luckysheet-rows-change-size").css({top:o-3,opacity:0}):$("#luckysheet-rows-change-size").css("opacity",0)}).mouseleave(function(e){$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-rows-change-size").css("opacity",0)}).mouseup(function(e){if(e.which==3){if(!Un()||Qe())return;$("#luckysheet-cols-rows-shift").hide(),h.luckysheetRightHeadClickIs="row",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Oe().rightclick.row),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Oe().rightclick.height),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Oe().rightclick.top),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Oe().rightclick.bottom),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block";let n=lt.cellRightClickConfig;if(!n.copy&&!n.copyAs&&!n.paste&&!n.insertRow&&!n.deleteRow&&!n.hideRow&&!n.rowHeight&&!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat)return;jt("#luckysheet-top-left-add-selected").style.display=n.insertRow?"block":"none",jt("#luckysheet-bottom-right-add-selected").style.display=n.insertRow?"block":"none",jt("#luckysheet-del-selected").style.display=n.deleteRow?"block":"none",jt("#luckysheet-hide-selected").style.display=n.hideRow?"block":"none",jt("#luckysheet-show-selected").style.display=n.hideRow?"block":"none",jt("#luckysheet-column-row-width-selected").style.display=n.rowHeight?"block":"none",!n.copy&&!n.copyAs&&!n.paste&&(jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!n.insertRow&&!n.deleteRow&&!n.hideRow&&!n.rowHeight&&(jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!n.insertRow&&!n.deleteRow&&!n.hideRow&&!n.rowHeight&&(jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat&&(jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),ea($("#luckysheet-rightclick-menu"),$(this).offset().left+46,e.pageY),h.luckysheet_cols_menu_status=!0;let t=$.extend(!0,{},h.config);t.rowlen==null&&(t.rowlen={});let l=t.rowlen[h.luckysheet_select_save[0].row[0]]==null?h.defaultrowlen:t.rowlen[h.luckysheet_select_save[0].row[0]],o=!0;for(let a=0;a<h.luckysheet_select_save.length;a++){let s=h.luckysheet_select_save[a],u=s.row[0],f=s.row[1];for(let m=u;m<=f;m++)if((t.rowlen[m]==null?h.defaultrowlen:t.rowlen[m])!=l){o=!1;break}}o?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(l):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}}),$("#luckysheet-cols-h-c").mousedown(function(e){if(!Eu(h.currentSheetIndex))return;Nt.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&$t.cancelActiveImgItem();let t=ll(e.pageX,e.pageY)[0]+$(this).scrollLeft(),l=h.visibledatarow.length-1,o=h.visibledatarow[l],a=0,s=Ml(t),u=s[1],f=s[0],m=s[2];if(h.orderbyindex=m,$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),e.which=="3"){let p=!1;for(let x=0;x<h.luckysheet_select_save.length;x++){let _=h.luckysheet_select_save[x];if(_.column!=null&&m>=_.column[0]&&m<=_.column[1]&&_.row[0]==0&&_.row[1]==h.flowdata.length-1){p=!0;break}}if(p)return}let d=f,g=u-f-1,b=[m,m];h.luckysheet_scroll_status=!0;let y=$("#luckysheet-input-box");if(parseInt(y.css("top"))>0)if(v.rangestart||v.rangedrag_column_start||v.rangedrag_row_start||v.israngeseleciton()||$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let p=ht.mergeMoveMain(b,[0,l],{row_focus:0,column_focus:m},a,o,d,g);if(p!=null&&(b=p[0],d=p[4],g=p[5]),e.shiftKey){let x=v.func_selectedrange,_=0,S=0,I=[];x.left>f?(_=f,S=x.left+x.width-f,x.column[1]>x.column_focus&&(x.column[1]=x.column_focus),I=[m,x.column[1]]):x.left==f?(_=f,S=x.left+x.width-f,I=[m,x.column[0]]):(_=x.left,S=u-x.left-1,x.column[0]<x.column_focus&&(x.column[0]=x.column_focus),I=[x.column[0],m]);let O=ht.mergeMoveMain(I,[0,l],{row_focus:0,column_focus:m},a,o,_,S);O!=null&&(I=O[0],_=O[4],S=O[5]),x.column=I,x.left_move=_,x.width_move=S,v.func_selectedrange=x}else if(e.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){let x=$("#luckysheet-rich-text-editor").text()+",";if(x.length>0&&x.substr(0,1)=="="){if(x=v.functionHTMLGenerate(x),window.getSelection){let _=window.getSelection();v.functionRangeIndex=[$(_.anchorNode).parent().index(),_.anchorOffset]}else{let _=document.selection.createRange();v.functionRangeIndex=_}$("#luckysheet-rich-text-editor").html(x),v.canceFunctionrangeSelected(),v.createRangeHightlight()}v.rangestart=!1,v.rangedrag_column_start=!1,v.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(x),v.rangeHightlightselected($("#luckysheet-rich-text-editor")),v.israngeseleciton(),v.func_selectedrange={left:d,width:g,top:$r(0)[0],height:$r(0)[1]-$r(0)[0]-1,left_move:d,width_move:g,top_move:a,height_move:o-a-1,row:[0,l],column:b,row_focus:0,column_focus:m}}else v.func_selectedrange={left:d,width:g,top:$r(0)[0],height:$r(0)[1]-$r(0)[0]-1,left_move:d,width_move:g,top_move:a,height_move:o-a-1,row:[0,l],column:b,row_focus:0,column_focus:m};if(v.rangestart||v.rangedrag_column_start||v.rangedrag_row_start||v.israngeseleciton())v.rangeSetValue({row:[null,null],column:b});else if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let x=Al(h.currentSheetIndex,{row:[0,l],column:b},h.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(x)}v.rangedrag_column_start=!0,v.rangestart=!1,v.rangedrag_row_start=!1,$("#luckysheet-formula-functionrange-select").css({left:d,width:g,top:a,height:o-a-1}).show(),$("#luckysheet-formula-help-c").hide(),Ti(d,a,g,o-a-1,[0,l],b);return}else v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_cols_selected_status=!0;else h.luckysheet_cols_selected_status=!0;if(h.luckysheet_cols_selected_status){if(e.shiftKey){let p=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),x=0,_=0,S=[];p.left>f?(x=f,_=p.left+p.width-f,p.column[1]>p.column_focus&&(p.column[1]=p.column_focus),S=[m,p.column[1]]):p.left==f?(x=f,_=p.left+p.width-f,S=[m,p.column[0]]):(x=p.left,_=u-p.left-1,p.column[0]<p.column_focus&&(p.column[0]=p.column_focus),S=[p.column[0],m]),p.column=S,p.left_move=x,p.width_move=_,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=p}else e.ctrlKey?h.luckysheet_select_save.push({left:d,width:g,top:$r(0)[0],height:$r(0)[1]-$r(0)[0]-1,left_move:d,width_move:g,top_move:a,height_move:o-a-1,row:[0,l],column:b,row_focus:0,column_focus:m,column_select:!0}):(h.luckysheet_select_save.length=0,h.luckysheet_select_save.push({left:d,width:g,top:$r(0)[0],height:$r(0)[1]-$r(0)[0]-1,left_move:d,width_move:g,top_move:a,height_move:o-a-1,row:[0,l],column:b,row_focus:0,column_focus:m,column_select:!0}));Zt(),He.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save)}Nh(),setTimeout(function(){clearTimeout(h.countfuncTimeout),mn()},101),h.luckysheet_cols_menu_status&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),h.luckysheet_cols_menu_status=!1),e.stopPropagation()}).mousemove(function(e){if(h.luckysheet_cols_selected_status||h.luckysheet_select_status){$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide();return}if(h.luckysheet_cols_menu_status||h.luckysheet_cols_change_size)return;let t=ll(e.pageX,e.pageY)[0]+$("#luckysheet-cols-h-c").scrollLeft(),l=Ml(t),o=l[1],a=l[0],s=l[2];$("#luckysheet-cols-h-hover").css({left:a,width:o-a-1,display:"block"}),$("#luckysheet-cols-menu-btn").css({left:o-19,display:"block"}),$("#luckysheet-cols-change-size").css({left:o-5}),t<o&&t>=o-5?($("#luckysheet-cols-change-size").css({opacity:0}),$("#luckysheet-cols-menu-btn").hide()):($("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0))}).mouseleave(function(e){h.luckysheet_cols_menu_status||h.luckysheet_cols_change_size||($("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-cols-change-size").css("opacity",0))}).mouseup(function(e){if(e.which==3){if(!Un()||Qe())return;h.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Oe().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Oe().rightclick.width),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Oe().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Oe().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block";let n=lt.cellRightClickConfig;if(!n.copy&&!n.copyAs&&!n.paste&&!n.insertColumn&&!n.deleteColumn&&!n.hideColumn&&!n.columnWidth&&!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat)return;jt("#luckysheet-top-left-add-selected").style.display=n.insertColumn?"block":"none",jt("#luckysheet-bottom-right-add-selected").style.display=n.insertColumn?"block":"none",jt("#luckysheet-del-selected").style.display=n.deleteColumn?"block":"none",jt("#luckysheet-hide-selected").style.display=n.hideColumn?"block":"none",jt("#luckysheet-show-selected").style.display=n.hideColumn?"block":"none",jt("#luckysheet-column-row-width-selected").style.display=n.columnWidth?"block":"none",!n.copy&&!n.copyAs&&!n.paste&&(jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!n.insertColumn&&!n.deleteColumn&&!n.hideColumn&&!n.columnWidth&&(jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!n.insertColumn&&!n.deleteColumn&&!n.hideColumn&&!n.columnWidth&&(jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat&&(jt("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),ea($("#luckysheet-rightclick-menu"),e.pageX,$(this).offset().top+18),h.luckysheet_cols_menu_status=!0;let t=$.extend(!0,{},h.config);t.columnlen==null&&(t.columnlen={});let l=t.columnlen[h.luckysheet_select_save[0].column[0]]==null?h.defaultcollen:t.columnlen[h.luckysheet_select_save[0].column[0]],o=!0;for(let a=0;a<h.luckysheet_select_save.length;a++){let s=h.luckysheet_select_save[a],u=s.column[0],f=s.column[1];for(let m=u;m<=f;m++)if((t.columnlen[m]==null?h.defaultcollen:t.columnlen[m])!=l){o=!1;break}}o?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(l):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}}),$("#luckysheet-rows-change-size").mousedown(function(e){if(!Un())return;Nt.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&$t.cancelActiveImgItem(),$("#luckysheet-input-box").hide(),$("#luckysheet-rows-change-size").css({opacity:1});let t=ll(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").width(),a=zl(t),s=a[1],u=a[0],f=a[2];h.luckysheet_rows_change_size=!0,h.luckysheet_scroll_status=!0,$("#luckysheet-change-size-line").css({height:"1px","border-width":"0 0px 1px 0",top:s-3,left:0,width:l+o,display:"block",cursor:"ns-resize"}),$("#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas").css("cursor","ns-resize"),h.luckysheet_rows_change_size_start=[u,f],$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),e.stopPropagation()}),$("#luckysheet-cols-change-size").mousedown(function(e){if(!Un())return;Nt.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&$t.cancelActiveImgItem(),$("#luckysheet-input-box").hide(),$("#luckysheet-cols-change-size").css({opacity:1});let n=ll(e.pageX,e.pageY),t=$("#luckysheet-cols-h-c").scrollLeft(),l=$("#luckysheet-cell-main").scrollTop(),o=$("#luckysheet-cell-main").height(),a=n[0]+t,s=h.visibledatarow.length-1,u=h.visibledatarow[s],f=0,m=Ml(a),d=m[1],g=m[0],b=m[2];h.luckysheet_cols_change_size=!0,h.luckysheet_scroll_status=!0,$("#luckysheet-change-size-line").css({height:o+l,"border-width":"0 1px 0 0",top:0,left:d-3,width:"1px",display:"block",cursor:"ew-resize"}),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","ew-resize"),h.luckysheet_cols_change_size_start=[g,b],$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),h.luckysheet_cols_dbclick_times=0,e.stopPropagation()}).dblclick(function(){g_()}),$("#luckysheet-cols-menu-btn").click(function(e){if(!Un()){de.info("",Oe().pivotTable.errorNotAllowEdit);return}let n=$("#luckysheet-rightclick-menu"),t=$(this).offset();$("#luckysheet-cols-rows-shift").show(),h.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Oe().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Oe().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Oe().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").hide(),$("#luckysheet-cols-rows-shift").show(),$("#luckysheet-cols-rows-handleincell").hide(),jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",jt("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="block";let l=lt.cellRightClickConfig;!l.copy&&!l.copyAs&&!l.paste&&!l.insertColumn&&!l.deleteColumn&&!l.hideColumn&&!l.columnWidth&&!l.sort||(jt("#luckysheet-top-left-add-selected").style.display=l.insertColumn?"block":"none",jt("#luckysheet-bottom-right-add-selected").style.display=l.insertColumn?"block":"none",jt("#luckysheet-del-selected").style.display=l.deleteColumn?"block":"none",jt("#luckysheet-hide-selected").style.display=l.hideColumn?"block":"none",jt("#luckysheet-show-selected").style.display=l.hideColumn?"block":"none",jt("#luckysheet-column-row-width-selected").style.display=l.columnWidth?"block":"none",!l.copy&&!l.copyAs&&!l.paste&&(jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!l.insertColumn&&!l.deleteColumn&&!l.hideColumn&&!l.columnWidth&&(jt("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="none")),!l.insertColumn&&!l.deleteColumn&&!l.hideColumn&&!l.columnWidth&&(jt("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),l.sort||(jt("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="none"),ea(n,t.left,t.top+18),h.luckysheet_cols_menu_status=!0)}),$("#luckysheet-top-left-add-selected").click(function(e){if(e.target.nodeName==="INPUT")return;$("#luckysheet-rightclick-menu").hide(),el();let n=Oe(),t=n.drag,l=n.info;if(h.luckysheet_select_save.length>1){Qe()?alert(t.noMulti):de.info(t.noMulti,"");return}let o=$(this),a=o.find("input").val();if(!Y(a)){Qe()?alert(l.tipInputNumber):de.info(l.tipInputNumber,"");return}if(a=parseInt(a),a<1||a>100){Qe()?alert(l.tipInputNumberLimit):de.info(l.tipInputNumberLimit,"");return}let s=h.luckysheet_select_save[0][h.luckysheetRightHeadClickIs][0];!Yt.createHookFunction("rowInsertBefore",s,a,"lefttop")||oo(h.luckysheetRightHeadClickIs,s,a,"lefttop")}),$("#luckysheetColsRowsHandleAdd_row").click(function(e){if($("#luckysheet-rightclick-menu").hide(),el(),h.allowEdit===!1)return;let n=h.luckysheet_select_save[0].row[0];!Yt.createHookFunction("rowInsertBefore",n,1,"lefttop")||oo("row",n,1,"lefttop")}),$("#luckysheetColsRowsHandleAdd_column").click(function(e){if($("#luckysheet-rightclick-menu").hide(),el(),h.allowEdit===!1)return;let n=h.luckysheet_select_save[0].column[0];oo("column",n,1,"lefttop")}),$(".luckysheetColsRowsHandleAdd_custom").click(function(e){$("#luckysheet-rightclick-menu").hide();let n=lt.cellRightClickConfig,t=h.luckysheet_select_save[0].row[0],l=h.luckysheet_select_save[0].column[0];if(n.customs[Number(e.currentTarget.dataset.index)])try{n.customs[Number(e.currentTarget.dataset.index)].onClick(e,event,{rowIndex:t,columnIndex:l})}catch(o){console.error("custom click error",o)}}),$("#luckysheet-bottom-right-add-selected").click(function(e){if(e.target.nodeName==="INPUT")return;$("#luckysheet-rightclick-menu").hide(),el();let n=Oe(),t=n.drag,l=n.info;if(h.luckysheet_select_save.length>1){Qe()?alert(t.noMulti):de.info(t.noMulti,"");return}let o=$(this),a=o.find("input").val();if(!Y(a)){Qe()?alert(l.tipInputNumber):de.info(l.tipInputNumber,"");return}if(a=parseInt(a),a<1||a>100){Qe()?alert(l.tipInputNumberLimit):de.info(l.tipInputNumberLimit,"");return}let s=h.luckysheet_select_save[0][h.luckysheetRightHeadClickIs][1];!Yt.createHookFunction("rowInsertBefore",s,a,"rightbottom")||oo(h.luckysheetRightHeadClickIs,s,a,"rightbottom")}),$("#luckysheet-del-selected, #luckysheet-del-selected_t").click(function(e){$("#luckysheet-rightclick-menu").hide(),el();let n=Oe().drag;if(h.luckysheet_select_save.length>1){h.luckysheetRightHeadClickIs=="row"?Qe()?alert(n.noMulti):de.info(n.noMulti,""):h.luckysheetRightHeadClickIs=="column"&&(Qe()?alert(n.noMulti):de.info(n.noMulti,""));return}let t=h.luckysheet_select_save[0][h.luckysheetRightHeadClickIs][0],l=h.luckysheet_select_save[0][h.luckysheetRightHeadClickIs][1];!Yt.createHookFunction("rowDeleteBefore",t,l)||Za(h.luckysheetRightHeadClickIs,t,l)}),$("#luckysheet-delRows").click(function(e){$("#luckysheet-rightclick-menu").hide(),el();let n=Oe().drag;if(h.luckysheet_select_save.length>1){h.luckysheetRightHeadClickIs=="row"?Qe()?alert(n.noMulti):de.info(n.noMulti,""):h.luckysheetRightHeadClickIs=="column"&&(Qe()?alert(n.noMulti):de.info(n.noMulti,""));return}let t=h.luckysheet_select_save[0].row[0],l=h.luckysheet_select_save[0].row[1];!Yt.createHookFunction("rowDeleteBefore",t,l)||Za("row",t,l)}),$("#luckysheet-delCols").click(function(e){$("#luckysheet-rightclick-menu").hide(),el();let n=Oe().drag;if(h.luckysheet_select_save.length>1){h.luckysheetRightHeadClickIs=="row"?Qe()?alert(n.noMulti):de.info(n.noMulti,""):h.luckysheetRightHeadClickIs=="column"&&(Qe()?alert(n.noMulti):de.info(n.noMulti,""));return}let t=h.luckysheet_select_save[0].column[0],l=h.luckysheet_select_save[0].column[1];Za("column",t,l)}),$("#luckysheet-hide-selected").click(function(e){$("#luckysheet-rightclick-menu").hide(),el();let n=Oe().drag;if(h.luckysheet_select_save.length>1){h.luckysheetRightHeadClickIs=="row"?Qe()?alert(n.noMulti):de.info(n.noMulti,""):h.luckysheetRightHeadClickIs=="column"&&(Qe()?alert(n.noMulti):de.info(n.noMulti,""));return}if(h.luckysheetRightHeadClickIs=="row"){if(!Hl(h.currentSheetIndex,"formatRows"))return;let t=$.extend(!0,{},h.config);t.rowhidden==null&&(t.rowhidden={});for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].row[0],a=h.luckysheet_select_save[l].row[1];for(let s=o;s<=a;s++)t.rowhidden[s]=0}if(h.clearjfundo){let l={};l.type="showHidRows",l.sheetIndex=h.currentSheetIndex,l.config=$.extend(!0,{},h.config),l.curconfig=t,h.jfundo.length=0,h.jfredo.push(l)}h.config=t,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,t.rowhidden,{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length)}else if(h.luckysheetRightHeadClickIs=="column"){if(!Hl(h.currentSheetIndex,"formatColumns"))return;let t=$.extend(!0,{},h.config);t.colhidden==null&&(t.colhidden={});for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].column[0],a=h.luckysheet_select_save[l].column[1];for(let s=o;s<=a;s++)t.colhidden[s]=0}if(h.clearjfundo){let l={};l.type="showHidCols",l.sheetIndex=h.currentSheetIndex,l.config=$.extend(!0,{},h.config),l.curconfig=t,h.jfundo.length=0,h.jfredo.push(l)}h.config=t,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,t.colhidden,{k:"colhidden"}),Nl(h.flowdata.length,h.flowdata[0].length)}}),$("#luckysheet-show-selected").click(function(e){$("#luckysheet-rightclick-menu").hide(),el();let n=Oe().drag;if(h.luckysheet_select_save.length>1){h.luckysheetRightHeadClickIs=="row"?Qe()?alert(n.noMulti):de.info(n.noMulti,""):h.luckysheetRightHeadClickIs=="column"&&(Qe()?alert(n.noMulti):de.info(n.noMulti,""));return}if(h.luckysheetRightHeadClickIs=="row"){if(!Hl(h.currentSheetIndex,"formatRows"))return;let t=$.extend(!0,{},h.config);if(t.rowhidden==null)return;for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].row[0],a=h.luckysheet_select_save[l].row[1];for(let s=o;s<=a;s++)delete t.rowhidden[s]}if(h.clearjfundo){let l={};l.type="showHidRows",l.sheetIndex=h.currentSheetIndex,l.config=$.extend(!0,{},h.config),l.curconfig=t,h.jfundo.length=0,h.jfredo.push(l)}h.config=t,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,t.rowhidden,{k:"rowhidden"}),Nl(h.flowdata.length,h.flowdata[0].length)}else if(h.luckysheetRightHeadClickIs=="column"){if(!Hl(h.currentSheetIndex,"formatColumns"))return;let t=$.extend(!0,{},h.config);if(t.colhidden==null)return;for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].column[0],a=h.luckysheet_select_save[l].column[1];for(let s=o;s<=a;s++)delete t.colhidden[s]}if(h.clearjfundo){let l={};l.type="showHidCols",l.sheetIndex=h.currentSheetIndex,l.config=$.extend(!0,{},h.config),l.curconfig=t,h.jfundo.length=0,h.jfredo.push(l)}h.config=t,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,He.saveParam("cg",h.currentSheetIndex,t.colhidden,{k:"colhidden"}),Nl(h.flowdata.length,h.flowdata[0].length)}}),$("#luckysheet-delCellsMoveLeft").click(function(e){$("body .luckysheet-cols-menu").hide(),el();let n=Oe().drag;if(h.luckysheet_select_save.length>1){Qe()?alert(n.noMulti):de.info(n.noMulti,"");return}let t=h.luckysheet_select_save[0].row[0],l=h.luckysheet_select_save[0].row[1],o=h.luckysheet_select_save[0].column[0],a=h.luckysheet_select_save[0].column[1];Fs("moveLeft",t,l,o,a)}),$("#luckysheet-delCellsMoveUp").click(function(e){$("body .luckysheet-cols-menu").hide(),el();let n=Oe().drag;if(h.luckysheet_select_save.length>1){Qe()?alert(n.noMulti):de.info(n.noMulti,"");return}let t=h.luckysheet_select_save[0].row[0],l=h.luckysheet_select_save[0].row[1],o=h.luckysheet_select_save[0].column[0],a=h.luckysheet_select_save[0].column[1];Fs("moveUp",t,l,o,a)}),$("#luckysheet-delete-text").click(function(){if(!!Wi(h.luckysheet_select_save,h.currentSheetIndex)&&($("#luckysheet-rightclick-menu").hide(),el(),h.allowEdit!==!1&&h.luckysheet_select_save.length>0)){let e=pt.deepCopyFlowData(h.flowdata),n=!1;for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].row[0],a=h.luckysheet_select_save[l].row[1],s=h.luckysheet_select_save[l].column[0],u=h.luckysheet_select_save[l].column[1];if(Ul(h.config,o,a,s,u)){n=!0;break}}if(n){let l=Oe().drag;Qe()?alert(l.noPartMerge):de.info(l.noPartMerge,"");return}let t=h.luckysheetfile[$e(h.currentSheetIndex)].hyperlink;for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].row[0],a=h.luckysheet_select_save[l].row[1],s=h.luckysheet_select_save[l].column[0],u=h.luckysheet_select_save[l].column[1];for(let f=o;f<=a;f++)for(let m=s;m<=u;m++)Pt.isPivotRange(f,m)||(V(e[f][m])=="object"?(delete e[f][m].m,delete e[f][m].v,e[f][m].f!=null&&(delete e[f][m].f,v.delFunctionGroup(f,m,h.currentSheetIndex),delete e[f][m].spl),e[f][m].ct!=null&&e[f][m].ct.t=="inlineStr"&&delete e[f][m].ct):e[f][m]=null,t&&t[`${f}_${m}`]&&delete t[`${f}_${m}`])}Gt(e,h.luckysheet_select_save),$("#luckysheet-rich-text-editor").html("")}}),$("#luckysheet-column-row-width-selected").click(function(e){if(e.target.nodeName==="INPUT")return;$("#luckysheet-rightclick-menu").hide(),el();let n=parseInt($(this).closest(".luckysheet-cols-menuitem").find("input[type='number']").val().trim()),t=Oe().info;if(isNaN(n)){de.info("\u53EA\u5141\u8BB8\u4F7F\u7528\u6570\u5B57\u6765\u8BBE\u7F6E\u884C\u5217\u7684\u5BBD\u9AD8!","");return}let l=$.extend(!0,{},h.config),o,a=null;if(h.luckysheetRightHeadClickIs=="row"){if(!Hl(h.currentSheetIndex,"formatRows"))return;if(n<0||n>545){Qe()?alert(t.tipRowHeightLimit):de.info(t.tipRowHeightLimit,"");return}o="resizeR",l.rowlen==null&&(l.rowlen={});for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].row[0],f=h.luckysheet_select_save[s].row[1];for(let m=u;m<=f;m++)l.rowlen[m]=n,a=$t.moveChangeSize("row",m,n)}}else if(h.luckysheetRightHeadClickIs=="column"){if(!Hl(h.currentSheetIndex,"formatColumns"))return;if(n<0||n>2038){Qe()?alert(t.tipColumnWidthLimit):de.info(t.tipColumnWidthLimit,"");return}o="resizeC",l.columnlen==null&&(l.columnlen={});for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].column[0],f=h.luckysheet_select_save[s].column[1];for(let m=u;m<=f;m++)l.columnlen[m]=n,a=$t.moveChangeSize("column",m,n)}}h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"resize",ctrlType:o,sheetIndex:h.currentSheetIndex,config:$.extend(!0,{},h.config),curconfig:$.extend(!0,{},l),images:$.extend(!0,{},$t.images),curImages:$.extend(!0,{},a)})),h.config=l,h.luckysheetfile[$e(h.currentSheetIndex)].config=h.config,h.luckysheetfile[$e(h.currentSheetIndex)].images=a,He.saveParam("all",h.currentSheetIndex,a,{k:"images"}),$t.images=a,$t.allImagesShow(),h.luckysheetRightHeadClickIs=="row"?(He.saveParam("cg",h.currentSheetIndex,l.rowlen,{k:"rowlen"}),Nl(h.flowdata.length,null)):h.luckysheetRightHeadClickIs=="column"&&(He.saveParam("cg",h.currentSheetIndex,l.columnlen,{k:"columnlen"}),Nl(null,h.flowdata[0].length))})}function g_(){h.luckysheet_cols_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","default");let e=ll(event.pageX,event.pageY),n=$("#luckysheet-cols-h-c").scrollLeft(),t=e[0]+n,l=Ml(t)[2],o=pt.deepCopyFlowData(h.flowdata),a=$("#luckysheetTableContent").get(0).getContext("2d"),s=$.extend(!0,{},h.config);s.columnlen==null&&(s.columnlen={});let u={},f=$("#luckysheet-cell-main").scrollTop(),m=h.luckysheetTableContentHW[1],d=al(h.visibledatarow,f),g=al(h.visibledatarow,f+m);g+=g-d,g>=o.length&&(g=o.length-1);for(let b=0;b<h.luckysheet_select_save.length;b++){let y=h.luckysheet_select_save[b].column[0],p=h.luckysheet_select_save[b].column[1];if(l<y||l>p){if(l in u)continue;let x=h.defaultcollen;for(let _=d;_<=g;_++){let S=o[_][l];if(S==null||rt(S.v)&&!wn(S))continue;let I=Vl(l)[1]-Vl(l)[0]-2,O=no(S,a,{r:_,c:l,cellWidth:I}),F=0;O!=null&&(F=O.textWidthAll),F+6>x&&(x=F+6)}x!=h.defaultcollen&&(s.columnlen[l]=x,s.customWidth&&delete s.customWidth[l]),u[l]=1}else for(let x=y;x<=p;x++){if(x in u)continue;let _=h.defaultcollen;for(let S=d;S<=g;S++){let I=o[S][x];if(I==null||rt(I.v)&&!wn(I))continue;let O=Vl(x)[1]-Vl(x)[0]-2,F=no(I,a,{r:S,c:x,cellWidth:O}),D=0;F!=null&&(D=F.textWidthAll),D+6>_&&(_=D+6)}_!=h.defaultcollen&&(s.columnlen[x]=_,s.customWidth&&delete s.customWidth[x]),u[x]=1}}fi(h.flowdata[0].length,h.flowdata.length,h.flowdata,s,h.luckysheet_select_save,"resizeC","columnlen")}var import_plugin,uk=Tt(()=>{import_plugin=Le(Be());Qo();Fo();To();Mr();wr();qn();vr();gl();ql();Qn();Gl();xc();ir();Ms();fr();mr();Sr();br();Rl();Hi();xo();va();jn();Ut();bn()});function Vh(e,n,t,l){if($("#luckysheet-formula-search-c").is(":visible")&&(e=="up"||e=="down")){let o;e=="down"?(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").next(),o.length==0&&(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").first())):e=="up"&&(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").prev(),o.length==0&&(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").last())),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),o.addClass("luckysheet-formula-search-item-active"),l.preventDefault()}else if($("#luckysheet-formula-functionrange-select").is(":visible")){if(n&&t)Jo(e,"rangeOfFormula");else if(n)Ts(e,"rangeOfFormula");else if(t){let o=e,a=1;e=="up"&&(o="down",a=-1),e=="left"&&(o="right",a=-1),Ya(o,a,"rangeOfFormula")}else{let o=e,a=1;e=="up"&&(o="down",a=-1),e=="left"&&(o="right",a=-1),lr(o,a,"rangeOfFormula")}l.preventDefault()}else if(v.israngeseleciton()){let o=$(window.getSelection().anchorNode);if(o.parent().next().text()==null||o.parent().next().text()==""){let a=$("#luckysheet-input-box #luckysheet-input-box-index").text(),s=v.getcellrange(a);s==null&&(s=v.getcellrange($("#luckysheet-input-box-index").text()));let u=s.row[0],f=s.row[1],m=s.column[0],d=s.column[1],g=h.visibledatarow[f],b=u-1==-1?0:h.visibledatarow[u-1],y=h.visibledatacolumn[d],p=m-1==-1?0:h.visibledatacolumn[m-1];if(v.func_selectedrange={left:p,width:y-p-1,top:b,height:g-b-1,left_move:p,width_move:y-p-1,top_move:b,height_move:g-b-1,row:[u,f],column:[m,d],row_focus:u,column_focus:m},v.rangeSetValue({row:[u,f],column:[m,d]}),v.rangestart=!0,v.rangedrag_column_start=!1,v.rangedrag_row_start=!1,n&&t)Jo(e,"rangeOfFormula");else if(n)Ts(e,"rangeOfFormula");else if(t){let x=e,_=1;e=="up"&&(x="down",_=-1),e=="left"&&(x="right",_=-1),Ya(x,_,"rangeOfFormula")}else{let x=e,_=1;e=="up"&&(x="down",_=-1),e=="left"&&(x="right",_=-1),lr(x,_,"rangeOfFormula")}l.preventDefault()}}else if(!n&&!t){let o=$(window.getSelection().anchorNode),a=window.getSelection().anchorOffset;e=="up"?o.parent().is("span")&&o.parent().next().length==0&&a>0?(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("down",-1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&o.context.childElementCount==a?(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("down",-1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&o.context.length==a&&(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("down",-1,"rangeOfSelect"),l.preventDefault()):e=="down"?o.parent().is("span")&&o.parent().next().length==0&&a>0?(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("down",1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&o.context.childElementCount==a?(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("down",1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&o.context.length==a&&(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("down",1,"rangeOfSelect"),l.preventDefault()):e=="left"?o.parent().is("span")&&o.parent().prev().length==0&&a==0?(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("right",-1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&a==1?(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("right",-1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&a==0?(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("right",-1,"rangeOfSelect"),l.preventDefault()):v.rangeHightlightselected($("#luckysheet-rich-text-editor")):e=="right"&&(o.parent().is("span")&&o.parent().next().length==0&&a>0?(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("right",1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&o.context.childElementCount==a?(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("right",1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&o.context.length==a?(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("right",1,"rangeOfSelect"),l.preventDefault()):v.rangeHightlightselected($("#luckysheet-rich-text-editor")))}}function hk(){let n=Oe().drag;$("#luckysheet-input-box").click(function(){v.rangeHightlightselected($("#luckysheet-rich-text-editor"))}).add("#"+h.container).on("keydown",function(t){let l=t.ctrlKey,o=t.altKey,a=t.shiftKey,s=t.keyCode;if($("#luckysheet-modal-dialog-mask").is(":visible")||$(t.target).hasClass("luckysheet-mousedown-cancel")||$(t.target).hasClass("sp-input")||parseInt($("#luckysheet-input-box").css("top"))>0&&$(t.target).closest(".luckysheet-input-box").length>0&&s!=rl.ENTER&&s!=rl.TAB&&s!=rl.UP&&s!=rl.DOWN&&s!=rl.LEFT&&s!=rl.RIGHT){let f=$(window.getSelection().anchorNode);if((f.parent().is("#luckysheet-helpbox-cell")||f.is("#luckysheet-helpbox-cell"))&&s==rl.ENTER){let m=$("#luckysheet-helpbox-cell").text();if(v.iscelldata(m)){let d=v.getcellrange(m);h.luckysheet_select_save=[{row:d.row,column:d.column,row_focus:d.row[0],column_focus:d.column[0]}],Zt(),$("#luckysheet-helpbox-cell").blur();let g=$("#luckysheet-cell-main").scrollLeft(),b=$("#luckysheet-cell-main").scrollTop(),y=$("#luckysheet-cell-main").height(),p=$("#luckysheet-cell-main").width(),x=h.visibledatarow[d.row[1]],_=d.row[0]-1==-1?0:h.visibledatarow[d.row[0]-1],S=h.visibledatacolumn[d.column[1]],I=d.column[0]-1==-1?0:h.visibledatacolumn[d.column[0]-1];S-g-p+20>0?$("#luckysheet-scrollbar-x").scrollLeft(S-p+20):I-g-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(I-20),x-b-y+20>0?$("#luckysheet-scrollbar-y").scrollTop(x-y+20):_-b-20<0&&$("#luckysheet-scrollbar-y").scrollTop(_-20)}}return}if($("#luckysheet-modal-dialog-mask").is(":visible")||$(t.target).hasClass("luckysheet-mousedown-cancel")||$(t.target).hasClass("formulaInputFocus"))return;let u=$("#luckysheet-input-box");if((o||t.metaKey)&&s==rl.ENTER&&parseInt(u.css("top"))>0){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;by(h.flowdata[m][d]),t.preventDefault()}else if(s==rl.ENTER&&parseInt(u.css("top"))>0)$("#luckysheet-formula-search-c").is(":visible")&&v.searchFunctionCell!=null?v.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_select_save=[{row:[h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[0]],column:[h.luckysheetCellUpdate[1],h.luckysheetCellUpdate[1]],row_focus:h.luckysheetCellUpdate[0],column_focus:h.luckysheetCellUpdate[1]}],lr("down",1,"rangeOfSelect")),$("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),t.preventDefault();else if(s==rl.TAB){if(parseInt(u.css("top"))>0)return;lr("right",1,"rangeOfSelect"),t.preventDefault()}else if(s==rl.F2){if(parseInt(u.css("top"))>0)return;let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;Dn(m,d,h.flowdata),t.preventDefault()}else if(s==rl.F4&&parseInt(u.css("top"))>0)v.setfreezonFuc(t),t.preventDefault();else if(s==rl.ESC&&parseInt(u.css("top"))>0)v.dontupdate(),lr("down",0,"rangeOfSelect"),t.preventDefault();else if(s==rl.ENTER){if($(t.target).hasClass("formulaInputFocus")||$("#luckysheet-conditionformat-dialog").is(":visible"))return;if(String.fromCharCode(s)!=null&&$("#luckysheet-cell-selected").is(":visible")){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;Dn(m,d,h.flowdata),t.preventDefault()}}else if(l||t.metaKey){if(a){if(fk||(h.luckysheet_shiftpositon=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),h.luckysheet_shiftkeydown=!0),s==rl.UP){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Jo("up","rangeOfSelect")}else if(s==rl.DOWN){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Jo("down","rangeOfSelect")}else if(s==rl.LEFT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Jo("left","rangeOfSelect")}else if(s==rl.RIGHT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Jo("right","rangeOfSelect")}else if(s==186||s==222){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;Dn(m,d,h.flowdata,!0);let g=Hh(2);$("#luckysheet-rich-text-editor").html(g),to($("#luckysheet-rich-text-editor")[0]),v.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}}else if(s==66)$("#luckysheet-icon-bold").click();else if(s==67){if($t.currentImgId!=null){$t.copyImgItem(t);return}if(ht.luckysheetPaintModelOn&&ht.cancelPaintModel(),h.luckysheet_select_save.length==0)return;if(h.config.merge!=null){let m=!1;for(let d=0;d<h.luckysheet_select_save.length;d++){let g=h.luckysheet_select_save[d].row[0],b=h.luckysheet_select_save[d].row[1],y=h.luckysheet_select_save[d].column[0],p=h.luckysheet_select_save[d].column[1];if(m=Ul(h.config,g,b,y,p),m)break}if(m){Qe()?alert(n.noMerge):de.info(n.noMerge,"");return}}let f=h.luckysheetfile[$e(h.currentSheetIndex)].luckysheet_conditionformat_save;if(h.luckysheet_select_save.length>1&&f!=null&&f.length>0){let m=!1,d=xt.getComputeMap();e:for(let g=0;g<h.luckysheet_select_save.length&&!m;g++){let b=h.luckysheet_select_save[g].row[0],y=h.luckysheet_select_save[g].row[1],p=h.luckysheet_select_save[g].column[0],x=h.luckysheet_select_save[g].column[1];for(let _=b;_<=y;_++)for(let S=p;S<=x;S++)if(xt.checksCF(_,S,d)!=null){m=!0;continue e}}if(m){Qe()?alert(n.noMulti):de.info(n.noMulti,"");return}}if(h.luckysheet_select_save.length>1){let m=!0,d=h.luckysheet_select_save[0].row[0],g=h.luckysheet_select_save[0].row[1],b=!0,y=h.luckysheet_select_save[0].column[0],p=h.luckysheet_select_save[0].column[1];for(let x=1;x<h.luckysheet_select_save.length;x++)(h.luckysheet_select_save[x].row[0]!=d||h.luckysheet_select_save[x].row[1]!=g)&&(m=!1),(h.luckysheet_select_save[x].column[0]!=y||h.luckysheet_select_save[x].column[1]!=p)&&(b=!1);if(!m&&!b||Ao()){Qe()?alert(n.noMulti):de.info(n.noMulti,"");return}}Ol.copy(t),h.luckysheet_paste_iscut=!1,uo(),t.stopPropagation();return}else if(s==70)Ta.createDialog(0),Ta.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(s==72)Ta.createDialog(1),Ta.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(s==73)$("#luckysheet-icon-italic").click();else if(s==86){if(Qe()||h.allowEdit===!1||$(t.target).hasClass("formulaInputFocus"))return;if(h.luckysheet_select_save.length>1){Qe()?alert(n.noPaste):de.info(n.noPaste,"");return}Ol.isPasteAction=!0,uo(),t.stopPropagation();return}else if(s==88){if(ht.luckysheetPaintModelOn&&ht.cancelPaintModel(),h.luckysheet_select_save.length==0)return;if(h.config.merge!=null){let f=!1;for(let m=0;m<h.luckysheet_select_save.length;m++){let d=h.luckysheet_select_save[m].row[0],g=h.luckysheet_select_save[m].row[1],b=h.luckysheet_select_save[m].column[0],y=h.luckysheet_select_save[m].column[1];if(f=Ul(h.config,d,g,b,y),f)break}if(f){lt.editMode?alert(_locale_drag.noMerge):de.info(_locale_drag.noMerge,"");return}}if(h.luckysheet_select_save.length>1){Qe()?alert(n.noMulti):de.info(n.noMulti,"");return}Ol.copy(t),h.luckysheet_paste_iscut=!0,uo(),t.stopPropagation();return}else if(s==90){Ia.redo(t),uo(),t.stopPropagation();return}else if(s==89){Ia.undo(t),uo(),t.stopPropagation();return}else if(s==rl.UP){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ts("up","rangeOfSelect")}else if(s==rl.DOWN){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ts("down","rangeOfSelect")}else if(s==rl.LEFT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ts("left","rangeOfSelect")}else if(s==rl.RIGHT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ts("right","rangeOfSelect")}else if(s==186){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;Dn(m,d,h.flowdata,!0);let g=Hh(1);$("#luckysheet-rich-text-editor").html(g),to($("#luckysheet-rich-text-editor")[0]),v.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}else if(s==222){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;Dn(m,d,h.flowdata,!0);let g=Hh(2);$("#luckysheet-rich-text-editor").html(g),to($("#luckysheet-rich-text-editor")[0]),v.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}else String.fromCharCode(s).toLocaleUpperCase()=="A"&&$("#luckysheet-left-top").click();t.preventDefault();return}else if(a&&(s==rl.UP||s==rl.DOWN||s==rl.LEFT||s==rl.RIGHT||o&&(s==53||s==101))){if(parseInt(u.css("top"))>0||$(t.target).hasClass("formulaInputFocus"))return;if(fk||(h.luckysheet_shiftpositon=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),h.luckysheet_shiftkeydown=!0),s==rl.UP){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ya("down",-1,"rangeOfSelect")}else if(s==rl.DOWN){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ya("down",1,"rangeOfSelect")}else if(s==rl.LEFT){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ya("right",-1,"rangeOfSelect")}else if(s==rl.RIGHT){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Ya("right",1,"rangeOfSelect")}else o&&(s==53||s==101)&&$("#luckysheet-icon-strikethrough").click();t.preventDefault()}else if(s==rl.ESC)ht.luckysheetPaintModelOn?ht.cancelPaintModel():(Ir(t),t.preventDefault()),Zt();else if(s==rl.DELETE||s==rl.BACKSPACE)$t.currentImgId!=null?$t.removeImgItem():$("#luckysheet-delete-text").click(),t.preventDefault();else if(s==8&&$t.currentImgId!=null)$t.removeImgItem(),t.preventDefault();else if(s==rl.UP){if(parseInt(u.css("top"))>0||h.luckysheet_cell_selected_move||h.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;lr("down",-1,"rangeOfSelect"),t.preventDefault()}else if(s==rl.DOWN){if(parseInt(u.css("top"))>0||h.luckysheet_cell_selected_move||h.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;lr("down",1,"rangeOfSelect"),t.preventDefault()}else if(s==rl.LEFT){if(parseInt(u.css("top"))>0||h.luckysheet_cell_selected_move||h.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;lr("right",-1,"rangeOfSelect"),t.preventDefault()}else if(s==rl.RIGHT){if(parseInt(u.css("top"))>0||h.luckysheet_cell_selected_move||h.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;lr("right",1,"rangeOfSelect"),t.preventDefault()}else if((!(s>=112&&s<=123||s<=46||s==144||s==108||t.ctrlKey||t.altKey||t.shiftKey&&(s==37||s==38||s==39||s==40))||s==8||s==32||s==46||s==0||t.ctrlKey&&s==86)&&String.fromCharCode(s)!=null&&$("#luckysheet-cell-selected").is(":visible")&&s!=rl.CAPSLOCK&&s!=rl.WIN&&s!=18){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;Dn(m,d,h.flowdata,!0),s==8&&$("#luckysheet-rich-text-editor").html("<br/>"),v.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}uo(),t.stopPropagation()}),$("#"+h.container).add("#luckysheet-input-box").keydown(function(t){if($("#luckysheet-modal-dialog-mask").is(":visible")||$(t.target).hasClass("luckysheet-mousedown-cancel")||$(t.target).hasClass("formulaInputFocus"))return;let l=t.ctrlKey,o=t.altKey,a=t.shiftKey,s=t.keyCode,u=$("#luckysheet-input-box");s==rl.ESC&&parseInt($("#luckysheet-input-box").css("top"))>0?(v.dontupdate(),lr("down",0,"rangeOfSelect"),t.preventDefault()):s==rl.ENTER&&parseInt(u.css("top"))>0?$("#luckysheet-formula-search-c").is(":visible")&&v.searchFunctionCell!=null&&(v.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")),t.preventDefault()):s==rl.TAB&&parseInt(u.css("top"))>0?($("#luckysheet-formula-search-c").is(":visible")&&v.searchFunctionCell!=null?v.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(v.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),lr("right",1,"rangeOfSelect")),t.preventDefault()):s==rl.F4&&parseInt(u.css("top"))>0?(v.setfreezonFuc(t),t.preventDefault()):s==rl.UP&&parseInt(u.css("top"))>0?Vh("up",l,a,t):s==rl.DOWN&&parseInt(u.css("top"))>0?Vh("down",l,a,t):s==rl.LEFT&&parseInt(u.css("top"))>0?Vh("left",l,a,t):s==rl.RIGHT&&parseInt(u.css("top"))>0?Vh("right",l,a,t):(!(s>=112&&s<=123||s<=46||s==144||s==108||t.ctrlKey||t.altKey||t.shiftKey&&(s==37||s==38||s==39||s==40||s==rl.WIN||s==rl.WIN_R||s==rl.MENU))||s==8||s==32||s==46||t.ctrlKey&&s==86)&&(v.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s),D1(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1],h.flowdata))}).keyup(function(t){let l=t.keyCode;!t.shiftKey&&l==16&&(h.luckysheet_shiftkeydown=!1,h.luckysheet_shiftpositon=null),parseInt($("#luckysheet-input-box").css("top"))>0&&(l==13||l==16||l==32),t.preventDefault()}),$("#luckysheet_info_detail_input").val(He.title).css("width",Ps(He.title)*10).keydown(function(){let t=event.ctrlKey,l=event.altKey,o=event.shiftKey,a=event.keyCode,s=$(this);a==rl.ENTER&&s.blur().change()}).bind("input propertychange",function(){let t=$(this),l=Ps(t.val())*10,o=$("#luckysheet_info_detail_update").outerWidth(),a=$("#luckysheet_info_detail_save").outerWidth(),s=$("#luckysheet_info_detail_user").parent().outerWidth()+60,u=$("#"+h.container).outerWidth(),f=100,m=u-a-o-s-f;l>m?$("#luckysheet_info_detail_input").css("width",m):$("#luckysheet_info_detail_input").css("width",l)}).change(function(){He.saveParam("na",null,$(this).val())}),$("#"+h.container).add("input.luckysheet-mousedown-cancel").keydown(function(t){let l=t.target.closest(".luckysheet-cols-menuitem");typeof l!="undefined"&&l!=null&&t.keyCode===13&&$(l).trigger("click")})}var import_plugin,fk,dk=Tt(()=>{import_plugin=Le(Be());bn();Mr();ji();wr();Ns();ar();Cc();vr();Ac();Mg();$h();To();gl();ql();Gl();pa();ir();Io();Sr();Rl();va();Ut();fk=!1});function mk(){let e=Oe();$("#luckysheetorderbyasc, #luckysheetorderbyasc_t").mousedown(function(t){Ir(t),Wm(h.orderbyindex,!0),Zt()}),$("#luckysheetorderbydesc, #luckysheetorderbydesc_t").click(function(t){Ir(t),Wm(h.orderbyindex,!1),Zt()});let n=!0;$("#luckysheetorderby").click(function(){if(!Hl(h.currentSheetIndex,"sort"))return;$("body .luckysheet-cols-menu").hide();let t=e.sort;if(h.luckysheet_select_save.length>1){Qe()?alert(t.noRangeError):de.info(t.noRangeError,"");return}let l=h.luckysheet_select_save[0],o=l.row[0],a=l.row[1],s=l.column[0],u=l.column[1];if(n){n=!1;let _=`<div style="overflow: hidden;" class="luckysheet-sort-modal"><div><label><input type="checkbox" id="luckysheet-sort-haveheader"/><span>${t.hasTitle}</span></label></div><div style="overflow-y:auto;" id="luckysheet-sort-dialog-tablec"><table data-itemcount="0" cellspacing="0"> <tr><td>${t.hasTitle} <select name="sort_0"> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> </select> </td> <td> <div><label><input value="asc" type="radio" checked="checked" name="sort_0"><span>${t.asc}A-Z</span></label></div> <div><label><input value="desc" type="radio" name="sort_0"><span>${t.desc}Z-A</span></label></div></td></tr></table></div><div style="background: #e5e5e5;border-top: 1px solid #f5f5f5; height: 1px; width: 100%;margin:2px 0px;margin-bottom:10px;"></div> <div> <span style="font-weight: bold; text-decoration: underline;text-align:center;color: blue;cursor: pointer;" class="luckysheet-sort-dialog-additem">+ ${t.addOthers}</span> </div> </div>`;$("body").first().append(yt(kl,{id:"luckysheet-sort-dialog",addclass:"",title:e.sort.sortTitle,content:_,botton:`<button id="luckysheet-sort-modal-confirm" class="btn btn-primary">${t.confirm}</button><button class="btn btn-default luckysheet-model-close-btn">${t.close}</button>`})),$("#luckysheet-sort-dialog .luckysheet-sort-dialog-additem").click(function(){let S=h.luckysheet_select_save[0],I=S.row[0],O=S.row[1],F=S.column[0],D=S.column[1],k="",w=$("#luckysheet-sort-dialog table").data("itemcount")+1,C=$("#luckysheet-sort-haveheader").is(":checked");for(let T=F;T<=D;T++)if(C){let z=Mt(I,T,h.flowdata,"m");z==null&&(z=t.columnOperation+(T-F+1)),k+='<option value="'+T+'">'+z+"</option>"}else k+='<option value="'+T+'">'+Qt(T)+"</option>";$("#luckysheet-sort-dialog table").append(`
                    <tr class="luckysheet-sort-dialog-tr">
                        <td><span class="luckysheet-sort-item-close" onclick="$(this).parent().parent().remove();"><i class="fa fa-times"
                                    aria-hidden="true"></i></span>${t.secondaryTitle} <select
                                name="sort_${w}">${k}</select> </td>
                        <td>
                            <div><label><input value="asc" type="radio" checked="checked"
                                        name="sort_${w}"><span>${t.asc}A-Z</span></label></div>
                            <div><label><input value="desc" type="radio" name="sort_${w}"><span>${t.desc}Z-A</span></label>
                            </div>
                        </td>
                    </tr>
                `),$("#luckysheet-sort-dialog table").data("itemcount",w)}),$("#luckysheet-sort-haveheader").change(function(){let S=h.luckysheet_select_save[0],I=S.row[0],O=S.row[1],F=S.column[0],D=S.column[1],k=$(this).is(":checked"),w="";for(let C=F;C<=D;C++)if(k){let T=Mt(I,C,h.flowdata,"m");T==null&&(T=t.columnOperation+(C-F+1)),w+='<option value="'+C+'">'+T+"</option>"}else w+='<option value="'+C+'">'+Qt(C)+"</option>";$("#luckysheet-sort-dialog tr select").each(function(){$(this).html(w)})}),$("#luckysheet-sort-modal-confirm").click(function(){if(h.luckysheet_select_save.length>1){Qe()?alert(t.noRangeError):de.info(t.noRangeError,"");return}let S=pt.deepCopyFlowData(h.flowdata),I=h.luckysheet_select_save[0],O=I.row[0],F=I.row[1],D=I.column[0],k=I.column[1],w=$("#luckysheet-sort-haveheader").is(":checked"),C;w?C=O+1:C=O;let T=!1,z=[];for(let M=C;M<=F;M++){let P=[];for(let N=D;N<=k;N++){if(S[M][N]!=null&&S[M][N].mc!=null){T=!0;break}P.push(S[M][N])}z.push(P)}if(T){Qe()?alert(t.mergeError):de.info(t.mergeError,"");return}$($("#luckysheet-sort-dialog table tr").toArray().reverse()).each(function(){let M=$(this).find("select").val(),P=$(this).find("input:radio:checked").val();M-=D,P=="asc"?P=!0:P=!1,z=So([].concat(z),M,P)});for(let M=C;M<=F;M++)for(let P=D;P<=k;P++)S[M][P]=z[M-C][P-D];let A={};if(h.config.rowlen!=null){let M=$.extend(!0,{},h.config);M=tn(S,C,F,M),A={cfg:M,RowlChange:!0}}Gt(S,[{row:[C,F],column:[D,k]}],A),$("#luckysheet-sort-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide()})}let f="";for(let _=s;_<=u;_++)f+='<option value="'+_+'">'+Qt(_)+"</option>";$("#luckysheet-sort-dialog select").html(f),$("#luckysheet-sort-dialog .luckysheet-sort-dialog-tr").remove(),$("#luckysheet-sort-haveheader").prop("checked",!1),$("#luckysheet-sort-dialog input:radio:first").prop("checked","checked"),$("#luckysheet-sort-dialog .luckysheet-modal-dialog-title-text").html(t.sortRangeTitle+"<span>"+Qt(s)+(o+1)+"</span>"+t.sortRangeTitleTo+"<span>"+Qt(u)+(a+1)+"</span>");let m=$("#luckysheet-sort-dialog"),d=m.outerHeight(),g=m.outerWidth(),b=$(window).width(),y=$(window).height(),p=$(document).scrollLeft(),x=$(document).scrollTop();$("#luckysheet-sort-dialog-tablec").css("max-height",(y-d)/2),$("#luckysheet-sort-dialog").css({left:(b+p-g)/2,top:(y+x-d)/2}).show(),$("#luckysheet-modal-dialog-mask").show(),o<a&&setTimeout(function(){let _=h.flowdata[o],S=h.flowdata[o+1],I=!1;for(let O=s;O<=u;O++){let F=xi(_[O]),D=xi(S[O]);F!=D&&(I=!0)}I&&$("#luckysheet-sort-haveheader").prop("checked",!0).change()},10)})}var import_plugin,gk=Tt(()=>{import_plugin=Le(Be());ar();vr();jn();gl();Hi();Gl();Io();fr();mr();Rs();Sr();br();Co();Ut();Rl()});function pk(e,n){xh(v_),wh(p_,null,function(){})}var import_plugin,p_,v_,vk=Tt(()=>{import_plugin=Le(Be());gl();p_=["http://localhost:8080/luckysheetPluginPrint.umd.js"],v_=["http://localhost:8080/luckysheetPluginPrint.css"]});function yk(e,n){e.length&&e.forEach(t=>{y_[t](n,k_)})}var import_plugin,y_,k_,kk=Tt(()=>{import_plugin=Le(Be());bh();vk();y_={chart:m1,print:pk},k_=!0});var import_plugin,ue,Ku,b_,bk,wk=Tt(()=>{import_plugin=Le(Be());bn();Uu();lg();ql();Mr();Xm();ir();Vu();br();Co();Gl();fr();Hn();Rs();mr();gl();Ut();ue=Le(ka()),Ku=Le(Is()),b_={SUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else if(Y(l))t.push(l);else if(V(l)=="boolean")l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0);else return v.error.v}var o=0;if(t.length>0)for(var e=0;e<t.length;e++){if(q(t[e]))return t[e];!Y(t[e])||(o=Pl(o,"+",t[e]))}return o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},AVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array")if(V(l[0])=="array"){if(!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else t=t.concat(l);else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"text",!0)):t.push(l)}for(var o=0,a=0,e=0;e<t.length;e++){if(q(t[e]))return t[e];if(!Y(t[e]))return v.error.v;o=Pl(o,"+",t[e]),a++}return a==0?v.error.d:Pl(o,"/",a)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},COUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array")if(V(l[0])=="array"){if(!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else t=t.concat(l);else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"text",!0)):V(l)=="boolean"?l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0):t.push(l)}for(var o=0,e=0;e<t.length;e++)Y(t[e])&&o++;return o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},COUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array")if(V(l[0])=="array"){if(!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l))}else t=t.concat(l);else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"text",!0)):t.push(l)}return t.length}catch(o){return o=v.errorInfo(o),[v.error.v,o]}},MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array")if(V(l[0])=="array"){if(!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else t=t.concat(l);else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=null,e=0;e<t.length;e++){if(q(t[e]))return t[e];!Y(t[e])||(o==null||parseFloat(t[e])>o)&&(o=parseFloat(t[e]))}return o??0}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array")if(V(l[0])=="array"){if(!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else t=t.concat(l);else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=null,e=0;e<t.length;e++){if(q(t[e]))return t[e];!Y(t[e])||(o==null||parseFloat(t[e])<o)&&(o=parseFloat(t[e]))}return o??0}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},AGE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return v.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(q(l))return l;l=(0,ue.default)(l);var o=(0,ue.default)();if(arguments.length==2){if(o=j.getFirstValue(arguments[1]),q(o))return o;o=(0,ue.default)(o)}var a=o.diff(l,"years");return a<0||a.toString()=="NaN"?v.error.v:a}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},SEX_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]).toString();return q(t)?t:window.luckysheet_function.ISIDCARD.f(t)?parseInt(t.substr(16,1))%2==1?"\u7537":"\u5973":v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},BIRTHDAY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]).toString();if(q(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return v.error.v;var l="";if(t.length==15){var o="19"+t.substring(6,8)+"/"+t.substring(8,10)+"/"+t.substring(10,12);l=o}else if(t.length==18){var o=t.substring(6,10)+"/"+t.substring(10,12)+"/"+t.substring(12,14);l=o}var a=0;if(arguments[1]!=null&&(a=j.getFirstValue(arguments[1]),q(a)))return a;if(!Y(a))return v.error.v;if(a=parseInt(a),a<0||a>2)return v.error.v;if(parseInt(a)==0)return l;if(parseInt(a)==1)return(0,ue.default)(l).format("YYYY-MM-DD");if(parseInt(a)==2)return(0,ue.default)(l).format("YYYY\u5E74M\u6708D\u65E5")}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},PROVINCE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]).toString();if(q(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return v.error.v;var l="\u672A\u77E5",o=v.classlist.province;return t.substring(0,2)in o&&(l=o[t.substring(0,2)]),l}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},CITY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]).toString();if(q(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return v.error.v;for(var l=cityData.length,o="\u672A\u77E5",e=0;e<l;e++)if(t.substring(0,6)==cityData[e].code){o=cityData[e].title;break}return o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},STAR_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return v.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(q(l))return l;l=new Date(l);var o=l.getMonth(),a=l.getDate(),s=new Date(1999,o,a,0,0,0),u=[];u.push(["\u9B54\u7FAF\u5EA7",new Date(1999,0,1,0,0,0)]),u.push(["\u6C34\u74F6\u5EA7",new Date(1999,0,20,0,0,0)]),u.push(["\u53CC\u9C7C\u5EA7",new Date(1999,1,19,0,0,0)]),u.push(["\u767D\u7F8A\u5EA7",new Date(1999,2,21,0,0,0)]),u.push(["\u91D1\u725B\u5EA7",new Date(1999,3,21,0,0,0)]),u.push(["\u53CC\u5B50\u5EA7",new Date(1999,4,21,0,0,0)]),u.push(["\u5DE8\u87F9\u5EA7",new Date(1999,5,22,0,0,0)]),u.push(["\u72EE\u5B50\u5EA7",new Date(1999,6,23,0,0,0)]),u.push(["\u5904\u5973\u5EA7",new Date(1999,7,23,0,0,0)]),u.push(["\u5929\u79E4\u5EA7",new Date(1999,8,23,0,0,0)]),u.push(["\u5929\u874E\u5EA7",new Date(1999,9,23,0,0,0)]),u.push(["\u5C04\u624B\u5EA7",new Date(1999,10,22,0,0,0)]),u.push(["\u9B54\u7FAF\u5EA7",new Date(1999,11,22,0,0,0)]);for(var e=u.length-1;e>=0;e--)if(s>=u[e][1])return u[e][0];return"\u672A\u627E\u5230\u5339\u914D\u661F\u5EA7\u4FE1\u606F"}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},ANIMAL_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return v.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(q(l))return l;l=new Date(l);var o=new Array("\u732A","\u9F20","\u725B","\u864E","\u5154","\u9F99","\u86C7","\u9A6C","\u7F8A","\u7334","\u9E21","\u72D7"),a=(parseInt(l.getFullYear())+9)%12;return a!=null&&!isNaN(a)?o[a]:"\u672A\u627E\u5230\u5339\u914D\u751F\u8096\u4FE1\u606F"}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},ISIDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;var l=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return!!l.test(t)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},DM_TEXT_CUTWORD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=j.getFirstValue(arguments[0],"text");if(q(a))return a;var s=0;return arguments[1]!=null&&(s=j.getFirstValue(arguments[1]),q(s))?s:Y(s)?(s=parseInt(s),s!=0&&s!=1&&s!=2?v.error.v:($.post("/dataqk/tu/api/cutword",{text:a,type:s},function(f){var m=[].concat(h.flowdata);v.execFunctionGroup(t,l,f),m[t][l]={v:f,f:o},Gt(m,[{row:[t,t],column:[l,l]}])}),"loading...")):v.error.v}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},DM_TEXT_TFIDF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=j.getFirstValue(arguments[0],"text");if(q(a))return a;var s=20;if(arguments[1]!=null&&(s=j.getFirstValue(arguments[1]),q(s)))return s;if(!Y(s))return v.error.v;s=parseInt(s);var u=0;return arguments[2]!=null&&(u=j.getFirstValue(arguments[2]),q(u))?u:Y(u)?(u=parseInt(u),s<0?v.error.v:u!=0&&u!=1&&u!=2?v.error.v:($.post("/dataqk/tu/api/tfidf",{text:a,count:s,set:u},function(m){var d=pt.deepCopyFlowData(h.flowdata);v.execFunctionGroup(t,l,m),d[t][l]={v:m,f:o},Gt(d,[{row:[t,t],column:[l,l]}])}),"loading...")):v.error.v}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},DM_TEXT_TEXTRANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=j.getFirstValue(arguments[0],"text");if(q(a))return a;var s=20;if(arguments[1]!=null&&(s=j.getFirstValue(arguments[1]),q(s)))return s;if(!Y(s))return v.error.v;s=parseInt(s);var u=0;return arguments[2]!=null&&(u=j.getFirstValue(arguments[2]),q(u))?u:Y(u)?(u=parseInt(u),s<0?v.error.v:u!=0&&u!=1&&u!=2?v.error.v:($.post("/dataqk/tu/api/tfidf",{text:a,count:s,set:u},function(m){var d=pt.deepCopyFlowData(h.flowdata);v.execFunctionGroup(t,l,m),d[t][l]={v:m,f:o},Gt(d,[{row:[t,t],column:[l,l]}])}),"loading...")):v.error.v}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},DATA_CN_STOCK_CLOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=j.getFirstValue(arguments[0]);if(q(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(V(u)=="array")return v.error.v;if(V(u)=="object"&&u.startCell!=null)if(u.data!=null&&V(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=$l("yyyy-mm-dd",u.data.v);else return v.error.v;else s=u;if(!Zl(s))return[v.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ue.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=j.getFirstValue(arguments[2]),q(f))?f:Y(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?v.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"0"},function(d){var g=pt.deepCopyFlowData(h.flowdata),b=Fn(d);b==null&&(b=d),v.execFunctionGroup(t,l,b),g[t][l]={v:b,f:o},Gt(g,[{row:[t,t],column:[l,l]}])}),"loading...")):v.error.v}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},DATA_CN_STOCK_OPEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=j.getFirstValue(arguments[0]);if(q(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(V(u)=="array")return v.error.v;if(V(u)=="object"&&u.startCell!=null)if(u.data!=null&&V(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=$l("yyyy-mm-dd",u.data.v);else return v.error.v;else s=u;if(!Zl(s))return[v.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ue.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=j.getFirstValue(arguments[2]),q(f))?f:Y(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?v.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"1"},function(d){var g=pt.deepCopyFlowData(h.flowdata);v.execFunctionGroup(t,l,d),g[t][l]={v:d,f:o},Gt(g,[{row:[t,t],column:[l,l]}])}),"loading...")):v.error.v}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},DATA_CN_STOCK_MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=j.getFirstValue(arguments[0]);if(q(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(V(u)=="array")return v.error.v;if(V(u)=="object"&&u.startCell!=null)if(u.data!=null&&V(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=$l("yyyy-mm-dd",u.data.v);else return v.error.v;else s=u;if(!Zl(s))return[v.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ue.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=j.getFirstValue(arguments[2]),q(f))?f:Y(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?v.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"2"},function(d){var g=pt.deepCopyFlowData(h.flowdata);v.execFunctionGroup(t,l,d),g[t][l]={v:d,f:o},Gt(g,[{row:[t,t],column:[l,l]}])}),"loading...")):v.error.v}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},DATA_CN_STOCK_MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=j.getFirstValue(arguments[0]);if(q(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(V(u)=="array")return v.error.v;if(V(u)=="object"&&u.startCell!=null)if(u.data!=null&&V(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=$l("yyyy-mm-dd",u.data.v);else return v.error.v;else s=u;if(!Zl(s))return[v.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ue.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=j.getFirstValue(arguments[2]),q(f))?f:Y(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?v.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"3"},function(d){var g=pt.deepCopyFlowData(h.flowdata);v.execFunctionGroup(t,l,d),g[t][l]={v:d,f:o},Gt(g,[{row:[t,t],column:[l,l]}])}),"loading...")):v.error.v}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},DATA_CN_STOCK_VOLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=j.getFirstValue(arguments[0]);if(q(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(V(u)=="array")return v.error.v;if(V(u)=="object"&&u.startCell!=null)if(u.data!=null&&V(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=$l("yyyy-mm-dd",u.data.v);else return v.error.v;else s=u;if(!Zl(s))return[v.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ue.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=j.getFirstValue(arguments[2]),q(f))?f:Y(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?v.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"4"},function(d){var g=pt.deepCopyFlowData(h.flowdata);v.execFunctionGroup(t,l,d),g[t][l]={v:d,f:o},Gt(g,[{row:[t,t],column:[l,l]}])}),"loading...")):v.error.v}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},DATA_CN_STOCK_AMOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=j.getFirstValue(arguments[0]);if(q(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(V(u)=="array")return v.error.v;if(V(u)=="object"&&u.startCell!=null)if(u.data!=null&&V(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=$l("yyyy-mm-dd",u.data.v);else return v.error.v;else s=u;if(!Zl(s))return[v.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ue.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=j.getFirstValue(arguments[2]),q(f))?f:Y(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?v.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"5"},function(d){var g=pt.deepCopyFlowData(h.flowdata);v.execFunctionGroup(t,l,d),g[t][l]={v:d,f:o},Gt(g,[{row:[t,t],column:[l,l]}])}),"loading...")):v.error.v}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},ISDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:Zl(t)}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},SUMIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=0,l=arguments[0].data,o=arguments[0].rowl,a=arguments[0].coll,s=Oc(arguments[1]);if(l=v.getRangeArray(l)[0],arguments[2]){var u=[],f=arguments[2].startCell,m=arguments[2].rowl,d=arguments[2].coll,g=arguments[2].sheetName;if(o==m&&a==d)u=arguments[2].data;else{var b=[],y=[],p="",x="";b[0]=parseInt(f.replace(/[^0-9]/g,""))-1,y[0]=jr(f.replace(/[^A-Za-z]/g,"")),b[1]=b[0]+o-1,y[1]=y[0]+a-1;var _=Qt(y[1]),S=b[1]+1;p=_+S,x=g+"!"+f+":"+p,u=Si(x).data}u=v.getRangeArray(u)[0];for(var e=0;e<l.length;e++){var I=l[e];if(!!I&&v.acompareb(I,s)){if(!Y(u[e]))continue;t=Pl(t,"+",u[e])}}}else for(var e=0;e<l.length;e++){var I=l[e];if(!!I&&v.acompareb(I,s)){if(!Y(I))continue;t=Pl(t,"",I)}}return t}catch(F){var O=F;return O=v.errorInfo(O),[v.error.v,O]}},TAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),Math.tan(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},TANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=Math.exp(2*t);return(l-1)/(l+1)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},CEILING:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),l==0?0:t>0&&l<0?v.error.nm:Math.ceil(t/l)*l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ATAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),Math.atan(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},ASINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),Math.log(t+Math.sqrt(t*t+1))):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},ABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),Math.abs(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},ACOS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<-1||t>1?v.error.nm:Math.acos(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},ACOSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<1?v.error.nm:Math.log(t+Math.sqrt(t*t-1))):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},MULTINOMIAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=0,a=1,e=0;e<t.length;e++){var s=t[e];if(!Y(s))return v.error.v;if(s=parseFloat(s),s<0)return v.error.nm;o+=s,a*=j.factorial(s)}return j.factorial(o)/a}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},ATANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<=-1||t>=1?v.error.nm:Math.log((1+t)/(1-t))/2):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},ATAN2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),t==0&&l==0?v.error.d:Math.atan2(l,t)):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},COUNTBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=0;if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return 1;if(V(t.data)=="array")for(var o=0;o<t.data.length;o++)for(var a=0;a<t.data[o].length;a++)(t.data[o][a]==null||rt(t.data[o][a].v))&&l++;else rt(t.data.v)&&l++}return l}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},COSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),(Math.exp(t)+Math.exp(-t))/2):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},INT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0];if(V(t)=="array")return V(t[0])=="array"?j.isDyadicArr(t)?Y(t[0][0])?Math.floor(parseFloat(t[0][0])):v.error.v:v.error.v:Y(t[0])?Math.floor(parseFloat(t[0])):v.error.v;if(V(t)=="object"&&t.startCell!=null){if(t.coll>1)return v.error.v;if(t.rowl>1){var l=v.getcellrange(t.startCell),o=l.row[0];if(window.luckysheetCurrentRow<o||window.luckysheetCurrentRow>o+t.rowl-1)return v.error.v;var a=t.data[window.luckysheetCurrentRow-o][0]}else var a=t.data;return a==null||rt(a.v)?0:Y(a.v)?Math.floor(parseFloat(a.v)):v.error.v}else{if(V(t)=="boolean"){if(t.toString().toLowerCase()=="true")return 1;if(t.toString().toLowerCase()=="false")return 0}return Y(t)?Math.floor(parseFloat(t)):v.error.v}}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},ISEVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseInt(t),!(Math.abs(t)&1)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},ISODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseInt(t),!!(Math.abs(t)&1)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},LCM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array")if(V(l[0])=="array"){if(!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l))}else t=t.concat(l);else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=0;o<t.length;o++){var a=t[o];if(!Y(a))return v.error.v;if(a=parseInt(a),a<0)return v.error.nm;t[o]=a}for(var e,s,u,f,m=1;(u=t.pop())!==void 0;)for(u==0&&(m=0);u>1;){if(u%2){for(e=3,s=Math.floor(Math.sqrt(u));e<=s&&u%e;e+=2);f=e<=s?e:u}else f=2;for(u/=f,m*=f,e=t.length;e;t[--e]%f==0&&(t[e]/=f)===1&&t.splice(e,1));}return m>=Math.pow(2,53)?v.error.nm:m}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},LN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<=0?v.error.nm:Math.log(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},LOG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;if(t=parseFloat(t),t<=0)return v.error.nm;if(arguments.length==2){var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;if(l=parseFloat(l),l<=0)return v.error.nm}else var l=10;return Math.log(t)/Math.log(l)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},LOG10:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<=0?v.error.nm:Math.log(t)/Math.log(10)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},MOD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;if(l=parseFloat(l),l==0)return v.error.d;var o=Math.abs(t%l);return l>0?o:-o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},MROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),t*l<0?v.error.nm:Math.round(t/l)*l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=Math.ceil(Math.abs(t));return l=l&1?l:l+1,t>=0?l:-l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},SUMSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"number",!0)):t.push(l)}var o=0;if(t.length>0)for(var e=0;e<t.length;e++){var a=t[e];if(!Y(a))return v.error.v;a=parseFloat(a),o+=a*a}return o}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},COMBIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseInt(l),t<0||l<0||t<l?v.error.nm:j.factorial(t)/(j.factorial(l)*j.factorial(t-l))):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},SUBTOTAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{let d=function(g){switch(g){case 1:case 101:return window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,s);case 2:case 102:return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,s);case 3:case 103:return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,s);case 4:case 104:return window.luckysheet_function.MAX.f.apply(window.luckysheet_function.MAX,s);case 5:case 105:return window.luckysheet_function.MIN.f.apply(window.luckysheet_function.MIN,s);case 6:case 106:return window.luckysheet_function.PRODUCT.f.apply(window.luckysheet_function.PRODUCT,s);case 7:case 107:return window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,s);case 8:case 108:return window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,s);case 9:case 109:return window.luckysheet_function.SUM.f.apply(window.luckysheet_function.SUM,s);case 10:case 110:return window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,s);case 11:case 111:return window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,s)}};var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=[];for(var e=0;e<t.length;e++){for(var o=[],a=0;a<t[e].length;a++)o.push(t[e][a]);l.push(o)}}else{l=[];for(var e=0;e<t.length;e++)l.push(t[e])}else V(t)=="object"&&t.startCell!=null?l=j.getFirstValue(t):l=t;var s=Array.prototype.slice.apply(arguments);if(s.shift(),V(l)=="array"){var u=[];if(V(l[0])=="array")for(var e=0;e<l.length;e++){for(var o=[],a=0;a<l[e].length;a++){var f=l[e][a];q(f)?o.push(f):Y(f)?(f=parseInt(f),f<1||f>111||f>11&&f<101?o.push(v.error.v):o.push(d(f))):o.push(v.error.v)}u.push(o)}else for(var e=0;e<l.length;e++){var f=l[e];q(f)?u.push(f):Y(f)?(f=parseInt(f),f<1||f>111||f>11&&f<101?u.push(v.error.v):u.push(d(f))):u.push(v.error.v)}return u}else return q(l)?l:Y(l)?(l=parseInt(l),l<1||l>111||l>11&&l<101?v.error.v:d(l)):v.error.v}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},ASIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<-1||t>1?v.error.nm:Math.asin(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},COUNTIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{let d=function(g,b){/[<>=!*?]/.test(b)||(b='=="'+b+'"'),b=b.replace("<>","!=");var y=0;if(V(g)=="array"){for(var p=0;p<g.length;p++)for(var x=0;x<g[p].length;x++)if(g[p][x]!=null&&!rt(g[p][x].v)){var _=g[p][x].v;b.indexOf("*")>-1||b.indexOf("?")>-1?v.isWildcard(_,b)&&y++:typeof _!="string"?new Function("return "+_+b)()&&y++:new Function('return "'+_+'"'+b)()&&y++}}else if(g!=null&&!rt(g.v)){var _=g.v;b.indexOf("*")>-1||b.indexOf("?")>-1?v.isWildcard(_,b)&&y++:typeof _!="string"?new Function("return "+_+b)()&&y++:new Function('return "'+_+'"'+b)()&&y++}return y};var t=arguments[0],l;if(V(t)=="object"&&t.startCell!=null)l=t.data;else return v.error.v;var o=arguments[1],a;if(V(o)=="array")if(a=[],V(o[0])=="array"){if(!j.isDyadicArr(o))return v.error.v;for(var e=0;e<o.length;e++){for(var s=[],u=0;u<o[e].length;u++)s.push(o[e][u]);a.push(s)}}else for(var e=0;e<o.length;e++)a.push(o[e]);else if(V(o)=="object"&&o.startCell!=null){if(o.rowl>1||o.coll>1)return 0;a=o.data.v}else a=o;if(V(a)=="array"){var f=[];if(V(a[0])=="array")for(var e=0;e<a.length;e++){for(var s=[],u=0;u<a[e].length;u++)s.push(d(l,a[e][u]));f.push(s)}else for(var e=0;e<a.length;e++)f.push(d(l,a[e]));return f}else return d(l,a)}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},RADIANS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t*Math.PI/180):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},RAND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;try{return Math.floor(Math.random()*1e9)/1e9}catch(n){var e=n;return e=v.errorInfo(e),[v.error.v,e]}},COUNTUNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"text",!0)):t.push(l)}return window.luckysheet_function.UNIQUE.f(t)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},DEGREES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t*180/Math.PI):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},ERFC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),jStat.erfc(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},EVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=Math.ceil(Math.abs(t));return l=l&1?l+1:l,t>0?l:-l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},EXP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),Math.exp(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},FACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))if(V(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return v.error.v;return t=parseInt(t),t<0?v.error.nm:j.factorial(t)}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},FACTDOUBLE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))if(V(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return v.error.v;return t=parseInt(t),t<0?v.error.nm:j.factorialDouble(t)}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},PI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;try{return Math.PI}catch(n){var e=n;return e=v.errorInfo(e),[v.error.v,e]}},FLOOR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;if(l=parseFloat(l),l==0)return v.error.d;if(t>0&&l<0)return v.error.nm;var o=-Math.floor(Math.log(Math.abs(l))/Math.log(10));return t>=0?Math.floor(t/l)*l*Math.pow(10,o)/Math.pow(10,o):-(Math.ceil(Math.abs(t)/l)*l*Math.pow(10,o))/Math.pow(10,o)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},GCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!1))}else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"number",!1)):t.push(l)}if(!Y(t[0]))return v.error.v;var o=parseInt(t[0]);if(o<0||o>=Math.pow(2,53))return v.error.nm;for(var e=1;e<t.length;e++){var a=t[e];if(!Y(a))return v.error.v;if(a=parseInt(a),a<0||a>=Math.pow(2,53))return v.error.nm;for(;o&&a;)o>a?o%=a:a%=o;o+=a}return o}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},RANDBETWEEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseInt(l),t>l?v.error.nm:t+Math.ceil((l-t+1)*Math.random())-1):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=t>0?1:-1;return o*Math.round(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},ROUNDDOWN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=t>0?1:-1;return o*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},ROUNDUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=t>0?1:-1;return o*Math.ceil(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},SERIESSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=arguments[3],s=[];if(V(a)=="array"){if(V(a[0])=="array"&&!j.isDyadicArr(a))return v.error.v;s=s.concat(j.getDataArr(a,!1))}else V(a)=="object"&&a.startCell!=null?s=s.concat(j.getCellDataArr(a,"number",!1)):s.push(a);if(!Y(s[0]))return v.error.v;for(var u=parseFloat(s[0])*Math.pow(t,l),e=1;e<s.length;e++){var f=s[e];if(!Y(f))return v.error.v;f=parseFloat(f),u+=f*Math.pow(t,l+e*o)}return u}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},SIGN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;if(t=parseFloat(t),t>0)return 1;if(t==0)return 0;if(t<0)return-1}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},SIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),Math.sin(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},SINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),(Math.exp(t)-Math.exp(-t))/2):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},SQRT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<0?v.error.nm:Math.sqrt(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},SQRTPI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<0?v.error.nm:Math.sqrt(t*Math.PI)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},GAMMALN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<=0?v.error.nm:jStat.gammaln(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},COS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),Math.cos(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},TRUNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;if(t=parseFloat(t),arguments.length==2){var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}else var l=0;var o=t>0?1:-1;return o*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},QUOTIENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),l==0?v.error.d:parseInt(t/l,10)):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},POWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),t==0&&l==0?v.error.nm:t<0&&l.toString().indexOf(".")>-1?v.error.nm:Math.pow(t,l)):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},SUMIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=0,l=arguments;$a(l);for(var o=v.getRangeArray(l[0])[0],a=new Array(o.length),e=0;e<a.length;e++)a[e]=!0;for(var e=1;e<l.length;e+=2)for(var s=v.getRangeArray(l[e])[0],u=l[e+1],f=0;f<s.length;f++){var m=s[f];a[f]=a[f]&&!!m&&v.acompareb(m,u)}for(var e=0;e<o.length;e++)a[e]&&(t=Pl(t,"+",o[e]));return t}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},COUNTIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments;$a(t);for(var l=new Array(v.getRangeArray(t[0])[0].length),e=0;e<l.length;e++)l[e]=!0;for(var e=0;e<t.length;e+=2)for(var o=v.getRangeArray(t[e])[0],a=t[e+1],s=0;s<o.length;s++){var u=o[s];l[s]=l[s]&&!!u&&v.acompareb(u,a)}for(var f=0,e=0;e<l.length;e++)l[e]&&f++;return f}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},PRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=1,e=0;e<t.length;e++){var a=t[e];if(!Y(a))return v.error.v;a=parseFloat(a),o*=a}return o}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},HARMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=0,a=0,e=0;e<t.length;e++){var s=t[e];if(!Y(s))return v.error.v;if(s=parseFloat(s),s<=0)return v.error.nm;o+=1/s,a++}return a/o}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},HYPGEOMDIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{let f=function(d,g,b,y){var p=j.factorial(b)/(j.factorial(d)*j.factorial(b-d)),x=j.factorial(y-b)/(j.factorial(g-d)*j.factorial(y-b-g+d)),_=j.factorial(y)/(j.factorial(g)*j.factorial(y-g));return p*x/_},m=function(d,g,b,y){for(var p=0,x=0;x<=d;x++)p+=f(x,g,b,y);return p};var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a);var s=j.getCellBoolen(arguments[4]);return q(s)?s:t<0||t>Math.min(l,o)||t<Math.max(0,l-a+o)?v.error.nm:l<=0||l>a?v.error.nm:o<=0||o>a?v.error.nm:a<=0?v.error.nm:s?m(t,l,o,a):f(t,l,o,a)}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},INTERCEPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=0,l=arguments[0],o=[];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;o=o.concat(j.getDataArr(l,!1))}else V(l)=="object"&&l.startCell!=null?o=o.concat(j.getCellDataArr(l,"text",!1)):o.push(l);var a=arguments[1],s=[];if(V(a)=="array"){if(V(a[0])=="array"&&!j.isDyadicArr(a))return v.error.v;s=s.concat(j.getDataArr(a,!1))}else V(a)=="object"&&a.startCell!=null?s=s.concat(j.getCellDataArr(a,"text",!1)):s.push(a);if(o.length!=s.length)return v.error.na;for(var u=[],f=[],e=0;e<o.length;e++){var m=o[e],d=s[e];Y(m)&&Y(d)&&(u.push(parseFloat(m)),f.push(parseFloat(d)))}if(j.variance_s(f)==0)return v.error.d;for(var g=jStat.mean(f),b=jStat.mean(u),y=f.length,p=0,x=0,e=0;e<y;e++)p+=(f[e]-g)*(u[e]-b),x+=Math.pow(f[e]-g,2);var _=p/x,S=b-_*g;return S+_*t}catch(O){var I=O;return I=v.errorInfo(I),[v.error.v,I]}},KURT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"text",!0)):t.push(l)}for(var o=[],a=0;a<t.length;a++){var s=t[a];if(!Y(s))return v.error.v;s=parseFloat(s),o.push(s)}if(o.length<4||j.standardDeviation_s(o)==0)return v.error.d;for(var u=jStat.mean(o),f=o.length,m=0,e=0;e<f;e++)m+=Math.pow(o[e]-u,4);return m=m/Math.pow(jStat.stdev(o,!0),4),f*(f+1)/((f-1)*(f-2)*(f-3))*m-3*(f-1)*(f-1)/((f-2)*(f-3))}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},LARGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[];if(V(arguments[0])=="array"){if(V(arguments[0][0])=="array"&&!j.isDyadicArr(arguments[0]))return v.error.v;t=t.concat(j.getDataArr(arguments[0],!0))}else V(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(j.getCellDataArr(arguments[0],"text",!0)):t.push(arguments[0]);for(var l=[],o=0;o<t.length;o++){var a=t[o];if(!Y(a))return v.error.v;a=parseFloat(a),l.push(a)}var s;if(V(arguments[1])=="array"){if(V(arguments[1][0])=="array"&&!j.isDyadicArr(arguments[1]))return v.error.v;s=j.getDataArr(arguments[1])}else if(V(arguments[1])=="object"&&arguments[1].startCell!=null){if(arguments[1].rowl>1||arguments[1].coll>1)return v.error.v;var u=arguments[1].data;if(u==null||rt(u.v))var s=0;else var s=u.v}else s=arguments[1];if(V(s)=="array"){if(l.length==0)return v.error.nm;for(var f=[],e=0;e<s.length;e++){if(!Y(s[e])){f.push(v.error.v);continue}if(s[e]=Math.ceil(parseFloat(s[e])),s[e]<=0||s[e]>l.length){f.push(v.error.nm);continue}f.push(t.sort(function(g,b){return b-g})[s[e]-1])}return f}else return Y(s)?(s=Math.ceil(parseFloat(s)),l.length==0?v.error.nm:s<=0||s>l.length?v.error.nm:t.sort(function(d,g){return g-d})[s-1]):v.error.v}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},STDEVA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!1))}else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"text",!1)):t.push(l)}for(var o=[],a=0;a<t.length;a++){var s=t[a];Y(s)?s=parseFloat(s):s.toString().toLowerCase()=="true"?s=1:s=0,o.push(s)}return o.length==0?0:o.length==1?v.error.d:j.standardDeviation_s(o)}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},STDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else V(l)=="object"&&l.startCell!=null?t=t.concat(j.getCellDataArr(l,"text",!0)):t.push(l)}for(var o=[],a=0;a<t.length;a++){var s=t[a];if(!Y(s))return v.error.v;s=parseFloat(s),o.push(s)}return o.length==0?0:o.length==1?v.error.d:j.standardDeviation(o)}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},GEOMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"text",!0));else if(V(l)=="boolean")l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0);else if(Y(l))t.push(l);else return v.error.v}for(var o=[],a=0;a<t.length;a++){var s=t[a];if(!!Y(s)){if(s=parseFloat(s),s<=0)return v.error.nm;o.push(s)}}return o.length==0?v.error.nm:jStat.geomean(o)}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},RANK_EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;o=o.concat(j.getDataArr(l,!0))}else V(l)=="object"&&l.startCell!=null?o=o.concat(j.getCellDataArr(l,"number",!0)):o.push(l);for(var a=[],s=0;s<o.length;s++){var u=o[s];if(!Y(u))return v.error.v;u=parseFloat(u),a.push(u)}if(arguments.length==3){var f=j.getCellBoolen(arguments[2]);if(q(f))return f}else var f=!1;var m=f?function(b,y){return b-y}:function(b,y){return y-b};a=a.sort(m);var d=a.indexOf(t);return d==-1?v.error.na:d+1}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},RANK_AVG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;o=o.concat(j.getDataArr(l,!0))}else V(l)=="object"&&l.startCell!=null?o=o.concat(j.getCellDataArr(l,"number",!0)):o.push(l);for(var a=[],s=0;s<o.length;s++){var u=o[s];if(!Y(u))return v.error.v;u=parseFloat(u),a.push(u)}if(arguments.length==3){var f=j.getFirstValue(arguments[2]);if(q(f))return f;if(V(f)!="boolean")if(V(f)=="string"&&(f.toLowerCase()=="true"||f.toLowerCase()=="false"))f.toLowerCase()=="true"&&(f=!0),f.toLowerCase()=="false"&&(f=!1);else if(Y(f))f=parseFloat(f),f=f!=0;else return v.error.v}else var f=!1;var m=f?function(b,y){return b-y}:function(b,y){return y-b};a=a.sort(m);for(var d=0,e=0;e<a.length;e++)a[e]==t&&d++;return d>1?(2*a.indexOf(t)+d+1)/2:a.indexOf(t)+1}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},PERCENTRANK_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!0))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"number",!0)):l.push(t);for(var o=[],a=0;a<l.length;a++){var s=l[a];if(!Y(s))return v.error.v;s=parseFloat(s),o.push(s)}var u=j.getFirstValue(arguments[1]);if(q(u))return u;if(!Y(u))return v.error.v;if(u=parseFloat(u),arguments.length==3){var f=j.getFirstValue(arguments[2]);if(q(f))return f;if(!Y(f))return v.error.v;f=parseInt(f)}else var f=3;if(o.length==0)return v.error.nm;if(f<1)return v.error.nm;if(o.length==1&&o[0]==u)return 1;o=o.sort(function(S,I){return S-I});for(var m=window.luckysheet_function.UNIQUE.f(o)[0],d=o.length,g=m.length,b=Math.pow(10,f),y=0,p=!1,e=0;!p&&e<g;)u===m[e]?(y=(o.indexOf(m[e])+1)/(d+1),p=!0):u>=m[e]&&(u<m[e+1]||e===g-1)&&(y=(o.lastIndexOf(m[e])+1+(u-m[e])/(m[e+1]-m[e]))/(d+1),p=!0),e++;return isNaN(y)?v.error.na:Math.floor(y*b)/b}catch(_){var x=_;return x=v.errorInfo(x),[v.error.v,x]}},PERCENTRANK_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!0))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"number",!0)):l.push(t);for(var o=[],a=0;a<l.length;a++){var s=l[a];if(!Y(s))return v.error.v;s=parseFloat(s),o.push(s)}var u=j.getFirstValue(arguments[1]);if(q(u))return u;if(!Y(u))return v.error.v;if(u=parseFloat(u),arguments.length==3){var f=j.getFirstValue(arguments[2]);if(q(f))return f;if(!Y(f))return v.error.v;f=parseInt(f)}else var f=3;if(o.length==0)return v.error.nm;if(f<1)return v.error.nm;if(o.length==1&&o[0]==u)return 1;o=o.sort(function(S,I){return S-I});for(var m=window.luckysheet_function.UNIQUE.f(o)[0],d=o.length,g=m.length,b=Math.pow(10,f),y=0,p=!1,e=0;!p&&e<g;)u===m[e]?(y=o.indexOf(m[e])/(d-1),p=!0):u>=m[e]&&(u<m[e+1]||e===g-1)&&(y=(o.lastIndexOf(m[e])+(u-m[e])/(m[e+1]-m[e]))/(d-1),p=!0),e++;return isNaN(y)?v.error.na:Math.floor(y*b)/b}catch(_){var x=_;return x=v.errorInfo(x),[v.error.v,x]}},FORECAST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;o=o.concat(j.getDataArr(l,!1))}else V(l)=="object"&&l.startCell!=null?o=o.concat(j.getCellDataArr(l,"text",!1)):o.push(l);var a=arguments[2],s=[];if(V(a)=="array"){if(V(a[0])=="array"&&!j.isDyadicArr(a))return v.error.v;s=s.concat(j.getDataArr(a,!1))}else V(a)=="object"&&a.startCell!=null?s=s.concat(j.getCellDataArr(a,"text",!1)):s.push(a);if(o.length!=s.length)return v.error.na;for(var u=[],f=[],e=0;e<o.length;e++){var m=o[e],d=s[e];Y(m)&&Y(d)&&(u.push(parseFloat(m)),f.push(parseFloat(d)))}if(j.variance_s(f)==0)return v.error.d;for(var g=jStat.mean(f),b=jStat.mean(u),y=f.length,p=0,x=0,e=0;e<y;e++)p+=(f[e]-g)*(u[e]-b),x+=Math.pow(f[e]-g,2);var _=p/x,S=b-_*g;return S+_*t}catch(O){var I=O;return I=v.errorInfo(I),[v.error.v,I]}},FISHERINV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=Math.exp(2*t);return(l-1)/(l+1)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},FISHER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<=-1||t>=1?v.error.nm:Math.log((1+t)/(1-t))/2):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},MODE_SNGL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else{if(!Y(l))return v.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)&&o.push(parseFloat(a))}for(var s={},u=[],f=0,m,e=0;e<o.length;e++)m=o[e],s[m]=s[m]?s[m]+1:1,s[m]>f&&(f=s[m],u=[]),s[m]==f&&(u[u.length]=m);if(f<=1)return v.error.na;for(var d=o.indexOf(u[0]),g=0;g<u.length;g++){var b=o.indexOf(u[g]);b<d&&(d=b)}return o[d]}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},WEIBULL_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getCellBoolen(arguments[3]);return q(a)?a:t<0||l<=0||o<=0?v.error.nm:a?1-Math.exp(-Math.pow(t/o,l)):Math.pow(t,l-1)*Math.exp(-Math.pow(t/o,l))*l/Math.pow(o,l)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},AVEDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else{if(!Y(l))return v.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)&&o.push(parseFloat(a))}return o.length==0?v.error.nm:jStat.sum(jStat(o).subtract(jStat.mean(o)).abs()[0])/o.length}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},AVERAGEA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!1))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else if(s.toString.toLowerCase()=="true")t.push(1);else if(s.toString.toLowerCase()=="false")t.push(0);else if(Y(l))t.push(l);else return v.error.v}for(var o=0,a=0,e=0;e<t.length;e++){var s=t[e];Y(s)?o+=parseFloat(s):s.toString().toLowerCase()=="true"?o+=1:o+=0,a++}return a==0?v.error.d:o/a}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},BINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getCellBoolen(arguments[3]);return q(a)?a:t<0||t>l?v.error.nm:o<0||o>1?v.error.nm:a?jStat.binomial.cdf(t,l,o):jStat.binomial.pdf(t,l,o)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},BINOM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;if(o=parseFloat(o),t<0)return v.error.nm;if(l<0||l>1)return v.error.nm;if(o<0||o>1)return v.error.nm;for(var a=0;a<=t;){if(jStat.binomial.cdf(a,t,l)>=o)return a;a++}}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},CONFIDENCE_NORM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);return q(o)?o:Y(o)?(o=parseInt(o),t<=0||t>=1?v.error.nm:l<=0?v.error.nm:o<1?v.error.nm:jStat.normalci(1,t,l,o)[1]-1):v.error.v}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},CORREL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(V(o)=="array"){if(V(o[0])=="array"&&!j.isDyadicArr(o))return v.error.v;a=a.concat(j.getDataArr(o,!1))}else V(o)=="object"&&o.startCell!=null?a=a.concat(j.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return v.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];Y(f)&&Y(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}return s.length==0||u.length==0||j.standardDeviation(s)==0||j.standardDeviation(u)==0?v.error.d:jStat.corrcoeff(s,u)}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},COVARIANCE_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(V(o)=="array"){if(V(o[0])=="array"&&!j.isDyadicArr(o))return v.error.v;a=a.concat(j.getDataArr(o,!1))}else V(o)=="object"&&o.startCell!=null?a=a.concat(j.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return v.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];Y(f)&&Y(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}if(s.length==0||u.length==0)return v.error.d;for(var d=jStat.mean(s),g=jStat.mean(u),b=0,e=0;e<s.length;e++)b+=(s[e]-d)*(u[e]-g);return b=b/s.length,b}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},COVARIANCE_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(V(o)=="array"){if(V(o[0])=="array"&&!j.isDyadicArr(o))return v.error.v;a=a.concat(j.getDataArr(o,!1))}else V(o)=="object"&&o.startCell!=null?a=a.concat(j.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return v.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];Y(f)&&Y(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}return s.length==0||u.length==0?v.error.d:jStat.covariance(s,u)}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},DEVSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else if(Y(l))t.push(l);else if(V(l)=="boolean")l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0);else return v.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)&&o.push(parseFloat(a))}for(var s=jStat.mean(o),u=0,e=0;e<o.length;e++)u+=Math.pow(o[e]-s,2);return u}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},EXPON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getCellBoolen(arguments[2]);return q(o)?o:t<0?v.error.nm:l<0?v.error.nm:o?jStat.exponential.cdf(t,l):jStat.exponential.pdf(t,l)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},AVERAGEIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=0,l=0,o=arguments[0].data,a=arguments[0].rowl,s=arguments[0].coll,u=Oc(arguments[1]),f=[];if(arguments[2]){var m=arguments[2].startCell,d=arguments[2].rowl,g=arguments[2].coll,b=arguments[2].sheetName;if(a==d&&s==g)f=arguments[2].data;else{var y=[],p=[],x="",_="";y[0]=parseInt(m.replace(/[^0-9]/g,""))-1,p[0]=jr(m.replace(/[^A-Za-z]/g,"")),y[1]=y[0]+a-1,p[1]=p[0]+s-1;var S=Qt(p[1]),I=y[1]+1;x=S+I,_=b+"!"+m+":"+x,f=Si(_).data}f=v.getRangeArray(f)[0]}o=v.getRangeArray(o)[0];for(var e=0;e<o.length;e++){var O=o[e];if(!!O&&v.acompareb(O,u)){var F=f[e]||O;if(!Y(F))continue;t+=parseFloat(F),l++}}return t==0||l==0?v.error.d:Fn(t/l)}catch(k){var D=k;return D=v.errorInfo(D),[v.error.v,D]}},AVERAGEIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=0,l=0,o=arguments;$a(o);for(var a=v.getRangeArray(o[0])[0],s=new Array(a.length),e=0;e<s.length;e++)s[e]=!0;for(var e=1;e<o.length;e+=2)for(var u=v.getRangeArray(o[e])[0],f=o[e+1],m=0;m<u.length;m++){var d=u[m];s[m]=s[m]&&!!d&&v.acompareb(d,f)}for(var e=0;e<a.length;e++)s[e]&&Y(a[e])&&(t+=parseFloat(a[e]),l++);return t==0||l==0?v.error.d:Fn(t/l)}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},PERMUT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseInt(l),t<=0||l<0?v.error.nm:t<l?v.error.nm:j.factorial(t)/j.factorial(t-l)):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},TRIMMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{let d=function(b,y){return y=y||1,!b||typeof b.slice!="function"?b:b.slice(y)},g=function(b,y){return y=y||1,!b||typeof b.slice!="function"?b:b.slice(0,b.length-y)};var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];Y(a)&&o.push(parseFloat(a))}var s=j.getFirstValue(arguments[1]);if(q(s))return s;if(!Y(s))return v.error.v;if(s=parseFloat(s),o.length==0)return v.error.nm;if(s<0||s>1)return v.error.nm;o.sort(function(b,y){return b-y});var u=window.luckysheet_function.FLOOR.f(o.length*s,2)/2,f=d(o,u);return f=g(f,u),f=jStat.mean(f),f}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},PERCENTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];Y(a)&&o.push(parseFloat(a))}var s=j.getFirstValue(arguments[1]);if(q(s))return s;if(!Y(s))return v.error.v;if(s=parseFloat(s),o.length==0)return v.error.nm;if(s<=0||s>=1)return v.error.nm;o=o.sort(function(g,b){return g-b});var u=o.length;if(s<1/(u+1)||s>1-1/(u+1))return v.error.nm;var f=s*(u+1)-1,m=Math.floor(f);return f===m?o[f]:o[m]+(f-m)*(o[m+1]-o[m])}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},PERCENTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];Y(a)&&o.push(parseFloat(a))}var s=j.getFirstValue(arguments[1]);if(q(s))return s;if(!Y(s))return v.error.v;if(s=parseFloat(s),o.length==0)return v.error.nm;if(s<0||s>1)return v.error.nm;o=o.sort(function(g,b){return g-b});var u=o.length,f=s*(u-1),m=Math.floor(f);return f===m?o[f]:o[m]+(f-m)*(o[m+1]-o[m])}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},PEARSON:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(V(o)=="array"){if(V(o[0])=="array"&&!j.isDyadicArr(o))return v.error.v;a=a.concat(j.getDataArr(o,!1))}else V(o)=="object"&&o.startCell!=null?a=a.concat(j.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return v.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];Y(f)&&Y(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}if(u.length==0||s.length==0)return v.error.d;for(var d=jStat.mean(s),g=jStat.mean(u),b=s.length,y=0,p=0,x=0,e=0;e<b;e++)y+=(s[e]-d)*(u[e]-g),p+=Math.pow(s[e]-d,2),x+=Math.pow(u[e]-g,2);return y/Math.sqrt(p*x)}catch(S){var _=S;return _=v.errorInfo(_),[v.error.v,_]}},NORM_S_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),t<=0||t>=1?v.error.nm:jStat.normal.inv(t,0,1)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},NORM_S_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getCellBoolen(arguments[1]);return q(l)?l:l?jStat.normal.cdf(t,0,1):jStat.normal.pdf(t,0,1)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},NORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))if(V(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))if(V(l)=="boolean")l.toString().toLowerCase()=="true"?l=1:l.toString().toLowerCase()=="false"&&(l=0);else return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))if(V(o)=="boolean")o.toString().toLowerCase()=="true"?o=1:o.toString().toLowerCase()=="false"&&(o=0);else return v.error.v;return o=parseFloat(o),t<=0||t>=1?v.error.nm:o<=0?v.error.nm:jStat.normal.inv(t,l,o)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},NORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))if(V(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getCellBoolen(arguments[3]);return q(a)?a:o<=0?v.error.nm:a?jStat.normal.cdf(t,l,o):jStat.normal.pdf(t,l,o)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},NEGBINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getCellBoolen(arguments[3]);return q(a)?a:o<0||o>1?v.error.nm:t<0||l<1?v.error.nm:a?jStat.negbin.cdf(t,l,o):jStat.negbin.pdf(t,l,o)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},MINA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!1))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(Y(l))t.push(l);else return v.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}return o.length===0?0:Math.min.apply(Math,o)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},MEDIAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else{if(!Y(l))return v.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)&&o.push(parseFloat(a))}return jStat.median(o)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},MAXA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!1))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(Y(l))t.push(l);else return v.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}return o.length===0?0:Math.max.apply(Math,o)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},LOGNORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);return q(o)?o:Y(o)?(o=parseFloat(o),t<=0||t>=1?v.error.nm:o<=0?v.error.nm:jStat.lognormal.inv(t,l,o)):v.error.v}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},LOGNORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getCellBoolen(arguments[3]);return q(a)?a:t<=0||o<=0?v.error.nm:a?jStat.lognormal.cdf(t,l,o):jStat.lognormal.pdf(t,l,o)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},Z_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[];if(V(arguments[0])=="array"){if(V(arguments[0][0])=="array"&&!j.isDyadicArr(arguments[0]))return v.error.v;t=t.concat(j.getDataArr(arguments[0],!0))}else V(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(j.getCellDataArr(arguments[0],"text",!0)):t.push(arguments[0]);for(var l=[],o=0;o<t.length;o++){var a=t[o];Y(a)&&l.push(parseFloat(a))}var s=j.getFirstValue(arguments[1]);if(q(s))return s;if(!Y(s))return v.error.v;if(s=parseFloat(s),l.length==0)return v.error.na;var u=j.standardDeviation_s(l);if(arguments.length==3){if(u=j.getFirstValue(arguments[2]),q(u))return u;if(!Y(u))return v.error.v;u=parseFloat(u)}var f=l.length,m=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,l);return 1-window.luckysheet_function.NORM_S_DIST.f((m-s)/(u/Math.sqrt(f)),"true")}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},PROB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[];if(V(arguments[0])=="array"){if(V(arguments[0][0])=="array"&&!j.isDyadicArr(arguments[0]))return v.error.v;t=t.concat(j.getDataArr(arguments[0],!1))}else V(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(j.getCellDataArr(arguments[0],"text",!1)):t.push(arguments[0]);var l=[];if(V(arguments[1])=="array"){if(V(arguments[1][0])=="array"&&!j.isDyadicArr(arguments[1]))return v.error.v;l=l.concat(j.getDataArr(arguments[1],!1))}else V(arguments[1])=="object"&&arguments[1].startCell!=null?l=l.concat(j.getCellDataArr(arguments[1],"text",!1)):l.push(arguments[1]);if(t.length!=l.length)return v.error.na;for(var o=[],a=[],s=0,e=0;e<t.length;e++){var u=t[e],f=l[e];if(Y(u)&&Y(f)&&(o.push(parseFloat(u)),a.push(parseFloat(f)),s+=parseFloat(f),parseFloat(f)<=0||parseFloat(f)>1))return v.error.nm}if(s!=1)return v.error.nm;var m=j.getFirstValue(arguments[2]);if(q(m))return m;if(!Y(m))return v.error.v;m=parseFloat(m);var d=m;if(arguments.length==4){if(d=j.getFirstValue(arguments[3]),q(d))return d;if(!Y(d))return v.error.v;d=parseFloat(d)}for(var g=0,e=0;e<o.length;e++)o[e]>=m&&o[e]<=d&&(g+=a[e]);return g}catch(y){var b=y;return b=v.errorInfo(b),[v.error.v,b]}},QUARTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[];if(V(arguments[0])=="array"){if(V(arguments[0][0])=="array"&&!j.isDyadicArr(arguments[0]))return v.error.v;t=t.concat(j.getDataArr(arguments[0],!0))}else if(V(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(j.getCellDataArr(arguments[0],"text",!0));else{if(!Y(arguments[0]))return v.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var o=t[e];Y(o)&&l.push(parseFloat(o))}var a=j.getFirstValue(arguments[1]);if(q(a))return a;if(!Y(a))return v.error.v;if(a=parseInt(a),l.length==0)return v.error.nm;if(a<=0||a>=4)return v.error.nm;switch(a){case 1:return window.luckysheet_function.PERCENTILE_EXC.f(l,.25);case 2:return window.luckysheet_function.PERCENTILE_EXC.f(l,.5);case 3:return window.luckysheet_function.PERCENTILE_EXC.f(l,.75)}}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},QUARTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[];if(V(arguments[0])=="array"){if(V(arguments[0][0])=="array"&&!j.isDyadicArr(arguments[0]))return v.error.v;t=t.concat(j.getDataArr(arguments[0],!0))}else if(V(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(j.getCellDataArr(arguments[0],"text",!0));else{if(!Y(arguments[0]))return v.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var o=t[e];Y(o)&&l.push(parseFloat(o))}var a=j.getFirstValue(arguments[1]);if(q(a))return a;if(!Y(a))return v.error.v;if(a=parseInt(a),l.length==0)return v.error.nm;if(a<0||a>4)return v.error.nm;switch(a){case 0:return Math.min.apply(Math,l);case 1:return window.luckysheet_function.PERCENTILE_INC.f(l,.25);case 2:return window.luckysheet_function.PERCENTILE_INC.f(l,.5);case 3:return window.luckysheet_function.PERCENTILE_INC.f(l,.75);case 4:return Math.max.apply(Math,l)}}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},POISSON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getCellBoolen(arguments[2]);return q(o)?o:t<0||l<0?v.error.nm:o?jStat.poisson.cdf(t,l):jStat.poisson.pdf(t,l)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},RSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else if(V(t)=="object"&&t.startCell!=null)l=l.concat(j.getCellDataArr(t,"text",!1));else{if(!Y(t))return v.error.v;l.push(t)}var o=arguments[1],a=[];if(V(o)=="array"){if(V(o[0])=="array"&&!j.isDyadicArr(o))return v.error.v;a=a.concat(j.getDataArr(o,!1))}else if(V(o)=="object"&&o.startCell!=null)a=a.concat(j.getCellDataArr(o,"text",!1));else{if(!Y(o))return v.error.v;a.push(o)}if(l.length!=a.length)return v.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];Y(f)&&Y(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}return s.length==0||u.length==0?v.error.d:Math.pow(window.luckysheet_function.PEARSON.f(s,u),2)}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},T_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getCellBoolen(arguments[2]);return q(o)?o:l<1?v.error.nm:o?jStat.studentt.cdf(t,l):jStat.studentt.pdf(t,l)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},T_DIST_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseInt(l),t<0||l<1?v.error.nm:(1-jStat.studentt.cdf(t,l))*2):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},T_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseInt(l),l<1?v.error.nm:1-jStat.studentt.cdf(t,l)):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},T_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseInt(l),t<=0||t>1?v.error.nm:l<1?v.error.nm:jStat.studentt.inv(t,l)):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},T_INV_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseInt(l),t<=0||t>1?v.error.nm:l<1?v.error.nm:Math.abs(jStat.studentt.inv(t/2,l))):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},T_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[];if(V(arguments[0])=="array"){if(V(arguments[0][0])=="array"&&!j.isDyadicArr(arguments[0]))return v.error.v;t=t.concat(j.getDataArr(arguments[0],!1))}else if(V(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(j.getCellDataArr(arguments[0],"text",!1));else{if(!Y(arguments[0]))return v.error.v;t.push(arguments[0])}var l=t,o=[];if(V(arguments[1])=="array"){if(V(arguments[1][0])=="array"&&!j.isDyadicArr(arguments[1]))return v.error.v;o=o.concat(j.getDataArr(arguments[1],!1))}else if(V(arguments[1])=="object"&&arguments[1].startCell!=null)o=o.concat(j.getCellDataArr(arguments[1],"text",!1));else{if(!Y(arguments[1]))return v.error.v;o.push(arguments[1])}var a=o,s=j.getFirstValue(arguments[2]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s);var u=j.getFirstValue(arguments[3]);if(q(u))return u;if(!Y(u))return v.error.v;if(u=parseInt(u),[1,2].indexOf(s)==-1)return v.error.nm;if([1,2,3].indexOf(u)==-1)return v.error.nm;var f=null,m=null;if(u==1){var d=[];for(e=0;e<l.length;e++)d.push(l[e]-a[e]);var g=Math.abs(jStat.mean(d)),b=j.standardDeviation_s(d);f=g/(b/Math.sqrt(l.length)),m=l.length-1}else{var y=jStat.mean(l),p=jStat.mean(a),x=j.variance_s(l),_=j.variance_s(a);switch(f=Math.abs(y-p)/Math.sqrt(x/l.length+_/a.length),u){case 2:m=l.length+a.length-2;break;case 3:m=Math.pow(x/l.length+_/a.length,2)/(Math.pow(x/l.length,2)/(l.length-1)+Math.pow(_/a.length,2)/(a.length-1));break}}if(s==1)var S=window.luckysheet_function.T_DIST_RT.f(f,m);else if(s==2)var S=window.luckysheet_function.T_DIST_2T.f(f,m);return S}catch(O){var I=O;return I=v.errorInfo(I),[v.error.v,I]}},F_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=j.getCellBoolen(arguments[3]);return q(a)?a:t<0?v.error.nm:l<1?v.error.nm:o<1?v.error.nm:a?jStat.centralF.cdf(t,l,o):jStat.centralF.pdf(t,l,o)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},F_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getFirstValue(arguments[2]);return q(o)?o:Y(o)?(o=parseInt(o),t<0?v.error.nm:l<1?v.error.nm:o<1?v.error.nm:1-jStat.centralF.cdf(t,l,o)):v.error.v}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},VAR_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else{if(!Y(l))return v.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)&&o.push(parseFloat(a))}if(o.length==0)return v.error.d;for(var s=o.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-f,2);return u/s}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},VAR_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else{if(!Y(l))return v.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)&&o.push(parseFloat(a))}if(o.length==0)return v.error.d;for(var s=o.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-f,2);return u/(s-1)}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},VARA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!1))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(Y(l))t.push(l);else return v.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}for(var s=o.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-f,2);return u/(s-1)}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},VARPA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!1))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(Y(l))t.push(l);else return v.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}for(var s=o.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-f,2);return u/s}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},STEYX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[];if(V(arguments[0])=="array"){if(V(arguments[0][0])=="array"&&!j.isDyadicArr(arguments[0]))return v.error.v;t=t.concat(j.getDataArr(arguments[0],!1))}else if(V(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(j.getCellDataArr(arguments[0],"text",!1));else{if(!Y(arguments[0]))return v.error.v;t.push(arguments[0])}var l=[];if(V(arguments[1])=="array"){if(V(arguments[1][0])=="array"&&!j.isDyadicArr(arguments[1]))return v.error.v;l=l.concat(j.getDataArr(arguments[1],!1))}else if(V(arguments[1])=="object"&&arguments[1].startCell!=null)l=l.concat(j.getCellDataArr(arguments[1],"text",!1));else{if(!Y(arguments[1]))return v.error.v;l.push(arguments[1])}if(t.length!=l.length)return v.error.na;for(var o=[],a=[],e=0;e<t.length;e++){var s=t[e],u=l[e];Y(s)&&Y(u)&&(o.push(parseFloat(s)),a.push(parseFloat(u)))}if(o.length<3||a.length<3)return v.error.d;for(var f=jStat.mean(a),m=jStat.mean(o),d=a.length,g=0,b=0,y=0,e=0;e<d;e++)g+=Math.pow(o[e]-m,2),b+=(a[e]-f)*(o[e]-m),y+=Math.pow(a[e]-f,2);return Math.sqrt((g-b*b/y)/(d-2))}catch(x){var p=x;return p=v.errorInfo(p),[v.error.v,p]}},STANDARDIZE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);return q(o)?o:Y(o)?(o=parseFloat(o),o<=0?v.error.nm:(t-l)/o):v.error.v}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},SMALL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[];if(V(arguments[0])=="array"){if(V(arguments[0][0])=="array"&&!j.isDyadicArr(arguments[0]))return v.error.v;t=t.concat(j.getDataArr(arguments[0],!0))}else if(V(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(j.getCellDataArr(arguments[0],"number",!0));else{if(!Y(arguments[0]))return v.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var o=t[e];Y(o)&&l.push(parseFloat(o))}var a=j.getFirstValue(arguments[1]);return q(a)?a:Y(a)?(a=parseInt(a),l.length==0?v.error.nm:a<=0||a>l.length?v.error.nm:l.sort(function(u,f){return u-f})[a-1]):v.error.v}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},SLOPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[];if(V(arguments[0])=="array"){if(V(arguments[0][0])=="array"&&!j.isDyadicArr(arguments[0]))return v.error.v;t=t.concat(j.getDataArr(arguments[0],!1))}else if(V(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(j.getCellDataArr(arguments[0],"text",!1));else{if(!Y(arguments[0]))return v.error.v;t.push(arguments[0])}var l=[];if(V(arguments[1])=="array"){if(V(arguments[1][0])=="array"&&!j.isDyadicArr(arguments[1]))return v.error.v;l=l.concat(j.getDataArr(arguments[1],!1))}else if(V(arguments[1])=="object"&&arguments[1].startCell!=null)l=l.concat(j.getCellDataArr(arguments[1],"text",!1));else{if(!Y(arguments[1]))return v.error.v;l.push(arguments[1])}if(t.length!=l.length)return v.error.na;for(var o=[],a=[],e=0;e<t.length;e++){var s=t[e],u=l[e];Y(s)&&Y(u)&&(o.push(parseFloat(s)),a.push(parseFloat(u)))}if(o.length<3||a.length<3)return v.error.d;for(var f=jStat.mean(a),m=jStat.mean(o),d=a.length,g=0,b=0,e=0;e<d;e++)g+=(a[e]-f)*(o[e]-m),b+=Math.pow(a[e]-f,2);return g/b}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},SKEW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else{if(!Y(l))return v.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)&&o.push(parseFloat(a))}if(o.length<3||j.standardDeviation_s(o)==0)return v.error.d;for(var s=jStat.mean(o),u=o.length,f=0,e=0;e<u;e++)f+=Math.pow(o[e]-s,3);return u*f/((u-1)*(u-2)*Math.pow(jStat.stdev(o,!0),3))}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},SKEW_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;t=t.concat(j.getDataArr(l,!0))}else if(V(l)=="object"&&l.startCell!=null)t=t.concat(j.getCellDataArr(l,"number",!0));else{if(!Y(l))return v.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];Y(a)&&o.push(parseFloat(a))}if(o.length<3||j.standardDeviation_s(o)==0)return v.error.d;for(var s=jStat.mean(o),u=o.length,f=0,m=0,e=0;e<u;e++)m+=Math.pow(o[e]-s,3),f+=Math.pow(o[e]-s,2);return m=m/u,f=f/u,m/Math.pow(f,3/2)}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},ADDRESS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=1;if(arguments.length>=3){if(o=j.getFirstValue(arguments[2]),q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o)}var a=!0;if(arguments.length>=4&&(a=j.getCellBoolen(arguments[3]),q(a)))return a;if(t<=0||l<=0)return v.error.v;if([1,2,3,4].indexOf(o)==-1)return v.error.v;var s;if(a)switch(l=Qt(l-1),o){case 1:s="$"+l+"$"+t;break;case 2:s=l+"$"+t;break;case 3:s="$"+l+t;break;case 4:s=l+t;break}else switch(o){case 1:s="R"+t+"C"+l;break;case 2:s="R"+t+"C["+l+"]";break;case 3:s="R["+t+"]C"+l;break;case 4:s="R["+t+"]C["+l+"]";break}if(arguments.length==5){var u=j.getFirstValue(arguments[4]);return q(u)?u:u+"!"+s}else return s}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},INDIRECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;var l=!0;if(arguments.length==2&&(l=j.getCellBoolen(arguments[1]),q(l)))return l;let a=Yl(),s=$e(h.calculateSheetIndex),u=a[s],f=u.data;if(v.iscelldata(t)){let m=v.getcellrange(t),d=m.row[0],g=m.column[0];if(d<0||d>=f.length||g<0||g>=f[0].length)return v.error.r;if(f[d][g]==null||rt(f[d][g].v))return 0;let b=f[d][g].v;if(v.execFunctionGlobalData!=null){let p=v.execFunctionGlobalData[d+"_"+g+"_"+h.calculateSheetIndex];p!=null&&(b=p.v)}return{sheetName:u.name,startCell:t,rowl:d,coll:g,data:b}}else return v.error.r}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ROW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{if(arguments.length==1){var t;if(V(arguments[0])=="array")return v.error.v;if(V(arguments[0])=="object"&&arguments[0].startCell!=null?t=arguments[0].startCell:t=arguments[0],v.iscelldata(t)){var l=v.getcellrange(t);return l.row[0]+1}else return v.error.v}else return window.luckysheetCurrentRow+1}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ROWS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return V(arguments[0])=="array"?V(arguments[0][0])=="array"?arguments[0].length:1:V(arguments[0])=="object"&&arguments[0].startCell!=null?arguments[0].rowl:1}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},COLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{if(arguments.length==1){var t;if(V(arguments[0])=="array")return v.error.v;if(V(arguments[0])=="object"&&arguments[0].startCell!=null?t=arguments[0].startCell:t=arguments[0],v.iscelldata(t)){var l=v.getcellrange(t);return l.column[0]+1}else return v.error.v}else return window.luckysheetCurrentColumn+1}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},COLUMNS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return V(arguments[0])=="array"?V(arguments[0][0])=="array"?arguments[0][0].length:arguments[0].length:V(arguments[0])=="object"&&arguments[0].startCell!=null?arguments[0].coll:1}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},OFFSET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{if(!(V(arguments[0])=="object"&&arguments[0].startCell!=null))return v.error.v;var t=arguments[0].startCell;let S=arguments[0].sheetName;var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=arguments[0].rowl;if(arguments.length>=4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a)}var s=arguments[0].coll;if(arguments.length==5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s)}if(a<1||s<1)return v.error.r;var u=v.getcellrange(t),f=u.row[0],m=u.column[0];f+=l,m+=o;var d=f+a-1,g=m+s-1;let I=Yl(),O=$e(h.calculateSheetIndex),F=I[O].data;if(f<0||d>=F.length||m<0||g>=F[0].length)return v.error.r;for(var b=[],y=f;y<=d;y++){for(var p=[],x=m;x<=g;x++)if(v.execFunctionGlobalData!=null&&v.execFunctionGlobalData[y+"_"+x+"_"+h.calculateSheetIndex]!=null){let k=v.execFunctionGlobalData[y+"_"+x+"_"+h.calculateSheetIndex];k!=null?p.push(k.v):p.push(0)}else F[y][x]!=null&&!rt(F[y][x].v)?p.push(F[y][x].v):p.push(0);b.push(p)}return{sheetName:S,startCell:Al(h.calculateSheetIndex,{row:[f,d],column:[m,g]}),rowl:f,coll:m,data:b}}catch(S){var _=S;return _=v.errorInfo(_),[v.error.v,_]}},MATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;var l=arguments[1],o=[];if(V(l)=="array"){if(V(l[0])=="array")return j.isDyadicArr(l)?v.error.na:v.error.v;for(var e=0;e<l.length;e++)o.push(l[e])}else if(V(l)=="object"&&l.startCell!=null){if(l.rowl>1&&l.coll>1)return v.error.na;if(l.data!=null)if(V(l.data)=="array")for(var e=0;e<l.data.length;e++)for(var a=0;a<l.data[e].length;a++)l.data[e][a]!=null&&!rt(l.data[e][a].v)&&o.push(l.data[e][a].v);else o.push(l.data.v)}var s=1;if(arguments.length==3){if(s=j.getFirstValue(arguments[2]),q(s))return s;if(!Y(s))return v.error.v;s=Math.ceil(parseFloat(s))}if([-1,0,1].indexOf(s)==-1)return v.error.na;for(var u,f,m=0;m<o.length;m++)if(s===1){if(o[m]===t)return m+1;o[m]<t&&(f?o[m]>f&&(u=m+1,f=o[m]):(u=m+1,f=o[m]))}else if(s===0){if(typeof t=="string"){if(t=t.replace(/\?/g,"."),o[m].toLowerCase().match(t.toLowerCase()))return m+1}else if(o[m]===t)return m+1}else if(s===-1){if(o[m]===t)return m+1;o[m]>t&&(f?o[m]<f&&(u=m+1,f=o[m]):(u=m+1,f=o[m]))}return u||v.error.na}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},VLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;if(t.toString().replace(/\s/g,"")=="")return v.error.na;var l=arguments[1],o=[];if(V(l)=="array")if(V(l[0])=="array"){if(!j.isDyadicArr(l))return v.error.v;for(var e=0;e<l.length;e++){for(var a=[],s=0;s<l[e].length;s++)a.push(l[e][s]);o.push(a)}}else{for(var a=[],e=0;e<l.length;e++)a.push(l[e]);o.push(a)}else if(V(l)=="object"&&l.startCell!=null)o=j.getCellDataDyadicArr(l,"text");else return v.error.v;var u=j.getFirstValue(arguments[2]);if(q(u))return u;if(!Y(u))return v.error.v;u=parseInt(u);var f=!0;if(arguments.length==4&&(f=j.getCellBoolen(arguments[3]),q(f)))return f;if(u<1)return v.error.v;if(u>o[0].length)return v.error.r;if(f){o=So(o,0,!0);for(var m=0;m<o.length;m++){var d=o[m][0],g;if(Zl(t)&&Zl(d)?g=Br(t,d):Y(t)&&Y(d)?g=(0,Ku.default)(t).value()-(0,Ku.default)(d).value():!Y(t)&&!Y(d)?g=t.localeCompare(d,"zh"):Y(t)?Y(d)||(g=-1):g=1,g<0)return m==0?v.error.na:o[m-1][u-1];if(m==o.length-1)return o[m][u-1]}}else{for(var b=null,m=0;m<o.length;m++)if(t.toString()==o[m][0].toString()){b=m;break}return b==null?v.error.na:o[b][u-1]}}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},HLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=arguments[0];typeof o=="object"&&(o=arguments[0].data,V(o)=="array"?(o=o[r],V(o)=="array"&&(o=o[m])):o=o.v);var a=arguments[1].data,s=arguments[2],u=!1;if(arguments.length>3&&(u=!!arguments[3]),s>a.rowl)return[v.error.v,"\u7D22\u5F15\u8D85\u8FC7\u4E86\u8303\u56F4\u7684\u957F\u5EA6\uFF0C"+a[0].length];if(s<1)return[v.error.v,"\u7D22\u5F15\u5FC5\u987B\u5927\u4E8E1"];for(var f=v.error.na,m=0;m<a[0].length;m++){var d=Mt(0,m,a),g=Mt(s-1,m,a);if(u)d.indexOf(o)>-1&&(f=g);else if(v.acompareb(d,o))return f=g,f}return f}catch(y){var b=y;return b=v.errorInfo(b),[v.error.v,b]}},LOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{let p=function(x,_){return _-x};var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=arguments[0];typeof o=="object"&&(o=arguments[0].data,V(o)=="array"?(o=o[r],V(o)=="array"&&(o=o[c])):o=o.v);var a=arguments[1].data,s,u=v.error.na;if(a=v.getRangeArray(a)[0],arguments[2]&&(s=arguments[2].data,s=v.getRangeArray(s)[0]),typeof o=="string")for(var e=0;e<a.length;e++){var f=a[e],m;arguments[2]?(m=s[e],f==o&&(u=m)):v.acompareb(f,o)&&(u=f)}else if(xi(o)=="num"){for(var d=[],e=0;e<a.length;e++){var f=a[e],m;if(arguments[2]){if(m=s[e],f==o)return u=m,u;f!=o&&xi(f)=="num"&&d.push(f)}else{if(f==o)return u=f,u;f!=o&&xi(f)=="num"&&d.push(f)}}if(d.length!=0){d.push(o),d.sort(p);var g=d.indexOf(o);if(g==d.length-1)return[v.error.na,"\u627E\u4E0D\u5230\u5BF9\u5E94\u53C2\u6570"];var b=d[g+1];if(arguments[2]){var e=a.indexOf(b);u=s[e]}else u=b}}return u}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},INDEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];let b=!1;if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=j.getDataDyadicArr(t)}else V(t)=="object"&&t.startCell!=null&&(l=j.getCellDataDyadicArr(t,"number"),b=!0);var o=l.length,a=l[0].length,s=j.getFirstValue(arguments[1]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s);var u=j.getFirstValue(arguments[2]);if(q(u))return u;if(s<0||Y(u)&&u<0)return v.error.v;if(s>o||Y(u)&&u>a)return v.error.r;if(b){var f=v.getcellrange(t.startCell),m=f.row[0],d=f.column[0];let y=l;s==0||u==0?(s==0?(y=l[0],s=1):y=l[s-1],Y(u)?u==0?(y=y[0],u=1):y=y[u-1]:u=1):(Y(s)||(s=1),Y(u)||(u=1),y=l[s-1][u-1]);let p=m+s-1,x=d+u-1;return{sheetName:t.sheetName,startCell:Al(h.calculateSheetIndex,{row:[p,p],column:[x,x]}),rowl:p,coll:x,data:y}}else return Y(u)?(u=parseInt(u),s<=0||u<=0?v.error.v:l[s-1][u-1]):v.error.v}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},GETPIVOTDATA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return v.error.v}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},CHOOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;if(t=parseInt(t),t<1||t>arguments.length-1)return v.error.v;var l=arguments[t];if(V(l)=="array")return V(l[0])=="array"&&!j.isDyadicArr(l)?v.error.v:l;if(V(l)=="object"&&l.startCell!=null){if(l.data==null)return 0;if(V(l.data)=="array"){var o=j.getCellDataDyadicArr(l.data,"number");return o}else return rt(l.data.v)?0:l.data.v}else return l}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},HYPERLINK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return v.error.v}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},TIME:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;if(o=parseInt(o),t<0||t>32767)return v.error.nm;if(t>24&&(t=t%24),l<0||l>32767)return v.error.nm;if(o<0||o>32767)return v.error.nm;var a=(0,ue.default)().set({hour:t,minute:l,second:o});return(0,ue.default)(a).format("h:mm:ss a")}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},TIMEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);return q(t)?t:(0,ue.default)(t).isValid()?(3600*(0,ue.default)(t).get("hour")+60*(0,ue.default)(t).get("minute")+(0,ue.default)(t).get("second"))/86400:v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},EOMONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;if(l=parseInt(l),!(0,ue.default)(t).isValid())return v.error.v;var o=(0,ue.default)(t).add(l+1,"months").set("date",1).subtract(1,"days"),a=nl((0,ue.default)(o).format("YYYY-MM-DD H:mm:ss")),s=a[2];return s}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},EDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;if(l=parseInt(l),!(0,ue.default)(t).isValid())return v.error.v;var o=(0,ue.default)(t).add(l,"months"),a=nl((0,ue.default)(o).format("YYYY-MM-DD h:mm:ss")),s=a[2];return s}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},SECOND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=(0,ue.default)(t).seconds();return l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},MINUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=(0,ue.default)(t).minutes();return l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},HOUR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=(0,ue.default)(t).hours();return l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},NOW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return(0,ue.default)().format("YYYY-M-D HH:mm")}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},NETWORKDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{if(arguments.length==3)var t=window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1,arguments[2]);else var t=window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1);return t}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},NETWORKDAYS_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],l=j.getCellDate(arguments[0]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getCellDate(arguments[1]);if(q(o))return o;if(!(0,ue.default)(o).isValid())return v.error.v;var a=t[1];if(arguments.length>=3&&(a=arguments[2],!(typeof a=="string"&&a.length=="7"&&/^[0-1]{7}$/g.test(a)))){if(a=j.getFirstValue(arguments[2]),q(a))return a;if(!Y(a))return v.error.v;if(a=parseInt(a),a<1||a>7&&a<11||a>17)return v.error.nm;a=t[a]}var s=[];if(arguments.length==4&&(s=j.getCellrangeDate(arguments[3]),q(s)))return s;for(var e=0;e<s.length;e++)if(!(0,ue.default)(s[e]).isValid())return v.error.v;var u=(0,ue.default)(o).diff((0,ue.default)(l),"days")+1,f=u,m=(0,ue.default)(l);for(e=0;e<u;e++){var d=(0,ue.default)(m).weekday(),g=!1;V(a)=="array"?(d===a[0]||d===a[1])&&(g=!0):(d==0&&(d=7),a.charAt(d-1)=="0"&&(g=!0));for(var b=0;b<s.length;b++)if((0,ue.default)(m).diff((0,ue.default)(s[b]),"days")===0){g=!0;break}g&&f--,m=(0,ue.default)(m).add(1,"days")}return f}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},ISOWEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);return q(t)?t:(0,ue.default)(t).isValid()?(0,ue.default)(t).isoWeeks():v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},WEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[void 0,7,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,7],l=j.getCellDate(arguments[0]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=1;if(arguments.length==2){if(o=j.getFirstValue(arguments[1]),q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o)}if(o==21)return window.luckysheet_function.ISOWEEKNUM.f(arguments[0]);if([1,2,11,12,13,14,15,16,17].indexOf(o)==-1)return v.error.nm;var a=t[o],s=(0,ue.default)(l).isoWeekday()>=a?1:0,u=(0,ue.default)(l).isoWeeks()+s;return u}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},WEEKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=j.getCellDate(arguments[0]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=1;if(arguments.length==2){if(o=j.getFirstValue(arguments[1]),q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o)}if([1,2,3,11,12,13,14,15,16,17].indexOf(o)==-1)return v.error.nm;var a=t[o][(0,ue.default)(l).day()];return a}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},DAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);return q(t)?t:(0,ue.default)(t).isValid()?(0,ue.default)(t).date():v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},DAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=(0,ue.default)(t).diff((0,ue.default)(l),"days");return o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},DAYS360:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=!1;if(arguments.length==3&&(o=j.getCellBoolen(arguments[2]),q(o)))return o;var a=(0,ue.default)(t).month(),s=(0,ue.default)(l).month(),u,f;if(o)u=(0,ue.default)(t).date()===31?30:(0,ue.default)(t).date(),f=(0,ue.default)(l).date()===31?30:(0,ue.default)(l).date();else{var m=(0,ue.default)().set({year:(0,ue.default)(t).year(),month:a+1,date:0}).date(),d=(0,ue.default)().set({year:(0,ue.default)(l).year(),month:s+1,date:0}).date();u=(0,ue.default)(t).date()===m?30:(0,ue.default)(t).date(),(0,ue.default)(l).date()===d?u<30?(s++,f=1):f=30:f=(0,ue.default)(l).date()}var g=360*(0,ue.default)(l).diff((0,ue.default)(t),"years")+30*(s-a)+(f-u);return g}catch(y){var b=y;return b=v.errorInfo(b),[v.error.v,b]}},DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;if(o=parseInt(o),t<0||t>=1e4)return v.error.nm;t>=0&&t<=1899&&(t=t+1900);var a=(0,ue.default)().set({year:t,month:l-1,date:o});return(0,ue.default)(a).year()<1900?v.error.nm:(0,ue.default)(a).format("YYYY-MM-DD")}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},DATEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;t=(0,ue.default)(t).format("YYYY-MM-DD");var l=nl(t)[2];return l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},DATEDIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{$a(arguments);for(var e=0;e<arguments.length-1;e++)if(arguments[e]=moment.fromOADate(arguments[e]).format("l"),!Zl(arguments[e]))return v.error.v;var t=(0,ue.default)(arguments[0]),l=(0,ue.default)(arguments[1]),o=arguments[2],a=v.error.v;if(window.luckysheet_function.DAYS.f(l,t)<0)return v.error.v;switch(o){case"Y":case"y":a=l.diff(t,"years",!1);break;case"M":case"m":a=l.diff(t,"months",!1);break;case"D":case"d":a=l.diff(t,"days",!1);break;case"MD":case"md":a=l.format("DD")-t.format("DD");break;case"YM":case"ym":var s=parseInt(t.format("M")),u=parseInt(l.format("M"));a=s<=u?u-s:u+12-s;break;case"YD":case"yd":var s=nl(t.format("MM-DD"))[2],u=nl(l.format("MM-DD"))[2];a=s<=u?u-s:u+365-s;break;default:a=v.error.v}return a}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},WORKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{if(arguments.length==3)var t=window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1,arguments[2]);else var t=window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1);return t}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},WORKDAY_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],l=j.getCellDate(arguments[0]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[1]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=t[1];if(arguments.length>=3&&(a=arguments[2],!(typeof a=="string"&&a.length=="7"&&/^[0-1]{7}$/g.test(a)))){if(a=j.getFirstValue(arguments[2]),q(a))return a;if(!Y(a))return v.error.v;if(a=parseInt(a),a<1||a>7&&a<11||a>17)return v.error.nm;a=t[a]}var s=[];if(arguments.length==4&&(s=j.getCellrangeDate(arguments[3]),q(s)))return s;for(var e=0;e<s.length;e++)if(!(0,ue.default)(s[e]).isValid())return v.error.v;for(var u=0;u<o;){l=(0,ue.default)(l).add(1,"days");var f=(0,ue.default)(l).weekday();if(V(a)){if(f===a[0]||f===a[1])continue}else if(f==0&&(f=7),a.charAt(f-1)=="0")continue;for(var m=0;m<s.length;m++)if((0,ue.default)(l).diff((0,ue.default)(s[m]),"days")===0){u--;break}u++}return(0,ue.default)(l).format("YYYY-MM-DD")}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},YEAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);return q(t)?t:(0,ue.default)(t).isValid()?(0,ue.default)(t).year():v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},YEARFRAC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=0;if(arguments.length==3){if(o=j.getFirstValue(arguments[2]),q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o)}if(o<0||o>4)return v.error.nm;var a=(0,ue.default)(t).date(),s=(0,ue.default)(t).month()+1,u=(0,ue.default)(t).year(),f=(0,ue.default)(l).date(),m=(0,ue.default)(l).month()+1,d=(0,ue.default)(l).year(),g;switch(o){case 0:a===31&&f===31?(a=30,f=30):a===31?a=30:a===30&&f===31&&(f=30),g=(f+m*30+d*360-(a+s*30+u*360))/360;break;case 1:var b=365;if(u===d||u+1===d&&(s>m||s===m&&a>=f))return(u===d&&j.isLeapYear(u)||j.feb29Between(t,l)||m===1&&f===29)&&(b=366),(0,ue.default)(l).diff((0,ue.default)(t),"days")/b;var y=d-u+1,p=((0,ue.default)().set({year:d+1,month:0,date:1})-(0,ue.default)().set({year:u,month:0,date:1}))/1e3/60/60/24,x=p/y;g=(0,ue.default)(l).diff((0,ue.default)(t),"days")/x;break;case 2:g=(0,ue.default)(l).diff((0,ue.default)(t),"days")/360;break;case 3:g=(0,ue.default)(l).diff((0,ue.default)(t),"days")/365;break;case 4:g=(f+m*30+d*360-(a+s*30+u*360))/360;break}return g}catch(S){var _=S;return _=v.errorInfo(_),[v.error.v,_]}},TODAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return(0,ue.default)().format("YYYY-MM-DD")}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},MONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);return q(t)?t:(0,ue.default)(t).isValid()?(0,ue.default)(t).month()+1:v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},EFFECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseInt(l),t<=0||l<1?v.error.nm:Math.pow(1+t/l,l)-1):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},DOLLAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=2;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}l>9&&(l=9);for(var o="0.",e=1;e<=l;e++)o+="0";var a=t>0?1:-1;return a*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},DOLLARDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;if(l=parseInt(l),l<0)return v.error.nm;if(l==0)return v.error.d;var o=parseInt(t,10);o+=t%1*Math.pow(10,Math.ceil(Math.log(l)/Math.LN10))/l;var a=Math.pow(10,Math.ceil(Math.log(l)/Math.LN2)+1);return o=Math.round(o*a)/a,o}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},DOLLARFR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;if(l=parseInt(l),l<0)return v.error.nm;if(l==0)return v.error.d;var o=parseInt(t,10);return o+=t%1*Math.pow(10,-Math.ceil(Math.log(l)/Math.LN10))*l,o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},DB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a);var s=12;if(arguments.length==5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s)}if(t<0||l<0||o<0||a<0)return v.error.nm;if(s<1||s>12)return v.error.nm;if(a>o)return v.error.nm;if(l>=t)return 0;for(var u=(1-Math.pow(l/t,1/o)).toFixed(3),f=t*u*s/12,m=f,d=0,g=a===o?o-1:a,e=2;e<=g;e++)d=(t-m)*u,m+=d;if(a===1)var b=f;else if(a===o)var b=(t-m)*u;else var b=d;return b}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},DDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a);var s=2;if(arguments.length==5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}if(t<0||l<0||o<0||a<0||s<=0)return v.error.nm;if(a>o)return v.error.nm;if(l>=t)return 0;for(var u=0,f=0,e=1;e<=a;e++)f=Math.min((t-u)*(s/o),t-l-u),u+=f;return f}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},RATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}var u=.1;if(arguments.length==6){if(u=j.getFirstValue(arguments[5]),q(u))return u;if(!Y(u))return v.error.v;u=parseFloat(u)}if(s!=0&&s!=1)return v.error.nm;for(var f=1e-6,m=100,d=0,g=!1,b=u;d<m&&!g;){var y=Math.pow(b+1,t),p=Math.pow(b+1,t-1),x=a+y*o+l*(y-1)*(b*s+1)/b,_=t*p*o-l*(y-1)*(b*s+1)/Math.pow(b,2),S=t*l*p*(b*s+1)/b+l*(y-1)*s/b,I=b-x/(_+S);Math.abs(I-b)<f&&(g=!0),d++,b=I}return g?b:v.error.nm}catch(F){var O=F;return O=v.errorInfo(O),[v.error.v,O]}},CUMPRINC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a);var s=j.getFirstValue(arguments[4]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s);var u=j.getFirstValue(arguments[5]);if(q(u))return u;if(!Y(u))return v.error.v;if(u=parseFloat(u),t<=0||l<=0||o<=0)return v.error.nm;if(a<1||s<1||a>s)return v.error.nm;if(u!=0&&u!=1)return v.error.nm;var f=window.luckysheet_function.PMT.f(t,l,o,0,u),m=0;a===1&&(u===0?m=f+o*t:m=f,a++);for(var e=a;e<=s;e++)u>0?m+=f-(window.luckysheet_function.FV.f(t,e-2,f,o,1)-f)*t:m+=f-window.luckysheet_function.FV.f(t,e-1,f,o,0)*t;return m}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},COUPNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=0;if(arguments.length==4){var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return v.error.nm;if(a<0||a>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var s=(0,ue.default)(t).date(),u=(0,ue.default)(t).month()+1,f=(0,ue.default)(t).year(),m=(0,ue.default)(l).date(),d=(0,ue.default)(l).month()+1,g=(0,ue.default)(l).year(),b;switch(a){case 0:s===31&&m===31?(s=30,m=30):s===31?s=30:s===30&&m===31&&(m=30),b=(m+d*30+g*360-(s+u*30+f*360))/(360/o);break;case 1:var y=365;if(f===g||f+1===g&&(u>d||u===d&&s>=m))return(f===g&&j.isLeapYear(f)||j.feb29Between(t,l)||d===1&&m===29)&&(y=366),(0,ue.default)(l).diff((0,ue.default)(t),"days")/(y/o);var p=g-f+1,x=((0,ue.default)().set({year:g+1,month:0,date:1})-(0,ue.default)().set({year:f,month:0,date:1}))/1e3/60/60/24,_=x/p;b=(0,ue.default)(l).diff((0,ue.default)(t),"days")/(_/o);break;case 2:b=(0,ue.default)(l).diff((0,ue.default)(t),"days")/(360/o);break;case 3:b=(0,ue.default)(l).diff((0,ue.default)(t),"days")/(365/o);break;case 4:b=(m+d*30+g*360-(s+u*30+f*360))/(360/o);break}return Math.round(b)}catch(I){var S=I;return S=v.errorInfo(S),[v.error.v,S]}},SYD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);return q(a)?a:Y(a)?(a=parseInt(a),o==0?v.error.nm:a<1||a>o?v.error.nm:(t-l)*(o-a+1)*2/(o*(o+1))):v.error.v}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},TBILLEQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);return q(o)?o:Y(o)?(o=parseFloat(o),o<=0?v.error.nm:(0,ue.default)(t)-(0,ue.default)(l)>0?v.error.nm:(0,ue.default)(l)-(0,ue.default)(t)>365*24*60*60*1e3?v.error.nm:365*o/(360-o*(0,ue.default)(l).diff((0,ue.default)(t),"days"))):v.error.v}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},TBILLYIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);return q(o)?o:Y(o)?(o=parseFloat(o),o<=0?v.error.nm:(0,ue.default)(t)-(0,ue.default)(l)>=0?v.error.nm:(0,ue.default)(l)-(0,ue.default)(t)>365*24*60*60*1e3?v.error.nm:(100-o)/o*(360/(0,ue.default)(l).diff((0,ue.default)(t),"days"))):v.error.v}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},TBILLPRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);return q(o)?o:Y(o)?(o=parseFloat(o),o<=0?v.error.nm:(0,ue.default)(t)-(0,ue.default)(l)>0?v.error.nm:(0,ue.default)(l)-(0,ue.default)(t)>365*24*60*60*1e3?v.error.nm:100*(1-o*(0,ue.default)(l).diff((0,ue.default)(t),"days")/360)):v.error.v}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},PV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return v.error.nm;if(t===0)var u=-o*l-a;else var u=((1-Math.pow(1+t,l))/t*o*(1+t*s)-a)/Math.pow(1+t,l);return u}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},ACCRINT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getCellDate(arguments[2]);if(q(o))return o;if(!(0,ue.default)(o).isValid())return v.error.v;var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=j.getFirstValue(arguments[4]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s);var u=j.getFirstValue(arguments[5]);if(q(u))return u;if(!Y(u))return v.error.v;u=parseInt(u);var f=0;if(arguments.length>=7){if(f=j.getFirstValue(arguments[6]),q(f))return f;if(!Y(f))return v.error.v;f=parseInt(f)}var m=!0;if(arguments.length==8&&(m=j.getCellBoolen(arguments[7]),q(m)))return m;if(a<=0||s<=0)return v.error.nm;if(u!=1&&u!=2&&u!=4)return v.error.nm;if(f<0||f>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(o)>=0)return v.error.nm;var d;if((0,ue.default)(o)-(0,ue.default)(l)>=0&&!m){var g=(0,ue.default)(l).date(),b=(0,ue.default)(l).month()+1,y=(0,ue.default)(l).year(),p=(0,ue.default)(o).date(),x=(0,ue.default)(o).month()+1,_=(0,ue.default)(o).year();switch(f){case 0:g===31&&p===31?(g=30,p=30):g===31?g=30:g===30&&p===31&&(p=30),d=(p+x*30+_*360-(g+b*30+y*360))/360;break;case 1:var S=365;if(y===_||y+1===_&&(b>x||b===x&&g>=p))return(y===_&&j.isLeapYear(y)||j.feb29Between(l,o)||x===1&&p===29)&&(S=366),(0,ue.default)(o).diff((0,ue.default)(l),"days")/S;var I=_-y+1,O=((0,ue.default)().set({year:_+1,month:0,date:1})-(0,ue.default)().set({year:y,month:0,date:1}))/1e3/60/60/24,F=O/I;d=(0,ue.default)(o).diff((0,ue.default)(l),"days")/F;break;case 2:d=(0,ue.default)(o).diff((0,ue.default)(l),"days")/360;break;case 3:d=(0,ue.default)(o).diff((0,ue.default)(l),"days")/365;break;case 4:d=(p+x*30+_*360-(g+b*30+y*360))/360;break}}else{var g=(0,ue.default)(t).date(),b=(0,ue.default)(t).month()+1,y=(0,ue.default)(t).year(),p=(0,ue.default)(o).date(),x=(0,ue.default)(o).month()+1,_=(0,ue.default)(o).year();switch(f){case 0:g===31&&p===31?(g=30,p=30):g===31?g=30:g===30&&p===31&&(p=30),d=(p+x*30+_*360-(g+b*30+y*360))/360;break;case 1:var S=365;if(y===_||y+1===_&&(b>x||b===x&&g>=p))return(y===_&&j.isLeapYear(y)||j.feb29Between(t,o)||x===1&&p===29)&&(S=366),(0,ue.default)(o).diff((0,ue.default)(t),"days")/S;var I=_-y+1,O=((0,ue.default)().set({year:_+1,month:0,date:1})-(0,ue.default)().set({year:y,month:0,date:1}))/1e3/60/60/24,F=O/I;d=(0,ue.default)(o).diff((0,ue.default)(t),"days")/F;break;case 2:d=(0,ue.default)(o).diff((0,ue.default)(t),"days")/360;break;case 3:d=(0,ue.default)(o).diff((0,ue.default)(t),"days")/365;break;case 4:d=(p+x*30+_*360-(g+b*30+y*360))/360;break}}return s*a*d}catch(k){var D=k;return D=v.errorInfo(D),[v.error.v,D]}},ACCRINTM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s)}if(o<=0||a<=0)return v.error.nm;if(s<0||s>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var u=(0,ue.default)(t).date(),f=(0,ue.default)(t).month()+1,m=(0,ue.default)(t).year(),d=(0,ue.default)(l).date(),g=(0,ue.default)(l).month()+1,b=(0,ue.default)(l).year(),y;switch(s){case 0:u===31&&d===31?(u=30,d=30):u===31?u=30:u===30&&d===31&&(d=30),y=(d+g*30+b*360-(u+f*30+m*360))/360;break;case 1:var p=365;if(m===b||m+1===b&&(f>g||f===g&&u>=d))return(m===b&&j.isLeapYear(m)||j.feb29Between(t,l)||g===1&&d===29)&&(p=366),(0,ue.default)(l).diff((0,ue.default)(t),"days")/p;var x=b-m+1,_=((0,ue.default)().set({year:b+1,month:0,date:1})-(0,ue.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,S=_/x;y=(0,ue.default)(l).diff((0,ue.default)(t),"days")/S;break;case 2:y=(0,ue.default)(l).diff((0,ue.default)(t),"days")/360;break;case 3:y=(0,ue.default)(l).diff((0,ue.default)(t),"days")/365;break;case 4:y=(d+g*30+b*360-(u+f*30+m*360))/360;break}return a*o*y}catch(O){var I=O;return I=v.errorInfo(I),[v.error.v,I]}},COUPDAYBS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return v.error.nm;if(a<0||a>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;for(var s,u=Math.ceil((0,ue.default)(l).diff((0,ue.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var f=(0,ue.default)(l).subtract(12/o*e,"months");if(f<=(0,ue.default)(t)){s=f;break}}var m;switch(a){case 0:var d=(0,ue.default)(s).date(),g=(0,ue.default)(s).month()+1,b=(0,ue.default)(s).year(),y=(0,ue.default)(t).date(),p=(0,ue.default)(t).month()+1,x=(0,ue.default)(t).year();d===31&&y===31?(d=30,y=30):d===31?d=30:d===30&&y===31&&(y=30),m=y+p*30+x*360-(d+g*30+b*360);break;case 1:case 2:case 3:m=(0,ue.default)(t).diff((0,ue.default)(s),"days");break;case 4:var d=(0,ue.default)(s).date(),g=(0,ue.default)(s).month()+1,b=(0,ue.default)(s).year(),y=(0,ue.default)(t).date(),p=(0,ue.default)(t).month()+1,x=(0,ue.default)(t).year();m=y+p*30+x*360-(d+g*30+b*360);break}return m}catch(S){var _=S;return _=v.errorInfo(_),[v.error.v,_]}},COUPDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return v.error.nm;if(a<0||a>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var s;switch(a){case 0:s=360/o;break;case 1:for(var u=Math.ceil((0,ue.default)(l).diff((0,ue.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var f=(0,ue.default)(l).subtract(12/o*e,"months");if(f<=(0,ue.default)(t)){var m=(0,ue.default)(l).subtract(12/o*(e-1),"months");s=(0,ue.default)(m).diff((0,ue.default)(f),"days");break}}break;case 2:s=360/o;break;case 3:s=365/o;break;case 4:s=360/o;break}return s}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},COUPDAYSNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return v.error.nm;if(a<0||a>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;for(var s,u=Math.ceil((0,ue.default)(l).diff((0,ue.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var f=(0,ue.default)(l).subtract(12/o*e,"months");if(f<=(0,ue.default)(t)){s=(0,ue.default)(l).subtract(12/o*(e-1),"months");break}}var m;switch(a){case 0:var d=(0,ue.default)(t).date(),g=(0,ue.default)(t).month()+1,b=(0,ue.default)(t).year(),y=(0,ue.default)(s).date(),p=(0,ue.default)(s).month()+1,x=(0,ue.default)(s).year();d===31&&y===31?(d=30,y=30):d===31?d=30:d===30&&y===31&&(y=30),m=y+p*30+x*360-(d+g*30+b*360);break;case 1:case 2:case 3:m=(0,ue.default)(s).diff((0,ue.default)(t),"days");break;case 4:var d=(0,ue.default)(t).date(),g=(0,ue.default)(t).month()+1,b=(0,ue.default)(t).year(),y=(0,ue.default)(s).date(),p=(0,ue.default)(s).month()+1,x=(0,ue.default)(s).year();m=y+p*30+x*360-(d+g*30+b*360);break}return m}catch(S){var _=S;return _=v.errorInfo(_),[v.error.v,_]}},COUPNCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return v.error.nm;if(a<0||a>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;for(var s,u=Math.ceil((0,ue.default)(l).diff((0,ue.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var f=(0,ue.default)(l).subtract(12/o*e,"months");if(f<=(0,ue.default)(t)){s=(0,ue.default)(l).subtract(12/o*(e-1),"months");break}}return(0,ue.default)(s).format("YYYY-MM-DD")}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},COUPPCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return v.error.nm;if(a<0||a>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;for(var s,u=Math.ceil((0,ue.default)(l).diff((0,ue.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var f=(0,ue.default)(l).subtract(12/o*e,"months");if(f<=(0,ue.default)(t)){s=f;break}}return(0,ue.default)(s).format("YYYY-MM-DD")}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},FV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return v.error.nm;var u;if(t===0)u=a+o*l;else{var f=Math.pow(1+t,l);s===1?u=a*f+o*(1+t)*(f-1)/t:u=a*f+o*(f-1)/t}return-u}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},FVSCHEDULE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;o=o.concat(j.getDataArr(l,!1))}else V(l)=="object"&&l.startCell!=null?o=o.concat(j.getCellDataArr(l,"number",!1)):o.push(l);for(var a=[],e=0;e<o.length;e++){var s=o[e];if(!Y(s))return v.error.v;a.push(parseFloat(s))}for(var u=a.length,f=t,e=0;e<u;e++)f*=1+a[e];return f}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},YIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=j.getFirstValue(arguments[4]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s);var u=j.getFirstValue(arguments[5]);if(q(u))return u;if(!Y(u))return v.error.v;u=parseInt(u);var f=0;if(arguments.length==7){if(f=j.getFirstValue(arguments[6]),q(f))return f;if(!Y(f))return v.error.v;f=parseInt(f)}if(o<0)return v.error.nm;if(a<=0||s<=0)return v.error.nm;if(u!=1&&u!=2&&u!=4)return v.error.nm;if(f<0||f>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var m=window.luckysheet_function.COUPNUM.f(t,l,u,f);if(m>1){for(var d=1,g=0,b=d,e=1;e<=100;e++){var y=window.luckysheet_function.PRICE.f(t,l,o,b,s,u,f);if(Math.abs(y-a)<1e-6)break;y>a?g=b:d=b,b=(d+g)/2}var p=b}else var x=window.luckysheet_function.COUPDAYSNC.f(t,l,u,f),_=window.luckysheet_function.COUPDAYS.f(t,l,u,f),S=window.luckysheet_function.COUPDAYBS.f(t,l,u,f),I=s/100+o/u,O=a/100+S/_*(o/u),F=u*_/x,p=(I-O)/O*F;return p}catch(k){var D=k;return D=v.errorInfo(D),[v.error.v,D]}},YIELDDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s)}if(o<=0||a<=0)return v.error.nm;if(s<0||s>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var u=window.luckysheet_function.YEARFRAC.f(t,l,s);return(a/o-1)/u}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},NOMINAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseInt(l),t<=0||l<1?v.error.nm:(Math.pow(t+1,1/l)-1)*l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},XIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];if(!Y(a))return v.error.v;o.push(parseFloat(a))}var s=j.getCellrangeDate(arguments[1]);if(q(s))return s;for(var e=0;e<s.length;e++)if(!(0,ue.default)(s[e]).isValid())return v.error.v;var u=.1;if(arguments.length==3){if(u=j.getFirstValue(arguments[2]),q(u))return u;if(!Y(u))return v.error.v;u=parseFloat(u)}for(var f=!1,m=!1,e=0;e<o.length&&(o[e]>0&&(f=!0),o[e]<0&&(m=!0),!(f&&m));e++);if(!f||!m)return v.error.nm;if(o.length!=s.length)return v.error.nm;var d=function(O,F,D){for(var k=D+1,w=O[0],C=1;C<O.length;C++)w+=O[C]/Math.pow(k,window.luckysheet_function.DAYS.f(F[C],F[0])/365);return w},g=function(O,F,D){for(var k=D+1,w=0,C=1;C<O.length;C++){var T=window.luckysheet_function.DAYS.f(F[C],F[0])/365;w-=T*O[C]/Math.pow(k,T+1)}return w},b=u,y=1e-10,p,x,_,S=!0;do _=d(o,s,b),p=b-_/g(o,s,b),x=Math.abs(p-b),b=p,S=x>y&&Math.abs(_)>y;while(S);return b}catch(O){var I=O;return I=v.errorInfo(I),[v.error.v,I]}},MIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];if(!Y(a))return v.error.v;o.push(parseFloat(a))}var s=j.getFirstValue(arguments[1]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s);var u=j.getFirstValue(arguments[2]);if(q(u))return u;if(!Y(u))return v.error.v;u=parseFloat(u);for(var f=o.length,m=[],d=[],e=0;e<f;e++)o[e]<0?m.push(o[e]):d.push(o[e]);if(m.length==0||d.length==0)return v.error.d;var g=-window.luckysheet_function.NPV.f(u,d)*Math.pow(1+u,f-1),b=window.luckysheet_function.NPV.f(s,m)*(1+s);return Math.pow(g/b,1/(f-1))-1}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},IRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"number",!0)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];if(!Y(a))return v.error.v;o.push(parseFloat(a))}var s=.1;if(arguments.length==2){if(s=j.getFirstValue(arguments[1]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}for(var u=[],f=!1,m=!1,e=0;e<l.length;e++)u[e]=e===0?0:u[e-1]+365,l[e]>0&&(f=!0),l[e]<0&&(m=!0);if(!f||!m)return v.error.nm;var d=function(O,F,D){for(var k=D+1,w=O[0],C=1;C<O.length;C++)w+=O[C]/Math.pow(k,(F[C]-F[0])/365);return w},g=function(O,F,D){for(var k=D+1,w=0,C=1;C<O.length;C++){var T=(F[C]-F[0])/365;w-=T*O[C]/Math.pow(k,T+1)}return w},b=s,y=1e-10,p,x,_,S=!0;do _=d(o,u,b),p=b-_/g(o,u,b),x=Math.abs(p-b),b=p,S=x>y&&Math.abs(_)>y;while(S);return b}catch(O){var I=O;return I=v.errorInfo(I),[v.error.v,I]}},NPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);for(var l=[],e=1;e<arguments.length;e++){var o=arguments[e];if(V(o)=="array"){if(V(o[0])=="array"&&!j.isDyadicArr(o))return v.error.v;l=l.concat(j.getDataArr(o,!0))}else V(o)=="object"&&o.startCell!=null?l=l.concat(j.getCellDataArr(o,"number",!0)):l.push(o)}for(var a=[],e=0;e<l.length;e++){var s=l[e];Y(s)&&a.push(parseFloat(s))}var u=0;if(a.length>0)for(var e=0;e<a.length;e++)u+=a[e]/Math.pow(1+t,e+1);return u}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},XNPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(V(l)=="array"){if(V(l[0])=="array"&&!j.isDyadicArr(l))return v.error.v;o=o.concat(j.getDataArr(l,!1))}else V(l)=="object"&&l.startCell!=null?o=o.concat(j.getCellDataArr(l,"number",!1)):o.push(l);for(var a=[],e=0;e<o.length;e++){var s=o[e];if(!Y(s))return v.error.v;a.push(parseFloat(s))}var u=j.getCellrangeDate(arguments[2]);if(q(u))return u;for(var e=0;e<u.length;e++)if(!(0,ue.default)(u[e]).isValid())return v.error.v;if(a.length!=u.length)return v.error.nm;for(var f=0,e=0;e<a.length;e++)f+=a[e]/Math.pow(1+t,window.luckysheet_function.DAYS.f(u[e],u[0])/365);return f}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},CUMIPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a);var s=j.getFirstValue(arguments[4]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s);var u=j.getFirstValue(arguments[5]);if(q(u))return u;if(!Y(u))return v.error.v;if(u=parseFloat(u),t<=0||l<=0||o<=0)return v.error.nm;if(a<1||s<1||a>s)return v.error.nm;if(u!=0&&u!=1)return v.error.nm;var f=window.luckysheet_function.PMT.f(t,l,o,0,u),m=0;a===1&&u===0&&(m=-o,a++);for(var e=a;e<=s;e++)u===1?m+=window.luckysheet_function.FV.f(t,e-2,f,o,1)-f:m+=window.luckysheet_function.FV.f(t,e-1,f,o,0);return m*=t,m}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},PMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a)}var s=0;if(arguments.length==5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return v.error.nm;var u;if(t===0)u=(o+a)/l;else{var f=Math.pow(1+t,l);s===1?u=(a*t/(f-1)+o*t/(1-1/f))/(1+t):u=a*t/(f-1)+o*t/(1-1/f)}return-u}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},IPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=0;if(arguments.length>=5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}var u=0;if(arguments.length>=6){if(u=j.getFirstValue(arguments[5]),q(u))return u;if(!Y(u))return v.error.v;u=parseFloat(u)}if(l<1||l>o)return v.error.nm;if(u!=0&&u!=1)return v.error.nm;var f=window.luckysheet_function.PMT.f(t,o,a,s,u),m;l===1?u===1?m=0:m=-a:u===1?m=window.luckysheet_function.FV.f(t,l-2,f,a,1)-f:m=window.luckysheet_function.FV.f(t,l-1,f,a,0);var d=m*t;return d}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},PPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=0;if(arguments.length>=5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}var u=0;if(arguments.length>=6){if(u=j.getFirstValue(arguments[5]),q(u))return u;if(!Y(u))return v.error.v;u=parseFloat(u)}if(l<1||l>o)return v.error.nm;if(u!=0&&u!=1)return v.error.nm;var f=window.luckysheet_function.PMT.f(t,o,a,s,u),m=window.luckysheet_function.IPMT.f(t,l,o,a,s,u);return f-m}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},INTRATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s)}if(o<=0||a<=0)return v.error.nm;if(s<0||s>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var u=(0,ue.default)(t).date(),f=(0,ue.default)(t).month()+1,m=(0,ue.default)(t).year(),d=(0,ue.default)(l).date(),g=(0,ue.default)(l).month()+1,b=(0,ue.default)(l).year(),y;switch(s){case 0:u===31&&d===31?(u=30,d=30):u===31?u=30:u===30&&d===31&&(d=30),y=360/(d+g*30+b*360-(u+f*30+m*360));break;case 1:var p=365;if(m===b||m+1===b&&(f>g||f===g&&u>=d))return(m===b&&j.isLeapYear(m)||j.feb29Between(t,l)||g===1&&d===29)&&(p=366),y=p/(0,ue.default)(l).diff((0,ue.default)(t),"days"),y=(a-o)/o*y,y;var x=b-m+1,_=((0,ue.default)().set({year:b+1,month:0,date:1})-(0,ue.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,S=_/x;y=S/(0,ue.default)(l).diff((0,ue.default)(t),"days");break;case 2:y=360/(0,ue.default)(l).diff((0,ue.default)(t),"days");break;case 3:y=365/(0,ue.default)(l).diff((0,ue.default)(t),"days");break;case 4:y=360/(d+g*30+b*360-(u+f*30+m*360));break}return y=(a-o)/o*y,y}catch(O){var I=O;return I=v.errorInfo(I),[v.error.v,I]}},PRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=j.getFirstValue(arguments[4]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s);var u=j.getFirstValue(arguments[5]);if(q(u))return u;if(!Y(u))return v.error.v;u=parseInt(u);var f=0;if(arguments.length==7){if(f=j.getFirstValue(arguments[6]),q(f))return f;if(!Y(f))return v.error.v;f=parseInt(f)}if(o<0||a<0)return v.error.nm;if(s<=0)return v.error.nm;if(u!=1&&u!=2&&u!=4)return v.error.nm;if(f<0||f>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var m=window.luckysheet_function.COUPDAYSNC.f(t,l,u,f),d=window.luckysheet_function.COUPDAYS.f(t,l,u,f),g=window.luckysheet_function.COUPDAYBS.f(t,l,u,f),b=window.luckysheet_function.COUPNUM.f(t,l,u,f);if(b>1){for(var y=s/Math.pow(1+a/u,b-1+m/d),p=0,e=1;e<=b;e++)p+=100*o/u/Math.pow(1+a/u,e-1+m/d);var x=100*(o/u)*(g/d),_=y+p-x}else var S=d-g,y=100*(o/u)+s,p=a/u*(S/d)+1,x=100*(o/u)*(g/d),_=y/p-x;return _}catch(O){var I=O;return I=v.errorInfo(I),[v.error.v,I]}},PRICEDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s)}if(o<=0||a<=0)return v.error.nm;if(s<0||s>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var u=(0,ue.default)(t).date(),f=(0,ue.default)(t).month()+1,m=(0,ue.default)(t).year(),d=(0,ue.default)(l).date(),g=(0,ue.default)(l).month()+1,b=(0,ue.default)(l).year(),y;switch(s){case 0:u===31&&d===31?(u=30,d=30):u===31?u=30:u===30&&d===31&&(d=30),y=(d+g*30+b*360-(u+f*30+m*360))/360;break;case 1:var p=365;if(m===b||m+1===b&&(f>g||f===g&&u>=d))return(m===b&&j.isLeapYear(m)||j.feb29Between(t,l)||g===1&&d===29)&&(p=366),y=(0,ue.default)(l).diff((0,ue.default)(t),"days")/p,y=a-o*a*y,y;var x=b-m+1,_=((0,ue.default)().set({year:b+1,month:0,date:1})-(0,ue.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,S=_/x;y=(0,ue.default)(l).diff((0,ue.default)(t),"days")/S;break;case 2:y=(0,ue.default)(l).diff((0,ue.default)(t),"days")/360;break;case 3:y=(0,ue.default)(l).diff((0,ue.default)(t),"days")/365;break;case 4:y=(d+g*30+b*360-(u+f*30+m*360))/360;break}return y=a-o*a*y,y}catch(O){var I=O;return I=v.errorInfo(I),[v.error.v,I]}},PRICEMAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getCellDate(arguments[2]);if(q(o))return o;if(!(0,ue.default)(o).isValid())return v.error.v;var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=j.getFirstValue(arguments[4]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s);var u=0;if(arguments.length==6){if(u=j.getFirstValue(arguments[5]),q(u))return u;if(!Y(u))return v.error.v;u=parseInt(u)}if(a<0||s<0)return v.error.nm;if(u<0||u>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var f=(0,ue.default)(t).date(),m=(0,ue.default)(t).month()+1,d=(0,ue.default)(t).year(),g=(0,ue.default)(l).date(),b=(0,ue.default)(l).month()+1,y=(0,ue.default)(l).year(),p=(0,ue.default)(o).date(),x=(0,ue.default)(o).month()+1,_=(0,ue.default)(o).year(),S;switch(u){case 0:f==31&&(f=30),g==31&&(g=30),p==31&&(p=30);var I=360,O=g+b*30+y*360-(f+m*30+d*360),F=g+b*30+y*360-(p+x*30+_*360),D=f+m*30+d*360-(p+x*30+_*360);break;case 1:var k=365;if(d===y||d+1===y&&(m>b||m===b&&f>=g)){(d===y&&j.isLeapYear(d)||j.feb29Between(t,l)||b===1&&g===29)&&(k=366);var I=k,O=(0,ue.default)(l).diff((0,ue.default)(t),"days"),F=(0,ue.default)(t).diff((0,ue.default)(o),"days"),D=(0,ue.default)(l).diff((0,ue.default)(o),"days");return S=(100+F/I*a*100)/(1+O/I*s)-D/I*a*100,S}var w=y-d+1,C=((0,ue.default)().set({year:y+1,month:0,date:1})-(0,ue.default)().set({year:d,month:0,date:1}))/1e3/60/60/24,T=C/w,I=T,O=(0,ue.default)(l).diff((0,ue.default)(t),"days"),F=(0,ue.default)(t).diff((0,ue.default)(o),"days"),D=(0,ue.default)(l).diff((0,ue.default)(o),"days");break;case 2:var I=360,O=(0,ue.default)(l).diff((0,ue.default)(t),"days"),F=(0,ue.default)(t).diff((0,ue.default)(o),"days"),D=(0,ue.default)(l).diff((0,ue.default)(o),"days");break;case 3:var I=365,O=(0,ue.default)(l).diff((0,ue.default)(t),"days"),F=(0,ue.default)(t).diff((0,ue.default)(o),"days"),D=(0,ue.default)(l).diff((0,ue.default)(o),"days");break;case 4:var I=360,O=g+b*30+y*360-(f+m*30+d*360),F=g+b*30+y*360-(p+x*30+_*360),D=f+m*30+d*360-(p+x*30+_*360);break}return S=(100+F/I*a*100)/(1+O/I*s)-D/I*a*100,S}catch(A){var z=A;return z=v.errorInfo(z),[v.error.v,z]}},RECEIVED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}if(o<=0||a<=0)return v.error.nm;if(s<0||s>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var u=(0,ue.default)(t).date(),f=(0,ue.default)(t).month()+1,m=(0,ue.default)(t).year(),d=(0,ue.default)(l).date(),g=(0,ue.default)(l).month()+1,b=(0,ue.default)(l).year(),y;switch(s){case 0:u==31&&(u=30),d==31&&(d=30);var p=360,x=d+g*30+b*360-(u+f*30+m*360);break;case 1:var _=365;if(m===b||m+1===b&&(f>g||f===g&&u>=d)){(m===b&&j.isLeapYear(m)||j.feb29Between(t,l)||g===1&&d===29)&&(_=366);var p=_,x=(0,ue.default)(l).diff((0,ue.default)(t),"days");return y=o/(1-a*x/p),y}var S=b-m+1,I=((0,ue.default)().set({year:b+1,month:0,date:1})-(0,ue.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,O=I/S,p=O,x=(0,ue.default)(l).diff((0,ue.default)(t),"days");break;case 2:var p=360,x=(0,ue.default)(l).diff((0,ue.default)(t),"days");break;case 3:var p=365,x=(0,ue.default)(l).diff((0,ue.default)(t),"days");break;case 4:var p=360,x=d+g*30+b*360-(u+f*30+m*360);break}return y=o/(1-a*x/p),y}catch(D){var F=D;return F=v.errorInfo(F),[v.error.v,F]}},DISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}if(o<=0||a<=0)return v.error.nm;if(s<0||s>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var u=(0,ue.default)(t).date(),f=(0,ue.default)(t).month()+1,m=(0,ue.default)(t).year(),d=(0,ue.default)(l).date(),g=(0,ue.default)(l).month()+1,b=(0,ue.default)(l).year(),y;switch(s){case 0:u==31&&(u=30),d==31&&(d=30);var p=360,x=d+g*30+b*360-(u+f*30+m*360);break;case 1:var _=365;if(m===b||m+1===b&&(f>g||f===g&&u>=d)){(m===b&&j.isLeapYear(m)||j.feb29Between(t,l)||g===1&&d===29)&&(_=366);var p=_,x=(0,ue.default)(l).diff((0,ue.default)(t),"days");return y=(a-o)/a*(p/x),y}var S=b-m+1,I=((0,ue.default)().set({year:b+1,month:0,date:1})-(0,ue.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,O=I/S,p=O,x=(0,ue.default)(l).diff((0,ue.default)(t),"days");break;case 2:var p=360,x=(0,ue.default)(l).diff((0,ue.default)(t),"days");break;case 3:var p=365,x=(0,ue.default)(l).diff((0,ue.default)(t),"days");break;case 4:var p=360,x=d+g*30+b*360-(u+f*30+m*360);break}return y=(a-o)/a*(p/x),y}catch(D){var F=D;return F=v.errorInfo(F),[v.error.v,F]}},NPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=j.getFirstValue(arguments[4]),q(s))return s;if(!Y(s))return v.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return v.error.nm;var u=l*(1+t*s)-a*t,f=o*t+l*(1+t*s);return Math.log(u/f)/Math.log(1+t)}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},SLN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o=j.getFirstValue(arguments[2]);return q(o)?o:Y(o)?(o=parseFloat(o),o==0?v.error.d:(t-l)/o):v.error.v}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},DURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=j.getFirstValue(arguments[4]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s);var u=0;if(arguments.length==6){if(u=j.getFirstValue(arguments[5]),q(u))return u;if(!Y(u))return v.error.v;u=parseInt(u)}if(o<0||a<0)return v.error.nm;if(s!=1&&s!=2&&s!=4)return v.error.nm;if(u<0||u>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;for(var f=window.luckysheet_function.COUPNUM.f(t,l,s,u),m=0,d=0,e=1;e<=f;e++)m+=100*(o/s)*e/Math.pow(1+a/s,e),d+=100*(o/s)/Math.pow(1+a/s,e);var g=(m+100*f/Math.pow(1+a/s,f))/(d+100/Math.pow(1+a/s,f));return g=g/s,g}catch(y){var b=y;return b=v.errorInfo(b),[v.error.v,b]}},MDURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellDate(arguments[0]);if(q(t))return t;if(!(0,ue.default)(t).isValid())return v.error.v;var l=j.getCellDate(arguments[1]);if(q(l))return l;if(!(0,ue.default)(l).isValid())return v.error.v;var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o);var a=j.getFirstValue(arguments[3]);if(q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a);var s=j.getFirstValue(arguments[4]);if(q(s))return s;if(!Y(s))return v.error.v;s=parseInt(s);var u=0;if(arguments.length==6){if(u=j.getFirstValue(arguments[5]),q(u))return u;if(!Y(u))return v.error.v;u=parseInt(u)}if(o<0||a<0)return v.error.nm;if(s!=1&&s!=2&&s!=4)return v.error.nm;if(u<0||u>4)return v.error.nm;if((0,ue.default)(t)-(0,ue.default)(l)>=0)return v.error.nm;var f=window.luckysheet_function.DURATION.f(t,l,o,a,s,u);return f/(1+a/s)}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},BIN2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!/^[01]{1,10}$/g.test(t))return v.error.nm;var l=parseInt(t,2),o=t.toString();return o.length===10&&o.substring(0,1)==="1"?parseInt(o.substring(1),2)-512:l}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},BIN2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;var l=null;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}if(!/^[01]{1,10}$/g.test(t))return v.error.nm;var o=parseInt(t,2).toString(16).toUpperCase();return l==null?o:l<0||l<o.length?v.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},BIN2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;var l=null;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}if(!/^[01]{1,10}$/g.test(t))return v.error.nm;var o=t.toString();if(o.length===10&&o.substring(0,1)==="1")return(1073741312+parseInt(o.substring(1),2)).toString(8);var a=parseInt(t,2).toString(8);return l==null?a:l<0||l<a.length?v.error.nm:new Array(l-a.length+1).join("0")+a}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},DEC2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=null;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return v.error.nm;if(t<0)return"1"+new Array(9-(512+t).toString(2).length).join("0")+(512+t).toString(2);var o=parseInt(t,10).toString(2);return l==null?o:l<0||l<o.length?v.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},DEC2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=null;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return v.error.nm;if(t<0)return(1099511627776+t).toString(16).toUpperCase();var o=parseInt(t,10).toString(16).toUpperCase();return l==null?o:l<0||l<o.length?v.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},DEC2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=null;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return v.error.nm;if(t<0)return(1073741824+t).toString(8);var o=parseInt(t,10).toString(8);return l==null?o:l<0||l<o.length?v.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},HEX2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;var l=null;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return v.error.nm;var o=t.length===10&&t.substring(0,1).toLowerCase()==="f",a=o?parseInt(t,16)-1099511627776:parseInt(t,16);if(a<-512||a>511)return v.error.nm;if(o)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var s=a.toString(2);return l==null?s:l<0||l<s.length?v.error.nm:new Array(l-s.length+1).join("0")+s}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},HEX2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return v.error.nm;var l=parseInt(t,16);return l>=549755813888?l-1099511627776:l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},HEX2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;var l=null;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return v.error.nm;var o=parseInt(t,16);if(o>536870911&&o<1098974756864)return v.error.nm;if(o>=1098974756864)return(o-1098437885952).toString(8);var a=o.toString(8);return l==null?a:l<0||l<a.length?v.error.nm:new Array(l-a.length+1).join("0")+a}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},OCT2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;var l=null;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}if(!/^[0-7]{1,10}$/.test(t))return v.error.nm;t=t.toString();var o=t.length===10&&t.substring(0,1)==="7",a=o?parseInt(t,8)-1073741824:parseInt(t,8);if(a<-512||a>511)return It.num;if(o)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var s=a.toString(2);return l==null?s:l<0||l<s.length?v.error.nm:new Array(l-s.length+1).join("0")+s}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},OCT2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!/^[0-7]{1,10}$/.test(t))return v.error.nm;var l=parseInt(t,8);return l>=536870912?l-1073741824:l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},OCT2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;var l=null;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}if(!/^[0-7]{1,10}$/.test(t))return v.error.nm;var o=parseInt(t,8);if(o>=536870912)return"FF"+(o+3221225472).toString(16).toUpperCase();var a=o.toString(16).toUpperCase();return l==null?a:l<0||l<a.length?v.error.nm:new Array(l-a.length+1).join("0")+a}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},COMPLEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l);var o="i";if(arguments.length==3&&(o=arguments[2].toString()),o!="i"&&o!="j")return v.error.v;if(t===0&&l===0)return 0;if(t===0)return l===1?o:l.toString()+o;if(l===0)return t.toString();var a=l>0?"+":"";return t.toString()+a+(l===1?o:l.toString()+o)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},IMREAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return v.error.v;if(t=="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;var l=t.indexOf("+"),o=t.indexOf("-");l===0&&(l=t.indexOf("+",1)),o===0&&(o=t.indexOf("-",1));var a=t.substring(t.length-1,t.length),s=a==="i"||a==="j";return l>=0||o>=0?s?l>=0?isNaN(t.substring(0,l))||isNaN(t.substring(l+1,t.length-1))?v.error.nm:Number(t.substring(0,l)):isNaN(t.substring(0,o))||isNaN(t.substring(o+1,t.length-1))?v.error.nm:Number(t.substring(0,o)):v.error.nm:s?isNaN(t.substring(0,t.length-1))?v.error.nm:0:isNaN(t)?v.error.nm:t}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},IMAGINARY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return v.error.v;if(t=="0")return 0;if(["i","j"].indexOf(t)>=0)return 1;t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var l=t.indexOf("+"),o=t.indexOf("-");l===0&&(l=t.indexOf("+",1)),o===0&&(o=t.indexOf("-",1));var a=t.substring(t.length-1,t.length),s=a==="i"||a==="j";return l>=0||o>=0?s?l>=0?isNaN(t.substring(0,l))||isNaN(t.substring(l+1,t.length-1))?v.error.nm:Number(t.substring(l+1,t.length-1)):isNaN(t.substring(0,o))||isNaN(t.substring(o+1,t.length-1))?v.error.nm:-Number(t.substring(o+1,t.length-1)):v.error.nm:s?isNaN(t.substring(0,t.length-1))?v.error.nm:t.substring(0,t.length-1):isNaN(t)?v.error.nm:0}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},IMCONJUGATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;t=t.toString();var l=window.luckysheet_function.IMREAL.f(t);if(q(l))return l;var o=window.luckysheet_function.IMAGINARY.f(t);if(q(o))return o;var a=t.substring(t.length-1);return a=a==="i"||a==="j"?a:"i",o!==0?window.luckysheet_function.COMPLEX.f(l,-o,a):t}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},IMABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(q(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);return q(l)?l:Math.sqrt(Math.pow(t,2)+Math.pow(l,2))}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},DELTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=0;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseFloat(l)}return t===l?1:0}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},IMSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(q(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(q(l))return l;for(var o=arguments[0],e=1;e<arguments.length;e++){var a=window.luckysheet_function.IMREAL.f(o);if(q(a))return a;var s=window.luckysheet_function.IMAGINARY.f(o);if(q(s))return s;var u=window.luckysheet_function.IMREAL.f(arguments[e]);if(q(u))return u;var f=window.luckysheet_function.IMAGINARY.f(arguments[e]);if(q(f))return f;o=window.luckysheet_function.COMPLEX.f(a+u,s+f)}return o}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},IMSUB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return v.error.v;var l=window.luckysheet_function.IMREAL.f(t);if(q(l))return l;var o=window.luckysheet_function.IMAGINARY.f(t);if(q(o))return o;var a=j.getFirstValue(arguments[1]);if(q(a))return a;if(a=a.toString(),a.toLowerCase()=="true"||a.toLowerCase()=="false")return v.error.v;var s=window.luckysheet_function.IMREAL.f(a);if(q(s))return s;var u=window.luckysheet_function.IMAGINARY.f(a);if(q(u))return u;var f=t.substring(t.length-1),m=a.substring(a.length-1),d="i";return(f==="j"||m==="j")&&(d="j"),window.luckysheet_function.COMPLEX.f(l-s,o-u,d)}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},IMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(q(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(q(l))return l;for(var o=arguments[0],e=1;e<arguments.length;e++){var a=window.luckysheet_function.IMREAL.f(o);if(q(a))return a;var s=window.luckysheet_function.IMAGINARY.f(o);if(q(s))return s;var u=window.luckysheet_function.IMREAL.f(arguments[e]);if(q(u))return u;var f=window.luckysheet_function.IMAGINARY.f(arguments[e]);if(q(f))return f;o=window.luckysheet_function.COMPLEX.f(a*u-s*f,a*f+s*u)}return o}catch(d){var m=d;return m=v.errorInfo(m),[v.error.v,m]}},IMDIV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return v.error.v;var l=window.luckysheet_function.IMREAL.f(t);if(q(l))return l;var o=window.luckysheet_function.IMAGINARY.f(t);if(q(o))return o;var a=j.getFirstValue(arguments[1]);if(q(a))return a;if(a=a.toString(),a.toLowerCase()=="true"||a.toLowerCase()=="false")return v.error.v;var s=window.luckysheet_function.IMREAL.f(a);if(q(s))return s;var u=window.luckysheet_function.IMAGINARY.f(a);if(q(u))return u;var f=t.substring(t.length-1),m=a.substring(a.length-1),d="i";if((f==="j"||m==="j")&&(d="j"),s===0&&u===0)return v.error.nm;var g=s*s+u*u;return window.luckysheet_function.COMPLEX.f((l*s+o*u)/g,(o*s-l*u)/g,d)}catch(y){var b=y;return b=v.errorInfo(b),[v.error.v,b]}},NOT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellBoolen(arguments[0]);return q(t)?t:!t}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},TRUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return!0}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},FALSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return!1}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},AND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=!0,e=0;e<arguments.length;e++){var l=j.getCellBoolen(arguments[e]);if(q(l))return l;if(!l){t=!1;break}}return t}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},IFERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[1],"text"),l=j.getFirstValue(arguments[0],"text");return q(l)||V(l)==="string"&&$.trim(l)===""?t:l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},IF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getCellBoolen(arguments[0]);if(q(t))return t;var l=j.getFirstValue(arguments[1],"text");if(q(l)&&o!=It.d)return l;var o="";return arguments.length==3&&(o=j.getFirstValue(arguments[2],"text"),q(o)&&o!=It.d)?o:t?l:o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},OR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t=!1,e=0;e<arguments.length;e++){var l=j.getCellBoolen(arguments[e]);if(q(l))return l;if(l){t=!0;break}}return t}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},NE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;var l=j.getFirstValue(arguments[1]);return q(l)?l:t!=l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;var l=j.getFirstValue(arguments[1]);return q(l)?l:t==l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},GT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),t>l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},GTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),t>=l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},LT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),t<l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},LTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),t<=l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ADD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),t+l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},MINUS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),t-l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},MULTIPLY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),t*l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},DIVIDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseFloat(l),l==0?v.error.d:t/l):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},CONCAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;var l=j.getFirstValue(arguments[1],"text");return q(l)?l:t+""+l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},UNARY_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=t/100;return Math.round(l*100)/100}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},CONCATENATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{for(var t="",e=0;e<arguments.length;e++){var l=j.getFirstValue(arguments[e],"text");if(q(l))return l;t=t+""+l}return t}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},CODE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:t==""?v.error.v:t.charCodeAt(0)}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},CHAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseInt(t),t<1||t>255?v.error.v:String.fromCharCode(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},ARABIC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;if(t=t.toString().toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return v.error.v;var l=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(a){l+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]}),l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ROMAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{let o=function(a){var s=[["","I","II","III","IV","V","VI","VII","VIII","IX"],["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"],["","M","MM","MMM"]],u=s[3][Math.floor(a/1e3)],f=s[2][Math.floor(a%1e3/100)],m=s[1][Math.floor(a%100/10)],d=s[0][a%10];return u+f+m+d};var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseInt(t),t==0?"":t<1||t>3999?v.error.v:o(t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},REGEXEXTRACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;var l=j.getFirstValue(arguments[1],"text");if(q(l))return l;var o=t.match(new RegExp(l));return o?o[o.length>1?o.length-1:0]:null}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},REGEXMATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;var l=j.getFirstValue(arguments[1],"text");if(q(l))return l;var o=t.match(new RegExp(l));return!!o}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},REGEXREPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;var l=j.getFirstValue(arguments[1],"text");if(q(l))return l;var o=j.getFirstValue(arguments[2],"text");return q(o)?o:t.replace(new RegExp(l),o)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)||V(t)=="string"?t:""}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},FIXED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=2;if(arguments.length>=2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}var o=!1;if(arguments.length==3&&(o=j.getCellBoolen(arguments[2]),q(o)))return o;if(l>127)return v.error.v;var a=o?"0":"#,##0";return l<=0?t=Math.round(t*Math.pow(10,l))/Math.pow(10,l):l>0&&(a+="."+new Array(l+1).join("0")),$l(a,t)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},FIND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();var l=j.getFirstValue(arguments[1],"text");if(q(l))return l;l=l.toString();var o=1;if(arguments.length==3){if(o=j.getFirstValue(arguments[2]),q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o)}if(o<0||o>l.length)return v.error.v;if(t=="")return o;if(l.indexOf(t)==-1)return v.error.v;var a=l.indexOf(t,o-1)+1;return a}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},FINDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();var l=j.getFirstValue(arguments[1],"text");if(q(l))return l;l=l.toString();var o=1;if(arguments.length==3){if(o=j.getFirstValue(arguments[2]),q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o)}if(o<0||o>l.length)return v.error.v;if(t=="")return o;if(l.indexOf(t)==-1)return v.error.v;for(var a=l.split(""),s=l.indexOf(t,o-1),u=0,e=0;e<s;e++)/[^\x00-\xff]/g.test(a[e])?u+=2:u+=1;return u}catch(m){var f=m;return f=v.errorInfo(f),[v.error.v,f]}},JOIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;for(var l=[],e=1;e<arguments.length;e++){var o=arguments[e];if(V(o)=="array"){if(V(o[0])=="array"&&!j.isDyadicArr(o))return v.error.v;l=l.concat(j.getDataArr(o,!1))}else V(o)=="object"&&o.startCell!=null?l=l.concat(j.getCellDataArr(o,"text",!1)):l.push(o)}return l.join(t)}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},LEFT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();var l=1;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}return l<0?v.error.v:l>=t.length?t:l==0?"":t.substr(0,l)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},RIGHT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();var l=1;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}return l<0?v.error.v:l>=t.length?t:l==0?"":t.substr(-l,l)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},MID:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getFirstValue(arguments[2]);return q(o)?o:Y(o)?(o=parseInt(o),l<1||o<0?v.error.v:l>t.length?"":l+o>t.length?t.substr(l-1,t.length-l+1):t.substr(l-1,o)):v.error.v}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},LEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:(t=t.toString(),t.length)}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},LENB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:(t=t.toString(),t.replace(/[^\x00-\xff]/g,"aa").length)}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},LOWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:(t=t.toString(),t&&t.toLowerCase())}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},UPPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:(t=t.toString(),t&&t.toUpperCase())}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},EXACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();var l=j.getFirstValue(arguments[1],"text");return q(l)?l:(l=l.toString(),t===l)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},REPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();var l=j.getFirstValue(arguments[1]);if(q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l);var o=j.getFirstValue(arguments[2]);if(q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o);var a=j.getFirstValue(arguments[3],"text");return q(a)?a:(a=a.toString(),t.substr(0,l-1)+a+t.substr(l-1+o))}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},REPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();var l=j.getFirstValue(arguments[1]);return q(l)?l:Y(l)?(l=parseInt(l),l<0?v.error.v:(l>100&&(l=100),new Array(l+1).join(t))):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},SEARCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();var l=j.getFirstValue(arguments[1],"text");if(q(l))return l;l=l.toString();var o=1;if(arguments.length==3){if(o=j.getFirstValue(arguments[2]),q(o))return o;if(!Y(o))return v.error.v;o=parseInt(o)}if(o<=0||o>l.length)return v.error.v;var a=l.toLowerCase().indexOf(t.toLowerCase(),o-1)+1;return a===0?v.error.v:a}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},SUBSTITUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();var l=j.getFirstValue(arguments[1],"text");if(q(l))return l;l=l.toString();var o=j.getFirstValue(arguments[2],"text");if(q(o))return o;o=o.toString();var a=null;if(arguments.length==4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseInt(a)}var s=new RegExp(l,"g"),u;if(a==null)u=t.replace(s,o);else{if(a<=0)return v.error.v;var f=t.match(s);if(f==null||a>f.length)return t;for(var m=l.length,d=0,e=1;e<=a;e++)d=t.indexOf(l,d)+1;u=t.substring(0,d-1)+o+t.substring(d-1+m)}return u}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},CLEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");if(q(t))return t;t=t.toString();for(var l=[],e=0;e<t.length;e++){var o=t.charCodeAt(e);(/[\u4e00-\u9fa5]/g.test(t.charAt(e))||o>31&&o<127)&&l.push(t.charAt(e))}return l.join("")}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1],"text");return q(l)?l:(l=l.toString(),$l(l,t))}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},TRIM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:(t=t.toString(),t.replace(/ +/g," ").trim())}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},VALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:(t=t.toString(),nl(t)[2])}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},PROPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:(t=t.toString().toLowerCase(),t.replace(/[a-zA-Z]+/g,function(o){return o.substring(0,1).toUpperCase()+o.substring(1)}))}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},CONVERT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseFloat(t);var l=j.getFirstValue(arguments[1],"text");if(q(l))return l;l=l.toString();var o=j.getFirstValue(arguments[2],"text");if(q(o))return o;o=o.toString();for(var a=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,30856775814671900],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,1125899906842624,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},u={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},f=null,m=null,d=l,g=o,b=1,y=1,p,e=0;e<a.length;e++)p=a[e][2]===null?[]:a[e][2],(a[e][1]===d||p.indexOf(d)>=0)&&(f=a[e]),(a[e][1]===g||p.indexOf(g)>=0)&&(m=a[e]);if(f===null){var x=s[l.substring(0,2)],_=u[l.substring(0,1)];l.substring(0,2)==="da"&&(_=["dekao",10,"da"]),x?(b=x[2],d=l.substring(2)):_&&(b=_[1],d=l.substring(_[2].length));for(var S=0;S<a.length;S++)p=a[S][2]===null?[]:a[S][2],(a[S][1]===d||p.indexOf(d)>=0)&&(f=a[S])}if(m===null){var I=s[o.substring(0,2)],O=u[o.substring(0,1)];o.substring(0,2)==="da"&&(O=["dekao",10,"da"]),I?(y=I[2],g=o.substring(2)):O&&(y=O[1],g=o.substring(O[2].length));for(var F=0;F<a.length;F++)p=a[F][2]===null?[]:a[F][2],(a[F][1]===g||p.indexOf(g)>=0)&&(m=a[F])}return f===null||m===null?v.error.na:f[3]!==m[3]?v.error.na:t*f[6]*b/(m[6]*y)}catch(k){var D=k;return D=v.errorInfo(D),[v.error.v,D]}},SUMX2MY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(V(o)=="array"){if(V(o[0])=="array"&&!j.isDyadicArr(o))return v.error.v;a=a.concat(j.getDataArr(o,!1))}else V(o)=="object"&&o.startCell!=null?a=a.concat(j.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return v.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];Y(f)&&Y(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}for(var d=0,e=0;e<s.length;e++)d+=Math.pow(s[e],2)-Math.pow(u[e],2);return d}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},SUMX2PY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(V(o)=="array"){if(V(o[0])=="array"&&!j.isDyadicArr(o))return v.error.v;a=a.concat(j.getDataArr(o,!1))}else V(o)=="object"&&o.startCell!=null?a=a.concat(j.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return v.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];Y(f)&&Y(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}for(var d=0,e=0;e<s.length;e++)d+=Math.pow(s[e],2)+Math.pow(u[e],2);return d}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},SUMXMY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!1))}else V(t)=="object"&&t.startCell!=null?l=l.concat(j.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(V(o)=="array"){if(V(o[0])=="array"&&!j.isDyadicArr(o))return v.error.v;a=a.concat(j.getDataArr(o,!1))}else V(o)=="object"&&o.startCell!=null?a=a.concat(j.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return v.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];Y(f)&&Y(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}for(var d=0,e=0;e<s.length;e++)d+=Math.pow(s[e]-u[e],2);return d}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},TRANSPOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=j.getDataDyadicArr(t)}else V(t)=="object"&&t.startCell!=null&&(l=j.getCellDataDyadicArr(t,"number"));return l=l[0].map(function(a,s){return l.map(function(u){return u[s]})}),l}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},TREND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{let w=function(C,T){for(var z=0,A=0,M=0,P=0,N=0;N<C.length;N++)for(var E=0;E<C[N].length;E++)z+=C[N][E],A+=T[N][E],M+=C[N][E]*T[N][E],P+=C[N][E]*C[N][E];var B=C.length*C[0].length,U=z/B,X=A/B,le=M/B,he=P/B,Z=(le-U*X)/(he-U*U),ae=X-Z*U;return[Z,ae]};var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=j.getDataDyadicArr(t)}else if(V(t)=="object"&&t.startCell!=null)l=j.getCellDataDyadicArr(t,"text");else{if(!Y(t))return v.error.v;var o=[];o.push(parseFloat(t)),l.push(o)}for(var a=l.length,s=l[0].length,e=0;e<a;e++)for(var u=0;u<s;u++){if(!Y(l[e][u]))return v.error.v;l[e][u]=parseFloat(l[e][u])}for(var f=[],e=1;e<=a;e++)for(var u=1;u<=s;u++){var m=(e-1)*s+u;f.push(m)}if(arguments.length>=2){var d=arguments[1];if(f=[],V(d)=="array"){if(V(d[0])=="array"&&!j.isDyadicArr(d))return v.error.v;f=j.getDataDyadicArr(d)}else if(V(d)=="object"&&d.startCell!=null)f=j.getCellDataDyadicArr(d,"text");else{if(!Y(d))return v.error.v;var o=[];o.push(parseFloat(d)),f.push(o)}for(var e=0;e<f.length;e++)for(var u=0;u<f[0].length;u++){if(!Y(f[e][u]))return v.error.v;f[e][u]=parseFloat(f[e][u])}}var g=f.length,b=f[0].length,y=f;if(arguments.length>=3){var p=arguments[2];if(y=[],V(p)=="array"){if(V(p[0])=="array"&&!j.isDyadicArr(p))return v.error.v;y=j.getDataDyadicArr(p)}else if(V(p)=="object"&&p.startCell!=null)y=j.getCellDataDyadicArr(p,"text");else{if(!Y(p))return v.error.v;var o=[];o.push(parseFloat(p)),y.push(o)}for(var e=0;e<y.length;e++)for(var u=0;u<y[0].length;u++){if(!Y(y[e][u]))return v.error.v;y[e][u]=parseFloat(y[e][u])}}var x=!0;if(arguments.length==4&&(x=j.getCellBoolen(arguments[3]),q(x)))return x;if(a!=g||s!=b)return v.error.r;var _=w(f,l),S=_[0];if(x)var I=_[1];else var I=0;for(var O=[],e=0;e<y.length;e++)for(var u=0;u<y[e].length;u++){var F=y[e][u],D=S*F+I;O.push(Math.round(D*1e9)/1e9)}return O}catch(w){var k=w;return k=v.errorInfo(k),[v.error.v,k]}},FREQUENCY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=l.concat(j.getDataArr(t,!0))}else if(V(t)=="object"&&t.startCell!=null)l=l.concat(j.getCellDataArr(t,"number",!0));else{if(!Y(t))return v.error.v;l.push(t)}for(var o=[],e=0;e<l.length;e++)Y(l[e])&&o.push(parseFloat(l[e]));var a=arguments[1],s=[];if(V(a)=="array"){if(V(a[0])=="array"&&!j.isDyadicArr(a))return v.error.v;s=s.concat(j.getDataArr(a,!0))}else if(V(a)=="object"&&a.startCell!=null)s=s.concat(j.getCellDataArr(a,"number",!0));else{if(!Y(a))return v.error.v;s.push(a)}for(var u=[],e=0;e<s.length;e++)Y(s[e])&&u.push(parseFloat(s[e]));if(o.length==0&&u.length==0)return[[0],[0]];if(o.length==0){for(var f=[[0]],e=0;e<u.length;e++)f.push([0]);return f}else{if(u.length==0)return[[0],[o.length]];u.sort(function(x,_){return x-_});for(var f=[],e=0;e<u.length;e++)if(e==0){for(var m=0,d=0;d<o.length;d++)o[d]<=u[0]&&m++;f.push([m])}else if(e==u.length-1){for(var g=0,b=0,d=0;d<o.length;d++)o[d]<=u[e]&&o[d]>u[e-1]&&g++,o[d]>u[e]&&b++;f.push([g]),f.push([b])}else{for(var m=0,d=0;d<o.length;d++)o[d]<=u[e]&&o[d]>u[e-1]&&m++;f.push([m])}return f}}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},GROWTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{let w=function(C,T){for(var z=0,A=0,M=0,P=0,N=0;N<C.length;N++)for(var E=0;E<C[N].length;E++)z+=C[N][E],A+=Math.log(T[N][E]),M+=C[N][E]*Math.log(T[N][E]),P+=C[N][E]*C[N][E];var B=C.length*C[0].length,U=z/B,X=A/B,le=M/B,he=P/B,Z=(le-U*X)/(he-U*U),ae=X-Z*U;return[Math.exp(Z),Math.exp(ae)]};var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=j.getDataDyadicArr(t)}else if(V(t)=="object"&&t.startCell!=null)l=j.getCellDataDyadicArr(t,"text");else{if(!Y(t))return v.error.v;var o=[];o.push(parseFloat(t)),l.push(o)}for(var a=l.length,s=l[0].length,e=0;e<a;e++)for(var u=0;u<s;u++){if(!Y(l[e][u]))return v.error.v;l[e][u]=parseFloat(l[e][u])}for(var f=[],e=1;e<=a;e++)for(var u=1;u<=s;u++){var m=(e-1)*s+u;f.push(m)}if(arguments.length>=2){var d=arguments[1];if(f=[],V(d)=="array"){if(V(d[0])=="array"&&!j.isDyadicArr(d))return v.error.v;f=j.getDataDyadicArr(d)}else if(V(d)=="object"&&d.startCell!=null)f=j.getCellDataDyadicArr(d,"text");else{if(!Y(d))return v.error.v;var o=[];o.push(parseFloat(d)),f.push(o)}for(var e=0;e<f.length;e++)for(var u=0;u<f[0].length;u++){if(!Y(f[e][u]))return v.error.v;f[e][u]=parseFloat(f[e][u])}}var g=f.length,b=f[0].length,y=f;if(arguments.length>=3){var p=arguments[2];if(y=[],V(p)=="array"){if(V(p[0])=="array"&&!j.isDyadicArr(p))return v.error.v;y=j.getDataDyadicArr(p)}else if(V(p)=="object"&&p.startCell!=null)y=j.getCellDataDyadicArr(p,"text");else{if(!Y(p))return v.error.v;var o=[];o.push(parseFloat(p)),y.push(o)}for(var e=0;e<y.length;e++)for(var u=0;u<y[0].length;u++){if(!Y(y[e][u]))return v.error.v;y[e][u]=parseFloat(y[e][u])}}var x=!0;if(arguments.length==4&&(x=j.getCellBoolen(arguments[3]),q(x)))return x;if(a!=g||s!=b)return v.error.r;var _=w(f,l),S=_[0];if(x)var I=_[1];else var I=1;for(var O=[],e=0;e<y.length;e++)for(var u=0;u<y[e].length;u++){var F=y[e][u],D=I*Math.pow(S,F);O.push(Math.round(D*1e9)/1e9)}return O}catch(w){var k=w;return k=v.errorInfo(k),[v.error.v,k]}},LINEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return v.error.v}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},LOGEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return v.error.v}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},MDETERM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{let u=function(f,m){var d,g=new Array;if(m==1)return d=f[0][0],d;if(m==2)return d=f[0][0]*f[1][1]-f[0][1]*f[1][0],d;if(m==3)return d=f[0][0]*f[1][1]*f[2][2]+f[1][0]*f[2][1]*f[0][2]+f[2][0]*f[0][1]*f[1][2]-f[2][0]*f[1][1]*f[0][2]-f[0][0]*f[2][1]*f[1][2]-f[1][0]*f[0][1]*f[2][2],d;d=0;for(var b=new Array,y=new Array,p=0;p<m;p++)g[p]=f[p][0]*Math.pow(-1,p+1+1);for(var p=0;p<m;p++){y[p]=new Array;for(var x=0;x<m-1;x++)y[p][x]=f[p][x+1]}for(var p=0;p<m;p++){for(var x=0;x<m;x++){b[x]=new Array;for(var _=0;_<m-1;_++)p>x?b[x][_]=y[x][_]:p<x&&(b[x-1][_]=y[x][_])}d+=g[p]*arguments.callee(b,m-1)}return d};var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=j.getDataDyadicArr(t)}else if(V(t)=="object"&&t.startCell!=null)l=j.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++){if(!Y(l[e][a]))return v.error.v;l[e][a]=parseFloat(l[e][a])}return l.length!=l[0].length?v.error.v:u(l,l.length)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},MINVERSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=j.getDataDyadicArr(t)}else if(V(t)=="object"&&t.startCell!=null)l=j.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++){if(!Y(l[e][a]))return v.error.v;l[e][a]=parseFloat(l[e][a])}return l.length!=l[0].length?v.error.v:kh(l)}catch(u){var s=u;return s=v.errorInfo(s),[v.error.v,s]}},MMULT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=j.getDataDyadicArr(t)}else if(V(t)=="object"&&t.startCell!=null)l=j.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++){if(!Y(l[e][a]))return v.error.v;l[e][a]=parseFloat(l[e][a])}var s=arguments[1],u=[];if(V(s)=="array"){if(V(s[0])=="array"&&!j.isDyadicArr(s))return v.error.v;u=j.getDataDyadicArr(s)}else if(V(s)=="object"&&s.startCell!=null)u=j.getCellDataDyadicArr(s,"text");else{var o=[];o.push(s),u.push(o)}for(var e=0;e<u.length;e++)for(var a=0;a<u[e].length;a++){if(!Y(u[e][a]))return v.error.v;u[e][a]=parseFloat(u[e][a])}if(l[0].length!=u.length)return v.error.v;for(var f=l.length,m=u[0].length,d=[],g=0;g<f;g++){for(var o=[],b=0;b<m;b++){for(var y=0,n=0;n<l[0].length;n++)y+=l[g][n]*u[n][b];o.push(y)}d.push(o)}return d}catch(x){var p=x;return p=v.errorInfo(p),[v.error.v,p]}},SUMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=j.getDataDyadicArr(t)}else if(V(t)=="object"&&t.startCell!=null)l=j.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++)Y(l[e][a])?l[e][a]=parseFloat(l[e][a]):l[e][a]=0;var s=l.length,u=l[0].length;if(arguments.length>=2)for(var e=1;e<arguments.length;e++){var f=arguments[e],m=[];if(V(f)=="array"){if(V(f[0])=="array"&&!j.isDyadicArr(f))return v.error.v;m=j.getDataDyadicArr(f)}else if(V(f)=="object"&&f.startCell!=null)m=j.getCellDataDyadicArr(f,"text");else{var o=[];o.push(f),m.push(o)}if(m.length!=s||m[0].length!=u)return v.error.v;for(var d=0;d<s;d++)for(var g=0;g<u;g++)Y(m[d][g])?l[d][g]=l[d][g]*parseFloat(m[d][g]):l[d][g]=0}for(var b=0,d=0;d<s;d++)for(var g=0;g<u;g++)b+=l[d][g];return b}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},ISFORMULA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;return V(t)=="object"&&t.startCell!=null?t.data==null?!1:(V(t.data)=="array"?l=t.data[0][0]:l=t.data,l!=null&&l.f!=null):v.error.v}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},CELL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=t[0][0]}else l=t[0];else if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;if(V(t.data)=="array")return v.error.v;if(l=t.data.v,rt(l))return v.error.v}else l=t;var o=arguments[1],a;if(V(o)=="object"&&o.startCell!=null)a=o.startCell;else return v.error.v;if(["address","col","color","contents","filename","format","parentheses","prefix","protect","row","type","width"].indexOf(l)==-1)return v.error.v;var s=Yl()[$e(h.currentSheetIndex)],u=v.getcellrange(a),f=u.row[0],m=u.column[0];let b=Yl(),y=$e(h.calculateSheetIndex),p=b[y].data,x;switch(v.execFunctionGlobalData!=null&&v.execFunctionGlobalData[f+"_"+m+"_"+h.calculateSheetIndex]!=null?x=v.execFunctionGlobalData[f+"_"+m+"_"+h.calculateSheetIndex].v:p[f][m]!=null&&p[f][m].v!=null&&p[f][m].v!=""?(x=p[f][m],x instanceof Object&&(x=x.v)):x=0,l){case"address":return a;case"col":return m+1;case"color":return 0;case"contents":return x;case"filename":return s.name;case"format":return p[f][m]==null||p[f][m].ct==null?"G":p[f][m].ct.fa;case"parentheses":return p[f][m]==null||p[f][m].v==null||p[f][m].v==""?0:p[f][m].v>0?1:0;case"prefix":return x==0?"":p[f][m].ht==0?"^":p[f][m].ht==1?"'":p[f][m].ht==2?'"':"";case"protect":return 0;case"row":return f+1;case"type":return x==0?"b":"l";case"width":var d=s.config;return d.columnlen!=null&&m in d.columnlen?d.columnlen[m]:h.defaultcollen}}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},NA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return v.error.na}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},ERROR_TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=t[0][0]}else l=t[0];else if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.na;if(V(t.data)=="array"){if(l=t.data[0][0],l==null||rt(l.v))return v.error.na;l=l.v}else{if(rt(t.data.v))return v.error.na;l=t.data.v}}else l=t;var o={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7,"#GETTING_DATA":8};return l in o?o[l]:v.error.na}catch(s){var a=s;return a=v.errorInfo(a),[v.error.v,a]}},ISBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;return V(t)=="object"&&t.startCell!=null?t.data==null:!1}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ISERR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=t[0][0]}else l=t[0];else if(V(t)=="object"&&t.startCell!=null){if(V(t.data)=="array")return!0;if(t.data==null||rt(t.data.v))return!1;l=t.data.v}else l=t;return["#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ISERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=t[0][0]}else l=t[0];else if(V(t)=="object"&&t.startCell!=null){if(V(t.data)=="array")return!0;if(t.data==null||rt(t.data.v))return!1;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ISLOGICAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=t[0][0]}else l=t[0];else if(V(t)=="object"&&t.startCell!=null){if(V(t.data)=="array"||t.data==null||rt(t.data.v))return!1;l=t.data.v}else l=t;return l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ISNA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=t[0][0]}else l=t[0];else if(V(t)=="object"&&t.startCell!=null){if(V(t.data)=="array"||t.data==null||rt(t.data.v))return!1;l=t.data.v}else l=t;return l.toString()=="#N/A"}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ISNONTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=t[0][0]}else l=t[0];else if(V(t)=="object"&&t.startCell!=null){if(V(t.data)=="array"||t.data==null||rt(t.data.v))return!0;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1||l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?!0:!!Y(l)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ISNUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=t[0][0]}else l=t[0];else if(V(t)=="object"&&t.startCell!=null){if(V(t.data)=="array"||t.data==null||rt(t.data.v))return!1;l=t.data.v}else l=t;return!!Y(l)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},ISREF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{return V(arguments[0])=="object"&&arguments[0].startCell!=null}catch(l){var t=l;return t=v.errorInfo(t),[v.error.v,t]}},ISTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=t[0][0]}else l=t[0];else if(V(t)=="object"&&t.startCell!=null){if(V(t.data)=="array"||t.data==null||rt(t.data.v))return!1;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1||l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?!1:!Y(l)}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")return 64;if(V(t)=="object"&&t.startCell!=null){if(V(t.data)=="array")return 16;if(t.data==null||rt(t.data.v))return 1;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1?16:l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?4:Y(l)?1:2}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},N:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;l=t[0][0]}else l=t[0];else if(V(t)=="object"&&t.startCell!=null)if(V(t.data)=="array"){if(l=t.data[0][0],l==null||rt(l.v))return 0;l=l.v}else{if(t.data==null||rt(t.data.v))return 0;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1?l:l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?l.toString().toLowerCase()=="true"?1:0:Y(l)?parseFloat(l):0}catch(a){var o=a;return o=v.errorInfo(o),[v.error.v,o]}},TO_DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),$l("yyyy-mm-dd",t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},TO_PURE_NUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:(0,ue.default)(t).isValid()?nl(t)[2]:(0,Ku.default)(t).value()==null?t:(0,Ku.default)(t).value()}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},TO_TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0],"text");return q(t)?t:$l("@",t)}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},TO_DOLLARS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),$l("$ 0.00",t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},TO_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);return q(t)?t:Y(t)?(t=parseFloat(t),$l("0%",t)):v.error.v}catch(o){var l=o;return l=v.errorInfo(l),[v.error.v,l]}},DGET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);return u.length===0?v.error.v:u.length>1?v.error.nm:f[u[0]]}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},DMAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);for(var d=f[u[0]],e=1;e<u.length;e++)d<f[u[e]]&&(d=f[u[e]]);return d}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},DMIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=findResultIndex(l,s),f=[];if(V(o)==="string"){var m=findField(l,o);f=rest(l[m])}else f=rest(l[o]);for(var d=f[u[0]],e=1;e<u.length;e++)d>f[u[e]]&&(d=f[u[e]]);return d}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},DAVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);for(var d=0,e=0;e<u.length;e++)d+=f[u[e]];return u.length===0?v.error.d:d/u.length}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},DCOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,d)}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},DCOUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,d)}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},DPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];d=j.compact(d);var g=1;for(e=0;e<d.length;e++)g*=d[e];return g}catch(y){var b=y;return b=v.errorInfo(b),[v.error.v,b]}},DSTDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return d=j.compact(d),window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,d)}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},DSTDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return d=j.compact(d),window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,d)}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},DSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];d=j.compact(d);var g=0;for(e=0;e<d.length;e++)g+=d[e];return g}catch(y){var b=y;return b=v.errorInfo(b),[v.error.v,b]}},DVAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return d=j.compact(d),window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,d)}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},DVARP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="object"&&t.startCell!=null){if(t.data==null)return v.error.v;l=j.getCellDataDyadicArr(t,"text")}else return v.error.v;var o=j.getFirstValue(arguments[1],"text");if(q(o))return o;if(rt(o))return v.error.v;var a=arguments[2],s=[];if(V(a)=="object"&&a.startCell!=null){if(a.data==null)return v.error.v;s=j.getCellDataDyadicArr(a,"text")}else return v.error.v;if(!Y(o)&&V(o)!=="string")return v.error.v;var u=j.findResultIndex(l,s),f=[];if(V(o)==="string"){var m=j.findField(l,o);f=j.rest(l[m])}else f=j.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return d=j.compact(d),window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,d)}catch(b){var g=b;return g=v.errorInfo(g),[v.error.v,g]}},LINESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList,s=arguments[0],u=arguments[1],f=arguments[2],m=arguments[3],d=arguments[4],g=arguments[5],b=arguments[6],y=arguments[7];let w=Yl(),C=$e(h.calculateSheetIndex),T=w[C].data;var p=v.readCellDataToOneArray(s),x=ht.getCellRealSize(T,t,l),_=x[0],S=x[1],I={};f==null&&(f=1),I.lineWidth=f,I.offsetY=f+1,I.height=S-(f+1),I.width=_;var O=function(z,A){A&&(typeof A=="number"&&(A>19&&(A=A%20),A=a[A]),I[z]=A)};if(u==null&&(u="#2ec7c9"),O("lineColor",u),I.fillColor=0,m)if(typeof m=="string"){m=m.toLowerCase();var F=null;m=="min"?F=window.luckysheet_function.MIN.f({data:p}):m=="max"?F=window.luckysheet_function.MAX.f({data:p}):m=="avg"||m=="mean"?F=window.luckysheet_function.AVERAGE.f({data:p}):m=="median"&&(F=window.luckysheet_function.MEDIAN.f({data:p})),F&&(I.normalRangeMin=F,I.normalRangeMax=F)}else I.normalRangeMin=m,I.normalRangeMax=m;d==null&&(d="#000"),O("normalRangeColor",d),O("maxSpotColor",g),O("minSpotColor",b),y==null&&(y="1.5"),I.spotRadius=y;var D=hi.init(p,I);return D}catch(w){var k=w;return k=v.errorInfo(k),[v.error.v,k]}},AREASPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList,s=arguments[0],u=arguments[1],f=arguments[2],m=arguments[3],d=arguments[4],g=arguments[5],b=v.readCellDataToOneArray(s);let D=Yl(),k=$e(h.calculateSheetIndex),w=D[k].data;var y=ht.getCellRealSize(w,t,l),p=y[0],x=y[1],_={};m==null&&(m=1),_.lineWidth=m,_.offsetY=m+1,_.height=x-(m+1),_.width=p;var S=function(C,T){T&&(typeof T=="number"&&(T>19&&(T=T%20),T=a[T]),_[C]=T)};if(u==null&&(u="#2ec7c9"),S("lineColor",u),S("fillColor",f),m==null&&(m="1"),_.lineWidth=m,d)if(typeof d=="string"){d=d.toLowerCase();var I=null;d=="min"?I=window.luckysheet_function.MIN.f({data:b}):d=="max"?I=window.luckysheet_function.MAX.f({data:b}):d=="avg"||d=="mean"?I=window.luckysheet_function.AVERAGE.f({data:b}):d=="median"&&(I=window.luckysheet_function.MEDIAN.f({data:b})),I&&(_.normalRangeMin=I,_.normalRangeMax=I)}else _.normalRangeMin=d,_.normalRangeMax=d;g==null&&(g="#000"),S("normalRangeColor",g);var O=hi.init(b,_);return O}catch(D){var F=D;return F=v.errorInfo(F),[v.error.v,F]}},COLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList,s=arguments[0],u=v.readCellDataToOneArray(s);let F=Yl(),D=$e(h.calculateSheetIndex),k=F[D].data;var f=ht.getCellRealSize(k,t,l),m=f[0],d=f[1],g={};g.height=d,g.width=m;var b=function(w,C){C&&(typeof C=="number"&&(C>19&&(C=C%20),C=a[C]),g[w]=C)},y=arguments[1],p=arguments[2],x=arguments[3],_=arguments[4];g.type="column",y==null&&(y="1"),g.barSpacing=y,p==null&&(p="#fc5c5c"),b("barColor",p),x==null&&(x="#97b552"),b("negBarColor",x),_==null||_===!1||typeof _!="number"?g.chartRangeMax=void 0:g.chartRangeMax=_;var S=v.sparklinesColorMap(arguments);S&&(g.colorMap=S);var I=hi.init(u,g);return I}catch(F){var O=F;return O=v.errorInfo(O),[v.error.v,O]}},STACKCOLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList,s=arguments[0],u=[],f=[];if(s!=null&&s.data!=null&&(f=s.data),V(f)=="array")f=v.getPureValueByData(f);else{if(V(f)=="object")return f=f.v,[f];/\{.*?\}/.test(f)&&(f=f.replace(/\{/g,"[").replace(/\}/g,"]")),f=new Function("return "+f)()}var m=arguments[1],d=f.length;if(m==null||!!m)for(var g=0;g<f[0].length;g++){for(var b="",y=0;y<f.length;y++)b+=f[y][g]+":";b=b.substr(0,b.length-1),u.push(b)}else{for(var y=0;y<f.length;y++){for(var p="",g=0;g<f[0].length;g++)p+=f[y][g]+":";p=p.substr(0,p.length-1),u.push(p)}var d=f[0].length}let T=Yl(),z=$e(h.calculateSheetIndex),A=T[z].data;var x=ht.getCellRealSize(A,t,l),_=x[0],S=x[1],I={};I.height=S,I.width=_;var O=function(M,P){P&&(typeof P=="number"&&(P>19&&(P=P%20),P=a[P]),I[M]=P)},F=arguments[2],D=arguments[3];I.type="column",F==null&&(F="1"),I.barSpacing=F,D==null||D===!1||typeof D!="number"?I.chartRangeMax=void 0:I.chartRangeMax=D;var k=v.sparklinesColorMap(arguments,4);k&&(I.colorMap=k);var w=hi.init(u,I);return w}catch(T){var C=T;return C=v.errorInfo(C),[v.error.v,C]}},BARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList,s=arguments[0],u=v.readCellDataToOneArray(s);let F=Yl(),D=$e(h.calculateSheetIndex),k=F[D].data;var f=ht.getCellRealSize(k,t,l),m=f[0],d=f[1],g={};g.height=d,g.width=m;var b=function(w,C){C&&(typeof C=="number"&&(C>19&&(C=C%20),C=a[C]),g[w]=C)},y=arguments[1],p=arguments[2],x=arguments[3],_=arguments[4];g.type="bar",y==null&&(y="1"),g.barSpacing=y,p==null&&(p="#fc5c5c"),b("barColor",p),x==null&&(x="#97b552"),b("negBarColor",x),_==null||_===!1||typeof _!="number"?g.chartRangeMax=void 0:g.chartRangeMax=_;var S=v.sparklinesColorMap(arguments);S&&(g.colorMap=S);var I=hi.init(u,g);return I}catch(F){var O=F;return O=v.errorInfo(O),[v.error.v,O]}},STACKBARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList,s=arguments[0],u=[],f=[];if(s!=null&&s.data!=null&&(f=s.data),V(f)=="array")f=v.getPureValueByData(f);else{if(V(f)=="object")return f=f.v,[f];/\{.*?\}/.test(f)&&(f=f.replace(/\{/g,"[").replace(/\}/g,"]")),f=new Function("return "+f)()}var m=arguments[1],d=f.length;if(m==null||!!m)for(var g=0;g<f[0].length;g++){for(var b="",y=0;y<f.length;y++)b+=f[y][g]+":";b=b.substr(0,b.length-1),u.push(b)}else{for(var y=0;y<f.length;y++){for(var p="",g=0;g<f[0].length;g++)p+=f[y][g]+":";p=p.substr(0,p.length-1),u.push(p)}var d=f[0].length}let T=Yl(),z=$e(h.calculateSheetIndex),A=T[z].data;var x=ht.getCellRealSize(A,t,l),_=x[0],S=x[1],I={};I.height=S,I.width=_;var O=function(M,P){P&&(typeof P=="number"&&(P>19&&(P=P%20),P=a[P]),I[M]=P)},F=arguments[2],D=arguments[3];I.type="bar",F==null&&(F="1"),I.barSpacing=F,D==null||D===!1||typeof D!="number"?I.chartRangeMax=void 0:I.chartRangeMax=D;var k=v.sparklinesColorMap(arguments,4);k&&(I.colorMap=k);var w=hi.init(u,I);return w}catch(T){var C=T;return C=v.errorInfo(C),[v.error.v,C]}},DISCRETESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList,s=arguments[0],u=v.readCellDataToOneArray(s);let I=Yl(),O=$e(h.calculateSheetIndex),F=I[O].data;var f=ht.getCellRealSize(F,t,l),m=f[0],d=f[1],g={};g.height=d,g.width=m;var b=function(D,k){k&&(typeof k=="number"&&(k>19&&(k=k%20),k=a[k]),g[D]=k)},y=arguments[1],p=arguments[2],x=arguments[3];g.type="discrete",y==null&&(y=0),g.thresholdValue=y,p==null&&(p="#2ec7c9"),b("lineColor",p),x==null&&(x="#fc5c5c"),b("thresholdColor",x);var _=hi.init(u,g);return _}catch(I){var S=I;return S=v.errorInfo(S),[v.error.v,S]}},TRISTATESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList,s=arguments[0],u=v.readCellDataToOneArray(s);let F=Yl(),D=$e(h.calculateSheetIndex),k=F[D].data;var f=ht.getCellRealSize(k,t,l),m=f[0],d=f[1],g={};g.height=d,g.width=m;var b=function(w,C){C&&(typeof C=="number"&&(C>19&&(C=C%20),C=a[C]),g[w]=C)},y=arguments[1],p=arguments[2],x=arguments[3],_=arguments[4];g.type="tristate",y==null&&(y="1"),g.barSpacing=y,p==null&&(p="#fc5c5c"),b("barColor",p),x==null&&(x="#97b552"),b("negBarColor",x),_==null&&(_="#999"),b("zeroBarColor",_);var S=v.sparklinesColorMap(arguments);S&&(g.colorMap=S);var I=hi.init(u,g);return I}catch(F){var O=F;return O=v.errorInfo(O),[v.error.v,O]}},PIESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList,s=arguments[0],u=v.readCellDataToOneArray(s);let O=Yl(),F=$e(h.calculateSheetIndex),D=O[F].data;var f=ht.getCellRealSize(D,t,l),m=f[0],d=f[1],g={};g.height=d,g.width=m;var b=function(k,w){w&&(typeof w=="number"&&(w>19&&(w=w%20),w=a[w]),g[k]=w)},y=arguments[1],p=arguments[2],x=arguments[3];g.type="pie",y==null&&(y=0),g.offset=y,p==null&&(p=0),b("borderWidth",p),x==null&&(x="#97b552"),b("borderColor",x);var _=v.sparklinesColorMap(arguments,4);_&&(g.colorMap=_);var S=hi.init(u,g);return S}catch(O){var I=O;return I=v.errorInfo(I),[v.error.v,I]}},BOXSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList,s=arguments[0],u=v.readCellDataToOneArray(s);let I=Yl(),O=$e(h.calculateSheetIndex),F=I[O].data;var f=ht.getCellRealSize(F,t,l),m=f[0],d=f[1],g={};g.height=d,g.width=m;var b=function(D,k){k&&(typeof k=="number"&&(k>19&&(k=k%20),k=a[k]),g[D]=k)},y=arguments[1],p=arguments[2],x=arguments[3];g.type="box",y==null&&(y=1.5),g.outlierIQR=y,p==null?p=0:b("target",p),x==null&&(x=1.5),b("spotRadius",x);var _=hi.init(u,g);return _}catch(I){var S=I;return S=v.errorInfo(S),[v.error.v,S]}},BULLETSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=v.colorList;let _=Yl(),S=$e(h.calculateSheetIndex),I=_[S].data;var s=ht.getCellRealSize(I,t,l),u=s[0],f=s[1],m={};m.height=f,m.width=u;var d=function(O,F){F&&(typeof F=="number"&&(F>19&&(F=F%20),F=a[F]),m[O]=F)},g=[];$a(arguments);var b=v.getValueByFuncData(arguments[0]),y=v.getValueByFuncData(arguments[1]);g.push(b),g.push(y);for(var e=2;e<arguments.length;e++)g.push(v.getValueByFuncData(arguments[e]));m.type="bullet";var p=hi.init(g,m);return p}catch(_){var x=_;return x=v.errorInfo(x),[v.error.v,x]}},SORT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[],o=1,a=1;if(V(t)=="array")if(V(t[0])=="array"){if(!j.isDyadicArr(t))return v.error.v;for(var e=0;e<t.length;e++){for(var s=[],u=0;u<t[e].length;u++){var f=t[e][u];s.push(f)}l.push(s)}o=l.length,a=l[0].length}else{for(var e=0;e<t.length;e++){var f=t[e];l.push(f)}o=l.length}else if(V(t)=="object"&&t.startCell!=null)if(t.data!=null)if(V(t.data)=="array"){for(var e=0;e<t.data.length;e++){for(var s=[],u=0;u<t.data[e].length;u++)if(t.data[e][u]!=null){var f=t.data[e][u].v;rt(f)&&(f=0),s.push(f)}else s.push(0);l.push(s)}o=l.length,a=l[0].length}else{var f=t.data.v;rt(f)&&(f=0),l.push(f)}else l.push(0);else{var f=t;l.push(f)}var m=1;if(arguments.length>=2){if(m=j.getFirstValue(arguments[1]),q(m))return m;if(!Y(m))return v.error.v;m=parseInt(m)}var d=1;if(arguments.length>=3){if(d=j.getFirstValue(arguments[2]),q(d))return d;if(!Y(d))return v.error.v;d=Math.floor(parseFloat(d))}var g=!1;if(arguments.length==4&&(g=j.getCellBoolen(arguments[3]),q(g)))return g;if(g){if(m<1||m>o)return v.error.v}else if(m<1||m>a)return v.error.v;if(d!=1&&d!=-1)return v.error.v;var b=function(x,_){if(V(x)=="array"&&(x=x[m-1]),V(_)=="array"&&(_=_[m-1]),!isNaN(x)&&!isNaN(_))return x-_;if(isNaN(x))if(isNaN(_)){if(x>_)return 1;if(x<_)return-1}else return 1;else return-1},y=function(x,_){if(V(x)=="array"&&(x=x[m-1]),V(_)=="array"&&(_=_[m-1]),!isNaN(x)&&!isNaN(_))return _-x;if(isNaN(x))if(isNaN(_)){if(x>_)return-1;if(x<_)return 1}else return-1;else return 1};return g?(l=l[0].map(function(x,_){return l.map(function(S){return S[_]})}),d==1&&l.sort(b),d==-1&&l.sort(y),l=l[0].map(function(x,_){return l.map(function(S){return S[_]})})):(d==1&&l.sort(b),d==-1&&l.sort(y)),l}catch(x){var p=x;return p=v.errorInfo(p),[v.error.v,p]}},FILTER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=j.getDataDyadicArr(t)}else if(V(t)=="object"&&t.startCell!=null)l=j.getCellDataDyadicArr(t,"number");else{var o=[];o.push(parseFloat(t)),l.push(o)}var a=l.length,s=l[0].length,u=arguments[1],f=[],m="row";if(V(u)=="array")if(V(u[0])=="array"){if(!j.isDyadicArr(u))return v.error.v;if(u.length>1&&u[0].length>1)return v.error.v;if(u.length>1){if(u.length!=l.length)return v.error.v;m="row";for(var e=0;e<u.length;e++){var d=u[e][0];if(V(d)!="boolean")if(V(d)=="string"&&(d.toLowerCase()=="true"||d.toLowerCase()=="false"))d.toLowerCase()=="true"?d=!0:d.toLowerCase()=="false"&&(d=!1);else if(Y(d))d=parseFloat(d),d=d!=0;else return v.error.v;f.push(d)}}if(u[0].length>1){if(u[0].length!=l[0].length)return v.error.v;m="col";for(var e=0;e<u[0].length;e++){var d=u[0][e];if(V(d)!="boolean")if(V(d)=="string"&&(d.toLowerCase()=="true"||d.toLowerCase()=="false"))d.toLowerCase()=="true"?d=!0:d.toLowerCase()=="false"&&(d=!1);else if(Y(d))d=parseFloat(d),d=d!=0;else return v.error.v;f.push(d)}}}else{if(u.length!=l[0].length)return v.error.v;m="col";for(var e=0;e<u.length;e++){var d=u[e];if(V(d)!="boolean")if(V(d)=="string"&&(d.toLowerCase()=="true"||d.toLowerCase()=="false"))d.toLowerCase()=="true"?d=!0:d.toLowerCase()=="false"&&(d=!1);else if(Y(d))d=parseFloat(d),d=d!=0;else return v.error.v;f.push(d)}}else if(V(u)=="object"&&u.data!=null&&V(u.data)=="array"){if(u.data.length>1&&u.data[0].length>1)return v.error.v;if(u.data.length>1){if(u.data.length!=l.length)return v.error.v;m="row";for(var e=0;e<u.data.length;e++){var d=u.data[e][0].v;if(rt(d)&&(d=0),V(d)!="boolean")if(V(d)=="string"&&(d.toLowerCase()=="true"||d.toLowerCase()=="false"))d.toLowerCase()=="true"?d=!0:d.toLowerCase()=="false"&&(d=!1);else if(Y(d))d=parseFloat(d),d=d!=0;else return v.error.v;f.push(d)}}if(u.data[0].length>1){if(u.data[0].length!=l[0].length)return v.error.v;m="col";for(var e=0;e<u.data[0].length;e++){var d=u.data[0][e].v;if(rt(d)&&(d=0),V(d)!="boolean")if(V(d)=="string"&&(d.toLowerCase()=="true"||d.toLowerCase()=="false"))d.toLowerCase()=="true"?d=!0:d.toLowerCase()=="false"&&(d=!1);else if(Y(d))d=parseFloat(d),d=d!=0;else return v.error.v;f.push(d)}}}else return v.error.v;var g="";if(arguments.length==3&&(g=j.getFirstValue(arguments[2],"text"),q(g)))return g;var b=[];if(m=="row")for(var e=0;e<l.length;e++)f[e]&&b.push(l[e]);else for(var e=0;e<l.length;e++){for(var o=[],y=0;y<l[0].length;y++)f[y]&&o.push(l[e][y]);o.length>0&&b.push(o)}return b.length==0?g:b}catch(x){var p=x;return p=v.errorInfo(p),[v.error.v,p]}},UNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=arguments[0],l=[];if(V(t)=="array"){if(V(t[0])=="array"&&!j.isDyadicArr(t))return v.error.v;l=j.getDataDyadicArr(t)}else if(V(t)=="object"&&t.startCell!=null)l=j.getCellDataDyadicArr(t,"number");else{var o=[];o.push(parseFloat(t)),l.push(o)}var a=!1;if(arguments.length>=2&&(a=j.getCellBoolen(arguments[1]),q(a)))return a;var s=!1;if(arguments.length==3&&(s=j.getCellBoolen(arguments[2]),q(s)))return s;if(a){l=l[0].map(function(p,x){return l.map(function(_){return _[x]})});for(var u={},f=[],m=[],e=0;e<l.length;e++){for(var d="",g=0;g<l[e].length;g++)d+=l[e][g].toString()+"|||";f.push(d),d in u||(u[d]=0,m.push(l[e]))}if(s){for(var b=[],e=0;e<f.length;e++)f.indexOf(f[e])==f.lastIndexOf(f[e])&&b.push(l[e]);return b=b[0].map(function(p,x){return b.map(function(_){return _[x]})}),b}else return m=m[0].map(function(p,x){return m.map(function(_){return _[x]})}),m}else{for(var u={},f=[],m=[],e=0;e<l.length;e++){for(var d="",g=0;g<l[e].length;g++)d+=l[e][g].toString()+"|||";f.push(d),d in u||(u[d]=0,m.push(l[e]))}if(s){for(var b=[],e=0;e<f.length;e++)f.indexOf(f[e])==f.lastIndexOf(f[e])&&b.push(l[e]);return b}else return m}}catch(p){var y=p;return y=v.errorInfo(y),[v.error.v,y]}},RANDARRAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=1;if(arguments.length>=1){if(t=j.getFirstValue(arguments[0]),q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t)}var l=1;if(arguments.length==2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}if(t<=0||l<=0)return v.error.v;for(var o=[],e=0;e<t;e++){for(var a=[],s=0;s<l;s++)a.push(Math.random().toFixed(9));o.push(a)}return o}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},SEQUENCE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=j.getFirstValue(arguments[0]);if(q(t))return t;if(!Y(t))return v.error.v;t=parseInt(t);var l=1;if(arguments.length>=2){if(l=j.getFirstValue(arguments[1]),q(l))return l;if(!Y(l))return v.error.v;l=parseInt(l)}var o=1;if(arguments.length>=3){if(o=j.getFirstValue(arguments[2]),q(o))return o;if(!Y(o))return v.error.v;o=parseFloat(o)}var a=1;if(arguments.length==4){if(a=j.getFirstValue(arguments[3]),q(a))return a;if(!Y(a))return v.error.v;a=parseFloat(a)}if(t<=0||l<=0)return v.error.v;for(var s=[],e=0;e<t;e++){for(var u=[],f=0;f<l;f++){var m=o+a*(f+l*e);u.push(m)}s.push(u)}return s}catch(g){var d=g;return d=v.errorInfo(d),[v.error.v,d]}},EVALUATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;for(var e=0;e<arguments.length;e++){var n=v.errorParamCheck(this.p,arguments[e],e);if(!n[0])return v.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentIndex,a=j.getFirstValue(arguments[0]).toString();if(q(a))return a;a.trim().indexOf("=")!=0&&(a="="+a);var s=v.execstringformula(a,t,l,o);return s[1]}catch(f){var u=f;return u=v.errorInfo(u),[v.error.v,u]}},REMOTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return v.error.na;try{let n=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=j.getFirstValue(arguments[0]);return q(o)?o:(lt.remoteFunction(o,a=>{let s=pt.deepCopyFlowData(h.flowdata);v.execFunctionGroup(n,t,a),s[n][t]={v:a,f:l},Gt(s,[{row:[n,n],column:[t,t]}])}),"Loading...")}catch(n){console.log(n);var e=n;return e=v.errorInfo(e),[v.error.v,e]}}},bk=b_});var import_plugin,w_,xk,_k=Tt(()=>{import_plugin=Le(Be());wk();Ut();Rl();w_=function(){let n=Oe().functionlist;for(let l=0;l<n.length;l++){let o=n[l];o.f=bk[o.n]}h.functionlist=n;let t={};for(let l=0;l<n.length;l++){let o=n[l];t[o.n]=o}window.luckysheet_function=t,h.luckysheet_function=t},xk=w_});function x_(e,n){let t=ct.getSheetByIndex();t.config==null&&(t.config={}),t.config.sheetViewZoom==null&&(t.config.sheetViewZoom={});let l=1,o="zoomScaleNormal";__(t),e=="viewNormal"?o="viewNormalZoomScale":e=="viewLayout"?o="viewLayoutZoomScale":e=="viewPage"&&(o="viewPageZoomScale",l=.6,C_(t));let a=t.config.sheetViewZoom[o];a==null&&(a=l),t.config.curentsheetView=e,h.clearjfundo&&h.jfredo.push({type:"viewChange",curType:e,preType:n,sheetIndex:h.currentSheetIndex}),He.saveParam("cg",h.currentSheetIndex,e,{k:"curentsheetView"}),h.currentSheetView=e,Sa(a)}function __(e){}function C_(e){}function $_(e){let n=e.parent(),t=n.find("luckysheet-print-viewBtn-active").attr("type");if(e.attr("type")==t)return;let l=e.attr("type");if(l!=null)x_(l,t);else return;e.parent().find(".luckysheet-print-viewBtn").removeClass("luckysheet-print-viewBtn-active"),e.addClass("luckysheet-print-viewBtn-active")}function Ck(){let e=lt.container,n=this;$("#"+e).find(".luckysheet-print-viewBtn").click(function(){$_($(this))})}var import_plugin,$k=Tt(()=>{import_plugin=Le(Be());bn();Nc();Yr();wr();Qn();Ut()});var Ik=fn((Wh,Sk)=>{var import_plugin=Le(Be());(function(e,n){typeof Wh=="object"&&typeof Sk!="undefined"?n(Wh):typeof define=="function"&&define.amd?define(["exports"],n):(e=typeof globalThis!="undefined"?globalThis:e||self,n(e.zh={}))})(Wh,function(e){"use strict";var n=typeof window!="undefined"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},t={weekdays:{shorthand:["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],longhand:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"]},months:{shorthand:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"],longhand:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"]},rangeSeparator:" \u81F3 ",weekAbbreviation:"\u5468",scrollTitle:"\u6EDA\u52A8\u5207\u6362",toggleTitle:"\u70B9\u51FB\u5207\u6362 12/24 \u5C0F\u65F6\u65F6\u5236"};n.l10ns.zh=t;var l=n.l10ns;e.Mandarin=t,e.default=l,Object.defineProperty(e,"__esModule",{value:!0})})});function S_(e){clearTimeout(Tk),Tk=setTimeout(()=>{$("#luckysheet-icon-undo")[e?"removeClass":"addClass"]("disabled")},10)}function I_(e){clearTimeout(Rk),Rk=setTimeout(()=>{$("#luckysheet-icon-redo")[e?"removeClass":"addClass"]("disabled")},10)}var import_plugin,Tk,Rk,Fk,Mk=Tt(()=>{import_plugin=Le(Be());gl();Ut();qn();ql();Es();Fk=function(){Bh(h,"jfredo",(e,n,t,l)=>{n!=="length"&&Yt.createHookFunction("updated",t),S_(h.jfredo.length)}),Bh(h,"jfundo",(e,n,t,l)=>{I_(h.jfundo.length)}),Bh(h,"asyncLoad",(e,n,t,l)=>{n==="length"&&t===0&&Yt.createHookFunction("workbookCreateAfter",Eh())})}});function Ak(){Ng(),zy(),Q1(),ik(),ak(),ck(),hk(),mk(),w1(),Ck(),Fk()}var import_plugin,Dk,Zr,zk=Tt(()=>{import_plugin=Le(Be());r0();gl();Ut();Rl();wr();bn();Yr();Bi();J1();wa();ek();ok();sk();uk();dk();gk();kk();ql();Ea();fr();_k();ar();mr();io();vr();Nc();$k();qn();Es();kg();Dk=Le(Ik());Mk();_m();Ms();Zr={};Zr=zg(Rg,Zr);Zr.create=function(e){Yt.destroy(),h.toJsonOptions={};for(let f in e)f!=="data"&&(h.toJsonOptions[f]=e[f]);let n=zg(l0,e),t=n.loadUrl,l=n.menu,o=n.title,a=n.container;h.container=a,h.luckysheetfile=n.data,h.defaultcolumnNum=n.column,h.defaultrowNum=n.row,h.defaultFontSize=n.defaultFontSize,h.fullscreenmode=n.fullscreenmode,h.lang=n.lang,h.allowEdit=n.allowEdit,h.limitSheetNameLength=n.limitSheetNameLength,h.defaultSheetNameMaxLength=n.defaultSheetNameMaxLength,h.fontList=n.fontList,He.gridKey=n.gridKey,He.loadUrl=n.loadUrl,He.updateUrl=n.updateUrl,He.updateImageUrl=n.updateImageUrl,He.title=n.title,He.loadSheetUrl=n.loadSheetUrl,He.allowUpdate=n.allowUpdate,lt.autoFormatw=n.autoFormatw,lt.accuracy=n.accuracy,lt.total=n.data[0].total,lt.loading=n.loading,lt.allowCopy=n.allowCopy,lt.showtoolbar=n.showtoolbar,lt.showtoolbarConfig=n.showtoolbarConfig,lt.showinfobar=n.showinfobar,lt.showsheetbar=n.showsheetbar,lt.showsheetbarConfig=n.showsheetbarConfig,lt.showstatisticBar=n.showstatisticBar,lt.showstatisticBarConfig=n.showstatisticBarConfig,lt.sheetFormulaBar=n.sheetFormulaBar,lt.cellRightClickConfig=n.cellRightClickConfig,lt.sheetRightClickConfig=n.sheetRightClickConfig,lt.pointEdit=n.pointEdit,lt.pointEditUpdate=n.pointEditUpdate,lt.pointEditZoom=n.pointEditZoom,lt.userInfo=n.userInfo,lt.userMenuItem=n.userMenuItem,lt.myFolderUrl=n.myFolderUrl,lt.functionButton=n.functionButton,lt.showConfigWindowResize=n.showConfigWindowResize,lt.enableAddRow=n.enableAddRow,lt.enableAddBackTop=n.enableAddBackTop,lt.addRowCount=n.addRowCount,lt.enablePage=n.enablePage,lt.pageInfo=n.pageInfo,lt.editMode=n.editMode,lt.beforeCreateDom=n.beforeCreateDom,lt.workbookCreateBefore=n.workbookCreateBefore,lt.workbookCreateAfter=n.workbookCreateAfter,lt.remoteFunction=n.remoteFunction,lt.fireMousedown=n.fireMousedown,lt.forceCalculation=n.forceCalculation,lt.plugins=n.plugins,lt.rowHeaderWidth=n.rowHeaderWidth,lt.columnHeaderHeight=n.columnHeaderHeight,lt.defaultColWidth=n.defaultColWidth,lt.defaultRowHeight=n.defaultRowHeight,lt.title=n.title,lt.container=n.container,lt.hook=n.hook,lt.pager=n.pager,lt.initShowsheetbarConfig=!1,lt.imageUpdateMethodConfig=n.imageUpdateMethodConfig,h.lang==="zh"&&Dh.localize(Dk.default.zh),h.asyncLoad.push(...lt.plugins),yk(n.plugins,n.data),xk();let s=n.devicePixelRatio;s==null&&(s=1),h.devicePixelRatio=Math.ceil(s);let u=ko("#"+a);h.loadingObj=u,t==""?(ct.initialjfFile(l,o),Ak()):$.post(t,{gridKey:He.gridKey},function(f){let m=new Function("return "+f)();h.luckysheetfile=m,ct.initialjfFile(l,o),Ak(),He.allowUpdate&&He.openWebSocket()})};Zr.getluckysheetfile=Yl;Zr.getluckysheet_select_save=x0;Zr.setluckysheet_select_save=C0;Zr.getconfig=_0;Zr.getGridData=ct.getGridData;Zr.buildGridData=ct.buildGridData;Zr.luckysheetrefreshgrid=Et;Zr.jfrefreshgrid=Gt;Zr.getcellvalue=Mt;Zr.setcellvalue=er;Zr.getdatabyselection=Xl;Zr.sheetmanage=ct;Zr.flowdata=function(){return h.flowdata};Zr.selectHightlightShow=Zt;Zr.destroy=Yt.destroy;Zr.showLoadingProgress=kc;Zr.hideLoadingProgress=Ru;Zr.luckysheetextendData=dh;Zr.locales=Hd});function T_(){HTMLElement.prototype.__defineGetter__("runtimeStyle",R_),window.constructor.prototype.__defineGetter__("event",F_),Event.prototype.__defineGetter__("srcElement",M_)}function R_(){return this.style}function F_(){return Ok()}function M_(){return this.target}function Ok(){if(document.all)return window.event;for(var e=Ok.caller;e!=null;){var n=e.arguments[0];if(n){var t=n.constructor;if(t.toString().indexOf("Event")!=-1)return n}e=e.caller}return null}var import_plugin,Pk,Ek=Tt(()=>{import_plugin=Le(Be());Pk=T_});var D_=fn((sL,Nk)=>{var import_plugin=Le(Be());t0();zk();Ek();window.addEventListener&&navigator.userAgent.indexOf("Firefox")>0&&Pk();Nk.exports=Zr});return D_();})();
/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */
