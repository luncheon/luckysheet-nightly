!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(x,t){function e(t,e){return e.toUpperCase()}var n=[],C=x.document,l=n.slice,g=n.concat,a=n.push,i=n.indexOf,r={},o=r.toString,d=r.hasOwnProperty,m={},s="2.2.4",k=function(t,e){return new k.fn.init(t,e)},u=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,c=/^-ms-/,h=/-([\da-z])/gi;function f(t){var e=!!t&&"length"in t&&t.length,n=k.type(t);return"function"!==n&&!k.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&0<e&&e-1 in t)}k.fn=k.prototype={jquery:s,constructor:k,selector:"",length:0,toArray:function(){return l.call(this)},get:function(t){return null!=t?t<0?this[t+this.length]:this[t]:l.call(this)},pushStack:function(t){t=k.merge(this.constructor(),t);return t.prevObject=this,t.context=this.context,t},each:function(t){return k.each(this,t)},map:function(n){return this.pushStack(k.map(this,function(t,e){return n.call(t,e,t)}))},slice:function(){return this.pushStack(l.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,t=+t+(t<0?e:0);return this.pushStack(0<=t&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:n.sort,splice:n.splice},k.extend=k.fn.extend=function(){var t,e,n,r,i,o=arguments[0]||{},s=1,a=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[s]||{},s++),"object"==typeof o||k.isFunction(o)||(o={}),s===a&&(o=this,s--);s<a;s++)if(null!=(t=arguments[s]))for(e in t)i=o[e],n=t[e],o!==n&&(u&&n&&(k.isPlainObject(n)||(r=k.isArray(n)))?(i=r?(r=!1,i&&k.isArray(i)?i:[]):i&&k.isPlainObject(i)?i:{},o[e]=k.extend(u,i,n)):void 0!==n&&(o[e]=n));return o},k.extend({expando:"jQuery"+(s+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===k.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=t&&t.toString();return!k.isArray(t)&&0<=e-parseFloat(e)+1},isPlainObject:function(t){if("object"!==k.type(t)||t.nodeType||k.isWindow(t))return!1;if(t.constructor&&!d.call(t,"constructor")&&!d.call(t.constructor.prototype||{},"isPrototypeOf"))return!1;for(var e in t);return void 0===e||d.call(t,e)},isEmptyObject:function(t){for(var e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?r[o.call(t)]||"object":typeof t},globalEval:function(t){var e,n=eval;(t=k.trim(t))&&(1===t.indexOf("use strict")?((e=C.createElement("script")).text=t,C.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(c,"ms-").replace(h,e)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var n,r=0;if(f(t))for(n=t.length;r<n&&!1!==e.call(t[r],r,t[r]);r++);else for(r in t)if(!1===e.call(t[r],r,t[r]))break;return t},trim:function(t){return null==t?"":(t+"").replace(u,"")},makeArray:function(t,e){e=e||[];return null!=t&&(f(Object(t))?k.merge(e,"string"==typeof t?[t]:t):a.call(e,t)),e},inArray:function(t,e,n){return null==e?-1:i.call(e,t,n)},merge:function(t,e){for(var n=+e.length,r=0,i=t.length;r<n;r++)t[i++]=e[r];return t.length=i,t},grep:function(t,e,n){for(var r=[],i=0,o=t.length,s=!n;i<o;i++)!e(t[i],i)!=s&&r.push(t[i]);return r},map:function(t,e,n){var r,i,o=0,s=[];if(f(t))for(r=t.length;o<r;o++)null!=(i=e(t[o],o,n))&&s.push(i);else for(o in t)i=e(t[o],o,n),null!=i&&s.push(i);return g.apply([],s)},guid:1,proxy:function(t,e){var n,r;return"string"==typeof e&&(r=t[e],e=t,t=r),k.isFunction(t)?(n=l.call(arguments,2),(r=function(){return t.apply(e||this,n.concat(l.call(arguments)))}).guid=t.guid=t.guid||k.guid++,r):void 0},now:Date.now,support:m}),"function"==typeof Symbol&&(k.fn[Symbol.iterator]=n[Symbol.iterator]),k.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){r["[object "+e+"]"]=e.toLowerCase()});var p=function(n){function h(t,e,n){var r="0x"+e-65536;return r!=r||n?e:r<0?String.fromCharCode(65536+r):String.fromCharCode(r>>10|55296,1023&r|56320)}function e(){x()}var t,d,w,o,r,g,f,m,_,u,c,x,C,i,k,v,s,a,y,S="sizzle"+ +new Date,b=n.document,O=0,l=0,p=it(),E=it(),T=it(),A=function(t,e){return t===e&&(c=!0),0},I={}.hasOwnProperty,j=[],P=j.pop,D=j.push,N=j.push,R=j.slice,M=function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1},W="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",H="\\["+L+"*("+F+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+L+"*\\]",B=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+H+")*)|.*)\\)|)",q=new RegExp(L+"+","g"),z=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),U=new RegExp("^"+L+"*,"+L+"*"),G=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),V=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),$=new RegExp(B),X=new RegExp("^"+F+"$"),Y={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+H),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+W+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},K=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig");try{N.apply(j=R.call(b.childNodes),b.childNodes),j[b.childNodes.length].nodeType}catch(t){N={apply:j.length?function(t,e){D.apply(t,R.call(e))}:function(t,e){for(var n=t.length,r=0;t[n++]=e[r++];);t.length=n-1}}}function rt(t,e,n,r){var i,o,s,a,u,c,l,h,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&((e?e.ownerDocument||e:b)!==C&&x(e),e=e||C,k)){if(11!==p&&(c=Z.exec(t)))if(i=c[1]){if(9===p){if(!(s=e.getElementById(i)))return n;if(s.id===i)return n.push(s),n}else if(f&&(s=f.getElementById(i))&&y(e,s)&&s.id===i)return n.push(s),n}else{if(c[2])return N.apply(n,e.getElementsByTagName(t)),n;if((i=c[3])&&d.getElementsByClassName&&e.getElementsByClassName)return N.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!T[t+" "]&&(!v||!v.test(t))){if(1!==p)f=e,h=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(et,"\\$&"):e.setAttribute("id",a=S),o=(l=g(t)).length,u=X.test(a)?"#"+a:"[id='"+a+"']";o--;)l[o]=u+" "+ft(l[o]);h=l.join(","),f=tt.test(t)&&lt(e.parentNode)||e}if(h)try{return N.apply(n,f.querySelectorAll(h)),n}catch(t){}finally{a===S&&e.removeAttribute("id")}}}return m(t.replace(z,"$1"),e,n,r)}function it(){var n=[];function r(t,e){return n.push(t+" ")>w.cacheLength&&delete r[n.shift()],r[t+" "]=e}return r}function ot(t){return t[S]=!0,t}function st(t){var e=C.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function at(t,e){for(var n=t.split("|"),r=n.length;r--;)w.attrHandle[n[r]]=e}function ut(t,e){var n=e&&t,r=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||1<<31)-(~t.sourceIndex||1<<31);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ct(s){return ot(function(o){return o=+o,ot(function(t,e){for(var n,r=s([],t.length,o),i=r.length;i--;)t[n=r[i]]&&(t[n]=!(e[n]=t[n]))})})}function lt(t){return t&&void 0!==t.getElementsByTagName&&t}for(t in d=rt.support={},r=rt.isXML=function(t){t=t&&(t.ownerDocument||t).documentElement;return!!t&&"HTML"!==t.nodeName},x=rt.setDocument=function(t){var t=t?t.ownerDocument||t:b;return t!==C&&9===t.nodeType&&t.documentElement&&(i=(C=t).documentElement,k=!r(C),(t=C.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",e,!1):t.attachEvent&&t.attachEvent("onunload",e)),d.attributes=st(function(t){return t.className="i",!t.getAttribute("className")}),d.getElementsByTagName=st(function(t){return t.appendChild(C.createComment("")),!t.getElementsByTagName("*").length}),d.getElementsByClassName=J.test(C.getElementsByClassName),d.getById=st(function(t){return i.appendChild(t).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(w.find.ID=function(t,e){if(void 0!==e.getElementById&&k){t=e.getElementById(t);return t?[t]:[]}},w.filter.ID=function(t){var e=t.replace(nt,h);return function(t){return t.getAttribute("id")===e}}):(delete w.find.ID,w.filter.ID=function(t){var e=t.replace(nt,h);return function(t){t=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return t&&t.value===e}}),w.find.TAG=d.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):d.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,r=[],i=0,o=e.getElementsByTagName(t);if("*"!==t)return o;for(;n=o[i++];)1===n.nodeType&&r.push(n);return r},w.find.CLASS=d.getElementsByClassName&&function(t,e){return void 0!==e.getElementsByClassName&&k?e.getElementsByClassName(t):void 0},s=[],v=[],(d.qsa=J.test(C.querySelectorAll))&&(st(function(t){i.appendChild(t).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+L+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||v.push("\\["+L+"*(?:value|"+W+")"),t.querySelectorAll("[id~="+S+"-]").length||v.push("~="),t.querySelectorAll(":checked").length||v.push(":checked"),t.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]")}),st(function(t){var e=C.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&v.push("name"+L+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),v.push(",.*:")})),(d.matchesSelector=J.test(a=i.matches||i.webkitMatchesSelector||i.mozMatchesSelector||i.oMatchesSelector||i.msMatchesSelector))&&st(function(t){d.disconnectedMatch=a.call(t,"div"),a.call(t,"[s!='']:x"),s.push("!=",B)}),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=J.test(i.compareDocumentPosition),y=t||J.test(i.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,e=e&&e.parentNode;return t===e||!(!e||1!==e.nodeType||!(n.contains?n.contains(e):t.compareDocumentPosition&&16&t.compareDocumentPosition(e)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},A=t?function(t,e){if(t===e)return c=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!d.sortDetached&&e.compareDocumentPosition(t)===n?t===C||t.ownerDocument===b&&y(b,t)?-1:e===C||e.ownerDocument===b&&y(b,e)?1:u?M(u,t)-M(u,e):0:4&n?-1:1)}:function(t,e){if(t===e)return c=!0,0;var n,r=0,i=t.parentNode,o=e.parentNode,s=[t],a=[e];if(!i||!o)return t===C?-1:e===C?1:i?-1:o?1:u?M(u,t)-M(u,e):0;if(i===o)return ut(t,e);for(n=t;n=n.parentNode;)s.unshift(n);for(n=e;n=n.parentNode;)a.unshift(n);for(;s[r]===a[r];)r++;return r?ut(s[r],a[r]):s[r]===b?-1:a[r]===b?1:0}),C},rt.matches=function(t,e){return rt(t,null,null,e)},rt.matchesSelector=function(t,e){if((t.ownerDocument||t)!==C&&x(t),e=e.replace(V,"='$1']"),d.matchesSelector&&k&&!T[e+" "]&&(!s||!s.test(e))&&(!v||!v.test(e)))try{var n=a.call(t,e);if(n||d.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return 0<rt(e,C,null,[t]).length},rt.contains=function(t,e){return(t.ownerDocument||t)!==C&&x(t),y(t,e)},rt.attr=function(t,e){(t.ownerDocument||t)!==C&&x(t);var n=w.attrHandle[e.toLowerCase()],n=n&&I.call(w.attrHandle,e.toLowerCase())?n(t,e,!k):void 0;return void 0!==n?n:d.attributes||!k?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},rt.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},rt.uniqueSort=function(t){var e,n=[],r=0,i=0;if(c=!d.detectDuplicates,u=!d.sortStable&&t.slice(0),t.sort(A),c){for(;e=t[i++];)e===t[i]&&(r=n.push(i));for(;r--;)t.splice(n[r],1)}return u=null,t},o=rt.getText=function(t){var e,n="",r=0,i=t.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=o(t)}else if(3===i||4===i)return t.nodeValue}else for(;e=t[r++];)n+=o(e);return n},(w=rt.selectors={cacheLength:50,createPseudo:ot,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(nt,h),t[3]=(t[3]||t[4]||t[5]||"").replace(nt,h),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||rt.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&rt.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Y.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&$.test(n)&&(e=g(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(nt,h).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=p[t+" "];return e||(e=new RegExp("(^|"+L+")"+t+"("+L+"|$)"))&&p(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(t){t=rt.attr(t,e);return null==t?"!="===n:!n||(t+="","="===n?t===r:"!="===n?t!==r:"^="===n?r&&0===t.indexOf(r):"*="===n?r&&-1<t.indexOf(r):"$="===n?r&&t.slice(-r.length)===r:"~="===n?-1<(" "+t.replace(q," ")+" ").indexOf(r):"|="===n&&(t===r||t.slice(0,r.length+1)===r+"-"))}},CHILD:function(d,t,e,g,m){var v="nth"!==d.slice(0,3),y="last"!==d.slice(-4),b="of-type"===t;return 1===g&&0===m?function(t){return!!t.parentNode}:function(t,e,n){var r,i,o,s,a,u,c=v!=y?"nextSibling":"previousSibling",l=t.parentNode,h=b&&t.nodeName.toLowerCase(),f=!n&&!b,p=!1;if(l){if(v){for(;c;){for(s=t;s=s[c];)if(b?s.nodeName.toLowerCase()===h:1===s.nodeType)return!1;u=c="only"===d&&!u&&"nextSibling"}return!0}if(u=[y?l.firstChild:l.lastChild],y&&f){for(p=(a=(r=(i=(o=(s=l)[S]||(s[S]={}))[s.uniqueID]||(o[s.uniqueID]={}))[d]||[])[0]===O&&r[1])&&r[2],s=a&&l.childNodes[a];s=++a&&s&&s[c]||(p=a=0)||u.pop();)if(1===s.nodeType&&++p&&s===t){i[d]=[O,a,p];break}}else if(f&&(p=a=(r=(i=(o=(s=t)[S]||(s[S]={}))[s.uniqueID]||(o[s.uniqueID]={}))[d]||[])[0]===O&&r[1]),!1===p)for(;(s=++a&&s&&s[c]||(p=a=0)||u.pop())&&((b?s.nodeName.toLowerCase()!==h:1!==s.nodeType)||!++p||(f&&((i=(o=s[S]||(s[S]={}))[s.uniqueID]||(o[s.uniqueID]={}))[d]=[O,p]),s!==t)););return(p-=m)===g||p%g==0&&0<=p/g}}},PSEUDO:function(t,o){var e,s=w.pseudos[t]||w.setFilters[t.toLowerCase()]||rt.error("unsupported pseudo: "+t);return s[S]?s(o):1<s.length?(e=[t,t,"",o],w.setFilters.hasOwnProperty(t.toLowerCase())?ot(function(t,e){for(var n,r=s(t,o),i=r.length;i--;)t[n=M(t,r[i])]=!(e[n]=r[i])}):function(t){return s(t,0,e)}):s}},pseudos:{not:ot(function(t){var r=[],i=[],a=f(t.replace(z,"$1"));return a[S]?ot(function(t,e,n,r){for(var i,o=a(t,null,r,[]),s=t.length;s--;)(i=o[s])&&(t[s]=!(e[s]=i))}):function(t,e,n){return r[0]=t,a(r,null,n,i),r[0]=null,!i.pop()}}),has:ot(function(e){return function(t){return 0<rt(e,t).length}}),contains:ot(function(e){return e=e.replace(nt,h),function(t){return-1<(t.textContent||t.innerText||o(t)).indexOf(e)}}),lang:ot(function(n){return X.test(n||"")||rt.error("unsupported lang: "+n),n=n.replace(nt,h).toLowerCase(),function(t){var e;do{if(e=k?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(e=e.toLowerCase())===n||0===e.indexOf(n+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var e=n.location&&n.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===i},focus:function(t){return t===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!w.pseudos.empty(t)},header:function(t){return Q.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(t=t.getAttribute("type"))||"text"===t.toLowerCase())},first:ct(function(){return[0]}),last:ct(function(t,e){return[e-1]}),eq:ct(function(t,e,n){return[n<0?n+e:n]}),even:ct(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:ct(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:ct(function(t,e,n){for(var r=n<0?n+e:n;0<=--r;)t.push(r);return t}),gt:ct(function(t,e,n){for(var r=n<0?n+e:n;++r<e;)t.push(r);return t})}}).pseudos.nth=w.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[t]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(t);for(t in{submit:!0,reset:!0})w.pseudos[t]=function(n){return function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&t.type===n}}(t);function ht(){}function ft(t){for(var e=0,n=t.length,r="";e<n;e++)r+=t[e].value;return r}function pt(s,t,e){var a=t.dir,u=e&&"parentNode"===a,c=l++;return t.first?function(t,e,n){for(;t=t[a];)if(1===t.nodeType||u)return s(t,e,n)}:function(t,e,n){var r,i,o=[O,c];if(n){for(;t=t[a];)if((1===t.nodeType||u)&&s(t,e,n))return!0}else for(;t=t[a];)if(1===t.nodeType||u){if((i=(r=(i=t[S]||(t[S]={}))[t.uniqueID]||(i[t.uniqueID]={}))[a])&&i[0]===O&&i[1]===c)return o[2]=i[2];if((r[a]=o)[2]=s(t,e,n))return!0}}}function dt(i){return 1<i.length?function(t,e,n){for(var r=i.length;r--;)if(!i[r](t,e,n))return!1;return!0}:i[0]}function gt(t,e,n,r,i){for(var o,s=[],a=0,u=t.length,c=null!=e;a<u;a++)(o=t[a])&&(n&&!n(o,r,i)||(s.push(o),c&&e.push(a)));return s}function mt(p,d,g,m,v,t){return m&&!m[S]&&(m=mt(m)),v&&!v[S]&&(v=mt(v,t)),ot(function(t,e,n,r){var i,o,s,a=[],u=[],c=e.length,l=t||function(t,e,n){for(var r=0,i=e.length;r<i;r++)rt(t,e[r],n);return n}(d||"*",n.nodeType?[n]:n,[]),h=!p||!t&&d?l:gt(l,a,p,n,r),f=g?v||(t?p:c||m)?[]:e:h;if(g&&g(h,f,n,r),m)for(i=gt(f,u),m(i,[],n,r),o=i.length;o--;)(s=i[o])&&(f[u[o]]=!(h[u[o]]=s));if(t){if(v||p){if(v){for(i=[],o=f.length;o--;)(s=f[o])&&i.push(h[o]=s);v(null,f=[],i,r)}for(o=f.length;o--;)(s=f[o])&&-1<(i=v?M(t,s):a[o])&&(t[i]=!(e[i]=s))}}else f=gt(f===e?f.splice(c,f.length):f),v?v(null,e,f,r):N.apply(e,f)})}function vt(m,v){function t(t,e,n,r,i){var o,s,a,u=0,c="0",l=t&&[],h=[],f=_,p=t||b&&w.find.TAG("*",i),d=O+=null==f?1:Math.random()||.1,g=p.length;for(i&&(_=e===C||e||i);c!==g&&null!=(o=p[c]);c++){if(b&&o){for(s=0,e||o.ownerDocument===C||(x(o),n=!k);a=m[s++];)if(a(o,e||C,n)){r.push(o);break}i&&(O=d)}y&&((o=!a&&o)&&u--,t&&l.push(o))}if(u+=c,y&&c!==u){for(s=0;a=v[s++];)a(l,h,e,n);if(t){if(0<u)for(;c--;)l[c]||h[c]||(h[c]=P.call(r));h=gt(h)}N.apply(r,h),i&&!t&&0<h.length&&1<u+v.length&&rt.uniqueSort(r)}return i&&(O=d,_=f),l}var y=0<v.length,b=0<m.length;return y?ot(t):t}return ht.prototype=w.filters=w.pseudos,w.setFilters=new ht,g=rt.tokenize=function(t,e){var n,r,i,o,s,a,u,c=E[t+" "];if(c)return e?0:c.slice(0);for(s=t,a=[],u=w.preFilter;s;){for(o in n&&!(r=U.exec(s))||(r&&(s=s.slice(r[0].length)||s),a.push(i=[])),n=!1,(r=G.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(z," ")}),s=s.slice(n.length)),w.filter)!(r=Y[o].exec(s))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),s=s.slice(n.length));if(!n)break}return e?s.length:s?rt.error(t):E(t,a).slice(0)},f=rt.compile=function(t,e){var n,r=[],i=[],o=T[t+" "];if(!o){for(n=(e=e||g(t)).length;n--;)((o=function t(e){for(var r,n,i,o=e.length,s=w.relative[e[0].type],a=s||w.relative[" "],u=s?1:0,c=pt(function(t){return t===r},a,!0),l=pt(function(t){return-1<M(r,t)},a,!0),h=[function(t,e,n){return n=!s&&(n||e!==_)||((r=e).nodeType?c:l)(t,e,n),r=null,n}];u<o;u++)if(n=w.relative[e[u].type])h=[pt(dt(h),n)];else{if((n=w.filter[e[u].type].apply(null,e[u].matches))[S]){for(i=++u;i<o&&!w.relative[e[i].type];i++);return mt(1<u&&dt(h),1<u&&ft(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(z,"$1"),n,u<i&&t(e.slice(u,i)),i<o&&t(e=e.slice(i)),i<o&&ft(e))}h.push(n)}return dt(h)}(e[n]))[S]?r:i).push(o);(o=T(t,vt(i,r))).selector=t}return o},m=rt.select=function(t,e,n,r){var i,o,s,a,u,c="function"==typeof t&&t,l=!r&&g(t=c.selector||t);if(n=n||[],1===l.length){if(2<(o=l[0]=l[0].slice(0)).length&&"ID"===(s=o[0]).type&&d.getById&&9===e.nodeType&&k&&w.relative[o[1].type]){if(!(e=(w.find.ID(s.matches[0].replace(nt,h),e)||[])[0]))return n;c&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(i=Y.needsContext.test(t)?0:o.length;i--&&(s=o[i],!w.relative[a=s.type]);)if((u=w.find[a])&&(r=u(s.matches[0].replace(nt,h),tt.test(o[0].type)&&lt(e.parentNode)||e))){if(o.splice(i,1),!(t=r.length&&ft(o)))return N.apply(n,r),n;break}}return(c||f(t,l))(r,e,!k,n,!e||tt.test(t)&&lt(e.parentNode)||e),n},d.sortStable=S.split("").sort(A).join("")===S,d.detectDuplicates=!!c,x(),d.sortDetached=st(function(t){return 1&t.compareDocumentPosition(C.createElement("div"))}),st(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||at("type|href|height|width",function(t,e,n){return n?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),d.attributes&&st(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||at("value",function(t,e,n){return n||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),st(function(t){return null==t.getAttribute("disabled")})||at(W,function(t,e,n){return n?void 0:!0===t[e]?e.toLowerCase():(e=t.getAttributeNode(e))&&e.specified?e.value:null}),rt}(x);k.find=p,k.expr=p.selectors,k.expr[":"]=k.expr.pseudos,k.uniqueSort=k.unique=p.uniqueSort,k.text=p.getText,k.isXMLDoc=p.isXML,k.contains=p.contains;function v(t,e,n){for(var r=[],i=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&k(t).is(n))break;r.push(t)}return r}function y(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}var b=k.expr.match.needsContext,w=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,_=/^.[^:#\[\.,]*$/;function S(t,n,r){if(k.isFunction(n))return k.grep(t,function(t,e){return!!n.call(t,e,t)!==r});if(n.nodeType)return k.grep(t,function(t){return t===n!==r});if("string"==typeof n){if(_.test(n))return k.filter(n,t,r);n=k.filter(n,t)}return k.grep(t,function(t){return-1<i.call(n,t)!==r})}k.filter=function(t,e,n){var r=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?k.find.matchesSelector(r,t)?[r]:[]:k.find.matches(t,k.grep(e,function(t){return 1===t.nodeType}))},k.fn.extend({find:function(t){var e,n=this.length,r=[],i=this;if("string"!=typeof t)return this.pushStack(k(t).filter(function(){for(e=0;e<n;e++)if(k.contains(i[e],this))return!0}));for(e=0;e<n;e++)k.find(t,i[e],r);return(r=this.pushStack(1<n?k.unique(r):r)).selector=this.selector?this.selector+" "+t:t,r},filter:function(t){return this.pushStack(S(this,t||[],!1))},not:function(t){return this.pushStack(S(this,t||[],!0))},is:function(t){return!!S(this,"string"==typeof t&&b.test(t)?k(t):t||[],!1).length}});var O,E=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(k.fn.init=function(t,e,n){if(!t)return this;if(n=n||O,"string"!=typeof t)return t.nodeType?(this.context=this[0]=t,this.length=1,this):k.isFunction(t)?void 0!==n.ready?n.ready(t):t(k):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),k.makeArray(t,this));if(!(r="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:E.exec(t))||!r[1]&&e)return(!e||e.jquery?e||n:this.constructor(e)).find(t);if(r[1]){if(e=e instanceof k?e[0]:e,k.merge(this,k.parseHTML(r[1],e&&e.nodeType?e.ownerDocument||e:C,!0)),w.test(r[1])&&k.isPlainObject(e))for(var r in e)k.isFunction(this[r])?this[r](e[r]):this.attr(r,e[r]);return this}return(n=C.getElementById(r[2]))&&n.parentNode&&(this.length=1,this[0]=n),this.context=C,this.selector=t,this}).prototype=k.fn,O=k(C);var T=/^(?:parents|prev(?:Until|All))/,A={children:!0,contents:!0,next:!0,prev:!0};function I(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}k.fn.extend({has:function(t){var e=k(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(k.contains(this,e[t]))return!0})},closest:function(t,e){for(var n,r=0,i=this.length,o=[],s=b.test(t)||"string"!=typeof t?k(t,e||this.context):0;r<i;r++)for(n=this[r];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?-1<s.index(n):1===n.nodeType&&k.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(1<o.length?k.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?i.call(k(t),this[0]):i.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(k.uniqueSort(k.merge(this.get(),k(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),k.each({parent:function(t){t=t.parentNode;return t&&11!==t.nodeType?t:null},parents:function(t){return v(t,"parentNode")},parentsUntil:function(t,e,n){return v(t,"parentNode",n)},next:function(t){return I(t,"nextSibling")},prev:function(t){return I(t,"previousSibling")},nextAll:function(t){return v(t,"nextSibling")},prevAll:function(t){return v(t,"previousSibling")},nextUntil:function(t,e,n){return v(t,"nextSibling",n)},prevUntil:function(t,e,n){return v(t,"previousSibling",n)},siblings:function(t){return y((t.parentNode||{}).firstChild,t)},children:function(t){return y(t.firstChild)},contents:function(t){return t.contentDocument||k.merge([],t.childNodes)}},function(r,i){k.fn[r]=function(t,e){var n=k.map(this,i,t);return"Until"!==r.slice(-5)&&(e=t),e&&"string"==typeof e&&(n=k.filter(e,n)),1<this.length&&(A[r]||k.uniqueSort(n),T.test(r)&&n.reverse()),this.pushStack(n)}});var j,P=/\S+/g;function D(){C.removeEventListener("DOMContentLoaded",D),x.removeEventListener("load",D),k.ready()}k.Callbacks=function(r){var t,n;r="string"==typeof r?(t=r,n={},k.each(t.match(P)||[],function(t,e){n[e]=!0}),n):k.extend({},r);function i(){for(a=r.once,s=o=!0;c.length;l=-1)for(e=c.shift();++l<u.length;)!1===u[l].apply(e[0],e[1])&&r.stopOnFalse&&(l=u.length,e=!1);r.memory||(e=!1),o=!1,a&&(u=e?[]:"")}var o,e,s,a,u=[],c=[],l=-1,h={add:function(){return u&&(e&&!o&&(l=u.length-1,c.push(e)),function n(t){k.each(t,function(t,e){k.isFunction(e)?r.unique&&h.has(e)||u.push(e):e&&e.length&&"string"!==k.type(e)&&n(e)})}(arguments),e&&!o&&i()),this},remove:function(){return k.each(arguments,function(t,e){for(var n;-1<(n=k.inArray(e,u,n));)u.splice(n,1),n<=l&&l--}),this},has:function(t){return t?-1<k.inArray(t,u):0<u.length},empty:function(){return u=u&&[],this},disable:function(){return a=c=[],u=e="",this},disabled:function(){return!u},lock:function(){return a=c=[],e||(u=e=""),this},locked:function(){return!!a},fireWith:function(t,e){return a||(e=[t,(e=e||[]).slice?e.slice():e],c.push(e),o||i()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!s}};return h},k.extend({Deferred:function(t){var o=[["resolve","done",k.Callbacks("once memory"),"resolved"],["reject","fail",k.Callbacks("once memory"),"rejected"],["notify","progress",k.Callbacks("memory")]],i="pending",s={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var i=arguments;return k.Deferred(function(r){k.each(o,function(t,e){var n=k.isFunction(i[t])&&i[t];a[e[1]](function(){var t=n&&n.apply(this,arguments);t&&k.isFunction(t.promise)?t.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[e[0]+"With"](this===s?r.promise():this,n?[t]:arguments)})}),i=null}).promise()},promise:function(t){return null!=t?k.extend(t,s):s}},a={};return s.pipe=s.then,k.each(o,function(t,e){var n=e[2],r=e[3];s[e[1]]=n.add,r&&n.add(function(){i=r},o[1^t][2].disable,o[2][2].lock),a[e[0]]=function(){return a[e[0]+"With"](this===a?s:this,arguments),this},a[e[0]+"With"]=n.fireWith}),s.promise(a),t&&t.call(a,a),a},when:function(t){function e(e,n,r){return function(t){n[e]=this,r[e]=1<arguments.length?l.call(arguments):t,r===i?c.notifyWith(n,r):--u||c.resolveWith(n,r)}}var i,n,r,o=0,s=l.call(arguments),a=s.length,u=1!==a||t&&k.isFunction(t.promise)?a:0,c=1===u?t:k.Deferred();if(1<a)for(i=new Array(a),n=new Array(a),r=new Array(a);o<a;o++)s[o]&&k.isFunction(s[o].promise)?s[o].promise().progress(e(o,n,i)).done(e(o,r,s)).fail(c.reject):--u;return u||c.resolveWith(r,s),c.promise()}}),k.fn.ready=function(t){return k.ready.promise().done(t),this},k.extend({isReady:!1,readyWait:1,holdReady:function(t){t?k.readyWait++:k.ready(!0)},ready:function(t){(!0===t?--k.readyWait:k.isReady)||((k.isReady=!0)!==t&&0<--k.readyWait||(j.resolveWith(C,[k]),k.fn.triggerHandler&&(k(C).triggerHandler("ready"),k(C).off("ready"))))}}),k.ready.promise=function(t){return j||(j=k.Deferred(),"complete"===C.readyState||"loading"!==C.readyState&&!C.documentElement.doScroll?x.setTimeout(k.ready):(C.addEventListener("DOMContentLoaded",D),x.addEventListener("load",D))),j.promise(t)},k.ready.promise();function N(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType}var R=function(t,e,n,r,i,o,s){var a=0,u=t.length,c=null==n;if("object"===k.type(n))for(a in i=!0,n)R(t,e,a,n[a],!0,o,s);else if(void 0!==r&&(i=!0,k.isFunction(r)||(s=!0),c&&(e=s?(e.call(t,r),null):(c=e,function(t,e,n){return c.call(k(t),n)})),e))for(;a<u;a++)e(t[a],n,s?r:r.call(t[a],a,e(t[a],n)));return i?t:c?e.call(t):u?e(t[0],n):o};function M(){this.expando=k.expando+M.uid++}M.uid=1,M.prototype={register:function(t,e){e=e||{};return t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,writable:!0,configurable:!0}),t[this.expando]},cache:function(t){if(!N(t))return{};var e=t[this.expando];return e||(e={},N(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var r,i=this.cache(t);if("string"==typeof e)i[e]=n;else for(r in e)i[r]=e[r];return i},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][e]},access:function(t,e,n){var r;return void 0===e||e&&"string"==typeof e&&void 0===n?void 0!==(r=this.get(t,e))?r:this.get(t,k.camelCase(e)):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,r,i,o=t[this.expando];if(void 0!==o){if(void 0===e)this.register(t);else{n=(r=k.isArray(e)?e.concat(e.map(k.camelCase)):(i=k.camelCase(e),e in o?[e,i]:(r=i)in o?[r]:r.match(P)||[])).length;for(;n--;)delete o[r[n]]}void 0!==e&&!k.isEmptyObject(o)||(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){t=t[this.expando];return void 0!==t&&!k.isEmptyObject(t)}};var W=new M,L=new M,F=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,H=/[A-Z]/g;function B(t,e,n){var r;if(void 0===n&&1===t.nodeType)if(r="data-"+e.replace(H,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:F.test(n)?k.parseJSON(n):n)}catch(t){}L.set(t,e,n)}else n=void 0;return n}k.extend({hasData:function(t){return L.hasData(t)||W.hasData(t)},data:function(t,e,n){return L.access(t,e,n)},removeData:function(t,e){L.remove(t,e)},_data:function(t,e,n){return W.access(t,e,n)},_removeData:function(t,e){W.remove(t,e)}}),k.fn.extend({data:function(r,t){var e,n,i,o=this[0],s=o&&o.attributes;if(void 0!==r)return"object"==typeof r?this.each(function(){L.set(this,r)}):R(this,function(e){var t,n;return o&&void 0===e?void 0!==(t=L.get(o,r)||L.get(o,r.replace(H,"-$&").toLowerCase()))?t:(n=k.camelCase(r),void 0!==(t=L.get(o,n))?t:void 0!==(t=B(o,n,void 0))?t:void 0):(n=k.camelCase(r),void this.each(function(){var t=L.get(this,n);L.set(this,n,e),-1<r.indexOf("-")&&void 0!==t&&L.set(this,r,e)}))},null,t,1<arguments.length,null,!0);if(this.length&&(i=L.get(o),1===o.nodeType&&!W.get(o,"hasDataAttrs"))){for(e=s.length;e--;)s[e]&&(0===(n=s[e].name).indexOf("data-")&&(n=k.camelCase(n.slice(5)),B(o,n,i[n])));W.set(o,"hasDataAttrs",!0)}return i},removeData:function(t){return this.each(function(){L.remove(this,t)})}}),k.extend({queue:function(t,e,n){var r;return t?(e=(e||"fx")+"queue",r=W.get(t,e),n&&(!r||k.isArray(n)?r=W.access(t,e,k.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(t,e){e=e||"fx";var n=k.queue(t,e),r=n.length,i=n.shift(),o=k._queueHooks(t,e);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===e&&n.unshift("inprogress"),delete o.stop,i.call(t,function(){k.dequeue(t,e)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return W.get(t,n)||W.access(t,n,{empty:k.Callbacks("once memory").add(function(){W.remove(t,[e+"queue",n])})})}}),k.fn.extend({queue:function(e,n){var t=2;return"string"!=typeof e&&(n=e,e="fx",t--),arguments.length<t?k.queue(this[0],e):void 0===n?this:this.each(function(){var t=k.queue(this,e,n);k._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&k.dequeue(this,e)})},dequeue:function(t){return this.each(function(){k.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){function n(){--i||o.resolveWith(s,[s])}var r,i=1,o=k.Deferred(),s=this,a=this.length;for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(r=W.get(s[a],t+"queueHooks"))&&r.empty&&(i++,r.empty.add(n));return n(),o.promise(e)}});function q(t,e){return t=e||t,"none"===k.css(t,"display")||!k.contains(t.ownerDocument,t)}var s=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,z=new RegExp("^(?:([+-])=|)("+s+")([a-z%]*)$","i"),U=["Top","Right","Bottom","Left"];function G(t,e,n,r){var i,o=1,s=20,a=r?function(){return r.cur()}:function(){return k.css(t,e,"")},u=a(),c=n&&n[3]||(k.cssNumber[e]?"":"px"),l=(k.cssNumber[e]||"px"!==c&&+u)&&z.exec(k.css(t,e));if(l&&l[3]!==c)for(c=c||l[3],n=n||[],l=+u||1;o=o||".5",l/=o,k.style(t,e,l+c),o!==(o=a()/u)&&1!==o&&--s;);return n&&(l=+l||+u||0,i=n[1]?l+(n[1]+1)*n[2]:+n[2],r&&(r.unit=c,r.start=l,r.end=i)),i}var V=/^(?:checkbox|radio)$/i,$=/<([\w:-]+)/,X=/^$|\/(?:java|ecma)script/i,Y={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function K(t,e){var n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&k.nodeName(t,e)?k.merge([t],n):n}function Q(t,e){for(var n=0,r=t.length;n<r;n++)W.set(t[n],"globalEval",!e||W.get(e[n],"globalEval"))}Y.optgroup=Y.option,Y.tbody=Y.tfoot=Y.colgroup=Y.caption=Y.thead,Y.th=Y.td;var J=/<|&#?\w+;/;function Z(t,e,n,r,i){for(var o,s,a,u,c,l=e.createDocumentFragment(),h=[],f=0,p=t.length;f<p;f++)if((o=t[f])||0===o)if("object"===k.type(o))k.merge(h,o.nodeType?[o]:o);else if(J.test(o)){for(s=s||l.appendChild(e.createElement("div")),a=($.exec(o)||["",""])[1].toLowerCase(),a=Y[a]||Y._default,s.innerHTML=a[1]+k.htmlPrefilter(o)+a[2],c=a[0];c--;)s=s.lastChild;k.merge(h,s.childNodes),(s=l.firstChild).textContent=""}else h.push(e.createTextNode(o));for(l.textContent="",f=0;o=h[f++];)if(r&&-1<k.inArray(o,r))i&&i.push(o);else if(u=k.contains(o.ownerDocument,o),s=K(l.appendChild(o),"script"),u&&Q(s),n)for(c=0;o=s[c++];)X.test(o.type||"")&&n.push(o);return l}n=C.createDocumentFragment().appendChild(C.createElement("div")),(p=C.createElement("input")).setAttribute("type","radio"),p.setAttribute("checked","checked"),p.setAttribute("name","t"),n.appendChild(p),m.checkClone=n.cloneNode(!0).cloneNode(!0).lastChild.checked,n.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!n.cloneNode(!0).lastChild.defaultValue;var tt=/^key/,et=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,nt=/^([^.]*)(?:\.(.+)|)/;function rt(){return!0}function it(){return!1}function ot(){try{return C.activeElement}catch(t){}}function st(t,e,n,r,i,o){var s,a;if("object"==typeof e){for(a in"string"!=typeof n&&(r=r||n,n=void 0),e)st(t,a,n,r,e[a],o);return t}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=it;else if(!i)return t;return 1===o&&(s=i,(i=function(t){return k().off(t),s.apply(this,arguments)}).guid=s.guid||(s.guid=k.guid++)),t.each(function(){k.event.add(this,e,i,r,n)})}k.event={global:{},add:function(e,t,n,r,i){var o,s,a,u,c,l,h,f,p,d=W.get(e);if(d)for(n.handler&&(n=(o=n).handler,i=o.selector),n.guid||(n.guid=k.guid++),(a=d.events)||(a=d.events={}),(s=d.handle)||(s=d.handle=function(t){return void 0!==k&&k.event.triggered!==t.type?k.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(P)||[""]).length;u--;)h=p=(c=nt.exec(t[u])||[])[1],f=(c[2]||"").split(".").sort(),h&&(l=k.event.special[h]||{},h=(i?l.delegateType:l.bindType)||h,l=k.event.special[h]||{},c=k.extend({type:h,origType:p,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&k.expr.match.needsContext.test(i),namespace:f.join(".")},o),(p=a[h])||((p=a[h]=[]).delegateCount=0,l.setup&&!1!==l.setup.call(e,r,f,s)||e.addEventListener&&e.addEventListener(h,s)),l.add&&(l.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),k.event.global[h]=!0)},remove:function(t,e,n,r,i){var o,s,a,u,c,l,h,f,p,d,g,m=W.hasData(t)&&W.get(t);if(m&&(u=m.events)){for(c=(e=(e||"").match(P)||[""]).length;c--;)if(p=g=(a=nt.exec(e[c])||[])[1],d=(a[2]||"").split(".").sort(),p){for(h=k.event.special[p]||{},f=u[p=(r?h.delegateType:h.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=f.length;o--;)l=f[o],!i&&g!==l.origType||n&&n.guid!==l.guid||a&&!a.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(f.splice(o,1),l.selector&&f.delegateCount--,h.remove&&h.remove.call(t,l));s&&!f.length&&(h.teardown&&!1!==h.teardown.call(t,d,m.handle)||k.removeEvent(t,p,m.handle),delete u[p])}else for(p in u)k.event.remove(t,p+e[c],n,r,!0);k.isEmptyObject(u)&&W.remove(t,"handle events")}},dispatch:function(t){t=k.event.fix(t);var e,n,r,i,o,s=l.call(arguments),a=(W.get(this,"events")||{})[t.type]||[],u=k.event.special[t.type]||{};if((s[0]=t).delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,t)){for(o=k.event.handlers.call(this,t,a),e=0;(r=o[e++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,n=0;(i=r.handlers[n++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(i.namespace)||(t.handleObj=i,t.data=i.data,void 0!==(i=((k.event.special[i.origType]||{}).handle||i.handler).apply(r.elem,s))&&!1===(t.result=i)&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,r,i,o,s=[],a=e.delegateCount,u=t.target;if(a&&u.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&(!0!==u.disabled||"click"!==t.type)){for(r=[],n=0;n<a;n++)void 0===r[i=(o=e[n]).selector+" "]&&(r[i]=o.needsContext?-1<k(i,this).index(u):k.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return a<e.length&&s.push({elem:this,handlers:e.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,r,i=e.button;return null==t.pageX&&null!=e.clientX&&(n=(r=t.target.ownerDocument||C).documentElement,r=r.body,t.pageX=e.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0)),t.which||void 0===i||(t.which=1&i?1:2&i?3:4&i?2:0),t}},fix:function(t){if(t[k.expando])return t;var e,n,r,i=t.type,o=t,s=this.fixHooks[i];for(s||(this.fixHooks[i]=s=et.test(i)?this.mouseHooks:tt.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,t=new k.Event(o),e=r.length;e--;)t[n=r[e]]=o[n];return t.target||(t.target=C),3===t.target.nodeType&&(t.target=t.target.parentNode),s.filter?s.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==ot()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===ot()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&k.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return k.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},k.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},k.Event=function(t,e){return this instanceof k.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?rt:it):this.type=t,e&&k.extend(this,e),this.timeStamp=t&&t.timeStamp||k.now(),void(this[k.expando]=!0)):new k.Event(t,e)},k.Event.prototype={constructor:k.Event,isDefaultPrevented:it,isPropagationStopped:it,isImmediatePropagationStopped:it,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=rt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=rt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=rt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},k.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,i){k.event.special[t]={delegateType:i,bindType:i,handle:function(t){var e,n=t.relatedTarget,r=t.handleObj;return n&&(n===this||k.contains(this,n))||(t.type=r.origType,e=r.handler.apply(this,arguments),t.type=i),e}}}),k.fn.extend({on:function(t,e,n,r){return st(this,t,e,n,r)},one:function(t,e,n,r){return st(this,t,e,n,r,1)},off:function(t,e,n){var r,i;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,k(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"!=typeof t)return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=it),this.each(function(){k.event.remove(this,t,n,e)});for(i in t)this.off(i,e,t[i]);return this}});var at=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ut=/<script|<style|<link/i,ct=/checked\s*(?:[^=]|=\s*.checked.)/i,lt=/^true\/(.*)/,ht=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function ft(t,e){return k.nodeName(t,"table")&&k.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function pt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function dt(t){var e=lt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function gt(t,e){var n,r,i,o,s,a;if(1===e.nodeType){if(W.hasData(t)&&(o=W.access(t),s=W.set(e,o),a=o.events))for(i in delete s.handle,s.events={},a)for(n=0,r=a[i].length;n<r;n++)k.event.add(e,i,a[i][n]);L.hasData(t)&&(t=L.access(t),t=k.extend({},t),L.set(e,t))}}function mt(n,r,i,o){r=g.apply([],r);var t,e,s,a,u,c,l=0,h=n.length,f=h-1,p=r[0],d=k.isFunction(p);if(d||1<h&&"string"==typeof p&&!m.checkClone&&ct.test(p))return n.each(function(t){var e=n.eq(t);d&&(r[0]=p.call(this,t,e.html())),mt(e,r,i,o)});if(h&&(e=(t=Z(r,n[0].ownerDocument,!1,n,o)).firstChild,1===t.childNodes.length&&(t=e),e||o)){for(a=(s=k.map(K(t,"script"),pt)).length;l<h;l++)u=t,l!==f&&(u=k.clone(u,!0,!0),a&&k.merge(s,K(u,"script"))),i.call(n[l],u,l);if(a)for(c=s[s.length-1].ownerDocument,k.map(s,dt),l=0;l<a;l++)u=s[l],X.test(u.type||"")&&!W.access(u,"globalEval")&&k.contains(c,u)&&(u.src?k._evalUrl&&k._evalUrl(u.src):k.globalEval(u.textContent.replace(ht,"")))}return n}function vt(t,e,n){for(var r,i=e?k.filter(e,t):t,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||k.cleanData(K(r)),r.parentNode&&(n&&k.contains(r.ownerDocument,r)&&Q(K(r,"script")),r.parentNode.removeChild(r));return t}k.extend({htmlPrefilter:function(t){return t.replace(at,"<$1></$2>")},clone:function(t,e,n){var r,i,o,s,a,u,c,l=t.cloneNode(!0),h=k.contains(t.ownerDocument,t);if(!(m.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||k.isXMLDoc(t)))for(s=K(l),r=0,i=(o=K(t)).length;r<i;r++)a=o[r],u=s[r],c=void 0,"input"===(c=u.nodeName.toLowerCase())&&V.test(a.type)?u.checked=a.checked:"input"!==c&&"textarea"!==c||(u.defaultValue=a.defaultValue);if(e)if(n)for(o=o||K(t),s=s||K(l),r=0,i=o.length;r<i;r++)gt(o[r],s[r]);else gt(t,l);return 0<(s=K(l,"script")).length&&Q(s,!h&&K(t,"script")),l},cleanData:function(t){for(var e,n,r,i=k.event.special,o=0;void 0!==(n=t[o]);o++)if(N(n)){if(e=n[W.expando]){if(e.events)for(r in e.events)i[r]?k.event.remove(n,r):k.removeEvent(n,r,e.handle);n[W.expando]=void 0}n[L.expando]&&(n[L.expando]=void 0)}}}),k.fn.extend({domManip:mt,detach:function(t){return vt(this,t,!0)},remove:function(t){return vt(this,t)},text:function(t){return R(this,function(t){return void 0===t?k.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return mt(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||ft(this,t).appendChild(t)})},prepend:function(){return mt(this,arguments,function(t){var e;1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(e=ft(this,t)).insertBefore(t,e.firstChild)})},before:function(){return mt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return mt(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(k.cleanData(K(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return k.clone(this,t,e)})},html:function(t){return R(this,function(t){var e=this[0]||{},n=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!ut.test(t)&&!Y[($.exec(t)||["",""])[1].toLowerCase()]){t=k.htmlPrefilter(t);try{for(;n<r;n++)1===(e=this[n]||{}).nodeType&&(k.cleanData(K(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var n=[];return mt(this,arguments,function(t){var e=this.parentNode;k.inArray(this,n)<0&&(k.cleanData(K(this)),e&&e.replaceChild(t,this))},n)}}),k.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,s){k.fn[t]=function(t){for(var e,n=[],r=k(t),i=r.length-1,o=0;o<=i;o++)e=o===i?this:this.clone(!0),k(r[o])[s](e),a.apply(n,e.get());return this.pushStack(n)}});var yt,bt={HTML:"block",BODY:"block"};function wt(t,e){t=k(e.createElement(t)).appendTo(e.body),e=k.css(t[0],"display");return t.detach(),e}function _t(t){var e=C,n=bt[t];return n||("none"!==(n=wt(t,e))&&n||((e=(yt=(yt||k("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),n=wt(t,e),yt.detach()),bt[t]=n),n}function xt(t,e,n,r){var i,o={};for(i in e)o[i]=t.style[i],t.style[i]=e[i];for(i in r=n.apply(t,r||[]),e)t.style[i]=o[i];return r}var Ct,kt,St,Ot,Et,Tt,At=/^margin/,It=new RegExp("^("+s+")(?!px)[a-z%]+$","i"),jt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=x),e.getComputedStyle(t)},Pt=C.documentElement;function Dt(){Tt.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",Tt.innerHTML="",Pt.appendChild(Et);var t=x.getComputedStyle(Tt);Ct="1%"!==t.top,Ot="2px"===t.marginLeft,kt="4px"===t.width,Tt.style.marginRight="50%",St="4px"===t.marginRight,Pt.removeChild(Et)}function Nt(t,e,n){var r,i,o=t.style;return""!==(i=(n=n||jt(t))?n.getPropertyValue(e)||n[e]:void 0)&&void 0!==i||k.contains(t.ownerDocument,t)||(i=k.style(t,e)),n&&!m.pixelMarginRight()&&It.test(i)&&At.test(e)&&(r=o.width,t=o.minWidth,e=o.maxWidth,o.minWidth=o.maxWidth=o.width=i,i=n.width,o.width=r,o.minWidth=t,o.maxWidth=e),void 0!==i?i+"":i}function Rt(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}Et=C.createElement("div"),(Tt=C.createElement("div")).style&&(Tt.style.backgroundClip="content-box",Tt.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===Tt.style.backgroundClip,Et.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",Et.appendChild(Tt),k.extend(m,{pixelPosition:function(){return Dt(),Ct},boxSizingReliable:function(){return null==kt&&Dt(),kt},pixelMarginRight:function(){return null==kt&&Dt(),St},reliableMarginLeft:function(){return null==kt&&Dt(),Ot},reliableMarginRight:function(){var t,e=Tt.appendChild(C.createElement("div"));return e.style.cssText=Tt.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",Tt.style.width="1px",Pt.appendChild(Et),t=!parseFloat(x.getComputedStyle(e).marginRight),Pt.removeChild(Et),Tt.removeChild(e),t}}));var Mt=/^(none|table(?!-c[ea]).+)/,Wt={position:"absolute",visibility:"hidden",display:"block"},Lt={letterSpacing:"0",fontWeight:"400"},Ft=["Webkit","O","Moz","ms"],Ht=C.createElement("div").style;function Bt(t){if(t in Ht)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=Ft.length;n--;)if((t=Ft[n]+e)in Ht)return t}function qt(t,e,n){var r=z.exec(e);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):e}function zt(t,e,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===e?1:0,s=0;o<4;o+=2)"margin"===n&&(s+=k.css(t,n+U[o],!0,i)),r?("content"===n&&(s-=k.css(t,"padding"+U[o],!0,i)),"margin"!==n&&(s-=k.css(t,"border"+U[o]+"Width",!0,i))):(s+=k.css(t,"padding"+U[o],!0,i),"padding"!==n&&(s+=k.css(t,"border"+U[o]+"Width",!0,i)));return s}function Ut(t,e,n){var r=!0,i="width"===e?t.offsetWidth:t.offsetHeight,o=jt(t),s="border-box"===k.css(t,"boxSizing",!1,o);if(i<=0||null==i){if(((i=Nt(t,e,o))<0||null==i)&&(i=t.style[e]),It.test(i))return i;r=s&&(m.boxSizingReliable()||i===t.style[e]),i=parseFloat(i)||0}return i+zt(t,e,n||(s?"border":"content"),r,o)+"px"}function Gt(t,e){for(var n,r,i,o=[],s=0,a=t.length;s<a;s++)(r=t[s]).style&&(o[s]=W.get(r,"olddisplay"),n=r.style.display,e?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&q(r)&&(o[s]=W.access(r,"olddisplay",_t(r.nodeName)))):(i=q(r),"none"===n&&i||W.set(r,"olddisplay",i?n:k.css(r,"display"))));for(s=0;s<a;s++)(r=t[s]).style&&(e&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=e?o[s]||"":"none"));return t}function Vt(t,e,n,r,i){return new Vt.prototype.init(t,e,n,r,i)}k.extend({cssHooks:{opacity:{get:function(t,e){if(e){t=Nt(t,"opacity");return""===t?"1":t}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,o,s,a=k.camelCase(e),u=t.style;return e=k.cssProps[a]||(k.cssProps[a]=Bt(a)||a),s=k.cssHooks[e]||k.cssHooks[a],void 0===n?s&&"get"in s&&void 0!==(i=s.get(t,!1,r))?i:u[e]:("string"===(o=typeof n)&&(i=z.exec(n))&&i[1]&&(n=G(t,e,i),o="number"),void(null!=n&&n==n&&("number"===o&&(n+=i&&i[3]||(k.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==n||0!==e.indexOf("background")||(u[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,r))||(u[e]=n))))}},css:function(t,e,n,r){var i,o=k.camelCase(e);return e=k.cssProps[o]||(k.cssProps[o]=Bt(o)||o),(o=k.cssHooks[e]||k.cssHooks[o])&&"get"in o&&(i=o.get(t,!0,n)),void 0===i&&(i=Nt(t,e,r)),"normal"===i&&e in Lt&&(i=Lt[e]),""===n||n?(e=parseFloat(i),!0===n||isFinite(e)?e||0:i):i}}),k.each(["height","width"],function(t,o){k.cssHooks[o]={get:function(t,e,n){return e?Mt.test(k.css(t,"display"))&&0===t.offsetWidth?xt(t,Wt,function(){return Ut(t,o,n)}):Ut(t,o,n):void 0},set:function(t,e,n){var r,i=n&&jt(t),i=n&&zt(t,o,n,"border-box"===k.css(t,"boxSizing",!1,i),i);return i&&(r=z.exec(e))&&"px"!==(r[3]||"px")&&(t.style[o]=e,e=k.css(t,o)),qt(0,e,i)}}}),k.cssHooks.marginLeft=Rt(m.reliableMarginLeft,function(t,e){return e?(parseFloat(Nt(t,"marginLeft"))||t.getBoundingClientRect().left-xt(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px":void 0}),k.cssHooks.marginRight=Rt(m.reliableMarginRight,function(t,e){return e?xt(t,{display:"inline-block"},Nt,[t,"marginRight"]):void 0}),k.each({margin:"",padding:"",border:"Width"},function(i,o){k.cssHooks[i+o]={expand:function(t){for(var e=0,n={},r="string"==typeof t?t.split(" "):[t];e<4;e++)n[i+U[e]+o]=r[e]||r[e-2]||r[0];return n}},At.test(i)||(k.cssHooks[i+o].set=qt)}),k.fn.extend({css:function(t,e){return R(this,function(t,e,n){var r,i,o={},s=0;if(k.isArray(e)){for(r=jt(t),i=e.length;s<i;s++)o[e[s]]=k.css(t,e[s],!1,r);return o}return void 0!==n?k.style(t,e,n):k.css(t,e)},t,e,1<arguments.length)},show:function(){return Gt(this,!0)},hide:function(){return Gt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){q(this)?k(this).show():k(this).hide()})}}),(k.Tween=Vt).prototype={constructor:Vt,init:function(t,e,n,r,i,o){this.elem=t,this.prop=n,this.easing=i||k.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(k.cssNumber[n]?"":"px")},cur:function(){var t=Vt.propHooks[this.prop];return(t&&t.get?t:Vt.propHooks._default).get(this)},run:function(t){var e,n=Vt.propHooks[this.prop];return this.options.duration?this.pos=e=k.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(n&&n.set?n:Vt.propHooks._default).set(this),this}},Vt.prototype.init.prototype=Vt.prototype,Vt.propHooks={_default:{get:function(t){return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(t=k.css(t.elem,t.prop,""))&&"auto"!==t?t:0},set:function(t){k.fx.step[t.prop]?k.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[k.cssProps[t.prop]]&&!k.cssHooks[t.prop]?t.elem[t.prop]=t.now:k.style(t.elem,t.prop,t.now+t.unit)}}},Vt.propHooks.scrollTop=Vt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},k.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},k.fx=Vt.prototype.init,k.fx.step={};var $t,Xt,Yt=/^(?:toggle|show|hide)$/,Kt=/queueHooks$/;function Qt(){return x.setTimeout(function(){$t=void 0}),$t=k.now()}function Jt(t,e){var n,r=0,i={height:t};for(e=e?1:0;r<4;r+=2-e)i["margin"+(n=U[r])]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function Zt(t,e,n){for(var r,i=(te.tweeners[e]||[]).concat(te.tweeners["*"]),o=0,s=i.length;o<s;o++)if(r=i[o].call(n,e,t))return r}function te(i,t,e){var n,o,r=0,s=te.prefilters.length,a=k.Deferred().always(function(){delete u.elem}),u=function(){if(o)return!1;for(var t=$t||Qt(),t=Math.max(0,c.startTime+c.duration-t),e=1-(t/c.duration||0),n=0,r=c.tweens.length;n<r;n++)c.tweens[n].run(e);return a.notifyWith(i,[c,e,t]),e<1&&r?t:(a.resolveWith(i,[c]),!1)},c=a.promise({elem:i,props:k.extend({},t),opts:k.extend(!0,{specialEasing:{},easing:k.easing._default},e),originalProperties:t,originalOptions:e,startTime:$t||Qt(),duration:e.duration,tweens:[],createTween:function(t,e){t=k.Tween(i,c.opts,t,e,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(t),t},stop:function(t){var e=0,n=t?c.tweens.length:0;if(o)return this;for(o=!0;e<n;e++)c.tweens[e].run(1);return t?(a.notifyWith(i,[c,1,0]),a.resolveWith(i,[c,t])):a.rejectWith(i,[c,t]),this}}),l=c.props;for(function(t,e){var n,r,i,o,s;for(n in t)if(r=k.camelCase(n),i=e[r],o=t[n],k.isArray(o)&&(i=o[1],o=t[n]=o[0]),n!==r&&(t[r]=o,delete t[n]),s=k.cssHooks[r],s&&"expand"in s)for(n in o=s.expand(o),delete t[r],o)n in t||(t[n]=o[n],e[n]=i);else e[r]=i}(l,c.opts.specialEasing);r<s;r++)if(n=te.prefilters[r].call(c,i,l,c.opts))return k.isFunction(n.stop)&&(k._queueHooks(c.elem,c.opts.queue).stop=k.proxy(n.stop,n)),n;return k.map(l,Zt,c),k.isFunction(c.opts.start)&&c.opts.start.call(i,c),k.fx.timer(k.extend(u,{elem:i,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}k.Animation=k.extend(te,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return G(n.elem,t,z.exec(e),n),n}]},tweener:function(t,e){for(var n,r=0,i=(t=k.isFunction(t)?(e=t,["*"]):t.match(P)).length;r<i;r++)n=t[r],te.tweeners[n]=te.tweeners[n]||[],te.tweeners[n].unshift(e)},prefilters:[function(e,t,n){var r,i,o,s,a,u,c,l=this,h={},f=e.style,p=e.nodeType&&q(e),d=W.get(e,"fxshow");for(r in n.queue||(null==(a=k._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,l.always(function(){l.always(function(){a.unqueued--,k.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===("none"===(c=k.css(e,"display"))?W.get(e,"olddisplay")||_t(e.nodeName):c)&&"none"===k.css(e,"float")&&(f.display="inline-block")),n.overflow&&(f.overflow="hidden",l.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]})),t)if(i=t[r],Yt.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(p?"hide":"show")){if("show"!==i||!d||void 0===d[r])continue;p=!0}h[r]=d&&d[r]||k.style(e,r)}else c=void 0;if(k.isEmptyObject(h))"inline"===("none"===c?_t(e.nodeName):c)&&(f.display=c);else for(r in d?"hidden"in d&&(p=d.hidden):d=W.access(e,"fxshow",{}),o&&(d.hidden=!p),p?k(e).show():l.done(function(){k(e).hide()}),l.done(function(){for(var t in W.remove(e,"fxshow"),h)k.style(e,t,h[t])}),h)s=Zt(p?d[r]:0,r,l),r in d||(d[r]=s.start,p&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}],prefilter:function(t,e){e?te.prefilters.unshift(t):te.prefilters.push(t)}}),k.speed=function(t,e,n){var r=t&&"object"==typeof t?k.extend({},t):{complete:n||!n&&e||k.isFunction(t)&&t,duration:t,easing:n&&e||e&&!k.isFunction(e)&&e};return r.duration=k.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in k.fx.speeds?k.fx.speeds[r.duration]:k.fx.speeds._default,null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){k.isFunction(r.old)&&r.old.call(this),r.queue&&k.dequeue(this,r.queue)},r},k.fn.extend({fadeTo:function(t,e,n,r){return this.filter(q).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(e,t,n,r){var i=k.isEmptyObject(e),o=k.speed(t,n,r),r=function(){var t=te(this,k.extend({},e),o);(i||W.get(this,"finish"))&&t.stop(!0)};return r.finish=r,i||!1===o.queue?this.each(r):this.queue(o.queue,r)},stop:function(i,t,o){function s(t){var e=t.stop;delete t.stop,e(o)}return"string"!=typeof i&&(o=t,t=i,i=void 0),t&&!1!==i&&this.queue(i||"fx",[]),this.each(function(){var t=!0,e=null!=i&&i+"queueHooks",n=k.timers,r=W.get(this);if(e)r[e]&&r[e].stop&&s(r[e]);else for(e in r)r[e]&&r[e].stop&&Kt.test(e)&&s(r[e]);for(e=n.length;e--;)n[e].elem!==this||null!=i&&n[e].queue!==i||(n[e].anim.stop(o),t=!1,n.splice(e,1));!t&&o||k.dequeue(this,i)})},finish:function(s){return!1!==s&&(s=s||"fx"),this.each(function(){var t,e=W.get(this),n=e[s+"queue"],r=e[s+"queueHooks"],i=k.timers,o=n?n.length:0;for(e.finish=!0,k.queue(this,s,[]),r&&r.stop&&r.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===s&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;t<o;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete e.finish})}}),k.each(["toggle","show","hide"],function(t,r){var i=k.fn[r];k.fn[r]=function(t,e,n){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(Jt(r,!0),t,e,n)}}),k.each({slideDown:Jt("show"),slideUp:Jt("hide"),slideToggle:Jt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,r){k.fn[t]=function(t,e,n){return this.animate(r,t,e,n)}}),k.timers=[],k.fx.tick=function(){var t,e=0,n=k.timers;for($t=k.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||k.fx.stop(),$t=void 0},k.fx.timer=function(t){k.timers.push(t),t()?k.fx.start():k.timers.pop()},k.fx.interval=13,k.fx.start=function(){Xt=Xt||x.setInterval(k.fx.tick,k.fx.interval)},k.fx.stop=function(){x.clearInterval(Xt),Xt=null},k.fx.speeds={slow:600,fast:200,_default:400},k.fn.delay=function(r,t){return r=k.fx&&k.fx.speeds[r]||r,t=t||"fx",this.queue(t,function(t,e){var n=x.setTimeout(t,r);e.stop=function(){x.clearTimeout(n)}})},p=C.createElement("input"),n=C.createElement("select"),s=n.appendChild(C.createElement("option")),p.type="checkbox",m.checkOn=""!==p.value,m.optSelected=s.selected,n.disabled=!0,m.optDisabled=!s.disabled,(p=C.createElement("input")).value="t",p.type="radio",m.radioValue="t"===p.value;var ee,ne=k.expr.attrHandle;k.fn.extend({attr:function(t,e){return R(this,k.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each(function(){k.removeAttr(this,t)})}}),k.extend({attr:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?k.prop(t,e,n):(1===o&&k.isXMLDoc(t)||(e=e.toLowerCase(),i=k.attrHooks[e]||(k.expr.match.bool.test(e)?ee:void 0)),void 0!==n?null===n?void k.removeAttr(t,e):i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:(t.setAttribute(e,n+""),n):i&&"get"in i&&null!==(r=i.get(t,e))?r:null==(r=k.find.attr(t,e))?void 0:r)},attrHooks:{type:{set:function(t,e){if(!m.radioValue&&"radio"===e&&k.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,r,i=0,o=e&&e.match(P);if(o&&1===t.nodeType)for(;n=o[i++];)r=k.propFix[n]||n,k.expr.match.bool.test(n)&&(t[r]=!1),t.removeAttribute(n)}}),ee={set:function(t,e,n){return!1===e?k.removeAttr(t,n):t.setAttribute(n,n),n}},k.each(k.expr.match.bool.source.match(/\w+/g),function(t,e){var o=ne[e]||k.find.attr;ne[e]=function(t,e,n){var r,i;return n||(i=ne[e],ne[e]=r,r=null!=o(t,e,n)?e.toLowerCase():null,ne[e]=i),r}});var re=/^(?:input|select|textarea|button)$/i,ie=/^(?:a|area)$/i;k.fn.extend({prop:function(t,e){return R(this,k.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each(function(){delete this[k.propFix[t]||t]})}}),k.extend({prop:function(t,e,n){var r,i,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&k.isXMLDoc(t)||(e=k.propFix[e]||e,i=k.propHooks[e]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:t[e]=n:i&&"get"in i&&null!==(r=i.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){var e=k.find.attr(t,"tabindex");return e?parseInt(e,10):re.test(t.nodeName)||ie.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(k.propHooks.selected={get:function(t){t=t.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(t){t=t.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),k.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){k.propFix[this.toLowerCase()]=this});var oe=/[\t\r\n\f]/g;function se(t){return t.getAttribute&&t.getAttribute("class")||""}k.fn.extend({addClass:function(e){var t,n,r,i,o,s,a=0;if(k.isFunction(e))return this.each(function(t){k(this).addClass(e.call(this,t,se(this)))});if("string"==typeof e&&e)for(t=e.match(P)||[];n=this[a++];)if(s=se(n),r=1===n.nodeType&&(" "+s+" ").replace(oe," ")){for(o=0;i=t[o++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");s!==(s=k.trim(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,i,o,s,a=0;if(k.isFunction(e))return this.each(function(t){k(this).removeClass(e.call(this,t,se(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof e&&e)for(t=e.match(P)||[];n=this[a++];)if(s=se(n),r=1===n.nodeType&&(" "+s+" ").replace(oe," ")){for(o=0;i=t[o++];)for(;-1<r.indexOf(" "+i+" ");)r=r.replace(" "+i+" "," ");s!==(s=k.trim(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,e){var o=typeof i;return"boolean"==typeof e&&"string"==o?e?this.addClass(i):this.removeClass(i):k.isFunction(i)?this.each(function(t){k(this).toggleClass(i.call(this,t,se(this),e),e)}):this.each(function(){var t,e,n,r;if("string"==o)for(e=0,n=k(this),r=i.match(P)||[];t=r[e++];)n.hasClass(t)?n.removeClass(t):n.addClass(t);else void 0!==i&&"boolean"!=o||((t=se(this))&&W.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",!t&&!1!==i&&W.get(this,"__className__")||""))})},hasClass:function(t){for(var e,n=0,r=" "+t+" ";e=this[n++];)if(1===e.nodeType&&-1<(" "+se(e)+" ").replace(oe," ").indexOf(r))return!0;return!1}});var ae=/\r/g,ue=/[\x20\t\r\n\f]+/g;k.fn.extend({val:function(e){var n,t,r,i=this[0];return arguments.length?(r=k.isFunction(e),this.each(function(t){1===this.nodeType&&(null==(t=r?e.call(this,t,k(this).val()):e)?t="":"number"==typeof t?t+="":k.isArray(t)&&(t=k.map(t,function(t){return null==t?"":t+""})),(n=k.valHooks[this.type]||k.valHooks[this.nodeName.toLowerCase()])&&"set"in n&&void 0!==n.set(this,t,"value")||(this.value=t))})):i?(n=k.valHooks[i.type]||k.valHooks[i.nodeName.toLowerCase()])&&"get"in n&&void 0!==(t=n.get(i,"value"))?t:"string"==typeof(t=i.value)?t.replace(ae,""):null==t?"":t:void 0}}),k.extend({valHooks:{option:{get:function(t){var e=k.find.attr(t,"value");return null!=e?e:k.trim(k.text(t)).replace(ue," ")}},select:{get:function(t){for(var e,n=t.options,r=t.selectedIndex,i="select-one"===t.type||r<0,o=i?null:[],s=i?r+1:n.length,a=r<0?s:i?r:0;a<s;a++)if(((e=n[a]).selected||a===r)&&(m.optDisabled?!e.disabled:null===e.getAttribute("disabled"))&&(!e.parentNode.disabled||!k.nodeName(e.parentNode,"optgroup"))){if(e=k(e).val(),i)return e;o.push(e)}return o},set:function(t,e){for(var n,r,i=t.options,o=k.makeArray(e),s=i.length;s--;)((r=i[s]).selected=-1<k.inArray(k.valHooks.option.get(r),o))&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),k.each(["radio","checkbox"],function(){k.valHooks[this]={set:function(t,e){return k.isArray(e)?t.checked=-1<k.inArray(k(t).val(),e):void 0}},m.checkOn||(k.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var ce=/^(?:focusinfocus|focusoutblur)$/;k.extend(k.event,{trigger:function(t,e,n,r){var i,o,s,a,u,c,l=[n||C],h=d.call(t,"type")?t.type:t,f=d.call(t,"namespace")?t.namespace.split("."):[],p=o=n=n||C;if(3!==n.nodeType&&8!==n.nodeType&&!ce.test(h+k.event.triggered)&&(-1<h.indexOf(".")&&(h=(f=h.split(".")).shift(),f.sort()),a=h.indexOf(":")<0&&"on"+h,(t=t[k.expando]?t:new k.Event(h,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=f.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:k.makeArray(e,[t]),c=k.event.special[h]||{},r||!c.trigger||!1!==c.trigger.apply(n,e))){if(!r&&!c.noBubble&&!k.isWindow(n)){for(s=c.delegateType||h,ce.test(s+h)||(p=p.parentNode);p;p=p.parentNode)l.push(p),o=p;o===(n.ownerDocument||C)&&l.push(o.defaultView||o.parentWindow||x)}for(i=0;(p=l[i++])&&!t.isPropagationStopped();)t.type=1<i?s:c.bindType||h,(u=(W.get(p,"events")||{})[t.type]&&W.get(p,"handle"))&&u.apply(p,e),(u=a&&p[a])&&u.apply&&N(p)&&(t.result=u.apply(p,e),!1===t.result&&t.preventDefault());return t.type=h,r||t.isDefaultPrevented()||c._default&&!1!==c._default.apply(l.pop(),e)||!N(n)||a&&k.isFunction(n[h])&&!k.isWindow(n)&&((o=n[a])&&(n[a]=null),n[k.event.triggered=h](),k.event.triggered=void 0,o&&(n[a]=o)),t.result}},simulate:function(t,e,n){t=k.extend(new k.Event,n,{type:t,isSimulated:!0});k.event.trigger(t,null,e)}}),k.fn.extend({trigger:function(t,e){return this.each(function(){k.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];return n?k.event.trigger(t,e,n,!0):void 0}}),k.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,n){k.fn[n]=function(t,e){return 0<arguments.length?this.on(n,null,t,e):this.trigger(n)}}),k.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),m.focusin="onfocusin"in x,m.focusin||k.each({focus:"focusin",blur:"focusout"},function(n,r){function i(t){k.event.simulate(r,t.target,k.event.fix(t))}k.event.special[r]={setup:function(){var t=this.ownerDocument||this,e=W.access(t,r);e||t.addEventListener(n,i,!0),W.access(t,r,(e||0)+1)},teardown:function(){var t=this.ownerDocument||this,e=W.access(t,r)-1;e?W.access(t,r,e):(t.removeEventListener(n,i,!0),W.remove(t,r))}}});var le=x.location,he=k.now(),fe=/\?/;k.parseJSON=function(t){return JSON.parse(t+"")},k.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new x.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||k.error("Invalid XML: "+t),e};var pe=/#.*$/,de=/([?&])_=[^&]*/,ge=/^(.*?):[ \t]*([^\r\n]*)$/gm,me=/^(?:GET|HEAD)$/,ve=/^\/\//,ye={},be={},we="*/".concat("*"),_e=C.createElement("a");function xe(o){return function(t,e){"string"!=typeof t&&(e=t,t="*");var n,r=0,i=t.toLowerCase().match(P)||[];if(k.isFunction(e))for(;n=i[r++];)"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(e)):(o[n]=o[n]||[]).push(e)}}function Ce(e,r,i,o){var s={},a=e===be;function u(t){var n;return s[t]=!0,k.each(e[t]||[],function(t,e){e=e(r,i,o);return"string"!=typeof e||a||s[e]?a?!(n=e):void 0:(r.dataTypes.unshift(e),u(e),!1)}),n}return u(r.dataTypes[0])||!s["*"]&&u("*")}function ke(t,e){var n,r,i=k.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((i[n]?t:r=r||{})[n]=e[n]);return r&&k.extend(!0,t,r),t}_e.href=le.href,k.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:le.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(le.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":we,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":k.parseJSON,"text xml":k.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?ke(ke(t,k.ajaxSettings),e):ke(k.ajaxSettings,t)},ajaxPrefilter:xe(ye),ajaxTransport:xe(be),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var u,c,l,n,h,r,f,i,p=k.ajaxSetup({},e),d=p.context||p,g=p.context&&(d.nodeType||d.jquery)?k(d):k.event,m=k.Deferred(),v=k.Callbacks("once memory"),y=p.statusCode||{},o={},s={},b=0,a="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===b){if(!n)for(n={};e=ge.exec(l);)n[e[1].toLowerCase()]=e[2];e=n[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===b?l:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return b||(t=s[n]=s[n]||t,o[t]=e),this},overrideMimeType:function(t){return b||(p.mimeType=t),this},statusCode:function(t){if(t)if(b<2)for(var e in t)y[e]=[y[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){t=t||a;return u&&u.abort(t),_(0,t),this}};if(m.promise(w).complete=v.add,w.success=w.done,w.error=w.fail,p.url=((t||p.url||le.href)+"").replace(pe,"").replace(ve,le.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=k.trim(p.dataType||"*").toLowerCase().match(P)||[""],null==p.crossDomain){r=C.createElement("a");try{r.href=p.url,r.href=r.href,p.crossDomain=_e.protocol+"//"+_e.host!=r.protocol+"//"+r.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=k.param(p.data,p.traditional)),Ce(ye,p,e,w),2===b)return w;for(i in(f=k.event&&p.global)&&0==k.active++&&k.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!me.test(p.type),c=p.url,p.hasContent||(p.data&&(c=p.url+=(fe.test(c)?"&":"?")+p.data,delete p.data),!1===p.cache&&(p.url=de.test(c)?c.replace(de,"$1_="+he++):c+(fe.test(c)?"&":"?")+"_="+he++)),p.ifModified&&(k.lastModified[c]&&w.setRequestHeader("If-Modified-Since",k.lastModified[c]),k.etag[c]&&w.setRequestHeader("If-None-Match",k.etag[c])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&w.setRequestHeader("Content-Type",p.contentType),w.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+we+"; q=0.01":""):p.accepts["*"]),p.headers)w.setRequestHeader(i,p.headers[i]);if(p.beforeSend&&(!1===p.beforeSend.call(d,w,p)||2===b))return w.abort();for(i in a="abort",{success:1,error:1,complete:1})w[i](p[i]);if(u=Ce(be,p,e,w)){if(w.readyState=1,f&&g.trigger("ajaxSend",[w,p]),2===b)return w;p.async&&0<p.timeout&&(h=x.setTimeout(function(){w.abort("timeout")},p.timeout));try{b=1,u.send(o,_)}catch(t){if(!(b<2))throw t;_(-1,t)}}else _(-1,"No Transport");function _(t,e,n,r){var i,o,s,a=e;2!==b&&(b=2,h&&x.clearTimeout(h),u=void 0,l=r||"",w.readyState=0<t?4:0,r=200<=t&&t<300||304===t,n&&(s=function(t,e,n){for(var r,i,o,s,a=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||t.converters[i+" "+u[0]]){o=i;break}s=s||i}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):void 0}(p,w,n)),s=function(t,e,n,r){var i,o,s,a,u,c={},l=t.dataTypes.slice();if(l[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(o=l.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!u&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=l.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(s=c[u+" "+o]||c["* "+o]))for(i in c)if(a=i.split(" "),a[1]===o&&(s=c[u+" "+a[0]]||c["* "+a[0]])){!0===s?s=c[i]:!0!==c[i]&&(o=a[0],l.unshift(a[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}(p,s,w,r),r?(p.ifModified&&((n=w.getResponseHeader("Last-Modified"))&&(k.lastModified[c]=n),(n=w.getResponseHeader("etag"))&&(k.etag[c]=n)),204===t||"HEAD"===p.type?a="nocontent":304===t?a="notmodified":(a=s.state,i=s.data,r=!(o=s.error))):(o=a,!t&&a||(a="error",t<0&&(t=0))),w.status=t,w.statusText=(e||a)+"",r?m.resolveWith(d,[i,a,w]):m.rejectWith(d,[w,a,o]),w.statusCode(y),y=void 0,f&&g.trigger(r?"ajaxSuccess":"ajaxError",[w,p,r?i:o]),v.fireWith(d,[w,a]),f&&(g.trigger("ajaxComplete",[w,p]),--k.active||k.event.trigger("ajaxStop")))}return w},getJSON:function(t,e,n){return k.get(t,e,n,"json")},getScript:function(t,e){return k.get(t,void 0,e,"script")}}),k.each(["get","post"],function(t,i){k[i]=function(t,e,n,r){return k.isFunction(e)&&(r=r||n,n=e,e=void 0),k.ajax(k.extend({url:t,type:i,dataType:r,data:e,success:n},k.isPlainObject(t)&&t))}}),k._evalUrl=function(t){return k.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},k.fn.extend({wrapAll:function(e){var t;return k.isFunction(e)?this.each(function(t){k(this).wrapAll(e.call(this,t))}):(this[0]&&(t=k(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(n){return k.isFunction(n)?this.each(function(t){k(this).wrapInner(n.call(this,t))}):this.each(function(){var t=k(this),e=t.contents();e.length?e.wrapAll(n):t.append(n)})},wrap:function(e){var n=k.isFunction(e);return this.each(function(t){k(this).wrapAll(n?e.call(this,t):e)})},unwrap:function(){return this.parent().each(function(){k.nodeName(this,"body")||k(this).replaceWith(this.childNodes)}).end()}}),k.expr.filters.hidden=function(t){return!k.expr.filters.visible(t)},k.expr.filters.visible=function(t){return 0<t.offsetWidth||0<t.offsetHeight||0<t.getClientRects().length};var Se=/%20/g,Oe=/\[\]$/,Ee=/\r?\n/g,Te=/^(?:submit|button|image|reset|file)$/i,Ae=/^(?:input|select|textarea|keygen)/i;k.param=function(t,e){function n(t,e){e=k.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)}var r,i=[];if(void 0===e&&(e=k.ajaxSettings&&k.ajaxSettings.traditional),k.isArray(t)||t.jquery&&!k.isPlainObject(t))k.each(t,function(){n(this.name,this.value)});else for(r in t)!function n(r,t,i,o){if(k.isArray(t))k.each(t,function(t,e){i||Oe.test(r)?o(r,e):n(r+"["+("object"==typeof e&&null!=e?t:"")+"]",e,i,o)});else if(i||"object"!==k.type(t))o(r,t);else for(var e in t)n(r+"["+e+"]",t[e],i,o)}(r,t[r],e,n);return i.join("&").replace(Se,"+")},k.fn.extend({serialize:function(){return k.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=k.prop(this,"elements");return t?k.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!k(this).is(":disabled")&&Ae.test(this.nodeName)&&!Te.test(t)&&(this.checked||!V.test(t))}).map(function(t,e){var n=k(this).val();return null==n?null:k.isArray(n)?k.map(n,function(t){return{name:e.name,value:t.replace(Ee,"\r\n")}}):{name:e.name,value:n.replace(Ee,"\r\n")}}).get()}}),k.ajaxSettings.xhr=function(){try{return new x.XMLHttpRequest}catch(t){}};var Ie={0:200,1223:204},je=k.ajaxSettings.xhr();m.cors=!!je&&"withCredentials"in je,m.ajax=je=!!je,k.ajaxTransport(function(i){var o,s;return m.cors||je&&!i.crossDomain?{send:function(t,e){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||t["X-Requested-With"]||(t["X-Requested-With"]="XMLHttpRequest"),t)r.setRequestHeader(n,t[n]);o=function(t){return function(){o&&(o=s=r.onload=r.onerror=r.onabort=r.onreadystatechange=null,"abort"===t?r.abort():"error"===t?"number"!=typeof r.status?e(0,"error"):e(r.status,r.statusText):e(Ie[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),s=r.onerror=o("error"),void 0!==r.onabort?r.onabort=s:r.onreadystatechange=function(){4===r.readyState&&x.setTimeout(function(){o&&s()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(t){if(o)throw t}},abort:function(){o&&o()}}:void 0}),k.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return k.globalEval(t),t}}}),k.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),k.ajaxTransport("script",function(n){var r,i;if(n.crossDomain)return{send:function(t,e){r=k("<script>").prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(t){r.remove(),i=null,t&&e("error"===t.type?404:200,t.type)}),C.head.appendChild(r[0])},abort:function(){i&&i()}}});var Pe=[],De=/(=)\?(?=&|$)|\?\?/;k.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Pe.pop()||k.expando+"_"+he++;return this[t]=!0,t}}),k.ajaxPrefilter("json jsonp",function(t,e,n){var r,i,o,s=!1!==t.jsonp&&(De.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&De.test(t.data)&&"data");return s||"jsonp"===t.dataTypes[0]?(r=t.jsonpCallback=k.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(De,"$1"+r):!1!==t.jsonp&&(t.url+=(fe.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return o||k.error(r+" was not called"),o[0]},t.dataTypes[0]="json",i=x[r],x[r]=function(){o=arguments},n.always(function(){void 0===i?k(x).removeProp(r):x[r]=i,t[r]&&(t.jsonpCallback=e.jsonpCallback,Pe.push(r)),o&&k.isFunction(i)&&i(o[0]),o=i=void 0}),"script"):void 0}),k.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||C;var r=w.exec(t),n=!n&&[];return r?[e.createElement(r[1])]:(r=Z([t],e,n),n&&n.length&&k(n).remove(),k.merge([],r.childNodes))};var Ne=k.fn.load;function Re(t){return k.isWindow(t)?t:9===t.nodeType&&t.defaultView}k.fn.load=function(t,e,n){if("string"!=typeof t&&Ne)return Ne.apply(this,arguments);var r,i,o,s=this,a=t.indexOf(" ");return-1<a&&(r=k.trim(t.slice(a)),t=t.slice(0,a)),k.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(i="POST"),0<s.length&&k.ajax({url:t,type:i||"GET",dataType:"html",data:e}).done(function(t){o=arguments,s.html(r?k("<div>").append(k.parseHTML(t)).find(r):t)}).always(n&&function(t,e){s.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},k.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){k.fn[e]=function(t){return this.on(e,t)}}),k.expr.filters.animated=function(e){return k.grep(k.timers,function(t){return e===t.elem}).length},k.offset={setOffset:function(t,e,n){var r,i,o,s,a=k.css(t,"position"),u=k(t),c={};"static"===a&&(t.style.position="relative"),o=u.offset(),r=k.css(t,"top"),s=k.css(t,"left"),s=("absolute"===a||"fixed"===a)&&-1<(r+s).indexOf("auto")?(i=(a=u.position()).top,a.left):(i=parseFloat(r)||0,parseFloat(s)||0),k.isFunction(e)&&(e=e.call(t,n,k.extend({},o))),null!=e.top&&(c.top=e.top-o.top+i),null!=e.left&&(c.left=e.left-o.left+s),"using"in e?e.using.call(t,c):u.css(c)}},k.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){k.offset.setOffset(this,e,t)});var t,n=this[0],r={top:0,left:0},i=n&&n.ownerDocument;return i?(t=i.documentElement,k.contains(t,n)?(r=n.getBoundingClientRect(),i=Re(i),{top:r.top+i.pageYOffset-t.clientTop,left:r.left+i.pageXOffset-t.clientLeft}):r):void 0},position:function(){if(this[0]){var t,e,n=this[0],r={top:0,left:0};return"fixed"===k.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),k.nodeName(t[0],"html")||(r=t.offset()),r.top+=k.css(t[0],"borderTopWidth",!0),r.left+=k.css(t[0],"borderLeftWidth",!0)),{top:e.top-r.top-k.css(n,"marginTop",!0),left:e.left-r.left-k.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===k.css(t,"position");)t=t.offsetParent;return t||Pt})}}),k.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var o="pageYOffset"===i;k.fn[e]=function(t){return R(this,function(t,e,n){var r=Re(t);return void 0===n?r?r[i]:t[e]:void(r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):t[e]=n)},e,t,arguments.length)}}),k.each(["top","left"],function(t,n){k.cssHooks[n]=Rt(m.pixelPosition,function(t,e){return e?(e=Nt(t,n),It.test(e)?k(t).position()[n]+"px":e):void 0})}),k.each({Height:"height",Width:"width"},function(o,s){k.each({padding:"inner"+o,content:s,"":"outer"+o},function(r,t){k.fn[t]=function(t,e){var n=arguments.length&&(r||"boolean"!=typeof t),i=r||(!0===t||!0===e?"margin":"border");return R(this,function(t,e,n){var r;return k.isWindow(t)?t.document.documentElement["client"+o]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+o],r["scroll"+o],t.body["offset"+o],r["offset"+o],r["client"+o])):void 0===n?k.css(t,e,i):k.style(t,e,n,i)},s,n?t:void 0,n,null)}})}),k.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},size:function(){return this.length}}),k.fn.andSelf=k.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return k});var Me=x.jQuery,We=x.$;return k.noConflict=function(t){return x.$===k&&(x.$=We),t&&x.jQuery===k&&(x.jQuery=Me),k},t||(x.jQuery=x.$=k),k}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).uuid={})}(this,function(t){"use strict";var e,n=new Uint8Array(16);function l(){if(!e&&!(e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(n)}var r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function i(t){return"string"==typeof t&&r.test(t)}for(var h,f,o=[],s=0;s<256;++s)o.push((s+256).toString(16).substr(1));function p(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=(o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]).toLowerCase();if(!i(e))throw TypeError("Stringified UUID is invalid");return e}var d=0,g=0;function u(t){if(!i(t))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n}function a(t,s,a){function e(t,e,n,r){if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}(t)),"string"==typeof e&&(e=u(e)),16!==e.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var i=new Uint8Array(16+t.length);if(i.set(e),i.set(t,e.length),(i=a(i))[6]=15&i[6]|s,i[8]=63&i[8]|128,n){r=r||0;for(var o=0;o<16;++o)n[r+o]=i[o];return n}return p(i)}try{e.name=t}catch(t){}return e.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",e.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",e}function m(t){return 14+(t+64>>>9<<4)+1}function v(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function c(t,e,n,r,i,o){return v((o=v(v(e,t),v(r,o)))<<i|o>>>32-i,n)}function y(t,e,n,r,i,o,s){return c(e&n|~e&r,t,e,i,o,s)}function b(t,e,n,r,i,o,s){return c(e&r|n&~r,t,e,i,o,s)}function w(t,e,n,r,i,o,s){return c(e^n^r,t,e,i,o,s)}function _(t,e,n,r,i,o,s){return c(n^(e|~r),t,e,i,o,s)}var x=a("v3",48,function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var n=0;n<e.length;++n)t[n]=e.charCodeAt(n)}return function(t){for(var e=[],n=32*t.length,r="0123456789abcdef",i=0;i<n;i+=8){var o=t[i>>5]>>>i%32&255,o=parseInt(r.charAt(o>>>4&15)+r.charAt(15&o),16);e.push(o)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[m(e)-1]=e;for(var n=1732584193,r=-271733879,i=-1732584194,o=271733878,s=0;s<t.length;s+=16){var a=n,u=r,c=i,l=o,n=y(n,r,i,o,t[s],7,-680876936),o=y(o,n,r,i,t[s+1],12,-389564586),i=y(i,o,n,r,t[s+2],17,606105819),r=y(r,i,o,n,t[s+3],22,-1044525330);n=y(n,r,i,o,t[s+4],7,-176418897),o=y(o,n,r,i,t[s+5],12,1200080426),i=y(i,o,n,r,t[s+6],17,-1473231341),r=y(r,i,o,n,t[s+7],22,-45705983),n=y(n,r,i,o,t[s+8],7,1770035416),o=y(o,n,r,i,t[s+9],12,-1958414417),i=y(i,o,n,r,t[s+10],17,-42063),r=y(r,i,o,n,t[s+11],22,-1990404162),n=y(n,r,i,o,t[s+12],7,1804603682),o=y(o,n,r,i,t[s+13],12,-40341101),i=y(i,o,n,r,t[s+14],17,-1502002290),n=b(n,r=y(r,i,o,n,t[s+15],22,1236535329),i,o,t[s+1],5,-165796510),o=b(o,n,r,i,t[s+6],9,-1069501632),i=b(i,o,n,r,t[s+11],14,643717713),r=b(r,i,o,n,t[s],20,-373897302),n=b(n,r,i,o,t[s+5],5,-701558691),o=b(o,n,r,i,t[s+10],9,38016083),i=b(i,o,n,r,t[s+15],14,-660478335),r=b(r,i,o,n,t[s+4],20,-405537848),n=b(n,r,i,o,t[s+9],5,568446438),o=b(o,n,r,i,t[s+14],9,-1019803690),i=b(i,o,n,r,t[s+3],14,-187363961),r=b(r,i,o,n,t[s+8],20,1163531501),n=b(n,r,i,o,t[s+13],5,-1444681467),o=b(o,n,r,i,t[s+2],9,-51403784),i=b(i,o,n,r,t[s+7],14,1735328473),n=w(n,r=b(r,i,o,n,t[s+12],20,-1926607734),i,o,t[s+5],4,-378558),o=w(o,n,r,i,t[s+8],11,-2022574463),i=w(i,o,n,r,t[s+11],16,1839030562),r=w(r,i,o,n,t[s+14],23,-35309556),n=w(n,r,i,o,t[s+1],4,-1530992060),o=w(o,n,r,i,t[s+4],11,1272893353),i=w(i,o,n,r,t[s+7],16,-155497632),r=w(r,i,o,n,t[s+10],23,-1094730640),n=w(n,r,i,o,t[s+13],4,681279174),o=w(o,n,r,i,t[s],11,-358537222),i=w(i,o,n,r,t[s+3],16,-722521979),r=w(r,i,o,n,t[s+6],23,76029189),n=w(n,r,i,o,t[s+9],4,-640364487),o=w(o,n,r,i,t[s+12],11,-421815835),i=w(i,o,n,r,t[s+15],16,530742520),n=_(n,r=w(r,i,o,n,t[s+2],23,-995338651),i,o,t[s],6,-198630844),o=_(o,n,r,i,t[s+7],10,1126891415),i=_(i,o,n,r,t[s+14],15,-1416354905),r=_(r,i,o,n,t[s+5],21,-57434055),n=_(n,r,i,o,t[s+12],6,1700485571),o=_(o,n,r,i,t[s+3],10,-1894986606),i=_(i,o,n,r,t[s+10],15,-1051523),r=_(r,i,o,n,t[s+1],21,-2054922799),n=_(n,r,i,o,t[s+8],6,1873313359),o=_(o,n,r,i,t[s+15],10,-30611744),i=_(i,o,n,r,t[s+6],15,-1560198380),r=_(r,i,o,n,t[s+13],21,1309151649),n=_(n,r,i,o,t[s+4],6,-145523070),o=_(o,n,r,i,t[s+11],10,-1120210379),i=_(i,o,n,r,t[s+2],15,718787259),r=_(r,i,o,n,t[s+9],21,-343485551),n=v(n,a),r=v(r,u),i=v(i,c),o=v(o,l)}return[n,r,i,o]}(function(t){if(0===t.length)return[];for(var e=8*t.length,n=new Uint32Array(m(e)),r=0;r<e;r+=8)n[r>>5]|=(255&t[r/8])<<r%32;return n}(t),8*t.length))});function C(t,e){return t<<e|t>>>32-e}var k=a("v5",80,function(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var r=unescape(encodeURIComponent(t));t=[];for(var i=0;i<r.length;++i)t.push(r.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var o=t.length/4+2,s=Math.ceil(o/16),a=new Array(s),u=0;u<s;++u){for(var c=new Uint32Array(16),l=0;l<16;++l)c[l]=t[64*u+4*l]<<24|t[64*u+4*l+1]<<16|t[64*u+4*l+2]<<8|t[64*u+4*l+3];a[u]=c}a[s-1][14]=8*(t.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(t.length-1)&4294967295;for(var h=0;h<s;++h){for(var f=new Uint32Array(80),p=0;p<16;++p)f[p]=a[h][p];for(var d=16;d<80;++d)f[d]=C(f[d-3]^f[d-8]^f[d-14]^f[d-16],1);for(var g=n[0],m=n[1],v=n[2],y=n[3],b=n[4],w=0;w<80;++w)var _=Math.floor(w/20),_=C(g,5)+function(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:return e^n^r;case 2:return e&n^e&r^n&r;case 3:return e^n^r}}(_,m,v,y)+b+e[_]+f[w]>>>0,b=y,y=v,v=C(m,30)>>>0,m=g,g=_;n[0]=n[0]+g>>>0,n[1]=n[1]+m>>>0,n[2]=n[2]+v>>>0,n[3]=n[3]+y>>>0,n[4]=n[4]+b>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]});t.NIL="00000000-0000-0000-0000-000000000000",t.parse=u,t.stringify=p,t.v1=function(t,e,n){var r=e&&n||0,i=e||new Array(16),o=(t=t||{}).node||h,s=void 0!==t.clockseq?t.clockseq:f;null!=o&&null!=s||(u=t.random||(t.rng||l)(),null==o&&(o=h=[1|u[0],u[1],u[2],u[3],u[4],u[5]]),null==s&&(s=f=16383&(u[6]<<8|u[7])));var a=void 0!==t.msecs?t.msecs:Date.now(),n=void 0!==t.nsecs?t.nsecs:g+1,u=a-d+(n-g)/1e4;if(u<0&&void 0===t.clockseq&&(s=s+1&16383),(u<0||d<a)&&void 0===t.nsecs&&(n=0),1e4<=n)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=a,f=s;n=(1e4*(268435455&(a+=122192928e5))+(g=n))%4294967296;i[r++]=n>>>24&255,i[r++]=n>>>16&255,i[r++]=n>>>8&255,i[r++]=255&n;a=a/4294967296*1e4&268435455;i[r++]=a>>>8&255,i[r++]=255&a,i[r++]=a>>>24&15|16,i[r++]=a>>>16&255,i[r++]=s>>>8|128,i[r++]=255&s;for(var c=0;c<6;++c)i[r+c]=o[c];return e||p(i)},t.v3=x,t.v4=function(t,e,n){var r=(t=t||{}).random||(t.rng||l)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return p(r)},t.v5=k,t.validate=i,t.version=function(t){if(!i(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)},Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.clipboard=e():t.clipboard=e()}(this,function(){return i={},r.m=n=[function(t,e,n){"use strict";function o(t){var e=new v,t=function(n,t,r){f("listener called"),n.success=!0,t.forEach(function(t,e){r.clipboardData.setData(e,t),e===g&&r.clipboardData.getData(e)!=t&&(f("setting text/plain failed"),n.success=!1)}),r.preventDefault()}.bind(this,e,t);document.addEventListener("copy",t);try{document.execCommand("copy")}finally{document.removeEventListener("copy",t)}return e.success}function s(t,e){a(t);e=o(e);return u(),e}function a(t){var e=document.getSelection(),n=document.createRange();n.selectNodeContents(t),e.removeAllRanges(),e.addRange(n)}function u(){document.getSelection().removeAllRanges()}function c(){return"undefined"==typeof ClipboardEvent&&void 0!==window.clipboardData&&void 0!==window.clipboardData.setData}function r(){return new h(function(t,e){var n=window.clipboardData.getData("Text");""===n?e(new Error("Empty clipboard or could not read plain text from clipboard")):t(n)})}Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),l=n(5),h="undefined"==typeof Promise?i.Promise:Promise,f=function(t){},p=!0,d=function(){(console.warn||console.log).call(arguments)}.bind(console,"[clipboard-polyfill]"),g="text/plain",i=(m.setDebugLog=function(t){f=t},m.suppressWarnings=function(){p=!1,l.suppressDTWarnings()},m.write=function(i){return p&&!i.getData(g)&&d("clipboard.write() was called without a `text/plain` data type. On some platforms, this may result in an empty clipboard. Call clipboard.suppressWarnings() to suppress this warning."),new h(function(t,e){if(c())(function(t){if(void 0!==(t=t.getData(g)))return window.clipboardData.setData("Text",t);throw"No `text/plain` value was specified."})(i)?t():e(new Error("Copying failed, possibly because the user rejected it."));else{if(o(i))return f("regular execCopy worked"),void t();if(-1<navigator.userAgent.indexOf("Edge"))return f('UA "Edge" => assuming success'),void t();if(s(document.body,i))return f("copyUsingTempSelection worked"),void t();if(r=i,(n=document.createElement("div")).setAttribute("style","-webkit-user-select: text !important"),n.textContent="temporary element",document.body.appendChild(n),r=s(n,r),document.body.removeChild(n),r)return f("copyUsingTempElem worked"),void t();var n,r=i.getData(g);if(void 0!==r&&function(t){f("copyTextUsingDOM");var e=document.createElement("div");e.setAttribute("style","-webkit-user-select: text !important");var n=e;e.attachShadow&&(f("Using shadow DOM."),n=e.attachShadow({mode:"open"}));var r=document.createElement("span");return r.innerText=t,n.appendChild(r),document.body.appendChild(e),a(r),r=document.execCommand("copy"),u(),document.body.removeChild(e),r}(r))return f("copyTextUsingDOM worked"),void t();e(new Error("Copy command failed."))}})},m.writeText=function(t){if(navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(t);var e=new l.DT;return e.setData(g,t),this.write(e)},m.read=function(){return new h(function(n,t){c()?r().then(function(t){return n((e=t,(t=new l.DT).setData(g,e),t));var e},t):t("Read is not supported in your browser.")})},m.readText=function(){return navigator.clipboard&&navigator.clipboard.readText?navigator.clipboard.readText():c()?r():new h(function(t,e){e("Read is not supported in your browser.")})},m.DT=l.DT,m);function m(){}e.default=i;var v=function(){this.success=!1};t.exports=i},function(t,e,st){(function(it,ot){t.exports=function(){"use strict";function n(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function c(t){return"function"==typeof t}function t(t){q=t}function e(t){z=t}function r(){return void 0!==B?function(){B(o)}:i()}function i(){var t=setTimeout;return function(){return t(o,1)}}function o(){for(var t=0;t<H;t+=2)(0,Y[t])(Y[t+1]),Y[t]=void 0,Y[t+1]=void 0;H=0}function s(t,e){var n=arguments,r=this,i=new this.constructor(u);void 0===i[Q]&&T(i);var o=r._state;return o?function(){var t=n[o-1];z(function(){return S(o,i,t,r._result)})}():_(r,i,t,e),i}function a(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(u);return v(n,t),n}function u(){}function l(){return new TypeError("You cannot resolve a promise with itself")}function h(){return new TypeError("A promises callback cannot return that same promise.")}function f(t){try{return t.then}catch(t){return et.error=t,et}}function p(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function d(t,r,i){z(function(e){var n=!1,t=p(i,r,function(t){n||(n=!0,r!==t?v(e,t):b(e,t))},function(t){n||(n=!0,w(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&t&&(n=!0,w(e,t))},t)}function g(e,t){t._state===Z?b(e,t._result):t._state===tt?w(e,t._result):_(t,void 0,function(t){return v(e,t)},function(t){return w(e,t)})}function m(t,e,n){e.constructor===t.constructor&&n===s&&e.constructor.resolve===a?g(t,e):n===et?(w(t,et.error),et.error=null):void 0===n?b(t,e):c(n)?d(t,e,n):b(t,e)}function v(t,e){t===e?w(t,l()):n(e)?m(t,e,f(e)):b(t,e)}function y(t){t._onerror&&t._onerror(t._result),x(t)}function b(t,e){t._state===J&&(t._result=e,t._state=Z,0!==t._subscribers.length&&z(x,t))}function w(t,e){t._state===J&&(t._state=tt,t._result=e,z(y,t))}function _(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+Z]=n,i[o+tt]=r,0===o&&t._state&&z(x,t)}function x(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,i=void 0,o=t._result,s=0;s<e.length;s+=3)r=e[s],i=e[s+n],r?S(n,r,i,o):i(o);t._subscribers.length=0}}function C(){this.error=null}function k(t,e){try{return t(e)}catch(t){return nt.error=t,nt}}function S(t,e,n,r){var i=c(n),o=void 0,s=void 0,a=void 0,u=void 0;if(i){if(o=k(n,r),o===nt?(u=!0,s=o.error,o.error=null):a=!0,e===o)return void w(e,h())}else o=r,a=!0;e._state!==J||(i&&a?v(e,o):u?w(e,s):t===Z?b(e,o):t===tt&&w(e,o))}function O(e,t){try{t(function(t){v(e,t)},function(t){w(e,t)})}catch(t){w(e,t)}}function E(){return rt++}function T(t){t[Q]=rt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function A(t,e){this._instanceConstructor=t,this.promise=new t(u),this.promise[Q]||T(this.promise),F(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?b(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&b(this.promise,this._result))):w(this.promise,I())}function I(){return new Error("Array Methods must be provided an Array")}function j(t){return new A(this,t).promise}function P(i){var o=this;return new o(F(i)?function(t,e){for(var n=i.length,r=0;r<n;r++)o.resolve(i[r]).then(t,e)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function D(t){var e=this,n=new e(u);return w(n,t),n}function N(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function R(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function M(t){this[Q]=E(),this._result=this._state=void 0,this._subscribers=[],u!==t&&("function"!=typeof t&&N(),this instanceof M?O(this,t):R())}function W(){var t=void 0;if(void 0!==ot)t=ot;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=M}var L=void 0,F=L=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},H=0,B=void 0,q=void 0,z=function(t,e){Y[H]=t,Y[H+1]=e,2===(H+=2)&&(q?q(o):K())},U="undefined"!=typeof window?window:void 0,G=U||{},V=G.MutationObserver||G.WebKitMutationObserver,$="undefined"==typeof self&&void 0!==it&&"[object process]"==={}.toString.call(it),X="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Y=new Array(1e3),K=void 0;K=$?function(){return function(){return it.nextTick(o)}}():V?function(){var t=0,e=new V(o),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}():X?function(){var t=new MessageChannel;return t.port1.onmessage=o,function(){return t.port2.postMessage(0)}}():void 0===U?function(){try{var t=st(4);return B=t.runOnLoop||t.runOnContext,r()}catch(t){return i()}}():i();var Q=Math.random().toString(36).substring(16),J=void 0,Z=1,tt=2,et=new C,nt=new C,rt=0;return A.prototype._enumerate=function(t){for(var e=0;this._state===J&&e<t.length;e++)this._eachEntry(t[e],e)},A.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===a){var i=f(e);if(i===s&&e._state!==J)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===M){var o=new n(u);m(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},A.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===J&&(this._remaining--,t===tt?w(r,n):this._result[e]=n),0===this._remaining&&b(r,this._result)},A.prototype._willSettleAt=function(t,e){var n=this;_(t,void 0,function(t){return n._settledAt(Z,e,t)},function(t){return n._settledAt(tt,e,t)})},M.all=j,M.race=P,M.resolve=a,M.reject=D,M._setScheduler=t,M._setAsap=e,M._asap=z,M.prototype={constructor:M,then:s,catch:function(t){return this.then(null,t)}},M.polyfill=W,M.Promise=M}()}).call(e,st(2),st(3))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function o(){p&&h&&(p=!1,h.length?f=h.concat(f):d=-1,f.length&&s())}function s(){if(!p){var t=i(o);p=!0;for(var e=f.length;e;){for(h=f,f=[];++d<e;)h&&h[d].run();d=-1,e=f.length}h=null,p=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(t)}}function a(t,e){this.fun=t,this.array=e}function u(){}var c,l,t=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var h,f=[],p=!1,d=-1;t.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new a(t,e)),1!==f.length||p||i(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=u,t.addListener=u,t.once=u,t.off=u,t.removeListener=u,t.removeAllListeners=u,t.emit=u,t.prependListener=u,t.prependOnceListener=u,t.listeners=function(t){return[]},t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},function(t,e){var n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=["text/plain","text/html"],i=function(){(console.warn||console.log).call(arguments)}.bind(console,"[clipboard-polyfill]"),o=!0;e.suppressDTWarnings=function(){o=!1};var s=(a.prototype.setData=function(t,e){o&&-1===r.indexOf(t)&&i("Unknown data type: "+t,"Call clipboard.suppressWarnings() to suppress this warning."),this.m[t]=e},a.prototype.getData=function(t){return this.m[t]},a.prototype.forEach=function(t){for(var e in this.m)t(this.m[e],e)},a);function a(){this.m={}}e.DT=s}],r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0);function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var n,i}),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jquery")):t(jQuery)}(function(It,jt){"use strict";var t,Pt={beforeShow:n,move:n,change:n,show:n,hide:n,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},Dt=[],Nt=!!/msie/i.exec(window.navigator.userAgent),Rt=((t=document.createElement("div").style).cssText="background-color:rgba(0,0,0,.5)",e(t.backgroundColor,"rgba")||e(t.backgroundColor,"hsla")),Mt=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),Wt=function(){var t="";if(Nt)for(var e=1;e<=6;e++)t+="<div class='sp-"+e+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",t,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input formulaInputFocus' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function e(t,e){return!!~(""+t).indexOf(e)}function Lt(t,e,n,r){for(var i=[],o=0;o<t.length;o++){var s,a,u,c=t[o];c?(a=(s=tinycolor(c)).toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",a+=tinycolor.equals(e,c)?" sp-thumb-active":"",u=s.toString(r.preferredFormat||"rgb"),c=Rt?"background-color:"+s.toRgbString():"filter:"+s.toFilter(),i.push('<span title="'+u+'" data-color="'+s.toRgbString()+'" class="'+a+'"><span class="sp-thumb-inner" style="'+c+';" /></span>')):i.push(It("<div />").append(It('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",r.noColorSelectedText)).html())}return"<div class='sp-cf "+n+"'>"+i.join("")+"</div>"}function o(t,e){var n,r,i,a=(i=t,(e=It.extend({},Pt,e)).callbacks={move:Ht(e.move,i),change:Ht(e.change,i),show:Ht(e.show,i),hide:Ht(e.hide,i),beforeShow:Ht(e.beforeShow,i)},e),u=a.flat,o=a.showSelectionPalette,s=a.localStorageKey,e=a.theme,c=a.callbacks,l=(n=Et,function(){var t=this,e=arguments;r=r||setTimeout(function(){r=null,n.apply(t,e)},10)}),h=!10,f=!1,p=0,d=0,g=0,m=0,v=0,y=0,b=0,w=0,_=0,x=0,C=1,k=[],S=[],O={},E=a.selectionPalette.slice(0),T=a.maxSelectionSize,A="sp-dragging",I=null,j=t.ownerDocument,P=(j.body,It(t)),D=!1,N=It(Wt,j).addClass(e),R=N.find(".sp-picker-container"),M=N.find(".sp-color"),W=N.find(".sp-dragger"),L=N.find(".sp-hue"),F=N.find(".sp-slider"),H=N.find(".sp-alpha-inner"),B=N.find(".sp-alpha"),q=N.find(".sp-alpha-handle"),z=N.find(".sp-input"),U=N.find(".sp-palette"),G=N.find(".sp-initial"),V=N.find(".sp-cancel"),$=N.find(".sp-clear"),X=N.find(".sp-choose"),Y=N.find(".sp-palette-toggle"),K=P.is("input"),t=K&&"color"===P.attr("type")&&qt(),Q=K&&!u,J=Q?It(Mt).addClass(e).addClass(a.className).addClass(a.replacerClassName):It([]),Z=Q?J:P,tt=J.find(".sp-preview-inner"),et=a.color||K&&P.val(),nt=!1,rt=a.preferredFormat,it=!a.showButtons||a.clickoutFiresChange,ot=!et,st=a.allowEmpty&&!t;function at(){if(a.showPaletteOnly&&(a.showPalette=!0),Y.text(a.showPaletteOnly?a.togglePaletteMoreText:a.togglePaletteLessText),a.palette){k=a.palette.slice(0),S=It.isArray(k[0])?k:[k],O={};for(var t=0;t<S.length;t++)for(var e=0;e<S[t].length;e++){var n=tinycolor(S[t][e]).toRgbString();O[n]=!0}}N.toggleClass("sp-flat",u),N.toggleClass("sp-input-disabled",!a.showInput),N.toggleClass("sp-alpha-enabled",a.showAlpha),N.toggleClass("sp-clear-enabled",st),N.toggleClass("sp-buttons-disabled",!a.showButtons),N.toggleClass("sp-palette-buttons-disabled",!a.togglePaletteOnly),N.toggleClass("sp-palette-disabled",!a.showPalette),N.toggleClass("sp-palette-only",a.showPaletteOnly),N.toggleClass("sp-initial-disabled",!a.showInitial),N.addClass(a.className).addClass(a.containerClassName),Et()}function ut(){if(s&&window.localStorage){try{var t=window.localStorage[s].split(",#");1<t.length&&(delete window.localStorage[s],It.each(t,function(t,e){ct(e)}))}catch(t){}try{E=window.localStorage[s].split(";")}catch(t){}}}function ct(t){if(o){var e=tinycolor(t).toRgbString();if(!O[e]&&-1===It.inArray(e,E))for(E.push(e);E.length>T;)E.shift();if(s&&window.localStorage)try{window.localStorage[s]=E.join(";")}catch(t){}}}function lt(){var n=xt(),t=It.map(S,function(t,e){return Lt(t,n,"sp-palette-row sp-palette-row-"+e,a)});ut(),E&&t.push(Lt(function(){var t=[];if(a.showPalette)for(var e=0;e<E.length;e++){var n=tinycolor(E[e]).toRgbString();O[n]||t.push(E[e])}return t.reverse().slice(0,a.maxSelectionSize)}(),n,"sp-palette-row sp-palette-row-selection",a)),U.html(t.join(""))}function ht(){var t,e;a.showInitial&&(t=nt,e=xt(),G.html(Lt([t,e],e,"sp-palette-row-initial",a)))}function ft(){(d<=0||p<=0||m<=0)&&Et(),f=!0,N.addClass(A),I=null,P.trigger("dragstart.spectrum",[xt()])}function pt(){f=!1,N.removeClass(A),P.trigger("dragstop.spectrum",[xt()])}function dt(){var t=z.val();null!==t&&""!==t||!st?(t=tinycolor(t)).isValid()?(_t(t),Ot(!0)):z.addClass("sp-validation-error"):(_t(null),Ot(!0))}function gt(){(h?bt:mt)()}function mt(){var t=It.Event("beforeShow.spectrum");h?Et():(P.trigger(t,[xt()]),!1===c.beforeShow(xt())||t.isDefaultPrevented()||(function(){for(var t=0;t<Dt.length;t++)Dt[t]&&Dt[t].hide()}(),h=!0,It(j).bind("keydown.spectrum",vt),It(j).bind("click.spectrum",yt),It(window).bind("resize.spectrum",l),J.addClass("sp-active"),N.removeClass("sp-hidden"),Et(),kt(),nt=xt(),ht(),c.show(nt),P.trigger("show.spectrum",[nt])))}function vt(t){27===t.keyCode&&bt()}function yt(t){2!=t.button&&(f||(it?Ot(!0):wt(),bt()))}function bt(){h&&!u&&(h=!1,It(j).unbind("keydown.spectrum",vt),It(j).unbind("click.spectrum",yt),It(window).unbind("resize.spectrum",l),J.removeClass("sp-active"),N.addClass("sp-hidden"),c.hide(xt()),P.trigger("hide.spectrum",[xt()]))}function wt(){_t(nt,!0)}function _t(t,e){var n;tinycolor.equals(t,xt())?kt():(!t&&st?ot=!0:(ot=!1,t=(n=tinycolor(t)).toHsv(),w=t.h%360/360,_=t.s,x=t.v,C=t.a),kt(),n&&n.isValid()&&!e&&(rt=a.preferredFormat||n.getFormat()))}function xt(t){return t=t||{},st&&ot?null:tinycolor.fromRatio({h:w,s:_,v:x,a:Math.round(100*C)/100},{format:t.format||rt})}function Ct(){kt(),c.move(xt()),P.trigger("move.spectrum",[xt()])}function kt(){z.removeClass("sp-validation-error"),St();var t=tinycolor.fromRatio({h:w,s:1,v:1});M.css("background-color",t.toHexString());var e=rt;C<1&&(0!==C||"name"!==e)&&("hex"!==e&&"hex3"!==e&&"hex6"!==e&&"name"!==e||(e="rgb"));var n,r,i=xt({format:e}),o="";tt.removeClass("sp-clear-display"),tt.css("background-color","transparent"),!i&&st?tt.addClass("sp-clear-display"):(n=i.toHexString(),r=i.toRgbString(),Rt||1===i.alpha?tt.css("background-color",r):(tt.css("background-color","transparent"),tt.css("filter",i.toFilter())),a.showAlpha&&((t=i.toRgb()).a=0,t="linear-gradient(left, "+(r=tinycolor(t).toRgbString())+", "+n+")",Nt?H.css("filter",tinycolor(r).toFilter({gradientType:1},n)):(H.css("background","-webkit-"+t),H.css("background","-moz-"+t),H.css("background","-ms-"+t),H.css("background","linear-gradient(to right, "+r+", "+n+")"))),o=i.toString(e)),a.showInput&&z.val(o),a.showPalette&&lt(),ht()}function St(){var t=_,e=x;st&&ot?(q.hide(),F.hide(),W.hide()):(q.show(),F.show(),W.show(),t=t*p,e=d-e*d,t=Math.max(-g,Math.min(p-g,t-g)),e=Math.max(-g,Math.min(d-g,e-g)),W.css({top:e+"px",left:t+"px"}),t=C*v,q.css({left:t-y/2+"px"}),t=w*m,F.css({top:t-b+"px"}))}function Ot(t){var e=xt(),n="";e&&(n=e.toString(rt),ct(e)),K&&P.val(n),t&&(c.change(e),P.trigger("change",[e]))}function Et(){var t,e,n,r,i,o,s;h&&(p=M.width(),d=M.height(),g=W.height(),L.width(),m=L.height(),b=F.height(),v=B.width(),y=q.width(),u||(N.css("position","absolute"),a.offset?N.offset(a.offset):N.offset((s=Z,t=(i=N).outerWidth(),e=i.outerHeight(),n=s.outerHeight(),i=(r=(o=i[0].ownerDocument).documentElement).clientWidth+It(o).scrollLeft(),o=r.clientHeight+It(o).scrollTop(),(s=s.offset()).top+=n,s.left-=Math.min(s.left,s.left+t>i&&t<i?Math.abs(s.left+t-i):0),s.top-=Math.min(s.top,s.top+e>o&&e<o?Math.abs(+(e+n)):0),s))),St(),a.showPalette&&lt(),P.trigger("reflow.spectrum"))}function Tt(){bt(),D=!0,P.attr("disabled",!0),Z.addClass("sp-disabled")}!function(){function t(t){return t.data&&t.data.ignore?(_t(It(t.target).closest(".sp-thumb-el").data("color")),Ct()):(_t(It(t.target).closest(".sp-thumb-el").data("color")),Ct(),Ot(!0),a.hideAfterPaletteSelect&&bt()),!1}Nt&&N.find("*:not(input)").attr("unselectable","on"),at(),Q&&P.after(J).hide(),st||$.hide(),u?P.after(N).hide():(1!==(e="parent"===a.appendTo?P.parent():It(a.appendTo)).length&&(e=It("body")),e.append(N)),ut(),Z.bind("click.spectrum touchstart.spectrum",function(t){D||gt(),t.stopPropagation(),It(t.target).is("input")||t.preventDefault()}),!P.is(":disabled")&&!0!==a.disabled||Tt(),N.click(Ft),z.change(dt),z.bind("paste",function(){setTimeout(dt,1)}),z.keydown(function(t){13==t.keyCode&&dt()}),V.text(a.cancelText),V.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),wt(),bt()}),$.attr("title",a.clearText),$.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),ot=!0,Ct(),u&&Ot(!0)}),X.text(a.chooseText),X.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),Nt&&z.is(":focus")&&z.trigger("change"),z.hasClass("sp-validation-error")||(Ot(!0),bt())}),Y.text(a.showPaletteOnly?a.togglePaletteMoreText:a.togglePaletteLessText),Y.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),a.showPaletteOnly=!a.showPaletteOnly,a.showPaletteOnly||u||N.css("left","-="+(R.outerWidth(!0)+5)),at()}),Bt(B,function(t,e,n){C=t/v,ot=!1,n.shiftKey&&(C=Math.round(10*C)/10),Ct()},ft,pt),Bt(L,function(t,e){w=parseFloat(e/m),ot=!1,a.showAlpha||(C=1),Ct()},ft,pt),Bt(M,function(t,e,n){n.shiftKey?I||(n=_*p,r=d-x*d,r=Math.abs(t-n)>Math.abs(e-r),I=r?"x":"y"):I=null;var r=!I||"y"===I;I&&"x"!==I||(_=parseFloat(t/p)),r&&(x=parseFloat((d-e)/d)),ot=!1,a.showAlpha||(C=1),Ct()},ft,pt),et?(_t(et),kt(),rt=a.preferredFormat||tinycolor(et).format,ct(et)):kt(),u&&mt();var e=Nt?"mousedown.spectrum":"click.spectrum touchstart.spectrum";U.delegate(".sp-thumb-el",e,t),G.delegate(".sp-thumb-el:nth-child(1)",e,{ignore:!0},t)}();var At={show:mt,hide:bt,toggle:gt,reflow:Et,option:function(t,e){return t===jt?It.extend({},a):e===jt?a[t]:(a[t]=e,"preferredFormat"===t&&(rt=a.preferredFormat),void at())},enable:function(){D=!1,P.attr("disabled",!1),Z.removeClass("sp-disabled")},disable:Tt,offset:function(t){a.offset=t,Et()},set:function(t){_t(t),Ot()},get:xt,destroy:function(){P.show(),Z.unbind("click.spectrum touchstart.spectrum"),N.remove(),J.remove(),Dt[At.id]=null},container:N};return At.id=Dt.push(At)-1,At}function n(){}function Ft(t){t.stopPropagation()}function Ht(t,e){var n=Array.prototype.slice,r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}function Bt(r,i,e,t){i=i||function(){},e=e||function(){},t=t||function(){};var o=document,s=!1,a={},u=0,c=0,l="ontouchstart"in window,n={};function h(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function f(t){if(s){if(Nt&&o.documentMode<9&&!t.button)return p();var e=t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches[0],n=e&&e.pageX||t.pageX,e=e&&e.pageY||t.pageY,n=Math.max(0,Math.min(n-a.left,c)),e=Math.max(0,Math.min(e-a.top,u));l&&h(t),i.apply(r,[n,e,t])}}function p(){s&&(It(o).unbind(n),It(o.body).removeClass("sp-dragging"),setTimeout(function(){t.apply(r,arguments)},0)),s=!1}n.selectstart=h,n.dragstart=h,n["touchmove mousemove"]=f,n["touchend mouseup"]=p,It(r).bind("touchstart mousedown",function(t){(t.which?3==t.which:2==t.button)||s||!1!==e.apply(r,arguments)&&(s=!0,u=It(r).height(),c=It(r).width(),a=It(r).offset(),It(o).bind(n),It(o.body).addClass("sp-dragging"),f(t),h(t))})}function qt(){return It.fn.spectrum.inputTypeColorSupport()}var s="spectrum.id";It.fn.spectrum=function(n,t){if("string"!=typeof n)return this.spectrum("destroy").each(function(){var t=o(this,It.extend({},n,It(this).data()));It(this).data(s,t.id)});var r=this,i=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=Dt[It(this).data(s)];if(t){var e=t[n];if(!e)throw new Error("Spectrum: no such method: '"+n+"'");"get"==n?r=t.get():"container"==n?r=t.container:"option"==n?r=t.option.apply(t,i):"destroy"==n?(t.destroy(),It(this).removeData(s)):e.apply(t,i)}}),r},It.fn.spectrum.load=!0,It.fn.spectrum.loadOpts={},It.fn.spectrum.draggable=Bt,It.fn.spectrum.defaults=Pt,It.fn.spectrum.inputTypeColorSupport=function t(){var e;return void 0===t._cachedResult&&(e=It("<input type='color'/>")[0],t._cachedResult="color"===e.type&&""!==e.value),t._cachedResult},It.spectrum={},It.spectrum.localization={},It.spectrum.palettes={},It.fn.spectrum.processNativeColorInputs=function(){var t=It("input[type=color]");t.length&&!qt()&&t.spectrum({preferredFormat:"hex6"})},function(){var d=/^[\s,#]+/,g=/\s+$/,m=0,v=Math,y=v.round,b=v.min,w=v.max,t=v.random,_=function(t,e){if(e=e||{},(t=t||"")instanceof _)return t;if(!(this instanceof _))return new _(t,e);var n,r,i,o,s,a,u,c,l,h,f,l=(c={r:0,g:0,b:0},f=h=!(l=1),"string"==typeof(n=t)&&(n=function(t){t=t.replace(d,"").replace(g,"").toLowerCase();var e,n=!1;if(O[t])t=O[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};return(e=M.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=M.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=M.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=M.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=M.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=M.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=M.hex8.exec(t))?{a:j(e[1])/255,r:j(e[2]),g:j(e[3]),b:j(e[4]),format:n?"name":"hex8"}:(e=M.hex6.exec(t))?{r:j(e[1]),g:j(e[2]),b:j(e[3]),format:n?"name":"hex"}:!!(e=M.hex3.exec(t))&&{r:j(e[1]+""+e[1]),g:j(e[2]+""+e[2]),b:j(e[3]+""+e[3]),format:n?"name":"hex"}}(n)),"object"==typeof n&&(n.hasOwnProperty("r")&&n.hasOwnProperty("g")&&n.hasOwnProperty("b")?(s=n.r,a=n.g,u=n.b,c={r:255*A(s,255),g:255*A(a,255),b:255*A(u,255)},h=!0,f="%"===String(n.r).substr(-1)?"prgb":"rgb"):n.hasOwnProperty("h")&&n.hasOwnProperty("s")&&n.hasOwnProperty("v")?(n.s=D(n.s),n.v=D(n.v),c=function(t,e,n){t=6*A(t,360),e=A(e,100),n=A(n,100);var r=v.floor(t),i=t-r,o=n*(1-e),t=n*(1-i*e),e=n*(1-(1-i)*e),r=r%6;return{r:255*[n,t,o,o,e,n][r],g:255*[e,n,n,t,o,o][r],b:255*[o,o,e,n,n,t][r]}}(n.h,n.s,n.v),h=!0,f="hsv"):n.hasOwnProperty("h")&&n.hasOwnProperty("s")&&n.hasOwnProperty("l")&&(n.s=D(n.s),n.l=D(n.l),s=n.h,a=n.s,u=n.l,s=A(s,360),a=A(a,100),u=A(u,100),0===a?r=i=o=u:(r=p(a=2*u-(u=u<.5?u*(1+a):u+a-u*a),u,s+1/3),i=p(a,u,s),o=p(a,u,s-1/3)),c={r:255*r,g:255*i,b:255*o},h=!0,f="hsl"),n.hasOwnProperty("a")&&(l=n.a)),l=T(l),{ok:h,format:n.format||f,r:b(255,w(c.r,0)),g:b(255,w(c.g,0)),b:b(255,w(c.b,0)),a:l});function p(t,e,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}this._originalInput=t,this._r=l.r,this._g=l.g,this._b=l.b,this._a=l.a,this._roundA=y(100*this._a)/100,this._format=e.format||l.format,this._gradientType=e.gradientType,this._r<1&&(this._r=y(this._r)),this._g<1&&(this._g=y(this._g)),this._b<1&&(this._b=y(this._b)),this._ok=l.ok,this._tc_id=m++};function r(t,e,n){t=A(t,255),e=A(e,255),n=A(n,255);var r,i=w(t,e,n),o=b(t,e,n),s=(i+o)/2;if(i==o)r=u=0;else{var a=i-o,u=.5<s?a/(2-i-o):a/(i+o);switch(i){case t:r=(e-n)/a+(e<n?6:0);break;case e:r=(n-t)/a+2;break;case n:r=(t-e)/a+4}r/=6}return{h:r,s:u,l:s}}function i(t,e,n){t=A(t,255),e=A(e,255),n=A(n,255);var r,i=w(t,e,n),o=b(t,e,n),s=i,a=i-o,u=0===i?0:a/i;if(i==o)r=0;else{switch(i){case t:r=(e-n)/a+(e<n?6:0);break;case e:r=(n-t)/a+2;break;case n:r=(t-e)/a+4}r/=6}return{h:r,s:u,v:s}}function e(t,e,n,r){n=[P(y(t).toString(16)),P(y(e).toString(16)),P(y(n).toString(16))];return r&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function o(t,e,n,r){return[P(Math.round(255*parseFloat(r)).toString(16)),P(y(t).toString(16)),P(y(e).toString(16)),P(y(n).toString(16))].join("")}function n(t,e){e=0===e?0:e||10;t=_(t).toHsl();return t.s-=e/100,t.s=I(t.s),_(t)}function s(t,e){e=0===e?0:e||10;t=_(t).toHsl();return t.s+=e/100,t.s=I(t.s),_(t)}function a(t){return _(t).desaturate(100)}function u(t,e){e=0===e?0:e||10;t=_(t).toHsl();return t.l+=e/100,t.l=I(t.l),_(t)}function c(t,e){e=0===e?0:e||10;t=_(t).toRgb();return t.r=w(0,b(255,t.r-y(-e/100*255))),t.g=w(0,b(255,t.g-y(-e/100*255))),t.b=w(0,b(255,t.b-y(-e/100*255))),_(t)}function l(t,e){e=0===e?0:e||10;t=_(t).toHsl();return t.l-=e/100,t.l=I(t.l),_(t)}function h(t,e){t=_(t).toHsl(),e=(y(t.h)+e)%360;return t.h=e<0?360+e:e,_(t)}function f(t){t=_(t).toHsl();return t.h=(t.h+180)%360,_(t)}function p(t){var e=_(t).toHsl(),n=e.h;return[_(t),_({h:(n+120)%360,s:e.s,l:e.l}),_({h:(n+240)%360,s:e.s,l:e.l})]}function x(t){var e=_(t).toHsl(),n=e.h;return[_(t),_({h:(n+90)%360,s:e.s,l:e.l}),_({h:(n+180)%360,s:e.s,l:e.l}),_({h:(n+270)%360,s:e.s,l:e.l})]}function C(t){var e=_(t).toHsl(),n=e.h;return[_(t),_({h:(n+72)%360,s:e.s,l:e.l}),_({h:(n+216)%360,s:e.s,l:e.l})]}function k(t,e,n){e=e||6,n=n||30;var r=_(t).toHsl(),i=360/n,o=[_(t)];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,o.push(_(r));return o}function S(t,e){e=e||6;for(var t=_(t).toHsv(),n=t.h,r=t.s,i=t.v,o=[],s=1/e;e--;)o.push(_({h:n,s:r,v:i})),i=(i+s)%1;return o}_.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=T(t),this._roundA=y(100*this._a)/100,this},toHsv:function(){var t=i(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=i(this._r,this._g,this._b),e=y(360*t.h),n=y(100*t.s),t=y(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+t+"%)":"hsva("+e+", "+n+"%, "+t+"%, "+this._roundA+")"},toHsl:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=r(this._r,this._g,this._b),e=y(360*t.h),n=y(100*t.s),t=y(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+t+"%)":"hsla("+e+", "+n+"%, "+t+"%, "+this._roundA+")"},toHex:function(t){return e(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return o(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:y(this._r),g:y(this._g),b:y(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+y(this._r)+", "+y(this._g)+", "+y(this._b)+")":"rgba("+y(this._r)+", "+y(this._g)+", "+y(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:y(100*A(this._r,255))+"%",g:y(100*A(this._g,255))+"%",b:y(100*A(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+y(100*A(this._r,255))+"%, "+y(100*A(this._g,255))+"%, "+y(100*A(this._b,255))+"%)":"rgba("+y(100*A(this._r,255))+"%, "+y(100*A(this._g,255))+"%, "+y(100*A(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(E[e(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+o(this._r,this._g,this._b,this._a),n=e,r=this._gradientType?"GradientType = 1, ":"";return t&&(n=_(t).toHex8String()),"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+e+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,r=this._a<1&&0<=this._a;return e||!r||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},_applyModification:function(t,e){e=t.apply(null,[this].concat([].slice.call(e)));return this._r=e._r,this._g=e._g,this._b=e._b,this.setAlpha(e._a),this},lighten:function(){return this._applyModification(u,arguments)},brighten:function(){return this._applyModification(c,arguments)},darken:function(){return this._applyModification(l,arguments)},desaturate:function(){return this._applyModification(n,arguments)},saturate:function(){return this._applyModification(s,arguments)},greyscale:function(){return this._applyModification(a,arguments)},spin:function(){return this._applyModification(h,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(k,arguments)},complement:function(){return this._applyCombination(f,arguments)},monochromatic:function(){return this._applyCombination(S,arguments)},splitcomplement:function(){return this._applyCombination(C,arguments)},triad:function(){return this._applyCombination(p,arguments)},tetrad:function(){return this._applyCombination(x,arguments)}},_.fromRatio=function(t,e){if("object"==typeof t){var n,r={};for(n in t)t.hasOwnProperty(n)&&(r[n]="a"===n?t[n]:D(t[n]));t=r}return _(t,e)},_.equals=function(t,e){return!(!t||!e)&&_(t).toRgbString()==_(e).toRgbString()},_.random=function(){return _.fromRatio({r:t(),g:t(),b:t()})},_.mix=function(t,e,n){n=0===n?0:n||50;var r=_(t).toRgb(),i=_(e).toRgb(),t=n/100,e=2*t-1,n=i.a-r.a,n=1-(e=(1+(e=e*n==-1?e:(e+n)/(1+e*n)))/2),t={r:i.r*e+r.r*n,g:i.g*e+r.g*n,b:i.b*e+r.b*n,a:i.a*t+r.a*(1-t)};return _(t)},_.readability=function(t,e){var n=_(t),r=_(e),t=n.toRgb(),e=r.toRgb(),n=n.getBrightness(),r=r.getBrightness(),e=Math.max(t.r,e.r)-Math.min(t.r,e.r)+Math.max(t.g,e.g)-Math.min(t.g,e.g)+Math.max(t.b,e.b)-Math.min(t.b,e.b);return{brightness:Math.abs(n-r),color:e}},_.isReadable=function(t,e){e=_.readability(t,e);return 125<e.brightness&&500<e.color},_.mostReadable=function(t,e){for(var n=null,r=0,i=!1,o=0;o<e.length;o++){var s=_.readability(t,e[o]),a=125<s.brightness&&500<s.color,s=s.brightness/125*3+s.color/500;(a&&!i||a&&i&&r<s||!a&&!i&&r<s)&&(i=a,r=s,n=_(e[o]))}return n};var O=_.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},E=_.hexNames=function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[t[e]]=e);return n}(O);function T(t){return t=parseFloat(t),(isNaN(t)||t<0||1<t)&&(t=1),t}function A(t,e){"string"==typeof(n=t)&&-1!=n.indexOf(".")&&1===parseFloat(n)&&(t="100%");var n="string"==typeof t&&-1!=t.indexOf("%");return t=b(e,w(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),v.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function I(t){return b(1,w(0,t))}function j(t){return parseInt(t,16)}function P(t){return 1==t.length?"0"+t:""+t}function D(t){return t<=1&&(t=100*t+"%"),t}var N,R,M=(N="[\\s|\\(]+("+(R="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",R="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",{rgb:new RegExp("rgb"+N),rgba:new RegExp("rgba"+R),hsl:new RegExp("hsl"+N),hsla:new RegExp("hsla"+R),hsv:new RegExp("hsv"+N),hsva:new RegExp("hsva"+R),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});window.tinycolor=_}(),It(function(){It.fn.spectrum.load&&It.fn.spectrum.processNativeColorInputs()})}),function(){var t=function(x){x.ui=x.ui||{},x.ui.version="1.12.1";var i,r,C,k,o,s,a,u,c,n,l=0,h=Array.prototype.slice;function S(t,e,n){return[parseFloat(t[0])*(c.test(t[0])?e/100:1),parseFloat(t[1])*(c.test(t[1])?n/100:1)]}function O(t,e){return parseInt(x.css(t,e),10)||0}x.cleanData=(i=x.cleanData,function(t){for(var e,n,r=0;null!=(n=t[r]);r++)try{(e=x._data(n,"events"))&&e.remove&&x(n).triggerHandler("remove")}catch(t){}i(t)}),x.widget=function(t,n,e){var r,i,o,s={},a=t.split(".")[0],u=a+"-"+(t=t.split(".")[1]);return e||(e=n,n=x.Widget),x.isArray(e)&&(e=x.extend.apply(null,[{}].concat(e))),x.expr[":"][u.toLowerCase()]=function(t){return!!x.data(t,u)},x[a]=x[a]||{},r=x[a][t],i=x[a][t]=function(t,e){if(!this._createWidget)return new i(t,e);arguments.length&&this._createWidget(t,e)},x.extend(i,r,{version:e.version,_proto:x.extend({},e),_childConstructors:[]}),(o=new n).options=x.widget.extend({},o.options),x.each(e,function(e,r){function i(){return n.prototype[e].apply(this,arguments)}function o(t){return n.prototype[e].apply(this,t)}x.isFunction(r)?s[e]=function(){var t,e=this._super,n=this._superApply;return this._super=i,this._superApply=o,t=r.apply(this,arguments),this._super=e,this._superApply=n,t}:s[e]=r}),i.prototype=x.widget.extend(o,{widgetEventPrefix:r&&o.widgetEventPrefix||t},s,{constructor:i,namespace:a,widgetName:t,widgetFullName:u}),r?(x.each(r._childConstructors,function(t,e){var n=e.prototype;x.widget(n.namespace+"."+n.widgetName,i,e._proto)}),delete r._childConstructors):n._childConstructors.push(i),x.widget.bridge(t,i),i},x.widget.extend=function(t){for(var e,n,r=h.call(arguments,1),i=0,o=r.length;i<o;i++)for(e in r[i])n=r[i][e],r[i].hasOwnProperty(e)&&void 0!==n&&(x.isPlainObject(n)?t[e]=x.isPlainObject(t[e])?x.widget.extend({},t[e],n):x.widget.extend({},n):t[e]=n);return t},x.widget.bridge=function(o,e){var s=e.prototype.widgetFullName||o;x.fn[o]=function(n){var t="string"==typeof n,r=h.call(arguments,1),i=this;return t?this.length||"instance"!==n?this.each(function(){var t,e=x.data(this,s);return"instance"===n?(i=e,!1):e?x.isFunction(e[n])&&"_"!==n.charAt(0)?(t=e[n].apply(e,r))!==e&&void 0!==t?(i=t&&t.jquery?i.pushStack(t.get()):t,!1):void 0:x.error("no such method '"+n+"' for "+o+" widget instance"):x.error("cannot call methods on "+o+" prior to initialization; attempted to call method '"+n+"'")}):i=void 0:(r.length&&(n=x.widget.extend.apply(null,[n].concat(r))),this.each(function(){var t=x.data(this,s);t?(t.option(n||{}),t._init&&t._init()):x.data(this,s,new e(n,this))})),i}},x.Widget=function(){},x.Widget._childConstructors=[],x.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(t,e){e=x(e||this.defaultElement||this)[0],this.element=x(e),this.uuid=l++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=x(),this.hoverable=x(),this.focusable=x(),this.classesElementLookup={},e!==this&&(x.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===e&&this.destroy()}}),this.document=x(e.style?e.ownerDocument:e.document||e),this.window=x(this.document[0].defaultView||this.document[0].parentWindow)),this.options=x.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:x.noop,_create:x.noop,_init:x.noop,destroy:function(){var n=this;this._destroy(),x.each(this.classesElementLookup,function(t,e){n._removeClass(e,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:x.noop,widget:function(){return this.element},option:function(t,e){var n,r,i,o=t;if(0===arguments.length)return x.widget.extend({},this.options);if("string"==typeof t)if(o={},t=(n=t.split(".")).shift(),n.length){for(r=o[t]=x.widget.extend({},this.options[t]),i=0;i<n.length-1;i++)r[n[i]]=r[n[i]]||{},r=r[n[i]];if(t=n.pop(),1===arguments.length)return void 0===r[t]?null:r[t];r[t]=e}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=e}return this._setOptions(o),this},_setOptions:function(t){for(var e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(t){var e,n,r;for(e in t)r=this.classesElementLookup[e],t[e]!==this.options.classes[e]&&r&&r.length&&(n=x(r.get()),this._removeClass(r,e),n.addClass(this._classes({element:n,keys:e,classes:t,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(i){var o=[],s=this;function t(t,e){for(var n,r=0;r<t.length;r++)n=s.classesElementLookup[t[r]]||x(),n=i.add?x(x.unique(n.get().concat(i.element.get()))):x(n.not(i.element).get()),s.classesElementLookup[t[r]]=n,o.push(t[r]),e&&i.classes[t[r]]&&o.push(i.classes[t[r]])}return i=x.extend({element:this.element,classes:this.options.classes||{}},i),this._on(i.element,{remove:"_untrackClassesElement"}),i.keys&&t(i.keys.match(/\S+/g)||[],!0),i.extra&&t(i.extra.match(/\S+/g)||[]),o.join(" ")},_untrackClassesElement:function(n){var r=this;x.each(r.classesElementLookup,function(t,e){-1!==x.inArray(n.target,e)&&(r.classesElementLookup[t]=x(e.not(n.target).get()))})},_removeClass:function(t,e,n){return this._toggleClass(t,e,n,!1)},_addClass:function(t,e,n){return this._toggleClass(t,e,n,!0)},_toggleClass:function(t,e,n,r){r="boolean"==typeof r?r:n;var i="string"==typeof t||null===t,t={extra:i?e:n,keys:i?t:e,element:i?this.element:t,add:r};return t.element.toggleClass(this._classes(t),r),this},_on:function(i,o,t){var s,a=this;"boolean"!=typeof i&&(t=o,o=i,i=!1),t?(o=s=x(o),this.bindings=this.bindings.add(o)):(t=o,o=this.element,s=this.widget()),x.each(t,function(t,e){function n(){if(i||!0!==a.options.disabled&&!x(this).hasClass("ui-state-disabled"))return("string"==typeof e?a[e]:e).apply(a,arguments)}"string"!=typeof e&&(n.guid=e.guid=e.guid||n.guid||x.guid++);var r=t.match(/^([\w:-]*)\s*(.*)$/),t=r[1]+a.eventNamespace,r=r[2];r?s.on(t,r,n):o.on(t,n)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(e).off(e),this.bindings=x(this.bindings.not(t).get()),this.focusable=x(this.focusable.not(t).get()),this.hoverable=x(this.hoverable.not(t).get())},_delay:function(t,e){var n=this;return setTimeout(function(){return("string"==typeof t?n[t]:t).apply(n,arguments)},e||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(x(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(x(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(x(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(x(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,e,n){var r,i,o=this.options[t];if(n=n||{},(e=x.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],i=e.originalEvent)for(r in i)r in e||(e[r]=i[r]);return this.element.trigger(e,n),!(x.isFunction(o)&&!1===o.apply(this.element[0],[e].concat(n))||e.isDefaultPrevented())}},x.each({show:"fadeIn",hide:"fadeOut"},function(o,s){x.Widget.prototype["_"+o]=function(e,t,n){var r;"string"==typeof t&&(t={effect:t});var i=t?!0!==t&&"number"!=typeof t&&t.effect||s:o;"number"==typeof(t=t||{})&&(t={duration:t}),r=!x.isEmptyObject(t),t.complete=n,t.delay&&e.delay(t.delay),r&&x.effects&&x.effects.effect[i]?e[o](t):i!==o&&e[i]?e[i](t.duration,t.easing,n):e.queue(function(t){x(this)[o](),n&&n.call(e[0]),t()})}}),x.widget,C=Math.max,k=Math.abs,o=/left|center|right/,s=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,u=/^\w+/,c=/%$/,n=x.fn.position,x.position={scrollbarWidth:function(){if(void 0!==r)return r;var t,e=x("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),n=e.children()[0];return x("body").append(e),t=n.offsetWidth,e.css("overflow","scroll"),t===(n=n.offsetWidth)&&(n=e[0].clientWidth),e.remove(),r=t-n},getScrollInfo:function(t){var e=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),n=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),e="scroll"===e||"auto"===e&&t.width<t.element[0].scrollWidth;return{width:"scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight?x.position.scrollbarWidth():0,height:e?x.position.scrollbarWidth():0}},getWithinInfo:function(t){var e=x(t||window),n=x.isWindow(e[0]),r=!!e[0]&&9===e[0].nodeType;return{element:e,isWindow:n,isDocument:r,offset:n||r?{left:0,top:0}:x(t).offset(),scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:e.outerWidth(),height:e.outerHeight()}}},x.fn.position=function(h){if(!h||!h.of)return n.apply(this,arguments);h=x.extend({},h);var f,p,d,g,m,t,v=x(h.of),y=x.position.getWithinInfo(h.within),b=x.position.getScrollInfo(y),w=(h.collision||"flip").split(" "),_={},e=9===(t=(e=v)[0]).nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:x.isWindow(t)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:t.preventDefault?{width:0,height:0,offset:{top:t.pageY,left:t.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()};return v[0].preventDefault&&(h.at="left top"),p=e.width,d=e.height,g=e.offset,m=x.extend({},g),x.each(["my","at"],function(){var t,e,n=(h[this]||"").split(" ");1===n.length&&(n=o.test(n[0])?n.concat(["center"]):s.test(n[0])?["center"].concat(n):["center","center"]),n[0]=o.test(n[0])?n[0]:"center",n[1]=s.test(n[1])?n[1]:"center",t=a.exec(n[0]),e=a.exec(n[1]),_[this]=[t?t[0]:0,e?e[0]:0],h[this]=[u.exec(n[0])[0],u.exec(n[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===h.at[0]?m.left+=p:"center"===h.at[0]&&(m.left+=p/2),"bottom"===h.at[1]?m.top+=d:"center"===h.at[1]&&(m.top+=d/2),f=S(_.at,p,d),m.left+=f[0],m.top+=f[1],this.each(function(){var n,t,s=x(this),a=s.outerWidth(),u=s.outerHeight(),e=O(this,"marginLeft"),r=O(this,"marginTop"),i=a+e+O(this,"marginRight")+b.width,o=u+r+O(this,"marginBottom")+b.height,c=x.extend({},m),l=S(_.my,s.outerWidth(),s.outerHeight());"right"===h.my[0]?c.left-=a:"center"===h.my[0]&&(c.left-=a/2),"bottom"===h.my[1]?c.top-=u:"center"===h.my[1]&&(c.top-=u/2),c.left+=l[0],c.top+=l[1],n={marginLeft:e,marginTop:r},x.each(["left","top"],function(t,e){x.ui.position[w[t]]&&x.ui.position[w[t]][e](c,{targetWidth:p,targetHeight:d,elemWidth:a,elemHeight:u,collisionPosition:n,collisionWidth:i,collisionHeight:o,offset:[f[0]+l[0],f[1]+l[1]],my:h.my,at:h.at,within:y,elem:s})}),h.using&&(t=function(t){var e=g.left-c.left,n=e+p-a,r=g.top-c.top,i=r+d-u,o={target:{element:v,left:g.left,top:g.top,width:p,height:d},element:{element:s,left:c.left,top:c.top,width:a,height:u},horizontal:n<0?"left":0<e?"right":"center",vertical:i<0?"top":0<r?"bottom":"middle"};p<a&&k(e+n)<p&&(o.horizontal="center"),d<u&&k(r+i)<d&&(o.vertical="middle"),C(k(e),k(n))>C(k(r),k(i))?o.important="horizontal":o.important="vertical",h.using.call(this,t,o)}),s.offset(x.extend(c,{using:t}))})},x.ui.position={fit:{left:function(t,e){var n=e.within,r=n.isWindow?n.scrollLeft:n.offset.left,i=n.width,o=t.left-e.collisionPosition.marginLeft,s=r-o,a=o+e.collisionWidth-i-r;e.collisionWidth>i?0<s&&a<=0?(n=t.left+s+e.collisionWidth-i-r,t.left+=s-n):t.left=!(0<a&&s<=0)&&a<s?r+i-e.collisionWidth:r:0<s?t.left+=s:0<a?t.left-=a:t.left=C(t.left-o,t.left)},top:function(t,e){var n=e.within,r=n.isWindow?n.scrollTop:n.offset.top,i=e.within.height,o=t.top-e.collisionPosition.marginTop,s=r-o,a=o+e.collisionHeight-i-r;e.collisionHeight>i?0<s&&a<=0?(n=t.top+s+e.collisionHeight-i-r,t.top+=s-n):t.top=!(0<a&&s<=0)&&a<s?r+i-e.collisionHeight:r:0<s?t.top+=s:0<a?t.top-=a:t.top=C(t.top-o,t.top)}},flip:{left:function(t,e){var n=e.within,r=n.offset.left+n.scrollLeft,i=n.width,o=n.isWindow?n.scrollLeft:n.offset.left,s=t.left-e.collisionPosition.marginLeft,a=s-o,u=s+e.collisionWidth-i-o,c="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,n="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,s=-2*e.offset[0];a<0?((r=t.left+c+n+s+e.collisionWidth-i-r)<0||r<k(a))&&(t.left+=c+n+s):0<u&&(0<(o=t.left-e.collisionPosition.marginLeft+c+n+s-o)||k(o)<u)&&(t.left+=c+n+s)},top:function(t,e){var n=e.within,r=n.offset.top+n.scrollTop,i=n.height,o=n.isWindow?n.scrollTop:n.offset.top,s=t.top-e.collisionPosition.marginTop,a=s-o,u=s+e.collisionHeight-i-o,c="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,n="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,s=-2*e.offset[1];a<0?((r=t.top+c+n+s+e.collisionHeight-i-r)<0||r<k(a))&&(t.top+=c+n+s):0<u&&(0<(o=t.top-e.collisionPosition.marginTop+c+n+s-o)||k(o)<u)&&(t.top+=c+n+s)}},flipfit:{left:function(){x.ui.position.flip.left.apply(this,arguments),x.ui.position.fit.left.apply(this,arguments)},top:function(){x.ui.position.flip.top.apply(this,arguments),x.ui.position.fit.top.apply(this,arguments)}}},x.ui.position,x.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):x(this[0].form)},x.ui.formResetMixin={_formResetHandler:function(){var e=x(this);setTimeout(function(){var t=e.data("ui-form-reset-instances");x.each(t,function(){this.refresh()})})},_bindFormResetHandler:function(){var t;this.form=this.element.form(),this.form.length&&((t=this.form.data("ui-form-reset-instances")||[]).length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t))},_unbindFormResetHandler:function(){var t;this.form.length&&((t=this.form.data("ui-form-reset-instances")).splice(x.inArray(this,t),1),t.length?this.form.data("ui-form-reset-instances",t):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset"))}},x.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},x.ui.escapeSelector=(e=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,function(t){return t.replace(e,"\\$1")}),x.fn.labels=function(){var t,e,n;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(e=this.eq(0).parents("label"),(t=this.attr("id"))&&(n=(n=this.eq(0).parents().last()).add((n.length?n:this).siblings()),t="label[for='"+x.ui.escapeSelector(t)+"']",e=e.add(n.find(t).addBack(t))),this.pushStack(e))},x.fn.extend({uniqueId:(t=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&x(this).removeAttr("id")})}});var e,t,f,p=/ui-corner-([a-z]){2,6}/g;x.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var o=this,s=[];x.each(this.options.items,function(r,t){var e,i;if(t)return"controlgroupLabel"===r?((e=o.element.find(t)).each(function(){var t=x(this);t.children(".ui-controlgroup-label-contents").length||t.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),o._addClass(e,null,"ui-widget ui-widget-content ui-state-default"),void(s=s.concat(e.get()))):void(x.fn[r]&&(i=o["_"+r+"Options"]?o["_"+r+"Options"]("middle"):{classes:{}},o.element.find(t).each(function(){var t=x(this),e=t[r]("instance"),n=x.widget.extend({},i);"button"===r&&t.parent(".ui-spinner").length||((e=e||t[r]()[r]("instance"))&&(n.classes=o._resolveClassesValues(n.classes,e)),t[r](n),n=t[r]("widget"),x.data(n[0],"ui-controlgroup-data",e||t[r]("instance")),s.push(n[0]))})))}),this.childWidgets=x(x.unique(s)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(e){this.childWidgets.each(function(){var t=x(this).data("ui-controlgroup-data");t&&t[e]&&t[e]()})},_updateCornerClass:function(t,e){e=this._buildSimpleOptions(e,"label").classes.label;this._removeClass(t,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(t,null,e)},_buildSimpleOptions:function(t,e){var n="vertical"===this.options.direction,r={classes:{}};return r.classes[e]={middle:"",first:"ui-corner-"+(n?"top":"left"),last:"ui-corner-"+(n?"bottom":"right"),only:"ui-corner-all"}[t],r},_spinnerOptions:function(t){t=this._buildSimpleOptions(t,"ui-spinner");return t.classes["ui-spinner-up"]="",t.classes["ui-spinner-down"]="",t},_buttonOptions:function(t){return this._buildSimpleOptions(t,"ui-button")},_checkboxradioOptions:function(t){return this._buildSimpleOptions(t,"ui-checkboxradio-label")},_selectmenuOptions:function(t){var e="vertical"===this.options.direction;return{width:!!e&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(e?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(e?"top":"left")},last:{"ui-selectmenu-button-open":e?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(e?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[t]}},_resolveClassesValues:function(n,r){var i={};return x.each(n,function(t){var e=r.options.classes[t]||"",e=x.trim(e.replace(p,""));i[t]=(e+" "+n[t]).replace(/\s+/g," ")}),i},_setOption:function(t,e){"direction"===t&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(t,e),"disabled"!==t?this.refresh():this._callChildMethod(e?"disable":"enable")},refresh:function(){var i,o=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),i=this.childWidgets,this.options.onlyVisible&&(i=i.filter(":visible")),i.length&&(x.each(["first","last"],function(t,e){var n,r=i[e]().data("ui-controlgroup-data");r&&o["_"+r.widgetName+"Options"]?((n=o["_"+r.widgetName+"Options"](1===i.length?"only":e)).classes=o._resolveClassesValues(n.classes,r),r.element[r.widgetName](n)):o._updateCornerClass(i[e](),e)}),this._callChildMethod("refresh"))}}),x.widget("ui.checkboxradio",[x.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var t,e=this,n=this._super()||{};return this._readType(),t=this.element.labels(),this.label=x(t[t.length-1]),this.label.length||x.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){e.originalLabel+=3===this.nodeType?x(this).text():this.outerHTML}),this.originalLabel&&(n.label=this.originalLabel),null!=(t=this.element[0].disabled)&&(n.disabled=t),n},_create:function(){var t=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),t&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var t=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===t&&/radio|checkbox/.test(this.type)||x.error("Can't create checkboxradio on element.nodeName="+t+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var t=this.element[0].name,e="input[name='"+x.ui.escapeSelector(t)+"']";return t?(this.form.length?x(this.form[0].elements).filter(e):x(e).filter(function(){return 0===x(this).form().length})).not(this.element):x([])},_toggleClasses:function(){var t=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",t)._toggleClass(this.icon,null,"ui-icon-blank",!t),"radio"===this.type&&this._getRadioGroup().each(function(){var t=x(this).checkboxradio("instance");t&&t._removeClass(t.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(t,e){if("label"!==t||e){if(this._super(t,e),"disabled"===t)return this._toggleClass(this.label,null,"ui-state-disabled",e),void(this.element[0].disabled=e);this.refresh()}},_updateIcon:function(t){var e="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=x("<span>"),this.iconSpace=x("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(e+=t?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,t?"ui-icon-blank":"ui-icon-check")):e+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",e),t||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var t=this.label.contents().not(this.element[0]);this.icon&&(t=t.not(this.icon[0])),this.iconSpace&&(t=t.not(this.iconSpace[0])),t.remove(),this.label.append(this.options.label)},refresh:function(){var t=this.element[0].checked,e=this.element[0].disabled;this._updateIcon(t),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),null!==this.options.label&&this._updateLabel(),e!==this.options.disabled&&this._setOptions({disabled:e})}}]),x.ui.checkboxradio,x.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var t,e=this._super()||{};return this.isInput=this.element.is("input"),null!=(t=this.element[0].disabled)&&(e.disabled=t),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(e.label=this.originalLabel),e},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(t){t.keyCode===x.ui.keyCode.SPACE&&(t.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(t,e){var n="iconPosition"!==t,r=n?this.options.iconPosition:e,t="top"===r||"bottom"===r;this.icon?n&&this._removeClass(this.icon,null,this.options.icon):(this.icon=x("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),n&&this._addClass(this.icon,null,e),this._attachIcon(r),t?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=x("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(r))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(t){this.icon[/^(?:end|bottom)/.test(t)?"before":"after"](this.iconSpace)},_attachIcon:function(t){this.element[/^(?:end|bottom)/.test(t)?"append":"prepend"](this.icon)},_setOptions:function(t){var e=(void 0===t.showLabel?this.options:t).showLabel,n=(void 0===t.icon?this.options:t).icon;e||n||(t.showLabel=!0),this._super(t)},_setOption:function(t,e){"icon"===t&&(e?this._updateIcon(t,e):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===t&&this._updateIcon(t,e),"showLabel"===t&&(this._toggleClass("ui-button-icon-only",null,!e),this._updateTooltip()),"label"===t&&(this.isInput?this.element.val(e):(this.element.html(e),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(t,e),"disabled"===t&&(this._toggleClass(null,"ui-state-disabled",e),(this.element[0].disabled=e)&&this.element.blur())},refresh:function(){var t=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOptions({disabled:t}),this._updateTooltip()}}),!1!==x.uiBackCompat&&(x.widget("ui.button",x.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(t,e){"text"!==t?("showLabel"===t&&(this.options.text=e),"icon"===t&&(this.options.icons.primary=e),"icons"===t&&(e.primary?(this._super("icon",e.primary),this._super("iconPosition","beginning")):e.secondary&&(this._super("icon",e.secondary),this._super("iconPosition","end"))),this._superApply(arguments)):this._super("showLabel",e)}}),x.fn.button=(f=x.fn.button,function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?f.apply(this,arguments):(x.ui.checkboxradio||x.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}),x.fn.buttonset=function(){return x.ui.controlgroup||x.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),x.ui.button,x.ui.safeActiveElement=function(e){var n;try{n=e.activeElement}catch(t){n=e.body}return(n=n||e.body).nodeName||(n=e.body),n},x.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(t){var e=x(t.target),n=x(x.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&e.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),e.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&n.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var e,n;this.previousFilter||(e=x(t.target).closest(".ui-menu-item"),n=x(t.currentTarget),e[0]===n[0]&&(this._removeClass(n.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(t,n)))},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var n=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,n)},blur:function(t){this._delay(function(){x.contains(this.element[0],x.ui.safeActiveElement(this.document[0]))||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){var t=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),t.children().each(function(){var t=x(this);t.data("ui-menu-submenu-caret")&&t.remove()})},_keydown:function(t){var e,n,r,i=!0;switch(t.keyCode){case x.ui.keyCode.PAGE_UP:this.previousPage(t);break;case x.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case x.ui.keyCode.HOME:this._move("first","first",t);break;case x.ui.keyCode.END:this._move("last","last",t);break;case x.ui.keyCode.UP:this.previous(t);break;case x.ui.keyCode.DOWN:this.next(t);break;case x.ui.keyCode.LEFT:this.collapse(t);break;case x.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case x.ui.keyCode.ENTER:case x.ui.keyCode.SPACE:this._activate(t);break;case x.ui.keyCode.ESCAPE:this.collapse(t);break;default:i=!1,e=this.previousFilter||"",r=!1,n=96<=t.keyCode&&t.keyCode<=105?(t.keyCode-96).toString():String.fromCharCode(t.keyCode),clearTimeout(this.filterTimer),n===e?r=!0:n=e+n,e=this._filterMenuItems(n),(e=r&&-1!==e.index(this.active.next())?this.active.nextAll(".ui-menu-item"):e).length||(n=String.fromCharCode(t.keyCode),e=this._filterMenuItems(n)),e.length?(this.focus(t,e),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}i&&t.preventDefault()},_activate:function(t){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var t,e,r=this,i=this.options.icons.submenu,n=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),e=n.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=x(this),e=t.prev(),n=x("<span>").data("ui-menu-submenu-caret",!0);r._addClass(n,"ui-menu-icon","ui-icon "+i),e.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",e.attr("id"))}),this._addClass(e,"ui-menu","ui-widget ui-widget-content ui-front"),(t=n.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var t=x(this);r._isDivider(t)&&r._addClass(t,"ui-menu-divider","ui-widget-content")}),n=(e=t.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(e,"ui-menu-item")._addClass(n,"ui-menu-item-wrapper"),t.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!x.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){var n;"icons"===t&&(n=this.element.find(".ui-menu-icon"),this._removeClass(n,null,this.options.icons.submenu)._addClass(n,null,e.submenu)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",String(t)),this._toggleClass(null,"ui-state-disabled",!!t)},focus:function(t,e){var n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),n=this.active.children(".ui-menu-item-wrapper"),this._addClass(n,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),n=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(n,null,"ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(n=e.children(".ui-menu")).length&&t&&/^mouse/.test(t.type)&&this._startOpening(n),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(t){var e,n,r;this._hasScroll()&&(n=parseFloat(x.css(this.activeMenu[0],"borderTopWidth"))||0,r=parseFloat(x.css(this.activeMenu[0],"paddingTop"))||0,e=t.offset().top-this.activeMenu.offset().top-n-r,n=this.activeMenu.scrollTop(),r=this.activeMenu.height(),t=t.outerHeight(),e<0?this.activeMenu.scrollTop(n+e):r<e+t&&this.activeMenu.scrollTop(n+e-r+t))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",t,{item:this.active}),this.active=null)},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(t){var e=x.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(e)},collapseAll:function(e,n){clearTimeout(this.timer),this.timer=this._delay(function(){var t=n?this.element:x(e&&e.target).closest(this.element.find(".ui-menu"));t.length||(t=this.element),this._close(t),this.blur(e),this._removeClass(t.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=t},this.delay)},_close:function(t){(t=t||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(t){return!x(t.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.preval(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,n){var r;this.active&&(r="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),r&&r.length&&this.active||(r=this.activeMenu.find(this.options.items)[e]()),this.focus(n,r)},nextPage:function(t){var e,n,r;this.active?this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,r=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(e=x(this)).offset().top-n-r<0}),this.focus(t,e)):this.focus(t,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())):this.next(t)},previousPage:function(t){var e,n,r;this.active?this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,r=this.element.height(),this.active.preval(".ui-menu-item").each(function(){return 0<(e=x(this)).offset().top-n+r}),this.focus(t,e)):this.focus(t,this.activeMenu.find(this.options.items).first())):this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||x(t.target).closest(".ui-menu-item");var e={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,e)},_filterMenuItems:function(t){var t=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),e=new RegExp("^"+t,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return e.test(x.trim(x(this).children(".ui-menu-item-wrapper").text()))})}}),x.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var d=!1;function g(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}x(document).on("mouseup",function(){d=!1}),x.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(t){if(!0===x.data(t.target,e.widgetName+".preventClickEvent"))return x.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!d){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var e=this,n=1===t.which,r=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&x(t.target).closest(this.options.cancel).length;return!(n&&!r&&this._mouseCapture(t))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===x.data(t.target,this.widgetName+".preventClickEvent")&&x.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return e._mouseMove(t)},this._mouseUpDelegate=function(t){return e._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),d=!0))}},_mouseMove:function(t){if(this._mouseMoved){if(x.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&x.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,d=!1,t.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),x.widget("ui.selectmenu",[x.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=x()},_drawButton:function(){var t,e=this,n=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=x("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),t=x("<span>").appendTo(this.button),this._addClass(t,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(n).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){e._rendered||e._refreshMenu()})},_drawMenu:function(){var n=this;this.menu=x("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=x("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(t,e){t.preventDefault(),n._setSelection(),n._select(e.item.data("ui-selectmenu-item"),t)},focus:function(t,e){e=e.item.data("ui-selectmenu-item");null!=n.focusIndex&&e.index!==n.focusIndex&&(n._trigger("focus",t,{item:e}),n.isOpen||n._select(e,t)),n.focusIndex=e.index,n.button.attr("aria-activedescendant",n.menuItems.eq(e.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var t=this.element.find("option");this.menu.empty(),this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,t.length&&(t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t)))},_position:function(){this.menuWrap.position(x.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(t){var e=x("<span>");return this._setText(e,t.label),this._addClass(e,"ui-selectmenu-text"),e},_renderMenu:function(r,t){var i=this,o="";x.each(t,function(t,e){var n;e.optgroup!==o&&(n=x("<li>",{text:e.optgroup}),i._addClass(n,"ui-selectmenu-optgroup","ui-menu-divider"+(e.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),n.appendTo(r),o=e.optgroup),i._renderItemData(r,e)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(t,e){var n=x("<li>"),r=x("<div>",{title:e.element.attr("title")});return e.disabled&&this._addClass(n,null,"ui-state-disabled"),this._setText(r,e.label),n.append(r).appendTo(t)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var n,r=".ui-menu-item";this.isOpen?n=this.menuItems.eq(this.focusIndex).parent("li"):(n=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),r+=":not(.ui-state-disabled)"),(r="first"===t||"last"===t?n["first"===t?"prevAll":"nextAll"](r).eq(-1):n[t+"All"](r).eq(0)).length&&this.menuInstance.focus(e,r)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?((t=window.getSelection()).removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(x(t.target).closest(".ui-selectmenu-menu, #"+x.ui.escapeSelector(this.ids.button)).length||this.close(t))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection()).rangeCount&&(this.range=t.getRangeAt(0)):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(t){var e=!0;switch(t.keyCode){case x.ui.keyCode.TAB:case x.ui.keyCode.ESCAPE:this.close(t),e=!1;break;case x.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case x.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case x.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case x.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case x.ui.keyCode.LEFT:this._move("prev",t);break;case x.ui.keyCode.RIGHT:this._move("next",t);break;case x.ui.keyCode.HOME:case x.ui.keyCode.PAGE_UP:this._move("first",t);break;case x.ui.keyCode.END:case x.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),e=!1}e&&t.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex).parent("li");e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var n=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(t)),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==n&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){t=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(t,e){var n;"icons"===t&&(n=this.button.find("span.ui-icon"),this._removeClass(n,null,this.options.icons.button)._addClass(n,null,e.button)),this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"width"===t&&this._resizeButton()},_setOptionDisabled:function(t){this._super(t),this.menuInstance.option("disabled",t),this.button.attr("aria-disabled",t),this._toggleClass(this.button,null,"ui-state-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var t=this.options.appendTo;return(t=t&&(t.jquery||t.nodeType?x(t):this.document.find(t).eq(0)))&&t[0]||(t=this.element.closest(".ui-front, dialog")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;!1!==t?(null===t&&(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t)):this.button.css("width","")},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var t=this._super();return t.disabled=this.element.prop("disabled"),t},_parseOptions:function(t){var n=this,r=[];t.each(function(t,e){r.push(n._parseOption(x(e),t))}),this.items=r},_parseOption:function(t,e){var n=t.parent("optgroup");return{element:t,index:e,value:t.val(),label:t.text(),optgroup:n.attr("label")||"",disabled:n.prop("disabled")||t.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),x.widget("ui.slider",x.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,e=this.options,n=this.element.find(".ui-slider-handle"),r=[],i=e.values&&e.values.length||1;for(n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),t=n.length;t<i;t++)r.push("<span tabindex='0'></span>");this.handles=n.add(x(r.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(t){x(this).data("ui-slider-handle-index",t).attr("tabIndex",0)})},_createRange:function(){var t=this.options;t.range?(!0===t.range&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:x.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=x("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==t.range&&"max"!==t.range||this._addClass(this.range,"ui-slider-range-"+t.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,o,e,s,a=this,u=this.options;return!u.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),s={x:t.pageX,y:t.pageY},n=this._normValueFromMouse(s),r=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var e=Math.abs(n-a.values(t));(e<r||r===e&&(t===a._lastChangedValue||a.values(t)===u.min))&&(r=e,i=x(this),o=t)}),!1!==this._start(t,o)&&(this._mouseSliding=!0,this._handleIndex=o,this._addClass(i,null,"ui-state-active"),i.trigger("focus"),e=i.offset(),s=!x(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=s?{left:0,top:0}:{left:t.pageX-e.left,top:t.pageY-e.top-i.height()/2-(parseInt(i.css("borderTopWidth"),10)||0)-(parseInt(i.css("borderBottomWidth"),10)||0)+(parseInt(i.css("marginTop"),10)||0)},this._animateOff=!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},e=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,e),!1},_mouseStop:function(t){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,t="horizontal"===this.orientation?(e=this.elementSize.width,t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));return 1<(t=t/e)&&(t=1),t<0&&(t=0),"vertical"===this.orientation&&(t=1-t),e=this._valueMax()-this._valueMin(),e=this._valueMin()+t*e,this._trimAlignValue(e)},_uiHash:function(t,e,n){var r={handle:this.handles[t],handleIndex:t,value:void 0!==e?e:this.value()};return this._hasMultipleValues()&&(r.value=void 0!==e?e:this.values(t),r.values=n||this.values()),r},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(t,e){return this._trigger("start",t,this._uiHash(e))},_slide:function(t,e,n){var r,i=this.value(),o=this.values();this._hasMultipleValues()&&(r=this.values(e?0:1),i=this.values(e),2===this.options.values.length&&!0===this.options.range&&(n=0===e?Math.min(r,n):Math.max(r,n)),o[e]=n),n!==i&&!1!==this._trigger("slide",t,this._uiHash(e,n,o))&&(this._hasMultipleValues()?this.values(e,n):this.value(n))},_stop:function(t,e){this._trigger("stop",t,this._uiHash(e))},_change:function(t,e){this._keySliding||this._mouseSliding||(this._lastChangedValue=e,this._trigger("change",t,this._uiHash(e)))},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,e){var n,r,i;if(1<arguments.length)return this.options.values[t]=this._trimAlignValue(e),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!x.isArray(t))return this._hasMultipleValues()?this._values(t):this.value();for(n=this.options.values,r=t,i=0;i<n.length;i+=1)n[i]=this._trimAlignValue(r[i]),this._change(null,i);this._refreshValue()},_setOption:function(t,e){var n,r=0;switch("range"===t&&!0===this.options.range&&("min"===e?(this.options.value=this._values(0),this.options.values=null):"max"===e&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),x.isArray(this.options.values)&&(r=this.options.values.length),this._super(t,e),t){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(e),this.handles.css("horizontal"===e?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=r-1;0<=n;n--)this._change(null,n);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(t){this._super(t),this._toggleClass(null,"ui-state-disabled",!!t)},_value:function(){var t=this.options.value;return this._trimAlignValue(t)},_values:function(t){var e,n,r;if(arguments.length)return e=this.options.values[t],this._trimAlignValue(e);if(this._hasMultipleValues()){for(n=this.options.values.slice(),r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n}return[]},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=0<this.options.step?this.options.step:1,n=(t-this._valueMin())%e,t=t-n;return 2*Math.abs(n)>=e&&(t+=0<n?e:-e),parseFloat(t.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),n=this.options.step;(t=Math.round((t-e)/n)*n+e)>this.options.max&&(t-=n),this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),t=e.indexOf(".");return-1===t?0:e.length-t-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(t){"vertical"===t&&this.range.css({width:"",left:""}),"horizontal"===t&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var e,n,t,r,i,o=this.options.range,s=this.options,a=this,u=!this._animateOff&&s.animate,c={};this._hasMultipleValues()?this.handles.each(function(t){n=(a.values(t)-a._valueMin())/(a._valueMax()-a._valueMin())*100,c["horizontal"===a.orientation?"left":"bottom"]=n+"%",x(this).stop(1,1)[u?"animate":"css"](c,s.animate),!0===a.options.range&&("horizontal"===a.orientation?(0===t&&a.range.stop(1,1)[u?"animate":"css"]({left:n+"%"},s.animate),1===t&&a.range[u?"animate":"css"]({width:n-e+"%"},{queue:!1,duration:s.animate})):(0===t&&a.range.stop(1,1)[u?"animate":"css"]({bottom:n+"%"},s.animate),1===t&&a.range[u?"animate":"css"]({height:n-e+"%"},{queue:!1,duration:s.animate}))),e=n}):(t=this.value(),r=this._valueMin(),i=this._valueMax(),n=i!==r?(t-r)/(i-r)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[u?"animate":"css"](c,s.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[u?"animate":"css"]({width:n+"%"},s.animate),"max"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[u?"animate":"css"]({width:100-n+"%"},s.animate),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[u?"animate":"css"]({height:n+"%"},s.animate),"max"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[u?"animate":"css"]({height:100-n+"%"},s.animate))},_handleEvents:{keydown:function(t){var e,n,r,i=x(t.target).data("ui-slider-handle-index");switch(t.keyCode){case x.ui.keyCode.HOME:case x.ui.keyCode.END:case x.ui.keyCode.PAGE_UP:case x.ui.keyCode.PAGE_DOWN:case x.ui.keyCode.UP:case x.ui.keyCode.RIGHT:case x.ui.keyCode.DOWN:case x.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(x(t.target),null,"ui-state-active"),!1===this._start(t,i)))return}switch(r=this.options.step,e=n=this._hasMultipleValues()?this.values(i):this.value(),t.keyCode){case x.ui.keyCode.HOME:n=this._valueMin();break;case x.ui.keyCode.END:n=this._valueMax();break;case x.ui.keyCode.PAGE_UP:n=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/this.numPages);break;case x.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/this.numPages);break;case x.ui.keyCode.UP:case x.ui.keyCode.RIGHT:if(e===this._valueMax())return;n=this._trimAlignValue(e+r);break;case x.ui.keyCode.DOWN:case x.ui.keyCode.LEFT:if(e===this._valueMin())return;n=this._trimAlignValue(e-r)}this._slide(t,i,n)},keyup:function(t){var e=x(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,e),this._change(t,e),this._removeClass(x(t.target),null,"ui-state-active"))}}}),x.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var r=this._super(),i=this.element;return x.each(["min","max","step"],function(t,e){var n=i.attr(e);null!=n&&n.length&&(r[e]=n)}),r},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){this.cancelBlur?delete this.cancelBlur:(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",t))},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((0<e?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(t){var e;function n(){this.element[0]===x.ui.safeActiveElement(this.document[0])||(this.element.trigger("focus"),this.previous=e,this._delay(function(){this.previous=e}))}e=this.element[0]===x.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),t.preventDefault(),n.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,n.call(this)}),!1!==this._start(t)&&this._repeat(null,x(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(x(t.currentTarget).hasClass("ui-state-active"))return!1!==this._start(t)&&void this._repeat(null,x(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&0<this.uiSpinner.height()&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(t){var e=this.options,n=x.ui.keyCode;switch(t.keyCode){case n.UP:return this._repeat(null,1,t),!0;case n.DOWN:return this._repeat(null,-1,t),!0;case n.PAGE_UP:return this._repeat(null,e.page,t),!0;case n.PAGE_DOWN:return this._repeat(null,-e.page,t),!0}return!1},_start:function(t){return!(!this.spinning&&!1===this._trigger("start",t))&&(this.counter||(this.counter=1),this.spinning=!0)},_repeat:function(t,e,n){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,n)},t),this._spin(e*this.options.step,n)},_spin:function(t,e){var n=this.value()||0;this.counter||(this.counter=1),n=this._adjustValue(n+t*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",e,{value:n})||(this._value(n),this.counter++)},_increment:function(t){var e=this.options.incremental;return e?x.isFunction(e)?e(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=t.toString(),t=e.indexOf(".");return-1===t?0:e.length-t-1},_adjustValue:function(t){var e,n=this.options,r=t-(e=null!==n.min?n.min:0);return t=e+Math.round(r/n.step)*n.step,t=parseFloat(t.toFixed(this._precision())),null!==n.max&&t>n.max?n.max:null!==n.min&&t<n.min?n.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){var n;if("culture"===t||"numberFormat"===t)return n=this._parse(this.element.val()),this.options[t]=e,void this.element.val(this._format(n));"max"!==t&&"min"!==t&&"step"!==t||"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(n=this.buttons.first().find(".ui-icon"),this._removeClass(n,null,this.options.icons.up),this._addClass(n,null,e.up),n=this.buttons.last().find(".ui-icon"),this._removeClass(n,null,this.options.icons.down),this._addClass(n,null,e.down)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable")},_setOptions:g(function(t){this._super(t)}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null!==t&&t===this._adjustValue(t)},_value:function(t,e){var n;""!==t&&null!==(n=this._parse(t))&&(e||(n=this._adjustValue(n)),t=this._format(n)),this.element.val(t),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:g(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:g(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:g(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:g(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){if(!arguments.length)return this._parse(this.element.val());g(this._value).call(this,t)},widget:function(){return this.uiSpinner}}),!1!==x.uiBackCompat&&x.widget("ui.spinner",x.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),x.ui.spinner};"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(l){function e(t){var e,n=t||window.event,r=g.call(arguments,1),i=0,o=0,s=0,a=0,u=0,c=0;if((t=l.event.fix(n)).type="mousewheel","detail"in n&&(s=-1*n.detail),"wheelDelta"in n&&(s=n.wheelDelta),"wheelDeltaY"in n&&(s=n.wheelDeltaY),"wheelDeltaX"in n&&(o=-1*n.wheelDeltaX),"axis"in n&&n.axis===n.HORIZONTAL_AXIS&&(o=-1*s,s=0),i=0===s?o:s,"deltaY"in n&&(i=s=-1*n.deltaY),"deltaX"in n&&(o=n.deltaX,0===s&&(i=-1*o)),0!==s||0!==o){1===n.deltaMode?(i*=e=l.data(this,"mousewheel-line-height"),s*=e,o*=e):2===n.deltaMode&&(i*=e=l.data(this,"mousewheel-page-height"),s*=e,o*=e);var a=Math.max(Math.abs(s),Math.abs(o));return d&&!(a<d)||f(n,d=a)&&(d/=40),f(n,a)&&(i/=40,o/=40,s/=40),i=Math[1<=i?"floor":"ceil"](i/d),o=Math[1<=o?"floor":"ceil"](o/d),s=Math[1<=s?"floor":"ceil"](s/d),m.settings.normalizeOffset&&this.getBoundingClientRect&&(a=this.getBoundingClientRect(),u=t.clientX-a.left,c=t.clientY-a.top),t.deltaX=o,t.deltaY=s,t.deltaFactor=d,t.offsetX=u,t.offsetY=c,t.deltaMode=0,r.unshift(t,i,o,s),p&&clearTimeout(p),p=setTimeout(h,200),(l.event.dispatch||l.event.handle).apply(this,r)}}function h(){d=null}function f(t,e){return m.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}var p,d,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],n="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],g=Array.prototype.slice;if(l.event.fixHooks)for(var r=t.length;r;)l.event.fixHooks[t[--r]]=l.event.mouseHooks;var m=l.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=n.length;t;)this.addEventListener(n[--t],e,!1);else this.onmousewheel=e;l.data(this,"mousewheel-line-height",m.getLineHeight(this)),l.data(this,"mousewheel-page-height",m.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=n.length;t;)this.removeEventListener(n[--t],e,!1);else this.onmousewheel=null;l.removeData(this,"mousewheel-line-height"),l.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var e=l(t),t=e["offsetParent"in l.fn?"offsetParent":"parent"]();return t.length||(t=l("body")),parseInt(t.css("fontSize"),10)||parseInt(e.css("fontSize"),10)||16},getPageHeight:function(t){return l(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};l.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}),function(t){var e;"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.html2canvas=t())}(function(){return function r(i,o,s){function a(n,t){if(!o[n]){if(!i[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(u)return u(n,!0);e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}e=o[n]={exports:{}};i[n][0].call(e.exports,function(t){var e=i[n][1][t];return a(e||t)},e,e.exports,r,i,o,s)}return o[n].exports}for(var u="function"==typeof require&&require,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(t,P,D){(function(j){!function(t){function v(t){throw RangeError(g[t])}function n(t,e){for(var n=t.length;n--;)t[n]=e(t[n]);return t}function e(t,e){return n(t.split(p),e).join(".")}function y(t){for(var e,n,r=[],i=0,o=t.length;i<o;)55296<=(e=t.charCodeAt(i++))&&e<=56319&&i<o?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function d(t){return n(t,function(t){var e="";return 65535<t&&(e+=A((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+A(t)}).join("")}function b(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function w(t,e,n){var r=0;for(t=n?T(t/l):t>>1,t+=T(t/e);m*k>>1<t;r+=x)t=T(t/m);return T(r+(m+1)*t/(t+c))}function r(t){var e,n,r,i,o,s,a,u=[],c=t.length,l=0,h=O,f=S,p=t.lastIndexOf(E);for(p<0&&(p=0),n=0;n<p;++n)128<=t.charCodeAt(n)&&v("not-basic"),u.push(t.charCodeAt(n));for(r=0<p?p+1:0;r<c;){for(i=l,o=1,s=x;c<=r&&v("invalid-input"),a=t.charCodeAt(r++),(x<=(a=a-48<10?a-22:a-65<26?a-65:a-97<26?a-97:x)||a>T((_-l)/o))&&v("overflow"),l+=a*o,!(a<(a=s<=f?C:f+k<=s?k:s-f));s+=x)o>T(_/(a=x-a))&&v("overflow"),o*=a;f=w(l-i,e=u.length+1,0==i),T(l/e)>_-h&&v("overflow"),h+=T(l/e),l%=e,u.splice(l++,0,h)}return d(u)}function i(t){for(var e,n,r,i,o,s,a,u,c,l,h,f=[],p=(t=y(t)).length,d=O,g=S,m=e=0;m<p;++m)(u=t[m])<128&&f.push(A(u));for(n=r=f.length,r&&f.push(E);n<p;){for(i=_,m=0;m<p;++m)d<=(u=t[m])&&u<i&&(i=u);for(i-d>T((_-e)/(c=n+1))&&v("overflow"),e+=(i-d)*c,d=i,m=0;m<p;++m)if((u=t[m])<d&&++e>_&&v("overflow"),u==d){for(o=e,s=x;!(o<(a=s<=g?C:g+k<=s?k:s-g));s+=x)h=o-a,l=x-a,f.push(A(b(a+h%l,0))),o=T(h/l);f.push(A(b(o,0))),g=w(e,c,n==r),e=0,++n}++e,++d}return f.join("")}var o="object"==typeof D&&D,s="object"==typeof P&&P&&P.exports==o&&P,a="object"==typeof j&&j;a.global!==a&&a.window!==a||(t=a);var u,_=2147483647,x=36,C=1,k=26,c=38,l=700,S=72,O=128,E="-",h=/^xn--/,f=/[^ -~]/,p=/\x2E|\u3002|\uFF0E|\uFF61/g,g={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=x-C,T=Math.floor,A=String.fromCharCode,I={version:"1.2.4",ucs2:{decode:y,encode:d},decode:r,encode:i,toASCII:function(t){return e(t,function(t){return f.test(t)?"xn--"+i(t):t})},toUnicode:function(t){return e(t,function(t){return h.test(t)?r(t.slice(4).toLowerCase()):t})}};if(0,o&&!o.nodeType)if(s)s.exports=I;else for(u in I)I.hasOwnProperty(u)&&(o[u]=I[u]);else t.punycode=I}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e){function i(t,e){for(var n=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),r=t.firstChild;r;)!0!==e&&1===r.nodeType&&"SCRIPT"===r.nodeName||n.appendChild(i(r,e)),r=r.nextSibling;return 1===t.nodeType&&(n._scrollTop=t.scrollTop,n._scrollLeft=t.scrollLeft,"CANVAS"===t.nodeName?function(e,t){try{t&&(t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e.getContext("2d").getImageData(0,0,e.width,e.height),0,0))}catch(t){o("Unable to copy canvas content from",e,t)}}(t,n):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(n.value=t.value)),n}var o=t("./log");e.exports=function(o,t,e,n,s,a,u){var c=i(o.documentElement,s.javascriptEnabled),l=t.createElement("iframe");return l.className="html2canvas-container",l.style.visibility="hidden",l.style.position="fixed",l.style.left="-10000px",l.style.top="0px",l.style.border="0",l.width=e,l.height=n,l.scrolling="no",t.body.appendChild(l),new Promise(function(e){var t,n,r,i=l.contentWindow.document;l.contentWindow.onload=l.onload=function(){var t=setInterval(function(){0<i.body.childNodes.length&&(function t(e){if(1===e.nodeType){e.scrollTop=e._scrollTop,e.scrollLeft=e._scrollLeft;for(var n=e.firstChild;n;)t(n),n=n.nextSibling}}(i.documentElement),clearInterval(t),"view"===s.type&&(l.contentWindow.scrollTo(a,u),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||l.contentWindow.scrollY===u&&l.contentWindow.scrollX===a||(i.documentElement.style.top=-u+"px",i.documentElement.style.left=-a+"px",i.documentElement.style.position="absolute")),e(l))},50)},i.open(),i.write("<!DOCTYPE html><html></html>"),n=a,r=u,!(t=o).defaultView||n===t.defaultView.pageXOffset&&r===t.defaultView.pageYOffset||t.defaultView.scrollTo(n,r),i.replaceChild(i.adoptNode(c),i.documentElement),i.close()})}},{"./log":13}],3:[function(t,e){function n(t){this.r=0,this.g=0,this.b=0,this.a=null,this.fromArray(t)||this.namedColor(t)||this.rgb(t)||this.rgba(t)||this.hex6(t)||this.hex3(t)}n.prototype.darken=function(t){t=1-t;return new n([Math.round(this.r*t),Math.round(this.g*t),Math.round(this.b*t),this.a])},n.prototype.isTransparent=function(){return 0===this.a},n.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},n.prototype.fromArray=function(t){return Array.isArray(t)&&(this.r=Math.min(t[0],255),this.g=Math.min(t[1],255),this.b=Math.min(t[2],255),3<t.length&&(this.a=t[3])),Array.isArray(t)};var r=/^#([a-f0-9]{3})$/i;n.prototype.hex3=function(t){var e;return null!==(e=t.match(r))&&(this.r=parseInt(e[1][0]+e[1][0],16),this.g=parseInt(e[1][1]+e[1][1],16),this.b=parseInt(e[1][2]+e[1][2],16)),null!==e};var i=/^#([a-f0-9]{6})$/i;n.prototype.hex6=function(t){var e=null;return null!==(e=t.match(i))&&(this.r=parseInt(e[1].substring(0,2),16),this.g=parseInt(e[1].substring(2,4),16),this.b=parseInt(e[1].substring(4,6),16)),null!==e};var o=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;n.prototype.rgb=function(t){var e;return null!==(e=t.match(o))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3])),null!==e};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;n.prototype.rgba=function(t){var e;return null!==(e=t.match(s))&&(this.r=Number(e[1]),this.g=Number(e[2]),this.b=Number(e[3]),this.a=Number(e[4])),null!==e},n.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},n.prototype.namedColor=function(t){t=t.toLowerCase();var e=a[t];if(e)this.r=e[0],this.g=e[1],this.b=e[2];else if("transparent"===t)return!(this.r=this.g=this.b=this.a=0);return!!e},n.prototype.isColor=!0;var a={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};e.exports=n},{}],4:[function(t,e){function n(t,e){var n,r,i=C++;if((e=e||{}).logging&&(y.options.logging=!0,y.options.start=Date.now()),e.async=void 0===e.async||e.async,e.allowTaint=void 0!==e.allowTaint&&e.allowTaint,e.removeContainer=void 0===e.removeContainer||e.removeContainer,e.javascriptEnabled=void 0!==e.javascriptEnabled&&e.javascriptEnabled,e.imageTimeout=void 0===e.imageTimeout?1e4:e.imageTimeout,e.renderer="function"==typeof e.renderer?e.renderer:g,e.strict=!!e.strict,"string"==typeof t){if("string"!=typeof e.proxy)return Promise.reject("Proxy must be used when rendering url");var o=null!=e.width?e.width:window.innerWidth,s=null!=e.height?e.height:window.innerHeight;return w((n=t,(r=document.createElement("a")).href=n,r.href=r.href,r),e.proxy,document,o,s,e).then(function(t){return f(t.contentWindow.document.documentElement,t,e,o,s)})}var a,u,c,l,h,t=(void 0===t?[document.documentElement]:t.length?t:[t])[0];return t.setAttribute(x+i,i),a=t.ownerDocument,u=e,c=t.ownerDocument.defaultView.innerWidth,l=t.ownerDocument.defaultView.innerHeight,h=i,b(a,a,c,l,u,a.defaultView.pageXOffset,a.defaultView.pageYOffset).then(function(t){y("Document cloned");var e=x+h,n="["+e+"='"+h+"']";a.querySelector(n).removeAttribute(e);var e=t.contentWindow,r=e.document.querySelector(n);return Promise.resolve("function"!=typeof u.onclone||u.onclone(e.document)).then(function(){return f(r,t,u,c,l)})}).then(function(t){return"function"==typeof e.onrendered&&(y("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),e.onrendered(t)),t})}function f(n,r,i,t,e){var o,s,a=r.contentWindow,u=new d(a.document),c=new m(i,u),l=_(n),s="view"===i.type?t:(s=a.document,Math.max(Math.max(s.body.scrollWidth,s.documentElement.scrollWidth),Math.max(s.body.offsetWidth,s.documentElement.offsetWidth),Math.max(s.body.clientWidth,s.documentElement.clientWidth))),o="view"===i.type?e:(o=a.document,Math.max(Math.max(o.body.scrollHeight,o.documentElement.scrollHeight),Math.max(o.body.offsetHeight,o.documentElement.offsetHeight),Math.max(o.body.clientHeight,o.documentElement.clientHeight))),h=new i.renderer(s,o,c,i,document);return new v(n,h,u,c,i).ready.then(function(){var t,e;return y("Finished rendering"),t="view"===i.type?p(h.canvas,{width:h.canvas.width,height:h.canvas.height,top:0,left:0,x:0,y:0}):n===a.document.body||n===a.document.documentElement||null!=i.canvas?h.canvas:p(h.canvas,{width:(null!=i.width?i:l).width,height:(null!=i.height?i:l).height,top:l.top,left:l.left,x:0,y:0}),e=r,i.removeContainer&&(e.parentNode.removeChild(e),y("Cleaned up container")),t})}function p(t,e){var n=document.createElement("canvas"),r=Math.min(t.width-1,Math.max(0,e.left)),i=Math.min(t.width,Math.max(1,e.left+e.width)),o=Math.min(t.height-1,Math.max(0,e.top)),s=Math.min(t.height,Math.max(1,e.top+e.height));n.width=e.width,n.height=e.height;i-=r,s-=o;return y("Cropping canvas at:","left:",e.left,"top:",e.top,"width:",i,"height:",s),y("Resulting crop with width",e.width,"and height",e.height,"with x",r,"and y",o),n.getContext("2d").drawImage(t,r,o,i,s,e.x,e.y,i,s),n}var d=t("./support"),g=t("./renderers/canvas"),m=t("./imageloader"),v=t("./nodeparser"),r=t("./nodecontainer"),y=t("./log"),i=t("./utils"),b=t("./clone"),w=t("./proxy").loadUrlDocument,_=i.getBounds,x="data-html2canvas-node",C=0;n.CanvasRenderer=g,n.NodeContainer=r,n.log=y,n.utils=i;i="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return Promise.reject("No canvas support")}:n;e.exports=i},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(t,e){function r(t){var n;this.src=t,i("DummyImageContainer for",t),this.promise&&this.image||(i("Initiating DummyImageContainer"),r.prototype.image=new Image,n=this.image,r.prototype.promise=new Promise(function(t,e){n.onload=t,n.onerror=e,n.src=o(),!0===n.complete&&t(n)}))}var i=t("./log"),o=t("./utils").smallImage;e.exports=r},{"./log":13,"./utils":26}],6:[function(t,e){var s=t("./utils").smallImage;e.exports=function(t,e){var n=document.createElement("div"),r=document.createElement("img"),i=document.createElement("span"),o="Hidden Text";n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=e,n.style.margin=0,n.style.padding=0,document.body.appendChild(n),r.src=s(),r.width=1,r.height=1,r.style.margin=0,r.style.padding=0,r.style.verticalAlign="baseline",i.style.fontFamily=t,i.style.fontSize=e,i.style.margin=0,i.style.padding=0,i.appendChild(document.createTextNode(o)),n.appendChild(i),n.appendChild(r),e=r.offsetTop-i.offsetTop+1,n.removeChild(i),n.appendChild(document.createTextNode(o)),n.style.lineHeight="normal",r.style.verticalAlign="super",r=r.offsetTop-n.offsetTop+1,document.body.removeChild(n),this.baseline=e,this.lineWidth=1,this.middle=r}},{"./utils":26}],7:[function(t,e){function n(){this.data={}}var r=t("./font");n.prototype.getMetrics=function(t,e){return void 0===this.data[t+"-"+e]&&(this.data[t+"-"+e]=new r(t,e)),this.data[t+"-"+e]},e.exports=n},{"./font":6}],8:[function(o,t){function e(e,t,n){this.image=null,this.src=e;var r=this,i=s(e);this.promise=(t?new Promise(function(t){"about:blank"===e.contentWindow.document.URL||null==e.contentWindow.document.documentElement?e.contentWindow.onload=e.onload=function(){t(e)}:t(e)}):this.proxyLoad(n.proxy,i,n)).then(function(t){return o("./core")(t.contentWindow.document.documentElement,{type:"view",width:t.width,height:t.height,proxy:n.proxy,javascriptEnabled:n.javascriptEnabled,removeContainer:n.removeContainer,allowTaint:n.allowTaint,imageTimeout:n.imageTimeout/2})}).then(function(t){return r.image=t})}var s=o("./utils").getBounds,i=o("./proxy").loadUrlDocument;e.prototype.proxyLoad=function(t,e,n){var r=this.src;return i(r.src,t,r.ownerDocument,e.width,e.height,n)},t.exports=e},{"./core":4,"./proxy":16,"./utils":26}],9:[function(t,e){function n(t){this.src=t.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=Promise.resolve(!0)}n.TYPES={LINEAR:1,RADIAL:2},n.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,e.exports=n},{}],10:[function(t,e){e.exports=function(n,r){this.src=n,this.image=new Image;var i=this;this.tainted=null,this.promise=new Promise(function(t,e){i.image.onload=t,i.image.onerror=e,r&&(i.image.crossOrigin="anonymous"),i.image.src=n,!0===i.image.complete&&t(i.image)})}},{}],11:[function(t,e){function n(t,e){this.link=null,this.options=t,this.support=e,this.origin=this.getOrigin(window.location.href)}var o=t("./log"),r=t("./imagecontainer"),i=t("./dummyimagecontainer"),s=t("./proxyimagecontainer"),a=t("./framecontainer"),u=t("./svgcontainer"),c=t("./svgnodecontainer"),l=t("./lineargradientcontainer"),h=t("./webkitgradientcontainer"),f=t("./utils").bind;n.prototype.findImages=function(t){var e=[];return t.reduce(function(t,e){switch(e.node.nodeName){case"IMG":return t.concat([{args:[e.node.src],method:"url"}]);case"svg":case"IFRAME":return t.concat([{args:[e.node],method:e.node.nodeName}])}return t},[]).forEach(this.addImage(e,this.loadImage),this),e},n.prototype.findBackgroundImage=function(t,e){return e.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(t,this.loadImage),this),t},n.prototype.addImage=function(n,r){return function(e){e.args.forEach(function(t){this.imageExists(n,t)||(n.splice(0,0,r.call(this,e)),o("Added image #"+n.length,"string"==typeof t?t.substring(0,100):t))},this)}},n.prototype.hasImageBackground=function(t){return"none"!==t.method},n.prototype.loadImage=function(t){if("url"!==t.method)return"linear-gradient"===t.method?new l(t):"gradient"===t.method?new h(t):"svg"===t.method?new c(t.args[0],this.support.svg):"IFRAME"===t.method?new a(t.args[0],this.isSameOrigin(t.args[0].src),this.options):new i(t);t=t.args[0];return!this.isSVG(t)||this.support.svg||this.options.allowTaint?t.match(/data:image\/.*;base64,/i)?new r(t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(t)||!0===this.options.allowTaint||this.isSVG(t)?new r(t,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new r(t,!0):this.options.proxy?new s(t,this.options.proxy):new i(t):new u(t)},n.prototype.isSVG=function(t){return"svg"===t.substring(t.length-3).toLowerCase()||u.prototype.isInline(t)},n.prototype.imageExists=function(t,e){return t.some(function(t){return t.src===e})},n.prototype.isSameOrigin=function(t){return this.getOrigin(t)===this.origin},n.prototype.getOrigin=function(t){var e=this.link||(this.link=document.createElement("a"));return e.href=t,e.href=e.href,e.protocol+e.hostname+e.port},n.prototype.getPromise=function(e){return this.timeout(e,this.options.imageTimeout).catch(function(){return new i(e.src).promise.then(function(t){e.image=t})})},n.prototype.get=function(e){var n=null;return this.images.some(function(t){return(n=t).src===e})?n:null},n.prototype.fetch=function(t){return this.images=t.reduce(f(this.findBackgroundImage,this),this.findImages(t)),this.images.forEach(function(e,n){e.promise.then(function(){o("Succesfully loaded image #"+(n+1),e)},function(t){o("Failed loading image #"+(n+1),e,t)})}),this.ready=Promise.all(this.images.map(this.getPromise,this)),o("Finished searching images"),this},n.prototype.timeout=function(n,r){var i,t=Promise.race([n.promise,new Promise(function(t,e){i=setTimeout(function(){o("Timed out loading image",n),e(n)},r)})]).then(function(t){return clearTimeout(i),t});return t.catch(function(){clearTimeout(i)}),t},e.exports=n},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(t,e){function n(t){r.apply(this,arguments),this.type=r.TYPES.LINEAR;var e=n.REGEXP_DIRECTION.test(t.args[0])||!r.REGEXP_COLORSTOP.test(t.args[0]);e?t.args[0].split(/\s+/).reverse().forEach(function(t,e){switch(t){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var n=this.y0,r=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=r,this.y1=n;break;case"center":break;default:n=.01*parseFloat(t,10);if(isNaN(n))break;0===e?(this.y0=n,this.y1=1-this.y0):(this.x0=n,this.x1=1-this.x0)}},this):(this.y0=0,this.y1=1),this.colorStops=t.args.slice(e?1:0).map(function(t){var e=t.match(r.REGEXP_COLORSTOP),n=+e[2],t=0==n?"%":e[3];return{color:new i(e[1]),stop:"%"===t?n/100:null}}),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(n,r){null===n.stop&&this.colorStops.slice(r).some(function(t,e){return null!==t.stop&&(n.stop=(t.stop-this.colorStops[r-1].stop)/(e+1)+this.colorStops[r-1].stop,!0)},this)},this)}var r=t("./gradientcontainer"),i=t("./color");n.prototype=Object.create(r.prototype),n.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,e.exports=n},{"./color":3,"./gradientcontainer":9}],13:[function(t,e){var n=function(){n.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-n.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};n.options={logging:!1},e.exports=n},{}],14:[function(t,e){function n(t,e){this.node=t,this.parent=e,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function s(t){return-1!==t.toString().indexOf("%")}function r(t){return t.replace("px","")}function i(t){return parseFloat(t)}var o=t("./color"),t=t("./utils"),a=t.getBounds,u=t.parseBackgrounds,c=t.offsetBounds;n.prototype.cloneTo=function(t){t.visible=this.visible,t.borders=this.borders,t.bounds=this.bounds,t.clip=this.clip,t.backgroundClip=this.backgroundClip,t.computedStyles=this.computedStyles,t.styles=this.styles,t.backgroundImages=this.backgroundImages,t.opacity=this.opacity},n.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},n.prototype.assignStack=function(t){(this.stack=t).children.push(this)},n.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},n.prototype.css=function(t){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[t]||(this.styles[t]=this.computedStyles[t])},n.prototype.prefixedCss=function(e){var n=this.css(e);return void 0===n&&["webkit","moz","ms","o"].some(function(t){return void 0!==(n=this.css(t+e.substr(0,1).toUpperCase()+e.substr(1)))},this),void 0===n?null:n},n.prototype.computedStyle=function(t){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,t)},n.prototype.cssInt=function(t){t=parseInt(this.css(t),10);return isNaN(t)?0:t},n.prototype.color=function(t){return this.colors[t]||(this.colors[t]=new o(this.css(t)))},n.prototype.cssFloat=function(t){t=parseFloat(this.css(t));return isNaN(t)?0:t},n.prototype.fontWeight=function(){var t=this.css("fontWeight");switch(parseInt(t,10)){case 401:t="bold";break;case 400:t="normal"}return t},n.prototype.parseClip=function(){var t=this.css("clip").match(this.CLIP);return t?{top:parseInt(t[1],10),right:parseInt(t[2],10),bottom:parseInt(t[3],10),left:parseInt(t[4],10)}:null},n.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=u(this.css("backgroundImage")))},n.prototype.cssList=function(t,e){t=(this.css(t)||"").split(",");return 1===(t=(t=t[e||0]||t[0]||"auto").trim().split(" ")).length&&(t=[t[0],s(t[0])?"auto":t[0]]),t},n.prototype.parseBackgroundSize=function(t,e,n){var r,i=this.cssList("backgroundSize",n);if(s(i[0]))r=t.width*parseFloat(i[0])/100;else{if(/contain|cover/.test(i[0])){var o=t.width/t.height,n=e.width/e.height;return o<n^"contain"===i[0]?{width:t.height*n,height:t.height}:{width:t.width,height:t.width/n}}r=parseInt(i[0],10)}return t="auto"===i[0]&&"auto"===i[1]?e.height:"auto"===i[1]?r/e.width*e.height:s(i[1])?t.height*parseFloat(i[1])/100:parseInt(i[1],10),"auto"===i[0]&&(r=t/e.height*e.width),{width:r,height:t}},n.prototype.parseBackgroundPosition=function(t,e,n,r){var i=this.cssList("backgroundPosition",n),n=s(i[0])?(t.width-(r||e).width)*(parseFloat(i[0])/100):parseInt(i[0],10),r="auto"===i[1]?n/e.width*e.height:s(i[1])?(t.height-(r||e).height)*parseFloat(i[1])/100:parseInt(i[1],10);return"auto"===i[0]&&(n=r/e.height*e.width),{left:n,top:r}},n.prototype.parseBackgroundRepeat=function(t){return this.cssList("backgroundRepeat",t)[0]},n.prototype.parseTextShadows=function(){var t=this.css("textShadow"),e=[];if(t&&"none"!==t)for(var n=t.match(this.TEXT_SHADOW_PROPERTY),r=0;n&&r<n.length;r++){var i=n[r].match(this.TEXT_SHADOW_VALUES);e.push({color:new o(i[0]),offsetX:i[1]?parseFloat(i[1].replace("px","")):0,offsetY:i[2]?parseFloat(i[2].replace("px","")):0,blur:i[3]?i[3].replace("px",""):0})}return e},n.prototype.parseTransform=function(){var t,e;return this.transformData||(this.hasTransform()?(t=this.parseBounds(),(e=this.prefixedCss("transformOrigin").split(" ").map(r).map(i))[0]+=t.left,e[1]+=t.top,this.transformData={origin:e,matrix:this.parseTransformMatrix()}):this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]}),this.transformData},n.prototype.parseTransformMatrix=function(){var t;return this.transformMatrix||(t=(t=this.prefixedCss("transform"))?function(t){if(t&&"matrix"===t[1])return t[2].split(",").map(function(t){return parseFloat(t.trim())});if(t&&"matrix3d"===t[1]){t=t[2].split(",").map(function(t){return parseFloat(t.trim())});return[t[0],t[1],t[4],t[5],t[12],t[13]]}}(t.match(this.MATRIX_PROPERTY)):null,this.transformMatrix=t||[1,0,0,1,0,0]),this.transformMatrix},n.prototype.parseBounds=function(){return this.bounds||(this.bounds=(this.hasTransform()?c:a)(this.node))},n.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},n.prototype.getValue=function(){var t,e=this.node.value||"";return"SELECT"===this.node.tagName?e=(t=(t=this.node).options[t.selectedIndex||0])&&t.text||"":"password"===this.node.type&&(e=Array(e.length+1).join("")),0===e.length?this.node.placeholder||"":e},n.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,n.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,n.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,n.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,e.exports=n},{"./color":3,"./utils":26}],15:[function(t,e){function n(t,e,n,r,i){T("Starting NodeParser"),this.renderer=e,this.options=i,this.range=null,this.support=n,this.renderQueue=[],this.stack=new R(!0,1,t.ownerDocument,null);var o=new I(t,null);i.background&&e.rectangle(0,0,e.width,e.height,new N(i.background)),t===t.ownerDocument.documentElement&&(n=new I(o.color("backgroundColor").isTransparent()?t.ownerDocument.body:t.ownerDocument.documentElement,null),e.rectangle(0,0,e.width,e.height,n.color("backgroundColor"))),o.visibile=o.isElementVisible(),this.createPseudoHideStyles(t.ownerDocument),this.disableAnimations(t.ownerDocument),this.nodes=E([o].concat(this.getChildren(o)).filter(function(t){return t.visible=t.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new D,T("Fetched nodes, total:",this.nodes.length),T("Calculate overflow clips"),this.calculateOverflowClips(),T("Start fetching images"),this.images=r.fetch(this.nodes.filter(x)),this.ready=this.images.ready.then(M(function(){return T("Images loaded, starting parsing"),T("Creating stacking contexts"),this.createStackingContexts(),T("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),T("Render queue created with "+this.renderQueue.length+" items"),new Promise(M(function(t){i.async?"function"==typeof i.async?i.async.call(this,this.renderQueue,t):0<this.renderQueue.length?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,t)):t():(this.renderQueue.forEach(this.paint,this),t())},this))},this))}function r(t){return t.parent&&t.parent.clip.length}function a(){}function u(s,a,u,c){return s.map(function(t,e){if(0<t.width){var n=a.left,r=a.top,i=a.width,o=a.height-s[2].width;switch(e){case 0:o=s[0].width,t.args=h({c1:[n,r],c2:[n+i,r],c3:[n+i-s[1].width,r+o],c4:[n+s[3].width,r+o]},c[0],c[1],u.topLeftOuter,u.topLeftInner,u.topRightOuter,u.topRightInner);break;case 1:n=a.left+a.width-s[1].width,i=s[1].width,t.args=h({c1:[n+i,r],c2:[n+i,r+o+s[2].width],c3:[n,r+o],c4:[n,r+s[0].width]},c[1],c[2],u.topRightOuter,u.topRightInner,u.bottomRightOuter,u.bottomRightInner);break;case 2:r=r+a.height-s[2].width,o=s[2].width,t.args=h({c1:[n+i,r+o],c2:[n,r+o],c3:[n+s[3].width,r],c4:[n+i-s[3].width,r]},c[2],c[3],u.bottomRightOuter,u.bottomRightInner,u.bottomLeftOuter,u.bottomLeftInner);break;case 3:i=s[3].width,t.args=h({c1:[n,r+o+s[2].width],c2:[n,r],c3:[n+i,r+s[0].width],c4:[n+i,r+o]},c[3],c[0],u.bottomLeftOuter,u.bottomLeftInner,u.topLeftOuter,u.topLeftInner)}}return t})}function v(t,e,n,r){var i=(Math.sqrt(2)-1)/3*4,o=n*i,i=r*i,n=t+n,r=e+r;return{topLeft:l({x:t,y:r},{x:t,y:r-i},{x:n-o,y:e},{x:n,y:e}),topRight:l({x:t,y:e},{x:t+o,y:e},{x:n,y:r-i},{x:n,y:r}),bottomRight:l({x:n,y:e},{x:n,y:e+i},{x:t+o,y:r},{x:t,y:r}),bottomLeft:l({x:n,y:r},{x:n-o,y:r},{x:t,y:e+i},{x:t,y:e})}}function c(t,e,n){var r=t.left,i=t.top,o=t.width,s=t.height,a=e[0][0]<o/2?e[0][0]:o/2,u=e[0][1]<s/2?e[0][1]:s/2,c=e[1][0]<o/2?e[1][0]:o/2,l=e[1][1]<s/2?e[1][1]:s/2,h=e[2][0]<o/2?e[2][0]:o/2,f=e[2][1]<s/2?e[2][1]:s/2,p=e[3][0]<o/2?e[3][0]:o/2,d=e[3][1]<s/2?e[3][1]:s/2,g=o-c,m=s-f,t=o-h,e=s-d;return{topLeftOuter:v(r,i,a,u).topLeft.subdivide(.5),topLeftInner:v(r+n[3].width,i+n[0].width,Math.max(0,a-n[3].width),Math.max(0,u-n[0].width)).topLeft.subdivide(.5),topRightOuter:v(r+g,i,c,l).topRight.subdivide(.5),topRightInner:v(r+Math.min(g,o+n[3].width),i+n[0].width,g>o+n[3].width?0:c-n[3].width,l-n[0].width).topRight.subdivide(.5),bottomRightOuter:v(r+t,i+m,h,f).bottomRight.subdivide(.5),bottomRightInner:v(r+Math.min(t,o-n[3].width),i+Math.min(m,s+n[0].width),Math.max(0,h-n[1].width),f-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:v(r,i+e,p,d).bottomLeft.subdivide(.5),bottomLeftInner:v(r+n[3].width,i+e,Math.max(0,p-n[3].width),d-n[2].width).bottomLeft.subdivide(.5)}}function l(o,s,a,u){function c(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}}return{start:o,startControl:s,endControl:a,end:u,subdivide:function(t){var e=c(o,s,t),n=c(s,a,t),r=c(a,u,t),i=c(e,n,t),n=c(n,r,t),t=c(i,n,t);return[l(o,e,i,t),l(t,n,r,u)]},curveTo:function(t){t.push(["bezierCurve",s.x,s.y,a.x,a.y,u.x,u.y])},curveToReversed:function(t){t.push(["bezierCurve",a.x,a.y,s.x,s.y,o.x,o.y])}}}function h(t,e,n,r,i,o,s){var a=[];return 0<e[0]||0<e[1]?(a.push(["line",r[1].start.x,r[1].start.y]),r[1].curveTo(a)):a.push(["line",t.c1[0],t.c1[1]]),0<n[0]||0<n[1]?(a.push(["line",o[0].start.x,o[0].start.y]),o[0].curveTo(a),a.push(["line",s[0].end.x,s[0].end.y]),s[0].curveToReversed(a)):(a.push(["line",t.c2[0],t.c2[1]]),a.push(["line",t.c3[0],t.c3[1]])),0<e[0]||0<e[1]?(a.push(["line",i[1].end.x,i[1].end.y]),i[1].curveToReversed(a)):a.push(["line",t.c4[0],t.c4[1]]),a}function s(t,e,n,r,i,o,s){0<e[0]||0<e[1]?(t.push(["line",r[0].start.x,r[0].start.y]),r[0].curveTo(t),r[1].curveTo(t)):t.push(["line",o,s]),(0<n[0]||0<n[1])&&t.push(["line",i[0].start.x,i[0].start.y])}function f(t){return t.cssInt("zIndex")<0}function p(t){return 0<t.cssInt("zIndex")}function d(t){return 0===t.cssInt("zIndex")}function g(t){return-1!==["inline","inline-block","inline-table"].indexOf(t.css("display"))}function m(t){return t instanceof R}function y(t){return 0<t.node.data.trim().length}function i(t){return t.nodeType===Node.TEXT_NODE||t.nodeType===Node.ELEMENT_NODE}function b(t){return"static"!==t.css("position")}function w(t){return"none"!==t.css("float")}function _(t){var e=this;return function(){return!t.apply(e,arguments)}}function x(t){return t.node.nodeType===Node.ELEMENT_NODE}function o(t){return!0===t.isPseudoElement}function C(t){return t.node.nodeType===Node.TEXT_NODE}function k(t){return parseInt(t,10)}function S(t){return t.width}function O(t){return t.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(t.node.nodeName)}function E(t){return[].concat.apply([],t)}var T=t("./log"),A=t("punycode"),I=t("./nodecontainer"),j=t("./textcontainer"),P=t("./pseudoelementcontainer"),D=t("./fontmetrics"),N=t("./color"),R=t("./stackingcontext"),t=t("./utils"),M=t.bind,W=t.getBounds,L=t.parseBackgrounds,F=t.offsetBounds;n.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(t){var e,n;x(t)?(o(t)&&t.appendToDOM(),t.borders=this.parseBorders(t),e="hidden"===t.css("overflow")?[t.borders.clip]:[],(n=t.parseClip())&&-1!==["absolute","fixed"].indexOf(t.css("position"))&&e.push([["rect",t.bounds.left+n.left,t.bounds.top+n.top,n.right-n.left,n.bottom-n.top]]),t.clip=r(t)?t.parent.clip.concat(e):e,t.backgroundClip="hidden"!==t.css("overflow")?t.clip.concat([t.borders.clip]):t.clip,o(t)&&t.cleanDOM()):C(t)&&(t.clip=r(t)?t.parent.clip:[]),o(t)||(t.bounds=null)},this)},n.prototype.asyncRenderer=function(t,e,n){n=n||Date.now(),this.paint(t[this.renderIndex++]),t.length===this.renderIndex?e():n+20>Date.now()?this.asyncRenderer(t,e,n):setTimeout(M(function(){this.asyncRenderer(t,e)},this),0)},n.prototype.createPseudoHideStyles=function(t){this.createStyles(t,"."+P.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+P.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},n.prototype.disableAnimations=function(t){this.createStyles(t,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},n.prototype.createStyles=function(t,e){var n=t.createElement("style");n.innerHTML=e,t.body.appendChild(n)},n.prototype.getPseudoElements=function(t){var e,n=[[t]];return t.node.nodeType===Node.ELEMENT_NODE&&(e=this.getPseudoElement(t,":before"),t=this.getPseudoElement(t,":after"),e&&n.push(e),t&&n.push(t)),E(n)},n.prototype.getPseudoElement=function(t,e){var n=t.computedStyle(e);if(!n||!n.content||"none"===n.content||"-moz-alt-content"===n.content||"none"===n.display)return null;for(var r,i=(r=n.content,(i=r.substr(0,1))===r.substr(r.length-1)&&i.match(/'|"/)?r.substr(1,r.length-2):r),r="url"===i.substr(0,3),o=document.createElement(r?"img":"html2canvaspseudoelement"),e=new P(o,t,e),s=n.length-1;0<=s;s--){var a=n.item(s).replace(/(\-[a-z])/g,function(t){return t.toUpperCase().replace("-","")});o.style[a]=n[a]}if(o.className=P.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+P.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,r)return o.src=L(i)[0].args[0],[e];var i=document.createTextNode(i);return o.appendChild(i),[e,new j(i,e)]},n.prototype.getChildren=function(n){return E([].filter.call(n.node.childNodes,i).map(function(t){var e=[new(t.nodeType===Node.TEXT_NODE?j:I)(t,n)].filter(O);return t.nodeType===Node.ELEMENT_NODE&&e.length&&"TEXTAREA"!==t.tagName?e[0].isElementVisible()?e.concat(this.getChildren(e[0])):[]:e},this))},n.prototype.newStackingContext=function(t,e){var n=new R(e,t.getOpacity(),t.node,t.parent);t.cloneTo(n),(e?n.getParentStack(this):n.parent.stack).contexts.push(n),t.stack=n},n.prototype.createStackingContexts=function(){this.nodes.forEach(function(t){var e,n;x(t)&&(this.isRootElement(t)||t.getOpacity()<1||(n=(e=t).css("position"),"auto"!==(-1!==["absolute","relative","fixed"].indexOf(n)?e.css("zIndex"):"auto"))||this.isBodyWithTransparentRoot(t)||t.hasTransform())?this.newStackingContext(t,!0):x(t)&&(b(t)&&d(t)||-1!==["inline-block","inline-table"].indexOf(t.css("display"))||w(t))?this.newStackingContext(t,!1):t.assignStack(t.parent.stack)},this)},n.prototype.isBodyWithTransparentRoot=function(t){return"BODY"===t.node.nodeName&&t.parent.color("backgroundColor").isTransparent()},n.prototype.isRootElement=function(t){return null===t.parent},n.prototype.sortStackingContexts=function(t){var n;t.contexts.sort((n=t.contexts.slice(0),function(t,e){return t.cssInt("zIndex")+n.indexOf(t)/n.length-(e.cssInt("zIndex")+n.indexOf(e)/n.length)})),t.contexts.forEach(this.sortStackingContexts,this)},n.prototype.parseTextBounds=function(i){return function(t,e,n){if("none"!==i.parent.css("textDecoration").substr(0,4)||0!==t.trim().length){if(this.support.rangeBounds&&!i.parent.hasTransform()){var r=n.slice(0,e).join("").length;return this.getRangeBounds(i.node,r,t.length)}if(i.node&&"string"==typeof i.node.data){e=i.node.splitText(t.length),r=this.getWrapperBounds(i.node,i.parent.hasTransform());return i.node=e,r}}else this.support.rangeBounds&&!i.parent.hasTransform()||(i.node=i.node.splitText(t.length));return{}}},n.prototype.getWrapperBounds=function(t,e){var n=t.ownerDocument.createElement("html2canvaswrapper"),r=t.parentNode,i=t.cloneNode(!0);n.appendChild(t.cloneNode(!0)),r.replaceChild(n,t);e=(e?F:W)(n);return r.replaceChild(i,n),e},n.prototype.getRangeBounds=function(t,e,n){var r=this.range||(this.range=t.ownerDocument.createRange());return r.setStart(t,e),r.setEnd(t,e+n),r.getBoundingClientRect()},n.prototype.parse=function(t){var e=t.contexts.filter(f),n=t.children.filter(x),r=n.filter(_(w)),i=r.filter(_(b)).filter(_(g)),o=n.filter(_(b)).filter(w),s=r.filter(_(b)).filter(g),n=t.contexts.concat(r.filter(b)).filter(d),r=t.children.filter(C).filter(y),t=t.contexts.filter(p);e.concat(i).concat(o).concat(s).concat(n).concat(r).concat(t).forEach(function(t){this.renderQueue.push(t),m(t)&&(this.parse(t),this.renderQueue.push(new a))},this)},n.prototype.paint=function(t){try{t instanceof a?this.renderer.ctx.restore():C(t)?(o(t.parent)&&t.parent.appendToDOM(),this.paintText(t),o(t.parent)&&t.parent.cleanDOM()):this.paintNode(t)}catch(t){if(T(t),this.options.strict)throw t}},n.prototype.paintNode=function(t){m(t)&&(this.renderer.setOpacity(t.opacity),this.renderer.ctx.save(),t.hasTransform()&&this.renderer.setTransform(t.parseTransform())),"INPUT"===t.node.nodeName&&"checkbox"===t.node.type?this.paintCheckbox(t):"INPUT"===t.node.nodeName&&"radio"===t.node.type?this.paintRadio(t):this.paintElement(t)},n.prototype.paintElement=function(e){var n=e.parseBounds();this.renderer.clip(e.backgroundClip,function(){this.renderer.renderBackground(e,n,e.borders.borders.map(S))},this),this.renderer.clip(e.clip,function(){this.renderer.renderBorders(e.borders.borders)},this),this.renderer.clip(e.backgroundClip,function(){switch(e.node.nodeName){case"svg":case"IFRAME":var t=this.images.get(e.node);t?this.renderer.renderImage(e,n,e.borders,t):T("Error loading <"+e.node.nodeName+">",e.node);break;case"IMG":t=this.images.get(e.node.src);t?this.renderer.renderImage(e,n,e.borders,t):T("Error loading <img>",e.node.src);break;case"CANVAS":this.renderer.renderImage(e,n,e.borders,{image:e.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(e)}},this)},n.prototype.paintCheckbox=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height),r={width:n-1,height:n-1,top:e.top,left:e.left},e=[3,3],i=[e,e,e,e],o=[1,1,1,1].map(function(t){return{color:new N("#A5A5A5"),width:t}}),s=c(r,i,o);this.renderer.clip(t.backgroundClip,function(){this.renderer.rectangle(r.left+1,r.top+1,r.width-2,r.height-2,new N("#DEDEDE")),this.renderer.renderBorders(u(o,r,s,i)),t.node.checked&&(this.renderer.font(new N("#424242"),"normal","normal","bold",n-3+"px","arial"),this.renderer.text("",r.left+n/6,r.top+n-1))},this)},n.prototype.paintRadio=function(t){var e=t.parseBounds(),n=Math.min(e.width,e.height)-2;this.renderer.clip(t.backgroundClip,function(){this.renderer.circleStroke(e.left+1,e.top+1,n,new N("#DEDEDE"),1,new N("#A5A5A5")),t.node.checked&&this.renderer.circle(Math.ceil(e.left+n/4)+1,Math.ceil(e.top+n/4)+1,Math.floor(n/2),new N("#424242"))},this)},n.prototype.paintFormValue=function(e){var t,n,r,i=e.getValue();0<i.length&&(t=e.node.ownerDocument,n=t.createElement("html2canvaswrapper"),["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"].forEach(function(t){try{n.style[t]=e.css(t)}catch(t){T("html2canvas: Parse: Exception caught in renderFormValue: "+t.message)}}),r=e.parseBounds(),n.style.position="fixed",n.style.left=r.left+"px",n.style.top=r.top+"px",n.textContent=i,t.body.appendChild(n),this.paintText(new j(n.firstChild,e)),t.body.removeChild(n))},n.prototype.paintText=function(n){n.applyTextTransform();var t=A.ucs2.decode(n.node.data),r=this.options.letterRendering&&!/^(normal|none|0px)$/.test(n.parent.css("letterSpacing"))||/[^\u0000-\u00ff]/.test(n.node.data)?t.map(function(t){return A.ucs2.encode([t])}):function(t){for(var e,n=[],r=0,i=!1;t.length;)-1!==[32,13,10,9,45].indexOf(t[r])===i?((e=t.splice(0,r)).length&&n.push(A.ucs2.encode(e)),i=!i,r=0):r++,r>=t.length&&((e=t.splice(0,r)).length&&n.push(A.ucs2.encode(e)));return n}(t),e=n.parent.fontWeight(),i=n.parent.css("fontSize"),o=n.parent.css("fontFamily"),t=n.parent.parseTextShadows();this.renderer.font(n.parent.color("color"),n.parent.css("fontStyle"),n.parent.css("fontVariant"),e,i,o),t.length?this.renderer.fontShadow(t[0].color,t[0].offsetX,t[0].offsetY,t[0].blur):this.renderer.clearShadow(),this.renderer.clip(n.parent.clip,function(){r.map(this.parseTextBounds(n),this).forEach(function(t,e){t&&(this.renderer.text(r[e],t.left,t.bottom),this.renderTextDecoration(n.parent,t,this.fontMetrics.getMetrics(o,i)))},this)},this)},n.prototype.renderTextDecoration=function(t,e,n){switch(t.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(e.left,Math.round(e.top+n.baseline+n.lineWidth),e.width,1,t.color("color"));break;case"overline":this.renderer.rectangle(e.left,Math.round(e.top),e.width,1,t.color("color"));break;case"line-through":this.renderer.rectangle(e.left,Math.ceil(e.top+n.middle+n.lineWidth),e.width,1,t.color("color"))}};var H={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};n.prototype.parseBorders=function(i){var e,t=i.parseBounds(),n=(e=i,["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){t=e.css("border"+t+"Radius").split(" ");return t.length<=1&&(t[1]=t[0]),t.map(k)})),r=["Top","Right","Bottom","Left"].map(function(t,e){var n=i.css("border"+t+"Style"),r=i.color("border"+t+"Color");"inset"===n&&r.isBlack()&&(r=new N([255,255,255,r.a]));e=H[n]?H[n][e]:null;return{width:i.cssInt("border"+t+"Width"),color:e?r[e[0]](e[1]):r,args:null}}),o=c(t,n,r);return{clip:this.parseBackgroundClip(i,o,r,n,t),borders:u(r,t,o,n)}},n.prototype.parseBackgroundClip=function(t,e,n,r,i){var o=[];switch(t.css("backgroundClip")){case"content-box":case"padding-box":s(o,r[0],r[1],e.topLeftInner,e.topRightInner,i.left+n[3].width,i.top+n[0].width),s(o,r[1],r[2],e.topRightInner,e.bottomRightInner,i.left+i.width-n[1].width,i.top+n[0].width),s(o,r[2],r[3],e.bottomRightInner,e.bottomLeftInner,i.left+i.width-n[1].width,i.top+i.height-n[2].width),s(o,r[3],r[0],e.bottomLeftInner,e.topLeftInner,i.left+n[3].width,i.top+i.height-n[2].width);break;default:s(o,r[0],r[1],e.topLeftOuter,e.topRightOuter,i.left,i.top),s(o,r[1],r[2],e.topRightOuter,e.bottomRightOuter,i.left+i.width,i.top),s(o,r[2],r[3],e.bottomRightOuter,e.bottomLeftOuter,i.left+i.width,i.top+i.height),s(o,r[3],r[0],e.bottomLeftOuter,e.topLeftOuter,i.left,i.top+i.height)}return o},e.exports=n},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(t,e,n){function a(t,e,n){var r="withCredentials"in new XMLHttpRequest;if(!e)return Promise.reject("No proxy configured");var i=s(r),t=u(e,t,i);return r?c(t):o(n,t,i).then(function(t){return f(t.content)})}function o(i,o,s){return new Promise(function(e,n){function r(){delete window.html2canvas.proxy[s],i.body.removeChild(t)}var t=i.createElement("script");window.html2canvas.proxy[s]=function(t){r(),e(t)},t.src=o,t.onerror=function(t){r(),n(t)},i.body.appendChild(t)})}function s(t){return t?"":"html2canvas_"+Date.now()+"_"+ ++i+"_"+Math.round(1e5*Math.random())}function u(t,e,n){return t+"?url="+encodeURIComponent(e)+(n.length?"&callback=html2canvas.proxy."+n:"")}var c=t("./xhr"),r=t("./utils"),l=t("./log"),h=t("./clone"),f=r.decode64,i=0;n.Proxy=a,n.ProxyURL=function(t,e,n){var r="crossOrigin"in new Image,i=s(r),t=u(e,t,i);return r?Promise.resolve(t):o(n,t,i).then(function(t){return"data:"+t.type+";base64,"+t.content})},n.loadUrlDocument=function(t,e,n,r,i,o){return new a(t,e,window.document).then((s=t,function(e){var n,t=new DOMParser;try{n=t.parseFromString(e,"text/html")}catch(t){l("DOMParser not supported, falling back to createHTMLDocument"),n=document.implementation.createHTMLDocument("");try{n.open(),n.write(e),n.close()}catch(t){l("createHTMLDocument write not supported, falling back to document.body.innerHTML"),n.body.innerHTML=e}}var r=n.querySelector("base");return r&&r.href.host||((r=n.createElement("base")).href=s,n.head.insertBefore(r,n.head.firstChild)),n})).then(function(t){return h(t,n,r,i,o,0,0)});var s}},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(t,e){var o=t("./proxy").ProxyURL;e.exports=function(n,r){var t=document.createElement("a");t.href=n,n=t.href,this.src=n,this.image=new Image;var i=this;this.promise=new Promise(function(t,e){i.image.crossOrigin="Anonymous",i.image.onload=t,i.image.onerror=e,new o(n,r,document).then(function(t){i.image.src=t}).catch(e)})}},{"./proxy":16}],18:[function(t,e){function n(t,e,n){r.call(this,t,e),this.isPseudoElement=!0,this.before=":before"===n}var r=t("./nodecontainer");n.prototype.cloneTo=function(t){n.prototype.cloneTo.call(this,t),t.isPseudoElement=!0,t.before=this.before},(n.prototype=Object.create(r.prototype)).appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},n.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},n.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},n.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",n.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",e.exports=n},{"./nodecontainer":14}],19:[function(t,e){function n(t,e,n,r,i){this.width=t,this.height=e,this.images=n,this.options=r,this.document=i}var a=t("./log");n.prototype.renderImage=function(t,e,n,r){var i=t.cssInt("paddingLeft"),o=t.cssInt("paddingTop"),s=t.cssInt("paddingRight"),t=t.cssInt("paddingBottom"),n=n.borders,s=e.width-(n[1].width+n[3].width+i+s),t=e.height-(n[0].width+n[2].width+o+t);this.drawImage(r,0,0,r.image.width||s,r.image.height||t,e.left+i+n[3].width,e.top+o+n[0].width,s,t)},n.prototype.renderBackground=function(t,e,n){0<e.height&&0<e.width&&(this.renderBackgroundColor(t,e),this.renderBackgroundImage(t,e,n))},n.prototype.renderBackgroundColor=function(t,e){t=t.color("backgroundColor");t.isTransparent()||this.rectangle(e.left,e.top,e.width,e.height,t)},n.prototype.renderBorders=function(t){t.forEach(this.renderBorder,this)},n.prototype.renderBorder=function(t){t.color.isTransparent()||null===t.args||this.drawShape(t.args,t.color)},n.prototype.renderBackgroundImage=function(i,o,s){i.parseBackgroundImages().reverse().forEach(function(t,e,n){switch(t.method){case"url":var r=this.images.get(t.args[0]);r?this.renderBackgroundRepeating(i,o,r,n.length-(e+1),s):a("Error loading background-image",t.args[0]);break;case"linear-gradient":case"gradient":r=this.images.get(t.value);r?this.renderBackgroundGradient(r,o,s):a("Error loading background-image",t.args[0]);break;case"none":break;default:a("Unknown background-image type",t.args[0])}},this)},n.prototype.renderBackgroundRepeating=function(t,e,n,r,i){var o=t.parseBackgroundSize(e,n.image,r),s=t.parseBackgroundPosition(e,n.image,r,o);switch(t.parseBackgroundRepeat(r)){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,s,o,e,e.left+i[3],e.top+s.top+i[0],99999,o.height,i);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,s,o,e,e.left+s.left+i[3],e.top+i[0],o.width,99999,i);break;case"no-repeat":this.backgroundRepeatShape(n,s,o,e,e.left+s.left+i[3],e.top+s.top+i[0],o.width,o.height,i);break;default:this.renderBackgroundRepeat(n,s,o,{top:e.top,left:e.left},i[3],i[0])}},e.exports=n},{"./log":13}],20:[function(t,e){function n(t,e){i.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=t,this.canvas.height=e),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},s("Initialized CanvasRenderer with size",t,"x",e)}function r(t){return 0<t.length}var i=t("../renderer"),o=t("../lineargradientcontainer"),s=t("../log");(n.prototype=Object.create(i.prototype)).setFillStyle=function(t){return this.ctx.fillStyle="object"==typeof t&&t.isColor?t.toString():t,this.ctx},n.prototype.rectangle=function(t,e,n,r,i){this.setFillStyle(i).fillRect(t,e,n,r)},n.prototype.circle=function(t,e,n,r){this.setFillStyle(r),this.ctx.beginPath(),this.ctx.arc(t+n/2,e+n/2,n/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},n.prototype.circleStroke=function(t,e,n,r,i,o){this.circle(t,e,n,r),this.ctx.strokeStyle=o.toString(),this.ctx.stroke()},n.prototype.drawShape=function(t,e){this.shape(t),this.setFillStyle(e).fill()},n.prototype.taints=function(e){if(null===e.tainted){this.taintCtx.drawImage(e.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),e.tainted=!1}catch(t){this.taintCtx=document.createElement("canvas").getContext("2d"),e.tainted=!0}}return e.tainted},n.prototype.drawImage=function(t,e,n,r,i,o,s,a,u){this.taints(t)&&!this.options.allowTaint||this.ctx.drawImage(t.image,e,n,r,i,o,s,a,u)},n.prototype.clip=function(t,e,n){this.ctx.save(),t.filter(r).forEach(function(t){this.shape(t).clip()},this),e.call(n),this.ctx.restore()},n.prototype.shape=function(t){return this.ctx.beginPath(),t.forEach(function(t,e){("rect"===t[0]?this.ctx.rect:this.ctx[0===e?"moveTo":t[0]+"To"]).apply(this.ctx,t.slice(1))},this),this.ctx.closePath(),this.ctx},n.prototype.font=function(t,e,n,r,i,o){this.setFillStyle(t).font=[e,n,r,i,o].join(" ").split(",")[0]},n.prototype.fontShadow=function(t,e,n,r){this.setVariable("shadowColor",t.toString()).setVariable("shadowOffsetY",e).setVariable("shadowOffsetX",n).setVariable("shadowBlur",r)},n.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},n.prototype.setOpacity=function(t){this.ctx.globalAlpha=t},n.prototype.setTransform=function(t){this.ctx.translate(t.origin[0],t.origin[1]),this.ctx.transform.apply(this.ctx,t.matrix),this.ctx.translate(-t.origin[0],-t.origin[1])},n.prototype.setVariable=function(t,e){return this.variables[t]!==e&&(this.variables[t]=this.ctx[t]=e),this},n.prototype.text=function(t,e,n){this.ctx.fillText(t,e,n)},n.prototype.backgroundRepeatShape=function(t,e,n,r,i,o,s,a,u){o=[["line",Math.round(i),Math.round(o)],["line",Math.round(i+s),Math.round(o)],["line",Math.round(i+s),Math.round(a+o)],["line",Math.round(i),Math.round(a+o)]];this.clip([o],function(){this.renderBackgroundRepeat(t,e,n,r,u[3],u[0])},this)},n.prototype.renderBackgroundRepeat=function(t,e,n,r,i,o){i=Math.round(r.left+e.left+i),o=Math.round(r.top+e.top+o);this.setFillStyle(this.ctx.createPattern(this.resizeImage(t,n),"repeat")),this.ctx.translate(i,o),this.ctx.fill(),this.ctx.translate(-i,-o)},n.prototype.renderBackgroundGradient=function(t,e){var n;t instanceof o&&(n=this.ctx.createLinearGradient(e.left+e.width*t.x0,e.top+e.height*t.y0,e.left+e.width*t.x1,e.top+e.height*t.y1),t.colorStops.forEach(function(t){n.addColorStop(t.stop,t.color.toString())}),this.rectangle(e.left,e.top,e.width,e.height,n))},n.prototype.resizeImage=function(t,e){var n=t.image;if(n.width===e.width&&n.height===e.height)return n;t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(n,0,0,n.width,n.height,0,0,e.width,e.height),t},e.exports=n},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(t,e){function n(t,e,n,r){i.call(this,n,r),this.ownStacking=t,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*e}var i=t("./nodecontainer");(n.prototype=Object.create(i.prototype)).getParentStack=function(t){var e=this.parent?this.parent.stack:null;return e?e.ownStacking?e:e.getParentStack(t):t.stack},e.exports=n},{"./nodecontainer":14}],22:[function(t,e){function n(t){this.rangeBounds=this.testRangeBounds(t),this.cors=this.testCORS(),this.svg=this.testSVG()}n.prototype.testRangeBounds=function(t){var e,n,r=!1;return t.createRange&&((e=t.createRange()).getBoundingClientRect&&((n=t.createElement("boundtest")).style.height="123px",n.style.display="block",t.body.appendChild(n),e.selectNode(n),123===e.getBoundingClientRect().height&&(r=!0),t.body.removeChild(n))),r},n.prototype.testCORS=function(){return void 0!==(new Image).crossOrigin},n.prototype.testSVG=function(){var t=new Image,e=document.createElement("canvas"),n=e.getContext("2d");t.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(t,0,0),e.toDataURL()}catch(t){return!1}return!0},e.exports=n},{}],23:[function(t,e){function n(t){this.src=t,this.image=null;var n=this;this.promise=this.hasFabric().then(function(){return n.isInline(t)?Promise.resolve(n.inlineFormatting(t)):r(t)}).then(function(e){return new Promise(function(t){window.html2canvas.svg.fabric.loadSVGFromString(e,n.createCanvas.call(n,t))})})}var r=t("./xhr"),i=t("./utils").decode64;n.prototype.hasFabric=function(){return window.html2canvas.svg&&window.html2canvas.svg.fabric?Promise.resolve():Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},n.prototype.inlineFormatting=function(t){return/^data:image\/svg\+xml;base64,/.test(t)?this.decode64(this.removeContentType(t)):this.removeContentType(t)},n.prototype.removeContentType=function(t){return t.replace(/^data:image\/svg\+xml(;base64)?,/,"")},n.prototype.isInline=function(t){return/^data:image\/svg\+xml/i.test(t)},n.prototype.createCanvas=function(r){var i=this;return function(t,e){var n=new window.html2canvas.svg.fabric.StaticCanvas("c");i.image=n.lowerCanvasEl,n.setWidth(e.width).setHeight(e.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(t,e)).renderAll(),r(n.lowerCanvasEl)}},n.prototype.decode64=function(t){return"function"==typeof window.atob?window.atob(t):i(t)},e.exports=n},{"./utils":26,"./xhr":28}],24:[function(t,e){function n(n,t){this.src=n,this.image=null;var r=this;this.promise=t?new Promise(function(t,e){r.image=new Image,r.image.onload=t,r.image.onerror=e,r.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(n),!0===r.image.complete&&t(r.image)}):this.hasFabric().then(function(){return new Promise(function(t){window.html2canvas.svg.fabric.parseSVGDocument(n,r.createCanvas.call(r,t))})})}t=t("./svgcontainer");n.prototype=Object.create(t.prototype),e.exports=n},{"./svgcontainer":23}],25:[function(t,e){function n(t,e){i.call(this,t,e)}function r(t,e,n){return 0<t.length?e+n.toUpperCase():void 0}var i=t("./nodecontainer");(n.prototype=Object.create(i.prototype)).applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},n.prototype.transform=function(t){var e=this.node.data;switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,r);case"uppercase":return e.toUpperCase();default:return e}},e.exports=n},{"./nodecontainer":14}],26:[function(t,e,n){n.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},n.bind=function(t,e){return function(){return t.apply(e,arguments)}},n.decode64=function(t){for(var e,n,r,i,o,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=t.length,u="",c=0;c<a;c+=4)r=s.indexOf(t[c])<<2|(o=s.indexOf(t[c+1]))>>4,i=(15&o)<<4|(e=s.indexOf(t[c+2]))>>2,o=(3&e)<<6|(n=s.indexOf(t[c+3])),u+=64===e?String.fromCharCode(r):64===n||-1===n?String.fromCharCode(r,i):String.fromCharCode(r,i,o);return u},n.getBounds=function(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect(),n=null==t.offsetWidth?e.width:t.offsetWidth;return{top:e.top,bottom:e.bottom||e.top+e.height,right:e.left+n,left:e.left,width:n,height:null==t.offsetHeight?e.height:t.offsetHeight}}return{}},n.offsetBounds=function(t){var e=t.offsetParent?n.offsetBounds(t.offsetParent):{top:0,left:0};return{top:t.offsetTop+e.top,bottom:t.offsetTop+t.offsetHeight+e.top,right:t.offsetLeft+e.left+t.offsetWidth,left:t.offsetLeft+e.left,width:t.offsetWidth,height:t.offsetHeight}},n.parseBackgrounds=function(t){function e(){h&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&l.push(n),"-"===h.substr(0,1)&&0<(i=h.indexOf("-",1)+1)&&(r=h.substr(0,i),h=h.substr(i)),a.push({prefix:r,method:h.toLowerCase(),value:o,args:l,image:null})),l=[],h=r=n=o=""}var n,r,i,o,s,a=[],u=0,c=0,l=[],h=r=n=o="";return t.split("").forEach(function(t){if(!(0===u&&-1<" \r\n\t".indexOf(t))){switch(t){case'"':s?s===t&&(s=null):s=t;break;case"(":if(s)break;if(0===u)return u=1,void(o+=t);c++;break;case")":if(s)break;if(1===u){if(0===c)return u=0,o+=t,void e();c--}break;case",":if(s)break;if(0===u)return void e();if(1===u&&0===c&&!h.match(/^url$/i))return l.push(n),n="",void(o+=t)}o+=t,0===u?h+=t:n+=t}}),e(),a}},{}],27:[function(t,e){function n(t){r.apply(this,arguments),this.type="linear"===t.args[0]?r.TYPES.LINEAR:r.TYPES.RADIAL}var r=t("./gradientcontainer");n.prototype=Object.create(r.prototype),e.exports=n},{"./gradientcontainer":9}],28:[function(t,e){e.exports=function(r){return new Promise(function(t,e){var n=new XMLHttpRequest;n.open("GET",r),n.onload=function(){200===n.status?t(n.responseText):e(new Error(n.statusText))},n.onerror=function(){e(new Error("Network Error"))},n.send()})}},{}]},{},[4])(4)}),function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=t()}(function(){return function r(i,o,s){function a(e,t){if(!o[e]){if(!i[e]){var n="function"==typeof require&&require;if(!t&&n)return n(e,!0);if(u)return u(e,!0);n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}n=o[e]={exports:{}};i[e][0].call(n.exports,function(t){return a(i[e][1][t]||t)},n,n.exports,r,i,o,s)}return o[e].exports}for(var u="function"==typeof require&&require,t=0;t<s.length;t++)a(s[t]);return a}({1:[function(t,c,e){(function(e){"use strict";function n(){o=!0;for(var t,e,n=u.length;n;){for(e=u,u=[],t=-1;++t<n;)e[t]();n=u.length}o=!1}var t,r,i,o,s=e.MutationObserver||e.WebKitMutationObserver,a=s?(t=0,s=new s(n),r=e.document.createTextNode(""),s.observe(r,{characterData:!0}),function(){r.data=t=++t%2}):e.setImmediate||void 0===e.MessageChannel?"document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)}:((i=new e.MessageChannel).port1.onmessage=n,function(){i.port2.postMessage(0)}),u=[];c.exports=function(t){1!==u.push(t)||o||a()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";function u(){}function r(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,t!==u&&a(this,t)}function i(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function o(e,n,r){l(function(){var t;try{t=n(r)}catch(t){return h.reject(e,t)}t===e?h.reject(e,new TypeError("Cannot resolve promise with itself")):h.resolve(e,t)})}function s(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function a(e,t){function n(t){i||(i=!0,h.reject(e,t))}function r(t){i||(i=!0,h.resolve(e,t))}var i=!1,o=c(function(){t(r,n)});"error"===o.status&&n(o.value)}function c(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}var l=t(1),h={},f=["REJECTED"],p=["FULFILLED"],d=["PENDING"];(e.exports=r).prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){if("function"!=typeof t&&this.state===p||"function"!=typeof e&&this.state===f)return this;var n=new this.constructor(u);return this.state!==d?o(n,this.state===p?t:e,this.outcome):this.queue.push(new i(n,t,e)),n},i.prototype.callFulfilled=function(t){h.resolve(this.promise,t)},i.prototype.otherCallFulfilled=function(t){o(this.promise,this.onFulfilled,t)},i.prototype.callRejected=function(t){h.reject(this.promise,t)},i.prototype.otherCallRejected=function(t){o(this.promise,this.onRejected,t)},h.resolve=function(t,e){var n=c(s,e);if("error"===n.status)return h.reject(t,n.value);n=n.value;if(n)a(t,n);else{t.state=p,t.outcome=e;for(var r=-1,i=t.queue.length;++r<i;)t.queue[r].callFulfilled(e)}return t},h.reject=function(t,e){t.state=f,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},r.resolve=function(t){return t instanceof this?t:h.resolve(new this(u),t)},r.reject=function(t){var e=new this(u);return h.reject(e,t)},r.all=function(t){var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,i=!1;if(!r)return this.resolve([]);for(var o=new Array(r),s=0,e=-1,a=new this(u);++e<r;)!function(t,e){n.resolve(t).then(function(t){o[e]=t,++s!==r||i||(i=!0,h.resolve(a,o))},function(t){i||(i=!0,h.reject(a,t))})}(t[e],e);return a},r.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var i,o=-1,s=new this(u);++o<n;)i=t[o],e.resolve(i).then(function(t){r||(r=!0,h.resolve(s,t))},function(t){r||(r=!0,h.reject(s,t))});return s}},{1:1}],3:[function(e,t,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";function o(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(t){if("TypeError"!==t.name)throw t;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<e.length;i+=1)r.append(e[i]);return r.getBlob(n.type)}}function l(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function u(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function h(t){return"string"!=typeof t&&(t=String(t)),t}function a(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function r(t){return"boolean"==typeof N?P.resolve(N):(r=t,new P(function(n){var t=r.transaction(D,L),e=o([""]);t.objectStore(D).put(e,"key"),t.onabort=function(t){t.preventDefault(),t.stopPropagation(),n(!1)},t.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),e=navigator.userAgent.match(/Edge\//);n(e||!t||43<=parseInt(t[1],10))}}).catch(function(){return!1}).then(function(t){return N=t}));var r}function c(t){var t=R[t.name],n={};n.promise=new P(function(t,e){n.resolve=t,n.reject=e}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function f(t){t=R[t.name].deferredOperations.pop();return t&&(t.resolve(),t.promise)}function p(t,e){t=R[t.name].deferredOperations.pop();if(t)return t.reject(e),t.promise}function i(i,o){return new P(function(t,e){if(R[i.name]=R[i.name]||_(),i.db){if(!o)return t(i.db);c(i),i.db.close()}var n=[i.name];o&&n.push(i.version);var r=I.open.apply(I,n);o&&(r.onupgradeneeded=function(t){var e=r.result;try{e.createObjectStore(i.storeName),t.oldVersion<=1&&e.createObjectStore(D)}catch(e){if("ConstraintError"!==e.name)throw e}}),r.onerror=function(t){t.preventDefault(),e(r.error)},r.onsuccess=function(){t(r.result),f(i)}})}function d(t){return i(t,!1)}function g(t){return i(t,!0)}function m(t){if(!t.db)return 1;var e=!t.db.objectStoreNames.contains(t.storeName),n=t.version<t.db.version,r=t.version>t.db.version;return n&&(t.version,t.version=t.db.version),(r||e)&&(!e||(e=t.db.version+1)>t.version&&(t.version=e),1)}function v(t){return o([function(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),i=0;i<e;i++)r[i]=t.charCodeAt(i);return n}(atob(t.data))],{type:t.type})}function y(t){return t&&t.__local_forage_encoded_blob}function b(t){var e=this,n=e._initReady().then(function(){var t=R[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return u(n,t,t),n}function w(t,e,n,r){void 0===r&&(r=1);try{var i=t.db.transaction(t.storeName,e);n(null,i)}catch(i){if(0<r&&(!t.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return P.resolve().then(function(){if(!t.db||"NotFoundError"===i.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),g(t)}).then(function(){return function(n){c(n);for(var r=R[n.name],i=r.forages,t=0;t<i.length;t++){var e=i[t];e._dbInfo.db&&(e._dbInfo.db.close(),e._dbInfo.db=null)}return n.db=null,d(n).then(function(t){return n.db=t,m(n)?g(n):t}).then(function(t){n.db=r.db=t;for(var e=0;e<i.length;e++)i[e]._dbInfo.db=t}).catch(function(t){throw p(n,t),t})}(t).then(function(){w(t,e,n,r-1)})}).catch(n);n(i)}}function _(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function s(t){var e,n,r,i,o=.75*t.length,s=t.length,a=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);for(var o=new ArrayBuffer(o),u=new Uint8Array(o),c=0;c<s;c+=4)e=H.indexOf(t[c]),n=H.indexOf(t[c+1]),r=H.indexOf(t[c+2]),i=H.indexOf(t[c+3]),u[a++]=e<<2|n>>4,u[a++]=(15&n)<<4|r>>2,u[a++]=(3&r)<<6|63&i;return o}function x(t){for(var e=new Uint8Array(t),n="",r=0;r<e.length;r+=3)n+=H[e[r]>>2],n+=H[(3&e[r])<<4|e[r+1]>>4],n+=H[(15&e[r+1])<<2|e[r+2]>>6],n+=H[63&e[r+2]];return e.length%3==2?n=n.substring(0,n.length-1)+"=":e.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}function C(t,e,n,r){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function k(t,r,i,o,s,a){t.executeSql(i,o,s,function(t,n){n.code===n.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[name],function(t,e){e.rows.length?a(t,n):C(t,r,function(){t.executeSql(i,o,s,a)},a)},a):a(t,n)},a)}function S(s,t,a,u){var c=this;s=h(s);var e=new P(function(i,o){c.ready().then(function(){void 0===t&&(t=null);var n=t,r=c._dbInfo;r.serializer.serialize(t,function(e,t){t?o(t):r.db.transaction(function(t){k(t,r,"INSERT OR REPLACE INTO "+r.storeName+" (key, value) VALUES (?, ?)",[s,e],function(){i(n)},function(t,e){o(e)})},function(t){t.code===t.QUOTA_ERR&&(0<u?i(S.apply(c,[s,n,a,u-1])):o(t))})})}).catch(o)});return l(e,a),e}function O(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function E(){return!function(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),0}catch(t){return 1}}()||0<localStorage.length}function T(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var r in n)n.hasOwnProperty(r)&&(X(n[r])?t[r]=n[r].slice():t[r]=n[r])}return t}var A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},I=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();"undefined"==typeof Promise&&t(3);function j(t,e){for(var n,r,i=t.length,o=0;o<i;){if((n=t[o])===(r=e)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return 1;o++}}var P=Promise,D="local-forage-detect-blob-support",N=void 0,R={},M=Object.prototype.toString,W="readonly",L="readwrite",F={_driver:"asyncStorage",_initStorage:function(t){function e(){return P.resolve()}var r=this,i={db:null};if(t)for(var n in t)i[n]=t[n];var o=R[i.name];o||(o=_(),R[i.name]=o),o.forages.push(r),r._initReady||(r._initReady=r.ready,r.ready=b);for(var s=[],a=0;a<o.forages.length;a++){var u=o.forages[a];u!==r&&s.push(u._initReady().catch(e))}var c=o.forages.slice(0);return P.all(s).then(function(){return i.db=o.db,d(i)}).then(function(t){return i.db=t,m(i,r._defaultConfig.version)?g(i):t}).then(function(t){i.db=o.db=t,r._dbInfo=i;for(var e=0;e<c.length;e++){var n=c[e];n!==r&&(n._dbInfo.db=i.db,n._dbInfo.version=i.version)}})},_support:function(){try{if(!I)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(s,t){var a=this,e=new P(function(i,o){a.ready().then(function(){w(a._dbInfo,W,function(t,e){if(t)return o(t);try{var n=e.objectStore(a._dbInfo.storeName).openCursor(),r=1;n.onsuccess=function(){var t,e=n.result;e?(y(t=e.value)&&(t=v(t)),void 0!==(t=s(t,e.key,r++))?i(t):e.continue()):i()},n.onerror=function(){o(n.error)}}catch(t){o(t)}})}).catch(o)});return l(e,t),e},getItem:function(o,t){var s=this;o=h(o);var e=new P(function(r,i){s.ready().then(function(){w(s._dbInfo,W,function(t,e){if(t)return i(t);try{var n=e.objectStore(s._dbInfo.storeName).get(o);n.onsuccess=function(){var t=n.result;void 0===t&&(t=null),y(t)&&(t=v(t)),r(t)},n.onerror=function(){i(n.error)}}catch(t){i(t)}})}).catch(i)});return l(e,t),e},setItem:function(a,e,t){var u=this;a=h(a);var n=new P(function(o,s){var t;u.ready().then(function(){return t=u._dbInfo,"[object Blob]"===M.call(e)?r(t.db).then(function(t){return t?e:(r=e,new P(function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){t=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:t,type:r.type})},n.readAsBinaryString(r)}));var r}):e}).then(function(i){w(u._dbInfo,L,function(t,e){if(t)return s(t);try{var n=e.objectStore(u._dbInfo.storeName);null===i&&(i=void 0);var r=n.put(i,a);e.oncomplete=function(){void 0===i&&(i=null),o(i)},e.onabort=e.onerror=function(){var t=r.error||r.transaction.error;s(t)}}catch(t){s(t)}})}).catch(s)});return l(n,t),n},removeItem:function(o,t){var s=this;o=h(o);var e=new P(function(r,i){s.ready().then(function(){w(s._dbInfo,L,function(t,e){if(t)return i(t);try{var n=e.objectStore(s._dbInfo.storeName).delete(o);e.oncomplete=function(){r()},e.onerror=function(){i(n.error)},e.onabort=function(){var t=n.error||n.transaction.error;i(t)}}catch(t){i(t)}})}).catch(i)});return l(e,t),e},clear:function(t){var o=this,e=new P(function(r,i){o.ready().then(function(){w(o._dbInfo,L,function(t,e){if(t)return i(t);try{var n=e.objectStore(o._dbInfo.storeName).clear();e.oncomplete=function(){r()},e.onabort=e.onerror=function(){var t=n.error||n.transaction.error;i(t)}}catch(t){i(t)}})}).catch(i)});return l(e,t),e},length:function(t){var o=this,e=new P(function(r,i){o.ready().then(function(){w(o._dbInfo,W,function(t,e){if(t)return i(t);try{var n=e.objectStore(o._dbInfo.storeName).count();n.onsuccess=function(){r(n.result)},n.onerror=function(){i(n.error)}}catch(t){i(t)}})}).catch(i)});return l(e,t),e},key:function(a,t){var u=this,e=new P(function(o,s){a<0?o(null):u.ready().then(function(){w(u._dbInfo,W,function(t,e){if(t)return s(t);try{var n=e.objectStore(u._dbInfo.storeName),r=!1,i=n.openCursor();i.onsuccess=function(){var t=i.result;t?0===a||r?o(t.key):(r=!0,t.advance(a)):o(null)},i.onerror=function(){s(i.error)}}catch(t){s(t)}})}).catch(s)});return l(e,t),e},keys:function(t){var s=this,e=new P(function(i,o){s.ready().then(function(){w(s._dbInfo,W,function(t,e){if(t)return o(t);try{var n=e.objectStore(s._dbInfo.storeName).openCursor(),r=[];n.onsuccess=function(){var t=n.result;t?(r.push(t.key),t.continue()):i(r)},n.onerror=function(){o(n.error)}}catch(t){o(t)}})}).catch(o)});return l(e,t),e},dropInstance:function(s,t){t=a.apply(this,arguments);var e,n=this.config();return(s="function"!=typeof s&&s||{}).name||(s.name=s.name||n.name,s.storeName=s.storeName||n.storeName),l(e=s.name?(e=s.name===n.name&&this._dbInfo.db?P.resolve(this._dbInfo.db):d(s).then(function(t){var e=R[s.name],n=e.forages;e.db=t;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=t;return t}),s.storeName?e.then(function(t){if(t.objectStoreNames.contains(s.storeName)){var i=t.version+1;c(s);var r=R[s.name],o=r.forages;t.close();for(var e=0;e<o.length;e++){var n=o[e];n._dbInfo.db=null,n._dbInfo.version=i}return new P(function(e,n){var r=I.open(s.name,i);r.onerror=function(t){r.result.close(),n(t)},r.onupgradeneeded=function(){r.result.deleteObjectStore(s.storeName)},r.onsuccess=function(){var t=r.result;t.close(),e(t)}}).then(function(t){r.db=t;for(var e=0;e<o.length;e++){var n=o[e];n._dbInfo.db=t,f(n._dbInfo)}}).catch(function(t){throw(p(s,t)||P.resolve()).catch(function(){}),t})}}):e.then(function(t){c(s);var n=R[s.name],r=n.forages;t.close();for(var e=0;e<r.length;e++)r[e]._dbInfo.db=null;return new P(function(e,n){var r=I.deleteDatabase(s.name);r.onerror=r.onblocked=function(t){var e=r.result;e&&e.close(),n(t)},r.onsuccess=function(){var t=r.result;t&&t.close(),e(t)}}).then(function(t){n.db=t;for(var e=0;e<r.length;e++)f(r[e]._dbInfo)}).catch(function(t){throw(p(s,t)||P.resolve()).catch(function(){}),t})})):P.reject("Invalid arguments"),t),e}},H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",B=/^~~local_forage_type~([^~]+)~/,q="__lfsc__:",z=q.length,U=z+"arbf".length,G=Object.prototype.toString,V={serialize:function(e,n){var t="";if(e&&(t=G.call(e)),e&&("[object ArrayBuffer]"===t||e.buffer&&"[object ArrayBuffer]"===G.call(e.buffer))){var r=q;e instanceof ArrayBuffer?(i=e,r+="arbf"):(i=e.buffer,"[object Int8Array]"===t?r+="si08":"[object Uint8Array]"===t?r+="ui08":"[object Uint8ClampedArray]"===t?r+="uic8":"[object Int16Array]"===t?r+="si16":"[object Uint16Array]"===t?r+="ur16":"[object Int32Array]"===t?r+="si32":"[object Uint32Array]"===t?r+="ui32":"[object Float32Array]"===t?r+="fl32":"[object Float64Array]"===t?r+="fl64":n(new Error("Failed to get type for BinaryArray"))),n(r+x(i))}else if("[object Blob]"===t){var i=new FileReader;i.onload=function(){var t="~~local_forage_type~"+e.type+"~"+x(this.result);n(q+"blob"+t)},i.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(t){n(null,t)}},deserialize:function(t){if(t.substring(0,z)!==q)return JSON.parse(t);var e,n=t.substring(U),r=t.substring(z,U);"blob"===r&&B.test(n)&&(e=(t=n.match(B))[1],n=n.substring(t[0].length));var i=s(n);switch(r){case"arbf":return i;case"blob":return o([i],{type:e});case"si08":return new Int8Array(i);case"ui08":return new Uint8Array(i);case"uic8":return new Uint8ClampedArray(i);case"si16":return new Int16Array(i);case"ur16":return new Uint16Array(i);case"si32":return new Int32Array(i);case"ui32":return new Uint32Array(i);case"fl32":return new Float32Array(i);case"fl64":return new Float64Array(i);default:throw new Error("Unkown type: "+r)}},stringToBuffer:s,bufferToString:x},$={_driver:"webSQLStorage",_initStorage:function(t){var r=this,i={db:null};if(t)for(var e in t)i[e]="string"!=typeof t[e]?t[e].toString():t[e];var n=new P(function(e,n){try{i.db=openDatabase(i.name,String(i.version),i.description,i.size)}catch(e){return n(e)}i.db.transaction(function(t){C(t,i,function(){r._dbInfo=i,e()},function(t,e){n(e)})},n)});return i.serializer=V,n},_support:"function"==typeof openDatabase,iterate:function(c,t){var e=this,n=new P(function(u,n){e.ready().then(function(){var a=e._dbInfo;a.db.transaction(function(t){k(t,a,"SELECT * FROM "+a.storeName,[],function(t,e){for(var n=e.rows,r=n.length,i=0;i<r;i++){var o=n.item(i),s=(s=o.value)&&a.serializer.deserialize(s);if(void 0!==(s=c(s,o.key,i+1)))return void u(s)}u()},function(t,e){n(e)})})}).catch(n)});return l(n,t),n},getItem:function(e,t){var o=this;e=h(e);var n=new P(function(r,i){o.ready().then(function(){var n=o._dbInfo;n.db.transaction(function(t){k(t,n,"SELECT * FROM "+n.storeName+" WHERE key = ? LIMIT 1",[e],function(t,e){e=(e=e.rows.length?e.rows.item(0).value:null)&&n.serializer.deserialize(e);r(e)},function(t,e){i(e)})})}).catch(i)});return l(n,t),n},setItem:function(t,e,n){return S.apply(this,[t,e,n,1])},removeItem:function(i,t){var o=this;i=h(i);var e=new P(function(n,r){o.ready().then(function(){var e=o._dbInfo;e.db.transaction(function(t){k(t,e,"DELETE FROM "+e.storeName+" WHERE key = ?",[i],function(){n()},function(t,e){r(e)})})}).catch(r)});return l(e,t),e},clear:function(t){var i=this,e=new P(function(n,r){i.ready().then(function(){var e=i._dbInfo;e.db.transaction(function(t){k(t,e,"DELETE FROM "+e.storeName,[],function(){n()},function(t,e){r(e)})})}).catch(r)});return l(e,t),e},length:function(t){var i=this,e=new P(function(n,r){i.ready().then(function(){var e=i._dbInfo;e.db.transaction(function(t){k(t,e,"SELECT COUNT(key) as c FROM "+e.storeName,[],function(t,e){e=e.rows.item(0).c;n(e)},function(t,e){r(e)})})}).catch(r)});return l(e,t),e},key:function(i,t){var o=this,e=new P(function(n,r){o.ready().then(function(){var e=o._dbInfo;e.db.transaction(function(t){k(t,e,"SELECT key FROM "+e.storeName+" WHERE id = ? LIMIT 1",[i+1],function(t,e){e=e.rows.length?e.rows.item(0).key:null;n(e)},function(t,e){r(e)})})}).catch(r)});return l(e,t),e},keys:function(t){var r=this,e=new P(function(i,n){r.ready().then(function(){var e=r._dbInfo;e.db.transaction(function(t){k(t,e,"SELECT key FROM "+e.storeName,[],function(t,e){for(var n=[],r=0;r<e.rows.length;r++)n.push(e.rows.item(r).key);i(n)},function(t,e){n(e)})})}).catch(n)});return l(e,t),e},dropInstance:function(n,t){t=a.apply(this,arguments);var r=this.config();(n="function"!=typeof n&&n||{}).name||(n.name=n.name||r.name,n.storeName=n.storeName||r.storeName);var i=this,e=n.name?new P(function(t){var o,e=n.name===r.name?i._dbInfo.db:openDatabase(n.name,"","",0);t(n.storeName?{db:e,storeNames:[n.storeName]}:(o=e,new P(function(i,n){o.transaction(function(t){t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(t,e){for(var n=[],r=0;r<e.rows.length;r++)n.push(e.rows.item(r).name);i({db:o,storeNames:n})},function(t,e){n(e)})},function(t){n(t)})})))}).then(function(s){return new P(function(i,o){s.db.transaction(function(r){for(var t=[],e=0,n=s.storeNames.length;e<n;e++)t.push(function(e){return new P(function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(t,e){n(e)})})}(s.storeNames[e]));P.all(t).then(function(){i()}).catch(function(t){o(t)})},function(t){o(t)})})}):P.reject("Invalid arguments");return l(e,t),e}},t={_driver:"localStorageWrapper",_initStorage:function(t){var e={};if(t)for(var n in t)e[n]=t[n];return e.keyPrefix=O(t,this._defaultConfig),E()?((this._dbInfo=e).serializer=V,P.resolve()):P.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(u,t){var c=this,e=c.ready().then(function(){for(var t=c._dbInfo,e=t.keyPrefix,n=e.length,r=localStorage.length,i=1,o=0;o<r;o++){var s=localStorage.key(o);if(0===s.indexOf(e)){var a=(a=localStorage.getItem(s))&&t.serializer.deserialize(a);if(void 0!==(a=u(a,s.substring(n),i++)))return a}}});return l(e,t),e},getItem:function(n,t){var r=this;n=h(n);var e=r.ready().then(function(){var t=r._dbInfo,e=localStorage.getItem(t.keyPrefix+n);return e=e&&t.serializer.deserialize(e)});return l(e,t),e},setItem:function(s,t,e){var a=this;s=h(s);var n=a.ready().then(function(){void 0===t&&(t=null);var o=t;return new P(function(n,r){var i=a._dbInfo;i.serializer.serialize(t,function(t,e){if(e)r(e);else try{localStorage.setItem(i.keyPrefix+s,t),n(o)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||r(t),r(t)}})})});return l(n,e),n},removeItem:function(e,t){var n=this;e=h(e);var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return l(r,t),r},clear:function(t){var r=this,e=r.ready().then(function(){for(var t=r._dbInfo.keyPrefix,e=localStorage.length-1;0<=e;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}});return l(e,t),e},length:function(t){var e=this.keys().then(function(t){return t.length});return l(e,t),e},key:function(n,t){var r=this,e=r.ready().then(function(){var e,t=r._dbInfo;try{e=localStorage.key(n)}catch(t){e=null}return e=e&&e.substring(t.keyPrefix.length)});return l(e,t),e},keys:function(t){var o=this,e=o.ready().then(function(){for(var t=o._dbInfo,e=localStorage.length,n=[],r=0;r<e;r++){var i=localStorage.key(r);0===i.indexOf(t.keyPrefix)&&n.push(i.substring(t.keyPrefix.length))}return n});return l(e,t),e},dropInstance:function(e,t){t=a.apply(this,arguments),(e="function"!=typeof e&&e||{}).name||(r=this.config(),e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n=this,r=e.name?new P(function(t){t(e.storeName?O(e,n._defaultConfig):e.name+"/")}).then(function(t){for(var e=localStorage.length-1;0<=e;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}}):P.reject("Invalid arguments");return l(r,t),r}},X=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Y={},K={},Q={INDEXEDDB:F,WEBSQL:$,LOCALSTORAGE:t},t=[Q.INDEXEDDB._driver,Q.WEBSQL._driver,Q.LOCALSTORAGE._driver],J=["dropInstance"],Z=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(J),tt={description:"",driver:t.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},t=new(et.prototype.config=function(t){if("object"!==(void 0===t?"undefined":A(t)))return"string"==typeof t?this._config[t]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)},et.prototype.defineDriver=function(c,t,e){var n=new P(function(e,n){try{var r=c._driver,t=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!c._driver)return void n(t);for(var i=Z.concat("_initStorage"),o=0,s=i.length;o<s;o++){var a=i[o];if((!j(J,a)||c[a])&&"function"!=typeof c[a])return void n(t)}!function(){for(var t=0,e=J.length;t<e;t++){var n=J[t];c[n]||(c[n]=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),t=P.reject(t);return l(t,arguments[arguments.length-1]),t}}(n))}}();var u=function(t){Y[r],Y[r]=c,K[r]=t,e()};"_support"in c?c._support&&"function"==typeof c._support?c._support().then(u,n):u(!!c._support):u(!0)}catch(t){n(t)}});return u(n,t,e),n},et.prototype.driver=function(){return this._driver||null},et.prototype.getDriver=function(t,e,n){t=Y[t]?P.resolve(Y[t]):P.reject(new Error("Driver not found."));return u(t,e,n),t},et.prototype.getSerializer=function(t){var e=P.resolve(V);return u(e,t),e},et.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return u(n,t,t),n},et.prototype.setDriver=function(t,e,n){function o(){a._config.driver=a.driver()}function s(t){return a._extend(t),o(),a._ready=a._initStorage(a._config),a._ready}function r(i){return function(){var r=0;return function t(){for(;r<i.length;){var e=i[r];return r++,a._dbInfo=null,a._ready=null,a.getDriver(e).then(s).catch(t)}o();var n=new Error("No available storage method found.");return a._driverSet=P.reject(n),a._driverSet}()}}var a=this;X(t)||(t=[t]);var i=this._getSupportedDrivers(t),t=null!==this._driverSet?this._driverSet.catch(function(){return P.resolve()}):P.resolve();return this._driverSet=t.then(function(){var t=i[0];return a._dbInfo=null,a._ready=null,a.getDriver(t).then(function(t){a._driver=t._driver,o(),a._wrapLibraryMethodsWithReady(),a._initDriver=r(i)})}).catch(function(){o();var t=new Error("No available storage method found.");return a._driverSet=P.reject(t),a._driverSet}),u(this._driverSet,e,n),this._driverSet},et.prototype.supports=function(t){return!!K[t]},et.prototype._extend=function(t){T(this,t)},et.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];this.supports(i)&&e.push(i)}return e},et.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=Z.length;t<e;t++)!function(e,n){e[n]=function(){var t=arguments;return e.ready().then(function(){return e[n].apply(e,t)})}}(this,Z[t])},et.prototype.createInstance=function(t){return new et(t)},et);function et(t){for(var e in!function(t){if(!(t instanceof et))throw new TypeError("Cannot call a class as a function")}(this),Q){var n,r;Q.hasOwnProperty(e)&&(r=(n=Q[e])._driver,this[e]=r,Y[r]||this.defineDriver(n))}this._defaultConfig=T({},tt),this._config=T({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}e.exports=t},{3:3}]},{},[4])(4)}),function(){function Bo(t,e){return t.set(e[0],e[1]),t}function qo(t,e){return t.add(e),t}function zo(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Uo(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var s=t[i];e(r,s,n(s),t)}return r}function Go(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function Vo(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function $o(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Xo(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o}function Yo(t,e){return!!(null==t?0:t.length)&&-1<is(t,e,0)}function Ko(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Qo(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function Jo(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function Zo(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function ts(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function es(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function ns(t,r,e){var i;return e(t,function(t,e,n){if(r(t,e,n))return i=e,!1}),i}function rs(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function is(t,e,n){return e==e?function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):rs(t,ss,n)}function os(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function ss(t){return t!=t}function as(t,e){var n=null==t?0:t.length;return n?ls(t,e)/n:Is}function us(e){return function(t){return null==t?Ss:t[e]}}function t(e){return function(t){return null==e?Ss:e[t]}}function cs(t,r,i,o,e){return e(t,function(t,e,n){i=o?(o=!1,t):r(i,t,e,n)}),i}function ls(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);o!==Ss&&(n=n===Ss?o:n+o)}return n}function hs(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function fs(e){return function(t){return e(t)}}function ps(e,t){return Qo(t,function(t){return e[t]})}function ds(t,e){return t.has(e)}function gs(t,e){for(var n=-1,r=t.length;++n<r&&-1<is(e,t[n],0););return n}function ms(t,e){for(var n=t.length;n--&&-1<is(e,t[n],0););return n}function vs(t){return"\\"+C[t]}function ys(t){return x.test(t)}function bs(t){var n=-1,r=Array(t.size);return t.forEach(function(t,e){r[++n]=[e,t]}),r}function ws(e,n){return function(t){return e(n(t))}}function _s(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n];s!==e&&s!==Ts||(t[n]=Ts,o[i++]=n)}return o}function xs(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function Cs(t){return(ys(t)?function(t){for(var e=_.lastIndex=0;_.test(t);)++e;return e}:S)(t)}function ks(t){return ys(t)?t.match(_)||[]:t.split("")}var Ss,Os="Expected a function",Es="__lodash_hash_undefined__",Ts="__lodash_placeholder__",As=9007199254740991,Is=NaN,js=4294967295,Ps=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Ds="[object Arguments]",Ns="[object Array]",Rs="[object Boolean]",Ms="[object Date]",Ws="[object Error]",Ls="[object Function]",Fs="[object GeneratorFunction]",Hs="[object Map]",Bs="[object Number]",qs="[object Object]",zs="[object Promise]",Us="[object RegExp]",Gs="[object Set]",Vs="[object String]",$s="[object Symbol]",Xs="[object WeakMap]",Ys="[object ArrayBuffer]",Ks="[object DataView]",Qs="[object Float32Array]",Js="[object Float64Array]",Zs="[object Int8Array]",ta="[object Int16Array]",ea="[object Int32Array]",na="[object Uint8Array]",ra="[object Uint8ClampedArray]",ia="[object Uint16Array]",oa="[object Uint32Array]",sa=/\b__p \+= '';/g,aa=/\b(__p \+=) '' \+/g,ua=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ca=/&(?:amp|lt|gt|quot|#39);/g,la=/[&<>"']/g,ha=RegExp(ca.source),fa=RegExp(la.source),pa=/<%-([\s\S]+?)%>/g,da=/<%([\s\S]+?)%>/g,ga=/<%=([\s\S]+?)%>/g,ma=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,va=/^\w*$/,ya=/^\./,ba=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,wa=/[\\^$.*+?()[\]{}|]/g,_a=RegExp(wa.source),xa=/^\s+|\s+$/g,Ca=/^\s+/,ka=/\s+$/,Sa=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Oa=/\{\n\/\* \[wrapped with (.+)\] \*/,Ea=/,? & /,Ta=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Aa=/\\(\\)?/g,Ia=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ja=/\w*$/,Pa=/^[-+]0x[0-9a-f]+$/i,Da=/^0b[01]+$/i,Na=/^\[object .+?Constructor\]$/,Ra=/^0o[0-7]+$/i,Ma=/^(?:0|[1-9]\d*)$/,Wa=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,La=/($^)/,Fa=/['\n\r\u2028\u2029\\]/g,e="\\ud800-\\udfff",n="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",r="\\u2700-\\u27bf",i="a-z\\xdf-\\xf6\\xf8-\\xff",o="A-Z\\xc0-\\xd6\\xd8-\\xde",s="\\ufe0e\\ufe0f",a="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",u="["+e+"]",c="["+a+"]",l="["+n+"]",h="\\d+",f="["+r+"]",p="["+i+"]",d="[^"+e+a+h+r+i+o+"]",g="\\ud83c[\\udffb-\\udfff]",m="[^"+e+"]",v="(?:\\ud83c[\\udde6-\\uddff]){2}",y="[\\ud800-\\udbff][\\udc00-\\udfff]",b="["+o+"]",w="(?:"+p+"|"+d+")",a="(?:"+b+"|"+d+")",r="(?:['](?:d|ll|m|re|s|t|ve))?",i="(?:['](?:D|LL|M|RE|S|T|VE))?",o="(?:"+l+"|"+g+")"+"?",d="["+s+"]?",o=d+o+("(?:\\u200d(?:"+[m,v,y].join("|")+")"+d+o+")*"),f="(?:"+[f,v,y].join("|")+")"+o,u="(?:"+[m+l+"?",l,v,y,u].join("|")+")",Ha=RegExp("[']","g"),Ba=RegExp(l,"g"),_=RegExp(g+"(?="+g+")|"+u+o,"g"),qa=RegExp([b+"?"+p+"+"+r+"(?="+[c,b,"$"].join("|")+")",a+"+"+i+"(?="+[c,b+w,"$"].join("|")+")",b+"?"+w+"+"+r,b+"+"+i,"\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",h,f].join("|"),"g"),x=RegExp("[\\u200d"+e+n+s+"]"),za=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ua=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ga=-1,Va={};Va[Qs]=Va[Js]=Va[Zs]=Va[ta]=Va[ea]=Va[na]=Va[ra]=Va[ia]=Va[oa]=!0,Va[Ds]=Va[Ns]=Va[Ys]=Va[Rs]=Va[Ks]=Va[Ms]=Va[Ws]=Va[Ls]=Va[Hs]=Va[Bs]=Va[qs]=Va[Us]=Va[Gs]=Va[Vs]=Va[Xs]=!1;var $a={};$a[Ds]=$a[Ns]=$a[Ys]=$a[Ks]=$a[Rs]=$a[Ms]=$a[Qs]=$a[Js]=$a[Zs]=$a[ta]=$a[ea]=$a[Hs]=$a[Bs]=$a[qs]=$a[Us]=$a[Gs]=$a[Vs]=$a[$s]=$a[na]=$a[ra]=$a[ia]=$a[oa]=!0,$a[Ws]=$a[Ls]=$a[Xs]=!1;var C={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Xa=parseFloat,Ya=parseInt,e="object"==typeof global&&global&&global.Object===Object&&global,n="object"==typeof self&&self&&self.Object===Object&&self,Ka=e||n||Function("return this")(),s="object"==typeof exports&&exports&&!exports.nodeType&&exports,n=s&&"object"==typeof module&&module&&!module.nodeType&&module,Qa=n&&n.exports===s,k=Qa&&e.process,e=function(){try{return k&&k.binding&&k.binding("util")}catch(t){}}(),Ja=e&&e.isArrayBuffer,Za=e&&e.isDate,tu=e&&e.isMap,eu=e&&e.isRegExp,nu=e&&e.isSet,ru=e&&e.isTypedArray,S=us("length"),iu=t({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),ou=t({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),su=t({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),au=function t(e){function d(t){if(hn(t)&&!io(t)&&!(t instanceof m)){if(t instanceof g)return t;if(tr.call(t,"__wrapped__"))return Me(t)}return new g(t)}function o(){}function g(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=Ss}function m(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=js,this.__views__=[]}function n(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function i(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function v(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new s;++e<n;)this.add(t[e])}function y(t){t=this.__data__=new i(t);this.size=t.size}function r(t,e){var n,r=io(t),i=!r&&ro(t),o=!r&&!i&&so(t),s=!r&&!i&&!o&&ho(t),a=r||i||o||s,u=a?hs(t.length,$n):[],c=u.length;for(n in t)!e&&!tr.call(t,n)||a&&("length"==n||o&&("offset"==n||"parent"==n)||s&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||xe(n,c))||u.push(n);return u}function a(t){var e=t.length;return e?t[ot(0,e-1)]:Ss}function u(t,e){return De(Mt(t),x(e,0,t.length))}function c(t){return De(Mt(t))}function p(t,e,n){(n===Ss||nn(t[e],n))&&(n!==Ss||e in t)||f(t,e,n)}function b(t,e,n){var r=t[e];tr.call(t,e)&&nn(r,n)&&(n!==Ss||e in t)||f(t,e,n)}function l(t,e){for(var n=t.length;n--;)if(nn(t[n][0],e))return n;return-1}function h(t,r,i,o){return Zr(t,function(t,e,n){r(o,t,i(t),n)}),o}function w(t,e){return t&&Wt(e,Sn(e),t)}function f(t,e,n){"__proto__"==e&&yr?yr(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function _(t,e){for(var n=-1,r=e.length,i=Hn(r),o=null==t;++n<r;)i[n]=o?Ss:Cn(t,e[n]);return i}function x(t,e,n){return t==t&&(n!==Ss&&(t=t<=n?t:n),e!==Ss&&(t=e<=t?t:e)),t}function C(n,r,i,t,e,o){var s,a=1&r,u=2&r,c=4&r;if(i&&(s=e?i(n,t,e,o):i(n)),s!==Ss)return s;if(!ln(n))return n;var l,h,f=io(n);if(f){if(t=(p=n).length,d=p.constructor(t),t&&"string"==typeof p[0]&&tr.call(p,"index")&&(d.index=p.index,d.input=p.input),s=d,!a)return Mt(n,s)}else{var p=hi(n),d=p==Ls||p==Fs;if(so(n))return It(n,a);if(p==qs||p==Ds||d&&!e){if(s=u||d?{}:we(n),!a)return u?(d=l=n,h=(h=s)&&Wt(d,On(d),h),Wt(l,li(l),h)):(h=w(s,l=n),Wt(l,ci(l),h))}else{if(!$a[p])return e?n:{};s=function(t,e,n,r){var i=t.constructor;switch(e){case Ys:return jt(t);case Rs:case Ms:return new i(+t);case Ks:return function(t,e){e=e?jt(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}(t,r);case Qs:case Js:case Zs:case ta:case ea:case na:case ra:case ia:case oa:return Pt(t,r);case Hs:return function(t,e,n){return Zo(e?n(bs(t),1):bs(t),Bo,new t.constructor)}(t,r,n);case Bs:case Vs:return new i(t);case Us:return function(t){var e=new t.constructor(t.source,ja.exec(t));return e.lastIndex=t.lastIndex,e}(t);case Gs:return function(t,e,n){return Zo(e?n(xs(t),1):xs(t),qo,new t.constructor)}(t,r,n);case $s:return function(t){return Yr?Gn(Yr.call(t)):{}}(t)}}(n,p,C,a)}}a=(o=o||new y).get(n);if(a)return a;o.set(n,s);var g=f?Ss:(c?u?fe:he:u?On:Sn)(n);return Go(g||n,function(t,e){g&&(t=n[e=t]),b(s,e,C(t,r,i,e,n,o))}),s}function k(t,e,n){var r=n.length;if(null==t)return!r;for(t=Gn(t);r--;){var i=n[r],o=e[i],s=t[i];if(s===Ss&&!(i in t)||!o(s))return!1}return!0}function S(t,e,n){if("function"!=typeof t)throw new Xn(Os);return mi(function(){t.apply(Ss,n)},e)}function O(t,e,n,r){var i=-1,o=Yo,s=!0,a=t.length,u=[],c=e.length;if(!a)return u;n&&(e=Qo(e,fs(n))),r?(o=Ko,s=!1):200<=e.length&&(o=ds,s=!1,e=new v(e));t:for(;++i<a;){var l=t[i],h=null==n?l:n(l),l=r||0!==l?l:0;if(s&&h==h){for(var f=c;f--;)if(e[f]===h)continue t;u.push(l)}else o(e,h,r)||u.push(l)}return u}function E(t,r){var i=!0;return Zr(t,function(t,e,n){return i=!!r(t,e,n)}),i}function T(t,e,n){for(var r=-1,i=t.length;++r<i;){var o,s,a=t[r],u=e(a);null!=u&&(o===Ss?u==u&&!gn(u):n(u,o))&&(o=u,s=a)}return s}function A(t,r){var i=[];return Zr(t,function(t,e,n){r(t,e,n)&&i.push(t)}),i}function I(t,e,n,r,i){var o=-1,s=t.length;for(n=n||_e,i=i||[];++o<s;){var a=t[o];0<e&&n(a)?1<e?I(a,e-1,n,r,i):Jo(i,a):r||(i[i.length]=a)}return i}function j(t,e){return t&&ei(t,e,Sn)}function P(t,e){return t&&ni(t,e,Sn)}function D(e,t){return Xo(t,function(t){return an(e[t])})}function N(t,e){for(var n=0,r=(e=Tt(e,t)).length;null!=t&&n<r;)t=t[Ne(e[n++])];return n&&n==r?t:Ss}function R(t,e,n){e=e(t);return io(t)?e:Jo(e,n(t))}function M(t){return null==t?t===Ss?"[object Undefined]":"[object Null]":vr&&vr in Gn(t)?function(t){var e=tr.call(t,vr),n=t[vr];try{t[vr]=Ss;var r=!0}catch(t){}var i=rr.call(t);return r&&(e?t[vr]=n:delete t[vr]),i}(t):(t=t,rr.call(t))}function W(t,e){return e<t}function L(t,e){return null!=t&&tr.call(t,e)}function F(t,e){return null!=t&&e in Gn(t)}function H(t,e,n){for(var r=n?Ko:Yo,i=t[0].length,o=t.length,s=o,a=Hn(o),u=1/0,c=[];s--;){var l=t[s];s&&e&&(l=Qo(l,fs(e))),u=Ir(l.length,u),a[s]=!n&&(e||120<=i&&120<=l.length)?new v(s&&l):Ss}l=t[0];var h=-1,f=a[0];t:for(;++h<i&&c.length<u;){var p=l[h],d=e?e(p):p,p=n||0!==p?p:0;if(!(f?ds(f,d):r(c,d,n))){for(s=o;--s;){var g=a[s];if(!(g?ds(g,d):r(t[s],d,n)))continue t}f&&f.push(d),c.push(p)}}return c}function B(t,e,n){e=null==(t=Ie(t,e=Tt(e,t)))?t:t[Ne(Be(e))];return null==e?Ss:zo(e,t,n)}function q(t){return hn(t)&&M(t)==Ds}function z(t,e,n,r,i){return t===e||(null==t||null==e||!hn(t)&&!hn(e)?t!=t&&e!=e:function(t,e,n,r,i,o){var s=io(t),a=io(e),u=s?Ns:hi(t),c=a?Ns:hi(e),l=(u=u==Ds?qs:u)==qs,a=(c=c==Ds?qs:c)==qs,c=u==c;if(c&&so(t)){if(!so(e))return!1;l=!(s=!0)}if(c&&!l)return o=o||new y,s||ho(t)?ce(t,e,n,r,i,o):function(t,e,n,r,i,o,s){switch(n){case Ks:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Ys:return!(t.byteLength!=e.byteLength||!o(new cr(t),new cr(e)));case Rs:case Ms:case Bs:return nn(+t,+e);case Ws:return t.name==e.name&&t.message==e.message;case Us:case Vs:return t==e+"";case Hs:var a=bs;case Gs:var u=1&r;if(a=a||xs,t.size!=e.size&&!u)return!1;u=s.get(t);if(u)return u==e;r|=2,s.set(t,e);a=ce(a(t),a(e),r,i,o,s);return s.delete(t),a;case $s:if(Yr)return Yr.call(t)==Yr.call(e)}return!1}(t,e,u,n,r,i,o);if(!(1&n)){l=l&&tr.call(t,"__wrapped__"),a=a&&tr.call(e,"__wrapped__");if(l||a){l=l?t.value():t,a=a?e.value():e;return o=o||new y,i(l,a,n,r,o)}}return!!c&&(o=o||new y,function(t,e,n,r,i,o){var s=1&n,a=he(t),u=a.length,c=he(e).length;if(u!=c&&!s)return!1;for(var l=u;l--;){var h=a[l];if(!(s?h in e:tr.call(e,h)))return!1}var f=o.get(t);if(f&&o.get(e))return f==e;var p=!0;o.set(t,e),o.set(e,t);for(var d=s;++l<u;){h=a[l];var g,m=t[h],v=e[h];if(r&&(g=s?r(v,m,h,e,t,o):r(m,v,h,t,e,o)),!(g===Ss?m===v||i(m,v,n,r,o):g)){p=!1;break}d=d||"constructor"==h}p&&!d&&(c=t.constructor,f=e.constructor,c!=f&&"constructor"in t&&"constructor"in e&&!("function"==typeof c&&c instanceof c&&"function"==typeof f&&f instanceof f)&&(p=!1));return o.delete(t),o.delete(e),p}(t,e,n,r,i,o))}(t,e,n,r,z,i))}function U(t,e,n,r){var i=n.length,o=i,s=!r;if(null==t)return!o;for(t=Gn(t);i--;){var a=n[i];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<o;){var u=(a=n[i])[0],c=t[u],l=a[1];if(s&&a[2]){if(c===Ss&&!(u in t))return!1}else{var h,f=new y;if(r&&(h=r(c,l,u,t,e,f)),!(h===Ss?z(l,c,3,r,f):h))return!1}}return!0}function G(t){return!(!ln(t)||(e=t,nr&&nr in e))&&(an(t)?sr:Na).test(Re(t));var e}function V(t){return"function"==typeof t?t:null==t?Dn:"object"==typeof t?io(t)?J(t[0],t[1]):Q(t):Wn(t)}function $(t){if(!Oe(t))return Tr(t);var e,n=[];for(e in Gn(t))tr.call(t,e)&&"constructor"!=e&&n.push(e);return n}function X(t){if(!ln(t))return function(t){var e=[];if(null!=t)for(var n in Gn(t))e.push(n);return e}(t);var e,n=Oe(t),r=[];for(e in t)("constructor"!=e||!n&&tr.call(t,e))&&r.push(e);return r}function Y(t,e){return t<e}function K(t,r){var i=-1,o=rn(t)?Hn(t.length):[];return Zr(t,function(t,e,n){o[++i]=r(t,e,n)}),o}function Q(e){var n=ve(e);return 1==n.length&&n[0][2]?Te(n[0][0],n[0][1]):function(t){return t===e||U(t,e,n)}}function J(n,r){return ke(n)&&Ee(r)?Te(Ne(n),r):function(t){var e=Cn(t,n);return e===Ss&&e===r?kn(t,n):z(r,e,3)}}function Z(r,i,o,s,a){r!==i&&ei(i,function(t,e){var n;ln(t)?(a=a||new y,function(t,e,n,r,i,o,s){var a=t[n],u=e[n],c=s.get(u);if(c)return p(t,n,c);var l,h=o?o(a,u,n+"",t,e,s):Ss,f=h===Ss;f&&(l=io(u),c=!l&&so(u),e=!l&&!c&&ho(u),h=u,l||c||e?h=io(a)?a:on(a)?Mt(a):c?It(u,!(f=!1)):e?Pt(u,!(f=!1)):[]:pn(u)||ro(u)?ro(h=a)?h=_n(a):(!ln(a)||r&&an(a))&&(h=we(u)):f=!1),f&&(s.set(u,h),i(h,u,r,o,s),s.delete(u)),p(t,n,h)}(r,i,e,o,Z,s,a)):((n=s?s(r[e],t,e+"",r,i,a):Ss)===Ss&&(n=t),p(r,e,n))},On)}function tt(t,e){var n=t.length;if(n)return xe(e+=e<0?n:0,n)?t[e]:Ss}function et(t,r,n){var i=-1;return r=Qo(r.length?r:[Dn],fs(ge())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(K(t,function(e,t,n){return{criteria:Qo(r,function(t){return t(e)}),index:++i,value:e}}),function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,s=i.length,a=n.length;++r<s;){var u=Dt(i[r],o[r]);if(u){if(a<=r)return u;var c=n[r];return u*("desc"==c?-1:1)}}return t.index-e.index}(t,e,n)})}function nt(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var s=e[r],a=N(t,s);n(a,s)&&lt(o,Tt(s,t),a)}return o}function rt(t,e,n,r){var i=r?os:is,o=-1,s=e.length,a=t;for(t===e&&(e=Mt(e)),n&&(a=Qo(t,fs(n)));++o<s;)for(var u=0,c=e[o],l=n?n(c):c;-1<(u=i(a,l,u,r));)a!==t&&dr.call(a,u,1),dr.call(t,u,1);return t}function it(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i,o=e[n];n!=r&&o===i||(xe(i=o)?dr.call(t,o,1):wt(t,o))}return t}function ot(t,e){return t+Cr(Dr()*(e-t+1))}function st(t,e){var n="";if(!t||e<1||As<e)return n;for(;e%2&&(n+=t),e=Cr(e/2),e&&(t+=t),e;);return n}function at(t,e){return vi(Ae(t,e,Dn),t+"")}function ut(t){return a(Tn(t))}function ct(t,e){t=Tn(t);return De(t,x(e,0,t.length))}function lt(t,e,n,r){if(!ln(t))return t;for(var i=-1,o=(e=Tt(e,t)).length,s=o-1,a=t;null!=a&&++i<o;){var u,c=Ne(e[i]),l=n;i!=s&&(u=a[c],(l=r?r(u,c,a):Ss)===Ss&&(l=ln(u)?u:xe(e[i+1])?[]:{})),b(a,c,l),a=a[c]}return t}function ht(t){return De(Tn(t))}function ft(t,e,n){var r=-1,i=t.length;e<0&&(e=i<-e?0:i+e),(n=i<n?i:n)<0&&(n+=i),i=n<e?0:n-e>>>0,e>>>=0;for(var o=Hn(i);++r<i;)o[r]=t[r+e];return o}function pt(t,r){var i;return Zr(t,function(t,e,n){return!(i=r(t,e,n))}),!!i}function dt(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=t[o];null!==s&&!gn(s)&&(n?s<=e:s<e)?r=1+o:i=o}return i}return gt(t,e,Dn,n)}function gt(t,e,n,r){e=n(e);for(var i=0,o=null==t?0:t.length,s=e!=e,a=null===e,u=gn(e),c=e===Ss;i<o;){var l=Cr((i+o)/2),h=n(t[l]),f=h!==Ss,p=null===h,d=h==h,g=gn(h),h=s?r||d:c?d&&(r||f):a?d&&f&&(r||!p):u?d&&f&&!p&&(r||!g):!p&&!g&&(r?h<=e:h<e);h?i=l+1:o=l}return Ir(o,4294967294)}function mt(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s,a=t[n],u=e?e(a):a;n&&nn(u,s)||(s=u,o[i++]=0===a?0:a)}return o}function vt(t){return"number"==typeof t?t:gn(t)?Is:+t}function yt(t){if("string"==typeof t)return t;if(io(t))return Qo(t,yt)+"";if(gn(t))return Kr?Kr.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function bt(t,e,n){var r=-1,i=Yo,o=t.length,s=!0,a=[],u=a;if(n)s=!1,i=Ko;else if(200<=o){var c=e?null:ai(t);if(c)return xs(c);s=!1,i=ds,u=new v}else u=e?[]:a;t:for(;++r<o;){var l=t[r],h=e?e(l):l,l=n||0!==l?l:0;if(s&&h==h){for(var f=u.length;f--;)if(u[f]===h)continue t;e&&u.push(h),a.push(l)}else i(u,h,n)||(u!==a&&u.push(h),a.push(l))}return a}function wt(t,e){return null==(t=Ie(t,e=Tt(e,t)))||delete t[Ne(Be(e))]}function _t(t,e,n,r){return lt(t,e,n(N(t,e)),r)}function xt(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?ft(t,r?0:o,r?o+1:i):ft(t,r?o+1:0,r?i:o)}function Ct(t,e){return t instanceof m&&(t=t.value()),Zo(e,function(t,e){return e.func.apply(e.thisArg,Jo([t],e.args))},t)}function kt(t,e,n){var r=t.length;if(r<2)return r?bt(t[0]):[];for(var i=-1,o=Hn(r);++i<r;)for(var s=t[i],a=-1;++a<r;)a!=i&&(o[i]=O(o[i]||s,t[a],e,n));return bt(I(o,1),e,n)}function St(t,e,n){for(var r=-1,i=t.length,o=e.length,s={};++r<i;){var a=r<o?e[r]:Ss;n(s,t[r],a)}return s}function Ot(t){return on(t)?t:[]}function Et(t){return"function"==typeof t?t:Dn}function Tt(t,e){return io(t)?t:ke(t,e)?[t]:yi(xn(t))}function At(t,e,n){var r=t.length;return n=n===Ss?r:n,!e&&r<=n?t:ft(t,e,n)}function It(t,e){if(e)return t.slice();e=t.length,e=lr?lr(e):new t.constructor(e);return t.copy(e),e}function jt(t){var e=new t.constructor(t.byteLength);return new cr(e).set(new cr(t)),e}function Pt(t,e){e=e?jt(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function Dt(t,e){if(t!==e){var n=t!==Ss,r=null===t,i=t==t,o=gn(t),s=e!==Ss,a=null===e,u=e==e,c=gn(e);if(!a&&!c&&!o&&e<t||o&&s&&u&&!a&&!c||r&&s&&u||!n&&u||!i)return 1;if(!r&&!o&&!c&&t<e||c&&n&&i&&!r&&!o||a&&n&&i||!s&&i||!u)return-1}return 0}function Nt(t,e,n,r){for(var i=-1,o=t.length,s=n.length,a=-1,u=e.length,c=Ar(o-s,0),l=Hn(u+c),h=!r;++a<u;)l[a]=e[a];for(;++i<s;)(h||i<o)&&(l[n[i]]=t[i]);for(;c--;)l[a++]=t[i++];return l}function Rt(t,e,n,r){for(var i=-1,o=t.length,s=-1,a=n.length,u=-1,c=e.length,l=Ar(o-a,0),h=Hn(l+c),f=!r;++i<l;)h[i]=t[i];for(var p=i;++u<c;)h[p+u]=e[u];for(;++s<a;)(f||i<o)&&(h[p+n[s]]=t[i++]);return h}function Mt(t,e){var n=-1,r=t.length;for(e=e||Hn(r);++n<r;)e[n]=t[n];return e}function Wt(t,e,n,r){var i=!n;n=n||{};for(var o=-1,s=e.length;++o<s;){var a=e[o],u=r?r(n[a],t[a],a,n,t):Ss;u===Ss&&(u=t[a]),(i?f:b)(n,a,u)}return n}function Lt(i,o){return function(t,e){var n=io(t)?Uo:h,r=o?o():{};return n(t,i,ge(e,2),r)}}function Ft(a){return at(function(t,e){var n=-1,r=e.length,i=1<r?e[r-1]:Ss,o=2<r?e[2]:Ss,i=3<a.length&&"function"==typeof i?(r--,i):Ss;for(o&&Ce(e[0],e[1],o)&&(i=r<3?Ss:i,r=1),t=Gn(t);++n<r;){var s=e[n];s&&a(t,s,n,i)}return t})}function Ht(o,s){return function(t,e){if(null==t)return t;if(!rn(t))return o(t,e);for(var n=t.length,r=s?n:-1,i=Gn(t);(s?r--:++r<n)&&!1!==e(i[r],r,i););return t}}function Bt(u){return function(t,e,n){for(var r=-1,i=Gn(t),o=n(t),s=o.length;s--;){var a=o[u?s:++r];if(!1===e(i[a],a,i))break}return t}}function qt(r){return function(t){var e=ys(t=xn(t))?ks(t):Ss,n=e?e[0]:t.charAt(0),t=e?At(e,1).join(""):t.slice(1);return n[r]()+t}}function zt(e){return function(t){return Zo(jn(In(t).replace(Ha,"")),e,"")}}function Ut(r){return function(){var t=arguments;switch(t.length){case 0:return new r;case 1:return new r(t[0]);case 2:return new r(t[0],t[1]);case 3:return new r(t[0],t[1],t[2]);case 4:return new r(t[0],t[1],t[2],t[3]);case 5:return new r(t[0],t[1],t[2],t[3],t[4]);case 6:return new r(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new r(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var e=Qr(r.prototype),n=r.apply(e,t);return ln(n)?n:e}}function Gt(o,s,a){var u=Ut(o);return function t(){for(var e=arguments.length,n=Hn(e),r=e,i=de(t);r--;)n[r]=arguments[r];i=e<3&&n[0]!==i&&n[e-1]!==i?[]:_s(n,i);return(e-=i.length)<a?ne(o,s,Xt,t.placeholder,Ss,n,i,Ss,Ss,a-e):zo(this&&this!==Ka&&this instanceof t?u:o,this,n)}}function Vt(o){return function(t,e,n){var r,i=Gn(t);rn(t)||(r=ge(e,3),t=Sn(t),e=function(t){return r(i[t],t,i)});n=o(t,e,n);return-1<n?i[r?t[n]:n]:Ss}}function $t(u){return le(function(i){var o=i.length,t=o,e=g.prototype.thru;for(u&&i.reverse();t--;){var n=i[t];if("function"!=typeof n)throw new Xn(Os);e&&!a&&"wrapper"==pe(n)&&(a=new g([],!0))}for(t=a?t:o;++t<o;)var r=pe(n=i[t]),s="wrapper"==r?ui(n):Ss,a=s&&Se(s[0])&&424==s[1]&&!s[4].length&&1==s[9]?a[pe(s[0])].apply(a,s[3]):1==n.length&&Se(n)?a[r]():a.thru(n);return function(){var t=arguments,e=t[0];if(a&&1==t.length&&io(e))return a.plant(e).value();for(var n=0,r=o?i[n].apply(this,t):e;++n<o;)r=i[n].call(this,r);return r}})}function Xt(a,u,c,l,h,f,p,d,g,m){var v=128&u,y=1&u,b=2&u,w=24&u,_=512&u,x=b?Ss:Ut(a);return function t(){for(var e,n=Hn(s=arguments.length),r=s;r--;)n[r]=arguments[r];if(w&&(e=function(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}(n,o=de(t))),l&&(n=Nt(n,l,h,w)),f&&(n=Rt(n,f,p,w)),s-=e,w&&s<m){var i=_s(n,o);return ne(a,u,Xt,t.placeholder,c,n,i,d,g,m-s)}var o=y?c:this,i=b?o[a]:a,s=n.length;return d?n=function(t,e){for(var n=t.length,r=Ir(e.length,n),i=Mt(t);r--;){var o=e[r];t[r]=xe(o,n)?i[o]:Ss}return t}(n,d):_&&1<s&&n.reverse(),v&&g<s&&(n.length=g),this&&this!==Ka&&this instanceof t&&(i=x||Ut(i)),i.apply(o,n)}}function Yt(n,s){return function(t,e){return t=t,r=n,i=s(e),o={},j(t,function(t,e,n){r(o,i(t),e,n)}),o;var r,i,o}}function Kt(r,i){return function(t,e){var n;if(t===Ss&&e===Ss)return i;if(t!==Ss&&(n=t),e!==Ss){if(n===Ss)return e;e="string"==typeof t||"string"==typeof e?(t=yt(t),yt(e)):(t=vt(t),vt(e)),n=r(t,e)}return n}}function Qt(r){return le(function(t){return t=Qo(t,fs(ge())),at(function(e){var n=this;return r(t,function(t){return zo(t,n,e)})})})}function Jt(t,e){var n=(e=e===Ss?" ":yt(e)).length;if(n<2)return n?st(e,t):e;n=st(e,xr(t/Cs(e)));return ys(e)?At(ks(n),0,t).join(""):n.slice(0,t)}function Zt(a,t,u,c){var l=1&t,h=Ut(a);return function t(){for(var e=-1,n=arguments.length,r=-1,i=c.length,o=Hn(i+n),s=this&&this!==Ka&&this instanceof t?h:a;++r<i;)o[r]=c[r];for(;n--;)o[r++]=arguments[++e];return zo(s,l?u:this,o)}}function te(r){return function(t,e,n){return n&&"number"!=typeof n&&Ce(t,e,n)&&(e=n=Ss),t=vn(t),e===Ss?(e=t,t=0):e=vn(e),function(t,e,n,r){for(var i=-1,o=Ar(xr((e-t)/(n||1)),0),s=Hn(o);o--;)s[r?o:++i]=t,t+=n;return s}(t,e,n=n===Ss?t<e?1:-1:vn(n),r)}}function ee(n){return function(t,e){return"string"==typeof t&&"string"==typeof e||(t=wn(t),e=wn(e)),n(t,e)}}function ne(t,e,n,r,i,o,s,a,u,c){var l=8&e;e|=l?32:64,4&(e&=~(l?64:32))||(e&=-4);c=[t,e,i,l?o:Ss,l?s:Ss,l?Ss:o,l?Ss:s,a,u,c],n=n.apply(Ss,c);return Se(t)&&gi(n,c),n.placeholder=r,je(n,t,e)}function re(t){var r=Un[t];return function(t,e){if(t=wn(t),e=null==e?0:Ir(yn(e),292)){var n=(xn(t)+"e").split("e");return+((n=(xn(r(n[0]+"e"+(+n[1]+e)))+"e").split("e"))[0]+"e"+(+n[1]-e))}return r(t)}}function ie(o){return function(t){var e,n,r,i=hi(t);return i==Hs?bs(t):i==Gs?(i=t,n=-1,r=Array(i.size),i.forEach(function(t){r[++n]=[t,t]}),r):Qo(o(e=t),function(t){return[t,e[t]]})}}function oe(t,e,n,r,i,o,s,a){var u=2&e;if(!u&&"function"!=typeof t)throw new Xn(Os);var c=r?r.length:0;c||(e&=-97,r=i=Ss),s=s===Ss?s:Ar(yn(s),0),a=a===Ss?a:yn(a),c-=i?i.length:0,64&e&&(d=r,g=i,r=i=Ss);var l,h,f,p,d,g,m,v,y,b,w=u?Ss:ui(t),_=[t,e,n,r,i,d,g,o,s,a];return w&&(h=w,p=(l=_)[1],d=h[1],o=(g=p|d)<131,s=128==d&&8==p||128==d&&256==p&&l[7].length<=h[8]||384==d&&h[7].length<=h[8]&&8==p,(o||s)&&(1&d&&(l[2]=h[2],g|=1&p?0:4),(p=h[3])&&(f=l[3],l[3]=f?Nt(f,p,h[4]):p,l[4]=f?_s(l[3],Ts):h[4]),(p=h[5])&&(f=l[5],l[5]=f?Rt(f,p,h[6]):p,l[6]=f?_s(l[5],Ts):h[6]),(p=h[7])&&(l[7]=p),128&d&&(l[8]=null==l[8]?h[8]:Ir(l[8],h[8])),null==l[9]&&(l[9]=h[9]),l[0]=h[0],l[1]=g)),t=_[0],e=_[1],n=_[2],r=_[3],i=_[4],!(a=_[9]=_[9]===Ss?u?0:t.length:Ar(_[9]-c,0))&&24&e&&(e&=-25),n=e&&1!=e?8==e||16==e?Gt(t,e,a):32!=e&&33!=e||i.length?Xt.apply(Ss,_):Zt(t,e,n,r):(v=n,y=1&e,b=Ut(m=t),function t(){return(this&&this!==Ka&&this instanceof t?b:m).apply(y?v:this,arguments)}),je((w?ri:gi)(n,_),t,e)}function se(t,e,n,r){return t===Ss||nn(t,Qn[n])&&!tr.call(r,n)?e:t}function ae(t,e,n,r,i,o){return ln(t)&&ln(e)&&(o.set(e,t),Z(t,e,Ss,ae,o),o.delete(e)),t}function ue(t){return pn(t)?Ss:t}function ce(t,e,n,r,i,o){var s=1&n,a=t.length,u=e.length;if(a!=u&&!(s&&a<u))return!1;u=o.get(t);if(u&&o.get(e))return u==e;var c=-1,l=!0,h=2&n?new v:Ss;for(o.set(t,e),o.set(e,t);++c<a;){var f,p=t[c],d=e[c];if(r&&(f=s?r(d,p,c,e,t,o):r(p,d,c,t,e,o)),f!==Ss){if(f)continue;l=!1;break}if(h){if(!es(e,function(t,e){return!ds(h,e)&&(p===t||i(p,t,n,r,o))&&h.push(e)})){l=!1;break}}else if(p!==d&&!i(p,d,n,r,o)){l=!1;break}}return o.delete(t),o.delete(e),l}function le(t){return vi(Ae(t,Ss,Fe),t+"")}function he(t){return R(t,Sn,ci)}function fe(t){return R(t,On,li)}function pe(t){for(var e=t.name+"",n=qr[e],r=tr.call(qr,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function de(t){return(tr.call(d,"placeholder")?d:t).placeholder}function ge(){var t=(t=d.iteratee||Nn)===Nn?V:t;return arguments.length?t(arguments[0],arguments[1]):t}function me(t,e){var n,r=t.__data__;return("string"==(t=typeof(n=e))||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function ve(t){for(var e=Sn(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Ee(i)]}return e}function ye(t,e){e=e,e=null==(t=t)?Ss:t[e];return G(e)?e:Ss}function be(t,e,n){for(var r=-1,i=(e=Tt(e,t)).length,o=!1;++r<i;){var s=Ne(e[r]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&cn(i)&&xe(s,i)&&(io(t)||ro(t))}function we(t){return"function"!=typeof t.constructor||Oe(t)?{}:Qr(hr(t))}function _e(t){return io(t)||ro(t)||!!(gr&&t&&t[gr])}function xe(t,e){return!!(e=null==e?As:e)&&("number"==typeof t||Ma.test(t))&&-1<t&&t%1==0&&t<e}function Ce(t,e,n){if(ln(n)){var r=typeof e;return("number"==r?rn(n)&&xe(e,n.length):"string"==r&&e in n)&&nn(n[e],t)}}function ke(t,e){if(!io(t)){var n=typeof t;return"number"==n||"symbol"==n||"boolean"==n||null==t||gn(t)||va.test(t)||!ma.test(t)||null!=e&&t in Gn(e)}}function Se(t){var e=pe(t),n=d[e];if("function"==typeof n&&e in m.prototype){if(t===n)return 1;n=ui(n);return n&&t===n[0]}}function Oe(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Qn)}function Ee(t){return t==t&&!ln(t)}function Te(e,n){return function(t){return null!=t&&t[e]===n&&(n!==Ss||e in Gn(t))}}function Ae(o,s,a){return s=Ar(s===Ss?o.length-1:s,0),function(){for(var t=arguments,e=-1,n=Ar(t.length-s,0),r=Hn(n);++e<n;)r[e]=t[s+e];e=-1;for(var i=Hn(s+1);++e<s;)i[e]=t[e];return i[s]=a(r),zo(o,this,i)}}function Ie(t,e){return e.length<2?t:N(t,ft(e,0,-1))}function je(t,e,n){var r,i,e=e+"";return vi(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(1<n?"& ":"")+e[r],e=e.join(2<n?", ":" "),t.replace(Sa,"{\n/* [wrapped with "+e+"] */\n")}(e,(r=(e=(e=e).match(Oa))?e[1].split(Ea):[],i=n,Go(Ps,function(t){var e="_."+t[0];i&t[1]&&!Yo(r,e)&&r.push(e)}),r.sort())))}function Pe(n){var r=0,i=0;return function(){var t=jr(),e=16-(t-i);if(i=t,0<e){if(800<=++r)return arguments[0]}else r=0;return n.apply(Ss,arguments)}}function De(t,e){var n=-1,r=t.length,i=r-1;for(e=e===Ss?r:e;++n<e;){var o=ot(n,i),s=t[o];t[o]=t[n],t[n]=s}return t.length=e,t}function Ne(t){if("string"==typeof t||gn(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Re(t){if(null!=t){try{return Zn.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Me(t){if(t instanceof m)return t.clone();var e=new g(t.__wrapped__,t.__chain__);return e.__actions__=Mt(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function We(t,e,n){var r=null==t?0:t.length;if(!r)return-1;n=null==n?0:yn(n);return n<0&&(n=Ar(r+n,0)),rs(t,ge(e,3),n)}function Le(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==Ss&&(i=yn(n),i=n<0?Ar(r+i,0):Ir(i,r-1)),rs(t,ge(e,3),i,!0)}function Fe(t){return(null==t?0:t.length)?I(t,1):[]}function He(t){return t&&t.length?t[0]:Ss}function Be(t){var e=null==t?0:t.length;return e?t[e-1]:Ss}function qe(t,e){return t&&t.length&&e&&e.length?rt(t,e):t}function ze(t){return null==t?t:Nr.call(t)}function Ue(e){if(!e||!e.length)return[];var n=0;return e=Xo(e,function(t){return on(t)&&(n=Ar(t.length,n),1)}),hs(n,function(t){return Qo(e,us(t))})}function Ge(t,e){if(!t||!t.length)return[];t=Ue(t);return null==e?t:Qo(t,function(t){return zo(e,Ss,t)})}function Ve(t){t=d(t);return t.__chain__=!0,t}function $e(t,e){return e(t)}function Xe(t,e){return(io(t)?Go:Zr)(t,ge(e,3))}function Ye(t,e){return(io(t)?Vo:ti)(t,ge(e,3))}function Ke(t,e){return(io(t)?Qo:K)(t,ge(e,3))}function Qe(t,e,n){return e=n?Ss:e,e=t&&null==e?t.length:e,oe(t,128,Ss,Ss,Ss,Ss,e)}function Je(t,e){var n;if("function"!=typeof e)throw new Xn(Os);return t=yn(t),function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=Ss),n}}function Ze(r,n,t){function i(t){var e=u,n=c;return u=c=Ss,d=t,h=r.apply(n,e)}function o(t){var e=t-p;return p===Ss||n<=e||e<0||m&&l<=t-d}function s(){var t,e=Gi();return o(e)?a(e):void(f=mi(s,(e=n-((t=e)-p),m?Ir(e,l-(t-d)):e)))}function a(t){return f=Ss,v&&u?i(t):(u=c=Ss,h)}function e(){var t=Gi(),e=o(t);if(u=arguments,c=this,p=t,e){if(f===Ss)return d=e=p,f=mi(s,n),g?i(e):h;if(m)return f=mi(s,n),i(p)}return f===Ss&&(f=mi(s,n)),h}var u,c,l,h,f,p,d=0,g=!1,m=!1,v=!0;if("function"!=typeof r)throw new Xn(Os);return n=wn(n)||0,ln(t)&&(g=!!t.leading,m="maxWait"in t,l=m?Ar(wn(t.maxWait)||0,n):l,v="trailing"in t?!!t.trailing:v),e.cancel=function(){f!==Ss&&si(f),d=0,u=p=c=f=Ss},e.flush=function(){return f===Ss?h:a(Gi())},e}function tn(r,i){if("function"!=typeof r||null!=i&&"function"!=typeof i)throw new Xn(Os);var o=function(){var t=arguments,e=i?i.apply(this,t):t[0],n=o.cache;if(n.has(e))return n.get(e);t=r.apply(this,t);return o.cache=n.set(e,t)||n,t};return o.cache=new(tn.Cache||s),o}function en(e){if("function"!=typeof e)throw new Xn(Os);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function nn(t,e){return t===e||t!=t&&e!=e}function rn(t){return null!=t&&cn(t.length)&&!an(t)}function on(t){return hn(t)&&rn(t)}function sn(t){if(!hn(t))return!1;var e=M(t);return e==Ws||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!pn(t)}function an(t){if(!ln(t))return!1;t=M(t);return t==Ls||t==Fs||"[object AsyncFunction]"==t||"[object Proxy]"==t}function un(t){return"number"==typeof t&&t==yn(t)}function cn(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=As}function ln(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function hn(t){return null!=t&&"object"==typeof t}function fn(t){return"number"==typeof t||hn(t)&&M(t)==Bs}function pn(t){if(!hn(t)||M(t)!=qs)return!1;t=hr(t);if(null===t)return!0;t=tr.call(t,"constructor")&&t.constructor;return"function"==typeof t&&t instanceof t&&Zn.call(t)==ir}function dn(t){return"string"==typeof t||!io(t)&&hn(t)&&M(t)==Vs}function gn(t){return"symbol"==typeof t||hn(t)&&M(t)==$s}function mn(t){if(!t)return[];if(rn(t))return(dn(t)?ks:Mt)(t);if(mr&&t[mr])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[mr]());var e=hi(t);return(e==Hs?bs:e==Gs?xs:Tn)(t)}function vn(t){return t?(t=wn(t))!==1/0&&t!==-1/0?t==t?t:0:17976931348623157e292*(t<0?-1:1):0===t?t:0}function yn(t){var e=vn(t),t=e%1;return e==e?t?e-t:e:0}function bn(t){return t?x(yn(t),0,js):0}function wn(t){if("number"==typeof t)return t;if(gn(t))return Is;if(ln(t)&&(t=ln(e="function"==typeof t.valueOf?t.valueOf():t)?e+"":e),"string"!=typeof t)return 0===t?t:+t;t=t.replace(xa,"");var e=Da.test(t);return e||Ra.test(t)?Ya(t.slice(2),e?2:8):Pa.test(t)?Is:+t}function _n(t){return Wt(t,On(t))}function xn(t){return null==t?"":yt(t)}function Cn(t,e,n){e=null==t?Ss:N(t,e);return e===Ss?n:e}function kn(t,e){return null!=t&&be(t,e,F)}function Sn(t){return(rn(t)?r:$)(t)}function On(t){return rn(t)?r(t,!0):X(t)}function En(t,n){if(null==t)return{};var e=Qo(fe(t),function(t){return[t]});return n=ge(n),nt(t,e,function(t,e){return n(t,e[0])})}function Tn(t){return null==t?[]:ps(t,Sn(t))}function An(t){return Lo(xn(t).toLowerCase())}function In(t){return(t=xn(t))&&t.replace(Wa,iu).replace(Ba,"")}function jn(t,e,n){return t=xn(t),(e=n?Ss:e)===Ss?(n=t,za.test(n)?t.match(qa)||[]:t.match(Ta)||[]):t.match(e)||[]}function Pn(t){return function(){return t}}function Dn(t){return t}function Nn(t){return V("function"==typeof t?t:C(t,1))}function Rn(r,e,t){var n=Sn(e),i=D(e,n);null!=t||ln(e)&&(i.length||!n.length)||(t=e,e=r,r=this,i=D(e,Sn(e)));var o=!(ln(t)&&"chain"in t&&!t.chain),s=an(r);return Go(i,function(t){var n=e[t];r[t]=n,s&&(r.prototype[t]=function(){var t=this.__chain__;if(o||t){var e=r(this.__wrapped__);return(e.__actions__=Mt(this.__actions__)).push({func:n,args:arguments,thisArg:r}),e.__chain__=t,e}return n.apply(r,Jo([this.value()],arguments))})}),r}function Mn(){}function Wn(t){return ke(t)?us(Ne(t)):(e=t,function(t){return N(t,e)});var e}function Ln(){return[]}function Fn(){return!1}var Hn=(e=null==e?Ka:au.defaults(Ka.Object(),e,au.pick(Ka,Ua))).Array,Bn=e.Date,qn=e.Error,zn=e.Function,Un=e.Math,Gn=e.Object,Vn=e.RegExp,$n=e.String,Xn=e.TypeError,Yn=Hn.prototype,Kn=zn.prototype,Qn=Gn.prototype,Jn=e["__core-js_shared__"],Zn=Kn.toString,tr=Qn.hasOwnProperty,er=0,nr=(Ho=/[^.]+$/.exec(Jn&&Jn.keys&&Jn.keys.IE_PROTO||""))?"Symbol(src)_1."+Ho:"",rr=Qn.toString,ir=Zn.call(Gn),or=Ka._,sr=Vn("^"+Zn.call(tr).replace(wa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ar=Qa?e.Buffer:Ss,ur=e.Symbol,cr=e.Uint8Array,lr=ar?ar.allocUnsafe:Ss,hr=ws(Gn.getPrototypeOf,Gn),fr=Gn.create,pr=Qn.propertyIsEnumerable,dr=Yn.splice,gr=ur?ur.isConcatSpreadable:Ss,mr=ur?ur.iterator:Ss,vr=ur?ur.toStringTag:Ss,yr=function(){try{var t=ye(Gn,"defineProperty");return t({},"",{}),t}catch(t){}}(),br=e.clearTimeout!==Ka.clearTimeout&&e.clearTimeout,wr=Bn&&Bn.now!==Ka.Date.now&&Bn.now,_r=e.setTimeout!==Ka.setTimeout&&e.setTimeout,xr=Un.ceil,Cr=Un.floor,kr=Gn.getOwnPropertySymbols,Sr=ar?ar.isBuffer:Ss,Or=e.isFinite,Er=Yn.join,Tr=ws(Gn.keys,Gn),Ar=Un.max,Ir=Un.min,jr=Bn.now,Pr=e.parseInt,Dr=Un.random,Nr=Yn.reverse,Rr=ye(e,"DataView"),Mr=ye(e,"Map"),Wr=ye(e,"Promise"),Lr=ye(e,"Set"),Fr=ye(e,"WeakMap"),Hr=ye(Gn,"create"),Br=Fr&&new Fr,qr={},zr=Re(Rr),Ur=Re(Mr),Gr=Re(Wr),Vr=Re(Lr),$r=Re(Fr),Xr=ur?ur.prototype:Ss,Yr=Xr?Xr.valueOf:Ss,Kr=Xr?Xr.toString:Ss,Qr=function(t){if(!ln(t))return{};if(fr)return fr(t);Jr.prototype=t;t=new Jr;return Jr.prototype=Ss,t};function Jr(){}d.templateSettings={escape:pa,evaluate:da,interpolate:ga,variable:"",imports:{_:d}},(d.prototype=o.prototype).constructor=d,(g.prototype=Qr(o.prototype)).constructor=g,(m.prototype=Qr(o.prototype)).constructor=m,n.prototype.clear=function(){this.__data__=Hr?Hr(null):{},this.size=0},n.prototype.delete=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},n.prototype.get=function(t){var e=this.__data__;if(Hr){var n=e[t];return n===Es?Ss:n}return tr.call(e,t)?e[t]:Ss},n.prototype.has=function(t){var e=this.__data__;return Hr?e[t]!==Ss:tr.call(e,t)},n.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Hr&&e===Ss?Es:e,this},i.prototype.clear=function(){this.__data__=[],this.size=0},i.prototype.delete=function(t){var e=this.__data__;return!((t=l(e,t))<0)&&(t==e.length-1?e.pop():dr.call(e,t,1),--this.size,!0)},i.prototype.get=function(t){var e=this.__data__;return(t=l(e,t))<0?Ss:e[t][1]},i.prototype.has=function(t){return-1<l(this.__data__,t)},i.prototype.set=function(t,e){var n=this.__data__,r=l(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},s.prototype.clear=function(){this.size=0,this.__data__={hash:new n,map:new(Mr||i),string:new n}},s.prototype.delete=function(t){return t=me(this,t).delete(t),this.size-=t?1:0,t},s.prototype.get=function(t){return me(this,t).get(t)},s.prototype.has=function(t){return me(this,t).has(t)},s.prototype.set=function(t,e){var n=me(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},v.prototype.add=v.prototype.push=function(t){return this.__data__.set(t,Es),this},v.prototype.has=function(t){return this.__data__.has(t)},y.prototype.clear=function(){this.__data__=new i,this.size=0},y.prototype.delete=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t},y.prototype.get=function(t){return this.__data__.get(t)},y.prototype.has=function(t){return this.__data__.has(t)},y.prototype.set=function(t,e){var n=this.__data__;if(n instanceof i){var r=n.__data__;if(!Mr||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new s(r)}return n.set(t,e),this.size=n.size,this};var Zr=Ht(j),ti=Ht(P,!0),ei=Bt(),ni=Bt(!0),ri=Br?function(t,e){return Br.set(t,e),t}:Dn,ii=yr?function(t,e){return yr(t,"toString",{configurable:!0,enumerable:!1,value:Pn(e),writable:!0})}:Dn,oi=at,si=br||function(t){return Ka.clearTimeout(t)},ai=Lr&&1/xs(new Lr([,-0]))[1]==1/0?function(t){return new Lr(t)}:Mn,ui=Br?function(t){return Br.get(t)}:Mn,ci=kr?function(e){return null==e?[]:(e=Gn(e),Xo(kr(e),function(t){return pr.call(e,t)}))}:Ln,li=kr?function(t){for(var e=[];t;)Jo(e,ci(t)),t=hr(t);return e}:Ln,hi=M;(Rr&&hi(new Rr(new ArrayBuffer(1)))!=Ks||Mr&&hi(new Mr)!=Hs||Wr&&hi(Wr.resolve())!=zs||Lr&&hi(new Lr)!=Gs||Fr&&hi(new Fr)!=Xs)&&(hi=function(t){var e=M(t),t=e==qs?t.constructor:Ss,t=t?Re(t):"";if(t)switch(t){case zr:return Ks;case Ur:return Hs;case Gr:return zs;case Vr:return Gs;case $r:return Xs}return e});var fi,pi,di=Jn?an:Fn,gi=Pe(ri),mi=_r||function(t,e){return Ka.setTimeout(t,e)},vi=Pe(ii),yi=(pi=(fi=tn(fi=function(t){var i=[];return ya.test(t)&&i.push(""),t.replace(ba,function(t,e,n,r){i.push(n?r.replace(Aa,"$1"):e||t)}),i},function(t){return 500===pi.size&&pi.clear(),t})).cache,fi),bi=at(function(t,e){return on(t)?O(t,I(e,1,on,!0)):[]}),wi=at(function(t,e){var n=Be(e);return on(n)&&(n=Ss),on(t)?O(t,I(e,1,on,!0),ge(n,2)):[]}),_i=at(function(t,e){var n=Be(e);return on(n)&&(n=Ss),on(t)?O(t,I(e,1,on,!0),Ss,n):[]}),xi=at(function(t){var e=Qo(t,Ot);return e.length&&e[0]===t[0]?H(e):[]}),Ci=at(function(t){var e=Be(t),n=Qo(t,Ot);return e===Be(n)?e=Ss:n.pop(),n.length&&n[0]===t[0]?H(n,ge(e,2)):[]}),ki=at(function(t){var e=Be(t),n=Qo(t,Ot);return(e="function"==typeof e?e:Ss)&&n.pop(),n.length&&n[0]===t[0]?H(n,Ss,e):[]}),Si=at(qe),Oi=le(function(t,e){var n=null==t?0:t.length,r=_(t,e);return it(t,Qo(e,function(t){return xe(t,n)?+t:t}).sort(Dt)),r}),Ei=at(function(t){return bt(I(t,1,on,!0))}),Ti=at(function(t){var e=Be(t);return on(e)&&(e=Ss),bt(I(t,1,on,!0),ge(e,2))}),Ai=at(function(t){var e="function"==typeof(e=Be(t))?e:Ss;return bt(I(t,1,on,!0),Ss,e)}),Ii=at(function(t,e){return on(t)?O(t,e):[]}),ji=at(function(t){return kt(Xo(t,on))}),Pi=at(function(t){var e=Be(t);return on(e)&&(e=Ss),kt(Xo(t,on),ge(e,2))}),Di=at(function(t){var e="function"==typeof(e=Be(t))?e:Ss;return kt(Xo(t,on),Ss,e)}),Ni=at(Ue),Ri=at(function(t){var e=t.length,e="function"==typeof(e=1<e?t[e-1]:Ss)?(t.pop(),e):Ss;return Ge(t,e)}),Mi=le(function(e){function t(t){return _(t,e)}var n=e.length,r=n?e[0]:0,i=this.__wrapped__;return!(1<n||this.__actions__.length)&&i instanceof m&&xe(r)?((i=i.slice(r,+r+(n?1:0))).__actions__.push({func:$e,args:[t],thisArg:Ss}),new g(i,this.__chain__).thru(function(t){return n&&!t.length&&t.push(Ss),t})):this.thru(t)}),Wi=Lt(function(t,e,n){tr.call(t,n)?++t[n]:f(t,n,1)}),Li=Vt(We),Fi=Vt(Le),Hi=Lt(function(t,e,n){tr.call(t,n)?t[n].push(e):f(t,n,[e])}),Bi=at(function(t,e,n){var r=-1,i="function"==typeof e,o=rn(t)?Hn(t.length):[];return Zr(t,function(t){o[++r]=i?zo(e,t,n):B(t,e,n)}),o}),qi=Lt(function(t,e,n){f(t,n,e)}),zi=Lt(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),Ui=at(function(t,e){if(null==t)return[];var n=e.length;return 1<n&&Ce(t,e[0],e[1])?e=[]:2<n&&Ce(e[0],e[1],e[2])&&(e=[e[0]]),et(t,I(e,1),[])}),Gi=wr||function(){return Ka.Date.now()},Vi=at(function(t,e,n){var r,i=1;return n.length&&(r=_s(n,de(Vi)),i|=32),oe(t,i,e,n,r)}),$i=at(function(t,e,n){var r,i=3;return n.length&&(r=_s(n,de($i)),i|=32),oe(e,i,t,n,r)}),Xi=at(function(t,e){return S(t,1,e)}),Yi=at(function(t,e,n){return S(t,wn(e)||0,n)});tn.Cache=s;var Ki,Qi=oi(function(r,i){var o=(i=1==i.length&&io(i[0])?Qo(i[0],fs(ge())):Qo(I(i,1),fs(ge()))).length;return at(function(t){for(var e=-1,n=Ir(t.length,o);++e<n;)t[e]=i[e].call(this,t[e]);return zo(r,this,t)})}),Ji=at(function(t,e){var n=_s(e,de(Ji));return oe(t,32,Ss,e,n)}),Zi=at(function(t,e){var n=_s(e,de(Zi));return oe(t,64,Ss,e,n)}),to=le(function(t,e){return oe(t,256,Ss,Ss,Ss,e)}),eo=ee(W),no=ee(function(t,e){return e<=t}),ro=q(function(){return arguments}())?q:function(t){return hn(t)&&tr.call(t,"callee")&&!pr.call(t,"callee")},io=Hn.isArray,oo=Ja?fs(Ja):function(t){return hn(t)&&M(t)==Ys},so=Sr||Fn,ao=Za?fs(Za):function(t){return hn(t)&&M(t)==Ms},uo=tu?fs(tu):function(t){return hn(t)&&hi(t)==Hs},co=eu?fs(eu):function(t){return hn(t)&&M(t)==Us},lo=nu?fs(nu):function(t){return hn(t)&&hi(t)==Gs},ho=ru?fs(ru):function(t){return hn(t)&&cn(t.length)&&!!Va[M(t)]},fo=ee(Y),po=ee(function(t,e){return t<=e}),go=Ft(function(t,e){if(Oe(e)||rn(e))Wt(e,Sn(e),t);else for(var n in e)tr.call(e,n)&&b(t,n,e[n])}),mo=Ft(function(t,e){Wt(e,On(e),t)}),vo=Ft(function(t,e,n,r){Wt(e,On(e),t,r)}),yo=Ft(function(t,e,n,r){Wt(e,Sn(e),t,r)}),bo=le(_),wo=at(function(t){return t.push(Ss,se),zo(vo,Ss,t)}),_o=at(function(t){return t.push(Ss,ae),zo(Oo,Ss,t)}),xo=Yt(function(t,e,n){t[e]=n},Pn(Dn)),Co=Yt(function(t,e,n){tr.call(t,e)?t[e].push(n):t[e]=[n]},ge),ko=at(B),So=Ft(function(t,e,n){Z(t,e,n)}),Oo=Ft(function(t,e,n,r){Z(t,e,n,r)}),Eo=le(function(e,t){var n={};if(null==e)return n;var r=!1;t=Qo(t,function(t){return t=Tt(t,e),r=r||1<t.length,t}),Wt(e,fe(e),n),r&&(n=C(n,7,ue));for(var i=t.length;i--;)wt(n,t[i]);return n}),To=le(function(t,e){return null==t?{}:nt(n=t,e,function(t,e){return kn(n,e)});var n}),Ao=ie(Sn),Io=ie(On),jo=zt(function(t,e,n){return e=e.toLowerCase(),t+(n?An(e):e)}),Po=zt(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Do=zt(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),No=qt("toLowerCase"),Ro=zt(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Mo=zt(function(t,e,n){return t+(n?" ":"")+Lo(e)}),Wo=zt(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),Lo=qt("toUpperCase"),Fo=at(function(t,e){try{return zo(t,Ss,e)}catch(t){return sn(t)?t:new qn(t)}}),Kn=le(function(e,t){return Go(t,function(t){t=Ne(t),f(e,t,Vi(e[t],e))}),e}),Ho=$t(),ar=$t(!0),Bn=at(function(e,n){return function(t){return B(t,e,n)}}),e=at(function(e,n){return function(t){return B(e,t,n)}}),ur=Qt(Qo),Xr=Qt($o),br=Qt(es),Rr=te(),Wr=te(!0),Fr=Kt(function(t,e){return t+e},0),Jn=re("ceil"),_r=Kt(function(t,e){return t/e},1),ii=re("floor"),wr=Kt(function(t,e){return t*e},1),oi=re("round"),Sr=Kt(function(t,e){return t-e},0);return d.after=function(t,e){if("function"!=typeof e)throw new Xn(Os);return t=yn(t),function(){if(--t<1)return e.apply(this,arguments)}},d.ary=Qe,d.assign=go,d.assignIn=mo,d.assignInWith=vo,d.assignWith=yo,d.at=bo,d.before=Je,d.bind=Vi,d.bindAll=Kn,d.bindKey=$i,d.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return io(t)?t:[t]},d.chain=Ve,d.chunk=function(t,e,n){e=(n?Ce(t,e,n):e===Ss)?1:Ar(yn(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var i=0,o=0,s=Hn(xr(r/e));i<r;)s[o++]=ft(t,i,i+=e);return s},d.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},d.concat=function(){var t=arguments.length;if(!t)return[];for(var e=Hn(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return Jo(io(n)?Mt(n):[n],I(e,1))},d.cond=function(r){var i=null==r?0:r.length,e=ge();return r=i?Qo(r,function(t){if("function"!=typeof t[1])throw new Xn(Os);return[e(t[0]),t[1]]}):[],at(function(t){for(var e=-1;++e<i;){var n=r[e];if(zo(n[0],this,t))return zo(n[1],this,t)}})},d.conforms=function(t){return e=C(t,1),n=Sn(e),function(t){return k(t,e,n)};var e,n},d.constant=Pn,d.countBy=Wi,d.create=function(t,e){return t=Qr(t),null==e?t:w(t,e)},d.curry=function t(e,n,r){n=oe(e,8,Ss,Ss,Ss,Ss,Ss,n=r?Ss:n);return n.placeholder=t.placeholder,n},d.curryRight=function t(e,n,r){n=oe(e,16,Ss,Ss,Ss,Ss,Ss,n=r?Ss:n);return n.placeholder=t.placeholder,n},d.debounce=Ze,d.defaults=wo,d.defaultsDeep=_o,d.defer=Xi,d.delay=Yi,d.difference=bi,d.differenceBy=wi,d.differenceWith=_i,d.drop=function(t,e,n){var r=null==t?0:t.length;return r?ft(t,(e=n||e===Ss?1:yn(e))<0?0:e,r):[]},d.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?ft(t,0,(e=r-(e=n||e===Ss?1:yn(e)))<0?0:e):[]},d.dropRightWhile=function(t,e){return t&&t.length?xt(t,ge(e,3),!0,!0):[]},d.dropWhile=function(t,e){return t&&t.length?xt(t,ge(e,3),!0):[]},d.fill=function(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&Ce(t,e,n)&&(n=0,r=i),function(t,e,n,r){var i=t.length;for((n=yn(n))<0&&(n=i<-n?0:i+n),(r=r===Ss||i<r?i:yn(r))<0&&(r+=i),r=r<n?0:bn(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},d.filter=function(t,e){return(io(t)?Xo:A)(t,ge(e,3))},d.flatMap=function(t,e){return I(Ke(t,e),1)},d.flatMapDeep=function(t,e){return I(Ke(t,e),1/0)},d.flatMapDepth=function(t,e,n){return n=n===Ss?1:yn(n),I(Ke(t,e),n)},d.flatten=Fe,d.flattenDeep=function(t){return(null==t?0:t.length)?I(t,1/0):[]},d.flattenDepth=function(t,e){return(null==t?0:t.length)?I(t,e=e===Ss?1:yn(e)):[]},d.flip=function(t){return oe(t,512)},d.flow=Ho,d.flowRight=ar,d.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},d.functions=function(t){return null==t?[]:D(t,Sn(t))},d.functionsIn=function(t){return null==t?[]:D(t,On(t))},d.groupBy=Hi,d.initial=function(t){return(null==t?0:t.length)?ft(t,0,-1):[]},d.intersection=xi,d.intersectionBy=Ci,d.intersectionWith=ki,d.invert=xo,d.invertBy=Co,d.invokeMap=Bi,d.iteratee=Nn,d.keyBy=qi,d.keys=Sn,d.keysIn=On,d.map=Ke,d.mapKeys=function(t,r){var i={};return r=ge(r,3),j(t,function(t,e,n){f(i,r(t,e,n),t)}),i},d.mapValues=function(t,r){var i={};return r=ge(r,3),j(t,function(t,e,n){f(i,e,r(t,e,n))}),i},d.matches=function(t){return Q(C(t,1))},d.matchesProperty=function(t,e){return J(t,C(e,1))},d.memoize=tn,d.merge=So,d.mergeWith=Oo,d.method=Bn,d.methodOf=e,d.mixin=Rn,d.negate=en,d.nthArg=function(e){return e=yn(e),at(function(t){return tt(t,e)})},d.omit=Eo,d.omitBy=function(t,e){return En(t,en(ge(e)))},d.once=function(t){return Je(2,t)},d.orderBy=function(t,e,n,r){return null==t?[]:(io(e)||(e=null==e?[]:[e]),io(n=r?Ss:n)||(n=null==n?[]:[n]),et(t,e,n))},d.over=ur,d.overArgs=Qi,d.overEvery=Xr,d.overSome=br,d.partial=Ji,d.partialRight=Zi,d.partition=zi,d.pick=To,d.pickBy=En,d.property=Wn,d.propertyOf=function(e){return function(t){return null==e?Ss:N(e,t)}},d.pull=Si,d.pullAll=qe,d.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?rt(t,e,ge(n,2)):t},d.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?rt(t,e,Ss,n):t},d.pullAt=Oi,d.range=Rr,d.rangeRight=Wr,d.rearg=to,d.reject=function(t,e){return(io(t)?Xo:A)(t,en(ge(e,3)))},d.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=ge(e,3);++r<o;){var s=t[r];e(s,r,t)&&(n.push(s),i.push(r))}return it(t,i),n},d.rest=function(t,e){if("function"!=typeof t)throw new Xn(Os);return at(t,e=e===Ss?e:yn(e))},d.reverse=ze,d.sampleSize=function(t,e,n){return e=(n?Ce(t,e,n):e===Ss)?1:yn(e),(io(t)?u:ct)(t,e)},d.set=function(t,e,n){return null==t?t:lt(t,e,n)},d.setWith=function(t,e,n,r){return r="function"==typeof r?r:Ss,null==t?t:lt(t,e,n,r)},d.shuffle=function(t){return(io(t)?c:ht)(t)},d.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n=n&&"number"!=typeof n&&Ce(t,e,n)?(e=0,r):(e=null==e?0:yn(e),n===Ss?r:yn(n)),ft(t,e,n)):[]},d.sortBy=Ui,d.sortedUniq=function(t){return t&&t.length?mt(t):[]},d.sortedUniqBy=function(t,e){return t&&t.length?mt(t,ge(e,2)):[]},d.split=function(t,e,n){return n&&"number"!=typeof n&&Ce(t,e,n)&&(e=n=Ss),(n=n===Ss?js:n>>>0)?(t=xn(t))&&("string"==typeof e||null!=e&&!co(e))&&(!(e=yt(e))&&ys(t))?At(ks(t),0,n):t.split(e,n):[]},d.spread=function(n,r){if("function"!=typeof n)throw new Xn(Os);return r=null==r?0:Ar(yn(r),0),at(function(t){var e=t[r],t=At(t,0,r);return e&&Jo(t,e),zo(n,this,t)})},d.tail=function(t){var e=null==t?0:t.length;return e?ft(t,1,e):[]},d.take=function(t,e,n){return t&&t.length?ft(t,0,(e=n||e===Ss?1:yn(e))<0?0:e):[]},d.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?ft(t,(e=r-(e=n||e===Ss?1:yn(e)))<0?0:e,r):[]},d.takeRightWhile=function(t,e){return t&&t.length?xt(t,ge(e,3),!1,!0):[]},d.takeWhile=function(t,e){return t&&t.length?xt(t,ge(e,3)):[]},d.tap=function(t,e){return e(t),t},d.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Xn(Os);return ln(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ze(t,e,{leading:r,maxWait:e,trailing:i})},d.thru=$e,d.toArray=mn,d.toPairs=Ao,d.toPairsIn=Io,d.toPath=function(t){return io(t)?Qo(t,Ne):gn(t)?[t]:Mt(yi(xn(t)))},d.toPlainObject=_n,d.transform=function(t,r,i){var e,n=io(t),o=n||so(t)||ho(t);return r=ge(r,4),null==i&&(e=t&&t.constructor,i=o?n?new e:[]:ln(t)&&an(e)?Qr(hr(t)):{}),(o?Go:j)(t,function(t,e,n){return r(i,t,e,n)}),i},d.unary=function(t){return Qe(t,1)},d.union=Ei,d.unionBy=Ti,d.unionWith=Ai,d.uniq=function(t){return t&&t.length?bt(t):[]},d.uniqBy=function(t,e){return t&&t.length?bt(t,ge(e,2)):[]},d.uniqWith=function(t,e){return e="function"==typeof e?e:Ss,t&&t.length?bt(t,Ss,e):[]},d.unset=function(t,e){return null==t||wt(t,e)},d.unzip=Ue,d.unzipWith=Ge,d.update=function(t,e,n){return null==t?t:_t(t,e,Et(n))},d.updateWith=function(t,e,n,r){return r="function"==typeof r?r:Ss,null==t?t:_t(t,e,Et(n),r)},d.values=Tn,d.valuesIn=function(t){return null==t?[]:ps(t,On(t))},d.without=Ii,d.words=jn,d.wrap=function(t,e){return Ji(Et(e),t)},d.xor=ji,d.xorBy=Pi,d.xorWith=Di,d.zip=Ni,d.zipObject=function(t,e){return St(t||[],e||[],b)},d.zipObjectDeep=function(t,e){return St(t||[],e||[],lt)},d.zipWith=Ri,d.entries=Ao,d.entriesIn=Io,d.extend=mo,d.extendWith=vo,Rn(d,d),d.add=Fr,d.attempt=Fo,d.camelCase=jo,d.capitalize=An,d.ceil=Jn,d.clamp=function(t,e,n){return n===Ss&&(n=e,e=Ss),n!==Ss&&(n=(n=wn(n))==n?n:0),e!==Ss&&(e=(e=wn(e))==e?e:0),x(wn(t),e,n)},d.clone=function(t){return C(t,4)},d.cloneDeep=function(t){return C(t,5)},d.cloneDeepWith=function(t,e){return C(t,5,e="function"==typeof e?e:Ss)},d.cloneWith=function(t,e){return C(t,4,e="function"==typeof e?e:Ss)},d.conformsTo=function(t,e){return null==e||k(t,e,Sn(e))},d.deburr=In,d.defaultTo=function(t,e){return null==t||t!=t?e:t},d.divide=_r,d.endsWith=function(t,e,n){t=xn(t),e=yt(e);var r=t.length,r=n=n===Ss?r:x(yn(n),0,r);return 0<=(n-=e.length)&&t.slice(n,r)==e},d.eq=nn,d.escape=function(t){return(t=xn(t))&&fa.test(t)?t.replace(la,ou):t},d.escapeRegExp=function(t){return(t=xn(t))&&_a.test(t)?t.replace(wa,"\\$&"):t},d.every=function(t,e,n){var r=io(t)?$o:E;return n&&Ce(t,e,n)&&(e=Ss),r(t,ge(e,3))},d.find=Li,d.findIndex=We,d.findKey=function(t,e){return ns(t,ge(e,3),j)},d.findLast=Fi,d.findLastIndex=Le,d.findLastKey=function(t,e){return ns(t,ge(e,3),P)},d.floor=ii,d.forEach=Xe,d.forEachRight=Ye,d.forIn=function(t,e){return null==t?t:ei(t,ge(e,3),On)},d.forInRight=function(t,e){return null==t?t:ni(t,ge(e,3),On)},d.forOwn=function(t,e){return t&&j(t,ge(e,3))},d.forOwnRight=function(t,e){return t&&P(t,ge(e,3))},d.get=Cn,d.gt=eo,d.gte=no,d.has=function(t,e){return null!=t&&be(t,e,L)},d.hasIn=kn,d.head=He,d.identity=Dn,d.includes=function(t,e,n,r){return t=rn(t)?t:Tn(t),n=n&&!r?yn(n):0,r=t.length,n<0&&(n=Ar(r+n,0)),dn(t)?n<=r&&-1<t.indexOf(e,n):!!r&&-1<is(t,e,n)},d.indexOf=function(t,e,n){var r=null==t?0:t.length;return r?((n=null==n?0:yn(n))<0&&(n=Ar(r+n,0)),is(t,e,n)):-1},d.inRange=function(t,e,n){return e=vn(e),n===Ss?(n=e,e=0):n=vn(n),(t=t=wn(t))>=Ir(e=e,n=n)&&t<Ar(e,n)},d.invoke=ko,d.isArguments=ro,d.isArray=io,d.isArrayBuffer=oo,d.isArrayLike=rn,d.isArrayLikeObject=on,d.isBoolean=function(t){return!0===t||!1===t||hn(t)&&M(t)==Rs},d.isBuffer=so,d.isDate=ao,d.isElement=function(t){return hn(t)&&1===t.nodeType&&!pn(t)},d.isEmpty=function(t){if(null==t)return!0;if(rn(t)&&(io(t)||"string"==typeof t||"function"==typeof t.splice||so(t)||ho(t)||ro(t)))return!t.length;var e,n=hi(t);if(n==Hs||n==Gs)return!t.size;if(Oe(t))return!$(t).length;for(e in t)if(tr.call(t,e))return!1;return!0},d.isEqual=function(t,e){return z(t,e)},d.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:Ss)?n(t,e):Ss;return r===Ss?z(t,e,Ss,n):!!r},d.isError=sn,d.isFinite=function(t){return"number"==typeof t&&Or(t)},d.isFunction=an,d.isInteger=un,d.isLength=cn,d.isMap=uo,d.isMatch=function(t,e){return t===e||U(t,e,ve(e))},d.isMatchWith=function(t,e,n){return n="function"==typeof n?n:Ss,U(t,e,ve(e),n)},d.isNaN=function(t){return fn(t)&&t!=+t},d.isNative=function(t){if(di(t))throw new qn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return G(t)},d.isNil=function(t){return null==t},d.isNull=function(t){return null===t},d.isNumber=fn,d.isObject=ln,d.isObjectLike=hn,d.isPlainObject=pn,d.isRegExp=co,d.isSafeInteger=function(t){return un(t)&&-As<=t&&t<=As},d.isSet=lo,d.isString=dn,d.isSymbol=gn,d.isTypedArray=ho,d.isUndefined=function(t){return t===Ss},d.isWeakMap=function(t){return hn(t)&&hi(t)==Xs},d.isWeakSet=function(t){return hn(t)&&"[object WeakSet]"==M(t)},d.join=function(t,e){return null==t?"":Er.call(t,e)},d.kebabCase=Po,d.last=Be,d.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==Ss&&(i=(i=yn(n))<0?Ar(r+i,0):Ir(i,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,i):rs(t,ss,i,!0)},d.lowerCase=Do,d.lowerFirst=No,d.lt=fo,d.lte=po,d.max=function(t){return t&&t.length?T(t,Dn,W):Ss},d.maxBy=function(t,e){return t&&t.length?T(t,ge(e,2),W):Ss},d.mean=function(t){return as(t,Dn)},d.meanBy=function(t,e){return as(t,ge(e,2))},d.min=function(t){return t&&t.length?T(t,Dn,Y):Ss},d.minBy=function(t,e){return t&&t.length?T(t,ge(e,2),Y):Ss},d.stubArray=Ln,d.stubFalse=Fn,d.stubObject=function(){return{}},d.stubString=function(){return""},d.stubTrue=function(){return!0},d.multiply=wr,d.nth=function(t,e){return t&&t.length?tt(t,yn(e)):Ss},d.noConflict=function(){return Ka._===this&&(Ka._=or),this},d.noop=Mn,d.now=Gi,d.pad=function(t,e,n){t=xn(t);var r=(e=yn(e))?Cs(t):0;return!e||e<=r?t:Jt(Cr(r=(e-r)/2),n)+t+Jt(xr(r),n)},d.padEnd=function(t,e,n){t=xn(t);var r=(e=yn(e))?Cs(t):0;return e&&r<e?t+Jt(e-r,n):t},d.padStart=function(t,e,n){t=xn(t);var r=(e=yn(e))?Cs(t):0;return e&&r<e?Jt(e-r,n)+t:t},d.parseInt=function(t,e,n){return e=n||null==e?0:e&&+e,Pr(xn(t).replace(Ca,""),e||0)},d.random=function(t,e,n){var r;if(n&&"boolean"!=typeof n&&Ce(t,e,n)&&(e=n=Ss),n===Ss&&("boolean"==typeof e?(n=e,e=Ss):"boolean"==typeof t&&(n=t,t=Ss)),t===Ss&&e===Ss?(t=0,e=1):(t=vn(t),e===Ss?(e=t,t=0):e=vn(e)),e<t&&(r=t,t=e,e=r),n||t%1||e%1){n=Dr();return Ir(t+n*(e-t+Xa("1e-"+((n+"").length-1))),e)}return ot(t,e)},d.reduce=function(t,e,n){var r=io(t)?Zo:cs,i=arguments.length<3;return r(t,ge(e,4),n,i,Zr)},d.reduceRight=function(t,e,n){var r=io(t)?ts:cs,i=arguments.length<3;return r(t,ge(e,4),n,i,ti)},d.repeat=function(t,e,n){return e=(n?Ce(t,e,n):e===Ss)?1:yn(e),st(xn(t),e)},d.replace=function(){var t=arguments,e=xn(t[0]);return t.length<3?e:e.replace(t[1],t[2])},d.result=function(t,e,n){var r=-1,i=(e=Tt(e,t)).length;for(i||(i=1,t=Ss);++r<i;){var o=null==t?Ss:t[Ne(e[r])];o===Ss&&(r=i,o=n),t=an(o)?o.call(t):o}return t},d.round=oi,d.runInContext=t,d.sample=function(t){return(io(t)?a:ut)(t)},d.size=function(t){if(null==t)return 0;if(rn(t))return dn(t)?Cs(t):t.length;var e=hi(t);return e==Hs||e==Gs?t.size:$(t).length},d.snakeCase=Ro,d.some=function(t,e,n){var r=io(t)?es:pt;return n&&Ce(t,e,n)&&(e=Ss),r(t,ge(e,3))},d.sortedIndex=function(t,e){return dt(t,e)},d.sortedIndexBy=function(t,e,n){return gt(t,e,ge(n,2))},d.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=dt(t,e);if(r<n&&nn(t[r],e))return r}return-1},d.sortedLastIndex=function(t,e){return dt(t,e,!0)},d.sortedLastIndexBy=function(t,e,n){return gt(t,e,ge(n,2),!0)},d.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=dt(t,e,!0)-1;if(nn(t[n],e))return n}return-1},d.startCase=Mo,d.startsWith=function(t,e,n){return t=xn(t),n=null==n?0:x(yn(n),0,t.length),e=yt(e),t.slice(n,n+e.length)==e},d.subtract=Sr,d.sum=function(t){return t&&t.length?ls(t,Dn):0},d.sumBy=function(t,e){return t&&t.length?ls(t,ge(e,2)):0},d.template=function(s,t,e){var n=d.templateSettings;e&&Ce(s,t,e)&&(t=Ss),s=xn(s),t=vo({},t,n,se);var a,u,r=Sn(n=vo({},t.imports,n.imports,se)),i=ps(n,r),c=0,n=t.interpolate||La,l="__p += '",n=Vn((t.escape||La).source+"|"+n.source+"|"+(n===ga?Ia:La).source+"|"+(t.evaluate||La).source+"|$","g"),o="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++Ga+"]")+"\n";if(s.replace(n,function(t,e,n,r,i,o){return n=n||r,l+=s.slice(c,o).replace(Fa,vs),e&&(a=!0,l+="' +\n__e("+e+") +\n'"),i&&(u=!0,l+="';\n"+i+";\n__p += '"),n&&(l+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=o+t.length,t}),l+="';\n",(t=t.variable)||(l="with (obj) {\n"+l+"\n}\n"),l=(u?l.replace(sa,""):l).replace(aa,"$1").replace(ua,"$1;"),l="function("+(t||"obj")+") {\n"+(t?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+l+"return __p\n}",(t=Fo(function(){return zn(r,o+"return "+l).apply(Ss,i)})).source=l,sn(t))throw t;return t},d.times=function(t,e){if((t=yn(t))<1||As<t)return[];var n=js,r=Ir(t,js);for(e=ge(e),t-=js,r=hs(r,e);++n<t;)e(n);return r},d.toFinite=vn,d.toInteger=yn,d.toLength=bn,d.toLower=function(t){return xn(t).toLowerCase()},d.toNumber=wn,d.toSafeInteger=function(t){return t?x(yn(t),-As,As):0===t?t:0},d.toString=xn,d.toUpper=function(t){return xn(t).toUpperCase()},d.trim=function(t,e,n){return(t=xn(t))&&(n||e===Ss)?t.replace(xa,""):t&&(e=yt(e))?(t=ks(t),e=ks(e),At(t,gs(t,e),ms(t,e)+1).join("")):t},d.trimEnd=function(t,e,n){return(t=xn(t))&&(n||e===Ss)?t.replace(ka,""):t&&(e=yt(e))?At(t=ks(t),0,ms(t,ks(e))+1).join(""):t},d.trimStart=function(t,e,n){return(t=xn(t))&&(n||e===Ss)?t.replace(Ca,""):t&&(e=yt(e))?At(t=ks(t),gs(t,ks(e))).join(""):t},d.truncate=function(t,e){var n,r=30,i="...";ln(e)&&(n="separator"in e?e.separator:n,r="length"in e?yn(e.length):r,i="omission"in e?yt(e.omission):i);var o,e=(t=xn(t)).length;if(ys(t)&&(e=(o=ks(t)).length),e<=r)return t;if((e=r-Cs(i))<1)return i;if(r=o?At(o,0,e).join(""):t.slice(0,e),n===Ss)return r+i;if(o&&(e+=r.length-e),co(n)){if(t.slice(e).search(n)){var s,a=r;for(n.global||(n=Vn(n.source,xn(ja.exec(n))+"g")),n.lastIndex=0;s=n.exec(a);)var u=s.index;r=r.slice(0,u===Ss?e:u)}}else t.indexOf(yt(n),e)==e||-1<(e=r.lastIndexOf(n))&&(r=r.slice(0,e));return r+i},d.unescape=function(t){return(t=xn(t))&&ha.test(t)?t.replace(ca,su):t},d.uniqueId=function(t){var e=++er;return xn(t)+e},d.upperCase=Wo,d.upperFirst=Lo,d.each=Xe,d.eachRight=Ye,d.first=He,Rn(d,(Ki={},j(d,function(t,e){tr.call(d.prototype,e)||(Ki[e]=t)}),Ki),{chain:!1}),d.VERSION="4.17.4",Go(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){d[t].placeholder=d}),Go(["drop","take"],function(n,r){m.prototype[n]=function(t){t=t===Ss?1:Ar(yn(t),0);var e=this.__filtered__&&!r?new m(this):this.clone();return e.__filtered__?e.__takeCount__=Ir(t,e.__takeCount__):e.__views__.push({size:Ir(t,js),type:n+(e.__dir__<0?"Right":"")}),e},m.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),Go(["filter","map","takeWhile"],function(t,e){var n=e+1,r=1==n||3==n;m.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:ge(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),Go(["head","last"],function(t,e){var n="take"+(e?"Right":"");m.prototype[t]=function(){return this[n](1).value()[0]}}),Go(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");m.prototype[t]=function(){return this.__filtered__?new m(this):this[n](1)}}),m.prototype.compact=function(){return this.filter(Dn)},m.prototype.find=function(t){return this.filter(t).head()},m.prototype.findLast=function(t){return this.reverse().find(t)},m.prototype.invokeMap=at(function(e,n){return"function"==typeof e?new m(this):this.map(function(t){return B(t,e,n)})}),m.prototype.reject=function(t){return this.filter(en(ge(t)))},m.prototype.slice=function(t,e){t=yn(t);var n=this;return n.__filtered__&&(0<t||e<0)?new m(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==Ss&&(n=(e=yn(e))<0?n.dropRight(-e):n.take(e-t)),n)},m.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},m.prototype.toArray=function(){return this.take(js)},j(m.prototype,function(c,t){var l=/^(?:filter|find|map|reject)|While$/.test(t),h=/^(?:head|last)$/.test(t),f=d[h?"take"+("last"==t?"Right":""):t],p=h||/^find/.test(t);f&&(d.prototype[t]=function(){function t(t){return t=f.apply(d,Jo([t],n)),h&&s?t[0]:t}var e=this.__wrapped__,n=h?[1]:arguments,r=e instanceof m,i=n[0],o=r||io(e);o&&l&&"function"==typeof i&&1!=i.length&&(r=o=!1);var s=this.__chain__,a=!!this.__actions__.length,i=p&&!s,a=r&&!a;if(p||!o)return i&&a?c.apply(this,n):(u=this.thru(t),i?h?u.value()[0]:u.value():u);e=a?e:new m(this);var u=c.apply(e,n);return u.__actions__.push({func:$e,args:[t],thisArg:Ss}),new g(u,s)})}),Go(["pop","push","shift","sort","splice","unshift"],function(t){var n=Yn[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);d.prototype[t]=function(){var e=arguments;if(!i||this.__chain__)return this[r](function(t){return n.apply(io(t)?t:[],e)});var t=this.value();return n.apply(io(t)?t:[],e)}}),j(m.prototype,function(t,e){var n,r=d[e];r&&(n=r.name+"",(qr[n]||(qr[n]=[])).push({name:e,func:r}))}),qr[Xt(Ss,2).name]=[{name:"wrapper",func:Ss}],m.prototype.clone=function(){var t=new m(this.__wrapped__);return t.__actions__=Mt(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Mt(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Mt(this.__views__),t},m.prototype.reverse=function(){var t;return this.__filtered__?((t=new m(this)).__dir__=-1,t.__filtered__=!0):(t=this.clone()).__dir__*=-1,t},m.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=io(t),r=e<0,i=n?t.length:0,o=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=Ir(e,t+s);break;case"takeRight":t=Ar(t,e-s)}}return{start:t,end:e}}(0,i,this.__views__),s=o.start,a=(o=o.end)-s,u=r?o:s-1,c=this.__iteratees__,l=c.length,h=0,f=Ir(a,this.__takeCount__);if(!n||!r&&i==a&&f==a)return Ct(t,this.__actions__);var p=[];t:for(;a--&&h<f;){for(var d=-1,g=t[u+=e];++d<l;){var m=c[d],v=m.iteratee,m=m.type,v=v(g);if(2==m)g=v;else if(!v){if(1==m)continue t;break t}}p[h++]=g}return p},d.prototype.at=Mi,d.prototype.chain=function(){return Ve(this)},d.prototype.commit=function(){return new g(this.value(),this.__chain__)},d.prototype.next=function(){this.__values__===Ss&&(this.__values__=mn(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?Ss:this.__values__[this.__index__++]}},d.prototype.plant=function(t){for(var e,n=this;n instanceof o;){var r=Me(n);r.__index__=0,r.__values__=Ss,e?i.__wrapped__=r:e=r;var i=r,n=n.__wrapped__}return i.__wrapped__=t,e},d.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof m){t=t;return this.__actions__.length&&(t=new m(this)),(t=t.reverse()).__actions__.push({func:$e,args:[ze],thisArg:Ss}),new g(t,this.__chain__)}return this.thru(ze)},d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=function(){return Ct(this.__wrapped__,this.__actions__)},d.prototype.first=d.prototype.head,mr&&(d.prototype[mr]=function(){return this}),d}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(Ka._=au,define(function(){return au})):n?((n.exports=au)._=au,s._=au):Ka._=au}.call(this),function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):t.jStat=e()}(this,function(){var p,d,_,x,m,g,a,u,i,e,c,l,h,s,n,f=function(a,u){var e=Array.prototype.concat,t=Array.prototype.slice,n=Object.prototype.toString;function c(t,e){e=e<t?t:e;return a.pow(10,17-~~(a.log(0<e?e:-e)*a.LOG10E))}var l=Array.isArray||function(t){return"[object Array]"===n.call(t)};function h(t){return"[object Function]"===n.call(t)}function f(t){return"number"==typeof t&&t-t==0}function p(){return new p._init(arguments)}function r(){return 0}function i(){return 1}function o(t,e){return t===e?1:0}function s(t,e,n,r){var i,o=[],s=t.length;if(e===u&&n===u&&r===u)return p.copy(t);if(r=r||1,(e=0<=(e=e||0)?e:s+e)===(n=0<=(n=n||t.length)?n:s+n)||0===r)return[];if(e<n&&r<0)return[];if(n<e&&0<r)return[];if(0<r)for(i=e;i<n;i+=r)o.push(t[i]);else for(i=e;n<i;i+=r)o.push(t[i]);return o}p.fn=p.prototype,p._init=function(t){if(l(t[0]))if(l(t[0][0])){h(t[1])&&(t[0]=p.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=h(t[1])?p.map(t[0],t[1]):t[0],this.length=1;else if(f(t[0]))this[0]=p.seq.apply(null,t),this.length=1;else{if(t[0]instanceof p)return p(t[0].toArray());this[0]=[],this.length=1}return this},p._init.prototype=p.prototype,(p._init.constructor=p).utils={calcRdx:c,isArray:l,isFunction:h,isNumber:f,toVector:function(t){return e.apply([],t)}},p._random_fn=a.random,p.setRandom=function(t){if("function"!=typeof t)throw new TypeError("fn is not a function");p._random_fn=t},p.extend=function(t){var e,n;if(1===arguments.length){for(n in t)p[n]=t[n];return this}for(e=1;e<arguments.length;e++)for(n in arguments[e])t[n]=arguments[e][n];return t},p.rows=function(t){return t.length||1},p.cols=function(t){return t[0].length||1},p.dimensions=function(t){return{rows:p.rows(t),cols:p.cols(t)}},p.row=function(e,t){return l(t)?t.map(function(t){return p.row(e,t)}):e[t]},p.rowa=function(t,e){return p.row(t,e)},p.col=function(r,t){if(l(t)){var i=p.arange(r.length).map(function(){return new Array(t.length)});return t.forEach(function(e,n){p.arange(r.length).forEach(function(t){i[t][n]=r[t][e]})}),i}for(var e=new Array(r.length),n=0;n<r.length;n++)e[n]=[r[n][t]];return e},p.cola=function(t,e){return p.col(t,e).map(function(t){return t[0]})},p.diag=function(t){for(var e=p.rows(t),n=new Array(e),r=0;r<e;r++)n[r]=[t[r][r]];return n},p.antidiag=function(t){for(var e=p.rows(t)-1,n=new Array(e),r=0;0<=e;e--,r++)n[r]=[t[r][e]];return n},p.transpose=function(t){var e,n,r,i,o,s=[];for(l(t[0])||(t=[t]),n=t.length,r=t[0].length,o=0;o<r;o++){for(e=new Array(n),i=0;i<n;i++)e[i]=t[i][o];s.push(e)}return 1===s.length?s[0]:s},p.map=function(t,e,n){var r,i,o,s,a;for(l(t[0])||(t=[t]),i=t.length,o=t[0].length,s=n?t:new Array(i),r=0;r<i;r++)for(s[r]||(s[r]=new Array(o)),a=0;a<o;a++)s[r][a]=e(t[r][a],r,a);return 1===s.length?s[0]:s},p.cumreduce=function(t,e,n){var r,i,o,s,a;for(l(t[0])||(t=[t]),i=t.length,o=t[0].length,s=n?t:new Array(i),r=0;r<i;r++)for(s[r]||(s[r]=new Array(o)),0<o&&(s[r][0]=t[r][0]),a=1;a<o;a++)s[r][a]=e(s[r][a-1],t[r][a]);return 1===s.length?s[0]:s},p.alter=function(t,e){return p.map(t,e,!0)},p.create=function(t,e,n){var r,i,o=new Array(t);for(h(e)&&(n=e,e=t),r=0;r<t;r++)for(o[r]=new Array(e),i=0;i<e;i++)o[r][i]=n(r,i);return o},p.zeros=function(t,e){return f(e)||(e=t),p.create(t,e,r)},p.ones=function(t,e){return f(e)||(e=t),p.create(t,e,i)},p.rand=function(t,e){return f(e)||(e=t),p.create(t,e,p._random_fn)},p.identity=function(t,e){return f(e)||(e=t),p.create(t,e,o)},p.symmetric=function(t){var e,n,r=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<r;e++)for(n=0;n<r;n++)if(t[n][e]!==t[e][n])return!1;return!0},p.clear=function(t){return p.alter(t,r)},p.seq=function(t,e,n,r){h(r)||(r=!1);for(var i=[],o=c(t,e),s=(e*o-t*o)/((n-1)*o),a=t,u=0;a<=e&&u<n;a=(t*o+s*o*++u)/o)i.push(r?r(a,u):a);return i},p.arange=function(t,e,n){var r,i=[];if(n=n||1,e===u&&(e=t,t=0),t===e||0===n)return[];if(t<e&&n<0)return[];if(e<t&&0<n)return[];if(0<n)for(r=t;r<e;r+=n)i.push(r);else for(r=t;e<r;r+=n)i.push(r);return i},p.slice=function(t,e){var n,r;return f((e=e||{}).row)?f(e.col)?t[e.row][e.col]:s(p.rowa(t,e.row),(n=e.col||{}).start,n.end,n.step):f(e.col)?s(p.cola(t,e.col),(r=e.row||{}).start,r.end,r.step):(r=e.row||{},n=e.col||{},s(t,r.start,r.end,r.step).map(function(t){return s(t,n.start,n.end,n.step)}))},p.sliceAssign=function(i,t,o){var e,n;if(f(t.row)){if(f(t.col))return i[t.row][t.col]=o;t.col=t.col||{},t.col.start=t.col.start||0,t.col.end=t.col.end||i[0].length,t.col.step=t.col.step||1,e=p.arange(t.col.start,a.min(i.length,t.col.end),t.col.step);var r=t.row;return e.forEach(function(t,e){i[r][t]=o[e]}),i}if(f(t.col)){t.row=t.row||{},t.row.start=t.row.start||0,t.row.end=t.row.end||i.length,t.row.step=t.row.step||1,n=p.arange(t.row.start,a.min(i[0].length,t.row.end),t.row.step);var s=t.col;return n.forEach(function(t,e){i[t][s]=o[e]}),i}return o[0].length===u&&(o=[o]),t.row.start=t.row.start||0,t.row.end=t.row.end||i.length,t.row.step=t.row.step||1,t.col.start=t.col.start||0,t.col.end=t.col.end||i[0].length,t.col.step=t.col.step||1,n=p.arange(t.row.start,a.min(i.length,t.row.end),t.row.step),e=p.arange(t.col.start,a.min(i[0].length,t.col.end),t.col.step),n.forEach(function(n,r){e.forEach(function(t,e){i[n][t]=o[r][e]})}),i},p.diagonal=function(t){var n=p.zeros(t.length,t.length);return t.forEach(function(t,e){n[e][e]=t}),n},p.copy=function(t){return t.map(function(t){return f(t)?t:t.map(function(t){return t})})};var d=p.prototype;return d.length=0,d.push=Array.prototype.push,d.sort=Array.prototype.sort,d.splice=Array.prototype.splice,d.slice=Array.prototype.slice,d.toArray=function(){return 1<this.length?t.call(this):t.call(this)[0]},d.map=function(t,e){return p(p.map(this,t,e))},d.cumreduce=function(t,e){return p(p.cumreduce(this,t,e))},d.alter=function(t){return p.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)!function(r){d[r]=function(t){var e,n=this;return t?(setTimeout(function(){t.call(n,d[r].call(n))}),this):(e=p[r](this),l(e)?p(e):e)}}(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(r){d[r]=function(t,e){var n=this;return e?(setTimeout(function(){e.call(n,d[r].call(n,t))}),this):p(p[r](this,t))}}(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){d[t]=function(){return p(p[t].apply(null,arguments))}}(t[e])}("create zeros ones rand identity".split(" ")),p}(Math);function o(t,e,n,r){for(var i,o=0,s=1,a=1,u=1,c=0,l=0;x.abs((a-l)/a)>r;)s=u+(i=-(e+c)*(e+n+c)*t/(e+2*c)/(e+2*c+1))*s,a=(o=(l=a)+i*o)+(i=(c+=1)*(n-c)*t/(e+2*c-1)/(e+2*c))*a,o/=u=s+i*u,s/=u,a/=u,u=1;return a/e}function v(t,e,n){var r=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],i=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],o=.5*t;if(8<=o)return 1;for(var s=(s=2*_.normal.cdf(o,0,1,1,0)-1)>=x.exp(-50/n)?x.pow(s,n):0,a=3<t?2:3,u=o,c=(8-o)/a,l=u+c,h=0,f=n-1,p=1;p<=a;p++){for(var d=0,g=.5*(l+u),m=.5*(l-u),v=1;v<=12;v++){var y,b=6<v?r[(y=12-v+1)-1]:-r[(y=v)-1],w=g+m*b,b=w*w;if(60<b)break;w=.5*(2*_.normal.cdf(w,0,1,1,0))-.5*(2*_.normal.cdf(w,t,1,1,0));w>=x.exp(-30/f)&&(d+=i[y-1]*x.exp(-.5*b)*x.pow(w,f))}h+=d*=2*m*n/x.sqrt(2*x.PI),u=l,l+=c}return(s+=h)<=x.exp(-30/e)?0:1<=(s=x.pow(s,e))?1:s}function y(t){return e(t)||t instanceof m}function b(t,e,n,r){if(1<t||1<n||t<=0||n<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(t*e+n*r)/(e+r);return(t-n)/l.sqrt(i*(1-i)*(1/e+1/r))}function w(t,e){var n=t.length,r=e[0].length-1,i=n-r-1,o=f.lstsq(e,t),s=f.multiply(e,o.map(function(t){return[t]})).map(function(t){return t[0]}),a=f.subtract(t,s),u=f.mean(t),c=f.sum(s.map(function(t){return Math.pow(t-u,2)})),l=f.sum(t.map(function(t,e){return Math.pow(t-s[e],2)})),h=c+l;return{exog:e,endog:t,nobs:n,df_model:r,df_resid:i,coef:o,predict:s,resid:a,ybar:u,SST:h,SSE:c,SSR:l,R2:c/h}}function C(e){var n,r,t=(n=e.exog,r=n[0].length,f.arange(r).map(function(e){var t=f.arange(r).filter(function(t){return t!==e});return w(f.col(n,e).map(function(t){return t[0]}),f.col(n,t))})),i=Math.sqrt(e.SSR/e.df_resid),o=t.map(function(t){var e=t.SST,t=t.R2;return i/Math.sqrt(e*(1-t))}),s=e.coef.map(function(t,e){return+t/o[e]}),a=s.map(function(t){t=f.studentt.cdf(t,e.df_resid);return 2*(.5<t?1-t:t)}),u=f.studentt.inv(.975,e.df_resid),t=e.coef.map(function(t,e){e=u*o[e];return[t-e,t+e]});return{se:o,t:s,p:a,sigmaHat:i,interval95:t}}return function(u,l){var c=u.utils.isFunction;function h(t,e){return t-e}function f(t,e,n){return l.max(e,l.min(t,n))}u.sum=function(t){for(var e=0,n=t.length;0<=--n;)e+=t[n];return e},u.sumsqrd=function(t){for(var e=0,n=t.length;0<=--n;)e+=t[n]*t[n];return e},u.sumsqerr=function(t){for(var e,n=u.mean(t),r=0,i=t.length;0<=--i;)r+=(e=t[i]-n)*e;return r},u.sumrow=function(t){for(var e=0,n=t.length;0<=--n;)e+=t[n];return e},u.product=function(t){for(var e=1,n=t.length;0<=--n;)e*=t[n];return e},u.min=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]<e&&(e=t[n]);return e},u.max=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]>e&&(e=t[n]);return e},u.unique=function(t){for(var e={},n=[],r=0;r<t.length;r++)e[t[r]]||(e[t[r]]=!0,n.push(t[r]));return n},u.mean=function(t){return u.sum(t)/t.length},u.meansqerr=function(t){return u.sumsqerr(t)/t.length},u.geomean=function(t){return l.pow(u.product(t),1/t.length)},u.median=function(t){var e=t.length,t=t.slice().sort(h);return 1&e?t[e/2|0]:(t[e/2-1]+t[e/2])/2},u.cumsum=function(t){return u.cumreduce(t,function(t,e){return t+e})},u.cumprod=function(t){return u.cumreduce(t,function(t,e){return t*e})},u.diff=function(t){for(var e=[],n=t.length,r=1;r<n;r++)e.push(t[r]-t[r-1]);return e},u.rank=function(t){for(var e=[],n={},r=0;r<t.length;r++)n[a=t[r]]?n[a]++:(n[a]=1,e.push(a));var i=e.sort(h),o={},s=1;for(r=0;r<i.length;r++){var a,u=n[a=i[r]],c=(s+(s+u-1))/2;o[a]=c,s+=u}return t.map(function(t){return o[t]})},u.mode=function(t){for(var e=t.length,n=t.slice().sort(h),r=1,i=0,o=0,s=[],a=0;a<e;a++)n[a]===n[a+1]?r++:(i<r?(s=[n[a]],i=r,o=0):r===i&&(s.push(n[a]),o++),r=1);return 0===o?s[0]:s},u.range=function(t){return u.max(t)-u.min(t)},u.variance=function(t,e){return u.sumsqerr(t)/(t.length-(e?1:0))},u.pooledvariance=function(t){return t.reduce(function(t,e){return t+u.sumsqerr(e)},0)/(t.reduce(function(t,e){return t+e.length},0)-t.length)},u.deviation=function(t){for(var e=u.mean(t),n=t.length,r=new Array(n),i=0;i<n;i++)r[i]=t[i]-e;return r},u.stdev=function(t,e){return l.sqrt(u.variance(t,e))},u.pooledstdev=function(t){return l.sqrt(u.pooledvariance(t))},u.meandev=function(t){for(var e=u.mean(t),n=[],r=t.length-1;0<=r;r--)n.push(l.abs(t[r]-e));return u.mean(n)},u.meddev=function(t){for(var e=u.median(t),n=[],r=t.length-1;0<=r;r--)n.push(l.abs(t[r]-e));return u.median(n)},u.coeffvar=function(t){return u.stdev(t)/u.mean(t)},u.quartiles=function(t){var e=t.length,t=t.slice().sort(h);return[t[l.round(e/4)-1],t[l.round(e/2)-1],t[l.round(3*e/4)-1]]},u.quantiles=function(t,e,n,r){var i,o,s,a=t.slice().sort(h),u=[e.length],c=t.length;for(void 0===n&&(n=3/8),void 0===r&&(r=3/8),i=0;i<e.length;i++)s=c*(o=e[i])+(n+o*(1-n-r)),o=l.floor(f(s,1,c-1)),s=f(s-o,0,1),u[i]=(1-s)*a[o-1]+s*a[o];return u},u.percentile=function(t,e,n){t=t.slice().sort(h),e=e*(t.length+(n?1:-1))+(n?0:1),n=parseInt(e),e-=n;return n+1<t.length?t[n-1]+e*(t[n]-t[n-1]):t[n-1]},u.percentileOfScore=function(t,e,n){for(var r,i=0,o=t.length,s="strict"===n?!0:!1,a=0;a<o;a++)r=t[a],(s&&r<e||!s&&r<=e)&&i++;return i/o},u.histogram=function(t,e){e=e||4;for(var n=u.min(t),r=(u.max(t)-n)/e,i=t.length,o=[],s=0;s<e;s++)o[s]=0;for(s=0;s<i;s++)o[l.min(l.floor((t[s]-n)/r),e-1)]+=1;return o},u.covariance=function(t,e){for(var n=u.mean(t),r=u.mean(e),i=t.length,o=new Array(i),s=0;s<i;s++)o[s]=(t[s]-n)*(e[s]-r);return u.sum(o)/(i-1)},u.corrcoeff=function(t,e){return u.covariance(t,e)/u.stdev(t,1)/u.stdev(e,1)},u.spearmancoeff=function(t,e){return t=u.rank(t),e=u.rank(e),u.corrcoeff(t,e)},u.stanMoment=function(t,e){for(var n=u.mean(t),r=u.stdev(t),i=t.length,o=0,s=0;s<i;s++)o+=l.pow((t[s]-n)/r,e);return o/t.length},u.skewness=function(t){return u.stanMoment(t,3)},u.kurtosis=function(t){return u.stanMoment(t,4)-3};var p=u.prototype;!function(t){for(var e=0;e<t.length;e++)!function(o){p[o]=function(t,e){var n=[],r=0,i=this;if(c(t)&&(e=t,t=!1),e)return setTimeout(function(){e.call(i,p[o].call(i,t))}),this;if(1<this.length){for(i=!0===t?this:this.transpose();r<i.length;r++)n[r]=u[o](i[r]);return n}return u[o](this[0],t)}}(t[e])}("cumsum cumprod".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(o){p[o]=function(t,e){var n=[],r=0,i=this;if(c(t)&&(e=t,t=!1),e)return setTimeout(function(){e.call(i,p[o].call(i,t))}),this;if(1<this.length){for("sumrow"!==o&&(i=!0===t?this:this.transpose());r<i.length;r++)n[r]=u[o](i[r]);return!0===t?u[o](u.utils.toVector(n)):n}return u[o](this[0],t)}}(t[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(a){p[a]=function(){var t,e=[],n=0,r=this,i=Array.prototype.slice.call(arguments);if(c(i[i.length-1])){t=i[i.length-1];var o=i.slice(0,i.length-1);return setTimeout(function(){t.call(r,p[a].apply(r,o))}),this}t=void 0;var s=function(t){return u[a].apply(r,[t].concat(i))};if(1<this.length){for(r=r.transpose();n<r.length;n++)e[n]=s(r[n]);return e}return s(this[0])}}(t[e])}("quantiles percentileOfScore".split(" "))}(f,Math),p=f,d=Math,p.gammaln=function(t){var e,n,r=0,i=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],o=1.000000000190015,t=(n=e=t)+5.5;for(t-=(e+.5)*d.log(t);r<6;r++)o+=i[r]/++n;return d.log(2.5066282746310007*o/e)-t},p.loggam=function(t){var e,n,r,i,o,s=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],a=t,u=0;if(1==t||2==t)return 0;for(t<=7&&(a=t+(u=d.floor(7-t))),e=1/(a*a),n=2*d.PI,i=s[9],o=8;0<=o;o--)i*=e,i+=s[o];if(r=i/a+.5*d.log(n)+(a-.5)*d.log(a)-a,t<=7)for(o=1;o<=u;o++)r-=d.log(a-1),--a;return r},p.gammafn=function(t){var e,n,r,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],o=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,a=0,u=0,c=0,l=t;if(171.6243769536076<t)return 1/0;if(l<=0){if(!(r=l%1+36e-17))return 1/0;s=(1&l?-1:1)*d.PI/d.sin(d.PI*r),l=1-l}for(n=(t=l)<1?l++:(l-=a=(0|l)-1)-1,e=0;e<8;++e)c=(c+i[e])*n,u=u*n+o[e];if(r=c/u+1,t<l)r/=t;else if(l<t)for(e=0;e<a;++e)r*=l,l++;return s&&(r=s/r),r},p.gammap=function(t,e){return p.lowRegGamma(t,e)*p.gammafn(t)},p.lowRegGamma=function(t,e){var n,r=p.gammaln(t),i=t,o=1/t,s=o,a=e+1-t,u=1/1e-30,c=1/a,l=c,h=1,f=-~(8.5*d.log(1<=t?t:1/t)+.4*t+17);if(e<0||t<=0)return NaN;if(e<t+1){for(;h<=f;h++)o+=s*=e/++i;return o*d.exp(-e+t*d.log(e)-r)}for(;h<=f;h++)l*=(c=1/(c=(n=-h*(h-t))*c+(a+=2)))*(u=a+n/u);return 1-l*d.exp(-e+t*d.log(e)-r)},p.factorialln=function(t){return t<0?NaN:p.gammaln(t+1)},p.factorial=function(t){return t<0?NaN:p.gammafn(t+1)},p.combination=function(t,e){return 170<t||170<e?d.exp(p.combinationln(t,e)):p.factorial(t)/p.factorial(e)/p.factorial(t-e)},p.combinationln=function(t,e){return p.factorialln(t)-p.factorialln(e)-p.factorialln(t-e)},p.permutation=function(t,e){return p.factorial(t)/p.factorial(t-e)},p.betafn=function(t,e){if(!(t<=0||e<=0))return 170<t+e?d.exp(p.betaln(t,e)):p.gammafn(t)*p.gammafn(e)/p.gammafn(t+e)},p.betaln=function(t,e){return p.gammaln(t)+p.gammaln(e)-p.gammaln(t+e)},p.betacf=function(t,e,n){var r,i,o,s=1e-30,a=1,u=e+n,c=e+1,l=e-1,h=1,f=1-u*t/c;for(d.abs(f)<s&&(f=s),o=f=1/f;a<=100&&(f=1+(i=a*(n-a)*t/((l+(r=2*a))*(e+r)))*f,d.abs(f)<s&&(f=s),h=1+i/h,d.abs(h)<s&&(h=s),o*=(f=1/f)*h,f=1+(i=-(e+a)*(u+a)*t/((e+r)*(c+r)))*f,d.abs(f)<s&&(f=s),h=1+i/h,d.abs(h)<s&&(h=s),o*=i=(f=1/f)*h,!(d.abs(i-1)<3e-7));a++);return o},p.gammapinv=function(t,e){var n,r,i,o,s,a,u=0,c=e-1,l=p.gammaln(e);if(1<=t)return d.max(100,e+100*d.sqrt(e));if(t<=0)return 0;for(n=1<e?(s=d.log(c),a=d.exp(c*(s-1)-l),o=t<.5?t:1-t,n=(2.30753+.27061*(r=d.sqrt(-2*d.log(o))))/(1+r*(.99229+.04481*r))-r,t<.5&&(n=-n),d.max(.001,e*d.pow(1-1/(9*e)-n/(3*d.sqrt(e)),3))):t<(r=1-e*(.253+.12*e))?d.pow(t/r,1/e):1-d.log(1-(t-r)/(1-r));u<12;u++){if(n<=0)return 0;if((n-=r=(i=(p.lowRegGamma(e,n)-t)/(r=1<e?a*d.exp(-(n-c)+c*(d.log(n)-s)):d.exp(-n+c*d.log(n)-l)))/(1-.5*d.min(1,i*((e-1)/n-1))))<=0&&(n=.5*(n+r)),d.abs(r)<1e-8*n)break}return n},p.erf=function(t){var e,n,r,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],o=i.length-1,s=!1,a=0,u=0;for(t<0&&(t=-t,s=!0),n=4*(e=2/(2+t))-2;0<o;o--)a=n*(r=a)-u+i[o],u=r;return t=e*d.exp(-t*t+.5*(i[0]+n*a)-u),s?t-1:1-t},p.erfc=function(t){return 1-p.erf(t)},p.erfcinv=function(t){var e,n,r,i,o=0;if(2<=t)return-100;if(t<=0)return 100;for(i=t<1?t:2-t,e=-.70711*((2.30753+.27061*(r=d.sqrt(-2*d.log(i/2))))/(1+r*(.99229+.04481*r))-r);o<2;o++)e+=(n=p.erfc(e)-i)/(1.1283791670955126*d.exp(-e*e)-e*n);return t<1?e:-e},p.ibetainv=function(t,e,n){var r,i,o,s,a,u,c,l=e-1,h=n-1,f=0;if(t<=0)return 0;if(1<=t)return 1;for(o=1<=e&&1<=n?(u=t<.5?t:1-t,o=(2.30753+.27061*(r=d.sqrt(-2*d.log(u))))/(1+r*(.99229+.04481*r))-r,t<.5&&(o=-o),s=(o*o-3)/6,a=2/(1/(2*e-1)+1/(2*n-1)),u=o*d.sqrt(s+a)/a-(1/(2*n-1)-1/(2*e-1))*(s+5/6-2/(3*a)),e/(e+n*d.exp(2*u))):(s=d.log(e/(e+n)),a=d.log(n/(e+n)),t<(r=d.exp(e*s)/e)/(u=r+(i=d.exp(n*a)/n))?d.pow(e*u*t,1/e):1-d.pow(n*u*(1-t),1/n)),c=-p.gammaln(e)-p.gammaln(n)+p.gammaln(e+n);f<10;f++){if(0===o||1===o)return o;if((o-=r=(i=(p.ibeta(o,e,n)-t)/(r=d.exp(l*d.log(o)+h*d.log(1-o)+c)))/(1-.5*d.min(1,i*(l/o-h/(1-o)))))<=0&&(o=.5*(o+r)),1<=o&&(o=.5*(o+r+1)),d.abs(r)<1e-8*o&&0<f)break}return o},p.ibeta=function(t,e,n){var r=0===t||1===t?0:d.exp(p.gammaln(e+n)-p.gammaln(e)-p.gammaln(n)+e*d.log(t)+n*d.log(1-t));return!(t<0||1<t)&&(t<(e+1)/(e+n+2)?r*p.betacf(t,e,n)/e:1-r*p.betacf(1-t,n,e)/n)},p.randn=function(t,e){var n,r,i,o;if(e=e||t,t)return p.create(t,e,function(){return p.randn()});for(;n=p._random_fn(),r=1.7156*(p._random_fn()-.5),o=(o=n-.449871)*o+(i=d.abs(r)+.386595)*(.196*i-.25472*o),.27597<o&&(.27846<o||r*r>-4*d.log(n)*n*n););return r/n},p.randg=function(t,e,n){var r,i,o,s,a,u=t;if(n=n||e,t=t||1,e)return(n=p.zeros(e,n)).alter(function(){return p.randg(t)}),n;t<1&&(t+=1),r=t-1/3,i=1/d.sqrt(9*r);do{for(;s=1+i*(a=p.randn()),s<=0;);}while(s*=s*s,(o=p._random_fn())>1-.331*d.pow(a,4)&&d.log(o)>.5*a*a+r*(1-s+d.log(s)));if(t==u)return r*s;for(;o=p._random_fn(),0===o;);return d.pow(o,1/u)*r*s},function(t){for(var e=0;e<t.length;e++)!function(e){p.fn[e]=function(){return p(p.map(this,function(t){return p[e](t)}))}}(t[e])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p.fn[t]=function(){return p(p[t].apply(null,arguments))}}(t[e])}("randn".split(" ")),_=f,x=Math,function(t){for(var e=0;e<t.length;e++)!function(o){_[o]=function(t,e,n){return this instanceof arguments.callee?(this._a=t,this._b=e,this._c=n,this):new arguments.callee(t,e,n)},_.fn[o]=function(t,e,n){n=_[o](t,e,n);return n.data=this,n},_[o].prototype.sample=function(t){var e=this._a,n=this._b,r=this._c;return t?_.alter(t,function(){return _[o].sample(e,n,r)}):_[o].sample(e,n,r)},function(t){for(var e=0;e<t.length;e++)!function(i){_[o].prototype[i]=function(t){var e=this._a,n=this._b,r=this._c;return t||0===t||(t=this.data),"number"!=typeof t?_.fn.map.call(t,function(t){return _[o][i](t,e,n,r)}):_[o][i](t,e,n,r)}}(t[e])}("pdf cdf inv".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){_[o].prototype[t]=function(){return _[o][t](this._a,this._b,this._c)}}(t[e])}("mean median mode variance".split(" "))}(t[e])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),_.extend(_.beta,{pdf:function(t,e,n){return 1<t||t<0?0:1==e&&1==n?1:e<512&&n<512?x.pow(t,e-1)*x.pow(1-t,n-1)/_.betafn(e,n):x.exp((e-1)*x.log(t)+(n-1)*x.log(1-t)-_.betaln(e,n))},cdf:function(t,e,n){return 1<t||t<0?+(1<t):_.ibeta(t,e,n)},inv:function(t,e,n){return _.ibetainv(t,e,n)},mean:function(t,e){return t/(t+e)},median:function(t,e){return _.ibetainv(.5,t,e)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(t,e){t=_.randg(t);return t/(t+_.randg(e))},variance:function(t,e){return t*e/(x.pow(t+e,2)*(t+e+1))}}),_.extend(_.centralF,{pdf:function(t,e,n){var r;return t<0?0:e<=2?0===t&&e<2?1/0:0===t&&2===e?1:1/_.betafn(e/2,n/2)*x.pow(e/n,e/2)*x.pow(t,e/2-1)*x.pow(1+e/n*t,-(e+n)/2):(r=e*t/(n+t*e),e*(n/(n+t*e))/2*_.binomial.pdf((e-2)/2,(e+n-2)/2,r))},cdf:function(t,e,n){return t<0?0:_.ibeta(e*t/(e*t+n),e/2,n/2)},inv:function(t,e,n){return n/(e*(1/_.ibetainv(t,e/2,n/2)-1))},mean:function(t,e){return 2<e?e/(e-2):void 0},mode:function(t,e){return 2<t?e*(t-2)/(t*(e+2)):void 0},sample:function(t,e){return 2*_.randg(t/2)/t/(2*_.randg(e/2)/e)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),_.extend(_.cauchy,{pdf:function(t,e,n){return n<0?0:n/(x.pow(t-e,2)+x.pow(n,2))/x.PI},cdf:function(t,e,n){return x.atan((t-e)/n)/x.PI+.5},inv:function(t,e,n){return e+n*x.tan(x.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(t,e){return _.randn()*x.sqrt(1/(2*_.randg(.5)))*e+t}}),_.extend(_.chisquare,{pdf:function(t,e){return t<0?0:0===t&&2===e?.5:x.exp((e/2-1)*x.log(t)-t/2-e/2*x.log(2)-_.gammaln(e/2))},cdf:function(t,e){return t<0?0:_.lowRegGamma(e/2,t/2)},inv:function(t,e){return 2*_.gammapinv(t,.5*e)},mean:function(t){return t},median:function(t){return t*x.pow(1-2/(9*t),3)},mode:function(t){return 0<t-2?t-2:0},sample:function(t){return 2*_.randg(t/2)},variance:function(t){return 2*t}}),_.extend(_.exponential,{pdf:function(t,e){return t<0?0:e*x.exp(-e*t)},cdf:function(t,e){return t<0?0:1-x.exp(-e*t)},inv:function(t,e){return-x.log(1-t)/e},mean:function(t){return 1/t},median:function(t){return 1/t*x.log(2)},mode:function(){return 0},sample:function(t){return-1/t*x.log(_._random_fn())},variance:function(t){return x.pow(t,-2)}}),_.extend(_.gamma,{pdf:function(t,e,n){return t<0?0:0===t&&1===e?1/n:x.exp((e-1)*x.log(t)-t/n-_.gammaln(e)-e*x.log(n))},cdf:function(t,e,n){return t<0?0:_.lowRegGamma(e,t/n)},inv:function(t,e,n){return _.gammapinv(t,e)*n},mean:function(t,e){return t*e},mode:function(t,e){if(1<t)return(t-1)*e},sample:function(t,e){return _.randg(t)*e},variance:function(t,e){return t*e*e}}),_.extend(_.invgamma,{pdf:function(t,e,n){return t<=0?0:x.exp(-(e+1)*x.log(t)-n/t-_.gammaln(e)+e*x.log(n))},cdf:function(t,e,n){return t<=0?0:1-_.lowRegGamma(e,n/t)},inv:function(t,e,n){return n/_.gammapinv(1-t,e)},mean:function(t,e){return 1<t?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(t,e){return e/_.randg(t)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),_.extend(_.kumaraswamy,{pdf:function(t,e,n){return 0===t&&1===e?n:1===t&&1===n?e:x.exp(x.log(e)+x.log(n)+(e-1)*x.log(t)+(n-1)*x.log(1-x.pow(t,e)))},cdf:function(t,e,n){return t<0?0:1<t?1:1-x.pow(1-x.pow(t,e),n)},inv:function(t,e,n){return x.pow(1-x.pow(1-t,1/n),1/e)},mean:function(t,e){return e*_.gammafn(1+1/t)*_.gammafn(e)/_.gammafn(1+1/t+e)},median:function(t,e){return x.pow(1-x.pow(2,-1/e),1/t)},mode:function(t,e){if(1<=t&&1<=e&&1!==t&&1!==e)return x.pow((t-1)/(t*e-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),_.extend(_.lognormal,{pdf:function(t,e,n){return t<=0?0:x.exp(-x.log(t)-.5*x.log(2*x.PI)-x.log(n)-x.pow(x.log(t)-e,2)/(2*n*n))},cdf:function(t,e,n){return t<0?0:.5+.5*_.erf((x.log(t)-e)/x.sqrt(2*n*n))},inv:function(t,e,n){return x.exp(-1.4142135623730951*n*_.erfcinv(2*t)+e)},mean:function(t,e){return x.exp(t+e*e/2)},median:function(t){return x.exp(t)},mode:function(t,e){return x.exp(t-e*e)},sample:function(t,e){return x.exp(_.randn()*e+t)},variance:function(t,e){return(x.exp(e*e)-1)*x.exp(2*t+e*e)}}),_.extend(_.noncentralt,{pdf:function(t,e,n){return x.abs(n)<1e-14?_.studentt.pdf(t,e):x.abs(t)<1e-14?x.exp(_.gammaln((e+1)/2)-n*n/2-.5*x.log(x.PI*e)-_.gammaln(e/2)):e/t*(_.noncentralt.cdf(t*x.sqrt(1+2/e),e+2,n)-_.noncentralt.cdf(t,e,n))},cdf:function(t,e,n){if(x.abs(n)<1e-14)return _.studentt.cdf(t,e);var r=!1;t<0&&(r=!0,n=-n);for(var i=_.normal.cdf(-n,0,1),o=1e-14+1,s=o,a=t*t/(t*t+e),u=0,c=x.exp(-n*n/2),l=x.exp(-n*n/2-.5*x.log(2)-_.gammaln(1.5))*n;u<200||1e-14<s||1e-14<o;)s=o,0<u&&(c*=n*n/(2*u),l*=n*n/(2*(u+.5))),i+=.5*(o=c*_.beta.cdf(a,u+.5,e/2)+l*_.beta.cdf(a,u+1,e/2)),u++;return r?1-i:i}}),_.extend(_.normal,{pdf:function(t,e,n){return x.exp(-.5*x.log(2*x.PI)-x.log(n)-x.pow(t-e,2)/(2*n*n))},cdf:function(t,e,n){return.5*(1+_.erf((t-e)/x.sqrt(2*n*n)))},inv:function(t,e,n){return-1.4142135623730951*n*_.erfcinv(2*t)+e},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(t,e){return _.randn()*e+t},variance:function(t,e){return e*e}}),_.extend(_.pareto,{pdf:function(t,e,n){return t<e?0:n*x.pow(e,n)/x.pow(t,n+1)},cdf:function(t,e,n){return t<e?0:1-x.pow(e/t,n)},inv:function(t,e,n){return e/x.pow(1-t,1/n)},mean:function(t,e){if(!(e<=1))return e*x.pow(t,e)/(e-1)},median:function(t,e){return t*(e*x.SQRT2)},mode:function(t){return t},variance:function(t,e){if(!(e<=2))return t*t*e/(x.pow(e-1,2)*(e-2))}}),_.extend(_.studentt,{pdf:function(t,e){return e=1e100<e?1e100:e,1/(x.sqrt(e)*_.betafn(.5,e/2))*x.pow(1+t*t/e,-(e+1)/2)},cdf:function(t,e){var n=e/2;return _.ibeta((t+x.sqrt(t*t+e))/(2*x.sqrt(t*t+e)),n,n)},inv:function(t,e){var n=_.ibetainv(2*x.min(t,1-t),.5*e,.5),n=x.sqrt(e*(1-n)/n);return.5<t?n:-n},mean:function(t){return 1<t?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(t){return _.randn()*x.sqrt(t/(2*_.randg(t/2)))},variance:function(t){return 2<t?t/(t-2):1<t?1/0:void 0}}),_.extend(_.weibull,{pdf:function(t,e,n){return t<0||e<0||n<0?0:n/e*x.pow(t/e,n-1)*x.exp(-x.pow(t/e,n))},cdf:function(t,e,n){return t<0?0:1-x.exp(-x.pow(t/e,n))},inv:function(t,e,n){return e*x.pow(-x.log(1-t),1/n)},mean:function(t,e){return t*_.gammafn(1+1/e)},median:function(t,e){return t*x.pow(x.log(2),1/e)},mode:function(t,e){return e<=1?0:t*x.pow((e-1)/e,1/e)},sample:function(t,e){return t*x.pow(-x.log(_._random_fn()),1/e)},variance:function(t,e){return t*t*_.gammafn(1+2/e)-x.pow(_.weibull.mean(t,e),2)}}),_.extend(_.uniform,{pdf:function(t,e,n){return t<e||n<t?0:1/(n-e)},cdf:function(t,e,n){return t<e?0:t<n?(t-e)/(n-e):1},inv:function(t,e,n){return e+t*(n-e)},mean:function(t,e){return.5*(t+e)},median:function(t,e){return _.mean(t,e)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,e){return t/2+e/2+(e/2-t/2)*(2*_._random_fn()-1)},variance:function(t,e){return x.pow(e-t,2)/12}}),_.extend(_.binomial,{pdf:function(t,e,n){return 0===n||1===n?e*n===t?1:0:_.combination(e,t)*x.pow(n,t)*x.pow(1-n,e-t)},cdf:function(t,e,n){if(t<0)return 0;if(e<=t)return 1;if(n<0||1<n||e<=0)return NaN;var r=n,i=(t=x.floor(t))+1,n=e-t,e=i+n,t=x.exp(_.gammaln(e)-_.gammaln(n)-_.gammaln(i)+i*x.log(r)+n*x.log(1-r)),i=r<(i+1)/(e+2)?t*o(r,i,n,1e-10):1-t*o(1-r,n,i,1e-10);return x.round(1e10*(1-i))/1e10}}),_.extend(_.negbin,{pdf:function(t,e,n){return t===t>>>0&&(t<0?0:_.combination(t+e-1,e-1)*x.pow(1-n,t)*x.pow(n,e))},cdf:function(t,e,n){var r=0,i=0;if(t<0)return 0;for(;i<=t;i++)r+=_.negbin.pdf(i,e,n);return r}}),_.extend(_.hypgeom,{pdf:function(t,e,n,r){if(t!=t|0)return!1;if(t<0||t<n-(e-r))return 0;if(r<t||n<t)return 0;if(e<2*n)return e<2*r?_.hypgeom.pdf(e-n-r+t,e,e-n,e-r):_.hypgeom.pdf(r-t,e,e-n,r);if(e<2*r)return _.hypgeom.pdf(n-t,e,n,e-r);if(n<r)return _.hypgeom.pdf(t,e,r,n);for(var i=1,o=0,s=0;s<t;s++){for(;1<i&&o<r;)i*=1-n/(e-o),o++;i*=(r-s)*(n-s)/((s+1)*(e-n-r+s+1))}for(;o<r;o++)i*=1-n/(e-o);return x.min(1,x.max(0,i))},cdf:function(t,e,n,r){if(t<0||t<n-(e-r))return 0;if(r<=t||n<=t)return 1;if(e<2*n)return e<2*r?_.hypgeom.cdf(e-n-r+t,e,e-n,e-r):1-_.hypgeom.cdf(r-t-1,e,e-n,r);if(e<2*r)return 1-_.hypgeom.cdf(n-t-1,e,n,e-r);if(n<r)return _.hypgeom.cdf(t,e,r,n);for(var i=1,o=1,s=0,a=0;a<t;a++){for(;1<i&&s<r;){var u=1-n/(e-s);o*=u,i*=u,s++}i+=o*=(r-a)*(n-a)/((a+1)*(e-n-r+a+1))}for(;s<r;s++)i*=1-n/(e-s);return x.min(1,x.max(0,i))}}),_.extend(_.poisson,{pdf:function(t,e){return e<0||t%1!=0||t<0?0:x.pow(e,t)*x.exp(-e)/_.factorial(t)},cdf:function(t,e){var n=[],r=0;if(t<0)return 0;for(;r<=t;r++)n.push(_.poisson.pdf(r,e));return _.sum(n)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(t){for(var e=1,n=0,r=x.exp(-t);n++,e*=_._random_fn(),r<e;);return n-1},sampleLarge:function(t){for(var e,n,r,i=t,t=x.sqrt(i),o=x.log(i),s=.931+2.53*t,a=.02483*s-.059,u=1.1239+1.1328/(s-3.4),c=.9277-3.6224/(s-2);;){if(e=x.random()-.5,n=x.random(),r=.5-x.abs(e),e=x.floor((2*a/r+s)*e+i+.43),.07<=r&&n<=c)return e;if(!(e<0||r<.013&&r<n)&&x.log(n)+x.log(u)-x.log(a/(r*r)+s)<=e*o-i-_.loggam(e+1))return e}},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),_.extend(_.triangular,{pdf:function(t,e,n,r){return n<=e||r<e||n<r?NaN:t<e||n<t?0:t<r?2*(t-e)/((n-e)*(r-e)):t===r?2/(n-e):2*(n-t)/((n-e)*(n-r))},cdf:function(t,e,n,r){return n<=e||r<e||n<r?NaN:t<=e?0:n<=t?1:t<=r?x.pow(t-e,2)/((n-e)*(r-e)):1-x.pow(n-t,2)/((n-e)*(n-r))},inv:function(t,e,n,r){return n<=e||r<e||n<r?NaN:t<=(r-e)/(n-e)?e+(n-e)*x.sqrt(t*((r-e)/(n-e))):e+(n-e)*(1-x.sqrt((1-t)*(1-(r-e)/(n-e))))},mean:function(t,e,n){return(t+e+n)/3},median:function(t,e,n){return n<=(t+e)/2?e-x.sqrt((e-t)*(e-n))/x.sqrt(2):(t+e)/2<n?t+x.sqrt((e-t)*(n-t))/x.sqrt(2):void 0},mode:function(t,e,n){return n},sample:function(t,e,n){var r=_._random_fn();return r<(n-t)/(e-t)?t+x.sqrt(r*(e-t)*(n-t)):e-x.sqrt((1-r)*(e-t)*(e-n))},variance:function(t,e,n){return(t*t+e*e+n*n-t*e-t*n-e*n)/18}}),_.extend(_.arcsine,{pdf:function(t,e,n){return n<=e?NaN:t<=e||n<=t?0:2/x.PI*x.pow(x.pow(n-e,2)-x.pow(2*t-e-n,2),-.5)},cdf:function(t,e,n){return t<e?0:t<n?2/x.PI*x.asin(x.sqrt((t-e)/(n-e))):1},inv:function(t,e,n){return e+(.5-.5*x.cos(x.PI*t))*(n-e)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,e){return(t+e)/2+(e-t)/2*x.sin(2*x.PI*_.uniform.sample(0,1))},variance:function(t,e){return e<=t?NaN:x.pow(e-t,2)/8}}),_.extend(_.laplace,{pdf:function(t,e,n){return n<=0?0:x.exp(-x.abs(t-e)/n)/(2*n)},cdf:function(t,e,n){return n<=0?0:t<e?.5*x.exp((t-e)/n):1-.5*x.exp(-(t-e)/n)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,e){return 2*e*e},sample:function(t,e){var n=_._random_fn()-.5;return t-e*((e=n)/x.abs(e))*x.log(1-2*x.abs(n))}}),_.extend(_.tukey,{cdf:function(t,e,n){var r=e,i=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],o=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(t<=0)return 0;if(n<2||r<2)return NaN;if(!Number.isFinite(t))return 1;if(25e3<n)return v(t,1,r);var e=.5*n,s=e*x.log(n)-n*x.log(2)-_.gammaln(e),a=e-1,u=.25*n,c=n<=100?1:n<=800?.5:n<=5e3?.25:.125;s+=x.log(c);for(var l=0,h=1;h<=50;h++){for(var f=0,p=(2*h-1)*c,d=1;d<=16;d++){var g,m=8<d?(g=d-8-1,s+a*x.log(p+i[g]*c)-(i[g]*c+p)*u):(g=d-1,s+a*x.log(p-i[g]*c)+(i[g]*c-p)*u);-30<=m&&(f+=v(8<d?t*x.sqrt(.5*(i[g]*c+p)):t*x.sqrt(.5*(-i[g]*c+p)),1,r)*o[g]*x.exp(m))}if(1<=h*c&&f<=1e-14)break;l+=f}if(1e-14<f)throw new Error("tukey.cdf failed to converge");return 1<l&&(l=1),l},inv:function(t,e,n){if(n<2||e<2)return NaN;if(t<0||1<t)return NaN;if(0===t)return 0;if(1===t)return 1/0;for(var r,i,o,s,a=(i=e,o=n,s=.5-.5*(r=t),s=(r=x.sqrt(x.log(1/(s*s))))+((((-453642210148e-16*r-.204231210125)*r-.342242088547)*r-1)*r+.322232421088)/((((.0038560700634*r+.10353775285)*r+.531103462366)*r+.588581570495)*r+.099348462606),o<120&&(s+=(s*s*s+s)/o/4),r=.8832-.2368*s,o<120&&(r+=-1.214/o+1.208*s/o),s*(r*x.log(i-1)+1.4142)),u=0<(f=_.tukey.cdf(a,e,n)-t)?x.max(0,a-1):a+1,c=_.tukey.cdf(u,e,n)-t,l=1;l<50;l++){var h=u-c*(u-a)/(c-f),f=c,a=u;if(h<0&&(h=0,c=-t),c=_.tukey.cdf(h,e,n)-t,u=h,x.abs(u-a)<1e-4)return h}throw new Error("tukey.inv failed to converge")}}),m=f,g=Math,i=Array.prototype.push,e=m.utils.isArray,m.extend({add:function(t,r){return y(r)?(y(r[0])||(r=[r]),m.map(t,function(t,e,n){return t+r[e][n]})):m.map(t,function(t){return t+r})},subtract:function(t,r){return y(r)?(y(r[0])||(r=[r]),m.map(t,function(t,e,n){return t-r[e][n]||0})):m.map(t,function(t){return t-r})},divide:function(t,e){return y(e)?(y(e[0])||(e=[e]),m.multiply(t,m.inv(e))):m.map(t,function(t){return t/e})},multiply:function(t,e){var n,r,i,o,s,a,u,c;if(void 0===t.length&&void 0===e.length)return t*e;if(s=t.length,a=t[0].length,u=m.zeros(s,i=y(e)?e[0].length:a),c=0,y(e)){for(;c<i;c++)for(n=0;n<s;n++){for(r=o=0;r<a;r++)o+=t[n][r]*e[r][c];u[n][c]=o}return 1===s&&1===c?u[0][0]:u}return m.map(t,function(t){return t*e})},outer:function(t,e){return m.multiply(t.map(function(t){return[t]}),[e])},dot:function(t,e){y(t[0])||(t=[t]),y(e[0])||(e=[e]);for(var n,r,i=1===t[0].length&&1!==t.length?m.transpose(t):t,o=1===e[0].length&&1!==e.length?m.transpose(e):e,s=[],a=0,u=i.length,c=i[0].length;a<u;a++){for(s[a]=[],r=n=0;r<c;r++)n+=i[a][r]*o[a][r];s[a]=n}return 1===s.length?s[0]:s},pow:function(t,e){return m.map(t,function(t){return g.pow(t,e)})},exp:function(t){return m.map(t,function(t){return g.exp(t)})},log:function(t){return m.map(t,function(t){return g.log(t)})},abs:function(t){return m.map(t,function(t){return g.abs(t)})},norm:function(t,e){var n=0,r=0;for(isNaN(e)&&(e=2),y(t[0])&&(t=t[0]);r<t.length;r++)n+=g.pow(g.abs(t[r]),e);return g.pow(n,1/e)},angle:function(t,e){return g.acos(m.dot(t,e)/(m.norm(t)*m.norm(e)))},aug:function(t,e){for(var n=[],r=0;r<t.length;r++)n.push(t[r].slice());for(r=0;r<n.length;r++)i.apply(n[r],e[r]);return n},inv:function(t){for(var e,n=t.length,r=t[0].length,i=m.identity(n,r),o=m.gauss_jordan(t,i),s=[],a=0;a<n;a++)for(s[a]=[],e=r;e<o[0].length;e++)s[a][e-r]=o[a][e];return s},det:function(t){var e,n=t.length,r=2*n,i=new Array(r),o=n-1,s=r-1,a=o-n+1,u=s,c=0,l=0;if(2===n)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(;c<r;c++)i[c]=1;for(c=0;c<n;c++){for(e=0;e<n;e++)i[a<0?a+n:a]*=t[c][e],i[u<n?u+n:u]*=t[c][e],a++,u--;a=--o-n+1,u=--s}for(c=0;c<n;c++)l+=i[c];for(;c<r;c++)l-=i[c];return l},gauss_elimination:function(t,e){for(var n,r,i,o,s=0,a=0,u=t.length,c=t[0].length,l=0,h=[],f=(t=m.aug(t,e))[0].length,s=0;s<u;s++){for(r=t[s][s],o=(a=s)+1;o<c;o++)r<g.abs(t[o][s])&&(r=t[o][s],a=o);if(a!=s)for(o=0;o<f;o++)i=t[s][o],t[s][o]=t[a][o],t[a][o]=i;for(a=s+1;a<u;a++)for(n=t[a][s]/t[s][s],o=s;o<f;o++)t[a][o]=t[a][o]-n*t[s][o]}for(s=u-1;0<=s;s--){for(l=0,a=s+1;a<=u-1;a++)l+=h[a]*t[s][a];h[s]=(t[s][f-1]-l)/t[s][s]}return h},gauss_jordan:function(t,e){for(var n,r=m.aug(t,e),i=r.length,o=r[0].length,s=0,a=0;a<i;a++){for(var u=a,c=a+1;c<i;c++)g.abs(r[c][a])>g.abs(r[u][a])&&(u=c);var l=r[a];for(r[a]=r[u],r[u]=l,c=a+1;c<i;c++)for(s=r[c][a]/r[a][a],n=a;n<o;n++)r[c][n]-=r[a][n]*s}for(a=i-1;0<=a;a--){for(s=r[a][a],c=0;c<a;c++)for(n=o-1;a-1<n;n--)r[c][n]-=r[a][n]*r[c][a]/s;for(r[a][a]/=s,n=i;n<o;n++)r[a][n]/=s}return r},triaUpSolve:function(n,t){var r,i=n[0].length,o=m.zeros(1,i)[0],e=!1;return null!=t[0].length&&(t=t.map(function(t){return t[0]}),e=!0),m.arange(i-1,-1,-1).forEach(function(e){r=m.arange(e+1,i).map(function(t){return o[t]*n[e][t]}),o[e]=(t[e]-m.sum(r))/n[e][e]}),e?o.map(function(t){return[t]}):o},triaLowSolve:function(n,t){var r,e=n[0].length,i=m.zeros(1,e)[0],o=!1;return null!=t[0].length&&(t=t.map(function(t){return t[0]}),o=!0),m.arange(e).forEach(function(e){r=m.arange(e).map(function(t){return n[e][t]*i[t]}),i[e]=(t[e]-m.sum(r))/n[e][e]}),o?i.map(function(t){return[t]}):i},lu:function(r){var t,e=r.length,i=m.identity(e),o=m.zeros(r.length,r[0].length);return m.arange(e).forEach(function(t){o[0][t]=r[0][t]}),m.arange(1,e).forEach(function(n){m.arange(n).forEach(function(e){t=m.arange(e).map(function(t){return i[n][t]*o[t][e]}),i[n][e]=(r[n][e]-m.sum(t))/o[e][e]}),m.arange(n,e).forEach(function(e){t=m.arange(n).map(function(t){return i[n][t]*o[t][e]}),o[n][e]=r[t.length][e]-m.sum(t)})}),[i,o]},cholesky:function(t){var r,e=t.length,i=m.zeros(t.length,t[0].length);return m.arange(e).forEach(function(n){r=m.arange(n).map(function(t){return g.pow(i[n][t],2)}),i[n][n]=g.sqrt(t[n][n]-m.sum(r)),m.arange(n+1,e).forEach(function(e){r=m.arange(n).map(function(t){return i[n][t]*i[e][t]}),i[e][n]=(t[n][e]-m.sum(r))/i[n][n]})}),i},gauss_jacobi:function(t,e,n,r){for(var i,o,s,a,u=0,c=0,l=t.length,h=[],f=[],p=[];u<l;u++)for(h[u]=[],f[u]=[],p[u]=[],c=0;c<l;c++)c<u?(h[u][c]=t[u][c],f[u][c]=p[u][c]=0):u<c?(f[u][c]=t[u][c],h[u][c]=p[u][c]=0):(p[u][c]=t[u][c],h[u][c]=f[u][c]=0);for(s=m.multiply(m.multiply(m.inv(p),m.add(h,f)),-1),o=m.multiply(m.inv(p),e),i=n,a=m.add(m.multiply(s,n),o),u=2;g.abs(m.norm(m.subtract(a,i)))>r;)i=a,a=m.add(m.multiply(s,i),o),u++;return a},gauss_seidel:function(t,e,n,r){for(var i,o,s,a,u,c=0,l=t.length,h=[],f=[],p=[];c<l;c++)for(h[c]=[],f[c]=[],p[c]=[],i=0;i<l;i++)i<c?(h[c][i]=t[c][i],f[c][i]=p[c][i]=0):c<i?(f[c][i]=t[c][i],h[c][i]=p[c][i]=0):(p[c][i]=t[c][i],h[c][i]=f[c][i]=0);for(a=m.multiply(m.multiply(m.inv(m.add(p,h)),f),-1),s=m.multiply(m.inv(m.add(p,h)),e),o=n,u=m.add(m.multiply(a,n),s),c=2;g.abs(m.norm(m.subtract(u,o)))>r;)o=u,u=m.add(m.multiply(a,o),s),c+=1;return u},SOR:function(t,e,n,r,i){for(var o,s,a,u,c,l=0,h=t.length,f=[],p=[],d=[];l<h;l++)for(f[l]=[],p[l]=[],d[l]=[],o=0;o<h;o++)o<l?(f[l][o]=t[l][o],p[l][o]=d[l][o]=0):l<o?(p[l][o]=t[l][o],f[l][o]=d[l][o]=0):(d[l][o]=t[l][o],f[l][o]=p[l][o]=0);for(u=m.multiply(m.inv(m.add(d,m.multiply(f,i))),m.subtract(m.multiply(d,1-i),m.multiply(p,i))),a=m.multiply(m.multiply(m.inv(m.add(d,m.multiply(f,i))),e),i),s=n,c=m.add(m.multiply(u,n),a),l=2;g.abs(m.norm(m.subtract(c,s)))>r;)s=c,c=m.add(m.multiply(u,s),a),l++;return c},householder:function(t){for(var e,n,r,i,o,s=t.length,a=t[0].length,u=0,c=[];u<s-1;u++){for(n=0,o=u+1;o<a;o++)n+=t[o][u]*t[o][u];for(n=(0<t[u+1][u]?-1:1)*g.sqrt(n),r=g.sqrt((n*n-t[u+1][u]*n)/2),(c=m.zeros(s,1))[u+1][0]=(t[u+1][u]-n)/(2*r),i=u+2;i<s;i++)c[i][0]=t[i][u]/(2*r);e=m.subtract(m.identity(s,a),m.multiply(m.multiply(c,m.transpose(c)),2)),t=m.multiply(e,m.multiply(t,e))}return t},QR:(a=m.sum,u=m.arange,function(e){var t,n,r,i=e.length,o=e[0].length,s=m.zeros(o,o);for(e=m.copy(e),n=0;n<o;n++){for(s[n][n]=g.sqrt(a(u(i).map(function(t){return e[t][n]*e[t][n]}))),t=0;t<i;t++)e[t][n]=e[t][n]/s[n][n];for(r=n+1;r<o;r++)for(s[n][r]=a(u(i).map(function(t){return e[t][n]*e[t][r]})),t=0;t<i;t++)e[t][r]=e[t][r]-e[t][n]*s[n][r]}return[e,s]}),lstsq:function(t,e){var n=!1;void 0===e[0].length&&(e=e.map(function(t){return[t]}),n=!0);var o,s,r=(i=m.QR(t))[0],i=i[1],t=t[0].length,r=m.slice(r,{col:{end:t}}),t=m.slice(i,{row:{end:t}}),t=(o=t,t=(o=m.copy(o)).length,s=m.identity(t),m.arange(t-1,-1,-1).forEach(function(i){m.sliceAssign(s,{row:i},m.divide(m.slice(s,{row:i}),o[i][i])),m.sliceAssign(o,{row:i},m.divide(m.slice(o,{row:i}),o[i][i])),m.arange(i).forEach(function(t){var e=m.multiply(o[t][i],-1),n=m.slice(o,{row:t}),r=m.multiply(m.slice(o,{row:i}),e);m.sliceAssign(o,{row:t},m.add(n,r));r=m.slice(s,{row:t}),e=m.multiply(m.slice(s,{row:i}),e);m.sliceAssign(s,{row:t},m.add(r,e))})}),s);return void 0===(r=m.transpose(r))[0].length&&(r=[r]),void 0===(e=m.multiply(m.multiply(t,r),e)).length&&(e=[[e]]),n?e.map(function(t){return t[0]}):e},jacobi:function(t){for(var e,n,r,i,o,s,a,u=1,c=t.length,l=m.identity(c,c),h=[];1===u;){for(o=t[0][1],i=1,e=r=0;e<c;e++)for(n=0;n<c;n++)e!=n&&o<g.abs(t[e][n])&&(o=g.abs(t[e][n]),r=e,i=n);for(s=t[r][r]===t[i][i]?0<t[r][i]?g.PI/4:-g.PI/4:g.atan(2*t[r][i]/(t[r][r]-t[i][i]))/2,(a=m.identity(c,c))[r][r]=g.cos(s),a[r][i]=-g.sin(s),a[i][r]=g.sin(s),a[i][i]=g.cos(s),l=m.multiply(l,a),t=m.multiply(m.multiply(m.inv(a),t),a),u=0,e=1;e<c;e++)for(n=1;n<c;n++)e!=n&&.001<g.abs(t[e][n])&&(u=1)}for(e=0;e<c;e++)h.push(t[e][e]);return[l,h]},rungekutta:function(t,e,n,r,i,o){var s,a,u;if(2===o)for(;r<=n;)i=i+((s=e*t(r,i))+(a=e*t(r+e,i+s)))/2,r+=e;if(4===o)for(;r<=n;)i=i+((s=e*t(r,i))+2*(a=e*t(r+e/2,i+s/2))+2*(u=e*t(r+e/2,i+a/2))+e*t(r+e,i+u))/6,r+=e;return i},romberg:function(t,e,n,r){for(var i,o,s,a,u,c=0,l=(n-e)/2,h=[],f=[],p=[];c<r/2;){for(u=t(e),s=e,a=0;s<=n;s+=l,a++)h[a]=s;for(i=h.length,s=1;s<i-1;s++)u+=(s%2!=0?4:2)*t(h[s]);u=l/3*(u+t(n)),p[c]=u,l/=2,c++}for(o=p.length,i=1;1!==o;){for(s=0;s<o-1;s++)f[s]=(g.pow(4,i)*p[s+1]-p[s])/(g.pow(4,i)-1);o=f.length,p=f,f=[],i++}return p},richardson:function(t,e,n,r){function i(t,e){for(var n,r=0,i=t.length;r<i;r++)t[r]===e&&(n=r);return n}for(var o,s,a,u,c,l=g.abs(n-t[i(t,n)+1]),h=0,f=[],p=[];l<=r;)o=i(t,n+r),s=i(t,n),f[h]=(e[o]-2*e[s]+e[2*s-o])/(r*r),r/=2,h++;for(u=f.length,a=1;1!=u;){for(c=0;c<u-1;c++)p[c]=(g.pow(4,a)*f[c+1]-f[c])/(g.pow(4,a)-1);u=p.length,f=p,p=[],a++}return f},simpson:function(t,e,n,r){for(var i,o=(n-e)/r,s=t(e),a=[],u=e,c=0,l=1;u<=n;u+=o,c++)a[c]=u;for(i=a.length;l<i-1;l++)s+=(l%2!=0?4:2)*t(a[l]);return o/3*(s+t(n))},hermite:function(t,e,n,r){for(var i,o=t.length,s=0,a=0,u=[],c=[],l=[],h=[];a<o;a++){for(u[a]=1,i=0;i<o;i++)a!=i&&(u[a]*=(r-t[i])/(t[a]-t[i]));for(i=c[a]=0;i<o;i++)a!=i&&(c[a]+=1/(t[a]-t[i]));l[a]=(1-2*(r-t[a])*c[a])*(u[a]*u[a]),h[a]=(r-t[a])*(u[a]*u[a]),s+=l[a]*e[a]+h[a]*n[a]}return s},lagrange:function(t,e,n){for(var r,i,o=0,s=0,a=t.length;s<a;s++){for(i=e[s],r=0;r<a;r++)s!=r&&(i*=(n-t[r])/(t[s]-t[r]));o+=i}return o},cubic_spline:function(t,e,n){for(var r,i,o=t.length,s=0,a=[],u=[],c=[],l=[],h=[],f=[];s<o-1;s++)l[s]=t[s+1]-t[s];for(c[0]=0,s=1;s<o-1;s++)c[s]=3/l[s]*(e[s+1]-e[s])-3/l[s-1]*(e[s]-e[s-1]);for(s=1;s<o-1;s++)a[s]=[],u[s]=[],a[s][s-1]=l[s-1],a[s][s]=2*(l[s-1]+l[s]),a[s][s+1]=l[s],u[s][0]=c[s];for(i=m.multiply(m.inv(a),u),r=0;r<o-1;r++)h[r]=(e[r+1]-e[r])/l[r]-l[r]*(i[r+1][0]+2*i[r][0])/3,f[r]=(i[r+1][0]-i[r][0])/(3*l[r]);for(r=0;r<o&&!(t[r]>n);r++);return e[--r]+(n-t[r])*h[r]+m.sq(n-t[r])*i[r]+(n-t[r])*m.sq(n-t[r])*f[r]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){for(var e,n,r,i,o,s,a=t.length,u=t[0].length,c=0,l=[],h=[],f=[],p=[],d=[],g=[],c=0;c<a;c++)l[c]=m.sum(t[c])/u;for(c=0;c<u;c++)for(p[c]=[],e=0;e<a;e++)p[c][e]=t[e][c]-l[e];for(p=m.transpose(p),c=0;c<a;c++)for(d[c]=[],e=0;e<a;e++)d[c][e]=m.dot([p[c]],[p[e]])/(u-1);for(s=(r=m.jacobi(d))[0],h=r[1],g=m.transpose(s),c=0;c<h.length;c++)for(e=c;e<h.length;e++)h[c]<h[e]&&(n=h[c],h[c]=h[e],h[e]=n,i=g[c],g[c]=g[e],g[e]=i);for(o=m.transpose(p),c=0;c<a;c++)for(f[c]=[],e=0;e<o.length;e++)f[c][e]=m.dot([g[c]],[o[e]]);return[t,h,g,f]}}),function(t){for(var e=0;e<t.length;e++)!function(r){m.fn[r]=function(t,e){var n=this;return e?(setTimeout(function(){e.call(n,m.fn[r].call(n,t))},15),this):"number"==typeof m[r](this,t)?m[r](this,t):m(m[r](this,t))}}(t[e])}("add divide multiply subtract dot pow exp log abs norm angle".split(" ")),c=f,l=Math,h=[].slice,s=c.utils.isNumber,n=c.utils.isArray,c.extend({zscore:function(){var t=h.call(arguments);return s(t[1])?(t[0]-t[1])/t[2]:(t[0]-c.mean(t[1]))/c.stdev(t[1],t[2])},ztest:function(){var t,e=h.call(arguments);return n(e[1])?(t=c.zscore(e[0],e[1],e[3]),1===e[2]?c.normal.cdf(-l.abs(t),0,1):2*c.normal.cdf(-l.abs(t),0,1)):2<e.length?(t=c.zscore(e[0],e[1],e[2]),1===e[3]?c.normal.cdf(-l.abs(t),0,1):2*c.normal.cdf(-l.abs(t),0,1)):(t=e[0],1===e[1]?c.normal.cdf(-l.abs(t),0,1):2*c.normal.cdf(-l.abs(t),0,1))}}),c.extend(c.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(t,e,n){n=l.abs(this.zscore(t,n));return 1===e?c.normal.cdf(-n,0,1):2*c.normal.cdf(-n,0,1)}}),c.extend({tscore:function(){var t=h.call(arguments);return 4===t.length?(t[0]-t[1])/(t[2]/l.sqrt(t[3])):(t[0]-c.mean(t[1]))/(c.stdev(t[1],!0)/l.sqrt(t[1].length))},ttest:function(){var t,e=h.call(arguments);return 5===e.length?(t=l.abs(c.tscore(e[0],e[1],e[2],e[3])),1===e[4]?c.studentt.cdf(-t,e[3]-1):2*c.studentt.cdf(-t,e[3]-1)):s(e[1])?(t=l.abs(e[0]),1==e[2]?c.studentt.cdf(-t,e[1]-1):2*c.studentt.cdf(-t,e[1]-1)):(t=l.abs(c.tscore(e[0],e[1])),1==e[2]?c.studentt.cdf(-t,e[1].length-1):2*c.studentt.cdf(-t,e[1].length-1))}}),c.extend(c.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/l.sqrt(this.cols()))},ttest:function(t,e){return 1===e?1-c.studentt.cdf(l.abs(this.tscore(t)),this.cols()-1):2*c.studentt.cdf(-l.abs(this.tscore(t)),this.cols()-1)}}),c.extend({anovafscore:function(){var t,e,n,r,i,o,s,a,u=h.call(arguments);if(1===u.length){for(i=new Array(u[0].length),s=0;s<u[0].length;s++)i[s]=u[0][s];u=i}for(e=new Array,s=0;s<u.length;s++)e=e.concat(u[s]);for(n=c.mean(e),s=t=0;s<u.length;s++)t+=u[s].length*l.pow(c.mean(u[s])-n,2);for(t/=u.length-1,s=o=0;s<u.length;s++)for(r=c.mean(u[s]),a=0;a<u[s].length;a++)o+=l.pow(u[s][a]-r,2);return t/(o/=e.length-u.length)},anovaftest:function(){var t,e=h.call(arguments);if(s(e[0]))return 1-c.centralF.cdf(e[0],e[1],e[2]);for(var n=c.anovafscore(e),r=e.length-1,i=0,o=0;o<e.length;o++)i+=e[o].length;return t=i-r-1,1-c.centralF.cdf(n,r,t)},ftest:function(t,e,n){return 1-c.centralF.cdf(t,e,n)}}),c.extend(c.fn,{anovafscore:function(){return c.anovafscore(this.toArray())},anovaftes:function(){for(var t=0,e=0;e<this.length;e++)t+=this[e].length;return c.ftest(this.anovafscore(),this.length-1,t-this.length)}}),c.extend({qscore:function(){var t,e,n,r,i=h.call(arguments),i=s(i[0])?(t=i[0],e=i[1],n=i[2],r=i[3],i[4]):(t=c.mean(i[0]),e=c.mean(i[1]),n=i[0].length,r=i[1].length,i[2]);return l.abs(t-e)/(i*l.sqrt((1/n+1/r)/2))},qtest:function(){var t,e=h.call(arguments),n=(e=3===e.length?(t=e[0],e.slice(1)):7===e.length?(t=c.qscore(e[0],e[1],e[2],e[3],e[4]),e.slice(5)):(t=c.qscore(e[0],e[1],e[2]),e.slice(3)))[0],e=e[1];return 1-c.tukey.cdf(t,e,n-e)},tukeyhsd:function(t){for(var e=c.pooledstdev(t),n=t.map(function(t){return c.mean(t)}),r=t.reduce(function(t,e){return t+e.length},0),i=[],o=0;o<t.length;++o)for(var s=o+1;s<t.length;++s){var a=c.qtest(n[o],n[s],t[o].length,t[s].length,e,r,t.length);i.push([[o,s],a])}return i}}),c.extend({normalci:function(){var t=h.call(arguments),e=new Array(2),n=4===t.length?l.abs(c.normal.inv(t[1]/2,0,1)*t[2]/l.sqrt(t[3])):l.abs(c.normal.inv(t[1]/2,0,1)*c.stdev(t[2])/l.sqrt(t[2].length));return e[0]=t[0]-n,e[1]=t[0]+n,e},tci:function(){var t=h.call(arguments),e=new Array(2),n=4===t.length?l.abs(c.studentt.inv(t[1]/2,t[3]-1)*t[2]/l.sqrt(t[3])):l.abs(c.studentt.inv(t[1]/2,t[2].length-1)*c.stdev(t[2],!0)/l.sqrt(t[2].length));return e[0]=t[0]-n,e[1]=t[0]+n,e},significant:function(t,e){return t<e}}),c.extend(c.fn,{normalci:function(t,e){return c.normalci(t,e,this.toArray())},tci:function(t,e){return c.tci(t,e,this.toArray())}}),c.extend(c.fn,{oneSidedDifferenceOfProportions:function(t,e,n,r){r=b(t,e,n,r);return c.ztest(r,1)},twoSidedDifferenceOfProportions:function(t,e,n,r){r=b(t,e,n,r);return c.ztest(r,2)}}),f.models={ols:function(t,e){var n=w(t,e),r=C(n),t={F_statistic:t=(i=n).R2/i.df_model/((1-i.R2)/i.df_resid),pvalue:1-(e=t,t=i.df_model,i=i.df_resid,f.beta.cdf(e/(i/t+e),t/2,i/2))},i=1-(1-n.R2)*((n.nobs-1)/n.df_resid);return n.t=r,n.f=t,n.adjust_R2=i,n}},f.extend({buildxmatrix:function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++)t[e]=[1].concat(arguments[e]);return f(t)},builddxmatrix:function(){for(var t=new Array(arguments[0].length),e=0;e<arguments[0].length;e++)t[e]=[1].concat(arguments[0][e]);return f(t)},buildjxmatrix:function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n];return f.builddxmatrix(e)},buildymatrix:function(t){return f(t).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(t,e){var n,r,i,o,s;if(t.cols()==e.rows()){if(1<e.rows()){for(o=[],n=0;n<t.rows();n++)for(o[n]=[],r=0;r<e.cols();r++){for(i=s=0;i<t.cols();i++)s+=t.toArray()[n][i]*e.toArray()[i][r];o[n][r]=s}return f(o)}for(o=[],n=0;n<t.rows();n++)for(o[n]=[],r=0;r<e.cols();r++){for(i=s=0;i<t.cols();i++)s+=t.toArray()[n][i]*e.toArray()[r];o[n][r]=s}return f(o)}},regress:function(t,e){var n=f.xtranspxinv(t),t=t.transpose(),t=f.matrixmult(f(n),t);return f.matrixmult(t,e)},regresst:function(t,e,n){var r=f.regress(t,e),i={anova:{}},o=f.jMatYBar(t,r);i.yBar=o;var s=e.mean();i.anova.residuals=f.residuals(e,o),i.anova.ssr=f.ssr(o,s),i.anova.msr=i.anova.ssr/(t[0].length-1),i.anova.sse=f.sse(e,o),i.anova.mse=i.anova.sse/(e.length-(t[0].length-1)-1),i.anova.sst=f.sst(e,s),i.anova.mst=i.anova.sst/(e.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=f.anovaftest(i.anova.fratio,t[0].length-1,e.length-(t[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(t[0].length);for(var a,u,c,l=f.xtranspxinv(t),h=0;h<r.length;h++)a=Math.sqrt(i.anova.mse*Math.abs(l[h][h])),u=Math.abs(r[h]/a),c=f.ttest(u,e.length-t[0].length-1,n),i.stats[h]=[r[h],a,u,c];return i.regress=r,i},xtranspx:function(t){return f.matrixmult(t.transpose(),t)},xtranspxinv:function(t){t=f.matrixmult(t.transpose(),t);return f.inv(t)},jMatYBar:function(t,e){e=f.matrixmult(t,e);return new f(e)},residuals:function(t,e){return f.matrixsubtract(t,e)},ssr:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},sse:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return n},sst:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},matrixsubtract:function(t,e){for(var n=new Array(t.length),r=0;r<t.length;r++){n[r]=new Array(t[r].length);for(var i=0;i<t[r].length;i++)n[r][i]=t[r][i]-e[r][i]}return f(n)}}),f.jStat=f});var CryptoApi=function(n){var r={};function i(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}return i.m=n,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=29)}([function(t,e,n){"use strict";function r(t,e){return t<<e|t>>>32-e|0}function i(t,e){return t>>>e|t<<32-e|0}function o(t,e,n){return 32===n?e:32<n?o(e,t,n-32):4294967295&(t>>>n|e<<32-n)}function s(t,e,n){return 32===n?t:32<n?s(e,t,n-32):4294967295&(e>>>n|t<<32-n)}n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i}),n.d(e,"d",function(){return s}),n.d(e,"c",function(){return o})},function(t,e,n){"use strict";function r(t){for(var e="",n=0,r=t.length;n<r;n++){var i=t.charCodeAt(n);i<128?e+=String.fromCharCode(i):(i<2048?e+=String.fromCharCode(192|i>>6):(i<55296||57344<=i?e+=String.fromCharCode(224|i>>12):(n++,i=65536+((1023&i)<<10|1023&t.charCodeAt(n)),e+=String.fromCharCode(240|i>>18),e+=String.fromCharCode(128|i>>12&63)),e+=String.fromCharCode(128|i>>6&63)),e+=String.fromCharCode(128|63&i))}return e}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";function r(t){for(var e="",n=0,r=t.length;n<r;n++)e+=(t.charCodeAt(n)<16?"0":"")+t.charCodeAt(n).toString(16);return e}n.d(e,"a",function(){return r})},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)})(s,n(4).a),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(s.prototype,[{key:"process",value:function(){for(;this.state.message.length>=this.blockSizeInBytes;){this.blockUnits=[];for(var t=0;t<this.blockSizeInBytes;t+=4)this.blockUnits.push(this.state.message.charCodeAt(t)<<24|this.state.message.charCodeAt(t+1)<<16|this.state.message.charCodeAt(t+2)<<8|this.state.message.charCodeAt(t+3));this.state.message=this.state.message.substr(this.blockSizeInBytes),this.processBlock(this.blockUnits)}}},{key:"processBlock",value:function(t){}},{key:"getStateHash",value:function(t){t=t||this.state.hash.length;for(var e="",n=0;n<t;n++)e+=String.fromCharCode(this.state.hash[n]>>24&255)+String.fromCharCode(this.state.hash[n]>>16&255)+String.fromCharCode(this.state.hash[n]>>8&255)+String.fromCharCode(255&this.state.hash[n]);return e}},{key:"addLengthBits",value:function(){this.state.message+="\0\0\0"+String.fromCharCode(this.state.length>>29&255)+String.fromCharCode(this.state.length>>21&255)+String.fromCharCode(this.state.length>>13&255)+String.fromCharCode(this.state.length>>5&255)+String.fromCharCode(this.state.length<<3&255)}}]),n=s;function s(t){var e;return function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),e=this,(t=!(t=i(s).call(this,t))||"object"!==r(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).unitOrder=1,t.blockUnits=[],t}e.a=n},function(t,e,n){"use strict";var r=(function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(i.prototype,[{key:"reset",value:function(){this.state={},this.state.message="",this.state.length=0}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(this.state))}},{key:"setState",value:function(t){this.state=t}},{key:"update",value:function(t){this.state.message+=t,this.state.length+=t.length,this.process()}},{key:"process",value:function(){}},{key:"finalize",value:function(){return""}},{key:"getStateHash",value:function(t){return""}},{key:"addPaddingPKCS7",value:function(t){this.state.message+=new Array(t+1).join(String.fromCharCode(t))}},{key:"addPaddingISO7816",value:function(t){this.state.message+=""+new Array(t).join("\0")}},{key:"addPaddingZero",value:function(t){this.state.message+=new Array(t+1).join("\0")}}]),i);function i(t){!function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),this.unitSize=4,this.unitOrder=0,this.blockSize=16,this.blockSizeInBytes=this.blockSize*this.unitSize,this.options=t||{},this.reset()}e.a=r},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)})(s,n(4).a),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(s.prototype,[{key:"process",value:function(){for(;this.state.message.length>=this.blockSizeInBytes;){this.blockUnits=[];for(var t=0;t<this.blockSizeInBytes;t+=4)this.blockUnits.push(this.state.message.charCodeAt(t)|this.state.message.charCodeAt(t+1)<<8|this.state.message.charCodeAt(t+2)<<16|this.state.message.charCodeAt(t+3)<<24);this.state.message=this.state.message.substr(this.blockSizeInBytes),this.processBlock(this.blockUnits)}}},{key:"processBlock",value:function(t){}},{key:"getStateHash",value:function(t){t=t||this.state.hash.length;for(var e="",n=0;n<t;n++)e+=String.fromCharCode(255&this.state.hash[n])+String.fromCharCode(this.state.hash[n]>>8&255)+String.fromCharCode(this.state.hash[n]>>16&255)+String.fromCharCode(this.state.hash[n]>>24&255);return e}},{key:"addLengthBits",value:function(){this.state.message+=String.fromCharCode(this.state.length<<3&255)+String.fromCharCode(this.state.length>>5&255)+String.fromCharCode(this.state.length>>13&255)+String.fromCharCode(this.state.length>>21&255)+String.fromCharCode(this.state.length>>29&255)+"\0\0\0"}}]),n=s;function s(t){var e;return function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),e=this,(t=!(t=i(s).call(this,t))||"object"!==r(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).blockUnits=[],t}e.a=n},function(t,e,n){"use strict";var r=n(3),E=n(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var T=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],r=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,r.a),r=[{key:"reset",value:function(){switch(o(s(u.prototype),"reset",this).call(this),this.options.length){case 384:this.state.hash=[-876896931,-1056596264,1654270250,914150663,-1856437926,812702999,355462360,-150054599,1731405415,-4191439,-1900787065,1750603025,-619958771,1694076839,1203062813,-1090891868];break;case 512:this.state.hash=[1779033703,-205731576,-1150833019,-2067093701,1013904242,-23791573,-1521486534,1595750129,1359893119,-1377402159,-1694144372,725511199,528734635,-79577749,1541459225,327033209];break;default:for(var t=new u,e=0;e<16;e++)t.state.hash[e]=2779096485^t.state.hash[e];t.update("SHA-512/"+this.options.length);var n=t.finalize();this.state.hash=[];for(var r=0;r<64;r+=4)this.state.hash.push(n.charCodeAt(r)<<24|n.charCodeAt(r+1)<<16|n.charCodeAt(r+2)<<8|n.charCodeAt(r+3))}}},{key:"processBlock",value:function(t){for(var e,n,r,i,o=this.state.hash[0],s=this.state.hash[1],a=this.state.hash[2],u=this.state.hash[3],c=this.state.hash[4],l=this.state.hash[5],h=this.state.hash[6],f=this.state.hash[7],p=this.state.hash[8],d=this.state.hash[9],g=this.state.hash[10],m=this.state.hash[11],v=this.state.hash[12],y=this.state.hash[13],b=this.state.hash[14],w=this.state.hash[15],_=0;_<this.options.rounds;_+=2){_<32?(this.W[_]=t[_],this.W[_+1]=t[_+1]):(e=Object(E.c)(this.W[_-30],this.W[_-29],1)^Object(E.c)(this.W[_-30],this.W[_-29],8)^this.W[_-30]>>>7,n=Object(E.d)(this.W[_-30],this.W[_-29],1)^Object(E.d)(this.W[_-30],this.W[_-29],8)^(this.W[_-29]>>>7|this.W[_-30]<<25),r=Object(E.c)(this.W[_-4],this.W[_-3],19)^Object(E.c)(this.W[_-4],this.W[_-3],61)^this.W[_-4]>>>6,i=Object(E.d)(this.W[_-4],this.W[_-3],19)^Object(E.d)(this.W[_-4],this.W[_-3],61)^(this.W[_-3]>>>6|this.W[_-4]<<26),S=(65535&this.W[_-13])+(65535&this.W[_-31])+(65535&n)+(65535&i)|0,O=(this.W[_-13]>>>16)+(this.W[_-31]>>>16)+(n>>>16)+(i>>>16)+(S>>>16)|0,k=(65535&this.W[_-14])+(65535&this.W[_-32])+(65535&e)+(65535&r)+(O>>>16)|0,C=(this.W[_-14]>>>16)+(this.W[_-32]>>>16)+(e>>>16)+(r>>>16)+(k>>>16)|0,this.W[_]=4294967295&(C<<16|65535&k),this.W[_+1]=4294967295&(O<<16|65535&S)),e=Object(E.c)(o,s,28)^Object(E.c)(o,s,34)^Object(E.c)(o,s,39),n=Object(E.d)(o,s,28)^Object(E.d)(o,s,34)^Object(E.d)(o,s,39);var x=d&m^~d&y,C=o&a^o&c^a&c,k=s&u^s&l^u&l,S=(S=(S=b+(r=Object(E.c)(p,d,14)^Object(E.c)(p,d,18)^Object(E.c)(p,d,41))+((O=w+(i=Object(E.d)(p,d,14)^Object(E.d)(p,d,18)^Object(E.d)(p,d,41))|0)>>>0<w>>>0?1:0)|0)+(p&g^~p&v)+((O=O+x|0)>>>0<x>>>0?1:0)|0)+T[_]+((O=O+T[_+1]|0)>>>0<T[_+1]>>>0?1:0)|0,O=O+this.W[_+1]|0,k=n+k|0,b=v,w=y,v=g,y=m,g=p,m=d,p=h+(S=S+this.W[_]+(O>>>0<this.W[_+1]>>>0?1:0)|0)+((d=f+O|0)>>>0<f>>>0?1:0)|0,h=c,f=l,c=a,l=u,a=o,u=s,o=S+(e+C+(k>>>0<n>>>0?1:0)|0)+((s=O+k|0)>>>0<O>>>0?1:0)|0}this.state.hash[1]=this.state.hash[1]+s|0,this.state.hash[0]=this.state.hash[0]+o+(this.state.hash[1]>>>0<s>>>0?1:0)|0,this.state.hash[3]=this.state.hash[3]+u|0,this.state.hash[2]=this.state.hash[2]+a+(this.state.hash[3]>>>0<u>>>0?1:0)|0,this.state.hash[5]=this.state.hash[5]+l|0,this.state.hash[4]=this.state.hash[4]+c+(this.state.hash[5]>>>0<l>>>0?1:0)|0,this.state.hash[7]=this.state.hash[7]+f|0,this.state.hash[6]=this.state.hash[6]+h+(this.state.hash[7]>>>0<f>>>0?1:0)|0,this.state.hash[9]=this.state.hash[9]+d|0,this.state.hash[8]=this.state.hash[8]+p+(this.state.hash[9]>>>0<d>>>0?1:0)|0,this.state.hash[11]=this.state.hash[11]+m|0,this.state.hash[10]=this.state.hash[10]+g+(this.state.hash[11]>>>0<m>>>0?1:0)|0,this.state.hash[13]=this.state.hash[13]+y|0,this.state.hash[12]=this.state.hash[12]+v+(this.state.hash[13]>>>0<y>>>0?1:0)|0,this.state.hash[15]=this.state.hash[15]+w|0,this.state.hash[14]=this.state.hash[14]+b+(this.state.hash[15]>>>0<w>>>0?1:0)|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<112?112-this.state.message.length|0:240-this.state.message.length|0),this.state.message+="\0\0\0\0\0\0\0\0",this.addLengthBits(),this.process(),this.getStateHash(this.options.length/32|0)}}],function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(u.prototype,r),u);function u(t){var e;return function(t){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}(this),(t=t||{}).length=t.length||512,t.rounds=t.rounds||160,e=this,(t=!(t=s(u).call(this,t))||"object"!==i(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).blockSize=32,t.blockSizeInBytes=t.blockSize*t.unitSize,t.W=new Array(160),t}e.a=r},function(t,e,n){"use strict";var r=n(3),f=n(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],r=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,r.a),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(u.prototype,[{key:"reset",value:function(){224===(o(s(u.prototype),"reset",this).call(this),this.options.length)?this.state.hash=[-1056596264,914150663,812702999,-150054599,-4191439,1750603025,1694076839,-1090891868]:this.state.hash=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225]}},{key:"processBlock",value:function(t){for(var e=0|this.state.hash[0],n=0|this.state.hash[1],r=0|this.state.hash[2],i=0|this.state.hash[3],o=0|this.state.hash[4],s=0|this.state.hash[5],a=0|this.state.hash[6],u=0|this.state.hash[7],c=0;c<this.options.rounds;c++){this.W[c]=c<16?0|t[c]:this.W[c-16]+(Object(f.b)(this.W[c-15],7)^Object(f.b)(this.W[c-15],18)^this.W[c-15]>>>3)+this.W[c-7]+(Object(f.b)(this.W[c-2],17)^Object(f.b)(this.W[c-2],19)^this.W[c-2]>>>10)|0;var l=u+(Object(f.b)(o,6)^Object(f.b)(o,11)^Object(f.b)(o,25))+(o&s^~o&a)+p[c]+this.W[c]|0,h=(Object(f.b)(e,2)^Object(f.b)(e,13)^Object(f.b)(e,22))+(e&n^e&r^n&r)|0,u=a,a=s,s=o,o=i+l|0,i=r,r=n,n=e,e=l+h|0}this.state.hash[0]=this.state.hash[0]+e|0,this.state.hash[1]=this.state.hash[1]+n|0,this.state.hash[2]=this.state.hash[2]+r|0,this.state.hash[3]=this.state.hash[3]+i|0,this.state.hash[4]=this.state.hash[4]+o|0,this.state.hash[5]=this.state.hash[5]+s|0,this.state.hash[6]=this.state.hash[6]+a|0,this.state.hash[7]=this.state.hash[7]+u|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash(this.options.length/32|0)}}]),u);function u(t){var e;return function(t){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}(this),(t=t||{}).length=t.length||256,t.rounds=t.rounds||64,e=this,(t=!(t=s(u).call(this,t))||"object"!==i(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).W=new Array(64),t}e.a=r},function(t,e,n){"use strict";var r=n(5),d=n(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],m=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],v=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],y=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],n=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(b,r.a),n=[{key:"F",value:function(t,e,n){return t^e^n}},{key:"G",value:function(t,e,n){return t&e|~t&n}},{key:"H",value:function(t,e,n){return(t|~e)^n}},{key:"I",value:function(t,e,n){return t&n|e&~n}},{key:"J",value:function(t,e,n){return t^(e|~n)}},{key:"T",value:function(t,e,n,r){return t<16?this.F(e,n,r):t<32?this.G(e,n,r)+1518500249|0:t<48?this.H(e,n,r)+1859775393|0:t<64?this.I(e,n,r)+2400959708|0:this.J(e,n,r)+2840853838|0}},{key:"T64",value:function(t,e,n,r){return t<16?this.I(e,n,r)+1352829926|0:t<32?this.H(e,n,r)+1548603684|0:t<48?this.G(e,n,r)+1836072691|0:this.F(e,n,r)}},{key:"T80",value:function(t,e,n,r){return t<16?this.J(e,n,r)+1352829926|0:t<32?this.I(e,n,r)+1548603684|0:t<48?this.H(e,n,r)+1836072691|0:t<64?this.G(e,n,r)+2053994217|0:this.F(e,n,r)}}],o((r=b).prototype,[{key:"reset",value:function(){switch(s(a(b.prototype),"reset",this).call(this),this.options.length){case 128:this.state.hash=[1732584193,4023233417,2562383102,271733878],this.processBlock=this.processBlock128;break;case 256:this.state.hash=[1732584193,4023233417,2562383102,271733878,1985229328,4275878552,2309737967,19088743],this.processBlock=this.processBlock256;break;case 320:this.state.hash=[1732584193,4023233417,2562383102,271733878,3285377520,1985229328,4275878552,2309737967,19088743,1009589775],this.processBlock=this.processBlock320;break;default:this.state.hash=[1732584193,4023233417,2562383102,271733878,3285377520],this.processBlock=this.processBlock160}}},{key:"processBlock128",value:function(t){for(var e=a=0|this.state.hash[0],n=l=0|this.state.hash[1],r=c=0|this.state.hash[2],i=u=0|this.state.hash[3],o=0;o<64;o++){var s=(s=a+t[g[o]]|0)+b.T(o,l,c,u)|0,a=u,u=c,c=l,l=s=Object(d.a)(s,v[o]);s=(s=e+t[m[o]]|0)+b.T64(o,n,r,i)|0,e=i,i=r,r=n,n=s=Object(d.a)(s,y[o])}var h=this.state.hash[1]+c+i|0;this.state.hash[1]=this.state.hash[2]+u+e|0,this.state.hash[2]=this.state.hash[3]+a+n|0,this.state.hash[3]=this.state.hash[0]+l+r|0,this.state.hash[0]=h}},{key:"processBlock160",value:function(t){for(var e=0|this.state.hash[0],n=0|this.state.hash[1],r=0|this.state.hash[2],i=0|this.state.hash[3],o=0|this.state.hash[4],s=e,a=n,u=r,c=i,l=o,h=0;h<80;h++){var f=(f=e+t[g[h]]|0)+b.T(h,n,r,i)|0;f=(f=Object(d.a)(f,v[h]))+o|0,e=o,o=i,i=Object(d.a)(r,10),r=n,n=f,f=(f=s+t[m[h]]|0)+b.T80(h,a,u,c)|0,f=(f=Object(d.a)(f,y[h]))+l|0,s=l,l=c,c=Object(d.a)(u,10),u=a,a=f}var p=this.state.hash[1]+r+c|0;this.state.hash[1]=this.state.hash[2]+i+l|0,this.state.hash[2]=this.state.hash[3]+o+s|0,this.state.hash[3]=this.state.hash[4]+e+a|0,this.state.hash[4]=this.state.hash[0]+n+u|0,this.state.hash[0]=p}},{key:"processBlock256",value:function(t){for(var e=0|this.state.hash[0],n=0|this.state.hash[1],r=0|this.state.hash[2],i=0|this.state.hash[3],o=0|this.state.hash[4],s=0|this.state.hash[5],a=0|this.state.hash[6],u=0|this.state.hash[7],c=0;c<64;c+=1){var l=(l=e+t[g[c]]|0)+b.T(c,n,r,i)|0,e=i,i=r,r=n,n=l=Object(d.a)(l,v[c]);switch(l=(l=o+t[m[c]]|0)+b.T64(c,s,a,u)|0,o=u,u=a,a=s,s=l=Object(d.a)(l,y[c]),c){case 15:l=e,e=o,o=l;break;case 31:l=n,n=s,s=l;break;case 47:l=r,r=a,a=l;break;case 63:l=i,i=u,u=l}}this.state.hash[0]=this.state.hash[0]+e|0,this.state.hash[1]=this.state.hash[1]+n|0,this.state.hash[2]=this.state.hash[2]+r|0,this.state.hash[3]=this.state.hash[3]+i|0,this.state.hash[4]=this.state.hash[4]+o|0,this.state.hash[5]=this.state.hash[5]+s|0,this.state.hash[6]=this.state.hash[6]+a|0,this.state.hash[7]=this.state.hash[7]+u|0}},{key:"processBlock320",value:function(t){for(var e=0|this.state.hash[0],n=0|this.state.hash[1],r=0|this.state.hash[2],i=0|this.state.hash[3],o=0|this.state.hash[4],s=0|this.state.hash[5],a=0|this.state.hash[6],u=0|this.state.hash[7],c=0|this.state.hash[8],l=0|this.state.hash[9],h=0;h<80;h+=1){var f=(f=e+t[g[h]]|0)+b.T(h,n,r,i)|0;switch(f=(f=Object(d.a)(f,v[h]))+o|0,e=o,o=i,i=Object(d.a)(r,10),r=n,n=f,f=(f=s+t[m[h]]|0)+b.T80(h,a,u,c)|0,f=(f=Object(d.a)(f,y[h]))+l|0,s=l,l=c,c=Object(d.a)(u,10),u=a,a=f,h){case 15:f=n,n=a,a=f;break;case 31:f=i,i=c,c=f;break;case 47:f=e,e=s,s=f;break;case 63:f=r,r=u,u=f;break;case 79:f=o,o=l,l=f}}this.state.hash[0]=this.state.hash[0]+e|0,this.state.hash[1]=this.state.hash[1]+n|0,this.state.hash[2]=this.state.hash[2]+r|0,this.state.hash[3]=this.state.hash[3]+i|0,this.state.hash[4]=this.state.hash[4]+o|0,this.state.hash[5]=this.state.hash[5]+s|0,this.state.hash[6]=this.state.hash[6]+a|0,this.state.hash[7]=this.state.hash[7]+u|0,this.state.hash[8]=this.state.hash[8]+c|0,this.state.hash[9]=this.state.hash[9]+l|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),o(r,n),b);function b(t){return function(t){if(!(t instanceof b))throw new TypeError("Cannot call a class as a function")}(this),(t=t||{}).length=t.length||160,e=this,!(t=a(b).call(this,t))||"object"!==i(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t;var e}e.a=n},function(t,e,n){"use strict";var r=n(3),c=n(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u=[10097,32533,76520,13586,34673,54876,80959,9117,39292,74945,37542,4805,64894,74296,24805,24037,20636,10402,822,91665,8422,68953,19645,9303,23209,2560,15953,34764,35080,33606,99019,2529,9376,70715,38311,31165,88676,74397,4436,27659,12807,99970,80157,36147,64032,36653,98951,16877,12171,76833,66065,74717,34072,76850,36697,36170,65813,39885,11199,29170,31060,10805,45571,82406,35303,42614,86799,7439,23403,9732,85269,77602,2051,65692,68665,74818,73053,85247,18623,88579,63573,32135,5325,47048,90553,57548,28468,28709,83491,25624,73796,45753,3529,64778,35808,34282,60935,20344,35273,88435,98520,17767,14905,68607,22109,40558,60970,93433,50500,73998,11805,5431,39808,27732,50725,68248,29405,24201,52775,67851,83452,99634,6288,98083,13746,70078,18475,40610,68711,77817,88685,40200,86507,58401,36766,67951,90364,76493,29609,11062,99594,67348,87517,64969,91826,8928,93785,61368,23478,34113,65481,17674,17468,50950,58047,76974,73039,57186,40218,16544,80124,35635,17727,8015,45318,22374,21115,78253,14385,53763,74350,99817,77402,77214,43236,210,45521,64237,96286,2655,69916,26803,66252,29148,36936,87203,76621,13990,94400,56418,9893,20505,14225,68514,46427,56788,96297,78822,54382,14598,91499,14523,68479,27686,46162,83554,94750,89923,37089,20048,80336,94598,26940,36858,70297,34135,53140,33340,42050,82341,44104,81949,85157,47954,32979,26575,57600,40881,22222,6413,12550,73742,11100,2040,12860,74697,96644,89439,28707,25815,63606,49329,16505,34484,40219,52563,43651,77082,7207,31790,61196,90446,26457,47774,51924,33729,65394,59593,42582,60527,15474,45266,95270,79953,59367,83848,82396,10118,33211,59466,94557,28573,67897,54387,54622,44431,91190,42592,92927,45973,42481,16213,97344,8721,16868,48767,3071,12059,25701,46670,23523,78317,73208,89837,68935,91416,26252,29663,5522,82562,4493,52494,75246,33824,45862,51025,61962,79335,65337,12472,549,97654,64051,88159,96119,63896,54692,82391,23287,29529,35963,15307,26898,9354,33351,35462,77974,50024,90103,39333,59808,8391,45427,26842,83609,49700,13021,24892,78565,20106,46058,85236,1390,92286,77281,44077,93910,83647,70617,42941,32179,597,87379,25241,5567,7007,86743,17157,85394,11838,69234,61406,20117,45204,15956,6e4,18743,92423,97118,96338,19565,41430,1758,75379,40419,21585,66674,36806,84962,85207,45155,14938,19476,7246,43667,94543,59047,90033,20826,69541,94864,31994,36168,10851,34888,81553,1540,35456,5014,51176,98086,24826,45240,28404,44999,8896,39094,73407,35441,31880,33185,16232,41941,50949,89435,48581,88695,41994,37548,73043,80951,406,96382,70774,20151,23387,25016,25298,94624,61171,79752,49140,71961,28296,69861,2591,74852,20539,387,59579,18633,32537,98145,6571,31010,24674,5455,61427,77938,91936,74029,43902,77557,32270,97790,17119,52527,58021,80814,51748,54178,45611,80993,37143,5335,12969,56127,19255,36040,90324,11664,49883,52079,84827,59381,71539,9973,33440,88461,23356,48324,77928,31249,64710,2295,36870,32307,57546,15020,9994,69074,94138,87637,91976,35584,4401,10518,21615,1848,76938,9188,20097,32825,39527,4220,86304,83389,87374,64278,58044,90045,85497,51981,50654,94938,81997,91870,76150,68476,64659,73189,50207,47677,26269,62290,64464,27124,67018,41361,82760,75768,76490,20971,87749,90429,12272,95375,5871,93823,43178,54016,44056,66281,31003,682,27398,20714,53295,7706,17813,8358,69910,78542,42785,13661,58873,4618,97553,31223,8420,28306,3264,81333,10591,40510,7893,32604,60475,94119,1840,53840,86233,81594,13628,51215,90290,28466,68795,77762,20791,91757,53741,61613,62269,50263,90212,55781,76514,83483,47055,89415,92694,397,58391,12607,17646,48949,72306,94541,37408,77513,3820,86864,29901,68414,82774,51908,13980,72893,55507,19502,37174,69979,20288,55210,29773,74287,75251,65344,67415,21818,59313,93278,81757,5686,73156,7082,85046,31853,38452,51474,66499,68107,23621,94049,91345,42836,9191,8007,45449,99559,68331,62535,24170,69777,12830,74819,78142,43860,72834,33713,48007,93584,72869,51926,64721,58303,29822,93174,93972,85274,86893,11303,22970,28834,34137,73515,90400,71148,43643,84133,89640,44035,52166,73852,70091,61222,60561,62327,18423,56732,16234,17395,96131,10123,91622,85496,57560,81604,18880,65138,56806,87648,85261,34313,65861,45875,21069,85644,47277,38001,2176,81719,11711,71602,92937,74219,64049,65584,49698,37402,96397,1304,77586,56271,10086,47324,62605,40030,37438,97125,40348,87083,31417,21815,39250,75237,62047,15501,29578,21826,41134,47143,34072,64638,85902,49139,6441,3856,54552,73135,42742,95719,9035,85794,74296,8789,88156,64691,19202,7638,77929,3061,18072,96207,44156,23821,99538,4713,66994,60528,83441,7954,19814,59175,20695,5533,52139,61212,6455,83596,35655,6958,92983,5128,9719,77433,53783,92301,50498,10850,62746,99599,10507,13499,6319,53075,71839,6410,19362,39820,98952,43622,63147,64421,80814,43800,9351,31024,73167,59580,6478,75569,78800,88835,54486,23768,6156,4111,8408,38508,7341,23793,48763,90822,97022,17719,4207,95954,49953,30692,70668,94688,16127,56196,80091,82067,63400,5462,69200,65443,95659,18288,27437,49632,24041,8337,65676,96299,90836,27267,50264,13192,72294,7477,44606,17985,48911,97341,30358,91307,6991,19072,24210,36699,53728,28825,35793,28976,66252,68434,94688,84473,13622,62126,98408,12843,82590,9815,93146,48908,15877,54745,24591,35700,4754,83824,52692,54130,55160,6913,45197,42672,78601,11883,9528,63011,98901,14974,40344,10455,16019,14210,33712,91342,37821,88325,80851,43667,70883,12883,97343,65027,61184,4285,1392,17974,15077,90712,26769,21778,30976,38807,36961,31649,42096,63281,2023,8816,47449,19523,59515,65122,59659,86283,68258,69572,13798,16435,91529,67245,52670,35583,16563,79246,86686,76463,34222,26655,90802,60584,47377,7500,37992,45134,26529,26760,83637,41326,44344,53853,41377,36066,94850,58838,73859,49364,73331,96240,43642,24637,38736,74384,89342,52623,7992,12369,18601,3742,83873,83080,12451,38992,22815,7759,51777,97377,27585,51972,37867,16444,24334,36151,99073,27493,70939,85130,32552,54846,54759,60790,18157,57178,65762,11161,78576,45819,52979,65130,4860,3991,10461,93716,16894,66083,24653,84609,58232,88618,19161,38555,95554,32886,59780,8355,60860,29735,47762,71299,23853,17546,73704,92052,46215,55121,29281,59076,7936,27954,58909,32643,52861,95819,6831,911,98936,76355,93779,80863,514,69572,68777,39510,35905,14060,40619,29549,69616,33564,60780,24122,66591,27699,6494,14845,46672,61958,77100,90899,75754,61196,30231,92962,61773,41839,55382,17267,70943,78038,70267,30532,21704,10274,12202,39685,23309,10061,68829,55986,66485,3788,97599,75867,20717,74416,53166,35208,33374,87539,8823,48228,63379,85783,47619,53152,67433,35663,52972,16818,60311,60365,94653,35075,33949,42614,29297,1918,28316,98953,73231,83799,42402,56623,34442,34994,41374,70071,14736,9958,18065,32960,7405,36409,83232,99385,41600,11133,7586,15917,6253,19322,53845,57620,52606,66497,68646,78138,66559,19640,99413,11220,94747,7399,37408,48509,23929,27482,45476,85244,35159,31751,57260,68980,5339,15470,48355,88651,22596,3152,19121,88492,99382,14454,4504,20094,98977,74843,93413,22109,78508,30934,47744,7481,83828,73788,6533,28597,20405,94205,20380,22888,48893,27499,98748,60530,45128,74022,84617,82037,10268,78212,16993,35902,91386,44372,15486,65741,14014,87481,37220,41849,84547,46850,52326,34677,58300,74910,64345,19325,81549,46352,33049,69248,93460,45305,7521,61318,31855,14413,70951,11087,96294,14013,31792,59747,67277,76503,34513,39663,77544,52701,8337,56303,87315,16520,69676,11654,99893,2181,68161,57275,36898,81304,48585,68652,27376,92852,55866,88448,3584,20857,73156,70284,24326,79375,95220,1159,63267,10622,48391,15633,84924,90415,93614,33521,26665,55823,47641,86225,31704,92694,48297,39904,2115,59589,49067,66821,41575,49767,4037,77613,19019,88152,80,20554,91409,96277,48257,50816,97616,38688,32486,45134,63545,59404,72059,43947,51680,43852,59693,25163,1889,70014,15021,41290,67312,71857,15957,68971,11403,65251,7629,37239,33295,5870,1119,92784,26340,18477,65622,36815,43625,18637,37509,82444,99005,4921,73701,14707,93997,64397,11692,5327,82162,20247,81759,45197,25332,83745,22567,4515,25624,95096,67946,48460,85558,15191,18782,16930,33361,83761,60873,43253,84145,60833,25983,1291,41349,20368,7126,14387,6345,80854,9279,43529,6318,38384,74761,41196,37480,51321,92246,80088,77074,88722,56736,66164,49431,66919,31678,72472,8,80890,18002,94813,31900,54155,83436,35352,54131,5466,55306,93128,18464,74457,90561,72848,11834,79982,68416,39528,72484,82474,25593,48545,35247,18619,13674,18611,19241,81616,18711,53342,44276,75122,11724,74627,73707,58319,15997,7586,16120,82641,22820,92904,13141,32392,19763,61199,67940,90767,4235,13574,17200,69902,63742,78464,22501,18627,90872,40188,28193,29593,88627,94972,11598,62095,36787,441,58997,34414,82157,86887,55087,19152,23,12302,80783,32624,68691,63439,75363,44989,16822,36024,867,76378,41605,65961,73488,67049,9070,93399,45547,94458,74284,5041,49807,20288,34060,79495,4146,52162,90286,54158,34243,46978,35482,59362,95938,91704,30552,4737,21031,75051,93029,47665,64382,99782,93478,94015,46874,32444,48277,59820,96163,64654,25843,41145,42820,74108,88222,88570,74015,25704,91035,1755,14750,48968,38603,62880,87873,95160,59221,22304,90314,72877,17334,39283,4149,11748,12102,80580,41867,17710,59621,6554,7850,73950,79552,17944,5600,60478,3343,25852,58905,57216,39618,49856,99326,66067,42792,95043,52680,46780,56487,9971,59481,37006,22186,54244,91030,45547,70818,59849,96169,61459,21647,87417,17198,30945,57589,31732,57260,47670,7654,46376,25366,94746,49580,69170,37403,86995,90307,94304,71803,26825,5511,12459,91314,8345,88975,35841,85771,8105,59987,87112,21476,14713,71181,27767,43584,85301,88977,29490,69714,73035,41207,74699,9310,13025,14338,54066,15243,47724,66733,47431,43905,31048,56699,80217,36292,98525,24335,24432,24896,43277,58874,11466,16082,10875,62004,90391,61105,57411,6368,53856,30743,8670,84741,54127,57326,26629,19087,24472,88779,30540,27886,61732,75454,60311,42824,37301,42678,45990,43242,17374,52003,70707,70214,49739,71484,92003,98086,76668,73209,59202,11973,2902,33250,78626,51594,16453,94614,39014,97066,83012,9832,25571,77628,66692,13986,99837,582,81232,44987,9504,96412,90193,79568,44071,28091,7362,97703,76447,42537,98524,97831,65704,9514,41468,85149,49554,17994,14924,39650,95294,556,70481,6905,94559,37559,49678,53119,70312,5682,66986,34099,74474,20740,41615,70360,64114,58660,90850,64618,80620,51790,11436,38072,50273,93113,41794,86861,24781,89683,55411,85667,77535,99892,41396,80504,90670,8289,40902,5069,95083,6783,28102,57816,25807,24260,71529,78920,72682,7385,90726,57166,98884,8583,6170,97965,88302,98041,21443,41808,68984,83620,89747,98882,60808,54444,74412,81105,1176,28838,36421,16489,18059,51061,80940,44893,10408,36222,80582,71944,92638,40333,67054,16067,19516,90120,46759,71643,13177,55292,21036,82808,77501,97427,49386,54480,23604,23554,21785,41101,91178,10174,29420,90438,6312,88940,15995,69321,47458,64809,98189,81851,29651,84215,60942,307,11897,92674,40405,68032,96717,54244,10701,41393,92329,98932,78284,46347,71209,92061,39448,93136,25722,8564,77936,63574,31384,51924,85561,29671,58137,17820,22751,36518,38101,77756,11657,13897,95889,57067,47648,13885,70669,93406,39641,69457,91339,22502,92613,89719,11947,56203,19324,20504,84054,40455,99396,63680,67667,60631,69181,96845,38525,11600,47468,3577,57649,63266,24700,71594,14004,23153,69249,5747,43321,31370,28977,23896,76479,68562,62342,7589,8899,5985,64281,61826,18555,64937,13173,33365,78851,16499,87064,13075,66847,70495,32350,2985,86716,38746,26313,77463,55387,72681,72461,33230,21529,53424,92581,2262,78438,66276,18396,73538,21032,91050,13058,16218,12470,56500,15292,76139,59526,52113,95362,67011,6651,16136,1016,857,55018,56374,35824,71708,49712,97380,10404,55452,34030,60726,75211,10271,36633,68424,58275,61764,97586,54716,50259,46345,87195,46092,26787,60939,89514,11788,68224,23417,73959,76145,30342,40277,11049,72049,15472,50669,48139,36732,46874,37088,73465,9819,58869,35220,12120,86124,51247,44302,60883,52109,21437,36786,49226,77837,19612,78430,11661,94770,77603,65669,86868,12665,30012,75989,39141,77400,28e3,64238,73258,71794,31340,26256,66453,37016,64756,80457,8747,12836,3469,50678,3274,43423,66677,82556,92901,51878,56441,22998,29718,38447,6453,25311,7565,53771,3551,90070,9483,94050,45938,18135,36908,43321,11073,51803,98884,66209,6830,53656,14663,56346,71430,4909,19818,5707,27369,86882,53473,7541,53633,70863,3748,12822,19360,49088,59066,75974,63335,20483,43514,37481,58278,26967,49325,43951,91647,93783,64169,49022,98588,9495,49829,59068,38831,4838,83605,92419,39542,7772,71568,75673,35185,89759,44901,74291,24895,88530,70774,35439,46758,70472,70207,92675,91623,61275,35720,26556,95596,20094,73750,85788,34264,1703,46833,65248,14141,53410,38649,6343,57256,61342,72709,75318,90379,37562,27416,75670,92176,72535,93119,56077,6886,18244,92344,31374,82071,7429,81007,47749,40744,56974,23336,88821,53841,10536,21445,82793,24831,93241,14199,76268,70883,68002,3829,17443,72513,76400,52225,92348,62308,98481,29744,33165,33141,61020,71479,45027,76160,57411,13780,13632,52308,77762,88874,33697,83210,51466,9088,50395,26743,5306,21706,70001,99439,80767,68749,95148,94897,78636,96750,9024,94538,91143,96693,61886,5184,75763,47075,88158,5313,53439,14908,8830,60096,21551,13651,62546,96892,25240,47511,58483,87342,78818,7855,39269,566,21220,292,24069,25072,29519,52548,54091,21282,21296,50958,17695,58072,68990,60329,95955,71586,63417,35947,67807,57621,64547,46850,37981,38527,9037,64756,3324,4986,83666,9282,25844,79139,78435,35428,43561,69799,63314,12991,93516,23394,94206,93432,37836,94919,26846,2555,74410,94915,48199,5280,37470,93622,4345,15092,19510,18094,16613,78234,50001,95491,97976,38306,32192,82639,54624,72434,92606,23191,74693,78521,104,18248,75583,90326,50785,54034,66251,35774,14692,96345,44579,85932,44053,75704,20840,86583,83944,52456,73766,77963,31151,32364,91691,47357,40338,23435,24065,8458,95366,7520,11294,23238,1748,41690,67328,54814,37777,10057,42332,38423,2309,70703,85736,46148,14258,29236,12152,5088,65825,2463,65533,21199,60555,33928,1817,7396,89215,30722,22102,15880,92261,17292,88190,61781,48898,92525,21283,88581,60098,71926,819,59144,224,30570,90194,18329,6999,26857,19238,64425,28108,16554,16016,42,83229,10333,36168,65617,94834,79782,23924,49440,30432,81077,31543,95216,64865,13658,51081,35337,74538,44553,64672,90960,41849,93865,44608,93176,34851,5249,29329,19715,94082,14738,86667,43708,66354,93692,25527,56463,99380,38793,85774,19056,13939,46062,27647,66146,63210,96296,33121,54196,34108,75814,85986,71171,15102,28992,63165,98380,36269,60014,7201,62448,46385,42175,88350,46182,49126,52567,64350,16315,53969,80395,81114,54358,64578,47269,15747,78498,90830,25955,99236,43286,91064,99969,95144,64424,77377,49553,24241,8150,89535,8703,91041,77323,81079,45127,93686,32151,7075,83155,10252,73100,88618,23891,87418,45417,20268,11314,50363,26860,27799,49416,83534,19187,8059,76677,2110,12364,71210,87052,50241,90785,97889,81399,58130,64439,5614,59467,58309,87834,57213,37510,33689,1259,62486,56320,46265,73452,17619,56421,40725,23439,41701,93223,41682,45026,47505,27635,56293,91700,4391,67317,89604,73020,69853,61517,51207,86040,2596,1655,9918,45161,222,54577,74821,47335,8582,52403,94255,26351,46527,68224,90183,85057,72310,34963,83462,49465,46581,61499,4844,94626,2963,41482,83879,44942,63915,94365,92560,12363,30246,2086,75036,88620,91088,67691,67762,34261,8769,91830,23313,18256,28850,37639,92748,57791,71328,37110,66538,39318,15626,44324,82827,8782,65960,58167,1305,83950,45424,72453,19444,68219,64733,94088,62006,89985,36936,61630,97966,76537,46467,30942,7479,67971,14558,22458,35148,1929,17165,12037,74558,16250,71750,55546,29693,94984,37782,41659,39098,23982,29899,71594,77979,54477,13764,17315,72893,32031,39608,75992,73445,1317,50525,87313,45191,30214,19769,90043,93478,58044,6949,31176,88370,50274,83987,45316,38551,79418,14322,91065,7841,36130,86602,10659,40859,964,71577,85447,61079,96910,72906,7361,84338,34114,52096,66715,51091,86219,81115,49625,48799,89485,24855,13684,68433,70595,70102,71712,88559,92476,32903,68009,58417,87962,11787,16644,72964,29776,63075,13270,84758,49560,10317,28778,23006,31036,84906,81488,17340,74154,42801,27917,89792,62604,62234,13124,76471,51667,37589,87147,24743,48023,6325,79794,35889,13255,4925,99004,70322,60832,76636,56907,56534,72615,46288,36788,93196,68656,66492,35933,52293,47953,95495,95304,50009,83464,28608,38074,74083,9337,7965,65047,36871,59015,21769,30398,44855,1020,80680,59328,8712,48190,45332,27284,31287,66011,9376,86379,74508,33579,77114,92955,23085,92824,3054,25242,16322,48498,9938,44420,13484,52319,58875,2012,88591,52500,95795,41800,95363,54142,17482,32705,60564,12505,40954,46174,64130,63026,96712,79883,39225,52653,69549,36693,59822,22684,31661,88298,15489,16030,42480,15372,38781,71995,77438,91161,10192,7839,62735,99218,25624,2547,27445,69187,55749,32322,15504,73298,51108,48717,92926,75705,89787,96114,99902,37749,96305,12829,70474,838,50385,91711,80370,56504,56857,80906,9018,76569,61072,48568,36491,22587,44363,39592,61546,90181,37348,41665,41339,62106,44203,6732,76111,79840,67999,32231,76869,58652,49983,1669,27464,79553,52855,25988,18087,38052,17529,13607,657,76173,43357,77334,24140,53860,2906,89863,44651,55715,26203,65933,51087,98234,40625,45545,63563,89148,82581,4110,66683,99001,9796,47349,65003,66524,81970,71262,14479,31300,8681,58068,44115,40064,77879,23965,69019,73985,19453,26225,97543,37044,7494,85778,35345,61115,92498,49737,64599,7158,82763,25072,38478,57782,75291,62155,52056,4786,11585,71251,25572,79771,93328,66927,54069,58752,26624,50463,77361,29991,96526,2820,91659,12818,96356,49499,1507,40223,9171,83642,21057,2677,9367,38097,16100,19355,6120,15378,56559,69167,30235,6767,66323,78294,14916,19124,88044,16673,66102,86018,29406,75415,22038,27056,26906,25867,14751,92380,30434,44114,6026,79553,55091,95385,41212,37882,46864,54717,97038,53805,64150,70915,63127,63695,41288,38192,72437,75075,18570,52065,8853,30104,79937,66913,53200,84570,78079,28970,53859,37632,80274,35240,32960,74859,7359,55176,3930,38984,35151,82576,82805,94031,12779,90879,24109,25367,77861,9541,85739,69023,64971,99321,7521,95909,43897,71724,92581,5471,64337,98949,3606,78236,78985,29212,57369,34857,67757,58019,58872,96526,28749,56592,37871,72905,70198,57319,54116,47014,18285,33692,72111,60958,96848,17893,40993,50445,14186,76877,87867,50335,9513,44346,26439,55293,6449,44301,63740,40158,72703,88321,85062,57345,66231,15409,3451,95261,43561,15673,28956,90303,62469,82517,43035,36850,15592,64098,59022,31752,4370,50486,11885,23085,41712,80692,48492,16495,99721,36912,28267,27882,16269,64483,11273,2680,1616,46138,54606,14761,5134,45144,63213,49666,27441,86989,29884,54334,6740,8368,80051,81020,17882,74973,74531,94994,24927,64894,22667,20466,82948,66831,47427,76033,31197,59817,20064,61135,28556,29695,80179,74058,18293,9963,35278,13062,83094,23373,90287,33477,48865,30348,70174,11468,25994,25343,22317,1587,30682,1,67814,59557,23362,13746,82244,42093,24671,79458,93730,45488,60234,67098,9899,25775,332,36636,57594,19958,85564,58977,12247,60774,66371,69442,20385,14486,91330,50332,46023,75768,59877,60081,92936,72302,75064,85727,52987,5750,19384,33684,78859,80458,69902,34870,88684,49762,40801,86291,18194,90366,82639,53844,96326,65728,48563,26027,52692,62406,76294,41848,63010,69841,29451,36170,21529,16525,64326,22086,24469,57407,96033,37771,31002,18311,93285,31948,14331,58335,15977,80336,81667,27286,24361,61638,57580,95270,46180,76990,53031,94366,2727,49944,19278,5756,51875,53445,33342,1965,7937,10054,97712,87693,58124,46064,39133,77385,9605,65359,70113,90563,86637,94282,12025,31926,24541,23854,58407,32131,92845,20714,27898,26917,50326,35145,50859,72119,95094,29441,42301,62460,75252,94267,38422,73047,24200,85349,72049,91723,97802,98496,12734,73432,10371,57213,53300,80847,46229,7099,72961,13767,65654,31102,82119,96946,65919,81083,3819,57888,57908,16849,77111,41429,92261,45263,1172,55926,78835,27697,48420,58865,41207,21406,8582,10785,36233,12237,7866,13706,92551,11021,63813,71512,65206,37768,94325,14721,20990,54235,71986,5345,56239,52028,1419,7215,55067,11669,21738,66605,69621,69827,8537,18638,60982,28151,98885,76431,25566,3085,23639,30849,63986,73287,26201,36174,14106,54102,57041,16141,64174,3591,90024,73332,31254,17288,59809,25061,51612,47951,16570,43330,79213,11354,55585,19646,99246,37564,32660,20632,21124,60597,69315,31312,57741,85108,21615,24365,27684,16124,33888,14966,35303,69921,15795,4020,67672,86816,63027,84470,45605,44887,26222,79888,58982,22466,98844,48353,60666,58256,31140,93507,69561,6256,88526,18655,865,75247,264,65957,98261,72706,36396,46065,85700,32121,99975,73627,78812,89638,86602,96758,65099,52777,46792,13790,55240,52002,10313,91933,71231,10053,78416,54563,96004,42215,30094,45958,48437,49591,50483,13422,69108,59952,27896,40450,79327,31962,46456,39260,51479,61882,48181,50691,64709,32902,10676,12083,35771,79656,56667,76783,3937,99859,10362,57411,40986,35045,2838,29255,64230,84418,34988,77644,39892,77327,74129,53444,35487,95803,38640,20383,55402,25793,14213,87082,42837,95030,97198,61608,97723,79390,35290,34683,81419,87133,70447,53127,97146,28299,56763,12868,1145,12147,58158,92124,60934,18414,97510,7056,54488,20719,53743,91037,44797,52110,8512,18991,20129,31441,51449,14661,71126,23180,68124,18807,70997,21913,19594,70355,73637,68266,60775,43164,52643,96363,77989,79332,39890,65379,20405,52935,43816,92740,95319,4538,60660,28982,15328,80475,34690,2293,19646,46524,96627,33159,42081,8816,74931,20674,8697,66169,46460,46326,39923,60625,28386,22919,19415,75766,43668,31626,70301,67053,3949,70082,2303,48642,38429,94053,38770,68137,68441,52928,70244,91954,17401,92693,98342,21451,84988,80487,33807,73797,49494,41878,76635,83227,76618,11946,13451,87591,78381,21407,90038,72638,69692,51599,86413,32019,64856,74730,41531,11064,1790,58817,86400,66213,92599,70905,78324,54326,43659,34206,63132,38837,40210,96346,16967,81619,96503,14881,89405,32205,49508,98425,2451,35423,56072,36810,30332,85998,49358,92748,84147,79835,94867,41224,61794,35066,82220,66684,20096,2754,41731,37068,32753,91059,13407,5607,69384,53329,95909,44968,11397,92973,50014,92997,80968,93761,57598,74703,7768,37978,73873,33475,9720,97852,98449,48722,84977,11271,11728,68318,22312,78792,87508,88466,72976,47099,84126,38595,85124,64405,90020,7492,52413,95111,34455,86311,68892,1074,60274,28136,19328,38161,57475,13771,63562,84207,94121,18901,52768,33801,82087,86091,59969,90398,56870,55756,78841,98450,54165,55106,50343,70519,14567,36780,55450,19606,83749,67562,64765,38543,16585,86841,73742,8766,39252,75678,75379,78760,37279,15280,13558,95916,89759,76686,76467,67147,63110,94008,8037,35263,53710,16667,79008,11231,29397,67136,18601,64502,90228,89109,72849,22711,65547,34542,26686,81678,87765,77654,23664,96352,14106,32938,28083,18633,80286,65507,46197,52722,75476,77816,47204,34876,45963,79262,90181,84041,3745,90041,30780,27226,92847,85572,15308,80688,5761,82638,13464,23683,81015,54214,64175,43701,86845,15569,50687,52679,87696,8285,97444,47599,94472,64150,87753,68652,60726,26213,17320,64553,81285,98126,12158,52095,64833,492,35817,55571,91300,97812,37507,4209,53515,64342,21223,16662,43265,68219,3529,43636,68417,53640,95326,93381,37113,80751,76469,96677,43054,22937,31954,13266,34140,27253,2734,99070,60077,57988,93211,92795,83795,57477,3941,39007,14619,38320,93449,31336,25279,97030,26245,47394,39475,90621,23820,29344,94859,91604,14033,41868,14816,4075,66644,87803,97815,99552,78666,3942,8175,22345,19983,76783,99044,20851,84981,59052,77178,72109,76475,21619,73017,6812,56633,50612,55289,4671,84419,94072,94446,80603,32188,93415,23464,43947,43728,74284,67177,57105,31059,10642,13803,69602,46961,66567,19359,84676,63918,40650,12923,15974,79732,20225,92525,71179,4859,91208,60430,5239,61458,24089,68852,60171,29603,42535,86365,93905,28237,45317,60718,82001,41679,20679,56304,70043,87568,21386,59049,78353,48696,77379,55309,23780,28391,5940,55583,81256,59418,97521,32846,70761,90115,45325,5490,65974,11186,15357,3568,450,96644,58976,36211,88240,92457,89200,94696,11370,91157,48487,59501,56983,89795,42789,69758,79701,29511,55968,41472,89474,84344,80517,7485,97523,17264,82840,59556,37119,30985,48866,60605,95719,70417,59083,95137,76538,44155,67286,57897,28262,4052,919,86207,79932,44236,10089,44373,65670,44285,6903,20834,49701,95735,21149,3425,17594,31427,14262,32252,68540,39427,44026,47257,45055,95091,8367,28381,57375,41562,83883,27715,10122,67745,46497,28626,87297,36568,39483,11385,63292,92305,78683,6146,81905,15038,38338,51206,65749,34119,71516,74068,51094,6665,91884,66762,11428,70908,21506,480,94183,78484,66507,75901,25728,52539,86806,69944,65036,27882,2530,4918,74351,65737,89178,8791,39342,94963,22581,56917,17541,83578,75376,65202,30935,79270,91986,99286,45236,44720,81915,70881,45886,43213,49789,97081,16075,20517,69980,25310,91953,1759,67635,88933,54558,18395,73375,62251,58871,9870,70538,48936,7757,90374,56631,88862,30487,38794,36079,32712,11130,55451,25137,38785,83558,31960,69473,45950,18225,9871,88502,75179,11551,75664,74321,67351,27703,83717,18913,42470,8816,37627,14288,62831,44047,67612,72738,26995,50933,63758,50003,43693,52661,55852,52372,59042,37595,4931,73622,68387,86478,40997,5245,75300,24902,59609,35653,15970,37681,69365,22236,86374,65550,343,98377,35354,65770,15365,41422,71356,16630,40044,19290,66449,53629,79452,71674,30260,97303,6487,62789,13005,70152,22501,49867,89294,59232,31776,54919,99851,5438,1096,72269,50486,16719,6144,82041,38332,64452,31840,99287,59928,25503,8407,46970,45907,99238,74547,19704,72035,26542,54600,79172,58779,35747,78956,11478,41195,58135,63856,33037,45753,60159,25193,71838,7526,7985,60714,88627,75790,38454,96110,39237,19792,34534,70169,24805,63215,38175,38784,38855,24826,50917,25147,17082,26997,32295,10894,21805,65245,85407,37926,69214,38579,84721,23544,88548,65626,75517,69737,55626,52175,21697,19453,16908,82841,24060,40285,19195,80281,89322,15232,70043,60691,86370,91949,19017,83846,77869,14321,95102,87073,71467,31305,64677,80358,52629,79419,22359,87867,48296,50141,46807,82184,95812,84665,74511,59914,4146,90417,58508,62875,17630,21868,9199,30322,33352,43374,25473,4119,63086,14147,14863,38020,44757,98628,57916,22199,11865,42911,62651,78290,9392,77294,63168,21043,17409,13786,27475,75979,89668,43596,74316,84489,54941,95992,45445,41059,55142,15214,42903,16799,88254,95984,48575,77822,21067,57238,35352,96779,89564,23797,99937,46379,27119,16060,30302,95327,12849,38111,97090,7598,78473,63079,18570,72803,70040,91385,96436,96263,17368,56188,85999,50026,36050,73736,13351,48321,28357,51718,65636,72903,21584,21060,39829,15564,4716,14594,22363,97639,65937,17802,31535,42767,98761,30987,57657,33398,63053,25926,20944,19306,81727,2695,97479,79172,72764,66446,78864,12698,15812,97209,38827,91016,91281,57875,45228,49211,69755,99224,43999,62879,8879,80015,74396,57146,64665,31159,6980,79069,37409,75037,69977,85919,42826,6974,61063,97640,13433,92528,91311,8440,38840,22362,93929,1836,36590,75052,89475,15437,65648,99012,70236,12307,83585,414,62851,48787,28447,21702,57033,29633,44760,34165,27548,37516,24343,63046,2081,20378,19510,42226,97134,68739,32982,56455,53129,77693,25022,55534,99375,30086,98001,7432,67126,76656,29347,28492,43108,64736,32278,84816,80440,30461,818,9136,1952,48442,91058,92590,10443,5195,34009,32141,62209,43740,54102,76895,98172,31583,4155,66492,58981,16591,11331,6838,3818,77063,12523,45570,68970,70055,77751,73743,71732,4704,61384,57343,66682,44500,89745,10436,67202,36455,42467,88801,91280,1056,27534,81619,79004,25824,66362,33280,20706,31929,57422,18730,96197,22101,47592,2180,18287,82310,60430,59627,26471,7794,60475,76713,45427,89654,14370,81674,41246,98416,8669,48883,77154,9806,94015,60347,20027,8405,33150,27368,53375,70171,59431,14534,34018,85665,77797,17944,49602,74391,48830,55029,10371,94261,16658,68400,44148,28150,40364,90913,73151,64463,50058,78191,84439,82478,62398,3113,17578,12830,6571,95934,9132,25287,78731,80683,67207,76597,42096,34934,76609,52553,47508,71561,8038,83011,72577,95790,40076,20292,32138,61197,95476,23123,26648,13611,48452,39963,85857,4855,27029,1542,72443,53688,82635,56264,7977,23090,93553,65434,12124,91087,87800,95675,99419,44659,30382,55263,82514,86800,16781,65977,65946,13033,93895,4056,75895,47878,91309,51233,81409,46773,69135,56906,84493,34530,84534,38312,54574,92933,77341,20839,36126,1143,35356,35459,7959,98335,53266,36146,78047,50607,22486,63308,8996,96056,39085,26567,6779,62663,30523,47881,41279,49864,82248,78333,29466,48151,41957,93235,53308,22682,90722,54478,7235,34306,15827,20121,96837,6283,80172,66109,92592,48238,76428,94546,45430,16288,74839,740,25553,83767,35900,5998,7493,46755,11449,88824,44906,33143,7454,56652,34755,63992,59674,65131,46358,12799,96988,51158,73176,1184,49925,63519,11785,29073,72850,47997,75172,55187,15313,40725,33225,56643,10465,38583,86440,97967,26401,17078,38765,33454,19136,57712,48446,98790,27315,71074,10157,57946,35582,49383,61324,26572,84503,3496,60449,17962,26017,65651,40400,83246,80056,75306,75147,41863,25581,87530,33193,43294,5065,99644,62771,75986,79005,44924,18703,40889,4403,5862,2571,82500,74200,36170,46836,74642,65471,26815,30937,64946,10160,15544,31962,54015,28853,66533,14573,79398,47391,73165,47805,77589,16881,13423,89452,76992,62509,9796,57540,13486,48855,25546,47589,21012,47388,78428,70196,84413,81026,87597,22445,83769,85937,38321,85485,87359,9839,67228,71179,94372,4446,62801,50775,96179,40646,44272,12417,47199,39701,30665,32775,66525,53558,78882,31939,67209,38906,34533,99914,27719,216,99225,96537,3843,90564,91110,51838,30300,9559,37795,94880,11325,44979,89696,28129,29931,89971,46292,92710,11036,74760,75307,12291,49618,16293,92408,67928,80823,32872,25460,66819,35374,4035,99087,61129,11341,39118,10891,37217,63638,75477,30068,42334,57570,6890,59353,89939,37692,15232,20033,32202,22348,2766,96791,58448,92248,5769,96684,67885,99295,47271,38655,59513,96960,31718,8974,16122,20535,52380,29769,70660,57425,50891,75044,84257,73315,38181,28673,93140,26307,82265,78382,19681,56585,8975,76764,39956,83450,84663,89963,71584,57696,30829,60527,64947,34899,28805,28397,91830,51842,99838,39839,66971,67177,74219,35637,35634,93581,81746,29991,81096,94279,2968,62561,2479,82126,25702,67953,88088,50293,83423,86206,39935,23253,43041,48941,85787,8388,6671,43574,84908,67295,33623,55060,28174,48415,2529,22009,24524,5283,30460,32399,80423,56929,40852,69969,88541,5979,91496,64730,57198,83145,39750,3568,54669,98679,4297,51047,31492,47734,31343,31180,232,19707,24823,75079,73943,17997,8446,91252,39879,58682,82972,18417,39203,36681,42895,8459,15618,17941,52594,43277,16530,40052,91100,87422,47230,95699,49794,50492,87439,86354,4546,65333,11057,77727,19748,38722,91821,18107,42125,89239,28847,54623,38783,47803,31414,38450,3697,89186,30579,44188,26532,8420,80723,48100,60748,76330,45832,8311,16051,4475,13400,48527,46073,17439,56498,94632,9021,16871,83366,14896,4219,38375,87890,90217,42370,61028,85101,76771,83715,94737,69973,74187,1958,59691,86712,86570,60984,76342,13648,85250,28323,48379,45141,36277,51845,29039,3553,5128,59866,51281,68124,17007,24729,29710,41439,40574,11774,86746,89698,56020,37810,88972,11361,95583,70786,589,74473,87513,17690,61427,72914,32517,1804,97910,6327,30246,33049,2622,41026,80875,41293,16752,84225,84414,37137,68956,8095,64981,28180,38629,76962,23840,17477,75268,48297,70340,57888,13938,38554,86836,2195,30270,55484,53364,54705,41380,56316,37723,234,21424,26664,63804,75139,36534,18579,9833,98849,72762,59767,52497,24227,83152,71794,21398,99456,89215,51632,54799,27973,68568,68465,98500,28681,18369,24279,96335,12874,82160,67202,85199,27908,67022,49810,77929,96212,81153,77884,7032,1671,53362,28119,56786,30883,28540,76029,3774,64611,19736,25589,46569,45206,48215,69523,17423,91807,90039,30393,58319,85098,66519,57571,24541,3562,14400,62731,82534,61477,89731,18421,29861,52829,838,78040,43350,74323,82892,84746,28302,13264,7595,134,12933,46831,24864,47275,20527,9110,28485,30326,99826,64005,99308,65779,42760,90066,3974,38688,39968,32604,11694,46262,73262,45405,43923,67397,88228,56405,17839,92073,57622,93328,15442,50186,7570,58001,31e3,8915,11467,14793,82691,51238,12485,51745,18192,5985,36826,89434,38669,91592,88799,65621,67237,59541,19657,93402,58705,73553,78280,69125,95591,81168,91927,25976,89077,71690,19404,64603,59752,74698,44233,67602,38615,31303,28650,53700,89819,7783,4351,77451,47350,21234,16016,41532,76508,23063,44993,43983,33356,61715,96485,22121,78004,6316,87896,99289,93981,37850,66128,92735,45064,50924,24204,58816,65290,34392,55567,66416,72353,45775,68590,85685,72683,60090,37149,85347,57414,72336,12979,5720,92754,76911,96883,74420,5220,85815,23557,80567,44365,70254,50864,36619,51479,23281,76428,18580,34240,59289,49076,18439,29522,42541,4024,84446,92434,90407,77241,19690,78143,65919,13699,91844,91241,38361,67171,90551,5709,3474,76025,97043,33834,44638,54040,82797,545,38159,16089,35870,89158,55864,98078,50563,36492,10994,85909,9018,19252,73887,67928,60045,70782,11937,4074,53814,46621,52577,94853,45968,73667,65062,73306,76045,78649,91654,53958,96537,95542,67622,54579,17279,67440,56441,20681,64011,52226,96618,32831,60664,67547,39523,2043,59748,1887,69229,94653,99271,98164,62155,9234,47367,13047,6364,35064,10073,6793,80248,29009,44969,11129,17139,79630,89772,26921,56949,23465,30036,17173,82459,96218,60768,76417,24405,18710,68887,82394,69729,82503,40873,41590,67255,30757,9657,91881,34578,9511,5417,58953,18532,10721,22029,48524,47778,881,83489,3464,57462,97459,86689,39755,39547,740,36666,7993,31671,86304,12970,73402,52849,31652,79655,11250,18463,57518,20306,25301,1374,51208,33298,87662,61849,60923,68685,69411,39266,80320,34844,89416,81569,83651,35795,40168,33501,1042,58931,3892,85188,74740,85476,23790,33842,89565,53359,25579,59049,62394,72435,12457,21904,18370,97035,57905,9581,91227,92754,37760,1411,7440,87175,88318,63242,85960,56690,12618,30493,11569,73723,7448,58830,157,65814,21118,22140,73793,57855,81830,6795,13183,12625,30635,56429,73216,12342,36722,83886,96828,82870,90954,97614,2370,42160,73370,11944,49067,59452,80495,43911,46712,17033,68037,41963,3874,44856,82985,57453,84358,16120,4454,76624,405,62369,55080,61880,51270,87807,10653,36894,70850,35660,234,14705,93418,94084,82856,25384,71555,56754,78315,18291,91656,98079,52384,43306,65205,75903,58701,99496,50048,33557,87793,90857,10143,46726,84284,43635,41213,83845,70986,91408,80220,5728,68890,46577,21152,43759,43301,93661,97252,50106,10099,13722,18572,44024,351,18173,23717,85114,85998,57782,63951,53723,86853,63851,79430,49181,46386,69666,55743,76162,71724,40028,94786,34457,16906,90040,30789,40281,94697,96584,81907,4055,53990,66397,80579,42517,78181,39251,9467,67097,95523,66568,63632,71048,15581,39904,75774,77495,75994,29911,65690,41178,47712,70355,16998,56025,5230,10093,71495,34784,70950,54680,57811,53782,39145,36829,85342,40406,35883,45668,3459,29870,78252,70088,70621,67153,5737,40933,91075,93335,86853,15860,81167,91259,16118,52401,83593,84474,2423,75608,39646,90871,70284,82100,96032,5115,63678,2225,88087,58581,44364,57468,21539,13042,64150,63754,5210,87644,54114,64013,63562,41388,32397,74152,23982,71982,71700,33026,66477,47838,46712,39848,35083,65927,97868,11067,76771,71799,43836,41014,97025,93225,8511,63096,26628,73012,12543,76269,99708,2629,49845,73677,19193,14924,57236,95564,15010,59667,73773,78515,2624,99744,13585,33746,58771,94785,62628,99585,11363,80832,59979,9444,78700,2596,85984,69438,16913,96475,93283,18625,77086,45911,39746,64722,39938,43930,54619,302,50384,2738,75714,75249,95439,80714,52555,47266,96190,78750,94973,83669,16479,53163,48071,28e3,45011,26733,67132,83362,84162,43028,8415,27236,52651,89059,64844,80910,1676,91752,57815,26264,3415,57532,29981,61200,96036,62600,20068,56530,38487,8432,89514,26883,69165,97237,22361,55276,39902,95927,82190,49269,27212,46095,37106,64254,27460,49572,51700,27679,12574,33891,3867,9925,6476,82018,45094,59014,67113,44192,75,23318,79895,70550,81717,28833,30271,15821,14999,88174,62617,57517,55256,50281,51583,96879,5225,42272,5339,20483,57596,41011,75937,22767,50120,95938,49753,63882,99616,69083,38721,73889,80236,99531,23053,71237,48861,59046,76283,60538,19732,93877,30345,64882,66660,17026,70364,45676,8039,96228,89936,59141,95585,89552,97247,59325,27848,80058,15950,61481,90906,40998,44137,16144,66300,44091,50018,81364,18211,60294,76559,20279,27414,10589,39860,23e3,31767,95618,56738,50332,16936,70342,92481,30702,76264,62619,68678,62284,83112,93032,55203,52614,36950,41796,45403,79262,2887,53596,61308,20738,34811,27099,90956,65448,3080,75795,29753,97699,80872,23830,85882,74427,99523,74904,28017,45898,57232,48525,7086,26805,74533,92470,18840,76011,93109,14344,55614,50284,15865,19458,35856,13464,53679,64603,51571,56124,79107,29596,89572,78198,57121,73649,8804,87977,87959,70859,40909,77295,87877,75158,62810,92074,23244,59516,50552,31602,41899,6347,27821,68370,48596,88577,30231,25267,84622,31449,12086,56461,22962,78213,62483,93966,60437,52239,58113,32526,38708,81607,57016,1695,90110,4649,59990,23979,3855,10297,46516,96092,82305,30760,78756,4967,82876,4773,86651,16648,53133,82439,78851,49766,24553,15273,36417,1901,33386,76979,25920,33372,2695,11982,40911,6230,91696,43907,17827,30332,89203,32215,91806,23080,49102,9174,11548,54590,75803,66108,73882,62324,26017,72716,33887,1285,31604,71039,24337,53514,58964,89901,22040,92751,12617,37007,5523,61672,62557,98540,26094,60284,19621,96230,38044,6545,9458,42988,2913,86345,67936,90174,40840,44991,24256,34989,74086,13652,68706,1363,4294,88008,78693,83068,94746,221,89299,53186,5930,61889,51341,45412,58860,72568,11381,59785,36887,10690,31347,93326,96267,86987,57565,86836,49071,90331,41248,34629,30240,27270,3864,84308,3035,61369,36902,51017,44409,17120,23823,36460,63359,8333,63173,19134,6493,303,18550,26191,19051,81502,66343,6737,90430,65478,58982,82484,16483,47704,44640,68322,44548,72787,2335,28749,39320,5436,98146,56596,812,51445,35533,35478,47573,38414,25542,38032,13442,42983,97207,77854,57806,81616,52828,79429,47389,96795,57764,19605,24767,63253,18809,65093,44449,22952,76872,30983,38948,9310,48336,87651,27110,84427,76209,56412,12760,16747,14551,82626,31224,98636,75100,84882,79479,83420,5347,6803,90063,4617,40257,79183,41766,71873,25242,12275,336,40798,42055,74066,69128,32547,76508,32530,42359,89207,49758,58984,92732,15779,7234,28884,28226,50011,35883,99606,45423,76224,75427,85747,33879,97978,57441,927,19164,74716,40702,19715,70917,60344,40236,9019,50577,15598,53136,57285,20536,7539,74832,89184,41501,39447,97422,97041,21913,40581,76081,13089,28776,54164,55736,36263,71841,34488,74988,55467,43322,9214,36746,67981,71877,81683,32461,84091,19422,88366,62054,85664,13409,8003,88276,6989,16607,33633,85349,5784,25950,97998,74110,16699,60184,92818,79705,10381,1474,18656,50434,18232,92132,66537,70141,42854,25120,39581,28249,14215,34810,19767,3409,11807,6566,66138,42997,41999,67504,87117,28961,5e3,29673,77726,73225,54753,69712,71576,92337,17713,63185,87923,91889,68351,17712,75532,93849,48280,62219,317,25290,29209,90927,92929,92762,60413,2018,31793,76290,73373,80777,60819,77375,57886,47291,99670,32605,29064,99476,80999,31217,35,91300,14892,73653,26593,25305,56797,12837,39560,27582,37253,38531,76489,49946,69108,58687,43092,73807,96282,6648,67431,87124,57694,21660,64002,6,33600,30245,60636,80164,9285,61426,4658,54130,14710,76553,1904,93668,63110,98618,5601,32199,74923,98049,49717,55539,35940,58545,43295,35810,45451,38735,42065,66769,69825,45461,83881,67372,67351,90612,79502,69460,23108,74421,82990,46821,40683,71603,55267,48192,50242,79738,96417,6664,19929,23644,41116,51056,219,45086,32747,49492,15399,24874,80825,95928,61457,45813,59037,16136,3953,83583,5910,12654,53630,92997,22168,93491,71897,74579,24022,6278,24049,71670,43044,8474,38572,77402,35800,7455,96177,41653,74493,20802,65843,73050,73349,2638,65813,96209,49196,45007,32207,14097,66059,46681,7534,71263,20582,10171,51514,52142,60961,57951,25637,37860,21683,86190,90434,94481,85697,95344,2606,74095,61133,7472,64777,94050,41482,975,23471,76052,82021,87676,91345,20196,2612,86299,44996,40312,65712,46079,88514,8610,3685,63197,9073,53105,86824,28112,99306,40706,66840,83003,51590,52755,32285,68454,85058,13645,23073,24724,52989,71880,21952,44144,74975,76715,7844,46447,86643,75579,29276,10864,83179,36721,19300,35066,29383,47478,56644,33354,31414,17643,92374,85085,88458,87191,85248,34963,76278,53230,13953,76985,70959,36663,5293,32658,56767,56997,76736,6558,64248,11907,29123,78458,17678,63805,89973,5076,39263,54404,4355,64957,74407,99838,18836,78098,6490,74888,73719,80675,86178,56283,33591,96957,38382,18772,74773,71229,2603,52673,44609,14843,58418,18060,95459,626,30914,13550,42195,44863,8871,89182,64446,78422,41140,15312,98274,48168,95651,35562,85386,56252,72136,85088,68761,78434,98143,61330,2446,64409,49406,99127,98626,55095,44808,13594,87370,89472,12833,98932,68064,58193,20225,5192,28425,23978,24542,80845,55858,4015,21454,37346,51007,17202,10242,12682,55933,96922,22280,75597,50227,70712,44236,20470,36320,49339,60536,80083,38880,93327,49522,93585,9918,55268,4671,57526,11457,48424,54610,7211,78610,9473,72923,27347,30057,76968,26177,59367,46172,88951,40229,34921,60405,88959,16779,29547,92231,61997,36002,21080,39795,77221,10012,49748,76900,15964,3803,40260,92351,92844,10288,57483,10881,70408,75688,16610,1638,93082,44282,66849,75702,69428,34047,84968,71281,72328,73143,88672,49802,50639,18129,93659,58389,49095,45971,34196,84609,59222,19332,17777,41004,47057,30688,16039,20906,41477,42915,60877,33864,75195,62294,3371,11672,1370,2486,35553,17907,90621,45136,9722,67635,12114,63055,16004,21625,24321,20491,26881,66259,94287,54751,36242,36557,5842,30687,65418,94608,24741,45887,78800,86912,42076,50287,9284,68891,76368,83094,96302,35997,30761,97081,9501,68887,32876,1705,34260,95065,45528,88241,30402,12318,52430,40139,96986,84900,72408,42027,31676,54382,73370,26184,14024,57444,57660,52173,30274,93448,63273,77681,74946,2099,69091,19372,66961,14595,58642,75760,52253,53148,26074,52293,65359,63971,4833,86492,1227,54505,19515,89889,46933,13364,33883,83389,36952,52505,67513,40071,31001,3105,87912,29610,75108,37363,28479,43546,89992,19550,54863,82633,19209,21548,35022,21960,57961,11815,95867,559,26428,69386,57453,70147,73538,49562,46806,64550,36653,25718,68792,31113,7607,48037,71020,22666,65957,11141,39227,7990,19849,65972,74528,40888,55386,95918,92088,91125,53648,66122,138,79933,71058,34826,97725,69513,22915,18246,52244,91161,40861,40374,13239,56162,4703,95851,22824,41271,28202,62852,84238,46625,20031,8524,20077,65817,21174,29279,57712,22401,67500,30980,74485,26480,21343,30031,61921,35744,57308,71196,1865,49234,62616,54021,29008,83672,85839,96836,45077,80900,66906,63526,93824,71820,11033,20183,85704,4683,63512,39144,56880,64424,95979,17709,94849,31771,5737,84286,16757,46256,24478,73180,59978,8254,78963,95437,86351,33824,32540,18357,2668,99260,21284,81351,70961,10255,6911,47394,72408,23827,59865,96395,30665,43699,3593,29165,23388,26628,92402,16731,86740,29493,9069,78653,90094,42735,33682,95041,89887,92369,57949,81585,50593,14698,4737,72551,57271,59433,156,33966,58773,59108,49578,18100,59836,73221,21110,1650,11058,47770,66141,84576,58388,40915,94507,32209,17272,65674,95552,25685,5345,36995,36302,7971,67001,62062,75939,36005,26739,56484,46885,66348,87666,78055,44485,82955,85936,9219,1847,92687,72579,45457,78252,98239,4e4,75563,92408,17175,78845,32638,26959,35406,59553,57852,7506,9,93172,77713,93880,40981,27924,9678,24538,52426,84852,83781,23712,82490,77890,22482,66668,55850,25644,44972,62275,78089,28894,98685,32998,98766,89119,34355,75127,69797,71419,62067,57990,96514,50603,79807,26135,29207,43632,32905,38513,18924,88872,20758,70232,60425,1116,24077,21369,93541,75329,78656,44251,42014,98154,42552,14575,30765,348,1134,71581,68420,78141,21105,63305,9718,54851,65867,8595,47390,39182,51174,41478,64433,59628,31945,87322,78667,95282,5622,26224,19972,97269,98376,14779,51138,49658,45345,4972,52794,15737,496,48939,63485,42780,16061,59631,37171,13483,56058,51093,62290,88227,17400,88433,67363,89507,26482,85964,71336,67799,28342,37747,61722,27180,78755,18603,42953,6606,23875,56766,1932,36113,62807,84012,21103,9685,69662,76755,13701,95168,13169,44726,15284,16702,89617,54397,52052,12835,37741,86434,22400,37947,95763,86337,35189,22756,47473,16618,42479,47405,14055,64262,66670,89692,54032,94591,44149,29854,76691,33263,62048,25116,88598,16119,62116,54517,31883,86707,18895,81790,71294,2684,15292,48107,14341,91416,75609,92564,39987,2283,89970,95855,80970,5432,89860,90293,99851,94648,5598,32171,28793,92305,64244,8277,93391,96717,34464,29838,10664,28050,60122,77934,10758,84922,92220,45071,97697,36368,17792,84792,76594,67319,51886,5665,45201,11348,9254,7510,51039,91683,84500,85338,5555,19633,3870,39576,41486,58524,54508,20707,58504,39642,22454,80069,83455,31043,90794,51934,3295,26582,16300,74990,22197,83310,69642,81113,58558,84833,17105,46659,25003,85749,44829,4103,67516,76458,52392,53546,70291,98846,67315,30686,18555,29755,5923,22732,19501,56181,85351,5023,4808,56911,16793,75336,49712,27723,96974,34321,5454,12862,71924,45928,95697,68664,58183,78104,42483,71204,99628,40642,56410,17350,13396,76724,87509,9158,83708,27298,92651,95086,38851,63558,89810,1580,32518,35795,26514,56322,78635,63731,91428,7247,66460,38671,26799,22549,47991,46064,80467,40083,17141,39152,99872,27561,75389,74778,94893,82935,99076,93419,10474,84436,47536,16719,60136,80566,28404,74525,74212,3704,65516,98197,34210,64140,22238,49939,99542,27481,21992,78181,90060,71365,66935,29578,14961,8569,9454,43308,66753,45972,93572,16382,87320,37183,25478,38164,31997,69856,60898,63968,62264,4799,17591,89937,73905,55890,88285,2448,40398,54180,65869,45155,43407,39105,339,51619,20203,21189,68245,76912,1222,76411,82679,7,66047,32043,42627,16638,27019,15248,66444,8249,18790,82150,54084,84469,3426,50226,99868,88894,43769,66384,8593,41414,2976,60053,51866,87904,74135,53842,59520,67482,16995,32328,29555,49067,2799,68851,41049,97190,53984,99755,46412,45885,64e3,21962,36438,71742,57223,66599,86071,31436,32667,98099,38399,47377,5171,2742,48803,17823,22093,9866,691,5514,25546,2114,5919,56181,96052,67211,61712,25995,3188,23833,38549,44775,55355,61548,55988,47309,23749,30667,70732,33299,16127,30842,78961,41072,9876,18903,30292,25275,61881,15939,72573,84502,92654,97226,53434,77025,63892,12421,33644,39445,30933,84218,13757,37719,84450,2697,60309,22402,80310,92771,45205,72792,95776,85945,74651,216,50842,47854,21916,61588,75405,10495,83083,60427,78495,99809,47890,22993,21508,9459,26845,98130,1184,46438,27698,40652,65654,98517,1096,6998,49133,57041,77983,58708,42176,67356,324,70063,10597,65205,25622,34336,16640,27896,26907,86760,48244,89650,44997,51609,28934,9171,97859,97213,19859,41037,64081,94781,27683,41521,52871,86935,26486,38744,25943,60617,6414,42292,46204,53262,30201,38776,88831,97253,67282,72860,18452,60927,81504,57713,30296,10896,39900,67135,42772,4631,55283,39253,25264,1809,12874,88035,88421,90491,83290,6884,15444,90113,20406,20796,40239,34431,15018,45600,17241,26611,9551,89126,65673,31708,91252,39647,63011,24193,58932,89326,33491,53217,27976,70151,37531,53576,23931,11789,73073,52171,89301,51718,15385,79487,66436,35771,34163,86540,42665,80748,77622,14679,40185,25030,42622,13162,17048,24243,59985,59807,60562,3595,10135,29199,69784,59796,38194,58432,50943,40422,63035,3208,81440,90749,88046,32218,88092,22224,2627,91576,16781,43948,57795,71073,27817,87077,82717,24473,42096,76920,88864,90537,14715,42551,45066,24316,37361,38582,21871,14672,93362,21727,57021,94313,39562,64985,94028,46094,43845,91838,79574,7597,3153,56783,18817,74711,6883,91061,31674,73729,99315,66183,57647,74484,68077,33224,397,56753,53158,71872,68153,9298,20961,49656,33407,95683,14328,44708,72952,27048,67887,28741,46752,88177,95894,40086,88534,87112,68614,83073,88794,96799,67588,75049,84603,83140,97347,87316,73087,77135,71883,98643,3808,8848,14133,60447,1366,72976,1868,51667,63279,60040,88264,79152,3474,61366,20523,21584,93712,83654,89761,90154,96345,37539,32556,74254,70603,97122,44978,78028,8943,13778,11080,34271,68276,85372,48410,94516,15427,75323,71685,70774,50342,33771,3678,42321,69788,41758,55004,30992,17402,63523,42328,87171,24751,15084,33884,83655,88345,69602,52606,57886,18034,3381,75796,35901,77480,28683,68324,66035,7223,14926,16128,13645,90370,31949,11057,98849,29499,21565,30786,83292,92392,37104,36899,49906,79368,43710,80365,88735,75275,21664,57965,19002,301,12658,94385,1717,96191,50404,80166,93965,24688,27839,10812,31715,92127,42588,93307,80834,11317,26583,25769,98227,14884,58462,29148,68662,26872,72927,79021,51622,29521,33355,45701,45996,33782,93424,16530,96086,17329,74020,11501,46660,5583,22277,77653,55430,84644,448,86828,58855,67451,95264,67386,82424,52611,60012,88620,72894,94716,22262,99813,69592,63464,33163,91857,47904,22209,78590,68615,52952,31441,41313,18550,72685,68825,4795,53971,14592,39634,23682,76630,2731,81481,86542,23727,54291,56045,61635,32186,9355,73416,63532,24340,18886,84832,30654,48543,18339,65024,91197,64624,74648,9660,27897,49771,11123,8732,49393,12911,72416,17834,18878,62754,85072,23727,56577,51257,83291,12329,16203,91681,68137,79959,43609,58987,2026,42969,59144,84349,75214,76972,22633,64104,53799,16851,99197,70476,77113,46320,88693,37711,96536,68156,7119,2104,49435,77706,18924,24957,92406,87148,70482,36491,42605,54440,7893,31618,35707,65130,30007,75706,77266,37100,9601,87681,42543,69847,81848,32034,49429,99434,62209,17125,55227,61634,52574,83649,28725,70119,62467,80676,21192,99584,21310,25292,72781,17186,10393,98390,19789,92931,36234,62627,23437,3885,58822,82941,43806,8172,23790,72295,36196,98200,2889,87619,13846,56197,27151,21238,48794,81100,62643,40001,39243,33213,78416,194,91369,79342,36404,52308,13741,24442,88610,12659,11574,70052,93039,79367,41792,61816,35435,47192,97596,28330,41145,16918,62865,9576,45857,68737,90124,16703,7071,48433,57222,34435,800,72496,16449,68187,28739,97672,86818,50768,40807,88681,64340,2224,19703,59245,90905,31239,84216,93942,97371,16842,92168,52692,16064,84686,89444,27938,98406,41365,4515,20494,18813,16242,10634,61566,18592,78057,8720,33739,78345,87693,30242,70545,55521,23687,9160,8655,38811,61768,7228,5567,5561,82071,85,50145,23113,97761,88441,14891,72188,85166,37189,75671,81377,92470,73645,93258,6610,12185,43065,26704,47922,56650,7527,18006,56948,51675,16658,66402,1047,81624,77395,62310,73262,66050,57275,32936,87641,51528,58183,21952,84098,28913,28622,18140,89796,41317,93954,67690,64667,57092,21315,4731,76115,77291,11204,8634,93034,27411,27149,13843,9817,9407,84492,28444,59901,14592,89654,66207,66232,80293,74502,36925,55515,10121,16768,4720,71502,40500,21406,571,87320,81683,42788,86367,44686,22159,67015,35892,49668,83991,72088,30210,74009,86370,97956,2132,93512,54819,26094,51409,21485,94764,85806,13393,48543,7042,76538,64224,47909,9994,23750,17351,52141,30486,60380,86546,66606,36913,58173,45709,83679,82617,23381,9603,61107,566,6572,64745,10614,86371,43244,97154,10397,50975,68006,20045,16942,25536,74031,31807,70133,78790,40341,68730,39635,39013,66841,44043,96215,21270,59427,25034,40645,84741,52083,54503,36861,27659,95463,53847,40921,70116,61536,56756,8967,31079,20097,76014,99818,16606,19713,66904,27106,24874,96701,73287,76772,6073,57343,51428,91171,28299,17520,64903,4177,36071,94952,59008,28543,11576,74547,13260,20688,41261,2780,6633,37536,8844,95774,49323,30448,14154,83379,71259,23302,68402,43750,88505,15575,44927,6584,29867,21541,65763,12154,86616,79877,73259,68626,98962,68548,86576,48046,51755,64995,3661,64585,81550,46798,49319,50206,22024,5175,12923,23427,55915,91723,55831,83784,81034,86779,34622,84570,18960,48798,42970,95789,39465,82353,68905,44234,18244,54345,5592,89361,14644,67924,66415,89349,88530,72096,44459,5258,48317,48866,56886,90458,75889,4514,37227,11302,4667,2129,80414,86289,15887,87380,50749,83220,50529,20619,11606,36531,23409,78122,19566,76564,33045,66703,30017,35347,35038,12952,13971,3922,98702,11786,38388,69556,76728,60535,59961,23634,42211,98387,34880,27755,93182,99040,96390,65989,38375,3652,59657,57431,24666,11061,64713,85185,72849,58611,31220,26657,77056,24553,24993,5210,89024,32054,46997,92652,28363,98992,22593,97710,47766,37646,93573,95502,33790,92973,27766,62671,89698,10877,73893,41004,96035,18795,48080,59666,30241,35233,87353,43647,13404,41982,19264,29229,61369,8309,39383,42305,25944,13577,51545,68990,69801,37145,79189,55897,57793,66816,21930,56771,79296,73793,21632,42301,23696,72641,56310,85576,3004,25669,69221,32996,23040,65782,23712,13414,10758,15590,97298,74246,51511,46900,36795,38292,3852,6384,84421,3446,91670,45312,27609,87034,6683,83891,88991,16533,9197,34427,60384,48525,90978,46107,21693,12956,21804,46558,37682,81207,85840,53238,35026,4835,53264,41376,17783,64756,39278,25403,33042,20954,31193,24247,45911,92453,25370,86602,48574,57865,26436,16122,76614,17028,21262,59718,77821,14036,31033,90563,45410,15158,90209,84089,38053,60780,54166,14255,33120,27171,71798,91214,80040,56699,12475,40193,59415,4769,75920,1036,2692,75862,16612,73670,61182,3305,90334,187,91659,28063,75684,50017,82643,9282,77376,85469,8164,5584,36623,82597,83859,3435,98460,70095,80257,4381,6501,8924,35514,14297,54373,71369,5172,15955,82441,4636,48215,6821,3385,17663,40107,55679,30366,42390,95895,16083,58499,17176,55993,51034,49296,4010,78974,35930,2019,96226,27167,68245,53109,59037,37843,79243,10262,58797,61490,82590,52411,54783,29447,94551,30026,97959,93939,73217,82573,62154,78291,33728,39102,11484,86210,43794,73553,87435,1110,77108,56521,78610,8254,1842,43068,70415,79195,26136,49786,47279,38471,20379,54704,86614,91138,51595,50818,80186,73087,17262,94735,4952,27935,4928,74862,51392,62388,9570,38485,30594,56278,47395,72762,94597,72279,16010,34697,54475,67874,78014,88381,4045,41494,55178,46054,24373,1824,55333,7525,97908,61178,84635,2199,35361,4803,21907,79414,66083,54782,58692,28332,41851,28198,55819,37313,67046,16147,90478,71230,34141,85002,44332,35906,429,39744,773,22909,19536,98986,90945,45209,85439,92265,25291,22775,60611,49159,95701,36113,53923,60824,84935,29656,50007,86624,61691,76150,32187,42765,60660,13859,10792,88210,29374,29563,45188,28811,19739,67649,73775,99247,48414,91067,68253,9452,90116,91737,73979,62370,69112,58791,20349,71480,56852,36919,87977,77609,68738,85159,4918,70076,46473,4122,57713,1426,50987,77910,66211,62546,77749,96462,34304,77441,12104,91805,10287,60943,49632,83116,25716,23113,22707,77770,31176,6759,46130,4739,55554,3843,31653,70834,72877,41561,36903,23010,6663,2266,16360,70118,91936,17098,77278,4880,23484,94970,41826,46733,93484,68350,38861,18134,32936,241,24803,13876,93278,5039,35873,44418,5305,28510,36115,46717,15238,78607,23464,68635,55712,55007,92411,65739,4858,67537,37041,67453,89801,45963,14800,14225,65655,80463,9716,77255,65136,11230,76323,81433,36445,86523,61058,59560,19380,40791,48073,29626,36661,87907,57369,41623,13705,3880,45088,55444,41003,27754,1450,75312,71801,99600,60719,54182,29245,63315,73758,42973,32702,10855,56363,14638,84424,27178,78195,3133,70865,48019,26117,7151,52107,85562,41347,50486,69457,86961,95482,11857,93587,45680,42145,13029,10043,5142,49213,54525,85761,42707,70754,33768,87671,85038,58900,88438,20004,63390,14815,38875,73417,82875,89481,55517,944,15773,61814,32915,27868,5510,21916,28426,89881,16680,88850,11056,51991,4230,39107,49216,40065,4523,75848,95349,56034,10724,9885,88232,42478,65702,95696,39746,66032,88082,86905,30007,75068,66629,7358,26706,90511,72843,67857,20061,98581,69682,38e3,14186,70,2290,17269,30909,69449,19997,13275,2444,84985,51290,97641,15092,69650,21920,19617,7418,49725,91090,20805,28627,80665,67192,34697,57667,99323,50101,40587,35081,14037,34414,19898,60779,83267,87499,29596,41852,15813,32419,72232,8322,39184,46525,13833,65743,94595,37363,4711,35386,96413,10627,62625,56555,12919,93218,25191,98380,51923,66181,5788,73491,1452,487,12277,45415,11884,61300,94528,9181,26616,11455,31514,63290,45035,42759,33804,85721,80979,46010,50975,72482,31231,3086,58941,46102,25773,89742,29788,96741,88523,14922,88262,76305,57676,93259,2396,69145,26074,30056,3853,75317,56639,66203,38923,48939,22813,91864,10934,6714,84099,25631,73223,95630,97552,45950,22197,42886,33764,1263,41856,82057,62349,94091,78028,62651,18911,5693,92561,97821,41994,92343,76785,22216,4203,5038,86151,23596,24338,77181,51761,97693,10955,98159,37568,58932,72128,27303,99608,31688,57557,91022,43036,93927,32869,53653,55205,33139,47271,31224,51650,36422,86857,73799,22068,43376,84760,44898,65776,42451,71480,38509,41673,44141,75918,95652,68981,83001,48815,98086,67950,27986,33175,43624,55274,71051,61124,51550,64967,31570,15748,19159,38174,51078,79811,39183,57527,96550,85168,28824,47466,56993,13151,96664,29735,70251,1079,4314,77714,11507,1440,48415,31984,99915,20282,26524,18057,4992,40521,98108,84045,91961,79256,72244,25788,5487,23595,73302,14205,8925,27625,64343,28821,37992,67156,83320,31106,10884,30735,15067,51091,15668,48777,50770,19169,76504,41165,29749,92812,8065,66782,26841,1411,95461,61134,18699,52261,60469,81373,44825,11448,73320,30151,56991,31372,6655,36472,86292,30247,30931,21029,53410,9859,37267,47514,3492,49008,94727,25234,40546,53417,36492,25723,76227,58456,15979,34876,9574,34392,3751,36933,83921,65108,63135,67572,40184,21098],l=new Array(16),h=[16,8,16,24],f=4,p=0;!function(){for(var t=0;t<16;t++){l[t]=new Array(256);for(var e=0;e<256;e++)l[t][e]=e|e<<8|e<<16|e<<24|0;for(var n=3;0<=n;n--)for(var r=0;r<255;r++){var i=255<<(n<<3),o=0|l[t][r],s=function(t,e){var n=e-t+1,r=0,i=1;do{for(r=0,i=1;i<n;i*=10)r=10*r+(f<0&&(f=4,p++),u[p]%Math.pow(10,f+1)/Math.pow(10,f--)|0)}while((i/n|0)*n<=r);return t+r%n|0}(r,255);l[t][r]=l[t][r]&~i|l[t][s]&i|0,l[t][s]=l[t][s]&~i|o&i|0}}}();(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)})(d,r.a),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(d.prototype,[{key:"reset",value:function(){o(s(d.prototype),"reset",this).call(this),this.state.hash=new Array(this.options.length/32|0);for(var t=0;t<this.state.hash.length;t++)this.state.hash[t]=0}},{key:"processBlock",value:function(t){for(var e=0;e<this.state.hash.length;e++)this.W[e]=0|this.state.hash[e];for(var n=this.state.hash.length;n<16;n++)this.W[n]=0|t[n-this.state.hash.length];for(var r=0;r<this.options.rounds<<1;r+=2)for(var i=0;i<4;i++){for(var o=0;o<16;o++){var s=0|l[r+(o/2|0)%2][255&this.W[o]];this.W[o-1>>>0&15]^=s,this.W[o+1&15]^=s}for(var a=0;a<16;a++)this.W[a]=Object(c.b)(this.W[a],h[i])}for(var u=0;u<this.state.hash.length;u++)this.state.hash[u]=this.state.hash[u]^this.W[15-u]|0}},{key:"finalize",value:function(){return 0<this.state.message.length&&this.addPaddingZero(this.blockSizeInBytes-this.state.message.length|0),this.addPaddingZero(this.blockSizeInBytes-8|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),r=d;function d(t){var e;return function(t){if(!(t instanceof d))throw new TypeError("Cannot call a class as a function")}(this),(t=t||{}).length=t.length||128,t.rounds=t.rounds||8,e=this,(t=!(t=s(d).call(this,t))||"object"!==i(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).blockSize=16-t.state.hash.length,t.blockSizeInBytes=t.blockSize*t.unitSize,t.W=new Array(16),t}e.a=r},function(t,e,n){"use strict";var r=n(5),u=n(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}for(var l=[[7,12,17,22],[5,9,14,20],[4,11,16,23],[6,10,15,21]],h=new Array(64),f=0;f<64;f++)h[f]=4294967296*Math.abs(Math.sin(f+1))|0;(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)})(p,r.a),n=[{key:"FF",value:function(t,e,n){return t&e|~t&n}},{key:"GG",value:function(t,e,n){return t&n|e&~n}},{key:"HH",value:function(t,e,n){return t^e^n}},{key:"II",value:function(t,e,n){return e^(t|~n)}},{key:"CC",value:function(t,e,n,r,i,o,s,a){return Object(u.a)(n+t(r,i,o)+s+e,a)+r|0}}],o((r=p).prototype,[{key:"reset",value:function(){s(a(p.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878]}},{key:"processBlock",value:function(t){var e=0|this.state.hash[0],n=0|this.state.hash[1],r=0|this.state.hash[2],i=0|this.state.hash[3],e=p.CC(p.FF,h[0],e,n,r,i,t[0],l[0][0]),i=p.CC(p.FF,h[1],i,e,n,r,t[1],l[0][1]),r=p.CC(p.FF,h[2],r,i,e,n,t[2],l[0][2]),n=p.CC(p.FF,h[3],n,r,i,e,t[3],l[0][3]);e=p.CC(p.FF,h[4],e,n,r,i,t[4],l[0][0]),i=p.CC(p.FF,h[5],i,e,n,r,t[5],l[0][1]),r=p.CC(p.FF,h[6],r,i,e,n,t[6],l[0][2]),n=p.CC(p.FF,h[7],n,r,i,e,t[7],l[0][3]),e=p.CC(p.FF,h[8],e,n,r,i,t[8],l[0][0]),i=p.CC(p.FF,h[9],i,e,n,r,t[9],l[0][1]),r=p.CC(p.FF,h[10],r,i,e,n,t[10],l[0][2]),n=p.CC(p.FF,h[11],n,r,i,e,t[11],l[0][3]),e=p.CC(p.FF,h[12],e,n,r,i,t[12],l[0][0]),i=p.CC(p.FF,h[13],i,e,n,r,t[13],l[0][1]),r=p.CC(p.FF,h[14],r,i,e,n,t[14],l[0][2]),n=p.CC(p.FF,h[15],n,r,i,e,t[15],l[0][3]),e=p.CC(p.GG,h[16],e,n,r,i,t[1],l[1][0]),i=p.CC(p.GG,h[17],i,e,n,r,t[6],l[1][1]),r=p.CC(p.GG,h[18],r,i,e,n,t[11],l[1][2]),n=p.CC(p.GG,h[19],n,r,i,e,t[0],l[1][3]),e=p.CC(p.GG,h[20],e,n,r,i,t[5],l[1][0]),i=p.CC(p.GG,h[21],i,e,n,r,t[10],l[1][1]),r=p.CC(p.GG,h[22],r,i,e,n,t[15],l[1][2]),n=p.CC(p.GG,h[23],n,r,i,e,t[4],l[1][3]),e=p.CC(p.GG,h[24],e,n,r,i,t[9],l[1][0]),i=p.CC(p.GG,h[25],i,e,n,r,t[14],l[1][1]),r=p.CC(p.GG,h[26],r,i,e,n,t[3],l[1][2]),n=p.CC(p.GG,h[27],n,r,i,e,t[8],l[1][3]),e=p.CC(p.GG,h[28],e,n,r,i,t[13],l[1][0]),i=p.CC(p.GG,h[29],i,e,n,r,t[2],l[1][1]),r=p.CC(p.GG,h[30],r,i,e,n,t[7],l[1][2]),n=p.CC(p.GG,h[31],n,r,i,e,t[12],l[1][3]),e=p.CC(p.HH,h[32],e,n,r,i,t[5],l[2][0]),i=p.CC(p.HH,h[33],i,e,n,r,t[8],l[2][1]),r=p.CC(p.HH,h[34],r,i,e,n,t[11],l[2][2]),n=p.CC(p.HH,h[35],n,r,i,e,t[14],l[2][3]),e=p.CC(p.HH,h[36],e,n,r,i,t[1],l[2][0]),i=p.CC(p.HH,h[37],i,e,n,r,t[4],l[2][1]),r=p.CC(p.HH,h[38],r,i,e,n,t[7],l[2][2]),n=p.CC(p.HH,h[39],n,r,i,e,t[10],l[2][3]),e=p.CC(p.HH,h[40],e,n,r,i,t[13],l[2][0]),i=p.CC(p.HH,h[41],i,e,n,r,t[0],l[2][1]),r=p.CC(p.HH,h[42],r,i,e,n,t[3],l[2][2]),n=p.CC(p.HH,h[43],n,r,i,e,t[6],l[2][3]),e=p.CC(p.HH,h[44],e,n,r,i,t[9],l[2][0]),i=p.CC(p.HH,h[45],i,e,n,r,t[12],l[2][1]),r=p.CC(p.HH,h[46],r,i,e,n,t[15],l[2][2]),n=p.CC(p.HH,h[47],n,r,i,e,t[2],l[2][3]),e=p.CC(p.II,h[48],e,n,r,i,t[0],l[3][0]),i=p.CC(p.II,h[49],i,e,n,r,t[7],l[3][1]),r=p.CC(p.II,h[50],r,i,e,n,t[14],l[3][2]),n=p.CC(p.II,h[51],n,r,i,e,t[5],l[3][3]),e=p.CC(p.II,h[52],e,n,r,i,t[12],l[3][0]),i=p.CC(p.II,h[53],i,e,n,r,t[3],l[3][1]),r=p.CC(p.II,h[54],r,i,e,n,t[10],l[3][2]),n=p.CC(p.II,h[55],n,r,i,e,t[1],l[3][3]),e=p.CC(p.II,h[56],e,n,r,i,t[8],l[3][0]),i=p.CC(p.II,h[57],i,e,n,r,t[15],l[3][1]),r=p.CC(p.II,h[58],r,i,e,n,t[6],l[3][2]),n=p.CC(p.II,h[59],n,r,i,e,t[13],l[3][3]),e=p.CC(p.II,h[60],e,n,r,i,t[4],l[3][0]),i=p.CC(p.II,h[61],i,e,n,r,t[11],l[3][1]),r=p.CC(p.II,h[62],r,i,e,n,t[2],l[3][2]),n=p.CC(p.II,h[63],n,r,i,e,t[9],l[3][3]),this.state.hash[0]=this.state.hash[0]+e|0,this.state.hash[1]=this.state.hash[1]+n|0,this.state.hash[2]=this.state.hash[2]+r|0,this.state.hash[3]=this.state.hash[3]+i|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),o(r,n),n=p;function p(){return function(t){if(!(t instanceof p))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=a(p).apply(this,arguments))||"object"!==i(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e;var t,e}e.a=n},function(t,e,n){"use strict";var r=n(3),u=n(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=[1518500249,1859775393,2400959708,3395469782],r=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(l,r.a),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(l.prototype,[{key:"reset",value:function(){o(s(l.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878,-1009589776]}},{key:"processBlock",value:function(t){for(var e=0|this.state.hash[0],n=0|this.state.hash[1],r=0|this.state.hash[2],i=0|this.state.hash[3],o=0|this.state.hash[4],s=0;s<this.options.rounds;s++){this.W[s]=s<16?0|t[s]:0|Object(u.a)(this.W[s-3]^this.W[s-8]^this.W[s-14]^this.W[s-16],1);var a=Object(u.a)(e,5)+o+this.W[s]+c[s/20>>0]|0,a=s<20?a+(n&r|~n&i)|0:!(s<40)&&s<60?a+(n&r|n&i|r&i)|0:a+(n^r^i)|0,o=i,i=r,r=0|Object(u.a)(n,30),n=e,e=a}this.state.hash[0]=this.state.hash[0]+e|0,this.state.hash[1]=this.state.hash[1]+n|0,this.state.hash[2]=this.state.hash[2]+r|0,this.state.hash[3]=this.state.hash[3]+i|0,this.state.hash[4]=this.state.hash[4]+o|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),l);function l(t){var e;return function(t){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}(this),e=this,(t=!(t=s(l).call(this,t))||"object"!==i(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).options.rounds=t.options.rounds||80,t.W=new Array(80),t}e.a=r},function(t,e,n){"use strict";var c=n(0),n=n(3);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var a=new Array(256),u=[104,208,235,43,72,157,106,228,227,163,86,129,125,241,133,158,44,142,120,202,23,169,97,213,93,11,140,60,119,81,34,66,63,84,65,128,204,134,179,24,46,87,6,98,244,54,209,107,27,101,117,16,218,73,38,249,203,102,231,186,174,80,82,171,5,240,13,115,59,4,32,254,221,245,180,95,10,181,192,160,113,165,45,96,114,147,57,8,131,33,92,135,177,224,0,195,18,145,138,2,28,230,69,194,196,253,191,68,161,76,51,197,132,35,124,176,37,21,53,105,255,148,77,112,162,175,205,214,108,183,248,9,243,103,164,234,236,182,212,210,20,30,225,36,56,198,219,75,122,58,222,94,223,149,252,170,215,206,7,15,61,88,154,152,156,242,167,17,126,139,67,3,226,220,229,178,78,199,109,233,39,64,216,55,146,143,1,29,83,62,89,193,79,50,22,250,116,251,99,159,52,26,42,90,141,201,207,246,144,40,136,155,49,14,189,74,232,150,166,12,200,121,188,190,239,110,70,151,91,237,25,217,172,153,168,41,100,31,173,85,19,187,247,111,185,71,47,238,184,123,137,48,211,127,118,130],l=[1,11,9,12,13,6,15,3,14,8,7,4,10,2,5,0],h=[7,12,11,13,14,4,9,15,6,3,8,10,2,5,1,0],f=new Array(16),p=[1,1,4,1,8,5,2,9],d=[1,1,3,1,5,8,9,5],g=new Array(512),m=new Array(22),v=new Array(512),y=new Array(22),b=new Array(512),w=new Array(22);function _(t,e){for(var n=new Array(512),r=new Array(22),i=0;i<8;i++)n[i]=[];for(var o=0;o<256;o++){var s=new Array(10);s[1]=t[o],s[2]=s[1]<<1,256<=s[2]&&(s[2]^=285),s[3]=s[2]^s[1],s[4]=s[2]<<1,256<=s[4]&&(s[4]^=285),s[5]=s[4]^s[1],s[8]=s[4]<<1,256<=s[8]&&(s[8]^=285),s[9]=s[8]^s[1],n[0][2*o]=s[e[0]]<<24|s[e[1]]<<16|s[e[2]]<<8|s[e[3]],n[0][2*o+1]=s[e[4]]<<24|s[e[5]]<<16|s[e[6]]<<8|s[e[7]];for(var a=1;a<8;a++)n[a][2*o]=Object(c.d)(n[0][2*o+1],n[0][2*o],a<<3),n[a][2*o+1]=Object(c.c)(n[0][2*o+1],n[0][2*o],a<<3)}r[0]=0,r[1]=0;for(var u=1;u<=10;u++)r[2*u]=4278190080&n[0][16*u-16]^16711680&n[1][16*u-14]^65280&n[2][16*u-12]^255&n[3][16*u-10],r[2*u+1]=4278190080&n[4][16*u-7]^16711680&n[5][16*u-5]^65280&n[6][16*u-3]^255&n[7][16*u-1];return[n,r]}!function(){!function(){for(var t=0;t<16;t++)f[l[t]]=0|t;for(var e=0;e<256;e++){var n=l[e>>4],r=f[15&e],i=h[n^r];a[e]=l[n^i]<<4|f[r^i]}}();var t=_(u,d);v=t[0],y=t[1],t=_(a,d),b=t[0],w=t[1],t=_(a,p),g=t[0],m=t[1]}();(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)})(x,n.a),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(x.prototype,[{key:"reset",value:function(){i(o(x.prototype),"reset",this).call(this),this.state.hash=new Array(16);for(var t=0;t<16;t++)this.state.hash[t]=0}},{key:"processBlock",value:function(t){for(var e=new Array(16),n=[],r=0;r<16;r++)n[r]=t[r]^(e[r]=this.state.hash[r])|0;for(var i=[],o=1;o<=this.options.rounds;o++){for(var s=0;s<8;s++){i[2*s]=0;for(var a=i[2*s+1]=0,u=56,c=0;a<8;a++,c=(u-=8)<32?1:0)i[2*s]^=this.C[a][2*(e[2*(s-a&7)+c]>>>u%32&255)],i[2*s+1]^=this.C[a][2*(e[2*(s-a&7)+c]>>>u%32&255)+1]}for(var l=0;l<16;l++)e[l]=i[l];e[0]^=this.RC[2*o],e[1]^=this.RC[2*o+1];for(var h=0;h<8;h++){i[2*h]=e[2*h],i[2*h+1]=e[2*h+1];for(var f=0,p=56,d=0;f<8;f++,d=(p-=8)<32?1:0)i[2*h]^=this.C[f][2*(n[2*(h-f&7)+d]>>>p%32&255)],i[2*h+1]^=this.C[f][2*(n[2*(h-f&7)+d]>>>p%32&255)+1]}for(var g=0;g<16;g++)n[g]=i[g]}for(var m=0;m<16;m++)this.state.hash[m]^=n[m]^t[m]}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<32?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),n=x;function x(t){var e,n;switch(function(t){if(!(t instanceof x))throw new TypeError("Cannot call a class as a function")}(this),(t=t||{}).type=t.type||"",t.rounds=t.rounds||10,n=this,(e=!(t=o(x).call(this,t))||"object"!==r(t)&&"function"!=typeof t?function(){if(void 0!==n)return n;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).options.type){case"0":case 0:e.C=v,e.RC=y;break;case"t":e.C=b,e.RC=w;break;default:e.C=g,e.RC=m}return e}e.a=n},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)})(s,n(4).a),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(s.prototype,[{key:"process",value:function(){for(;this.state.message.length>=this.blockSizeInBytes;){this.blockUnits=new Array(this.blockSizeInBytes);for(var t=0;t<this.blockSizeInBytes;t++)this.blockUnits[t]=0|this.state.message.charCodeAt(t);this.state.message=this.state.message.substr(this.blockSizeInBytes),this.processBlock(this.blockUnits)}}},{key:"processBlock",value:function(t){}},{key:"getStateHash",value:function(t){t=t||this.state.hash.length;for(var e="",n=0;n<t;n++)e+=String.fromCharCode(255&this.state.hash[n]);return e}}]),n=s;function s(t){var e;return function(t){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}(this),e=this,(t=!(t=i(s).call(this,t))||"object"!==r(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).unitSize=1,t.blockSizeInBytes=t.blockSize*t.unitSize,t.blockUnits=[],t}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=[41,46,67,201,162,216,124,1,61,54,84,161,236,240,6,19,98,167,5,243,192,199,115,140,152,147,43,217,188,76,130,202,30,155,87,60,253,212,224,22,103,66,111,24,138,23,229,18,190,78,196,214,218,158,222,73,160,251,245,142,187,47,238,122,169,104,121,145,21,178,7,63,148,194,16,137,11,34,95,33,128,127,93,154,90,144,50,39,53,62,204,231,191,247,151,3,255,25,48,179,72,165,181,209,215,94,146,42,172,86,170,198,79,184,56,210,150,164,125,182,118,252,107,226,156,116,4,241,69,157,112,89,100,113,135,32,134,91,207,101,230,45,168,2,27,96,37,173,174,176,185,246,28,70,97,105,52,64,126,15,85,71,163,35,221,81,175,58,195,92,249,206,186,197,234,38,44,83,13,110,133,40,132,9,211,223,205,244,65,129,77,82,106,220,55,200,108,193,171,250,36,225,123,8,12,189,177,74,120,136,149,139,227,99,232,109,233,203,213,254,59,0,29,57,242,239,183,14,102,88,208,228,166,119,114,248,235,117,75,10,49,68,80,180,143,237,31,26,219,153,141,51,159,17,131,20],n=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),l(t,e)}(f,n),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(f.prototype,[{key:"reset",value:function(){u(c(f.prototype),"reset",this).call(this),this.state.hash=new Array(48),this.state.checksum=new Array(16)}},{key:"processBlock",value:function(t){for(var e=0;e<16;e++)this.state.hash[16+e]=0|t[e],this.state.hash[32+e]=t[e]^this.state.hash[e];for(var n=0,r=0;r<this.options.rounds;r++){for(var i=0;i<48;i++)n=this.state.hash[i]^=h[n];n=n+r&255}n=255&this.state.checksum[15];for(var o=0;o<16;o++)n=this.state.checksum[o]^=h[t[o]^n]}},{key:"finalize",value:function(){this.addPaddingPKCS7(16-(15&this.state.message.length)|0),this.process();for(var t=0;t<16;t++)this.state.message+=String.fromCharCode(this.state.checksum[t]);return this.process(),this.getStateHash(16)}}]),f);function f(t){var e;return function(t){if(!(t instanceof f))throw new TypeError("Cannot call a class as a function")}(this),e=this,(t=!(t=c(f).call(this,t))||"object"!==a(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).options.rounds=t.options.rounds||18,t}e.a=n},function(t,e,n){"use strict";var r=n(5),c=n(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=[0,1518500249,1859775393,2400959708],h=[5,11,7,15,6,13,8,14,7,12,9,11,8,15,6,12,9,14,5,13],f=[10,17,25,30],p=[18,0,1,2,3,19,4,5,6,7,16,8,9,10,11,17,12,13,14,15,22,3,6,9,12,23,15,2,5,8,20,11,14,1,4,21,7,10,13,0,26,12,5,14,7,27,0,9,2,11,24,4,13,6,15,25,8,1,10,3,30,7,2,13,8,31,3,14,9,4,28,15,10,5,0,29,11,6,1,12],r=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(u,r.a),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(u.prototype,[{key:"reset",value:function(){o(s(u.prototype),"reset",this).call(this),this.state.hash=[1732584193,4023233417,2562383102,271733878,3285377520]}},{key:"processBlock",value:function(t){for(var e=0|this.state.hash[0],n=0|this.state.hash[1],r=0|this.state.hash[2],i=0|this.state.hash[3],o=0|this.state.hash[4],s=0;s<16;s++)this.W[s]=0|t[s];this.W[16]=this.W[0]^this.W[1]^this.W[2]^this.W[3]|0,this.W[17]=this.W[4]^this.W[5]^this.W[6]^this.W[7]|0,this.W[18]=this.W[8]^this.W[9]^this.W[10]^this.W[11]|0,this.W[19]=this.W[12]^this.W[13]^this.W[14]^this.W[15]|0,this.W[20]=this.W[3]^this.W[6]^this.W[9]^this.W[12]|0,this.W[21]=this.W[2]^this.W[5]^this.W[8]^this.W[15]|0,this.W[22]=this.W[1]^this.W[4]^this.W[11]^this.W[14]|0,this.W[23]=this.W[0]^this.W[7]^this.W[10]^this.W[13]|0,this.W[24]=this.W[5]^this.W[7]^this.W[12]^this.W[14]|0,this.W[25]=this.W[0]^this.W[2]^this.W[9]^this.W[11]|0,this.W[26]=this.W[4]^this.W[6]^this.W[13]^this.W[15]|0,this.W[27]=this.W[1]^this.W[3]^this.W[8]^this.W[10]|0,this.W[28]=this.W[2]^this.W[7]^this.W[8]^this.W[13]|0,this.W[29]=this.W[3]^this.W[4]^this.W[9]^this.W[14]|0,this.W[30]=this.W[0]^this.W[5]^this.W[10]^this.W[15]|0,this.W[31]=this.W[1]^this.W[6]^this.W[11]^this.W[12]|0;for(var a=0;a<this.options.rounds;a++)var u=Object(c.a)(e,h[a%20])+o+this.W[p[a]]+l[a/20>>0]|0,u=a<20?u+(n&r|~n&i)|0:!(a<40)&&a<60?u+(r^(n|~i))|0:u+(n^r^i)|0,o=i,i=r,r=0|Object(c.a)(n,f[a/20>>0]),n=e,e=u;this.state.hash[0]=this.state.hash[0]+e|0,this.state.hash[1]=this.state.hash[1]+n|0,this.state.hash[2]=this.state.hash[2]+r|0,this.state.hash[3]=this.state.hash[3]+i|0,this.state.hash[4]=this.state.hash[4]+o|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),u);function u(t){var e;return function(t){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}(this),e=this,(t=!(t=s(u).call(this,t))||"object"!==i(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).options.rounds=t.options.rounds||80,t.W=new Array(32),t}e.a=r},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function r(t){for(var e="",n=t.length-t.length%3|0,r=0,i=0;i<n;i+=3)r=t.charCodeAt(i)<<16|t.charCodeAt(i+1)<<8|t.charCodeAt(i+2),e+=o.charAt(r>>18)+o.charAt(r>>12&63)+o.charAt(r>>6&63)+o.charAt(63&r);return t.length-n==2?(r=t.charCodeAt(n)<<16|t.charCodeAt(1+n)<<8,e+=o.charAt(r>>18)+o.charAt(r>>12&63)+o.charAt(r>>6&63)+"="):t.length-n==1&&(r=t.charCodeAt(n)<<16,e+=o.charAt(r>>18)+o.charAt(r>>12&63)+"=="),e}},function(t,e,n){"use strict";var r=n(5),u=n(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=[[3,7,11,19],[3,5,9,13],[3,9,11,15]],h=1518500249,f=1859775393,n=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,r.a),n=[{key:"FF",value:function(t,e,n){return t&e|~t&n}},{key:"GG",value:function(t,e,n){return t&e|t&n|e&n}},{key:"HH",value:function(t,e,n){return t^e^n}},{key:"CC",value:function(t,e,n,r,i,o,s,a){return 0|Object(u.a)(n+t(r,i,o)+s+e,a)}}],o((r=p).prototype,[{key:"reset",value:function(){s(a(p.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878]}},{key:"processBlock",value:function(t){var e=0|this.state.hash[0],n=0|this.state.hash[1],r=0|this.state.hash[2],i=0|this.state.hash[3],e=p.CC(p.FF,0,e,n,r,i,t[0],l[0][0]),i=p.CC(p.FF,0,i,e,n,r,t[1],l[0][1]),r=p.CC(p.FF,0,r,i,e,n,t[2],l[0][2]),n=p.CC(p.FF,0,n,r,i,e,t[3],l[0][3]);e=p.CC(p.FF,0,e,n,r,i,t[4],l[0][0]),i=p.CC(p.FF,0,i,e,n,r,t[5],l[0][1]),r=p.CC(p.FF,0,r,i,e,n,t[6],l[0][2]),n=p.CC(p.FF,0,n,r,i,e,t[7],l[0][3]),e=p.CC(p.FF,0,e,n,r,i,t[8],l[0][0]),i=p.CC(p.FF,0,i,e,n,r,t[9],l[0][1]),r=p.CC(p.FF,0,r,i,e,n,t[10],l[0][2]),n=p.CC(p.FF,0,n,r,i,e,t[11],l[0][3]),e=p.CC(p.FF,0,e,n,r,i,t[12],l[0][0]),i=p.CC(p.FF,0,i,e,n,r,t[13],l[0][1]),r=p.CC(p.FF,0,r,i,e,n,t[14],l[0][2]),n=p.CC(p.FF,0,n,r,i,e,t[15],l[0][3]),e=p.CC(p.GG,h,e,n,r,i,t[0],l[1][0]),i=p.CC(p.GG,h,i,e,n,r,t[4],l[1][1]),r=p.CC(p.GG,h,r,i,e,n,t[8],l[1][2]),n=p.CC(p.GG,h,n,r,i,e,t[12],l[1][3]),e=p.CC(p.GG,h,e,n,r,i,t[1],l[1][0]),i=p.CC(p.GG,h,i,e,n,r,t[5],l[1][1]),r=p.CC(p.GG,h,r,i,e,n,t[9],l[1][2]),n=p.CC(p.GG,h,n,r,i,e,t[13],l[1][3]),e=p.CC(p.GG,h,e,n,r,i,t[2],l[1][0]),i=p.CC(p.GG,h,i,e,n,r,t[6],l[1][1]),r=p.CC(p.GG,h,r,i,e,n,t[10],l[1][2]),n=p.CC(p.GG,h,n,r,i,e,t[14],l[1][3]),e=p.CC(p.GG,h,e,n,r,i,t[3],l[1][0]),i=p.CC(p.GG,h,i,e,n,r,t[7],l[1][1]),r=p.CC(p.GG,h,r,i,e,n,t[11],l[1][2]),n=p.CC(p.GG,h,n,r,i,e,t[15],l[1][3]),e=p.CC(p.HH,f,e,n,r,i,t[0],l[2][0]),i=p.CC(p.HH,f,i,e,n,r,t[8],l[2][1]),r=p.CC(p.HH,f,r,i,e,n,t[4],l[2][2]),n=p.CC(p.HH,f,n,r,i,e,t[12],l[2][3]),e=p.CC(p.HH,f,e,n,r,i,t[2],l[2][0]),i=p.CC(p.HH,f,i,e,n,r,t[10],l[2][1]),r=p.CC(p.HH,f,r,i,e,n,t[6],l[2][2]),n=p.CC(p.HH,f,n,r,i,e,t[14],l[2][3]),e=p.CC(p.HH,f,e,n,r,i,t[1],l[2][0]),i=p.CC(p.HH,f,i,e,n,r,t[9],l[2][1]),r=p.CC(p.HH,f,r,i,e,n,t[5],l[2][2]),n=p.CC(p.HH,f,n,r,i,e,t[13],l[2][3]),e=p.CC(p.HH,f,e,n,r,i,t[3],l[2][0]),i=p.CC(p.HH,f,i,e,n,r,t[11],l[2][1]),r=p.CC(p.HH,f,r,i,e,n,t[7],l[2][2]),n=p.CC(p.HH,f,n,r,i,e,t[15],l[2][3]),this.state.hash=[this.state.hash[0]+e|0,this.state.hash[1]+n|0,this.state.hash[2]+r|0,this.state.hash[3]+i|0]}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),o(r,n),p);function p(){return function(t){if(!(t instanceof p))throw new TypeError("Cannot call a class as a function")}(this),t=this,!(e=a(p).apply(this,arguments))||"object"!==i(e)&&"function"!=typeof e?function(){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():e;var t,e}e.a=n},function(t,e,n){"use strict";var r=n(3),u=n(0);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(t){e=Object.getOwnPropertyDescriptor(t,e);return e.get?e.get.call(n):e.value}})(t,e,n||t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=[1518500249,1859775393,2400959708,3395469782],r=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(l,r.a),function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(l.prototype,[{key:"reset",value:function(){o(s(l.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878,-1009589776]}},{key:"processBlock",value:function(t){for(var e=0|this.state.hash[0],n=0|this.state.hash[1],r=0|this.state.hash[2],i=0|this.state.hash[3],o=0|this.state.hash[4],s=0;s<this.options.rounds;s++){this.W[s]=s<16?0|t[s]:this.W[s-3]^this.W[s-8]^this.W[s-14]^this.W[s-16]|0;var a=Object(u.a)(e,5)+o+this.W[s]+c[s/20>>0]|0,a=s<20?a+(n&r|~n&i)|0:!(s<40)&&s<60?a+(n&r|n&i|r&i)|0:a+(n^r^i)|0,o=i,i=r,r=0|Object(u.a)(n,30),n=e,e=a}this.state.hash[0]=this.state.hash[0]+e|0,this.state.hash[1]=this.state.hash[1]+n|0,this.state.hash[2]=this.state.hash[2]+r|0,this.state.hash[3]=this.state.hash[3]+i|0,this.state.hash[4]=this.state.hash[4]+o|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),l);function l(t){var e;return function(t){if(!(t instanceof l))throw new TypeError("Cannot call a class as a function")}(this),e=this,(t=!(t=s(l).call(this,t))||"object"!==i(t)&&"function"!=typeof t?function(){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():t).options.rounds=t.options.rounds||80,t.W=new Array(80),t}e.a=r},function(t,e,n){"use strict";function r(t){for(var e="",n=new Uint8Array(t),r=0;r<n.length;r++)e+=String.fromCharCode(n[r]);return e}n.d(e,"a",function(){return r})},,function(t,e,n){"use strict";var r=(function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(i.prototype,[{key:"update",value:function(t){this.hasher.update(t)}},{key:"finalize",value:function(){var t=this.hasher.finalize();return this.hasher.reset(),this.hasher.update(this.oPad),this.hasher.update(t),this.hasher.finalize()}}]),i);function i(t,e){!function(t){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this),t.length>e.blockSizeInBytes&&(e.update(t),t=e.finalize(),e.reset());for(var n=t.length;n<e.blockSizeInBytes;n++)t+="\0";this.oPad="";for(var r=0;r<t.length;r++)e.update(String.fromCharCode(54^t.charCodeAt(r))),this.oPad+=String.fromCharCode(92^t.charCodeAt(r));this.hasher=e}e.a=r},,,,,,,,,function(t,e,n){"use strict";n.r(e);var r=n(14),i=n(13),o=n(16),s=n(10),a=n(8),u=n(17),c=n(11),l=n(7),h=n(6),f=n(9),p=n(12),d=n(1),g=n(18),m=n(2),v=n(15),y=n(20);(function(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}})(b.prototype,[{key:"getHasher",value:function(t,e){switch(e=e||{},t){case"has160":return new r.a(e);case"md2":return new i.a(e);case"md4":return new o.a(e);case"md5":return new s.a(e);case"ripemd128":return e=Object.assign({},{length:128},e),new a.a(e);case"ripemd":case"ripemd160":return e=Object.assign({},{length:160},e),new a.a(e);case"ripemd256":return e=Object.assign({},{length:256},e),new a.a(e);case"ripemd320":return e=Object.assign({},{length:320},e),new a.a(e);case"sha0":return new u.a(e);case"sha1":return new c.a(e);case"sha224":return e=Object.assign({},{length:224},e),new l.a(e);case"sha256":return e=Object.assign({},{length:256},e),new l.a(e);case"sha384":return e=Object.assign({},{length:384},e),new h.a(e);case"sha512":return e=Object.assign({},{length:512},e),new h.a(e);case"sha512/224":return e=Object.assign({},{length:224},e),new h.a(e);case"sha512/256":return e=Object.assign({},{length:256},e),new h.a(e);case"snefru":case"snefru128":case"snefru128/8":return e=Object.assign({},{length:128},e),new f.a(e);case"snefru256":case"snefru256/8":return e=Object.assign({},{length:256},e),new f.a(e);case"snefru128/2":return e=Object.assign({},{length:128,rounds:2},e),new f.a(e);case"snefru256/4":return e=Object.assign({},{length:256,rounds:4},e),new f.a(e);case"whirlpool":return new p.a(e);case"whirlpool-0":return e=Object.assign({},{type:"0"},e),new p.a(e);case"whirlpool-t":return e=Object.assign({},{type:"t"},e),new p.a(e)}}},{key:"hash",value:function(t,e,n){n=n||{};n=this.getHasher(t,n);return n.update(Object(d.a)(e)),Object(m.a)(n.finalize())}},{key:"getHmac",value:function(t,e){return new y.a(t,e)}},{key:"hmac",value:function(t,e,n){n=this.getHmac(Object(d.a)(t),n);return n.update(Object(d.a)(e)),Object(m.a)(n.finalize())}}]),n=b;function b(){!function(t){if(!(t instanceof b))throw new TypeError("Cannot call a class as a function")}(this),this.encoder={},this.encoder.fromUtf=d.a,this.encoder.fromArrayBuffer=g.a,this.encoder.toHex=m.a,this.encoder.toBase64=v.a}n=new n,e.default=n}]).default;!function(s){"use strict";var n={page:1,pageSize:200,total:0,showTotal:!1,totalTxt:"",noData:!1,showSkip:!1,showPN:!0,prevPage:"",nextPage:"",fastForward:0,selectOption:[],backFun:function(t){}};function e(t,e){this.element=s(t),this.settings=s.extend({},n,e),this.pageNum=1,this.pageList=[],this.pageTatol=0,this.init()}s.extend(e.prototype,{init:function(){this.element.empty(),this.viewHtml(),this.clickBtn()},creatHtml:function(t){t==this.settings.page?this.pageList.push('<button class="active" data-page='+t+">"+t+"</button>"):this.pageList.push("<button data-page="+t+">"+t+"</button>")},viewHtml:function(){var t=this.settings,e=0,n=[];if(0<t.total)e=Math.ceil(t.total/t.pageSize);else{if(!t.noData)return;e=1,t.page=1,t.total=0}if(this.pageTatol=e,this.pageNum=t.page,t.showTotal&&n.push('<div class="spage-total">'+t.totalTxt+"</div>"),n.push('<div class="spage-number">'),this.pageList=[],t.showPN&&(1==t.page?this.pageList.push('<button class="button-disabled" data-page="prev"><i class="prevBtn"></i></button>'):this.pageList.push('<button data-page="prev"><i class="prevBtn"></i></button>')),e<=6)for(var r=1;r<e+1;r++)this.creatHtml(r);else if(t.page<3){for(r=1;r<=3;r++)this.creatHtml(r);this.pageList.push('<button data-page="after" class="spage-after">...</button><button data-page='+e+">"+e+"</button>")}else if(t.page>e-3){this.pageList.push('<button data-page="1">1</button><button data-page="before" class="spage-before">...</button>');for(r=e-3;r<=e;r++)this.creatHtml(r)}else{this.pageList.push('<button data-page="1">1</button>'),3<t.page&&this.pageList.push('<button data-page="before" class="spage-before">...</button>');for(r=t.page-1;r<=Number(t.page)+1;r++)this.creatHtml(r);t.page<=e-3&&this.pageList.push('<button data-page="after" class="spage-after">...</button>'),this.pageList.push("<button data-page="+e+">"+e+"</button>")}if(t.showPN&&(t.page==e?this.pageList.push('<button class="button-disabled" data-page="next"><i class="nextBtn"></i></button>'):this.pageList.push('<button data-page="next"><i class="nextBtn"></i></button>')),n.push(this.pageList.join("")),n.push("</div>"),0<t.selectOption.length){for(var i='<select class="selectNum" id="selectNum">',o=0;o<=t.selectOption.length-1;o++)i+="<option value="+t.selectOption[o]+" ",t.pageSize===t.selectOption[o]?i+="selected>"+t.selectOption[o]+"/</option>":i+=">"+t.selectOption[o]+"/</option>";i+="</select>",n.push(i)}t.showSkip&&n.push('<div class="spage-skip">&nbsp;<input type="text" class="luckysheet-mousedown-cancel" value="'+t.page+'"/>&nbsp;&nbsp;&nbsp;</div>'),this.element.html(n.join(""))},clickBtn:function(){var n=this,r=this.settings,i=this.element,o=this.pageTatol;this.element.on("change","select",function(t){var e=parseInt(document.getElementById("selectNum").value);r.pageSize=e,r.page=1,n.element.empty(),n.viewHtml(),r.backFun(r)}),this.element.off("click","button"),this.element.on("click","button",function(){var t=s(this).data("page");switch(t){case"prev":r.page=1<=r.page-1?r.page-1:1,t=r.page;break;case"next":r.page=Number(r.page)+1<=o?Number(r.page)+1:o,t=r.page;break;case"before":r.page=1<=r.page-r.fastForward?r.page-r.fastForward:1,t=r.page;break;case"after":r.page=Number(r.page)+Number(r.fastForward)<=o?Number(r.page)+Number(r.fastForward):o,t=r.page;break;case"go":var e=parseInt(i.find("input").val());if(!(/^[0-9]*$/.test(e)&&1<=e&&e<=o))return;t=r.page=e;break;default:r.page=t}t!=n.pageNum&&(n.pageNum=r.page,n.viewHtml(),r.backFun(r))}),this.element.off("keyup","input"),this.element.on("keyup","input",function(t){13==t.keyCode&&(t=parseInt(i.find("input").val()),/^[0-9]*$/.test(t)&&1<=t&&t<=o&&t!=n.pageNum&&(r.page=t,n.pageNum=t,n.viewHtml(),r.backFun(r)))}),0<r.fastForward&&(i.find(".spage-after").hover(function(){s(this).html("&raquo;")},function(){s(this).html("...")}),i.find(".spage-before").hover(function(){s(this).html("&laquo;")},function(){s(this).html("...")}))}}),s.fn.sPage=function(t){return this.each(function(){new e(this,t)})}}(jQuery,(window,document));/*! @preserve
 * luckysheet
 * version: 2.1.13
 * https://github.com/mengshukeji/Luckysheet
 */
var luckysheet=(()=>{var dw=Object.create,Gf=Object.defineProperty;var mw=Object.getOwnPropertyDescriptor;var gw=Object.getOwnPropertyNames;var pw=Object.getPrototypeOf,vw=Object.prototype.hasOwnProperty;var yw=e=>Gf(e,"__esModule",{value:!0});var Va=e=>{if(typeof require!="undefined")return require(e);throw new Error('Dynamic require of "'+e+'" is not supported')};var Nt=(e,n)=>()=>(e&&(n=e(e=0)),n),Fn=(e,n)=>()=>(n||e((n={exports:{}}).exports,n),n.exports),kw=(e,n)=>{for(var t in n)Gf(e,t,{get:n[t],enumerable:!0})},bw=(e,n,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let l of gw(n))!vw.call(e,l)&&l!=="default"&&Gf(e,l,{get:()=>n[l],enumerable:!(t=mw(n,l))||t.enumerable});return e},qe=e=>bw(yw(Gf(e!=null?dw(pw(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var l0=Fn((t0,Yf)=>{var import_plugin=qe(Ye());(function(e,n){typeof Yf=="object"&&typeof Yf.exports=="object"?Yf.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)})(typeof window!="undefined"?window:t0,function(e,n){var t=[],l=e.document,o=t.slice,a=t.concat,s=t.push,u=t.indexOf,f={},m=f.toString,d=f.hasOwnProperty,p={},b="2.2.4",g=function(M,j){return new g.fn.init(M,j)},v=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,x=/^-ms-/,_=/-([\da-z])/gi,S=function(M,j){return j.toUpperCase()};g.fn=g.prototype={jquery:b,constructor:g,selector:"",length:0,toArray:function(){return o.call(this)},get:function(M){return M!=null?M<0?this[M+this.length]:this[M]:o.call(this)},pushStack:function(M){var j=g.merge(this.constructor(),M);return j.prevObject=this,j.context=this.context,j},each:function(M){return g.each(this,M)},map:function(M){return this.pushStack(g.map(this,function(j,V){return M.call(j,V,j)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(M){var j=this.length,V=+M+(M<0?j:0);return this.pushStack(V>=0&&V<j?[this[V]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:t.sort,splice:t.splice},g.extend=g.fn.extend=function(){var M,j,V,U,le,se,ee=arguments[0]||{},de=1,J=arguments.length,He=!1;for(typeof ee=="boolean"&&(He=ee,ee=arguments[de]||{},de++),typeof ee!="object"&&!g.isFunction(ee)&&(ee={}),de===J&&(ee=this,de--);de<J;de++)if((M=arguments[de])!=null)for(j in M)V=ee[j],U=M[j],ee!==U&&(He&&U&&(g.isPlainObject(U)||(le=g.isArray(U)))?(le?(le=!1,se=V&&g.isArray(V)?V:[]):se=V&&g.isPlainObject(V)?V:{},ee[j]=g.extend(He,se,U)):U!==void 0&&(ee[j]=U));return ee},g.extend({expando:"jQuery"+(b+Math.random()).replace(/\D/g,""),isReady:!0,error:function(M){throw new Error(M)},noop:function(){},isFunction:function(M){return g.type(M)==="function"},isArray:Array.isArray,isWindow:function(M){return M!=null&&M===M.window},isNumeric:function(M){var j=M&&M.toString();return!g.isArray(M)&&j-parseFloat(j)+1>=0},isPlainObject:function(M){var j;if(g.type(M)!=="object"||M.nodeType||g.isWindow(M)||M.constructor&&!d.call(M,"constructor")&&!d.call(M.constructor.prototype||{},"isPrototypeOf"))return!1;for(j in M);return j===void 0||d.call(M,j)},isEmptyObject:function(M){var j;for(j in M)return!1;return!0},type:function(M){return M==null?M+"":typeof M=="object"||typeof M=="function"?f[m.call(M)]||"object":typeof M},globalEval:function(M){var j,V=eval;M=g.trim(M),M&&(M.indexOf("use strict")===1?(j=l.createElement("script"),j.text=M,l.head.appendChild(j).parentNode.removeChild(j)):V(M))},camelCase:function(M){return M.replace(x,"ms-").replace(_,S)},nodeName:function(M,j){return M.nodeName&&M.nodeName.toLowerCase()===j.toLowerCase()},each:function(M,j){var V,U=0;if(I(M))for(V=M.length;U<V&&j.call(M[U],U,M[U])!==!1;U++);else for(U in M)if(j.call(M[U],U,M[U])===!1)break;return M},trim:function(M){return M==null?"":(M+"").replace(v,"")},makeArray:function(M,j){var V=j||[];return M!=null&&(I(Object(M))?g.merge(V,typeof M=="string"?[M]:M):s.call(V,M)),V},inArray:function(M,j,V){return j==null?-1:u.call(j,M,V)},merge:function(M,j){for(var V=+j.length,U=0,le=M.length;U<V;U++)M[le++]=j[U];return M.length=le,M},grep:function(M,j,V){for(var U,le=[],se=0,ee=M.length,de=!V;se<ee;se++)U=!j(M[se],se),U!==de&&le.push(M[se]);return le},map:function(M,j,V){var U,le,se=0,ee=[];if(I(M))for(U=M.length;se<U;se++)le=j(M[se],se,V),le!=null&&ee.push(le);else for(se in M)le=j(M[se],se,V),le!=null&&ee.push(le);return a.apply([],ee)},guid:1,proxy:function(M,j){var V,U,le;if(typeof j=="string"&&(V=M[j],j=M,M=V),!!g.isFunction(M))return U=o.call(arguments,2),le=function(){return M.apply(j||this,U.concat(o.call(arguments)))},le.guid=M.guid=M.guid||g.guid++,le},now:Date.now,support:p}),typeof Symbol=="function"&&(g.fn[Symbol.iterator]=t[Symbol.iterator]),g.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(M,j){f["[object "+j+"]"]=j.toLowerCase()});function I(M){var j=!!M&&"length"in M&&M.length,V=g.type(M);return V==="function"||g.isWindow(M)?!1:V==="array"||j===0||typeof j=="number"&&j>0&&j-1 in M}var P=function(M){var j,V,U,le,se,ee,de,J,He,Ae,lt,vt,bt,dl,Jt,Cl,Rl,Pr,fl,Wt="sizzle"+1*new Date,ar=M.document,Fl=0,Ir=0,oi=Ho(),Un=Ho(),yr=Ho(),Yr=function(Ce,Ve){return Ce===Ve&&(lt=!0),0},wr=1<<31,Xr={}.hasOwnProperty,rn=[],pr=rn.pop,$r=rn.push,xr=rn.push,Sn=rn.slice,Tl=function(Ce,Ve){for(var Ge=0,dt=Ce.length;Ge<dt;Ge++)if(Ce[Ge]===Ve)return Ge;return-1},vr="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Gl="[\\x20\\t\\r\\n\\f]",mi="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",za="\\["+Gl+"*("+mi+")(?:"+Gl+"*([*^$|!~]?=)"+Gl+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+mi+"))|)"+Gl+"*\\]",Oi=":("+mi+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+za+")*)|.*)\\)|)",yc=new RegExp(Gl+"+","g"),In=new RegExp("^"+Gl+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Gl+"+$","g"),Hs=new RegExp("^"+Gl+"*,"+Gl+"*"),bu=new RegExp("^"+Gl+"*([>+~]|"+Gl+")"+Gl+"*"),kc=new RegExp("="+Gl+`*([^\\]'"]*?)`+Gl+"*\\]","g"),sa=new RegExp(Oi),ca=new RegExp("^"+mi+"$"),Oa={ID:new RegExp("^#("+mi+")"),CLASS:new RegExp("^\\.("+mi+")"),TAG:new RegExp("^("+mi+"|[*])"),ATTR:new RegExp("^"+za),PSEUDO:new RegExp("^"+Oi),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Gl+"*(even|odd|(([+-]|)(\\d*)n|)"+Gl+"*(?:([+-]|)"+Gl+"*(\\d+)|))"+Gl+"*\\)|)","i"),bool:new RegExp("^(?:"+vr+")$","i"),needsContext:new RegExp("^"+Gl+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Gl+"*((?:-\\d)?\\d*)"+Gl+"*\\)|)(?=[^-]|$)","i")},oo=/^(?:input|select|textarea|button)$/i,js=/^h\d$/i,bo=/^[^{]+\{\s*\[native \w/,bc=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,gi=/[+~]/,Lr=/'|\\/g,pi=new RegExp("\\\\([\\da-f]{1,6}"+Gl+"?|("+Gl+")|.)","ig"),gn=function(Ce,Ve,Ge){var dt="0x"+Ve-65536;return dt!==dt||Ge?Ve:dt<0?String.fromCharCode(dt+65536):String.fromCharCode(dt>>10|55296,dt&1023|56320)},xi=function(){vt()};try{xr.apply(rn=Sn.call(ar.childNodes),ar.childNodes),rn[ar.childNodes.length].nodeType}catch(Ce){xr={apply:rn.length?function(Ve,Ge){$r.apply(Ve,Sn.call(Ge))}:function(Ve,Ge){for(var dt=Ve.length,st=0;Ve[dt++]=Ge[st++];);Ve.length=dt-1}}}function Tr(Ce,Ve,Ge,dt){var st,$t,mt,Ot,rl,vl,Ut,ml,Il=Ve&&Ve.ownerDocument,ql=Ve?Ve.nodeType:9;if(Ge=Ge||[],typeof Ce!="string"||!Ce||ql!==1&&ql!==9&&ql!==11)return Ge;if(!dt&&((Ve?Ve.ownerDocument||Ve:ar)!==bt&&vt(Ve),Ve=Ve||bt,Jt)){if(ql!==11&&(vl=bc.exec(Ce)))if(st=vl[1]){if(ql===9)if(mt=Ve.getElementById(st)){if(mt.id===st)return Ge.push(mt),Ge}else return Ge;else if(Il&&(mt=Il.getElementById(st))&&fl(Ve,mt)&&mt.id===st)return Ge.push(mt),Ge}else{if(vl[2])return xr.apply(Ge,Ve.getElementsByTagName(Ce)),Ge;if((st=vl[3])&&V.getElementsByClassName&&Ve.getElementsByClassName)return xr.apply(Ge,Ve.getElementsByClassName(st)),Ge}if(V.qsa&&!yr[Ce+" "]&&(!Cl||!Cl.test(Ce))){if(ql!==1)Il=Ve,ml=Ce;else if(Ve.nodeName.toLowerCase()!=="object"){for((Ot=Ve.getAttribute("id"))?Ot=Ot.replace(Lr,"\\$&"):Ve.setAttribute("id",Ot=Wt),Ut=ee(Ce),$t=Ut.length,rl=ca.test(Ot)?"#"+Ot:"[id='"+Ot+"']";$t--;)Ut[$t]=rl+" "+De(Ut[$t]);ml=Ut.join(","),Il=gi.test(Ce)&&Yl(Ve.parentNode)||Ve}if(ml)try{return xr.apply(Ge,Il.querySelectorAll(ml)),Ge}catch(Dl){}finally{Ot===Wt&&Ve.removeAttribute("id")}}}return J(Ce.replace(In,"$1"),Ve,Ge,dt)}function Ho(){var Ce=[];function Ve(Ge,dt){return Ce.push(Ge+" ")>U.cacheLength&&delete Ve[Ce.shift()],Ve[Ge+" "]=dt}return Ve}function Tn(Ce){return Ce[Wt]=!0,Ce}function vi(Ce){var Ve=bt.createElement("div");try{return!!Ce(Ve)}catch(Ge){return!1}finally{Ve.parentNode&&Ve.parentNode.removeChild(Ve),Ve=null}}function Pa(Ce,Ve){for(var Ge=Ce.split("|"),dt=Ge.length;dt--;)U.attrHandle[Ge[dt]]=Ve}function jo(Ce,Ve){var Ge=Ve&&Ce,dt=Ge&&Ce.nodeType===1&&Ve.nodeType===1&&(~Ve.sourceIndex||wr)-(~Ce.sourceIndex||wr);if(dt)return dt;if(Ge){for(;Ge=Ge.nextSibling;)if(Ge===Ve)return-1}return Ce?1:-1}function us(Ce){return function(Ve){var Ge=Ve.nodeName.toLowerCase();return Ge==="input"&&Ve.type===Ce}}function Ea(Ce){return function(Ve){var Ge=Ve.nodeName.toLowerCase();return(Ge==="input"||Ge==="button")&&Ve.type===Ce}}function _i(Ce){return Tn(function(Ve){return Ve=+Ve,Tn(function(Ge,dt){for(var st,$t=Ce([],Ge.length,Ve),mt=$t.length;mt--;)Ge[st=$t[mt]]&&(Ge[st]=!(dt[st]=Ge[st]))})})}function Yl(Ce){return Ce&&typeof Ce.getElementsByTagName!="undefined"&&Ce}V=Tr.support={},se=Tr.isXML=function(Ce){var Ve=Ce&&(Ce.ownerDocument||Ce).documentElement;return Ve?Ve.nodeName!=="HTML":!1},vt=Tr.setDocument=function(Ce){var Ve,Ge,dt=Ce?Ce.ownerDocument||Ce:ar;return dt===bt||dt.nodeType!==9||!dt.documentElement||(bt=dt,dl=bt.documentElement,Jt=!se(bt),(Ge=bt.defaultView)&&Ge.top!==Ge&&(Ge.addEventListener?Ge.addEventListener("unload",xi,!1):Ge.attachEvent&&Ge.attachEvent("onunload",xi)),V.attributes=vi(function(st){return st.className="i",!st.getAttribute("className")}),V.getElementsByTagName=vi(function(st){return st.appendChild(bt.createComment("")),!st.getElementsByTagName("*").length}),V.getElementsByClassName=bo.test(bt.getElementsByClassName),V.getById=vi(function(st){return dl.appendChild(st).id=Wt,!bt.getElementsByName||!bt.getElementsByName(Wt).length}),V.getById?(U.find.ID=function(st,$t){if(typeof $t.getElementById!="undefined"&&Jt){var mt=$t.getElementById(st);return mt?[mt]:[]}},U.filter.ID=function(st){var $t=st.replace(pi,gn);return function(mt){return mt.getAttribute("id")===$t}}):(delete U.find.ID,U.filter.ID=function(st){var $t=st.replace(pi,gn);return function(mt){var Ot=typeof mt.getAttributeNode!="undefined"&&mt.getAttributeNode("id");return Ot&&Ot.value===$t}}),U.find.TAG=V.getElementsByTagName?function(st,$t){if(typeof $t.getElementsByTagName!="undefined")return $t.getElementsByTagName(st);if(V.qsa)return $t.querySelectorAll(st)}:function(st,$t){var mt,Ot=[],rl=0,vl=$t.getElementsByTagName(st);if(st==="*"){for(;mt=vl[rl++];)mt.nodeType===1&&Ot.push(mt);return Ot}return vl},U.find.CLASS=V.getElementsByClassName&&function(st,$t){if(typeof $t.getElementsByClassName!="undefined"&&Jt)return $t.getElementsByClassName(st)},Rl=[],Cl=[],(V.qsa=bo.test(bt.querySelectorAll))&&(vi(function(st){dl.appendChild(st).innerHTML="<a id='"+Wt+"'></a><select id='"+Wt+"-\r\\' msallowcapture=''><option selected=''></option></select>",st.querySelectorAll("[msallowcapture^='']").length&&Cl.push("[*^$]="+Gl+`*(?:''|"")`),st.querySelectorAll("[selected]").length||Cl.push("\\["+Gl+"*(?:value|"+vr+")"),st.querySelectorAll("[id~="+Wt+"-]").length||Cl.push("~="),st.querySelectorAll(":checked").length||Cl.push(":checked"),st.querySelectorAll("a#"+Wt+"+*").length||Cl.push(".#.+[+~]")}),vi(function(st){var $t=bt.createElement("input");$t.setAttribute("type","hidden"),st.appendChild($t).setAttribute("name","D"),st.querySelectorAll("[name=d]").length&&Cl.push("name"+Gl+"*[*^$|!~]?="),st.querySelectorAll(":enabled").length||Cl.push(":enabled",":disabled"),st.querySelectorAll("*,:x"),Cl.push(",.*:")})),(V.matchesSelector=bo.test(Pr=dl.matches||dl.webkitMatchesSelector||dl.mozMatchesSelector||dl.oMatchesSelector||dl.msMatchesSelector))&&vi(function(st){V.disconnectedMatch=Pr.call(st,"div"),Pr.call(st,"[s!='']:x"),Rl.push("!=",Oi)}),Cl=Cl.length&&new RegExp(Cl.join("|")),Rl=Rl.length&&new RegExp(Rl.join("|")),Ve=bo.test(dl.compareDocumentPosition),fl=Ve||bo.test(dl.contains)?function(st,$t){var mt=st.nodeType===9?st.documentElement:st,Ot=$t&&$t.parentNode;return st===Ot||!!(Ot&&Ot.nodeType===1&&(mt.contains?mt.contains(Ot):st.compareDocumentPosition&&st.compareDocumentPosition(Ot)&16))}:function(st,$t){if($t){for(;$t=$t.parentNode;)if($t===st)return!0}return!1},Yr=Ve?function(st,$t){if(st===$t)return lt=!0,0;var mt=!st.compareDocumentPosition-!$t.compareDocumentPosition;return mt||(mt=(st.ownerDocument||st)===($t.ownerDocument||$t)?st.compareDocumentPosition($t):1,mt&1||!V.sortDetached&&$t.compareDocumentPosition(st)===mt?st===bt||st.ownerDocument===ar&&fl(ar,st)?-1:$t===bt||$t.ownerDocument===ar&&fl(ar,$t)?1:Ae?Tl(Ae,st)-Tl(Ae,$t):0:mt&4?-1:1)}:function(st,$t){if(st===$t)return lt=!0,0;var mt,Ot=0,rl=st.parentNode,vl=$t.parentNode,Ut=[st],ml=[$t];if(!rl||!vl)return st===bt?-1:$t===bt?1:rl?-1:vl?1:Ae?Tl(Ae,st)-Tl(Ae,$t):0;if(rl===vl)return jo(st,$t);for(mt=st;mt=mt.parentNode;)Ut.unshift(mt);for(mt=$t;mt=mt.parentNode;)ml.unshift(mt);for(;Ut[Ot]===ml[Ot];)Ot++;return Ot?jo(Ut[Ot],ml[Ot]):Ut[Ot]===ar?-1:ml[Ot]===ar?1:0}),bt},Tr.matches=function(Ce,Ve){return Tr(Ce,null,null,Ve)},Tr.matchesSelector=function(Ce,Ve){if((Ce.ownerDocument||Ce)!==bt&&vt(Ce),Ve=Ve.replace(kc,"='$1']"),V.matchesSelector&&Jt&&!yr[Ve+" "]&&(!Rl||!Rl.test(Ve))&&(!Cl||!Cl.test(Ve)))try{var Ge=Pr.call(Ce,Ve);if(Ge||V.disconnectedMatch||Ce.document&&Ce.document.nodeType!==11)return Ge}catch(dt){}return Tr(Ve,bt,null,[Ce]).length>0},Tr.contains=function(Ce,Ve){return(Ce.ownerDocument||Ce)!==bt&&vt(Ce),fl(Ce,Ve)},Tr.attr=function(Ce,Ve){(Ce.ownerDocument||Ce)!==bt&&vt(Ce);var Ge=U.attrHandle[Ve.toLowerCase()],dt=Ge&&Xr.call(U.attrHandle,Ve.toLowerCase())?Ge(Ce,Ve,!Jt):void 0;return dt!==void 0?dt:V.attributes||!Jt?Ce.getAttribute(Ve):(dt=Ce.getAttributeNode(Ve))&&dt.specified?dt.value:null},Tr.error=function(Ce){throw new Error("Syntax error, unrecognized expression: "+Ce)},Tr.uniqueSort=function(Ce){var Ve,Ge=[],dt=0,st=0;if(lt=!V.detectDuplicates,Ae=!V.sortStable&&Ce.slice(0),Ce.sort(Yr),lt){for(;Ve=Ce[st++];)Ve===Ce[st]&&(dt=Ge.push(st));for(;dt--;)Ce.splice(Ge[dt],1)}return Ae=null,Ce},le=Tr.getText=function(Ce){var Ve,Ge="",dt=0,st=Ce.nodeType;if(st){if(st===1||st===9||st===11){if(typeof Ce.textContent=="string")return Ce.textContent;for(Ce=Ce.firstChild;Ce;Ce=Ce.nextSibling)Ge+=le(Ce)}else if(st===3||st===4)return Ce.nodeValue}else for(;Ve=Ce[dt++];)Ge+=le(Ve);return Ge},U=Tr.selectors={cacheLength:50,createPseudo:Tn,match:Oa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(Ce){return Ce[1]=Ce[1].replace(pi,gn),Ce[3]=(Ce[3]||Ce[4]||Ce[5]||"").replace(pi,gn),Ce[2]==="~="&&(Ce[3]=" "+Ce[3]+" "),Ce.slice(0,4)},CHILD:function(Ce){return Ce[1]=Ce[1].toLowerCase(),Ce[1].slice(0,3)==="nth"?(Ce[3]||Tr.error(Ce[0]),Ce[4]=+(Ce[4]?Ce[5]+(Ce[6]||1):2*(Ce[3]==="even"||Ce[3]==="odd")),Ce[5]=+(Ce[7]+Ce[8]||Ce[3]==="odd")):Ce[3]&&Tr.error(Ce[0]),Ce},PSEUDO:function(Ce){var Ve,Ge=!Ce[6]&&Ce[2];return Oa.CHILD.test(Ce[0])?null:(Ce[3]?Ce[2]=Ce[4]||Ce[5]||"":Ge&&sa.test(Ge)&&(Ve=ee(Ge,!0))&&(Ve=Ge.indexOf(")",Ge.length-Ve)-Ge.length)&&(Ce[0]=Ce[0].slice(0,Ve),Ce[2]=Ge.slice(0,Ve)),Ce.slice(0,3))}},filter:{TAG:function(Ce){var Ve=Ce.replace(pi,gn).toLowerCase();return Ce==="*"?function(){return!0}:function(Ge){return Ge.nodeName&&Ge.nodeName.toLowerCase()===Ve}},CLASS:function(Ce){var Ve=oi[Ce+" "];return Ve||(Ve=new RegExp("(^|"+Gl+")"+Ce+"("+Gl+"|$)"))&&oi(Ce,function(Ge){return Ve.test(typeof Ge.className=="string"&&Ge.className||typeof Ge.getAttribute!="undefined"&&Ge.getAttribute("class")||"")})},ATTR:function(Ce,Ve,Ge){return function(dt){var st=Tr.attr(dt,Ce);return st==null?Ve==="!=":Ve?(st+="",Ve==="="?st===Ge:Ve==="!="?st!==Ge:Ve==="^="?Ge&&st.indexOf(Ge)===0:Ve==="*="?Ge&&st.indexOf(Ge)>-1:Ve==="$="?Ge&&st.slice(-Ge.length)===Ge:Ve==="~="?(" "+st.replace(yc," ")+" ").indexOf(Ge)>-1:Ve==="|="?st===Ge||st.slice(0,Ge.length+1)===Ge+"-":!1):!0}},CHILD:function(Ce,Ve,Ge,dt,st){var $t=Ce.slice(0,3)!=="nth",mt=Ce.slice(-4)!=="last",Ot=Ve==="of-type";return dt===1&&st===0?function(rl){return!!rl.parentNode}:function(rl,vl,Ut){var ml,Il,ql,Dl,pn,Gn,Ci=$t!==mt?"nextSibling":"previousSibling",tn=rl.parentNode,jn=Ot&&rl.nodeName.toLowerCase(),$i=!Ut&&!Ot,ai=!1;if(tn){if($t){for(;Ci;){for(Dl=rl;Dl=Dl[Ci];)if(Ot?Dl.nodeName.toLowerCase()===jn:Dl.nodeType===1)return!1;Gn=Ci=Ce==="only"&&!Gn&&"nextSibling"}return!0}if(Gn=[mt?tn.firstChild:tn.lastChild],mt&&$i){for(Dl=tn,ql=Dl[Wt]||(Dl[Wt]={}),Il=ql[Dl.uniqueID]||(ql[Dl.uniqueID]={}),ml=Il[Ce]||[],pn=ml[0]===Fl&&ml[1],ai=pn&&ml[2],Dl=pn&&tn.childNodes[pn];Dl=++pn&&Dl&&Dl[Ci]||(ai=pn=0)||Gn.pop();)if(Dl.nodeType===1&&++ai&&Dl===rl){Il[Ce]=[Fl,pn,ai];break}}else if($i&&(Dl=rl,ql=Dl[Wt]||(Dl[Wt]={}),Il=ql[Dl.uniqueID]||(ql[Dl.uniqueID]={}),ml=Il[Ce]||[],pn=ml[0]===Fl&&ml[1],ai=pn),ai===!1)for(;(Dl=++pn&&Dl&&Dl[Ci]||(ai=pn=0)||Gn.pop())&&!((Ot?Dl.nodeName.toLowerCase()===jn:Dl.nodeType===1)&&++ai&&($i&&(ql=Dl[Wt]||(Dl[Wt]={}),Il=ql[Dl.uniqueID]||(ql[Dl.uniqueID]={}),Il[Ce]=[Fl,ai]),Dl===rl)););return ai-=st,ai===dt||ai%dt==0&&ai/dt>=0}}},PSEUDO:function(Ce,Ve){var Ge,dt=U.pseudos[Ce]||U.setFilters[Ce.toLowerCase()]||Tr.error("unsupported pseudo: "+Ce);return dt[Wt]?dt(Ve):dt.length>1?(Ge=[Ce,Ce,"",Ve],U.setFilters.hasOwnProperty(Ce.toLowerCase())?Tn(function(st,$t){for(var mt,Ot=dt(st,Ve),rl=Ot.length;rl--;)mt=Tl(st,Ot[rl]),st[mt]=!($t[mt]=Ot[rl])}):function(st){return dt(st,0,Ge)}):dt}},pseudos:{not:Tn(function(Ce){var Ve=[],Ge=[],dt=de(Ce.replace(In,"$1"));return dt[Wt]?Tn(function(st,$t,mt,Ot){for(var rl,vl=dt(st,null,Ot,[]),Ut=st.length;Ut--;)(rl=vl[Ut])&&(st[Ut]=!($t[Ut]=rl))}):function(st,$t,mt){return Ve[0]=st,dt(Ve,null,mt,Ge),Ve[0]=null,!Ge.pop()}}),has:Tn(function(Ce){return function(Ve){return Tr(Ce,Ve).length>0}}),contains:Tn(function(Ce){return Ce=Ce.replace(pi,gn),function(Ve){return(Ve.textContent||Ve.innerText||le(Ve)).indexOf(Ce)>-1}}),lang:Tn(function(Ce){return ca.test(Ce||"")||Tr.error("unsupported lang: "+Ce),Ce=Ce.replace(pi,gn).toLowerCase(),function(Ve){var Ge;do if(Ge=Jt?Ve.lang:Ve.getAttribute("xml:lang")||Ve.getAttribute("lang"))return Ge=Ge.toLowerCase(),Ge===Ce||Ge.indexOf(Ce+"-")===0;while((Ve=Ve.parentNode)&&Ve.nodeType===1);return!1}}),target:function(Ce){var Ve=M.location&&M.location.hash;return Ve&&Ve.slice(1)===Ce.id},root:function(Ce){return Ce===dl},focus:function(Ce){return Ce===bt.activeElement&&(!bt.hasFocus||bt.hasFocus())&&!!(Ce.type||Ce.href||~Ce.tabIndex)},enabled:function(Ce){return Ce.disabled===!1},disabled:function(Ce){return Ce.disabled===!0},checked:function(Ce){var Ve=Ce.nodeName.toLowerCase();return Ve==="input"&&!!Ce.checked||Ve==="option"&&!!Ce.selected},selected:function(Ce){return Ce.parentNode&&Ce.parentNode.selectedIndex,Ce.selected===!0},empty:function(Ce){for(Ce=Ce.firstChild;Ce;Ce=Ce.nextSibling)if(Ce.nodeType<6)return!1;return!0},parent:function(Ce){return!U.pseudos.empty(Ce)},header:function(Ce){return js.test(Ce.nodeName)},input:function(Ce){return oo.test(Ce.nodeName)},button:function(Ce){var Ve=Ce.nodeName.toLowerCase();return Ve==="input"&&Ce.type==="button"||Ve==="button"},text:function(Ce){var Ve;return Ce.nodeName.toLowerCase()==="input"&&Ce.type==="text"&&((Ve=Ce.getAttribute("type"))==null||Ve.toLowerCase()==="text")},first:_i(function(){return[0]}),last:_i(function(Ce,Ve){return[Ve-1]}),eq:_i(function(Ce,Ve,Ge){return[Ge<0?Ge+Ve:Ge]}),even:_i(function(Ce,Ve){for(var Ge=0;Ge<Ve;Ge+=2)Ce.push(Ge);return Ce}),odd:_i(function(Ce,Ve){for(var Ge=1;Ge<Ve;Ge+=2)Ce.push(Ge);return Ce}),lt:_i(function(Ce,Ve,Ge){for(var dt=Ge<0?Ge+Ve:Ge;--dt>=0;)Ce.push(dt);return Ce}),gt:_i(function(Ce,Ve,Ge){for(var dt=Ge<0?Ge+Ve:Ge;++dt<Ve;)Ce.push(dt);return Ce})}},U.pseudos.nth=U.pseudos.eq;for(j in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})U.pseudos[j]=us(j);for(j in{submit:!0,reset:!0})U.pseudos[j]=Ea(j);function wc(){}wc.prototype=U.filters=U.pseudos,U.setFilters=new wc,ee=Tr.tokenize=function(Ce,Ve){var Ge,dt,st,$t,mt,Ot,rl,vl=Un[Ce+" "];if(vl)return Ve?0:vl.slice(0);for(mt=Ce,Ot=[],rl=U.preFilter;mt;){(!Ge||(dt=Hs.exec(mt)))&&(dt&&(mt=mt.slice(dt[0].length)||mt),Ot.push(st=[])),Ge=!1,(dt=bu.exec(mt))&&(Ge=dt.shift(),st.push({value:Ge,type:dt[0].replace(In," ")}),mt=mt.slice(Ge.length));for($t in U.filter)(dt=Oa[$t].exec(mt))&&(!rl[$t]||(dt=rl[$t](dt)))&&(Ge=dt.shift(),st.push({value:Ge,type:$t,matches:dt}),mt=mt.slice(Ge.length));if(!Ge)break}return Ve?mt.length:mt?Tr.error(Ce):Un(Ce,Ot).slice(0)};function De(Ce){for(var Ve=0,Ge=Ce.length,dt="";Ve<Ge;Ve++)dt+=Ce[Ve].value;return dt}function je(Ce,Ve,Ge){var dt=Ve.dir,st=Ge&&dt==="parentNode",$t=Ir++;return Ve.first?function(mt,Ot,rl){for(;mt=mt[dt];)if(mt.nodeType===1||st)return Ce(mt,Ot,rl)}:function(mt,Ot,rl){var vl,Ut,ml,Il=[Fl,$t];if(rl){for(;mt=mt[dt];)if((mt.nodeType===1||st)&&Ce(mt,Ot,rl))return!0}else for(;mt=mt[dt];)if(mt.nodeType===1||st){if(ml=mt[Wt]||(mt[Wt]={}),Ut=ml[mt.uniqueID]||(ml[mt.uniqueID]={}),(vl=Ut[dt])&&vl[0]===Fl&&vl[1]===$t)return Il[2]=vl[2];if(Ut[dt]=Il,Il[2]=Ce(mt,Ot,rl))return!0}}}function tt(Ce){return Ce.length>1?function(Ve,Ge,dt){for(var st=Ce.length;st--;)if(!Ce[st](Ve,Ge,dt))return!1;return!0}:Ce[0]}function yt(Ce,Ve,Ge){for(var dt=0,st=Ve.length;dt<st;dt++)Tr(Ce,Ve[dt],Ge);return Ge}function jt(Ce,Ve,Ge,dt,st){for(var $t,mt=[],Ot=0,rl=Ce.length,vl=Ve!=null;Ot<rl;Ot++)($t=Ce[Ot])&&(!Ge||Ge($t,dt,st))&&(mt.push($t),vl&&Ve.push(Ot));return mt}function pl(Ce,Ve,Ge,dt,st,$t){return dt&&!dt[Wt]&&(dt=pl(dt)),st&&!st[Wt]&&(st=pl(st,$t)),Tn(function(mt,Ot,rl,vl){var Ut,ml,Il,ql=[],Dl=[],pn=Ot.length,Gn=mt||yt(Ve||"*",rl.nodeType?[rl]:rl,[]),Ci=Ce&&(mt||!Ve)?jt(Gn,ql,Ce,rl,vl):Gn,tn=Ge?st||(mt?Ce:pn||dt)?[]:Ot:Ci;if(Ge&&Ge(Ci,tn,rl,vl),dt)for(Ut=jt(tn,Dl),dt(Ut,[],rl,vl),ml=Ut.length;ml--;)(Il=Ut[ml])&&(tn[Dl[ml]]=!(Ci[Dl[ml]]=Il));if(mt){if(st||Ce){if(st){for(Ut=[],ml=tn.length;ml--;)(Il=tn[ml])&&Ut.push(Ci[ml]=Il);st(null,tn=[],Ut,vl)}for(ml=tn.length;ml--;)(Il=tn[ml])&&(Ut=st?Tl(mt,Il):ql[ml])>-1&&(mt[Ut]=!(Ot[Ut]=Il))}}else tn=jt(tn===Ot?tn.splice(pn,tn.length):tn),st?st(null,Ot,tn,vl):xr.apply(Ot,tn)})}function Bt(Ce){for(var Ve,Ge,dt,st=Ce.length,$t=U.relative[Ce[0].type],mt=$t||U.relative[" "],Ot=$t?1:0,rl=je(function(ml){return ml===Ve},mt,!0),vl=je(function(ml){return Tl(Ve,ml)>-1},mt,!0),Ut=[function(ml,Il,ql){var Dl=!$t&&(ql||Il!==He)||((Ve=Il).nodeType?rl(ml,Il,ql):vl(ml,Il,ql));return Ve=null,Dl}];Ot<st;Ot++)if(Ge=U.relative[Ce[Ot].type])Ut=[je(tt(Ut),Ge)];else{if(Ge=U.filter[Ce[Ot].type].apply(null,Ce[Ot].matches),Ge[Wt]){for(dt=++Ot;dt<st&&!U.relative[Ce[dt].type];dt++);return pl(Ot>1&&tt(Ut),Ot>1&&De(Ce.slice(0,Ot-1).concat({value:Ce[Ot-2].type===" "?"*":""})).replace(In,"$1"),Ge,Ot<dt&&Bt(Ce.slice(Ot,dt)),dt<st&&Bt(Ce=Ce.slice(dt)),dt<st&&De(Ce))}Ut.push(Ge)}return tt(Ut)}function hl(Ce,Ve){var Ge=Ve.length>0,dt=Ce.length>0,st=function($t,mt,Ot,rl,vl){var Ut,ml,Il,ql=0,Dl="0",pn=$t&&[],Gn=[],Ci=He,tn=$t||dt&&U.find.TAG("*",vl),jn=Fl+=Ci==null?1:Math.random()||.1,$i=tn.length;for(vl&&(He=mt===bt||mt||vl);Dl!==$i&&(Ut=tn[Dl])!=null;Dl++){if(dt&&Ut){for(ml=0,!mt&&Ut.ownerDocument!==bt&&(vt(Ut),Ot=!Jt);Il=Ce[ml++];)if(Il(Ut,mt||bt,Ot)){rl.push(Ut);break}vl&&(Fl=jn)}Ge&&((Ut=!Il&&Ut)&&ql--,$t&&pn.push(Ut))}if(ql+=Dl,Ge&&Dl!==ql){for(ml=0;Il=Ve[ml++];)Il(pn,Gn,mt,Ot);if($t){if(ql>0)for(;Dl--;)pn[Dl]||Gn[Dl]||(Gn[Dl]=pr.call(rl));Gn=jt(Gn)}xr.apply(rl,Gn),vl&&!$t&&Gn.length>0&&ql+Ve.length>1&&Tr.uniqueSort(rl)}return vl&&(Fl=jn,He=Ci),pn};return Ge?Tn(st):st}return de=Tr.compile=function(Ce,Ve){var Ge,dt=[],st=[],$t=yr[Ce+" "];if(!$t){for(Ve||(Ve=ee(Ce)),Ge=Ve.length;Ge--;)$t=Bt(Ve[Ge]),$t[Wt]?dt.push($t):st.push($t);$t=yr(Ce,hl(st,dt)),$t.selector=Ce}return $t},J=Tr.select=function(Ce,Ve,Ge,dt){var st,$t,mt,Ot,rl,vl=typeof Ce=="function"&&Ce,Ut=!dt&&ee(Ce=vl.selector||Ce);if(Ge=Ge||[],Ut.length===1){if($t=Ut[0]=Ut[0].slice(0),$t.length>2&&(mt=$t[0]).type==="ID"&&V.getById&&Ve.nodeType===9&&Jt&&U.relative[$t[1].type]){if(Ve=(U.find.ID(mt.matches[0].replace(pi,gn),Ve)||[])[0],Ve)vl&&(Ve=Ve.parentNode);else return Ge;Ce=Ce.slice($t.shift().value.length)}for(st=Oa.needsContext.test(Ce)?0:$t.length;st--&&(mt=$t[st],!U.relative[Ot=mt.type]);)if((rl=U.find[Ot])&&(dt=rl(mt.matches[0].replace(pi,gn),gi.test($t[0].type)&&Yl(Ve.parentNode)||Ve))){if($t.splice(st,1),Ce=dt.length&&De($t),!Ce)return xr.apply(Ge,dt),Ge;break}}return(vl||de(Ce,Ut))(dt,Ve,!Jt,Ge,!Ve||gi.test(Ce)&&Yl(Ve.parentNode)||Ve),Ge},V.sortStable=Wt.split("").sort(Yr).join("")===Wt,V.detectDuplicates=!!lt,vt(),V.sortDetached=vi(function(Ce){return Ce.compareDocumentPosition(bt.createElement("div"))&1}),vi(function(Ce){return Ce.innerHTML="<a href='#'></a>",Ce.firstChild.getAttribute("href")==="#"})||Pa("type|href|height|width",function(Ce,Ve,Ge){if(!Ge)return Ce.getAttribute(Ve,Ve.toLowerCase()==="type"?1:2)}),(!V.attributes||!vi(function(Ce){return Ce.innerHTML="<input/>",Ce.firstChild.setAttribute("value",""),Ce.firstChild.getAttribute("value")===""}))&&Pa("value",function(Ce,Ve,Ge){if(!Ge&&Ce.nodeName.toLowerCase()==="input")return Ce.defaultValue}),vi(function(Ce){return Ce.getAttribute("disabled")==null})||Pa(vr,function(Ce,Ve,Ge){var dt;if(!Ge)return Ce[Ve]===!0?Ve.toLowerCase():(dt=Ce.getAttributeNode(Ve))&&dt.specified?dt.value:null}),Tr}(e);g.find=P,g.expr=P.selectors,g.expr[":"]=g.expr.pseudos,g.uniqueSort=g.unique=P.uniqueSort,g.text=P.getText,g.isXMLDoc=P.isXML,g.contains=P.contains;var F=function(M,j,V){for(var U=[],le=V!==void 0;(M=M[j])&&M.nodeType!==9;)if(M.nodeType===1){if(le&&g(M).is(V))break;U.push(M)}return U},D=function(M,j){for(var V=[];M;M=M.nextSibling)M.nodeType===1&&M!==j&&V.push(M);return V},k=g.expr.match.needsContext,w=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,C=/^.[^:#\[\.,]*$/;function T(M,j,V){if(g.isFunction(j))return g.grep(M,function(U,le){return!!j.call(U,le,U)!==V});if(j.nodeType)return g.grep(M,function(U){return U===j!==V});if(typeof j=="string"){if(C.test(j))return g.filter(j,M,V);j=g.filter(j,M)}return g.grep(M,function(U){return u.call(j,U)>-1!==V})}g.filter=function(M,j,V){var U=j[0];return V&&(M=":not("+M+")"),j.length===1&&U.nodeType===1?g.find.matchesSelector(U,M)?[U]:[]:g.find.matches(M,g.grep(j,function(le){return le.nodeType===1}))},g.fn.extend({find:function(M){var j,V=this.length,U=[],le=this;if(typeof M!="string")return this.pushStack(g(M).filter(function(){for(j=0;j<V;j++)if(g.contains(le[j],this))return!0}));for(j=0;j<V;j++)g.find(M,le[j],U);return U=this.pushStack(V>1?g.unique(U):U),U.selector=this.selector?this.selector+" "+M:M,U},filter:function(M){return this.pushStack(T(this,M||[],!1))},not:function(M){return this.pushStack(T(this,M||[],!0))},is:function(M){return!!T(this,typeof M=="string"&&k.test(M)?g(M):M||[],!1).length}});var O,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=g.fn.init=function(M,j,V){var U,le;if(!M)return this;if(V=V||O,typeof M=="string")if(M[0]==="<"&&M[M.length-1]===">"&&M.length>=3?U=[null,M,null]:U=z.exec(M),U&&(U[1]||!j))if(U[1]){if(j=j instanceof g?j[0]:j,g.merge(this,g.parseHTML(U[1],j&&j.nodeType?j.ownerDocument||j:l,!0)),w.test(U[1])&&g.isPlainObject(j))for(U in j)g.isFunction(this[U])?this[U](j[U]):this.attr(U,j[U]);return this}else return le=l.getElementById(U[2]),le&&le.parentNode&&(this.length=1,this[0]=le),this.context=l,this.selector=M,this;else return!j||j.jquery?(j||V).find(M):this.constructor(j).find(M);else{if(M.nodeType)return this.context=this[0]=M,this.length=1,this;if(g.isFunction(M))return V.ready!==void 0?V.ready(M):M(g)}return M.selector!==void 0&&(this.selector=M.selector,this.context=M.context),g.makeArray(M,this)};A.prototype=g.fn,O=g(l);var E=/^(?:parents|prev(?:Until|All))/,L={children:!0,contents:!0,next:!0,prev:!0};g.fn.extend({has:function(M){var j=g(M,this),V=j.length;return this.filter(function(){for(var U=0;U<V;U++)if(g.contains(this,j[U]))return!0})},closest:function(M,j){for(var V,U=0,le=this.length,se=[],ee=k.test(M)||typeof M!="string"?g(M,j||this.context):0;U<le;U++)for(V=this[U];V&&V!==j;V=V.parentNode)if(V.nodeType<11&&(ee?ee.index(V)>-1:V.nodeType===1&&g.find.matchesSelector(V,M))){se.push(V);break}return this.pushStack(se.length>1?g.uniqueSort(se):se)},index:function(M){return M?typeof M=="string"?u.call(g(M),this[0]):u.call(this,M.jquery?M[0]:M):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(M,j){return this.pushStack(g.uniqueSort(g.merge(this.get(),g(M,j))))},addBack:function(M){return this.add(M==null?this.prevObject:this.prevObject.filter(M))}});function N(M,j){for(;(M=M[j])&&M.nodeType!==1;);return M}g.each({parent:function(M){var j=M.parentNode;return j&&j.nodeType!==11?j:null},parents:function(M){return F(M,"parentNode")},parentsUntil:function(M,j,V){return F(M,"parentNode",V)},next:function(M){return N(M,"nextSibling")},prev:function(M){return N(M,"previousSibling")},nextAll:function(M){return F(M,"nextSibling")},prevAll:function(M){return F(M,"previousSibling")},nextUntil:function(M,j,V){return F(M,"nextSibling",V)},prevUntil:function(M,j,V){return F(M,"previousSibling",V)},siblings:function(M){return D((M.parentNode||{}).firstChild,M)},children:function(M){return D(M.firstChild)},contents:function(M){return M.contentDocument||g.merge([],M.childNodes)}},function(M,j){g.fn[M]=function(V,U){var le=g.map(this,j,V);return M.slice(-5)!=="Until"&&(U=V),U&&typeof U=="string"&&(le=g.filter(U,le)),this.length>1&&(L[M]||g.uniqueSort(le),E.test(M)&&le.reverse()),this.pushStack(le)}});var W=/\S+/g;function X(M){var j={};return g.each(M.match(W)||[],function(V,U){j[U]=!0}),j}g.Callbacks=function(M){M=typeof M=="string"?X(M):g.extend({},M);var j,V,U,le,se=[],ee=[],de=-1,J=function(){for(le=M.once,U=j=!0;ee.length;de=-1)for(V=ee.shift();++de<se.length;)se[de].apply(V[0],V[1])===!1&&M.stopOnFalse&&(de=se.length,V=!1);M.memory||(V=!1),j=!1,le&&(V?se=[]:se="")},He={add:function(){return se&&(V&&!j&&(de=se.length-1,ee.push(V)),function Ae(lt){g.each(lt,function(vt,bt){g.isFunction(bt)?(!M.unique||!He.has(bt))&&se.push(bt):bt&&bt.length&&g.type(bt)!=="string"&&Ae(bt)})}(arguments),V&&!j&&J()),this},remove:function(){return g.each(arguments,function(Ae,lt){for(var vt;(vt=g.inArray(lt,se,vt))>-1;)se.splice(vt,1),vt<=de&&de--}),this},has:function(Ae){return Ae?g.inArray(Ae,se)>-1:se.length>0},empty:function(){return se&&(se=[]),this},disable:function(){return le=ee=[],se=V="",this},disabled:function(){return!se},lock:function(){return le=ee=[],V||(se=V=""),this},locked:function(){return!!le},fireWith:function(Ae,lt){return le||(lt=lt||[],lt=[Ae,lt.slice?lt.slice():lt],ee.push(lt),j||J()),this},fire:function(){return He.fireWith(this,arguments),this},fired:function(){return!!U}};return He},g.extend({Deferred:function(M){var j=[["resolve","done",g.Callbacks("once memory"),"resolved"],["reject","fail",g.Callbacks("once memory"),"rejected"],["notify","progress",g.Callbacks("memory")]],V="pending",U={state:function(){return V},always:function(){return le.done(arguments).fail(arguments),this},then:function(){var se=arguments;return g.Deferred(function(ee){g.each(j,function(de,J){var He=g.isFunction(se[de])&&se[de];le[J[1]](function(){var Ae=He&&He.apply(this,arguments);Ae&&g.isFunction(Ae.promise)?Ae.promise().progress(ee.notify).done(ee.resolve).fail(ee.reject):ee[J[0]+"With"](this===U?ee.promise():this,He?[Ae]:arguments)})}),se=null}).promise()},promise:function(se){return se!=null?g.extend(se,U):U}},le={};return U.pipe=U.then,g.each(j,function(se,ee){var de=ee[2],J=ee[3];U[ee[1]]=de.add,J&&de.add(function(){V=J},j[se^1][2].disable,j[2][2].lock),le[ee[0]]=function(){return le[ee[0]+"With"](this===le?U:this,arguments),this},le[ee[0]+"With"]=de.fireWith}),U.promise(le),M&&M.call(le,le),le},when:function(M){var j=0,V=o.call(arguments),U=V.length,le=U!==1||M&&g.isFunction(M.promise)?U:0,se=le===1?M:g.Deferred(),ee=function(Ae,lt,vt){return function(bt){lt[Ae]=this,vt[Ae]=arguments.length>1?o.call(arguments):bt,vt===de?se.notifyWith(lt,vt):--le||se.resolveWith(lt,vt)}},de,J,He;if(U>1)for(de=new Array(U),J=new Array(U),He=new Array(U);j<U;j++)V[j]&&g.isFunction(V[j].promise)?V[j].promise().progress(ee(j,J,de)).done(ee(j,He,V)).fail(se.reject):--le;return le||se.resolveWith(He,V),se.promise()}});var te;g.fn.ready=function(M){return g.ready.promise().done(M),this},g.extend({isReady:!1,readyWait:1,holdReady:function(M){M?g.readyWait++:g.ready(!0)},ready:function(M){(M===!0?--g.readyWait:g.isReady)||(g.isReady=!0,!(M!==!0&&--g.readyWait>0)&&(te.resolveWith(l,[g]),g.fn.triggerHandler&&(g(l).triggerHandler("ready"),g(l).off("ready"))))}});function ue(){l.removeEventListener("DOMContentLoaded",ue),e.removeEventListener("load",ue),g.ready()}g.ready.promise=function(M){return te||(te=g.Deferred(),l.readyState==="complete"||l.readyState!=="loading"&&!l.documentElement.doScroll?e.setTimeout(g.ready):(l.addEventListener("DOMContentLoaded",ue),e.addEventListener("load",ue))),te.promise(M)},g.ready.promise();var pe=function(M,j,V,U,le,se,ee){var de=0,J=M.length,He=V==null;if(g.type(V)==="object"){le=!0;for(de in V)pe(M,j,de,V[de],!0,se,ee)}else if(U!==void 0&&(le=!0,g.isFunction(U)||(ee=!0),He&&(ee?(j.call(M,U),j=null):(He=j,j=function(Ae,lt,vt){return He.call(g(Ae),vt)})),j))for(;de<J;de++)j(M[de],V,ee?U:U.call(M[de],de,j(M[de],V)));return le?M:He?j.call(M):J?j(M[0],V):se},ne=function(M){return M.nodeType===1||M.nodeType===9||!+M.nodeType};function me(){this.expando=g.expando+me.uid++}me.uid=1,me.prototype={register:function(M,j){var V=j||{};return M.nodeType?M[this.expando]=V:Object.defineProperty(M,this.expando,{value:V,writable:!0,configurable:!0}),M[this.expando]},cache:function(M){if(!ne(M))return{};var j=M[this.expando];return j||(j={},ne(M)&&(M.nodeType?M[this.expando]=j:Object.defineProperty(M,this.expando,{value:j,configurable:!0}))),j},set:function(M,j,V){var U,le=this.cache(M);if(typeof j=="string")le[j]=V;else for(U in j)le[U]=j[U];return le},get:function(M,j){return j===void 0?this.cache(M):M[this.expando]&&M[this.expando][j]},access:function(M,j,V){var U;return j===void 0||j&&typeof j=="string"&&V===void 0?(U=this.get(M,j),U!==void 0?U:this.get(M,g.camelCase(j))):(this.set(M,j,V),V!==void 0?V:j)},remove:function(M,j){var V,U,le,se=M[this.expando];if(se!==void 0){if(j===void 0)this.register(M);else for(g.isArray(j)?U=j.concat(j.map(g.camelCase)):(le=g.camelCase(j),j in se?U=[j,le]:(U=le,U=U in se?[U]:U.match(W)||[])),V=U.length;V--;)delete se[U[V]];(j===void 0||g.isEmptyObject(se))&&(M.nodeType?M[this.expando]=void 0:delete M[this.expando])}},hasData:function(M){var j=M[this.expando];return j!==void 0&&!g.isEmptyObject(j)}};var Q=new me,we=new me,ie=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ge=/[A-Z]/g;function ce(M,j,V){var U;if(V===void 0&&M.nodeType===1)if(U="data-"+j.replace(ge,"-$&").toLowerCase(),V=M.getAttribute(U),typeof V=="string"){try{V=V==="true"?!0:V==="false"?!1:V==="null"?null:+V+""===V?+V:ie.test(V)?g.parseJSON(V):V}catch(le){}we.set(M,j,V)}else V=void 0;return V}g.extend({hasData:function(M){return we.hasData(M)||Q.hasData(M)},data:function(M,j,V){return we.access(M,j,V)},removeData:function(M,j){we.remove(M,j)},_data:function(M,j,V){return Q.access(M,j,V)},_removeData:function(M,j){Q.remove(M,j)}}),g.fn.extend({data:function(M,j){var V,U,le,se=this[0],ee=se&&se.attributes;if(M===void 0){if(this.length&&(le=we.get(se),se.nodeType===1&&!Q.get(se,"hasDataAttrs"))){for(V=ee.length;V--;)ee[V]&&(U=ee[V].name,U.indexOf("data-")===0&&(U=g.camelCase(U.slice(5)),ce(se,U,le[U])));Q.set(se,"hasDataAttrs",!0)}return le}return typeof M=="object"?this.each(function(){we.set(this,M)}):pe(this,function(de){var J,He;if(se&&de===void 0)return J=we.get(se,M)||we.get(se,M.replace(ge,"-$&").toLowerCase()),J!==void 0||(He=g.camelCase(M),J=we.get(se,He),J!==void 0)||(J=ce(se,He,void 0),J!==void 0)?J:void 0;He=g.camelCase(M),this.each(function(){var Ae=we.get(this,He);we.set(this,He,de),M.indexOf("-")>-1&&Ae!==void 0&&we.set(this,M,de)})},null,j,arguments.length>1,null,!0)},removeData:function(M){return this.each(function(){we.remove(this,M)})}}),g.extend({queue:function(M,j,V){var U;if(M)return j=(j||"fx")+"queue",U=Q.get(M,j),V&&(!U||g.isArray(V)?U=Q.access(M,j,g.makeArray(V)):U.push(V)),U||[]},dequeue:function(M,j){j=j||"fx";var V=g.queue(M,j),U=V.length,le=V.shift(),se=g._queueHooks(M,j),ee=function(){g.dequeue(M,j)};le==="inprogress"&&(le=V.shift(),U--),le&&(j==="fx"&&V.unshift("inprogress"),delete se.stop,le.call(M,ee,se)),!U&&se&&se.empty.fire()},_queueHooks:function(M,j){var V=j+"queueHooks";return Q.get(M,V)||Q.access(M,V,{empty:g.Callbacks("once memory").add(function(){Q.remove(M,[j+"queue",V])})})}}),g.fn.extend({queue:function(M,j){var V=2;return typeof M!="string"&&(j=M,M="fx",V--),arguments.length<V?g.queue(this[0],M):j===void 0?this:this.each(function(){var U=g.queue(this,M,j);g._queueHooks(this,M),M==="fx"&&U[0]!=="inprogress"&&g.dequeue(this,M)})},dequeue:function(M){return this.each(function(){g.dequeue(this,M)})},clearQueue:function(M){return this.queue(M||"fx",[])},promise:function(M,j){var V,U=1,le=g.Deferred(),se=this,ee=this.length,de=function(){--U||le.resolveWith(se,[se])};for(typeof M!="string"&&(j=M,M=void 0),M=M||"fx";ee--;)V=Q.get(se[ee],M+"queueHooks"),V&&V.empty&&(U++,V.empty.add(de));return de(),le.promise(j)}});var fe=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ye=new RegExp("^(?:([+-])=|)("+fe+")([a-z%]*)$","i"),Ne=["Top","Right","Bottom","Left"],xe=function(M,j){return M=j||M,g.css(M,"display")==="none"||!g.contains(M.ownerDocument,M)};function et(M,j,V,U){var le,se=1,ee=20,de=U?function(){return U.cur()}:function(){return g.css(M,j,"")},J=de(),He=V&&V[3]||(g.cssNumber[j]?"":"px"),Ae=(g.cssNumber[j]||He!=="px"&&+J)&&ye.exec(g.css(M,j));if(Ae&&Ae[3]!==He){He=He||Ae[3],V=V||[],Ae=+J||1;do se=se||".5",Ae=Ae/se,g.style(M,j,Ae+He);while(se!==(se=de()/J)&&se!==1&&--ee)}return V&&(Ae=+Ae||+J||0,le=V[1]?Ae+(V[1]+1)*V[2]:+V[2],U&&(U.unit=He,U.start=Ae,U.end=le)),le}var Fe=/^(?:checkbox|radio)$/i,it=/<([\w:-]+)/,wt=/^$|\/(?:java|ecma)script/i,ot={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ot.optgroup=ot.option,ot.tbody=ot.tfoot=ot.colgroup=ot.caption=ot.thead,ot.th=ot.td;function xt(M,j){var V=typeof M.getElementsByTagName!="undefined"?M.getElementsByTagName(j||"*"):typeof M.querySelectorAll!="undefined"?M.querySelectorAll(j||"*"):[];return j===void 0||j&&g.nodeName(M,j)?g.merge([M],V):V}function Ft(M,j){for(var V=0,U=M.length;V<U;V++)Q.set(M[V],"globalEval",!j||Q.get(j[V],"globalEval"))}var Se=/<|&#?\w+;/;function oe(M,j,V,U,le){for(var se,ee,de,J,He,Ae,lt=j.createDocumentFragment(),vt=[],bt=0,dl=M.length;bt<dl;bt++)if(se=M[bt],se||se===0)if(g.type(se)==="object")g.merge(vt,se.nodeType?[se]:se);else if(!Se.test(se))vt.push(j.createTextNode(se));else{for(ee=ee||lt.appendChild(j.createElement("div")),de=(it.exec(se)||["",""])[1].toLowerCase(),J=ot[de]||ot._default,ee.innerHTML=J[1]+g.htmlPrefilter(se)+J[2],Ae=J[0];Ae--;)ee=ee.lastChild;g.merge(vt,ee.childNodes),ee=lt.firstChild,ee.textContent=""}for(lt.textContent="",bt=0;se=vt[bt++];){if(U&&g.inArray(se,U)>-1){le&&le.push(se);continue}if(He=g.contains(se.ownerDocument,se),ee=xt(lt.appendChild(se),"script"),He&&Ft(ee),V)for(Ae=0;se=ee[Ae++];)wt.test(se.type||"")&&V.push(se)}return lt}(function(){var M=l.createDocumentFragment(),j=M.appendChild(l.createElement("div")),V=l.createElement("input");V.setAttribute("type","radio"),V.setAttribute("checked","checked"),V.setAttribute("name","t"),j.appendChild(V),p.checkClone=j.cloneNode(!0).cloneNode(!0).lastChild.checked,j.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!j.cloneNode(!0).lastChild.defaultValue})();var be=/^key/,Te=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Oe=/^([^.]*)(?:\.(.+)|)/;function Xe(){return!0}function Le(){return!1}function Ee(){try{return l.activeElement}catch(M){}}function nt(M,j,V,U,le,se){var ee,de;if(typeof j=="object"){typeof V!="string"&&(U=U||V,V=void 0);for(de in j)nt(M,de,V,U,j[de],se);return M}if(U==null&&le==null?(le=V,U=V=void 0):le==null&&(typeof V=="string"?(le=U,U=void 0):(le=U,U=V,V=void 0)),le===!1)le=Le;else if(!le)return M;return se===1&&(ee=le,le=function(J){return g().off(J),ee.apply(this,arguments)},le.guid=ee.guid||(ee.guid=g.guid++)),M.each(function(){g.event.add(this,j,le,U,V)})}g.event={global:{},add:function(M,j,V,U,le){var se,ee,de,J,He,Ae,lt,vt,bt,dl,Jt,Cl=Q.get(M);if(!!Cl)for(V.handler&&(se=V,V=se.handler,le=se.selector),V.guid||(V.guid=g.guid++),(J=Cl.events)||(J=Cl.events={}),(ee=Cl.handle)||(ee=Cl.handle=function(Rl){return typeof g!="undefined"&&g.event.triggered!==Rl.type?g.event.dispatch.apply(M,arguments):void 0}),j=(j||"").match(W)||[""],He=j.length;He--;)de=Oe.exec(j[He])||[],bt=Jt=de[1],dl=(de[2]||"").split(".").sort(),!!bt&&(lt=g.event.special[bt]||{},bt=(le?lt.delegateType:lt.bindType)||bt,lt=g.event.special[bt]||{},Ae=g.extend({type:bt,origType:Jt,data:U,handler:V,guid:V.guid,selector:le,needsContext:le&&g.expr.match.needsContext.test(le),namespace:dl.join(".")},se),(vt=J[bt])||(vt=J[bt]=[],vt.delegateCount=0,(!lt.setup||lt.setup.call(M,U,dl,ee)===!1)&&M.addEventListener&&M.addEventListener(bt,ee)),lt.add&&(lt.add.call(M,Ae),Ae.handler.guid||(Ae.handler.guid=V.guid)),le?vt.splice(vt.delegateCount++,0,Ae):vt.push(Ae),g.event.global[bt]=!0)},remove:function(M,j,V,U,le){var se,ee,de,J,He,Ae,lt,vt,bt,dl,Jt,Cl=Q.hasData(M)&&Q.get(M);if(!(!Cl||!(J=Cl.events))){for(j=(j||"").match(W)||[""],He=j.length;He--;){if(de=Oe.exec(j[He])||[],bt=Jt=de[1],dl=(de[2]||"").split(".").sort(),!bt){for(bt in J)g.event.remove(M,bt+j[He],V,U,!0);continue}for(lt=g.event.special[bt]||{},bt=(U?lt.delegateType:lt.bindType)||bt,vt=J[bt]||[],de=de[2]&&new RegExp("(^|\\.)"+dl.join("\\.(?:.*\\.|)")+"(\\.|$)"),ee=se=vt.length;se--;)Ae=vt[se],(le||Jt===Ae.origType)&&(!V||V.guid===Ae.guid)&&(!de||de.test(Ae.namespace))&&(!U||U===Ae.selector||U==="**"&&Ae.selector)&&(vt.splice(se,1),Ae.selector&&vt.delegateCount--,lt.remove&&lt.remove.call(M,Ae));ee&&!vt.length&&((!lt.teardown||lt.teardown.call(M,dl,Cl.handle)===!1)&&g.removeEvent(M,bt,Cl.handle),delete J[bt])}g.isEmptyObject(J)&&Q.remove(M,"handle events")}},dispatch:function(M){M=g.event.fix(M);var j,V,U,le,se,ee=[],de=o.call(arguments),J=(Q.get(this,"events")||{})[M.type]||[],He=g.event.special[M.type]||{};if(de[0]=M,M.delegateTarget=this,!(He.preDispatch&&He.preDispatch.call(this,M)===!1)){for(ee=g.event.handlers.call(this,M,J),j=0;(le=ee[j++])&&!M.isPropagationStopped();)for(M.currentTarget=le.elem,V=0;(se=le.handlers[V++])&&!M.isImmediatePropagationStopped();)(!M.rnamespace||M.rnamespace.test(se.namespace))&&(M.handleObj=se,M.data=se.data,U=((g.event.special[se.origType]||{}).handle||se.handler).apply(le.elem,de),U!==void 0&&(M.result=U)===!1&&(M.preventDefault(),M.stopPropagation()));return He.postDispatch&&He.postDispatch.call(this,M),M.result}},handlers:function(M,j){var V,U,le,se,ee=[],de=j.delegateCount,J=M.target;if(de&&J.nodeType&&(M.type!=="click"||isNaN(M.button)||M.button<1)){for(;J!==this;J=J.parentNode||this)if(J.nodeType===1&&(J.disabled!==!0||M.type!=="click")){for(U=[],V=0;V<de;V++)se=j[V],le=se.selector+" ",U[le]===void 0&&(U[le]=se.needsContext?g(le,this).index(J)>-1:g.find(le,this,null,[J]).length),U[le]&&U.push(se);U.length&&ee.push({elem:J,handlers:U})}}return de<j.length&&ee.push({elem:this,handlers:j.slice(de)}),ee},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(M,j){return M.which==null&&(M.which=j.charCode!=null?j.charCode:j.keyCode),M}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(M,j){var V,U,le,se=j.button;return M.pageX==null&&j.clientX!=null&&(V=M.target.ownerDocument||l,U=V.documentElement,le=V.body,M.pageX=j.clientX+(U&&U.scrollLeft||le&&le.scrollLeft||0)-(U&&U.clientLeft||le&&le.clientLeft||0),M.pageY=j.clientY+(U&&U.scrollTop||le&&le.scrollTop||0)-(U&&U.clientTop||le&&le.clientTop||0)),!M.which&&se!==void 0&&(M.which=se&1?1:se&2?3:se&4?2:0),M}},fix:function(M){if(M[g.expando])return M;var j,V,U,le=M.type,se=M,ee=this.fixHooks[le];for(ee||(this.fixHooks[le]=ee=Te.test(le)?this.mouseHooks:be.test(le)?this.keyHooks:{}),U=ee.props?this.props.concat(ee.props):this.props,M=new g.Event(se),j=U.length;j--;)V=U[j],M[V]=se[V];return M.target||(M.target=l),M.target.nodeType===3&&(M.target=M.target.parentNode),ee.filter?ee.filter(M,se):M},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Ee()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Ee()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&g.nodeName(this,"input"))return this.click(),!1},_default:function(M){return g.nodeName(M.target,"a")}},beforeunload:{postDispatch:function(M){M.result!==void 0&&M.originalEvent&&(M.originalEvent.returnValue=M.result)}}}},g.removeEvent=function(M,j,V){M.removeEventListener&&M.removeEventListener(j,V)},g.Event=function(M,j){if(!(this instanceof g.Event))return new g.Event(M,j);M&&M.type?(this.originalEvent=M,this.type=M.type,this.isDefaultPrevented=M.defaultPrevented||M.defaultPrevented===void 0&&M.returnValue===!1?Xe:Le):this.type=M,j&&g.extend(this,j),this.timeStamp=M&&M.timeStamp||g.now(),this[g.expando]=!0},g.Event.prototype={constructor:g.Event,isDefaultPrevented:Le,isPropagationStopped:Le,isImmediatePropagationStopped:Le,isSimulated:!1,preventDefault:function(){var M=this.originalEvent;this.isDefaultPrevented=Xe,M&&!this.isSimulated&&M.preventDefault()},stopPropagation:function(){var M=this.originalEvent;this.isPropagationStopped=Xe,M&&!this.isSimulated&&M.stopPropagation()},stopImmediatePropagation:function(){var M=this.originalEvent;this.isImmediatePropagationStopped=Xe,M&&!this.isSimulated&&M.stopImmediatePropagation(),this.stopPropagation()}},g.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(M,j){g.event.special[M]={delegateType:j,bindType:j,handle:function(V){var U,le=this,se=V.relatedTarget,ee=V.handleObj;return(!se||se!==le&&!g.contains(le,se))&&(V.type=ee.origType,U=ee.handler.apply(this,arguments),V.type=j),U}}}),g.fn.extend({on:function(M,j,V,U){return nt(this,M,j,V,U)},one:function(M,j,V,U){return nt(this,M,j,V,U,1)},off:function(M,j,V){var U,le;if(M&&M.preventDefault&&M.handleObj)return U=M.handleObj,g(M.delegateTarget).off(U.namespace?U.origType+"."+U.namespace:U.origType,U.selector,U.handler),this;if(typeof M=="object"){for(le in M)this.off(le,j,M[le]);return this}return(j===!1||typeof j=="function")&&(V=j,j=void 0),V===!1&&(V=Le),this.each(function(){g.event.remove(this,M,V,j)})}});var Ze=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ze=/<script|<style|<link/i,_e=/checked\s*(?:[^=]|=\s*.checked.)/i,Qe=/^true\/(.*)/,Je=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ke(M,j){return g.nodeName(M,"table")&&g.nodeName(j.nodeType!==11?j:j.firstChild,"tr")?M.getElementsByTagName("tbody")[0]||M.appendChild(M.ownerDocument.createElement("tbody")):M}function gt(M){return M.type=(M.getAttribute("type")!==null)+"/"+M.type,M}function At(M){var j=Qe.exec(M.type);return j?M.type=j[1]:M.removeAttribute("type"),M}function cl(M,j){var V,U,le,se,ee,de,J,He;if(j.nodeType===1){if(Q.hasData(M)&&(se=Q.access(M),ee=Q.set(j,se),He=se.events,He)){delete ee.handle,ee.events={};for(le in He)for(V=0,U=He[le].length;V<U;V++)g.event.add(j,le,He[le][V])}we.hasData(M)&&(de=we.access(M),J=g.extend({},de),we.set(j,J))}}function El(M,j){var V=j.nodeName.toLowerCase();V==="input"&&Fe.test(M.type)?j.checked=M.checked:(V==="input"||V==="textarea")&&(j.defaultValue=M.defaultValue)}function bl(M,j,V,U){j=a.apply([],j);var le,se,ee,de,J,He,Ae=0,lt=M.length,vt=lt-1,bt=j[0],dl=g.isFunction(bt);if(dl||lt>1&&typeof bt=="string"&&!p.checkClone&&_e.test(bt))return M.each(function(Jt){var Cl=M.eq(Jt);dl&&(j[0]=bt.call(this,Jt,Cl.html())),bl(Cl,j,V,U)});if(lt&&(le=oe(j,M[0].ownerDocument,!1,M,U),se=le.firstChild,le.childNodes.length===1&&(le=se),se||U)){for(ee=g.map(xt(le,"script"),gt),de=ee.length;Ae<lt;Ae++)J=le,Ae!==vt&&(J=g.clone(J,!0,!0),de&&g.merge(ee,xt(J,"script"))),V.call(M[Ae],J,Ae);if(de)for(He=ee[ee.length-1].ownerDocument,g.map(ee,At),Ae=0;Ae<de;Ae++)J=ee[Ae],wt.test(J.type||"")&&!Q.access(J,"globalEval")&&g.contains(He,J)&&(J.src?g._evalUrl&&g._evalUrl(J.src):g.globalEval(J.textContent.replace(Je,"")))}return M}function Nr(M,j,V){for(var U,le=j?g.filter(j,M):M,se=0;(U=le[se])!=null;se++)!V&&U.nodeType===1&&g.cleanData(xt(U)),U.parentNode&&(V&&g.contains(U.ownerDocument,U)&&Ft(xt(U,"script")),U.parentNode.removeChild(U));return M}g.extend({htmlPrefilter:function(M){return M.replace(Ze,"<$1></$2>")},clone:function(M,j,V){var U,le,se,ee,de=M.cloneNode(!0),J=g.contains(M.ownerDocument,M);if(!p.noCloneChecked&&(M.nodeType===1||M.nodeType===11)&&!g.isXMLDoc(M))for(ee=xt(de),se=xt(M),U=0,le=se.length;U<le;U++)El(se[U],ee[U]);if(j)if(V)for(se=se||xt(M),ee=ee||xt(de),U=0,le=se.length;U<le;U++)cl(se[U],ee[U]);else cl(M,de);return ee=xt(de,"script"),ee.length>0&&Ft(ee,!J&&xt(M,"script")),de},cleanData:function(M){for(var j,V,U,le=g.event.special,se=0;(V=M[se])!==void 0;se++)if(ne(V)){if(j=V[Q.expando]){if(j.events)for(U in j.events)le[U]?g.event.remove(V,U):g.removeEvent(V,U,j.handle);V[Q.expando]=void 0}V[we.expando]&&(V[we.expando]=void 0)}}}),g.fn.extend({domManip:bl,detach:function(M){return Nr(this,M,!0)},remove:function(M){return Nr(this,M)},text:function(M){return pe(this,function(j){return j===void 0?g.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=j)})},null,M,arguments.length)},append:function(){return bl(this,arguments,function(M){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var j=Ke(this,M);j.appendChild(M)}})},prepend:function(){return bl(this,arguments,function(M){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var j=Ke(this,M);j.insertBefore(M,j.firstChild)}})},before:function(){return bl(this,arguments,function(M){this.parentNode&&this.parentNode.insertBefore(M,this)})},after:function(){return bl(this,arguments,function(M){this.parentNode&&this.parentNode.insertBefore(M,this.nextSibling)})},empty:function(){for(var M,j=0;(M=this[j])!=null;j++)M.nodeType===1&&(g.cleanData(xt(M,!1)),M.textContent="");return this},clone:function(M,j){return M=M??!1,j=j??M,this.map(function(){return g.clone(this,M,j)})},html:function(M){return pe(this,function(j){var V=this[0]||{},U=0,le=this.length;if(j===void 0&&V.nodeType===1)return V.innerHTML;if(typeof j=="string"&&!ze.test(j)&&!ot[(it.exec(j)||["",""])[1].toLowerCase()]){j=g.htmlPrefilter(j);try{for(;U<le;U++)V=this[U]||{},V.nodeType===1&&(g.cleanData(xt(V,!1)),V.innerHTML=j);V=0}catch(se){}}V&&this.empty().append(j)},null,M,arguments.length)},replaceWith:function(){var M=[];return bl(this,arguments,function(j){var V=this.parentNode;g.inArray(this,M)<0&&(g.cleanData(xt(this)),V&&V.replaceChild(j,this))},M)}}),g.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(M,j){g.fn[M]=function(V){for(var U,le=[],se=g(V),ee=se.length-1,de=0;de<=ee;de++)U=de===ee?this:this.clone(!0),g(se[de])[j](U),s.apply(le,U.get());return this.pushStack(le)}});var li,on={HTML:"block",BODY:"block"};function Re(M,j){var V=g(j.createElement(M)).appendTo(j.body),U=g.css(V[0],"display");return V.detach(),U}function We(M){var j=l,V=on[M];return V||(V=Re(M,j),(V==="none"||!V)&&(li=(li||g("<iframe frameborder='0' width='0' height='0'/>")).appendTo(j.documentElement),j=li[0].contentDocument,j.write(),j.close(),V=Re(M,j),li.detach()),on[M]=V),V}var ht=/^margin/,Ct=new RegExp("^("+fe+")(?!px)[a-z%]+$","i"),Lt=function(M){var j=M.ownerDocument.defaultView;return(!j||!j.opener)&&(j=e),j.getComputedStyle(M)},Dt=function(M,j,V,U){var le,se,ee={};for(se in j)ee[se]=M.style[se],M.style[se]=j[se];le=V.apply(M,U||[]);for(se in j)M.style[se]=ee[se];return le},ol=l.documentElement;(function(){var M,j,V,U,le=l.createElement("div"),se=l.createElement("div");if(!se.style)return;se.style.backgroundClip="content-box",se.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle=se.style.backgroundClip==="content-box",le.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",le.appendChild(se);function ee(){se.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",se.innerHTML="",ol.appendChild(le);var de=e.getComputedStyle(se);M=de.top!=="1%",U=de.marginLeft==="2px",j=de.width==="4px",se.style.marginRight="50%",V=de.marginRight==="4px",ol.removeChild(le)}g.extend(p,{pixelPosition:function(){return ee(),M},boxSizingReliable:function(){return j==null&&ee(),j},pixelMarginRight:function(){return j==null&&ee(),V},reliableMarginLeft:function(){return j==null&&ee(),U},reliableMarginRight:function(){var de,J=se.appendChild(l.createElement("div"));return J.style.cssText=se.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",J.style.marginRight=J.style.width="0",se.style.width="1px",ol.appendChild(le),de=!parseFloat(e.getComputedStyle(J).marginRight),ol.removeChild(le),se.removeChild(J),de}})})();function el(M,j,V){var U,le,se,ee,de=M.style;return V=V||Lt(M),ee=V?V.getPropertyValue(j)||V[j]:void 0,(ee===""||ee===void 0)&&!g.contains(M.ownerDocument,M)&&(ee=g.style(M,j)),V&&!p.pixelMarginRight()&&Ct.test(ee)&&ht.test(j)&&(U=de.width,le=de.minWidth,se=de.maxWidth,de.minWidth=de.maxWidth=de.width=ee,ee=V.width,de.width=U,de.minWidth=le,de.maxWidth=se),ee!==void 0?ee+"":ee}function Al(M,j){return{get:function(){if(M()){delete this.get;return}return(this.get=j).apply(this,arguments)}}}var Vl=/^(none|table(?!-c[ea]).+)/,lr={position:"absolute",visibility:"hidden",display:"block"},hn={letterSpacing:"0",fontWeight:"400"},en=["Webkit","O","Moz","ms"],Mn=l.createElement("div").style;function Dn(M){if(M in Mn)return M;for(var j=M[0].toUpperCase()+M.slice(1),V=en.length;V--;)if(M=en[V]+j,M in Mn)return M}function An(M,j,V){var U=ye.exec(j);return U?Math.max(0,U[2]-(V||0))+(U[3]||"px"):j}function Br(M,j,V,U,le){for(var se=V===(U?"border":"content")?4:j==="width"?1:0,ee=0;se<4;se+=2)V==="margin"&&(ee+=g.css(M,V+Ne[se],!0,le)),U?(V==="content"&&(ee-=g.css(M,"padding"+Ne[se],!0,le)),V!=="margin"&&(ee-=g.css(M,"border"+Ne[se]+"Width",!0,le))):(ee+=g.css(M,"padding"+Ne[se],!0,le),V!=="padding"&&(ee+=g.css(M,"border"+Ne[se]+"Width",!0,le)));return ee}function Ln(M,j,V){var U=!0,le=j==="width"?M.offsetWidth:M.offsetHeight,se=Lt(M),ee=g.css(M,"boxSizing",!1,se)==="border-box";if(le<=0||le==null){if(le=el(M,j,se),(le<0||le==null)&&(le=M.style[j]),Ct.test(le))return le;U=ee&&(p.boxSizingReliable()||le===M.style[j]),le=parseFloat(le)||0}return le+Br(M,j,V||(ee?"border":"content"),U,se)+"px"}function ri(M,j){for(var V,U,le,se=[],ee=0,de=M.length;ee<de;ee++)U=M[ee],!!U.style&&(se[ee]=Q.get(U,"olddisplay"),V=U.style.display,j?(!se[ee]&&V==="none"&&(U.style.display=""),U.style.display===""&&xe(U)&&(se[ee]=Q.access(U,"olddisplay",We(U.nodeName)))):(le=xe(U),(V!=="none"||!le)&&Q.set(U,"olddisplay",le?V:g.css(U,"display"))));for(ee=0;ee<de;ee++)U=M[ee],!!U.style&&(!j||U.style.display==="none"||U.style.display==="")&&(U.style.display=j?se[ee]||"":"none");return M}g.extend({cssHooks:{opacity:{get:function(M,j){if(j){var V=el(M,"opacity");return V===""?"1":V}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(M,j,V,U){if(!(!M||M.nodeType===3||M.nodeType===8||!M.style)){var le,se,ee,de=g.camelCase(j),J=M.style;if(j=g.cssProps[de]||(g.cssProps[de]=Dn(de)||de),ee=g.cssHooks[j]||g.cssHooks[de],V!==void 0){if(se=typeof V,se==="string"&&(le=ye.exec(V))&&le[1]&&(V=et(M,j,le),se="number"),V==null||V!==V)return;se==="number"&&(V+=le&&le[3]||(g.cssNumber[de]?"":"px")),!p.clearCloneStyle&&V===""&&j.indexOf("background")===0&&(J[j]="inherit"),(!ee||!("set"in ee)||(V=ee.set(M,V,U))!==void 0)&&(J[j]=V)}else return ee&&"get"in ee&&(le=ee.get(M,!1,U))!==void 0?le:J[j]}},css:function(M,j,V,U){var le,se,ee,de=g.camelCase(j);return j=g.cssProps[de]||(g.cssProps[de]=Dn(de)||de),ee=g.cssHooks[j]||g.cssHooks[de],ee&&"get"in ee&&(le=ee.get(M,!0,V)),le===void 0&&(le=el(M,j,U)),le==="normal"&&j in hn&&(le=hn[j]),V===""||V?(se=parseFloat(le),V===!0||isFinite(se)?se||0:le):le}}),g.each(["height","width"],function(M,j){g.cssHooks[j]={get:function(V,U,le){if(U)return Vl.test(g.css(V,"display"))&&V.offsetWidth===0?Dt(V,lr,function(){return Ln(V,j,le)}):Ln(V,j,le)},set:function(V,U,le){var se,ee=le&&Lt(V),de=le&&Br(V,j,le,g.css(V,"boxSizing",!1,ee)==="border-box",ee);return de&&(se=ye.exec(U))&&(se[3]||"px")!=="px"&&(V.style[j]=U,U=g.css(V,j)),An(V,U,de)}}}),g.cssHooks.marginLeft=Al(p.reliableMarginLeft,function(M,j){if(j)return(parseFloat(el(M,"marginLeft"))||M.getBoundingClientRect().left-Dt(M,{marginLeft:0},function(){return M.getBoundingClientRect().left}))+"px"}),g.cssHooks.marginRight=Al(p.reliableMarginRight,function(M,j){if(j)return Dt(M,{display:"inline-block"},el,[M,"marginRight"])}),g.each({margin:"",padding:"",border:"Width"},function(M,j){g.cssHooks[M+j]={expand:function(V){for(var U=0,le={},se=typeof V=="string"?V.split(" "):[V];U<4;U++)le[M+Ne[U]+j]=se[U]||se[U-2]||se[0];return le}},ht.test(M)||(g.cssHooks[M+j].set=An)}),g.fn.extend({css:function(M,j){return pe(this,function(V,U,le){var se,ee,de={},J=0;if(g.isArray(U)){for(se=Lt(V),ee=U.length;J<ee;J++)de[U[J]]=g.css(V,U[J],!1,se);return de}return le!==void 0?g.style(V,U,le):g.css(V,U)},M,j,arguments.length>1)},show:function(){return ri(this,!0)},hide:function(){return ri(this)},toggle:function(M){return typeof M=="boolean"?M?this.show():this.hide():this.each(function(){xe(this)?g(this).show():g(this).hide()})}});function dn(M,j,V,U,le){return new dn.prototype.init(M,j,V,U,le)}g.Tween=dn,dn.prototype={constructor:dn,init:function(M,j,V,U,le,se){this.elem=M,this.prop=V,this.easing=le||g.easing._default,this.options=j,this.start=this.now=this.cur(),this.end=U,this.unit=se||(g.cssNumber[V]?"":"px")},cur:function(){var M=dn.propHooks[this.prop];return M&&M.get?M.get(this):dn.propHooks._default.get(this)},run:function(M){var j,V=dn.propHooks[this.prop];return this.options.duration?this.pos=j=g.easing[this.easing](M,this.options.duration*M,0,1,this.options.duration):this.pos=j=M,this.now=(this.end-this.start)*j+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),V&&V.set?V.set(this):dn.propHooks._default.set(this),this}},dn.prototype.init.prototype=dn.prototype,dn.propHooks={_default:{get:function(M){var j;return M.elem.nodeType!==1||M.elem[M.prop]!=null&&M.elem.style[M.prop]==null?M.elem[M.prop]:(j=g.css(M.elem,M.prop,""),!j||j==="auto"?0:j)},set:function(M){g.fx.step[M.prop]?g.fx.step[M.prop](M):M.elem.nodeType===1&&(M.elem.style[g.cssProps[M.prop]]!=null||g.cssHooks[M.prop])?g.style(M.elem,M.prop,M.now+M.unit):M.elem[M.prop]=M.now}}},dn.propHooks.scrollTop=dn.propHooks.scrollLeft={set:function(M){M.elem.nodeType&&M.elem.parentNode&&(M.elem[M.prop]=M.now)}},g.easing={linear:function(M){return M},swing:function(M){return .5-Math.cos(M*Math.PI)/2},_default:"swing"},g.fx=dn.prototype.init,g.fx.step={};var zn,Hn,$n=/^(?:toggle|show|hide)$/,di=/queueHooks$/;function qt(){return e.setTimeout(function(){zn=void 0}),zn=g.now()}function ul(M,j){var V,U=0,le={height:M};for(j=j?1:0;U<4;U+=2-j)V=Ne[U],le["margin"+V]=le["padding"+V]=M;return j&&(le.opacity=le.width=M),le}function Sl(M,j,V){for(var U,le=(Fr.tweeners[j]||[]).concat(Fr.tweeners["*"]),se=0,ee=le.length;se<ee;se++)if(U=le[se].call(V,j,M))return U}function Gr(M,j,V){var U,le,se,ee,de,J,He,Ae,lt=this,vt={},bt=M.style,dl=M.nodeType&&xe(M),Jt=Q.get(M,"fxshow");V.queue||(de=g._queueHooks(M,"fx"),de.unqueued==null&&(de.unqueued=0,J=de.empty.fire,de.empty.fire=function(){de.unqueued||J()}),de.unqueued++,lt.always(function(){lt.always(function(){de.unqueued--,g.queue(M,"fx").length||de.empty.fire()})})),M.nodeType===1&&("height"in j||"width"in j)&&(V.overflow=[bt.overflow,bt.overflowX,bt.overflowY],He=g.css(M,"display"),Ae=He==="none"?Q.get(M,"olddisplay")||We(M.nodeName):He,Ae==="inline"&&g.css(M,"float")==="none"&&(bt.display="inline-block")),V.overflow&&(bt.overflow="hidden",lt.always(function(){bt.overflow=V.overflow[0],bt.overflowX=V.overflow[1],bt.overflowY=V.overflow[2]}));for(U in j)if(le=j[U],$n.exec(le)){if(delete j[U],se=se||le==="toggle",le===(dl?"hide":"show"))if(le==="show"&&Jt&&Jt[U]!==void 0)dl=!0;else continue;vt[U]=Jt&&Jt[U]||g.style(M,U)}else He=void 0;if(g.isEmptyObject(vt))(He==="none"?We(M.nodeName):He)==="inline"&&(bt.display=He);else{Jt?"hidden"in Jt&&(dl=Jt.hidden):Jt=Q.access(M,"fxshow",{}),se&&(Jt.hidden=!dl),dl?g(M).show():lt.done(function(){g(M).hide()}),lt.done(function(){var Cl;Q.remove(M,"fxshow");for(Cl in vt)g.style(M,Cl,vt[Cl])});for(U in vt)ee=Sl(dl?Jt[U]:0,U,lt),U in Jt||(Jt[U]=ee.start,dl&&(ee.end=ee.start,ee.start=U==="width"||U==="height"?1:0))}}function br(M,j){var V,U,le,se,ee;for(V in M)if(U=g.camelCase(V),le=j[U],se=M[V],g.isArray(se)&&(le=se[1],se=M[V]=se[0]),V!==U&&(M[U]=se,delete M[V]),ee=g.cssHooks[U],ee&&"expand"in ee){se=ee.expand(se),delete M[U];for(V in se)V in M||(M[V]=se[V],j[V]=le)}else j[U]=le}function Fr(M,j,V){var U,le,se=0,ee=Fr.prefilters.length,de=g.Deferred().always(function(){delete J.elem}),J=function(){if(le)return!1;for(var lt=zn||qt(),vt=Math.max(0,He.startTime+He.duration-lt),bt=vt/He.duration||0,dl=1-bt,Jt=0,Cl=He.tweens.length;Jt<Cl;Jt++)He.tweens[Jt].run(dl);return de.notifyWith(M,[He,dl,vt]),dl<1&&Cl?vt:(de.resolveWith(M,[He]),!1)},He=de.promise({elem:M,props:g.extend({},j),opts:g.extend(!0,{specialEasing:{},easing:g.easing._default},V),originalProperties:j,originalOptions:V,startTime:zn||qt(),duration:V.duration,tweens:[],createTween:function(lt,vt){var bt=g.Tween(M,He.opts,lt,vt,He.opts.specialEasing[lt]||He.opts.easing);return He.tweens.push(bt),bt},stop:function(lt){var vt=0,bt=lt?He.tweens.length:0;if(le)return this;for(le=!0;vt<bt;vt++)He.tweens[vt].run(1);return lt?(de.notifyWith(M,[He,1,0]),de.resolveWith(M,[He,lt])):de.rejectWith(M,[He,lt]),this}}),Ae=He.props;for(br(Ae,He.opts.specialEasing);se<ee;se++)if(U=Fr.prefilters[se].call(He,M,Ae,He.opts),U)return g.isFunction(U.stop)&&(g._queueHooks(He.elem,He.opts.queue).stop=g.proxy(U.stop,U)),U;return g.map(Ae,Sl,He),g.isFunction(He.opts.start)&&He.opts.start.call(M,He),g.fx.timer(g.extend(J,{elem:M,anim:He,queue:He.opts.queue})),He.progress(He.opts.progress).done(He.opts.done,He.opts.complete).fail(He.opts.fail).always(He.opts.always)}g.Animation=g.extend(Fr,{tweeners:{"*":[function(M,j){var V=this.createTween(M,j);return et(V.elem,M,ye.exec(j),V),V}]},tweener:function(M,j){g.isFunction(M)?(j=M,M=["*"]):M=M.match(W);for(var V,U=0,le=M.length;U<le;U++)V=M[U],Fr.tweeners[V]=Fr.tweeners[V]||[],Fr.tweeners[V].unshift(j)},prefilters:[Gr],prefilter:function(M,j){j?Fr.prefilters.unshift(M):Fr.prefilters.push(M)}}),g.speed=function(M,j,V){var U=M&&typeof M=="object"?g.extend({},M):{complete:V||!V&&j||g.isFunction(M)&&M,duration:M,easing:V&&j||j&&!g.isFunction(j)&&j};return U.duration=g.fx.off?0:typeof U.duration=="number"?U.duration:U.duration in g.fx.speeds?g.fx.speeds[U.duration]:g.fx.speeds._default,(U.queue==null||U.queue===!0)&&(U.queue="fx"),U.old=U.complete,U.complete=function(){g.isFunction(U.old)&&U.old.call(this),U.queue&&g.dequeue(this,U.queue)},U},g.fn.extend({fadeTo:function(M,j,V,U){return this.filter(xe).css("opacity",0).show().end().animate({opacity:j},M,V,U)},animate:function(M,j,V,U){var le=g.isEmptyObject(M),se=g.speed(j,V,U),ee=function(){var de=Fr(this,g.extend({},M),se);(le||Q.get(this,"finish"))&&de.stop(!0)};return ee.finish=ee,le||se.queue===!1?this.each(ee):this.queue(se.queue,ee)},stop:function(M,j,V){var U=function(le){var se=le.stop;delete le.stop,se(V)};return typeof M!="string"&&(V=j,j=M,M=void 0),j&&M!==!1&&this.queue(M||"fx",[]),this.each(function(){var le=!0,se=M!=null&&M+"queueHooks",ee=g.timers,de=Q.get(this);if(se)de[se]&&de[se].stop&&U(de[se]);else for(se in de)de[se]&&de[se].stop&&di.test(se)&&U(de[se]);for(se=ee.length;se--;)ee[se].elem===this&&(M==null||ee[se].queue===M)&&(ee[se].anim.stop(V),le=!1,ee.splice(se,1));(le||!V)&&g.dequeue(this,M)})},finish:function(M){return M!==!1&&(M=M||"fx"),this.each(function(){var j,V=Q.get(this),U=V[M+"queue"],le=V[M+"queueHooks"],se=g.timers,ee=U?U.length:0;for(V.finish=!0,g.queue(this,M,[]),le&&le.stop&&le.stop.call(this,!0),j=se.length;j--;)se[j].elem===this&&se[j].queue===M&&(se[j].anim.stop(!0),se.splice(j,1));for(j=0;j<ee;j++)U[j]&&U[j].finish&&U[j].finish.call(this);delete V.finish})}}),g.each(["toggle","show","hide"],function(M,j){var V=g.fn[j];g.fn[j]=function(U,le,se){return U==null||typeof U=="boolean"?V.apply(this,arguments):this.animate(ul(j,!0),U,le,se)}}),g.each({slideDown:ul("show"),slideUp:ul("hide"),slideToggle:ul("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(M,j){g.fn[M]=function(V,U,le){return this.animate(j,V,U,le)}}),g.timers=[],g.fx.tick=function(){var M,j=0,V=g.timers;for(zn=g.now();j<V.length;j++)M=V[j],!M()&&V[j]===M&&V.splice(j--,1);V.length||g.fx.stop(),zn=void 0},g.fx.timer=function(M){g.timers.push(M),M()?g.fx.start():g.timers.pop()},g.fx.interval=13,g.fx.start=function(){Hn||(Hn=e.setInterval(g.fx.tick,g.fx.interval))},g.fx.stop=function(){e.clearInterval(Hn),Hn=null},g.fx.speeds={slow:600,fast:200,_default:400},g.fn.delay=function(M,j){return M=g.fx&&g.fx.speeds[M]||M,j=j||"fx",this.queue(j,function(V,U){var le=e.setTimeout(V,M);U.stop=function(){e.clearTimeout(le)}})},function(){var M=l.createElement("input"),j=l.createElement("select"),V=j.appendChild(l.createElement("option"));M.type="checkbox",p.checkOn=M.value!=="",p.optSelected=V.selected,j.disabled=!0,p.optDisabled=!V.disabled,M=l.createElement("input"),M.value="t",M.type="radio",p.radioValue=M.value==="t"}();var Wl,ni=g.expr.attrHandle;g.fn.extend({attr:function(M,j){return pe(this,g.attr,M,j,arguments.length>1)},removeAttr:function(M){return this.each(function(){g.removeAttr(this,M)})}}),g.extend({attr:function(M,j,V){var U,le,se=M.nodeType;if(!(se===3||se===8||se===2)){if(typeof M.getAttribute=="undefined")return g.prop(M,j,V);if((se!==1||!g.isXMLDoc(M))&&(j=j.toLowerCase(),le=g.attrHooks[j]||(g.expr.match.bool.test(j)?Wl:void 0)),V!==void 0){if(V===null){g.removeAttr(M,j);return}return le&&"set"in le&&(U=le.set(M,V,j))!==void 0?U:(M.setAttribute(j,V+""),V)}return le&&"get"in le&&(U=le.get(M,j))!==null?U:(U=g.find.attr(M,j),U??void 0)}},attrHooks:{type:{set:function(M,j){if(!p.radioValue&&j==="radio"&&g.nodeName(M,"input")){var V=M.value;return M.setAttribute("type",j),V&&(M.value=V),j}}}},removeAttr:function(M,j){var V,U,le=0,se=j&&j.match(W);if(se&&M.nodeType===1)for(;V=se[le++];)U=g.propFix[V]||V,g.expr.match.bool.test(V)&&(M[U]=!1),M.removeAttribute(V)}}),Wl={set:function(M,j,V){return j===!1?g.removeAttr(M,V):M.setAttribute(V,V),V}},g.each(g.expr.match.bool.source.match(/\w+/g),function(M,j){var V=ni[j]||g.find.attr;ni[j]=function(U,le,se){var ee,de;return se||(de=ni[le],ni[le]=ee,ee=V(U,le,se)!=null?le.toLowerCase():null,ni[le]=de),ee}});var no=/^(?:input|select|textarea|button)$/i,Ta=/^(?:a|area)$/i;g.fn.extend({prop:function(M,j){return pe(this,g.prop,M,j,arguments.length>1)},removeProp:function(M){return this.each(function(){delete this[g.propFix[M]||M]})}}),g.extend({prop:function(M,j,V){var U,le,se=M.nodeType;if(!(se===3||se===8||se===2))return(se!==1||!g.isXMLDoc(M))&&(j=g.propFix[j]||j,le=g.propHooks[j]),V!==void 0?le&&"set"in le&&(U=le.set(M,V,j))!==void 0?U:M[j]=V:le&&"get"in le&&(U=le.get(M,j))!==null?U:M[j]},propHooks:{tabIndex:{get:function(M){var j=g.find.attr(M,"tabindex");return j?parseInt(j,10):no.test(M.nodeName)||Ta.test(M.nodeName)&&M.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),p.optSelected||(g.propHooks.selected={get:function(M){var j=M.parentNode;return j&&j.parentNode&&j.parentNode.selectedIndex,null},set:function(M){var j=M.parentNode;j&&(j.selectedIndex,j.parentNode&&j.parentNode.selectedIndex)}}),g.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){g.propFix[this.toLowerCase()]=this});var ji=/[\t\r\n\f]/g;function ii(M){return M.getAttribute&&M.getAttribute("class")||""}g.fn.extend({addClass:function(M){var j,V,U,le,se,ee,de,J=0;if(g.isFunction(M))return this.each(function(He){g(this).addClass(M.call(this,He,ii(this)))});if(typeof M=="string"&&M){for(j=M.match(W)||[];V=this[J++];)if(le=ii(V),U=V.nodeType===1&&(" "+le+" ").replace(ji," "),U){for(ee=0;se=j[ee++];)U.indexOf(" "+se+" ")<0&&(U+=se+" ");de=g.trim(U),le!==de&&V.setAttribute("class",de)}}return this},removeClass:function(M){var j,V,U,le,se,ee,de,J=0;if(g.isFunction(M))return this.each(function(He){g(this).removeClass(M.call(this,He,ii(this)))});if(!arguments.length)return this.attr("class","");if(typeof M=="string"&&M){for(j=M.match(W)||[];V=this[J++];)if(le=ii(V),U=V.nodeType===1&&(" "+le+" ").replace(ji," "),U){for(ee=0;se=j[ee++];)for(;U.indexOf(" "+se+" ")>-1;)U=U.replace(" "+se+" "," ");de=g.trim(U),le!==de&&V.setAttribute("class",de)}}return this},toggleClass:function(M,j){var V=typeof M;return typeof j=="boolean"&&V==="string"?j?this.addClass(M):this.removeClass(M):g.isFunction(M)?this.each(function(U){g(this).toggleClass(M.call(this,U,ii(this),j),j)}):this.each(function(){var U,le,se,ee;if(V==="string")for(le=0,se=g(this),ee=M.match(W)||[];U=ee[le++];)se.hasClass(U)?se.removeClass(U):se.addClass(U);else(M===void 0||V==="boolean")&&(U=ii(this),U&&Q.set(this,"__className__",U),this.setAttribute&&this.setAttribute("class",U||M===!1?"":Q.get(this,"__className__")||""))})},hasClass:function(M){var j,V,U=0;for(j=" "+M+" ";V=this[U++];)if(V.nodeType===1&&(" "+ii(V)+" ").replace(ji," ").indexOf(j)>-1)return!0;return!1}});var Bi=/\r/g,As=/[\x20\t\r\n\f]+/g;g.fn.extend({val:function(M){var j,V,U,le=this[0];return arguments.length?(U=g.isFunction(M),this.each(function(se){var ee;this.nodeType===1&&(U?ee=M.call(this,se,g(this).val()):ee=M,ee==null?ee="":typeof ee=="number"?ee+="":g.isArray(ee)&&(ee=g.map(ee,function(de){return de==null?"":de+""})),j=g.valHooks[this.type]||g.valHooks[this.nodeName.toLowerCase()],(!j||!("set"in j)||j.set(this,ee,"value")===void 0)&&(this.value=ee))})):le?(j=g.valHooks[le.type]||g.valHooks[le.nodeName.toLowerCase()],j&&"get"in j&&(V=j.get(le,"value"))!==void 0?V:(V=le.value,typeof V=="string"?V.replace(Bi,""):V??"")):void 0}}),g.extend({valHooks:{option:{get:function(M){var j=g.find.attr(M,"value");return j??g.trim(g.text(M)).replace(As," ")}},select:{get:function(M){for(var j,V,U=M.options,le=M.selectedIndex,se=M.type==="select-one"||le<0,ee=se?null:[],de=se?le+1:U.length,J=le<0?de:se?le:0;J<de;J++)if(V=U[J],(V.selected||J===le)&&(p.optDisabled?!V.disabled:V.getAttribute("disabled")===null)&&(!V.parentNode.disabled||!g.nodeName(V.parentNode,"optgroup"))){if(j=g(V).val(),se)return j;ee.push(j)}return ee},set:function(M,j){for(var V,U,le=M.options,se=g.makeArray(j),ee=le.length;ee--;)U=le[ee],(U.selected=g.inArray(g.valHooks.option.get(U),se)>-1)&&(V=!0);return V||(M.selectedIndex=-1),se}}}}),g.each(["radio","checkbox"],function(){g.valHooks[this]={set:function(M,j){if(g.isArray(j))return M.checked=g.inArray(g(M).val(),j)>-1}},p.checkOn||(g.valHooks[this].get=function(M){return M.getAttribute("value")===null?"on":M.value})});var zs=/^(?:focusinfocus|focusoutblur)$/;g.extend(g.event,{trigger:function(M,j,V,U){var le,se,ee,de,J,He,Ae,lt=[V||l],vt=d.call(M,"type")?M.type:M,bt=d.call(M,"namespace")?M.namespace.split("."):[];if(se=ee=V=V||l,!(V.nodeType===3||V.nodeType===8)&&!zs.test(vt+g.event.triggered)&&(vt.indexOf(".")>-1&&(bt=vt.split("."),vt=bt.shift(),bt.sort()),J=vt.indexOf(":")<0&&"on"+vt,M=M[g.expando]?M:new g.Event(vt,typeof M=="object"&&M),M.isTrigger=U?2:3,M.namespace=bt.join("."),M.rnamespace=M.namespace?new RegExp("(^|\\.)"+bt.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,M.result=void 0,M.target||(M.target=V),j=j==null?[M]:g.makeArray(j,[M]),Ae=g.event.special[vt]||{},!(!U&&Ae.trigger&&Ae.trigger.apply(V,j)===!1))){if(!U&&!Ae.noBubble&&!g.isWindow(V)){for(de=Ae.delegateType||vt,zs.test(de+vt)||(se=se.parentNode);se;se=se.parentNode)lt.push(se),ee=se;ee===(V.ownerDocument||l)&&lt.push(ee.defaultView||ee.parentWindow||e)}for(le=0;(se=lt[le++])&&!M.isPropagationStopped();)M.type=le>1?de:Ae.bindType||vt,He=(Q.get(se,"events")||{})[M.type]&&Q.get(se,"handle"),He&&He.apply(se,j),He=J&&se[J],He&&He.apply&&ne(se)&&(M.result=He.apply(se,j),M.result===!1&&M.preventDefault());return M.type=vt,!U&&!M.isDefaultPrevented()&&(!Ae._default||Ae._default.apply(lt.pop(),j)===!1)&&ne(V)&&J&&g.isFunction(V[vt])&&!g.isWindow(V)&&(ee=V[J],ee&&(V[J]=null),g.event.triggered=vt,V[vt](),g.event.triggered=void 0,ee&&(V[J]=ee)),M.result}},simulate:function(M,j,V){var U=g.extend(new g.Event,V,{type:M,isSimulated:!0});g.event.trigger(U,null,j)}}),g.fn.extend({trigger:function(M,j){return this.each(function(){g.event.trigger(M,j,this)})},triggerHandler:function(M,j){var V=this[0];if(V)return g.event.trigger(M,j,V,!0)}}),g.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(M,j){g.fn[j]=function(V,U){return arguments.length>0?this.on(j,null,V,U):this.trigger(j)}}),g.fn.extend({hover:function(M,j){return this.mouseenter(M).mouseleave(j||M)}}),p.focusin="onfocusin"in e,p.focusin||g.each({focus:"focusin",blur:"focusout"},function(M,j){var V=function(U){g.event.simulate(j,U.target,g.event.fix(U))};g.event.special[j]={setup:function(){var U=this.ownerDocument||this,le=Q.access(U,j);le||U.addEventListener(M,V,!0),Q.access(U,j,(le||0)+1)},teardown:function(){var U=this.ownerDocument||this,le=Q.access(U,j)-1;le?Q.access(U,j,le):(U.removeEventListener(M,V,!0),Q.remove(U,j))}}});var io=e.location,yo=g.now(),No=/\?/;g.parseJSON=function(M){return JSON.parse(M+"")},g.parseXML=function(M){var j;if(!M||typeof M!="string")return null;try{j=new e.DOMParser().parseFromString(M,"text/xml")}catch(V){j=void 0}return(!j||j.getElementsByTagName("parsererror").length)&&g.error("Invalid XML: "+M),j};var os=/#.*$/,oa=/([?&])_=[^&]*/,as=/^(.*?):[ \t]*([^\r\n]*)$/mg,pc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Os=/^(?:GET|HEAD)$/,Ps=/^\/\//,ko={},aa={},Es="*/".concat("*"),Ra=l.createElement("a");Ra.href=io.href;function Fa(M){return function(j,V){typeof j!="string"&&(V=j,j="*");var U,le=0,se=j.toLowerCase().match(W)||[];if(g.isFunction(V))for(;U=se[le++];)U[0]==="+"?(U=U.slice(1)||"*",(M[U]=M[U]||[]).unshift(V)):(M[U]=M[U]||[]).push(V)}}function Ns(M,j,V,U){var le={},se=M===aa;function ee(de){var J;return le[de]=!0,g.each(M[de]||[],function(He,Ae){var lt=Ae(j,V,U);if(typeof lt=="string"&&!se&&!le[lt])return j.dataTypes.unshift(lt),ee(lt),!1;if(se)return!(J=lt)}),J}return ee(j.dataTypes[0])||!le["*"]&&ee("*")}function Ma(M,j){var V,U,le=g.ajaxSettings.flatOptions||{};for(V in j)j[V]!==void 0&&((le[V]?M:U||(U={}))[V]=j[V]);return U&&g.extend(!0,M,U),M}function vu(M,j,V){for(var U,le,se,ee,de=M.contents,J=M.dataTypes;J[0]==="*";)J.shift(),U===void 0&&(U=M.mimeType||j.getResponseHeader("Content-Type"));if(U){for(le in de)if(de[le]&&de[le].test(U)){J.unshift(le);break}}if(J[0]in V)se=J[0];else{for(le in V){if(!J[0]||M.converters[le+" "+J[0]]){se=le;break}ee||(ee=le)}se=se||ee}if(se)return se!==J[0]&&J.unshift(se),V[se]}function yu(M,j,V,U){var le,se,ee,de,J,He={},Ae=M.dataTypes.slice();if(Ae[1])for(ee in M.converters)He[ee.toLowerCase()]=M.converters[ee];for(se=Ae.shift();se;)if(M.responseFields[se]&&(V[M.responseFields[se]]=j),!J&&U&&M.dataFilter&&(j=M.dataFilter(j,M.dataType)),J=se,se=Ae.shift(),se){if(se==="*")se=J;else if(J!=="*"&&J!==se){if(ee=He[J+" "+se]||He["* "+se],!ee){for(le in He)if(de=le.split(" "),de[1]===se&&(ee=He[J+" "+de[0]]||He["* "+de[0]],ee)){ee===!0?ee=He[le]:He[le]!==!0&&(se=de[0],Ae.unshift(de[1]));break}}if(ee!==!0)if(ee&&M.throws)j=ee(j);else try{j=ee(j)}catch(lt){return{state:"parsererror",error:ee?lt:"No conversion from "+J+" to "+se}}}}return{state:"success",data:j}}g.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:io.href,type:"GET",isLocal:pc.test(io.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Es,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":g.parseJSON,"text xml":g.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(M,j){return j?Ma(Ma(M,g.ajaxSettings),j):Ma(g.ajaxSettings,M)},ajaxPrefilter:Fa(ko),ajaxTransport:Fa(aa),ajax:function(M,j){typeof M=="object"&&(j=M,M=void 0),j=j||{};var V,U,le,se,ee,de,J,He,Ae=g.ajaxSetup({},j),lt=Ae.context||Ae,vt=Ae.context&&(lt.nodeType||lt.jquery)?g(lt):g.event,bt=g.Deferred(),dl=g.Callbacks("once memory"),Jt=Ae.statusCode||{},Cl={},Rl={},Pr=0,fl="canceled",Wt={readyState:0,getResponseHeader:function(Fl){var Ir;if(Pr===2){if(!se)for(se={};Ir=as.exec(le);)se[Ir[1].toLowerCase()]=Ir[2];Ir=se[Fl.toLowerCase()]}return Ir??null},getAllResponseHeaders:function(){return Pr===2?le:null},setRequestHeader:function(Fl,Ir){var oi=Fl.toLowerCase();return Pr||(Fl=Rl[oi]=Rl[oi]||Fl,Cl[Fl]=Ir),this},overrideMimeType:function(Fl){return Pr||(Ae.mimeType=Fl),this},statusCode:function(Fl){var Ir;if(Fl)if(Pr<2)for(Ir in Fl)Jt[Ir]=[Jt[Ir],Fl[Ir]];else Wt.always(Fl[Wt.status]);return this},abort:function(Fl){var Ir=Fl||fl;return V&&V.abort(Ir),ar(0,Ir),this}};if(bt.promise(Wt).complete=dl.add,Wt.success=Wt.done,Wt.error=Wt.fail,Ae.url=((M||Ae.url||io.href)+"").replace(os,"").replace(Ps,io.protocol+"//"),Ae.type=j.method||j.type||Ae.method||Ae.type,Ae.dataTypes=g.trim(Ae.dataType||"*").toLowerCase().match(W)||[""],Ae.crossDomain==null){de=l.createElement("a");try{de.href=Ae.url,de.href=de.href,Ae.crossDomain=Ra.protocol+"//"+Ra.host!=de.protocol+"//"+de.host}catch(Fl){Ae.crossDomain=!0}}if(Ae.data&&Ae.processData&&typeof Ae.data!="string"&&(Ae.data=g.param(Ae.data,Ae.traditional)),Ns(ko,Ae,j,Wt),Pr===2)return Wt;J=g.event&&Ae.global,J&&g.active++==0&&g.event.trigger("ajaxStart"),Ae.type=Ae.type.toUpperCase(),Ae.hasContent=!Os.test(Ae.type),U=Ae.url,Ae.hasContent||(Ae.data&&(U=Ae.url+=(No.test(U)?"&":"?")+Ae.data,delete Ae.data),Ae.cache===!1&&(Ae.url=oa.test(U)?U.replace(oa,"$1_="+yo++):U+(No.test(U)?"&":"?")+"_="+yo++)),Ae.ifModified&&(g.lastModified[U]&&Wt.setRequestHeader("If-Modified-Since",g.lastModified[U]),g.etag[U]&&Wt.setRequestHeader("If-None-Match",g.etag[U])),(Ae.data&&Ae.hasContent&&Ae.contentType!==!1||j.contentType)&&Wt.setRequestHeader("Content-Type",Ae.contentType),Wt.setRequestHeader("Accept",Ae.dataTypes[0]&&Ae.accepts[Ae.dataTypes[0]]?Ae.accepts[Ae.dataTypes[0]]+(Ae.dataTypes[0]!=="*"?", "+Es+"; q=0.01":""):Ae.accepts["*"]);for(He in Ae.headers)Wt.setRequestHeader(He,Ae.headers[He]);if(Ae.beforeSend&&(Ae.beforeSend.call(lt,Wt,Ae)===!1||Pr===2))return Wt.abort();fl="abort";for(He in{success:1,error:1,complete:1})Wt[He](Ae[He]);if(V=Ns(aa,Ae,j,Wt),!V)ar(-1,"No Transport");else{if(Wt.readyState=1,J&&vt.trigger("ajaxSend",[Wt,Ae]),Pr===2)return Wt;Ae.async&&Ae.timeout>0&&(ee=e.setTimeout(function(){Wt.abort("timeout")},Ae.timeout));try{Pr=1,V.send(Cl,ar)}catch(Fl){if(Pr<2)ar(-1,Fl);else throw Fl}}function ar(Fl,Ir,oi,Un){var yr,Yr,wr,Xr,rn,pr=Ir;Pr!==2&&(Pr=2,ee&&e.clearTimeout(ee),V=void 0,le=Un||"",Wt.readyState=Fl>0?4:0,yr=Fl>=200&&Fl<300||Fl===304,oi&&(Xr=vu(Ae,Wt,oi)),Xr=yu(Ae,Xr,Wt,yr),yr?(Ae.ifModified&&(rn=Wt.getResponseHeader("Last-Modified"),rn&&(g.lastModified[U]=rn),rn=Wt.getResponseHeader("etag"),rn&&(g.etag[U]=rn)),Fl===204||Ae.type==="HEAD"?pr="nocontent":Fl===304?pr="notmodified":(pr=Xr.state,Yr=Xr.data,wr=Xr.error,yr=!wr)):(wr=pr,(Fl||!pr)&&(pr="error",Fl<0&&(Fl=0))),Wt.status=Fl,Wt.statusText=(Ir||pr)+"",yr?bt.resolveWith(lt,[Yr,pr,Wt]):bt.rejectWith(lt,[Wt,pr,wr]),Wt.statusCode(Jt),Jt=void 0,J&&vt.trigger(yr?"ajaxSuccess":"ajaxError",[Wt,Ae,yr?Yr:wr]),dl.fireWith(lt,[Wt,pr]),J&&(vt.trigger("ajaxComplete",[Wt,Ae]),--g.active||g.event.trigger("ajaxStop")))}return Wt},getJSON:function(M,j,V){return g.get(M,j,V,"json")},getScript:function(M,j){return g.get(M,void 0,j,"script")}}),g.each(["get","post"],function(M,j){g[j]=function(V,U,le,se){return g.isFunction(U)&&(se=se||le,le=U,U=void 0),g.ajax(g.extend({url:V,type:j,dataType:se,data:U,success:le},g.isPlainObject(V)&&V))}}),g._evalUrl=function(M){return g.ajax({url:M,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},g.fn.extend({wrapAll:function(M){var j;return g.isFunction(M)?this.each(function(V){g(this).wrapAll(M.call(this,V))}):(this[0]&&(j=g(M,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&j.insertBefore(this[0]),j.map(function(){for(var V=this;V.firstElementChild;)V=V.firstElementChild;return V}).append(this)),this)},wrapInner:function(M){return g.isFunction(M)?this.each(function(j){g(this).wrapInner(M.call(this,j))}):this.each(function(){var j=g(this),V=j.contents();V.length?V.wrapAll(M):j.append(M)})},wrap:function(M){var j=g.isFunction(M);return this.each(function(V){g(this).wrapAll(j?M.call(this,V):M)})},unwrap:function(){return this.parent().each(function(){g.nodeName(this,"body")||g(this).replaceWith(this.childNodes)}).end()}}),g.expr.filters.hidden=function(M){return!g.expr.filters.visible(M)},g.expr.filters.visible=function(M){return M.offsetWidth>0||M.offsetHeight>0||M.getClientRects().length>0};var vc=/%20/g,Vr=/\[\]$/,Or=/\r?\n/g,ku=/^(?:submit|button|image|reset|file)$/i,Da=/^(?:input|select|textarea|keygen)/i;function ss(M,j,V,U){var le;if(g.isArray(j))g.each(j,function(se,ee){V||Vr.test(M)?U(M,ee):ss(M+"["+(typeof ee=="object"&&ee!=null?se:"")+"]",ee,V,U)});else if(!V&&g.type(j)==="object")for(le in j)ss(M+"["+le+"]",j[le],V,U);else U(M,j)}g.param=function(M,j){var V,U=[],le=function(se,ee){ee=g.isFunction(ee)?ee():ee??"",U[U.length]=encodeURIComponent(se)+"="+encodeURIComponent(ee)};if(j===void 0&&(j=g.ajaxSettings&&g.ajaxSettings.traditional),g.isArray(M)||M.jquery&&!g.isPlainObject(M))g.each(M,function(){le(this.name,this.value)});else for(V in M)ss(V,M[V],j,le);return U.join("&").replace(vc,"+")},g.fn.extend({serialize:function(){return g.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var M=g.prop(this,"elements");return M?g.makeArray(M):this}).filter(function(){var M=this.type;return this.name&&!g(this).is(":disabled")&&Da.test(this.nodeName)&&!ku.test(M)&&(this.checked||!Fe.test(M))}).map(function(M,j){var V=g(this).val();return V==null?null:g.isArray(V)?g.map(V,function(U){return{name:j.name,value:U.replace(Or,`\r
`)}}):{name:j.name,value:V.replace(Or,`\r
`)}}).get()}}),g.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(M){}};var mn={0:200,1223:204},Lo=g.ajaxSettings.xhr();p.cors=!!Lo&&"withCredentials"in Lo,p.ajax=Lo=!!Lo,g.ajaxTransport(function(M){var j,V;if(p.cors||Lo&&!M.crossDomain)return{send:function(U,le){var se,ee=M.xhr();if(ee.open(M.type,M.url,M.async,M.username,M.password),M.xhrFields)for(se in M.xhrFields)ee[se]=M.xhrFields[se];M.mimeType&&ee.overrideMimeType&&ee.overrideMimeType(M.mimeType),!M.crossDomain&&!U["X-Requested-With"]&&(U["X-Requested-With"]="XMLHttpRequest");for(se in U)ee.setRequestHeader(se,U[se]);j=function(de){return function(){j&&(j=V=ee.onload=ee.onerror=ee.onabort=ee.onreadystatechange=null,de==="abort"?ee.abort():de==="error"?typeof ee.status!="number"?le(0,"error"):le(ee.status,ee.statusText):le(mn[ee.status]||ee.status,ee.statusText,(ee.responseType||"text")!=="text"||typeof ee.responseText!="string"?{binary:ee.response}:{text:ee.responseText},ee.getAllResponseHeaders()))}},ee.onload=j(),V=ee.onerror=j("error"),ee.onabort!==void 0?ee.onabort=V:ee.onreadystatechange=function(){ee.readyState===4&&e.setTimeout(function(){j&&V()})},j=j("abort");try{ee.send(M.hasContent&&M.data||null)}catch(de){if(j)throw de}},abort:function(){j&&j()}}}),g.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(M){return g.globalEval(M),M}}}),g.ajaxPrefilter("script",function(M){M.cache===void 0&&(M.cache=!1),M.crossDomain&&(M.type="GET")}),g.ajaxTransport("script",function(M){if(M.crossDomain){var j,V;return{send:function(U,le){j=g("<script>").prop({charset:M.scriptCharset,src:M.url}).on("load error",V=function(se){j.remove(),V=null,se&&le(se.type==="error"?404:200,se.type)}),l.head.appendChild(j[0])},abort:function(){V&&V()}}}});var Aa=[],cs=/(=)\?(?=&|$)|\?\?/;g.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var M=Aa.pop()||g.expando+"_"+yo++;return this[M]=!0,M}}),g.ajaxPrefilter("json jsonp",function(M,j,V){var U,le,se,ee=M.jsonp!==!1&&(cs.test(M.url)?"url":typeof M.data=="string"&&(M.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&cs.test(M.data)&&"data");if(ee||M.dataTypes[0]==="jsonp")return U=M.jsonpCallback=g.isFunction(M.jsonpCallback)?M.jsonpCallback():M.jsonpCallback,ee?M[ee]=M[ee].replace(cs,"$1"+U):M.jsonp!==!1&&(M.url+=(No.test(M.url)?"&":"?")+M.jsonp+"="+U),M.converters["script json"]=function(){return se||g.error(U+" was not called"),se[0]},M.dataTypes[0]="json",le=e[U],e[U]=function(){se=arguments},V.always(function(){le===void 0?g(e).removeProp(U):e[U]=le,M[U]&&(M.jsonpCallback=j.jsonpCallback,Aa.push(U)),se&&g.isFunction(le)&&le(se[0]),se=le=void 0}),"script"}),g.parseHTML=function(M,j,V){if(!M||typeof M!="string")return null;typeof j=="boolean"&&(V=j,j=!1),j=j||l;var U=w.exec(M),le=!V&&[];return U?[j.createElement(U[1])]:(U=oe([M],j,le),le&&le.length&&g(le).remove(),g.merge([],U.childNodes))};var Ls=g.fn.load;g.fn.load=function(M,j,V){if(typeof M!="string"&&Ls)return Ls.apply(this,arguments);var U,le,se,ee=this,de=M.indexOf(" ");return de>-1&&(U=g.trim(M.slice(de)),M=M.slice(0,de)),g.isFunction(j)?(V=j,j=void 0):j&&typeof j=="object"&&(le="POST"),ee.length>0&&g.ajax({url:M,type:le||"GET",dataType:"html",data:j}).done(function(J){se=arguments,ee.html(U?g("<div>").append(g.parseHTML(J)).find(U):J)}).always(V&&function(J,He){ee.each(function(){V.apply(this,se||[J.responseText,He,J])})}),this},g.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(M,j){g.fn[j]=function(V){return this.on(j,V)}}),g.expr.filters.animated=function(M){return g.grep(g.timers,function(j){return M===j.elem}).length};function B(M){return g.isWindow(M)?M:M.nodeType===9&&M.defaultView}g.offset={setOffset:function(M,j,V){var U,le,se,ee,de,J,He,Ae=g.css(M,"position"),lt=g(M),vt={};Ae==="static"&&(M.style.position="relative"),de=lt.offset(),se=g.css(M,"top"),J=g.css(M,"left"),He=(Ae==="absolute"||Ae==="fixed")&&(se+J).indexOf("auto")>-1,He?(U=lt.position(),ee=U.top,le=U.left):(ee=parseFloat(se)||0,le=parseFloat(J)||0),g.isFunction(j)&&(j=j.call(M,V,g.extend({},de))),j.top!=null&&(vt.top=j.top-de.top+ee),j.left!=null&&(vt.left=j.left-de.left+le),"using"in j?j.using.call(M,vt):lt.css(vt)}},g.fn.extend({offset:function(M){if(arguments.length)return M===void 0?this:this.each(function(ee){g.offset.setOffset(this,M,ee)});var j,V,U=this[0],le={top:0,left:0},se=U&&U.ownerDocument;if(!!se)return j=se.documentElement,g.contains(j,U)?(le=U.getBoundingClientRect(),V=B(se),{top:le.top+V.pageYOffset-j.clientTop,left:le.left+V.pageXOffset-j.clientLeft}):le},position:function(){if(!!this[0]){var M,j,V=this[0],U={top:0,left:0};return g.css(V,"position")==="fixed"?j=V.getBoundingClientRect():(M=this.offsetParent(),j=this.offset(),g.nodeName(M[0],"html")||(U=M.offset()),U.top+=g.css(M[0],"borderTopWidth",!0),U.left+=g.css(M[0],"borderLeftWidth",!0)),{top:j.top-U.top-g.css(V,"marginTop",!0),left:j.left-U.left-g.css(V,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var M=this.offsetParent;M&&g.css(M,"position")==="static";)M=M.offsetParent;return M||ol})}}),g.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(M,j){var V=j==="pageYOffset";g.fn[M]=function(U){return pe(this,function(le,se,ee){var de=B(le);if(ee===void 0)return de?de[j]:le[se];de?de.scrollTo(V?de.pageXOffset:ee,V?ee:de.pageYOffset):le[se]=ee},M,U,arguments.length)}}),g.each(["top","left"],function(M,j){g.cssHooks[j]=Al(p.pixelPosition,function(V,U){if(U)return U=el(V,j),Ct.test(U)?g(V).position()[j]+"px":U})}),g.each({Height:"height",Width:"width"},function(M,j){g.each({padding:"inner"+M,content:j,"":"outer"+M},function(V,U){g.fn[U]=function(le,se){var ee=arguments.length&&(V||typeof le!="boolean"),de=V||(le===!0||se===!0?"margin":"border");return pe(this,function(J,He,Ae){var lt;return g.isWindow(J)?J.document.documentElement["client"+M]:J.nodeType===9?(lt=J.documentElement,Math.max(J.body["scroll"+M],lt["scroll"+M],J.body["offset"+M],lt["offset"+M],lt["client"+M])):Ae===void 0?g.css(J,He,de):g.style(J,He,Ae,de)},j,ee?le:void 0,ee,null)}})}),g.fn.extend({bind:function(M,j,V){return this.on(M,null,j,V)},unbind:function(M,j){return this.off(M,null,j)},delegate:function(M,j,V,U){return this.on(j,M,V,U)},undelegate:function(M,j,V){return arguments.length===1?this.off(M,"**"):this.off(j,M||"**",V)},size:function(){return this.length}}),g.fn.andSelf=g.fn.addBack,typeof define=="function"&&define.amd&&define("jquery",[],function(){return g});var Z=e.jQuery,ae=e.$;return g.noConflict=function(M){return e.$===g&&(e.$=ae),M&&e.jQuery===g&&(e.jQuery=Z),g},n||(e.jQuery=e.$=g),g})});var Ye=Fn((Bn,Zn)=>{(function(e,n){typeof Zn=="object"&&typeof Zn.exports=="object"?Zn.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)})(typeof window!="undefined"?window:Bn,function(e,n){function t(B,Z){return Z.toUpperCase()}var l=[],o=e.document,a=l.slice,s=l.concat,u=l.push,f=l.indexOf,m={},d=m.toString,p=m.hasOwnProperty,b={},g="2.2.4",v=function(B,Z){return new v.fn.init(B,Z)},x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,_=/^-ms-/,S=/-([\da-z])/gi;function I(B){var Z=!!B&&"length"in B&&B.length,ae=v.type(B);return ae!=="function"&&!v.isWindow(B)&&(ae==="array"||Z===0||typeof Z=="number"&&0<Z&&Z-1 in B)}v.fn=v.prototype={jquery:g,constructor:v,selector:"",length:0,toArray:function(){return a.call(this)},get:function(B){return B!=null?B<0?this[B+this.length]:this[B]:a.call(this)},pushStack:function(B){return B=v.merge(this.constructor(),B),B.prevObject=this,B.context=this.context,B},each:function(B){return v.each(this,B)},map:function(B){return this.pushStack(v.map(this,function(Z,ae){return B.call(Z,ae,Z)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(B){var Z=this.length,B=+B+(B<0?Z:0);return this.pushStack(0<=B&&B<Z?[this[B]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:l.sort,splice:l.splice},v.extend=v.fn.extend=function(){var B,Z,ae,M,j,V=arguments[0]||{},U=1,le=arguments.length,se=!1;for(typeof V=="boolean"&&(se=V,V=arguments[U]||{},U++),typeof V=="object"||v.isFunction(V)||(V={}),U===le&&(V=this,U--);U<le;U++)if((B=arguments[U])!=null)for(Z in B)j=V[Z],ae=B[Z],V!==ae&&(se&&ae&&(v.isPlainObject(ae)||(M=v.isArray(ae)))?(j=M?(M=!1,j&&v.isArray(j)?j:[]):j&&v.isPlainObject(j)?j:{},V[Z]=v.extend(se,j,ae)):ae!==void 0&&(V[Z]=ae));return V},v.extend({expando:"jQuery"+(g+Math.random()).replace(/\D/g,""),isReady:!0,error:function(B){throw new Error(B)},noop:function(){},isFunction:function(B){return v.type(B)==="function"},isArray:Array.isArray,isWindow:function(B){return B!=null&&B===B.window},isNumeric:function(B){var Z=B&&B.toString();return!v.isArray(B)&&0<=Z-parseFloat(Z)+1},isPlainObject:function(B){if(v.type(B)!=="object"||B.nodeType||v.isWindow(B)||B.constructor&&!p.call(B,"constructor")&&!p.call(B.constructor.prototype||{},"isPrototypeOf"))return!1;for(var Z in B);return Z===void 0||p.call(B,Z)},isEmptyObject:function(B){for(var Z in B)return!1;return!0},type:function(B){return B==null?B+"":typeof B=="object"||typeof B=="function"?m[d.call(B)]||"object":typeof B},globalEval:function(B){var Z,ae=eval;(B=v.trim(B))&&(B.indexOf("use strict")===1?((Z=o.createElement("script")).text=B,o.head.appendChild(Z).parentNode.removeChild(Z)):ae(B))},camelCase:function(B){return B.replace(_,"ms-").replace(S,t)},nodeName:function(B,Z){return B.nodeName&&B.nodeName.toLowerCase()===Z.toLowerCase()},each:function(B,Z){var ae,M=0;if(I(B))for(ae=B.length;M<ae&&Z.call(B[M],M,B[M])!==!1;M++);else for(M in B)if(Z.call(B[M],M,B[M])===!1)break;return B},trim:function(B){return B==null?"":(B+"").replace(x,"")},makeArray:function(B,Z){return Z=Z||[],B!=null&&(I(Object(B))?v.merge(Z,typeof B=="string"?[B]:B):u.call(Z,B)),Z},inArray:function(B,Z,ae){return Z==null?-1:f.call(Z,B,ae)},merge:function(B,Z){for(var ae=+Z.length,M=0,j=B.length;M<ae;M++)B[j++]=Z[M];return B.length=j,B},grep:function(B,Z,ae){for(var M=[],j=0,V=B.length,U=!ae;j<V;j++)!Z(B[j],j)!=U&&M.push(B[j]);return M},map:function(B,Z,ae){var M,j,V=0,U=[];if(I(B))for(M=B.length;V<M;V++)(j=Z(B[V],V,ae))!=null&&U.push(j);else for(V in B)j=Z(B[V],V,ae),j!=null&&U.push(j);return s.apply([],U)},guid:1,proxy:function(B,Z){var ae,M;return typeof Z=="string"&&(M=B[Z],Z=B,B=M),v.isFunction(B)?(ae=a.call(arguments,2),(M=function(){return B.apply(Z||this,ae.concat(a.call(arguments)))}).guid=B.guid=B.guid||v.guid++,M):void 0},now:Date.now,support:b}),typeof Symbol=="function"&&(v.fn[Symbol.iterator]=l[Symbol.iterator]),v.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(B,Z){m["[object "+Z+"]"]=Z.toLowerCase()});var P=function(B){function Z(De,je,tt){var yt="0x"+je-65536;return yt!=yt||tt?je:yt<0?String.fromCharCode(65536+yt):String.fromCharCode(yt>>10|55296,1023&yt|56320)}function ae(){lt()}var M,j,V,U,le,se,ee,de,J,He,Ae,lt,vt,bt,dl,Jt,Cl,Rl,Pr,fl="sizzle"+ +new Date,Wt=B.document,ar=0,Fl=0,Ir=pi(),oi=pi(),Un=pi(),yr=function(De,je){return De===je&&(Ae=!0),0},Yr={}.hasOwnProperty,wr=[],Xr=wr.pop,rn=wr.push,pr=wr.push,$r=wr.slice,xr=function(De,je){for(var tt=0,yt=De.length;tt<yt;tt++)if(De[tt]===je)return tt;return-1},Sn="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Tl="[\\x20\\t\\r\\n\\f]",vr="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",Gl="\\["+Tl+"*("+vr+")(?:"+Tl+"*([*^$|!~]?=)"+Tl+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+vr+"))|)"+Tl+"*\\]",mi=":("+vr+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Gl+")*)|.*)\\)|)",za=new RegExp(Tl+"+","g"),Oi=new RegExp("^"+Tl+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Tl+"+$","g"),yc=new RegExp("^"+Tl+"*,"+Tl+"*"),In=new RegExp("^"+Tl+"*([>+~]|"+Tl+")"+Tl+"*"),Hs=new RegExp("="+Tl+`*([^\\]'"]*?)`+Tl+"*\\]","g"),bu=new RegExp(mi),kc=new RegExp("^"+vr+"$"),sa={ID:new RegExp("^#("+vr+")"),CLASS:new RegExp("^\\.("+vr+")"),TAG:new RegExp("^("+vr+"|[*])"),ATTR:new RegExp("^"+Gl),PSEUDO:new RegExp("^"+mi),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Tl+"*(even|odd|(([+-]|)(\\d*)n|)"+Tl+"*(?:([+-]|)"+Tl+"*(\\d+)|))"+Tl+"*\\)|)","i"),bool:new RegExp("^(?:"+Sn+")$","i"),needsContext:new RegExp("^"+Tl+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Tl+"*((?:-\\d)?\\d*)"+Tl+"*\\)|)(?=[^-]|$)","i")},ca=/^(?:input|select|textarea|button)$/i,Oa=/^h\d$/i,oo=/^[^{]+\{\s*\[native \w/,js=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bo=/[+~]/,bc=/'|\\/g,gi=new RegExp("\\\\([\\da-f]{1,6}"+Tl+"?|("+Tl+")|.)","ig");try{pr.apply(wr=$r.call(Wt.childNodes),Wt.childNodes),wr[Wt.childNodes.length].nodeType}catch(De){pr={apply:wr.length?function(je,tt){rn.apply(je,$r.call(tt))}:function(je,tt){for(var yt=je.length,jt=0;je[yt++]=tt[jt++];);je.length=yt-1}}}function Lr(De,je,tt,yt){var jt,pl,Bt,hl,Ce,Ve,Ge,dt,st=je&&je.ownerDocument,$t=je?je.nodeType:9;if(tt=tt||[],typeof De!="string"||!De||$t!==1&&$t!==9&&$t!==11)return tt;if(!yt&&((je?je.ownerDocument||je:Wt)!==vt&&lt(je),je=je||vt,dl)){if($t!==11&&(Ve=js.exec(De)))if(jt=Ve[1]){if($t===9){if(!(Bt=je.getElementById(jt)))return tt;if(Bt.id===jt)return tt.push(Bt),tt}else if(st&&(Bt=st.getElementById(jt))&&Pr(je,Bt)&&Bt.id===jt)return tt.push(Bt),tt}else{if(Ve[2])return pr.apply(tt,je.getElementsByTagName(De)),tt;if((jt=Ve[3])&&j.getElementsByClassName&&je.getElementsByClassName)return pr.apply(tt,je.getElementsByClassName(jt)),tt}if(j.qsa&&!Un[De+" "]&&(!Jt||!Jt.test(De))){if($t!==1)st=je,dt=De;else if(je.nodeName.toLowerCase()!=="object"){for((hl=je.getAttribute("id"))?hl=hl.replace(bc,"\\$&"):je.setAttribute("id",hl=fl),pl=(Ge=se(De)).length,Ce=kc.test(hl)?"#"+hl:"[id='"+hl+"']";pl--;)Ge[pl]=Ce+" "+jo(Ge[pl]);dt=Ge.join(","),st=bo.test(De)&&vi(je.parentNode)||je}if(dt)try{return pr.apply(tt,st.querySelectorAll(dt)),tt}catch(mt){}finally{hl===fl&&je.removeAttribute("id")}}}return de(De.replace(Oi,"$1"),je,tt,yt)}function pi(){var De=[];function je(tt,yt){return De.push(tt+" ")>V.cacheLength&&delete je[De.shift()],je[tt+" "]=yt}return je}function gn(De){return De[fl]=!0,De}function xi(De){var je=vt.createElement("div");try{return!!De(je)}catch(tt){return!1}finally{je.parentNode&&je.parentNode.removeChild(je),je=null}}function Tr(De,je){for(var tt=De.split("|"),yt=tt.length;yt--;)V.attrHandle[tt[yt]]=je}function Ho(De,je){var tt=je&&De,yt=tt&&De.nodeType===1&&je.nodeType===1&&(~je.sourceIndex||1<<31)-(~De.sourceIndex||1<<31);if(yt)return yt;if(tt){for(;tt=tt.nextSibling;)if(tt===je)return-1}return De?1:-1}function Tn(De){return gn(function(je){return je=+je,gn(function(tt,yt){for(var jt,pl=De([],tt.length,je),Bt=pl.length;Bt--;)tt[jt=pl[Bt]]&&(tt[jt]=!(yt[jt]=tt[jt]))})})}function vi(De){return De&&De.getElementsByTagName!==void 0&&De}for(M in j=Lr.support={},le=Lr.isXML=function(De){return De=De&&(De.ownerDocument||De).documentElement,!!De&&De.nodeName!=="HTML"},lt=Lr.setDocument=function(De){var De=De?De.ownerDocument||De:Wt;return De!==vt&&De.nodeType===9&&De.documentElement&&(bt=(vt=De).documentElement,dl=!le(vt),(De=vt.defaultView)&&De.top!==De&&(De.addEventListener?De.addEventListener("unload",ae,!1):De.attachEvent&&De.attachEvent("onunload",ae)),j.attributes=xi(function(je){return je.className="i",!je.getAttribute("className")}),j.getElementsByTagName=xi(function(je){return je.appendChild(vt.createComment("")),!je.getElementsByTagName("*").length}),j.getElementsByClassName=oo.test(vt.getElementsByClassName),j.getById=xi(function(je){return bt.appendChild(je).id=fl,!vt.getElementsByName||!vt.getElementsByName(fl).length}),j.getById?(V.find.ID=function(je,tt){if(tt.getElementById!==void 0&&dl)return je=tt.getElementById(je),je?[je]:[]},V.filter.ID=function(je){var tt=je.replace(gi,Z);return function(yt){return yt.getAttribute("id")===tt}}):(delete V.find.ID,V.filter.ID=function(je){var tt=je.replace(gi,Z);return function(yt){return yt=yt.getAttributeNode!==void 0&&yt.getAttributeNode("id"),yt&&yt.value===tt}}),V.find.TAG=j.getElementsByTagName?function(je,tt){return tt.getElementsByTagName!==void 0?tt.getElementsByTagName(je):j.qsa?tt.querySelectorAll(je):void 0}:function(je,tt){var yt,jt=[],pl=0,Bt=tt.getElementsByTagName(je);if(je!=="*")return Bt;for(;yt=Bt[pl++];)yt.nodeType===1&&jt.push(yt);return jt},V.find.CLASS=j.getElementsByClassName&&function(je,tt){return tt.getElementsByClassName!==void 0&&dl?tt.getElementsByClassName(je):void 0},Cl=[],Jt=[],(j.qsa=oo.test(vt.querySelectorAll))&&(xi(function(je){bt.appendChild(je).innerHTML="<a id='"+fl+"'></a><select id='"+fl+"-\r\\' msallowcapture=''><option selected=''></option></select>",je.querySelectorAll("[msallowcapture^='']").length&&Jt.push("[*^$]="+Tl+`*(?:''|"")`),je.querySelectorAll("[selected]").length||Jt.push("\\["+Tl+"*(?:value|"+Sn+")"),je.querySelectorAll("[id~="+fl+"-]").length||Jt.push("~="),je.querySelectorAll(":checked").length||Jt.push(":checked"),je.querySelectorAll("a#"+fl+"+*").length||Jt.push(".#.+[+~]")}),xi(function(je){var tt=vt.createElement("input");tt.setAttribute("type","hidden"),je.appendChild(tt).setAttribute("name","D"),je.querySelectorAll("[name=d]").length&&Jt.push("name"+Tl+"*[*^$|!~]?="),je.querySelectorAll(":enabled").length||Jt.push(":enabled",":disabled"),je.querySelectorAll("*,:x"),Jt.push(",.*:")})),(j.matchesSelector=oo.test(Rl=bt.matches||bt.webkitMatchesSelector||bt.mozMatchesSelector||bt.oMatchesSelector||bt.msMatchesSelector))&&xi(function(je){j.disconnectedMatch=Rl.call(je,"div"),Rl.call(je,"[s!='']:x"),Cl.push("!=",mi)}),Jt=Jt.length&&new RegExp(Jt.join("|")),Cl=Cl.length&&new RegExp(Cl.join("|")),De=oo.test(bt.compareDocumentPosition),Pr=De||oo.test(bt.contains)?function(je,tt){var yt=je.nodeType===9?je.documentElement:je,tt=tt&&tt.parentNode;return je===tt||!(!tt||tt.nodeType!==1||!(yt.contains?yt.contains(tt):je.compareDocumentPosition&&16&je.compareDocumentPosition(tt)))}:function(je,tt){if(tt){for(;tt=tt.parentNode;)if(tt===je)return!0}return!1},yr=De?function(je,tt){if(je===tt)return Ae=!0,0;var yt=!je.compareDocumentPosition-!tt.compareDocumentPosition;return yt||(1&(yt=(je.ownerDocument||je)===(tt.ownerDocument||tt)?je.compareDocumentPosition(tt):1)||!j.sortDetached&&tt.compareDocumentPosition(je)===yt?je===vt||je.ownerDocument===Wt&&Pr(Wt,je)?-1:tt===vt||tt.ownerDocument===Wt&&Pr(Wt,tt)?1:He?xr(He,je)-xr(He,tt):0:4&yt?-1:1)}:function(je,tt){if(je===tt)return Ae=!0,0;var yt,jt=0,pl=je.parentNode,Bt=tt.parentNode,hl=[je],Ce=[tt];if(!pl||!Bt)return je===vt?-1:tt===vt?1:pl?-1:Bt?1:He?xr(He,je)-xr(He,tt):0;if(pl===Bt)return Ho(je,tt);for(yt=je;yt=yt.parentNode;)hl.unshift(yt);for(yt=tt;yt=yt.parentNode;)Ce.unshift(yt);for(;hl[jt]===Ce[jt];)jt++;return jt?Ho(hl[jt],Ce[jt]):hl[jt]===Wt?-1:Ce[jt]===Wt?1:0}),vt},Lr.matches=function(De,je){return Lr(De,null,null,je)},Lr.matchesSelector=function(De,je){if((De.ownerDocument||De)!==vt&&lt(De),je=je.replace(Hs,"='$1']"),j.matchesSelector&&dl&&!Un[je+" "]&&(!Cl||!Cl.test(je))&&(!Jt||!Jt.test(je)))try{var tt=Rl.call(De,je);if(tt||j.disconnectedMatch||De.document&&De.document.nodeType!==11)return tt}catch(yt){}return 0<Lr(je,vt,null,[De]).length},Lr.contains=function(De,je){return(De.ownerDocument||De)!==vt&&lt(De),Pr(De,je)},Lr.attr=function(De,je){(De.ownerDocument||De)!==vt&&lt(De);var tt=V.attrHandle[je.toLowerCase()],tt=tt&&Yr.call(V.attrHandle,je.toLowerCase())?tt(De,je,!dl):void 0;return tt!==void 0?tt:j.attributes||!dl?De.getAttribute(je):(tt=De.getAttributeNode(je))&&tt.specified?tt.value:null},Lr.error=function(De){throw new Error("Syntax error, unrecognized expression: "+De)},Lr.uniqueSort=function(De){var je,tt=[],yt=0,jt=0;if(Ae=!j.detectDuplicates,He=!j.sortStable&&De.slice(0),De.sort(yr),Ae){for(;je=De[jt++];)je===De[jt]&&(yt=tt.push(jt));for(;yt--;)De.splice(tt[yt],1)}return He=null,De},U=Lr.getText=function(De){var je,tt="",yt=0,jt=De.nodeType;if(jt){if(jt===1||jt===9||jt===11){if(typeof De.textContent=="string")return De.textContent;for(De=De.firstChild;De;De=De.nextSibling)tt+=U(De)}else if(jt===3||jt===4)return De.nodeValue}else for(;je=De[yt++];)tt+=U(je);return tt},(V=Lr.selectors={cacheLength:50,createPseudo:gn,match:sa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(De){return De[1]=De[1].replace(gi,Z),De[3]=(De[3]||De[4]||De[5]||"").replace(gi,Z),De[2]==="~="&&(De[3]=" "+De[3]+" "),De.slice(0,4)},CHILD:function(De){return De[1]=De[1].toLowerCase(),De[1].slice(0,3)==="nth"?(De[3]||Lr.error(De[0]),De[4]=+(De[4]?De[5]+(De[6]||1):2*(De[3]==="even"||De[3]==="odd")),De[5]=+(De[7]+De[8]||De[3]==="odd")):De[3]&&Lr.error(De[0]),De},PSEUDO:function(De){var je,tt=!De[6]&&De[2];return sa.CHILD.test(De[0])?null:(De[3]?De[2]=De[4]||De[5]||"":tt&&bu.test(tt)&&(je=se(tt,!0))&&(je=tt.indexOf(")",tt.length-je)-tt.length)&&(De[0]=De[0].slice(0,je),De[2]=tt.slice(0,je)),De.slice(0,3))}},filter:{TAG:function(De){var je=De.replace(gi,Z).toLowerCase();return De==="*"?function(){return!0}:function(tt){return tt.nodeName&&tt.nodeName.toLowerCase()===je}},CLASS:function(De){var je=Ir[De+" "];return je||(je=new RegExp("(^|"+Tl+")"+De+"("+Tl+"|$)"))&&Ir(De,function(tt){return je.test(typeof tt.className=="string"&&tt.className||tt.getAttribute!==void 0&&tt.getAttribute("class")||"")})},ATTR:function(De,je,tt){return function(yt){return yt=Lr.attr(yt,De),yt==null?je==="!=":!je||(yt+="",je==="="?yt===tt:je==="!="?yt!==tt:je==="^="?tt&&yt.indexOf(tt)===0:je==="*="?tt&&-1<yt.indexOf(tt):je==="$="?tt&&yt.slice(-tt.length)===tt:je==="~="?-1<(" "+yt.replace(za," ")+" ").indexOf(tt):je==="|="&&(yt===tt||yt.slice(0,tt.length+1)===tt+"-"))}},CHILD:function(De,je,tt,yt,jt){var pl=De.slice(0,3)!=="nth",Bt=De.slice(-4)!=="last",hl=je==="of-type";return yt===1&&jt===0?function(Ce){return!!Ce.parentNode}:function(Ce,Ve,Ge){var dt,st,$t,mt,Ot,rl,vl=pl!=Bt?"nextSibling":"previousSibling",Ut=Ce.parentNode,ml=hl&&Ce.nodeName.toLowerCase(),Il=!Ge&&!hl,ql=!1;if(Ut){if(pl){for(;vl;){for(mt=Ce;mt=mt[vl];)if(hl?mt.nodeName.toLowerCase()===ml:mt.nodeType===1)return!1;rl=vl=De==="only"&&!rl&&"nextSibling"}return!0}if(rl=[Bt?Ut.firstChild:Ut.lastChild],Bt&&Il){for(ql=(Ot=(dt=(st=($t=(mt=Ut)[fl]||(mt[fl]={}))[mt.uniqueID]||($t[mt.uniqueID]={}))[De]||[])[0]===ar&&dt[1])&&dt[2],mt=Ot&&Ut.childNodes[Ot];mt=++Ot&&mt&&mt[vl]||(ql=Ot=0)||rl.pop();)if(mt.nodeType===1&&++ql&&mt===Ce){st[De]=[ar,Ot,ql];break}}else if(Il&&(ql=Ot=(dt=(st=($t=(mt=Ce)[fl]||(mt[fl]={}))[mt.uniqueID]||($t[mt.uniqueID]={}))[De]||[])[0]===ar&&dt[1]),ql===!1)for(;(mt=++Ot&&mt&&mt[vl]||(ql=Ot=0)||rl.pop())&&((hl?mt.nodeName.toLowerCase()!==ml:mt.nodeType!==1)||!++ql||(Il&&((st=($t=mt[fl]||(mt[fl]={}))[mt.uniqueID]||($t[mt.uniqueID]={}))[De]=[ar,ql]),mt!==Ce)););return(ql-=jt)===yt||ql%yt==0&&0<=ql/yt}}},PSEUDO:function(De,je){var tt,yt=V.pseudos[De]||V.setFilters[De.toLowerCase()]||Lr.error("unsupported pseudo: "+De);return yt[fl]?yt(je):1<yt.length?(tt=[De,De,"",je],V.setFilters.hasOwnProperty(De.toLowerCase())?gn(function(jt,pl){for(var Bt,hl=yt(jt,je),Ce=hl.length;Ce--;)jt[Bt=xr(jt,hl[Ce])]=!(pl[Bt]=hl[Ce])}):function(jt){return yt(jt,0,tt)}):yt}},pseudos:{not:gn(function(De){var je=[],tt=[],yt=ee(De.replace(Oi,"$1"));return yt[fl]?gn(function(jt,pl,Bt,hl){for(var Ce,Ve=yt(jt,null,hl,[]),Ge=jt.length;Ge--;)(Ce=Ve[Ge])&&(jt[Ge]=!(pl[Ge]=Ce))}):function(jt,pl,Bt){return je[0]=jt,yt(je,null,Bt,tt),je[0]=null,!tt.pop()}}),has:gn(function(De){return function(je){return 0<Lr(De,je).length}}),contains:gn(function(De){return De=De.replace(gi,Z),function(je){return-1<(je.textContent||je.innerText||U(je)).indexOf(De)}}),lang:gn(function(De){return kc.test(De||"")||Lr.error("unsupported lang: "+De),De=De.replace(gi,Z).toLowerCase(),function(je){var tt;do if(tt=dl?je.lang:je.getAttribute("xml:lang")||je.getAttribute("lang"))return(tt=tt.toLowerCase())===De||tt.indexOf(De+"-")===0;while((je=je.parentNode)&&je.nodeType===1);return!1}}),target:function(De){var je=B.location&&B.location.hash;return je&&je.slice(1)===De.id},root:function(De){return De===bt},focus:function(De){return De===vt.activeElement&&(!vt.hasFocus||vt.hasFocus())&&!!(De.type||De.href||~De.tabIndex)},enabled:function(De){return De.disabled===!1},disabled:function(De){return De.disabled===!0},checked:function(De){var je=De.nodeName.toLowerCase();return je==="input"&&!!De.checked||je==="option"&&!!De.selected},selected:function(De){return De.parentNode&&De.parentNode.selectedIndex,De.selected===!0},empty:function(De){for(De=De.firstChild;De;De=De.nextSibling)if(De.nodeType<6)return!1;return!0},parent:function(De){return!V.pseudos.empty(De)},header:function(De){return Oa.test(De.nodeName)},input:function(De){return ca.test(De.nodeName)},button:function(De){var je=De.nodeName.toLowerCase();return je==="input"&&De.type==="button"||je==="button"},text:function(De){return De.nodeName.toLowerCase()==="input"&&De.type==="text"&&((De=De.getAttribute("type"))==null||De.toLowerCase()==="text")},first:Tn(function(){return[0]}),last:Tn(function(De,je){return[je-1]}),eq:Tn(function(De,je,tt){return[tt<0?tt+je:tt]}),even:Tn(function(De,je){for(var tt=0;tt<je;tt+=2)De.push(tt);return De}),odd:Tn(function(De,je){for(var tt=1;tt<je;tt+=2)De.push(tt);return De}),lt:Tn(function(De,je,tt){for(var yt=tt<0?tt+je:tt;0<=--yt;)De.push(yt);return De}),gt:Tn(function(De,je,tt){for(var yt=tt<0?tt+je:tt;++yt<je;)De.push(yt);return De})}}).pseudos.nth=V.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})V.pseudos[M]=function(De){return function(je){return je.nodeName.toLowerCase()==="input"&&je.type===De}}(M);for(M in{submit:!0,reset:!0})V.pseudos[M]=function(De){return function(je){var tt=je.nodeName.toLowerCase();return(tt==="input"||tt==="button")&&je.type===De}}(M);function Pa(){}function jo(De){for(var je=0,tt=De.length,yt="";je<tt;je++)yt+=De[je].value;return yt}function us(De,je,tt){var yt=je.dir,jt=tt&&yt==="parentNode",pl=Fl++;return je.first?function(Bt,hl,Ce){for(;Bt=Bt[yt];)if(Bt.nodeType===1||jt)return De(Bt,hl,Ce)}:function(Bt,hl,Ce){var Ve,Ge,dt=[ar,pl];if(Ce){for(;Bt=Bt[yt];)if((Bt.nodeType===1||jt)&&De(Bt,hl,Ce))return!0}else for(;Bt=Bt[yt];)if(Bt.nodeType===1||jt){if((Ge=(Ve=(Ge=Bt[fl]||(Bt[fl]={}))[Bt.uniqueID]||(Ge[Bt.uniqueID]={}))[yt])&&Ge[0]===ar&&Ge[1]===pl)return dt[2]=Ge[2];if((Ve[yt]=dt)[2]=De(Bt,hl,Ce))return!0}}}function Ea(De){return 1<De.length?function(je,tt,yt){for(var jt=De.length;jt--;)if(!De[jt](je,tt,yt))return!1;return!0}:De[0]}function _i(De,je,tt,yt,jt){for(var pl,Bt=[],hl=0,Ce=De.length,Ve=je!=null;hl<Ce;hl++)(pl=De[hl])&&(tt&&!tt(pl,yt,jt)||(Bt.push(pl),Ve&&je.push(hl)));return Bt}function Yl(De,je,tt,yt,jt,pl){return yt&&!yt[fl]&&(yt=Yl(yt)),jt&&!jt[fl]&&(jt=Yl(jt,pl)),gn(function(Bt,hl,Ce,Ve){var Ge,dt,st,$t=[],mt=[],Ot=hl.length,rl=Bt||function(ml,Il,ql){for(var Dl=0,pn=Il.length;Dl<pn;Dl++)Lr(ml,Il[Dl],ql);return ql}(je||"*",Ce.nodeType?[Ce]:Ce,[]),vl=!De||!Bt&&je?rl:_i(rl,$t,De,Ce,Ve),Ut=tt?jt||(Bt?De:Ot||yt)?[]:hl:vl;if(tt&&tt(vl,Ut,Ce,Ve),yt)for(Ge=_i(Ut,mt),yt(Ge,[],Ce,Ve),dt=Ge.length;dt--;)(st=Ge[dt])&&(Ut[mt[dt]]=!(vl[mt[dt]]=st));if(Bt){if(jt||De){if(jt){for(Ge=[],dt=Ut.length;dt--;)(st=Ut[dt])&&Ge.push(vl[dt]=st);jt(null,Ut=[],Ge,Ve)}for(dt=Ut.length;dt--;)(st=Ut[dt])&&-1<(Ge=jt?xr(Bt,st):$t[dt])&&(Bt[Ge]=!(hl[Ge]=st))}}else Ut=_i(Ut===hl?Ut.splice(Ot,Ut.length):Ut),jt?jt(null,hl,Ut,Ve):pr.apply(hl,Ut)})}function wc(De,je){function tt(pl,Bt,hl,Ce,Ve){var Ge,dt,st,$t=0,mt="0",Ot=pl&&[],rl=[],vl=J,Ut=pl||jt&&V.find.TAG("*",Ve),ml=ar+=vl==null?1:Math.random()||.1,Il=Ut.length;for(Ve&&(J=Bt===vt||Bt||Ve);mt!==Il&&(Ge=Ut[mt])!=null;mt++){if(jt&&Ge){for(dt=0,Bt||Ge.ownerDocument===vt||(lt(Ge),hl=!dl);st=De[dt++];)if(st(Ge,Bt||vt,hl)){Ce.push(Ge);break}Ve&&(ar=ml)}yt&&((Ge=!st&&Ge)&&$t--,pl&&Ot.push(Ge))}if($t+=mt,yt&&mt!==$t){for(dt=0;st=je[dt++];)st(Ot,rl,Bt,hl);if(pl){if(0<$t)for(;mt--;)Ot[mt]||rl[mt]||(rl[mt]=Xr.call(Ce));rl=_i(rl)}pr.apply(Ce,rl),Ve&&!pl&&0<rl.length&&1<$t+je.length&&Lr.uniqueSort(Ce)}return Ve&&(ar=ml,J=vl),Ot}var yt=0<je.length,jt=0<De.length;return yt?gn(tt):tt}return Pa.prototype=V.filters=V.pseudos,V.setFilters=new Pa,se=Lr.tokenize=function(De,je){var tt,yt,jt,pl,Bt,hl,Ce,Ve=oi[De+" "];if(Ve)return je?0:Ve.slice(0);for(Bt=De,hl=[],Ce=V.preFilter;Bt;){for(pl in tt&&!(yt=yc.exec(Bt))||(yt&&(Bt=Bt.slice(yt[0].length)||Bt),hl.push(jt=[])),tt=!1,(yt=In.exec(Bt))&&(tt=yt.shift(),jt.push({value:tt,type:yt[0].replace(Oi," ")}),Bt=Bt.slice(tt.length)),V.filter)!(yt=sa[pl].exec(Bt))||Ce[pl]&&!(yt=Ce[pl](yt))||(tt=yt.shift(),jt.push({value:tt,type:pl,matches:yt}),Bt=Bt.slice(tt.length));if(!tt)break}return je?Bt.length:Bt?Lr.error(De):oi(De,hl).slice(0)},ee=Lr.compile=function(De,je){var tt,yt=[],jt=[],pl=Un[De+" "];if(!pl){for(tt=(je=je||se(De)).length;tt--;)((pl=function Bt(hl){for(var Ce,Ve,Ge,dt=hl.length,st=V.relative[hl[0].type],$t=st||V.relative[" "],mt=st?1:0,Ot=us(function(Ut){return Ut===Ce},$t,!0),rl=us(function(Ut){return-1<xr(Ce,Ut)},$t,!0),vl=[function(Ut,ml,Il){return Il=!st&&(Il||ml!==J)||((Ce=ml).nodeType?Ot:rl)(Ut,ml,Il),Ce=null,Il}];mt<dt;mt++)if(Ve=V.relative[hl[mt].type])vl=[us(Ea(vl),Ve)];else{if((Ve=V.filter[hl[mt].type].apply(null,hl[mt].matches))[fl]){for(Ge=++mt;Ge<dt&&!V.relative[hl[Ge].type];Ge++);return Yl(1<mt&&Ea(vl),1<mt&&jo(hl.slice(0,mt-1).concat({value:hl[mt-2].type===" "?"*":""})).replace(Oi,"$1"),Ve,mt<Ge&&Bt(hl.slice(mt,Ge)),Ge<dt&&Bt(hl=hl.slice(Ge)),Ge<dt&&jo(hl))}vl.push(Ve)}return Ea(vl)}(je[tt]))[fl]?yt:jt).push(pl);(pl=Un(De,wc(jt,yt))).selector=De}return pl},de=Lr.select=function(De,je,tt,yt){var jt,pl,Bt,hl,Ce,Ve=typeof De=="function"&&De,Ge=!yt&&se(De=Ve.selector||De);if(tt=tt||[],Ge.length===1){if(2<(pl=Ge[0]=Ge[0].slice(0)).length&&(Bt=pl[0]).type==="ID"&&j.getById&&je.nodeType===9&&dl&&V.relative[pl[1].type]){if(!(je=(V.find.ID(Bt.matches[0].replace(gi,Z),je)||[])[0]))return tt;Ve&&(je=je.parentNode),De=De.slice(pl.shift().value.length)}for(jt=sa.needsContext.test(De)?0:pl.length;jt--&&(Bt=pl[jt],!V.relative[hl=Bt.type]);)if((Ce=V.find[hl])&&(yt=Ce(Bt.matches[0].replace(gi,Z),bo.test(pl[0].type)&&vi(je.parentNode)||je))){if(pl.splice(jt,1),!(De=yt.length&&jo(pl)))return pr.apply(tt,yt),tt;break}}return(Ve||ee(De,Ge))(yt,je,!dl,tt,!je||bo.test(De)&&vi(je.parentNode)||je),tt},j.sortStable=fl.split("").sort(yr).join("")===fl,j.detectDuplicates=!!Ae,lt(),j.sortDetached=xi(function(De){return 1&De.compareDocumentPosition(vt.createElement("div"))}),xi(function(De){return De.innerHTML="<a href='#'></a>",De.firstChild.getAttribute("href")==="#"})||Tr("type|href|height|width",function(De,je,tt){return tt?void 0:De.getAttribute(je,je.toLowerCase()==="type"?1:2)}),j.attributes&&xi(function(De){return De.innerHTML="<input/>",De.firstChild.setAttribute("value",""),De.firstChild.getAttribute("value")===""})||Tr("value",function(De,je,tt){return tt||De.nodeName.toLowerCase()!=="input"?void 0:De.defaultValue}),xi(function(De){return De.getAttribute("disabled")==null})||Tr(Sn,function(De,je,tt){return tt?void 0:De[je]===!0?je.toLowerCase():(je=De.getAttributeNode(je))&&je.specified?je.value:null}),Lr}(e);v.find=P,v.expr=P.selectors,v.expr[":"]=v.expr.pseudos,v.uniqueSort=v.unique=P.uniqueSort,v.text=P.getText,v.isXMLDoc=P.isXML,v.contains=P.contains;function F(B,Z,ae){for(var M=[],j=ae!==void 0;(B=B[Z])&&B.nodeType!==9;)if(B.nodeType===1){if(j&&v(B).is(ae))break;M.push(B)}return M}function D(B,Z){for(var ae=[];B;B=B.nextSibling)B.nodeType===1&&B!==Z&&ae.push(B);return ae}var k=v.expr.match.needsContext,w=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,C=/^.[^:#\[\.,]*$/;function T(B,Z,ae){if(v.isFunction(Z))return v.grep(B,function(M,j){return!!Z.call(M,j,M)!==ae});if(Z.nodeType)return v.grep(B,function(M){return M===Z!==ae});if(typeof Z=="string"){if(C.test(Z))return v.filter(Z,B,ae);Z=v.filter(Z,B)}return v.grep(B,function(M){return-1<f.call(Z,M)!==ae})}v.filter=function(B,Z,ae){var M=Z[0];return ae&&(B=":not("+B+")"),Z.length===1&&M.nodeType===1?v.find.matchesSelector(M,B)?[M]:[]:v.find.matches(B,v.grep(Z,function(j){return j.nodeType===1}))},v.fn.extend({find:function(B){var Z,ae=this.length,M=[],j=this;if(typeof B!="string")return this.pushStack(v(B).filter(function(){for(Z=0;Z<ae;Z++)if(v.contains(j[Z],this))return!0}));for(Z=0;Z<ae;Z++)v.find(B,j[Z],M);return(M=this.pushStack(1<ae?v.unique(M):M)).selector=this.selector?this.selector+" "+B:B,M},filter:function(B){return this.pushStack(T(this,B||[],!1))},not:function(B){return this.pushStack(T(this,B||[],!0))},is:function(B){return!!T(this,typeof B=="string"&&k.test(B)?v(B):B||[],!1).length}});var O,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(v.fn.init=function(B,Z,ae){if(!B)return this;if(ae=ae||O,typeof B!="string")return B.nodeType?(this.context=this[0]=B,this.length=1,this):v.isFunction(B)?ae.ready!==void 0?ae.ready(B):B(v):(B.selector!==void 0&&(this.selector=B.selector,this.context=B.context),v.makeArray(B,this));if(!(M=B[0]==="<"&&B[B.length-1]===">"&&3<=B.length?[null,B,null]:z.exec(B))||!M[1]&&Z)return(!Z||Z.jquery?Z||ae:this.constructor(Z)).find(B);if(M[1]){if(Z=Z instanceof v?Z[0]:Z,v.merge(this,v.parseHTML(M[1],Z&&Z.nodeType?Z.ownerDocument||Z:o,!0)),w.test(M[1])&&v.isPlainObject(Z))for(var M in Z)v.isFunction(this[M])?this[M](Z[M]):this.attr(M,Z[M]);return this}return(ae=o.getElementById(M[2]))&&ae.parentNode&&(this.length=1,this[0]=ae),this.context=o,this.selector=B,this}).prototype=v.fn,O=v(o);var A=/^(?:parents|prev(?:Until|All))/,E={children:!0,contents:!0,next:!0,prev:!0};function L(B,Z){for(;(B=B[Z])&&B.nodeType!==1;);return B}v.fn.extend({has:function(B){var Z=v(B,this),ae=Z.length;return this.filter(function(){for(var M=0;M<ae;M++)if(v.contains(this,Z[M]))return!0})},closest:function(B,Z){for(var ae,M=0,j=this.length,V=[],U=k.test(B)||typeof B!="string"?v(B,Z||this.context):0;M<j;M++)for(ae=this[M];ae&&ae!==Z;ae=ae.parentNode)if(ae.nodeType<11&&(U?-1<U.index(ae):ae.nodeType===1&&v.find.matchesSelector(ae,B))){V.push(ae);break}return this.pushStack(1<V.length?v.uniqueSort(V):V)},index:function(B){return B?typeof B=="string"?f.call(v(B),this[0]):f.call(this,B.jquery?B[0]:B):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(B,Z){return this.pushStack(v.uniqueSort(v.merge(this.get(),v(B,Z))))},addBack:function(B){return this.add(B==null?this.prevObject:this.prevObject.filter(B))}}),v.each({parent:function(B){return B=B.parentNode,B&&B.nodeType!==11?B:null},parents:function(B){return F(B,"parentNode")},parentsUntil:function(B,Z,ae){return F(B,"parentNode",ae)},next:function(B){return L(B,"nextSibling")},prev:function(B){return L(B,"previousSibling")},nextAll:function(B){return F(B,"nextSibling")},prevAll:function(B){return F(B,"previousSibling")},nextUntil:function(B,Z,ae){return F(B,"nextSibling",ae)},prevUntil:function(B,Z,ae){return F(B,"previousSibling",ae)},siblings:function(B){return D((B.parentNode||{}).firstChild,B)},children:function(B){return D(B.firstChild)},contents:function(B){return B.contentDocument||v.merge([],B.childNodes)}},function(B,Z){v.fn[B]=function(ae,M){var j=v.map(this,Z,ae);return B.slice(-5)!=="Until"&&(M=ae),M&&typeof M=="string"&&(j=v.filter(M,j)),1<this.length&&(E[B]||v.uniqueSort(j),A.test(B)&&j.reverse()),this.pushStack(j)}});var N,W=/\S+/g;function X(){o.removeEventListener("DOMContentLoaded",X),e.removeEventListener("load",X),v.ready()}v.Callbacks=function(B){var Z,ae;B=typeof B=="string"?(Z=B,ae={},v.each(Z.match(W)||[],function(He,Ae){ae[Ae]=!0}),ae):v.extend({},B);function M(){for(le=B.once,U=j=!0;ee.length;de=-1)for(V=ee.shift();++de<se.length;)se[de].apply(V[0],V[1])===!1&&B.stopOnFalse&&(de=se.length,V=!1);B.memory||(V=!1),j=!1,le&&(se=V?[]:"")}var j,V,U,le,se=[],ee=[],de=-1,J={add:function(){return se&&(V&&!j&&(de=se.length-1,ee.push(V)),function He(Ae){v.each(Ae,function(lt,vt){v.isFunction(vt)?B.unique&&J.has(vt)||se.push(vt):vt&&vt.length&&v.type(vt)!=="string"&&He(vt)})}(arguments),V&&!j&&M()),this},remove:function(){return v.each(arguments,function(He,Ae){for(var lt;-1<(lt=v.inArray(Ae,se,lt));)se.splice(lt,1),lt<=de&&de--}),this},has:function(He){return He?-1<v.inArray(He,se):0<se.length},empty:function(){return se=se&&[],this},disable:function(){return le=ee=[],se=V="",this},disabled:function(){return!se},lock:function(){return le=ee=[],V||(se=V=""),this},locked:function(){return!!le},fireWith:function(He,Ae){return le||(Ae=[He,(Ae=Ae||[]).slice?Ae.slice():Ae],ee.push(Ae),j||M()),this},fire:function(){return J.fireWith(this,arguments),this},fired:function(){return!!U}};return J},v.extend({Deferred:function(B){var Z=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],ae="pending",M={state:function(){return ae},always:function(){return j.done(arguments).fail(arguments),this},then:function(){var V=arguments;return v.Deferred(function(U){v.each(Z,function(le,se){var ee=v.isFunction(V[le])&&V[le];j[se[1]](function(){var de=ee&&ee.apply(this,arguments);de&&v.isFunction(de.promise)?de.promise().progress(U.notify).done(U.resolve).fail(U.reject):U[se[0]+"With"](this===M?U.promise():this,ee?[de]:arguments)})}),V=null}).promise()},promise:function(V){return V!=null?v.extend(V,M):M}},j={};return M.pipe=M.then,v.each(Z,function(V,U){var le=U[2],se=U[3];M[U[1]]=le.add,se&&le.add(function(){ae=se},Z[1^V][2].disable,Z[2][2].lock),j[U[0]]=function(){return j[U[0]+"With"](this===j?M:this,arguments),this},j[U[0]+"With"]=le.fireWith}),M.promise(j),B&&B.call(j,j),j},when:function(B){function Z(de,J,He){return function(Ae){J[de]=this,He[de]=1<arguments.length?a.call(arguments):Ae,He===ae?ee.notifyWith(J,He):--se||ee.resolveWith(J,He)}}var ae,M,j,V=0,U=a.call(arguments),le=U.length,se=le!==1||B&&v.isFunction(B.promise)?le:0,ee=se===1?B:v.Deferred();if(1<le)for(ae=new Array(le),M=new Array(le),j=new Array(le);V<le;V++)U[V]&&v.isFunction(U[V].promise)?U[V].promise().progress(Z(V,M,ae)).done(Z(V,j,U)).fail(ee.reject):--se;return se||ee.resolveWith(j,U),ee.promise()}}),v.fn.ready=function(B){return v.ready.promise().done(B),this},v.extend({isReady:!1,readyWait:1,holdReady:function(B){B?v.readyWait++:v.ready(!0)},ready:function(B){(B===!0?--v.readyWait:v.isReady)||(v.isReady=!0)!==B&&0<--v.readyWait||(N.resolveWith(o,[v]),v.fn.triggerHandler&&(v(o).triggerHandler("ready"),v(o).off("ready")))}}),v.ready.promise=function(B){return N||(N=v.Deferred(),o.readyState==="complete"||o.readyState!=="loading"&&!o.documentElement.doScroll?e.setTimeout(v.ready):(o.addEventListener("DOMContentLoaded",X),e.addEventListener("load",X))),N.promise(B)},v.ready.promise();function te(B){return B.nodeType===1||B.nodeType===9||!+B.nodeType}var ue=function(B,Z,ae,M,j,V,U){var le=0,se=B.length,ee=ae==null;if(v.type(ae)==="object")for(le in j=!0,ae)ue(B,Z,le,ae[le],!0,V,U);else if(M!==void 0&&(j=!0,v.isFunction(M)||(U=!0),ee&&(Z=U?(Z.call(B,M),null):(ee=Z,function(de,J,He){return ee.call(v(de),He)})),Z))for(;le<se;le++)Z(B[le],ae,U?M:M.call(B[le],le,Z(B[le],ae)));return j?B:ee?Z.call(B):se?Z(B[0],ae):V};function pe(){this.expando=v.expando+pe.uid++}pe.uid=1,pe.prototype={register:function(B,Z){return Z=Z||{},B.nodeType?B[this.expando]=Z:Object.defineProperty(B,this.expando,{value:Z,writable:!0,configurable:!0}),B[this.expando]},cache:function(B){if(!te(B))return{};var Z=B[this.expando];return Z||(Z={},te(B)&&(B.nodeType?B[this.expando]=Z:Object.defineProperty(B,this.expando,{value:Z,configurable:!0}))),Z},set:function(B,Z,ae){var M,j=this.cache(B);if(typeof Z=="string")j[Z]=ae;else for(M in Z)j[M]=Z[M];return j},get:function(B,Z){return Z===void 0?this.cache(B):B[this.expando]&&B[this.expando][Z]},access:function(B,Z,ae){var M;return Z===void 0||Z&&typeof Z=="string"&&ae===void 0?(M=this.get(B,Z))!==void 0?M:this.get(B,v.camelCase(Z)):(this.set(B,Z,ae),ae!==void 0?ae:Z)},remove:function(B,Z){var ae,M,j,V=B[this.expando];if(V!==void 0){if(Z===void 0)this.register(B);else for(ae=(M=v.isArray(Z)?Z.concat(Z.map(v.camelCase)):(j=v.camelCase(Z),Z in V?[Z,j]:(M=j)in V?[M]:M.match(W)||[])).length;ae--;)delete V[M[ae]];Z!==void 0&&!v.isEmptyObject(V)||(B.nodeType?B[this.expando]=void 0:delete B[this.expando])}},hasData:function(B){return B=B[this.expando],B!==void 0&&!v.isEmptyObject(B)}};var ne=new pe,me=new pe,Q=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,we=/[A-Z]/g;function ie(B,Z,ae){var M;if(ae===void 0&&B.nodeType===1)if(M="data-"+Z.replace(we,"-$&").toLowerCase(),typeof(ae=B.getAttribute(M))=="string"){try{ae=ae==="true"||ae!=="false"&&(ae==="null"?null:+ae+""===ae?+ae:Q.test(ae)?v.parseJSON(ae):ae)}catch(j){}me.set(B,Z,ae)}else ae=void 0;return ae}v.extend({hasData:function(B){return me.hasData(B)||ne.hasData(B)},data:function(B,Z,ae){return me.access(B,Z,ae)},removeData:function(B,Z){me.remove(B,Z)},_data:function(B,Z,ae){return ne.access(B,Z,ae)},_removeData:function(B,Z){ne.remove(B,Z)}}),v.fn.extend({data:function(B,Z){var ae,M,j,V=this[0],U=V&&V.attributes;if(B!==void 0)return typeof B=="object"?this.each(function(){me.set(this,B)}):ue(this,function(le){var se,ee;return V&&le===void 0?(se=me.get(V,B)||me.get(V,B.replace(we,"-$&").toLowerCase()))!==void 0?se:(ee=v.camelCase(B),(se=me.get(V,ee))!==void 0||(se=ie(V,ee,void 0))!==void 0?se:void 0):(ee=v.camelCase(B),void this.each(function(){var de=me.get(this,ee);me.set(this,ee,le),-1<B.indexOf("-")&&de!==void 0&&me.set(this,B,le)}))},null,Z,1<arguments.length,null,!0);if(this.length&&(j=me.get(V),V.nodeType===1&&!ne.get(V,"hasDataAttrs"))){for(ae=U.length;ae--;)U[ae]&&(M=U[ae].name).indexOf("data-")===0&&(M=v.camelCase(M.slice(5)),ie(V,M,j[M]));ne.set(V,"hasDataAttrs",!0)}return j},removeData:function(B){return this.each(function(){me.remove(this,B)})}}),v.extend({queue:function(B,Z,ae){var M;return B?(Z=(Z||"fx")+"queue",M=ne.get(B,Z),ae&&(!M||v.isArray(ae)?M=ne.access(B,Z,v.makeArray(ae)):M.push(ae)),M||[]):void 0},dequeue:function(B,Z){Z=Z||"fx";var ae=v.queue(B,Z),M=ae.length,j=ae.shift(),V=v._queueHooks(B,Z);j==="inprogress"&&(j=ae.shift(),M--),j&&(Z==="fx"&&ae.unshift("inprogress"),delete V.stop,j.call(B,function(){v.dequeue(B,Z)},V)),!M&&V&&V.empty.fire()},_queueHooks:function(B,Z){var ae=Z+"queueHooks";return ne.get(B,ae)||ne.access(B,ae,{empty:v.Callbacks("once memory").add(function(){ne.remove(B,[Z+"queue",ae])})})}}),v.fn.extend({queue:function(B,Z){var ae=2;return typeof B!="string"&&(Z=B,B="fx",ae--),arguments.length<ae?v.queue(this[0],B):Z===void 0?this:this.each(function(){var M=v.queue(this,B,Z);v._queueHooks(this,B),B==="fx"&&M[0]!=="inprogress"&&v.dequeue(this,B)})},dequeue:function(B){return this.each(function(){v.dequeue(this,B)})},clearQueue:function(B){return this.queue(B||"fx",[])},promise:function(B,Z){function ae(){--j||V.resolveWith(U,[U])}var M,j=1,V=v.Deferred(),U=this,le=this.length;for(typeof B!="string"&&(Z=B,B=void 0),B=B||"fx";le--;)(M=ne.get(U[le],B+"queueHooks"))&&M.empty&&(j++,M.empty.add(ae));return ae(),V.promise(Z)}});function ge(B,Z){return B=Z||B,v.css(B,"display")==="none"||!v.contains(B.ownerDocument,B)}var g=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ce=new RegExp("^(?:([+-])=|)("+g+")([a-z%]*)$","i"),fe=["Top","Right","Bottom","Left"];function ye(B,Z,ae,M){var j,V=1,U=20,le=M?function(){return M.cur()}:function(){return v.css(B,Z,"")},se=le(),ee=ae&&ae[3]||(v.cssNumber[Z]?"":"px"),de=(v.cssNumber[Z]||ee!=="px"&&+se)&&ce.exec(v.css(B,Z));if(de&&de[3]!==ee)for(ee=ee||de[3],ae=ae||[],de=+se||1;V=V||".5",de/=V,v.style(B,Z,de+ee),V!==(V=le()/se)&&V!==1&&--U;);return ae&&(de=+de||+se||0,j=ae[1]?de+(ae[1]+1)*ae[2]:+ae[2],M&&(M.unit=ee,M.start=de,M.end=j)),j}var Ne=/^(?:checkbox|radio)$/i,xe=/<([\w:-]+)/,et=/^$|\/(?:java|ecma)script/i,Fe={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function it(B,Z){var ae=B.getElementsByTagName!==void 0?B.getElementsByTagName(Z||"*"):B.querySelectorAll!==void 0?B.querySelectorAll(Z||"*"):[];return Z===void 0||Z&&v.nodeName(B,Z)?v.merge([B],ae):ae}function wt(B,Z){for(var ae=0,M=B.length;ae<M;ae++)ne.set(B[ae],"globalEval",!Z||ne.get(Z[ae],"globalEval"))}Fe.optgroup=Fe.option,Fe.tbody=Fe.tfoot=Fe.colgroup=Fe.caption=Fe.thead,Fe.th=Fe.td;var ot=/<|&#?\w+;/;function xt(B,Z,ae,M,j){for(var V,U,le,se,ee,de=Z.createDocumentFragment(),J=[],He=0,Ae=B.length;He<Ae;He++)if((V=B[He])||V===0)if(v.type(V)==="object")v.merge(J,V.nodeType?[V]:V);else if(ot.test(V)){for(U=U||de.appendChild(Z.createElement("div")),le=(xe.exec(V)||["",""])[1].toLowerCase(),le=Fe[le]||Fe._default,U.innerHTML=le[1]+v.htmlPrefilter(V)+le[2],ee=le[0];ee--;)U=U.lastChild;v.merge(J,U.childNodes),(U=de.firstChild).textContent=""}else J.push(Z.createTextNode(V));for(de.textContent="",He=0;V=J[He++];)if(M&&-1<v.inArray(V,M))j&&j.push(V);else if(se=v.contains(V.ownerDocument,V),U=it(de.appendChild(V),"script"),se&&wt(U),ae)for(ee=0;V=U[ee++];)et.test(V.type||"")&&ae.push(V);return de}l=o.createDocumentFragment().appendChild(o.createElement("div")),(P=o.createElement("input")).setAttribute("type","radio"),P.setAttribute("checked","checked"),P.setAttribute("name","t"),l.appendChild(P),b.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,l.innerHTML="<textarea>x</textarea>",b.noCloneChecked=!!l.cloneNode(!0).lastChild.defaultValue;var Ft=/^key/,Se=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,oe=/^([^.]*)(?:\.(.+)|)/;function be(){return!0}function Te(){return!1}function Oe(){try{return o.activeElement}catch(B){}}function Xe(B,Z,ae,M,j,V){var U,le;if(typeof Z=="object"){for(le in typeof ae!="string"&&(M=M||ae,ae=void 0),Z)Xe(B,le,ae,M,Z[le],V);return B}if(M==null&&j==null?(j=ae,M=ae=void 0):j==null&&(typeof ae=="string"?(j=M,M=void 0):(j=M,M=ae,ae=void 0)),j===!1)j=Te;else if(!j)return B;return V===1&&(U=j,(j=function(se){return v().off(se),U.apply(this,arguments)}).guid=U.guid||(U.guid=v.guid++)),B.each(function(){v.event.add(this,Z,j,M,ae)})}v.event={global:{},add:function(B,Z,ae,M,j){var V,U,le,se,ee,de,J,He,Ae,lt=ne.get(B);if(lt)for(ae.handler&&(ae=(V=ae).handler,j=V.selector),ae.guid||(ae.guid=v.guid++),(le=lt.events)||(le=lt.events={}),(U=lt.handle)||(U=lt.handle=function(vt){return v!==void 0&&v.event.triggered!==vt.type?v.event.dispatch.apply(B,arguments):void 0}),se=(Z=(Z||"").match(W)||[""]).length;se--;)J=Ae=(ee=oe.exec(Z[se])||[])[1],He=(ee[2]||"").split(".").sort(),J&&(de=v.event.special[J]||{},J=(j?de.delegateType:de.bindType)||J,de=v.event.special[J]||{},ee=v.extend({type:J,origType:Ae,data:M,handler:ae,guid:ae.guid,selector:j,needsContext:j&&v.expr.match.needsContext.test(j),namespace:He.join(".")},V),(Ae=le[J])||((Ae=le[J]=[]).delegateCount=0,de.setup&&de.setup.call(B,M,He,U)!==!1||B.addEventListener&&B.addEventListener(J,U)),de.add&&(de.add.call(B,ee),ee.handler.guid||(ee.handler.guid=ae.guid)),j?Ae.splice(Ae.delegateCount++,0,ee):Ae.push(ee),v.event.global[J]=!0)},remove:function(B,Z,ae,M,j){var V,U,le,se,ee,de,J,He,Ae,lt,vt,bt=ne.hasData(B)&&ne.get(B);if(bt&&(se=bt.events)){for(ee=(Z=(Z||"").match(W)||[""]).length;ee--;)if(Ae=vt=(le=oe.exec(Z[ee])||[])[1],lt=(le[2]||"").split(".").sort(),Ae){for(J=v.event.special[Ae]||{},He=se[Ae=(M?J.delegateType:J.bindType)||Ae]||[],le=le[2]&&new RegExp("(^|\\.)"+lt.join("\\.(?:.*\\.|)")+"(\\.|$)"),U=V=He.length;V--;)de=He[V],!j&&vt!==de.origType||ae&&ae.guid!==de.guid||le&&!le.test(de.namespace)||M&&M!==de.selector&&(M!=="**"||!de.selector)||(He.splice(V,1),de.selector&&He.delegateCount--,J.remove&&J.remove.call(B,de));U&&!He.length&&(J.teardown&&J.teardown.call(B,lt,bt.handle)!==!1||v.removeEvent(B,Ae,bt.handle),delete se[Ae])}else for(Ae in se)v.event.remove(B,Ae+Z[ee],ae,M,!0);v.isEmptyObject(se)&&ne.remove(B,"handle events")}},dispatch:function(B){B=v.event.fix(B);var Z,ae,M,j,V,U=a.call(arguments),le=(ne.get(this,"events")||{})[B.type]||[],se=v.event.special[B.type]||{};if((U[0]=B).delegateTarget=this,!se.preDispatch||se.preDispatch.call(this,B)!==!1){for(V=v.event.handlers.call(this,B,le),Z=0;(M=V[Z++])&&!B.isPropagationStopped();)for(B.currentTarget=M.elem,ae=0;(j=M.handlers[ae++])&&!B.isImmediatePropagationStopped();)B.rnamespace&&!B.rnamespace.test(j.namespace)||(B.handleObj=j,B.data=j.data,(j=((v.event.special[j.origType]||{}).handle||j.handler).apply(M.elem,U))!==void 0&&(B.result=j)===!1&&(B.preventDefault(),B.stopPropagation()));return se.postDispatch&&se.postDispatch.call(this,B),B.result}},handlers:function(B,Z){var ae,M,j,V,U=[],le=Z.delegateCount,se=B.target;if(le&&se.nodeType&&(B.type!=="click"||isNaN(B.button)||B.button<1)){for(;se!==this;se=se.parentNode||this)if(se.nodeType===1&&(se.disabled!==!0||B.type!=="click")){for(M=[],ae=0;ae<le;ae++)M[j=(V=Z[ae]).selector+" "]===void 0&&(M[j]=V.needsContext?-1<v(j,this).index(se):v.find(j,this,null,[se]).length),M[j]&&M.push(V);M.length&&U.push({elem:se,handlers:M})}}return le<Z.length&&U.push({elem:this,handlers:Z.slice(le)}),U},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(B,Z){return B.which==null&&(B.which=Z.charCode!=null?Z.charCode:Z.keyCode),B}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(B,Z){var ae,M,j=Z.button;return B.pageX==null&&Z.clientX!=null&&(ae=(M=B.target.ownerDocument||o).documentElement,M=M.body,B.pageX=Z.clientX+(ae&&ae.scrollLeft||M&&M.scrollLeft||0)-(ae&&ae.clientLeft||M&&M.clientLeft||0),B.pageY=Z.clientY+(ae&&ae.scrollTop||M&&M.scrollTop||0)-(ae&&ae.clientTop||M&&M.clientTop||0)),B.which||j===void 0||(B.which=1&j?1:2&j?3:4&j?2:0),B}},fix:function(B){if(B[v.expando])return B;var Z,ae,M,j=B.type,V=B,U=this.fixHooks[j];for(U||(this.fixHooks[j]=U=Se.test(j)?this.mouseHooks:Ft.test(j)?this.keyHooks:{}),M=U.props?this.props.concat(U.props):this.props,B=new v.Event(V),Z=M.length;Z--;)B[ae=M[Z]]=V[ae];return B.target||(B.target=o),B.target.nodeType===3&&(B.target=B.target.parentNode),U.filter?U.filter(B,V):B},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==Oe()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===Oe()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return this.type==="checkbox"&&this.click&&v.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(B){return v.nodeName(B.target,"a")}},beforeunload:{postDispatch:function(B){B.result!==void 0&&B.originalEvent&&(B.originalEvent.returnValue=B.result)}}}},v.removeEvent=function(B,Z,ae){B.removeEventListener&&B.removeEventListener(Z,ae)},v.Event=function(B,Z){return this instanceof v.Event?(B&&B.type?(this.originalEvent=B,this.type=B.type,this.isDefaultPrevented=B.defaultPrevented||B.defaultPrevented===void 0&&B.returnValue===!1?be:Te):this.type=B,Z&&v.extend(this,Z),this.timeStamp=B&&B.timeStamp||v.now(),void(this[v.expando]=!0)):new v.Event(B,Z)},v.Event.prototype={constructor:v.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var B=this.originalEvent;this.isDefaultPrevented=be,B&&!this.isSimulated&&B.preventDefault()},stopPropagation:function(){var B=this.originalEvent;this.isPropagationStopped=be,B&&!this.isSimulated&&B.stopPropagation()},stopImmediatePropagation:function(){var B=this.originalEvent;this.isImmediatePropagationStopped=be,B&&!this.isSimulated&&B.stopImmediatePropagation(),this.stopPropagation()}},v.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(B,Z){v.event.special[B]={delegateType:Z,bindType:Z,handle:function(ae){var M,j=ae.relatedTarget,V=ae.handleObj;return j&&(j===this||v.contains(this,j))||(ae.type=V.origType,M=V.handler.apply(this,arguments),ae.type=Z),M}}}),v.fn.extend({on:function(B,Z,ae,M){return Xe(this,B,Z,ae,M)},one:function(B,Z,ae,M){return Xe(this,B,Z,ae,M,1)},off:function(B,Z,ae){var M,j;if(B&&B.preventDefault&&B.handleObj)return M=B.handleObj,v(B.delegateTarget).off(M.namespace?M.origType+"."+M.namespace:M.origType,M.selector,M.handler),this;if(typeof B!="object")return Z!==!1&&typeof Z!="function"||(ae=Z,Z=void 0),ae===!1&&(ae=Te),this.each(function(){v.event.remove(this,B,ae,Z)});for(j in B)this.off(j,Z,B[j]);return this}});var Le=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Ee=/<script|<style|<link/i,nt=/checked\s*(?:[^=]|=\s*.checked.)/i,Ze=/^true\/(.*)/,ze=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function _e(B,Z){return v.nodeName(B,"table")&&v.nodeName(Z.nodeType!==11?Z:Z.firstChild,"tr")?B.getElementsByTagName("tbody")[0]||B.appendChild(B.ownerDocument.createElement("tbody")):B}function Qe(B){return B.type=(B.getAttribute("type")!==null)+"/"+B.type,B}function Je(B){var Z=Ze.exec(B.type);return Z?B.type=Z[1]:B.removeAttribute("type"),B}function Ke(B,Z){var ae,M,j,V,U,le;if(Z.nodeType===1){if(ne.hasData(B)&&(V=ne.access(B),U=ne.set(Z,V),le=V.events))for(j in delete U.handle,U.events={},le)for(ae=0,M=le[j].length;ae<M;ae++)v.event.add(Z,j,le[j][ae]);me.hasData(B)&&(B=me.access(B),B=v.extend({},B),me.set(Z,B))}}function gt(B,Z,ae,M){Z=s.apply([],Z);var j,V,U,le,se,ee,de=0,J=B.length,He=J-1,Ae=Z[0],lt=v.isFunction(Ae);if(lt||1<J&&typeof Ae=="string"&&!b.checkClone&&nt.test(Ae))return B.each(function(vt){var bt=B.eq(vt);lt&&(Z[0]=Ae.call(this,vt,bt.html())),gt(bt,Z,ae,M)});if(J&&(V=(j=xt(Z,B[0].ownerDocument,!1,B,M)).firstChild,j.childNodes.length===1&&(j=V),V||M)){for(le=(U=v.map(it(j,"script"),Qe)).length;de<J;de++)se=j,de!==He&&(se=v.clone(se,!0,!0),le&&v.merge(U,it(se,"script"))),ae.call(B[de],se,de);if(le)for(ee=U[U.length-1].ownerDocument,v.map(U,Je),de=0;de<le;de++)se=U[de],et.test(se.type||"")&&!ne.access(se,"globalEval")&&v.contains(ee,se)&&(se.src?v._evalUrl&&v._evalUrl(se.src):v.globalEval(se.textContent.replace(ze,"")))}return B}function At(B,Z,ae){for(var M,j=Z?v.filter(Z,B):B,V=0;(M=j[V])!=null;V++)ae||M.nodeType!==1||v.cleanData(it(M)),M.parentNode&&(ae&&v.contains(M.ownerDocument,M)&&wt(it(M,"script")),M.parentNode.removeChild(M));return B}v.extend({htmlPrefilter:function(B){return B.replace(Le,"<$1></$2>")},clone:function(B,Z,ae){var M,j,V,U,le,se,ee,de=B.cloneNode(!0),J=v.contains(B.ownerDocument,B);if(!(b.noCloneChecked||B.nodeType!==1&&B.nodeType!==11||v.isXMLDoc(B)))for(U=it(de),M=0,j=(V=it(B)).length;M<j;M++)le=V[M],se=U[M],ee=void 0,(ee=se.nodeName.toLowerCase())==="input"&&Ne.test(le.type)?se.checked=le.checked:ee!=="input"&&ee!=="textarea"||(se.defaultValue=le.defaultValue);if(Z)if(ae)for(V=V||it(B),U=U||it(de),M=0,j=V.length;M<j;M++)Ke(V[M],U[M]);else Ke(B,de);return 0<(U=it(de,"script")).length&&wt(U,!J&&it(B,"script")),de},cleanData:function(B){for(var Z,ae,M,j=v.event.special,V=0;(ae=B[V])!==void 0;V++)if(te(ae)){if(Z=ae[ne.expando]){if(Z.events)for(M in Z.events)j[M]?v.event.remove(ae,M):v.removeEvent(ae,M,Z.handle);ae[ne.expando]=void 0}ae[me.expando]&&(ae[me.expando]=void 0)}}}),v.fn.extend({domManip:gt,detach:function(B){return At(this,B,!0)},remove:function(B){return At(this,B)},text:function(B){return ue(this,function(Z){return Z===void 0?v.text(this):this.empty().each(function(){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(this.textContent=Z)})},null,B,arguments.length)},append:function(){return gt(this,arguments,function(B){this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||_e(this,B).appendChild(B)})},prepend:function(){return gt(this,arguments,function(B){var Z;this.nodeType!==1&&this.nodeType!==11&&this.nodeType!==9||(Z=_e(this,B)).insertBefore(B,Z.firstChild)})},before:function(){return gt(this,arguments,function(B){this.parentNode&&this.parentNode.insertBefore(B,this)})},after:function(){return gt(this,arguments,function(B){this.parentNode&&this.parentNode.insertBefore(B,this.nextSibling)})},empty:function(){for(var B,Z=0;(B=this[Z])!=null;Z++)B.nodeType===1&&(v.cleanData(it(B,!1)),B.textContent="");return this},clone:function(B,Z){return B=B!=null&&B,Z=Z??B,this.map(function(){return v.clone(this,B,Z)})},html:function(B){return ue(this,function(Z){var ae=this[0]||{},M=0,j=this.length;if(Z===void 0&&ae.nodeType===1)return ae.innerHTML;if(typeof Z=="string"&&!Ee.test(Z)&&!Fe[(xe.exec(Z)||["",""])[1].toLowerCase()]){Z=v.htmlPrefilter(Z);try{for(;M<j;M++)(ae=this[M]||{}).nodeType===1&&(v.cleanData(it(ae,!1)),ae.innerHTML=Z);ae=0}catch(V){}}ae&&this.empty().append(Z)},null,B,arguments.length)},replaceWith:function(){var B=[];return gt(this,arguments,function(Z){var ae=this.parentNode;v.inArray(this,B)<0&&(v.cleanData(it(this)),ae&&ae.replaceChild(Z,this))},B)}}),v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(B,Z){v.fn[B]=function(ae){for(var M,j=[],V=v(ae),U=V.length-1,le=0;le<=U;le++)M=le===U?this:this.clone(!0),v(V[le])[Z](M),u.apply(j,M.get());return this.pushStack(j)}});var cl,El={HTML:"block",BODY:"block"};function bl(B,Z){return B=v(Z.createElement(B)).appendTo(Z.body),Z=v.css(B[0],"display"),B.detach(),Z}function Nr(B){var Z=o,ae=El[B];return ae||((ae=bl(B,Z))!=="none"&&ae||((Z=(cl=(cl||v("<iframe frameborder='0' width='0' height='0'/>")).appendTo(Z.documentElement))[0].contentDocument).write(),Z.close(),ae=bl(B,Z),cl.detach()),El[B]=ae),ae}function li(B,Z,ae,M){var j,V={};for(j in Z)V[j]=B.style[j],B.style[j]=Z[j];for(j in M=ae.apply(B,M||[]),Z)B.style[j]=V[j];return M}var on,Re,We,ht,Ct,Lt,Dt=/^margin/,ol=new RegExp("^("+g+")(?!px)[a-z%]+$","i"),el=function(B){var Z=B.ownerDocument.defaultView;return Z&&Z.opener||(Z=e),Z.getComputedStyle(B)},Al=o.documentElement;function Vl(){Lt.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",Lt.innerHTML="",Al.appendChild(Ct);var B=e.getComputedStyle(Lt);on=B.top!=="1%",ht=B.marginLeft==="2px",Re=B.width==="4px",Lt.style.marginRight="50%",We=B.marginRight==="4px",Al.removeChild(Ct)}function lr(B,Z,ae){var M,j,V=B.style;return(j=(ae=ae||el(B))?ae.getPropertyValue(Z)||ae[Z]:void 0)!==""&&j!==void 0||v.contains(B.ownerDocument,B)||(j=v.style(B,Z)),ae&&!b.pixelMarginRight()&&ol.test(j)&&Dt.test(Z)&&(M=V.width,B=V.minWidth,Z=V.maxWidth,V.minWidth=V.maxWidth=V.width=j,j=ae.width,V.width=M,V.minWidth=B,V.maxWidth=Z),j!==void 0?j+"":j}function hn(B,Z){return{get:function(){return B()?void delete this.get:(this.get=Z).apply(this,arguments)}}}Ct=o.createElement("div"),(Lt=o.createElement("div")).style&&(Lt.style.backgroundClip="content-box",Lt.cloneNode(!0).style.backgroundClip="",b.clearCloneStyle=Lt.style.backgroundClip==="content-box",Ct.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",Ct.appendChild(Lt),v.extend(b,{pixelPosition:function(){return Vl(),on},boxSizingReliable:function(){return Re==null&&Vl(),Re},pixelMarginRight:function(){return Re==null&&Vl(),We},reliableMarginLeft:function(){return Re==null&&Vl(),ht},reliableMarginRight:function(){var B,Z=Lt.appendChild(o.createElement("div"));return Z.style.cssText=Lt.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",Z.style.marginRight=Z.style.width="0",Lt.style.width="1px",Al.appendChild(Ct),B=!parseFloat(e.getComputedStyle(Z).marginRight),Al.removeChild(Ct),Lt.removeChild(Z),B}}));var en=/^(none|table(?!-c[ea]).+)/,Mn={position:"absolute",visibility:"hidden",display:"block"},Dn={letterSpacing:"0",fontWeight:"400"},An=["Webkit","O","Moz","ms"],Br=o.createElement("div").style;function Ln(B){if(B in Br)return B;for(var Z=B[0].toUpperCase()+B.slice(1),ae=An.length;ae--;)if((B=An[ae]+Z)in Br)return B}function ri(B,Z,ae){var M=ce.exec(Z);return M?Math.max(0,M[2]-(ae||0))+(M[3]||"px"):Z}function dn(B,Z,ae,M,j){for(var V=ae===(M?"border":"content")?4:Z==="width"?1:0,U=0;V<4;V+=2)ae==="margin"&&(U+=v.css(B,ae+fe[V],!0,j)),M?(ae==="content"&&(U-=v.css(B,"padding"+fe[V],!0,j)),ae!=="margin"&&(U-=v.css(B,"border"+fe[V]+"Width",!0,j))):(U+=v.css(B,"padding"+fe[V],!0,j),ae!=="padding"&&(U+=v.css(B,"border"+fe[V]+"Width",!0,j)));return U}function zn(B,Z,ae){var M=!0,j=Z==="width"?B.offsetWidth:B.offsetHeight,V=el(B),U=v.css(B,"boxSizing",!1,V)==="border-box";if(j<=0||j==null){if(((j=lr(B,Z,V))<0||j==null)&&(j=B.style[Z]),ol.test(j))return j;M=U&&(b.boxSizingReliable()||j===B.style[Z]),j=parseFloat(j)||0}return j+dn(B,Z,ae||(U?"border":"content"),M,V)+"px"}function Hn(B,Z){for(var ae,M,j,V=[],U=0,le=B.length;U<le;U++)(M=B[U]).style&&(V[U]=ne.get(M,"olddisplay"),ae=M.style.display,Z?(V[U]||ae!=="none"||(M.style.display=""),M.style.display===""&&ge(M)&&(V[U]=ne.access(M,"olddisplay",Nr(M.nodeName)))):(j=ge(M),ae==="none"&&j||ne.set(M,"olddisplay",j?ae:v.css(M,"display"))));for(U=0;U<le;U++)(M=B[U]).style&&(Z&&M.style.display!=="none"&&M.style.display!==""||(M.style.display=Z?V[U]||"":"none"));return B}function $n(B,Z,ae,M,j){return new $n.prototype.init(B,Z,ae,M,j)}v.extend({cssHooks:{opacity:{get:function(B,Z){if(Z)return B=lr(B,"opacity"),B===""?"1":B}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(B,Z,ae,M){if(B&&B.nodeType!==3&&B.nodeType!==8&&B.style){var j,V,U,le=v.camelCase(Z),se=B.style;return Z=v.cssProps[le]||(v.cssProps[le]=Ln(le)||le),U=v.cssHooks[Z]||v.cssHooks[le],ae===void 0?U&&"get"in U&&(j=U.get(B,!1,M))!==void 0?j:se[Z]:((V=typeof ae)==="string"&&(j=ce.exec(ae))&&j[1]&&(ae=ye(B,Z,j),V="number"),void(ae!=null&&ae==ae&&(V==="number"&&(ae+=j&&j[3]||(v.cssNumber[le]?"":"px")),b.clearCloneStyle||ae!==""||Z.indexOf("background")!==0||(se[Z]="inherit"),U&&"set"in U&&(ae=U.set(B,ae,M))===void 0||(se[Z]=ae))))}},css:function(B,Z,ae,M){var j,V=v.camelCase(Z);return Z=v.cssProps[V]||(v.cssProps[V]=Ln(V)||V),(V=v.cssHooks[Z]||v.cssHooks[V])&&"get"in V&&(j=V.get(B,!0,ae)),j===void 0&&(j=lr(B,Z,M)),j==="normal"&&Z in Dn&&(j=Dn[Z]),ae===""||ae?(Z=parseFloat(j),ae===!0||isFinite(Z)?Z||0:j):j}}),v.each(["height","width"],function(B,Z){v.cssHooks[Z]={get:function(ae,M,j){return M?en.test(v.css(ae,"display"))&&ae.offsetWidth===0?li(ae,Mn,function(){return zn(ae,Z,j)}):zn(ae,Z,j):void 0},set:function(ae,M,j){var V,U=j&&el(ae),U=j&&dn(ae,Z,j,v.css(ae,"boxSizing",!1,U)==="border-box",U);return U&&(V=ce.exec(M))&&(V[3]||"px")!=="px"&&(ae.style[Z]=M,M=v.css(ae,Z)),ri(0,M,U)}}}),v.cssHooks.marginLeft=hn(b.reliableMarginLeft,function(B,Z){return Z?(parseFloat(lr(B,"marginLeft"))||B.getBoundingClientRect().left-li(B,{marginLeft:0},function(){return B.getBoundingClientRect().left}))+"px":void 0}),v.cssHooks.marginRight=hn(b.reliableMarginRight,function(B,Z){return Z?li(B,{display:"inline-block"},lr,[B,"marginRight"]):void 0}),v.each({margin:"",padding:"",border:"Width"},function(B,Z){v.cssHooks[B+Z]={expand:function(ae){for(var M=0,j={},V=typeof ae=="string"?ae.split(" "):[ae];M<4;M++)j[B+fe[M]+Z]=V[M]||V[M-2]||V[0];return j}},Dt.test(B)||(v.cssHooks[B+Z].set=ri)}),v.fn.extend({css:function(B,Z){return ue(this,function(ae,M,j){var V,U,le={},se=0;if(v.isArray(M)){for(V=el(ae),U=M.length;se<U;se++)le[M[se]]=v.css(ae,M[se],!1,V);return le}return j!==void 0?v.style(ae,M,j):v.css(ae,M)},B,Z,1<arguments.length)},show:function(){return Hn(this,!0)},hide:function(){return Hn(this)},toggle:function(B){return typeof B=="boolean"?B?this.show():this.hide():this.each(function(){ge(this)?v(this).show():v(this).hide()})}}),(v.Tween=$n).prototype={constructor:$n,init:function(B,Z,ae,M,j,V){this.elem=B,this.prop=ae,this.easing=j||v.easing._default,this.options=Z,this.start=this.now=this.cur(),this.end=M,this.unit=V||(v.cssNumber[ae]?"":"px")},cur:function(){var B=$n.propHooks[this.prop];return(B&&B.get?B:$n.propHooks._default).get(this)},run:function(B){var Z,ae=$n.propHooks[this.prop];return this.options.duration?this.pos=Z=v.easing[this.easing](B,this.options.duration*B,0,1,this.options.duration):this.pos=Z=B,this.now=(this.end-this.start)*Z+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),(ae&&ae.set?ae:$n.propHooks._default).set(this),this}},$n.prototype.init.prototype=$n.prototype,$n.propHooks={_default:{get:function(B){return B.elem.nodeType!==1||B.elem[B.prop]!=null&&B.elem.style[B.prop]==null?B.elem[B.prop]:(B=v.css(B.elem,B.prop,""))&&B!=="auto"?B:0},set:function(B){v.fx.step[B.prop]?v.fx.step[B.prop](B):B.elem.nodeType!==1||B.elem.style[v.cssProps[B.prop]]==null&&!v.cssHooks[B.prop]?B.elem[B.prop]=B.now:v.style(B.elem,B.prop,B.now+B.unit)}}},$n.propHooks.scrollTop=$n.propHooks.scrollLeft={set:function(B){B.elem.nodeType&&B.elem.parentNode&&(B.elem[B.prop]=B.now)}},v.easing={linear:function(B){return B},swing:function(B){return .5-Math.cos(B*Math.PI)/2},_default:"swing"},v.fx=$n.prototype.init,v.fx.step={};var di,qt,ul=/^(?:toggle|show|hide)$/,Sl=/queueHooks$/;function Gr(){return e.setTimeout(function(){di=void 0}),di=v.now()}function br(B,Z){var ae,M=0,j={height:B};for(Z=Z?1:0;M<4;M+=2-Z)j["margin"+(ae=fe[M])]=j["padding"+ae]=B;return Z&&(j.opacity=j.width=B),j}function Fr(B,Z,ae){for(var M,j=(Wl.tweeners[Z]||[]).concat(Wl.tweeners["*"]),V=0,U=j.length;V<U;V++)if(M=j[V].call(ae,Z,B))return M}function Wl(B,Z,ae){var M,j,V=0,U=Wl.prefilters.length,le=v.Deferred().always(function(){delete se.elem}),se=function(){if(j)return!1;for(var J=di||Gr(),J=Math.max(0,ee.startTime+ee.duration-J),He=1-(J/ee.duration||0),Ae=0,lt=ee.tweens.length;Ae<lt;Ae++)ee.tweens[Ae].run(He);return le.notifyWith(B,[ee,He,J]),He<1&&lt?J:(le.resolveWith(B,[ee]),!1)},ee=le.promise({elem:B,props:v.extend({},Z),opts:v.extend(!0,{specialEasing:{},easing:v.easing._default},ae),originalProperties:Z,originalOptions:ae,startTime:di||Gr(),duration:ae.duration,tweens:[],createTween:function(J,He){return J=v.Tween(B,ee.opts,J,He,ee.opts.specialEasing[J]||ee.opts.easing),ee.tweens.push(J),J},stop:function(J){var He=0,Ae=J?ee.tweens.length:0;if(j)return this;for(j=!0;He<Ae;He++)ee.tweens[He].run(1);return J?(le.notifyWith(B,[ee,1,0]),le.resolveWith(B,[ee,J])):le.rejectWith(B,[ee,J]),this}}),de=ee.props;for(function(J,He){var Ae,lt,vt,bt,dl;for(Ae in J)if(lt=v.camelCase(Ae),vt=He[lt],bt=J[Ae],v.isArray(bt)&&(vt=bt[1],bt=J[Ae]=bt[0]),Ae!==lt&&(J[lt]=bt,delete J[Ae]),dl=v.cssHooks[lt],dl&&"expand"in dl)for(Ae in bt=dl.expand(bt),delete J[lt],bt)Ae in J||(J[Ae]=bt[Ae],He[Ae]=vt);else He[lt]=vt}(de,ee.opts.specialEasing);V<U;V++)if(M=Wl.prefilters[V].call(ee,B,de,ee.opts))return v.isFunction(M.stop)&&(v._queueHooks(ee.elem,ee.opts.queue).stop=v.proxy(M.stop,M)),M;return v.map(de,Fr,ee),v.isFunction(ee.opts.start)&&ee.opts.start.call(B,ee),v.fx.timer(v.extend(se,{elem:B,anim:ee,queue:ee.opts.queue})),ee.progress(ee.opts.progress).done(ee.opts.done,ee.opts.complete).fail(ee.opts.fail).always(ee.opts.always)}v.Animation=v.extend(Wl,{tweeners:{"*":[function(B,Z){var ae=this.createTween(B,Z);return ye(ae.elem,B,ce.exec(Z),ae),ae}]},tweener:function(B,Z){for(var ae,M=0,j=(B=v.isFunction(B)?(Z=B,["*"]):B.match(W)).length;M<j;M++)ae=B[M],Wl.tweeners[ae]=Wl.tweeners[ae]||[],Wl.tweeners[ae].unshift(Z)},prefilters:[function(B,Z,ae){var M,j,V,U,le,se,ee,de=this,J={},He=B.style,Ae=B.nodeType&&ge(B),lt=ne.get(B,"fxshow");for(M in ae.queue||((le=v._queueHooks(B,"fx")).unqueued==null&&(le.unqueued=0,se=le.empty.fire,le.empty.fire=function(){le.unqueued||se()}),le.unqueued++,de.always(function(){de.always(function(){le.unqueued--,v.queue(B,"fx").length||le.empty.fire()})})),B.nodeType===1&&("height"in Z||"width"in Z)&&(ae.overflow=[He.overflow,He.overflowX,He.overflowY],((ee=v.css(B,"display"))==="none"?ne.get(B,"olddisplay")||Nr(B.nodeName):ee)==="inline"&&v.css(B,"float")==="none"&&(He.display="inline-block")),ae.overflow&&(He.overflow="hidden",de.always(function(){He.overflow=ae.overflow[0],He.overflowX=ae.overflow[1],He.overflowY=ae.overflow[2]})),Z)if(j=Z[M],ul.exec(j)){if(delete Z[M],V=V||j==="toggle",j===(Ae?"hide":"show")){if(j!=="show"||!lt||lt[M]===void 0)continue;Ae=!0}J[M]=lt&&lt[M]||v.style(B,M)}else ee=void 0;if(v.isEmptyObject(J))(ee==="none"?Nr(B.nodeName):ee)==="inline"&&(He.display=ee);else for(M in lt?"hidden"in lt&&(Ae=lt.hidden):lt=ne.access(B,"fxshow",{}),V&&(lt.hidden=!Ae),Ae?v(B).show():de.done(function(){v(B).hide()}),de.done(function(){for(var vt in ne.remove(B,"fxshow"),J)v.style(B,vt,J[vt])}),J)U=Fr(Ae?lt[M]:0,M,de),M in lt||(lt[M]=U.start,Ae&&(U.end=U.start,U.start=M==="width"||M==="height"?1:0))}],prefilter:function(B,Z){Z?Wl.prefilters.unshift(B):Wl.prefilters.push(B)}}),v.speed=function(B,Z,ae){var M=B&&typeof B=="object"?v.extend({},B):{complete:ae||!ae&&Z||v.isFunction(B)&&B,duration:B,easing:ae&&Z||Z&&!v.isFunction(Z)&&Z};return M.duration=v.fx.off?0:typeof M.duration=="number"?M.duration:M.duration in v.fx.speeds?v.fx.speeds[M.duration]:v.fx.speeds._default,M.queue!=null&&M.queue!==!0||(M.queue="fx"),M.old=M.complete,M.complete=function(){v.isFunction(M.old)&&M.old.call(this),M.queue&&v.dequeue(this,M.queue)},M},v.fn.extend({fadeTo:function(B,Z,ae,M){return this.filter(ge).css("opacity",0).show().end().animate({opacity:Z},B,ae,M)},animate:function(B,Z,ae,M){var j=v.isEmptyObject(B),V=v.speed(Z,ae,M),M=function(){var U=Wl(this,v.extend({},B),V);(j||ne.get(this,"finish"))&&U.stop(!0)};return M.finish=M,j||V.queue===!1?this.each(M):this.queue(V.queue,M)},stop:function(B,Z,ae){function M(j){var V=j.stop;delete j.stop,V(ae)}return typeof B!="string"&&(ae=Z,Z=B,B=void 0),Z&&B!==!1&&this.queue(B||"fx",[]),this.each(function(){var j=!0,V=B!=null&&B+"queueHooks",U=v.timers,le=ne.get(this);if(V)le[V]&&le[V].stop&&M(le[V]);else for(V in le)le[V]&&le[V].stop&&Sl.test(V)&&M(le[V]);for(V=U.length;V--;)U[V].elem!==this||B!=null&&U[V].queue!==B||(U[V].anim.stop(ae),j=!1,U.splice(V,1));!j&&ae||v.dequeue(this,B)})},finish:function(B){return B!==!1&&(B=B||"fx"),this.each(function(){var Z,ae=ne.get(this),M=ae[B+"queue"],j=ae[B+"queueHooks"],V=v.timers,U=M?M.length:0;for(ae.finish=!0,v.queue(this,B,[]),j&&j.stop&&j.stop.call(this,!0),Z=V.length;Z--;)V[Z].elem===this&&V[Z].queue===B&&(V[Z].anim.stop(!0),V.splice(Z,1));for(Z=0;Z<U;Z++)M[Z]&&M[Z].finish&&M[Z].finish.call(this);delete ae.finish})}}),v.each(["toggle","show","hide"],function(B,Z){var ae=v.fn[Z];v.fn[Z]=function(M,j,V){return M==null||typeof M=="boolean"?ae.apply(this,arguments):this.animate(br(Z,!0),M,j,V)}}),v.each({slideDown:br("show"),slideUp:br("hide"),slideToggle:br("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(B,Z){v.fn[B]=function(ae,M,j){return this.animate(Z,ae,M,j)}}),v.timers=[],v.fx.tick=function(){var B,Z=0,ae=v.timers;for(di=v.now();Z<ae.length;Z++)(B=ae[Z])()||ae[Z]!==B||ae.splice(Z--,1);ae.length||v.fx.stop(),di=void 0},v.fx.timer=function(B){v.timers.push(B),B()?v.fx.start():v.timers.pop()},v.fx.interval=13,v.fx.start=function(){qt=qt||e.setInterval(v.fx.tick,v.fx.interval)},v.fx.stop=function(){e.clearInterval(qt),qt=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fn.delay=function(B,Z){return B=v.fx&&v.fx.speeds[B]||B,Z=Z||"fx",this.queue(Z,function(ae,M){var j=e.setTimeout(ae,B);M.stop=function(){e.clearTimeout(j)}})},P=o.createElement("input"),l=o.createElement("select"),g=l.appendChild(o.createElement("option")),P.type="checkbox",b.checkOn=P.value!=="",b.optSelected=g.selected,l.disabled=!0,b.optDisabled=!g.disabled,(P=o.createElement("input")).value="t",P.type="radio",b.radioValue=P.value==="t";var ni,no=v.expr.attrHandle;v.fn.extend({attr:function(B,Z){return ue(this,v.attr,B,Z,1<arguments.length)},removeAttr:function(B){return this.each(function(){v.removeAttr(this,B)})}}),v.extend({attr:function(B,Z,ae){var M,j,V=B.nodeType;if(V!==3&&V!==8&&V!==2)return B.getAttribute===void 0?v.prop(B,Z,ae):(V===1&&v.isXMLDoc(B)||(Z=Z.toLowerCase(),j=v.attrHooks[Z]||(v.expr.match.bool.test(Z)?ni:void 0)),ae!==void 0?ae===null?void v.removeAttr(B,Z):j&&"set"in j&&(M=j.set(B,ae,Z))!==void 0?M:(B.setAttribute(Z,ae+""),ae):j&&"get"in j&&(M=j.get(B,Z))!==null?M:(M=v.find.attr(B,Z))==null?void 0:M)},attrHooks:{type:{set:function(B,Z){if(!b.radioValue&&Z==="radio"&&v.nodeName(B,"input")){var ae=B.value;return B.setAttribute("type",Z),ae&&(B.value=ae),Z}}}},removeAttr:function(B,Z){var ae,M,j=0,V=Z&&Z.match(W);if(V&&B.nodeType===1)for(;ae=V[j++];)M=v.propFix[ae]||ae,v.expr.match.bool.test(ae)&&(B[M]=!1),B.removeAttribute(ae)}}),ni={set:function(B,Z,ae){return Z===!1?v.removeAttr(B,ae):B.setAttribute(ae,ae),ae}},v.each(v.expr.match.bool.source.match(/\w+/g),function(B,Z){var ae=no[Z]||v.find.attr;no[Z]=function(M,j,V){var U,le;return V||(le=no[j],no[j]=U,U=ae(M,j,V)!=null?j.toLowerCase():null,no[j]=le),U}});var Ta=/^(?:input|select|textarea|button)$/i,ji=/^(?:a|area)$/i;v.fn.extend({prop:function(B,Z){return ue(this,v.prop,B,Z,1<arguments.length)},removeProp:function(B){return this.each(function(){delete this[v.propFix[B]||B]})}}),v.extend({prop:function(B,Z,ae){var M,j,V=B.nodeType;if(V!==3&&V!==8&&V!==2)return V===1&&v.isXMLDoc(B)||(Z=v.propFix[Z]||Z,j=v.propHooks[Z]),ae!==void 0?j&&"set"in j&&(M=j.set(B,ae,Z))!==void 0?M:B[Z]=ae:j&&"get"in j&&(M=j.get(B,Z))!==null?M:B[Z]},propHooks:{tabIndex:{get:function(B){var Z=v.find.attr(B,"tabindex");return Z?parseInt(Z,10):Ta.test(B.nodeName)||ji.test(B.nodeName)&&B.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),b.optSelected||(v.propHooks.selected={get:function(B){return B=B.parentNode,B&&B.parentNode&&B.parentNode.selectedIndex,null},set:function(B){B=B.parentNode,B&&(B.selectedIndex,B.parentNode&&B.parentNode.selectedIndex)}}),v.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){v.propFix[this.toLowerCase()]=this});var ii=/[\t\r\n\f]/g;function Bi(B){return B.getAttribute&&B.getAttribute("class")||""}v.fn.extend({addClass:function(B){var Z,ae,M,j,V,U,le=0;if(v.isFunction(B))return this.each(function(se){v(this).addClass(B.call(this,se,Bi(this)))});if(typeof B=="string"&&B){for(Z=B.match(W)||[];ae=this[le++];)if(U=Bi(ae),M=ae.nodeType===1&&(" "+U+" ").replace(ii," ")){for(V=0;j=Z[V++];)M.indexOf(" "+j+" ")<0&&(M+=j+" ");U!==(U=v.trim(M))&&ae.setAttribute("class",U)}}return this},removeClass:function(B){var Z,ae,M,j,V,U,le=0;if(v.isFunction(B))return this.each(function(se){v(this).removeClass(B.call(this,se,Bi(this)))});if(!arguments.length)return this.attr("class","");if(typeof B=="string"&&B){for(Z=B.match(W)||[];ae=this[le++];)if(U=Bi(ae),M=ae.nodeType===1&&(" "+U+" ").replace(ii," ")){for(V=0;j=Z[V++];)for(;-1<M.indexOf(" "+j+" ");)M=M.replace(" "+j+" "," ");U!==(U=v.trim(M))&&ae.setAttribute("class",U)}}return this},toggleClass:function(B,Z){var ae=typeof B;return typeof Z=="boolean"&&ae=="string"?Z?this.addClass(B):this.removeClass(B):v.isFunction(B)?this.each(function(M){v(this).toggleClass(B.call(this,M,Bi(this),Z),Z)}):this.each(function(){var M,j,V,U;if(ae=="string")for(j=0,V=v(this),U=B.match(W)||[];M=U[j++];)V.hasClass(M)?V.removeClass(M):V.addClass(M);else B!==void 0&&ae!="boolean"||((M=Bi(this))&&ne.set(this,"__className__",M),this.setAttribute&&this.setAttribute("class",!M&&B!==!1&&ne.get(this,"__className__")||""))})},hasClass:function(B){for(var Z,ae=0,M=" "+B+" ";Z=this[ae++];)if(Z.nodeType===1&&-1<(" "+Bi(Z)+" ").replace(ii," ").indexOf(M))return!0;return!1}});var As=/\r/g,zs=/[\x20\t\r\n\f]+/g;v.fn.extend({val:function(B){var Z,ae,M,j=this[0];return arguments.length?(M=v.isFunction(B),this.each(function(V){this.nodeType===1&&((V=M?B.call(this,V,v(this).val()):B)==null?V="":typeof V=="number"?V+="":v.isArray(V)&&(V=v.map(V,function(U){return U==null?"":U+""})),(Z=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()])&&"set"in Z&&Z.set(this,V,"value")!==void 0||(this.value=V))})):j?(Z=v.valHooks[j.type]||v.valHooks[j.nodeName.toLowerCase()])&&"get"in Z&&(ae=Z.get(j,"value"))!==void 0?ae:typeof(ae=j.value)=="string"?ae.replace(As,""):ae??"":void 0}}),v.extend({valHooks:{option:{get:function(B){var Z=v.find.attr(B,"value");return Z??v.trim(v.text(B)).replace(zs," ")}},select:{get:function(B){for(var Z,ae=B.options,M=B.selectedIndex,j=B.type==="select-one"||M<0,V=j?null:[],U=j?M+1:ae.length,le=M<0?U:j?M:0;le<U;le++)if(((Z=ae[le]).selected||le===M)&&(b.optDisabled?!Z.disabled:Z.getAttribute("disabled")===null)&&(!Z.parentNode.disabled||!v.nodeName(Z.parentNode,"optgroup"))){if(Z=v(Z).val(),j)return Z;V.push(Z)}return V},set:function(B,Z){for(var ae,M,j=B.options,V=v.makeArray(Z),U=j.length;U--;)((M=j[U]).selected=-1<v.inArray(v.valHooks.option.get(M),V))&&(ae=!0);return ae||(B.selectedIndex=-1),V}}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]={set:function(B,Z){return v.isArray(Z)?B.checked=-1<v.inArray(v(B).val(),Z):void 0}},b.checkOn||(v.valHooks[this].get=function(B){return B.getAttribute("value")===null?"on":B.value})});var io=/^(?:focusinfocus|focusoutblur)$/;v.extend(v.event,{trigger:function(B,Z,ae,M){var j,V,U,le,se,ee,de=[ae||o],J=p.call(B,"type")?B.type:B,He=p.call(B,"namespace")?B.namespace.split("."):[],Ae=V=ae=ae||o;if(ae.nodeType!==3&&ae.nodeType!==8&&!io.test(J+v.event.triggered)&&(-1<J.indexOf(".")&&(J=(He=J.split(".")).shift(),He.sort()),le=J.indexOf(":")<0&&"on"+J,(B=B[v.expando]?B:new v.Event(J,typeof B=="object"&&B)).isTrigger=M?2:3,B.namespace=He.join("."),B.rnamespace=B.namespace?new RegExp("(^|\\.)"+He.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,B.result=void 0,B.target||(B.target=ae),Z=Z==null?[B]:v.makeArray(Z,[B]),ee=v.event.special[J]||{},M||!ee.trigger||ee.trigger.apply(ae,Z)!==!1)){if(!M&&!ee.noBubble&&!v.isWindow(ae)){for(U=ee.delegateType||J,io.test(U+J)||(Ae=Ae.parentNode);Ae;Ae=Ae.parentNode)de.push(Ae),V=Ae;V===(ae.ownerDocument||o)&&de.push(V.defaultView||V.parentWindow||e)}for(j=0;(Ae=de[j++])&&!B.isPropagationStopped();)B.type=1<j?U:ee.bindType||J,(se=(ne.get(Ae,"events")||{})[B.type]&&ne.get(Ae,"handle"))&&se.apply(Ae,Z),(se=le&&Ae[le])&&se.apply&&te(Ae)&&(B.result=se.apply(Ae,Z),B.result===!1&&B.preventDefault());return B.type=J,M||B.isDefaultPrevented()||ee._default&&ee._default.apply(de.pop(),Z)!==!1||!te(ae)||le&&v.isFunction(ae[J])&&!v.isWindow(ae)&&((V=ae[le])&&(ae[le]=null),ae[v.event.triggered=J](),v.event.triggered=void 0,V&&(ae[le]=V)),B.result}},simulate:function(B,Z,ae){B=v.extend(new v.Event,ae,{type:B,isSimulated:!0}),v.event.trigger(B,null,Z)}}),v.fn.extend({trigger:function(B,Z){return this.each(function(){v.event.trigger(B,Z,this)})},triggerHandler:function(B,Z){var ae=this[0];return ae?v.event.trigger(B,Z,ae,!0):void 0}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(B,Z){v.fn[Z]=function(ae,M){return 0<arguments.length?this.on(Z,null,ae,M):this.trigger(Z)}}),v.fn.extend({hover:function(B,Z){return this.mouseenter(B).mouseleave(Z||B)}}),b.focusin="onfocusin"in e,b.focusin||v.each({focus:"focusin",blur:"focusout"},function(B,Z){function ae(M){v.event.simulate(Z,M.target,v.event.fix(M))}v.event.special[Z]={setup:function(){var M=this.ownerDocument||this,j=ne.access(M,Z);j||M.addEventListener(B,ae,!0),ne.access(M,Z,(j||0)+1)},teardown:function(){var M=this.ownerDocument||this,j=ne.access(M,Z)-1;j?ne.access(M,Z,j):(M.removeEventListener(B,ae,!0),ne.remove(M,Z))}}});var yo=e.location,No=v.now(),os=/\?/;v.parseJSON=function(B){return JSON.parse(B+"")},v.parseXML=function(B){var Z;if(!B||typeof B!="string")return null;try{Z=new e.DOMParser().parseFromString(B,"text/xml")}catch(ae){Z=void 0}return Z&&!Z.getElementsByTagName("parsererror").length||v.error("Invalid XML: "+B),Z};var oa=/#.*$/,as=/([?&])_=[^&]*/,pc=/^(.*?):[ \t]*([^\r\n]*)$/gm,Os=/^(?:GET|HEAD)$/,Ps=/^\/\//,ko={},aa={},Es="*/".concat("*"),Ra=o.createElement("a");function Fa(B){return function(Z,ae){typeof Z!="string"&&(ae=Z,Z="*");var M,j=0,V=Z.toLowerCase().match(W)||[];if(v.isFunction(ae))for(;M=V[j++];)M[0]==="+"?(M=M.slice(1)||"*",(B[M]=B[M]||[]).unshift(ae)):(B[M]=B[M]||[]).push(ae)}}function Ns(B,Z,ae,M){var j={},V=B===aa;function U(le){var se;return j[le]=!0,v.each(B[le]||[],function(ee,de){return de=de(Z,ae,M),typeof de!="string"||V||j[de]?V?!(se=de):void 0:(Z.dataTypes.unshift(de),U(de),!1)}),se}return U(Z.dataTypes[0])||!j["*"]&&U("*")}function Ma(B,Z){var ae,M,j=v.ajaxSettings.flatOptions||{};for(ae in Z)Z[ae]!==void 0&&((j[ae]?B:M=M||{})[ae]=Z[ae]);return M&&v.extend(!0,B,M),B}Ra.href=yo.href,v.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yo.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(yo.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Es,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(B,Z){return Z?Ma(Ma(B,v.ajaxSettings),Z):Ma(v.ajaxSettings,B)},ajaxPrefilter:Fa(ko),ajaxTransport:Fa(aa),ajax:function(B,Z){typeof B=="object"&&(Z=B,B=void 0),Z=Z||{};var ae,M,j,V,U,le,se,ee,de=v.ajaxSetup({},Z),J=de.context||de,He=de.context&&(J.nodeType||J.jquery)?v(J):v.event,Ae=v.Deferred(),lt=v.Callbacks("once memory"),vt=de.statusCode||{},bt={},dl={},Jt=0,Cl="canceled",Rl={readyState:0,getResponseHeader:function(fl){var Wt;if(Jt===2){if(!V)for(V={};Wt=pc.exec(j);)V[Wt[1].toLowerCase()]=Wt[2];Wt=V[fl.toLowerCase()]}return Wt??null},getAllResponseHeaders:function(){return Jt===2?j:null},setRequestHeader:function(fl,Wt){var ar=fl.toLowerCase();return Jt||(fl=dl[ar]=dl[ar]||fl,bt[fl]=Wt),this},overrideMimeType:function(fl){return Jt||(de.mimeType=fl),this},statusCode:function(fl){if(fl)if(Jt<2)for(var Wt in fl)vt[Wt]=[vt[Wt],fl[Wt]];else Rl.always(fl[Rl.status]);return this},abort:function(fl){return fl=fl||Cl,ae&&ae.abort(fl),Pr(0,fl),this}};if(Ae.promise(Rl).complete=lt.add,Rl.success=Rl.done,Rl.error=Rl.fail,de.url=((B||de.url||yo.href)+"").replace(oa,"").replace(Ps,yo.protocol+"//"),de.type=Z.method||Z.type||de.method||de.type,de.dataTypes=v.trim(de.dataType||"*").toLowerCase().match(W)||[""],de.crossDomain==null){le=o.createElement("a");try{le.href=de.url,le.href=le.href,de.crossDomain=Ra.protocol+"//"+Ra.host!=le.protocol+"//"+le.host}catch(fl){de.crossDomain=!0}}if(de.data&&de.processData&&typeof de.data!="string"&&(de.data=v.param(de.data,de.traditional)),Ns(ko,de,Z,Rl),Jt===2)return Rl;for(ee in(se=v.event&&de.global)&&v.active++==0&&v.event.trigger("ajaxStart"),de.type=de.type.toUpperCase(),de.hasContent=!Os.test(de.type),M=de.url,de.hasContent||(de.data&&(M=de.url+=(os.test(M)?"&":"?")+de.data,delete de.data),de.cache===!1&&(de.url=as.test(M)?M.replace(as,"$1_="+No++):M+(os.test(M)?"&":"?")+"_="+No++)),de.ifModified&&(v.lastModified[M]&&Rl.setRequestHeader("If-Modified-Since",v.lastModified[M]),v.etag[M]&&Rl.setRequestHeader("If-None-Match",v.etag[M])),(de.data&&de.hasContent&&de.contentType!==!1||Z.contentType)&&Rl.setRequestHeader("Content-Type",de.contentType),Rl.setRequestHeader("Accept",de.dataTypes[0]&&de.accepts[de.dataTypes[0]]?de.accepts[de.dataTypes[0]]+(de.dataTypes[0]!=="*"?", "+Es+"; q=0.01":""):de.accepts["*"]),de.headers)Rl.setRequestHeader(ee,de.headers[ee]);if(de.beforeSend&&(de.beforeSend.call(J,Rl,de)===!1||Jt===2))return Rl.abort();for(ee in Cl="abort",{success:1,error:1,complete:1})Rl[ee](de[ee]);if(ae=Ns(aa,de,Z,Rl)){if(Rl.readyState=1,se&&He.trigger("ajaxSend",[Rl,de]),Jt===2)return Rl;de.async&&0<de.timeout&&(U=e.setTimeout(function(){Rl.abort("timeout")},de.timeout));try{Jt=1,ae.send(bt,Pr)}catch(fl){if(!(Jt<2))throw fl;Pr(-1,fl)}}else Pr(-1,"No Transport");function Pr(fl,Wt,ar,Fl){var Ir,oi,Un,yr=Wt;Jt!==2&&(Jt=2,U&&e.clearTimeout(U),ae=void 0,j=Fl||"",Rl.readyState=0<fl?4:0,Fl=200<=fl&&fl<300||fl===304,ar&&(Un=function(Yr,wr,Xr){for(var rn,pr,$r,xr,Sn=Yr.contents,Tl=Yr.dataTypes;Tl[0]==="*";)Tl.shift(),rn===void 0&&(rn=Yr.mimeType||wr.getResponseHeader("Content-Type"));if(rn){for(pr in Sn)if(Sn[pr]&&Sn[pr].test(rn)){Tl.unshift(pr);break}}if(Tl[0]in Xr)$r=Tl[0];else{for(pr in Xr){if(!Tl[0]||Yr.converters[pr+" "+Tl[0]]){$r=pr;break}xr=xr||pr}$r=$r||xr}return $r?($r!==Tl[0]&&Tl.unshift($r),Xr[$r]):void 0}(de,Rl,ar)),Un=function(Yr,wr,Xr,rn){var pr,$r,xr,Sn,Tl,vr={},Gl=Yr.dataTypes.slice();if(Gl[1])for(xr in Yr.converters)vr[xr.toLowerCase()]=Yr.converters[xr];for($r=Gl.shift();$r;)if(Yr.responseFields[$r]&&(Xr[Yr.responseFields[$r]]=wr),!Tl&&rn&&Yr.dataFilter&&(wr=Yr.dataFilter(wr,Yr.dataType)),Tl=$r,$r=Gl.shift()){if($r==="*")$r=Tl;else if(Tl!=="*"&&Tl!==$r){if(!(xr=vr[Tl+" "+$r]||vr["* "+$r])){for(pr in vr)if(Sn=pr.split(" "),Sn[1]===$r&&(xr=vr[Tl+" "+Sn[0]]||vr["* "+Sn[0]])){xr===!0?xr=vr[pr]:vr[pr]!==!0&&($r=Sn[0],Gl.unshift(Sn[1]));break}}if(xr!==!0)if(xr&&Yr.throws)wr=xr(wr);else try{wr=xr(wr)}catch(mi){return{state:"parsererror",error:xr?mi:"No conversion from "+Tl+" to "+$r}}}}return{state:"success",data:wr}}(de,Un,Rl,Fl),Fl?(de.ifModified&&((ar=Rl.getResponseHeader("Last-Modified"))&&(v.lastModified[M]=ar),(ar=Rl.getResponseHeader("etag"))&&(v.etag[M]=ar)),fl===204||de.type==="HEAD"?yr="nocontent":fl===304?yr="notmodified":(yr=Un.state,Ir=Un.data,Fl=!(oi=Un.error))):(oi=yr,!fl&&yr||(yr="error",fl<0&&(fl=0))),Rl.status=fl,Rl.statusText=(Wt||yr)+"",Fl?Ae.resolveWith(J,[Ir,yr,Rl]):Ae.rejectWith(J,[Rl,yr,oi]),Rl.statusCode(vt),vt=void 0,se&&He.trigger(Fl?"ajaxSuccess":"ajaxError",[Rl,de,Fl?Ir:oi]),lt.fireWith(J,[Rl,yr]),se&&(He.trigger("ajaxComplete",[Rl,de]),--v.active||v.event.trigger("ajaxStop")))}return Rl},getJSON:function(B,Z,ae){return v.get(B,Z,ae,"json")},getScript:function(B,Z){return v.get(B,void 0,Z,"script")}}),v.each(["get","post"],function(B,Z){v[Z]=function(ae,M,j,V){return v.isFunction(M)&&(V=V||j,j=M,M=void 0),v.ajax(v.extend({url:ae,type:Z,dataType:V,data:M,success:j},v.isPlainObject(ae)&&ae))}}),v._evalUrl=function(B){return v.ajax({url:B,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},v.fn.extend({wrapAll:function(B){var Z;return v.isFunction(B)?this.each(function(ae){v(this).wrapAll(B.call(this,ae))}):(this[0]&&(Z=v(B,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&Z.insertBefore(this[0]),Z.map(function(){for(var ae=this;ae.firstElementChild;)ae=ae.firstElementChild;return ae}).append(this)),this)},wrapInner:function(B){return v.isFunction(B)?this.each(function(Z){v(this).wrapInner(B.call(this,Z))}):this.each(function(){var Z=v(this),ae=Z.contents();ae.length?ae.wrapAll(B):Z.append(B)})},wrap:function(B){var Z=v.isFunction(B);return this.each(function(ae){v(this).wrapAll(Z?B.call(this,ae):B)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()}}),v.expr.filters.hidden=function(B){return!v.expr.filters.visible(B)},v.expr.filters.visible=function(B){return 0<B.offsetWidth||0<B.offsetHeight||0<B.getClientRects().length};var vu=/%20/g,yu=/\[\]$/,vc=/\r?\n/g,Vr=/^(?:submit|button|image|reset|file)$/i,Or=/^(?:input|select|textarea|keygen)/i;v.param=function(B,Z){function ae(V,U){U=v.isFunction(U)?U():U??"",j[j.length]=encodeURIComponent(V)+"="+encodeURIComponent(U)}var M,j=[];if(Z===void 0&&(Z=v.ajaxSettings&&v.ajaxSettings.traditional),v.isArray(B)||B.jquery&&!v.isPlainObject(B))v.each(B,function(){ae(this.name,this.value)});else for(M in B)(function V(U,le,se,ee){if(v.isArray(le))v.each(le,function(J,He){se||yu.test(U)?ee(U,He):V(U+"["+(typeof He=="object"&&He!=null?J:"")+"]",He,se,ee)});else if(se||v.type(le)!=="object")ee(U,le);else for(var de in le)V(U+"["+de+"]",le[de],se,ee)})(M,B[M],Z,ae);return j.join("&").replace(vu,"+")},v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var B=v.prop(this,"elements");return B?v.makeArray(B):this}).filter(function(){var B=this.type;return this.name&&!v(this).is(":disabled")&&Or.test(this.nodeName)&&!Vr.test(B)&&(this.checked||!Ne.test(B))}).map(function(B,Z){var ae=v(this).val();return ae==null?null:v.isArray(ae)?v.map(ae,function(M){return{name:Z.name,value:M.replace(vc,`\r
`)}}):{name:Z.name,value:ae.replace(vc,`\r
`)}}).get()}}),v.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(B){}};var ku={0:200,1223:204},Da=v.ajaxSettings.xhr();b.cors=!!Da&&"withCredentials"in Da,b.ajax=Da=!!Da,v.ajaxTransport(function(B){var Z,ae;return b.cors||Da&&!B.crossDomain?{send:function(M,j){var V,U=B.xhr();if(U.open(B.type,B.url,B.async,B.username,B.password),B.xhrFields)for(V in B.xhrFields)U[V]=B.xhrFields[V];for(V in B.mimeType&&U.overrideMimeType&&U.overrideMimeType(B.mimeType),B.crossDomain||M["X-Requested-With"]||(M["X-Requested-With"]="XMLHttpRequest"),M)U.setRequestHeader(V,M[V]);Z=function(le){return function(){Z&&(Z=ae=U.onload=U.onerror=U.onabort=U.onreadystatechange=null,le==="abort"?U.abort():le==="error"?typeof U.status!="number"?j(0,"error"):j(U.status,U.statusText):j(ku[U.status]||U.status,U.statusText,(U.responseType||"text")!=="text"||typeof U.responseText!="string"?{binary:U.response}:{text:U.responseText},U.getAllResponseHeaders()))}},U.onload=Z(),ae=U.onerror=Z("error"),U.onabort!==void 0?U.onabort=ae:U.onreadystatechange=function(){U.readyState===4&&e.setTimeout(function(){Z&&ae()})},Z=Z("abort");try{U.send(B.hasContent&&B.data||null)}catch(le){if(Z)throw le}},abort:function(){Z&&Z()}}:void 0}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(B){return v.globalEval(B),B}}}),v.ajaxPrefilter("script",function(B){B.cache===void 0&&(B.cache=!1),B.crossDomain&&(B.type="GET")}),v.ajaxTransport("script",function(B){var Z,ae;if(B.crossDomain)return{send:function(M,j){Z=v("<script>").prop({charset:B.scriptCharset,src:B.url}).on("load error",ae=function(V){Z.remove(),ae=null,V&&j(V.type==="error"?404:200,V.type)}),o.head.appendChild(Z[0])},abort:function(){ae&&ae()}}});var ss=[],mn=/(=)\?(?=&|$)|\?\?/;v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var B=ss.pop()||v.expando+"_"+No++;return this[B]=!0,B}}),v.ajaxPrefilter("json jsonp",function(B,Z,ae){var M,j,V,U=B.jsonp!==!1&&(mn.test(B.url)?"url":typeof B.data=="string"&&(B.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&mn.test(B.data)&&"data");return U||B.dataTypes[0]==="jsonp"?(M=B.jsonpCallback=v.isFunction(B.jsonpCallback)?B.jsonpCallback():B.jsonpCallback,U?B[U]=B[U].replace(mn,"$1"+M):B.jsonp!==!1&&(B.url+=(os.test(B.url)?"&":"?")+B.jsonp+"="+M),B.converters["script json"]=function(){return V||v.error(M+" was not called"),V[0]},B.dataTypes[0]="json",j=e[M],e[M]=function(){V=arguments},ae.always(function(){j===void 0?v(e).removeProp(M):e[M]=j,B[M]&&(B.jsonpCallback=Z.jsonpCallback,ss.push(M)),V&&v.isFunction(j)&&j(V[0]),V=j=void 0}),"script"):void 0}),v.parseHTML=function(B,Z,ae){if(!B||typeof B!="string")return null;typeof Z=="boolean"&&(ae=Z,Z=!1),Z=Z||o;var M=w.exec(B),ae=!ae&&[];return M?[Z.createElement(M[1])]:(M=xt([B],Z,ae),ae&&ae.length&&v(ae).remove(),v.merge([],M.childNodes))};var Lo=v.fn.load;function Aa(B){return v.isWindow(B)?B:B.nodeType===9&&B.defaultView}v.fn.load=function(B,Z,ae){if(typeof B!="string"&&Lo)return Lo.apply(this,arguments);var M,j,V,U=this,le=B.indexOf(" ");return-1<le&&(M=v.trim(B.slice(le)),B=B.slice(0,le)),v.isFunction(Z)?(ae=Z,Z=void 0):Z&&typeof Z=="object"&&(j="POST"),0<U.length&&v.ajax({url:B,type:j||"GET",dataType:"html",data:Z}).done(function(se){V=arguments,U.html(M?v("<div>").append(v.parseHTML(se)).find(M):se)}).always(ae&&function(se,ee){U.each(function(){ae.apply(this,V||[se.responseText,ee,se])})}),this},v.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(B,Z){v.fn[Z]=function(ae){return this.on(Z,ae)}}),v.expr.filters.animated=function(B){return v.grep(v.timers,function(Z){return B===Z.elem}).length},v.offset={setOffset:function(B,Z,ae){var M,j,V,U,le=v.css(B,"position"),se=v(B),ee={};le==="static"&&(B.style.position="relative"),V=se.offset(),M=v.css(B,"top"),U=v.css(B,"left"),U=(le==="absolute"||le==="fixed")&&-1<(M+U).indexOf("auto")?(j=(le=se.position()).top,le.left):(j=parseFloat(M)||0,parseFloat(U)||0),v.isFunction(Z)&&(Z=Z.call(B,ae,v.extend({},V))),Z.top!=null&&(ee.top=Z.top-V.top+j),Z.left!=null&&(ee.left=Z.left-V.left+U),"using"in Z?Z.using.call(B,ee):se.css(ee)}},v.fn.extend({offset:function(B){if(arguments.length)return B===void 0?this:this.each(function(V){v.offset.setOffset(this,B,V)});var Z,ae=this[0],M={top:0,left:0},j=ae&&ae.ownerDocument;return j?(Z=j.documentElement,v.contains(Z,ae)?(M=ae.getBoundingClientRect(),j=Aa(j),{top:M.top+j.pageYOffset-Z.clientTop,left:M.left+j.pageXOffset-Z.clientLeft}):M):void 0},position:function(){if(this[0]){var B,Z,ae=this[0],M={top:0,left:0};return v.css(ae,"position")==="fixed"?Z=ae.getBoundingClientRect():(B=this.offsetParent(),Z=this.offset(),v.nodeName(B[0],"html")||(M=B.offset()),M.top+=v.css(B[0],"borderTopWidth",!0),M.left+=v.css(B[0],"borderLeftWidth",!0)),{top:Z.top-M.top-v.css(ae,"marginTop",!0),left:Z.left-M.left-v.css(ae,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var B=this.offsetParent;B&&v.css(B,"position")==="static";)B=B.offsetParent;return B||Al})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(B,Z){var ae=Z==="pageYOffset";v.fn[B]=function(M){return ue(this,function(j,V,U){var le=Aa(j);return U===void 0?le?le[Z]:j[V]:void(le?le.scrollTo(ae?le.pageXOffset:U,ae?U:le.pageYOffset):j[V]=U)},B,M,arguments.length)}}),v.each(["top","left"],function(B,Z){v.cssHooks[Z]=hn(b.pixelPosition,function(ae,M){return M?(M=lr(ae,Z),ol.test(M)?v(ae).position()[Z]+"px":M):void 0})}),v.each({Height:"height",Width:"width"},function(B,Z){v.each({padding:"inner"+B,content:Z,"":"outer"+B},function(ae,M){v.fn[M]=function(j,V){var U=arguments.length&&(ae||typeof j!="boolean"),le=ae||(j===!0||V===!0?"margin":"border");return ue(this,function(se,ee,de){var J;return v.isWindow(se)?se.document.documentElement["client"+B]:se.nodeType===9?(J=se.documentElement,Math.max(se.body["scroll"+B],J["scroll"+B],se.body["offset"+B],J["offset"+B],J["client"+B])):de===void 0?v.css(se,ee,le):v.style(se,ee,de,le)},Z,U?j:void 0,U,null)}})}),v.fn.extend({bind:function(B,Z,ae){return this.on(B,null,Z,ae)},unbind:function(B,Z){return this.off(B,null,Z)},delegate:function(B,Z,ae,M){return this.on(Z,B,ae,M)},undelegate:function(B,Z,ae){return arguments.length===1?this.off(B,"**"):this.off(Z,B||"**",ae)},size:function(){return this.length}}),v.fn.andSelf=v.fn.addBack,typeof define=="function"&&define.amd&&define("jquery",[],function(){return v});var cs=e.jQuery,Ls=e.$;return v.noConflict=function(B){return e.$===v&&(e.$=Ls),B&&e.jQuery===v&&(e.jQuery=cs),v},n||(e.jQuery=e.$=v),v}),function(e,n){typeof Bn=="object"&&typeof Zn!="undefined"?n(Bn):typeof define=="function"&&define.amd?define(["exports"],n):n((e=typeof globalThis!="undefined"?globalThis:e||self).uuid={})}(Bn,function(e){"use strict";var n,t=new Uint8Array(16);function l(){if(!n&&!(n=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(t)}var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function a(T){return typeof T=="string"&&o.test(T)}for(var s,u,f=[],m=0;m<256;++m)f.push((m+256).toString(16).substr(1));function d(T){var O=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,O=(f[T[O+0]]+f[T[O+1]]+f[T[O+2]]+f[T[O+3]]+"-"+f[T[O+4]]+f[T[O+5]]+"-"+f[T[O+6]]+f[T[O+7]]+"-"+f[T[O+8]]+f[T[O+9]]+"-"+f[T[O+10]]+f[T[O+11]]+f[T[O+12]]+f[T[O+13]]+f[T[O+14]]+f[T[O+15]]).toLowerCase();if(!a(O))throw TypeError("Stringified UUID is invalid");return O}var p=0,b=0;function g(T){if(!a(T))throw TypeError("Invalid UUID");var O,z=new Uint8Array(16);return z[0]=(O=parseInt(T.slice(0,8),16))>>>24,z[1]=O>>>16&255,z[2]=O>>>8&255,z[3]=255&O,z[4]=(O=parseInt(T.slice(9,13),16))>>>8,z[5]=255&O,z[6]=(O=parseInt(T.slice(14,18),16))>>>8,z[7]=255&O,z[8]=(O=parseInt(T.slice(19,23),16))>>>8,z[9]=255&O,z[10]=(O=parseInt(T.slice(24,36),16))/1099511627776&255,z[11]=O/4294967296&255,z[12]=O>>>24&255,z[13]=O>>>16&255,z[14]=O>>>8&255,z[15]=255&O,z}function v(T,O,z){function A(E,L,N,W){if(typeof E=="string"&&(E=function(ue){ue=unescape(encodeURIComponent(ue));for(var pe=[],ne=0;ne<ue.length;++ne)pe.push(ue.charCodeAt(ne));return pe}(E)),typeof L=="string"&&(L=g(L)),L.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var X=new Uint8Array(16+E.length);if(X.set(L),X.set(E,L.length),(X=z(X))[6]=15&X[6]|O,X[8]=63&X[8]|128,N){W=W||0;for(var te=0;te<16;++te)N[W+te]=X[te];return N}return d(X)}try{A.name=T}catch(E){}return A.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",A.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",A}function x(T){return 14+(T+64>>>9<<4)+1}function _(T,O){var z=(65535&T)+(65535&O);return(T>>16)+(O>>16)+(z>>16)<<16|65535&z}function S(T,O,z,A,E,L){return _((L=_(_(O,T),_(A,L)))<<E|L>>>32-E,z)}function I(T,O,z,A,E,L,N){return S(O&z|~O&A,T,O,E,L,N)}function P(T,O,z,A,E,L,N){return S(O&A|z&~A,T,O,E,L,N)}function F(T,O,z,A,E,L,N){return S(O^z^A,T,O,E,L,N)}function D(T,O,z,A,E,L,N){return S(z^(O|~A),T,O,E,L,N)}var k=v("v3",48,function(T){if(typeof T=="string"){var O=unescape(encodeURIComponent(T));T=new Uint8Array(O.length);for(var z=0;z<O.length;++z)T[z]=O.charCodeAt(z)}return function(A){for(var E=[],L=32*A.length,N="0123456789abcdef",W=0;W<L;W+=8){var X=A[W>>5]>>>W%32&255,X=parseInt(N.charAt(X>>>4&15)+N.charAt(15&X),16);E.push(X)}return E}(function(A,E){A[E>>5]|=128<<E%32,A[x(E)-1]=E;for(var L=1732584193,N=-271733879,W=-1732584194,X=271733878,te=0;te<A.length;te+=16){var ue=L,pe=N,ne=W,me=X,L=I(L,N,W,X,A[te],7,-680876936),X=I(X,L,N,W,A[te+1],12,-389564586),W=I(W,X,L,N,A[te+2],17,606105819),N=I(N,W,X,L,A[te+3],22,-1044525330);L=I(L,N,W,X,A[te+4],7,-176418897),X=I(X,L,N,W,A[te+5],12,1200080426),W=I(W,X,L,N,A[te+6],17,-1473231341),N=I(N,W,X,L,A[te+7],22,-45705983),L=I(L,N,W,X,A[te+8],7,1770035416),X=I(X,L,N,W,A[te+9],12,-1958414417),W=I(W,X,L,N,A[te+10],17,-42063),N=I(N,W,X,L,A[te+11],22,-1990404162),L=I(L,N,W,X,A[te+12],7,1804603682),X=I(X,L,N,W,A[te+13],12,-40341101),W=I(W,X,L,N,A[te+14],17,-1502002290),L=P(L,N=I(N,W,X,L,A[te+15],22,1236535329),W,X,A[te+1],5,-165796510),X=P(X,L,N,W,A[te+6],9,-1069501632),W=P(W,X,L,N,A[te+11],14,643717713),N=P(N,W,X,L,A[te],20,-373897302),L=P(L,N,W,X,A[te+5],5,-701558691),X=P(X,L,N,W,A[te+10],9,38016083),W=P(W,X,L,N,A[te+15],14,-660478335),N=P(N,W,X,L,A[te+4],20,-405537848),L=P(L,N,W,X,A[te+9],5,568446438),X=P(X,L,N,W,A[te+14],9,-1019803690),W=P(W,X,L,N,A[te+3],14,-187363961),N=P(N,W,X,L,A[te+8],20,1163531501),L=P(L,N,W,X,A[te+13],5,-1444681467),X=P(X,L,N,W,A[te+2],9,-51403784),W=P(W,X,L,N,A[te+7],14,1735328473),L=F(L,N=P(N,W,X,L,A[te+12],20,-1926607734),W,X,A[te+5],4,-378558),X=F(X,L,N,W,A[te+8],11,-2022574463),W=F(W,X,L,N,A[te+11],16,1839030562),N=F(N,W,X,L,A[te+14],23,-35309556),L=F(L,N,W,X,A[te+1],4,-1530992060),X=F(X,L,N,W,A[te+4],11,1272893353),W=F(W,X,L,N,A[te+7],16,-155497632),N=F(N,W,X,L,A[te+10],23,-1094730640),L=F(L,N,W,X,A[te+13],4,681279174),X=F(X,L,N,W,A[te],11,-358537222),W=F(W,X,L,N,A[te+3],16,-722521979),N=F(N,W,X,L,A[te+6],23,76029189),L=F(L,N,W,X,A[te+9],4,-640364487),X=F(X,L,N,W,A[te+12],11,-421815835),W=F(W,X,L,N,A[te+15],16,530742520),L=D(L,N=F(N,W,X,L,A[te+2],23,-995338651),W,X,A[te],6,-198630844),X=D(X,L,N,W,A[te+7],10,1126891415),W=D(W,X,L,N,A[te+14],15,-1416354905),N=D(N,W,X,L,A[te+5],21,-57434055),L=D(L,N,W,X,A[te+12],6,1700485571),X=D(X,L,N,W,A[te+3],10,-1894986606),W=D(W,X,L,N,A[te+10],15,-1051523),N=D(N,W,X,L,A[te+1],21,-2054922799),L=D(L,N,W,X,A[te+8],6,1873313359),X=D(X,L,N,W,A[te+15],10,-30611744),W=D(W,X,L,N,A[te+6],15,-1560198380),N=D(N,W,X,L,A[te+13],21,1309151649),L=D(L,N,W,X,A[te+4],6,-145523070),X=D(X,L,N,W,A[te+11],10,-1120210379),W=D(W,X,L,N,A[te+2],15,718787259),N=D(N,W,X,L,A[te+9],21,-343485551),L=_(L,ue),N=_(N,pe),W=_(W,ne),X=_(X,me)}return[L,N,W,X]}(function(A){if(A.length===0)return[];for(var E=8*A.length,L=new Uint32Array(x(E)),N=0;N<E;N+=8)L[N>>5]|=(255&A[N/8])<<N%32;return L}(T),8*T.length))});function w(T,O){return T<<O|T>>>32-O}var C=v("v5",80,function(T){var O=[1518500249,1859775393,2400959708,3395469782],z=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof T=="string"){var A=unescape(encodeURIComponent(T));T=[];for(var E=0;E<A.length;++E)T.push(A.charCodeAt(E))}else Array.isArray(T)||(T=Array.prototype.slice.call(T));T.push(128);for(var L=T.length/4+2,N=Math.ceil(L/16),W=new Array(N),X=0;X<N;++X){for(var te=new Uint32Array(16),ue=0;ue<16;++ue)te[ue]=T[64*X+4*ue]<<24|T[64*X+4*ue+1]<<16|T[64*X+4*ue+2]<<8|T[64*X+4*ue+3];W[X]=te}W[N-1][14]=8*(T.length-1)/Math.pow(2,32),W[N-1][14]=Math.floor(W[N-1][14]),W[N-1][15]=8*(T.length-1)&4294967295;for(var pe=0;pe<N;++pe){for(var ne=new Uint32Array(80),me=0;me<16;++me)ne[me]=W[pe][me];for(var Q=16;Q<80;++Q)ne[Q]=w(ne[Q-3]^ne[Q-8]^ne[Q-14]^ne[Q-16],1);for(var we=z[0],ie=z[1],ge=z[2],ce=z[3],fe=z[4],ye=0;ye<80;++ye)var Ne=Math.floor(ye/20),Ne=w(we,5)+function(xe,et,Fe,it){switch(xe){case 0:return et&Fe^~et&it;case 1:return et^Fe^it;case 2:return et&Fe^et&it^Fe&it;case 3:return et^Fe^it}}(Ne,ie,ge,ce)+fe+O[Ne]+ne[ye]>>>0,fe=ce,ce=ge,ge=w(ie,30)>>>0,ie=we,we=Ne;z[0]=z[0]+we>>>0,z[1]=z[1]+ie>>>0,z[2]=z[2]+ge>>>0,z[3]=z[3]+ce>>>0,z[4]=z[4]+fe>>>0}return[z[0]>>24&255,z[0]>>16&255,z[0]>>8&255,255&z[0],z[1]>>24&255,z[1]>>16&255,z[1]>>8&255,255&z[1],z[2]>>24&255,z[2]>>16&255,z[2]>>8&255,255&z[2],z[3]>>24&255,z[3]>>16&255,z[3]>>8&255,255&z[3],z[4]>>24&255,z[4]>>16&255,z[4]>>8&255,255&z[4]]});e.NIL="00000000-0000-0000-0000-000000000000",e.parse=g,e.stringify=d,e.v1=function(T,O,z){var A=O&&z||0,E=O||new Array(16),L=(T=T||{}).node||s,N=T.clockseq!==void 0?T.clockseq:u;L!=null&&N!=null||(X=T.random||(T.rng||l)(),L==null&&(L=s=[1|X[0],X[1],X[2],X[3],X[4],X[5]]),N==null&&(N=u=16383&(X[6]<<8|X[7])));var W=T.msecs!==void 0?T.msecs:Date.now(),z=T.nsecs!==void 0?T.nsecs:b+1,X=W-p+(z-b)/1e4;if(X<0&&T.clockseq===void 0&&(N=N+1&16383),(X<0||p<W)&&T.nsecs===void 0&&(z=0),1e4<=z)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=W,u=N,z=(1e4*(268435455&(W+=122192928e5))+(b=z))%4294967296,E[A++]=z>>>24&255,E[A++]=z>>>16&255,E[A++]=z>>>8&255,E[A++]=255&z,W=W/4294967296*1e4&268435455,E[A++]=W>>>8&255,E[A++]=255&W,E[A++]=W>>>24&15|16,E[A++]=W>>>16&255,E[A++]=N>>>8|128,E[A++]=255&N;for(var te=0;te<6;++te)E[A+te]=L[te];return O||d(E)},e.v3=k,e.v4=function(T,O,z){var A=(T=T||{}).random||(T.rng||l)();if(A[6]=15&A[6]|64,A[8]=63&A[8]|128,O){z=z||0;for(var E=0;E<16;++E)O[z+E]=A[E];return O}return d(A)},e.v5=C,e.validate=a,e.version=function(T){if(!a(T))throw TypeError("Invalid UUID");return parseInt(T.substr(14,1),16)},Object.defineProperty(e,"__esModule",{value:!0})}),function(e,n){typeof Bn=="object"&&typeof Zn=="object"?Zn.exports=n():typeof define=="function"&&define.amd?define([],n):typeof Bn=="object"?Bn.clipboard=n():e.clipboard=n()}(Bn,function(){return t={},e.m=n=[function(l,o,a){"use strict";function s(D){var k=new F,D=function(w,C,T){x("listener called"),w.success=!0,C.forEach(function(O,z){T.clipboardData.setData(z,O),z===I&&T.clipboardData.getData(z)!=O&&(x("setting text/plain failed"),w.success=!1)}),T.preventDefault()}.bind(this,k,D);document.addEventListener("copy",D);try{document.execCommand("copy")}finally{document.removeEventListener("copy",D)}return k.success}function u(D,k){return f(D),k=s(k),m(),k}function f(D){var k=document.getSelection(),w=document.createRange();w.selectNodeContents(D),k.removeAllRanges(),k.addRange(w)}function m(){document.getSelection().removeAllRanges()}function d(){return typeof ClipboardEvent=="undefined"&&window.clipboardData!==void 0&&window.clipboardData.setData!==void 0}function p(){return new v(function(D,k){var w=window.clipboardData.getData("Text");w===""?k(new Error("Empty clipboard or could not read plain text from clipboard")):D(w)})}Object.defineProperty(o,"__esModule",{value:!0});var b=a(1),g=a(5),v=typeof Promise=="undefined"?b.Promise:Promise,x=function(D){},_=!0,S=function(){(console.warn||console.log).call(arguments)}.bind(console,"[clipboard-polyfill]"),I="text/plain",b=(P.setDebugLog=function(D){x=D},P.suppressWarnings=function(){_=!1,g.suppressDTWarnings()},P.write=function(D){return _&&!D.getData(I)&&S("clipboard.write() was called without a `text/plain` data type. On some platforms, this may result in an empty clipboard. Call clipboard.suppressWarnings() to suppress this warning."),new v(function(k,w){if(d())(function(O){if((O=O.getData(I))!==void 0)return window.clipboardData.setData("Text",O);throw"No `text/plain` value was specified."})(D)?k():w(new Error("Copying failed, possibly because the user rejected it."));else{if(s(D))return x("regular execCopy worked"),void k();if(-1<navigator.userAgent.indexOf("Edge"))return x('UA "Edge" => assuming success'),void k();if(u(document.body,D))return x("copyUsingTempSelection worked"),void k();if(T=D,(C=document.createElement("div")).setAttribute("style","-webkit-user-select: text !important"),C.textContent="temporary element",document.body.appendChild(C),T=u(C,T),document.body.removeChild(C),T)return x("copyUsingTempElem worked"),void k();var C,T=D.getData(I);if(T!==void 0&&function(O){x("copyTextUsingDOM");var z=document.createElement("div");z.setAttribute("style","-webkit-user-select: text !important");var A=z;z.attachShadow&&(x("Using shadow DOM."),A=z.attachShadow({mode:"open"}));var E=document.createElement("span");return E.innerText=O,A.appendChild(E),document.body.appendChild(z),f(E),E=document.execCommand("copy"),m(),document.body.removeChild(z),E}(T))return x("copyTextUsingDOM worked"),void k();w(new Error("Copy command failed."))}})},P.writeText=function(D){if(navigator.clipboard&&navigator.clipboard.writeText)return navigator.clipboard.writeText(D);var k=new g.DT;return k.setData(I,D),this.write(k)},P.read=function(){return new v(function(D,k){d()?p().then(function(w){return D((C=w,(w=new g.DT).setData(I,C),w));var C},k):k("Read is not supported in your browser.")})},P.readText=function(){return navigator.clipboard&&navigator.clipboard.readText?navigator.clipboard.readText():d()?p():new v(function(D,k){k("Read is not supported in your browser.")})},P.DT=g.DT,P);function P(){}o.default=b;var F=function(){this.success=!1};l.exports=b},function(l,o,a){(function(s,u){l.exports=function(){"use strict";function f(_e){var Qe=typeof _e;return _e!==null&&(Qe==="object"||Qe==="function")}function m(_e){return typeof _e=="function"}function d(_e){it=_e}function p(_e){wt=_e}function b(){return Fe!==void 0?function(){Fe(v)}:g()}function g(){var _e=setTimeout;return function(){return _e(v,1)}}function v(){for(var _e=0;_e<et;_e+=2)(0,be[_e])(be[_e+1]),be[_e]=void 0,be[_e+1]=void 0;et=0}function x(_e,Qe){var Je=arguments,Ke=this,gt=new this.constructor(S);gt[Oe]===void 0&&pe(gt);var At=Ke._state;return At?function(){var cl=Je[At-1];wt(function(){return X(At,gt,cl,Ke._result)})}():E(Ke,gt,_e,Qe),gt}function _(_e){var Qe=this;if(_e&&typeof _e=="object"&&_e.constructor===Qe)return _e;var Je=new Qe(S);return T(Je,_e),Je}function S(){}function I(){return new TypeError("You cannot resolve a promise with itself")}function P(){return new TypeError("A promises callback cannot return that same promise.")}function F(_e){try{return _e.then}catch(Qe){return nt.error=Qe,nt}}function D(_e,Qe,Je,Ke){try{_e.call(Qe,Je,Ke)}catch(gt){return gt}}function k(_e,Qe,Je){wt(function(Ke){var gt=!1,At=D(Je,Qe,function(cl){gt||(gt=!0,Qe!==cl?T(Ke,cl):z(Ke,cl))},function(cl){gt||(gt=!0,A(Ke,cl))},"Settle: "+(Ke._label||" unknown promise"));!gt&&At&&(gt=!0,A(Ke,At))},_e)}function w(_e,Qe){Qe._state===Le?z(_e,Qe._result):Qe._state===Ee?A(_e,Qe._result):E(Qe,void 0,function(Je){return T(_e,Je)},function(Je){return A(_e,Je)})}function C(_e,Qe,Je){Qe.constructor===_e.constructor&&Je===x&&Qe.constructor.resolve===_?w(_e,Qe):Je===nt?(A(_e,nt.error),nt.error=null):Je===void 0?z(_e,Qe):m(Je)?k(_e,Qe,Je):z(_e,Qe)}function T(_e,Qe){_e===Qe?A(_e,I()):f(Qe)?C(_e,Qe,F(Qe)):z(_e,Qe)}function O(_e){_e._onerror&&_e._onerror(_e._result),L(_e)}function z(_e,Qe){_e._state===Xe&&(_e._result=Qe,_e._state=Le,_e._subscribers.length!==0&&wt(L,_e))}function A(_e,Qe){_e._state===Xe&&(_e._state=Ee,_e._result=Qe,wt(O,_e))}function E(_e,Qe,Je,Ke){var gt=_e._subscribers,At=gt.length;_e._onerror=null,gt[At]=Qe,gt[At+Le]=Je,gt[At+Ee]=Ke,At===0&&_e._state&&wt(L,_e)}function L(_e){var Qe=_e._subscribers,Je=_e._state;if(Qe.length!==0){for(var Ke=void 0,gt=void 0,At=_e._result,cl=0;cl<Qe.length;cl+=3)Ke=Qe[cl],gt=Qe[cl+Je],Ke?X(Je,Ke,gt,At):gt(At);_e._subscribers.length=0}}function N(){this.error=null}function W(_e,Qe){try{return _e(Qe)}catch(Je){return Ze.error=Je,Ze}}function X(_e,Qe,Je,Ke){var gt=m(Je),At=void 0,cl=void 0,El=void 0,bl=void 0;if(gt){if(At=W(Je,Ke),At===Ze?(bl=!0,cl=At.error,At.error=null):El=!0,Qe===At)return void A(Qe,P())}else At=Ke,El=!0;Qe._state!==Xe||(gt&&El?T(Qe,At):bl?A(Qe,cl):_e===Le?z(Qe,At):_e===Ee&&A(Qe,At))}function te(_e,Qe){try{Qe(function(Je){T(_e,Je)},function(Je){A(_e,Je)})}catch(Je){A(_e,Je)}}function ue(){return ze++}function pe(_e){_e[Oe]=ze++,_e._state=void 0,_e._result=void 0,_e._subscribers=[]}function ne(_e,Qe){this._instanceConstructor=_e,this.promise=new _e(S),this.promise[Oe]||pe(this.promise),xe(Qe)?(this.length=Qe.length,this._remaining=Qe.length,this._result=new Array(this.length),this.length===0?z(this.promise,this._result):(this.length=this.length||0,this._enumerate(Qe),this._remaining===0&&z(this.promise,this._result))):A(this.promise,me())}function me(){return new Error("Array Methods must be provided an Array")}function Q(_e){return new ne(this,_e).promise}function we(_e){var Qe=this;return new Qe(xe(_e)?function(Je,Ke){for(var gt=_e.length,At=0;At<gt;At++)Qe.resolve(_e[At]).then(Je,Ke)}:function(Je,Ke){return Ke(new TypeError("You must pass an array to race."))})}function ie(_e){var Qe=this,Je=new Qe(S);return A(Je,_e),Je}function ge(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ce(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function fe(_e){this[Oe]=ue(),this._result=this._state=void 0,this._subscribers=[],S!==_e&&(typeof _e!="function"&&ge(),this instanceof fe?te(this,_e):ce())}function ye(){var _e=void 0;if(u!==void 0)_e=u;else if(typeof self!="undefined")_e=self;else try{_e=Function("return this")()}catch(Ke){throw new Error("polyfill failed because global object is unavailable in this environment")}var Qe=_e.Promise;if(Qe){var Je=null;try{Je=Object.prototype.toString.call(Qe.resolve())}catch(Ke){}if(Je==="[object Promise]"&&!Qe.cast)return}_e.Promise=fe}var Ne=void 0,xe=Ne=Array.isArray?Array.isArray:function(_e){return Object.prototype.toString.call(_e)==="[object Array]"},et=0,Fe=void 0,it=void 0,wt=function(_e,Qe){be[et]=_e,be[et+1]=Qe,(et+=2)===2&&(it?it(v):Te())},ot=typeof window!="undefined"?window:void 0,xt=ot||{},Ft=xt.MutationObserver||xt.WebKitMutationObserver,Se=typeof self=="undefined"&&s!==void 0&&{}.toString.call(s)==="[object process]",oe=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined",be=new Array(1e3),Te=void 0;Te=Se?function(){return function(){return s.nextTick(v)}}():Ft?function(){var _e=0,Qe=new Ft(v),Je=document.createTextNode("");return Qe.observe(Je,{characterData:!0}),function(){Je.data=_e=++_e%2}}():oe?function(){var _e=new MessageChannel;return _e.port1.onmessage=v,function(){return _e.port2.postMessage(0)}}():ot===void 0?function(){try{var _e=a(4);return Fe=_e.runOnLoop||_e.runOnContext,b()}catch(Qe){return g()}}():g();var Oe=Math.random().toString(36).substring(16),Xe=void 0,Le=1,Ee=2,nt=new N,Ze=new N,ze=0;return ne.prototype._enumerate=function(_e){for(var Qe=0;this._state===Xe&&Qe<_e.length;Qe++)this._eachEntry(_e[Qe],Qe)},ne.prototype._eachEntry=function(_e,Qe){var Je=this._instanceConstructor,Ke=Je.resolve;if(Ke===_){var gt=F(_e);if(gt===x&&_e._state!==Xe)this._settledAt(_e._state,Qe,_e._result);else if(typeof gt!="function")this._remaining--,this._result[Qe]=_e;else if(Je===fe){var At=new Je(S);C(At,_e,gt),this._willSettleAt(At,Qe)}else this._willSettleAt(new Je(function(cl){return cl(_e)}),Qe)}else this._willSettleAt(Ke(_e),Qe)},ne.prototype._settledAt=function(_e,Qe,Je){var Ke=this.promise;Ke._state===Xe&&(this._remaining--,_e===Ee?A(Ke,Je):this._result[Qe]=Je),this._remaining===0&&z(Ke,this._result)},ne.prototype._willSettleAt=function(_e,Qe){var Je=this;E(_e,void 0,function(Ke){return Je._settledAt(Le,Qe,Ke)},function(Ke){return Je._settledAt(Ee,Qe,Ke)})},fe.all=Q,fe.race=we,fe.resolve=_,fe.reject=ie,fe._setScheduler=d,fe._setAsap=p,fe._asap=wt,fe.prototype={constructor:fe,then:x,catch:function(_e){return this.then(null,_e)}},fe.polyfill=ye,fe.Promise=fe}()}).call(o,a(2),a(3))},function(l,o){function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(I){if(b===setTimeout)return setTimeout(I,0);if((b===a||!b)&&setTimeout)return b=setTimeout,setTimeout(I,0);try{return b(I,0)}catch(P){try{return b.call(null,I,0)}catch(F){return b.call(this,I,0)}}}function f(){_&&v&&(_=!1,v.length?x=v.concat(x):S=-1,x.length&&m())}function m(){if(!_){var I=u(f);_=!0;for(var P=x.length;P;){for(v=x,x=[];++S<P;)v&&v[S].run();S=-1,P=x.length}v=null,_=!1,function(F){if(g===clearTimeout)return clearTimeout(F);if((g===s||!g)&&clearTimeout)return g=clearTimeout,clearTimeout(F);try{g(F)}catch(D){try{return g.call(null,F)}catch(k){return g.call(this,F)}}}(I)}}function d(I,P){this.fun=I,this.array=P}function p(){}var b,g,l=l.exports={};(function(){try{b=typeof setTimeout=="function"?setTimeout:a}catch(I){b=a}try{g=typeof clearTimeout=="function"?clearTimeout:s}catch(I){g=s}})();var v,x=[],_=!1,S=-1;l.nextTick=function(I){var P=new Array(arguments.length-1);if(1<arguments.length)for(var F=1;F<arguments.length;F++)P[F-1]=arguments[F];x.push(new d(I,P)),x.length!==1||_||u(m)},d.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=p,l.addListener=p,l.once=p,l.off=p,l.removeListener=p,l.removeAllListeners=p,l.emit=p,l.prependListener=p,l.prependOnceListener=p,l.listeners=function(I){return[]},l.binding=function(I){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(I){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(l,o){var a=function(){return this}();try{a=a||Function("return this")()||(0,eval)("this")}catch(s){typeof window=="object"&&(a=window)}l.exports=a},function(l,o){},function(l,o,a){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var s=["text/plain","text/html"],u=function(){(console.warn||console.log).call(arguments)}.bind(console,"[clipboard-polyfill]"),f=!0;o.suppressDTWarnings=function(){f=!1};var m=(d.prototype.setData=function(p,b){f&&s.indexOf(p)===-1&&u("Unknown data type: "+p,"Call clipboard.suppressWarnings() to suppress this warning."),this.m[p]=b},d.prototype.getData=function(p){return this.m[p]},d.prototype.forEach=function(p){for(var b in this.m)p(this.m[b],b)},d);function d(){this.m={}}o.DT=m}],e.c=t,e.d=function(l,o,a){e.o(l,o)||Object.defineProperty(l,o,{configurable:!1,enumerable:!0,get:a})},e.n=function(l){var o=l&&l.__esModule?function(){return l.default}:function(){return l};return e.d(o,"a",o),o},e.o=function(l,o){return Object.prototype.hasOwnProperty.call(l,o)},e.p="",e(e.s=0);function e(l){if(t[l])return t[l].exports;var o=t[l]={i:l,l:!1,exports:{}};return n[l].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n,t}),function(e){"use strict";typeof define=="function"&&define.amd?define(["jquery"],e):typeof Bn=="object"&&typeof Zn=="object"?Zn.exports=e(l0()):e(jQuery)}(function(e,n){"use strict";var t,l={beforeShow:b,move:b,change:b,show:b,hide:b,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},o=[],a=!!/msie/i.exec(window.navigator.userAgent),s=((t=document.createElement("div").style).cssText="background-color:rgba(0,0,0,.5)",m(t.backgroundColor,"rgba")||m(t.backgroundColor,"hsla")),u=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),f=function(){var I="";if(a)for(var P=1;P<=6;P++)I+="<div class='sp-"+P+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",I,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input formulaInputFocus' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}();function m(I,P){return!!~(""+I).indexOf(P)}function d(I,P,F,D){for(var k=[],w=0;w<I.length;w++){var C,T,O,z=I[w];z?(T=(C=tinycolor(z)).toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light",T+=tinycolor.equals(P,z)?" sp-thumb-active":"",O=C.toString(D.preferredFormat||"rgb"),z=s?"background-color:"+C.toRgbString():"filter:"+C.toFilter(),k.push('<span title="'+O+'" data-color="'+C.toRgbString()+'" class="'+T+'"><span class="sp-thumb-inner" style="'+z+';" /></span>')):k.push(e("<div />").append(e('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",D.noColorSelectedText)).html())}return"<div class='sp-cf "+F+"'>"+k.join("")+"</div>"}function p(I,P){var F,D,k,w=(k=I,(P=e.extend({},l,P)).callbacks={move:v(P.move,k),change:v(P.change,k),show:v(P.show,k),hide:v(P.hide,k),beforeShow:v(P.beforeShow,k)},P),C=w.flat,T=w.showSelectionPalette,O=w.localStorageKey,P=w.theme,z=w.callbacks,A=(F=Hn,function(){var qt=this,ul=arguments;D=D||setTimeout(function(){D=null,F.apply(qt,ul)},10)}),E=!1,L=!1,N=0,W=0,X=0,te=0,ue=0,pe=0,ne=0,me=0,Q=0,we=0,ie=1,ge=[],ce=[],fe={},ye=w.selectionPalette.slice(0),Ne=w.maxSelectionSize,xe="sp-dragging",et=null,Fe=I.ownerDocument,it=(Fe.body,e(I)),wt=!1,ot=e(f,Fe).addClass(P),xt=ot.find(".sp-picker-container"),Ft=ot.find(".sp-color"),Se=ot.find(".sp-dragger"),oe=ot.find(".sp-hue"),be=ot.find(".sp-slider"),Te=ot.find(".sp-alpha-inner"),Oe=ot.find(".sp-alpha"),Xe=ot.find(".sp-alpha-handle"),Le=ot.find(".sp-input"),Ee=ot.find(".sp-palette"),nt=ot.find(".sp-initial"),Ze=ot.find(".sp-cancel"),ze=ot.find(".sp-clear"),_e=ot.find(".sp-choose"),Qe=ot.find(".sp-palette-toggle"),Je=it.is("input"),I=Je&&it.attr("type")==="color"&&_(),Ke=Je&&!C,gt=Ke?e(u).addClass(P).addClass(w.className).addClass(w.replacerClassName):e([]),At=Ke?gt:it,cl=gt.find(".sp-preview-inner"),El=w.color||Je&&it.val(),bl=!1,Nr=w.preferredFormat,li=!w.showButtons||w.clickoutFiresChange,on=!El,Re=w.allowEmpty&&!I;function We(){if(w.showPaletteOnly&&(w.showPalette=!0),Qe.text(w.showPaletteOnly?w.togglePaletteMoreText:w.togglePaletteLessText),w.palette){ge=w.palette.slice(0),ce=e.isArray(ge[0])?ge:[ge],fe={};for(var qt=0;qt<ce.length;qt++)for(var ul=0;ul<ce[qt].length;ul++){var Sl=tinycolor(ce[qt][ul]).toRgbString();fe[Sl]=!0}}ot.toggleClass("sp-flat",C),ot.toggleClass("sp-input-disabled",!w.showInput),ot.toggleClass("sp-alpha-enabled",w.showAlpha),ot.toggleClass("sp-clear-enabled",Re),ot.toggleClass("sp-buttons-disabled",!w.showButtons),ot.toggleClass("sp-palette-buttons-disabled",!w.togglePaletteOnly),ot.toggleClass("sp-palette-disabled",!w.showPalette),ot.toggleClass("sp-palette-only",w.showPaletteOnly),ot.toggleClass("sp-initial-disabled",!w.showInitial),ot.addClass(w.className).addClass(w.containerClassName),Hn()}function ht(){if(O&&window.localStorage){try{var qt=window.localStorage[O].split(",#");1<qt.length&&(delete window.localStorage[O],e.each(qt,function(ul,Sl){Ct(Sl)}))}catch(ul){}try{ye=window.localStorage[O].split(";")}catch(ul){}}}function Ct(qt){if(T){var ul=tinycolor(qt).toRgbString();if(!fe[ul]&&e.inArray(ul,ye)===-1)for(ye.push(ul);ye.length>Ne;)ye.shift();if(O&&window.localStorage)try{window.localStorage[O]=ye.join(";")}catch(Sl){}}}function Lt(){var qt=Br(),ul=e.map(ce,function(Sl,Gr){return d(Sl,qt,"sp-palette-row sp-palette-row-"+Gr,w)});ht(),ye&&ul.push(d(function(){var Sl=[];if(w.showPalette)for(var Gr=0;Gr<ye.length;Gr++){var br=tinycolor(ye[Gr]).toRgbString();fe[br]||Sl.push(ye[Gr])}return Sl.reverse().slice(0,w.maxSelectionSize)}(),qt,"sp-palette-row sp-palette-row-selection",w)),Ee.html(ul.join(""))}function Dt(){var qt,ul;w.showInitial&&(qt=bl,ul=Br(),nt.html(d([qt,ul],ul,"sp-palette-row-initial",w)))}function ol(){(W<=0||N<=0||te<=0)&&Hn(),L=!0,ot.addClass(xe),et=null,it.trigger("dragstart.spectrum",[Br()])}function el(){L=!1,ot.removeClass(xe),it.trigger("dragstop.spectrum",[Br()])}function Al(){var qt=Le.val();qt!==null&&qt!==""||!Re?(qt=tinycolor(qt)).isValid()?(An(qt),zn(!0)):Le.addClass("sp-validation-error"):(An(null),zn(!0))}function Vl(){(E?Mn:lr)()}function lr(){var qt=e.Event("beforeShow.spectrum");E?Hn():(it.trigger(qt,[Br()]),z.beforeShow(Br())===!1||qt.isDefaultPrevented()||(function(){for(var ul=0;ul<o.length;ul++)o[ul]&&o[ul].hide()}(),E=!0,e(Fe).bind("keydown.spectrum",hn),e(Fe).bind("click.spectrum",en),e(window).bind("resize.spectrum",A),gt.addClass("sp-active"),ot.removeClass("sp-hidden"),Hn(),ri(),bl=Br(),Dt(),z.show(bl),it.trigger("show.spectrum",[bl])))}function hn(qt){qt.keyCode===27&&Mn()}function en(qt){qt.button!=2&&(L||(li?zn(!0):Dn(),Mn()))}function Mn(){E&&!C&&(E=!1,e(Fe).unbind("keydown.spectrum",hn),e(Fe).unbind("click.spectrum",en),e(window).unbind("resize.spectrum",A),gt.removeClass("sp-active"),ot.addClass("sp-hidden"),z.hide(Br()),it.trigger("hide.spectrum",[Br()]))}function Dn(){An(bl,!0)}function An(qt,ul){var Sl;tinycolor.equals(qt,Br())?ri():(!qt&&Re?on=!0:(on=!1,qt=(Sl=tinycolor(qt)).toHsv(),me=qt.h%360/360,Q=qt.s,we=qt.v,ie=qt.a),ri(),Sl&&Sl.isValid()&&!ul&&(Nr=w.preferredFormat||Sl.getFormat()))}function Br(qt){return qt=qt||{},Re&&on?null:tinycolor.fromRatio({h:me,s:Q,v:we,a:Math.round(100*ie)/100},{format:qt.format||Nr})}function Ln(){ri(),z.move(Br()),it.trigger("move.spectrum",[Br()])}function ri(){Le.removeClass("sp-validation-error"),dn();var qt=tinycolor.fromRatio({h:me,s:1,v:1});Ft.css("background-color",qt.toHexString());var ul=Nr;ie<1&&(ie!==0||ul!=="name")&&(ul!=="hex"&&ul!=="hex3"&&ul!=="hex6"&&ul!=="name"||(ul="rgb"));var Sl,Gr,br=Br({format:ul}),Fr="";cl.removeClass("sp-clear-display"),cl.css("background-color","transparent"),!br&&Re?cl.addClass("sp-clear-display"):(Sl=br.toHexString(),Gr=br.toRgbString(),s||br.alpha===1?cl.css("background-color",Gr):(cl.css("background-color","transparent"),cl.css("filter",br.toFilter())),w.showAlpha&&((qt=br.toRgb()).a=0,qt="linear-gradient(left, "+(Gr=tinycolor(qt).toRgbString())+", "+Sl+")",a?Te.css("filter",tinycolor(Gr).toFilter({gradientType:1},Sl)):(Te.css("background","-webkit-"+qt),Te.css("background","-moz-"+qt),Te.css("background","-ms-"+qt),Te.css("background","linear-gradient(to right, "+Gr+", "+Sl+")"))),Fr=br.toString(ul)),w.showInput&&Le.val(Fr),w.showPalette&&Lt(),Dt()}function dn(){var qt=Q,ul=we;Re&&on?(Xe.hide(),be.hide(),Se.hide()):(Xe.show(),be.show(),Se.show(),qt=qt*N,ul=W-ul*W,qt=Math.max(-X,Math.min(N-X,qt-X)),ul=Math.max(-X,Math.min(W-X,ul-X)),Se.css({top:ul+"px",left:qt+"px"}),qt=ie*ue,Xe.css({left:qt-pe/2+"px"}),qt=me*te,be.css({top:qt-ne+"px"}))}function zn(qt){var ul=Br(),Sl="";ul&&(Sl=ul.toString(Nr),Ct(ul)),Je&&it.val(Sl),qt&&(z.change(ul),it.trigger("change",[ul]))}function Hn(){var qt,ul,Sl,Gr,br,Fr,Wl;E&&(N=Ft.width(),W=Ft.height(),X=Se.height(),oe.width(),te=oe.height(),ne=be.height(),ue=Oe.width(),pe=Xe.width(),C||(ot.css("position","absolute"),w.offset?ot.offset(w.offset):ot.offset((Wl=At,qt=(br=ot).outerWidth(),ul=br.outerHeight(),Sl=Wl.outerHeight(),br=(Gr=(Fr=br[0].ownerDocument).documentElement).clientWidth+e(Fr).scrollLeft(),Fr=Gr.clientHeight+e(Fr).scrollTop(),(Wl=Wl.offset()).top+=Sl,Wl.left-=Math.min(Wl.left,Wl.left+qt>br&&qt<br?Math.abs(Wl.left+qt-br):0),Wl.top-=Math.min(Wl.top,Wl.top+ul>Fr&&ul<Fr?Math.abs(+(ul+Sl)):0),Wl))),dn(),w.showPalette&&Lt(),it.trigger("reflow.spectrum"))}function $n(){Mn(),wt=!0,it.attr("disabled",!0),At.addClass("sp-disabled")}(function(){function qt(Sl){return Sl.data&&Sl.data.ignore?(An(e(Sl.target).closest(".sp-thumb-el").data("color")),Ln()):(An(e(Sl.target).closest(".sp-thumb-el").data("color")),Ln(),zn(!0),w.hideAfterPaletteSelect&&Mn()),!1}a&&ot.find("*:not(input)").attr("unselectable","on"),We(),Ke&&it.after(gt).hide(),Re||ze.hide(),C?it.after(ot).hide():((ul=w.appendTo==="parent"?it.parent():e(w.appendTo)).length!==1&&(ul=e("body")),ul.append(ot)),ht(),At.bind("click.spectrum touchstart.spectrum",function(Sl){wt||Vl(),Sl.stopPropagation(),e(Sl.target).is("input")||Sl.preventDefault()}),!it.is(":disabled")&&w.disabled!==!0||$n(),ot.click(g),Le.change(Al),Le.bind("paste",function(){setTimeout(Al,1)}),Le.keydown(function(Sl){Sl.keyCode==13&&Al()}),Ze.text(w.cancelText),Ze.bind("click.spectrum",function(Sl){Sl.stopPropagation(),Sl.preventDefault(),Dn(),Mn()}),ze.attr("title",w.clearText),ze.bind("click.spectrum",function(Sl){Sl.stopPropagation(),Sl.preventDefault(),on=!0,Ln(),C&&zn(!0)}),_e.text(w.chooseText),_e.bind("click.spectrum",function(Sl){Sl.stopPropagation(),Sl.preventDefault(),a&&Le.is(":focus")&&Le.trigger("change"),Le.hasClass("sp-validation-error")||(zn(!0),Mn())}),Qe.text(w.showPaletteOnly?w.togglePaletteMoreText:w.togglePaletteLessText),Qe.bind("click.spectrum",function(Sl){Sl.stopPropagation(),Sl.preventDefault(),w.showPaletteOnly=!w.showPaletteOnly,w.showPaletteOnly||C||ot.css("left","-="+(xt.outerWidth(!0)+5)),We()}),x(Oe,function(Sl,Gr,br){ie=Sl/ue,on=!1,br.shiftKey&&(ie=Math.round(10*ie)/10),Ln()},ol,el),x(oe,function(Sl,Gr){me=parseFloat(Gr/te),on=!1,w.showAlpha||(ie=1),Ln()},ol,el),x(Ft,function(Sl,Gr,br){br.shiftKey?et||(br=Q*N,Fr=W-we*W,Fr=Math.abs(Sl-br)>Math.abs(Gr-Fr),et=Fr?"x":"y"):et=null;var Fr=!et||et==="y";et&&et!=="x"||(Q=parseFloat(Sl/N)),Fr&&(we=parseFloat((W-Gr)/W)),on=!1,w.showAlpha||(ie=1),Ln()},ol,el),El?(An(El),ri(),Nr=w.preferredFormat||tinycolor(El).format,Ct(El)):ri(),C&&lr();var ul=a?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Ee.delegate(".sp-thumb-el",ul,qt),nt.delegate(".sp-thumb-el:nth-child(1)",ul,{ignore:!0},qt)})();var di={show:lr,hide:Mn,toggle:Vl,reflow:Hn,option:function(qt,ul){return qt===n?e.extend({},w):ul===n?w[qt]:(w[qt]=ul,qt==="preferredFormat"&&(Nr=w.preferredFormat),void We())},enable:function(){wt=!1,it.attr("disabled",!1),At.removeClass("sp-disabled")},disable:$n,offset:function(qt){w.offset=qt,Hn()},set:function(qt){An(qt),zn()},get:Br,destroy:function(){it.show(),At.unbind("click.spectrum touchstart.spectrum"),ot.remove(),gt.remove(),o[di.id]=null},container:ot};return di.id=o.push(di)-1,di}function b(){}function g(I){I.stopPropagation()}function v(I,P){var F=Array.prototype.slice,D=F.call(arguments,2);return function(){return I.apply(P,D.concat(F.call(arguments)))}}function x(I,P,F,D){P=P||function(){},F=F||function(){},D=D||function(){};var k=document,w=!1,C={},T=0,O=0,z="ontouchstart"in window,A={};function E(W){W.stopPropagation&&W.stopPropagation(),W.preventDefault&&W.preventDefault(),W.returnValue=!1}function L(W){if(w){if(a&&k.documentMode<9&&!W.button)return N();var X=W.originalEvent&&W.originalEvent.touches&&W.originalEvent.touches[0],te=X&&X.pageX||W.pageX,X=X&&X.pageY||W.pageY,te=Math.max(0,Math.min(te-C.left,O)),X=Math.max(0,Math.min(X-C.top,T));z&&E(W),P.apply(I,[te,X,W])}}function N(){w&&(e(k).unbind(A),e(k.body).removeClass("sp-dragging"),setTimeout(function(){D.apply(I,arguments)},0)),w=!1}A.selectstart=E,A.dragstart=E,A["touchmove mousemove"]=L,A["touchend mouseup"]=N,e(I).bind("touchstart mousedown",function(W){(W.which?W.which==3:W.button==2)||w||F.apply(I,arguments)!==!1&&(w=!0,T=e(I).height(),O=e(I).width(),C=e(I).offset(),e(k).bind(A),e(k.body).addClass("sp-dragging"),L(W),E(W))})}function _(){return e.fn.spectrum.inputTypeColorSupport()}var S="spectrum.id";e.fn.spectrum=function(I,P){if(typeof I!="string")return this.spectrum("destroy").each(function(){var k=p(this,e.extend({},I,e(this).data()));e(this).data(S,k.id)});var F=this,D=Array.prototype.slice.call(arguments,1);return this.each(function(){var k=o[e(this).data(S)];if(k){var w=k[I];if(!w)throw new Error("Spectrum: no such method: '"+I+"'");I=="get"?F=k.get():I=="container"?F=k.container:I=="option"?F=k.option.apply(k,D):I=="destroy"?(k.destroy(),e(this).removeData(S)):w.apply(k,D)}}),F},e.fn.spectrum.load=!0,e.fn.spectrum.loadOpts={},e.fn.spectrum.draggable=x,e.fn.spectrum.defaults=l,e.fn.spectrum.inputTypeColorSupport=function I(){var P;return I._cachedResult===void 0&&(P=e("<input type='color'/>")[0],I._cachedResult=P.type==="color"&&P.value!==""),I._cachedResult},e.spectrum={},e.spectrum.localization={},e.spectrum.palettes={},e.fn.spectrum.processNativeColorInputs=function(){var I=e("input[type=color]");I.length&&!_()&&I.spectrum({preferredFormat:"hex6"})},function(){var I=/^[\s,#]+/,P=/\s+$/,F=0,D=Math,k=D.round,w=D.min,C=D.max,T=D.random,O=function(Se,oe){if(oe=oe||{},(Se=Se||"")instanceof O)return Se;if(!(this instanceof O))return new O(Se,oe);var be,Te,Oe,Xe,Le,Ee,nt,Ze,ze,_e,Qe,ze=(Ze={r:0,g:0,b:0},Qe=_e=!(ze=1),typeof(be=Se)=="string"&&(be=function(Ke){Ke=Ke.replace(I,"").replace(P,"").toLowerCase();var gt,At=!1;if(fe[Ke])Ke=fe[Ke],At=!0;else if(Ke=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(gt=Ft.rgb.exec(Ke))?{r:gt[1],g:gt[2],b:gt[3]}:(gt=Ft.rgba.exec(Ke))?{r:gt[1],g:gt[2],b:gt[3],a:gt[4]}:(gt=Ft.hsl.exec(Ke))?{h:gt[1],s:gt[2],l:gt[3]}:(gt=Ft.hsla.exec(Ke))?{h:gt[1],s:gt[2],l:gt[3],a:gt[4]}:(gt=Ft.hsv.exec(Ke))?{h:gt[1],s:gt[2],v:gt[3]}:(gt=Ft.hsva.exec(Ke))?{h:gt[1],s:gt[2],v:gt[3],a:gt[4]}:(gt=Ft.hex8.exec(Ke))?{a:Fe(gt[1])/255,r:Fe(gt[2]),g:Fe(gt[3]),b:Fe(gt[4]),format:At?"name":"hex8"}:(gt=Ft.hex6.exec(Ke))?{r:Fe(gt[1]),g:Fe(gt[2]),b:Fe(gt[3]),format:At?"name":"hex"}:!!(gt=Ft.hex3.exec(Ke))&&{r:Fe(gt[1]+""+gt[1]),g:Fe(gt[2]+""+gt[2]),b:Fe(gt[3]+""+gt[3]),format:At?"name":"hex"}}(be)),typeof be=="object"&&(be.hasOwnProperty("r")&&be.hasOwnProperty("g")&&be.hasOwnProperty("b")?(Le=be.r,Ee=be.g,nt=be.b,Ze={r:255*xe(Le,255),g:255*xe(Ee,255),b:255*xe(nt,255)},_e=!0,Qe=String(be.r).substr(-1)==="%"?"prgb":"rgb"):be.hasOwnProperty("h")&&be.hasOwnProperty("s")&&be.hasOwnProperty("v")?(be.s=wt(be.s),be.v=wt(be.v),Ze=function(Ke,gt,At){Ke=6*xe(Ke,360),gt=xe(gt,100),At=xe(At,100);var cl=D.floor(Ke),El=Ke-cl,bl=At*(1-gt),Ke=At*(1-El*gt),gt=At*(1-(1-El)*gt),cl=cl%6;return{r:255*[At,Ke,bl,bl,gt,At][cl],g:255*[gt,At,At,Ke,bl,bl][cl],b:255*[bl,bl,gt,At,At,Ke][cl]}}(be.h,be.s,be.v),_e=!0,Qe="hsv"):be.hasOwnProperty("h")&&be.hasOwnProperty("s")&&be.hasOwnProperty("l")&&(be.s=wt(be.s),be.l=wt(be.l),Le=be.h,Ee=be.s,nt=be.l,Le=xe(Le,360),Ee=xe(Ee,100),nt=xe(nt,100),Ee===0?Te=Oe=Xe=nt:(Te=Je(Ee=2*nt-(nt=nt<.5?nt*(1+Ee):nt+Ee-nt*Ee),nt,Le+1/3),Oe=Je(Ee,nt,Le),Xe=Je(Ee,nt,Le-1/3)),Ze={r:255*Te,g:255*Oe,b:255*Xe},_e=!0,Qe="hsl"),be.hasOwnProperty("a")&&(ze=be.a)),ze=Ne(ze),{ok:_e,format:be.format||Qe,r:w(255,C(Ze.r,0)),g:w(255,C(Ze.g,0)),b:w(255,C(Ze.b,0)),a:ze});function Je(Ke,gt,At){return At<0&&(At+=1),1<At&&--At,At<1/6?Ke+6*(gt-Ke)*At:At<.5?gt:At<2/3?Ke+(gt-Ke)*(2/3-At)*6:Ke}this._originalInput=Se,this._r=ze.r,this._g=ze.g,this._b=ze.b,this._a=ze.a,this._roundA=k(100*this._a)/100,this._format=oe.format||ze.format,this._gradientType=oe.gradientType,this._r<1&&(this._r=k(this._r)),this._g<1&&(this._g=k(this._g)),this._b<1&&(this._b=k(this._b)),this._ok=ze.ok,this._tc_id=F++};function z(Se,oe,be){Se=xe(Se,255),oe=xe(oe,255),be=xe(be,255);var Te,Oe=C(Se,oe,be),Xe=w(Se,oe,be),Le=(Oe+Xe)/2;if(Oe==Xe)Te=nt=0;else{var Ee=Oe-Xe,nt=.5<Le?Ee/(2-Oe-Xe):Ee/(Oe+Xe);switch(Oe){case Se:Te=(oe-be)/Ee+(oe<be?6:0);break;case oe:Te=(be-Se)/Ee+2;break;case be:Te=(Se-oe)/Ee+4}Te/=6}return{h:Te,s:nt,l:Le}}function A(Se,oe,be){Se=xe(Se,255),oe=xe(oe,255),be=xe(be,255);var Te,Oe=C(Se,oe,be),Xe=w(Se,oe,be),Le=Oe,Ee=Oe-Xe,nt=Oe===0?0:Ee/Oe;if(Oe==Xe)Te=0;else{switch(Oe){case Se:Te=(oe-be)/Ee+(oe<be?6:0);break;case oe:Te=(be-Se)/Ee+2;break;case be:Te=(Se-oe)/Ee+4}Te/=6}return{h:Te,s:nt,v:Le}}function E(Se,oe,be,Te){return be=[it(k(Se).toString(16)),it(k(oe).toString(16)),it(k(be).toString(16))],Te&&be[0].charAt(0)==be[0].charAt(1)&&be[1].charAt(0)==be[1].charAt(1)&&be[2].charAt(0)==be[2].charAt(1)?be[0].charAt(0)+be[1].charAt(0)+be[2].charAt(0):be.join("")}function L(Se,oe,be,Te){return[it(Math.round(255*parseFloat(Te)).toString(16)),it(k(Se).toString(16)),it(k(oe).toString(16)),it(k(be).toString(16))].join("")}function N(Se,oe){return oe=oe===0?0:oe||10,Se=O(Se).toHsl(),Se.s-=oe/100,Se.s=et(Se.s),O(Se)}function W(Se,oe){return oe=oe===0?0:oe||10,Se=O(Se).toHsl(),Se.s+=oe/100,Se.s=et(Se.s),O(Se)}function X(Se){return O(Se).desaturate(100)}function te(Se,oe){return oe=oe===0?0:oe||10,Se=O(Se).toHsl(),Se.l+=oe/100,Se.l=et(Se.l),O(Se)}function ue(Se,oe){return oe=oe===0?0:oe||10,Se=O(Se).toRgb(),Se.r=C(0,w(255,Se.r-k(-oe/100*255))),Se.g=C(0,w(255,Se.g-k(-oe/100*255))),Se.b=C(0,w(255,Se.b-k(-oe/100*255))),O(Se)}function pe(Se,oe){return oe=oe===0?0:oe||10,Se=O(Se).toHsl(),Se.l-=oe/100,Se.l=et(Se.l),O(Se)}function ne(Se,oe){return Se=O(Se).toHsl(),oe=(k(Se.h)+oe)%360,Se.h=oe<0?360+oe:oe,O(Se)}function me(Se){return Se=O(Se).toHsl(),Se.h=(Se.h+180)%360,O(Se)}function Q(Se){var oe=O(Se).toHsl(),be=oe.h;return[O(Se),O({h:(be+120)%360,s:oe.s,l:oe.l}),O({h:(be+240)%360,s:oe.s,l:oe.l})]}function we(Se){var oe=O(Se).toHsl(),be=oe.h;return[O(Se),O({h:(be+90)%360,s:oe.s,l:oe.l}),O({h:(be+180)%360,s:oe.s,l:oe.l}),O({h:(be+270)%360,s:oe.s,l:oe.l})]}function ie(Se){var oe=O(Se).toHsl(),be=oe.h;return[O(Se),O({h:(be+72)%360,s:oe.s,l:oe.l}),O({h:(be+216)%360,s:oe.s,l:oe.l})]}function ge(Se,oe,be){oe=oe||6,be=be||30;var Te=O(Se).toHsl(),Oe=360/be,Xe=[O(Se)];for(Te.h=(Te.h-(Oe*oe>>1)+720)%360;--oe;)Te.h=(Te.h+Oe)%360,Xe.push(O(Te));return Xe}function ce(Se,oe){oe=oe||6;for(var Se=O(Se).toHsv(),be=Se.h,Te=Se.s,Oe=Se.v,Xe=[],Le=1/oe;oe--;)Xe.push(O({h:be,s:Te,v:Oe})),Oe=(Oe+Le)%1;return Xe}O.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var Se=this.toRgb();return(299*Se.r+587*Se.g+114*Se.b)/1e3},setAlpha:function(Se){return this._a=Ne(Se),this._roundA=k(100*this._a)/100,this},toHsv:function(){var Se=A(this._r,this._g,this._b);return{h:360*Se.h,s:Se.s,v:Se.v,a:this._a}},toHsvString:function(){var Se=A(this._r,this._g,this._b),oe=k(360*Se.h),be=k(100*Se.s),Se=k(100*Se.v);return this._a==1?"hsv("+oe+", "+be+"%, "+Se+"%)":"hsva("+oe+", "+be+"%, "+Se+"%, "+this._roundA+")"},toHsl:function(){var Se=z(this._r,this._g,this._b);return{h:360*Se.h,s:Se.s,l:Se.l,a:this._a}},toHslString:function(){var Se=z(this._r,this._g,this._b),oe=k(360*Se.h),be=k(100*Se.s),Se=k(100*Se.l);return this._a==1?"hsl("+oe+", "+be+"%, "+Se+"%)":"hsla("+oe+", "+be+"%, "+Se+"%, "+this._roundA+")"},toHex:function(Se){return E(this._r,this._g,this._b,Se)},toHexString:function(Se){return"#"+this.toHex(Se)},toHex8:function(){return L(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:k(this._r),g:k(this._g),b:k(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+k(this._r)+", "+k(this._g)+", "+k(this._b)+")":"rgba("+k(this._r)+", "+k(this._g)+", "+k(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:k(100*xe(this._r,255))+"%",g:k(100*xe(this._g,255))+"%",b:k(100*xe(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+k(100*xe(this._r,255))+"%, "+k(100*xe(this._g,255))+"%, "+k(100*xe(this._b,255))+"%)":"rgba("+k(100*xe(this._r,255))+"%, "+k(100*xe(this._g,255))+"%, "+k(100*xe(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(ye[E(this._r,this._g,this._b,!0)]||!1)},toFilter:function(Se){var oe="#"+L(this._r,this._g,this._b,this._a),be=oe,Te=this._gradientType?"GradientType = 1, ":"";return Se&&(be=O(Se).toHex8String()),"progid:DXImageTransform.Microsoft.gradient("+Te+"startColorstr="+oe+",endColorstr="+be+")"},toString:function(Se){var oe=!!Se;Se=Se||this._format;var be=!1,Te=this._a<1&&0<=this._a;return oe||!Te||Se!=="hex"&&Se!=="hex6"&&Se!=="hex3"&&Se!=="name"?(Se==="rgb"&&(be=this.toRgbString()),Se==="prgb"&&(be=this.toPercentageRgbString()),Se!=="hex"&&Se!=="hex6"||(be=this.toHexString()),Se==="hex3"&&(be=this.toHexString(!0)),Se==="hex8"&&(be=this.toHex8String()),Se==="name"&&(be=this.toName()),Se==="hsl"&&(be=this.toHslString()),Se==="hsv"&&(be=this.toHsvString()),be||this.toHexString()):Se==="name"&&this._a===0?this.toName():this.toRgbString()},_applyModification:function(Se,oe){return oe=Se.apply(null,[this].concat([].slice.call(oe))),this._r=oe._r,this._g=oe._g,this._b=oe._b,this.setAlpha(oe._a),this},lighten:function(){return this._applyModification(te,arguments)},brighten:function(){return this._applyModification(ue,arguments)},darken:function(){return this._applyModification(pe,arguments)},desaturate:function(){return this._applyModification(N,arguments)},saturate:function(){return this._applyModification(W,arguments)},greyscale:function(){return this._applyModification(X,arguments)},spin:function(){return this._applyModification(ne,arguments)},_applyCombination:function(Se,oe){return Se.apply(null,[this].concat([].slice.call(oe)))},analogous:function(){return this._applyCombination(ge,arguments)},complement:function(){return this._applyCombination(me,arguments)},monochromatic:function(){return this._applyCombination(ce,arguments)},splitcomplement:function(){return this._applyCombination(ie,arguments)},triad:function(){return this._applyCombination(Q,arguments)},tetrad:function(){return this._applyCombination(we,arguments)}},O.fromRatio=function(Se,oe){if(typeof Se=="object"){var be,Te={};for(be in Se)Se.hasOwnProperty(be)&&(Te[be]=be==="a"?Se[be]:wt(Se[be]));Se=Te}return O(Se,oe)},O.equals=function(Se,oe){return!(!Se||!oe)&&O(Se).toRgbString()==O(oe).toRgbString()},O.random=function(){return O.fromRatio({r:T(),g:T(),b:T()})},O.mix=function(Se,oe,be){be=be===0?0:be||50;var Te=O(Se).toRgb(),Oe=O(oe).toRgb(),Se=be/100,oe=2*Se-1,be=Oe.a-Te.a,be=1-(oe=(1+(oe=oe*be==-1?oe:(oe+be)/(1+oe*be)))/2),Se={r:Oe.r*oe+Te.r*be,g:Oe.g*oe+Te.g*be,b:Oe.b*oe+Te.b*be,a:Oe.a*Se+Te.a*(1-Se)};return O(Se)},O.readability=function(Se,oe){var be=O(Se),Te=O(oe),Se=be.toRgb(),oe=Te.toRgb(),be=be.getBrightness(),Te=Te.getBrightness(),oe=Math.max(Se.r,oe.r)-Math.min(Se.r,oe.r)+Math.max(Se.g,oe.g)-Math.min(Se.g,oe.g)+Math.max(Se.b,oe.b)-Math.min(Se.b,oe.b);return{brightness:Math.abs(be-Te),color:oe}},O.isReadable=function(Se,oe){return oe=O.readability(Se,oe),125<oe.brightness&&500<oe.color},O.mostReadable=function(Se,oe){for(var be=null,Te=0,Oe=!1,Xe=0;Xe<oe.length;Xe++){var Le=O.readability(Se,oe[Xe]),Ee=125<Le.brightness&&500<Le.color,Le=Le.brightness/125*3+Le.color/500;(Ee&&!Oe||Ee&&Oe&&Te<Le||!Ee&&!Oe&&Te<Le)&&(Oe=Ee,Te=Le,be=O(oe[Xe]))}return be};var fe=O.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},ye=O.hexNames=function(Se){var oe,be={};for(oe in Se)Se.hasOwnProperty(oe)&&(be[Se[oe]]=oe);return be}(fe);function Ne(Se){return Se=parseFloat(Se),(isNaN(Se)||Se<0||1<Se)&&(Se=1),Se}function xe(Se,oe){typeof(be=Se)=="string"&&be.indexOf(".")!=-1&&parseFloat(be)===1&&(Se="100%");var be=typeof Se=="string"&&Se.indexOf("%")!=-1;return Se=w(oe,C(0,parseFloat(Se))),be&&(Se=parseInt(Se*oe,10)/100),D.abs(Se-oe)<1e-6?1:Se%oe/parseFloat(oe)}function et(Se){return w(1,C(0,Se))}function Fe(Se){return parseInt(Se,16)}function it(Se){return Se.length==1?"0"+Se:""+Se}function wt(Se){return Se<=1&&(Se=100*Se+"%"),Se}var ot,xt,Ft=(ot="[\\s|\\(]+("+(xt="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+xt+")[,|\\s]+("+xt+")\\s*\\)?",xt="[\\s|\\(]+("+xt+")[,|\\s]+("+xt+")[,|\\s]+("+xt+")[,|\\s]+("+xt+")\\s*\\)?",{rgb:new RegExp("rgb"+ot),rgba:new RegExp("rgba"+xt),hsl:new RegExp("hsl"+ot),hsla:new RegExp("hsla"+xt),hsv:new RegExp("hsv"+ot),hsva:new RegExp("hsva"+xt),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});window.tinycolor=O}(),e(function(){e.fn.spectrum.load&&e.fn.spectrum.processNativeColorInputs()})}),function(){var e=function(n){n.ui=n.ui||{},n.ui.version="1.12.1";var t,l,o,a,s,u,f,m,d,p,b=0,g=Array.prototype.slice;function v(k,w,C){return[parseFloat(k[0])*(d.test(k[0])?w/100:1),parseFloat(k[1])*(d.test(k[1])?C/100:1)]}function x(k,w){return parseInt(n.css(k,w),10)||0}n.cleanData=(t=n.cleanData,function(k){for(var w,C,T=0;(C=k[T])!=null;T++)try{(w=n._data(C,"events"))&&w.remove&&n(C).triggerHandler("remove")}catch(O){}t(k)}),n.widget=function(k,w,C){var T,O,z,A={},E=k.split(".")[0],L=E+"-"+(k=k.split(".")[1]);return C||(C=w,w=n.Widget),n.isArray(C)&&(C=n.extend.apply(null,[{}].concat(C))),n.expr[":"][L.toLowerCase()]=function(N){return!!n.data(N,L)},n[E]=n[E]||{},T=n[E][k],O=n[E][k]=function(N,W){if(!this._createWidget)return new O(N,W);arguments.length&&this._createWidget(N,W)},n.extend(O,T,{version:C.version,_proto:n.extend({},C),_childConstructors:[]}),(z=new w).options=n.widget.extend({},z.options),n.each(C,function(N,W){function X(){return w.prototype[N].apply(this,arguments)}function te(ue){return w.prototype[N].apply(this,ue)}n.isFunction(W)?A[N]=function(){var ue,pe=this._super,ne=this._superApply;return this._super=X,this._superApply=te,ue=W.apply(this,arguments),this._super=pe,this._superApply=ne,ue}:A[N]=W}),O.prototype=n.widget.extend(z,{widgetEventPrefix:T&&z.widgetEventPrefix||k},A,{constructor:O,namespace:E,widgetName:k,widgetFullName:L}),T?(n.each(T._childConstructors,function(N,W){var X=W.prototype;n.widget(X.namespace+"."+X.widgetName,O,W._proto)}),delete T._childConstructors):w._childConstructors.push(O),n.widget.bridge(k,O),O},n.widget.extend=function(k){for(var w,C,T=g.call(arguments,1),O=0,z=T.length;O<z;O++)for(w in T[O])C=T[O][w],T[O].hasOwnProperty(w)&&C!==void 0&&(n.isPlainObject(C)?k[w]=n.isPlainObject(k[w])?n.widget.extend({},k[w],C):n.widget.extend({},C):k[w]=C);return k},n.widget.bridge=function(k,w){var C=w.prototype.widgetFullName||k;n.fn[k]=function(T){var O=typeof T=="string",z=g.call(arguments,1),A=this;return O?this.length||T!=="instance"?this.each(function(){var E,L=n.data(this,C);return T==="instance"?(A=L,!1):L?n.isFunction(L[T])&&T.charAt(0)!=="_"?(E=L[T].apply(L,z))!==L&&E!==void 0?(A=E&&E.jquery?A.pushStack(E.get()):E,!1):void 0:n.error("no such method '"+T+"' for "+k+" widget instance"):n.error("cannot call methods on "+k+" prior to initialization; attempted to call method '"+T+"'")}):A=void 0:(z.length&&(T=n.widget.extend.apply(null,[T].concat(z))),this.each(function(){var E=n.data(this,C);E?(E.option(T||{}),E._init&&E._init()):n.data(this,C,new w(T,this))})),A}},n.Widget=function(){},n.Widget._childConstructors=[],n.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(k,w){w=n(w||this.defaultElement||this)[0],this.element=n(w),this.uuid=b++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=n(),this.hoverable=n(),this.focusable=n(),this.classesElementLookup={},w!==this&&(n.data(w,this.widgetFullName,this),this._on(!0,this.element,{remove:function(C){C.target===w&&this.destroy()}}),this.document=n(w.style?w.ownerDocument:w.document||w),this.window=n(this.document[0].defaultView||this.document[0].parentWindow)),this.options=n.widget.extend({},this.options,this._getCreateOptions(),k),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:n.noop,_create:n.noop,_init:n.noop,destroy:function(){var k=this;this._destroy(),n.each(this.classesElementLookup,function(w,C){k._removeClass(C,w)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:n.noop,widget:function(){return this.element},option:function(k,w){var C,T,O,z=k;if(arguments.length===0)return n.widget.extend({},this.options);if(typeof k=="string")if(z={},k=(C=k.split(".")).shift(),C.length){for(T=z[k]=n.widget.extend({},this.options[k]),O=0;O<C.length-1;O++)T[C[O]]=T[C[O]]||{},T=T[C[O]];if(k=C.pop(),arguments.length===1)return T[k]===void 0?null:T[k];T[k]=w}else{if(arguments.length===1)return this.options[k]===void 0?null:this.options[k];z[k]=w}return this._setOptions(z),this},_setOptions:function(k){for(var w in k)this._setOption(w,k[w]);return this},_setOption:function(k,w){return k==="classes"&&this._setOptionClasses(w),this.options[k]=w,k==="disabled"&&this._setOptionDisabled(w),this},_setOptionClasses:function(k){var w,C,T;for(w in k)T=this.classesElementLookup[w],k[w]!==this.options.classes[w]&&T&&T.length&&(C=n(T.get()),this._removeClass(T,w),C.addClass(this._classes({element:C,keys:w,classes:k,add:!0})))},_setOptionDisabled:function(k){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!k),k&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(k){var w=[],C=this;function T(O,z){for(var A,E=0;E<O.length;E++)A=C.classesElementLookup[O[E]]||n(),A=k.add?n(n.unique(A.get().concat(k.element.get()))):n(A.not(k.element).get()),C.classesElementLookup[O[E]]=A,w.push(O[E]),z&&k.classes[O[E]]&&w.push(k.classes[O[E]])}return k=n.extend({element:this.element,classes:this.options.classes||{}},k),this._on(k.element,{remove:"_untrackClassesElement"}),k.keys&&T(k.keys.match(/\S+/g)||[],!0),k.extra&&T(k.extra.match(/\S+/g)||[]),w.join(" ")},_untrackClassesElement:function(k){var w=this;n.each(w.classesElementLookup,function(C,T){n.inArray(k.target,T)!==-1&&(w.classesElementLookup[C]=n(T.not(k.target).get()))})},_removeClass:function(k,w,C){return this._toggleClass(k,w,C,!1)},_addClass:function(k,w,C){return this._toggleClass(k,w,C,!0)},_toggleClass:function(k,w,C,T){T=typeof T=="boolean"?T:C;var O=typeof k=="string"||k===null,k={extra:O?w:C,keys:O?k:w,element:O?this.element:k,add:T};return k.element.toggleClass(this._classes(k),T),this},_on:function(k,w,C){var T,O=this;typeof k!="boolean"&&(C=w,w=k,k=!1),C?(w=T=n(w),this.bindings=this.bindings.add(w)):(C=w,w=this.element,T=this.widget()),n.each(C,function(z,A){function E(){if(k||O.options.disabled!==!0&&!n(this).hasClass("ui-state-disabled"))return(typeof A=="string"?O[A]:A).apply(O,arguments)}typeof A!="string"&&(E.guid=A.guid=A.guid||E.guid||n.guid++);var L=z.match(/^([\w:-]*)\s*(.*)$/),z=L[1]+O.eventNamespace,L=L[2];L?T.on(z,L,E):w.on(z,E)})},_off:function(k,w){w=(w||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,k.off(w).off(w),this.bindings=n(this.bindings.not(k).get()),this.focusable=n(this.focusable.not(k).get()),this.hoverable=n(this.hoverable.not(k).get())},_delay:function(k,w){var C=this;return setTimeout(function(){return(typeof k=="string"?C[k]:k).apply(C,arguments)},w||0)},_hoverable:function(k){this.hoverable=this.hoverable.add(k),this._on(k,{mouseenter:function(w){this._addClass(n(w.currentTarget),null,"ui-state-hover")},mouseleave:function(w){this._removeClass(n(w.currentTarget),null,"ui-state-hover")}})},_focusable:function(k){this.focusable=this.focusable.add(k),this._on(k,{focusin:function(w){this._addClass(n(w.currentTarget),null,"ui-state-focus")},focusout:function(w){this._removeClass(n(w.currentTarget),null,"ui-state-focus")}})},_trigger:function(k,w,C){var T,O,z=this.options[k];if(C=C||{},(w=n.Event(w)).type=(k===this.widgetEventPrefix?k:this.widgetEventPrefix+k).toLowerCase(),w.target=this.element[0],O=w.originalEvent)for(T in O)T in w||(w[T]=O[T]);return this.element.trigger(w,C),!(n.isFunction(z)&&z.apply(this.element[0],[w].concat(C))===!1||w.isDefaultPrevented())}},n.each({show:"fadeIn",hide:"fadeOut"},function(k,w){n.Widget.prototype["_"+k]=function(C,T,O){var z;typeof T=="string"&&(T={effect:T});var A=T?T!==!0&&typeof T!="number"&&T.effect||w:k;typeof(T=T||{})=="number"&&(T={duration:T}),z=!n.isEmptyObject(T),T.complete=O,T.delay&&C.delay(T.delay),z&&n.effects&&n.effects.effect[A]?C[k](T):A!==k&&C[A]?C[A](T.duration,T.easing,O):C.queue(function(E){n(this)[k](),O&&O.call(C[0]),E()})}}),n.widget,o=Math.max,a=Math.abs,s=/left|center|right/,u=/top|center|bottom/,f=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,d=/%$/,p=n.fn.position,n.position={scrollbarWidth:function(){if(l!==void 0)return l;var k,w=n("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),C=w.children()[0];return n("body").append(w),k=C.offsetWidth,w.css("overflow","scroll"),k===(C=C.offsetWidth)&&(C=w[0].clientWidth),w.remove(),l=k-C},getScrollInfo:function(k){var w=k.isWindow||k.isDocument?"":k.element.css("overflow-x"),C=k.isWindow||k.isDocument?"":k.element.css("overflow-y"),w=w==="scroll"||w==="auto"&&k.width<k.element[0].scrollWidth;return{width:C==="scroll"||C==="auto"&&k.height<k.element[0].scrollHeight?n.position.scrollbarWidth():0,height:w?n.position.scrollbarWidth():0}},getWithinInfo:function(k){var w=n(k||window),C=n.isWindow(w[0]),T=!!w[0]&&w[0].nodeType===9;return{element:w,isWindow:C,isDocument:T,offset:C||T?{left:0,top:0}:n(k).offset(),scrollLeft:w.scrollLeft(),scrollTop:w.scrollTop(),width:w.outerWidth(),height:w.outerHeight()}}},n.fn.position=function(k){if(!k||!k.of)return p.apply(this,arguments);k=n.extend({},k);var w,C,T,O,z,A,E=n(k.of),L=n.position.getWithinInfo(k.within),N=n.position.getScrollInfo(L),W=(k.collision||"flip").split(" "),X={},te=(A=(te=E)[0]).nodeType===9?{width:te.width(),height:te.height(),offset:{top:0,left:0}}:n.isWindow(A)?{width:te.width(),height:te.height(),offset:{top:te.scrollTop(),left:te.scrollLeft()}}:A.preventDefault?{width:0,height:0,offset:{top:A.pageY,left:A.pageX}}:{width:te.outerWidth(),height:te.outerHeight(),offset:te.offset()};return E[0].preventDefault&&(k.at="left top"),C=te.width,T=te.height,O=te.offset,z=n.extend({},O),n.each(["my","at"],function(){var ue,pe,ne=(k[this]||"").split(" ");ne.length===1&&(ne=s.test(ne[0])?ne.concat(["center"]):u.test(ne[0])?["center"].concat(ne):["center","center"]),ne[0]=s.test(ne[0])?ne[0]:"center",ne[1]=u.test(ne[1])?ne[1]:"center",ue=f.exec(ne[0]),pe=f.exec(ne[1]),X[this]=[ue?ue[0]:0,pe?pe[0]:0],k[this]=[m.exec(ne[0])[0],m.exec(ne[1])[0]]}),W.length===1&&(W[1]=W[0]),k.at[0]==="right"?z.left+=C:k.at[0]==="center"&&(z.left+=C/2),k.at[1]==="bottom"?z.top+=T:k.at[1]==="center"&&(z.top+=T/2),w=v(X.at,C,T),z.left+=w[0],z.top+=w[1],this.each(function(){var ue,pe,ne=n(this),me=ne.outerWidth(),Q=ne.outerHeight(),we=x(this,"marginLeft"),ie=x(this,"marginTop"),ge=me+we+x(this,"marginRight")+N.width,ce=Q+ie+x(this,"marginBottom")+N.height,fe=n.extend({},z),ye=v(X.my,ne.outerWidth(),ne.outerHeight());k.my[0]==="right"?fe.left-=me:k.my[0]==="center"&&(fe.left-=me/2),k.my[1]==="bottom"?fe.top-=Q:k.my[1]==="center"&&(fe.top-=Q/2),fe.left+=ye[0],fe.top+=ye[1],ue={marginLeft:we,marginTop:ie},n.each(["left","top"],function(Ne,xe){n.ui.position[W[Ne]]&&n.ui.position[W[Ne]][xe](fe,{targetWidth:C,targetHeight:T,elemWidth:me,elemHeight:Q,collisionPosition:ue,collisionWidth:ge,collisionHeight:ce,offset:[w[0]+ye[0],w[1]+ye[1]],my:k.my,at:k.at,within:L,elem:ne})}),k.using&&(pe=function(Ne){var xe=O.left-fe.left,et=xe+C-me,Fe=O.top-fe.top,it=Fe+T-Q,wt={target:{element:E,left:O.left,top:O.top,width:C,height:T},element:{element:ne,left:fe.left,top:fe.top,width:me,height:Q},horizontal:et<0?"left":0<xe?"right":"center",vertical:it<0?"top":0<Fe?"bottom":"middle"};C<me&&a(xe+et)<C&&(wt.horizontal="center"),T<Q&&a(Fe+it)<T&&(wt.vertical="middle"),o(a(xe),a(et))>o(a(Fe),a(it))?wt.important="horizontal":wt.important="vertical",k.using.call(this,Ne,wt)}),ne.offset(n.extend(fe,{using:pe}))})},n.ui.position={fit:{left:function(k,w){var C=w.within,T=C.isWindow?C.scrollLeft:C.offset.left,O=C.width,z=k.left-w.collisionPosition.marginLeft,A=T-z,E=z+w.collisionWidth-O-T;w.collisionWidth>O?0<A&&E<=0?(C=k.left+A+w.collisionWidth-O-T,k.left+=A-C):k.left=!(0<E&&A<=0)&&E<A?T+O-w.collisionWidth:T:0<A?k.left+=A:0<E?k.left-=E:k.left=o(k.left-z,k.left)},top:function(k,w){var C=w.within,T=C.isWindow?C.scrollTop:C.offset.top,O=w.within.height,z=k.top-w.collisionPosition.marginTop,A=T-z,E=z+w.collisionHeight-O-T;w.collisionHeight>O?0<A&&E<=0?(C=k.top+A+w.collisionHeight-O-T,k.top+=A-C):k.top=!(0<E&&A<=0)&&E<A?T+O-w.collisionHeight:T:0<A?k.top+=A:0<E?k.top-=E:k.top=o(k.top-z,k.top)}},flip:{left:function(k,w){var C=w.within,T=C.offset.left+C.scrollLeft,O=C.width,z=C.isWindow?C.scrollLeft:C.offset.left,A=k.left-w.collisionPosition.marginLeft,E=A-z,L=A+w.collisionWidth-O-z,N=w.my[0]==="left"?-w.elemWidth:w.my[0]==="right"?w.elemWidth:0,C=w.at[0]==="left"?w.targetWidth:w.at[0]==="right"?-w.targetWidth:0,A=-2*w.offset[0];E<0?((T=k.left+N+C+A+w.collisionWidth-O-T)<0||T<a(E))&&(k.left+=N+C+A):0<L&&(0<(z=k.left-w.collisionPosition.marginLeft+N+C+A-z)||a(z)<L)&&(k.left+=N+C+A)},top:function(k,w){var C=w.within,T=C.offset.top+C.scrollTop,O=C.height,z=C.isWindow?C.scrollTop:C.offset.top,A=k.top-w.collisionPosition.marginTop,E=A-z,L=A+w.collisionHeight-O-z,N=w.my[1]==="top"?-w.elemHeight:w.my[1]==="bottom"?w.elemHeight:0,C=w.at[1]==="top"?w.targetHeight:w.at[1]==="bottom"?-w.targetHeight:0,A=-2*w.offset[1];E<0?((T=k.top+N+C+A+w.collisionHeight-O-T)<0||T<a(E))&&(k.top+=N+C+A):0<L&&(0<(z=k.top-w.collisionPosition.marginTop+N+C+A-z)||a(z)<L)&&(k.top+=N+C+A)}},flipfit:{left:function(){n.ui.position.flip.left.apply(this,arguments),n.ui.position.fit.left.apply(this,arguments)},top:function(){n.ui.position.flip.top.apply(this,arguments),n.ui.position.fit.top.apply(this,arguments)}}},n.ui.position,n.fn.form=function(){return typeof this[0].form=="string"?this.closest("form"):n(this[0].form)},n.ui.formResetMixin={_formResetHandler:function(){var k=n(this);setTimeout(function(){var w=k.data("ui-form-reset-instances");n.each(w,function(){this.refresh()})})},_bindFormResetHandler:function(){var k;this.form=this.element.form(),this.form.length&&((k=this.form.data("ui-form-reset-instances")||[]).length||this.form.on("reset.ui-form-reset",this._formResetHandler),k.push(this),this.form.data("ui-form-reset-instances",k))},_unbindFormResetHandler:function(){var k;this.form.length&&((k=this.form.data("ui-form-reset-instances")).splice(n.inArray(this,k),1),k.length?this.form.data("ui-form-reset-instances",k):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset"))}},n.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},n.ui.escapeSelector=(_=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,function(k){return k.replace(_,"\\$1")}),n.fn.labels=function(){var k,w,C;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(w=this.eq(0).parents("label"),(k=this.attr("id"))&&(C=(C=this.eq(0).parents().last()).add((C.length?C:this).siblings()),k="label[for='"+n.ui.escapeSelector(k)+"']",w=w.add(C.find(k).addBack(k))),this.pushStack(w))},n.fn.extend({uniqueId:(S=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++S)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&n(this).removeAttr("id")})}});var _,S,I,P=/ui-corner-([a-z]){2,6}/g;n.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var k=this,w=[];n.each(this.options.items,function(C,T){var O,z;if(T)return C==="controlgroupLabel"?((O=k.element.find(T)).each(function(){var A=n(this);A.children(".ui-controlgroup-label-contents").length||A.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),k._addClass(O,null,"ui-widget ui-widget-content ui-state-default"),void(w=w.concat(O.get()))):void(n.fn[C]&&(z=k["_"+C+"Options"]?k["_"+C+"Options"]("middle"):{classes:{}},k.element.find(T).each(function(){var A=n(this),E=A[C]("instance"),L=n.widget.extend({},z);C==="button"&&A.parent(".ui-spinner").length||((E=E||A[C]()[C]("instance"))&&(L.classes=k._resolveClassesValues(L.classes,E)),A[C](L),L=A[C]("widget"),n.data(L[0],"ui-controlgroup-data",E||A[C]("instance")),w.push(L[0]))})))}),this.childWidgets=n(n.unique(w)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(k){this.childWidgets.each(function(){var w=n(this).data("ui-controlgroup-data");w&&w[k]&&w[k]()})},_updateCornerClass:function(k,w){w=this._buildSimpleOptions(w,"label").classes.label,this._removeClass(k,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(k,null,w)},_buildSimpleOptions:function(k,w){var C=this.options.direction==="vertical",T={classes:{}};return T.classes[w]={middle:"",first:"ui-corner-"+(C?"top":"left"),last:"ui-corner-"+(C?"bottom":"right"),only:"ui-corner-all"}[k],T},_spinnerOptions:function(k){return k=this._buildSimpleOptions(k,"ui-spinner"),k.classes["ui-spinner-up"]="",k.classes["ui-spinner-down"]="",k},_buttonOptions:function(k){return this._buildSimpleOptions(k,"ui-button")},_checkboxradioOptions:function(k){return this._buildSimpleOptions(k,"ui-checkboxradio-label")},_selectmenuOptions:function(k){var w=this.options.direction==="vertical";return{width:!!w&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(w?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(w?"top":"left")},last:{"ui-selectmenu-button-open":w?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(w?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[k]}},_resolveClassesValues:function(k,w){var C={};return n.each(k,function(T){var O=w.options.classes[T]||"",O=n.trim(O.replace(P,""));C[T]=(O+" "+k[T]).replace(/\s+/g," ")}),C},_setOption:function(k,w){k==="direction"&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(k,w),k!=="disabled"?this.refresh():this._callChildMethod(w?"disable":"enable")},refresh:function(){var k,w=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),this.options.direction==="horizontal"&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),k=this.childWidgets,this.options.onlyVisible&&(k=k.filter(":visible")),k.length&&(n.each(["first","last"],function(C,T){var O,z=k[T]().data("ui-controlgroup-data");z&&w["_"+z.widgetName+"Options"]?((O=w["_"+z.widgetName+"Options"](k.length===1?"only":T)).classes=w._resolveClassesValues(O.classes,z),z.element[z.widgetName](O)):w._updateCornerClass(k[T](),T)}),this._callChildMethod("refresh"))}}),n.widget("ui.checkboxradio",[n.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var k,w=this,C=this._super()||{};return this._readType(),k=this.element.labels(),this.label=n(k[k.length-1]),this.label.length||n.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){w.originalLabel+=this.nodeType===3?n(this).text():this.outerHTML}),this.originalLabel&&(C.label=this.originalLabel),(k=this.element[0].disabled)!=null&&(C.disabled=k),C},_create:function(){var k=this.element[0].checked;this._bindFormResetHandler(),this.options.disabled==null&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),this.type==="radio"&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),k&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var k=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,k==="input"&&/radio|checkbox/.test(this.type)||n.error("Can't create checkboxradio on element.nodeName="+k+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var k=this.element[0].name,w="input[name='"+n.ui.escapeSelector(k)+"']";return k?(this.form.length?n(this.form[0].elements).filter(w):n(w).filter(function(){return n(this).form().length===0})).not(this.element):n([])},_toggleClasses:function(){var k=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",k),this.options.icon&&this.type==="checkbox"&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",k)._toggleClass(this.icon,null,"ui-icon-blank",!k),this.type==="radio"&&this._getRadioGroup().each(function(){var w=n(this).checkboxradio("instance");w&&w._removeClass(w.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(k,w){if(k!=="label"||w){if(this._super(k,w),k==="disabled")return this._toggleClass(this.label,null,"ui-state-disabled",w),void(this.element[0].disabled=w);this.refresh()}},_updateIcon:function(k){var w="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=n("<span>"),this.iconSpace=n("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),this.type==="checkbox"?(w+=k?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,k?"ui-icon-blank":"ui-icon-check")):w+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",w),k||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):this.icon!==void 0&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var k=this.label.contents().not(this.element[0]);this.icon&&(k=k.not(this.icon[0])),this.iconSpace&&(k=k.not(this.iconSpace[0])),k.remove(),this.label.append(this.options.label)},refresh:function(){var k=this.element[0].checked,w=this.element[0].disabled;this._updateIcon(k),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",k),this.options.label!==null&&this._updateLabel(),w!==this.options.disabled&&this._setOptions({disabled:w})}}]),n.ui.checkboxradio,n.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var k,w=this._super()||{};return this.isInput=this.element.is("input"),(k=this.element[0].disabled)!=null&&(w.disabled=k),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(w.label=this.originalLabel),w},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),this.options.disabled==null&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(k){k.keyCode===n.ui.keyCode.SPACE&&(k.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(k,w){var C=k!=="iconPosition",T=C?this.options.iconPosition:w,k=T==="top"||T==="bottom";this.icon?C&&this._removeClass(this.icon,null,this.options.icon):(this.icon=n("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),C&&this._addClass(this.icon,null,w),this._attachIcon(T),k?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=n("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(T))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(k){this.icon[/^(?:end|bottom)/.test(k)?"before":"after"](this.iconSpace)},_attachIcon:function(k){this.element[/^(?:end|bottom)/.test(k)?"append":"prepend"](this.icon)},_setOptions:function(k){var w=(k.showLabel===void 0?this.options:k).showLabel,C=(k.icon===void 0?this.options:k).icon;w||C||(k.showLabel=!0),this._super(k)},_setOption:function(k,w){k==="icon"&&(w?this._updateIcon(k,w):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),k==="iconPosition"&&this._updateIcon(k,w),k==="showLabel"&&(this._toggleClass("ui-button-icon-only",null,!w),this._updateTooltip()),k==="label"&&(this.isInput?this.element.val(w):(this.element.html(w),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(k,w),k==="disabled"&&(this._toggleClass(null,"ui-state-disabled",w),(this.element[0].disabled=w)&&this.element.blur())},refresh:function(){var k=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");k!==this.options.disabled&&this._setOptions({disabled:k}),this._updateTooltip()}}),n.uiBackCompat!==!1&&(n.widget("ui.button",n.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(k,w){k!=="text"?(k==="showLabel"&&(this.options.text=w),k==="icon"&&(this.options.icons.primary=w),k==="icons"&&(w.primary?(this._super("icon",w.primary),this._super("iconPosition","beginning")):w.secondary&&(this._super("icon",w.secondary),this._super("iconPosition","end"))),this._superApply(arguments)):this._super("showLabel",w)}}),n.fn.button=(I=n.fn.button,function(){return!this.length||this.length&&this[0].tagName!=="INPUT"||this.length&&this[0].tagName==="INPUT"&&this.attr("type")!=="checkbox"&&this.attr("type")!=="radio"?I.apply(this,arguments):(n.ui.checkboxradio||n.error("Checkboxradio widget missing"),arguments.length===0?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}),n.fn.buttonset=function(){return n.ui.controlgroup||n.error("Controlgroup widget missing"),arguments[0]==="option"&&arguments[1]==="items"&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):arguments[0]==="option"&&arguments[1]==="items"?this.controlgroup.apply(this,[arguments[0],"items.button"]):(typeof arguments[0]=="object"&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),n.ui.button,n.ui.safeActiveElement=function(k){var w;try{w=k.activeElement}catch(C){w=k.body}return(w=w||k.body).nodeName||(w=k.body),w},n.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(k){k.preventDefault()},"click .ui-menu-item":function(k){var w=n(k.target),C=n(n.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&w.not(".ui-state-disabled").length&&(this.select(k),k.isPropagationStopped()||(this.mouseHandled=!0),w.has(".ui-menu").length?this.expand(k):!this.element.is(":focus")&&C.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(k){var w,C;this.previousFilter||(w=n(k.target).closest(".ui-menu-item"),C=n(k.currentTarget),w[0]===C[0]&&(this._removeClass(C.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(k,C)))},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(k,w){var C=this.active||this.element.find(this.options.items).eq(0);w||this.focus(k,C)},blur:function(k){this._delay(function(){n.contains(this.element[0],n.ui.safeActiveElement(this.document[0]))||this.collapseAll(k)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(k){this._closeOnDocumentClick(k)&&this.collapseAll(k),this.mouseHandled=!1}})},_destroy:function(){var k=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),k.children().each(function(){var w=n(this);w.data("ui-menu-submenu-caret")&&w.remove()})},_keydown:function(k){var w,C,T,O=!0;switch(k.keyCode){case n.ui.keyCode.PAGE_UP:this.previousPage(k);break;case n.ui.keyCode.PAGE_DOWN:this.nextPage(k);break;case n.ui.keyCode.HOME:this._move("first","first",k);break;case n.ui.keyCode.END:this._move("last","last",k);break;case n.ui.keyCode.UP:this.previous(k);break;case n.ui.keyCode.DOWN:this.next(k);break;case n.ui.keyCode.LEFT:this.collapse(k);break;case n.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(k);break;case n.ui.keyCode.ENTER:case n.ui.keyCode.SPACE:this._activate(k);break;case n.ui.keyCode.ESCAPE:this.collapse(k);break;default:O=!1,w=this.previousFilter||"",T=!1,C=96<=k.keyCode&&k.keyCode<=105?(k.keyCode-96).toString():String.fromCharCode(k.keyCode),clearTimeout(this.filterTimer),C===w?T=!0:C=w+C,w=this._filterMenuItems(C),(w=T&&w.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):w).length||(C=String.fromCharCode(k.keyCode),w=this._filterMenuItems(C)),w.length?(this.focus(k,w),this.previousFilter=C,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}O&&k.preventDefault()},_activate:function(k){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(k):this.select(k))},refresh:function(){var k,w,C=this,T=this.options.icons.submenu,O=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),w=O.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var z=n(this),A=z.prev(),E=n("<span>").data("ui-menu-submenu-caret",!0);C._addClass(E,"ui-menu-icon","ui-icon "+T),A.attr("aria-haspopup","true").prepend(E),z.attr("aria-labelledby",A.attr("id"))}),this._addClass(w,"ui-menu","ui-widget ui-widget-content ui-front"),(k=O.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var z=n(this);C._isDivider(z)&&C._addClass(z,"ui-menu-divider","ui-widget-content")}),O=(w=k.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(w,"ui-menu-item")._addClass(O,"ui-menu-item-wrapper"),k.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!n.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(k,w){var C;k==="icons"&&(C=this.element.find(".ui-menu-icon"),this._removeClass(C,null,this.options.icons.submenu)._addClass(C,null,w.submenu)),this._super(k,w)},_setOptionDisabled:function(k){this._super(k),this.element.attr("aria-disabled",String(k)),this._toggleClass(null,"ui-state-disabled",!!k)},focus:function(k,w){var C;this.blur(k,k&&k.type==="focus"),this._scrollIntoView(w),this.active=w.first(),C=this.active.children(".ui-menu-item-wrapper"),this._addClass(C,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",C.attr("id")),C=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(C,null,"ui-state-active"),k&&k.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),(C=w.children(".ui-menu")).length&&k&&/^mouse/.test(k.type)&&this._startOpening(C),this.activeMenu=w.parent(),this._trigger("focus",k,{item:w})},_scrollIntoView:function(k){var w,C,T;this._hasScroll()&&(C=parseFloat(n.css(this.activeMenu[0],"borderTopWidth"))||0,T=parseFloat(n.css(this.activeMenu[0],"paddingTop"))||0,w=k.offset().top-this.activeMenu.offset().top-C-T,C=this.activeMenu.scrollTop(),T=this.activeMenu.height(),k=k.outerHeight(),w<0?this.activeMenu.scrollTop(C+w):T<w+k&&this.activeMenu.scrollTop(C+w-T+k))},blur:function(k,w){w||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",k,{item:this.active}),this.active=null)},_startOpening:function(k){clearTimeout(this.timer),k.attr("aria-hidden")==="true"&&(this.timer=this._delay(function(){this._close(),this._open(k)},this.delay))},_open:function(k){var w=n.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(k.parents(".ui-menu")).hide().attr("aria-hidden","true"),k.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(w)},collapseAll:function(k,w){clearTimeout(this.timer),this.timer=this._delay(function(){var C=w?this.element:n(k&&k.target).closest(this.element.find(".ui-menu"));C.length||(C=this.element),this._close(C),this.blur(k),this._removeClass(C.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=C},this.delay)},_close:function(k){(k=k||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(k){return!n(k.target).closest(".ui-menu").length},_isDivider:function(k){return!/[^\-\u2014\u2013\s]/.test(k.text())},collapse:function(k){var w=this.active&&this.active.parent().closest(".ui-menu-item",this.element);w&&w.length&&(this._close(),this.focus(k,w))},expand:function(k){var w=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();w&&w.length&&(this._open(w.parent()),this._delay(function(){this.focus(k,w)}))},next:function(k){this._move("next","first",k)},previous:function(k){this._move("prev","last",k)},isFirstItem:function(){return this.active&&!this.active.preval(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(k,w,C){var T;this.active&&(T=k==="first"||k==="last"?this.active[k==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[k+"All"](".ui-menu-item").eq(0)),T&&T.length&&this.active||(T=this.activeMenu.find(this.options.items)[w]()),this.focus(C,T)},nextPage:function(k){var w,C,T;this.active?this.isLastItem()||(this._hasScroll()?(C=this.active.offset().top,T=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(w=n(this)).offset().top-C-T<0}),this.focus(k,w)):this.focus(k,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())):this.next(k)},previousPage:function(k){var w,C,T;this.active?this.isFirstItem()||(this._hasScroll()?(C=this.active.offset().top,T=this.element.height(),this.active.preval(".ui-menu-item").each(function(){return 0<(w=n(this)).offset().top-C+T}),this.focus(k,w)):this.focus(k,this.activeMenu.find(this.options.items).first())):this.next(k)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(k){this.active=this.active||n(k.target).closest(".ui-menu-item");var w={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(k,!0),this._trigger("select",k,w)},_filterMenuItems:function(k){var k=k.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),w=new RegExp("^"+k,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return w.test(n.trim(n(this).children(".ui-menu-item-wrapper").text()))})}}),n.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var F=!1;function D(k){return function(){var w=this.element.val();k.apply(this,arguments),this._refresh(),w!==this.element.val()&&this._trigger("change")}}n(document).on("mouseup",function(){F=!1}),n.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var k=this;this.element.on("mousedown."+this.widgetName,function(w){return k._mouseDown(w)}).on("click."+this.widgetName,function(w){if(n.data(w.target,k.widgetName+".preventClickEvent")===!0)return n.removeData(w.target,k.widgetName+".preventClickEvent"),w.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(k){if(!F){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(k),this._mouseDownEvent=k;var w=this,C=k.which===1,T=!(typeof this.options.cancel!="string"||!k.target.nodeName)&&n(k.target).closest(this.options.cancel).length;return!(C&&!T&&this._mouseCapture(k))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){w.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(k)&&this._mouseDelayMet(k)&&(this._mouseStarted=this._mouseStart(k)!==!1,!this._mouseStarted)?(k.preventDefault(),!0):(n.data(k.target,this.widgetName+".preventClickEvent")===!0&&n.removeData(k.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(O){return w._mouseMove(O)},this._mouseUpDelegate=function(O){return w._mouseUp(O)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),k.preventDefault(),F=!0))}},_mouseMove:function(k){if(this._mouseMoved){if(n.ui.ie&&(!document.documentMode||document.documentMode<9)&&!k.button)return this._mouseUp(k);if(!k.which){if(k.originalEvent.altKey||k.originalEvent.ctrlKey||k.originalEvent.metaKey||k.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(k)}}return(k.which||k.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(k),k.preventDefault()):(this._mouseDistanceMet(k)&&this._mouseDelayMet(k)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,k)!==!1,this._mouseStarted?this._mouseDrag(k):this._mouseUp(k)),!this._mouseStarted)},_mouseUp:function(k){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,k.target===this._mouseDownEvent.target&&n.data(k.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(k)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,F=!1,k.preventDefault()},_mouseDistanceMet:function(k){return Math.max(Math.abs(this._mouseDownEvent.pageX-k.pageX),Math.abs(this._mouseDownEvent.pageY-k.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),n.widget("ui.selectmenu",[n.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var k=this.element.uniqueId().attr("id");this.ids={element:k,button:k+"-button",menu:k+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=n()},_drawButton:function(){var k,w=this,C=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(T){this.button.focus(),T.preventDefault()}}),this.element.hide(),this.button=n("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),k=n("<span>").appendTo(this.button),this._addClass(k,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(C).appendTo(this.button),this.options.width!==!1&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){w._rendered||w._refreshMenu()})},_drawMenu:function(){var k=this;this.menu=n("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=n("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(w,C){w.preventDefault(),k._setSelection(),k._select(C.item.data("ui-selectmenu-item"),w)},focus:function(w,C){C=C.item.data("ui-selectmenu-item"),k.focusIndex!=null&&C.index!==k.focusIndex&&(k._trigger("focus",w,{item:C}),k.isOpen||k._select(C,w)),k.focusIndex=C.index,k.button.attr("aria-activedescendant",k.menuItems.eq(C.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),this.options.width===null&&this._resizeButton()},_refreshMenu:function(){var k=this.element.find("option");this.menu.empty(),this._parseOptions(k),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,k.length&&(k=this._getSelectedItem(),this.menuInstance.focus(null,k),this._setAria(k.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(k){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",k)))},_position:function(){this.menuWrap.position(n.extend({of:this.button},this.options.position))},close:function(k){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",k))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(k){var w=n("<span>");return this._setText(w,k.label),this._addClass(w,"ui-selectmenu-text"),w},_renderMenu:function(k,w){var C=this,T="";n.each(w,function(O,z){var A;z.optgroup!==T&&(A=n("<li>",{text:z.optgroup}),C._addClass(A,"ui-selectmenu-optgroup","ui-menu-divider"+(z.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),A.appendTo(k),T=z.optgroup),C._renderItemData(k,z)})},_renderItemData:function(k,w){return this._renderItem(k,w).data("ui-selectmenu-item",w)},_renderItem:function(k,w){var C=n("<li>"),T=n("<div>",{title:w.element.attr("title")});return w.disabled&&this._addClass(C,null,"ui-state-disabled"),this._setText(T,w.label),C.append(T).appendTo(k)},_setText:function(k,w){w?k.text(w):k.html("&#160;")},_move:function(k,w){var C,T=".ui-menu-item";this.isOpen?C=this.menuItems.eq(this.focusIndex).parent("li"):(C=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),T+=":not(.ui-state-disabled)"),(T=k==="first"||k==="last"?C[k==="first"?"prevAll":"nextAll"](T).eq(-1):C[k+"All"](T).eq(0)).length&&this.menuInstance.focus(w,T)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(k){this[this.isOpen?"close":"open"](k)},_setSelection:function(){var k;this.range&&(window.getSelection?((k=window.getSelection()).removeAllRanges(),k.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(k){this.isOpen&&(n(k.target).closest(".ui-selectmenu-menu, #"+n.ui.escapeSelector(this.ids.button)).length||this.close(k))}},_buttonEvents:{mousedown:function(){var k;window.getSelection?(k=window.getSelection()).rangeCount&&(this.range=k.getRangeAt(0)):this.range=document.selection.createRange()},click:function(k){this._setSelection(),this._toggle(k)},keydown:function(k){var w=!0;switch(k.keyCode){case n.ui.keyCode.TAB:case n.ui.keyCode.ESCAPE:this.close(k),w=!1;break;case n.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(k);break;case n.ui.keyCode.UP:k.altKey?this._toggle(k):this._move("prev",k);break;case n.ui.keyCode.DOWN:k.altKey?this._toggle(k):this._move("next",k);break;case n.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(k):this._toggle(k);break;case n.ui.keyCode.LEFT:this._move("prev",k);break;case n.ui.keyCode.RIGHT:this._move("next",k);break;case n.ui.keyCode.HOME:case n.ui.keyCode.PAGE_UP:this._move("first",k);break;case n.ui.keyCode.END:case n.ui.keyCode.PAGE_DOWN:this._move("last",k);break;default:this.menu.trigger(k),w=!1}w&&k.preventDefault()}},_selectFocusedItem:function(k){var w=this.menuItems.eq(this.focusIndex).parent("li");w.hasClass("ui-state-disabled")||this._select(w.data("ui-selectmenu-item"),k)},_select:function(k,w){var C=this.element[0].selectedIndex;this.element[0].selectedIndex=k.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(k)),this._setAria(k),this._trigger("select",w,{item:k}),k.index!==C&&this._trigger("change",w,{item:k}),this.close(w)},_setAria:function(k){k=this.menuItems.eq(k.index).attr("id"),this.button.attr({"aria-labelledby":k,"aria-activedescendant":k}),this.menu.attr("aria-activedescendant",k)},_setOption:function(k,w){var C;k==="icons"&&(C=this.button.find("span.ui-icon"),this._removeClass(C,null,this.options.icons.button)._addClass(C,null,w.button)),this._super(k,w),k==="appendTo"&&this.menuWrap.appendTo(this._appendTo()),k==="width"&&this._resizeButton()},_setOptionDisabled:function(k){this._super(k),this.menuInstance.option("disabled",k),this.button.attr("aria-disabled",k),this._toggleClass(this.button,null,"ui-state-disabled",k),this.element.prop("disabled",k),k?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var k=this.options.appendTo;return(k=k&&(k.jquery||k.nodeType?n(k):this.document.find(k).eq(0)))&&k[0]||(k=this.element.closest(".ui-front, dialog")),k.length||(k=this.document[0].body),k},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var k=this.options.width;k!==!1?(k===null&&(k=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(k)):this.button.css("width","")},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var k=this._super();return k.disabled=this.element.prop("disabled"),k},_parseOptions:function(k){var w=this,C=[];k.each(function(T,O){C.push(w._parseOption(n(O),T))}),this.items=C},_parseOption:function(k,w){var C=k.parent("optgroup");return{element:k,index:w,value:k.val(),label:k.text(),optgroup:C.attr("label")||"",disabled:C.prop("disabled")||k.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),n.widget("ui.slider",n.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var k,w=this.options,C=this.element.find(".ui-slider-handle"),T=[],O=w.values&&w.values.length||1;for(C.length>O&&(C.slice(O).remove(),C=C.slice(0,O)),k=C.length;k<O;k++)T.push("<span tabindex='0'></span>");this.handles=C.add(n(T.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(z){n(this).data("ui-slider-handle-index",z).attr("tabIndex",0)})},_createRange:function(){var k=this.options;k.range?(k.range===!0&&(k.values?k.values.length&&k.values.length!==2?k.values=[k.values[0],k.values[0]]:n.isArray(k.values)&&(k.values=k.values.slice(0)):k.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=n("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),k.range!=="min"&&k.range!=="max"||this._addClass(this.range,"ui-slider-range-"+k.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(k){var w,C,T,O,z,A,E=this,L=this.options;return!L.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),A={x:k.pageX,y:k.pageY},w=this._normValueFromMouse(A),C=this._valueMax()-this._valueMin()+1,this.handles.each(function(N){var W=Math.abs(w-E.values(N));(W<C||C===W&&(N===E._lastChangedValue||E.values(N)===L.min))&&(C=W,T=n(this),O=N)}),this._start(k,O)!==!1&&(this._mouseSliding=!0,this._handleIndex=O,this._addClass(T,null,"ui-state-active"),T.trigger("focus"),z=T.offset(),A=!n(k.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=A?{left:0,top:0}:{left:k.pageX-z.left,top:k.pageY-z.top-T.height()/2-(parseInt(T.css("borderTopWidth"),10)||0)-(parseInt(T.css("borderBottomWidth"),10)||0)+(parseInt(T.css("marginTop"),10)||0)},this._animateOff=!0))},_mouseStart:function(){return!0},_mouseDrag:function(k){var w={x:k.pageX,y:k.pageY},w=this._normValueFromMouse(w);return this._slide(k,this._handleIndex,w),!1},_mouseStop:function(k){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(k,this._handleIndex),this._change(k,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(k){var w,k=this.orientation==="horizontal"?(w=this.elementSize.width,k.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(w=this.elementSize.height,k.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));return 1<(k=k/w)&&(k=1),k<0&&(k=0),this.orientation==="vertical"&&(k=1-k),w=this._valueMax()-this._valueMin(),w=this._valueMin()+k*w,this._trimAlignValue(w)},_uiHash:function(k,w,C){var T={handle:this.handles[k],handleIndex:k,value:w!==void 0?w:this.value()};return this._hasMultipleValues()&&(T.value=w!==void 0?w:this.values(k),T.values=C||this.values()),T},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(k,w){return this._trigger("start",k,this._uiHash(w))},_slide:function(k,w,C){var T,O=this.value(),z=this.values();this._hasMultipleValues()&&(T=this.values(w?0:1),O=this.values(w),this.options.values.length===2&&this.options.range===!0&&(C=w===0?Math.min(T,C):Math.max(T,C)),z[w]=C),C!==O&&this._trigger("slide",k,this._uiHash(w,C,z))!==!1&&(this._hasMultipleValues()?this.values(w,C):this.value(C))},_stop:function(k,w){this._trigger("stop",k,this._uiHash(w))},_change:function(k,w){this._keySliding||this._mouseSliding||(this._lastChangedValue=w,this._trigger("change",k,this._uiHash(w)))},value:function(k){return arguments.length?(this.options.value=this._trimAlignValue(k),this._refreshValue(),void this._change(null,0)):this._value()},values:function(k,w){var C,T,O;if(1<arguments.length)return this.options.values[k]=this._trimAlignValue(w),this._refreshValue(),void this._change(null,k);if(!arguments.length)return this._values();if(!n.isArray(k))return this._hasMultipleValues()?this._values(k):this.value();for(C=this.options.values,T=k,O=0;O<C.length;O+=1)C[O]=this._trimAlignValue(T[O]),this._change(null,O);this._refreshValue()},_setOption:function(k,w){var C,T=0;switch(k==="range"&&this.options.range===!0&&(w==="min"?(this.options.value=this._values(0),this.options.values=null):w==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),n.isArray(this.options.values)&&(T=this.options.values.length),this._super(k,w),k){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(w),this.handles.css(w==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),C=T-1;0<=C;C--)this._change(null,C);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(k){this._super(k),this._toggleClass(null,"ui-state-disabled",!!k)},_value:function(){var k=this.options.value;return this._trimAlignValue(k)},_values:function(k){var w,C,T;if(arguments.length)return w=this.options.values[k],this._trimAlignValue(w);if(this._hasMultipleValues()){for(C=this.options.values.slice(),T=0;T<C.length;T+=1)C[T]=this._trimAlignValue(C[T]);return C}return[]},_trimAlignValue:function(k){if(k<=this._valueMin())return this._valueMin();if(k>=this._valueMax())return this._valueMax();var w=0<this.options.step?this.options.step:1,C=(k-this._valueMin())%w,k=k-C;return 2*Math.abs(C)>=w&&(k+=0<C?w:-w),parseFloat(k.toFixed(5))},_calculateNewMax:function(){var k=this.options.max,w=this._valueMin(),C=this.options.step;(k=Math.round((k-w)/C)*C+w)>this.options.max&&(k-=C),this.max=parseFloat(k.toFixed(this._precision()))},_precision:function(){var k=this._precisionOf(this.options.step);return this.options.min!==null&&(k=Math.max(k,this._precisionOf(this.options.min))),k},_precisionOf:function(k){var w=k.toString(),k=w.indexOf(".");return k===-1?0:w.length-k-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(k){k==="vertical"&&this.range.css({width:"",left:""}),k==="horizontal"&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var k,w,C,T,O,z=this.options.range,A=this.options,E=this,L=!this._animateOff&&A.animate,N={};this._hasMultipleValues()?this.handles.each(function(W){w=(E.values(W)-E._valueMin())/(E._valueMax()-E._valueMin())*100,N[E.orientation==="horizontal"?"left":"bottom"]=w+"%",n(this).stop(1,1)[L?"animate":"css"](N,A.animate),E.options.range===!0&&(E.orientation==="horizontal"?(W===0&&E.range.stop(1,1)[L?"animate":"css"]({left:w+"%"},A.animate),W===1&&E.range[L?"animate":"css"]({width:w-k+"%"},{queue:!1,duration:A.animate})):(W===0&&E.range.stop(1,1)[L?"animate":"css"]({bottom:w+"%"},A.animate),W===1&&E.range[L?"animate":"css"]({height:w-k+"%"},{queue:!1,duration:A.animate}))),k=w}):(C=this.value(),T=this._valueMin(),O=this._valueMax(),w=O!==T?(C-T)/(O-T)*100:0,N[this.orientation==="horizontal"?"left":"bottom"]=w+"%",this.handle.stop(1,1)[L?"animate":"css"](N,A.animate),z==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[L?"animate":"css"]({width:w+"%"},A.animate),z==="max"&&this.orientation==="horizontal"&&this.range.stop(1,1)[L?"animate":"css"]({width:100-w+"%"},A.animate),z==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[L?"animate":"css"]({height:w+"%"},A.animate),z==="max"&&this.orientation==="vertical"&&this.range.stop(1,1)[L?"animate":"css"]({height:100-w+"%"},A.animate))},_handleEvents:{keydown:function(k){var w,C,T,O=n(k.target).data("ui-slider-handle-index");switch(k.keyCode){case n.ui.keyCode.HOME:case n.ui.keyCode.END:case n.ui.keyCode.PAGE_UP:case n.ui.keyCode.PAGE_DOWN:case n.ui.keyCode.UP:case n.ui.keyCode.RIGHT:case n.ui.keyCode.DOWN:case n.ui.keyCode.LEFT:if(k.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(n(k.target),null,"ui-state-active"),this._start(k,O)===!1))return}switch(T=this.options.step,w=C=this._hasMultipleValues()?this.values(O):this.value(),k.keyCode){case n.ui.keyCode.HOME:C=this._valueMin();break;case n.ui.keyCode.END:C=this._valueMax();break;case n.ui.keyCode.PAGE_UP:C=this._trimAlignValue(w+(this._valueMax()-this._valueMin())/this.numPages);break;case n.ui.keyCode.PAGE_DOWN:C=this._trimAlignValue(w-(this._valueMax()-this._valueMin())/this.numPages);break;case n.ui.keyCode.UP:case n.ui.keyCode.RIGHT:if(w===this._valueMax())return;C=this._trimAlignValue(w+T);break;case n.ui.keyCode.DOWN:case n.ui.keyCode.LEFT:if(w===this._valueMin())return;C=this._trimAlignValue(w-T)}this._slide(k,O,C)},keyup:function(k){var w=n(k.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(k,w),this._change(k,w),this._removeClass(n(k.target),null,"ui-state-active"))}}}),n.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this.value()!==""&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var k=this._super(),w=this.element;return n.each(["min","max","step"],function(C,T){var O=w.attr(T);O!=null&&O.length&&(k[T]=O)}),k},_events:{keydown:function(k){this._start(k)&&this._keydown(k)&&k.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(k){this.cancelBlur?delete this.cancelBlur:(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",k))},mousewheel:function(k,w){if(w){if(!this.spinning&&!this._start(k))return!1;this._spin((0<w?1:-1)*this.options.step,k),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(k)},100),k.preventDefault()}},"mousedown .ui-spinner-button":function(k){var w;function C(){this.element[0]===n.ui.safeActiveElement(this.document[0])||(this.element.trigger("focus"),this.previous=w,this._delay(function(){this.previous=w}))}w=this.element[0]===n.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),k.preventDefault(),C.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,C.call(this)}),this._start(k)!==!1&&this._repeat(null,n(k.currentTarget).hasClass("ui-spinner-up")?1:-1,k)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(k){if(n(k.currentTarget).hasClass("ui-state-active"))return this._start(k)!==!1&&void this._repeat(null,n(k.currentTarget).hasClass("ui-spinner-up")?1:-1,k)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&0<this.uiSpinner.height()&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(k){var w=this.options,C=n.ui.keyCode;switch(k.keyCode){case C.UP:return this._repeat(null,1,k),!0;case C.DOWN:return this._repeat(null,-1,k),!0;case C.PAGE_UP:return this._repeat(null,w.page,k),!0;case C.PAGE_DOWN:return this._repeat(null,-w.page,k),!0}return!1},_start:function(k){return!(!this.spinning&&this._trigger("start",k)===!1)&&(this.counter||(this.counter=1),this.spinning=!0)},_repeat:function(k,w,C){k=k||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,w,C)},k),this._spin(w*this.options.step,C)},_spin:function(k,w){var C=this.value()||0;this.counter||(this.counter=1),C=this._adjustValue(C+k*this._increment(this.counter)),this.spinning&&this._trigger("spin",w,{value:C})===!1||(this._value(C),this.counter++)},_increment:function(k){var w=this.options.incremental;return w?n.isFunction(w)?w(k):Math.floor(k*k*k/5e4-k*k/500+17*k/200+1):1},_precision:function(){var k=this._precisionOf(this.options.step);return this.options.min!==null&&(k=Math.max(k,this._precisionOf(this.options.min))),k},_precisionOf:function(k){var w=k.toString(),k=w.indexOf(".");return k===-1?0:w.length-k-1},_adjustValue:function(k){var w,C=this.options,T=k-(w=C.min!==null?C.min:0);return k=w+Math.round(T/C.step)*C.step,k=parseFloat(k.toFixed(this._precision())),C.max!==null&&k>C.max?C.max:C.min!==null&&k<C.min?C.min:k},_stop:function(k){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",k))},_setOption:function(k,w){var C;if(k==="culture"||k==="numberFormat")return C=this._parse(this.element.val()),this.options[k]=w,void this.element.val(this._format(C));k!=="max"&&k!=="min"&&k!=="step"||typeof w=="string"&&(w=this._parse(w)),k==="icons"&&(C=this.buttons.first().find(".ui-icon"),this._removeClass(C,null,this.options.icons.up),this._addClass(C,null,w.up),C=this.buttons.last().find(".ui-icon"),this._removeClass(C,null,this.options.icons.down),this._addClass(C,null,w.down)),this._super(k,w)},_setOptionDisabled:function(k){this._super(k),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!k),this.element.prop("disabled",!!k),this.buttons.button(k?"disable":"enable")},_setOptions:D(function(k){this._super(k)}),_parse:function(k){return typeof k=="string"&&k!==""&&(k=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(k,10,this.options.culture):+k),k===""||isNaN(k)?null:k},_format:function(k){return k===""?"":window.Globalize&&this.options.numberFormat?Globalize.format(k,this.options.numberFormat,this.options.culture):k},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var k=this.value();return k!==null&&k===this._adjustValue(k)},_value:function(k,w){var C;k!==""&&(C=this._parse(k))!==null&&(w||(C=this._adjustValue(C)),k=this._format(C)),this.element.val(k),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:D(function(k){this._stepUp(k)}),_stepUp:function(k){this._start()&&(this._spin((k||1)*this.options.step),this._stop())},stepDown:D(function(k){this._stepDown(k)}),_stepDown:function(k){this._start()&&(this._spin((k||1)*-this.options.step),this._stop())},pageUp:D(function(k){this._stepUp((k||1)*this.options.page)}),pageDown:D(function(k){this._stepDown((k||1)*this.options.page)}),value:function(k){if(!arguments.length)return this._parse(this.element.val());D(this._value).call(this,k)},widget:function(){return this.uiSpinner}}),n.uiBackCompat!==!1&&n.widget("ui.spinner",n.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),n.ui.spinner};typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)}(),function(e){typeof define=="function"&&define.amd?define(["jquery"],e):typeof Bn=="object"?Zn.exports=e:e(jQuery)}(function(e){function n(p){var b,g=p||window.event,v=f.call(arguments,1),x=0,_=0,S=0,I=0,P=0,F=0;if((p=e.event.fix(g)).type="mousewheel","detail"in g&&(S=-1*g.detail),"wheelDelta"in g&&(S=g.wheelDelta),"wheelDeltaY"in g&&(S=g.wheelDeltaY),"wheelDeltaX"in g&&(_=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(_=-1*S,S=0),x=S===0?_:S,"deltaY"in g&&(x=S=-1*g.deltaY),"deltaX"in g&&(_=g.deltaX,S===0&&(x=-1*_)),S!==0||_!==0){g.deltaMode===1?(x*=b=e.data(this,"mousewheel-line-height"),S*=b,_*=b):g.deltaMode===2&&(x*=b=e.data(this,"mousewheel-page-height"),S*=b,_*=b);var I=Math.max(Math.abs(S),Math.abs(_));return a&&!(I<a)||l(g,a=I)&&(a/=40),l(g,I)&&(x/=40,_/=40,S/=40),x=Math[1<=x?"floor":"ceil"](x/a),_=Math[1<=_?"floor":"ceil"](_/a),S=Math[1<=S?"floor":"ceil"](S/a),d.settings.normalizeOffset&&this.getBoundingClientRect&&(I=this.getBoundingClientRect(),P=p.clientX-I.left,F=p.clientY-I.top),p.deltaX=_,p.deltaY=S,p.deltaFactor=a,p.offsetX=P,p.offsetY=F,p.deltaMode=0,v.unshift(p,x,_,S),o&&clearTimeout(o),o=setTimeout(t,200),(e.event.dispatch||e.event.handle).apply(this,v)}}function t(){a=null}function l(p,b){return d.settings.adjustOldDeltas&&p.type==="mousewheel"&&b%120==0}var o,a,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],u="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],f=Array.prototype.slice;if(e.event.fixHooks)for(var m=s.length;m;)e.event.fixHooks[s[--m]]=e.event.mouseHooks;var d=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var p=u.length;p;)this.addEventListener(u[--p],n,!1);else this.onmousewheel=n;e.data(this,"mousewheel-line-height",d.getLineHeight(this)),e.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var p=u.length;p;)this.removeEventListener(u[--p],n,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(p){var b=e(p),p=b["offsetParent"in e.fn?"offsetParent":"parent"]();return p.length||(p=e("body")),parseInt(p.css("fontSize"),10)||parseInt(b.css("fontSize"),10)||16},getPageHeight:function(p){return e(p).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(p){return p?this.bind("mousewheel",p):this.trigger("mousewheel")},unmousewheel:function(p){return this.unbind("mousewheel",p)}})}),function(e){var n;typeof Bn=="object"&&typeof Zn!="undefined"?Zn.exports=e():typeof define=="function"&&define.amd?define([],e):(typeof window!="undefined"?n=window:typeof global!="undefined"?n=global:typeof self!="undefined"&&(n=self),n.html2canvas=e())}(function(){return function e(n,t,l){function o(u,f){if(!t[u]){if(!n[u]){var m=typeof Va=="function"&&Va;if(!f&&m)return m(u,!0);if(a)return a(u,!0);throw m=new Error("Cannot find module '"+u+"'"),m.code="MODULE_NOT_FOUND",m}m=t[u]={exports:{}},n[u][0].call(m.exports,function(d){var p=n[u][1][d];return o(p||d)},m,m.exports,e,n,t,l)}return t[u].exports}for(var a=typeof Va=="function"&&Va,s=0;s<l.length;s++)o(l[s]);return o}({1:[function(e,n,t){(function(l){(function(o){function a(ue){throw RangeError(L[ue])}function s(ue,pe){for(var ne=ue.length;ne--;)ue[ne]=pe(ue[ne]);return ue}function u(ue,pe){return s(ue.split(E),pe).join(".")}function f(ue){for(var pe,ne,me=[],Q=0,we=ue.length;Q<we;)55296<=(pe=ue.charCodeAt(Q++))&&pe<=56319&&Q<we?(64512&(ne=ue.charCodeAt(Q++)))==56320?me.push(((1023&pe)<<10)+(1023&ne)+65536):(me.push(pe),Q--):me.push(pe);return me}function m(ue){return s(ue,function(pe){var ne="";return 65535<pe&&(ne+=X((pe-=65536)>>>10&1023|55296),pe=56320|1023&pe),ne+X(pe)}).join("")}function d(ue,pe){return ue+22+75*(ue<26)-((pe!=0)<<5)}function p(ue,pe,ne){var me=0;for(ue=ne?W(ue/w):ue>>1,ue+=W(ue/pe);N*D>>1<ue;me+=P)ue=W(ue/N);return W(me+(N+1)*ue/(ue+k))}function b(ue){var pe,ne,me,Q,we,ie,ge,ce=[],fe=ue.length,ye=0,Ne=T,xe=C,et=ue.lastIndexOf(O);for(et<0&&(et=0),ne=0;ne<et;++ne)128<=ue.charCodeAt(ne)&&a("not-basic"),ce.push(ue.charCodeAt(ne));for(me=0<et?et+1:0;me<fe;){for(Q=ye,we=1,ie=P;fe<=me&&a("invalid-input"),ge=ue.charCodeAt(me++),(P<=(ge=ge-48<10?ge-22:ge-65<26?ge-65:ge-97<26?ge-97:P)||ge>W((I-ye)/we))&&a("overflow"),ye+=ge*we,!(ge<(ge=ie<=xe?F:xe+D<=ie?D:ie-xe));ie+=P)we>W(I/(ge=P-ge))&&a("overflow"),we*=ge;xe=p(ye-Q,pe=ce.length+1,Q==0),W(ye/pe)>I-Ne&&a("overflow"),Ne+=W(ye/pe),ye%=pe,ce.splice(ye++,0,Ne)}return m(ce)}function g(ue){for(var pe,ne,me,Q,we,ie,ge,ce,fe,ye,Ne,xe=[],et=(ue=f(ue)).length,Fe=T,it=C,wt=pe=0;wt<et;++wt)(ce=ue[wt])<128&&xe.push(X(ce));for(ne=me=xe.length,me&&xe.push(O);ne<et;){for(Q=I,wt=0;wt<et;++wt)Fe<=(ce=ue[wt])&&ce<Q&&(Q=ce);for(Q-Fe>W((I-pe)/(fe=ne+1))&&a("overflow"),pe+=(Q-Fe)*fe,Fe=Q,wt=0;wt<et;++wt)if((ce=ue[wt])<Fe&&++pe>I&&a("overflow"),ce==Fe){for(we=pe,ie=P;!(we<(ge=ie<=it?F:it+D<=ie?D:ie-it));ie+=P)Ne=we-ge,ye=P-ge,xe.push(X(d(ge+Ne%ye,0))),we=W(Ne/ye);xe.push(X(d(we,0))),it=p(pe,fe,ne==me),pe=0,++ne}++pe,++Fe}return xe.join("")}var v=typeof t=="object"&&t,x=typeof n=="object"&&n&&n.exports==v&&n,_=typeof l=="object"&&l;_.global!==_&&_.window!==_||(o=_);var S,I=2147483647,P=36,F=1,D=26,k=38,w=700,C=72,T=128,O="-",z=/^xn--/,A=/[^ -~]/,E=/\x2E|\u3002|\uFF0E|\uFF61/g,L={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},N=P-F,W=Math.floor,X=String.fromCharCode,te={version:"1.2.4",ucs2:{decode:f,encode:m},decode:b,encode:g,toASCII:function(ue){return u(ue,function(pe){return A.test(pe)?"xn--"+g(pe):pe})},toUnicode:function(ue){return u(ue,function(pe){return z.test(pe)?b(pe.slice(4).toLowerCase()):pe})}};if(v&&!v.nodeType)if(x)x.exports=te;else for(S in te)te.hasOwnProperty(S)&&(v[S]=te[S]);else o.punycode=te})(this)}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(e,n){function t(o,a){for(var s=o.nodeType===3?document.createTextNode(o.nodeValue):o.cloneNode(!1),u=o.firstChild;u;)a!==!0&&u.nodeType===1&&u.nodeName==="SCRIPT"||s.appendChild(t(u,a)),u=u.nextSibling;return o.nodeType===1&&(s._scrollTop=o.scrollTop,s._scrollLeft=o.scrollLeft,o.nodeName==="CANVAS"?function(f,m){try{m&&(m.width=f.width,m.height=f.height,m.getContext("2d").putImageData(f.getContext("2d").getImageData(0,0,f.width,f.height),0,0))}catch(d){l("Unable to copy canvas content from",f,d)}}(o,s):o.nodeName!=="TEXTAREA"&&o.nodeName!=="SELECT"||(s.value=o.value)),s}var l=e("./log");n.exports=function(o,a,s,u,f,m,d){var p=t(o.documentElement,f.javascriptEnabled),b=a.createElement("iframe");return b.className="html2canvas-container",b.style.visibility="hidden",b.style.position="fixed",b.style.left="-10000px",b.style.top="0px",b.style.border="0",b.width=s,b.height=u,b.scrolling="no",a.body.appendChild(b),new Promise(function(g){var v,x,_,S=b.contentWindow.document;b.contentWindow.onload=b.onload=function(){var I=setInterval(function(){0<S.body.childNodes.length&&(function P(F){if(F.nodeType===1){F.scrollTop=F._scrollTop,F.scrollLeft=F._scrollLeft;for(var D=F.firstChild;D;)P(D),D=D.nextSibling}}(S.documentElement),clearInterval(I),f.type==="view"&&(b.contentWindow.scrollTo(m,d),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||b.contentWindow.scrollY===d&&b.contentWindow.scrollX===m||(S.documentElement.style.top=-d+"px",S.documentElement.style.left=-m+"px",S.documentElement.style.position="absolute")),g(b))},50)},S.open(),S.write("<!DOCTYPE html><html></html>"),x=m,_=d,!(v=o).defaultView||x===v.defaultView.pageXOffset&&_===v.defaultView.pageYOffset||v.defaultView.scrollTo(x,_),S.replaceChild(S.adoptNode(p),S.documentElement),S.close()})}},{"./log":13}],3:[function(e,n){function t(f){this.r=0,this.g=0,this.b=0,this.a=null,this.fromArray(f)||this.namedColor(f)||this.rgb(f)||this.rgba(f)||this.hex6(f)||this.hex3(f)}t.prototype.darken=function(f){return f=1-f,new t([Math.round(this.r*f),Math.round(this.g*f),Math.round(this.b*f),this.a])},t.prototype.isTransparent=function(){return this.a===0},t.prototype.isBlack=function(){return this.r===0&&this.g===0&&this.b===0},t.prototype.fromArray=function(f){return Array.isArray(f)&&(this.r=Math.min(f[0],255),this.g=Math.min(f[1],255),this.b=Math.min(f[2],255),3<f.length&&(this.a=f[3])),Array.isArray(f)};var l=/^#([a-f0-9]{3})$/i;t.prototype.hex3=function(f){var m;return(m=f.match(l))!==null&&(this.r=parseInt(m[1][0]+m[1][0],16),this.g=parseInt(m[1][1]+m[1][1],16),this.b=parseInt(m[1][2]+m[1][2],16)),m!==null};var o=/^#([a-f0-9]{6})$/i;t.prototype.hex6=function(f){var m=null;return(m=f.match(o))!==null&&(this.r=parseInt(m[1].substring(0,2),16),this.g=parseInt(m[1].substring(2,4),16),this.b=parseInt(m[1].substring(4,6),16)),m!==null};var a=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;t.prototype.rgb=function(f){var m;return(m=f.match(a))!==null&&(this.r=Number(m[1]),this.g=Number(m[2]),this.b=Number(m[3])),m!==null};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;t.prototype.rgba=function(f){var m;return(m=f.match(s))!==null&&(this.r=Number(m[1]),this.g=Number(m[2]),this.b=Number(m[3]),this.a=Number(m[4])),m!==null},t.prototype.toString=function(){return this.a!==null&&this.a!==1?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},t.prototype.namedColor=function(f){f=f.toLowerCase();var m=u[f];if(m)this.r=m[0],this.g=m[1],this.b=m[2];else if(f==="transparent")return!(this.r=this.g=this.b=this.a=0);return!!m},t.prototype.isColor=!0;var u={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};n.exports=t},{}],4:[function(e,n){function t(S,I){var P,F,D=_++;if((I=I||{}).logging&&(d.options.logging=!0,d.options.start=Date.now()),I.async=I.async===void 0||I.async,I.allowTaint=I.allowTaint!==void 0&&I.allowTaint,I.removeContainer=I.removeContainer===void 0||I.removeContainer,I.javascriptEnabled=I.javascriptEnabled!==void 0&&I.javascriptEnabled,I.imageTimeout=I.imageTimeout===void 0?1e4:I.imageTimeout,I.renderer=typeof I.renderer=="function"?I.renderer:s,I.strict=!!I.strict,typeof S=="string"){if(typeof I.proxy!="string")return Promise.reject("Proxy must be used when rendering url");var k=I.width!=null?I.width:window.innerWidth,w=I.height!=null?I.height:window.innerHeight;return g((P=S,(F=document.createElement("a")).href=P,F.href=F.href,F),I.proxy,document,k,w,I).then(function(E){return l(E.contentWindow.document.documentElement,E,I,k,w)})}var C,T,O,z,A,S=(S===void 0?[document.documentElement]:S.length?S:[S])[0];return S.setAttribute(x+D,D),C=S.ownerDocument,T=I,O=S.ownerDocument.defaultView.innerWidth,z=S.ownerDocument.defaultView.innerHeight,A=D,b(C,C,O,z,T,C.defaultView.pageXOffset,C.defaultView.pageYOffset).then(function(E){d("Document cloned");var L=x+A,N="["+L+"='"+A+"']";C.querySelector(N).removeAttribute(L);var L=E.contentWindow,W=L.document.querySelector(N);return Promise.resolve(typeof T.onclone!="function"||T.onclone(L.document)).then(function(){return l(W,E,T,O,z)})}).then(function(E){return typeof I.onrendered=="function"&&(d("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),I.onrendered(E)),E})}function l(S,I,P,F,D){var k,w,C=I.contentWindow,T=new a(C.document),O=new u(P,T),z=v(S),w=P.type==="view"?F:(w=C.document,Math.max(Math.max(w.body.scrollWidth,w.documentElement.scrollWidth),Math.max(w.body.offsetWidth,w.documentElement.offsetWidth),Math.max(w.body.clientWidth,w.documentElement.clientWidth))),k=P.type==="view"?D:(k=C.document,Math.max(Math.max(k.body.scrollHeight,k.documentElement.scrollHeight),Math.max(k.body.offsetHeight,k.documentElement.offsetHeight),Math.max(k.body.clientHeight,k.documentElement.clientHeight))),A=new P.renderer(w,k,O,P,document);return new f(S,A,T,O,P).ready.then(function(){var E,L;return d("Finished rendering"),E=P.type==="view"?o(A.canvas,{width:A.canvas.width,height:A.canvas.height,top:0,left:0,x:0,y:0}):S===C.document.body||S===C.document.documentElement||P.canvas!=null?A.canvas:o(A.canvas,{width:(P.width!=null?P:z).width,height:(P.height!=null?P:z).height,top:z.top,left:z.left,x:0,y:0}),L=I,P.removeContainer&&(L.parentNode.removeChild(L),d("Cleaned up container")),E})}function o(S,I){var P=document.createElement("canvas"),F=Math.min(S.width-1,Math.max(0,I.left)),D=Math.min(S.width,Math.max(1,I.left+I.width)),k=Math.min(S.height-1,Math.max(0,I.top)),w=Math.min(S.height,Math.max(1,I.top+I.height));return P.width=I.width,P.height=I.height,D-=F,w-=k,d("Cropping canvas at:","left:",I.left,"top:",I.top,"width:",D,"height:",w),d("Resulting crop with width",I.width,"and height",I.height,"with x",F,"and y",k),P.getContext("2d").drawImage(S,F,k,D,w,I.x,I.y,D,w),P}var a=e("./support"),s=e("./renderers/canvas"),u=e("./imageloader"),f=e("./nodeparser"),m=e("./nodecontainer"),d=e("./log"),p=e("./utils"),b=e("./clone"),g=e("./proxy").loadUrlDocument,v=p.getBounds,x="data-html2canvas-node",_=0;t.CanvasRenderer=s,t.NodeContainer=m,t.log=d,t.utils=p,p=typeof document=="undefined"||typeof Object.create!="function"||typeof document.createElement("canvas").getContext!="function"?function(){return Promise.reject("No canvas support")}:t,n.exports=p},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(e,n){function t(a){var s;this.src=a,l("DummyImageContainer for",a),this.promise&&this.image||(l("Initiating DummyImageContainer"),t.prototype.image=new Image,s=this.image,t.prototype.promise=new Promise(function(u,f){s.onload=u,s.onerror=f,s.src=o(),s.complete===!0&&u(s)}))}var l=e("./log"),o=e("./utils").smallImage;n.exports=t},{"./log":13,"./utils":26}],6:[function(e,n){var t=e("./utils").smallImage;n.exports=function(l,o){var a=document.createElement("div"),s=document.createElement("img"),u=document.createElement("span"),f="Hidden Text";a.style.visibility="hidden",a.style.fontFamily=l,a.style.fontSize=o,a.style.margin=0,a.style.padding=0,document.body.appendChild(a),s.src=t(),s.width=1,s.height=1,s.style.margin=0,s.style.padding=0,s.style.verticalAlign="baseline",u.style.fontFamily=l,u.style.fontSize=o,u.style.margin=0,u.style.padding=0,u.appendChild(document.createTextNode(f)),a.appendChild(u),a.appendChild(s),o=s.offsetTop-u.offsetTop+1,a.removeChild(u),a.appendChild(document.createTextNode(f)),a.style.lineHeight="normal",s.style.verticalAlign="super",s=s.offsetTop-a.offsetTop+1,document.body.removeChild(a),this.baseline=o,this.lineWidth=1,this.middle=s}},{"./utils":26}],7:[function(e,n){function t(){this.data={}}var l=e("./font");t.prototype.getMetrics=function(o,a){return this.data[o+"-"+a]===void 0&&(this.data[o+"-"+a]=new l(o,a)),this.data[o+"-"+a]},n.exports=t},{"./font":6}],8:[function(e,n){function t(a,s,u){this.image=null,this.src=a;var f=this,m=l(a);this.promise=(s?new Promise(function(d){a.contentWindow.document.URL==="about:blank"||a.contentWindow.document.documentElement==null?a.contentWindow.onload=a.onload=function(){d(a)}:d(a)}):this.proxyLoad(u.proxy,m,u)).then(function(d){return e("./core")(d.contentWindow.document.documentElement,{type:"view",width:d.width,height:d.height,proxy:u.proxy,javascriptEnabled:u.javascriptEnabled,removeContainer:u.removeContainer,allowTaint:u.allowTaint,imageTimeout:u.imageTimeout/2})}).then(function(d){return f.image=d})}var l=e("./utils").getBounds,o=e("./proxy").loadUrlDocument;t.prototype.proxyLoad=function(a,s,u){var f=this.src;return o(f.src,a,f.ownerDocument,s.width,s.height,u)},n.exports=t},{"./core":4,"./proxy":16,"./utils":26}],9:[function(e,n){function t(l){this.src=l.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=Promise.resolve(!0)}t.TYPES={LINEAR:1,RADIAL:2},t.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,n.exports=t},{}],10:[function(e,n){n.exports=function(t,l){this.src=t,this.image=new Image;var o=this;this.tainted=null,this.promise=new Promise(function(a,s){o.image.onload=a,o.image.onerror=s,l&&(o.image.crossOrigin="anonymous"),o.image.src=t,o.image.complete===!0&&a(o.image)})}},{}],11:[function(e,n){function t(g,v){this.link=null,this.options=g,this.support=v,this.origin=this.getOrigin(window.location.href)}var l=e("./log"),o=e("./imagecontainer"),a=e("./dummyimagecontainer"),s=e("./proxyimagecontainer"),u=e("./framecontainer"),f=e("./svgcontainer"),m=e("./svgnodecontainer"),d=e("./lineargradientcontainer"),p=e("./webkitgradientcontainer"),b=e("./utils").bind;t.prototype.findImages=function(g){var v=[];return g.reduce(function(x,_){switch(_.node.nodeName){case"IMG":return x.concat([{args:[_.node.src],method:"url"}]);case"svg":case"IFRAME":return x.concat([{args:[_.node],method:_.node.nodeName}])}return x},[]).forEach(this.addImage(v,this.loadImage),this),v},t.prototype.findBackgroundImage=function(g,v){return v.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(g,this.loadImage),this),g},t.prototype.addImage=function(g,v){return function(x){x.args.forEach(function(_){this.imageExists(g,_)||(g.splice(0,0,v.call(this,x)),l("Added image #"+g.length,typeof _=="string"?_.substring(0,100):_))},this)}},t.prototype.hasImageBackground=function(g){return g.method!=="none"},t.prototype.loadImage=function(g){return g.method!=="url"?g.method==="linear-gradient"?new d(g):g.method==="gradient"?new p(g):g.method==="svg"?new m(g.args[0],this.support.svg):g.method==="IFRAME"?new u(g.args[0],this.isSameOrigin(g.args[0].src),this.options):new a(g):(g=g.args[0],!this.isSVG(g)||this.support.svg||this.options.allowTaint?g.match(/data:image\/.*;base64,/i)?new o(g.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(g)||this.options.allowTaint===!0||this.isSVG(g)?new o(g,!1):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new o(g,!0):this.options.proxy?new s(g,this.options.proxy):new a(g):new f(g))},t.prototype.isSVG=function(g){return g.substring(g.length-3).toLowerCase()==="svg"||f.prototype.isInline(g)},t.prototype.imageExists=function(g,v){return g.some(function(x){return x.src===v})},t.prototype.isSameOrigin=function(g){return this.getOrigin(g)===this.origin},t.prototype.getOrigin=function(g){var v=this.link||(this.link=document.createElement("a"));return v.href=g,v.href=v.href,v.protocol+v.hostname+v.port},t.prototype.getPromise=function(g){return this.timeout(g,this.options.imageTimeout).catch(function(){return new a(g.src).promise.then(function(v){g.image=v})})},t.prototype.get=function(g){var v=null;return this.images.some(function(x){return(v=x).src===g})?v:null},t.prototype.fetch=function(g){return this.images=g.reduce(b(this.findBackgroundImage,this),this.findImages(g)),this.images.forEach(function(v,x){v.promise.then(function(){l("Succesfully loaded image #"+(x+1),v)},function(_){l("Failed loading image #"+(x+1),v,_)})}),this.ready=Promise.all(this.images.map(this.getPromise,this)),l("Finished searching images"),this},t.prototype.timeout=function(g,v){var x,_=Promise.race([g.promise,new Promise(function(S,I){x=setTimeout(function(){l("Timed out loading image",g),I(g)},v)})]).then(function(S){return clearTimeout(x),S});return _.catch(function(){clearTimeout(x)}),_},n.exports=t},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(e,n){function t(a){l.apply(this,arguments),this.type=l.TYPES.LINEAR;var s=t.REGEXP_DIRECTION.test(a.args[0])||!l.REGEXP_COLORSTOP.test(a.args[0]);s?a.args[0].split(/\s+/).reverse().forEach(function(u,f){switch(u){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var m=this.y0,d=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=d,this.y1=m;break;case"center":break;default:if(m=.01*parseFloat(u,10),isNaN(m))break;f===0?(this.y0=m,this.y1=1-this.y0):(this.x0=m,this.x1=1-this.x0)}},this):(this.y0=0,this.y1=1),this.colorStops=a.args.slice(s?1:0).map(function(u){var f=u.match(l.REGEXP_COLORSTOP),m=+f[2],u=m==0?"%":f[3];return{color:new o(f[1]),stop:u==="%"?m/100:null}}),this.colorStops[0].stop===null&&(this.colorStops[0].stop=0),this.colorStops[this.colorStops.length-1].stop===null&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(u,f){u.stop===null&&this.colorStops.slice(f).some(function(m,d){return m.stop!==null&&(u.stop=(m.stop-this.colorStops[f-1].stop)/(d+1)+this.colorStops[f-1].stop,!0)},this)},this)}var l=e("./gradientcontainer"),o=e("./color");t.prototype=Object.create(l.prototype),t.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,n.exports=t},{"./color":3,"./gradientcontainer":9}],13:[function(e,n){var t=function(){t.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-t.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};t.options={logging:!1},n.exports=t},{}],14:[function(e,n){function t(d,p){this.node=d,this.parent=p,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function l(d){return d.toString().indexOf("%")!==-1}function o(d){return d.replace("px","")}function a(d){return parseFloat(d)}var s=e("./color"),e=e("./utils"),u=e.getBounds,f=e.parseBackgrounds,m=e.offsetBounds;t.prototype.cloneTo=function(d){d.visible=this.visible,d.borders=this.borders,d.bounds=this.bounds,d.clip=this.clip,d.backgroundClip=this.backgroundClip,d.computedStyles=this.computedStyles,d.styles=this.styles,d.backgroundImages=this.backgroundImages,d.opacity=this.opacity},t.prototype.getOpacity=function(){return this.opacity===null?this.opacity=this.cssFloat("opacity"):this.opacity},t.prototype.assignStack=function(d){(this.stack=d).children.push(this)},t.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:this.css("display")!=="none"&&this.css("visibility")!=="hidden"&&!this.node.hasAttribute("data-html2canvas-ignore")&&(this.node.nodeName!=="INPUT"||this.node.getAttribute("type")!=="hidden")},t.prototype.css=function(d){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[d]||(this.styles[d]=this.computedStyles[d])},t.prototype.prefixedCss=function(d){var p=this.css(d);return p===void 0&&["webkit","moz","ms","o"].some(function(b){return(p=this.css(b+d.substr(0,1).toUpperCase()+d.substr(1)))!==void 0},this),p===void 0?null:p},t.prototype.computedStyle=function(d){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,d)},t.prototype.cssInt=function(d){return d=parseInt(this.css(d),10),isNaN(d)?0:d},t.prototype.color=function(d){return this.colors[d]||(this.colors[d]=new s(this.css(d)))},t.prototype.cssFloat=function(d){return d=parseFloat(this.css(d)),isNaN(d)?0:d},t.prototype.fontWeight=function(){var d=this.css("fontWeight");switch(parseInt(d,10)){case 401:d="bold";break;case 400:d="normal"}return d},t.prototype.parseClip=function(){var d=this.css("clip").match(this.CLIP);return d?{top:parseInt(d[1],10),right:parseInt(d[2],10),bottom:parseInt(d[3],10),left:parseInt(d[4],10)}:null},t.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=f(this.css("backgroundImage")))},t.prototype.cssList=function(d,p){return d=(this.css(d)||"").split(","),(d=(d=d[p||0]||d[0]||"auto").trim().split(" ")).length===1&&(d=[d[0],l(d[0])?"auto":d[0]]),d},t.prototype.parseBackgroundSize=function(d,p,b){var g,v=this.cssList("backgroundSize",b);if(l(v[0]))g=d.width*parseFloat(v[0])/100;else{if(/contain|cover/.test(v[0])){var x=d.width/d.height,b=p.width/p.height;return x<b^v[0]==="contain"?{width:d.height*b,height:d.height}:{width:d.width,height:d.width/b}}g=parseInt(v[0],10)}return d=v[0]==="auto"&&v[1]==="auto"?p.height:v[1]==="auto"?g/p.width*p.height:l(v[1])?d.height*parseFloat(v[1])/100:parseInt(v[1],10),v[0]==="auto"&&(g=d/p.height*p.width),{width:g,height:d}},t.prototype.parseBackgroundPosition=function(d,p,b,g){var v=this.cssList("backgroundPosition",b),b=l(v[0])?(d.width-(g||p).width)*(parseFloat(v[0])/100):parseInt(v[0],10),g=v[1]==="auto"?b/p.width*p.height:l(v[1])?(d.height-(g||p).height)*parseFloat(v[1])/100:parseInt(v[1],10);return v[0]==="auto"&&(b=g/p.height*p.width),{left:b,top:g}},t.prototype.parseBackgroundRepeat=function(d){return this.cssList("backgroundRepeat",d)[0]},t.prototype.parseTextShadows=function(){var d=this.css("textShadow"),p=[];if(d&&d!=="none")for(var b=d.match(this.TEXT_SHADOW_PROPERTY),g=0;b&&g<b.length;g++){var v=b[g].match(this.TEXT_SHADOW_VALUES);p.push({color:new s(v[0]),offsetX:v[1]?parseFloat(v[1].replace("px","")):0,offsetY:v[2]?parseFloat(v[2].replace("px","")):0,blur:v[3]?v[3].replace("px",""):0})}return p},t.prototype.parseTransform=function(){var d,p;return this.transformData||(this.hasTransform()?(d=this.parseBounds(),(p=this.prefixedCss("transformOrigin").split(" ").map(o).map(a))[0]+=d.left,p[1]+=d.top,this.transformData={origin:p,matrix:this.parseTransformMatrix()}):this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]}),this.transformData},t.prototype.parseTransformMatrix=function(){var d;return this.transformMatrix||(d=(d=this.prefixedCss("transform"))?function(p){if(p&&p[1]==="matrix")return p[2].split(",").map(function(b){return parseFloat(b.trim())});if(p&&p[1]==="matrix3d")return p=p[2].split(",").map(function(b){return parseFloat(b.trim())}),[p[0],p[1],p[4],p[5],p[12],p[13]]}(d.match(this.MATRIX_PROPERTY)):null,this.transformMatrix=d||[1,0,0,1,0,0]),this.transformMatrix},t.prototype.parseBounds=function(){return this.bounds||(this.bounds=(this.hasTransform()?m:u)(this.node))},t.prototype.hasTransform=function(){return this.parseTransformMatrix().join(",")!=="1,0,0,1,0,0"||this.parent&&this.parent.hasTransform()},t.prototype.getValue=function(){var d,p=this.node.value||"";return this.node.tagName==="SELECT"?p=(d=(d=this.node).options[d.selectedIndex||0])&&d.text||"":this.node.type==="password"&&(p=Array(p.length+1).join("\u2022")),p.length===0?this.node.placeholder||"":p},t.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,t.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,t.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,t.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,n.exports=t},{"./color":3,"./utils":26}],15:[function(e,n){function t(ie,ge,ce,fe,ye){A("Starting NodeParser"),this.renderer=ge,this.options=ye,this.range=null,this.support=ce,this.renderQueue=[],this.stack=new ue(!0,1,ie.ownerDocument,null);var Ne=new L(ie,null);ye.background&&ge.rectangle(0,0,ge.width,ge.height,new te(ye.background)),ie===ie.ownerDocument.documentElement&&(ce=new L(Ne.color("backgroundColor").isTransparent()?ie.ownerDocument.body:ie.ownerDocument.documentElement,null),ge.rectangle(0,0,ge.width,ge.height,ce.color("backgroundColor"))),Ne.visibile=Ne.isElementVisible(),this.createPseudoHideStyles(ie.ownerDocument),this.disableAnimations(ie.ownerDocument),this.nodes=z([Ne].concat(this.getChildren(Ne)).filter(function(xe){return xe.visible=xe.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new X,A("Fetched nodes, total:",this.nodes.length),A("Calculate overflow clips"),this.calculateOverflowClips(),A("Start fetching images"),this.images=fe.fetch(this.nodes.filter(D)),this.ready=this.images.ready.then(pe(function(){return A("Images loaded, starting parsing"),A("Creating stacking contexts"),this.createStackingContexts(),A("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),A("Render queue created with "+this.renderQueue.length+" items"),new Promise(pe(function(xe){ye.async?typeof ye.async=="function"?ye.async.call(this,this.renderQueue,xe):0<this.renderQueue.length?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,xe)):xe():(this.renderQueue.forEach(this.paint,this),xe())},this))},this))}function l(ie){return ie.parent&&ie.parent.clip.length}function o(){}function a(ie,ge,ce,fe){return ie.map(function(ye,Ne){if(0<ye.width){var xe=ge.left,et=ge.top,Fe=ge.width,it=ge.height-ie[2].width;switch(Ne){case 0:it=ie[0].width,ye.args=m({c1:[xe,et],c2:[xe+Fe,et],c3:[xe+Fe-ie[1].width,et+it],c4:[xe+ie[3].width,et+it]},fe[0],fe[1],ce.topLeftOuter,ce.topLeftInner,ce.topRightOuter,ce.topRightInner);break;case 1:xe=ge.left+ge.width-ie[1].width,Fe=ie[1].width,ye.args=m({c1:[xe+Fe,et],c2:[xe+Fe,et+it+ie[2].width],c3:[xe,et+it],c4:[xe,et+ie[0].width]},fe[1],fe[2],ce.topRightOuter,ce.topRightInner,ce.bottomRightOuter,ce.bottomRightInner);break;case 2:et=et+ge.height-ie[2].width,it=ie[2].width,ye.args=m({c1:[xe+Fe,et+it],c2:[xe,et+it],c3:[xe+ie[3].width,et],c4:[xe+Fe-ie[3].width,et]},fe[2],fe[3],ce.bottomRightOuter,ce.bottomRightInner,ce.bottomLeftOuter,ce.bottomLeftInner);break;case 3:Fe=ie[3].width,ye.args=m({c1:[xe,et+it+ie[2].width],c2:[xe,et],c3:[xe+Fe,et+ie[0].width],c4:[xe+Fe,et+it]},fe[3],fe[0],ce.bottomLeftOuter,ce.bottomLeftInner,ce.topLeftOuter,ce.topLeftInner)}}return ye})}function s(ie,ge,ce,fe){var ye=(Math.sqrt(2)-1)/3*4,Ne=ce*ye,ye=fe*ye,ce=ie+ce,fe=ge+fe;return{topLeft:f({x:ie,y:fe},{x:ie,y:fe-ye},{x:ce-Ne,y:ge},{x:ce,y:ge}),topRight:f({x:ie,y:ge},{x:ie+Ne,y:ge},{x:ce,y:fe-ye},{x:ce,y:fe}),bottomRight:f({x:ce,y:ge},{x:ce,y:ge+ye},{x:ie+Ne,y:fe},{x:ie,y:fe}),bottomLeft:f({x:ce,y:fe},{x:ce-Ne,y:fe},{x:ie,y:ge+ye},{x:ie,y:ge})}}function u(ie,ge,ce){var fe=ie.left,ye=ie.top,Ne=ie.width,xe=ie.height,et=ge[0][0]<Ne/2?ge[0][0]:Ne/2,Fe=ge[0][1]<xe/2?ge[0][1]:xe/2,it=ge[1][0]<Ne/2?ge[1][0]:Ne/2,wt=ge[1][1]<xe/2?ge[1][1]:xe/2,ot=ge[2][0]<Ne/2?ge[2][0]:Ne/2,xt=ge[2][1]<xe/2?ge[2][1]:xe/2,Ft=ge[3][0]<Ne/2?ge[3][0]:Ne/2,Se=ge[3][1]<xe/2?ge[3][1]:xe/2,oe=Ne-it,be=xe-xt,ie=Ne-ot,ge=xe-Se;return{topLeftOuter:s(fe,ye,et,Fe).topLeft.subdivide(.5),topLeftInner:s(fe+ce[3].width,ye+ce[0].width,Math.max(0,et-ce[3].width),Math.max(0,Fe-ce[0].width)).topLeft.subdivide(.5),topRightOuter:s(fe+oe,ye,it,wt).topRight.subdivide(.5),topRightInner:s(fe+Math.min(oe,Ne+ce[3].width),ye+ce[0].width,oe>Ne+ce[3].width?0:it-ce[3].width,wt-ce[0].width).topRight.subdivide(.5),bottomRightOuter:s(fe+ie,ye+be,ot,xt).bottomRight.subdivide(.5),bottomRightInner:s(fe+Math.min(ie,Ne-ce[3].width),ye+Math.min(be,xe+ce[0].width),Math.max(0,ot-ce[1].width),xt-ce[2].width).bottomRight.subdivide(.5),bottomLeftOuter:s(fe,ye+ge,Ft,Se).bottomLeft.subdivide(.5),bottomLeftInner:s(fe+ce[3].width,ye+ge,Math.max(0,Ft-ce[3].width),Se-ce[2].width).bottomLeft.subdivide(.5)}}function f(ie,ge,ce,fe){function ye(Ne,xe,et){return{x:Ne.x+(xe.x-Ne.x)*et,y:Ne.y+(xe.y-Ne.y)*et}}return{start:ie,startControl:ge,endControl:ce,end:fe,subdivide:function(Ne){var xe=ye(ie,ge,Ne),et=ye(ge,ce,Ne),Fe=ye(ce,fe,Ne),it=ye(xe,et,Ne),et=ye(et,Fe,Ne),Ne=ye(it,et,Ne);return[f(ie,xe,it,Ne),f(Ne,et,Fe,fe)]},curveTo:function(Ne){Ne.push(["bezierCurve",ge.x,ge.y,ce.x,ce.y,fe.x,fe.y])},curveToReversed:function(Ne){Ne.push(["bezierCurve",ce.x,ce.y,ge.x,ge.y,ie.x,ie.y])}}}function m(ie,ge,ce,fe,ye,Ne,xe){var et=[];return 0<ge[0]||0<ge[1]?(et.push(["line",fe[1].start.x,fe[1].start.y]),fe[1].curveTo(et)):et.push(["line",ie.c1[0],ie.c1[1]]),0<ce[0]||0<ce[1]?(et.push(["line",Ne[0].start.x,Ne[0].start.y]),Ne[0].curveTo(et),et.push(["line",xe[0].end.x,xe[0].end.y]),xe[0].curveToReversed(et)):(et.push(["line",ie.c2[0],ie.c2[1]]),et.push(["line",ie.c3[0],ie.c3[1]])),0<ge[0]||0<ge[1]?(et.push(["line",ye[1].end.x,ye[1].end.y]),ye[1].curveToReversed(et)):et.push(["line",ie.c4[0],ie.c4[1]]),et}function d(ie,ge,ce,fe,ye,Ne,xe){0<ge[0]||0<ge[1]?(ie.push(["line",fe[0].start.x,fe[0].start.y]),fe[0].curveTo(ie),fe[1].curveTo(ie)):ie.push(["line",Ne,xe]),(0<ce[0]||0<ce[1])&&ie.push(["line",ye[0].start.x,ye[0].start.y])}function p(ie){return ie.cssInt("zIndex")<0}function b(ie){return 0<ie.cssInt("zIndex")}function g(ie){return ie.cssInt("zIndex")===0}function v(ie){return["inline","inline-block","inline-table"].indexOf(ie.css("display"))!==-1}function x(ie){return ie instanceof ue}function _(ie){return 0<ie.node.data.trim().length}function S(ie){return ie.nodeType===Node.TEXT_NODE||ie.nodeType===Node.ELEMENT_NODE}function I(ie){return ie.css("position")!=="static"}function P(ie){return ie.css("float")!=="none"}function F(ie){var ge=this;return function(){return!ie.apply(ge,arguments)}}function D(ie){return ie.node.nodeType===Node.ELEMENT_NODE}function k(ie){return ie.isPseudoElement===!0}function w(ie){return ie.node.nodeType===Node.TEXT_NODE}function C(ie){return parseInt(ie,10)}function T(ie){return ie.width}function O(ie){return ie.node.nodeType!==Node.ELEMENT_NODE||["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(ie.node.nodeName)===-1}function z(ie){return[].concat.apply([],ie)}var A=e("./log"),E=e("punycode"),L=e("./nodecontainer"),N=e("./textcontainer"),W=e("./pseudoelementcontainer"),X=e("./fontmetrics"),te=e("./color"),ue=e("./stackingcontext"),e=e("./utils"),pe=e.bind,ne=e.getBounds,me=e.parseBackgrounds,Q=e.offsetBounds;t.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(ie){var ge,ce;D(ie)?(k(ie)&&ie.appendToDOM(),ie.borders=this.parseBorders(ie),ge=ie.css("overflow")==="hidden"?[ie.borders.clip]:[],(ce=ie.parseClip())&&["absolute","fixed"].indexOf(ie.css("position"))!==-1&&ge.push([["rect",ie.bounds.left+ce.left,ie.bounds.top+ce.top,ce.right-ce.left,ce.bottom-ce.top]]),ie.clip=l(ie)?ie.parent.clip.concat(ge):ge,ie.backgroundClip=ie.css("overflow")!=="hidden"?ie.clip.concat([ie.borders.clip]):ie.clip,k(ie)&&ie.cleanDOM()):w(ie)&&(ie.clip=l(ie)?ie.parent.clip:[]),k(ie)||(ie.bounds=null)},this)},t.prototype.asyncRenderer=function(ie,ge,ce){ce=ce||Date.now(),this.paint(ie[this.renderIndex++]),ie.length===this.renderIndex?ge():ce+20>Date.now()?this.asyncRenderer(ie,ge,ce):setTimeout(pe(function(){this.asyncRenderer(ie,ge)},this),0)},t.prototype.createPseudoHideStyles=function(ie){this.createStyles(ie,"."+W.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+W.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},t.prototype.disableAnimations=function(ie){this.createStyles(ie,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},t.prototype.createStyles=function(ie,ge){var ce=ie.createElement("style");ce.innerHTML=ge,ie.body.appendChild(ce)},t.prototype.getPseudoElements=function(ie){var ge,ce=[[ie]];return ie.node.nodeType===Node.ELEMENT_NODE&&(ge=this.getPseudoElement(ie,":before"),ie=this.getPseudoElement(ie,":after"),ge&&ce.push(ge),ie&&ce.push(ie)),z(ce)},t.prototype.getPseudoElement=function(ie,ge){var ce=ie.computedStyle(ge);if(!ce||!ce.content||ce.content==="none"||ce.content==="-moz-alt-content"||ce.display==="none")return null;for(var fe,et=(fe=ce.content,(et=fe.substr(0,1))===fe.substr(fe.length-1)&&et.match(/'|"/)?fe.substr(1,fe.length-2):fe),fe=et.substr(0,3)==="url",ye=document.createElement(fe?"img":"html2canvaspseudoelement"),ge=new W(ye,ie,ge),Ne=ce.length-1;0<=Ne;Ne--){var xe=ce.item(Ne).replace(/(\-[a-z])/g,function(wt){return wt.toUpperCase().replace("-","")});ye.style[xe]=ce[xe]}if(ye.className=W.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+W.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,fe)return ye.src=me(et)[0].args[0],[ge];var et=document.createTextNode(et);return ye.appendChild(et),[ge,new N(et,ge)]},t.prototype.getChildren=function(ie){return z([].filter.call(ie.node.childNodes,S).map(function(ge){var ce=[new(ge.nodeType===Node.TEXT_NODE?N:L)(ge,ie)].filter(O);return ge.nodeType===Node.ELEMENT_NODE&&ce.length&&ge.tagName!=="TEXTAREA"?ce[0].isElementVisible()?ce.concat(this.getChildren(ce[0])):[]:ce},this))},t.prototype.newStackingContext=function(ie,ge){var ce=new ue(ge,ie.getOpacity(),ie.node,ie.parent);ie.cloneTo(ce),(ge?ce.getParentStack(this):ce.parent.stack).contexts.push(ce),ie.stack=ce},t.prototype.createStackingContexts=function(){this.nodes.forEach(function(ie){var ge,ce;D(ie)&&(this.isRootElement(ie)||ie.getOpacity()<1||(ce=(ge=ie).css("position"),(["absolute","relative","fixed"].indexOf(ce)!==-1?ge.css("zIndex"):"auto")!=="auto")||this.isBodyWithTransparentRoot(ie)||ie.hasTransform())?this.newStackingContext(ie,!0):D(ie)&&(I(ie)&&g(ie)||["inline-block","inline-table"].indexOf(ie.css("display"))!==-1||P(ie))?this.newStackingContext(ie,!1):ie.assignStack(ie.parent.stack)},this)},t.prototype.isBodyWithTransparentRoot=function(ie){return ie.node.nodeName==="BODY"&&ie.parent.color("backgroundColor").isTransparent()},t.prototype.isRootElement=function(ie){return ie.parent===null},t.prototype.sortStackingContexts=function(ie){var ge;ie.contexts.sort((ge=ie.contexts.slice(0),function(ce,fe){return ce.cssInt("zIndex")+ge.indexOf(ce)/ge.length-(fe.cssInt("zIndex")+ge.indexOf(fe)/ge.length)})),ie.contexts.forEach(this.sortStackingContexts,this)},t.prototype.parseTextBounds=function(ie){return function(ge,ce,fe){if(ie.parent.css("textDecoration").substr(0,4)!=="none"||ge.trim().length!==0){if(this.support.rangeBounds&&!ie.parent.hasTransform()){var ye=fe.slice(0,ce).join("").length;return this.getRangeBounds(ie.node,ye,ge.length)}if(ie.node&&typeof ie.node.data=="string")return ce=ie.node.splitText(ge.length),ye=this.getWrapperBounds(ie.node,ie.parent.hasTransform()),ie.node=ce,ye}else this.support.rangeBounds&&!ie.parent.hasTransform()||(ie.node=ie.node.splitText(ge.length));return{}}},t.prototype.getWrapperBounds=function(ie,ge){var ce=ie.ownerDocument.createElement("html2canvaswrapper"),fe=ie.parentNode,ye=ie.cloneNode(!0);return ce.appendChild(ie.cloneNode(!0)),fe.replaceChild(ce,ie),ge=(ge?Q:ne)(ce),fe.replaceChild(ye,ce),ge},t.prototype.getRangeBounds=function(ie,ge,ce){var fe=this.range||(this.range=ie.ownerDocument.createRange());return fe.setStart(ie,ge),fe.setEnd(ie,ge+ce),fe.getBoundingClientRect()},t.prototype.parse=function(ie){var ge=ie.contexts.filter(p),ce=ie.children.filter(D),fe=ce.filter(F(P)),ye=fe.filter(F(I)).filter(F(v)),Ne=ce.filter(F(I)).filter(P),xe=fe.filter(F(I)).filter(v),ce=ie.contexts.concat(fe.filter(I)).filter(g),fe=ie.children.filter(w).filter(_),ie=ie.contexts.filter(b);ge.concat(ye).concat(Ne).concat(xe).concat(ce).concat(fe).concat(ie).forEach(function(et){this.renderQueue.push(et),x(et)&&(this.parse(et),this.renderQueue.push(new o))},this)},t.prototype.paint=function(ie){try{ie instanceof o?this.renderer.ctx.restore():w(ie)?(k(ie.parent)&&ie.parent.appendToDOM(),this.paintText(ie),k(ie.parent)&&ie.parent.cleanDOM()):this.paintNode(ie)}catch(ge){if(A(ge),this.options.strict)throw ge}},t.prototype.paintNode=function(ie){x(ie)&&(this.renderer.setOpacity(ie.opacity),this.renderer.ctx.save(),ie.hasTransform()&&this.renderer.setTransform(ie.parseTransform())),ie.node.nodeName==="INPUT"&&ie.node.type==="checkbox"?this.paintCheckbox(ie):ie.node.nodeName==="INPUT"&&ie.node.type==="radio"?this.paintRadio(ie):this.paintElement(ie)},t.prototype.paintElement=function(ie){var ge=ie.parseBounds();this.renderer.clip(ie.backgroundClip,function(){this.renderer.renderBackground(ie,ge,ie.borders.borders.map(T))},this),this.renderer.clip(ie.clip,function(){this.renderer.renderBorders(ie.borders.borders)},this),this.renderer.clip(ie.backgroundClip,function(){switch(ie.node.nodeName){case"svg":case"IFRAME":var ce=this.images.get(ie.node);ce?this.renderer.renderImage(ie,ge,ie.borders,ce):A("Error loading <"+ie.node.nodeName+">",ie.node);break;case"IMG":ce=this.images.get(ie.node.src),ce?this.renderer.renderImage(ie,ge,ie.borders,ce):A("Error loading <img>",ie.node.src);break;case"CANVAS":this.renderer.renderImage(ie,ge,ie.borders,{image:ie.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(ie)}},this)},t.prototype.paintCheckbox=function(ie){var ge=ie.parseBounds(),ce=Math.min(ge.width,ge.height),fe={width:ce-1,height:ce-1,top:ge.top,left:ge.left},ge=[3,3],ye=[ge,ge,ge,ge],Ne=[1,1,1,1].map(function(et){return{color:new te("#A5A5A5"),width:et}}),xe=u(fe,ye,Ne);this.renderer.clip(ie.backgroundClip,function(){this.renderer.rectangle(fe.left+1,fe.top+1,fe.width-2,fe.height-2,new te("#DEDEDE")),this.renderer.renderBorders(a(Ne,fe,xe,ye)),ie.node.checked&&(this.renderer.font(new te("#424242"),"normal","normal","bold",ce-3+"px","arial"),this.renderer.text("\u2714",fe.left+ce/6,fe.top+ce-1))},this)},t.prototype.paintRadio=function(ie){var ge=ie.parseBounds(),ce=Math.min(ge.width,ge.height)-2;this.renderer.clip(ie.backgroundClip,function(){this.renderer.circleStroke(ge.left+1,ge.top+1,ce,new te("#DEDEDE"),1,new te("#A5A5A5")),ie.node.checked&&this.renderer.circle(Math.ceil(ge.left+ce/4)+1,Math.ceil(ge.top+ce/4)+1,Math.floor(ce/2),new te("#424242"))},this)},t.prototype.paintFormValue=function(ie){var ge,ce,fe,ye=ie.getValue();0<ye.length&&(ge=ie.node.ownerDocument,ce=ge.createElement("html2canvaswrapper"),["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"].forEach(function(Ne){try{ce.style[Ne]=ie.css(Ne)}catch(xe){A("html2canvas: Parse: Exception caught in renderFormValue: "+xe.message)}}),fe=ie.parseBounds(),ce.style.position="fixed",ce.style.left=fe.left+"px",ce.style.top=fe.top+"px",ce.textContent=ye,ge.body.appendChild(ce),this.paintText(new N(ce.firstChild,ie)),ge.body.removeChild(ce))},t.prototype.paintText=function(ie){ie.applyTextTransform();var ge=E.ucs2.decode(ie.node.data),ce=this.options.letterRendering&&!/^(normal|none|0px)$/.test(ie.parent.css("letterSpacing"))||/[^\u0000-\u00ff]/.test(ie.node.data)?ge.map(function(xe){return E.ucs2.encode([xe])}):function(xe){for(var et,Fe=[],it=0,wt=!1;xe.length;)[32,13,10,9,45].indexOf(xe[it])!==-1===wt?((et=xe.splice(0,it)).length&&Fe.push(E.ucs2.encode(et)),wt=!wt,it=0):it++,it>=xe.length&&(et=xe.splice(0,it)).length&&Fe.push(E.ucs2.encode(et));return Fe}(ge),fe=ie.parent.fontWeight(),ye=ie.parent.css("fontSize"),Ne=ie.parent.css("fontFamily"),ge=ie.parent.parseTextShadows();this.renderer.font(ie.parent.color("color"),ie.parent.css("fontStyle"),ie.parent.css("fontVariant"),fe,ye,Ne),ge.length?this.renderer.fontShadow(ge[0].color,ge[0].offsetX,ge[0].offsetY,ge[0].blur):this.renderer.clearShadow(),this.renderer.clip(ie.parent.clip,function(){ce.map(this.parseTextBounds(ie),this).forEach(function(xe,et){xe&&(this.renderer.text(ce[et],xe.left,xe.bottom),this.renderTextDecoration(ie.parent,xe,this.fontMetrics.getMetrics(Ne,ye)))},this)},this)},t.prototype.renderTextDecoration=function(ie,ge,ce){switch(ie.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(ge.left,Math.round(ge.top+ce.baseline+ce.lineWidth),ge.width,1,ie.color("color"));break;case"overline":this.renderer.rectangle(ge.left,Math.round(ge.top),ge.width,1,ie.color("color"));break;case"line-through":this.renderer.rectangle(ge.left,Math.ceil(ge.top+ce.middle+ce.lineWidth),ge.width,1,ie.color("color"))}};var we={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};t.prototype.parseBorders=function(ie){var ge,ce=ie.parseBounds(),fe=(ge=ie,["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(xe){return xe=ge.css("border"+xe+"Radius").split(" "),xe.length<=1&&(xe[1]=xe[0]),xe.map(C)})),ye=["Top","Right","Bottom","Left"].map(function(xe,et){var Fe=ie.css("border"+xe+"Style"),it=ie.color("border"+xe+"Color");return Fe==="inset"&&it.isBlack()&&(it=new te([255,255,255,it.a])),et=we[Fe]?we[Fe][et]:null,{width:ie.cssInt("border"+xe+"Width"),color:et?it[et[0]](et[1]):it,args:null}}),Ne=u(ce,fe,ye);return{clip:this.parseBackgroundClip(ie,Ne,ye,fe,ce),borders:a(ye,ce,Ne,fe)}},t.prototype.parseBackgroundClip=function(ie,ge,ce,fe,ye){var Ne=[];switch(ie.css("backgroundClip")){case"content-box":case"padding-box":d(Ne,fe[0],fe[1],ge.topLeftInner,ge.topRightInner,ye.left+ce[3].width,ye.top+ce[0].width),d(Ne,fe[1],fe[2],ge.topRightInner,ge.bottomRightInner,ye.left+ye.width-ce[1].width,ye.top+ce[0].width),d(Ne,fe[2],fe[3],ge.bottomRightInner,ge.bottomLeftInner,ye.left+ye.width-ce[1].width,ye.top+ye.height-ce[2].width),d(Ne,fe[3],fe[0],ge.bottomLeftInner,ge.topLeftInner,ye.left+ce[3].width,ye.top+ye.height-ce[2].width);break;default:d(Ne,fe[0],fe[1],ge.topLeftOuter,ge.topRightOuter,ye.left,ye.top),d(Ne,fe[1],fe[2],ge.topRightOuter,ge.bottomRightOuter,ye.left+ye.width,ye.top),d(Ne,fe[2],fe[3],ge.bottomRightOuter,ge.bottomLeftOuter,ye.left+ye.width,ye.top+ye.height),d(Ne,fe[3],fe[0],ge.bottomLeftOuter,ge.topLeftOuter,ye.left,ye.top+ye.height)}return Ne},n.exports=t},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(e,n,t){function l(g,v,x){var _="withCredentials"in new XMLHttpRequest;if(!v)return Promise.reject("No proxy configured");var S=a(_),g=s(v,g,S);return _?u(g):o(x,g,S).then(function(I){return p(I.content)})}function o(g,v,x){return new Promise(function(_,S){function I(){delete window.html2canvas.proxy[x],g.body.removeChild(P)}var P=g.createElement("script");window.html2canvas.proxy[x]=function(F){I(),_(F)},P.src=v,P.onerror=function(F){I(),S(F)},g.body.appendChild(P)})}function a(g){return g?"":"html2canvas_"+Date.now()+"_"+ ++b+"_"+Math.round(1e5*Math.random())}function s(g,v,x){return g+"?url="+encodeURIComponent(v)+(x.length?"&callback=html2canvas.proxy."+x:"")}var u=e("./xhr"),f=e("./utils"),m=e("./log"),d=e("./clone"),p=f.decode64,b=0;t.Proxy=l,t.ProxyURL=function(g,v,x){var _="crossOrigin"in new Image,S=a(_),g=s(v,g,S);return _?Promise.resolve(g):o(x,g,S).then(function(I){return"data:"+I.type+";base64,"+I.content})},t.loadUrlDocument=function(g,v,x,_,S,I){return new l(g,v,window.document).then((P=g,function(F){var D,k=new DOMParser;try{D=k.parseFromString(F,"text/html")}catch(C){m("DOMParser not supported, falling back to createHTMLDocument"),D=document.implementation.createHTMLDocument("");try{D.open(),D.write(F),D.close()}catch(T){m("createHTMLDocument write not supported, falling back to document.body.innerHTML"),D.body.innerHTML=F}}var w=D.querySelector("base");return w&&w.href.host||((w=D.createElement("base")).href=P,D.head.insertBefore(w,D.head.firstChild)),D})).then(function(F){return d(F,x,_,S,I,0,0)});var P}},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(e,n){var t=e("./proxy").ProxyURL;n.exports=function(l,o){var a=document.createElement("a");a.href=l,l=a.href,this.src=l,this.image=new Image;var s=this;this.promise=new Promise(function(u,f){s.image.crossOrigin="Anonymous",s.image.onload=u,s.image.onerror=f,new t(l,o,document).then(function(m){s.image.src=m}).catch(f)})}},{"./proxy":16}],18:[function(e,n){function t(o,a,s){l.call(this,o,a),this.isPseudoElement=!0,this.before=s===":before"}var l=e("./nodecontainer");t.prototype.cloneTo=function(o){t.prototype.cloneTo.call(this,o),o.isPseudoElement=!0,o.before=this.before},(t.prototype=Object.create(l.prototype)).appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},t.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},t.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},t.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",t.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",n.exports=t},{"./nodecontainer":14}],19:[function(e,n){function t(o,a,s,u,f){this.width=o,this.height=a,this.images=s,this.options=u,this.document=f}var l=e("./log");t.prototype.renderImage=function(o,a,s,u){var f=o.cssInt("paddingLeft"),m=o.cssInt("paddingTop"),d=o.cssInt("paddingRight"),o=o.cssInt("paddingBottom"),s=s.borders,d=a.width-(s[1].width+s[3].width+f+d),o=a.height-(s[0].width+s[2].width+m+o);this.drawImage(u,0,0,u.image.width||d,u.image.height||o,a.left+f+s[3].width,a.top+m+s[0].width,d,o)},t.prototype.renderBackground=function(o,a,s){0<a.height&&0<a.width&&(this.renderBackgroundColor(o,a),this.renderBackgroundImage(o,a,s))},t.prototype.renderBackgroundColor=function(o,a){o=o.color("backgroundColor"),o.isTransparent()||this.rectangle(a.left,a.top,a.width,a.height,o)},t.prototype.renderBorders=function(o){o.forEach(this.renderBorder,this)},t.prototype.renderBorder=function(o){o.color.isTransparent()||o.args===null||this.drawShape(o.args,o.color)},t.prototype.renderBackgroundImage=function(o,a,s){o.parseBackgroundImages().reverse().forEach(function(u,f,m){switch(u.method){case"url":var d=this.images.get(u.args[0]);d?this.renderBackgroundRepeating(o,a,d,m.length-(f+1),s):l("Error loading background-image",u.args[0]);break;case"linear-gradient":case"gradient":d=this.images.get(u.value),d?this.renderBackgroundGradient(d,a,s):l("Error loading background-image",u.args[0]);break;case"none":break;default:l("Unknown background-image type",u.args[0])}},this)},t.prototype.renderBackgroundRepeating=function(o,a,s,u,f){var m=o.parseBackgroundSize(a,s.image,u),d=o.parseBackgroundPosition(a,s.image,u,m);switch(o.parseBackgroundRepeat(u)){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(s,d,m,a,a.left+f[3],a.top+d.top+f[0],99999,m.height,f);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(s,d,m,a,a.left+d.left+f[3],a.top+f[0],m.width,99999,f);break;case"no-repeat":this.backgroundRepeatShape(s,d,m,a,a.left+d.left+f[3],a.top+d.top+f[0],m.width,m.height,f);break;default:this.renderBackgroundRepeat(s,d,m,{top:a.top,left:a.left},f[3],f[0])}},n.exports=t},{"./log":13}],20:[function(e,n){function t(u,f){o.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=u,this.canvas.height=f),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},s("Initialized CanvasRenderer with size",u,"x",f)}function l(u){return 0<u.length}var o=e("../renderer"),a=e("../lineargradientcontainer"),s=e("../log");(t.prototype=Object.create(o.prototype)).setFillStyle=function(u){return this.ctx.fillStyle=typeof u=="object"&&u.isColor?u.toString():u,this.ctx},t.prototype.rectangle=function(u,f,m,d,p){this.setFillStyle(p).fillRect(u,f,m,d)},t.prototype.circle=function(u,f,m,d){this.setFillStyle(d),this.ctx.beginPath(),this.ctx.arc(u+m/2,f+m/2,m/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},t.prototype.circleStroke=function(u,f,m,d,p,b){this.circle(u,f,m,d),this.ctx.strokeStyle=b.toString(),this.ctx.stroke()},t.prototype.drawShape=function(u,f){this.shape(u),this.setFillStyle(f).fill()},t.prototype.taints=function(u){if(u.tainted===null){this.taintCtx.drawImage(u.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),u.tainted=!1}catch(f){this.taintCtx=document.createElement("canvas").getContext("2d"),u.tainted=!0}}return u.tainted},t.prototype.drawImage=function(u,f,m,d,p,b,g,v,x){this.taints(u)&&!this.options.allowTaint||this.ctx.drawImage(u.image,f,m,d,p,b,g,v,x)},t.prototype.clip=function(u,f,m){this.ctx.save(),u.filter(l).forEach(function(d){this.shape(d).clip()},this),f.call(m),this.ctx.restore()},t.prototype.shape=function(u){return this.ctx.beginPath(),u.forEach(function(f,m){(f[0]==="rect"?this.ctx.rect:this.ctx[m===0?"moveTo":f[0]+"To"]).apply(this.ctx,f.slice(1))},this),this.ctx.closePath(),this.ctx},t.prototype.font=function(u,f,m,d,p,b){this.setFillStyle(u).font=[f,m,d,p,b].join(" ").split(",")[0]},t.prototype.fontShadow=function(u,f,m,d){this.setVariable("shadowColor",u.toString()).setVariable("shadowOffsetY",f).setVariable("shadowOffsetX",m).setVariable("shadowBlur",d)},t.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},t.prototype.setOpacity=function(u){this.ctx.globalAlpha=u},t.prototype.setTransform=function(u){this.ctx.translate(u.origin[0],u.origin[1]),this.ctx.transform.apply(this.ctx,u.matrix),this.ctx.translate(-u.origin[0],-u.origin[1])},t.prototype.setVariable=function(u,f){return this.variables[u]!==f&&(this.variables[u]=this.ctx[u]=f),this},t.prototype.text=function(u,f,m){this.ctx.fillText(u,f,m)},t.prototype.backgroundRepeatShape=function(u,f,m,d,p,b,g,v,x){b=[["line",Math.round(p),Math.round(b)],["line",Math.round(p+g),Math.round(b)],["line",Math.round(p+g),Math.round(v+b)],["line",Math.round(p),Math.round(v+b)]],this.clip([b],function(){this.renderBackgroundRepeat(u,f,m,d,x[3],x[0])},this)},t.prototype.renderBackgroundRepeat=function(u,f,m,d,p,b){p=Math.round(d.left+f.left+p),b=Math.round(d.top+f.top+b),this.setFillStyle(this.ctx.createPattern(this.resizeImage(u,m),"repeat")),this.ctx.translate(p,b),this.ctx.fill(),this.ctx.translate(-p,-b)},t.prototype.renderBackgroundGradient=function(u,f){var m;u instanceof a&&(m=this.ctx.createLinearGradient(f.left+f.width*u.x0,f.top+f.height*u.y0,f.left+f.width*u.x1,f.top+f.height*u.y1),u.colorStops.forEach(function(d){m.addColorStop(d.stop,d.color.toString())}),this.rectangle(f.left,f.top,f.width,f.height,m))},t.prototype.resizeImage=function(u,f){var m=u.image;return m.width===f.width&&m.height===f.height?m:(u=document.createElement("canvas"),u.width=f.width,u.height=f.height,u.getContext("2d").drawImage(m,0,0,m.width,m.height,0,0,f.width,f.height),u)},n.exports=t},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(e,n){function t(o,a,s,u){l.call(this,s,u),this.ownStacking=o,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*a}var l=e("./nodecontainer");(t.prototype=Object.create(l.prototype)).getParentStack=function(o){var a=this.parent?this.parent.stack:null;return a?a.ownStacking?a:a.getParentStack(o):o.stack},n.exports=t},{"./nodecontainer":14}],22:[function(e,n){function t(l){this.rangeBounds=this.testRangeBounds(l),this.cors=this.testCORS(),this.svg=this.testSVG()}t.prototype.testRangeBounds=function(l){var o,a,s=!1;return l.createRange&&(o=l.createRange()).getBoundingClientRect&&((a=l.createElement("boundtest")).style.height="123px",a.style.display="block",l.body.appendChild(a),o.selectNode(a),o.getBoundingClientRect().height===123&&(s=!0),l.body.removeChild(a)),s},t.prototype.testCORS=function(){return new Image().crossOrigin!==void 0},t.prototype.testSVG=function(){var l=new Image,o=document.createElement("canvas"),a=o.getContext("2d");l.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{a.drawImage(l,0,0),o.toDataURL()}catch(s){return!1}return!0},n.exports=t},{}],23:[function(e,n){function t(a){this.src=a,this.image=null;var s=this;this.promise=this.hasFabric().then(function(){return s.isInline(a)?Promise.resolve(s.inlineFormatting(a)):l(a)}).then(function(u){return new Promise(function(f){window.html2canvas.svg.fabric.loadSVGFromString(u,s.createCanvas.call(s,f))})})}var l=e("./xhr"),o=e("./utils").decode64;t.prototype.hasFabric=function(){return window.html2canvas.svg&&window.html2canvas.svg.fabric?Promise.resolve():Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},t.prototype.inlineFormatting=function(a){return/^data:image\/svg\+xml;base64,/.test(a)?this.decode64(this.removeContentType(a)):this.removeContentType(a)},t.prototype.removeContentType=function(a){return a.replace(/^data:image\/svg\+xml(;base64)?,/,"")},t.prototype.isInline=function(a){return/^data:image\/svg\+xml/i.test(a)},t.prototype.createCanvas=function(a){var s=this;return function(u,f){var m=new window.html2canvas.svg.fabric.StaticCanvas("c");s.image=m.lowerCanvasEl,m.setWidth(f.width).setHeight(f.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(u,f)).renderAll(),a(m.lowerCanvasEl)}},t.prototype.decode64=function(a){return typeof window.atob=="function"?window.atob(a):o(a)},n.exports=t},{"./utils":26,"./xhr":28}],24:[function(e,n){function t(l,o){this.src=l,this.image=null;var a=this;this.promise=o?new Promise(function(s,u){a.image=new Image,a.image.onload=s,a.image.onerror=u,a.image.src="data:image/svg+xml,"+new XMLSerializer().serializeToString(l),a.image.complete===!0&&s(a.image)}):this.hasFabric().then(function(){return new Promise(function(s){window.html2canvas.svg.fabric.parseSVGDocument(l,a.createCanvas.call(a,s))})})}e=e("./svgcontainer"),t.prototype=Object.create(e.prototype),n.exports=t},{"./svgcontainer":23}],25:[function(e,n){function t(a,s){o.call(this,a,s)}function l(a,s,u){return 0<a.length?s+u.toUpperCase():void 0}var o=e("./nodecontainer");(t.prototype=Object.create(o.prototype)).applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},t.prototype.transform=function(a){var s=this.node.data;switch(a){case"lowercase":return s.toLowerCase();case"capitalize":return s.replace(/(^|\s|:|-|\(|\))([a-z])/g,l);case"uppercase":return s.toUpperCase();default:return s}},n.exports=t},{"./nodecontainer":14}],26:[function(e,n,t){t.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},t.bind=function(l,o){return function(){return l.apply(o,arguments)}},t.decode64=function(l){for(var o,a,s,u,f,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=l.length,p="",b=0;b<d;b+=4)s=m.indexOf(l[b])<<2|(f=m.indexOf(l[b+1]))>>4,u=(15&f)<<4|(o=m.indexOf(l[b+2]))>>2,f=(3&o)<<6|(a=m.indexOf(l[b+3])),p+=o===64?String.fromCharCode(s):a===64||a===-1?String.fromCharCode(s,u):String.fromCharCode(s,u,f);return p},t.getBounds=function(l){if(l.getBoundingClientRect){var o=l.getBoundingClientRect(),a=l.offsetWidth==null?o.width:l.offsetWidth;return{top:o.top,bottom:o.bottom||o.top+o.height,right:o.left+a,left:o.left,width:a,height:l.offsetHeight==null?o.height:l.offsetHeight}}return{}},t.offsetBounds=function(l){var o=l.offsetParent?t.offsetBounds(l.offsetParent):{top:0,left:0};return{top:l.offsetTop+o.top,bottom:l.offsetTop+l.offsetHeight+o.top,right:l.offsetLeft+o.left+l.offsetWidth,left:l.offsetLeft+o.left,width:l.offsetWidth,height:l.offsetHeight}},t.parseBackgrounds=function(l){function o(){v&&(a.substr(0,1)==='"'&&(a=a.substr(1,a.length-2)),a&&g.push(a),v.substr(0,1)==="-"&&0<(u=v.indexOf("-",1)+1)&&(s=v.substr(0,u),v=v.substr(u)),d.push({prefix:s,method:v.toLowerCase(),value:f,args:g,image:null})),g=[],v=s=a=f=""}var a,s,u,f,m,d=[],p=0,b=0,g=[],v=s=a=f="";return l.split("").forEach(function(x){if(!(p===0&&-1<` \r
	`.indexOf(x))){switch(x){case'"':m?m===x&&(m=null):m=x;break;case"(":if(m)break;if(p===0)return p=1,void(f+=x);b++;break;case")":if(m)break;if(p===1){if(b===0)return p=0,f+=x,void o();b--}break;case",":if(m)break;if(p===0)return void o();if(p===1&&b===0&&!v.match(/^url$/i))return g.push(a),a="",void(f+=x)}f+=x,p===0?v+=x:a+=x}}),o(),d}},{}],27:[function(e,n){function t(o){l.apply(this,arguments),this.type=o.args[0]==="linear"?l.TYPES.LINEAR:l.TYPES.RADIAL}var l=e("./gradientcontainer");t.prototype=Object.create(l.prototype),n.exports=t},{"./gradientcontainer":9}],28:[function(e,n){n.exports=function(t){return new Promise(function(l,o){var a=new XMLHttpRequest;a.open("GET",t),a.onload=function(){a.status===200?l(a.responseText):o(new Error(a.statusText))},a.onerror=function(){o(new Error("Network Error"))},a.send()})}},{}]},{},[4])(4)}),function(e){typeof Bn=="object"&&typeof Zn!="undefined"?Zn.exports=e():typeof define=="function"&&define.amd?define([],e):(typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:this).localforage=e()}(function(){return function e(n,t,l){function o(u,f){if(!t[u]){if(!n[u]){var m=typeof Va=="function"&&Va;if(!f&&m)return m(u,!0);if(a)return a(u,!0);throw m=new Error("Cannot find module '"+u+"'"),m.code="MODULE_NOT_FOUND",m}m=t[u]={exports:{}},n[u][0].call(m.exports,function(d){return o(n[u][1][d]||d)},m,m.exports,e,n,t,l)}return t[u].exports}for(var a=typeof Va=="function"&&Va,s=0;s<l.length;s++)o(l[s]);return o}({1:[function(e,n,t){(function(l){"use strict";function o(){f=!0;for(var b,g,v=p.length;v;){for(g=p,p=[],b=-1;++b<v;)g[b]();v=p.length}f=!1}var a,s,u,f,m=l.MutationObserver||l.WebKitMutationObserver,d=m?(a=0,m=new m(o),s=l.document.createTextNode(""),m.observe(s,{characterData:!0}),function(){s.data=a=++a%2}):l.setImmediate||l.MessageChannel===void 0?"document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var b=l.document.createElement("script");b.onreadystatechange=function(){o(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},l.document.documentElement.appendChild(b)}:function(){setTimeout(o,0)}:((u=new l.MessageChannel).port1.onmessage=o,function(){u.port2.postMessage(0)}),p=[];n.exports=function(b){p.push(b)!==1||f||d()}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(e,n,t){"use strict";function l(){}function o(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,x!==l&&f(this,x)}function a(x,_,S){this.promise=x,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function s(x,_,S){d(function(){var I;try{I=_(S)}catch(P){return p.reject(x,P)}I===x?p.reject(x,new TypeError("Cannot resolve promise with itself")):p.resolve(x,I)})}function u(x){var _=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof _=="function")return function(){_.apply(x,arguments)}}function f(x,_){function S(D){P||(P=!0,p.reject(x,D))}function I(D){P||(P=!0,p.resolve(x,D))}var P=!1,F=m(function(){_(I,S)});F.status==="error"&&S(F.value)}function m(x,_){var S={};try{S.value=x(_),S.status="success"}catch(I){S.status="error",S.value=I}return S}var d=e(1),p={},b=["REJECTED"],g=["FULFILLED"],v=["PENDING"];(n.exports=o).prototype.catch=function(x){return this.then(null,x)},o.prototype.then=function(x,_){if(typeof x!="function"&&this.state===g||typeof _!="function"&&this.state===b)return this;var S=new this.constructor(l);return this.state!==v?s(S,this.state===g?x:_,this.outcome):this.queue.push(new a(S,x,_)),S},a.prototype.callFulfilled=function(x){p.resolve(this.promise,x)},a.prototype.otherCallFulfilled=function(x){s(this.promise,this.onFulfilled,x)},a.prototype.callRejected=function(x){p.reject(this.promise,x)},a.prototype.otherCallRejected=function(x){s(this.promise,this.onRejected,x)},p.resolve=function(x,_){var S=m(u,_);if(S.status==="error")return p.reject(x,S.value);if(S=S.value,S)f(x,S);else{x.state=g,x.outcome=_;for(var I=-1,P=x.queue.length;++I<P;)x.queue[I].callFulfilled(_)}return x},p.reject=function(x,_){x.state=b,x.outcome=_;for(var S=-1,I=x.queue.length;++S<I;)x.queue[S].callRejected(_);return x},o.resolve=function(x){return x instanceof this?x:p.resolve(new this(l),x)},o.reject=function(x){var _=new this(l);return p.reject(_,x)},o.all=function(x){var _=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,I=!1;if(!S)return this.resolve([]);for(var P=new Array(S),F=0,D=-1,k=new this(l);++D<S;)(function(w,C){_.resolve(w).then(function(T){P[C]=T,++F!==S||I||(I=!0,p.resolve(k,P))},function(T){I||(I=!0,p.reject(k,T))})})(x[D],D);return k},o.race=function(x){var _=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,I=!1;if(!S)return this.resolve([]);for(var P,F=-1,D=new this(l);++F<S;)P=x[F],_.resolve(P).then(function(k){I||(I=!0,p.resolve(D,k))},function(k){I||(I=!0,p.reject(D,k))});return D}},{1:1}],3:[function(e,n,t){(function(l){"use strict";typeof l.Promise!="function"&&(l.Promise=e(2))}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{2:2}],4:[function(e,n,t){"use strict";function l(oe,be){oe=oe||[],be=be||{};try{return new Blob(oe,be)}catch(Xe){if(Xe.name!=="TypeError")throw Xe;for(var Te=new(typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder),Oe=0;Oe<oe.length;Oe+=1)Te.append(oe[Oe]);return Te.getBlob(be.type)}}function o(oe,be){be&&oe.then(function(Te){be(null,Te)},function(Te){be(Te)})}function a(oe,be,Te){typeof be=="function"&&oe.then(be),typeof Te=="function"&&oe.catch(Te)}function s(oe){return typeof oe!="string"&&(oe=String(oe)),oe}function u(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}function f(oe){return typeof te=="boolean"?W.resolve(te):(be=oe,new W(function(Te){var Oe=be.transaction(X,me),Xe=l([""]);Oe.objectStore(X).put(Xe,"key"),Oe.onabort=function(Le){Le.preventDefault(),Le.stopPropagation(),Te(!1)},Oe.oncomplete=function(){var Le=navigator.userAgent.match(/Chrome\/(\d+)/),Ee=navigator.userAgent.match(/Edge\//);Te(Ee||!Le||43<=parseInt(Le[1],10))}}).catch(function(){return!1}).then(function(Te){return te=Te}));var be}function m(oe){var oe=ue[oe.name],be={};be.promise=new W(function(Te,Oe){be.resolve=Te,be.reject=Oe}),oe.deferredOperations.push(be),oe.dbReady?oe.dbReady=oe.dbReady.then(function(){return be.promise}):oe.dbReady=be.promise}function d(oe){return oe=ue[oe.name].deferredOperations.pop(),oe&&(oe.resolve(),oe.promise)}function p(oe,be){if(oe=ue[oe.name].deferredOperations.pop(),oe)return oe.reject(be),oe.promise}function b(oe,be){return new W(function(Te,Oe){if(ue[oe.name]=ue[oe.name]||F(),oe.db){if(!be)return Te(oe.db);m(oe),oe.db.close()}var Xe=[oe.name];be&&Xe.push(oe.version);var Le=L.open.apply(L,Xe);be&&(Le.onupgradeneeded=function(Ee){var nt=Le.result;try{nt.createObjectStore(oe.storeName),Ee.oldVersion<=1&&nt.createObjectStore(X)}catch(Ze){if(Ze.name!=="ConstraintError")throw Ze}}),Le.onerror=function(Ee){Ee.preventDefault(),Oe(Le.error)},Le.onsuccess=function(){Te(Le.result),d(oe)}})}function g(oe){return b(oe,!1)}function v(oe){return b(oe,!0)}function x(oe){if(!oe.db)return 1;var be=!oe.db.objectStoreNames.contains(oe.storeName),Te=oe.version<oe.db.version,Oe=oe.version>oe.db.version;return Te&&(oe.version,oe.version=oe.db.version),(Oe||be)&&(!be||(be=oe.db.version+1)>oe.version&&(oe.version=be),1)}function _(oe){return l([function(be){for(var Te=be.length,Oe=new ArrayBuffer(Te),Xe=new Uint8Array(Oe),Le=0;Le<Te;Le++)Xe[Le]=be.charCodeAt(Le);return Oe}(atob(oe.data))],{type:oe.type})}function S(oe){return oe&&oe.__local_forage_encoded_blob}function I(oe){var be=this,Te=be._initReady().then(function(){var Oe=ue[be._dbInfo.name];if(Oe&&Oe.dbReady)return Oe.dbReady});return a(Te,oe,oe),Te}function P(oe,be,Te,Oe){Oe===void 0&&(Oe=1);try{var Xe=oe.db.transaction(oe.storeName,be);Te(null,Xe)}catch(Le){if(0<Oe&&(!oe.db||Le.name==="InvalidStateError"||Le.name==="NotFoundError"))return W.resolve().then(function(){if(!oe.db||Le.name==="NotFoundError"&&!oe.db.objectStoreNames.contains(oe.storeName)&&oe.version<=oe.db.version)return oe.db&&(oe.version=oe.db.version+1),v(oe)}).then(function(){return function(Ee){m(Ee);for(var nt=ue[Ee.name],Ze=nt.forages,ze=0;ze<Ze.length;ze++){var _e=Ze[ze];_e._dbInfo.db&&(_e._dbInfo.db.close(),_e._dbInfo.db=null)}return Ee.db=null,g(Ee).then(function(Qe){return Ee.db=Qe,x(Ee)?v(Ee):Qe}).then(function(Qe){Ee.db=nt.db=Qe;for(var Je=0;Je<Ze.length;Je++)Ze[Je]._dbInfo.db=Qe}).catch(function(Qe){throw p(Ee,Qe),Qe})}(oe).then(function(){P(oe,be,Te,Oe-1)})}).catch(Te);Te(Le)}}function F(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function D(oe){var be,Te,Oe,Xe,Le=.75*oe.length,Ee=oe.length,nt=0;oe[oe.length-1]==="="&&(Le--,oe[oe.length-2]==="="&&Le--);for(var Le=new ArrayBuffer(Le),Ze=new Uint8Array(Le),ze=0;ze<Ee;ze+=4)be=we.indexOf(oe[ze]),Te=we.indexOf(oe[ze+1]),Oe=we.indexOf(oe[ze+2]),Xe=we.indexOf(oe[ze+3]),Ze[nt++]=be<<2|Te>>4,Ze[nt++]=(15&Te)<<4|Oe>>2,Ze[nt++]=(3&Oe)<<6|63&Xe;return Le}function k(oe){for(var be=new Uint8Array(oe),Te="",Oe=0;Oe<be.length;Oe+=3)Te+=we[be[Oe]>>2],Te+=we[(3&be[Oe])<<4|be[Oe+1]>>4],Te+=we[(15&be[Oe+1])<<2|be[Oe+2]>>6],Te+=we[63&be[Oe+2]];return be.length%3==2?Te=Te.substring(0,Te.length-1)+"=":be.length%3==1&&(Te=Te.substring(0,Te.length-2)+"=="),Te}function w(oe,be,Te,Oe){oe.executeSql("CREATE TABLE IF NOT EXISTS "+be.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],Te,Oe)}function C(oe,be,Te,Oe,Xe,Le){oe.executeSql(Te,Oe,Xe,function(Ee,nt){nt.code===nt.SYNTAX_ERR?Ee.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[name],function(Ze,ze){ze.rows.length?Le(Ze,nt):w(Ze,be,function(){Ze.executeSql(Te,Oe,Xe,Le)},Le)},Le):Le(Ee,nt)},Le)}function T(oe,be,Te,Oe){var Xe=this;oe=s(oe);var Le=new W(function(Ee,nt){Xe.ready().then(function(){be===void 0&&(be=null);var Ze=be,ze=Xe._dbInfo;ze.serializer.serialize(be,function(_e,Qe){Qe?nt(Qe):ze.db.transaction(function(Je){C(Je,ze,"INSERT OR REPLACE INTO "+ze.storeName+" (key, value) VALUES (?, ?)",[oe,_e],function(){Ee(Ze)},function(Ke,gt){nt(gt)})},function(Je){Je.code===Je.QUOTA_ERR&&(0<Oe?Ee(T.apply(Xe,[oe,Ze,Te,Oe-1])):nt(Je))})})}).catch(nt)});return o(Le,Te),Le}function O(oe,be){var Te=oe.name+"/";return oe.storeName!==be.storeName&&(Te+=oe.storeName+"/"),Te}function z(){return!function(){var oe="_localforage_support_test";try{return localStorage.setItem(oe,!0),localStorage.removeItem(oe),0}catch(be){return 1}}()||0<localStorage.length}function A(oe){for(var be=1;be<arguments.length;be++){var Te=arguments[be];if(Te)for(var Oe in Te)Te.hasOwnProperty(Oe)&&(et(Te[Oe])?oe[Oe]=Te[Oe].slice():oe[Oe]=Te[Oe])}return oe}var E=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(oe){return typeof oe}:function(oe){return oe&&typeof Symbol=="function"&&oe.constructor===Symbol&&oe!==Symbol.prototype?"symbol":typeof oe},L=function(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(oe){return}}();typeof Promise=="undefined"&&e(3);function N(oe,be){for(var Te,Oe,Xe=oe.length,Le=0;Le<Xe;){if((Te=oe[Le])===(Oe=be)||typeof Te=="number"&&typeof Oe=="number"&&isNaN(Te)&&isNaN(Oe))return 1;Le++}}var W=Promise,X="local-forage-detect-blob-support",te=void 0,ue={},pe=Object.prototype.toString,ne="readonly",me="readwrite",Q={_driver:"asyncStorage",_initStorage:function(oe){function be(){return W.resolve()}var Te=this,Oe={db:null};if(oe)for(var Xe in oe)Oe[Xe]=oe[Xe];var Le=ue[Oe.name];Le||(Le=F(),ue[Oe.name]=Le),Le.forages.push(Te),Te._initReady||(Te._initReady=Te.ready,Te.ready=I);for(var Ee=[],nt=0;nt<Le.forages.length;nt++){var Ze=Le.forages[nt];Ze!==Te&&Ee.push(Ze._initReady().catch(be))}var ze=Le.forages.slice(0);return W.all(Ee).then(function(){return Oe.db=Le.db,g(Oe)}).then(function(_e){return Oe.db=_e,x(Oe,Te._defaultConfig.version)?v(Oe):_e}).then(function(_e){Oe.db=Le.db=_e,Te._dbInfo=Oe;for(var Qe=0;Qe<ze.length;Qe++){var Je=ze[Qe];Je!==Te&&(Je._dbInfo.db=Oe.db,Je._dbInfo.version=Oe.version)}})},_support:function(){try{if(!L)return!1;var oe=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),be=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!oe||be)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(Te){return!1}}(),iterate:function(oe,be){var Te=this,Oe=new W(function(Xe,Le){Te.ready().then(function(){P(Te._dbInfo,ne,function(Ee,nt){if(Ee)return Le(Ee);try{var Ze=nt.objectStore(Te._dbInfo.storeName).openCursor(),ze=1;Ze.onsuccess=function(){var _e,Qe=Ze.result;Qe?(S(_e=Qe.value)&&(_e=_(_e)),(_e=oe(_e,Qe.key,ze++))!==void 0?Xe(_e):Qe.continue()):Xe()},Ze.onerror=function(){Le(Ze.error)}}catch(_e){Le(_e)}})}).catch(Le)});return o(Oe,be),Oe},getItem:function(oe,be){var Te=this;oe=s(oe);var Oe=new W(function(Xe,Le){Te.ready().then(function(){P(Te._dbInfo,ne,function(Ee,nt){if(Ee)return Le(Ee);try{var Ze=nt.objectStore(Te._dbInfo.storeName).get(oe);Ze.onsuccess=function(){var ze=Ze.result;ze===void 0&&(ze=null),S(ze)&&(ze=_(ze)),Xe(ze)},Ze.onerror=function(){Le(Ze.error)}}catch(ze){Le(ze)}})}).catch(Le)});return o(Oe,be),Oe},setItem:function(oe,be,Te){var Oe=this;oe=s(oe);var Xe=new W(function(Le,Ee){var nt;Oe.ready().then(function(){return nt=Oe._dbInfo,pe.call(be)==="[object Blob]"?f(nt.db).then(function(Ze){return Ze?be:(ze=be,new W(function(_e,Qe){var Je=new FileReader;Je.onerror=Qe,Je.onloadend=function(Ke){Ke=btoa(Ke.target.result||""),_e({__local_forage_encoded_blob:!0,data:Ke,type:ze.type})},Je.readAsBinaryString(ze)}));var ze}):be}).then(function(Ze){P(Oe._dbInfo,me,function(ze,_e){if(ze)return Ee(ze);try{var Qe=_e.objectStore(Oe._dbInfo.storeName);Ze===null&&(Ze=void 0);var Je=Qe.put(Ze,oe);_e.oncomplete=function(){Ze===void 0&&(Ze=null),Le(Ze)},_e.onabort=_e.onerror=function(){var Ke=Je.error||Je.transaction.error;Ee(Ke)}}catch(Ke){Ee(Ke)}})}).catch(Ee)});return o(Xe,Te),Xe},removeItem:function(oe,be){var Te=this;oe=s(oe);var Oe=new W(function(Xe,Le){Te.ready().then(function(){P(Te._dbInfo,me,function(Ee,nt){if(Ee)return Le(Ee);try{var Ze=nt.objectStore(Te._dbInfo.storeName).delete(oe);nt.oncomplete=function(){Xe()},nt.onerror=function(){Le(Ze.error)},nt.onabort=function(){var ze=Ze.error||Ze.transaction.error;Le(ze)}}catch(ze){Le(ze)}})}).catch(Le)});return o(Oe,be),Oe},clear:function(oe){var be=this,Te=new W(function(Oe,Xe){be.ready().then(function(){P(be._dbInfo,me,function(Le,Ee){if(Le)return Xe(Le);try{var nt=Ee.objectStore(be._dbInfo.storeName).clear();Ee.oncomplete=function(){Oe()},Ee.onabort=Ee.onerror=function(){var Ze=nt.error||nt.transaction.error;Xe(Ze)}}catch(Ze){Xe(Ze)}})}).catch(Xe)});return o(Te,oe),Te},length:function(oe){var be=this,Te=new W(function(Oe,Xe){be.ready().then(function(){P(be._dbInfo,ne,function(Le,Ee){if(Le)return Xe(Le);try{var nt=Ee.objectStore(be._dbInfo.storeName).count();nt.onsuccess=function(){Oe(nt.result)},nt.onerror=function(){Xe(nt.error)}}catch(Ze){Xe(Ze)}})}).catch(Xe)});return o(Te,oe),Te},key:function(oe,be){var Te=this,Oe=new W(function(Xe,Le){oe<0?Xe(null):Te.ready().then(function(){P(Te._dbInfo,ne,function(Ee,nt){if(Ee)return Le(Ee);try{var Ze=nt.objectStore(Te._dbInfo.storeName),ze=!1,_e=Ze.openCursor();_e.onsuccess=function(){var Qe=_e.result;Qe?oe===0||ze?Xe(Qe.key):(ze=!0,Qe.advance(oe)):Xe(null)},_e.onerror=function(){Le(_e.error)}}catch(Qe){Le(Qe)}})}).catch(Le)});return o(Oe,be),Oe},keys:function(oe){var be=this,Te=new W(function(Oe,Xe){be.ready().then(function(){P(be._dbInfo,ne,function(Le,Ee){if(Le)return Xe(Le);try{var nt=Ee.objectStore(be._dbInfo.storeName).openCursor(),Ze=[];nt.onsuccess=function(){var ze=nt.result;ze?(Ze.push(ze.key),ze.continue()):Oe(Ze)},nt.onerror=function(){Xe(nt.error)}}catch(ze){Xe(ze)}})}).catch(Xe)});return o(Te,oe),Te},dropInstance:function(oe,be){be=u.apply(this,arguments);var Te,Oe=this.config();return(oe=typeof oe!="function"&&oe||{}).name||(oe.name=oe.name||Oe.name,oe.storeName=oe.storeName||Oe.storeName),o(Te=oe.name?(Te=oe.name===Oe.name&&this._dbInfo.db?W.resolve(this._dbInfo.db):g(oe).then(function(Xe){var Le=ue[oe.name],Ee=Le.forages;Le.db=Xe;for(var nt=0;nt<Ee.length;nt++)Ee[nt]._dbInfo.db=Xe;return Xe}),oe.storeName?Te.then(function(Xe){if(Xe.objectStoreNames.contains(oe.storeName)){var Le=Xe.version+1;m(oe);var Ee=ue[oe.name],nt=Ee.forages;Xe.close();for(var Ze=0;Ze<nt.length;Ze++){var ze=nt[Ze];ze._dbInfo.db=null,ze._dbInfo.version=Le}return new W(function(_e,Qe){var Je=L.open(oe.name,Le);Je.onerror=function(Ke){Je.result.close(),Qe(Ke)},Je.onupgradeneeded=function(){Je.result.deleteObjectStore(oe.storeName)},Je.onsuccess=function(){var Ke=Je.result;Ke.close(),_e(Ke)}}).then(function(_e){Ee.db=_e;for(var Qe=0;Qe<nt.length;Qe++){var Je=nt[Qe];Je._dbInfo.db=_e,d(Je._dbInfo)}}).catch(function(_e){throw(p(oe,_e)||W.resolve()).catch(function(){}),_e})}}):Te.then(function(Xe){m(oe);var Le=ue[oe.name],Ee=Le.forages;Xe.close();for(var nt=0;nt<Ee.length;nt++)Ee[nt]._dbInfo.db=null;return new W(function(Ze,ze){var _e=L.deleteDatabase(oe.name);_e.onerror=_e.onblocked=function(Qe){var Je=_e.result;Je&&Je.close(),ze(Qe)},_e.onsuccess=function(){var Qe=_e.result;Qe&&Qe.close(),Ze(Qe)}}).then(function(Ze){Le.db=Ze;for(var ze=0;ze<Ee.length;ze++)d(Ee[ze]._dbInfo)}).catch(function(Ze){throw(p(oe,Ze)||W.resolve()).catch(function(){}),Ze})})):W.reject("Invalid arguments"),be),Te}},we="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ie=/^~~local_forage_type~([^~]+)~/,ge="__lfsc__:",ce=ge.length,fe=ce+"arbf".length,ye=Object.prototype.toString,Ne={serialize:function(oe,be){var Te="";if(oe&&(Te=ye.call(oe)),oe&&(Te==="[object ArrayBuffer]"||oe.buffer&&ye.call(oe.buffer)==="[object ArrayBuffer]")){var Oe=ge;oe instanceof ArrayBuffer?(Xe=oe,Oe+="arbf"):(Xe=oe.buffer,Te==="[object Int8Array]"?Oe+="si08":Te==="[object Uint8Array]"?Oe+="ui08":Te==="[object Uint8ClampedArray]"?Oe+="uic8":Te==="[object Int16Array]"?Oe+="si16":Te==="[object Uint16Array]"?Oe+="ur16":Te==="[object Int32Array]"?Oe+="si32":Te==="[object Uint32Array]"?Oe+="ui32":Te==="[object Float32Array]"?Oe+="fl32":Te==="[object Float64Array]"?Oe+="fl64":be(new Error("Failed to get type for BinaryArray"))),be(Oe+k(Xe))}else if(Te==="[object Blob]"){var Xe=new FileReader;Xe.onload=function(){var Le="~~local_forage_type~"+oe.type+"~"+k(this.result);be(ge+"blob"+Le)},Xe.readAsArrayBuffer(oe)}else try{be(JSON.stringify(oe))}catch(Le){be(null,Le)}},deserialize:function(oe){if(oe.substring(0,ce)!==ge)return JSON.parse(oe);var be,Te=oe.substring(fe),Oe=oe.substring(ce,fe);Oe==="blob"&&ie.test(Te)&&(be=(oe=Te.match(ie))[1],Te=Te.substring(oe[0].length));var Xe=D(Te);switch(Oe){case"arbf":return Xe;case"blob":return l([Xe],{type:be});case"si08":return new Int8Array(Xe);case"ui08":return new Uint8Array(Xe);case"uic8":return new Uint8ClampedArray(Xe);case"si16":return new Int16Array(Xe);case"ur16":return new Uint16Array(Xe);case"si32":return new Int32Array(Xe);case"ui32":return new Uint32Array(Xe);case"fl32":return new Float32Array(Xe);case"fl64":return new Float64Array(Xe);default:throw new Error("Unkown type: "+Oe)}},stringToBuffer:D,bufferToString:k},xe={_driver:"webSQLStorage",_initStorage:function(oe){var be=this,Te={db:null};if(oe)for(var Oe in oe)Te[Oe]=typeof oe[Oe]!="string"?oe[Oe].toString():oe[Oe];var Xe=new W(function(Le,Ee){try{Te.db=openDatabase(Te.name,String(Te.version),Te.description,Te.size)}catch(nt){return Ee(nt)}Te.db.transaction(function(nt){w(nt,Te,function(){be._dbInfo=Te,Le()},function(Ze,ze){Ee(ze)})},Ee)});return Te.serializer=Ne,Xe},_support:typeof openDatabase=="function",iterate:function(oe,be){var Te=this,Oe=new W(function(Xe,Le){Te.ready().then(function(){var Ee=Te._dbInfo;Ee.db.transaction(function(nt){C(nt,Ee,"SELECT * FROM "+Ee.storeName,[],function(Ze,ze){for(var _e=ze.rows,Qe=_e.length,Je=0;Je<Qe;Je++){var Ke=_e.item(Je),gt=(gt=Ke.value)&&Ee.serializer.deserialize(gt);if((gt=oe(gt,Ke.key,Je+1))!==void 0)return void Xe(gt)}Xe()},function(Ze,ze){Le(ze)})})}).catch(Le)});return o(Oe,be),Oe},getItem:function(oe,be){var Te=this;oe=s(oe);var Oe=new W(function(Xe,Le){Te.ready().then(function(){var Ee=Te._dbInfo;Ee.db.transaction(function(nt){C(nt,Ee,"SELECT * FROM "+Ee.storeName+" WHERE key = ? LIMIT 1",[oe],function(Ze,ze){ze=(ze=ze.rows.length?ze.rows.item(0).value:null)&&Ee.serializer.deserialize(ze),Xe(ze)},function(Ze,ze){Le(ze)})})}).catch(Le)});return o(Oe,be),Oe},setItem:function(oe,be,Te){return T.apply(this,[oe,be,Te,1])},removeItem:function(oe,be){var Te=this;oe=s(oe);var Oe=new W(function(Xe,Le){Te.ready().then(function(){var Ee=Te._dbInfo;Ee.db.transaction(function(nt){C(nt,Ee,"DELETE FROM "+Ee.storeName+" WHERE key = ?",[oe],function(){Xe()},function(Ze,ze){Le(ze)})})}).catch(Le)});return o(Oe,be),Oe},clear:function(oe){var be=this,Te=new W(function(Oe,Xe){be.ready().then(function(){var Le=be._dbInfo;Le.db.transaction(function(Ee){C(Ee,Le,"DELETE FROM "+Le.storeName,[],function(){Oe()},function(nt,Ze){Xe(Ze)})})}).catch(Xe)});return o(Te,oe),Te},length:function(oe){var be=this,Te=new W(function(Oe,Xe){be.ready().then(function(){var Le=be._dbInfo;Le.db.transaction(function(Ee){C(Ee,Le,"SELECT COUNT(key) as c FROM "+Le.storeName,[],function(nt,Ze){Ze=Ze.rows.item(0).c,Oe(Ze)},function(nt,Ze){Xe(Ze)})})}).catch(Xe)});return o(Te,oe),Te},key:function(oe,be){var Te=this,Oe=new W(function(Xe,Le){Te.ready().then(function(){var Ee=Te._dbInfo;Ee.db.transaction(function(nt){C(nt,Ee,"SELECT key FROM "+Ee.storeName+" WHERE id = ? LIMIT 1",[oe+1],function(Ze,ze){ze=ze.rows.length?ze.rows.item(0).key:null,Xe(ze)},function(Ze,ze){Le(ze)})})}).catch(Le)});return o(Oe,be),Oe},keys:function(oe){var be=this,Te=new W(function(Oe,Xe){be.ready().then(function(){var Le=be._dbInfo;Le.db.transaction(function(Ee){C(Ee,Le,"SELECT key FROM "+Le.storeName,[],function(nt,Ze){for(var ze=[],_e=0;_e<Ze.rows.length;_e++)ze.push(Ze.rows.item(_e).key);Oe(ze)},function(nt,Ze){Xe(Ze)})})}).catch(Xe)});return o(Te,oe),Te},dropInstance:function(oe,be){be=u.apply(this,arguments);var Te=this.config();(oe=typeof oe!="function"&&oe||{}).name||(oe.name=oe.name||Te.name,oe.storeName=oe.storeName||Te.storeName);var Oe=this,Xe=oe.name?new W(function(Le){var Ee,nt=oe.name===Te.name?Oe._dbInfo.db:openDatabase(oe.name,"","",0);Le(oe.storeName?{db:nt,storeNames:[oe.storeName]}:(Ee=nt,new W(function(Ze,ze){Ee.transaction(function(_e){_e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Qe,Je){for(var Ke=[],gt=0;gt<Je.rows.length;gt++)Ke.push(Je.rows.item(gt).name);Ze({db:Ee,storeNames:Ke})},function(Qe,Je){ze(Je)})},function(_e){ze(_e)})})))}).then(function(Le){return new W(function(Ee,nt){Le.db.transaction(function(Ze){for(var ze=[],_e=0,Qe=Le.storeNames.length;_e<Qe;_e++)ze.push(function(Je){return new W(function(Ke,gt){Ze.executeSql("DROP TABLE IF EXISTS "+Je,[],function(){Ke()},function(At,cl){gt(cl)})})}(Le.storeNames[_e]));W.all(ze).then(function(){Ee()}).catch(function(Je){nt(Je)})},function(Ze){nt(Ze)})})}):W.reject("Invalid arguments");return o(Xe,be),Xe}},e={_driver:"localStorageWrapper",_initStorage:function(oe){var be={};if(oe)for(var Te in oe)be[Te]=oe[Te];return be.keyPrefix=O(oe,this._defaultConfig),z()?((this._dbInfo=be).serializer=Ne,W.resolve()):W.reject()},_support:function(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(oe){return!1}}(),iterate:function(oe,be){var Te=this,Oe=Te.ready().then(function(){for(var Xe=Te._dbInfo,Le=Xe.keyPrefix,Ee=Le.length,nt=localStorage.length,Ze=1,ze=0;ze<nt;ze++){var _e=localStorage.key(ze);if(_e.indexOf(Le)===0){var Qe=(Qe=localStorage.getItem(_e))&&Xe.serializer.deserialize(Qe);if((Qe=oe(Qe,_e.substring(Ee),Ze++))!==void 0)return Qe}}});return o(Oe,be),Oe},getItem:function(oe,be){var Te=this;oe=s(oe);var Oe=Te.ready().then(function(){var Xe=Te._dbInfo,Le=localStorage.getItem(Xe.keyPrefix+oe);return Le=Le&&Xe.serializer.deserialize(Le)});return o(Oe,be),Oe},setItem:function(oe,be,Te){var Oe=this;oe=s(oe);var Xe=Oe.ready().then(function(){be===void 0&&(be=null);var Le=be;return new W(function(Ee,nt){var Ze=Oe._dbInfo;Ze.serializer.serialize(be,function(ze,_e){if(_e)nt(_e);else try{localStorage.setItem(Ze.keyPrefix+oe,ze),Ee(Le)}catch(Qe){Qe.name!=="QuotaExceededError"&&Qe.name!=="NS_ERROR_DOM_QUOTA_REACHED"||nt(Qe),nt(Qe)}})})});return o(Xe,Te),Xe},removeItem:function(oe,be){var Te=this;oe=s(oe);var Oe=Te.ready().then(function(){var Xe=Te._dbInfo;localStorage.removeItem(Xe.keyPrefix+oe)});return o(Oe,be),Oe},clear:function(oe){var be=this,Te=be.ready().then(function(){for(var Oe=be._dbInfo.keyPrefix,Xe=localStorage.length-1;0<=Xe;Xe--){var Le=localStorage.key(Xe);Le.indexOf(Oe)===0&&localStorage.removeItem(Le)}});return o(Te,oe),Te},length:function(oe){var be=this.keys().then(function(Te){return Te.length});return o(be,oe),be},key:function(oe,be){var Te=this,Oe=Te.ready().then(function(){var Xe,Le=Te._dbInfo;try{Xe=localStorage.key(oe)}catch(Ee){Xe=null}return Xe=Xe&&Xe.substring(Le.keyPrefix.length)});return o(Oe,be),Oe},keys:function(oe){var be=this,Te=be.ready().then(function(){for(var Oe=be._dbInfo,Xe=localStorage.length,Le=[],Ee=0;Ee<Xe;Ee++){var nt=localStorage.key(Ee);nt.indexOf(Oe.keyPrefix)===0&&Le.push(nt.substring(Oe.keyPrefix.length))}return Le});return o(Te,oe),Te},dropInstance:function(oe,be){be=u.apply(this,arguments),(oe=typeof oe!="function"&&oe||{}).name||(Oe=this.config(),oe.name=oe.name||Oe.name,oe.storeName=oe.storeName||Oe.storeName);var Te=this,Oe=oe.name?new W(function(Xe){Xe(oe.storeName?O(oe,Te._defaultConfig):oe.name+"/")}).then(function(Xe){for(var Le=localStorage.length-1;0<=Le;Le--){var Ee=localStorage.key(Le);Ee.indexOf(Xe)===0&&localStorage.removeItem(Ee)}}):W.reject("Invalid arguments");return o(Oe,be),Oe}},et=Array.isArray||function(oe){return Object.prototype.toString.call(oe)==="[object Array]"},Fe={},it={},wt={INDEXEDDB:Q,WEBSQL:xe,LOCALSTORAGE:e},e=[wt.INDEXEDDB._driver,wt.WEBSQL._driver,wt.LOCALSTORAGE._driver],ot=["dropInstance"],xt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ot),Ft={description:"",driver:e.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},e=new(Se.prototype.config=function(oe){if((oe===void 0?"undefined":E(oe))!=="object")return typeof oe=="string"?this._config[oe]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var be in oe){if(be==="storeName"&&(oe[be]=oe[be].replace(/\W/g,"_")),be==="version"&&typeof oe[be]!="number")return new Error("Database version must be a number.");this._config[be]=oe[be]}return!("driver"in oe&&oe.driver)||this.setDriver(this._config.driver)},Se.prototype.defineDriver=function(oe,be,Te){var Oe=new W(function(Xe,Le){try{var Ee=oe._driver,nt=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!oe._driver)return void Le(nt);for(var Ze=xt.concat("_initStorage"),ze=0,_e=Ze.length;ze<_e;ze++){var Qe=Ze[ze];if((!N(ot,Qe)||oe[Qe])&&typeof oe[Qe]!="function")return void Le(nt)}(function(){for(var Ke=0,gt=ot.length;Ke<gt;Ke++){var At=ot[Ke];oe[At]||(oe[At]=function(cl){return function(){var El=new Error("Method "+cl+" is not implemented by the current driver"),El=W.reject(El);return o(El,arguments[arguments.length-1]),El}}(At))}})();var Je=function(Ke){Fe[Ee],Fe[Ee]=oe,it[Ee]=Ke,Xe()};"_support"in oe?oe._support&&typeof oe._support=="function"?oe._support().then(Je,Le):Je(!!oe._support):Je(!0)}catch(Ke){Le(Ke)}});return a(Oe,be,Te),Oe},Se.prototype.driver=function(){return this._driver||null},Se.prototype.getDriver=function(oe,be,Te){return oe=Fe[oe]?W.resolve(Fe[oe]):W.reject(new Error("Driver not found.")),a(oe,be,Te),oe},Se.prototype.getSerializer=function(oe){var be=W.resolve(Ne);return a(be,oe),be},Se.prototype.ready=function(oe){var be=this,Te=be._driverSet.then(function(){return be._ready===null&&(be._ready=be._initDriver()),be._ready});return a(Te,oe,oe),Te},Se.prototype.setDriver=function(oe,be,Te){function Oe(){Ee._config.driver=Ee.driver()}function Xe(Ze){return Ee._extend(Ze),Oe(),Ee._ready=Ee._initStorage(Ee._config),Ee._ready}function Le(Ze){return function(){var ze=0;return function _e(){for(;ze<Ze.length;){var Qe=Ze[ze];return ze++,Ee._dbInfo=null,Ee._ready=null,Ee.getDriver(Qe).then(Xe).catch(_e)}Oe();var Je=new Error("No available storage method found.");return Ee._driverSet=W.reject(Je),Ee._driverSet}()}}var Ee=this;et(oe)||(oe=[oe]);var nt=this._getSupportedDrivers(oe),oe=this._driverSet!==null?this._driverSet.catch(function(){return W.resolve()}):W.resolve();return this._driverSet=oe.then(function(){var Ze=nt[0];return Ee._dbInfo=null,Ee._ready=null,Ee.getDriver(Ze).then(function(ze){Ee._driver=ze._driver,Oe(),Ee._wrapLibraryMethodsWithReady(),Ee._initDriver=Le(nt)})}).catch(function(){Oe();var Ze=new Error("No available storage method found.");return Ee._driverSet=W.reject(Ze),Ee._driverSet}),a(this._driverSet,be,Te),this._driverSet},Se.prototype.supports=function(oe){return!!it[oe]},Se.prototype._extend=function(oe){A(this,oe)},Se.prototype._getSupportedDrivers=function(oe){for(var be=[],Te=0,Oe=oe.length;Te<Oe;Te++){var Xe=oe[Te];this.supports(Xe)&&be.push(Xe)}return be},Se.prototype._wrapLibraryMethodsWithReady=function(){for(var oe=0,be=xt.length;oe<be;oe++)(function(Te,Oe){Te[Oe]=function(){var Xe=arguments;return Te.ready().then(function(){return Te[Oe].apply(Te,Xe)})}})(this,xt[oe])},Se.prototype.createInstance=function(oe){return new Se(oe)},Se);function Se(oe){for(var be in function(Xe){if(!(Xe instanceof Se))throw new TypeError("Cannot call a class as a function")}(this),wt){var Te,Oe;wt.hasOwnProperty(be)&&(Oe=(Te=wt[be])._driver,this[be]=Oe,Fe[Oe]||this.defineDriver(Te))}this._defaultConfig=A({},Ft),this._config=A({},this._defaultConfig,oe),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}n.exports=e},{3:3}]},{},[4])(4)}),function(){function e(ee,de){return ee.set(de[0],de[1]),ee}function n(ee,de){return ee.add(de),ee}function t(ee,de,J){switch(J.length){case 0:return ee.call(de);case 1:return ee.call(de,J[0]);case 2:return ee.call(de,J[0],J[1]);case 3:return ee.call(de,J[0],J[1],J[2])}return ee.apply(de,J)}function l(ee,de,J,He){for(var Ae=-1,lt=ee==null?0:ee.length;++Ae<lt;){var vt=ee[Ae];de(He,vt,J(vt),ee)}return He}function o(ee,de){for(var J=-1,He=ee==null?0:ee.length;++J<He&&de(ee[J],J,ee)!==!1;);return ee}function a(ee,de){for(var J=ee==null?0:ee.length;J--&&de(ee[J],J,ee)!==!1;);return ee}function s(ee,de){for(var J=-1,He=ee==null?0:ee.length;++J<He;)if(!de(ee[J],J,ee))return!1;return!0}function u(ee,de){for(var J=-1,He=ee==null?0:ee.length,Ae=0,lt=[];++J<He;){var vt=ee[J];de(vt,J,ee)&&(lt[Ae++]=vt)}return lt}function f(ee,de){return!!(ee==null?0:ee.length)&&-1<S(ee,de,0)}function m(ee,de,J){for(var He=-1,Ae=ee==null?0:ee.length;++He<Ae;)if(J(de,ee[He]))return!0;return!1}function d(ee,de){for(var J=-1,He=ee==null?0:ee.length,Ae=Array(He);++J<He;)Ae[J]=de(ee[J],J,ee);return Ae}function p(ee,de){for(var J=-1,He=de.length,Ae=ee.length;++J<He;)ee[Ae+J]=de[J];return ee}function b(ee,de,J,He){var Ae=-1,lt=ee==null?0:ee.length;for(He&&lt&&(J=ee[++Ae]);++Ae<lt;)J=de(J,ee[Ae],Ae,ee);return J}function g(ee,de,J,He){var Ae=ee==null?0:ee.length;for(He&&Ae&&(J=ee[--Ae]);Ae--;)J=de(J,ee[Ae],Ae,ee);return J}function v(ee,de){for(var J=-1,He=ee==null?0:ee.length;++J<He;)if(de(ee[J],J,ee))return!0;return!1}function x(ee,de,J){var He;return J(ee,function(Ae,lt,vt){if(de(Ae,lt,vt))return He=lt,!1}),He}function _(ee,de,J,He){for(var Ae=ee.length,lt=J+(He?1:-1);He?lt--:++lt<Ae;)if(de(ee[lt],lt,ee))return lt;return-1}function S(ee,de,J){return de==de?function(He,Ae,lt){for(var vt=lt-1,bt=He.length;++vt<bt;)if(He[vt]===Ae)return vt;return-1}(ee,de,J):_(ee,P,J)}function I(ee,de,J,He){for(var Ae=J-1,lt=ee.length;++Ae<lt;)if(He(ee[Ae],de))return Ae;return-1}function P(ee){return ee!=ee}function F(ee,de){var J=ee==null?0:ee.length;return J?C(ee,de)/J:fe}function D(ee){return function(de){return de==null?Q:de[ee]}}function k(ee){return function(de){return ee==null?Q:ee[de]}}function w(ee,de,J,He,Ae){return Ae(ee,function(lt,vt,bt){J=He?(He=!1,lt):de(J,lt,vt,bt)}),J}function C(ee,de){for(var J,He=-1,Ae=ee.length;++He<Ae;){var lt=de(ee[He]);lt!==Q&&(J=J===Q?lt:J+lt)}return J}function T(ee,de){for(var J=-1,He=Array(ee);++J<ee;)He[J]=de(J);return He}function O(ee){return function(de){return ee(de)}}function z(ee,de){return d(de,function(J){return ee[J]})}function A(ee,de){return ee.has(de)}function E(ee,de){for(var J=-1,He=ee.length;++J<He&&-1<S(de,ee[J],0););return J}function L(ee,de){for(var J=ee.length;J--&&-1<S(de,ee[J],0););return J}function N(ee){return"\\"+ku[ee]}function W(ee){return Ma.test(ee)}function X(ee){var de=-1,J=Array(ee.size);return ee.forEach(function(He,Ae){J[++de]=[Ae,He]}),J}function te(ee,de){return function(J){return ee(de(J))}}function ue(ee,de){for(var J=-1,He=ee.length,Ae=0,lt=[];++J<He;){var vt=ee[J];vt!==de&&vt!==ge||(ee[J]=ge,lt[Ae++]=J)}return lt}function pe(ee){var de=-1,J=Array(ee.size);return ee.forEach(function(He){J[++de]=He}),J}function ne(ee){return(W(ee)?function(de){for(var J=Fa.lastIndex=0;Fa.test(de);)++J;return J}:j)(ee)}function me(ee){return W(ee)?ee.match(Fa)||[]:ee.split("")}var Q,we="Expected a function",ie="__lodash_hash_undefined__",ge="__lodash_placeholder__",ce=9007199254740991,fe=NaN,ye=4294967295,Ne=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],xe="[object Arguments]",et="[object Array]",Fe="[object Boolean]",it="[object Date]",wt="[object Error]",ot="[object Function]",xt="[object GeneratorFunction]",Ft="[object Map]",Se="[object Number]",oe="[object Object]",be="[object Promise]",Te="[object RegExp]",Oe="[object Set]",Xe="[object String]",Le="[object Symbol]",Ee="[object WeakMap]",nt="[object ArrayBuffer]",Ze="[object DataView]",ze="[object Float32Array]",_e="[object Float64Array]",Qe="[object Int8Array]",Je="[object Int16Array]",Ke="[object Int32Array]",gt="[object Uint8Array]",At="[object Uint8ClampedArray]",cl="[object Uint16Array]",El="[object Uint32Array]",bl=/\b__p \+= '';/g,Nr=/\b(__p \+=) '' \+/g,li=/(__e\(.*?\)|\b__t\)) \+\n'';/g,on=/&(?:amp|lt|gt|quot|#39);/g,Re=/[&<>"']/g,We=RegExp(on.source),ht=RegExp(Re.source),Ct=/<%-([\s\S]+?)%>/g,Lt=/<%([\s\S]+?)%>/g,Dt=/<%=([\s\S]+?)%>/g,ol=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,el=/^\w*$/,Al=/^\./,Vl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lr=/[\\^$.*+?()[\]{}|]/g,hn=RegExp(lr.source),en=/^\s+|\s+$/g,Mn=/^\s+/,Dn=/\s+$/,An=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Br=/\{\n\/\* \[wrapped with (.+)\] \*/,Ln=/,? & /,ri=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,dn=/\\(\\)?/g,zn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Hn=/\w*$/,$n=/^[-+]0x[0-9a-f]+$/i,di=/^0b[01]+$/i,qt=/^\[object .+?Constructor\]$/,ul=/^0o[0-7]+$/i,Sl=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,br=/($^)/,Fr=/['\n\r\u2028\u2029\\]/g,Wl="\\ud800-\\udfff",ni="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",no="\\u2700-\\u27bf",Ta="a-z\\xdf-\\xf6\\xf8-\\xff",ji="A-Z\\xc0-\\xd6\\xd8-\\xde",ii="\\ufe0e\\ufe0f",Bi="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",As="["+Wl+"]",zs="["+Bi+"]",io="["+ni+"]",yo="\\d+",No="["+no+"]",os="["+Ta+"]",oa="[^"+Wl+Bi+yo+no+Ta+ji+"]",as="\\ud83c[\\udffb-\\udfff]",pc="[^"+Wl+"]",Os="(?:\\ud83c[\\udde6-\\uddff]){2}",Ps="[\\ud800-\\udbff][\\udc00-\\udfff]",ko="["+ji+"]",aa="(?:"+os+"|"+oa+")",Bi="(?:"+ko+"|"+oa+")",no="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Ta="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",ji="(?:"+io+"|"+as+")?",oa="["+ii+"]?",ji=oa+ji+("(?:\\u200d(?:"+[pc,Os,Ps].join("|")+")"+oa+ji+")*"),No="(?:"+[No,Os,Ps].join("|")+")"+ji,As="(?:"+[pc+io+"?",io,Os,Ps,As].join("|")+")",Es=RegExp("['\u2019]","g"),Ra=RegExp(io,"g"),Fa=RegExp(as+"(?="+as+")|"+As+ji,"g"),Ns=RegExp([ko+"?"+os+"+"+no+"(?="+[zs,ko,"$"].join("|")+")",Bi+"+"+Ta+"(?="+[zs,ko+aa,"$"].join("|")+")",ko+"?"+aa+"+"+no,ko+"+"+Ta,"\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)","\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",yo,No].join("|"),"g"),Ma=RegExp("[\\u200d"+Wl+ni+ii+"]"),vu=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,yu=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],vc=-1,Vr={};Vr[ze]=Vr[_e]=Vr[Qe]=Vr[Je]=Vr[Ke]=Vr[gt]=Vr[At]=Vr[cl]=Vr[El]=!0,Vr[xe]=Vr[et]=Vr[nt]=Vr[Fe]=Vr[Ze]=Vr[it]=Vr[wt]=Vr[ot]=Vr[Ft]=Vr[Se]=Vr[oe]=Vr[Te]=Vr[Oe]=Vr[Xe]=Vr[Ee]=!1;var Or={};Or[xe]=Or[et]=Or[nt]=Or[Ze]=Or[Fe]=Or[it]=Or[ze]=Or[_e]=Or[Qe]=Or[Je]=Or[Ke]=Or[Ft]=Or[Se]=Or[oe]=Or[Te]=Or[Oe]=Or[Xe]=Or[Le]=Or[gt]=Or[At]=Or[cl]=Or[El]=!0,Or[wt]=Or[ot]=Or[Ee]=!1;var ku={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Da=parseFloat,ss=parseInt,Wl=typeof global=="object"&&global&&global.Object===Object&&global,ni=typeof self=="object"&&self&&self.Object===Object&&self,mn=Wl||ni||Function("return this")(),ii=typeof Bn=="object"&&Bn&&!Bn.nodeType&&Bn,ni=ii&&typeof Zn=="object"&&Zn&&!Zn.nodeType&&Zn,Lo=ni&&ni.exports===ii,Aa=Lo&&Wl.process,Wl=function(){try{return Aa&&Aa.binding&&Aa.binding("util")}catch(ee){}}(),cs=Wl&&Wl.isArrayBuffer,Ls=Wl&&Wl.isDate,B=Wl&&Wl.isMap,Z=Wl&&Wl.isRegExp,ae=Wl&&Wl.isSet,M=Wl&&Wl.isTypedArray,j=D("length"),V=k({\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"}),U=k({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),le=k({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),se=function ee(de){function J(R){if(Rn(R)&&!rr(R)&&!(R instanceof lt)){if(R instanceof Ae)return R;if(an.call(R,"__wrapped__"))return cp(R)}return new Ae(R)}function He(){}function Ae(R,H){this.__wrapped__=R,this.__actions__=[],this.__chain__=!!H,this.__index__=0,this.__values__=Q}function lt(R){this.__wrapped__=R,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ye,this.__views__=[]}function vt(R){var H=-1,Y=R==null?0:R.length;for(this.clear();++H<Y;){var he=R[H];this.set(he[0],he[1])}}function bt(R){var H=-1,Y=R==null?0:R.length;for(this.clear();++H<Y;){var he=R[H];this.set(he[0],he[1])}}function dl(R){var H=-1,Y=R==null?0:R.length;for(this.clear();++H<Y;){var he=R[H];this.set(he[0],he[1])}}function Jt(R){var H=-1,Y=R==null?0:R.length;for(this.__data__=new dl;++H<Y;)this.add(R[H])}function Cl(R){R=this.__data__=new bt(R),this.size=R.size}function Rl(R,H){var Y,he=rr(R),$e=!he&&Us(R),Pe=!he&&!$e&&hs(R),rt=!he&&!$e&&!Pe&&Ac(R),ct=he||$e||Pe||rt,pt=ct?T(R.length,Uk):[],Rt=pt.length;for(Y in R)!H&&!an.call(R,Y)||ct&&(Y=="length"||Pe&&(Y=="offset"||Y=="parent")||rt&&(Y=="buffer"||Y=="byteLength"||Y=="byteOffset")||Ha(Y,Rt))||pt.push(Y);return pt}function Pr(R){var H=R.length;return H?R[Ea(0,H-1)]:Q}function fl(R,H){return If(jn(R),wr(H,0,R.length))}function Wt(R){return If(jn(R))}function ar(R,H,Y){(Y===Q||fa(R[H],Y))&&(Y!==Q||H in R)||yr(R,H,Y)}function Fl(R,H,Y){var he=R[H];an.call(R,H)&&fa(he,Y)&&(Y!==Q||H in R)||yr(R,H,Y)}function Ir(R,H){for(var Y=R.length;Y--;)if(fa(R[Y][0],H))return Y;return-1}function oi(R,H,Y,he){return fs(R,function($e,Pe,rt){H(he,$e,Y($e),rt)}),he}function Un(R,H){return R&&$i(H,si(H),R)}function yr(R,H,Y){H=="__proto__"&&Lf?Lf(R,H,{configurable:!0,enumerable:!0,value:Y,writable:!0}):R[H]=Y}function Yr(R,H){for(var Y=-1,he=H.length,$e=Yn(he),Pe=R==null;++Y<he;)$e[Y]=Pe?Q:fd(R,H[Y]);return $e}function wr(R,H,Y){return R==R&&(Y!==Q&&(R=R<=Y?R:Y),H!==Q&&(R=H<=R?R:H)),R}function Xr(R,H,Y,he,$e,Pe){var rt,ct=1&H,pt=2&H,Rt=4&H;if(Y&&(rt=$e?Y(R,he,$e,Pe):Y(R)),rt!==Q)return rt;if(!_n(R))return R;var St,Ht,Qt=rr(R);if(Qt){if(he=(Gt=R).length,nl=Gt.constructor(he),he&&typeof Gt[0]=="string"&&an.call(Gt,"index")&&(nl.index=Gt.index,nl.input=Gt.input),rt=nl,!ct)return jn(R,rt)}else{var Gt=Ii(R),nl=Gt==ot||Gt==xt;if(hs(R))return ql(R,ct);if(Gt==oe||Gt==xe||nl&&!$e){if(rt=pt||nl?{}:lp(R),!ct)return pt?(nl=St=R,Ht=(Ht=rt)&&$i(nl,so(nl),Ht),$i(St,qp(St),Ht)):(Ht=Un(rt,St=R),$i(St,Md(St),Ht))}else{if(!Or[Gt])return $e?R:{};rt=function(Kt,Ml,jl,Nl){var nn=Kt.constructor;switch(Ml){case nt:return Dl(Kt);case Fe:case it:return new nn(+Kt);case Ze:return function(Pl,Mr){return Mr=Mr?Dl(Pl.buffer):Pl.buffer,new Pl.constructor(Mr,Pl.byteOffset,Pl.byteLength)}(Kt,Nl);case ze:case _e:case Qe:case Je:case Ke:case gt:case At:case cl:case El:return pn(Kt,Nl);case Ft:return function(Pl,Mr,sn){return b(Mr?sn(X(Pl),1):X(Pl),e,new Pl.constructor)}(Kt,Nl,jl);case Se:case Xe:return new nn(Kt);case Te:return function(Pl){var Mr=new Pl.constructor(Pl.source,Hn.exec(Pl));return Mr.lastIndex=Pl.lastIndex,Mr}(Kt);case Oe:return function(Pl,Mr,sn){return b(Mr?sn(pe(Pl),1):pe(Pl),n,new Pl.constructor)}(Kt,Nl,jl);case Le:return function(Pl){return Mu?vn(Mu.call(Pl)):{}}(Kt)}}(R,Gt,Xr,ct)}}if(ct=(Pe=Pe||new Cl).get(R),ct)return ct;Pe.set(R,rt);var zl=Qt?Q:(Rt?pt?nd:rd:pt?so:si)(R);return o(zl||R,function(Kt,Ml){zl&&(Kt=R[Ml=Kt]),Fl(rt,Ml,Xr(Kt,H,Y,Ml,R,Pe))}),rt}function rn(R,H,Y){var he=Y.length;if(R==null)return!he;for(R=vn(R);he--;){var $e=Y[he],Pe=H[$e],rt=R[$e];if(rt===Q&&!($e in R)||!Pe(rt))return!1}return!0}function pr(R,H,Y){if(typeof R!="function")throw new _o(we);return Du(function(){R.apply(Q,Y)},H)}function $r(R,H,Y,he){var $e=-1,Pe=f,rt=!0,ct=R.length,pt=[],Rt=H.length;if(!ct)return pt;Y&&(H=d(H,O(Y))),he?(Pe=m,rt=!1):200<=H.length&&(Pe=A,rt=!1,H=new Jt(H));e:for(;++$e<ct;){var St=R[$e],Ht=Y==null?St:Y(St),St=he||St!==0?St:0;if(rt&&Ht==Ht){for(var Qt=Rt;Qt--;)if(H[Qt]===Ht)continue e;pt.push(St)}else Pe(H,Ht,he)||pt.push(St)}return pt}function xr(R,H){var Y=!0;return fs(R,function(he,$e,Pe){return Y=!!H(he,$e,Pe)}),Y}function Sn(R,H,Y){for(var he=-1,$e=R.length;++he<$e;){var Pe,rt,ct=R[he],pt=H(ct);pt!=null&&(Pe===Q?pt==pt&&!ao(pt):Y(pt,Pe))&&(Pe=pt,rt=ct)}return rt}function Tl(R,H){var Y=[];return fs(R,function(he,$e,Pe){H(he,$e,Pe)&&Y.push(he)}),Y}function vr(R,H,Y,he,$e){var Pe=-1,rt=R.length;for(Y=Y||qk,$e=$e||[];++Pe<rt;){var ct=R[Pe];0<H&&Y(ct)?1<H?vr(ct,H-1,Y,he,$e):p($e,ct):he||($e[$e.length]=ct)}return $e}function Gl(R,H){return R&&Id(R,H,si)}function mi(R,H){return R&&Vp(R,H,si)}function za(R,H){return u(H,function(Y){return ja(R[Y])})}function Oi(R,H){for(var Y=0,he=(H=ml(H,R)).length;R!=null&&Y<he;)R=R[ua(H[Y++])];return Y&&Y==he?R:Q}function yc(R,H,Y){return H=H(R),rr(R)?H:p(H,Y(R))}function In(R){return R==null?R===Q?"[object Undefined]":"[object Null]":Ws&&Ws in vn(R)?function(H){var Y=an.call(H,Ws),he=H[Ws];try{H[Ws]=Q;var $e=!0}catch(rt){}var Pe=Op.call(H);return $e&&(Y?H[Ws]=he:delete H[Ws]),Pe}(R):(R=R,Op.call(R))}function Hs(R,H){return H<R}function bu(R,H){return R!=null&&an.call(R,H)}function kc(R,H){return R!=null&&H in vn(R)}function sa(R,H,Y){for(var he=Y?m:f,$e=R[0].length,Pe=R.length,rt=Pe,ct=Yn(Pe),pt=1/0,Rt=[];rt--;){var St=R[rt];rt&&H&&(St=d(St,O(H))),pt=Si(St.length,pt),ct[rt]=!Y&&(H||120<=$e&&120<=St.length)?new Jt(rt&&St):Q}St=R[0];var Ht=-1,Qt=ct[0];e:for(;++Ht<$e&&Rt.length<pt;){var Gt=St[Ht],nl=H?H(Gt):Gt,Gt=Y||Gt!==0?Gt:0;if(!(Qt?A(Qt,nl):he(Rt,nl,Y))){for(rt=Pe;--rt;){var zl=ct[rt];if(!(zl?A(zl,nl):he(R[rt],nl,Y)))continue e}Qt&&Qt.push(nl),Rt.push(Gt)}}return Rt}function ca(R,H,Y){return H=(R=op(R,H=ml(H,R)))==null?R:R[ua(wo(H))],H==null?Q:t(H,R,Y)}function Oa(R){return Rn(R)&&In(R)==xe}function oo(R,H,Y,he,$e){return R===H||(R==null||H==null||!Rn(R)&&!Rn(H)?R!=R&&H!=H:function(Pe,rt,ct,pt,Rt,St){var Ht=rr(Pe),Qt=rr(rt),Gt=Ht?et:Ii(Pe),nl=Qt?et:Ii(rt),zl=(Gt=Gt==xe?oe:Gt)==oe,Qt=(nl=nl==xe?oe:nl)==oe,nl=Gt==nl;if(nl&&hs(Pe)){if(!hs(rt))return!1;zl=!(Ht=!0)}return nl&&!zl?(St=St||new Cl,Ht||Ac(Pe)?ep(Pe,rt,ct,pt,Rt,St):function(Kt,Ml,jl,Nl,nn,Pl,Mr){switch(jl){case Ze:if(Kt.byteLength!=Ml.byteLength||Kt.byteOffset!=Ml.byteOffset)return!1;Kt=Kt.buffer,Ml=Ml.buffer;case nt:return!(Kt.byteLength!=Ml.byteLength||!Pl(new Pf(Kt),new Pf(Ml)));case Fe:case it:case Se:return fa(+Kt,+Ml);case wt:return Kt.name==Ml.name&&Kt.message==Ml.message;case Te:case Xe:return Kt==Ml+"";case Ft:var sn=X;case Oe:var ci=1&Nl;return sn=sn||pe,Kt.size!=Ml.size&&!ci?!1:(ci=Mr.get(Kt),ci?ci==Ml:(Nl|=2,Mr.set(Kt,Ml),sn=ep(sn(Kt),sn(Ml),Nl,nn,Pl,Mr),Mr.delete(Kt),sn));case Le:if(Mu)return Mu.call(Kt)==Mu.call(Ml)}return!1}(Pe,rt,Gt,ct,pt,Rt,St)):!(1&ct)&&(zl=zl&&an.call(Pe,"__wrapped__"),Qt=Qt&&an.call(rt,"__wrapped__"),zl||Qt)?(zl=zl?Pe.value():Pe,Qt=Qt?rt.value():rt,St=St||new Cl,Rt(zl,Qt,ct,pt,St)):!!nl&&(St=St||new Cl,function(Kt,Ml,jl,Nl,nn,Pl){var Mr=1&jl,sn=rd(Kt),ci=sn.length,Co=rd(Ml).length;if(ci!=Co&&!Mr)return!1;for(var Bo=ci;Bo--;){var da=sn[Bo];if(!(Mr?da in Ml:an.call(Ml,da)))return!1}var ma=Pl.get(Kt);if(ma&&Pl.get(Ml))return ma==Ml;var Wf=!0;Pl.set(Kt,Ml),Pl.set(Ml,Kt);for(var jd=Mr;++Bo<ci;){da=sn[Bo];var Bd,qf=Kt[da],Uf=Ml[da];if(Nl&&(Bd=Mr?Nl(Uf,qf,da,Ml,Kt,Pl):Nl(qf,Uf,da,Kt,Ml,Pl)),!(Bd===Q?qf===Uf||nn(qf,Uf,jl,Nl,Pl):Bd)){Wf=!1;break}jd=jd||da=="constructor"}return Wf&&!jd&&(Co=Kt.constructor,ma=Ml.constructor,Co!=ma&&"constructor"in Kt&&"constructor"in Ml&&!(typeof Co=="function"&&Co instanceof Co&&typeof ma=="function"&&ma instanceof ma)&&(Wf=!1)),Pl.delete(Kt),Pl.delete(Ml),Wf}(Pe,rt,ct,pt,Rt,St))}(R,H,Y,he,oo,$e))}function js(R,H,Y,he){var $e=Y.length,Pe=$e,rt=!he;if(R==null)return!Pe;for(R=vn(R);$e--;){var ct=Y[$e];if(rt&&ct[2]?ct[1]!==R[ct[0]]:!(ct[0]in R))return!1}for(;++$e<Pe;){var pt=(ct=Y[$e])[0],Rt=R[pt],St=ct[1];if(rt&&ct[2]){if(Rt===Q&&!(pt in R))return!1}else{var Ht,Qt=new Cl;if(he&&(Ht=he(Rt,St,pt,R,H,Qt)),!(Ht===Q?oo(St,Rt,3,he,Qt):Ht))return!1}}return!0}function bo(R){return!(!_n(R)||(H=R,zp&&zp in H))&&(ja(R)?Zk:qt).test(Vs(R));var H}function bc(R){return typeof R=="function"?R:R==null?qi:typeof R=="object"?rr(R)?Tr(R[0],R[1]):xi(R):Mp(R)}function gi(R){if(!xu(R))return Qk(R);var H,Y=[];for(H in vn(R))an.call(R,H)&&H!="constructor"&&Y.push(H);return Y}function Lr(R){if(!_n(R))return function($e){var Pe=[];if($e!=null)for(var rt in vn($e))Pe.push(rt);return Pe}(R);var H,Y=xu(R),he=[];for(H in R)(H!="constructor"||!Y&&an.call(R,H))&&he.push(H);return he}function pi(R,H){return R<H}function gn(R,H){var Y=-1,he=Wi(R)?Yn(R.length):[];return fs(R,function($e,Pe,rt){he[++Y]=H($e,Pe,rt)}),he}function xi(R){var H=id(R);return H.length==1&&H[0][2]?np(H[0][0],H[0][1]):function(Y){return Y===R||js(Y,R,H)}}function Tr(R,H){return od(R)&&rp(H)?np(ua(R),H):function(Y){var he=fd(Y,R);return he===Q&&he===H?hd(Y,R):oo(H,he,3)}}function Ho(R,H,Y,he,$e){R!==H&&Id(H,function(Pe,rt){var ct;_n(Pe)?($e=$e||new Cl,function(pt,Rt,St,Ht,Qt,Gt,nl){var zl=pt[St],Kt=Rt[St],Ml=nl.get(Kt);if(Ml)return ar(pt,St,Ml);var jl,Nl=Gt?Gt(zl,Kt,St+"",pt,Rt,nl):Q,nn=Nl===Q;nn&&(jl=rr(Kt),Ml=!jl&&hs(Kt),Rt=!jl&&!Ml&&Ac(Kt),Nl=Kt,jl||Ml||Rt?Nl=rr(zl)?zl:On(zl)?jn(zl):Ml?ql(Kt,!(nn=!1)):Rt?pn(Kt,!(nn=!1)):[]:_u(Kt)||Us(Kt)?Us(Nl=zl)?Nl=Sp(zl):(!_n(zl)||Ht&&ja(zl))&&(Nl=lp(Kt)):nn=!1),nn&&(nl.set(Kt,Nl),Qt(Nl,Kt,Ht,Gt,nl),nl.delete(Kt)),ar(pt,St,Nl)}(R,H,rt,Y,Ho,he,$e)):((ct=he?he(R[rt],Pe,rt+"",R,H,$e):Q)===Q&&(ct=Pe),ar(R,rt,ct))},so)}function Tn(R,H){var Y=R.length;if(Y)return Ha(H+=H<0?Y:0,Y)?R[H]:Q}function vi(R,H,Y){var he=-1;return H=d(H.length?H:[qi],O(Hl())),function($e,Pe){var rt=$e.length;for($e.sort(Pe);rt--;)$e[rt]=$e[rt].value;return $e}(gn(R,function($e,Pe,rt){return{criteria:d(H,function(ct){return ct($e)}),index:++he,value:$e}}),function($e,Pe){return function(rt,ct,pt){for(var Rt=-1,St=rt.criteria,Ht=ct.criteria,Qt=St.length,Gt=pt.length;++Rt<Qt;){var nl=Gn(St[Rt],Ht[Rt]);if(nl){if(Gt<=Rt)return nl;var zl=pt[Rt];return nl*(zl=="desc"?-1:1)}}return rt.index-ct.index}($e,Pe,Y)})}function Pa(R,H,Y){for(var he=-1,$e=H.length,Pe={};++he<$e;){var rt=H[he],ct=Oi(R,rt);Y(ct,rt)&&je(Pe,ml(rt,R),ct)}return Pe}function jo(R,H,Y,he){var $e=he?I:S,Pe=-1,rt=H.length,ct=R;for(R===H&&(H=jn(H)),Y&&(ct=d(R,O(Y)));++Pe<rt;)for(var pt=0,Rt=H[Pe],St=Y?Y(Rt):Rt;-1<(pt=$e(ct,St,pt,he));)ct!==R&&Nf.call(ct,pt,1),Nf.call(R,pt,1);return R}function us(R,H){for(var Y=R?H.length:0,he=Y-1;Y--;){var $e,Pe=H[Y];Y!=he&&Pe===$e||(Ha($e=Pe)?Nf.call(R,Pe,1):dt(R,Pe))}return R}function Ea(R,H){return R+jf(Hp()*(H-R+1))}function _i(R,H){var Y="";if(!R||H<1||ce<H)return Y;for(;H%2&&(Y+=R),H=jf(H/2),H&&(R+=R),H;);return Y}function Yl(R,H){return zd(ip(R,H,qi),R+"")}function wc(R){return Pr($c(R))}function De(R,H){return R=$c(R),If(R,wr(H,0,R.length))}function je(R,H,Y,he){if(!_n(R))return R;for(var $e=-1,Pe=(H=ml(H,R)).length,rt=Pe-1,ct=R;ct!=null&&++$e<Pe;){var pt,Rt=ua(H[$e]),St=Y;$e!=rt&&(pt=ct[Rt],(St=he?he(pt,Rt,ct):Q)===Q&&(St=_n(pt)?pt:Ha(H[$e+1])?[]:{})),Fl(ct,Rt,St),ct=ct[Rt]}return R}function tt(R){return If($c(R))}function yt(R,H,Y){var he=-1,$e=R.length;H<0&&(H=$e<-H?0:$e+H),(Y=$e<Y?$e:Y)<0&&(Y+=$e),$e=Y<H?0:Y-H>>>0,H>>>=0;for(var Pe=Yn($e);++he<$e;)Pe[he]=R[he+H];return Pe}function jt(R,H){var Y;return fs(R,function(he,$e,Pe){return!(Y=H(he,$e,Pe))}),!!Y}function pl(R,H,Y){var he=0,$e=R==null?he:R.length;if(typeof H=="number"&&H==H&&$e<=2147483647){for(;he<$e;){var Pe=he+$e>>>1,rt=R[Pe];rt!==null&&!ao(rt)&&(Y?rt<=H:rt<H)?he=1+Pe:$e=Pe}return $e}return Bt(R,H,qi,Y)}function Bt(R,H,Y,he){H=Y(H);for(var $e=0,Pe=R==null?0:R.length,rt=H!=H,ct=H===null,pt=ao(H),Rt=H===Q;$e<Pe;){var St=jf(($e+Pe)/2),Ht=Y(R[St]),Qt=Ht!==Q,Gt=Ht===null,nl=Ht==Ht,zl=ao(Ht),Ht=rt?he||nl:Rt?nl&&(he||Qt):ct?nl&&Qt&&(he||!Gt):pt?nl&&Qt&&!Gt&&(he||!zl):!Gt&&!zl&&(he?Ht<=H:Ht<H);Ht?$e=St+1:Pe=St}return Si(Pe,4294967294)}function hl(R,H){for(var Y=-1,he=R.length,$e=0,Pe=[];++Y<he;){var rt,ct=R[Y],pt=H?H(ct):ct;Y&&fa(pt,rt)||(rt=pt,Pe[$e++]=ct===0?0:ct)}return Pe}function Ce(R){return typeof R=="number"?R:ao(R)?fe:+R}function Ve(R){if(typeof R=="string")return R;if(rr(R))return d(R,Ve)+"";if(ao(R))return jp?jp.call(R):"";var H=R+"";return H=="0"&&1/R==-1/0?"-0":H}function Ge(R,H,Y){var he=-1,$e=f,Pe=R.length,rt=!0,ct=[],pt=ct;if(Y)rt=!1,$e=m;else if(200<=Pe){var Rt=H?null:cb(R);if(Rt)return pe(Rt);rt=!1,$e=A,pt=new Jt}else pt=H?[]:ct;e:for(;++he<Pe;){var St=R[he],Ht=H?H(St):St,St=Y||St!==0?St:0;if(rt&&Ht==Ht){for(var Qt=pt.length;Qt--;)if(pt[Qt]===Ht)continue e;H&&pt.push(Ht),ct.push(St)}else $e(pt,Ht,Y)||(pt!==ct&&pt.push(Ht),ct.push(St))}return ct}function dt(R,H){return(R=op(R,H=ml(H,R)))==null||delete R[ua(wo(H))]}function st(R,H,Y,he){return je(R,H,Y(Oi(R,H)),he)}function $t(R,H,Y,he){for(var $e=R.length,Pe=he?$e:-1;(he?Pe--:++Pe<$e)&&H(R[Pe],Pe,R););return Y?yt(R,he?0:Pe,he?Pe+1:$e):yt(R,he?Pe+1:0,he?$e:Pe)}function mt(R,H){return R instanceof lt&&(R=R.value()),b(H,function(Y,he){return he.func.apply(he.thisArg,p([Y],he.args))},R)}function Ot(R,H,Y){var he=R.length;if(he<2)return he?Ge(R[0]):[];for(var $e=-1,Pe=Yn(he);++$e<he;)for(var rt=R[$e],ct=-1;++ct<he;)ct!=$e&&(Pe[$e]=$r(Pe[$e]||rt,R[ct],H,Y));return Ge(vr(Pe,1),H,Y)}function rl(R,H,Y){for(var he=-1,$e=R.length,Pe=H.length,rt={};++he<$e;){var ct=he<Pe?H[he]:Q;Y(rt,R[he],ct)}return rt}function vl(R){return On(R)?R:[]}function Ut(R){return typeof R=="function"?R:qi}function ml(R,H){return rr(R)?R:od(R,H)?[R]:Gp(Hr(R))}function Il(R,H,Y){var he=R.length;return Y=Y===Q?he:Y,!H&&he<=Y?R:yt(R,H,Y)}function ql(R,H){return H?R.slice():(H=R.length,H=Pp?Pp(H):new R.constructor(H),R.copy(H),H)}function Dl(R){var H=new R.constructor(R.byteLength);return new Pf(H).set(new Pf(R)),H}function pn(R,H){return H=H?Dl(R.buffer):R.buffer,new R.constructor(H,R.byteOffset,R.length)}function Gn(R,H){if(R!==H){var Y=R!==Q,he=R===null,$e=R==R,Pe=ao(R),rt=H!==Q,ct=H===null,pt=H==H,Rt=ao(H);if(!ct&&!Rt&&!Pe&&H<R||Pe&&rt&&pt&&!ct&&!Rt||he&&rt&&pt||!Y&&pt||!$e)return 1;if(!he&&!Pe&&!Rt&&R<H||Rt&&Y&&$e&&!he&&!Pe||ct&&Y&&$e||!rt&&$e||!pt)return-1}return 0}function Ci(R,H,Y,he){for(var $e=-1,Pe=R.length,rt=Y.length,ct=-1,pt=H.length,Rt=Xn(Pe-rt,0),St=Yn(pt+Rt),Ht=!he;++ct<pt;)St[ct]=H[ct];for(;++$e<rt;)(Ht||$e<Pe)&&(St[Y[$e]]=R[$e]);for(;Rt--;)St[ct++]=R[$e++];return St}function tn(R,H,Y,he){for(var $e=-1,Pe=R.length,rt=-1,ct=Y.length,pt=-1,Rt=H.length,St=Xn(Pe-ct,0),Ht=Yn(St+Rt),Qt=!he;++$e<St;)Ht[$e]=R[$e];for(var Gt=$e;++pt<Rt;)Ht[Gt+pt]=H[pt];for(;++rt<ct;)(Qt||$e<Pe)&&(Ht[Gt+Y[rt]]=R[$e++]);return Ht}function jn(R,H){var Y=-1,he=R.length;for(H=H||Yn(he);++Y<he;)H[Y]=R[Y];return H}function $i(R,H,Y,he){var $e=!Y;Y=Y||{};for(var Pe=-1,rt=H.length;++Pe<rt;){var ct=H[Pe],pt=he?he(Y[ct],R[ct],ct,Y,R):Q;pt===Q&&(pt=R[ct]),($e?yr:Fl)(Y,ct,pt)}return Y}function ai(R,H){return function(Y,he){var $e=rr(Y)?l:oi,Pe=H?H():{};return $e(Y,R,Hl(he,2),Pe)}}function xc(R){return Yl(function(H,Y){var he=-1,$e=Y.length,Pe=1<$e?Y[$e-1]:Q,rt=2<$e?Y[2]:Q,Pe=3<R.length&&typeof Pe=="function"?($e--,Pe):Q;for(rt&&Vi(Y[0],Y[1],rt)&&(Pe=$e<3?Q:Pe,$e=1),H=vn(H);++he<$e;){var ct=Y[he];ct&&R(H,ct,he,Pe)}return H})}function Wg(R,H){return function(Y,he){if(Y==null)return Y;if(!Wi(Y))return R(Y,he);for(var $e=Y.length,Pe=H?$e:-1,rt=vn(Y);(H?Pe--:++Pe<$e)&&he(rt[Pe],Pe,rt)!==!1;);return Y}}function qg(R){return function(H,Y,he){for(var $e=-1,Pe=vn(H),rt=he(H),ct=rt.length;ct--;){var pt=rt[R?ct:++$e];if(Y(Pe[pt],pt,Pe)===!1)break}return H}}function Ug(R){return function(H){var Y=W(H=Hr(H))?me(H):Q,he=Y?Y[0]:H.charAt(0),H=Y?Il(Y,1).join(""):H.slice(1);return he[R]()+H}}function _c(R){return function(H){return b(Fp(Rp(H).replace(Es,"")),R,"")}}function wu(R){return function(){var H=arguments;switch(H.length){case 0:return new R;case 1:return new R(H[0]);case 2:return new R(H[0],H[1]);case 3:return new R(H[0],H[1],H[2]);case 4:return new R(H[0],H[1],H[2],H[3]);case 5:return new R(H[0],H[1],H[2],H[3],H[4]);case 6:return new R(H[0],H[1],H[2],H[3],H[4],H[5]);case 7:return new R(H[0],H[1],H[2],H[3],H[4],H[5],H[6])}var Y=Dc(R.prototype),he=R.apply(Y,H);return _n(he)?he:Y}}function Bk(R,H,Y){var he=wu(R);return function $e(){for(var Pe=arguments.length,rt=Yn(Pe),ct=Pe,pt=Cc($e);ct--;)rt[ct]=arguments[ct];return pt=Pe<3&&rt[0]!==pt&&rt[Pe-1]!==pt?[]:ue(rt,pt),(Pe-=pt.length)<Y?Kg(R,H,wf,$e.placeholder,Q,rt,pt,Q,Q,Y-Pe):t(this&&this!==mn&&this instanceof $e?he:R,this,rt)}}function Gg(R){return function(H,Y,he){var $e,Pe=vn(H);return Wi(H)||($e=Hl(Y,3),H=si(H),Y=function(rt){return $e(Pe[rt],rt,Pe)}),he=R(H,Y,he),-1<he?Pe[$e?H[he]:he]:Q}}function Yg(R){return La(function(H){var Y=H.length,he=Y,$e=Ae.prototype.thru;for(R&&H.reverse();he--;){var Pe=H[he];if(typeof Pe!="function")throw new _o(we);$e&&!pt&&$f(Pe)=="wrapper"&&(pt=new Ae([],!0))}for(he=pt?he:Y;++he<Y;)var rt=$f(Pe=H[he]),ct=rt=="wrapper"?Fd(Pe):Q,pt=ct&&ad(ct[0])&&ct[1]==424&&!ct[4].length&&ct[9]==1?pt[$f(ct[0])].apply(pt,ct[3]):Pe.length==1&&ad(Pe)?pt[rt]():pt.thru(Pe);return function(){var Rt=arguments,St=Rt[0];if(pt&&Rt.length==1&&rr(St))return pt.plant(St).value();for(var Ht=0,Qt=Y?H[Ht].apply(this,Rt):St;++Ht<Y;)Qt=H[Ht].call(this,Qt);return Qt}})}function wf(R,H,Y,he,$e,Pe,rt,ct,pt,Rt){var St=128&H,Ht=1&H,Qt=2&H,Gt=24&H,nl=512&H,zl=Qt?Q:wu(R);return function Kt(){for(var Ml,jl=Yn(Mr=arguments.length),Nl=Mr;Nl--;)jl[Nl]=arguments[Nl];if(Gt&&(Ml=function(sn,ci){for(var Co=sn.length,Bo=0;Co--;)sn[Co]===ci&&++Bo;return Bo}(jl,nn=Cc(Kt))),he&&(jl=Ci(jl,he,$e,Gt)),Pe&&(jl=tn(jl,Pe,rt,Gt)),Mr-=Ml,Gt&&Mr<Rt){var Pl=ue(jl,nn);return Kg(R,H,wf,Kt.placeholder,Y,jl,Pl,ct,pt,Rt-Mr)}var nn=Ht?Y:this,Pl=Qt?nn[R]:R,Mr=jl.length;return ct?jl=function(sn,ci){for(var Co=sn.length,Bo=Si(ci.length,Co),da=jn(sn);Bo--;){var ma=ci[Bo];sn[Bo]=Ha(ma,Co)?da[ma]:Q}return sn}(jl,ct):nl&&1<Mr&&jl.reverse(),St&&pt<Mr&&(jl.length=pt),this&&this!==mn&&this instanceof Kt&&(Pl=zl||wu(Pl)),Pl.apply(nn,jl)}}function Xg(R,H){return function(Y,he){return Y=Y,$e=R,Pe=H(he),rt={},Gl(Y,function(ct,pt,Rt){$e(rt,Pe(ct),pt,Rt)}),rt;var $e,Pe,rt}}function xf(R,H){return function(Y,he){var $e;if(Y===Q&&he===Q)return H;if(Y!==Q&&($e=Y),he!==Q){if($e===Q)return he;he=typeof Y=="string"||typeof he=="string"?(Y=Ve(Y),Ve(he)):(Y=Ce(Y),Ce(he)),$e=R(Y,he)}return $e}}function ed(R){return La(function(H){return H=d(H,O(Hl())),Yl(function(Y){var he=this;return R(H,function($e){return t($e,he,Y)})})})}function _f(R,H){var Y=(H=H===Q?" ":Ve(H)).length;return Y<2?Y?_i(H,R):H:(Y=_i(H,Hf(R/ne(H))),W(H)?Il(me(Y),0,R).join(""):Y.slice(0,R))}function Vk(R,H,Y,he){var $e=1&H,Pe=wu(R);return function rt(){for(var ct=-1,pt=arguments.length,Rt=-1,St=he.length,Ht=Yn(St+pt),Qt=this&&this!==mn&&this instanceof rt?Pe:R;++Rt<St;)Ht[Rt]=he[Rt];for(;pt--;)Ht[Rt++]=arguments[++ct];return t(Qt,$e?Y:this,Ht)}}function Zg(R){return function(H,Y,he){return he&&typeof he!="number"&&Vi(H,Y,he)&&(Y=he=Q),H=Ba(H),Y===Q?(Y=H,H=0):Y=Ba(Y),function($e,Pe,rt,ct){for(var pt=-1,Rt=Xn(Hf((Pe-$e)/(rt||1)),0),St=Yn(Rt);Rt--;)St[ct?Rt:++pt]=$e,$e+=rt;return St}(H,Y,he=he===Q?H<Y?1:-1:Ba(he),R)}}function Cf(R){return function(H,Y){return typeof H=="string"&&typeof Y=="string"||(H=xo(H),Y=xo(Y)),R(H,Y)}}function Kg(R,H,Y,he,$e,Pe,rt,ct,pt,Rt){var St=8&H;return H|=St?32:64,4&(H&=~(St?64:32))||(H&=-4),Rt=[R,H,$e,St?Pe:Q,St?rt:Q,St?Q:Pe,St?Q:rt,ct,pt,Rt],Y=Y.apply(Q,Rt),ad(R)&&Up(Y,Rt),Y.placeholder=he,ap(Y,R,H)}function td(R){var H=Ic[R];return function(Y,he){if(Y=xo(Y),he=he==null?0:Si(ir(he),292)){var $e=(Hr(Y)+"e").split("e");return+(($e=(Hr(H($e[0]+"e"+(+$e[1]+he)))+"e").split("e"))[0]+"e"+(+$e[1]-he))}return H(Y)}}function Jg(R){return function(H){var Y,he,$e,Pe=Ii(H);return Pe==Ft?X(H):Pe==Oe?(Pe=H,he=-1,$e=Array(Pe.size),Pe.forEach(function(rt){$e[++he]=[rt,rt]}),$e):d(R(Y=H),function(rt){return[rt,Y[rt]]})}}function Na(R,H,Y,he,$e,Pe,rt,ct){var pt=2&H;if(!pt&&typeof R!="function")throw new _o(we);var Rt=he?he.length:0;Rt||(H&=-97,he=$e=Q),rt=rt===Q?rt:Xn(ir(rt),0),ct=ct===Q?ct:ir(ct),Rt-=$e?$e.length:0,64&H&&(nl=he,zl=$e,he=$e=Q);var St,Ht,Qt,Gt,nl,zl,Kt,Ml,jl,Nl,nn=pt?Q:Fd(R),Pl=[R,H,Y,he,$e,nl,zl,Pe,rt,ct];return nn&&(Ht=nn,Gt=(St=Pl)[1],nl=Ht[1],Pe=(zl=Gt|nl)<131,rt=nl==128&&Gt==8||nl==128&&Gt==256&&St[7].length<=Ht[8]||nl==384&&Ht[7].length<=Ht[8]&&Gt==8,(Pe||rt)&&(1&nl&&(St[2]=Ht[2],zl|=1&Gt?0:4),(Gt=Ht[3])&&(Qt=St[3],St[3]=Qt?Ci(Qt,Gt,Ht[4]):Gt,St[4]=Qt?ue(St[3],ge):Ht[4]),(Gt=Ht[5])&&(Qt=St[5],St[5]=Qt?tn(Qt,Gt,Ht[6]):Gt,St[6]=Qt?ue(St[5],ge):Ht[6]),(Gt=Ht[7])&&(St[7]=Gt),128&nl&&(St[8]=St[8]==null?Ht[8]:Si(St[8],Ht[8])),St[9]==null&&(St[9]=Ht[9]),St[0]=Ht[0],St[1]=zl)),R=Pl[0],H=Pl[1],Y=Pl[2],he=Pl[3],$e=Pl[4],!(ct=Pl[9]=Pl[9]===Q?pt?0:R.length:Xn(Pl[9]-Rt,0))&&24&H&&(H&=-25),Y=H&&H!=1?H==8||H==16?Bk(R,H,ct):H!=32&&H!=33||$e.length?wf.apply(Q,Pl):Vk(R,H,Y,he):(Ml=Y,jl=1&H,Nl=wu(Kt=R),function Mr(){return(this&&this!==mn&&this instanceof Mr?Nl:Kt).apply(jl?Ml:this,arguments)}),ap((nn?Wp:Up)(Y,Pl),R,H)}function ld(R,H,Y,he){return R===Q||fa(R,Cu[Y])&&!an.call(he,Y)?H:R}function Qg(R,H,Y,he,$e,Pe){return _n(R)&&_n(H)&&(Pe.set(H,R),Ho(R,H,Q,Qg,Pe),Pe.delete(H)),R}function Wk(R){return _u(R)?Q:R}function ep(R,H,Y,he,$e,Pe){var rt=1&Y,ct=R.length,pt=H.length;if(ct!=pt&&!(rt&&ct<pt))return!1;if(pt=Pe.get(R),pt&&Pe.get(H))return pt==H;var Rt=-1,St=!0,Ht=2&Y?new Jt:Q;for(Pe.set(R,H),Pe.set(H,R);++Rt<ct;){var Qt,Gt=R[Rt],nl=H[Rt];if(he&&(Qt=rt?he(nl,Gt,Rt,H,R,Pe):he(Gt,nl,Rt,R,H,Pe)),Qt!==Q){if(Qt)continue;St=!1;break}if(Ht){if(!v(H,function(zl,Kt){return!A(Ht,Kt)&&(Gt===zl||$e(Gt,zl,Y,he,Pe))&&Ht.push(Kt)})){St=!1;break}}else if(Gt!==nl&&!$e(Gt,nl,Y,he,Pe)){St=!1;break}}return Pe.delete(R),Pe.delete(H),St}function La(R){return zd(ip(R,Q,hp),R+"")}function rd(R){return yc(R,si,Md)}function nd(R){return yc(R,so,qp)}function $f(R){for(var H=R.name+"",Y=Fu[H],he=an.call(Fu,H)?Y.length:0;he--;){var $e=Y[he],Pe=$e.func;if(Pe==null||Pe==R)return $e.name}return H}function Cc(R){return(an.call(J,"placeholder")?J:R).placeholder}function Hl(){var R=(R=J.iteratee||md)===md?bc:R;return arguments.length?R(arguments[0],arguments[1]):R}function Sf(R,H){var Y,he=R.__data__;return((R=typeof(Y=H))=="string"||R=="number"||R=="symbol"||R=="boolean"?Y!=="__proto__":Y===null)?he[typeof H=="string"?"string":"hash"]:he.map}function id(R){for(var H=si(R),Y=H.length;Y--;){var he=H[Y],$e=R[he];H[Y]=[he,$e,rp($e)]}return H}function Bs(R,H){return H=H,H=(R=R)==null?Q:R[H],bo(H)?H:Q}function tp(R,H,Y){for(var he=-1,$e=(H=ml(H,R)).length,Pe=!1;++he<$e;){var rt=ua(H[he]);if(!(Pe=R!=null&&Y(R,rt)))break;R=R[rt]}return Pe||++he!=$e?Pe:!!($e=R==null?0:R.length)&&Df($e)&&Ha(rt,$e)&&(rr(R)||Us(R))}function lp(R){return typeof R.constructor!="function"||xu(R)?{}:Dc(Ef(R))}function qk(R){return rr(R)||Us(R)||!!(Lp&&R&&R[Lp])}function Ha(R,H){return!!(H=H??ce)&&(typeof R=="number"||Sl.test(R))&&-1<R&&R%1==0&&R<H}function Vi(R,H,Y){if(_n(Y)){var he=typeof H;return(he=="number"?Wi(Y)&&Ha(H,Y.length):he=="string"&&H in Y)&&fa(Y[H],R)}}function od(R,H){if(!rr(R)){var Y=typeof R;return Y=="number"||Y=="symbol"||Y=="boolean"||R==null||ao(R)||el.test(R)||!ol.test(R)||H!=null&&R in vn(H)}}function ad(R){var H=$f(R),Y=J[H];if(typeof Y=="function"&&H in lt.prototype)return R===Y?1:(Y=Fd(Y),Y&&R===Y[0])}function xu(R){var H=R&&R.constructor;return R===(typeof H=="function"&&H.prototype||Cu)}function rp(R){return R==R&&!_n(R)}function np(R,H){return function(Y){return Y!=null&&Y[R]===H&&(H!==Q||R in vn(Y))}}function ip(R,H,Y){return H=Xn(H===Q?R.length-1:H,0),function(){for(var he=arguments,$e=-1,Pe=Xn(he.length-H,0),rt=Yn(Pe);++$e<Pe;)rt[$e]=he[H+$e];$e=-1;for(var ct=Yn(H+1);++$e<H;)ct[$e]=he[$e];return ct[H]=Y(rt),t(R,this,ct)}}function op(R,H){return H.length<2?R:Oi(R,yt(H,0,-1))}function ap(R,H,Y){var he,$e,H=H+"";return zd(R,function(Pe,rt){var ct=rt.length;if(!ct)return Pe;var pt=ct-1;return rt[pt]=(1<ct?"& ":"")+rt[pt],rt=rt.join(2<ct?", ":" "),Pe.replace(An,`{
/* [wrapped with `+rt+`] */
`)}(H,(he=(H=(H=H).match(Br))?H[1].split(Ln):[],$e=Y,o(Ne,function(Pe){var rt="_."+Pe[0];$e&Pe[1]&&!f(he,rt)&&he.push(rt)}),he.sort())))}function sp(R){var H=0,Y=0;return function(){var he=eb(),$e=16-(he-Y);if(Y=he,0<$e){if(800<=++H)return arguments[0]}else H=0;return R.apply(Q,arguments)}}function If(R,H){var Y=-1,he=R.length,$e=he-1;for(H=H===Q?he:H;++Y<H;){var Pe=Ea(Y,$e),rt=R[Pe];R[Pe]=R[Y],R[Y]=rt}return R.length=H,R}function ua(R){if(typeof R=="string"||ao(R))return R;var H=R+"";return H=="0"&&1/R==-1/0?"-0":H}function Vs(R){if(R!=null){try{return Of.call(R)}catch(H){}try{return R+""}catch(H){}}return""}function cp(R){if(R instanceof lt)return R.clone();var H=new Ae(R.__wrapped__,R.__chain__);return H.__actions__=jn(R.__actions__),H.__index__=R.__index__,H.__values__=R.__values__,H}function up(R,H,Y){var he=R==null?0:R.length;return he?(Y=Y==null?0:ir(Y),Y<0&&(Y=Xn(he+Y,0)),_(R,Hl(H,3),Y)):-1}function fp(R,H,Y){var he=R==null?0:R.length;if(!he)return-1;var $e=he-1;return Y!==Q&&($e=ir(Y),$e=Y<0?Xn(he+$e,0):Si($e,he-1)),_(R,Hl(H,3),$e,!0)}function hp(R){return(R==null?0:R.length)?vr(R,1):[]}function dp(R){return R&&R.length?R[0]:Q}function wo(R){var H=R==null?0:R.length;return H?R[H-1]:Q}function mp(R,H){return R&&R.length&&H&&H.length?jo(R,H):R}function sd(R){return R==null?R:lb.call(R)}function cd(R){if(!R||!R.length)return[];var H=0;return R=u(R,function(Y){return On(Y)&&(H=Xn(Y.length,H),1)}),T(H,function(Y){return d(R,D(Y))})}function gp(R,H){return!R||!R.length?[]:(R=cd(R),H==null?R:d(R,function(Y){return t(H,Q,Y)}))}function pp(R){return R=J(R),R.__chain__=!0,R}function Tf(R,H){return H(R)}function vp(R,H){return(rr(R)?o:fs)(R,Hl(H,3))}function yp(R,H){return(rr(R)?a:Bp)(R,Hl(H,3))}function Rf(R,H){return(rr(R)?d:gn)(R,Hl(H,3))}function kp(R,H,Y){return H=Y?Q:H,H=R&&H==null?R.length:H,Na(R,128,Q,Q,Q,Q,H)}function bp(R,H){var Y;if(typeof H!="function")throw new _o(we);return R=ir(R),function(){return 0<--R&&(Y=H.apply(this,arguments)),R<=1&&(H=Q),Y}}function wp(R,H,Y){function he(jl){var Nl=pt,nn=Rt;return pt=Rt=Q,nl=jl,Ht=R.apply(nn,Nl)}function $e(jl){var Nl=jl-Gt;return Gt===Q||H<=Nl||Nl<0||Kt&&St<=jl-nl}function Pe(){var jl,Nl=Vf();return $e(Nl)?rt(Nl):void(Qt=Du(Pe,(Nl=H-((jl=Nl)-Gt),Kt?Si(Nl,St-(jl-nl)):Nl)))}function rt(jl){return Qt=Q,Ml&&pt?he(jl):(pt=Rt=Q,Ht)}function ct(){var jl=Vf(),Nl=$e(jl);if(pt=arguments,Rt=this,Gt=jl,Nl){if(Qt===Q)return nl=Nl=Gt,Qt=Du(Pe,H),zl?he(Nl):Ht;if(Kt)return Qt=Du(Pe,H),he(Gt)}return Qt===Q&&(Qt=Du(Pe,H)),Ht}var pt,Rt,St,Ht,Qt,Gt,nl=0,zl=!1,Kt=!1,Ml=!0;if(typeof R!="function")throw new _o(we);return H=xo(H)||0,_n(Y)&&(zl=!!Y.leading,Kt="maxWait"in Y,St=Kt?Xn(xo(Y.maxWait)||0,H):St,Ml="trailing"in Y?!!Y.trailing:Ml),ct.cancel=function(){Qt!==Q&&sb(Qt),nl=0,pt=Gt=Rt=Qt=Q},ct.flush=function(){return Qt===Q?Ht:rt(Vf())},ct}function Ff(R,H){if(typeof R!="function"||H!=null&&typeof H!="function")throw new _o(we);var Y=function(){var he=arguments,$e=H?H.apply(this,he):he[0],Pe=Y.cache;return Pe.has($e)?Pe.get($e):(he=R.apply(this,he),Y.cache=Pe.set($e,he)||Pe,he)};return Y.cache=new(Ff.Cache||dl),Y}function Mf(R){if(typeof R!="function")throw new _o(we);return function(){var H=arguments;switch(H.length){case 0:return!R.call(this);case 1:return!R.call(this,H[0]);case 2:return!R.call(this,H[0],H[1]);case 3:return!R.call(this,H[0],H[1],H[2])}return!R.apply(this,H)}}function fa(R,H){return R===H||R!=R&&H!=H}function Wi(R){return R!=null&&Df(R.length)&&!ja(R)}function On(R){return Rn(R)&&Wi(R)}function ud(R){if(!Rn(R))return!1;var H=In(R);return H==wt||H=="[object DOMException]"||typeof R.message=="string"&&typeof R.name=="string"&&!_u(R)}function ja(R){return _n(R)?(R=In(R),R==ot||R==xt||R=="[object AsyncFunction]"||R=="[object Proxy]"):!1}function xp(R){return typeof R=="number"&&R==ir(R)}function Df(R){return typeof R=="number"&&-1<R&&R%1==0&&R<=ce}function _n(R){var H=typeof R;return R!=null&&(H=="object"||H=="function")}function Rn(R){return R!=null&&typeof R=="object"}function _p(R){return typeof R=="number"||Rn(R)&&In(R)==Se}function _u(R){return!Rn(R)||In(R)!=oe?!1:(R=Ef(R),R===null?!0:(R=an.call(R,"constructor")&&R.constructor,typeof R=="function"&&R instanceof R&&Of.call(R)==Yk))}function Af(R){return typeof R=="string"||!rr(R)&&Rn(R)&&In(R)==Xe}function ao(R){return typeof R=="symbol"||Rn(R)&&In(R)==Le}function Cp(R){if(!R)return[];if(Wi(R))return(Af(R)?me:jn)(R);if($u&&R[$u])return function(Y){for(var he,$e=[];!(he=Y.next()).done;)$e.push(he.value);return $e}(R[$u]());var H=Ii(R);return(H==Ft?X:H==Oe?pe:$c)(R)}function Ba(R){return R?(R=xo(R))!==1/0&&R!==-1/0?R==R?R:0:17976931348623157e292*(R<0?-1:1):R===0?R:0}function ir(R){var H=Ba(R),R=H%1;return H==H?R?H-R:H:0}function $p(R){return R?wr(ir(R),0,ye):0}function xo(R){if(typeof R=="number")return R;if(ao(R))return fe;if(_n(R)&&(R=_n(H=typeof R.valueOf=="function"?R.valueOf():R)?H+"":H),typeof R!="string")return R===0?R:+R;R=R.replace(en,"");var H=di.test(R);return H||ul.test(R)?ss(R.slice(2),H?2:8):$n.test(R)?fe:+R}function Sp(R){return $i(R,so(R))}function Hr(R){return R==null?"":Ve(R)}function fd(R,H,Y){return H=R==null?Q:Oi(R,H),H===Q?Y:H}function hd(R,H){return R!=null&&tp(R,H,kc)}function si(R){return(Wi(R)?Rl:gi)(R)}function so(R){return Wi(R)?Rl(R,!0):Lr(R)}function Ip(R,H){if(R==null)return{};var Y=d(nd(R),function(he){return[he]});return H=Hl(H),Pa(R,Y,function(he,$e){return H(he,$e[0])})}function $c(R){return R==null?[]:z(R,si(R))}function Tp(R){return Ld(Hr(R).toLowerCase())}function Rp(R){return(R=Hr(R))&&R.replace(Gr,V).replace(Ra,"")}function Fp(R,H,Y){return R=Hr(R),(H=Y?Q:H)===Q?(Y=R,vu.test(Y)?R.match(Ns)||[]:R.match(ri)||[]):R.match(H)||[]}function dd(R){return function(){return R}}function qi(R){return R}function md(R){return bc(typeof R=="function"?R:Xr(R,1))}function gd(R,H,Y){var he=si(H),$e=za(H,he);Y!=null||_n(H)&&($e.length||!he.length)||(Y=H,H=R,R=this,$e=za(H,si(H)));var Pe=!(_n(Y)&&"chain"in Y&&!Y.chain),rt=ja(R);return o($e,function(ct){var pt=H[ct];R[ct]=pt,rt&&(R.prototype[ct]=function(){var Rt=this.__chain__;if(Pe||Rt){var St=R(this.__wrapped__);return(St.__actions__=jn(this.__actions__)).push({func:pt,args:arguments,thisArg:R}),St.__chain__=Rt,St}return pt.apply(R,p([this.value()],arguments))})}),R}function pd(){}function Mp(R){return od(R)?D(ua(R)):(H=R,function(Y){return Oi(Y,H)});var H}function vd(){return[]}function yd(){return!1}var Yn=(de=de==null?mn:se.defaults(mn.Object(),de,se.pick(mn,yu))).Array,Sc=de.Date,Dp=de.Error,Ap=de.Function,Ic=de.Math,vn=de.Object,kd=de.RegExp,Uk=de.String,_o=de.TypeError,zf=Yn.prototype,bd=Ap.prototype,Cu=vn.prototype,Tc=de["__core-js_shared__"],Of=bd.toString,an=Cu.hasOwnProperty,Gk=0,zp=(Hd=/[^.]+$/.exec(Tc&&Tc.keys&&Tc.keys.IE_PROTO||""))?"Symbol(src)_1."+Hd:"",Op=Cu.toString,Yk=Of.call(vn),Xk=mn._,Zk=kd("^"+Of.call(an).replace(lr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rc=Lo?de.Buffer:Q,ha=de.Symbol,Pf=de.Uint8Array,Pp=Rc?Rc.allocUnsafe:Q,Ef=te(vn.getPrototypeOf,vn),Ep=vn.create,Np=Cu.propertyIsEnumerable,Nf=zf.splice,Lp=ha?ha.isConcatSpreadable:Q,$u=ha?ha.iterator:Q,Ws=ha?ha.toStringTag:Q,Lf=function(){try{var R=Bs(vn,"defineProperty");return R({},"",{}),R}catch(H){}}(),wd=de.clearTimeout!==mn.clearTimeout&&de.clearTimeout,xd=Sc&&Sc.now!==mn.Date.now&&Sc.now,_d=de.setTimeout!==mn.setTimeout&&de.setTimeout,Hf=Ic.ceil,jf=Ic.floor,Cd=vn.getOwnPropertySymbols,$d=Rc?Rc.isBuffer:Q,Kk=de.isFinite,Jk=zf.join,Qk=te(vn.keys,vn),Xn=Ic.max,Si=Ic.min,eb=Sc.now,tb=de.parseInt,Hp=Ic.random,lb=zf.reverse,Su=Bs(de,"DataView"),Iu=Bs(de,"Map"),Tu=Bs(de,"Promise"),Fc=Bs(de,"Set"),qs=Bs(de,"WeakMap"),Ru=Bs(vn,"create"),Bf=qs&&new qs,Fu={},rb=Vs(Su),nb=Vs(Iu),ib=Vs(Tu),ob=Vs(Fc),ab=Vs(qs),Mc=ha?ha.prototype:Q,Mu=Mc?Mc.valueOf:Q,jp=Mc?Mc.toString:Q,Dc=function(R){return _n(R)?Ep?Ep(R):(Sd.prototype=R,R=new Sd,Sd.prototype=Q,R):{}};function Sd(){}J.templateSettings={escape:Ct,evaluate:Lt,interpolate:Dt,variable:"",imports:{_:J}},(J.prototype=He.prototype).constructor=J,(Ae.prototype=Dc(He.prototype)).constructor=Ae,(lt.prototype=Dc(He.prototype)).constructor=lt,vt.prototype.clear=function(){this.__data__=Ru?Ru(null):{},this.size=0},vt.prototype.delete=function(R){return R=this.has(R)&&delete this.__data__[R],this.size-=R?1:0,R},vt.prototype.get=function(R){var H=this.__data__;if(Ru){var Y=H[R];return Y===ie?Q:Y}return an.call(H,R)?H[R]:Q},vt.prototype.has=function(R){var H=this.__data__;return Ru?H[R]!==Q:an.call(H,R)},vt.prototype.set=function(R,H){var Y=this.__data__;return this.size+=this.has(R)?0:1,Y[R]=Ru&&H===Q?ie:H,this},bt.prototype.clear=function(){this.__data__=[],this.size=0},bt.prototype.delete=function(R){var H=this.__data__;return!((R=Ir(H,R))<0)&&(R==H.length-1?H.pop():Nf.call(H,R,1),--this.size,!0)},bt.prototype.get=function(R){var H=this.__data__;return(R=Ir(H,R))<0?Q:H[R][1]},bt.prototype.has=function(R){return-1<Ir(this.__data__,R)},bt.prototype.set=function(R,H){var Y=this.__data__,he=Ir(Y,R);return he<0?(++this.size,Y.push([R,H])):Y[he][1]=H,this},dl.prototype.clear=function(){this.size=0,this.__data__={hash:new vt,map:new(Iu||bt),string:new vt}},dl.prototype.delete=function(R){return R=Sf(this,R).delete(R),this.size-=R?1:0,R},dl.prototype.get=function(R){return Sf(this,R).get(R)},dl.prototype.has=function(R){return Sf(this,R).has(R)},dl.prototype.set=function(R,H){var Y=Sf(this,R),he=Y.size;return Y.set(R,H),this.size+=Y.size==he?0:1,this},Jt.prototype.add=Jt.prototype.push=function(R){return this.__data__.set(R,ie),this},Jt.prototype.has=function(R){return this.__data__.has(R)},Cl.prototype.clear=function(){this.__data__=new bt,this.size=0},Cl.prototype.delete=function(R){var H=this.__data__,R=H.delete(R);return this.size=H.size,R},Cl.prototype.get=function(R){return this.__data__.get(R)},Cl.prototype.has=function(R){return this.__data__.has(R)},Cl.prototype.set=function(R,H){var Y=this.__data__;if(Y instanceof bt){var he=Y.__data__;if(!Iu||he.length<199)return he.push([R,H]),this.size=++Y.size,this;Y=this.__data__=new dl(he)}return Y.set(R,H),this.size=Y.size,this};var fs=Wg(Gl),Bp=Wg(mi,!0),Id=qg(),Vp=qg(!0),Wp=Bf?function(R,H){return Bf.set(R,H),R}:qi,Td=Lf?function(R,H){return Lf(R,"toString",{configurable:!0,enumerable:!1,value:dd(H),writable:!0})}:qi,Rd=Yl,sb=wd||function(R){return mn.clearTimeout(R)},cb=Fc&&1/pe(new Fc([,-0]))[1]==1/0?function(R){return new Fc(R)}:pd,Fd=Bf?function(R){return Bf.get(R)}:pd,Md=Cd?function(R){return R==null?[]:(R=vn(R),u(Cd(R),function(H){return Np.call(R,H)}))}:vd,qp=Cd?function(R){for(var H=[];R;)p(H,Md(R)),R=Ef(R);return H}:vd,Ii=In;(Su&&Ii(new Su(new ArrayBuffer(1)))!=Ze||Iu&&Ii(new Iu)!=Ft||Tu&&Ii(Tu.resolve())!=be||Fc&&Ii(new Fc)!=Oe||qs&&Ii(new qs)!=Ee)&&(Ii=function(R){var H=In(R),R=H==oe?R.constructor:Q,R=R?Vs(R):"";if(R)switch(R){case rb:return Ze;case nb:return Ft;case ib:return be;case ob:return Oe;case ab:return Ee}return H});var Dd,Ad,ub=Tc?ja:yd,Up=sp(Wp),Du=_d||function(R,H){return mn.setTimeout(R,H)},zd=sp(Td),Gp=(Ad=(Dd=Ff(Dd=function(R){var H=[];return Al.test(R)&&H.push(""),R.replace(Vl,function(Y,he,$e,Pe){H.push($e?Pe.replace(dn,"$1"):he||Y)}),H},function(R){return Ad.size===500&&Ad.clear(),R})).cache,Dd),fb=Yl(function(R,H){return On(R)?$r(R,vr(H,1,On,!0)):[]}),hb=Yl(function(R,H){var Y=wo(H);return On(Y)&&(Y=Q),On(R)?$r(R,vr(H,1,On,!0),Hl(Y,2)):[]}),db=Yl(function(R,H){var Y=wo(H);return On(Y)&&(Y=Q),On(R)?$r(R,vr(H,1,On,!0),Q,Y):[]}),mb=Yl(function(R){var H=d(R,vl);return H.length&&H[0]===R[0]?sa(H):[]}),gb=Yl(function(R){var H=wo(R),Y=d(R,vl);return H===wo(Y)?H=Q:Y.pop(),Y.length&&Y[0]===R[0]?sa(Y,Hl(H,2)):[]}),pb=Yl(function(R){var H=wo(R),Y=d(R,vl);return(H=typeof H=="function"?H:Q)&&Y.pop(),Y.length&&Y[0]===R[0]?sa(Y,Q,H):[]}),vb=Yl(mp),yb=La(function(R,H){var Y=R==null?0:R.length,he=Yr(R,H);return us(R,d(H,function($e){return Ha($e,Y)?+$e:$e}).sort(Gn)),he}),kb=Yl(function(R){return Ge(vr(R,1,On,!0))}),bb=Yl(function(R){var H=wo(R);return On(H)&&(H=Q),Ge(vr(R,1,On,!0),Hl(H,2))}),wb=Yl(function(R){var H=typeof(H=wo(R))=="function"?H:Q;return Ge(vr(R,1,On,!0),Q,H)}),xb=Yl(function(R,H){return On(R)?$r(R,H):[]}),_b=Yl(function(R){return Ot(u(R,On))}),Cb=Yl(function(R){var H=wo(R);return On(H)&&(H=Q),Ot(u(R,On),Hl(H,2))}),$b=Yl(function(R){var H=typeof(H=wo(R))=="function"?H:Q;return Ot(u(R,On),Q,H)}),Sb=Yl(cd),Ib=Yl(function(R){var H=R.length,H=typeof(H=1<H?R[H-1]:Q)=="function"?(R.pop(),H):Q;return gp(R,H)}),Tb=La(function(R){function H(Pe){return Yr(Pe,R)}var Y=R.length,he=Y?R[0]:0,$e=this.__wrapped__;return!(1<Y||this.__actions__.length)&&$e instanceof lt&&Ha(he)?(($e=$e.slice(he,+he+(Y?1:0))).__actions__.push({func:Tf,args:[H],thisArg:Q}),new Ae($e,this.__chain__).thru(function(Pe){return Y&&!Pe.length&&Pe.push(Q),Pe})):this.thru(H)}),Rb=ai(function(R,H,Y){an.call(R,Y)?++R[Y]:yr(R,Y,1)}),Fb=Gg(up),Mb=Gg(fp),Db=ai(function(R,H,Y){an.call(R,Y)?R[Y].push(H):yr(R,Y,[H])}),Ab=Yl(function(R,H,Y){var he=-1,$e=typeof H=="function",Pe=Wi(R)?Yn(R.length):[];return fs(R,function(rt){Pe[++he]=$e?t(H,rt,Y):ca(rt,H,Y)}),Pe}),zb=ai(function(R,H,Y){yr(R,Y,H)}),Ob=ai(function(R,H,Y){R[Y?0:1].push(H)},function(){return[[],[]]}),Pb=Yl(function(R,H){if(R==null)return[];var Y=H.length;return 1<Y&&Vi(R,H[0],H[1])?H=[]:2<Y&&Vi(H[0],H[1],H[2])&&(H=[H[0]]),vi(R,vr(H,1),[])}),Vf=xd||function(){return mn.Date.now()},Od=Yl(function(R,H,Y){var he,$e=1;return Y.length&&(he=ue(Y,Cc(Od)),$e|=32),Na(R,$e,H,Y,he)}),Yp=Yl(function(R,H,Y){var he,$e=3;return Y.length&&(he=ue(Y,Cc(Yp)),$e|=32),Na(H,$e,R,Y,he)}),Eb=Yl(function(R,H){return pr(R,1,H)}),Nb=Yl(function(R,H,Y){return pr(R,xo(H)||0,Y)});Ff.Cache=dl;var Pd,Lb=Rd(function(R,H){var Y=(H=H.length==1&&rr(H[0])?d(H[0],O(Hl())):d(vr(H,1),O(Hl()))).length;return Yl(function(he){for(var $e=-1,Pe=Si(he.length,Y);++$e<Pe;)he[$e]=H[$e].call(this,he[$e]);return t(R,this,he)})}),Ed=Yl(function(R,H){var Y=ue(H,Cc(Ed));return Na(R,32,Q,H,Y)}),Xp=Yl(function(R,H){var Y=ue(H,Cc(Xp));return Na(R,64,Q,H,Y)}),Hb=La(function(R,H){return Na(R,256,Q,Q,Q,H)}),jb=Cf(Hs),Bb=Cf(function(R,H){return H<=R}),Us=Oa(function(){return arguments}())?Oa:function(R){return Rn(R)&&an.call(R,"callee")&&!Np.call(R,"callee")},rr=Yn.isArray,Vb=cs?O(cs):function(R){return Rn(R)&&In(R)==nt},hs=$d||yd,Wb=Ls?O(Ls):function(R){return Rn(R)&&In(R)==it},qb=B?O(B):function(R){return Rn(R)&&Ii(R)==Ft},Nd=Z?O(Z):function(R){return Rn(R)&&In(R)==Te},Ub=ae?O(ae):function(R){return Rn(R)&&Ii(R)==Oe},Ac=M?O(M):function(R){return Rn(R)&&Df(R.length)&&!!Vr[In(R)]},Gb=Cf(pi),Yb=Cf(function(R,H){return R<=H}),Xb=xc(function(R,H){if(xu(H)||Wi(H))$i(H,si(H),R);else for(var Y in H)an.call(H,Y)&&Fl(R,Y,H[Y])}),Zp=xc(function(R,H){$i(H,so(H),R)}),Au=xc(function(R,H,Y,he){$i(H,so(H),R,he)}),Zb=xc(function(R,H,Y,he){$i(H,si(H),R,he)}),Kb=La(Yr),Jb=Yl(function(R){return R.push(Q,ld),t(Au,Q,R)}),Qb=Yl(function(R){return R.push(Q,Qg),t(Kp,Q,R)}),ew=Xg(function(R,H,Y){R[H]=Y},dd(qi)),tw=Xg(function(R,H,Y){an.call(R,H)?R[H].push(Y):R[H]=[Y]},Hl),lw=Yl(ca),rw=xc(function(R,H,Y){Ho(R,H,Y)}),Kp=xc(function(R,H,Y,he){Ho(R,H,Y,he)}),nw=La(function(R,H){var Y={};if(R==null)return Y;var he=!1;H=d(H,function(Pe){return Pe=ml(Pe,R),he=he||1<Pe.length,Pe}),$i(R,nd(R),Y),he&&(Y=Xr(Y,7,Wk));for(var $e=H.length;$e--;)dt(Y,H[$e]);return Y}),iw=La(function(R,H){return R==null?{}:Pa(Y=R,H,function(he,$e){return hd(Y,$e)});var Y}),Jp=Jg(si),Qp=Jg(so),ow=_c(function(R,H,Y){return H=H.toLowerCase(),R+(Y?Tp(H):H)}),aw=_c(function(R,H,Y){return R+(Y?"-":"")+H.toLowerCase()}),sw=_c(function(R,H,Y){return R+(Y?" ":"")+H.toLowerCase()}),cw=Ug("toLowerCase"),uw=_c(function(R,H,Y){return R+(Y?"_":"")+H.toLowerCase()}),fw=_c(function(R,H,Y){return R+(Y?" ":"")+Ld(H)}),hw=_c(function(R,H,Y){return R+(Y?" ":"")+H.toUpperCase()}),Ld=Ug("toUpperCase"),e0=Yl(function(R,H){try{return t(R,Q,H)}catch(Y){return ud(Y)?Y:new Dp(Y)}}),bd=La(function(R,H){return o(H,function(Y){Y=ua(Y),yr(R,Y,Od(R[Y],R))}),R}),Hd=Yg(),Rc=Yg(!0),Sc=Yl(function(R,H){return function(Y){return ca(Y,R,H)}}),de=Yl(function(R,H){return function(Y){return ca(R,Y,H)}}),ha=ed(d),Mc=ed(s),wd=ed(v),Su=Zg(),Tu=Zg(!0),qs=xf(function(R,H){return R+H},0),Tc=td("ceil"),_d=xf(function(R,H){return R/H},1),Td=td("floor"),xd=xf(function(R,H){return R*H},1),Rd=td("round"),$d=xf(function(R,H){return R-H},0);return J.after=function(R,H){if(typeof H!="function")throw new _o(we);return R=ir(R),function(){if(--R<1)return H.apply(this,arguments)}},J.ary=kp,J.assign=Xb,J.assignIn=Zp,J.assignInWith=Au,J.assignWith=Zb,J.at=Kb,J.before=bp,J.bind=Od,J.bindAll=bd,J.bindKey=Yp,J.castArray=function(){if(!arguments.length)return[];var R=arguments[0];return rr(R)?R:[R]},J.chain=pp,J.chunk=function(R,H,Y){H=(Y?Vi(R,H,Y):H===Q)?1:Xn(ir(H),0);var he=R==null?0:R.length;if(!he||H<1)return[];for(var $e=0,Pe=0,rt=Yn(Hf(he/H));$e<he;)rt[Pe++]=yt(R,$e,$e+=H);return rt},J.compact=function(R){for(var H=-1,Y=R==null?0:R.length,he=0,$e=[];++H<Y;){var Pe=R[H];Pe&&($e[he++]=Pe)}return $e},J.concat=function(){var R=arguments.length;if(!R)return[];for(var H=Yn(R-1),Y=arguments[0],he=R;he--;)H[he-1]=arguments[he];return p(rr(Y)?jn(Y):[Y],vr(H,1))},J.cond=function(R){var H=R==null?0:R.length,Y=Hl();return R=H?d(R,function(he){if(typeof he[1]!="function")throw new _o(we);return[Y(he[0]),he[1]]}):[],Yl(function(he){for(var $e=-1;++$e<H;){var Pe=R[$e];if(t(Pe[0],this,he))return t(Pe[1],this,he)}})},J.conforms=function(R){return H=Xr(R,1),Y=si(H),function(he){return rn(he,H,Y)};var H,Y},J.constant=dd,J.countBy=Rb,J.create=function(R,H){return R=Dc(R),H==null?R:Un(R,H)},J.curry=function R(H,Y,he){return Y=Na(H,8,Q,Q,Q,Q,Q,Y=he?Q:Y),Y.placeholder=R.placeholder,Y},J.curryRight=function R(H,Y,he){return Y=Na(H,16,Q,Q,Q,Q,Q,Y=he?Q:Y),Y.placeholder=R.placeholder,Y},J.debounce=wp,J.defaults=Jb,J.defaultsDeep=Qb,J.defer=Eb,J.delay=Nb,J.difference=fb,J.differenceBy=hb,J.differenceWith=db,J.drop=function(R,H,Y){var he=R==null?0:R.length;return he?yt(R,(H=Y||H===Q?1:ir(H))<0?0:H,he):[]},J.dropRight=function(R,H,Y){var he=R==null?0:R.length;return he?yt(R,0,(H=he-(H=Y||H===Q?1:ir(H)))<0?0:H):[]},J.dropRightWhile=function(R,H){return R&&R.length?$t(R,Hl(H,3),!0,!0):[]},J.dropWhile=function(R,H){return R&&R.length?$t(R,Hl(H,3),!0):[]},J.fill=function(R,H,Y,he){var $e=R==null?0:R.length;return $e?(Y&&typeof Y!="number"&&Vi(R,H,Y)&&(Y=0,he=$e),function(Pe,rt,ct,pt){var Rt=Pe.length;for((ct=ir(ct))<0&&(ct=Rt<-ct?0:Rt+ct),(pt=pt===Q||Rt<pt?Rt:ir(pt))<0&&(pt+=Rt),pt=pt<ct?0:$p(pt);ct<pt;)Pe[ct++]=rt;return Pe}(R,H,Y,he)):[]},J.filter=function(R,H){return(rr(R)?u:Tl)(R,Hl(H,3))},J.flatMap=function(R,H){return vr(Rf(R,H),1)},J.flatMapDeep=function(R,H){return vr(Rf(R,H),1/0)},J.flatMapDepth=function(R,H,Y){return Y=Y===Q?1:ir(Y),vr(Rf(R,H),Y)},J.flatten=hp,J.flattenDeep=function(R){return(R==null?0:R.length)?vr(R,1/0):[]},J.flattenDepth=function(R,H){return(R==null?0:R.length)?vr(R,H=H===Q?1:ir(H)):[]},J.flip=function(R){return Na(R,512)},J.flow=Hd,J.flowRight=Rc,J.fromPairs=function(R){for(var H=-1,Y=R==null?0:R.length,he={};++H<Y;){var $e=R[H];he[$e[0]]=$e[1]}return he},J.functions=function(R){return R==null?[]:za(R,si(R))},J.functionsIn=function(R){return R==null?[]:za(R,so(R))},J.groupBy=Db,J.initial=function(R){return(R==null?0:R.length)?yt(R,0,-1):[]},J.intersection=mb,J.intersectionBy=gb,J.intersectionWith=pb,J.invert=ew,J.invertBy=tw,J.invokeMap=Ab,J.iteratee=md,J.keyBy=zb,J.keys=si,J.keysIn=so,J.map=Rf,J.mapKeys=function(R,H){var Y={};return H=Hl(H,3),Gl(R,function(he,$e,Pe){yr(Y,H(he,$e,Pe),he)}),Y},J.mapValues=function(R,H){var Y={};return H=Hl(H,3),Gl(R,function(he,$e,Pe){yr(Y,$e,H(he,$e,Pe))}),Y},J.matches=function(R){return xi(Xr(R,1))},J.matchesProperty=function(R,H){return Tr(R,Xr(H,1))},J.memoize=Ff,J.merge=rw,J.mergeWith=Kp,J.method=Sc,J.methodOf=de,J.mixin=gd,J.negate=Mf,J.nthArg=function(R){return R=ir(R),Yl(function(H){return Tn(H,R)})},J.omit=nw,J.omitBy=function(R,H){return Ip(R,Mf(Hl(H)))},J.once=function(R){return bp(2,R)},J.orderBy=function(R,H,Y,he){return R==null?[]:(rr(H)||(H=H==null?[]:[H]),rr(Y=he?Q:Y)||(Y=Y==null?[]:[Y]),vi(R,H,Y))},J.over=ha,J.overArgs=Lb,J.overEvery=Mc,J.overSome=wd,J.partial=Ed,J.partialRight=Xp,J.partition=Ob,J.pick=iw,J.pickBy=Ip,J.property=Mp,J.propertyOf=function(R){return function(H){return R==null?Q:Oi(R,H)}},J.pull=vb,J.pullAll=mp,J.pullAllBy=function(R,H,Y){return R&&R.length&&H&&H.length?jo(R,H,Hl(Y,2)):R},J.pullAllWith=function(R,H,Y){return R&&R.length&&H&&H.length?jo(R,H,Q,Y):R},J.pullAt=yb,J.range=Su,J.rangeRight=Tu,J.rearg=Hb,J.reject=function(R,H){return(rr(R)?u:Tl)(R,Mf(Hl(H,3)))},J.remove=function(R,H){var Y=[];if(!R||!R.length)return Y;var he=-1,$e=[],Pe=R.length;for(H=Hl(H,3);++he<Pe;){var rt=R[he];H(rt,he,R)&&(Y.push(rt),$e.push(he))}return us(R,$e),Y},J.rest=function(R,H){if(typeof R!="function")throw new _o(we);return Yl(R,H=H===Q?H:ir(H))},J.reverse=sd,J.sampleSize=function(R,H,Y){return H=(Y?Vi(R,H,Y):H===Q)?1:ir(H),(rr(R)?fl:De)(R,H)},J.set=function(R,H,Y){return R==null?R:je(R,H,Y)},J.setWith=function(R,H,Y,he){return he=typeof he=="function"?he:Q,R==null?R:je(R,H,Y,he)},J.shuffle=function(R){return(rr(R)?Wt:tt)(R)},J.slice=function(R,H,Y){var he=R==null?0:R.length;return he?(Y=Y&&typeof Y!="number"&&Vi(R,H,Y)?(H=0,he):(H=H==null?0:ir(H),Y===Q?he:ir(Y)),yt(R,H,Y)):[]},J.sortBy=Pb,J.sortedUniq=function(R){return R&&R.length?hl(R):[]},J.sortedUniqBy=function(R,H){return R&&R.length?hl(R,Hl(H,2)):[]},J.split=function(R,H,Y){return Y&&typeof Y!="number"&&Vi(R,H,Y)&&(H=Y=Q),(Y=Y===Q?ye:Y>>>0)?(R=Hr(R))&&(typeof H=="string"||H!=null&&!Nd(H))&&!(H=Ve(H))&&W(R)?Il(me(R),0,Y):R.split(H,Y):[]},J.spread=function(R,H){if(typeof R!="function")throw new _o(we);return H=H==null?0:Xn(ir(H),0),Yl(function(Y){var he=Y[H],Y=Il(Y,0,H);return he&&p(Y,he),t(R,this,Y)})},J.tail=function(R){var H=R==null?0:R.length;return H?yt(R,1,H):[]},J.take=function(R,H,Y){return R&&R.length?yt(R,0,(H=Y||H===Q?1:ir(H))<0?0:H):[]},J.takeRight=function(R,H,Y){var he=R==null?0:R.length;return he?yt(R,(H=he-(H=Y||H===Q?1:ir(H)))<0?0:H,he):[]},J.takeRightWhile=function(R,H){return R&&R.length?$t(R,Hl(H,3),!1,!0):[]},J.takeWhile=function(R,H){return R&&R.length?$t(R,Hl(H,3)):[]},J.tap=function(R,H){return H(R),R},J.throttle=function(R,H,Y){var he=!0,$e=!0;if(typeof R!="function")throw new _o(we);return _n(Y)&&(he="leading"in Y?!!Y.leading:he,$e="trailing"in Y?!!Y.trailing:$e),wp(R,H,{leading:he,maxWait:H,trailing:$e})},J.thru=Tf,J.toArray=Cp,J.toPairs=Jp,J.toPairsIn=Qp,J.toPath=function(R){return rr(R)?d(R,ua):ao(R)?[R]:jn(Gp(Hr(R)))},J.toPlainObject=Sp,J.transform=function(R,H,Y){var he,$e=rr(R),Pe=$e||hs(R)||Ac(R);return H=Hl(H,4),Y==null&&(he=R&&R.constructor,Y=Pe?$e?new he:[]:_n(R)&&ja(he)?Dc(Ef(R)):{}),(Pe?o:Gl)(R,function(rt,ct,pt){return H(Y,rt,ct,pt)}),Y},J.unary=function(R){return kp(R,1)},J.union=kb,J.unionBy=bb,J.unionWith=wb,J.uniq=function(R){return R&&R.length?Ge(R):[]},J.uniqBy=function(R,H){return R&&R.length?Ge(R,Hl(H,2)):[]},J.uniqWith=function(R,H){return H=typeof H=="function"?H:Q,R&&R.length?Ge(R,Q,H):[]},J.unset=function(R,H){return R==null||dt(R,H)},J.unzip=cd,J.unzipWith=gp,J.update=function(R,H,Y){return R==null?R:st(R,H,Ut(Y))},J.updateWith=function(R,H,Y,he){return he=typeof he=="function"?he:Q,R==null?R:st(R,H,Ut(Y),he)},J.values=$c,J.valuesIn=function(R){return R==null?[]:z(R,so(R))},J.without=xb,J.words=Fp,J.wrap=function(R,H){return Ed(Ut(H),R)},J.xor=_b,J.xorBy=Cb,J.xorWith=$b,J.zip=Sb,J.zipObject=function(R,H){return rl(R||[],H||[],Fl)},J.zipObjectDeep=function(R,H){return rl(R||[],H||[],je)},J.zipWith=Ib,J.entries=Jp,J.entriesIn=Qp,J.extend=Zp,J.extendWith=Au,gd(J,J),J.add=qs,J.attempt=e0,J.camelCase=ow,J.capitalize=Tp,J.ceil=Tc,J.clamp=function(R,H,Y){return Y===Q&&(Y=H,H=Q),Y!==Q&&(Y=(Y=xo(Y))==Y?Y:0),H!==Q&&(H=(H=xo(H))==H?H:0),wr(xo(R),H,Y)},J.clone=function(R){return Xr(R,4)},J.cloneDeep=function(R){return Xr(R,5)},J.cloneDeepWith=function(R,H){return Xr(R,5,H=typeof H=="function"?H:Q)},J.cloneWith=function(R,H){return Xr(R,4,H=typeof H=="function"?H:Q)},J.conformsTo=function(R,H){return H==null||rn(R,H,si(H))},J.deburr=Rp,J.defaultTo=function(R,H){return R==null||R!=R?H:R},J.divide=_d,J.endsWith=function(R,H,Y){R=Hr(R),H=Ve(H);var he=R.length,he=Y=Y===Q?he:wr(ir(Y),0,he);return 0<=(Y-=H.length)&&R.slice(Y,he)==H},J.eq=fa,J.escape=function(R){return(R=Hr(R))&&ht.test(R)?R.replace(Re,U):R},J.escapeRegExp=function(R){return(R=Hr(R))&&hn.test(R)?R.replace(lr,"\\$&"):R},J.every=function(R,H,Y){var he=rr(R)?s:xr;return Y&&Vi(R,H,Y)&&(H=Q),he(R,Hl(H,3))},J.find=Fb,J.findIndex=up,J.findKey=function(R,H){return x(R,Hl(H,3),Gl)},J.findLast=Mb,J.findLastIndex=fp,J.findLastKey=function(R,H){return x(R,Hl(H,3),mi)},J.floor=Td,J.forEach=vp,J.forEachRight=yp,J.forIn=function(R,H){return R==null?R:Id(R,Hl(H,3),so)},J.forInRight=function(R,H){return R==null?R:Vp(R,Hl(H,3),so)},J.forOwn=function(R,H){return R&&Gl(R,Hl(H,3))},J.forOwnRight=function(R,H){return R&&mi(R,Hl(H,3))},J.get=fd,J.gt=jb,J.gte=Bb,J.has=function(R,H){return R!=null&&tp(R,H,bu)},J.hasIn=hd,J.head=dp,J.identity=qi,J.includes=function(R,H,Y,he){return R=Wi(R)?R:$c(R),Y=Y&&!he?ir(Y):0,he=R.length,Y<0&&(Y=Xn(he+Y,0)),Af(R)?Y<=he&&-1<R.indexOf(H,Y):!!he&&-1<S(R,H,Y)},J.indexOf=function(R,H,Y){var he=R==null?0:R.length;return he?((Y=Y==null?0:ir(Y))<0&&(Y=Xn(he+Y,0)),S(R,H,Y)):-1},J.inRange=function(R,H,Y){return H=Ba(H),Y===Q?(Y=H,H=0):Y=Ba(Y),(R=R=xo(R))>=Si(H=H,Y=Y)&&R<Xn(H,Y)},J.invoke=lw,J.isArguments=Us,J.isArray=rr,J.isArrayBuffer=Vb,J.isArrayLike=Wi,J.isArrayLikeObject=On,J.isBoolean=function(R){return R===!0||R===!1||Rn(R)&&In(R)==Fe},J.isBuffer=hs,J.isDate=Wb,J.isElement=function(R){return Rn(R)&&R.nodeType===1&&!_u(R)},J.isEmpty=function(R){if(R==null)return!0;if(Wi(R)&&(rr(R)||typeof R=="string"||typeof R.splice=="function"||hs(R)||Ac(R)||Us(R)))return!R.length;var H,Y=Ii(R);if(Y==Ft||Y==Oe)return!R.size;if(xu(R))return!gi(R).length;for(H in R)if(an.call(R,H))return!1;return!0},J.isEqual=function(R,H){return oo(R,H)},J.isEqualWith=function(R,H,Y){var he=(Y=typeof Y=="function"?Y:Q)?Y(R,H):Q;return he===Q?oo(R,H,Q,Y):!!he},J.isError=ud,J.isFinite=function(R){return typeof R=="number"&&Kk(R)},J.isFunction=ja,J.isInteger=xp,J.isLength=Df,J.isMap=qb,J.isMatch=function(R,H){return R===H||js(R,H,id(H))},J.isMatchWith=function(R,H,Y){return Y=typeof Y=="function"?Y:Q,js(R,H,id(H),Y)},J.isNaN=function(R){return _p(R)&&R!=+R},J.isNative=function(R){if(ub(R))throw new Dp("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return bo(R)},J.isNil=function(R){return R==null},J.isNull=function(R){return R===null},J.isNumber=_p,J.isObject=_n,J.isObjectLike=Rn,J.isPlainObject=_u,J.isRegExp=Nd,J.isSafeInteger=function(R){return xp(R)&&-ce<=R&&R<=ce},J.isSet=Ub,J.isString=Af,J.isSymbol=ao,J.isTypedArray=Ac,J.isUndefined=function(R){return R===Q},J.isWeakMap=function(R){return Rn(R)&&Ii(R)==Ee},J.isWeakSet=function(R){return Rn(R)&&In(R)=="[object WeakSet]"},J.join=function(R,H){return R==null?"":Jk.call(R,H)},J.kebabCase=aw,J.last=wo,J.lastIndexOf=function(R,H,Y){var he=R==null?0:R.length;if(!he)return-1;var $e=he;return Y!==Q&&($e=($e=ir(Y))<0?Xn(he+$e,0):Si($e,he-1)),H==H?function(Pe,rt,ct){for(var pt=ct+1;pt--;)if(Pe[pt]===rt)return pt;return pt}(R,H,$e):_(R,P,$e,!0)},J.lowerCase=sw,J.lowerFirst=cw,J.lt=Gb,J.lte=Yb,J.max=function(R){return R&&R.length?Sn(R,qi,Hs):Q},J.maxBy=function(R,H){return R&&R.length?Sn(R,Hl(H,2),Hs):Q},J.mean=function(R){return F(R,qi)},J.meanBy=function(R,H){return F(R,Hl(H,2))},J.min=function(R){return R&&R.length?Sn(R,qi,pi):Q},J.minBy=function(R,H){return R&&R.length?Sn(R,Hl(H,2),pi):Q},J.stubArray=vd,J.stubFalse=yd,J.stubObject=function(){return{}},J.stubString=function(){return""},J.stubTrue=function(){return!0},J.multiply=xd,J.nth=function(R,H){return R&&R.length?Tn(R,ir(H)):Q},J.noConflict=function(){return mn._===this&&(mn._=Xk),this},J.noop=pd,J.now=Vf,J.pad=function(R,H,Y){R=Hr(R);var he=(H=ir(H))?ne(R):0;return!H||H<=he?R:_f(jf(he=(H-he)/2),Y)+R+_f(Hf(he),Y)},J.padEnd=function(R,H,Y){R=Hr(R);var he=(H=ir(H))?ne(R):0;return H&&he<H?R+_f(H-he,Y):R},J.padStart=function(R,H,Y){R=Hr(R);var he=(H=ir(H))?ne(R):0;return H&&he<H?_f(H-he,Y)+R:R},J.parseInt=function(R,H,Y){return H=Y||H==null?0:H&&+H,tb(Hr(R).replace(Mn,""),H||0)},J.random=function(R,H,Y){var he;return Y&&typeof Y!="boolean"&&Vi(R,H,Y)&&(H=Y=Q),Y===Q&&(typeof H=="boolean"?(Y=H,H=Q):typeof R=="boolean"&&(Y=R,R=Q)),R===Q&&H===Q?(R=0,H=1):(R=Ba(R),H===Q?(H=R,R=0):H=Ba(H)),H<R&&(he=R,R=H,H=he),Y||R%1||H%1?(Y=Hp(),Si(R+Y*(H-R+Da("1e-"+((Y+"").length-1))),H)):Ea(R,H)},J.reduce=function(R,H,Y){var he=rr(R)?b:w,$e=arguments.length<3;return he(R,Hl(H,4),Y,$e,fs)},J.reduceRight=function(R,H,Y){var he=rr(R)?g:w,$e=arguments.length<3;return he(R,Hl(H,4),Y,$e,Bp)},J.repeat=function(R,H,Y){return H=(Y?Vi(R,H,Y):H===Q)?1:ir(H),_i(Hr(R),H)},J.replace=function(){var R=arguments,H=Hr(R[0]);return R.length<3?H:H.replace(R[1],R[2])},J.result=function(R,H,Y){var he=-1,$e=(H=ml(H,R)).length;for($e||($e=1,R=Q);++he<$e;){var Pe=R==null?Q:R[ua(H[he])];Pe===Q&&(he=$e,Pe=Y),R=ja(Pe)?Pe.call(R):Pe}return R},J.round=Rd,J.runInContext=ee,J.sample=function(R){return(rr(R)?Pr:wc)(R)},J.size=function(R){if(R==null)return 0;if(Wi(R))return Af(R)?ne(R):R.length;var H=Ii(R);return H==Ft||H==Oe?R.size:gi(R).length},J.snakeCase=uw,J.some=function(R,H,Y){var he=rr(R)?v:jt;return Y&&Vi(R,H,Y)&&(H=Q),he(R,Hl(H,3))},J.sortedIndex=function(R,H){return pl(R,H)},J.sortedIndexBy=function(R,H,Y){return Bt(R,H,Hl(Y,2))},J.sortedIndexOf=function(R,H){var Y=R==null?0:R.length;if(Y){var he=pl(R,H);if(he<Y&&fa(R[he],H))return he}return-1},J.sortedLastIndex=function(R,H){return pl(R,H,!0)},J.sortedLastIndexBy=function(R,H,Y){return Bt(R,H,Hl(Y,2),!0)},J.sortedLastIndexOf=function(R,H){if(R==null?0:R.length){var Y=pl(R,H,!0)-1;if(fa(R[Y],H))return Y}return-1},J.startCase=fw,J.startsWith=function(R,H,Y){return R=Hr(R),Y=Y==null?0:wr(ir(Y),0,R.length),H=Ve(H),R.slice(Y,Y+H.length)==H},J.subtract=$d,J.sum=function(R){return R&&R.length?C(R,qi):0},J.sumBy=function(R,H){return R&&R.length?C(R,Hl(H,2)):0},J.template=function(R,H,Y){var he=J.templateSettings;Y&&Vi(R,H,Y)&&(H=Q),R=Hr(R),H=Au({},H,he,ld);var $e,Pe,rt=si(he=Au({},H.imports,he.imports,ld)),ct=z(he,rt),pt=0,he=H.interpolate||br,Rt="__p += '",he=kd((H.escape||br).source+"|"+he.source+"|"+(he===Dt?zn:br).source+"|"+(H.evaluate||br).source+"|$","g"),St="//# sourceURL="+("sourceURL"in H?H.sourceURL:"lodash.templateSources["+ ++vc+"]")+`
`;if(R.replace(he,function(Ht,Qt,Gt,nl,zl,Kt){return Gt=Gt||nl,Rt+=R.slice(pt,Kt).replace(Fr,N),Qt&&($e=!0,Rt+=`' +
__e(`+Qt+`) +
'`),zl&&(Pe=!0,Rt+=`';
`+zl+`;
__p += '`),Gt&&(Rt+=`' +
((__t = (`+Gt+`)) == null ? '' : __t) +
'`),pt=Kt+Ht.length,Ht}),Rt+=`';
`,(H=H.variable)||(Rt=`with (obj) {
`+Rt+`
}
`),Rt=(Pe?Rt.replace(bl,""):Rt).replace(Nr,"$1").replace(li,"$1;"),Rt="function("+(H||"obj")+`) {
`+(H?"":`obj || (obj = {});
`)+"var __t, __p = ''"+($e?", __e = _.escape":"")+(Pe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Rt+`return __p
}`,(H=e0(function(){return Ap(rt,St+"return "+Rt).apply(Q,ct)})).source=Rt,ud(H))throw H;return H},J.times=function(R,H){if((R=ir(R))<1||ce<R)return[];var Y=ye,he=Si(R,ye);for(H=Hl(H),R-=ye,he=T(he,H);++Y<R;)H(Y);return he},J.toFinite=Ba,J.toInteger=ir,J.toLength=$p,J.toLower=function(R){return Hr(R).toLowerCase()},J.toNumber=xo,J.toSafeInteger=function(R){return R?wr(ir(R),-ce,ce):R===0?R:0},J.toString=Hr,J.toUpper=function(R){return Hr(R).toUpperCase()},J.trim=function(R,H,Y){return(R=Hr(R))&&(Y||H===Q)?R.replace(en,""):R&&(H=Ve(H))?(R=me(R),H=me(H),Il(R,E(R,H),L(R,H)+1).join("")):R},J.trimEnd=function(R,H,Y){return(R=Hr(R))&&(Y||H===Q)?R.replace(Dn,""):R&&(H=Ve(H))?Il(R=me(R),0,L(R,me(H))+1).join(""):R},J.trimStart=function(R,H,Y){return(R=Hr(R))&&(Y||H===Q)?R.replace(Mn,""):R&&(H=Ve(H))?Il(R=me(R),E(R,me(H))).join(""):R},J.truncate=function(R,H){var Y,he=30,$e="...";_n(H)&&(Y="separator"in H?H.separator:Y,he="length"in H?ir(H.length):he,$e="omission"in H?Ve(H.omission):$e);var Pe,H=(R=Hr(R)).length;if(W(R)&&(H=(Pe=me(R)).length),H<=he)return R;if((H=he-ne($e))<1)return $e;if(he=Pe?Il(Pe,0,H).join(""):R.slice(0,H),Y===Q)return he+$e;if(Pe&&(H+=he.length-H),Nd(Y)){if(R.slice(H).search(Y)){var rt,ct=he;for(Y.global||(Y=kd(Y.source,Hr(Hn.exec(Y))+"g")),Y.lastIndex=0;rt=Y.exec(ct);)var pt=rt.index;he=he.slice(0,pt===Q?H:pt)}}else R.indexOf(Ve(Y),H)==H||-1<(H=he.lastIndexOf(Y))&&(he=he.slice(0,H));return he+$e},J.unescape=function(R){return(R=Hr(R))&&We.test(R)?R.replace(on,le):R},J.uniqueId=function(R){var H=++Gk;return Hr(R)+H},J.upperCase=hw,J.upperFirst=Ld,J.each=vp,J.eachRight=yp,J.first=dp,gd(J,(Pd={},Gl(J,function(R,H){an.call(J.prototype,H)||(Pd[H]=R)}),Pd),{chain:!1}),J.VERSION="4.17.4",o(["bind","bindKey","curry","curryRight","partial","partialRight"],function(R){J[R].placeholder=J}),o(["drop","take"],function(R,H){lt.prototype[R]=function(Y){Y=Y===Q?1:Xn(ir(Y),0);var he=this.__filtered__&&!H?new lt(this):this.clone();return he.__filtered__?he.__takeCount__=Si(Y,he.__takeCount__):he.__views__.push({size:Si(Y,ye),type:R+(he.__dir__<0?"Right":"")}),he},lt.prototype[R+"Right"]=function(Y){return this.reverse()[R](Y).reverse()}}),o(["filter","map","takeWhile"],function(R,H){var Y=H+1,he=Y==1||Y==3;lt.prototype[R]=function($e){var Pe=this.clone();return Pe.__iteratees__.push({iteratee:Hl($e,3),type:Y}),Pe.__filtered__=Pe.__filtered__||he,Pe}}),o(["head","last"],function(R,H){var Y="take"+(H?"Right":"");lt.prototype[R]=function(){return this[Y](1).value()[0]}}),o(["initial","tail"],function(R,H){var Y="drop"+(H?"":"Right");lt.prototype[R]=function(){return this.__filtered__?new lt(this):this[Y](1)}}),lt.prototype.compact=function(){return this.filter(qi)},lt.prototype.find=function(R){return this.filter(R).head()},lt.prototype.findLast=function(R){return this.reverse().find(R)},lt.prototype.invokeMap=Yl(function(R,H){return typeof R=="function"?new lt(this):this.map(function(Y){return ca(Y,R,H)})}),lt.prototype.reject=function(R){return this.filter(Mf(Hl(R)))},lt.prototype.slice=function(R,H){R=ir(R);var Y=this;return Y.__filtered__&&(0<R||H<0)?new lt(Y):(R<0?Y=Y.takeRight(-R):R&&(Y=Y.drop(R)),H!==Q&&(Y=(H=ir(H))<0?Y.dropRight(-H):Y.take(H-R)),Y)},lt.prototype.takeRightWhile=function(R){return this.reverse().takeWhile(R).reverse()},lt.prototype.toArray=function(){return this.take(ye)},Gl(lt.prototype,function(R,H){var Y=/^(?:filter|find|map|reject)|While$/.test(H),he=/^(?:head|last)$/.test(H),$e=J[he?"take"+(H=="last"?"Right":""):H],Pe=he||/^find/.test(H);$e&&(J.prototype[H]=function(){function rt(zl){return zl=$e.apply(J,p([zl],pt)),he&&Qt?zl[0]:zl}var ct=this.__wrapped__,pt=he?[1]:arguments,Rt=ct instanceof lt,St=pt[0],Ht=Rt||rr(ct);Ht&&Y&&typeof St=="function"&&St.length!=1&&(Rt=Ht=!1);var Qt=this.__chain__,Gt=!!this.__actions__.length,St=Pe&&!Qt,Gt=Rt&&!Gt;if(Pe||!Ht)return St&&Gt?R.apply(this,pt):(nl=this.thru(rt),St?he?nl.value()[0]:nl.value():nl);ct=Gt?ct:new lt(this);var nl=R.apply(ct,pt);return nl.__actions__.push({func:Tf,args:[rt],thisArg:Q}),new Ae(nl,Qt)})}),o(["pop","push","shift","sort","splice","unshift"],function(R){var H=zf[R],Y=/^(?:push|sort|unshift)$/.test(R)?"tap":"thru",he=/^(?:pop|shift)$/.test(R);J.prototype[R]=function(){var $e=arguments;if(!he||this.__chain__)return this[Y](function(rt){return H.apply(rr(rt)?rt:[],$e)});var Pe=this.value();return H.apply(rr(Pe)?Pe:[],$e)}}),Gl(lt.prototype,function(R,H){var Y,he=J[H];he&&(Y=he.name+"",(Fu[Y]||(Fu[Y]=[])).push({name:H,func:he}))}),Fu[wf(Q,2).name]=[{name:"wrapper",func:Q}],lt.prototype.clone=function(){var R=new lt(this.__wrapped__);return R.__actions__=jn(this.__actions__),R.__dir__=this.__dir__,R.__filtered__=this.__filtered__,R.__iteratees__=jn(this.__iteratees__),R.__takeCount__=this.__takeCount__,R.__views__=jn(this.__views__),R},lt.prototype.reverse=function(){var R;return this.__filtered__?((R=new lt(this)).__dir__=-1,R.__filtered__=!0):(R=this.clone()).__dir__*=-1,R},lt.prototype.value=function(){var R=this.__wrapped__.value(),H=this.__dir__,Y=rr(R),he=H<0,$e=Y?R.length:0,Pe=function(jl,Nl,nn){for(var Pl=-1,Mr=nn.length;++Pl<Mr;){var sn=nn[Pl],ci=sn.size;switch(sn.type){case"drop":jl+=ci;break;case"dropRight":Nl-=ci;break;case"take":Nl=Si(Nl,jl+ci);break;case"takeRight":jl=Xn(jl,Nl-ci)}}return{start:jl,end:Nl}}(0,$e,this.__views__),rt=Pe.start,ct=(Pe=Pe.end)-rt,pt=he?Pe:rt-1,Rt=this.__iteratees__,St=Rt.length,Ht=0,Qt=Si(ct,this.__takeCount__);if(!Y||!he&&$e==ct&&Qt==ct)return mt(R,this.__actions__);var Gt=[];e:for(;ct--&&Ht<Qt;){for(var nl=-1,zl=R[pt+=H];++nl<St;){var Kt=Rt[nl],Ml=Kt.iteratee,Kt=Kt.type,Ml=Ml(zl);if(Kt==2)zl=Ml;else if(!Ml){if(Kt==1)continue e;break e}}Gt[Ht++]=zl}return Gt},J.prototype.at=Tb,J.prototype.chain=function(){return pp(this)},J.prototype.commit=function(){return new Ae(this.value(),this.__chain__)},J.prototype.next=function(){this.__values__===Q&&(this.__values__=Cp(this.value()));var R=this.__index__>=this.__values__.length;return{done:R,value:R?Q:this.__values__[this.__index__++]}},J.prototype.plant=function(R){for(var H,Y=this;Y instanceof He;){var he=cp(Y);he.__index__=0,he.__values__=Q,H?$e.__wrapped__=he:H=he;var $e=he,Y=Y.__wrapped__}return $e.__wrapped__=R,H},J.prototype.reverse=function(){var R=this.__wrapped__;return R instanceof lt?(R=R,this.__actions__.length&&(R=new lt(this)),(R=R.reverse()).__actions__.push({func:Tf,args:[sd],thisArg:Q}),new Ae(R,this.__chain__)):this.thru(sd)},J.prototype.toJSON=J.prototype.valueOf=J.prototype.value=function(){return mt(this.__wrapped__,this.__actions__)},J.prototype.first=J.prototype.head,$u&&(J.prototype[$u]=function(){return this}),J}();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(mn._=se,define(function(){return se})):ni?((ni.exports=se)._=se,ii._=se):mn._=se}.call(Bn),function(e,n){typeof Bn=="object"?Zn.exports=n():typeof define=="function"&&define.amd?define(n):e.jStat=n()}(Bn,function(){var e,n,t,l,o,a,s,u,f,m,d,p,b,g,v,x=function(k,w){var C=Array.prototype.concat,T=Array.prototype.slice,O=Object.prototype.toString;function z(ne,me){return me=me<ne?ne:me,k.pow(10,17-~~(k.log(0<me?me:-me)*k.LOG10E))}var A=Array.isArray||function(ne){return O.call(ne)==="[object Array]"};function E(ne){return O.call(ne)==="[object Function]"}function L(ne){return typeof ne=="number"&&ne-ne==0}function N(){return new N._init(arguments)}function W(){return 0}function X(){return 1}function te(ne,me){return ne===me?1:0}function ue(ne,me,Q,we){var ie,ge=[],ce=ne.length;if(me===w&&Q===w&&we===w)return N.copy(ne);if(we=we||1,(me=0<=(me=me||0)?me:ce+me)===(Q=0<=(Q=Q||ne.length)?Q:ce+Q)||we===0)return[];if(me<Q&&we<0)return[];if(Q<me&&0<we)return[];if(0<we)for(ie=me;ie<Q;ie+=we)ge.push(ne[ie]);else for(ie=me;Q<ie;ie+=we)ge.push(ne[ie]);return ge}N.fn=N.prototype,N._init=function(ne){if(A(ne[0]))if(A(ne[0][0])){E(ne[1])&&(ne[0]=N.map(ne[0],ne[1]));for(var me=0;me<ne[0].length;me++)this[me]=ne[0][me];this.length=ne[0].length}else this[0]=E(ne[1])?N.map(ne[0],ne[1]):ne[0],this.length=1;else if(L(ne[0]))this[0]=N.seq.apply(null,ne),this.length=1;else{if(ne[0]instanceof N)return N(ne[0].toArray());this[0]=[],this.length=1}return this},N._init.prototype=N.prototype,(N._init.constructor=N).utils={calcRdx:z,isArray:A,isFunction:E,isNumber:L,toVector:function(ne){return C.apply([],ne)}},N._random_fn=k.random,N.setRandom=function(ne){if(typeof ne!="function")throw new TypeError("fn is not a function");N._random_fn=ne},N.extend=function(ne){var me,Q;if(arguments.length===1){for(Q in ne)N[Q]=ne[Q];return this}for(me=1;me<arguments.length;me++)for(Q in arguments[me])ne[Q]=arguments[me][Q];return ne},N.rows=function(ne){return ne.length||1},N.cols=function(ne){return ne[0].length||1},N.dimensions=function(ne){return{rows:N.rows(ne),cols:N.cols(ne)}},N.row=function(ne,me){return A(me)?me.map(function(Q){return N.row(ne,Q)}):ne[me]},N.rowa=function(ne,me){return N.row(ne,me)},N.col=function(ne,me){if(A(me)){var Q=N.arange(ne.length).map(function(){return new Array(me.length)});return me.forEach(function(ge,ce){N.arange(ne.length).forEach(function(fe){Q[fe][ce]=ne[fe][ge]})}),Q}for(var we=new Array(ne.length),ie=0;ie<ne.length;ie++)we[ie]=[ne[ie][me]];return we},N.cola=function(ne,me){return N.col(ne,me).map(function(Q){return Q[0]})},N.diag=function(ne){for(var me=N.rows(ne),Q=new Array(me),we=0;we<me;we++)Q[we]=[ne[we][we]];return Q},N.antidiag=function(ne){for(var me=N.rows(ne)-1,Q=new Array(me),we=0;0<=me;me--,we++)Q[we]=[ne[we][me]];return Q},N.transpose=function(ne){var me,Q,we,ie,ge,ce=[];for(A(ne[0])||(ne=[ne]),Q=ne.length,we=ne[0].length,ge=0;ge<we;ge++){for(me=new Array(Q),ie=0;ie<Q;ie++)me[ie]=ne[ie][ge];ce.push(me)}return ce.length===1?ce[0]:ce},N.map=function(ne,me,Q){var we,ie,ge,ce,fe;for(A(ne[0])||(ne=[ne]),ie=ne.length,ge=ne[0].length,ce=Q?ne:new Array(ie),we=0;we<ie;we++)for(ce[we]||(ce[we]=new Array(ge)),fe=0;fe<ge;fe++)ce[we][fe]=me(ne[we][fe],we,fe);return ce.length===1?ce[0]:ce},N.cumreduce=function(ne,me,Q){var we,ie,ge,ce,fe;for(A(ne[0])||(ne=[ne]),ie=ne.length,ge=ne[0].length,ce=Q?ne:new Array(ie),we=0;we<ie;we++)for(ce[we]||(ce[we]=new Array(ge)),0<ge&&(ce[we][0]=ne[we][0]),fe=1;fe<ge;fe++)ce[we][fe]=me(ce[we][fe-1],ne[we][fe]);return ce.length===1?ce[0]:ce},N.alter=function(ne,me){return N.map(ne,me,!0)},N.create=function(ne,me,Q){var we,ie,ge=new Array(ne);for(E(me)&&(Q=me,me=ne),we=0;we<ne;we++)for(ge[we]=new Array(me),ie=0;ie<me;ie++)ge[we][ie]=Q(we,ie);return ge},N.zeros=function(ne,me){return L(me)||(me=ne),N.create(ne,me,W)},N.ones=function(ne,me){return L(me)||(me=ne),N.create(ne,me,X)},N.rand=function(ne,me){return L(me)||(me=ne),N.create(ne,me,N._random_fn)},N.identity=function(ne,me){return L(me)||(me=ne),N.create(ne,me,te)},N.symmetric=function(ne){var me,Q,we=ne.length;if(ne.length!==ne[0].length)return!1;for(me=0;me<we;me++)for(Q=0;Q<we;Q++)if(ne[Q][me]!==ne[me][Q])return!1;return!0},N.clear=function(ne){return N.alter(ne,W)},N.seq=function(ne,me,Q,we){E(we)||(we=!1);for(var ie=[],ge=z(ne,me),ce=(me*ge-ne*ge)/((Q-1)*ge),fe=ne,ye=0;fe<=me&&ye<Q;fe=(ne*ge+ce*ge*++ye)/ge)ie.push(we?we(fe,ye):fe);return ie},N.arange=function(ne,me,Q){var we,ie=[];if(Q=Q||1,me===w&&(me=ne,ne=0),ne===me||Q===0)return[];if(ne<me&&Q<0)return[];if(me<ne&&0<Q)return[];if(0<Q)for(we=ne;we<me;we+=Q)ie.push(we);else for(we=ne;me<we;we+=Q)ie.push(we);return ie},N.slice=function(ne,me){var Q,we;return L((me=me||{}).row)?L(me.col)?ne[me.row][me.col]:ue(N.rowa(ne,me.row),(Q=me.col||{}).start,Q.end,Q.step):L(me.col)?ue(N.cola(ne,me.col),(we=me.row||{}).start,we.end,we.step):(we=me.row||{},Q=me.col||{},ue(ne,we.start,we.end,we.step).map(function(ie){return ue(ie,Q.start,Q.end,Q.step)}))},N.sliceAssign=function(ne,me,Q){var we,ie;if(L(me.row)){if(L(me.col))return ne[me.row][me.col]=Q;me.col=me.col||{},me.col.start=me.col.start||0,me.col.end=me.col.end||ne[0].length,me.col.step=me.col.step||1,we=N.arange(me.col.start,k.min(ne.length,me.col.end),me.col.step);var ge=me.row;return we.forEach(function(fe,ye){ne[ge][fe]=Q[ye]}),ne}if(L(me.col)){me.row=me.row||{},me.row.start=me.row.start||0,me.row.end=me.row.end||ne.length,me.row.step=me.row.step||1,ie=N.arange(me.row.start,k.min(ne[0].length,me.row.end),me.row.step);var ce=me.col;return ie.forEach(function(fe,ye){ne[fe][ce]=Q[ye]}),ne}return Q[0].length===w&&(Q=[Q]),me.row.start=me.row.start||0,me.row.end=me.row.end||ne.length,me.row.step=me.row.step||1,me.col.start=me.col.start||0,me.col.end=me.col.end||ne[0].length,me.col.step=me.col.step||1,ie=N.arange(me.row.start,k.min(ne.length,me.row.end),me.row.step),we=N.arange(me.col.start,k.min(ne[0].length,me.col.end),me.col.step),ie.forEach(function(fe,ye){we.forEach(function(Ne,xe){ne[fe][Ne]=Q[ye][xe]})}),ne},N.diagonal=function(ne){var me=N.zeros(ne.length,ne.length);return ne.forEach(function(Q,we){me[we][we]=Q}),me},N.copy=function(ne){return ne.map(function(me){return L(me)?me:me.map(function(Q){return Q})})};var pe=N.prototype;return pe.length=0,pe.push=Array.prototype.push,pe.sort=Array.prototype.sort,pe.splice=Array.prototype.splice,pe.slice=Array.prototype.slice,pe.toArray=function(){return 1<this.length?T.call(this):T.call(this)[0]},pe.map=function(ne,me){return N(N.map(this,ne,me))},pe.cumreduce=function(ne,me){return N(N.cumreduce(this,ne,me))},pe.alter=function(ne){return N.alter(this,ne),this},function(ne){for(var me=0;me<ne.length;me++)(function(Q){pe[Q]=function(we){var ie,ge=this;return we?(setTimeout(function(){we.call(ge,pe[Q].call(ge))}),this):(ie=N[Q](this),A(ie)?N(ie):ie)}})(ne[me])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(ne){for(var me=0;me<ne.length;me++)(function(Q){pe[Q]=function(we,ie){var ge=this;return ie?(setTimeout(function(){ie.call(ge,pe[Q].call(ge,we))}),this):N(N[Q](this,we))}})(ne[me])}("row col".split(" ")),function(ne){for(var me=0;me<ne.length;me++)(function(Q){pe[Q]=function(){return N(N[Q].apply(null,arguments))}})(ne[me])}("create zeros ones rand identity".split(" ")),N}(Math);function _(k,w,C,T){for(var O,z=0,A=1,E=1,L=1,N=0,W=0;l.abs((E-W)/E)>T;)A=L+(O=-(w+N)*(w+C+N)*k/(w+2*N)/(w+2*N+1))*A,E=(z=(W=E)+O*z)+(O=(N+=1)*(C-N)*k/(w+2*N-1)/(w+2*N))*E,z/=L=A+O*L,A/=L,E/=L,L=1;return E/w}function S(k,w,C){var T=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],O=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],z=.5*k;if(8<=z)return 1;for(var A=(A=2*t.normal.cdf(z,0,1,1,0)-1)>=l.exp(-50/C)?l.pow(A,C):0,E=3<k?2:3,L=z,N=(8-z)/E,W=L+N,X=0,te=C-1,ue=1;ue<=E;ue++){for(var pe=0,ne=.5*(W+L),me=.5*(W-L),Q=1;Q<=12;Q++){var we,ie=6<Q?T[(we=12-Q+1)-1]:-T[(we=Q)-1],ge=ne+me*ie,ie=ge*ge;if(60<ie)break;ge=.5*(2*t.normal.cdf(ge,0,1,1,0))-.5*(2*t.normal.cdf(ge,k,1,1,0)),ge>=l.exp(-30/te)&&(pe+=O[we-1]*l.exp(-.5*ie)*l.pow(ge,te))}X+=pe*=2*me*C/l.sqrt(2*l.PI),L=W,W+=N}return(A+=X)<=l.exp(-30/w)?0:1<=(A=l.pow(A,w))?1:A}function I(k){return m(k)||k instanceof o}function P(k,w,C,T){if(1<k||1<C||k<=0||C<=0)throw new Error("Proportions should be greater than 0 and less than 1");var O=(k*w+C*T)/(w+T);return(k-C)/p.sqrt(O*(1-O)*(1/w+1/T))}function F(k,w){var C=k.length,T=w[0].length-1,O=C-T-1,z=x.lstsq(w,k),A=x.multiply(w,z.map(function(te){return[te]})).map(function(te){return te[0]}),E=x.subtract(k,A),L=x.mean(k),N=x.sum(A.map(function(te){return Math.pow(te-L,2)})),W=x.sum(k.map(function(te,ue){return Math.pow(te-A[ue],2)})),X=N+W;return{exog:w,endog:k,nobs:C,df_model:T,df_resid:O,coef:z,predict:A,resid:E,ybar:L,SST:X,SSE:N,SSR:W,R2:N/X}}function D(k){var w,C,T=(w=k.exog,C=w[0].length,x.arange(C).map(function(N){var W=x.arange(C).filter(function(X){return X!==N});return F(x.col(w,N).map(function(X){return X[0]}),x.col(w,W))})),O=Math.sqrt(k.SSR/k.df_resid),z=T.map(function(N){var W=N.SST,N=N.R2;return O/Math.sqrt(W*(1-N))}),A=k.coef.map(function(N,W){return+N/z[W]}),E=A.map(function(N){return N=x.studentt.cdf(N,k.df_resid),2*(.5<N?1-N:N)}),L=x.studentt.inv(.975,k.df_resid),T=k.coef.map(function(N,W){return W=L*z[W],[N-W,N+W]});return{se:z,t:A,p:E,sigmaHat:O,interval95:T}}return function(k,w){var C=k.utils.isFunction;function T(A,E){return A-E}function O(A,E,L){return w.max(E,w.min(A,L))}k.sum=function(A){for(var E=0,L=A.length;0<=--L;)E+=A[L];return E},k.sumsqrd=function(A){for(var E=0,L=A.length;0<=--L;)E+=A[L]*A[L];return E},k.sumsqerr=function(A){for(var E,L=k.mean(A),N=0,W=A.length;0<=--W;)N+=(E=A[W]-L)*E;return N},k.sumrow=function(A){for(var E=0,L=A.length;0<=--L;)E+=A[L];return E},k.product=function(A){for(var E=1,L=A.length;0<=--L;)E*=A[L];return E},k.min=function(A){for(var E=A[0],L=0;++L<A.length;)A[L]<E&&(E=A[L]);return E},k.max=function(A){for(var E=A[0],L=0;++L<A.length;)A[L]>E&&(E=A[L]);return E},k.unique=function(A){for(var E={},L=[],N=0;N<A.length;N++)E[A[N]]||(E[A[N]]=!0,L.push(A[N]));return L},k.mean=function(A){return k.sum(A)/A.length},k.meansqerr=function(A){return k.sumsqerr(A)/A.length},k.geomean=function(A){return w.pow(k.product(A),1/A.length)},k.median=function(A){var E=A.length,A=A.slice().sort(T);return 1&E?A[E/2|0]:(A[E/2-1]+A[E/2])/2},k.cumsum=function(A){return k.cumreduce(A,function(E,L){return E+L})},k.cumprod=function(A){return k.cumreduce(A,function(E,L){return E*L})},k.diff=function(A){for(var E=[],L=A.length,N=1;N<L;N++)E.push(A[N]-A[N-1]);return E},k.rank=function(A){for(var E=[],L={},N=0;N<A.length;N++)L[ue=A[N]]?L[ue]++:(L[ue]=1,E.push(ue));var W=E.sort(T),X={},te=1;for(N=0;N<W.length;N++){var ue,pe=L[ue=W[N]],ne=(te+(te+pe-1))/2;X[ue]=ne,te+=pe}return A.map(function(me){return X[me]})},k.mode=function(A){for(var E=A.length,L=A.slice().sort(T),N=1,W=0,X=0,te=[],ue=0;ue<E;ue++)L[ue]===L[ue+1]?N++:(W<N?(te=[L[ue]],W=N,X=0):N===W&&(te.push(L[ue]),X++),N=1);return X===0?te[0]:te},k.range=function(A){return k.max(A)-k.min(A)},k.variance=function(A,E){return k.sumsqerr(A)/(A.length-(E?1:0))},k.pooledvariance=function(A){return A.reduce(function(E,L){return E+k.sumsqerr(L)},0)/(A.reduce(function(E,L){return E+L.length},0)-A.length)},k.deviation=function(A){for(var E=k.mean(A),L=A.length,N=new Array(L),W=0;W<L;W++)N[W]=A[W]-E;return N},k.stdev=function(A,E){return w.sqrt(k.variance(A,E))},k.pooledstdev=function(A){return w.sqrt(k.pooledvariance(A))},k.meandev=function(A){for(var E=k.mean(A),L=[],N=A.length-1;0<=N;N--)L.push(w.abs(A[N]-E));return k.mean(L)},k.meddev=function(A){for(var E=k.median(A),L=[],N=A.length-1;0<=N;N--)L.push(w.abs(A[N]-E));return k.median(L)},k.coeffvar=function(A){return k.stdev(A)/k.mean(A)},k.quartiles=function(A){var E=A.length,A=A.slice().sort(T);return[A[w.round(E/4)-1],A[w.round(E/2)-1],A[w.round(3*E/4)-1]]},k.quantiles=function(A,E,L,N){var W,X,te,ue=A.slice().sort(T),pe=[E.length],ne=A.length;for(L===void 0&&(L=3/8),N===void 0&&(N=3/8),W=0;W<E.length;W++)te=ne*(X=E[W])+(L+X*(1-L-N)),X=w.floor(O(te,1,ne-1)),te=O(te-X,0,1),pe[W]=(1-te)*ue[X-1]+te*ue[X];return pe},k.percentile=function(A,E,L){return A=A.slice().sort(T),E=E*(A.length+(L?1:-1))+(L?0:1),L=parseInt(E),E-=L,L+1<A.length?A[L-1]+E*(A[L]-A[L-1]):A[L-1]},k.percentileOfScore=function(A,E,L){for(var N,W=0,X=A.length,te=L==="strict",ue=0;ue<X;ue++)N=A[ue],(te&&N<E||!te&&N<=E)&&W++;return W/X},k.histogram=function(A,E){E=E||4;for(var L=k.min(A),N=(k.max(A)-L)/E,W=A.length,X=[],te=0;te<E;te++)X[te]=0;for(te=0;te<W;te++)X[w.min(w.floor((A[te]-L)/N),E-1)]+=1;return X},k.covariance=function(A,E){for(var L=k.mean(A),N=k.mean(E),W=A.length,X=new Array(W),te=0;te<W;te++)X[te]=(A[te]-L)*(E[te]-N);return k.sum(X)/(W-1)},k.corrcoeff=function(A,E){return k.covariance(A,E)/k.stdev(A,1)/k.stdev(E,1)},k.spearmancoeff=function(A,E){return A=k.rank(A),E=k.rank(E),k.corrcoeff(A,E)},k.stanMoment=function(A,E){for(var L=k.mean(A),N=k.stdev(A),W=A.length,X=0,te=0;te<W;te++)X+=w.pow((A[te]-L)/N,E);return X/A.length},k.skewness=function(A){return k.stanMoment(A,3)},k.kurtosis=function(A){return k.stanMoment(A,4)-3};var z=k.prototype;(function(A){for(var E=0;E<A.length;E++)(function(L){z[L]=function(N,W){var X=[],te=0,ue=this;if(C(N)&&(W=N,N=!1),W)return setTimeout(function(){W.call(ue,z[L].call(ue,N))}),this;if(1<this.length){for(ue=N===!0?this:this.transpose();te<ue.length;te++)X[te]=k[L](ue[te]);return X}return k[L](this[0],N)}})(A[E])})("cumsum cumprod".split(" ")),function(A){for(var E=0;E<A.length;E++)(function(L){z[L]=function(N,W){var X=[],te=0,ue=this;if(C(N)&&(W=N,N=!1),W)return setTimeout(function(){W.call(ue,z[L].call(ue,N))}),this;if(1<this.length){for(L!=="sumrow"&&(ue=N===!0?this:this.transpose());te<ue.length;te++)X[te]=k[L](ue[te]);return N===!0?k[L](k.utils.toVector(X)):X}return k[L](this[0],N)}})(A[E])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(A){for(var E=0;E<A.length;E++)(function(L){z[L]=function(){var N,W=[],X=0,te=this,ue=Array.prototype.slice.call(arguments);if(C(ue[ue.length-1])){N=ue[ue.length-1];var pe=ue.slice(0,ue.length-1);return setTimeout(function(){N.call(te,z[L].apply(te,pe))}),this}N=void 0;var ne=function(me){return k[L].apply(te,[me].concat(ue))};if(1<this.length){for(te=te.transpose();X<te.length;X++)W[X]=ne(te[X]);return W}return ne(this[0])}})(A[E])}("quantiles percentileOfScore".split(" "))}(x,Math),e=x,n=Math,e.gammaln=function(k){var w,C,T=0,O=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],z=1.000000000190015,k=(C=w=k)+5.5;for(k-=(w+.5)*n.log(k);T<6;T++)z+=O[T]/++C;return n.log(2.5066282746310007*z/w)-k},e.loggam=function(k){var w,C,T,O,z,A=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],E=k,L=0;if(k==1||k==2)return 0;for(k<=7&&(E=k+(L=n.floor(7-k))),w=1/(E*E),C=2*n.PI,O=A[9],z=8;0<=z;z--)O*=w,O+=A[z];if(T=O/E+.5*n.log(C)+(E-.5)*n.log(E)-E,k<=7)for(z=1;z<=L;z++)T-=n.log(E-1),--E;return T},e.gammafn=function(k){var w,C,T,O=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],z=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],A=!1,E=0,L=0,N=0,W=k;if(171.6243769536076<k)return 1/0;if(W<=0){if(!(T=W%1+36e-17))return 1/0;A=(1&W?-1:1)*n.PI/n.sin(n.PI*T),W=1-W}for(C=(k=W)<1?W++:(W-=E=(0|W)-1)-1,w=0;w<8;++w)N=(N+O[w])*C,L=L*C+z[w];if(T=N/L+1,k<W)T/=k;else if(W<k)for(w=0;w<E;++w)T*=W,W++;return A&&(T=A/T),T},e.gammap=function(k,w){return e.lowRegGamma(k,w)*e.gammafn(k)},e.lowRegGamma=function(k,w){var C,T=e.gammaln(k),O=k,z=1/k,A=z,E=w+1-k,L=1/1e-30,N=1/E,W=N,X=1,te=-~(8.5*n.log(1<=k?k:1/k)+.4*k+17);if(w<0||k<=0)return NaN;if(w<k+1){for(;X<=te;X++)z+=A*=w/++O;return z*n.exp(-w+k*n.log(w)-T)}for(;X<=te;X++)W*=(N=1/(N=(C=-X*(X-k))*N+(E+=2)))*(L=E+C/L);return 1-W*n.exp(-w+k*n.log(w)-T)},e.factorialln=function(k){return k<0?NaN:e.gammaln(k+1)},e.factorial=function(k){return k<0?NaN:e.gammafn(k+1)},e.combination=function(k,w){return 170<k||170<w?n.exp(e.combinationln(k,w)):e.factorial(k)/e.factorial(w)/e.factorial(k-w)},e.combinationln=function(k,w){return e.factorialln(k)-e.factorialln(w)-e.factorialln(k-w)},e.permutation=function(k,w){return e.factorial(k)/e.factorial(k-w)},e.betafn=function(k,w){if(!(k<=0||w<=0))return 170<k+w?n.exp(e.betaln(k,w)):e.gammafn(k)*e.gammafn(w)/e.gammafn(k+w)},e.betaln=function(k,w){return e.gammaln(k)+e.gammaln(w)-e.gammaln(k+w)},e.betacf=function(k,w,C){var T,O,z,A=1e-30,E=1,L=w+C,N=w+1,W=w-1,X=1,te=1-L*k/N;for(n.abs(te)<A&&(te=A),z=te=1/te;E<=100&&(te=1+(O=E*(C-E)*k/((W+(T=2*E))*(w+T)))*te,n.abs(te)<A&&(te=A),X=1+O/X,n.abs(X)<A&&(X=A),z*=(te=1/te)*X,te=1+(O=-(w+E)*(L+E)*k/((w+T)*(N+T)))*te,n.abs(te)<A&&(te=A),X=1+O/X,n.abs(X)<A&&(X=A),z*=O=(te=1/te)*X,!(n.abs(O-1)<3e-7));E++);return z},e.gammapinv=function(k,w){var C,T,O,z,A,E,L=0,N=w-1,W=e.gammaln(w);if(1<=k)return n.max(100,w+100*n.sqrt(w));if(k<=0)return 0;for(C=1<w?(A=n.log(N),E=n.exp(N*(A-1)-W),z=k<.5?k:1-k,C=(2.30753+.27061*(T=n.sqrt(-2*n.log(z))))/(1+T*(.99229+.04481*T))-T,k<.5&&(C=-C),n.max(.001,w*n.pow(1-1/(9*w)-C/(3*n.sqrt(w)),3))):k<(T=1-w*(.253+.12*w))?n.pow(k/T,1/w):1-n.log(1-(k-T)/(1-T));L<12;L++){if(C<=0)return 0;if((C-=T=(O=(e.lowRegGamma(w,C)-k)/(T=1<w?E*n.exp(-(C-N)+N*(n.log(C)-A)):n.exp(-C+N*n.log(C)-W)))/(1-.5*n.min(1,O*((w-1)/C-1))))<=0&&(C=.5*(C+T)),n.abs(T)<1e-8*C)break}return C},e.erf=function(k){var w,C,T,O=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],z=O.length-1,A=!1,E=0,L=0;for(k<0&&(k=-k,A=!0),C=4*(w=2/(2+k))-2;0<z;z--)E=C*(T=E)-L+O[z],L=T;return k=w*n.exp(-k*k+.5*(O[0]+C*E)-L),A?k-1:1-k},e.erfc=function(k){return 1-e.erf(k)},e.erfcinv=function(k){var w,C,T,O,z=0;if(2<=k)return-100;if(k<=0)return 100;for(O=k<1?k:2-k,w=-.70711*((2.30753+.27061*(T=n.sqrt(-2*n.log(O/2))))/(1+T*(.99229+.04481*T))-T);z<2;z++)w+=(C=e.erfc(w)-O)/(1.1283791670955126*n.exp(-w*w)-w*C);return k<1?w:-w},e.ibetainv=function(k,w,C){var T,O,z,A,E,L,N,W=w-1,X=C-1,te=0;if(k<=0)return 0;if(1<=k)return 1;for(z=1<=w&&1<=C?(L=k<.5?k:1-k,z=(2.30753+.27061*(T=n.sqrt(-2*n.log(L))))/(1+T*(.99229+.04481*T))-T,k<.5&&(z=-z),A=(z*z-3)/6,E=2/(1/(2*w-1)+1/(2*C-1)),L=z*n.sqrt(A+E)/E-(1/(2*C-1)-1/(2*w-1))*(A+5/6-2/(3*E)),w/(w+C*n.exp(2*L))):(A=n.log(w/(w+C)),E=n.log(C/(w+C)),k<(T=n.exp(w*A)/w)/(L=T+(O=n.exp(C*E)/C))?n.pow(w*L*k,1/w):1-n.pow(C*L*(1-k),1/C)),N=-e.gammaln(w)-e.gammaln(C)+e.gammaln(w+C);te<10;te++){if(z===0||z===1)return z;if((z-=T=(O=(e.ibeta(z,w,C)-k)/(T=n.exp(W*n.log(z)+X*n.log(1-z)+N)))/(1-.5*n.min(1,O*(W/z-X/(1-z)))))<=0&&(z=.5*(z+T)),1<=z&&(z=.5*(z+T+1)),n.abs(T)<1e-8*z&&0<te)break}return z},e.ibeta=function(k,w,C){var T=k===0||k===1?0:n.exp(e.gammaln(w+C)-e.gammaln(w)-e.gammaln(C)+w*n.log(k)+C*n.log(1-k));return!(k<0||1<k)&&(k<(w+1)/(w+C+2)?T*e.betacf(k,w,C)/w:1-T*e.betacf(1-k,C,w)/C)},e.randn=function(k,w){var C,T,O,z;if(w=w||k,k)return e.create(k,w,function(){return e.randn()});for(;C=e._random_fn(),T=1.7156*(e._random_fn()-.5),z=(z=C-.449871)*z+(O=n.abs(T)+.386595)*(.196*O-.25472*z),.27597<z&&(.27846<z||T*T>-4*n.log(C)*C*C););return T/C},e.randg=function(k,w,C){var T,O,z,A,E,L=k;if(C=C||w,k=k||1,w)return(C=e.zeros(w,C)).alter(function(){return e.randg(k)}),C;k<1&&(k+=1),T=k-1/3,O=1/n.sqrt(9*T);do for(;A=1+O*(E=e.randn()),A<=0;);while(A*=A*A,(z=e._random_fn())>1-.331*n.pow(E,4)&&n.log(z)>.5*E*E+T*(1-A+n.log(A)));if(k==L)return T*A;for(;z=e._random_fn(),z===0;);return n.pow(z,1/L)*T*A},function(k){for(var w=0;w<k.length;w++)(function(C){e.fn[C]=function(){return e(e.map(this,function(T){return e[C](T)}))}})(k[w])}("gammaln gammafn factorial factorialln".split(" ")),function(k){for(var w=0;w<k.length;w++)(function(C){e.fn[C]=function(){return e(e[C].apply(null,arguments))}})(k[w])}("randn".split(" ")),t=x,l=Math,function(k){for(var w=0;w<k.length;w++)(function(C){t[C]=function(T,O,z){return this instanceof arguments.callee?(this._a=T,this._b=O,this._c=z,this):new arguments.callee(T,O,z)},t.fn[C]=function(T,O,z){return z=t[C](T,O,z),z.data=this,z},t[C].prototype.sample=function(T){var O=this._a,z=this._b,A=this._c;return T?t.alter(T,function(){return t[C].sample(O,z,A)}):t[C].sample(O,z,A)},function(T){for(var O=0;O<T.length;O++)(function(z){t[C].prototype[z]=function(A){var E=this._a,L=this._b,N=this._c;return A||A===0||(A=this.data),typeof A!="number"?t.fn.map.call(A,function(W){return t[C][z](W,E,L,N)}):t[C][z](A,E,L,N)}})(T[O])}("pdf cdf inv".split(" ")),function(T){for(var O=0;O<T.length;O++)(function(z){t[C].prototype[z]=function(){return t[C][z](this._a,this._b,this._c)}})(T[O])}("mean median mode variance".split(" "))})(k[w])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(k,w,C){return 1<k||k<0?0:w==1&&C==1?1:w<512&&C<512?l.pow(k,w-1)*l.pow(1-k,C-1)/t.betafn(w,C):l.exp((w-1)*l.log(k)+(C-1)*l.log(1-k)-t.betaln(w,C))},cdf:function(k,w,C){return 1<k||k<0?+(1<k):t.ibeta(k,w,C)},inv:function(k,w,C){return t.ibetainv(k,w,C)},mean:function(k,w){return k/(k+w)},median:function(k,w){return t.ibetainv(.5,k,w)},mode:function(k,w){return(k-1)/(k+w-2)},sample:function(k,w){return k=t.randg(k),k/(k+t.randg(w))},variance:function(k,w){return k*w/(l.pow(k+w,2)*(k+w+1))}}),t.extend(t.centralF,{pdf:function(k,w,C){var T;return k<0?0:w<=2?k===0&&w<2?1/0:k===0&&w===2?1:1/t.betafn(w/2,C/2)*l.pow(w/C,w/2)*l.pow(k,w/2-1)*l.pow(1+w/C*k,-(w+C)/2):(T=w*k/(C+k*w),w*(C/(C+k*w))/2*t.binomial.pdf((w-2)/2,(w+C-2)/2,T))},cdf:function(k,w,C){return k<0?0:t.ibeta(w*k/(w*k+C),w/2,C/2)},inv:function(k,w,C){return C/(w*(1/t.ibetainv(k,w/2,C/2)-1))},mean:function(k,w){return 2<w?w/(w-2):void 0},mode:function(k,w){return 2<k?w*(k-2)/(k*(w+2)):void 0},sample:function(k,w){return 2*t.randg(k/2)/k/(2*t.randg(w/2)/w)},variance:function(k,w){if(!(w<=4))return 2*w*w*(k+w-2)/(k*(w-2)*(w-2)*(w-4))}}),t.extend(t.cauchy,{pdf:function(k,w,C){return C<0?0:C/(l.pow(k-w,2)+l.pow(C,2))/l.PI},cdf:function(k,w,C){return l.atan((k-w)/C)/l.PI+.5},inv:function(k,w,C){return w+C*l.tan(l.PI*(k-.5))},median:function(k){return k},mode:function(k){return k},sample:function(k,w){return t.randn()*l.sqrt(1/(2*t.randg(.5)))*w+k}}),t.extend(t.chisquare,{pdf:function(k,w){return k<0?0:k===0&&w===2?.5:l.exp((w/2-1)*l.log(k)-k/2-w/2*l.log(2)-t.gammaln(w/2))},cdf:function(k,w){return k<0?0:t.lowRegGamma(w/2,k/2)},inv:function(k,w){return 2*t.gammapinv(k,.5*w)},mean:function(k){return k},median:function(k){return k*l.pow(1-2/(9*k),3)},mode:function(k){return 0<k-2?k-2:0},sample:function(k){return 2*t.randg(k/2)},variance:function(k){return 2*k}}),t.extend(t.exponential,{pdf:function(k,w){return k<0?0:w*l.exp(-w*k)},cdf:function(k,w){return k<0?0:1-l.exp(-w*k)},inv:function(k,w){return-l.log(1-k)/w},mean:function(k){return 1/k},median:function(k){return 1/k*l.log(2)},mode:function(){return 0},sample:function(k){return-1/k*l.log(t._random_fn())},variance:function(k){return l.pow(k,-2)}}),t.extend(t.gamma,{pdf:function(k,w,C){return k<0?0:k===0&&w===1?1/C:l.exp((w-1)*l.log(k)-k/C-t.gammaln(w)-w*l.log(C))},cdf:function(k,w,C){return k<0?0:t.lowRegGamma(w,k/C)},inv:function(k,w,C){return t.gammapinv(k,w)*C},mean:function(k,w){return k*w},mode:function(k,w){if(1<k)return(k-1)*w},sample:function(k,w){return t.randg(k)*w},variance:function(k,w){return k*w*w}}),t.extend(t.invgamma,{pdf:function(k,w,C){return k<=0?0:l.exp(-(w+1)*l.log(k)-C/k-t.gammaln(w)+w*l.log(C))},cdf:function(k,w,C){return k<=0?0:1-t.lowRegGamma(w,C/k)},inv:function(k,w,C){return C/t.gammapinv(1-k,w)},mean:function(k,w){return 1<k?w/(k-1):void 0},mode:function(k,w){return w/(k+1)},sample:function(k,w){return w/t.randg(k)},variance:function(k,w){if(!(k<=2))return w*w/((k-1)*(k-1)*(k-2))}}),t.extend(t.kumaraswamy,{pdf:function(k,w,C){return k===0&&w===1?C:k===1&&C===1?w:l.exp(l.log(w)+l.log(C)+(w-1)*l.log(k)+(C-1)*l.log(1-l.pow(k,w)))},cdf:function(k,w,C){return k<0?0:1<k?1:1-l.pow(1-l.pow(k,w),C)},inv:function(k,w,C){return l.pow(1-l.pow(1-k,1/C),1/w)},mean:function(k,w){return w*t.gammafn(1+1/k)*t.gammafn(w)/t.gammafn(1+1/k+w)},median:function(k,w){return l.pow(1-l.pow(2,-1/w),1/k)},mode:function(k,w){if(1<=k&&1<=w&&k!==1&&w!==1)return l.pow((k-1)/(k*w-1),1/k)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(k,w,C){return k<=0?0:l.exp(-l.log(k)-.5*l.log(2*l.PI)-l.log(C)-l.pow(l.log(k)-w,2)/(2*C*C))},cdf:function(k,w,C){return k<0?0:.5+.5*t.erf((l.log(k)-w)/l.sqrt(2*C*C))},inv:function(k,w,C){return l.exp(-1.4142135623730951*C*t.erfcinv(2*k)+w)},mean:function(k,w){return l.exp(k+w*w/2)},median:function(k){return l.exp(k)},mode:function(k,w){return l.exp(k-w*w)},sample:function(k,w){return l.exp(t.randn()*w+k)},variance:function(k,w){return(l.exp(w*w)-1)*l.exp(2*k+w*w)}}),t.extend(t.noncentralt,{pdf:function(k,w,C){return l.abs(C)<1e-14?t.studentt.pdf(k,w):l.abs(k)<1e-14?l.exp(t.gammaln((w+1)/2)-C*C/2-.5*l.log(l.PI*w)-t.gammaln(w/2)):w/k*(t.noncentralt.cdf(k*l.sqrt(1+2/w),w+2,C)-t.noncentralt.cdf(k,w,C))},cdf:function(k,w,C){if(l.abs(C)<1e-14)return t.studentt.cdf(k,w);var T=!1;k<0&&(T=!0,C=-C);for(var O=t.normal.cdf(-C,0,1),z=1e-14+1,A=z,E=k*k/(k*k+w),L=0,N=l.exp(-C*C/2),W=l.exp(-C*C/2-.5*l.log(2)-t.gammaln(1.5))*C;L<200||1e-14<A||1e-14<z;)A=z,0<L&&(N*=C*C/(2*L),W*=C*C/(2*(L+.5))),O+=.5*(z=N*t.beta.cdf(E,L+.5,w/2)+W*t.beta.cdf(E,L+1,w/2)),L++;return T?1-O:O}}),t.extend(t.normal,{pdf:function(k,w,C){return l.exp(-.5*l.log(2*l.PI)-l.log(C)-l.pow(k-w,2)/(2*C*C))},cdf:function(k,w,C){return .5*(1+t.erf((k-w)/l.sqrt(2*C*C)))},inv:function(k,w,C){return-1.4142135623730951*C*t.erfcinv(2*k)+w},mean:function(k){return k},median:function(k){return k},mode:function(k){return k},sample:function(k,w){return t.randn()*w+k},variance:function(k,w){return w*w}}),t.extend(t.pareto,{pdf:function(k,w,C){return k<w?0:C*l.pow(w,C)/l.pow(k,C+1)},cdf:function(k,w,C){return k<w?0:1-l.pow(w/k,C)},inv:function(k,w,C){return w/l.pow(1-k,1/C)},mean:function(k,w){if(!(w<=1))return w*l.pow(k,w)/(w-1)},median:function(k,w){return k*(w*l.SQRT2)},mode:function(k){return k},variance:function(k,w){if(!(w<=2))return k*k*w/(l.pow(w-1,2)*(w-2))}}),t.extend(t.studentt,{pdf:function(k,w){return w=1e100<w?1e100:w,1/(l.sqrt(w)*t.betafn(.5,w/2))*l.pow(1+k*k/w,-(w+1)/2)},cdf:function(k,w){var C=w/2;return t.ibeta((k+l.sqrt(k*k+w))/(2*l.sqrt(k*k+w)),C,C)},inv:function(k,w){var C=t.ibetainv(2*l.min(k,1-k),.5*w,.5),C=l.sqrt(w*(1-C)/C);return .5<k?C:-C},mean:function(k){return 1<k?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(k){return t.randn()*l.sqrt(k/(2*t.randg(k/2)))},variance:function(k){return 2<k?k/(k-2):1<k?1/0:void 0}}),t.extend(t.weibull,{pdf:function(k,w,C){return k<0||w<0||C<0?0:C/w*l.pow(k/w,C-1)*l.exp(-l.pow(k/w,C))},cdf:function(k,w,C){return k<0?0:1-l.exp(-l.pow(k/w,C))},inv:function(k,w,C){return w*l.pow(-l.log(1-k),1/C)},mean:function(k,w){return k*t.gammafn(1+1/w)},median:function(k,w){return k*l.pow(l.log(2),1/w)},mode:function(k,w){return w<=1?0:k*l.pow((w-1)/w,1/w)},sample:function(k,w){return k*l.pow(-l.log(t._random_fn()),1/w)},variance:function(k,w){return k*k*t.gammafn(1+2/w)-l.pow(t.weibull.mean(k,w),2)}}),t.extend(t.uniform,{pdf:function(k,w,C){return k<w||C<k?0:1/(C-w)},cdf:function(k,w,C){return k<w?0:k<C?(k-w)/(C-w):1},inv:function(k,w,C){return w+k*(C-w)},mean:function(k,w){return .5*(k+w)},median:function(k,w){return t.mean(k,w)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(k,w){return k/2+w/2+(w/2-k/2)*(2*t._random_fn()-1)},variance:function(k,w){return l.pow(w-k,2)/12}}),t.extend(t.binomial,{pdf:function(k,w,C){return C===0||C===1?w*C===k?1:0:t.combination(w,k)*l.pow(C,k)*l.pow(1-C,w-k)},cdf:function(k,w,C){if(k<0)return 0;if(w<=k)return 1;if(C<0||1<C||w<=0)return NaN;var T=C,O=(k=l.floor(k))+1,C=w-k,w=O+C,k=l.exp(t.gammaln(w)-t.gammaln(C)-t.gammaln(O)+O*l.log(T)+C*l.log(1-T)),O=T<(O+1)/(w+2)?k*_(T,O,C,1e-10):1-k*_(1-T,C,O,1e-10);return l.round(1e10*(1-O))/1e10}}),t.extend(t.negbin,{pdf:function(k,w,C){return k===k>>>0&&(k<0?0:t.combination(k+w-1,w-1)*l.pow(1-C,k)*l.pow(C,w))},cdf:function(k,w,C){var T=0,O=0;if(k<0)return 0;for(;O<=k;O++)T+=t.negbin.pdf(O,w,C);return T}}),t.extend(t.hypgeom,{pdf:function(k,w,C,T){if(k!=k|0)return!1;if(k<0||k<C-(w-T)||T<k||C<k)return 0;if(w<2*C)return w<2*T?t.hypgeom.pdf(w-C-T+k,w,w-C,w-T):t.hypgeom.pdf(T-k,w,w-C,T);if(w<2*T)return t.hypgeom.pdf(C-k,w,C,w-T);if(C<T)return t.hypgeom.pdf(k,w,T,C);for(var O=1,z=0,A=0;A<k;A++){for(;1<O&&z<T;)O*=1-C/(w-z),z++;O*=(T-A)*(C-A)/((A+1)*(w-C-T+A+1))}for(;z<T;z++)O*=1-C/(w-z);return l.min(1,l.max(0,O))},cdf:function(k,w,C,T){if(k<0||k<C-(w-T))return 0;if(T<=k||C<=k)return 1;if(w<2*C)return w<2*T?t.hypgeom.cdf(w-C-T+k,w,w-C,w-T):1-t.hypgeom.cdf(T-k-1,w,w-C,T);if(w<2*T)return 1-t.hypgeom.cdf(C-k-1,w,C,w-T);if(C<T)return t.hypgeom.cdf(k,w,T,C);for(var O=1,z=1,A=0,E=0;E<k;E++){for(;1<O&&A<T;){var L=1-C/(w-A);z*=L,O*=L,A++}O+=z*=(T-E)*(C-E)/((E+1)*(w-C-T+E+1))}for(;A<T;A++)O*=1-C/(w-A);return l.min(1,l.max(0,O))}}),t.extend(t.poisson,{pdf:function(k,w){return w<0||k%1!=0||k<0?0:l.pow(w,k)*l.exp(-w)/t.factorial(k)},cdf:function(k,w){var C=[],T=0;if(k<0)return 0;for(;T<=k;T++)C.push(t.poisson.pdf(T,w));return t.sum(C)},mean:function(k){return k},variance:function(k){return k},sampleSmall:function(k){for(var w=1,C=0,T=l.exp(-k);C++,w*=t._random_fn(),T<w;);return C-1},sampleLarge:function(k){for(var w,C,T,O=k,k=l.sqrt(O),z=l.log(O),A=.931+2.53*k,E=.02483*A-.059,L=1.1239+1.1328/(A-3.4),N=.9277-3.6224/(A-2);;)if(w=l.random()-.5,C=l.random(),T=.5-l.abs(w),w=l.floor((2*E/T+A)*w+O+.43),.07<=T&&C<=N||!(w<0||T<.013&&T<C)&&l.log(C)+l.log(L)-l.log(E/(T*T)+A)<=w*z-O-t.loggam(w+1))return w},sample:function(k){return k<10?this.sampleSmall(k):this.sampleLarge(k)}}),t.extend(t.triangular,{pdf:function(k,w,C,T){return C<=w||T<w||C<T?NaN:k<w||C<k?0:k<T?2*(k-w)/((C-w)*(T-w)):k===T?2/(C-w):2*(C-k)/((C-w)*(C-T))},cdf:function(k,w,C,T){return C<=w||T<w||C<T?NaN:k<=w?0:C<=k?1:k<=T?l.pow(k-w,2)/((C-w)*(T-w)):1-l.pow(C-k,2)/((C-w)*(C-T))},inv:function(k,w,C,T){return C<=w||T<w||C<T?NaN:k<=(T-w)/(C-w)?w+(C-w)*l.sqrt(k*((T-w)/(C-w))):w+(C-w)*(1-l.sqrt((1-k)*(1-(T-w)/(C-w))))},mean:function(k,w,C){return(k+w+C)/3},median:function(k,w,C){return C<=(k+w)/2?w-l.sqrt((w-k)*(w-C))/l.sqrt(2):(k+w)/2<C?k+l.sqrt((w-k)*(C-k))/l.sqrt(2):void 0},mode:function(k,w,C){return C},sample:function(k,w,C){var T=t._random_fn();return T<(C-k)/(w-k)?k+l.sqrt(T*(w-k)*(C-k)):w-l.sqrt((1-T)*(w-k)*(w-C))},variance:function(k,w,C){return(k*k+w*w+C*C-k*w-k*C-w*C)/18}}),t.extend(t.arcsine,{pdf:function(k,w,C){return C<=w?NaN:k<=w||C<=k?0:2/l.PI*l.pow(l.pow(C-w,2)-l.pow(2*k-w-C,2),-.5)},cdf:function(k,w,C){return k<w?0:k<C?2/l.PI*l.asin(l.sqrt((k-w)/(C-w))):1},inv:function(k,w,C){return w+(.5-.5*l.cos(l.PI*k))*(C-w)},mean:function(k,w){return w<=k?NaN:(k+w)/2},median:function(k,w){return w<=k?NaN:(k+w)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(k,w){return(k+w)/2+(w-k)/2*l.sin(2*l.PI*t.uniform.sample(0,1))},variance:function(k,w){return w<=k?NaN:l.pow(w-k,2)/8}}),t.extend(t.laplace,{pdf:function(k,w,C){return C<=0?0:l.exp(-l.abs(k-w)/C)/(2*C)},cdf:function(k,w,C){return C<=0?0:k<w?.5*l.exp((k-w)/C):1-.5*l.exp(-(k-w)/C)},mean:function(k){return k},median:function(k){return k},mode:function(k){return k},variance:function(k,w){return 2*w*w},sample:function(k,w){var C=t._random_fn()-.5;return k-w*((w=C)/l.abs(w))*l.log(1-2*l.abs(C))}}),t.extend(t.tukey,{cdf:function(k,w,C){var T=w,O=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],z=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(k<=0)return 0;if(C<2||T<2)return NaN;if(!Number.isFinite(k))return 1;if(25e3<C)return S(k,1,T);var w=.5*C,A=w*l.log(C)-C*l.log(2)-t.gammaln(w),E=w-1,L=.25*C,N=C<=100?1:C<=800?.5:C<=5e3?.25:.125;A+=l.log(N);for(var W=0,X=1;X<=50;X++){for(var te=0,ue=(2*X-1)*N,pe=1;pe<=16;pe++){var ne,me=8<pe?(ne=pe-8-1,A+E*l.log(ue+O[ne]*N)-(O[ne]*N+ue)*L):(ne=pe-1,A+E*l.log(ue-O[ne]*N)+(O[ne]*N-ue)*L);-30<=me&&(te+=S(8<pe?k*l.sqrt(.5*(O[ne]*N+ue)):k*l.sqrt(.5*(-O[ne]*N+ue)),1,T)*z[ne]*l.exp(me))}if(1<=X*N&&te<=1e-14)break;W+=te}if(1e-14<te)throw new Error("tukey.cdf failed to converge");return 1<W&&(W=1),W},inv:function(k,w,C){if(C<2||w<2)return NaN;if(k<0||1<k)return NaN;if(k===0)return 0;if(k===1)return 1/0;for(var T,O,z,A,E=(O=w,z=C,A=.5-.5*(T=k),A=(T=l.sqrt(l.log(1/(A*A))))+((((-453642210148e-16*T-.204231210125)*T-.342242088547)*T-1)*T+.322232421088)/((((.0038560700634*T+.10353775285)*T+.531103462366)*T+.588581570495)*T+.099348462606),z<120&&(A+=(A*A*A+A)/z/4),T=.8832-.2368*A,z<120&&(T+=-1.214/z+1.208*A/z),A*(T*l.log(O-1)+1.4142)),L=0<(te=t.tukey.cdf(E,w,C)-k)?l.max(0,E-1):E+1,N=t.tukey.cdf(L,w,C)-k,W=1;W<50;W++){var X=L-N*(L-E)/(N-te),te=N,E=L;if(X<0&&(X=0,N=-k),N=t.tukey.cdf(X,w,C)-k,L=X,l.abs(L-E)<1e-4)return X}throw new Error("tukey.inv failed to converge")}}),o=x,a=Math,f=Array.prototype.push,m=o.utils.isArray,o.extend({add:function(k,w){return I(w)?(I(w[0])||(w=[w]),o.map(k,function(C,T,O){return C+w[T][O]})):o.map(k,function(C){return C+w})},subtract:function(k,w){return I(w)?(I(w[0])||(w=[w]),o.map(k,function(C,T,O){return C-w[T][O]||0})):o.map(k,function(C){return C-w})},divide:function(k,w){return I(w)?(I(w[0])||(w=[w]),o.multiply(k,o.inv(w))):o.map(k,function(C){return C/w})},multiply:function(k,w){var C,T,O,z,A,E,L,N;if(k.length===void 0&&w.length===void 0)return k*w;if(A=k.length,E=k[0].length,L=o.zeros(A,O=I(w)?w[0].length:E),N=0,I(w)){for(;N<O;N++)for(C=0;C<A;C++){for(T=z=0;T<E;T++)z+=k[C][T]*w[T][N];L[C][N]=z}return A===1&&N===1?L[0][0]:L}return o.map(k,function(W){return W*w})},outer:function(k,w){return o.multiply(k.map(function(C){return[C]}),[w])},dot:function(k,w){I(k[0])||(k=[k]),I(w[0])||(w=[w]);for(var C,T,O=k[0].length===1&&k.length!==1?o.transpose(k):k,z=w[0].length===1&&w.length!==1?o.transpose(w):w,A=[],E=0,L=O.length,N=O[0].length;E<L;E++){for(A[E]=[],T=C=0;T<N;T++)C+=O[E][T]*z[E][T];A[E]=C}return A.length===1?A[0]:A},pow:function(k,w){return o.map(k,function(C){return a.pow(C,w)})},exp:function(k){return o.map(k,function(w){return a.exp(w)})},log:function(k){return o.map(k,function(w){return a.log(w)})},abs:function(k){return o.map(k,function(w){return a.abs(w)})},norm:function(k,w){var C=0,T=0;for(isNaN(w)&&(w=2),I(k[0])&&(k=k[0]);T<k.length;T++)C+=a.pow(a.abs(k[T]),w);return a.pow(C,1/w)},angle:function(k,w){return a.acos(o.dot(k,w)/(o.norm(k)*o.norm(w)))},aug:function(k,w){for(var C=[],T=0;T<k.length;T++)C.push(k[T].slice());for(T=0;T<C.length;T++)f.apply(C[T],w[T]);return C},inv:function(k){for(var w,C=k.length,T=k[0].length,O=o.identity(C,T),z=o.gauss_jordan(k,O),A=[],E=0;E<C;E++)for(A[E]=[],w=T;w<z[0].length;w++)A[E][w-T]=z[E][w];return A},det:function(k){var w,C=k.length,T=2*C,O=new Array(T),z=C-1,A=T-1,E=z-C+1,L=A,N=0,W=0;if(C===2)return k[0][0]*k[1][1]-k[0][1]*k[1][0];for(;N<T;N++)O[N]=1;for(N=0;N<C;N++){for(w=0;w<C;w++)O[E<0?E+C:E]*=k[N][w],O[L<C?L+C:L]*=k[N][w],E++,L--;E=--z-C+1,L=--A}for(N=0;N<C;N++)W+=O[N];for(;N<T;N++)W-=O[N];return W},gauss_elimination:function(k,w){for(var C,T,O,z,A=0,E=0,L=k.length,N=k[0].length,W=0,X=[],te=(k=o.aug(k,w))[0].length,A=0;A<L;A++){for(T=k[A][A],z=(E=A)+1;z<N;z++)T<a.abs(k[z][A])&&(T=k[z][A],E=z);if(E!=A)for(z=0;z<te;z++)O=k[A][z],k[A][z]=k[E][z],k[E][z]=O;for(E=A+1;E<L;E++)for(C=k[E][A]/k[A][A],z=A;z<te;z++)k[E][z]=k[E][z]-C*k[A][z]}for(A=L-1;0<=A;A--){for(W=0,E=A+1;E<=L-1;E++)W+=X[E]*k[A][E];X[A]=(k[A][te-1]-W)/k[A][A]}return X},gauss_jordan:function(k,w){for(var C,T=o.aug(k,w),O=T.length,z=T[0].length,A=0,E=0;E<O;E++){for(var L=E,N=E+1;N<O;N++)a.abs(T[N][E])>a.abs(T[L][E])&&(L=N);var W=T[E];for(T[E]=T[L],T[L]=W,N=E+1;N<O;N++)for(A=T[N][E]/T[E][E],C=E;C<z;C++)T[N][C]-=T[E][C]*A}for(E=O-1;0<=E;E--){for(A=T[E][E],N=0;N<E;N++)for(C=z-1;E-1<C;C--)T[N][C]-=T[E][C]*T[N][E]/A;for(T[E][E]/=A,C=O;C<z;C++)T[E][C]/=A}return T},triaUpSolve:function(k,w){var C,T=k[0].length,O=o.zeros(1,T)[0],z=!1;return w[0].length!=null&&(w=w.map(function(A){return A[0]}),z=!0),o.arange(T-1,-1,-1).forEach(function(A){C=o.arange(A+1,T).map(function(E){return O[E]*k[A][E]}),O[A]=(w[A]-o.sum(C))/k[A][A]}),z?O.map(function(A){return[A]}):O},triaLowSolve:function(k,w){var C,T=k[0].length,O=o.zeros(1,T)[0],z=!1;return w[0].length!=null&&(w=w.map(function(A){return A[0]}),z=!0),o.arange(T).forEach(function(A){C=o.arange(A).map(function(E){return k[A][E]*O[E]}),O[A]=(w[A]-o.sum(C))/k[A][A]}),z?O.map(function(A){return[A]}):O},lu:function(k){var w,C=k.length,T=o.identity(C),O=o.zeros(k.length,k[0].length);return o.arange(C).forEach(function(z){O[0][z]=k[0][z]}),o.arange(1,C).forEach(function(z){o.arange(z).forEach(function(A){w=o.arange(A).map(function(E){return T[z][E]*O[E][A]}),T[z][A]=(k[z][A]-o.sum(w))/O[A][A]}),o.arange(z,C).forEach(function(A){w=o.arange(z).map(function(E){return T[z][E]*O[E][A]}),O[z][A]=k[w.length][A]-o.sum(w)})}),[T,O]},cholesky:function(k){var w,C=k.length,T=o.zeros(k.length,k[0].length);return o.arange(C).forEach(function(O){w=o.arange(O).map(function(z){return a.pow(T[O][z],2)}),T[O][O]=a.sqrt(k[O][O]-o.sum(w)),o.arange(O+1,C).forEach(function(z){w=o.arange(O).map(function(A){return T[O][A]*T[z][A]}),T[z][O]=(k[O][z]-o.sum(w))/T[O][O]})}),T},gauss_jacobi:function(k,w,C,T){for(var O,z,A,E,L=0,N=0,W=k.length,X=[],te=[],ue=[];L<W;L++)for(X[L]=[],te[L]=[],ue[L]=[],N=0;N<W;N++)N<L?(X[L][N]=k[L][N],te[L][N]=ue[L][N]=0):L<N?(te[L][N]=k[L][N],X[L][N]=ue[L][N]=0):(ue[L][N]=k[L][N],X[L][N]=te[L][N]=0);for(A=o.multiply(o.multiply(o.inv(ue),o.add(X,te)),-1),z=o.multiply(o.inv(ue),w),O=C,E=o.add(o.multiply(A,C),z),L=2;a.abs(o.norm(o.subtract(E,O)))>T;)O=E,E=o.add(o.multiply(A,O),z),L++;return E},gauss_seidel:function(k,w,C,T){for(var O,z,A,E,L,N=0,W=k.length,X=[],te=[],ue=[];N<W;N++)for(X[N]=[],te[N]=[],ue[N]=[],O=0;O<W;O++)O<N?(X[N][O]=k[N][O],te[N][O]=ue[N][O]=0):N<O?(te[N][O]=k[N][O],X[N][O]=ue[N][O]=0):(ue[N][O]=k[N][O],X[N][O]=te[N][O]=0);for(E=o.multiply(o.multiply(o.inv(o.add(ue,X)),te),-1),A=o.multiply(o.inv(o.add(ue,X)),w),z=C,L=o.add(o.multiply(E,C),A),N=2;a.abs(o.norm(o.subtract(L,z)))>T;)z=L,L=o.add(o.multiply(E,z),A),N+=1;return L},SOR:function(k,w,C,T,O){for(var z,A,E,L,N,W=0,X=k.length,te=[],ue=[],pe=[];W<X;W++)for(te[W]=[],ue[W]=[],pe[W]=[],z=0;z<X;z++)z<W?(te[W][z]=k[W][z],ue[W][z]=pe[W][z]=0):W<z?(ue[W][z]=k[W][z],te[W][z]=pe[W][z]=0):(pe[W][z]=k[W][z],te[W][z]=ue[W][z]=0);for(L=o.multiply(o.inv(o.add(pe,o.multiply(te,O))),o.subtract(o.multiply(pe,1-O),o.multiply(ue,O))),E=o.multiply(o.multiply(o.inv(o.add(pe,o.multiply(te,O))),w),O),A=C,N=o.add(o.multiply(L,C),E),W=2;a.abs(o.norm(o.subtract(N,A)))>T;)A=N,N=o.add(o.multiply(L,A),E),W++;return N},householder:function(k){for(var w,C,T,O,z,A=k.length,E=k[0].length,L=0,N=[];L<A-1;L++){for(C=0,z=L+1;z<E;z++)C+=k[z][L]*k[z][L];for(C=(0<k[L+1][L]?-1:1)*a.sqrt(C),T=a.sqrt((C*C-k[L+1][L]*C)/2),(N=o.zeros(A,1))[L+1][0]=(k[L+1][L]-C)/(2*T),O=L+2;O<A;O++)N[O][0]=k[O][L]/(2*T);w=o.subtract(o.identity(A,E),o.multiply(o.multiply(N,o.transpose(N)),2)),k=o.multiply(w,o.multiply(k,w))}return k},QR:(s=o.sum,u=o.arange,function(k){var w,C,T,O=k.length,z=k[0].length,A=o.zeros(z,z);for(k=o.copy(k),C=0;C<z;C++){for(A[C][C]=a.sqrt(s(u(O).map(function(E){return k[E][C]*k[E][C]}))),w=0;w<O;w++)k[w][C]=k[w][C]/A[C][C];for(T=C+1;T<z;T++)for(A[C][T]=s(u(O).map(function(E){return k[E][C]*k[E][T]})),w=0;w<O;w++)k[w][T]=k[w][T]-k[w][C]*A[C][T]}return[k,A]}),lstsq:function(k,w){var C=!1;w[0].length===void 0&&(w=w.map(function(E){return[E]}),C=!0);var T,O,z=(A=o.QR(k))[0],A=A[1],k=k[0].length,z=o.slice(z,{col:{end:k}}),k=o.slice(A,{row:{end:k}}),k=(T=k,k=(T=o.copy(T)).length,O=o.identity(k),o.arange(k-1,-1,-1).forEach(function(E){o.sliceAssign(O,{row:E},o.divide(o.slice(O,{row:E}),T[E][E])),o.sliceAssign(T,{row:E},o.divide(o.slice(T,{row:E}),T[E][E])),o.arange(E).forEach(function(L){var N=o.multiply(T[L][E],-1),W=o.slice(T,{row:L}),X=o.multiply(o.slice(T,{row:E}),N);o.sliceAssign(T,{row:L},o.add(W,X)),X=o.slice(O,{row:L}),N=o.multiply(o.slice(O,{row:E}),N),o.sliceAssign(O,{row:L},o.add(X,N))})}),O);return(z=o.transpose(z))[0].length===void 0&&(z=[z]),(w=o.multiply(o.multiply(k,z),w)).length===void 0&&(w=[[w]]),C?w.map(function(E){return E[0]}):w},jacobi:function(k){for(var w,C,T,O,z,A,E,L=1,N=k.length,W=o.identity(N,N),X=[];L===1;){for(z=k[0][1],O=1,w=T=0;w<N;w++)for(C=0;C<N;C++)w!=C&&z<a.abs(k[w][C])&&(z=a.abs(k[w][C]),T=w,O=C);for(A=k[T][T]===k[O][O]?0<k[T][O]?a.PI/4:-a.PI/4:a.atan(2*k[T][O]/(k[T][T]-k[O][O]))/2,(E=o.identity(N,N))[T][T]=a.cos(A),E[T][O]=-a.sin(A),E[O][T]=a.sin(A),E[O][O]=a.cos(A),W=o.multiply(W,E),k=o.multiply(o.multiply(o.inv(E),k),E),L=0,w=1;w<N;w++)for(C=1;C<N;C++)w!=C&&.001<a.abs(k[w][C])&&(L=1)}for(w=0;w<N;w++)X.push(k[w][w]);return[W,X]},rungekutta:function(k,w,C,T,O,z){var A,E,L;if(z===2)for(;T<=C;)O=O+((A=w*k(T,O))+(E=w*k(T+w,O+A)))/2,T+=w;if(z===4)for(;T<=C;)O=O+((A=w*k(T,O))+2*(E=w*k(T+w/2,O+A/2))+2*(L=w*k(T+w/2,O+E/2))+w*k(T+w,O+L))/6,T+=w;return O},romberg:function(k,w,C,T){for(var O,z,A,E,L,N=0,W=(C-w)/2,X=[],te=[],ue=[];N<T/2;){for(L=k(w),A=w,E=0;A<=C;A+=W,E++)X[E]=A;for(O=X.length,A=1;A<O-1;A++)L+=(A%2!=0?4:2)*k(X[A]);L=W/3*(L+k(C)),ue[N]=L,W/=2,N++}for(z=ue.length,O=1;z!==1;){for(A=0;A<z-1;A++)te[A]=(a.pow(4,O)*ue[A+1]-ue[A])/(a.pow(4,O)-1);z=te.length,ue=te,te=[],O++}return ue},richardson:function(k,w,C,T){function O(pe,ne){for(var me,Q=0,we=pe.length;Q<we;Q++)pe[Q]===ne&&(me=Q);return me}for(var z,A,E,L,N,W=a.abs(C-k[O(k,C)+1]),X=0,te=[],ue=[];W<=T;)z=O(k,C+T),A=O(k,C),te[X]=(w[z]-2*w[A]+w[2*A-z])/(T*T),T/=2,X++;for(L=te.length,E=1;L!=1;){for(N=0;N<L-1;N++)ue[N]=(a.pow(4,E)*te[N+1]-te[N])/(a.pow(4,E)-1);L=ue.length,te=ue,ue=[],E++}return te},simpson:function(k,w,C,T){for(var O,z=(C-w)/T,A=k(w),E=[],L=w,N=0,W=1;L<=C;L+=z,N++)E[N]=L;for(O=E.length;W<O-1;W++)A+=(W%2!=0?4:2)*k(E[W]);return z/3*(A+k(C))},hermite:function(k,w,C,T){for(var O,z=k.length,A=0,E=0,L=[],N=[],W=[],X=[];E<z;E++){for(L[E]=1,O=0;O<z;O++)E!=O&&(L[E]*=(T-k[O])/(k[E]-k[O]));for(O=N[E]=0;O<z;O++)E!=O&&(N[E]+=1/(k[E]-k[O]));W[E]=(1-2*(T-k[E])*N[E])*(L[E]*L[E]),X[E]=(T-k[E])*(L[E]*L[E]),A+=W[E]*w[E]+X[E]*C[E]}return A},lagrange:function(k,w,C){for(var T,O,z=0,A=0,E=k.length;A<E;A++){for(O=w[A],T=0;T<E;T++)A!=T&&(O*=(C-k[T])/(k[A]-k[T]));z+=O}return z},cubic_spline:function(k,w,C){for(var T,O,z=k.length,A=0,E=[],L=[],N=[],W=[],X=[],te=[];A<z-1;A++)W[A]=k[A+1]-k[A];for(N[0]=0,A=1;A<z-1;A++)N[A]=3/W[A]*(w[A+1]-w[A])-3/W[A-1]*(w[A]-w[A-1]);for(A=1;A<z-1;A++)E[A]=[],L[A]=[],E[A][A-1]=W[A-1],E[A][A]=2*(W[A-1]+W[A]),E[A][A+1]=W[A],L[A][0]=N[A];for(O=o.multiply(o.inv(E),L),T=0;T<z-1;T++)X[T]=(w[T+1]-w[T])/W[T]-W[T]*(O[T+1][0]+2*O[T][0])/3,te[T]=(O[T+1][0]-O[T][0])/(3*W[T]);for(T=0;T<z&&!(k[T]>C);T++);return w[--T]+(C-k[T])*X[T]+o.sq(C-k[T])*O[T]+(C-k[T])*o.sq(C-k[T])*te[T]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(k){for(var w,C,T,O,z,A,E=k.length,L=k[0].length,N=0,W=[],X=[],te=[],ue=[],pe=[],ne=[],N=0;N<E;N++)W[N]=o.sum(k[N])/L;for(N=0;N<L;N++)for(ue[N]=[],w=0;w<E;w++)ue[N][w]=k[w][N]-W[w];for(ue=o.transpose(ue),N=0;N<E;N++)for(pe[N]=[],w=0;w<E;w++)pe[N][w]=o.dot([ue[N]],[ue[w]])/(L-1);for(A=(T=o.jacobi(pe))[0],X=T[1],ne=o.transpose(A),N=0;N<X.length;N++)for(w=N;w<X.length;w++)X[N]<X[w]&&(C=X[N],X[N]=X[w],X[w]=C,O=ne[N],ne[N]=ne[w],ne[w]=O);for(z=o.transpose(ue),N=0;N<E;N++)for(te[N]=[],w=0;w<z.length;w++)te[N][w]=o.dot([ne[N]],[z[w]]);return[k,X,ne,te]}}),function(k){for(var w=0;w<k.length;w++)(function(C){o.fn[C]=function(T,O){var z=this;return O?(setTimeout(function(){O.call(z,o.fn[C].call(z,T))},15),this):typeof o[C](this,T)=="number"?o[C](this,T):o(o[C](this,T))}})(k[w])}("add divide multiply subtract dot pow exp log abs norm angle".split(" ")),d=x,p=Math,b=[].slice,g=d.utils.isNumber,v=d.utils.isArray,d.extend({zscore:function(){var k=b.call(arguments);return g(k[1])?(k[0]-k[1])/k[2]:(k[0]-d.mean(k[1]))/d.stdev(k[1],k[2])},ztest:function(){var k,w=b.call(arguments);return v(w[1])?(k=d.zscore(w[0],w[1],w[3]),w[2]===1?d.normal.cdf(-p.abs(k),0,1):2*d.normal.cdf(-p.abs(k),0,1)):2<w.length?(k=d.zscore(w[0],w[1],w[2]),w[3]===1?d.normal.cdf(-p.abs(k),0,1):2*d.normal.cdf(-p.abs(k),0,1)):(k=w[0],w[1]===1?d.normal.cdf(-p.abs(k),0,1):2*d.normal.cdf(-p.abs(k),0,1))}}),d.extend(d.fn,{zscore:function(k,w){return(k-this.mean())/this.stdev(w)},ztest:function(k,w,C){return C=p.abs(this.zscore(k,C)),w===1?d.normal.cdf(-C,0,1):2*d.normal.cdf(-C,0,1)}}),d.extend({tscore:function(){var k=b.call(arguments);return k.length===4?(k[0]-k[1])/(k[2]/p.sqrt(k[3])):(k[0]-d.mean(k[1]))/(d.stdev(k[1],!0)/p.sqrt(k[1].length))},ttest:function(){var k,w=b.call(arguments);return w.length===5?(k=p.abs(d.tscore(w[0],w[1],w[2],w[3])),w[4]===1?d.studentt.cdf(-k,w[3]-1):2*d.studentt.cdf(-k,w[3]-1)):g(w[1])?(k=p.abs(w[0]),w[2]==1?d.studentt.cdf(-k,w[1]-1):2*d.studentt.cdf(-k,w[1]-1)):(k=p.abs(d.tscore(w[0],w[1])),w[2]==1?d.studentt.cdf(-k,w[1].length-1):2*d.studentt.cdf(-k,w[1].length-1))}}),d.extend(d.fn,{tscore:function(k){return(k-this.mean())/(this.stdev(!0)/p.sqrt(this.cols()))},ttest:function(k,w){return w===1?1-d.studentt.cdf(p.abs(this.tscore(k)),this.cols()-1):2*d.studentt.cdf(-p.abs(this.tscore(k)),this.cols()-1)}}),d.extend({anovafscore:function(){var k,w,C,T,O,z,A,E,L=b.call(arguments);if(L.length===1){for(O=new Array(L[0].length),A=0;A<L[0].length;A++)O[A]=L[0][A];L=O}for(w=new Array,A=0;A<L.length;A++)w=w.concat(L[A]);for(C=d.mean(w),A=k=0;A<L.length;A++)k+=L[A].length*p.pow(d.mean(L[A])-C,2);for(k/=L.length-1,A=z=0;A<L.length;A++)for(T=d.mean(L[A]),E=0;E<L[A].length;E++)z+=p.pow(L[A][E]-T,2);return k/(z/=w.length-L.length)},anovaftest:function(){var k,w=b.call(arguments);if(g(w[0]))return 1-d.centralF.cdf(w[0],w[1],w[2]);for(var C=d.anovafscore(w),T=w.length-1,O=0,z=0;z<w.length;z++)O+=w[z].length;return k=O-T-1,1-d.centralF.cdf(C,T,k)},ftest:function(k,w,C){return 1-d.centralF.cdf(k,w,C)}}),d.extend(d.fn,{anovafscore:function(){return d.anovafscore(this.toArray())},anovaftes:function(){for(var k=0,w=0;w<this.length;w++)k+=this[w].length;return d.ftest(this.anovafscore(),this.length-1,k-this.length)}}),d.extend({qscore:function(){var k,w,C,T,O=b.call(arguments),O=g(O[0])?(k=O[0],w=O[1],C=O[2],T=O[3],O[4]):(k=d.mean(O[0]),w=d.mean(O[1]),C=O[0].length,T=O[1].length,O[2]);return p.abs(k-w)/(O*p.sqrt((1/C+1/T)/2))},qtest:function(){var k,w=b.call(arguments),C=(w=w.length===3?(k=w[0],w.slice(1)):w.length===7?(k=d.qscore(w[0],w[1],w[2],w[3],w[4]),w.slice(5)):(k=d.qscore(w[0],w[1],w[2]),w.slice(3)))[0],w=w[1];return 1-d.tukey.cdf(k,w,C-w)},tukeyhsd:function(k){for(var w=d.pooledstdev(k),C=k.map(function(L){return d.mean(L)}),T=k.reduce(function(L,N){return L+N.length},0),O=[],z=0;z<k.length;++z)for(var A=z+1;A<k.length;++A){var E=d.qtest(C[z],C[A],k[z].length,k[A].length,w,T,k.length);O.push([[z,A],E])}return O}}),d.extend({normalci:function(){var k=b.call(arguments),w=new Array(2),C=k.length===4?p.abs(d.normal.inv(k[1]/2,0,1)*k[2]/p.sqrt(k[3])):p.abs(d.normal.inv(k[1]/2,0,1)*d.stdev(k[2])/p.sqrt(k[2].length));return w[0]=k[0]-C,w[1]=k[0]+C,w},tci:function(){var k=b.call(arguments),w=new Array(2),C=k.length===4?p.abs(d.studentt.inv(k[1]/2,k[3]-1)*k[2]/p.sqrt(k[3])):p.abs(d.studentt.inv(k[1]/2,k[2].length-1)*d.stdev(k[2],!0)/p.sqrt(k[2].length));return w[0]=k[0]-C,w[1]=k[0]+C,w},significant:function(k,w){return k<w}}),d.extend(d.fn,{normalci:function(k,w){return d.normalci(k,w,this.toArray())},tci:function(k,w){return d.tci(k,w,this.toArray())}}),d.extend(d.fn,{oneSidedDifferenceOfProportions:function(k,w,C,T){return T=P(k,w,C,T),d.ztest(T,1)},twoSidedDifferenceOfProportions:function(k,w,C,T){return T=P(k,w,C,T),d.ztest(T,2)}}),x.models={ols:function(k,w){var C=F(k,w),T=D(C),k={F_statistic:k=(O=C).R2/O.df_model/((1-O.R2)/O.df_resid),pvalue:1-(w=k,k=O.df_model,O=O.df_resid,x.beta.cdf(w/(O/k+w),k/2,O/2))},O=1-(1-C.R2)*((C.nobs-1)/C.df_resid);return C.t=T,C.f=k,C.adjust_R2=O,C}},x.extend({buildxmatrix:function(){for(var k=new Array(arguments.length),w=0;w<arguments.length;w++)k[w]=[1].concat(arguments[w]);return x(k)},builddxmatrix:function(){for(var k=new Array(arguments[0].length),w=0;w<arguments[0].length;w++)k[w]=[1].concat(arguments[0][w]);return x(k)},buildjxmatrix:function(k){for(var w=new Array(k.length),C=0;C<k.length;C++)w[C]=k[C];return x.builddxmatrix(w)},buildymatrix:function(k){return x(k).transpose()},buildjymatrix:function(k){return k.transpose()},matrixmult:function(k,w){var C,T,O,z,A;if(k.cols()==w.rows()){if(1<w.rows()){for(z=[],C=0;C<k.rows();C++)for(z[C]=[],T=0;T<w.cols();T++){for(O=A=0;O<k.cols();O++)A+=k.toArray()[C][O]*w.toArray()[O][T];z[C][T]=A}return x(z)}for(z=[],C=0;C<k.rows();C++)for(z[C]=[],T=0;T<w.cols();T++){for(O=A=0;O<k.cols();O++)A+=k.toArray()[C][O]*w.toArray()[T];z[C][T]=A}return x(z)}},regress:function(k,w){var C=x.xtranspxinv(k),k=k.transpose(),k=x.matrixmult(x(C),k);return x.matrixmult(k,w)},regresst:function(k,w,C){var T=x.regress(k,w),O={anova:{}},z=x.jMatYBar(k,T);O.yBar=z;var A=w.mean();O.anova.residuals=x.residuals(w,z),O.anova.ssr=x.ssr(z,A),O.anova.msr=O.anova.ssr/(k[0].length-1),O.anova.sse=x.sse(w,z),O.anova.mse=O.anova.sse/(w.length-(k[0].length-1)-1),O.anova.sst=x.sst(w,A),O.anova.mst=O.anova.sst/(w.length-1),O.anova.r2=1-O.anova.sse/O.anova.sst,O.anova.r2<0&&(O.anova.r2=0),O.anova.fratio=O.anova.msr/O.anova.mse,O.anova.pvalue=x.anovaftest(O.anova.fratio,k[0].length-1,w.length-(k[0].length-1)-1),O.anova.rmse=Math.sqrt(O.anova.mse),O.anova.r2adj=1-O.anova.mse/O.anova.mst,O.anova.r2adj<0&&(O.anova.r2adj=0),O.stats=new Array(k[0].length);for(var E,L,N,W=x.xtranspxinv(k),X=0;X<T.length;X++)E=Math.sqrt(O.anova.mse*Math.abs(W[X][X])),L=Math.abs(T[X]/E),N=x.ttest(L,w.length-k[0].length-1,C),O.stats[X]=[T[X],E,L,N];return O.regress=T,O},xtranspx:function(k){return x.matrixmult(k.transpose(),k)},xtranspxinv:function(k){return k=x.matrixmult(k.transpose(),k),x.inv(k)},jMatYBar:function(k,w){return w=x.matrixmult(k,w),new x(w)},residuals:function(k,w){return x.matrixsubtract(k,w)},ssr:function(k,w){for(var C=0,T=0;T<k.length;T++)C+=Math.pow(k[T]-w,2);return C},sse:function(k,w){for(var C=0,T=0;T<k.length;T++)C+=Math.pow(k[T]-w[T],2);return C},sst:function(k,w){for(var C=0,T=0;T<k.length;T++)C+=Math.pow(k[T]-w,2);return C},matrixsubtract:function(k,w){for(var C=new Array(k.length),T=0;T<k.length;T++){C[T]=new Array(k[T].length);for(var O=0;O<k[T].length;O++)C[T][O]=k[T][O]-w[T][O]}return x(C)}}),x.jStat=x});var E_=function(e){var n={};function t(l){if(n[l])return n[l].exports;var o=n[l]={i:l,l:!1,exports:{}};return e[l].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(l,o,a){t.o(l,o)||Object.defineProperty(l,o,{enumerable:!0,get:a})},t.r=function(l){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},t.t=function(l,o){if(1&o&&(l=t(l)),8&o||4&o&&typeof l=="object"&&l&&l.__esModule)return l;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:l}),2&o&&typeof l!="string")for(var s in l)t.d(a,s,function(u){return l[u]}.bind(null,s));return a},t.n=function(l){var o=l&&l.__esModule?function(){return l.default}:function(){return l};return t.d(o,"a",o),o},t.o=function(l,o){return Object.prototype.hasOwnProperty.call(l,o)},t.p="",t(t.s=29)}([function(e,n,t){"use strict";function l(u,f){return u<<f|u>>>32-f|0}function o(u,f){return u>>>f|u<<32-f|0}function a(u,f,m){return m===32?f:32<m?a(f,u,m-32):4294967295&(u>>>m|f<<32-m)}function s(u,f,m){return m===32?u:32<m?s(f,u,m-32):4294967295&(f>>>m|u<<32-m)}t.d(n,"a",function(){return l}),t.d(n,"b",function(){return o}),t.d(n,"d",function(){return s}),t.d(n,"c",function(){return a})},function(e,n,t){"use strict";function l(o){for(var a="",s=0,u=o.length;s<u;s++){var f=o.charCodeAt(s);f<128?a+=String.fromCharCode(f):(f<2048?a+=String.fromCharCode(192|f>>6):(f<55296||57344<=f?a+=String.fromCharCode(224|f>>12):(s++,f=65536+((1023&f)<<10|1023&o.charCodeAt(s)),a+=String.fromCharCode(240|f>>18),a+=String.fromCharCode(128|f>>12&63)),a+=String.fromCharCode(128|f>>6&63)),a+=String.fromCharCode(128|63&f))}return a}t.d(n,"a",function(){return l})},function(e,n,t){"use strict";function l(o){for(var a="",s=0,u=o.length;s<u;s++)a+=(o.charCodeAt(s)<16?"0":"")+o.charCodeAt(s).toString(16);return a}t.d(n,"a",function(){return l})},function(e,n,t){"use strict";function l(u){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function o(u){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}function a(u,f){return(a=Object.setPrototypeOf||function(m,d){return m.__proto__=d,m})(u,f)}(function(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),f&&a(u,f)})(s,t(4).a),function(u,f){for(var m=0;m<f.length;m++){var d=f[m];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}(s.prototype,[{key:"process",value:function(){for(;this.state.message.length>=this.blockSizeInBytes;){this.blockUnits=[];for(var u=0;u<this.blockSizeInBytes;u+=4)this.blockUnits.push(this.state.message.charCodeAt(u)<<24|this.state.message.charCodeAt(u+1)<<16|this.state.message.charCodeAt(u+2)<<8|this.state.message.charCodeAt(u+3));this.state.message=this.state.message.substr(this.blockSizeInBytes),this.processBlock(this.blockUnits)}}},{key:"processBlock",value:function(u){}},{key:"getStateHash",value:function(u){u=u||this.state.hash.length;for(var f="",m=0;m<u;m++)f+=String.fromCharCode(this.state.hash[m]>>24&255)+String.fromCharCode(this.state.hash[m]>>16&255)+String.fromCharCode(this.state.hash[m]>>8&255)+String.fromCharCode(255&this.state.hash[m]);return f}},{key:"addLengthBits",value:function(){this.state.message+="\0\0\0"+String.fromCharCode(this.state.length>>29&255)+String.fromCharCode(this.state.length>>21&255)+String.fromCharCode(this.state.length>>13&255)+String.fromCharCode(this.state.length>>5&255)+String.fromCharCode(this.state.length<<3&255)}}]),t=s;function s(u){var f;return function(m){if(!(m instanceof s))throw new TypeError("Cannot call a class as a function")}(this),f=this,(u=!(u=o(s).call(this,u))||l(u)!=="object"&&typeof u!="function"?function(){if(f!==void 0)return f;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():u).unitOrder=1,u.blockUnits=[],u}n.a=t},function(e,n,t){"use strict";var l=(function(a,s){for(var u=0;u<s.length;u++){var f=s[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(a,f.key,f)}}(o.prototype,[{key:"reset",value:function(){this.state={},this.state.message="",this.state.length=0}},{key:"getState",value:function(){return JSON.parse(JSON.stringify(this.state))}},{key:"setState",value:function(a){this.state=a}},{key:"update",value:function(a){this.state.message+=a,this.state.length+=a.length,this.process()}},{key:"process",value:function(){}},{key:"finalize",value:function(){return""}},{key:"getStateHash",value:function(a){return""}},{key:"addPaddingPKCS7",value:function(a){this.state.message+=new Array(a+1).join(String.fromCharCode(a))}},{key:"addPaddingISO7816",value:function(a){this.state.message+="\x80"+new Array(a).join("\0")}},{key:"addPaddingZero",value:function(a){this.state.message+=new Array(a+1).join("\0")}}]),o);function o(a){(function(s){if(!(s instanceof o))throw new TypeError("Cannot call a class as a function")})(this),this.unitSize=4,this.unitOrder=0,this.blockSize=16,this.blockSizeInBytes=this.blockSize*this.unitSize,this.options=a||{},this.reset()}n.a=l},function(e,n,t){"use strict";function l(u){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(u)}function o(u){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(f){return f.__proto__||Object.getPrototypeOf(f)})(u)}function a(u,f){return(a=Object.setPrototypeOf||function(m,d){return m.__proto__=d,m})(u,f)}(function(u,f){if(typeof f!="function"&&f!==null)throw new TypeError("Super expression must either be null or a function");u.prototype=Object.create(f&&f.prototype,{constructor:{value:u,writable:!0,configurable:!0}}),f&&a(u,f)})(s,t(4).a),function(u,f){for(var m=0;m<f.length;m++){var d=f[m];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(u,d.key,d)}}(s.prototype,[{key:"process",value:function(){for(;this.state.message.length>=this.blockSizeInBytes;){this.blockUnits=[];for(var u=0;u<this.blockSizeInBytes;u+=4)this.blockUnits.push(this.state.message.charCodeAt(u)|this.state.message.charCodeAt(u+1)<<8|this.state.message.charCodeAt(u+2)<<16|this.state.message.charCodeAt(u+3)<<24);this.state.message=this.state.message.substr(this.blockSizeInBytes),this.processBlock(this.blockUnits)}}},{key:"processBlock",value:function(u){}},{key:"getStateHash",value:function(u){u=u||this.state.hash.length;for(var f="",m=0;m<u;m++)f+=String.fromCharCode(255&this.state.hash[m])+String.fromCharCode(this.state.hash[m]>>8&255)+String.fromCharCode(this.state.hash[m]>>16&255)+String.fromCharCode(this.state.hash[m]>>24&255);return f}},{key:"addLengthBits",value:function(){this.state.message+=String.fromCharCode(this.state.length<<3&255)+String.fromCharCode(this.state.length>>5&255)+String.fromCharCode(this.state.length>>13&255)+String.fromCharCode(this.state.length>>21&255)+String.fromCharCode(this.state.length>>29&255)+"\0\0\0"}}]),t=s;function s(u){var f;return function(m){if(!(m instanceof s))throw new TypeError("Cannot call a class as a function")}(this),f=this,(u=!(u=o(s).call(this,u))||l(u)!=="object"&&typeof u!="function"?function(){if(f!==void 0)return f;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():u).blockUnits=[],u}n.a=t},function(e,n,t){"use strict";var l=t(3),o=t(0);function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(p)}function s(p,b,g){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(v,x,_){if(v=function(S,I){for(;!Object.prototype.hasOwnProperty.call(S,I)&&(S=u(S))!==null;);return S}(v,x),v)return x=Object.getOwnPropertyDescriptor(v,x),x.get?x.get.call(_):x.value})(p,b,g||p)}function u(p){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(p)}function f(p,b){return(f=Object.setPrototypeOf||function(g,v){return g.__proto__=v,g})(p,b)}var m=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],l=(function(p,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(b&&b.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),b&&f(p,b)}(d,l.a),l=[{key:"reset",value:function(){switch(s(u(d.prototype),"reset",this).call(this),this.options.length){case 384:this.state.hash=[-876896931,-1056596264,1654270250,914150663,-1856437926,812702999,355462360,-150054599,1731405415,-4191439,-1900787065,1750603025,-619958771,1694076839,1203062813,-1090891868];break;case 512:this.state.hash=[1779033703,-205731576,-1150833019,-2067093701,1013904242,-23791573,-1521486534,1595750129,1359893119,-1377402159,-1694144372,725511199,528734635,-79577749,1541459225,327033209];break;default:for(var p=new d,b=0;b<16;b++)p.state.hash[b]=2779096485^p.state.hash[b];p.update("SHA-512/"+this.options.length);var g=p.finalize();this.state.hash=[];for(var v=0;v<64;v+=4)this.state.hash.push(g.charCodeAt(v)<<24|g.charCodeAt(v+1)<<16|g.charCodeAt(v+2)<<8|g.charCodeAt(v+3))}}},{key:"processBlock",value:function(p){for(var b,g,v,x,_=this.state.hash[0],S=this.state.hash[1],I=this.state.hash[2],P=this.state.hash[3],F=this.state.hash[4],D=this.state.hash[5],k=this.state.hash[6],w=this.state.hash[7],C=this.state.hash[8],T=this.state.hash[9],O=this.state.hash[10],z=this.state.hash[11],A=this.state.hash[12],E=this.state.hash[13],L=this.state.hash[14],N=this.state.hash[15],W=0;W<this.options.rounds;W+=2){W<32?(this.W[W]=p[W],this.W[W+1]=p[W+1]):(b=Object(o.c)(this.W[W-30],this.W[W-29],1)^Object(o.c)(this.W[W-30],this.W[W-29],8)^this.W[W-30]>>>7,g=Object(o.d)(this.W[W-30],this.W[W-29],1)^Object(o.d)(this.W[W-30],this.W[W-29],8)^(this.W[W-29]>>>7|this.W[W-30]<<25),v=Object(o.c)(this.W[W-4],this.W[W-3],19)^Object(o.c)(this.W[W-4],this.W[W-3],61)^this.W[W-4]>>>6,x=Object(o.d)(this.W[W-4],this.W[W-3],19)^Object(o.d)(this.W[W-4],this.W[W-3],61)^(this.W[W-3]>>>6|this.W[W-4]<<26),pe=(65535&this.W[W-13])+(65535&this.W[W-31])+(65535&g)+(65535&x)|0,ne=(this.W[W-13]>>>16)+(this.W[W-31]>>>16)+(g>>>16)+(x>>>16)+(pe>>>16)|0,ue=(65535&this.W[W-14])+(65535&this.W[W-32])+(65535&b)+(65535&v)+(ne>>>16)|0,te=(this.W[W-14]>>>16)+(this.W[W-32]>>>16)+(b>>>16)+(v>>>16)+(ue>>>16)|0,this.W[W]=4294967295&(te<<16|65535&ue),this.W[W+1]=4294967295&(ne<<16|65535&pe)),b=Object(o.c)(_,S,28)^Object(o.c)(_,S,34)^Object(o.c)(_,S,39),g=Object(o.d)(_,S,28)^Object(o.d)(_,S,34)^Object(o.d)(_,S,39);var X=T&z^~T&E,te=_&I^_&F^I&F,ue=S&P^S&D^P&D,pe=(pe=(pe=L+(v=Object(o.c)(C,T,14)^Object(o.c)(C,T,18)^Object(o.c)(C,T,41))+((ne=N+(x=Object(o.d)(C,T,14)^Object(o.d)(C,T,18)^Object(o.d)(C,T,41))|0)>>>0<N>>>0?1:0)|0)+(C&O^~C&A)+((ne=ne+X|0)>>>0<X>>>0?1:0)|0)+m[W]+((ne=ne+m[W+1]|0)>>>0<m[W+1]>>>0?1:0)|0,ne=ne+this.W[W+1]|0,ue=g+ue|0,L=A,N=E,A=O,E=z,O=C,z=T,C=k+(pe=pe+this.W[W]+(ne>>>0<this.W[W+1]>>>0?1:0)|0)+((T=w+ne|0)>>>0<w>>>0?1:0)|0,k=F,w=D,F=I,D=P,I=_,P=S,_=pe+(b+te+(ue>>>0<g>>>0?1:0)|0)+((S=ne+ue|0)>>>0<ne>>>0?1:0)|0}this.state.hash[1]=this.state.hash[1]+S|0,this.state.hash[0]=this.state.hash[0]+_+(this.state.hash[1]>>>0<S>>>0?1:0)|0,this.state.hash[3]=this.state.hash[3]+P|0,this.state.hash[2]=this.state.hash[2]+I+(this.state.hash[3]>>>0<P>>>0?1:0)|0,this.state.hash[5]=this.state.hash[5]+D|0,this.state.hash[4]=this.state.hash[4]+F+(this.state.hash[5]>>>0<D>>>0?1:0)|0,this.state.hash[7]=this.state.hash[7]+w|0,this.state.hash[6]=this.state.hash[6]+k+(this.state.hash[7]>>>0<w>>>0?1:0)|0,this.state.hash[9]=this.state.hash[9]+T|0,this.state.hash[8]=this.state.hash[8]+C+(this.state.hash[9]>>>0<T>>>0?1:0)|0,this.state.hash[11]=this.state.hash[11]+z|0,this.state.hash[10]=this.state.hash[10]+O+(this.state.hash[11]>>>0<z>>>0?1:0)|0,this.state.hash[13]=this.state.hash[13]+E|0,this.state.hash[12]=this.state.hash[12]+A+(this.state.hash[13]>>>0<E>>>0?1:0)|0,this.state.hash[15]=this.state.hash[15]+N|0,this.state.hash[14]=this.state.hash[14]+L+(this.state.hash[15]>>>0<N>>>0?1:0)|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<112?112-this.state.message.length|0:240-this.state.message.length|0),this.state.message+="\0\0\0\0\0\0\0\0",this.addLengthBits(),this.process(),this.getStateHash(this.options.length/32|0)}}],function(p,b){for(var g=0;g<b.length;g++){var v=b[g];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(p,v.key,v)}}(d.prototype,l),d);function d(p){var b;return function(g){if(!(g instanceof d))throw new TypeError("Cannot call a class as a function")}(this),(p=p||{}).length=p.length||512,p.rounds=p.rounds||160,b=this,(p=!(p=u(d).call(this,p))||a(p)!=="object"&&typeof p!="function"?function(){if(b!==void 0)return b;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():p).blockSize=32,p.blockSizeInBytes=p.blockSize*p.unitSize,p.W=new Array(160),p}n.a=l},function(e,n,t){"use strict";var l=t(3),o=t(0);function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(p)}function s(p,b,g){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(v,x,_){if(v=function(S,I){for(;!Object.prototype.hasOwnProperty.call(S,I)&&(S=u(S))!==null;);return S}(v,x),v)return x=Object.getOwnPropertyDescriptor(v,x),x.get?x.get.call(_):x.value})(p,b,g||p)}function u(p){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(p)}function f(p,b){return(f=Object.setPrototypeOf||function(g,v){return g.__proto__=v,g})(p,b)}var m=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=(function(p,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(b&&b.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),b&&f(p,b)}(d,l.a),function(p,b){for(var g=0;g<b.length;g++){var v=b[g];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(p,v.key,v)}}(d.prototype,[{key:"reset",value:function(){s(u(d.prototype),"reset",this).call(this),this.options.length===224?this.state.hash=[-1056596264,914150663,812702999,-150054599,-4191439,1750603025,1694076839,-1090891868]:this.state.hash=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225]}},{key:"processBlock",value:function(p){for(var b=0|this.state.hash[0],g=0|this.state.hash[1],v=0|this.state.hash[2],x=0|this.state.hash[3],_=0|this.state.hash[4],S=0|this.state.hash[5],I=0|this.state.hash[6],P=0|this.state.hash[7],F=0;F<this.options.rounds;F++){this.W[F]=F<16?0|p[F]:this.W[F-16]+(Object(o.b)(this.W[F-15],7)^Object(o.b)(this.W[F-15],18)^this.W[F-15]>>>3)+this.W[F-7]+(Object(o.b)(this.W[F-2],17)^Object(o.b)(this.W[F-2],19)^this.W[F-2]>>>10)|0;var D=P+(Object(o.b)(_,6)^Object(o.b)(_,11)^Object(o.b)(_,25))+(_&S^~_&I)+m[F]+this.W[F]|0,k=(Object(o.b)(b,2)^Object(o.b)(b,13)^Object(o.b)(b,22))+(b&g^b&v^g&v)|0,P=I,I=S,S=_,_=x+D|0,x=v,v=g,g=b,b=D+k|0}this.state.hash[0]=this.state.hash[0]+b|0,this.state.hash[1]=this.state.hash[1]+g|0,this.state.hash[2]=this.state.hash[2]+v|0,this.state.hash[3]=this.state.hash[3]+x|0,this.state.hash[4]=this.state.hash[4]+_|0,this.state.hash[5]=this.state.hash[5]+S|0,this.state.hash[6]=this.state.hash[6]+I|0,this.state.hash[7]=this.state.hash[7]+P|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash(this.options.length/32|0)}}]),d);function d(p){var b;return function(g){if(!(g instanceof d))throw new TypeError("Cannot call a class as a function")}(this),(p=p||{}).length=p.length||256,p.rounds=p.rounds||64,b=this,(p=!(p=u(d).call(this,p))||a(p)!=="object"&&typeof p!="function"?function(){if(b!==void 0)return b;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():p).W=new Array(64),p}n.a=l},function(e,n,t){"use strict";var l=t(5),o=t(0);function a(x){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(x)}function s(x,_){for(var S=0;S<_.length;S++){var I=_[S];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(x,I.key,I)}}function u(x,_,S){return(u=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(I,P,F){if(I=function(D,k){for(;!Object.prototype.hasOwnProperty.call(D,k)&&(D=f(D))!==null;);return D}(I,P),I)return P=Object.getOwnPropertyDescriptor(I,P),P.get?P.get.call(F):P.value})(x,_,S||x)}function f(x){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(_){return _.__proto__||Object.getPrototypeOf(_)})(x)}function m(x,_){return(m=Object.setPrototypeOf||function(S,I){return S.__proto__=I,S})(x,_)}var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],t=(function(x,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");x.prototype=Object.create(_&&_.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),_&&m(x,_)}(v,l.a),t=[{key:"F",value:function(x,_,S){return x^_^S}},{key:"G",value:function(x,_,S){return x&_|~x&S}},{key:"H",value:function(x,_,S){return(x|~_)^S}},{key:"I",value:function(x,_,S){return x&S|_&~S}},{key:"J",value:function(x,_,S){return x^(_|~S)}},{key:"T",value:function(x,_,S,I){return x<16?this.F(_,S,I):x<32?this.G(_,S,I)+1518500249|0:x<48?this.H(_,S,I)+1859775393|0:x<64?this.I(_,S,I)+2400959708|0:this.J(_,S,I)+2840853838|0}},{key:"T64",value:function(x,_,S,I){return x<16?this.I(_,S,I)+1352829926|0:x<32?this.H(_,S,I)+1548603684|0:x<48?this.G(_,S,I)+1836072691|0:this.F(_,S,I)}},{key:"T80",value:function(x,_,S,I){return x<16?this.J(_,S,I)+1352829926|0:x<32?this.I(_,S,I)+1548603684|0:x<48?this.H(_,S,I)+1836072691|0:x<64?this.G(_,S,I)+2053994217|0:this.F(_,S,I)}}],s((l=v).prototype,[{key:"reset",value:function(){switch(u(f(v.prototype),"reset",this).call(this),this.options.length){case 128:this.state.hash=[1732584193,4023233417,2562383102,271733878],this.processBlock=this.processBlock128;break;case 256:this.state.hash=[1732584193,4023233417,2562383102,271733878,1985229328,4275878552,2309737967,19088743],this.processBlock=this.processBlock256;break;case 320:this.state.hash=[1732584193,4023233417,2562383102,271733878,3285377520,1985229328,4275878552,2309737967,19088743,1009589775],this.processBlock=this.processBlock320;break;default:this.state.hash=[1732584193,4023233417,2562383102,271733878,3285377520],this.processBlock=this.processBlock160}}},{key:"processBlock128",value:function(x){for(var _=k=0|this.state.hash[0],S=T=0|this.state.hash[1],I=C=0|this.state.hash[2],P=w=0|this.state.hash[3],F=0;F<64;F++){var D=(D=k+x[d[F]]|0)+v.T(F,T,C,w)|0,k=w,w=C,C=T,T=D=Object(o.a)(D,b[F]);D=(D=_+x[p[F]]|0)+v.T64(F,S,I,P)|0,_=P,P=I,I=S,S=D=Object(o.a)(D,g[F])}var O=this.state.hash[1]+C+P|0;this.state.hash[1]=this.state.hash[2]+w+_|0,this.state.hash[2]=this.state.hash[3]+k+S|0,this.state.hash[3]=this.state.hash[0]+T+I|0,this.state.hash[0]=O}},{key:"processBlock160",value:function(x){for(var _=0|this.state.hash[0],S=0|this.state.hash[1],I=0|this.state.hash[2],P=0|this.state.hash[3],F=0|this.state.hash[4],D=_,k=S,w=I,C=P,T=F,O=0;O<80;O++){var z=(z=_+x[d[O]]|0)+v.T(O,S,I,P)|0;z=(z=Object(o.a)(z,b[O]))+F|0,_=F,F=P,P=Object(o.a)(I,10),I=S,S=z,z=(z=D+x[p[O]]|0)+v.T80(O,k,w,C)|0,z=(z=Object(o.a)(z,g[O]))+T|0,D=T,T=C,C=Object(o.a)(w,10),w=k,k=z}var A=this.state.hash[1]+I+C|0;this.state.hash[1]=this.state.hash[2]+P+T|0,this.state.hash[2]=this.state.hash[3]+F+D|0,this.state.hash[3]=this.state.hash[4]+_+k|0,this.state.hash[4]=this.state.hash[0]+S+w|0,this.state.hash[0]=A}},{key:"processBlock256",value:function(x){for(var _=0|this.state.hash[0],S=0|this.state.hash[1],I=0|this.state.hash[2],P=0|this.state.hash[3],F=0|this.state.hash[4],D=0|this.state.hash[5],k=0|this.state.hash[6],w=0|this.state.hash[7],C=0;C<64;C+=1){var T=(T=_+x[d[C]]|0)+v.T(C,S,I,P)|0,_=P,P=I,I=S,S=T=Object(o.a)(T,b[C]);switch(T=(T=F+x[p[C]]|0)+v.T64(C,D,k,w)|0,F=w,w=k,k=D,D=T=Object(o.a)(T,g[C]),C){case 15:T=_,_=F,F=T;break;case 31:T=S,S=D,D=T;break;case 47:T=I,I=k,k=T;break;case 63:T=P,P=w,w=T}}this.state.hash[0]=this.state.hash[0]+_|0,this.state.hash[1]=this.state.hash[1]+S|0,this.state.hash[2]=this.state.hash[2]+I|0,this.state.hash[3]=this.state.hash[3]+P|0,this.state.hash[4]=this.state.hash[4]+F|0,this.state.hash[5]=this.state.hash[5]+D|0,this.state.hash[6]=this.state.hash[6]+k|0,this.state.hash[7]=this.state.hash[7]+w|0}},{key:"processBlock320",value:function(x){for(var _=0|this.state.hash[0],S=0|this.state.hash[1],I=0|this.state.hash[2],P=0|this.state.hash[3],F=0|this.state.hash[4],D=0|this.state.hash[5],k=0|this.state.hash[6],w=0|this.state.hash[7],C=0|this.state.hash[8],T=0|this.state.hash[9],O=0;O<80;O+=1){var z=(z=_+x[d[O]]|0)+v.T(O,S,I,P)|0;switch(z=(z=Object(o.a)(z,b[O]))+F|0,_=F,F=P,P=Object(o.a)(I,10),I=S,S=z,z=(z=D+x[p[O]]|0)+v.T80(O,k,w,C)|0,z=(z=Object(o.a)(z,g[O]))+T|0,D=T,T=C,C=Object(o.a)(w,10),w=k,k=z,O){case 15:z=S,S=k,k=z;break;case 31:z=P,P=C,C=z;break;case 47:z=_,_=D,D=z;break;case 63:z=I,I=w,w=z;break;case 79:z=F,F=T,T=z}}this.state.hash[0]=this.state.hash[0]+_|0,this.state.hash[1]=this.state.hash[1]+S|0,this.state.hash[2]=this.state.hash[2]+I|0,this.state.hash[3]=this.state.hash[3]+P|0,this.state.hash[4]=this.state.hash[4]+F|0,this.state.hash[5]=this.state.hash[5]+D|0,this.state.hash[6]=this.state.hash[6]+k|0,this.state.hash[7]=this.state.hash[7]+w|0,this.state.hash[8]=this.state.hash[8]+C|0,this.state.hash[9]=this.state.hash[9]+T|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),s(l,t),v);function v(x){return function(S){if(!(S instanceof v))throw new TypeError("Cannot call a class as a function")}(this),(x=x||{}).length=x.length||160,_=this,!(x=f(v).call(this,x))||a(x)!=="object"&&typeof x!="function"?function(){if(_!==void 0)return _;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():x;var _}n.a=t},function(e,n,t){"use strict";var l=t(3),o=t(0);function a(x){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(x)}function s(x,_,S){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(I,P,F){if(I=function(D,k){for(;!Object.prototype.hasOwnProperty.call(D,k)&&(D=u(D))!==null;);return D}(I,P),I)return P=Object.getOwnPropertyDescriptor(I,P),P.get?P.get.call(F):P.value})(x,_,S||x)}function u(x){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(_){return _.__proto__||Object.getPrototypeOf(_)})(x)}function f(x,_){return(f=Object.setPrototypeOf||function(S,I){return S.__proto__=I,S})(x,_)}var m=[10097,32533,76520,13586,34673,54876,80959,9117,39292,74945,37542,4805,64894,74296,24805,24037,20636,10402,822,91665,8422,68953,19645,9303,23209,2560,15953,34764,35080,33606,99019,2529,9376,70715,38311,31165,88676,74397,4436,27659,12807,99970,80157,36147,64032,36653,98951,16877,12171,76833,66065,74717,34072,76850,36697,36170,65813,39885,11199,29170,31060,10805,45571,82406,35303,42614,86799,7439,23403,9732,85269,77602,2051,65692,68665,74818,73053,85247,18623,88579,63573,32135,5325,47048,90553,57548,28468,28709,83491,25624,73796,45753,3529,64778,35808,34282,60935,20344,35273,88435,98520,17767,14905,68607,22109,40558,60970,93433,50500,73998,11805,5431,39808,27732,50725,68248,29405,24201,52775,67851,83452,99634,6288,98083,13746,70078,18475,40610,68711,77817,88685,40200,86507,58401,36766,67951,90364,76493,29609,11062,99594,67348,87517,64969,91826,8928,93785,61368,23478,34113,65481,17674,17468,50950,58047,76974,73039,57186,40218,16544,80124,35635,17727,8015,45318,22374,21115,78253,14385,53763,74350,99817,77402,77214,43236,210,45521,64237,96286,2655,69916,26803,66252,29148,36936,87203,76621,13990,94400,56418,9893,20505,14225,68514,46427,56788,96297,78822,54382,14598,91499,14523,68479,27686,46162,83554,94750,89923,37089,20048,80336,94598,26940,36858,70297,34135,53140,33340,42050,82341,44104,81949,85157,47954,32979,26575,57600,40881,22222,6413,12550,73742,11100,2040,12860,74697,96644,89439,28707,25815,63606,49329,16505,34484,40219,52563,43651,77082,7207,31790,61196,90446,26457,47774,51924,33729,65394,59593,42582,60527,15474,45266,95270,79953,59367,83848,82396,10118,33211,59466,94557,28573,67897,54387,54622,44431,91190,42592,92927,45973,42481,16213,97344,8721,16868,48767,3071,12059,25701,46670,23523,78317,73208,89837,68935,91416,26252,29663,5522,82562,4493,52494,75246,33824,45862,51025,61962,79335,65337,12472,549,97654,64051,88159,96119,63896,54692,82391,23287,29529,35963,15307,26898,9354,33351,35462,77974,50024,90103,39333,59808,8391,45427,26842,83609,49700,13021,24892,78565,20106,46058,85236,1390,92286,77281,44077,93910,83647,70617,42941,32179,597,87379,25241,5567,7007,86743,17157,85394,11838,69234,61406,20117,45204,15956,6e4,18743,92423,97118,96338,19565,41430,1758,75379,40419,21585,66674,36806,84962,85207,45155,14938,19476,7246,43667,94543,59047,90033,20826,69541,94864,31994,36168,10851,34888,81553,1540,35456,5014,51176,98086,24826,45240,28404,44999,8896,39094,73407,35441,31880,33185,16232,41941,50949,89435,48581,88695,41994,37548,73043,80951,406,96382,70774,20151,23387,25016,25298,94624,61171,79752,49140,71961,28296,69861,2591,74852,20539,387,59579,18633,32537,98145,6571,31010,24674,5455,61427,77938,91936,74029,43902,77557,32270,97790,17119,52527,58021,80814,51748,54178,45611,80993,37143,5335,12969,56127,19255,36040,90324,11664,49883,52079,84827,59381,71539,9973,33440,88461,23356,48324,77928,31249,64710,2295,36870,32307,57546,15020,9994,69074,94138,87637,91976,35584,4401,10518,21615,1848,76938,9188,20097,32825,39527,4220,86304,83389,87374,64278,58044,90045,85497,51981,50654,94938,81997,91870,76150,68476,64659,73189,50207,47677,26269,62290,64464,27124,67018,41361,82760,75768,76490,20971,87749,90429,12272,95375,5871,93823,43178,54016,44056,66281,31003,682,27398,20714,53295,7706,17813,8358,69910,78542,42785,13661,58873,4618,97553,31223,8420,28306,3264,81333,10591,40510,7893,32604,60475,94119,1840,53840,86233,81594,13628,51215,90290,28466,68795,77762,20791,91757,53741,61613,62269,50263,90212,55781,76514,83483,47055,89415,92694,397,58391,12607,17646,48949,72306,94541,37408,77513,3820,86864,29901,68414,82774,51908,13980,72893,55507,19502,37174,69979,20288,55210,29773,74287,75251,65344,67415,21818,59313,93278,81757,5686,73156,7082,85046,31853,38452,51474,66499,68107,23621,94049,91345,42836,9191,8007,45449,99559,68331,62535,24170,69777,12830,74819,78142,43860,72834,33713,48007,93584,72869,51926,64721,58303,29822,93174,93972,85274,86893,11303,22970,28834,34137,73515,90400,71148,43643,84133,89640,44035,52166,73852,70091,61222,60561,62327,18423,56732,16234,17395,96131,10123,91622,85496,57560,81604,18880,65138,56806,87648,85261,34313,65861,45875,21069,85644,47277,38001,2176,81719,11711,71602,92937,74219,64049,65584,49698,37402,96397,1304,77586,56271,10086,47324,62605,40030,37438,97125,40348,87083,31417,21815,39250,75237,62047,15501,29578,21826,41134,47143,34072,64638,85902,49139,6441,3856,54552,73135,42742,95719,9035,85794,74296,8789,88156,64691,19202,7638,77929,3061,18072,96207,44156,23821,99538,4713,66994,60528,83441,7954,19814,59175,20695,5533,52139,61212,6455,83596,35655,6958,92983,5128,9719,77433,53783,92301,50498,10850,62746,99599,10507,13499,6319,53075,71839,6410,19362,39820,98952,43622,63147,64421,80814,43800,9351,31024,73167,59580,6478,75569,78800,88835,54486,23768,6156,4111,8408,38508,7341,23793,48763,90822,97022,17719,4207,95954,49953,30692,70668,94688,16127,56196,80091,82067,63400,5462,69200,65443,95659,18288,27437,49632,24041,8337,65676,96299,90836,27267,50264,13192,72294,7477,44606,17985,48911,97341,30358,91307,6991,19072,24210,36699,53728,28825,35793,28976,66252,68434,94688,84473,13622,62126,98408,12843,82590,9815,93146,48908,15877,54745,24591,35700,4754,83824,52692,54130,55160,6913,45197,42672,78601,11883,9528,63011,98901,14974,40344,10455,16019,14210,33712,91342,37821,88325,80851,43667,70883,12883,97343,65027,61184,4285,1392,17974,15077,90712,26769,21778,30976,38807,36961,31649,42096,63281,2023,8816,47449,19523,59515,65122,59659,86283,68258,69572,13798,16435,91529,67245,52670,35583,16563,79246,86686,76463,34222,26655,90802,60584,47377,7500,37992,45134,26529,26760,83637,41326,44344,53853,41377,36066,94850,58838,73859,49364,73331,96240,43642,24637,38736,74384,89342,52623,7992,12369,18601,3742,83873,83080,12451,38992,22815,7759,51777,97377,27585,51972,37867,16444,24334,36151,99073,27493,70939,85130,32552,54846,54759,60790,18157,57178,65762,11161,78576,45819,52979,65130,4860,3991,10461,93716,16894,66083,24653,84609,58232,88618,19161,38555,95554,32886,59780,8355,60860,29735,47762,71299,23853,17546,73704,92052,46215,55121,29281,59076,7936,27954,58909,32643,52861,95819,6831,911,98936,76355,93779,80863,514,69572,68777,39510,35905,14060,40619,29549,69616,33564,60780,24122,66591,27699,6494,14845,46672,61958,77100,90899,75754,61196,30231,92962,61773,41839,55382,17267,70943,78038,70267,30532,21704,10274,12202,39685,23309,10061,68829,55986,66485,3788,97599,75867,20717,74416,53166,35208,33374,87539,8823,48228,63379,85783,47619,53152,67433,35663,52972,16818,60311,60365,94653,35075,33949,42614,29297,1918,28316,98953,73231,83799,42402,56623,34442,34994,41374,70071,14736,9958,18065,32960,7405,36409,83232,99385,41600,11133,7586,15917,6253,19322,53845,57620,52606,66497,68646,78138,66559,19640,99413,11220,94747,7399,37408,48509,23929,27482,45476,85244,35159,31751,57260,68980,5339,15470,48355,88651,22596,3152,19121,88492,99382,14454,4504,20094,98977,74843,93413,22109,78508,30934,47744,7481,83828,73788,6533,28597,20405,94205,20380,22888,48893,27499,98748,60530,45128,74022,84617,82037,10268,78212,16993,35902,91386,44372,15486,65741,14014,87481,37220,41849,84547,46850,52326,34677,58300,74910,64345,19325,81549,46352,33049,69248,93460,45305,7521,61318,31855,14413,70951,11087,96294,14013,31792,59747,67277,76503,34513,39663,77544,52701,8337,56303,87315,16520,69676,11654,99893,2181,68161,57275,36898,81304,48585,68652,27376,92852,55866,88448,3584,20857,73156,70284,24326,79375,95220,1159,63267,10622,48391,15633,84924,90415,93614,33521,26665,55823,47641,86225,31704,92694,48297,39904,2115,59589,49067,66821,41575,49767,4037,77613,19019,88152,80,20554,91409,96277,48257,50816,97616,38688,32486,45134,63545,59404,72059,43947,51680,43852,59693,25163,1889,70014,15021,41290,67312,71857,15957,68971,11403,65251,7629,37239,33295,5870,1119,92784,26340,18477,65622,36815,43625,18637,37509,82444,99005,4921,73701,14707,93997,64397,11692,5327,82162,20247,81759,45197,25332,83745,22567,4515,25624,95096,67946,48460,85558,15191,18782,16930,33361,83761,60873,43253,84145,60833,25983,1291,41349,20368,7126,14387,6345,80854,9279,43529,6318,38384,74761,41196,37480,51321,92246,80088,77074,88722,56736,66164,49431,66919,31678,72472,8,80890,18002,94813,31900,54155,83436,35352,54131,5466,55306,93128,18464,74457,90561,72848,11834,79982,68416,39528,72484,82474,25593,48545,35247,18619,13674,18611,19241,81616,18711,53342,44276,75122,11724,74627,73707,58319,15997,7586,16120,82641,22820,92904,13141,32392,19763,61199,67940,90767,4235,13574,17200,69902,63742,78464,22501,18627,90872,40188,28193,29593,88627,94972,11598,62095,36787,441,58997,34414,82157,86887,55087,19152,23,12302,80783,32624,68691,63439,75363,44989,16822,36024,867,76378,41605,65961,73488,67049,9070,93399,45547,94458,74284,5041,49807,20288,34060,79495,4146,52162,90286,54158,34243,46978,35482,59362,95938,91704,30552,4737,21031,75051,93029,47665,64382,99782,93478,94015,46874,32444,48277,59820,96163,64654,25843,41145,42820,74108,88222,88570,74015,25704,91035,1755,14750,48968,38603,62880,87873,95160,59221,22304,90314,72877,17334,39283,4149,11748,12102,80580,41867,17710,59621,6554,7850,73950,79552,17944,5600,60478,3343,25852,58905,57216,39618,49856,99326,66067,42792,95043,52680,46780,56487,9971,59481,37006,22186,54244,91030,45547,70818,59849,96169,61459,21647,87417,17198,30945,57589,31732,57260,47670,7654,46376,25366,94746,49580,69170,37403,86995,90307,94304,71803,26825,5511,12459,91314,8345,88975,35841,85771,8105,59987,87112,21476,14713,71181,27767,43584,85301,88977,29490,69714,73035,41207,74699,9310,13025,14338,54066,15243,47724,66733,47431,43905,31048,56699,80217,36292,98525,24335,24432,24896,43277,58874,11466,16082,10875,62004,90391,61105,57411,6368,53856,30743,8670,84741,54127,57326,26629,19087,24472,88779,30540,27886,61732,75454,60311,42824,37301,42678,45990,43242,17374,52003,70707,70214,49739,71484,92003,98086,76668,73209,59202,11973,2902,33250,78626,51594,16453,94614,39014,97066,83012,9832,25571,77628,66692,13986,99837,582,81232,44987,9504,96412,90193,79568,44071,28091,7362,97703,76447,42537,98524,97831,65704,9514,41468,85149,49554,17994,14924,39650,95294,556,70481,6905,94559,37559,49678,53119,70312,5682,66986,34099,74474,20740,41615,70360,64114,58660,90850,64618,80620,51790,11436,38072,50273,93113,41794,86861,24781,89683,55411,85667,77535,99892,41396,80504,90670,8289,40902,5069,95083,6783,28102,57816,25807,24260,71529,78920,72682,7385,90726,57166,98884,8583,6170,97965,88302,98041,21443,41808,68984,83620,89747,98882,60808,54444,74412,81105,1176,28838,36421,16489,18059,51061,80940,44893,10408,36222,80582,71944,92638,40333,67054,16067,19516,90120,46759,71643,13177,55292,21036,82808,77501,97427,49386,54480,23604,23554,21785,41101,91178,10174,29420,90438,6312,88940,15995,69321,47458,64809,98189,81851,29651,84215,60942,307,11897,92674,40405,68032,96717,54244,10701,41393,92329,98932,78284,46347,71209,92061,39448,93136,25722,8564,77936,63574,31384,51924,85561,29671,58137,17820,22751,36518,38101,77756,11657,13897,95889,57067,47648,13885,70669,93406,39641,69457,91339,22502,92613,89719,11947,56203,19324,20504,84054,40455,99396,63680,67667,60631,69181,96845,38525,11600,47468,3577,57649,63266,24700,71594,14004,23153,69249,5747,43321,31370,28977,23896,76479,68562,62342,7589,8899,5985,64281,61826,18555,64937,13173,33365,78851,16499,87064,13075,66847,70495,32350,2985,86716,38746,26313,77463,55387,72681,72461,33230,21529,53424,92581,2262,78438,66276,18396,73538,21032,91050,13058,16218,12470,56500,15292,76139,59526,52113,95362,67011,6651,16136,1016,857,55018,56374,35824,71708,49712,97380,10404,55452,34030,60726,75211,10271,36633,68424,58275,61764,97586,54716,50259,46345,87195,46092,26787,60939,89514,11788,68224,23417,73959,76145,30342,40277,11049,72049,15472,50669,48139,36732,46874,37088,73465,9819,58869,35220,12120,86124,51247,44302,60883,52109,21437,36786,49226,77837,19612,78430,11661,94770,77603,65669,86868,12665,30012,75989,39141,77400,28e3,64238,73258,71794,31340,26256,66453,37016,64756,80457,8747,12836,3469,50678,3274,43423,66677,82556,92901,51878,56441,22998,29718,38447,6453,25311,7565,53771,3551,90070,9483,94050,45938,18135,36908,43321,11073,51803,98884,66209,6830,53656,14663,56346,71430,4909,19818,5707,27369,86882,53473,7541,53633,70863,3748,12822,19360,49088,59066,75974,63335,20483,43514,37481,58278,26967,49325,43951,91647,93783,64169,49022,98588,9495,49829,59068,38831,4838,83605,92419,39542,7772,71568,75673,35185,89759,44901,74291,24895,88530,70774,35439,46758,70472,70207,92675,91623,61275,35720,26556,95596,20094,73750,85788,34264,1703,46833,65248,14141,53410,38649,6343,57256,61342,72709,75318,90379,37562,27416,75670,92176,72535,93119,56077,6886,18244,92344,31374,82071,7429,81007,47749,40744,56974,23336,88821,53841,10536,21445,82793,24831,93241,14199,76268,70883,68002,3829,17443,72513,76400,52225,92348,62308,98481,29744,33165,33141,61020,71479,45027,76160,57411,13780,13632,52308,77762,88874,33697,83210,51466,9088,50395,26743,5306,21706,70001,99439,80767,68749,95148,94897,78636,96750,9024,94538,91143,96693,61886,5184,75763,47075,88158,5313,53439,14908,8830,60096,21551,13651,62546,96892,25240,47511,58483,87342,78818,7855,39269,566,21220,292,24069,25072,29519,52548,54091,21282,21296,50958,17695,58072,68990,60329,95955,71586,63417,35947,67807,57621,64547,46850,37981,38527,9037,64756,3324,4986,83666,9282,25844,79139,78435,35428,43561,69799,63314,12991,93516,23394,94206,93432,37836,94919,26846,2555,74410,94915,48199,5280,37470,93622,4345,15092,19510,18094,16613,78234,50001,95491,97976,38306,32192,82639,54624,72434,92606,23191,74693,78521,104,18248,75583,90326,50785,54034,66251,35774,14692,96345,44579,85932,44053,75704,20840,86583,83944,52456,73766,77963,31151,32364,91691,47357,40338,23435,24065,8458,95366,7520,11294,23238,1748,41690,67328,54814,37777,10057,42332,38423,2309,70703,85736,46148,14258,29236,12152,5088,65825,2463,65533,21199,60555,33928,1817,7396,89215,30722,22102,15880,92261,17292,88190,61781,48898,92525,21283,88581,60098,71926,819,59144,224,30570,90194,18329,6999,26857,19238,64425,28108,16554,16016,42,83229,10333,36168,65617,94834,79782,23924,49440,30432,81077,31543,95216,64865,13658,51081,35337,74538,44553,64672,90960,41849,93865,44608,93176,34851,5249,29329,19715,94082,14738,86667,43708,66354,93692,25527,56463,99380,38793,85774,19056,13939,46062,27647,66146,63210,96296,33121,54196,34108,75814,85986,71171,15102,28992,63165,98380,36269,60014,7201,62448,46385,42175,88350,46182,49126,52567,64350,16315,53969,80395,81114,54358,64578,47269,15747,78498,90830,25955,99236,43286,91064,99969,95144,64424,77377,49553,24241,8150,89535,8703,91041,77323,81079,45127,93686,32151,7075,83155,10252,73100,88618,23891,87418,45417,20268,11314,50363,26860,27799,49416,83534,19187,8059,76677,2110,12364,71210,87052,50241,90785,97889,81399,58130,64439,5614,59467,58309,87834,57213,37510,33689,1259,62486,56320,46265,73452,17619,56421,40725,23439,41701,93223,41682,45026,47505,27635,56293,91700,4391,67317,89604,73020,69853,61517,51207,86040,2596,1655,9918,45161,222,54577,74821,47335,8582,52403,94255,26351,46527,68224,90183,85057,72310,34963,83462,49465,46581,61499,4844,94626,2963,41482,83879,44942,63915,94365,92560,12363,30246,2086,75036,88620,91088,67691,67762,34261,8769,91830,23313,18256,28850,37639,92748,57791,71328,37110,66538,39318,15626,44324,82827,8782,65960,58167,1305,83950,45424,72453,19444,68219,64733,94088,62006,89985,36936,61630,97966,76537,46467,30942,7479,67971,14558,22458,35148,1929,17165,12037,74558,16250,71750,55546,29693,94984,37782,41659,39098,23982,29899,71594,77979,54477,13764,17315,72893,32031,39608,75992,73445,1317,50525,87313,45191,30214,19769,90043,93478,58044,6949,31176,88370,50274,83987,45316,38551,79418,14322,91065,7841,36130,86602,10659,40859,964,71577,85447,61079,96910,72906,7361,84338,34114,52096,66715,51091,86219,81115,49625,48799,89485,24855,13684,68433,70595,70102,71712,88559,92476,32903,68009,58417,87962,11787,16644,72964,29776,63075,13270,84758,49560,10317,28778,23006,31036,84906,81488,17340,74154,42801,27917,89792,62604,62234,13124,76471,51667,37589,87147,24743,48023,6325,79794,35889,13255,4925,99004,70322,60832,76636,56907,56534,72615,46288,36788,93196,68656,66492,35933,52293,47953,95495,95304,50009,83464,28608,38074,74083,9337,7965,65047,36871,59015,21769,30398,44855,1020,80680,59328,8712,48190,45332,27284,31287,66011,9376,86379,74508,33579,77114,92955,23085,92824,3054,25242,16322,48498,9938,44420,13484,52319,58875,2012,88591,52500,95795,41800,95363,54142,17482,32705,60564,12505,40954,46174,64130,63026,96712,79883,39225,52653,69549,36693,59822,22684,31661,88298,15489,16030,42480,15372,38781,71995,77438,91161,10192,7839,62735,99218,25624,2547,27445,69187,55749,32322,15504,73298,51108,48717,92926,75705,89787,96114,99902,37749,96305,12829,70474,838,50385,91711,80370,56504,56857,80906,9018,76569,61072,48568,36491,22587,44363,39592,61546,90181,37348,41665,41339,62106,44203,6732,76111,79840,67999,32231,76869,58652,49983,1669,27464,79553,52855,25988,18087,38052,17529,13607,657,76173,43357,77334,24140,53860,2906,89863,44651,55715,26203,65933,51087,98234,40625,45545,63563,89148,82581,4110,66683,99001,9796,47349,65003,66524,81970,71262,14479,31300,8681,58068,44115,40064,77879,23965,69019,73985,19453,26225,97543,37044,7494,85778,35345,61115,92498,49737,64599,7158,82763,25072,38478,57782,75291,62155,52056,4786,11585,71251,25572,79771,93328,66927,54069,58752,26624,50463,77361,29991,96526,2820,91659,12818,96356,49499,1507,40223,9171,83642,21057,2677,9367,38097,16100,19355,6120,15378,56559,69167,30235,6767,66323,78294,14916,19124,88044,16673,66102,86018,29406,75415,22038,27056,26906,25867,14751,92380,30434,44114,6026,79553,55091,95385,41212,37882,46864,54717,97038,53805,64150,70915,63127,63695,41288,38192,72437,75075,18570,52065,8853,30104,79937,66913,53200,84570,78079,28970,53859,37632,80274,35240,32960,74859,7359,55176,3930,38984,35151,82576,82805,94031,12779,90879,24109,25367,77861,9541,85739,69023,64971,99321,7521,95909,43897,71724,92581,5471,64337,98949,3606,78236,78985,29212,57369,34857,67757,58019,58872,96526,28749,56592,37871,72905,70198,57319,54116,47014,18285,33692,72111,60958,96848,17893,40993,50445,14186,76877,87867,50335,9513,44346,26439,55293,6449,44301,63740,40158,72703,88321,85062,57345,66231,15409,3451,95261,43561,15673,28956,90303,62469,82517,43035,36850,15592,64098,59022,31752,4370,50486,11885,23085,41712,80692,48492,16495,99721,36912,28267,27882,16269,64483,11273,2680,1616,46138,54606,14761,5134,45144,63213,49666,27441,86989,29884,54334,6740,8368,80051,81020,17882,74973,74531,94994,24927,64894,22667,20466,82948,66831,47427,76033,31197,59817,20064,61135,28556,29695,80179,74058,18293,9963,35278,13062,83094,23373,90287,33477,48865,30348,70174,11468,25994,25343,22317,1587,30682,1,67814,59557,23362,13746,82244,42093,24671,79458,93730,45488,60234,67098,9899,25775,332,36636,57594,19958,85564,58977,12247,60774,66371,69442,20385,14486,91330,50332,46023,75768,59877,60081,92936,72302,75064,85727,52987,5750,19384,33684,78859,80458,69902,34870,88684,49762,40801,86291,18194,90366,82639,53844,96326,65728,48563,26027,52692,62406,76294,41848,63010,69841,29451,36170,21529,16525,64326,22086,24469,57407,96033,37771,31002,18311,93285,31948,14331,58335,15977,80336,81667,27286,24361,61638,57580,95270,46180,76990,53031,94366,2727,49944,19278,5756,51875,53445,33342,1965,7937,10054,97712,87693,58124,46064,39133,77385,9605,65359,70113,90563,86637,94282,12025,31926,24541,23854,58407,32131,92845,20714,27898,26917,50326,35145,50859,72119,95094,29441,42301,62460,75252,94267,38422,73047,24200,85349,72049,91723,97802,98496,12734,73432,10371,57213,53300,80847,46229,7099,72961,13767,65654,31102,82119,96946,65919,81083,3819,57888,57908,16849,77111,41429,92261,45263,1172,55926,78835,27697,48420,58865,41207,21406,8582,10785,36233,12237,7866,13706,92551,11021,63813,71512,65206,37768,94325,14721,20990,54235,71986,5345,56239,52028,1419,7215,55067,11669,21738,66605,69621,69827,8537,18638,60982,28151,98885,76431,25566,3085,23639,30849,63986,73287,26201,36174,14106,54102,57041,16141,64174,3591,90024,73332,31254,17288,59809,25061,51612,47951,16570,43330,79213,11354,55585,19646,99246,37564,32660,20632,21124,60597,69315,31312,57741,85108,21615,24365,27684,16124,33888,14966,35303,69921,15795,4020,67672,86816,63027,84470,45605,44887,26222,79888,58982,22466,98844,48353,60666,58256,31140,93507,69561,6256,88526,18655,865,75247,264,65957,98261,72706,36396,46065,85700,32121,99975,73627,78812,89638,86602,96758,65099,52777,46792,13790,55240,52002,10313,91933,71231,10053,78416,54563,96004,42215,30094,45958,48437,49591,50483,13422,69108,59952,27896,40450,79327,31962,46456,39260,51479,61882,48181,50691,64709,32902,10676,12083,35771,79656,56667,76783,3937,99859,10362,57411,40986,35045,2838,29255,64230,84418,34988,77644,39892,77327,74129,53444,35487,95803,38640,20383,55402,25793,14213,87082,42837,95030,97198,61608,97723,79390,35290,34683,81419,87133,70447,53127,97146,28299,56763,12868,1145,12147,58158,92124,60934,18414,97510,7056,54488,20719,53743,91037,44797,52110,8512,18991,20129,31441,51449,14661,71126,23180,68124,18807,70997,21913,19594,70355,73637,68266,60775,43164,52643,96363,77989,79332,39890,65379,20405,52935,43816,92740,95319,4538,60660,28982,15328,80475,34690,2293,19646,46524,96627,33159,42081,8816,74931,20674,8697,66169,46460,46326,39923,60625,28386,22919,19415,75766,43668,31626,70301,67053,3949,70082,2303,48642,38429,94053,38770,68137,68441,52928,70244,91954,17401,92693,98342,21451,84988,80487,33807,73797,49494,41878,76635,83227,76618,11946,13451,87591,78381,21407,90038,72638,69692,51599,86413,32019,64856,74730,41531,11064,1790,58817,86400,66213,92599,70905,78324,54326,43659,34206,63132,38837,40210,96346,16967,81619,96503,14881,89405,32205,49508,98425,2451,35423,56072,36810,30332,85998,49358,92748,84147,79835,94867,41224,61794,35066,82220,66684,20096,2754,41731,37068,32753,91059,13407,5607,69384,53329,95909,44968,11397,92973,50014,92997,80968,93761,57598,74703,7768,37978,73873,33475,9720,97852,98449,48722,84977,11271,11728,68318,22312,78792,87508,88466,72976,47099,84126,38595,85124,64405,90020,7492,52413,95111,34455,86311,68892,1074,60274,28136,19328,38161,57475,13771,63562,84207,94121,18901,52768,33801,82087,86091,59969,90398,56870,55756,78841,98450,54165,55106,50343,70519,14567,36780,55450,19606,83749,67562,64765,38543,16585,86841,73742,8766,39252,75678,75379,78760,37279,15280,13558,95916,89759,76686,76467,67147,63110,94008,8037,35263,53710,16667,79008,11231,29397,67136,18601,64502,90228,89109,72849,22711,65547,34542,26686,81678,87765,77654,23664,96352,14106,32938,28083,18633,80286,65507,46197,52722,75476,77816,47204,34876,45963,79262,90181,84041,3745,90041,30780,27226,92847,85572,15308,80688,5761,82638,13464,23683,81015,54214,64175,43701,86845,15569,50687,52679,87696,8285,97444,47599,94472,64150,87753,68652,60726,26213,17320,64553,81285,98126,12158,52095,64833,492,35817,55571,91300,97812,37507,4209,53515,64342,21223,16662,43265,68219,3529,43636,68417,53640,95326,93381,37113,80751,76469,96677,43054,22937,31954,13266,34140,27253,2734,99070,60077,57988,93211,92795,83795,57477,3941,39007,14619,38320,93449,31336,25279,97030,26245,47394,39475,90621,23820,29344,94859,91604,14033,41868,14816,4075,66644,87803,97815,99552,78666,3942,8175,22345,19983,76783,99044,20851,84981,59052,77178,72109,76475,21619,73017,6812,56633,50612,55289,4671,84419,94072,94446,80603,32188,93415,23464,43947,43728,74284,67177,57105,31059,10642,13803,69602,46961,66567,19359,84676,63918,40650,12923,15974,79732,20225,92525,71179,4859,91208,60430,5239,61458,24089,68852,60171,29603,42535,86365,93905,28237,45317,60718,82001,41679,20679,56304,70043,87568,21386,59049,78353,48696,77379,55309,23780,28391,5940,55583,81256,59418,97521,32846,70761,90115,45325,5490,65974,11186,15357,3568,450,96644,58976,36211,88240,92457,89200,94696,11370,91157,48487,59501,56983,89795,42789,69758,79701,29511,55968,41472,89474,84344,80517,7485,97523,17264,82840,59556,37119,30985,48866,60605,95719,70417,59083,95137,76538,44155,67286,57897,28262,4052,919,86207,79932,44236,10089,44373,65670,44285,6903,20834,49701,95735,21149,3425,17594,31427,14262,32252,68540,39427,44026,47257,45055,95091,8367,28381,57375,41562,83883,27715,10122,67745,46497,28626,87297,36568,39483,11385,63292,92305,78683,6146,81905,15038,38338,51206,65749,34119,71516,74068,51094,6665,91884,66762,11428,70908,21506,480,94183,78484,66507,75901,25728,52539,86806,69944,65036,27882,2530,4918,74351,65737,89178,8791,39342,94963,22581,56917,17541,83578,75376,65202,30935,79270,91986,99286,45236,44720,81915,70881,45886,43213,49789,97081,16075,20517,69980,25310,91953,1759,67635,88933,54558,18395,73375,62251,58871,9870,70538,48936,7757,90374,56631,88862,30487,38794,36079,32712,11130,55451,25137,38785,83558,31960,69473,45950,18225,9871,88502,75179,11551,75664,74321,67351,27703,83717,18913,42470,8816,37627,14288,62831,44047,67612,72738,26995,50933,63758,50003,43693,52661,55852,52372,59042,37595,4931,73622,68387,86478,40997,5245,75300,24902,59609,35653,15970,37681,69365,22236,86374,65550,343,98377,35354,65770,15365,41422,71356,16630,40044,19290,66449,53629,79452,71674,30260,97303,6487,62789,13005,70152,22501,49867,89294,59232,31776,54919,99851,5438,1096,72269,50486,16719,6144,82041,38332,64452,31840,99287,59928,25503,8407,46970,45907,99238,74547,19704,72035,26542,54600,79172,58779,35747,78956,11478,41195,58135,63856,33037,45753,60159,25193,71838,7526,7985,60714,88627,75790,38454,96110,39237,19792,34534,70169,24805,63215,38175,38784,38855,24826,50917,25147,17082,26997,32295,10894,21805,65245,85407,37926,69214,38579,84721,23544,88548,65626,75517,69737,55626,52175,21697,19453,16908,82841,24060,40285,19195,80281,89322,15232,70043,60691,86370,91949,19017,83846,77869,14321,95102,87073,71467,31305,64677,80358,52629,79419,22359,87867,48296,50141,46807,82184,95812,84665,74511,59914,4146,90417,58508,62875,17630,21868,9199,30322,33352,43374,25473,4119,63086,14147,14863,38020,44757,98628,57916,22199,11865,42911,62651,78290,9392,77294,63168,21043,17409,13786,27475,75979,89668,43596,74316,84489,54941,95992,45445,41059,55142,15214,42903,16799,88254,95984,48575,77822,21067,57238,35352,96779,89564,23797,99937,46379,27119,16060,30302,95327,12849,38111,97090,7598,78473,63079,18570,72803,70040,91385,96436,96263,17368,56188,85999,50026,36050,73736,13351,48321,28357,51718,65636,72903,21584,21060,39829,15564,4716,14594,22363,97639,65937,17802,31535,42767,98761,30987,57657,33398,63053,25926,20944,19306,81727,2695,97479,79172,72764,66446,78864,12698,15812,97209,38827,91016,91281,57875,45228,49211,69755,99224,43999,62879,8879,80015,74396,57146,64665,31159,6980,79069,37409,75037,69977,85919,42826,6974,61063,97640,13433,92528,91311,8440,38840,22362,93929,1836,36590,75052,89475,15437,65648,99012,70236,12307,83585,414,62851,48787,28447,21702,57033,29633,44760,34165,27548,37516,24343,63046,2081,20378,19510,42226,97134,68739,32982,56455,53129,77693,25022,55534,99375,30086,98001,7432,67126,76656,29347,28492,43108,64736,32278,84816,80440,30461,818,9136,1952,48442,91058,92590,10443,5195,34009,32141,62209,43740,54102,76895,98172,31583,4155,66492,58981,16591,11331,6838,3818,77063,12523,45570,68970,70055,77751,73743,71732,4704,61384,57343,66682,44500,89745,10436,67202,36455,42467,88801,91280,1056,27534,81619,79004,25824,66362,33280,20706,31929,57422,18730,96197,22101,47592,2180,18287,82310,60430,59627,26471,7794,60475,76713,45427,89654,14370,81674,41246,98416,8669,48883,77154,9806,94015,60347,20027,8405,33150,27368,53375,70171,59431,14534,34018,85665,77797,17944,49602,74391,48830,55029,10371,94261,16658,68400,44148,28150,40364,90913,73151,64463,50058,78191,84439,82478,62398,3113,17578,12830,6571,95934,9132,25287,78731,80683,67207,76597,42096,34934,76609,52553,47508,71561,8038,83011,72577,95790,40076,20292,32138,61197,95476,23123,26648,13611,48452,39963,85857,4855,27029,1542,72443,53688,82635,56264,7977,23090,93553,65434,12124,91087,87800,95675,99419,44659,30382,55263,82514,86800,16781,65977,65946,13033,93895,4056,75895,47878,91309,51233,81409,46773,69135,56906,84493,34530,84534,38312,54574,92933,77341,20839,36126,1143,35356,35459,7959,98335,53266,36146,78047,50607,22486,63308,8996,96056,39085,26567,6779,62663,30523,47881,41279,49864,82248,78333,29466,48151,41957,93235,53308,22682,90722,54478,7235,34306,15827,20121,96837,6283,80172,66109,92592,48238,76428,94546,45430,16288,74839,740,25553,83767,35900,5998,7493,46755,11449,88824,44906,33143,7454,56652,34755,63992,59674,65131,46358,12799,96988,51158,73176,1184,49925,63519,11785,29073,72850,47997,75172,55187,15313,40725,33225,56643,10465,38583,86440,97967,26401,17078,38765,33454,19136,57712,48446,98790,27315,71074,10157,57946,35582,49383,61324,26572,84503,3496,60449,17962,26017,65651,40400,83246,80056,75306,75147,41863,25581,87530,33193,43294,5065,99644,62771,75986,79005,44924,18703,40889,4403,5862,2571,82500,74200,36170,46836,74642,65471,26815,30937,64946,10160,15544,31962,54015,28853,66533,14573,79398,47391,73165,47805,77589,16881,13423,89452,76992,62509,9796,57540,13486,48855,25546,47589,21012,47388,78428,70196,84413,81026,87597,22445,83769,85937,38321,85485,87359,9839,67228,71179,94372,4446,62801,50775,96179,40646,44272,12417,47199,39701,30665,32775,66525,53558,78882,31939,67209,38906,34533,99914,27719,216,99225,96537,3843,90564,91110,51838,30300,9559,37795,94880,11325,44979,89696,28129,29931,89971,46292,92710,11036,74760,75307,12291,49618,16293,92408,67928,80823,32872,25460,66819,35374,4035,99087,61129,11341,39118,10891,37217,63638,75477,30068,42334,57570,6890,59353,89939,37692,15232,20033,32202,22348,2766,96791,58448,92248,5769,96684,67885,99295,47271,38655,59513,96960,31718,8974,16122,20535,52380,29769,70660,57425,50891,75044,84257,73315,38181,28673,93140,26307,82265,78382,19681,56585,8975,76764,39956,83450,84663,89963,71584,57696,30829,60527,64947,34899,28805,28397,91830,51842,99838,39839,66971,67177,74219,35637,35634,93581,81746,29991,81096,94279,2968,62561,2479,82126,25702,67953,88088,50293,83423,86206,39935,23253,43041,48941,85787,8388,6671,43574,84908,67295,33623,55060,28174,48415,2529,22009,24524,5283,30460,32399,80423,56929,40852,69969,88541,5979,91496,64730,57198,83145,39750,3568,54669,98679,4297,51047,31492,47734,31343,31180,232,19707,24823,75079,73943,17997,8446,91252,39879,58682,82972,18417,39203,36681,42895,8459,15618,17941,52594,43277,16530,40052,91100,87422,47230,95699,49794,50492,87439,86354,4546,65333,11057,77727,19748,38722,91821,18107,42125,89239,28847,54623,38783,47803,31414,38450,3697,89186,30579,44188,26532,8420,80723,48100,60748,76330,45832,8311,16051,4475,13400,48527,46073,17439,56498,94632,9021,16871,83366,14896,4219,38375,87890,90217,42370,61028,85101,76771,83715,94737,69973,74187,1958,59691,86712,86570,60984,76342,13648,85250,28323,48379,45141,36277,51845,29039,3553,5128,59866,51281,68124,17007,24729,29710,41439,40574,11774,86746,89698,56020,37810,88972,11361,95583,70786,589,74473,87513,17690,61427,72914,32517,1804,97910,6327,30246,33049,2622,41026,80875,41293,16752,84225,84414,37137,68956,8095,64981,28180,38629,76962,23840,17477,75268,48297,70340,57888,13938,38554,86836,2195,30270,55484,53364,54705,41380,56316,37723,234,21424,26664,63804,75139,36534,18579,9833,98849,72762,59767,52497,24227,83152,71794,21398,99456,89215,51632,54799,27973,68568,68465,98500,28681,18369,24279,96335,12874,82160,67202,85199,27908,67022,49810,77929,96212,81153,77884,7032,1671,53362,28119,56786,30883,28540,76029,3774,64611,19736,25589,46569,45206,48215,69523,17423,91807,90039,30393,58319,85098,66519,57571,24541,3562,14400,62731,82534,61477,89731,18421,29861,52829,838,78040,43350,74323,82892,84746,28302,13264,7595,134,12933,46831,24864,47275,20527,9110,28485,30326,99826,64005,99308,65779,42760,90066,3974,38688,39968,32604,11694,46262,73262,45405,43923,67397,88228,56405,17839,92073,57622,93328,15442,50186,7570,58001,31e3,8915,11467,14793,82691,51238,12485,51745,18192,5985,36826,89434,38669,91592,88799,65621,67237,59541,19657,93402,58705,73553,78280,69125,95591,81168,91927,25976,89077,71690,19404,64603,59752,74698,44233,67602,38615,31303,28650,53700,89819,7783,4351,77451,47350,21234,16016,41532,76508,23063,44993,43983,33356,61715,96485,22121,78004,6316,87896,99289,93981,37850,66128,92735,45064,50924,24204,58816,65290,34392,55567,66416,72353,45775,68590,85685,72683,60090,37149,85347,57414,72336,12979,5720,92754,76911,96883,74420,5220,85815,23557,80567,44365,70254,50864,36619,51479,23281,76428,18580,34240,59289,49076,18439,29522,42541,4024,84446,92434,90407,77241,19690,78143,65919,13699,91844,91241,38361,67171,90551,5709,3474,76025,97043,33834,44638,54040,82797,545,38159,16089,35870,89158,55864,98078,50563,36492,10994,85909,9018,19252,73887,67928,60045,70782,11937,4074,53814,46621,52577,94853,45968,73667,65062,73306,76045,78649,91654,53958,96537,95542,67622,54579,17279,67440,56441,20681,64011,52226,96618,32831,60664,67547,39523,2043,59748,1887,69229,94653,99271,98164,62155,9234,47367,13047,6364,35064,10073,6793,80248,29009,44969,11129,17139,79630,89772,26921,56949,23465,30036,17173,82459,96218,60768,76417,24405,18710,68887,82394,69729,82503,40873,41590,67255,30757,9657,91881,34578,9511,5417,58953,18532,10721,22029,48524,47778,881,83489,3464,57462,97459,86689,39755,39547,740,36666,7993,31671,86304,12970,73402,52849,31652,79655,11250,18463,57518,20306,25301,1374,51208,33298,87662,61849,60923,68685,69411,39266,80320,34844,89416,81569,83651,35795,40168,33501,1042,58931,3892,85188,74740,85476,23790,33842,89565,53359,25579,59049,62394,72435,12457,21904,18370,97035,57905,9581,91227,92754,37760,1411,7440,87175,88318,63242,85960,56690,12618,30493,11569,73723,7448,58830,157,65814,21118,22140,73793,57855,81830,6795,13183,12625,30635,56429,73216,12342,36722,83886,96828,82870,90954,97614,2370,42160,73370,11944,49067,59452,80495,43911,46712,17033,68037,41963,3874,44856,82985,57453,84358,16120,4454,76624,405,62369,55080,61880,51270,87807,10653,36894,70850,35660,234,14705,93418,94084,82856,25384,71555,56754,78315,18291,91656,98079,52384,43306,65205,75903,58701,99496,50048,33557,87793,90857,10143,46726,84284,43635,41213,83845,70986,91408,80220,5728,68890,46577,21152,43759,43301,93661,97252,50106,10099,13722,18572,44024,351,18173,23717,85114,85998,57782,63951,53723,86853,63851,79430,49181,46386,69666,55743,76162,71724,40028,94786,34457,16906,90040,30789,40281,94697,96584,81907,4055,53990,66397,80579,42517,78181,39251,9467,67097,95523,66568,63632,71048,15581,39904,75774,77495,75994,29911,65690,41178,47712,70355,16998,56025,5230,10093,71495,34784,70950,54680,57811,53782,39145,36829,85342,40406,35883,45668,3459,29870,78252,70088,70621,67153,5737,40933,91075,93335,86853,15860,81167,91259,16118,52401,83593,84474,2423,75608,39646,90871,70284,82100,96032,5115,63678,2225,88087,58581,44364,57468,21539,13042,64150,63754,5210,87644,54114,64013,63562,41388,32397,74152,23982,71982,71700,33026,66477,47838,46712,39848,35083,65927,97868,11067,76771,71799,43836,41014,97025,93225,8511,63096,26628,73012,12543,76269,99708,2629,49845,73677,19193,14924,57236,95564,15010,59667,73773,78515,2624,99744,13585,33746,58771,94785,62628,99585,11363,80832,59979,9444,78700,2596,85984,69438,16913,96475,93283,18625,77086,45911,39746,64722,39938,43930,54619,302,50384,2738,75714,75249,95439,80714,52555,47266,96190,78750,94973,83669,16479,53163,48071,28e3,45011,26733,67132,83362,84162,43028,8415,27236,52651,89059,64844,80910,1676,91752,57815,26264,3415,57532,29981,61200,96036,62600,20068,56530,38487,8432,89514,26883,69165,97237,22361,55276,39902,95927,82190,49269,27212,46095,37106,64254,27460,49572,51700,27679,12574,33891,3867,9925,6476,82018,45094,59014,67113,44192,75,23318,79895,70550,81717,28833,30271,15821,14999,88174,62617,57517,55256,50281,51583,96879,5225,42272,5339,20483,57596,41011,75937,22767,50120,95938,49753,63882,99616,69083,38721,73889,80236,99531,23053,71237,48861,59046,76283,60538,19732,93877,30345,64882,66660,17026,70364,45676,8039,96228,89936,59141,95585,89552,97247,59325,27848,80058,15950,61481,90906,40998,44137,16144,66300,44091,50018,81364,18211,60294,76559,20279,27414,10589,39860,23e3,31767,95618,56738,50332,16936,70342,92481,30702,76264,62619,68678,62284,83112,93032,55203,52614,36950,41796,45403,79262,2887,53596,61308,20738,34811,27099,90956,65448,3080,75795,29753,97699,80872,23830,85882,74427,99523,74904,28017,45898,57232,48525,7086,26805,74533,92470,18840,76011,93109,14344,55614,50284,15865,19458,35856,13464,53679,64603,51571,56124,79107,29596,89572,78198,57121,73649,8804,87977,87959,70859,40909,77295,87877,75158,62810,92074,23244,59516,50552,31602,41899,6347,27821,68370,48596,88577,30231,25267,84622,31449,12086,56461,22962,78213,62483,93966,60437,52239,58113,32526,38708,81607,57016,1695,90110,4649,59990,23979,3855,10297,46516,96092,82305,30760,78756,4967,82876,4773,86651,16648,53133,82439,78851,49766,24553,15273,36417,1901,33386,76979,25920,33372,2695,11982,40911,6230,91696,43907,17827,30332,89203,32215,91806,23080,49102,9174,11548,54590,75803,66108,73882,62324,26017,72716,33887,1285,31604,71039,24337,53514,58964,89901,22040,92751,12617,37007,5523,61672,62557,98540,26094,60284,19621,96230,38044,6545,9458,42988,2913,86345,67936,90174,40840,44991,24256,34989,74086,13652,68706,1363,4294,88008,78693,83068,94746,221,89299,53186,5930,61889,51341,45412,58860,72568,11381,59785,36887,10690,31347,93326,96267,86987,57565,86836,49071,90331,41248,34629,30240,27270,3864,84308,3035,61369,36902,51017,44409,17120,23823,36460,63359,8333,63173,19134,6493,303,18550,26191,19051,81502,66343,6737,90430,65478,58982,82484,16483,47704,44640,68322,44548,72787,2335,28749,39320,5436,98146,56596,812,51445,35533,35478,47573,38414,25542,38032,13442,42983,97207,77854,57806,81616,52828,79429,47389,96795,57764,19605,24767,63253,18809,65093,44449,22952,76872,30983,38948,9310,48336,87651,27110,84427,76209,56412,12760,16747,14551,82626,31224,98636,75100,84882,79479,83420,5347,6803,90063,4617,40257,79183,41766,71873,25242,12275,336,40798,42055,74066,69128,32547,76508,32530,42359,89207,49758,58984,92732,15779,7234,28884,28226,50011,35883,99606,45423,76224,75427,85747,33879,97978,57441,927,19164,74716,40702,19715,70917,60344,40236,9019,50577,15598,53136,57285,20536,7539,74832,89184,41501,39447,97422,97041,21913,40581,76081,13089,28776,54164,55736,36263,71841,34488,74988,55467,43322,9214,36746,67981,71877,81683,32461,84091,19422,88366,62054,85664,13409,8003,88276,6989,16607,33633,85349,5784,25950,97998,74110,16699,60184,92818,79705,10381,1474,18656,50434,18232,92132,66537,70141,42854,25120,39581,28249,14215,34810,19767,3409,11807,6566,66138,42997,41999,67504,87117,28961,5e3,29673,77726,73225,54753,69712,71576,92337,17713,63185,87923,91889,68351,17712,75532,93849,48280,62219,317,25290,29209,90927,92929,92762,60413,2018,31793,76290,73373,80777,60819,77375,57886,47291,99670,32605,29064,99476,80999,31217,35,91300,14892,73653,26593,25305,56797,12837,39560,27582,37253,38531,76489,49946,69108,58687,43092,73807,96282,6648,67431,87124,57694,21660,64002,6,33600,30245,60636,80164,9285,61426,4658,54130,14710,76553,1904,93668,63110,98618,5601,32199,74923,98049,49717,55539,35940,58545,43295,35810,45451,38735,42065,66769,69825,45461,83881,67372,67351,90612,79502,69460,23108,74421,82990,46821,40683,71603,55267,48192,50242,79738,96417,6664,19929,23644,41116,51056,219,45086,32747,49492,15399,24874,80825,95928,61457,45813,59037,16136,3953,83583,5910,12654,53630,92997,22168,93491,71897,74579,24022,6278,24049,71670,43044,8474,38572,77402,35800,7455,96177,41653,74493,20802,65843,73050,73349,2638,65813,96209,49196,45007,32207,14097,66059,46681,7534,71263,20582,10171,51514,52142,60961,57951,25637,37860,21683,86190,90434,94481,85697,95344,2606,74095,61133,7472,64777,94050,41482,975,23471,76052,82021,87676,91345,20196,2612,86299,44996,40312,65712,46079,88514,8610,3685,63197,9073,53105,86824,28112,99306,40706,66840,83003,51590,52755,32285,68454,85058,13645,23073,24724,52989,71880,21952,44144,74975,76715,7844,46447,86643,75579,29276,10864,83179,36721,19300,35066,29383,47478,56644,33354,31414,17643,92374,85085,88458,87191,85248,34963,76278,53230,13953,76985,70959,36663,5293,32658,56767,56997,76736,6558,64248,11907,29123,78458,17678,63805,89973,5076,39263,54404,4355,64957,74407,99838,18836,78098,6490,74888,73719,80675,86178,56283,33591,96957,38382,18772,74773,71229,2603,52673,44609,14843,58418,18060,95459,626,30914,13550,42195,44863,8871,89182,64446,78422,41140,15312,98274,48168,95651,35562,85386,56252,72136,85088,68761,78434,98143,61330,2446,64409,49406,99127,98626,55095,44808,13594,87370,89472,12833,98932,68064,58193,20225,5192,28425,23978,24542,80845,55858,4015,21454,37346,51007,17202,10242,12682,55933,96922,22280,75597,50227,70712,44236,20470,36320,49339,60536,80083,38880,93327,49522,93585,9918,55268,4671,57526,11457,48424,54610,7211,78610,9473,72923,27347,30057,76968,26177,59367,46172,88951,40229,34921,60405,88959,16779,29547,92231,61997,36002,21080,39795,77221,10012,49748,76900,15964,3803,40260,92351,92844,10288,57483,10881,70408,75688,16610,1638,93082,44282,66849,75702,69428,34047,84968,71281,72328,73143,88672,49802,50639,18129,93659,58389,49095,45971,34196,84609,59222,19332,17777,41004,47057,30688,16039,20906,41477,42915,60877,33864,75195,62294,3371,11672,1370,2486,35553,17907,90621,45136,9722,67635,12114,63055,16004,21625,24321,20491,26881,66259,94287,54751,36242,36557,5842,30687,65418,94608,24741,45887,78800,86912,42076,50287,9284,68891,76368,83094,96302,35997,30761,97081,9501,68887,32876,1705,34260,95065,45528,88241,30402,12318,52430,40139,96986,84900,72408,42027,31676,54382,73370,26184,14024,57444,57660,52173,30274,93448,63273,77681,74946,2099,69091,19372,66961,14595,58642,75760,52253,53148,26074,52293,65359,63971,4833,86492,1227,54505,19515,89889,46933,13364,33883,83389,36952,52505,67513,40071,31001,3105,87912,29610,75108,37363,28479,43546,89992,19550,54863,82633,19209,21548,35022,21960,57961,11815,95867,559,26428,69386,57453,70147,73538,49562,46806,64550,36653,25718,68792,31113,7607,48037,71020,22666,65957,11141,39227,7990,19849,65972,74528,40888,55386,95918,92088,91125,53648,66122,138,79933,71058,34826,97725,69513,22915,18246,52244,91161,40861,40374,13239,56162,4703,95851,22824,41271,28202,62852,84238,46625,20031,8524,20077,65817,21174,29279,57712,22401,67500,30980,74485,26480,21343,30031,61921,35744,57308,71196,1865,49234,62616,54021,29008,83672,85839,96836,45077,80900,66906,63526,93824,71820,11033,20183,85704,4683,63512,39144,56880,64424,95979,17709,94849,31771,5737,84286,16757,46256,24478,73180,59978,8254,78963,95437,86351,33824,32540,18357,2668,99260,21284,81351,70961,10255,6911,47394,72408,23827,59865,96395,30665,43699,3593,29165,23388,26628,92402,16731,86740,29493,9069,78653,90094,42735,33682,95041,89887,92369,57949,81585,50593,14698,4737,72551,57271,59433,156,33966,58773,59108,49578,18100,59836,73221,21110,1650,11058,47770,66141,84576,58388,40915,94507,32209,17272,65674,95552,25685,5345,36995,36302,7971,67001,62062,75939,36005,26739,56484,46885,66348,87666,78055,44485,82955,85936,9219,1847,92687,72579,45457,78252,98239,4e4,75563,92408,17175,78845,32638,26959,35406,59553,57852,7506,9,93172,77713,93880,40981,27924,9678,24538,52426,84852,83781,23712,82490,77890,22482,66668,55850,25644,44972,62275,78089,28894,98685,32998,98766,89119,34355,75127,69797,71419,62067,57990,96514,50603,79807,26135,29207,43632,32905,38513,18924,88872,20758,70232,60425,1116,24077,21369,93541,75329,78656,44251,42014,98154,42552,14575,30765,348,1134,71581,68420,78141,21105,63305,9718,54851,65867,8595,47390,39182,51174,41478,64433,59628,31945,87322,78667,95282,5622,26224,19972,97269,98376,14779,51138,49658,45345,4972,52794,15737,496,48939,63485,42780,16061,59631,37171,13483,56058,51093,62290,88227,17400,88433,67363,89507,26482,85964,71336,67799,28342,37747,61722,27180,78755,18603,42953,6606,23875,56766,1932,36113,62807,84012,21103,9685,69662,76755,13701,95168,13169,44726,15284,16702,89617,54397,52052,12835,37741,86434,22400,37947,95763,86337,35189,22756,47473,16618,42479,47405,14055,64262,66670,89692,54032,94591,44149,29854,76691,33263,62048,25116,88598,16119,62116,54517,31883,86707,18895,81790,71294,2684,15292,48107,14341,91416,75609,92564,39987,2283,89970,95855,80970,5432,89860,90293,99851,94648,5598,32171,28793,92305,64244,8277,93391,96717,34464,29838,10664,28050,60122,77934,10758,84922,92220,45071,97697,36368,17792,84792,76594,67319,51886,5665,45201,11348,9254,7510,51039,91683,84500,85338,5555,19633,3870,39576,41486,58524,54508,20707,58504,39642,22454,80069,83455,31043,90794,51934,3295,26582,16300,74990,22197,83310,69642,81113,58558,84833,17105,46659,25003,85749,44829,4103,67516,76458,52392,53546,70291,98846,67315,30686,18555,29755,5923,22732,19501,56181,85351,5023,4808,56911,16793,75336,49712,27723,96974,34321,5454,12862,71924,45928,95697,68664,58183,78104,42483,71204,99628,40642,56410,17350,13396,76724,87509,9158,83708,27298,92651,95086,38851,63558,89810,1580,32518,35795,26514,56322,78635,63731,91428,7247,66460,38671,26799,22549,47991,46064,80467,40083,17141,39152,99872,27561,75389,74778,94893,82935,99076,93419,10474,84436,47536,16719,60136,80566,28404,74525,74212,3704,65516,98197,34210,64140,22238,49939,99542,27481,21992,78181,90060,71365,66935,29578,14961,8569,9454,43308,66753,45972,93572,16382,87320,37183,25478,38164,31997,69856,60898,63968,62264,4799,17591,89937,73905,55890,88285,2448,40398,54180,65869,45155,43407,39105,339,51619,20203,21189,68245,76912,1222,76411,82679,7,66047,32043,42627,16638,27019,15248,66444,8249,18790,82150,54084,84469,3426,50226,99868,88894,43769,66384,8593,41414,2976,60053,51866,87904,74135,53842,59520,67482,16995,32328,29555,49067,2799,68851,41049,97190,53984,99755,46412,45885,64e3,21962,36438,71742,57223,66599,86071,31436,32667,98099,38399,47377,5171,2742,48803,17823,22093,9866,691,5514,25546,2114,5919,56181,96052,67211,61712,25995,3188,23833,38549,44775,55355,61548,55988,47309,23749,30667,70732,33299,16127,30842,78961,41072,9876,18903,30292,25275,61881,15939,72573,84502,92654,97226,53434,77025,63892,12421,33644,39445,30933,84218,13757,37719,84450,2697,60309,22402,80310,92771,45205,72792,95776,85945,74651,216,50842,47854,21916,61588,75405,10495,83083,60427,78495,99809,47890,22993,21508,9459,26845,98130,1184,46438,27698,40652,65654,98517,1096,6998,49133,57041,77983,58708,42176,67356,324,70063,10597,65205,25622,34336,16640,27896,26907,86760,48244,89650,44997,51609,28934,9171,97859,97213,19859,41037,64081,94781,27683,41521,52871,86935,26486,38744,25943,60617,6414,42292,46204,53262,30201,38776,88831,97253,67282,72860,18452,60927,81504,57713,30296,10896,39900,67135,42772,4631,55283,39253,25264,1809,12874,88035,88421,90491,83290,6884,15444,90113,20406,20796,40239,34431,15018,45600,17241,26611,9551,89126,65673,31708,91252,39647,63011,24193,58932,89326,33491,53217,27976,70151,37531,53576,23931,11789,73073,52171,89301,51718,15385,79487,66436,35771,34163,86540,42665,80748,77622,14679,40185,25030,42622,13162,17048,24243,59985,59807,60562,3595,10135,29199,69784,59796,38194,58432,50943,40422,63035,3208,81440,90749,88046,32218,88092,22224,2627,91576,16781,43948,57795,71073,27817,87077,82717,24473,42096,76920,88864,90537,14715,42551,45066,24316,37361,38582,21871,14672,93362,21727,57021,94313,39562,64985,94028,46094,43845,91838,79574,7597,3153,56783,18817,74711,6883,91061,31674,73729,99315,66183,57647,74484,68077,33224,397,56753,53158,71872,68153,9298,20961,49656,33407,95683,14328,44708,72952,27048,67887,28741,46752,88177,95894,40086,88534,87112,68614,83073,88794,96799,67588,75049,84603,83140,97347,87316,73087,77135,71883,98643,3808,8848,14133,60447,1366,72976,1868,51667,63279,60040,88264,79152,3474,61366,20523,21584,93712,83654,89761,90154,96345,37539,32556,74254,70603,97122,44978,78028,8943,13778,11080,34271,68276,85372,48410,94516,15427,75323,71685,70774,50342,33771,3678,42321,69788,41758,55004,30992,17402,63523,42328,87171,24751,15084,33884,83655,88345,69602,52606,57886,18034,3381,75796,35901,77480,28683,68324,66035,7223,14926,16128,13645,90370,31949,11057,98849,29499,21565,30786,83292,92392,37104,36899,49906,79368,43710,80365,88735,75275,21664,57965,19002,301,12658,94385,1717,96191,50404,80166,93965,24688,27839,10812,31715,92127,42588,93307,80834,11317,26583,25769,98227,14884,58462,29148,68662,26872,72927,79021,51622,29521,33355,45701,45996,33782,93424,16530,96086,17329,74020,11501,46660,5583,22277,77653,55430,84644,448,86828,58855,67451,95264,67386,82424,52611,60012,88620,72894,94716,22262,99813,69592,63464,33163,91857,47904,22209,78590,68615,52952,31441,41313,18550,72685,68825,4795,53971,14592,39634,23682,76630,2731,81481,86542,23727,54291,56045,61635,32186,9355,73416,63532,24340,18886,84832,30654,48543,18339,65024,91197,64624,74648,9660,27897,49771,11123,8732,49393,12911,72416,17834,18878,62754,85072,23727,56577,51257,83291,12329,16203,91681,68137,79959,43609,58987,2026,42969,59144,84349,75214,76972,22633,64104,53799,16851,99197,70476,77113,46320,88693,37711,96536,68156,7119,2104,49435,77706,18924,24957,92406,87148,70482,36491,42605,54440,7893,31618,35707,65130,30007,75706,77266,37100,9601,87681,42543,69847,81848,32034,49429,99434,62209,17125,55227,61634,52574,83649,28725,70119,62467,80676,21192,99584,21310,25292,72781,17186,10393,98390,19789,92931,36234,62627,23437,3885,58822,82941,43806,8172,23790,72295,36196,98200,2889,87619,13846,56197,27151,21238,48794,81100,62643,40001,39243,33213,78416,194,91369,79342,36404,52308,13741,24442,88610,12659,11574,70052,93039,79367,41792,61816,35435,47192,97596,28330,41145,16918,62865,9576,45857,68737,90124,16703,7071,48433,57222,34435,800,72496,16449,68187,28739,97672,86818,50768,40807,88681,64340,2224,19703,59245,90905,31239,84216,93942,97371,16842,92168,52692,16064,84686,89444,27938,98406,41365,4515,20494,18813,16242,10634,61566,18592,78057,8720,33739,78345,87693,30242,70545,55521,23687,9160,8655,38811,61768,7228,5567,5561,82071,85,50145,23113,97761,88441,14891,72188,85166,37189,75671,81377,92470,73645,93258,6610,12185,43065,26704,47922,56650,7527,18006,56948,51675,16658,66402,1047,81624,77395,62310,73262,66050,57275,32936,87641,51528,58183,21952,84098,28913,28622,18140,89796,41317,93954,67690,64667,57092,21315,4731,76115,77291,11204,8634,93034,27411,27149,13843,9817,9407,84492,28444,59901,14592,89654,66207,66232,80293,74502,36925,55515,10121,16768,4720,71502,40500,21406,571,87320,81683,42788,86367,44686,22159,67015,35892,49668,83991,72088,30210,74009,86370,97956,2132,93512,54819,26094,51409,21485,94764,85806,13393,48543,7042,76538,64224,47909,9994,23750,17351,52141,30486,60380,86546,66606,36913,58173,45709,83679,82617,23381,9603,61107,566,6572,64745,10614,86371,43244,97154,10397,50975,68006,20045,16942,25536,74031,31807,70133,78790,40341,68730,39635,39013,66841,44043,96215,21270,59427,25034,40645,84741,52083,54503,36861,27659,95463,53847,40921,70116,61536,56756,8967,31079,20097,76014,99818,16606,19713,66904,27106,24874,96701,73287,76772,6073,57343,51428,91171,28299,17520,64903,4177,36071,94952,59008,28543,11576,74547,13260,20688,41261,2780,6633,37536,8844,95774,49323,30448,14154,83379,71259,23302,68402,43750,88505,15575,44927,6584,29867,21541,65763,12154,86616,79877,73259,68626,98962,68548,86576,48046,51755,64995,3661,64585,81550,46798,49319,50206,22024,5175,12923,23427,55915,91723,55831,83784,81034,86779,34622,84570,18960,48798,42970,95789,39465,82353,68905,44234,18244,54345,5592,89361,14644,67924,66415,89349,88530,72096,44459,5258,48317,48866,56886,90458,75889,4514,37227,11302,4667,2129,80414,86289,15887,87380,50749,83220,50529,20619,11606,36531,23409,78122,19566,76564,33045,66703,30017,35347,35038,12952,13971,3922,98702,11786,38388,69556,76728,60535,59961,23634,42211,98387,34880,27755,93182,99040,96390,65989,38375,3652,59657,57431,24666,11061,64713,85185,72849,58611,31220,26657,77056,24553,24993,5210,89024,32054,46997,92652,28363,98992,22593,97710,47766,37646,93573,95502,33790,92973,27766,62671,89698,10877,73893,41004,96035,18795,48080,59666,30241,35233,87353,43647,13404,41982,19264,29229,61369,8309,39383,42305,25944,13577,51545,68990,69801,37145,79189,55897,57793,66816,21930,56771,79296,73793,21632,42301,23696,72641,56310,85576,3004,25669,69221,32996,23040,65782,23712,13414,10758,15590,97298,74246,51511,46900,36795,38292,3852,6384,84421,3446,91670,45312,27609,87034,6683,83891,88991,16533,9197,34427,60384,48525,90978,46107,21693,12956,21804,46558,37682,81207,85840,53238,35026,4835,53264,41376,17783,64756,39278,25403,33042,20954,31193,24247,45911,92453,25370,86602,48574,57865,26436,16122,76614,17028,21262,59718,77821,14036,31033,90563,45410,15158,90209,84089,38053,60780,54166,14255,33120,27171,71798,91214,80040,56699,12475,40193,59415,4769,75920,1036,2692,75862,16612,73670,61182,3305,90334,187,91659,28063,75684,50017,82643,9282,77376,85469,8164,5584,36623,82597,83859,3435,98460,70095,80257,4381,6501,8924,35514,14297,54373,71369,5172,15955,82441,4636,48215,6821,3385,17663,40107,55679,30366,42390,95895,16083,58499,17176,55993,51034,49296,4010,78974,35930,2019,96226,27167,68245,53109,59037,37843,79243,10262,58797,61490,82590,52411,54783,29447,94551,30026,97959,93939,73217,82573,62154,78291,33728,39102,11484,86210,43794,73553,87435,1110,77108,56521,78610,8254,1842,43068,70415,79195,26136,49786,47279,38471,20379,54704,86614,91138,51595,50818,80186,73087,17262,94735,4952,27935,4928,74862,51392,62388,9570,38485,30594,56278,47395,72762,94597,72279,16010,34697,54475,67874,78014,88381,4045,41494,55178,46054,24373,1824,55333,7525,97908,61178,84635,2199,35361,4803,21907,79414,66083,54782,58692,28332,41851,28198,55819,37313,67046,16147,90478,71230,34141,85002,44332,35906,429,39744,773,22909,19536,98986,90945,45209,85439,92265,25291,22775,60611,49159,95701,36113,53923,60824,84935,29656,50007,86624,61691,76150,32187,42765,60660,13859,10792,88210,29374,29563,45188,28811,19739,67649,73775,99247,48414,91067,68253,9452,90116,91737,73979,62370,69112,58791,20349,71480,56852,36919,87977,77609,68738,85159,4918,70076,46473,4122,57713,1426,50987,77910,66211,62546,77749,96462,34304,77441,12104,91805,10287,60943,49632,83116,25716,23113,22707,77770,31176,6759,46130,4739,55554,3843,31653,70834,72877,41561,36903,23010,6663,2266,16360,70118,91936,17098,77278,4880,23484,94970,41826,46733,93484,68350,38861,18134,32936,241,24803,13876,93278,5039,35873,44418,5305,28510,36115,46717,15238,78607,23464,68635,55712,55007,92411,65739,4858,67537,37041,67453,89801,45963,14800,14225,65655,80463,9716,77255,65136,11230,76323,81433,36445,86523,61058,59560,19380,40791,48073,29626,36661,87907,57369,41623,13705,3880,45088,55444,41003,27754,1450,75312,71801,99600,60719,54182,29245,63315,73758,42973,32702,10855,56363,14638,84424,27178,78195,3133,70865,48019,26117,7151,52107,85562,41347,50486,69457,86961,95482,11857,93587,45680,42145,13029,10043,5142,49213,54525,85761,42707,70754,33768,87671,85038,58900,88438,20004,63390,14815,38875,73417,82875,89481,55517,944,15773,61814,32915,27868,5510,21916,28426,89881,16680,88850,11056,51991,4230,39107,49216,40065,4523,75848,95349,56034,10724,9885,88232,42478,65702,95696,39746,66032,88082,86905,30007,75068,66629,7358,26706,90511,72843,67857,20061,98581,69682,38e3,14186,70,2290,17269,30909,69449,19997,13275,2444,84985,51290,97641,15092,69650,21920,19617,7418,49725,91090,20805,28627,80665,67192,34697,57667,99323,50101,40587,35081,14037,34414,19898,60779,83267,87499,29596,41852,15813,32419,72232,8322,39184,46525,13833,65743,94595,37363,4711,35386,96413,10627,62625,56555,12919,93218,25191,98380,51923,66181,5788,73491,1452,487,12277,45415,11884,61300,94528,9181,26616,11455,31514,63290,45035,42759,33804,85721,80979,46010,50975,72482,31231,3086,58941,46102,25773,89742,29788,96741,88523,14922,88262,76305,57676,93259,2396,69145,26074,30056,3853,75317,56639,66203,38923,48939,22813,91864,10934,6714,84099,25631,73223,95630,97552,45950,22197,42886,33764,1263,41856,82057,62349,94091,78028,62651,18911,5693,92561,97821,41994,92343,76785,22216,4203,5038,86151,23596,24338,77181,51761,97693,10955,98159,37568,58932,72128,27303,99608,31688,57557,91022,43036,93927,32869,53653,55205,33139,47271,31224,51650,36422,86857,73799,22068,43376,84760,44898,65776,42451,71480,38509,41673,44141,75918,95652,68981,83001,48815,98086,67950,27986,33175,43624,55274,71051,61124,51550,64967,31570,15748,19159,38174,51078,79811,39183,57527,96550,85168,28824,47466,56993,13151,96664,29735,70251,1079,4314,77714,11507,1440,48415,31984,99915,20282,26524,18057,4992,40521,98108,84045,91961,79256,72244,25788,5487,23595,73302,14205,8925,27625,64343,28821,37992,67156,83320,31106,10884,30735,15067,51091,15668,48777,50770,19169,76504,41165,29749,92812,8065,66782,26841,1411,95461,61134,18699,52261,60469,81373,44825,11448,73320,30151,56991,31372,6655,36472,86292,30247,30931,21029,53410,9859,37267,47514,3492,49008,94727,25234,40546,53417,36492,25723,76227,58456,15979,34876,9574,34392,3751,36933,83921,65108,63135,67572,40184,21098],d=new Array(16),p=[16,8,16,24],b=4,g=0;(function(){for(var x=0;x<16;x++){d[x]=new Array(256);for(var _=0;_<256;_++)d[x][_]=_|_<<8|_<<16|_<<24|0;for(var S=3;0<=S;S--)for(var I=0;I<255;I++){var P=255<<(S<<3),F=0|d[x][I],D=function(k,w){var C=w-k+1,T=0,O=1;do for(T=0,O=1;O<C;O*=10)T=10*T+(b<0&&(b=4,g++),m[g]%Math.pow(10,b+1)/Math.pow(10,b--)|0);while((O/C|0)*C<=T);return k+T%C|0}(I,255);d[x][I]=d[x][I]&~P|d[x][D]&P|0,d[x][D]=d[x][D]&~P|F&P|0}}})(),function(x,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");x.prototype=Object.create(_&&_.prototype,{constructor:{value:x,writable:!0,configurable:!0}}),_&&f(x,_)}(v,l.a),function(x,_){for(var S=0;S<_.length;S++){var I=_[S];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(x,I.key,I)}}(v.prototype,[{key:"reset",value:function(){s(u(v.prototype),"reset",this).call(this),this.state.hash=new Array(this.options.length/32|0);for(var x=0;x<this.state.hash.length;x++)this.state.hash[x]=0}},{key:"processBlock",value:function(x){for(var _=0;_<this.state.hash.length;_++)this.W[_]=0|this.state.hash[_];for(var S=this.state.hash.length;S<16;S++)this.W[S]=0|x[S-this.state.hash.length];for(var I=0;I<this.options.rounds<<1;I+=2)for(var P=0;P<4;P++){for(var F=0;F<16;F++){var D=0|d[I+(F/2|0)%2][255&this.W[F]];this.W[F-1>>>0&15]^=D,this.W[F+1&15]^=D}for(var k=0;k<16;k++)this.W[k]=Object(o.b)(this.W[k],p[P])}for(var w=0;w<this.state.hash.length;w++)this.state.hash[w]=this.state.hash[w]^this.W[15-w]|0}},{key:"finalize",value:function(){return 0<this.state.message.length&&this.addPaddingZero(this.blockSizeInBytes-this.state.message.length|0),this.addPaddingZero(this.blockSizeInBytes-8|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),l=v;function v(x){var _;return function(S){if(!(S instanceof v))throw new TypeError("Cannot call a class as a function")}(this),(x=x||{}).length=x.length||128,x.rounds=x.rounds||8,_=this,(x=!(x=u(v).call(this,x))||a(x)!=="object"&&typeof x!="function"?function(){if(_!==void 0)return _;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():x).blockSize=16-x.state.hash.length,x.blockSizeInBytes=x.blockSize*x.unitSize,x.W=new Array(16),x}n.a=l},function(e,n,t){"use strict";var l=t(5),o=t(0);function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(v)}function s(v,x){for(var _=0;_<x.length;_++){var S=x[_];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(v,S.key,S)}}function u(v,x,_){return(u=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(S,I,P){if(S=function(F,D){for(;!Object.prototype.hasOwnProperty.call(F,D)&&(F=f(F))!==null;);return F}(S,I),S)return I=Object.getOwnPropertyDescriptor(S,I),I.get?I.get.call(P):I.value})(v,x,_||v)}function f(v){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(v)}function m(v,x){return(m=Object.setPrototypeOf||function(_,S){return _.__proto__=S,_})(v,x)}for(var d=[[7,12,17,22],[5,9,14,20],[4,11,16,23],[6,10,15,21]],p=new Array(64),b=0;b<64;b++)p[b]=4294967296*Math.abs(Math.sin(b+1))|0;(function(v,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(x&&x.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),x&&m(v,x)})(g,l.a),t=[{key:"FF",value:function(v,x,_){return v&x|~v&_}},{key:"GG",value:function(v,x,_){return v&_|x&~_}},{key:"HH",value:function(v,x,_){return v^x^_}},{key:"II",value:function(v,x,_){return x^(v|~_)}},{key:"CC",value:function(v,x,_,S,I,P,F,D){return Object(o.a)(_+v(S,I,P)+F+x,D)+S|0}}],s((l=g).prototype,[{key:"reset",value:function(){u(f(g.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878]}},{key:"processBlock",value:function(v){var x=0|this.state.hash[0],_=0|this.state.hash[1],S=0|this.state.hash[2],I=0|this.state.hash[3],x=g.CC(g.FF,p[0],x,_,S,I,v[0],d[0][0]),I=g.CC(g.FF,p[1],I,x,_,S,v[1],d[0][1]),S=g.CC(g.FF,p[2],S,I,x,_,v[2],d[0][2]),_=g.CC(g.FF,p[3],_,S,I,x,v[3],d[0][3]);x=g.CC(g.FF,p[4],x,_,S,I,v[4],d[0][0]),I=g.CC(g.FF,p[5],I,x,_,S,v[5],d[0][1]),S=g.CC(g.FF,p[6],S,I,x,_,v[6],d[0][2]),_=g.CC(g.FF,p[7],_,S,I,x,v[7],d[0][3]),x=g.CC(g.FF,p[8],x,_,S,I,v[8],d[0][0]),I=g.CC(g.FF,p[9],I,x,_,S,v[9],d[0][1]),S=g.CC(g.FF,p[10],S,I,x,_,v[10],d[0][2]),_=g.CC(g.FF,p[11],_,S,I,x,v[11],d[0][3]),x=g.CC(g.FF,p[12],x,_,S,I,v[12],d[0][0]),I=g.CC(g.FF,p[13],I,x,_,S,v[13],d[0][1]),S=g.CC(g.FF,p[14],S,I,x,_,v[14],d[0][2]),_=g.CC(g.FF,p[15],_,S,I,x,v[15],d[0][3]),x=g.CC(g.GG,p[16],x,_,S,I,v[1],d[1][0]),I=g.CC(g.GG,p[17],I,x,_,S,v[6],d[1][1]),S=g.CC(g.GG,p[18],S,I,x,_,v[11],d[1][2]),_=g.CC(g.GG,p[19],_,S,I,x,v[0],d[1][3]),x=g.CC(g.GG,p[20],x,_,S,I,v[5],d[1][0]),I=g.CC(g.GG,p[21],I,x,_,S,v[10],d[1][1]),S=g.CC(g.GG,p[22],S,I,x,_,v[15],d[1][2]),_=g.CC(g.GG,p[23],_,S,I,x,v[4],d[1][3]),x=g.CC(g.GG,p[24],x,_,S,I,v[9],d[1][0]),I=g.CC(g.GG,p[25],I,x,_,S,v[14],d[1][1]),S=g.CC(g.GG,p[26],S,I,x,_,v[3],d[1][2]),_=g.CC(g.GG,p[27],_,S,I,x,v[8],d[1][3]),x=g.CC(g.GG,p[28],x,_,S,I,v[13],d[1][0]),I=g.CC(g.GG,p[29],I,x,_,S,v[2],d[1][1]),S=g.CC(g.GG,p[30],S,I,x,_,v[7],d[1][2]),_=g.CC(g.GG,p[31],_,S,I,x,v[12],d[1][3]),x=g.CC(g.HH,p[32],x,_,S,I,v[5],d[2][0]),I=g.CC(g.HH,p[33],I,x,_,S,v[8],d[2][1]),S=g.CC(g.HH,p[34],S,I,x,_,v[11],d[2][2]),_=g.CC(g.HH,p[35],_,S,I,x,v[14],d[2][3]),x=g.CC(g.HH,p[36],x,_,S,I,v[1],d[2][0]),I=g.CC(g.HH,p[37],I,x,_,S,v[4],d[2][1]),S=g.CC(g.HH,p[38],S,I,x,_,v[7],d[2][2]),_=g.CC(g.HH,p[39],_,S,I,x,v[10],d[2][3]),x=g.CC(g.HH,p[40],x,_,S,I,v[13],d[2][0]),I=g.CC(g.HH,p[41],I,x,_,S,v[0],d[2][1]),S=g.CC(g.HH,p[42],S,I,x,_,v[3],d[2][2]),_=g.CC(g.HH,p[43],_,S,I,x,v[6],d[2][3]),x=g.CC(g.HH,p[44],x,_,S,I,v[9],d[2][0]),I=g.CC(g.HH,p[45],I,x,_,S,v[12],d[2][1]),S=g.CC(g.HH,p[46],S,I,x,_,v[15],d[2][2]),_=g.CC(g.HH,p[47],_,S,I,x,v[2],d[2][3]),x=g.CC(g.II,p[48],x,_,S,I,v[0],d[3][0]),I=g.CC(g.II,p[49],I,x,_,S,v[7],d[3][1]),S=g.CC(g.II,p[50],S,I,x,_,v[14],d[3][2]),_=g.CC(g.II,p[51],_,S,I,x,v[5],d[3][3]),x=g.CC(g.II,p[52],x,_,S,I,v[12],d[3][0]),I=g.CC(g.II,p[53],I,x,_,S,v[3],d[3][1]),S=g.CC(g.II,p[54],S,I,x,_,v[10],d[3][2]),_=g.CC(g.II,p[55],_,S,I,x,v[1],d[3][3]),x=g.CC(g.II,p[56],x,_,S,I,v[8],d[3][0]),I=g.CC(g.II,p[57],I,x,_,S,v[15],d[3][1]),S=g.CC(g.II,p[58],S,I,x,_,v[6],d[3][2]),_=g.CC(g.II,p[59],_,S,I,x,v[13],d[3][3]),x=g.CC(g.II,p[60],x,_,S,I,v[4],d[3][0]),I=g.CC(g.II,p[61],I,x,_,S,v[11],d[3][1]),S=g.CC(g.II,p[62],S,I,x,_,v[2],d[3][2]),_=g.CC(g.II,p[63],_,S,I,x,v[9],d[3][3]),this.state.hash[0]=this.state.hash[0]+x|0,this.state.hash[1]=this.state.hash[1]+_|0,this.state.hash[2]=this.state.hash[2]+S|0,this.state.hash[3]=this.state.hash[3]+I|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),s(l,t),t=g;function g(){return function(_){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}(this),v=this,!(x=f(g).apply(this,arguments))||a(x)!=="object"&&typeof x!="function"?function(){if(v!==void 0)return v;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():x;var v,x}n.a=t},function(e,n,t){"use strict";var l=t(3),o=t(0);function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(p)}function s(p,b,g){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(v,x,_){if(v=function(S,I){for(;!Object.prototype.hasOwnProperty.call(S,I)&&(S=u(S))!==null;);return S}(v,x),v)return x=Object.getOwnPropertyDescriptor(v,x),x.get?x.get.call(_):x.value})(p,b,g||p)}function u(p){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(p)}function f(p,b){return(f=Object.setPrototypeOf||function(g,v){return g.__proto__=v,g})(p,b)}var m=[1518500249,1859775393,2400959708,3395469782],l=(function(p,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(b&&b.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),b&&f(p,b)}(d,l.a),function(p,b){for(var g=0;g<b.length;g++){var v=b[g];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(p,v.key,v)}}(d.prototype,[{key:"reset",value:function(){s(u(d.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878,-1009589776]}},{key:"processBlock",value:function(p){for(var b=0|this.state.hash[0],g=0|this.state.hash[1],v=0|this.state.hash[2],x=0|this.state.hash[3],_=0|this.state.hash[4],S=0;S<this.options.rounds;S++){this.W[S]=S<16?0|p[S]:0|Object(o.a)(this.W[S-3]^this.W[S-8]^this.W[S-14]^this.W[S-16],1);var I=Object(o.a)(b,5)+_+this.W[S]+m[S/20>>0]|0,I=S<20?I+(g&v|~g&x)|0:!(S<40)&&S<60?I+(g&v|g&x|v&x)|0:I+(g^v^x)|0,_=x,x=v,v=0|Object(o.a)(g,30),g=b,b=I}this.state.hash[0]=this.state.hash[0]+b|0,this.state.hash[1]=this.state.hash[1]+g|0,this.state.hash[2]=this.state.hash[2]+v|0,this.state.hash[3]=this.state.hash[3]+x|0,this.state.hash[4]=this.state.hash[4]+_|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),d);function d(p){var b;return function(g){if(!(g instanceof d))throw new TypeError("Cannot call a class as a function")}(this),b=this,(p=!(p=u(d).call(this,p))||a(p)!=="object"&&typeof p!="function"?function(){if(b!==void 0)return b;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():p).options.rounds=p.options.rounds||80,p.W=new Array(80),p}n.a=l},function(e,n,t){"use strict";var l=t(0),t=t(3);function o(w){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(w)}function a(w,C,T){return(a=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(O,z,A){if(O=function(E,L){for(;!Object.prototype.hasOwnProperty.call(E,L)&&(E=s(E))!==null;);return E}(O,z),O)return z=Object.getOwnPropertyDescriptor(O,z),z.get?z.get.call(A):z.value})(w,C,T||w)}function s(w){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(C){return C.__proto__||Object.getPrototypeOf(C)})(w)}function u(w,C){return(u=Object.setPrototypeOf||function(T,O){return T.__proto__=O,T})(w,C)}var f=new Array(256),m=[104,208,235,43,72,157,106,228,227,163,86,129,125,241,133,158,44,142,120,202,23,169,97,213,93,11,140,60,119,81,34,66,63,84,65,128,204,134,179,24,46,87,6,98,244,54,209,107,27,101,117,16,218,73,38,249,203,102,231,186,174,80,82,171,5,240,13,115,59,4,32,254,221,245,180,95,10,181,192,160,113,165,45,96,114,147,57,8,131,33,92,135,177,224,0,195,18,145,138,2,28,230,69,194,196,253,191,68,161,76,51,197,132,35,124,176,37,21,53,105,255,148,77,112,162,175,205,214,108,183,248,9,243,103,164,234,236,182,212,210,20,30,225,36,56,198,219,75,122,58,222,94,223,149,252,170,215,206,7,15,61,88,154,152,156,242,167,17,126,139,67,3,226,220,229,178,78,199,109,233,39,64,216,55,146,143,1,29,83,62,89,193,79,50,22,250,116,251,99,159,52,26,42,90,141,201,207,246,144,40,136,155,49,14,189,74,232,150,166,12,200,121,188,190,239,110,70,151,91,237,25,217,172,153,168,41,100,31,173,85,19,187,247,111,185,71,47,238,184,123,137,48,211,127,118,130],d=[1,11,9,12,13,6,15,3,14,8,7,4,10,2,5,0],p=[7,12,11,13,14,4,9,15,6,3,8,10,2,5,1,0],b=new Array(16),g=[1,1,4,1,8,5,2,9],v=[1,1,3,1,5,8,9,5],x=new Array(512),_=new Array(22),S=new Array(512),I=new Array(22),P=new Array(512),F=new Array(22);function D(w,C){for(var T=new Array(512),O=new Array(22),z=0;z<8;z++)T[z]=[];for(var A=0;A<256;A++){var E=new Array(10);E[1]=w[A],E[2]=E[1]<<1,256<=E[2]&&(E[2]^=285),E[3]=E[2]^E[1],E[4]=E[2]<<1,256<=E[4]&&(E[4]^=285),E[5]=E[4]^E[1],E[8]=E[4]<<1,256<=E[8]&&(E[8]^=285),E[9]=E[8]^E[1],T[0][2*A]=E[C[0]]<<24|E[C[1]]<<16|E[C[2]]<<8|E[C[3]],T[0][2*A+1]=E[C[4]]<<24|E[C[5]]<<16|E[C[6]]<<8|E[C[7]];for(var L=1;L<8;L++)T[L][2*A]=Object(l.d)(T[0][2*A+1],T[0][2*A],L<<3),T[L][2*A+1]=Object(l.c)(T[0][2*A+1],T[0][2*A],L<<3)}O[0]=0,O[1]=0;for(var N=1;N<=10;N++)O[2*N]=4278190080&T[0][16*N-16]^16711680&T[1][16*N-14]^65280&T[2][16*N-12]^255&T[3][16*N-10],O[2*N+1]=4278190080&T[4][16*N-7]^16711680&T[5][16*N-5]^65280&T[6][16*N-3]^255&T[7][16*N-1];return[T,O]}(function(){(function(){for(var C=0;C<16;C++)b[d[C]]=0|C;for(var T=0;T<256;T++){var O=d[T>>4],z=b[15&T],A=p[O^z];f[T]=d[O^A]<<4|b[z^A]}})();var w=D(m,v);S=w[0],I=w[1],w=D(f,v),P=w[0],F=w[1],w=D(f,g),x=w[0],_=w[1]})(),function(w,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");w.prototype=Object.create(C&&C.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),C&&u(w,C)}(k,t.a),function(w,C){for(var T=0;T<C.length;T++){var O=C[T];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(w,O.key,O)}}(k.prototype,[{key:"reset",value:function(){a(s(k.prototype),"reset",this).call(this),this.state.hash=new Array(16);for(var w=0;w<16;w++)this.state.hash[w]=0}},{key:"processBlock",value:function(w){for(var C=new Array(16),T=[],O=0;O<16;O++)T[O]=w[O]^(C[O]=this.state.hash[O])|0;for(var z=[],A=1;A<=this.options.rounds;A++){for(var E=0;E<8;E++){z[2*E]=0;for(var L=z[2*E+1]=0,N=56,W=0;L<8;L++,W=(N-=8)<32?1:0)z[2*E]^=this.C[L][2*(C[2*(E-L&7)+W]>>>N%32&255)],z[2*E+1]^=this.C[L][2*(C[2*(E-L&7)+W]>>>N%32&255)+1]}for(var X=0;X<16;X++)C[X]=z[X];C[0]^=this.RC[2*A],C[1]^=this.RC[2*A+1];for(var te=0;te<8;te++){z[2*te]=C[2*te],z[2*te+1]=C[2*te+1];for(var ue=0,pe=56,ne=0;ue<8;ue++,ne=(pe-=8)<32?1:0)z[2*te]^=this.C[ue][2*(T[2*(te-ue&7)+ne]>>>pe%32&255)],z[2*te+1]^=this.C[ue][2*(T[2*(te-ue&7)+ne]>>>pe%32&255)+1]}for(var me=0;me<16;me++)T[me]=z[me]}for(var Q=0;Q<16;Q++)this.state.hash[Q]^=T[Q]^w[Q]}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<32?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),t=k;function k(w){var C,T;switch(function(O){if(!(O instanceof k))throw new TypeError("Cannot call a class as a function")}(this),(w=w||{}).type=w.type||"",w.rounds=w.rounds||10,T=this,(C=!(w=s(k).call(this,w))||o(w)!=="object"&&typeof w!="function"?function(){if(T!==void 0)return T;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():w).options.type){case"0":case 0:C.C=S,C.RC=I;break;case"t":C.C=P,C.RC=F;break;default:C.C=x,C.RC=_}return C}n.a=t},function(e,n,t){"use strict";function l(g){return(l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(g)}function o(g){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(v){return v.__proto__||Object.getPrototypeOf(v)})(g)}function a(g,v){return(a=Object.setPrototypeOf||function(x,_){return x.__proto__=_,x})(g,v)}(function(g,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(v&&v.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),v&&a(g,v)})(s,t(4).a),function(g,v){for(var x=0;x<v.length;x++){var _=v[x];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(g,_.key,_)}}(s.prototype,[{key:"process",value:function(){for(;this.state.message.length>=this.blockSizeInBytes;){this.blockUnits=new Array(this.blockSizeInBytes);for(var g=0;g<this.blockSizeInBytes;g++)this.blockUnits[g]=0|this.state.message.charCodeAt(g);this.state.message=this.state.message.substr(this.blockSizeInBytes),this.processBlock(this.blockUnits)}}},{key:"processBlock",value:function(g){}},{key:"getStateHash",value:function(g){g=g||this.state.hash.length;for(var v="",x=0;x<g;x++)v+=String.fromCharCode(255&this.state.hash[x]);return v}}]),t=s;function s(g){var v;return function(x){if(!(x instanceof s))throw new TypeError("Cannot call a class as a function")}(this),v=this,(g=!(g=o(s).call(this,g))||l(g)!=="object"&&typeof g!="function"?function(){if(v!==void 0)return v;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():g).unitSize=1,g.blockSizeInBytes=g.blockSize*g.unitSize,g.blockUnits=[],g}function u(g){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(g)}function f(g,v,x){return(f=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(_,S,I){if(_=function(P,F){for(;!Object.prototype.hasOwnProperty.call(P,F)&&(P=m(P))!==null;);return P}(_,S),_)return S=Object.getOwnPropertyDescriptor(_,S),S.get?S.get.call(I):S.value})(g,v,x||g)}function m(g){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(v){return v.__proto__||Object.getPrototypeOf(v)})(g)}function d(g,v){return(d=Object.setPrototypeOf||function(x,_){return x.__proto__=_,x})(g,v)}var p=[41,46,67,201,162,216,124,1,61,54,84,161,236,240,6,19,98,167,5,243,192,199,115,140,152,147,43,217,188,76,130,202,30,155,87,60,253,212,224,22,103,66,111,24,138,23,229,18,190,78,196,214,218,158,222,73,160,251,245,142,187,47,238,122,169,104,121,145,21,178,7,63,148,194,16,137,11,34,95,33,128,127,93,154,90,144,50,39,53,62,204,231,191,247,151,3,255,25,48,179,72,165,181,209,215,94,146,42,172,86,170,198,79,184,56,210,150,164,125,182,118,252,107,226,156,116,4,241,69,157,112,89,100,113,135,32,134,91,207,101,230,45,168,2,27,96,37,173,174,176,185,246,28,70,97,105,52,64,126,15,85,71,163,35,221,81,175,58,195,92,249,206,186,197,234,38,44,83,13,110,133,40,132,9,211,223,205,244,65,129,77,82,106,220,55,200,108,193,171,250,36,225,123,8,12,189,177,74,120,136,149,139,227,99,232,109,233,203,213,254,59,0,29,57,242,239,183,14,102,88,208,228,166,119,114,248,235,117,75,10,49,68,80,180,143,237,31,26,219,153,141,51,159,17,131,20],t=(function(g,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(v.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),d(g,v)}(b,t),function(g,v){for(var x=0;x<v.length;x++){var _=v[x];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(g,_.key,_)}}(b.prototype,[{key:"reset",value:function(){f(m(b.prototype),"reset",this).call(this),this.state.hash=new Array(48),this.state.checksum=new Array(16)}},{key:"processBlock",value:function(g){for(var v=0;v<16;v++)this.state.hash[16+v]=0|g[v],this.state.hash[32+v]=g[v]^this.state.hash[v];for(var x=0,_=0;_<this.options.rounds;_++){for(var S=0;S<48;S++)x=this.state.hash[S]^=p[x];x=x+_&255}x=255&this.state.checksum[15];for(var I=0;I<16;I++)x=this.state.checksum[I]^=p[g[I]^x]}},{key:"finalize",value:function(){this.addPaddingPKCS7(16-(15&this.state.message.length)|0),this.process();for(var g=0;g<16;g++)this.state.message+=String.fromCharCode(this.state.checksum[g]);return this.process(),this.getStateHash(16)}}]),b);function b(g){var v;return function(x){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}(this),v=this,(g=!(g=m(b).call(this,g))||u(g)!=="object"&&typeof g!="function"?function(){if(v!==void 0)return v;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():g).options.rounds=g.options.rounds||18,g}n.a=t},function(e,n,t){"use strict";var l=t(5),o=t(0);function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(v)}function s(v,x,_){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(S,I,P){if(S=function(F,D){for(;!Object.prototype.hasOwnProperty.call(F,D)&&(F=u(F))!==null;);return F}(S,I),S)return I=Object.getOwnPropertyDescriptor(S,I),I.get?I.get.call(P):I.value})(v,x,_||v)}function u(v){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(v)}function f(v,x){return(f=Object.setPrototypeOf||function(_,S){return _.__proto__=S,_})(v,x)}var m=[0,1518500249,1859775393,2400959708],d=[5,11,7,15,6,13,8,14,7,12,9,11,8,15,6,12,9,14,5,13],p=[10,17,25,30],b=[18,0,1,2,3,19,4,5,6,7,16,8,9,10,11,17,12,13,14,15,22,3,6,9,12,23,15,2,5,8,20,11,14,1,4,21,7,10,13,0,26,12,5,14,7,27,0,9,2,11,24,4,13,6,15,25,8,1,10,3,30,7,2,13,8,31,3,14,9,4,28,15,10,5,0,29,11,6,1,12],l=(function(v,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(x&&x.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),x&&f(v,x)}(g,l.a),function(v,x){for(var _=0;_<x.length;_++){var S=x[_];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(v,S.key,S)}}(g.prototype,[{key:"reset",value:function(){s(u(g.prototype),"reset",this).call(this),this.state.hash=[1732584193,4023233417,2562383102,271733878,3285377520]}},{key:"processBlock",value:function(v){for(var x=0|this.state.hash[0],_=0|this.state.hash[1],S=0|this.state.hash[2],I=0|this.state.hash[3],P=0|this.state.hash[4],F=0;F<16;F++)this.W[F]=0|v[F];this.W[16]=this.W[0]^this.W[1]^this.W[2]^this.W[3]|0,this.W[17]=this.W[4]^this.W[5]^this.W[6]^this.W[7]|0,this.W[18]=this.W[8]^this.W[9]^this.W[10]^this.W[11]|0,this.W[19]=this.W[12]^this.W[13]^this.W[14]^this.W[15]|0,this.W[20]=this.W[3]^this.W[6]^this.W[9]^this.W[12]|0,this.W[21]=this.W[2]^this.W[5]^this.W[8]^this.W[15]|0,this.W[22]=this.W[1]^this.W[4]^this.W[11]^this.W[14]|0,this.W[23]=this.W[0]^this.W[7]^this.W[10]^this.W[13]|0,this.W[24]=this.W[5]^this.W[7]^this.W[12]^this.W[14]|0,this.W[25]=this.W[0]^this.W[2]^this.W[9]^this.W[11]|0,this.W[26]=this.W[4]^this.W[6]^this.W[13]^this.W[15]|0,this.W[27]=this.W[1]^this.W[3]^this.W[8]^this.W[10]|0,this.W[28]=this.W[2]^this.W[7]^this.W[8]^this.W[13]|0,this.W[29]=this.W[3]^this.W[4]^this.W[9]^this.W[14]|0,this.W[30]=this.W[0]^this.W[5]^this.W[10]^this.W[15]|0,this.W[31]=this.W[1]^this.W[6]^this.W[11]^this.W[12]|0;for(var D=0;D<this.options.rounds;D++)var k=Object(o.a)(x,d[D%20])+P+this.W[b[D]]+m[D/20>>0]|0,k=D<20?k+(_&S|~_&I)|0:!(D<40)&&D<60?k+(S^(_|~I))|0:k+(_^S^I)|0,P=I,I=S,S=0|Object(o.a)(_,p[D/20>>0]),_=x,x=k;this.state.hash[0]=this.state.hash[0]+x|0,this.state.hash[1]=this.state.hash[1]+_|0,this.state.hash[2]=this.state.hash[2]+S|0,this.state.hash[3]=this.state.hash[3]+I|0,this.state.hash[4]=this.state.hash[4]+P|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),g);function g(v){var x;return function(_){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}(this),x=this,(v=!(v=u(g).call(this,v))||a(v)!=="object"&&typeof v!="function"?function(){if(x!==void 0)return x;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():v).options.rounds=v.options.rounds||80,v.W=new Array(32),v}n.a=l},function(e,n,t){"use strict";t.d(n,"a",function(){return o});var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function o(a){for(var s="",u=a.length-a.length%3|0,f=0,m=0;m<u;m+=3)f=a.charCodeAt(m)<<16|a.charCodeAt(m+1)<<8|a.charCodeAt(m+2),s+=l.charAt(f>>18)+l.charAt(f>>12&63)+l.charAt(f>>6&63)+l.charAt(63&f);return a.length-u==2?(f=a.charCodeAt(u)<<16|a.charCodeAt(1+u)<<8,s+=l.charAt(f>>18)+l.charAt(f>>12&63)+l.charAt(f>>6&63)+"="):a.length-u==1&&(f=a.charCodeAt(u)<<16,s+=l.charAt(f>>18)+l.charAt(f>>12&63)+"=="),s}},function(e,n,t){"use strict";var l=t(5),o=t(0);function a(v){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x})(v)}function s(v,x){for(var _=0;_<x.length;_++){var S=x[_];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(v,S.key,S)}}function u(v,x,_){return(u=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(S,I,P){if(S=function(F,D){for(;!Object.prototype.hasOwnProperty.call(F,D)&&(F=f(F))!==null;);return F}(S,I),S)return I=Object.getOwnPropertyDescriptor(S,I),I.get?I.get.call(P):I.value})(v,x,_||v)}function f(v){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(x){return x.__proto__||Object.getPrototypeOf(x)})(v)}function m(v,x){return(m=Object.setPrototypeOf||function(_,S){return _.__proto__=S,_})(v,x)}var d=[[3,7,11,19],[3,5,9,13],[3,9,11,15]],p=1518500249,b=1859775393,t=(function(v,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");v.prototype=Object.create(x&&x.prototype,{constructor:{value:v,writable:!0,configurable:!0}}),x&&m(v,x)}(g,l.a),t=[{key:"FF",value:function(v,x,_){return v&x|~v&_}},{key:"GG",value:function(v,x,_){return v&x|v&_|x&_}},{key:"HH",value:function(v,x,_){return v^x^_}},{key:"CC",value:function(v,x,_,S,I,P,F,D){return 0|Object(o.a)(_+v(S,I,P)+F+x,D)}}],s((l=g).prototype,[{key:"reset",value:function(){u(f(g.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878]}},{key:"processBlock",value:function(v){var x=0|this.state.hash[0],_=0|this.state.hash[1],S=0|this.state.hash[2],I=0|this.state.hash[3],x=g.CC(g.FF,0,x,_,S,I,v[0],d[0][0]),I=g.CC(g.FF,0,I,x,_,S,v[1],d[0][1]),S=g.CC(g.FF,0,S,I,x,_,v[2],d[0][2]),_=g.CC(g.FF,0,_,S,I,x,v[3],d[0][3]);x=g.CC(g.FF,0,x,_,S,I,v[4],d[0][0]),I=g.CC(g.FF,0,I,x,_,S,v[5],d[0][1]),S=g.CC(g.FF,0,S,I,x,_,v[6],d[0][2]),_=g.CC(g.FF,0,_,S,I,x,v[7],d[0][3]),x=g.CC(g.FF,0,x,_,S,I,v[8],d[0][0]),I=g.CC(g.FF,0,I,x,_,S,v[9],d[0][1]),S=g.CC(g.FF,0,S,I,x,_,v[10],d[0][2]),_=g.CC(g.FF,0,_,S,I,x,v[11],d[0][3]),x=g.CC(g.FF,0,x,_,S,I,v[12],d[0][0]),I=g.CC(g.FF,0,I,x,_,S,v[13],d[0][1]),S=g.CC(g.FF,0,S,I,x,_,v[14],d[0][2]),_=g.CC(g.FF,0,_,S,I,x,v[15],d[0][3]),x=g.CC(g.GG,p,x,_,S,I,v[0],d[1][0]),I=g.CC(g.GG,p,I,x,_,S,v[4],d[1][1]),S=g.CC(g.GG,p,S,I,x,_,v[8],d[1][2]),_=g.CC(g.GG,p,_,S,I,x,v[12],d[1][3]),x=g.CC(g.GG,p,x,_,S,I,v[1],d[1][0]),I=g.CC(g.GG,p,I,x,_,S,v[5],d[1][1]),S=g.CC(g.GG,p,S,I,x,_,v[9],d[1][2]),_=g.CC(g.GG,p,_,S,I,x,v[13],d[1][3]),x=g.CC(g.GG,p,x,_,S,I,v[2],d[1][0]),I=g.CC(g.GG,p,I,x,_,S,v[6],d[1][1]),S=g.CC(g.GG,p,S,I,x,_,v[10],d[1][2]),_=g.CC(g.GG,p,_,S,I,x,v[14],d[1][3]),x=g.CC(g.GG,p,x,_,S,I,v[3],d[1][0]),I=g.CC(g.GG,p,I,x,_,S,v[7],d[1][1]),S=g.CC(g.GG,p,S,I,x,_,v[11],d[1][2]),_=g.CC(g.GG,p,_,S,I,x,v[15],d[1][3]),x=g.CC(g.HH,b,x,_,S,I,v[0],d[2][0]),I=g.CC(g.HH,b,I,x,_,S,v[8],d[2][1]),S=g.CC(g.HH,b,S,I,x,_,v[4],d[2][2]),_=g.CC(g.HH,b,_,S,I,x,v[12],d[2][3]),x=g.CC(g.HH,b,x,_,S,I,v[2],d[2][0]),I=g.CC(g.HH,b,I,x,_,S,v[10],d[2][1]),S=g.CC(g.HH,b,S,I,x,_,v[6],d[2][2]),_=g.CC(g.HH,b,_,S,I,x,v[14],d[2][3]),x=g.CC(g.HH,b,x,_,S,I,v[1],d[2][0]),I=g.CC(g.HH,b,I,x,_,S,v[9],d[2][1]),S=g.CC(g.HH,b,S,I,x,_,v[5],d[2][2]),_=g.CC(g.HH,b,_,S,I,x,v[13],d[2][3]),x=g.CC(g.HH,b,x,_,S,I,v[3],d[2][0]),I=g.CC(g.HH,b,I,x,_,S,v[11],d[2][1]),S=g.CC(g.HH,b,S,I,x,_,v[7],d[2][2]),_=g.CC(g.HH,b,_,S,I,x,v[15],d[2][3]),this.state.hash=[this.state.hash[0]+x|0,this.state.hash[1]+_|0,this.state.hash[2]+S|0,this.state.hash[3]+I|0]}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),s(l,t),g);function g(){return function(_){if(!(_ instanceof g))throw new TypeError("Cannot call a class as a function")}(this),v=this,!(x=f(g).apply(this,arguments))||a(x)!=="object"&&typeof x!="function"?function(){if(v!==void 0)return v;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():x;var v,x}n.a=t},function(e,n,t){"use strict";var l=t(3),o=t(0);function a(p){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b})(p)}function s(p,b,g){return(s=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(v,x,_){if(v=function(S,I){for(;!Object.prototype.hasOwnProperty.call(S,I)&&(S=u(S))!==null;);return S}(v,x),v)return x=Object.getOwnPropertyDescriptor(v,x),x.get?x.get.call(_):x.value})(p,b,g||p)}function u(p){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(b){return b.__proto__||Object.getPrototypeOf(b)})(p)}function f(p,b){return(f=Object.setPrototypeOf||function(g,v){return g.__proto__=v,g})(p,b)}var m=[1518500249,1859775393,2400959708,3395469782],l=(function(p,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(b&&b.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),b&&f(p,b)}(d,l.a),function(p,b){for(var g=0;g<b.length;g++){var v=b[g];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(p,v.key,v)}}(d.prototype,[{key:"reset",value:function(){s(u(d.prototype),"reset",this).call(this),this.state.hash=[1732584193,-271733879,-1732584194,271733878,-1009589776]}},{key:"processBlock",value:function(p){for(var b=0|this.state.hash[0],g=0|this.state.hash[1],v=0|this.state.hash[2],x=0|this.state.hash[3],_=0|this.state.hash[4],S=0;S<this.options.rounds;S++){this.W[S]=S<16?0|p[S]:this.W[S-3]^this.W[S-8]^this.W[S-14]^this.W[S-16]|0;var I=Object(o.a)(b,5)+_+this.W[S]+m[S/20>>0]|0,I=S<20?I+(g&v|~g&x)|0:!(S<40)&&S<60?I+(g&v|g&x|v&x)|0:I+(g^v^x)|0,_=x,x=v,v=0|Object(o.a)(g,30),g=b,b=I}this.state.hash[0]=this.state.hash[0]+b|0,this.state.hash[1]=this.state.hash[1]+g|0,this.state.hash[2]=this.state.hash[2]+v|0,this.state.hash[3]=this.state.hash[3]+x|0,this.state.hash[4]=this.state.hash[4]+_|0}},{key:"finalize",value:function(){return this.addPaddingISO7816(this.state.message.length<56?56-this.state.message.length|0:120-this.state.message.length|0),this.addLengthBits(),this.process(),this.getStateHash()}}]),d);function d(p){var b;return function(g){if(!(g instanceof d))throw new TypeError("Cannot call a class as a function")}(this),b=this,(p=!(p=u(d).call(this,p))||a(p)!=="object"&&typeof p!="function"?function(){if(b!==void 0)return b;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}():p).options.rounds=p.options.rounds||80,p.W=new Array(80),p}n.a=l},function(e,n,t){"use strict";function l(o){for(var a="",s=new Uint8Array(o),u=0;u<s.length;u++)a+=String.fromCharCode(s[u]);return a}t.d(n,"a",function(){return l})},,function(e,n,t){"use strict";var l=(function(a,s){for(var u=0;u<s.length;u++){var f=s[u];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(a,f.key,f)}}(o.prototype,[{key:"update",value:function(a){this.hasher.update(a)}},{key:"finalize",value:function(){var a=this.hasher.finalize();return this.hasher.reset(),this.hasher.update(this.oPad),this.hasher.update(a),this.hasher.finalize()}}]),o);function o(a,s){(function(m){if(!(m instanceof o))throw new TypeError("Cannot call a class as a function")})(this),a.length>s.blockSizeInBytes&&(s.update(a),a=s.finalize(),s.reset());for(var u=a.length;u<s.blockSizeInBytes;u++)a+="\0";this.oPad="";for(var f=0;f<a.length;f++)s.update(String.fromCharCode(54^a.charCodeAt(f))),this.oPad+=String.fromCharCode(92^a.charCodeAt(f));this.hasher=s}n.a=l},,,,,,,,,function(e,n,t){"use strict";t.r(n);var l=t(14),o=t(13),a=t(16),s=t(10),u=t(8),f=t(17),m=t(11),d=t(7),p=t(6),b=t(9),g=t(12),v=t(1),x=t(18),_=t(2),S=t(15),I=t(20);(function(F,D){for(var k=0;k<D.length;k++){var w=D[k];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(F,w.key,w)}})(P.prototype,[{key:"getHasher",value:function(F,D){switch(D=D||{},F){case"has160":return new l.a(D);case"md2":return new o.a(D);case"md4":return new a.a(D);case"md5":return new s.a(D);case"ripemd128":return D=Object.assign({},{length:128},D),new u.a(D);case"ripemd":case"ripemd160":return D=Object.assign({},{length:160},D),new u.a(D);case"ripemd256":return D=Object.assign({},{length:256},D),new u.a(D);case"ripemd320":return D=Object.assign({},{length:320},D),new u.a(D);case"sha0":return new f.a(D);case"sha1":return new m.a(D);case"sha224":return D=Object.assign({},{length:224},D),new d.a(D);case"sha256":return D=Object.assign({},{length:256},D),new d.a(D);case"sha384":return D=Object.assign({},{length:384},D),new p.a(D);case"sha512":return D=Object.assign({},{length:512},D),new p.a(D);case"sha512/224":return D=Object.assign({},{length:224},D),new p.a(D);case"sha512/256":return D=Object.assign({},{length:256},D),new p.a(D);case"snefru":case"snefru128":case"snefru128/8":return D=Object.assign({},{length:128},D),new b.a(D);case"snefru256":case"snefru256/8":return D=Object.assign({},{length:256},D),new b.a(D);case"snefru128/2":return D=Object.assign({},{length:128,rounds:2},D),new b.a(D);case"snefru256/4":return D=Object.assign({},{length:256,rounds:4},D),new b.a(D);case"whirlpool":return new g.a(D);case"whirlpool-0":return D=Object.assign({},{type:"0"},D),new g.a(D);case"whirlpool-t":return D=Object.assign({},{type:"t"},D),new g.a(D)}}},{key:"hash",value:function(F,D,k){return k=k||{},k=this.getHasher(F,k),k.update(Object(v.a)(D)),Object(_.a)(k.finalize())}},{key:"getHmac",value:function(F,D){return new I.a(F,D)}},{key:"hmac",value:function(F,D,k){return k=this.getHmac(Object(v.a)(F),k),k.update(Object(v.a)(D)),Object(_.a)(k.finalize())}}]),t=P;function P(){(function(F){if(!(F instanceof P))throw new TypeError("Cannot call a class as a function")})(this),this.encoder={},this.encoder.fromUtf=v.a,this.encoder.fromArrayBuffer=x.a,this.encoder.toHex=_.a,this.encoder.toBase64=S.a}t=new t,n.default=t}]).default;(function(e){"use strict";var n={page:1,pageSize:200,total:0,showTotal:!1,totalTxt:"",noData:!1,showSkip:!1,showPN:!0,prevPage:"\u4E0A\u4E00\u9875",nextPage:"\u4E0B\u4E00\u9875",fastForward:0,selectOption:[],backFun:function(l){}};function t(l,o){this.element=e(l),this.settings=e.extend({},n,o),this.pageNum=1,this.pageList=[],this.pageTatol=0,this.init()}e.extend(t.prototype,{init:function(){this.element.empty(),this.viewHtml(),this.clickBtn()},creatHtml:function(l){l==this.settings.page?this.pageList.push('<button class="active" data-page='+l+">"+l+"</button>"):this.pageList.push("<button data-page="+l+">"+l+"</button>")},viewHtml:function(){var l=this.settings,o=0,a=[];if(0<l.total)o=Math.ceil(l.total/l.pageSize);else{if(!l.noData)return;o=1,l.page=1,l.total=0}if(this.pageTatol=o,this.pageNum=l.page,l.showTotal&&a.push('<div class="spage-total">'+l.totalTxt+"</div>"),a.push('<div class="spage-number">'),this.pageList=[],l.showPN&&(l.page==1?this.pageList.push('<button class="button-disabled" data-page="prev"><i class="prevBtn"></i></button>'):this.pageList.push('<button data-page="prev"><i class="prevBtn"></i></button>')),o<=6)for(var s=1;s<o+1;s++)this.creatHtml(s);else if(l.page<3){for(s=1;s<=3;s++)this.creatHtml(s);this.pageList.push('<button data-page="after" class="spage-after">...</button><button data-page='+o+">"+o+"</button>")}else if(l.page>o-3)for(this.pageList.push('<button data-page="1">1</button><button data-page="before" class="spage-before">...</button>'),s=o-3;s<=o;s++)this.creatHtml(s);else{for(this.pageList.push('<button data-page="1">1</button>'),3<l.page&&this.pageList.push('<button data-page="before" class="spage-before">...</button>'),s=l.page-1;s<=Number(l.page)+1;s++)this.creatHtml(s);l.page<=o-3&&this.pageList.push('<button data-page="after" class="spage-after">...</button>'),this.pageList.push("<button data-page="+o+">"+o+"</button>")}if(l.showPN&&(l.page==o?this.pageList.push('<button class="button-disabled" data-page="next"><i class="nextBtn"></i></button>'):this.pageList.push('<button data-page="next"><i class="nextBtn"></i></button>')),a.push(this.pageList.join("")),a.push("</div>"),0<l.selectOption.length){for(var u='<select class="selectNum" id="selectNum">',f=0;f<=l.selectOption.length-1;f++)u+="<option value="+l.selectOption[f]+" ",l.pageSize===l.selectOption[f]?u+="selected>"+l.selectOption[f]+"\u884C/\u9875</option>":u+=">"+l.selectOption[f]+"\u884C/\u9875</option>";u+="</select>",a.push(u)}l.showSkip&&a.push('<div class="spage-skip">\u8DF3\u81F3&nbsp;<input type="text" class="luckysheet-mousedown-cancel" value="'+l.page+'"/>&nbsp;\u9875&nbsp;&nbsp;</div>'),this.element.html(a.join(""))},clickBtn:function(){var l=this,o=this.settings,a=this.element,s=this.pageTatol;this.element.on("change","select",function(u){var f=parseInt(document.getElementById("selectNum").value);o.pageSize=f,o.page=1,l.element.empty(),l.viewHtml(),o.backFun(o)}),this.element.off("click","button"),this.element.on("click","button",function(){var u=e(this).data("page");switch(u){case"prev":o.page=1<=o.page-1?o.page-1:1,u=o.page;break;case"next":o.page=Number(o.page)+1<=s?Number(o.page)+1:s,u=o.page;break;case"before":o.page=1<=o.page-o.fastForward?o.page-o.fastForward:1,u=o.page;break;case"after":o.page=Number(o.page)+Number(o.fastForward)<=s?Number(o.page)+Number(o.fastForward):s,u=o.page;break;case"go":var f=parseInt(a.find("input").val());if(!(/^[0-9]*$/.test(f)&&1<=f&&f<=s))return;u=o.page=f;break;default:o.page=u}u!=l.pageNum&&(l.pageNum=o.page,l.viewHtml(),o.backFun(o))}),this.element.off("keyup","input"),this.element.on("keyup","input",function(u){u.keyCode==13&&(u=parseInt(a.find("input").val()),/^[0-9]*$/.test(u)&&1<=u&&u<=s&&u!=l.pageNum&&(o.page=u,l.pageNum=u,l.viewHtml(),o.backFun(o)))}),0<o.fastForward&&(a.find(".spage-after").hover(function(){e(this).html("&raquo;")},function(){e(this).html("...")}),a.find(".spage-before").hover(function(){e(this).html("&laquo;")},function(){e(this).html("...")}))}}),e.fn.sPage=function(l){return this.each(function(){new t(this,l)})}})(jQuery,document)});var import_plugin,ww,ut,Vn=Nt(()=>{import_plugin=qe(Ye()),ww={autoFormatw:!1,accuracy:void 0,total:0,allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,userInfo:!1,userMenuItem:[],myFolderUrl:null,functionButton:null,showConfigWindowResize:!0,enableAddRow:!0,addRowCount:100,enableAddBackTop:!0,enablePage:!0,pageInfo:null,editMode:!1,beforeCreateDom:null,workbookCreateBefore:null,workbookCreateAfter:null,remoteFunction:null,fireMousedown:null,plugins:[],forceCalculation:!1,defaultColWidth:73,defaultRowHeight:19,defaultTextColor:"#000",defaultCellColor:"#fff"},ut=ww});var import_plugin,xw,h,il=Nt(()=>{import_plugin=qe(Ye()),xw={container:null,loadingObj:{},luckysheetfile:null,defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:!0,devicePixelRatio:1,currentSheetIndex:0,calculateSheetIndex:0,flowdata:[],config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:0,infobarHeight:0,calculatebarHeight:0,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,jfcountfuncTimeout:null,jfautoscrollTimeout:null,luckysheet_select_status:!1,luckysheet_select_save:[{row:[0,0],column:[0,0]}],luckysheet_selection_range:[],luckysheet_copy_save:{},luckysheet_paste_iscut:!1,filterchage:!0,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:!1,luckysheet_sheet_move_data:[],luckysheet_scroll_status:!1,luckysheetisrefreshdetail:!0,luckysheetisrefreshtheme:!0,luckysheetcurrentisPivotTable:!1,luckysheet_rows_selected_status:!1,luckysheet_cols_selected_status:!1,luckysheet_rows_change_size:!1,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:!1,luckysheet_cols_change_size_start:[],luckysheet_cols_dbclick_timeout:null,luckysheet_cols_dbclick_times:0,luckysheetCellUpdate:[],luckysheet_shiftpositon:null,iscopyself:!0,orderbyindex:0,luckysheet_model_move_state:!1,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:!1,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:!1,luckysheet_cell_selected_extend_index:[],luckysheet_cell_selected_extend_time:null,clearjfundo:!0,jfundo:[],jfredo:[],lang:"en",createChart:"",highlightChart:"",zIndex:15,chartparam:{luckysheetCurrentChart:null,luckysheetCurrentChartActive:!1,luckysheetCurrentChartMove:null,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:null,luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetCurrentChartResize:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheetInsertChartTosheetChange:!0,luckysheetCurrentChartZIndexRank:100,luckysheet_chart_redo_click:!1,luckysheetCurrentChartMaxState:!1,jfrefreshchartall:"",changeChartCellData:"",renderChart:"",getChartJson:""},functionList:null,luckysheet_function:null,chart_selection:{},currentChart:"",scrollRefreshSwitch:!0,measureTextCache:{},measureTextCellInfoCache:{},measureTextCacheTimeOut:null,cellOverflowMapCache:{},zoomRatio:1,visibledatacolumn_unique:null,visibledatarow_unique:null,showGridLines:!0,toobarObject:{},inlineStringEditCache:null,inlineStringEditRange:null,fontList:[],defaultFontSize:10,currentSheetView:"viewNormal",cooperativeEdit:{usernameTimeout:{},changeCollaborationSize:[],allDataColumnlen:[],merge_range:{},checkoutData:[]},asyncLoad:["core"],defaultCell:{bg:null,bl:0,ct:{fa:"General",t:"n"},fc:"rgb(51, 51, 51)",ff:0,fs:11,ht:1,it:0,vt:1,m:"",v:""}},h=xw});function ft(e){return e==null||e.toString().replace(/\s/g,"")==""}function K(e){return!(e==null||e.toString().replace(/\s/g,"")===""||typeof e=="boolean"||isNaN(e))}function re(e){let n=!1;for(let t in Et)if(e==Et[t]){n=!0;break}return n}function ds(e){return!!/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.exec(e)}function at(){return!!ut.editMode}function yi(){return!!h.allowEdit}function sr(e,n,t,l,o){let a=!1;for(let s in h.config.merge){let u=e.merge[s];if(n<u.r){if(t>=u.r&&t<u.r+u.rs-1){if(l>=u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<=u.c+u.cs-1){a=!0;break}else if(l<u.c&&o>u.c+u.cs-1){a=!0;break}}else if(t>=u.r&&t==u.r+u.rs-1){if(l>u.c&&l<u.c+u.cs-1){a=!0;break}else if(o>u.c&&o<u.c+u.cs-1){a=!0;break}else if(l==u.c&&o<u.c+u.cs-1){a=!0;break}else if(l>u.c&&o==u.c+u.cs-1){a=!0;break}}else if(t>u.r+u.rs-1){if(l>u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<u.c+u.cs-1){a=!0;break}else if(l==u.c&&o<u.c+u.cs-1){a=!0;break}else if(l>u.c&&o==u.c+u.cs-1){a=!0;break}}}else if(n==u.r){if(t<u.r+u.rs-1){if(l>=u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<=u.c+u.cs-1){a=!0;break}else if(l<u.c&&o>u.c+u.cs-1){a=!0;break}}else if(t>=u.r+u.rs-1){if(l>u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<u.c+u.cs-1){a=!0;break}else if(l==u.c&&o<u.c+u.cs-1){a=!0;break}else if(l>u.c&&o==u.c+u.cs-1){a=!0;break}}}else if(n<=u.r+u.rs-1){if(l>=u.c&&l<=u.c+u.cs-1){a=!0;break}else if(o>=u.c&&o<=u.c+u.cs-1){a=!0;break}else if(l<u.c&&o>u.c+u.cs-1){a=!0;break}}}return a}function Vd(e){return Math.ceil(e.charCodeAt().toString(2).length/8)}var import_plugin,Et,cr=Nt(()=>{import_plugin=qe(Ye());Vn();il();Et={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"}});function _w(e){return Math.floor(e)===e}function r0(e){var n={times:1,num:0};if(_w(e))return n.num=e,n;var t=e+"",l=t.indexOf("."),o=t.substr(l+1).length,a=Math.pow(10,o),s=parseInt(e*a+.5,10);return n.times=a,n.num=s,n}function zu(e,n,t){var l=r0(e),o=r0(n),a=l.num,s=o.num,u=l.times,f=o.times,m=u>f?u:f,d=null;switch(t){case"add":return u===f?d=a+s:u>f?d=a+s*(u/f):d=a*(f/u)+s,d/m;case"subtract":return u===f?d=a-s:u>f?d=a-s*(u/f):d=a*(f/u)-s,d/m;case"multiply":return d=a*s/(u*f),d;case"divide":return d=function(){var p=a/s,b=f/u;return zu(p,b,"multiply")}()}}function Cw(e,n){if(n||(n=2),!K(e))return e;let t=e.toFixed(n),l=t.indexOf("."),o=t.substring(0,l),a=t.substring(l+1,t.length);if(a)for(let s=a.length-1;s!=0&&!(a.charAt(s)!="0"&&s==a.length-1);s--)a=a.substring(0,s);return Number(o+"."+a)}var import_plugin,n0=Nt(()=>{import_plugin=qe(Ye());cr();Number.prototype.add=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return zu(this,n,"add")};Number.prototype.subtract=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return zu(this,n,"subtract")};Number.prototype.multiply=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return zu(this,n,"multiply")};Number.prototype.divide=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return zu(this,n,"divide")};Number.prototype.tofixed=function(e){let n=parseFloat(e);if(typeof n!="number"||Number.isNaN(n))throw new Error("\u8BF7\u8F93\u5165\u6570\u5B57\u6216\u8005\u6570\u5B57\u5B57\u7B26\u4E32\uFF5E");return Cw(this,n)}});var import_plugin,i0,o0=Nt(()=>{import_plugin=qe(Ye()),i0={container:"luckysheet",loading:{},column:60,row:84,allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,data:[{name:"Sheet1",color:"",status:"1",order:"0",data:[],config:{},index:0},{name:"Sheet2",color:"",status:"0",order:"1",data:[],config:{},index:1},{name:"Sheet3",color:"",status:"0",order:"2",data:[],config:{},index:2}],title:"Luckysheet Demo",userInfo:!1,userMenuItem:[],myFolderUrl:"https://github.com/luncheon/luckysheet-nightly",config:{},fullscreenmode:!0,devicePixelRatio:window.devicePixelRatio,allowEdit:!0,loadUrl:"",loadSheetUrl:"",gridKey:"",updateUrl:"",updateImageUrl:"",allowUpdate:!1,functionButton:"",showConfigWindowResize:!0,enableAddRow:!0,enableAddBackTop:!0,autoFormatw:!1,accuracy:void 0,pageInfo:{queryExps:"",reportId:"",fields:"",mobile:"",frezon:"",currentPage:"",totalPage:10,pageUrl:""},editMode:!1,beforeCreateDom:null,fireMousedown:null,lang:"en",plugins:[],forceCalculation:!1,rowHeaderWidth:46,columnHeaderHeight:20,defaultColWidth:73,defaultRowHeight:19,defaultFontSize:10,limitSheetNameLength:!0,defaultSheetNameMaxLength:31,sheetFormulaBar:!0,showtoolbarConfig:{},showsheetbarConfig:{},showstatisticBarConfig:{},cellRightClickConfig:{},sheetRightClickConfig:{},imageUpdateMethodConfig:{}}});var import_plugin,Wd,Be,Xl=Nt(()=>{import_plugin=qe(Ye());il();Wd={},Be=()=>Wd[h.lang]});function a0(){let e=Be().toolbar,n=Be().fontarray,t=Be().defaultFmt,l={undo:`<div class="luckysheet-toolbar-button luckysheet-inline-block disabled" data-tips="${e.undo}"
        id="luckysheet-icon-undo" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-undo iconfont luckysheet-iconfont-qianjin"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,redo:`<div class="luckysheet-toolbar-button luckysheet-inline-block disabled" data-tips="${e.redo}"
        id="luckysheet-icon-redo" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-redo iconfont luckysheet-iconfont-houtui"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,paintFormat:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.paintFormat}"
        id="luckysheet-icon-paintformat" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-geshishua"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,currencyFormat:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.currencyFormat}"
        id="luckysheet-icon-currency" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-jine"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,percentageFormat:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.percentageFormat}"
        id="luckysheet-icon-percent" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img iconfont luckysheet-iconfont-baifenhao"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,numberDecrease:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.numberDecrease}"
        id="luckysheet-icon-fmt-decimal-decrease" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block toolbar-decimal-icon"
                    style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-decimal-decrease iconfont luckysheet-iconfont-jianxiaoxiaoshuwei"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,numberIncrease:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.numberIncrease}"
        id="luckysheet-icon-fmt-decimal-increase" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block toolbar-decimal-icon"
                    style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-decimal-increase iconfont luckysheet-iconfont-zengjiaxiaoshuwei"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,moreFormats:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.moreFormats}"
        id="luckysheet-icon-fmt-other" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${t[0].text}
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,font:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.font}" id="luckysheet-icon-font-family" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${n[0]}
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,fontSize:`<div class="luckysheet-toolbar-select luckysheet-toolbar-zoom-combobox luckysheet-toolbar-combo-button luckysheet-inline-block"
        data-tips="${e.fontSize}" id="luckysheet-icon-font-size" style="user-select: none;">
            <div class="luckysheet-toolbar-combo-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-combo-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div aria-posinset="4" aria-setsize="7" class="luckysheet-inline-block luckysheet-toolbar-combo-button-caption"
                    style="user-select: none;">
                        <input aria-label="${e.fontSize}" class="luckysheet-toolbar-combo-button-input luckysheet-toolbar-textinput"
                        role="combobox" style="user-select: none;" tabindex="-1" type="text" value="10"
                        />
                    </div>
                    <div class="luckysheet-toolbar-combo-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,bold:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.bold}"
        id="luckysheet-icon-bold" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-bold iconfont luckysheet-iconfont-jiacu"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,italic:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.italic}"
        id="luckysheet-icon-italic" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-italic iconfont luckysheet-iconfont-wenbenqingxie1"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,strikethrough:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.strikethrough}"
        id="luckysheet-icon-strikethrough" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-strikethrough iconfont luckysheet-iconfont-wenbenshanchuxian"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,underline:`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${e.underline}"
        id="luckysheet-icon-underline" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-underline iconfont luckysheet-iconfont-wenbenxiahuaxian"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>`,textColor:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-text-color"
        data-tips="${e.textColor}" id="luckysheet-icon-text-color" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-color-menu-button-indicator" style="border-bottom-color: rgb(0, 0, 0); user-select: none;">
                            <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                                <div class="text-color-bar" style="background-color:${ut.defaultTextColor}"></div>
                                <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color iconfont luckysheet-iconfont-wenbenyanse"
                                style="user-select: none;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.chooseColor}..." id="luckysheet-icon-text-color-menu" role="button"
        style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,fillColor:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-cell-color"
        data-tips="${e.fillColor}" id="luckysheet-icon-cell-color" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-color-menu-button-indicator" style="border-bottom-color: rgb(255, 255, 255); user-select: none;">
                            <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                                <div class="text-color-bar" style="background-color:${ut.defaultCellColor}"></div>
                                <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color iconfont luckysheet-iconfont-tianchong"
                                style="user-select: none;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.chooseColor}..." id="luckysheet-icon-cell-color-menu" role="button"
        style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,border:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-border-all"
        data-tips="${e.border}" id="luckysheet-icon-border-all" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all iconfont luckysheet-iconfont-quanjiabiankuang"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.borderStyle}..." id="luckysheet-icon-border-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,mergeCell:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-merge-button"
        data-tips="${e.mergeCell}" id="luckysheet-icon-merge-button" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-merge iconfont luckysheet-iconfont-hebing"
                        style="user-select: none;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.chooseMergeType}..." id="luckysheet-icon-merge-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,horizontalAlignMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-align"
        data-tips="${e.horizontalAlign}" id="luckysheet-icon-align" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left iconfont luckysheet-iconfont-wenbenzuoduiqi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.alignment}..." id="luckysheet-icon-align-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,verticalAlignMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-valign"
        data-tips="${e.verticalAlign}" id="luckysheet-icon-valign" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom iconfont luckysheet-iconfont-dibuduiqi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.alignment}..." id="luckysheet-icon-valign-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,textWrapMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-textwrap"
        data-tips="${e.textWrap}" id="luckysheet-icon-textwrap" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-clip iconfont luckysheet-iconfont-jieduan"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.textWrapMode}..." id="luckysheet-icon-textwrap-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,textRotateMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-rotation"
        data-tips="${e.textRotate}" id="luckysheet-icon-rotation" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wuxuanzhuang"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.textRotateMode}..." id="luckysheet-icon-rotation-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,image:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.insertImage}" id="luckysheet-insertImg-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-tupian"
                            style="user-select: none;">
                                <input id="luckysheet-imgUpload" type="file" accept="image/*" style="display:none;"></input>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,link:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.insertLink}" id="luckysheet-insertLink-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-lianjie"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,chart:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.chart}" id="luckysheet-chart-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-tubiao"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,postil:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.postil}"
        id="luckysheet-icon-postil" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon-img-container luckysheet-toolbar-menu-button-caption luckysheet-inline-block iconfont luckysheet-iconfont-zhushi"
                    style="user-select: none;">
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,pivotTable:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.pivotTable}" id="luckysheet-pivot-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-shujutoushi"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,function:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-icon-function"
        data-tips="${e.autoSum}" id="luckysheet-icon-function" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-jisuan"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${e.sum}
                    </div>
                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.moreFunction}..." id="luckysheet-icon-function-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,frozenMode:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block luckysheet-freezen-btn-horizontal"
        data-tips="${e.freezeTopRow}" id="luckysheet-freezen-btn-horizontal" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-dongjie1"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="luckysheet-toolbar-button-split-right luckysheet-toolbar-menu-button luckysheet-inline-block"
        data-tips="${e.moreOptions}..." id="luckysheet-icon-freezen-menu" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,sortAndFilter:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.sortAndFilter}"
        id="luckysheet-icon-autofilter" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-shaixuan"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>`,conditionalFormat:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.conditionalFormat}"
        id="luckysheet-icon-conditionformat" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-geshitiaojian"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;">
                    </div>
                </div>
            </div>
        </div>`,dataVerification:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.dataVerification}" id="luckysheet-dataVerification-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-shujuyanzheng"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,splitColumn:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.splitColumn}" id="luckysheet-splitColumn-btn-title" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wenbenfenge"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,screenshot:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.screenshot}" id="luckysheet-chart-btn-screenshot" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-jieping"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,findAndReplace:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.findAndReplace}"
        id="luckysheet-icon-seachmore" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-sousuo"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>`,protection:`<div class="luckysheet-toolbar-button-split-left luckysheet-toolbar-button luckysheet-inline-block"
        data-tips="${e.protection}" id="luckysheet-icon-protection" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-menu-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                            <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-biaogesuoding"
                            style="user-select: none;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>`,print:`<div class="luckysheet-toolbar-select luckysheet-toolbar-menu-button luckysheet-inline-block" data-tips="${e.print}"
        id="luckysheet-icon-print" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-menu-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">

                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-autofilter iconfont luckysheet-iconfont-dayin"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige"
                    style="user-select: none;margin-left: 0px;margin-right: 4px;">
                    </div>
                </div>
            </div>
        </div>`},o=ut.showtoolbar,a=ut.showtoolbarConfig,s=['<div class="luckysheet-toolbar-left-theme"></div>'];if(G(a)==="array"){if(!o)return"";let f=0;return a.forEach(function(m,d){if(m==="|"){let p=a[d-1];p!=="|"&&s.push(`<div id="toolbar-separator-${ms(p)}" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"></div>`)}else s.push(l[m])}),s.join("")}let u=Vo.reduce(function(f,m){return m!=="|"&&(f[m]=!0),f},{});if(!o)for(let f in u)u[f]=!1;JSON.stringify(a)!=="{}"&&(a.hasOwnProperty("undoRedo")&&(u.undo=u.redo=a.undoRedo),Object.assign(u,a));for(let f=0;f<Vo.length;f++){let m=Vo[f];if(!u[m]&&m!=="|"){Vo[f+1]==="|"&&f++;continue}if(m==="|"){let d=Vo[f-1];d!=="|"&&s.push(`<div id="toolbar-separator-${ms(d)}" class="luckysheet-toolbar-separator luckysheet-inline-block" style="user-select: none;"></div>`)}else s.push(l[m])}return s.join("")}var import_plugin,Vo,qd,Ud=Nt(()=>{import_plugin=qe(Ye());Xl();Vn();Ol();Vo=["undo","redo","paintFormat","|","currencyFormat","percentageFormat","numberDecrease","numberIncrease","moreFormats","|","font","|","fontSize","|","bold","italic","strikethrough","underline","textColor","|","fillColor","border","mergeCell","|","horizontalAlignMode","verticalAlignMode","textWrapMode","textRotateMode","|","image","link","chart","postil","pivotTable","|","function","frozenMode","sortAndFilter","conditionalFormat","dataVerification","splitColumn","screenshot","findAndReplace","protection","print"],qd={undo:"#luckysheet-icon-undo",redo:"#luckysheet-icon-redo",paintFormat:["#luckysheet-icon-paintformat"],currencyFormat:"#luckysheet-icon-currency",percentageFormat:"#luckysheet-icon-percent",numberDecrease:"#luckysheet-icon-fmt-decimal-decrease",numberIncrease:"#luckysheet-icon-fmt-decimal-increase",moreFormats:"#luckysheet-icon-fmt-other",font:"#luckysheet-icon-font-family",fontSize:"#luckysheet-icon-font-size",bold:"#luckysheet-icon-bold",italic:"#luckysheet-icon-italic",strikethrough:"#luckysheet-icon-strikethrough",underline:"#luckysheet-icon-underline",textColor:["#luckysheet-icon-text-color","#luckysheet-icon-text-color-menu"],fillColor:["#luckysheet-icon-cell-color","#luckysheet-icon-cell-color-menu"],border:["#luckysheet-icon-border-all","#luckysheet-icon-border-menu"],mergeCell:["#luckysheet-icon-merge-button","#luckysheet-icon-merge-menu"],horizontalAlignMode:["#luckysheet-icon-align","#luckysheet-icon-align-menu"],verticalAlignMode:["#luckysheet-icon-valign","#luckysheet-icon-valign-menu"],textWrapMode:["#luckysheet-icon-textwrap","#luckysheet-icon-textwrap-menu"],textRotateMode:["#luckysheet-icon-rotation","#luckysheet-icon-rotation-menu"],image:"#luckysheet-insertImg-btn-title",link:"#luckysheet-insertLink-btn-title",chart:"#luckysheet-chart-btn-title",postil:"#luckysheet-icon-postil",pivotTable:["#luckysheet-pivot-btn-title"],function:["#luckysheet-icon-function","#luckysheet-icon-function-menu"],frozenMode:["#luckysheet-freezen-btn-horizontal","#luckysheet-icon-freezen-menu"],sortAndFilter:"#luckysheet-icon-autofilter",conditionalFormat:"#luckysheet-icon-conditionformat",dataVerification:"#luckysheet-dataVerification-btn-title",splitColumn:"#luckysheet-splitColumn-btn-title",screenshot:"#luckysheet-chart-btn-screenshot",findAndReplace:"#luckysheet-icon-seachmore",protection:"#luckysheet-icon-protection",print:"#luckysheet-icon-print"}});function f0(){let e=Be(),n=e.rightclick,t=e.toolbar,l=Iw(),o=!0;!l.insertRow&&!l.insertColumn&&!l.deleteRow&&!l.deleteColumn&&!l.deleteCell&&(o=!1);let a=!0;!l.clear&&!l.matrix&&!l.sort&&!l.filter&&!l.chart&&!l.image&&!l.link&&!l.data&&!l.cellFormat&&(a=!1);let s=(l.customs||[]).map((f,m)=>`
            <div data-index="${m}" class="luckysheetColsRowsHandleAdd_custom luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                ${f.title}
                </div>
            </div>`).join("");return`<div id="luckysheet-rightclick-menu" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel">
                <div id="luckysheet-copy-btn" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-copy-btn" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" style="display:${l.copy?"block":"none"};">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.copy}</div>
                </div>
                <div id="luckysheetcopyfor" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel"  style="display:${l.copyAs?"block":"none"};">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.copyAs}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                    </div>
                </div>
                <div id="luckysheet-copy-paste" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.paste?"block":"none"};">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.paste}</div>
                </div>
                <div id="luckysheet-cols-rows-handleincell">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${o?"block":"none"};"></div>
                    <div id="luckysheetColsRowsHandleAdd_row" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.insertRow?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.insert}${n.row}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheetColsRowsHandleAdd_column" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.insertColumn?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.insert}${n.column}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheet-delRows" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.deleteRow?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.row}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheet-delCols" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.deleteColumn?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.column}<span class="luckysheet-submenu-arrow" style="user-select: none;"></span>
                        </div>
                    </div>
                    <!-- cell right click remove hide button
                    <div id="luckysheetColsRowsHandleHid" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.hide}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                    -->
                    <div id="luckysheetCellsHandleDel" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.deleteCell?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.deleteCell}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-add">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                    <div id="luckysheet-top-left-add-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.to}
                            <span class="luckysheet-cols-rows-shift-left">${n.left}</span>
                            ${n.add}
                            <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align:center;margin-left:5px;"/>
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-bottom-right-add-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.to}
                            <span class="luckysheet-cols-rows-shift-right">${n.right}</span>
                            ${n.add}
                            <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-del-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.deleteSelected}
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-hide-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.hideSelected}
                        <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-show-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.showHide}
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                        </div>
                    </div>
                    <div id="luckysheet-column-row-width-selected" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            <span class="luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel">${n.column}</span>
                            <span class="luckysheet-cols-rows-shift-size luckysheet-mousedown-cancel">${n.width}</span>
                            <input type="number" class="luckysheet-mousedown-cancel rcsize" min="0" max="255" placeholder="${n.number}" value="" style="width:50px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;">
                            px
                        </div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-shift">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${l.sort?"block":"none"};"></div>
                    <div id="luckysheetorderbyasc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.sort?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.orderAZ}</div>
                    </div>
                    <div id="luckysheetorderbydesc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.sort?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.orderZA}</div>
                    </div>
                </div>
                <div id="luckysheet-cols-rows-data">
                    <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${a?"block":"none"};"></div>
                    <div id="luckysheet-delete-text" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.clear?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.clearContent}</div>
                    </div>
                    <div id="luckysheetmatrix" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${l.matrix?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                            ${n.matrix}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span>
                        </div>
                    </div>
                    <div id="luckysheetorderby" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.sort?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.sortSelection}</div>
                    </div>
                    <div id="luckysheetfilter" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.filter?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.filterSelection}</div>
                    </div>
                    <div id="luckysheetdatavisual" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.chart?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.chartGeneration}</div>
                    </div>
                    <div id="luckysheetInsertImage" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.image?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.insertImage}</div>
                    </div>
                    <div id="luckysheetInsertLink" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.link?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.insertLink}</div>
                    </div>
                    <div id="luckysheetDataVerification" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.data?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.dataVerification}</div>
                    </div>
                    <div id="luckysheetCellFormatRightClickMenu" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${l.cellFormat?"block":"none"};">
                        <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${t.cellFormat}</div>
                    </div>
                    ${s}
                </div>
            </div>
            <div id="luckysheetcopyfor_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-copy-json-head" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">Json ${n.firstLineTitle}</div>
                </div>
                <div id="luckysheet-copy-json-nohead" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">Json ${n.untitled}</div>
                </div>
                <div id="luckysheet-copy-array1" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.array1}</div>
                </div>
                <div id="luckysheet-copy-array2" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.array2}</div>
                </div>
                <div id="luckysheet-copy-arraymore-confirm" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        <span class="luckysheet-mousedown-cancel">${n.array3}</span>
                        <input type="number" id="luckysheet-copy-arraymore-row" min="1" class="luckysheet-mousedown-cancel" placeholder="${n.row}" style="width:40px;height:20px;box-sizing:border-box;text-align: center;"/>
                            \xD7
                            <input type="number" id="luckysheet-copy-arraymore-col" min="1" class="luckysheet-mousedown-cancel" placeholder="${n.column}" style="width:40px;height:20px;box-sizing:border-box;text-align: center;"/>
                    </div>
                </div>
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                <div id="luckysheet-copy-diagonal" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.diagonal}</div>
                </div>
                <div id="luckysheet-copy-antidiagonal" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.antiDiagonal}</div>
                </div>
                <div id="luckysheet-copy-diagonaloffset" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.diagonalOffset}
                        <input type="number" id="luckysheet-copy-diagonaloffset-value" class="luckysheet-mousedown-cancel" placeholder="${n.offset}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        ${n.column}
                    </div>
                </div>
                <div id="luckysheet-copy-boolvalue" data-clipboard-action="copy" data-clipboard-target="#luckysheet-copy-content" class="luckysheet-cols-menuitem luckysheet-copy-btn luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.boolean}</div>
                </div>
            </div>
            
            <!-- Revision: modeled on google sheet
            
            <div id="luckysheetColsRowsHandleAdd_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.top}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.row}</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.bottom}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.row}</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.left}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.column}</span>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.to}${n.right}${n.add}
                        <input type="text" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="1" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        <span class="luckysheet-mousedown-cancel">${n.column}</span>
                    </div>
                </div>
            </div>
            
            -->

            <!-- delete row or column
            
            <div id="luckysheetColsRowsHandleDel_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-delRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.row}
                    </div>
                </div>
                <div id="luckysheet-delCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.deleteSelected}${n.column}
                    </div>
                </div>
            </div>
            
            -->

            <!--
            <div id="luckysheetColsRowsHandleHid_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-hidRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.hideSelected}${n.row}
                    </div>
                </div>
                <div id="luckysheet-showHidRows" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.showHide}${n.row}
                    </div>
                </div>
                <div id="luckysheet-hidCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.hideSelected}${n.column}
                    </div>
                </div>
                <div id="luckysheet-showHidCols" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.showHide}${n.column}
                    </div>
                </div>
            </div>

            -->

            <div id="luckysheetCellsHandleDel_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheet-delCellsMoveLeft" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.moveLeft}
                    </div>
                </div>
                <div id="luckysheet-delCellsMoveUp" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.moveUp}
                    </div>
                </div>
            </div>
            <div id="luckysheetmatrix_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.flip}
                        <button id="luckysheet-matrix-turn-up" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.upAndDown}</button>
                        <button id="luckysheet-matrix-turn-left" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.leftAndRight}</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.flip}
                        <button id="luckysheet-matrix-turn-cw" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.clockwise}</button>
                        <button id="luckysheet-matrix-turn-anticw" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.counterclockwise}</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div id="luckysheet-matrix-turn-trans" class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.transpose}</div>
                </div>
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>
                <div id="luckysheet-matrix-cal-confirm" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        <div class="luckysheet-mousedown-cancel">${n.matrixCalculation}</div>
                        <div class="luckysheet-mousedown-cancel">
                            <select id="luckysheet-matrix-cal-type" class="luckysheet-mousedown-cancel" style="height:20px;">
                                <option value="plus">${n.plus}</option>
                                <option value="minus">${n.minus}</option>
                                <option value="multiply">${n.multiply}</option>
                                <option value="divided">${n.divided}</option>
                                <option value="power">${n.power}</option>
                                <option value="root">${n.root}</option>
                                <option value="log">${n.log}</option>
                            </select>
                            <input type="number" id="luckysheet-matrix-cal-value" class="luckysheet-mousedown-cancel" placeholder="${n.number}" value="2" style="width:40px;height:20px;box-sizing:border-box;text-align: center;margin-left:5px;"/>
                        </div>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.delete0}
                        <button id="luckysheet-matrix-delezero-row" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byRow}</button>
                        <button id="luckysheet-matrix-delezero-column" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byCol}</button>
                    </div>
                </div>
                <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">
                        ${n.removeDuplicate}
                        <button id="luckysheet-matrix-delerpt-row" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byRow}</button>
                        <button id="luckysheet-matrix-delerpt-column" class="btn btn-primary luckysheet-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">${n.byCol}</button>
                    </div>
                </div>
            </div>`}function k0(){let e=Be().sheetconfig,n=Tw();if(Object.values(n).every(a=>!a))return $("#luckysheet-sheet-container-c").addClass("luckysheet-sheet-container-menu-hide"),"";let t=!0,l=!0;return!n.delete&&!n.copy&&!n.rename&&!n.color&&(t=!1,n.hide||(l=!1)),n.hide||(t=!1),n.move||(l=!1),`<div id="luckysheet-rightclick-sheet-menu" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel"> 
                <div id="luckysheetsheetconfigdelete" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.delete?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.delete}</div>
                </div> 
                <div id="luckysheetsheetconfigcopy" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.copy?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.copy}</div> 
                </div> 
                <div id="luckysheetsheetconfigrename" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.rename?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.rename}</div> 
                </div> 
                <div id="luckysheetsheetconfigcolor" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel" style="display:${n.color?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> 
                        ${e.changeColor} <span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;"></span> 
                    </div> 
                </div> 
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${t?"block":"none"};"></div> 
                <div id="luckysheetsheetconfighide" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.hide?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.hide}</div> 
                </div> 
                <div id="luckysheetsheetconfigshow" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.hide?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.unhide}</div> 
                </div> 
                <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator" style="display:${l?"block":"none"};"></div> 
                <div id="luckysheetsheetconfigmoveleft" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.move?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.moveLeft}</div> 
                </div> 
                <div id="luckysheetsheetconfigmoveright" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="display:${n.move?"block":"none"};"> 
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.moveRight}</div> 
                </div> 
            </div> 
            <div id="luckysheetsheetconfigcolor_sub" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel">
                <div id="luckysheetsheetconfigcolorreset" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel">
                    <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${e.resetColor}</div>
                </div> 
                <div class="luckysheet-mousedown-cancel"> 
                    <div class="luckysheet-mousedown-cancel"> 
                        <input type="text" id="luckysheetsheetconfigcolorur" /> 
                    </div> 
                </div> 
            </div>`}function Xf(){let n=Be().filter;return`<div class="luckysheet-cols-menu luckysheet-mousedown-cancel luckysheet-filter-menu" id="luckysheet-\${menuid}-menu"><div id="luckysheet-\${menuid}-orderby-asc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.sortByAsc}</div></div><div id="luckysheet-\${menuid}-orderby-desc" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div style="width:205px;" class="luckysheet-mousedown-cancel">${n.sortByDesc}</div></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div><div id="luckysheet-\${menuid}-orderby-color" class="luckysheet-cols-menuitem luckysheet-cols-submenu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="position: relative;">${n.filterByColor}<span class="luckysheet-submenu-arrow iconfont luckysheet-iconfont-youjiantou" style="user-select: none;right: 0;"></span></div></div><div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-bycondition" style="padding-top:0px;padding-bottom:0px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> ${n.filterByCondition}</div></div> <div class="luckysheet-\${menuid}-bycondition" style="display:none;"><div class="luckysheet-flat-menu-button luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-selected"><span class="luckysheet-mousedown-cancel" data-value="null" data-type="0">${n.filiterInputNone}</span><div class="luckysheet-mousedown-cancel"><i class="fa fa-sort" aria-hidden="true"></i></div></div><div class="luckysheet-\${menuid}-selected-input"><input type="text" placeholder="${n.filiterInputTip}" class="luckysheet-mousedown-cancel" /></div><div class="luckysheet-\${menuid}-selected-input luckysheet-\${menuid}-selected-input2"><span>${n.filiterRangeStart}</span><input type="text" placeholder="${n.filiterRangeStartTip}" class="luckysheet-mousedown-cancel" /><span>${n.filiterRangeEnd}</span><input type="text" placeholder="${n.filiterRangeEndTip}" class="luckysheet-mousedown-cancel" /></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-byvalue" style="padding-top:0px;padding-bottom:0px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> ${n.filterByValues}</div></div> <div class="luckysheet-\${menuid}-byvalue"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel luckysheet-mousedown-\${menuid}-byvalue-btn"><span id="luckysheet-\${menuid}-byvalue-btn-all" class="luckysheet-mousedown-cancel">${n.filterValueByAllBtn}</span> - <span id="luckysheet-\${menuid}-byvalue-btn-clear" class="luckysheet-mousedown-cancel">${n.filterValueByClearBtn}</span> - <span id="luckysheet-\${menuid}-byvalue-btn-contra" class="luckysheet-mousedown-cancel">${n.filterValueByInverseBtn}</span> <div><i class="fa fa-\${menuid} luckysheet-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="padding-left:3px; padding-right:3px;"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><input type="text" placeholder="${n.filterValueByTip}" class="luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-byvalue-input" /><div class="luckysheet-\${menuid}-byvalue-input-icon luckysheet-mousedown-cancel"><i class="fa fa-search luckysheet-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div id="luckysheet-\${menuid}-byvalue-select" class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"></div></div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"><div class="btn btn-primary luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-confirm">${n.filterConform}</div> <div class="btn btn-default luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-cancel">${n.filterCancel}</div> <div class="btn btn-danger luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-initial">${n.clearFilter}</div></div></div> </div>`}function Zf(){let n=Be().filter;return`<div style="z-index:1004;overflow-y:auto;" class="luckysheet-filter-submenu luckysheet-cols-menu luckysheet-mousedown-cancel" id="luckysheet-\${menuid}-submenu"><div data-value="null" data-type="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionNone}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="cellnull"  data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellIsNull}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="cellnonull"  data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellNotNull}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textinclude"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextContain}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textnotinclude"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextNotContain}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textstart"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextStart}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textend"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextEnd}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="textequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellTextEqual}</div></div>  <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>  <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="dateequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellDateEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="datelessthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellDateBefore}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="datemorethan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellDateAfter}</div></div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="morethan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellGreater}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="moreequalthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellGreaterEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="lessthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellLess}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="lessequalthan"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellLessEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="equal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="noequal"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellNotEqual}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="include"  data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellBetween}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-value="noinclude" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${n.conditionCellNotBetween}</div></div> </div>`}function w0(){let e=Be(),n=e.alternatingColors,t=e.toolbar;return'<div id="luckysheet-modal-dialog-slider-alternateformat" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-alternateformat" style="display: block;"><div class="luckysheet-modal-dialog-slider-title"><span>'+t.alternatingColors+'</span><span class="luckysheet-model-close-btn" title="'+n.close+'"><i class="fa fa-times" aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-slider-content"><div class="textTitle">'+n.applyRange+'</div><div id="luckysheet-alternateformat-range"><input class="formulaInputFocus" placeholder="'+n.selectRange+'"/><i class="fa fa-table" aria-hidden="true"></i></div><div id="luckysheet-alternateformat-checkbox"><div class="cf"><input type="checkbox" id="luckysheet-alternateformat-rowHeader"/><label for="luckysheet-alternateformat-rowHeader">'+n.header+'</label></div><div class="cf"><input type="checkbox" id="luckysheet-alternateformat-rowFooter"/><label for="luckysheet-alternateformat-rowFooter">'+n.footer+'</label></div></div><div class="textTitle">'+n.textTitle+'</div><div id="luckysheet-alternateformat-modelList" class="cf"></div><div class="textTitle">'+n.custom+'</div><div id="luckysheet-alternateformat-modelCustom" class="cf"></div><div id="luckysheet-alternateformat-modelToning"><div class="toningbox header"><div class="toningShow"> '+n.header+' </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctOne"><div class="toningShow"> '+n.colorShow+'1 </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctTwo"><div class="toningShow"> '+n.colorShow+'2 </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox footer"><div class="toningShow"> '+n.footer+' </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionTextColor+'" style="border-bottom-color: #000;margin-right: 10px;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="luckysheet-color-menu-button-indicator" title="'+n.selectionCellColor+'" style="border-bottom-color: #fff;"> <div class="luckysheet-icon luckysheet-inline-block"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-cell-color" style="user-select: none;"> </div> </div> </div></div></div><button id="luckysheet-alternateformat-remove" class="btn btn-default" style="margin: 10px;">'+n.removeColor+"</button></div></div>"}function C0(){return a0()}function $w(){let n=Be().info,t={enable:!0,image:()=>`<svg viewBox="25 25 50 50" class="circular">
            <circle cx="50" cy="50" r="20" fill="none"></circle>
            </svg>`,text:n.loading,viewBox:"32 32 64 64",imageClass:"",textClass:"",customClass:""};return JSON.stringify(ut.loading)!=="{}"&&Object.assign(t,ut.loading),t}function Iw(){let e={copy:!0,copyAs:!0,paste:!0,insertRow:!0,insertColumn:!0,deleteRow:!0,deleteColumn:!0,deleteCell:!0,hideRow:!0,hideColumn:!0,rowHeight:!0,columnWidth:!0,clear:!0,matrix:!0,sort:!0,filter:!0,chart:!0,image:!0,link:!0,data:!0,cellFormat:!0};return JSON.stringify(ut.cellRightClickConfig)!=="{}"&&Object.assign(e,ut.cellRightClickConfig),ut.cellRightClickConfig=e,e}function Tw(){let e={delete:!0,copy:!0,rename:!0,color:!0,hide:!0,move:!0};return JSON.stringify(ut.sheetRightClickConfig)!=="{}"&&Object.assign(e,ut.sheetRightClickConfig),ut.sheetRightClickConfig=e,e}var import_plugin,s0,c0,u0,h0,d0,Ui,m0,g0,p0,v0,Ll,y0,b0,x0,_0,Sw,Wo,Pi,xl,Kn,Gs,zc,ga,Rr=Nt(()=>{import_plugin=qe(Ye());Xl();il();Vn();Ol();Ud();s0=function(){let e=Be(),n=e.info,t=e.print,l=ut.userInfo===!0?'<i style="font-size:16px;color:#ff6a00;" class="fa fa-taxi" aria-hidden="true"></i> Lucky':ut.userInfo;return`<div class="luckysheet">
                    <canvas id="luckysheetTableContentF" style="display:none;" class="luckysheetTableContent"></canvas> 
                    <div class="luckysheet-work-area luckysheet-noselected-text"> 
                        <div id ="luckysheet_info_detail" class="luckysheet_info_detail"> 
                            <div data-tips="${n.return}" id="luckysheet_info_detail_title" class="luckysheet_info_detail_back"> 
                                <i style="color:#444D5A;" class="fa fa-angle-left fa-2x" aria-hidden="true"></i> 
                            </div> 
                            <div class="luckysheet-share-logo" title="\${logotitle}"></div>
                            <div class="sheet-name"> 
                                <input data-tips="${n.tips}" id="luckysheet_info_detail_input" class="luckysheet_info_detail_input luckysheet-mousedown-cancel" value="${n.noName}" tabindex="0" dir="ltr" aria-label="${n.rename}" style="visibility: visible; width: 149px;" data-tooltip="${n.rename}"> 
                            </div> 
                            <div id="luckysheet_info_detail_update" class="luckysheet_info_detail_update"> ${n.detailUpdate} </div> 
                            <div id="luckysheet_info_detail_save" class="luckysheet_info_detail_save"> ${n.wait} </div>
                            
                            \${functionButton}
                            
                            ${G(l)==="string"?`<div class="luckysheet_info_detail_user">
                            <span id="luckysheet_info_detail_user">${l}</span></div>`:""}

                            ${G(l)==="object"?`<div class="luckysheet_info_detail_user">                            
                            <img src="${l.userImage}" id="luckysheet_info_detail_user_img">
                            <span id="luckysheet_info_detail_user">${l.userName}</span>
                            </div>`:""}
                            
                        </div> 
                        <div id="luckysheet-wa-editor" class="luckysheet-wa-editor toolbar"> \${menu} </div> 
                        <div id="luckysheet-wa-calculate" class="luckysheet-wa-calculate"> 
                            <div class="luckysheet-wa-calculate-size" id="luckysheet-wa-calculate-size"></div> 
                            <div class="luckysheet-wa-calculate-help"> 
                                <div class="luckysheet-wa-calculate-help-box"> 
                                    <div spellcheck="false" aria-hidden="false" id="luckysheet-helpbox">
                                        <div id="luckysheet-helpbox-cell" class="luckysheet-helpbox-cell-input luckysheet-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list"></div>
                                    </div> 
                                </div>  
                                <div class="luckysheet-wa-calculate-help-tool">
                                    <i class="fa fa-caret-down" aria-hidden="true"></i>
                                </div> 
                            </div> 
                            <div id="luckysheet-wa-functionbox-cancel" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-qingchu" aria-hidden="true"></i></span>
                            </div> 
                            <div id="luckysheet-wa-functionbox-confirm" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-yunhang" aria-hidden="true"></i></span>
                            </div> 
                            <div id="luckysheet-wa-functionbox-fx" class="luckysheet-wa-functionbox">
                                <span><i class="iconfont luckysheet-iconfont-hanshu" aria-hidden="true" style="color:#333"></i></span> 
                            </div> 
                            <div id="luckysheet-functionbox-container" class="luckysheet-mousedown-cancel">
                                <div class="luckysheet-mousedown-cancel" dir="ltr">
                                    <div spellcheck="false" aria-hidden="false" id="luckysheet-functionbox">
                                        <div id="luckysheet-functionbox-cell" class="luckysheet-functionbox-cell-input luckysheet-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list" aria-label="D4"></div>
                                    </div>
                                </div>
                            </div>   
                        </div> 
                    </div> 
                    <div class="luckysheet-grid-container luckysheet-scrollbars-enabled"> 
                        <div class="luckysheet-grid-window"> 
                            <div class="luckysheet-help-sub"></div> 
                            <div class="luckysheet-grid-window-1" id="luckysheet-grid-window-1">
                                <canvas id="luckysheetTableContent" class="luckysheetTableContent"></canvas> 
                                <table class="luckysheet-grid-window-2" cellspacing="0" cellpadding="0" dir="ltr" tabindex="-1" > 
                                    <tbody> 
                                        <tr> 
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div class="luckysheet-left-top" id="luckysheet-left-top"> </div> 
                                            </td> 
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div id="luckysheet-cols-h-c" class="luckysheet-cols-h-c">
                                                    <div class="luckysheet-cols-change-size" id="luckysheet-cols-change-size"></div>  
                                                    <div class="luckysheet-cols-menu-btn luckysheet-mousedown-cancel" id="luckysheet-cols-menu-btn"><i class="fa fa-caret-down luckysheet-mousedown-cancel" aria-hidden="true"></i></div>  
                                                    <div class="luckysheet-cols-h-hover" id="luckysheet-cols-h-hover"></div>  
                                                    <div id="luckysheet-cols-h-selected"></div>  
                                                    <div class="luckysheet-grdusedrange"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div>  \${columnHeader}
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td valign="top" class="luckysheet-paneswrapper"> 
                                                <div class="luckysheet-rows-h" id="luckysheet-rows-h"> 
                                                    <div class="luckysheet-rows-change-size" id="luckysheet-rows-change-size"></div> 
                                                    <div class="luckysheet-rows-h-hover" id="luckysheet-rows-h-hover"></div> 
                                                    <div id="luckysheet-rows-h-selected"></div>  
                                                    <div class="luckysheet-grdusedrange"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div> \${rowHeader}
                                                </div> 
                                            </td>  
                                            <td valign="top" class="luckysheet-paneswrapper">
                                                <div class="luckysheet-cell-loading" id="luckysheet-cell-loading">
                                                    <div class="luckysheet-cell-loading-inner">
                                                        <i class="fa fa-circle-o-notch fa-spin"></i>
                                                        <span></span>
                                                    </div>
                                                </div> 
                                                <div class="luckysheet-cell-freezen"></div> 
                                                <div class="luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-x" id="luckysheet-scrollbar-x"><div></div></div> 
                                                <div class="luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-y" id="luckysheet-scrollbar-y"><div></div></div> 
                                                <div class="luckysheet-cell-main " id="luckysheet-cell-main">
                                                    <div id="luckysheet-formula-functionrange"></div>  
                                                    <div id="luckysheet-formula-functionrange-select" class="luckysheet-selection-copy luckysheet-formula-functionrange-select">
                                                        <div class="luckysheet-selection-copy-top luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-right luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-bottom luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-left luckysheet-copy"></div>
                                                        <div class="luckysheet-selection-copy-hc"></div>
                                                    </div>  
                                                    <div class="luckysheet-row-count-show luckysheet-count-show" id="luckysheet-row-count-show"></div>
                                                    <div class="luckysheet-column-count-show luckysheet-count-show" id="luckysheet-column-count-show"></div>
                                                    <div class="luckysheet-change-size-line" id="luckysheet-change-size-line"></div>  
                                                    <div class="luckysheet-cell-selected-focus" id="luckysheet-cell-selected-focus"></div>  
                                                    <div id="luckysheet-selection-copy"></div>  
                                                    <div id="luckysheet-chart-rangeShow"></div>
                                                    <div class="luckysheet-cell-selected-extend" id="luckysheet-cell-selected-extend"></div>  
                                                    <div class="luckysheet-cell-selected-move" id="luckysheet-cell-selected-move"></div>  
                                                    <div id="luckysheet-cell-selected-boxs">
                                                        <div id="luckysheet-cell-selected" class="luckysheet-cell-selected">
                                                            <div class="luckysheet-cs-inner-border"></div>
                                                            <div class="luckysheet-cs-fillhandle"></div>
                                                            <div class="luckysheet-cs-inner-border"></div>
                                                            <div class="luckysheet-cs-draghandle-top luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-bottom luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-left luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-draghandle-right luckysheet-cs-draghandle"></div>
                                                            <div class="luckysheet-cs-touchhandle luckysheet-cs-touchhandle-lt"><div class="luckysheet-cs-touchhandle-btn"></div></div>
                                                            <div class="luckysheet-cs-touchhandle luckysheet-cs-touchhandle-rb"><div class="luckysheet-cs-touchhandle-btn"></div></div>
                                                        </div>
                                                    </div>
                                                    <div id="luckysheet-postil-showBoxs"></div>
                                                    <div id="luckysheet-multipleRange-show"></div>  
                                                    <div id="luckysheet-dynamicArray-hightShow"></div>  
                                                    <div id="luckysheet-image-showBoxs">
                                                        <div id="luckysheet-modal-dialog-activeImage" class="luckysheet-modal-dialog" style="display:none;padding:0;position:absolute;z-index:300;">
                                                            <div class="luckysheet-modal-dialog-border" style="position:absolute;"></div> 
                                                            <div class="luckysheet-modal-dialog-content"></div>  
                                                            <div class="luckysheet-modal-dialog-resize">
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt" data-type="lt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt" data-type="mt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm" data-type="lm"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm" data-type="rm"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt" data-type="rt"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb" data-type="lb"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb" data-type="mb"></div>
                                                                <div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb" data-type="rb"></div>
                                                            </div>
                                                            <div class="luckysheet-modal-dialog-controll">
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-crop" role="button" tabindex="0" aria-label="\u88C1\u526A" title="\u88C1\u526A">
                                                                    <i class="fa fa-pencil" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-restore" role="button" tabindex="0" aria-label="\u6062\u590D\u539F\u56FE" title="\u6062\u590D\u539F\u56FE">
                                                                    <i class="fa fa-window-maximize" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del" role="button" tabindex="0" aria-label="\u5220\u9664" title="\u5220\u9664">
                                                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div id="luckysheet-modal-dialog-cropping" class="luckysheet-modal-dialog" style="display:none;padding:0;position:absolute;z-index:300;">
                                                            <div class="cropping-mask"></div>
                                                            <div class="cropping-content"></div>
                                                            <div class="luckysheet-modal-dialog-border" style="position:absolute;"></div>
                                                            <div class="luckysheet-modal-dialog-resize">
                                                                <div class="resize-item lt" data-type="lt"></div> 
                                                                <div class="resize-item mt" data-type="mt"></div> 
                                                                <div class="resize-item lm" data-type="lm"></div> 
                                                                <div class="resize-item rm" data-type="rm"></div> 
                                                                <div class="resize-item rt" data-type="rt"></div> 
                                                                <div class="resize-item lb" data-type="lb"></div> 
                                                                <div class="resize-item mb" data-type="mb"></div> 
                                                                <div class="resize-item rb" data-type="rb"></div>
                                                            </div>
                                                            <div class="luckysheet-modal-dialog-controll">
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-crop" role="button" tabindex="0" aria-label="\u88C1\u526A" title="\u88C1\u526A">
                                                                    <i class="fa fa-pencil" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-restore" role="button" tabindex="0" aria-label="\u6062\u590D\u539F\u56FE" title="\u6062\u590D\u539F\u56FE">
                                                                    <i class="fa fa-window-maximize" aria-hidden="true"></i>
                                                                </span>
                                                                <span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del" role="button" tabindex="0" aria-label="\u5220\u9664" title="\u5220\u9664">
                                                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div class="img-list"></div>
                                                        <div class="cell-date-picker">
                                                            <input id="cellDatePickerBtn" class="formulaInputFocus" readonly="readonly"/>
                                                        </div>
                                                    </div>
                                                    <div id="luckysheet-dataVerification-dropdown-btn"></div>
                                                    <div id="luckysheet-dataVerification-dropdown-List" class="luckysheet-mousedown-cancel"></div>
                                                    <div id="luckysheet-dataVerification-showHintBox" class="luckysheet-mousedown-cancel"></div>
                                                    <div class="luckysheet-cell-copy"></div>  
                                                    <div class="luckysheet-grdblkflowpush"></div>  \${flow} 
                                                </div> 
                                            </td> 
                                        </tr> 
                                    </tbody> 
                                </table> 
                            </div> 
                            <div class="luckysheet-sheet-area luckysheet-noselected-text" id="luckysheet-sheet-area">
                                <div id="luckysheet-sheet-content">
                                    <div id="luckysheet-sheets-add" class="luckysheet-sheets-add lucky-button-custom"><i class="iconfont luckysheet-iconfont-jia1"></i></div>
                                    <div id="luckysheet-sheets-m" class="luckysheet-sheets-m lucky-button-custom"><i class="iconfont luckysheet-iconfont-caidan2"></i></div>
                                    <div class="luckysheet-sheet-container" id="luckysheet-sheet-container">
                                        <div class="docs-sheet-fade docs-sheet-fade-left" style="display: none;">
                                            <div class="docs-sheet-fade3"></div>
                                            <div class="docs-sheet-fade2"></div>
                                            <div class="docs-sheet-fade1"></div>
                                        </div>
                                        <div class="docs-sheet-fade docs-sheet-fade-right" style="display: none;">
                                            <div class="docs-sheet-fade1"></div>
                                            <div class="docs-sheet-fade2"></div>
                                            <div class="docs-sheet-fade3"></div>
                                        </div>
                                        <div class="luckysheet-sheet-container-c" id="luckysheet-sheet-container-c"></div>
                                    </div>
                                    <div id="luckysheet-sheets-leftscroll" class="luckysheet-sheets-scroll lucky-button-custom"><i class="fa fa-caret-left"></i></div>
                                    <div id="luckysheet-sheets-rightscroll" class="luckysheet-sheets-scroll lucky-button-custom"><i class="fa fa-caret-right"></i></div>
                                </div>
                            </div> 
                        </div> 
                        <div class="luckysheet-stat-area"> 
                            <div class="luckysheet-sta-c">
                                <div class="luckysheet-zoom-content" id="luckysheet-zoom-content">
                                    <div class="luckysheet-zoom-minus" id="luckysheet-zoom-minus">
                                        <div class="luckysheet-zoom-minus-icon"></div>
                                    </div>
                                    <div class="luckysheet-zoom-slider" id="luckysheet-zoom-slider">
                                        <div class="luckysheet-zoom-line"></div>
                                        <div class="luckysheet-zoom-cursor" id="luckysheet-zoom-cursor"></div>
                                        <div class="luckysheet-zoom-hundred"></div>
                                    </div>
                                    <div class="luckysheet-zoom-plus" id="luckysheet-zoom-plus">
                                        <div class="luckysheet-zoom-plus-icon"></div>
                                    </div>
                                    <div class="luckysheet-zoom-ratioText" id="luckysheet-zoom-ratioText">100%</div>
                                </div>
                                <div class="luckysheet-print-viewList">
                                    <div type="viewNormal" class="luckysheet-print-viewBtn luckysheet-print-viewNormal luckysheet-print-viewBtn-active" title="${t.normalBtn}"><i class="icon iconfont luckysheet-iconfont-putong"></i></div>
                                    <div type="viewLayout" class="luckysheet-print-viewBtn luckysheet-print-viewLayout" title="${t.layoutBtn}"><i class="icon iconfont luckysheet-iconfont-yemianbuju"></i></div>
                                    <div type="viewPage" class="luckysheet-print-viewBtn luckysheet-print-viewPage" title="${t.pageBtn}"><i class="icon iconfont luckysheet-iconfont-fenyeyulan"></i></div>
                                </div>
                                <div class="luckysheet-sta-content" id="luckysheet-sta-content"></div>  
                                <!--<div class="luckysheet-bottom-content" id="luckysheet-bottom-content-show"></div> -->
                            </div> 
                        </div> 
                    </div>
                    <div id="luckysheet-copy-content" contenteditable="true"></div>
                    <input id="luckysheet-copy-btn" type="button" data-clipboard-target="luckysheet-copy-content">
                    <div id="testdpidiv" style="height: 1in; left: -100%; position: absolute; top: -100%; width: 1in;"></div>
                  </div>`},c0='<div id="luckysheet-cell-flow_${index}" class="luckysheet-cell-flow luckysheetsheetchange" style="width:${width}px;"><div class="luckysheet-cell-flow-clip"><div class="luckysheet-grdblkpush"></div>${flow}</div></div>',u0="";h0=function(){let n=Be().pivotTable;return'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-pivotTable-config-option"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.titleSort+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-order"> <option selected="selected" value="default">'+n.titleNoSort+'</option> <option value="asc">'+n.titleSortAsc+'</option> <option value="desc">'+n.titleSortDesc+'</option> </select> </div> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.titleSortBy+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-orderby"> </select> </div> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.titleShowSum+'</span> <select class="luckysheet-mousedown-cancel" style="height:24px;" id="luckysheet-pivotTable-config-option-stastic"> <option  value="0">'+n.titleStasticFalse+'</option> <option value="1" selected="selected">'+n.titleStasticTrue+"</option> </select> </div> </div> </div> </div>"},d0=function(){let n=Be().pivotTable;return'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-pivotTable-config-option-sumtype"> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="SUM"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsSUM+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNT"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsCOUNT+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNTA"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsCOUNTA+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="COUNTUNIQUE"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsCOUNTUNIQUE+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="AVERAGE"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsAVERAGE+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MAX"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsMAX+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MIN"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsMIN+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="MEDIAN"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsMEDIAN+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="PRODUCT"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsPRODUCT+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="STDEV"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsSTDEV+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="STDEVP"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsSTDEVP+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="VAR"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticslet+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" sumtype="VARP"> <div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"> <span class="luckysheet-mousedown-cancel">'+n.valueStatisticsVARP+'</span> <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel" style="user-select: none;"><i class="fa fa-check luckysheet-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> </div>'},Ui='<div style="${style}" id="luckysheet-sheets-item${index}" data-index="${index}" class="luckysheet-sheets-item ${active}"><span class="luckysheet-sheets-item-name" spellcheck ="false" contenteditable="false">${name}</span> <span class="luckysheet-sheets-item-menu luckysheet-mousedown-cancel"><i class="fa fa-sort-desc luckysheet-mousedown-cancel"></i></span>${colorset}</div>',m0='<div class="luckysheet-cols-h-cells luckysheetsheetchange"  id="luckysheet-cols-h-cells_${index}" style="width:${width}px;"> <div class="luckysheet-cols-h-cells-c"> <div class="luckysheet-grdblkpush"></div>${column}</div></div>',g0='<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel" id="luckysheet-sheet-list">${item}</div>',p0='<div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel"  id="luckysheet-sheet-btn${index}" data-index="${index}"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="${style}" ><span class="icon luckysheet-mousedown-cancel">${icon}</span>${name}</div></div>',v0='<div dir="ltr"><div class="luckysheet-input-box-index" id="luckysheet-input-box-index"></div><div id="luckysheet-input-box" spellcheck="false" aria-hidden="false" class="luckysheet-input-box"><div class="luckysheet-cell-input editable" tabindex="0" role="combobox" contenteditable="true" id="luckysheet-rich-text-editor" dir="ltr" g_editable="true" aria-autocomplete="list"></div></div></div>',Ll='<div id="${id}" style="${style}" class="luckysheet-modal-dialog ${addclass}" tabindex="0" role="dialog" aria-labelledby=":41e" dir="ltr"> <div class="luckysheet-modal-dialog-title luckysheet-modal-dialog-title-draggable"> <span class="luckysheet-modal-dialog-title-text" role="heading">${title}</span>	 <span class="luckysheet-modal-dialog-title-close" role="button" tabindex="0" aria-label="${close}"><i class="fa fa-times" aria-hidden="true"></i></span> </div> <div class="luckysheet-modal-dialog-content">${content}</div> <div class="luckysheet-modal-dialog-buttons">	 ${botton} </div></div>',y0='<div class="luckysheet-modal-dialog-mask" id="luckysheet-modal-dialog-mask"></div>';b0=function(){let n=Be().pivotTable;return`
        <div id="luckysheet-modal-dialog-slider-pivot" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot">
        <div class="luckysheet-modal-dialog-slider-title"> <span>${n.title}</span> <span id="luckysheet-modal-dialog-slider-close" title="${n.closePannel}"><i class="fa fa-times" aria-hidden="true"></i></span> </div>
        <div class="luckysheet-modal-dialog-slider-content">
            <div class="luckysheet-modal-dialog-slider-range">
                <div id="luckysheet-dialog-pivotTable-range"></div>
                <div id="luckysheet-dialog-pivotTable-range-seleted">${n.editRange}</div>
            </div>
            <div class="luckysheet-modal-dialog-slider-list-title"> ${n.tipPivotFieldSelected} <span title="${n.tipClearSelectedField}" id="luckysheet-dialog-pivotTable-clearitem">${n.btnClearSelectedField}</span></div>
            <div id="luckysheet-modal-dialog-pivotTable-list" class="luckysheet-modal-dialog-slider-list luckysheet-scrollbars"> </div>
            <div class="luckysheet-modal-dialog-slider-config-c">
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-filter">
                    <div> <span><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i> ${n.btnFilter}</span> </div>
                    <div id="luckysheet-modal-dialog-config-filter" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-row">
                    <div> <span><i class="fa fa-list-alt" aria-hidden="true"></i> ${n.titleRow}</span> </div>
                    <div id="luckysheet-modal-dialog-config-row" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-column">
                    <div> <span><i class="fa fa-indent" aria-hidden="true"></i> ${n.titleColumn}</span> </div>
                    <div id="luckysheet-modal-dialog-config-column" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
                <div class="luckysheet-modal-dialog-slider-config luckysheet-modal-dialog-config-value">
                    <div> <span><i class="fa fa-cube" aria-hidden="true"></i> ${n.titleValue}</span> <span style="float: right;margin-right: 10px;display:none;" id="luckysheetpivottablevaluecolrowshow"><label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="${n.tipShowColumn}" for="luckysheetpivottablevaluecolrow">${n.titleColumn}</label> <input type="radio" checked="checked" value="1" name="luckysheetpivottablevaluecolrow" id="luckysheetpivottablevaluecolrow" /> <label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="${n.tipShowRow}" for="luckysheetpivottablevaluecolrow1">${n.titleRow}</label> <input type="radio" value="0" name="luckysheetpivottablevaluecolrow" id="luckysheetpivottablevaluecolrow1" /></span></div>
                    <div id="luckysheet-modal-dialog-config-value" class="luckysheet-modal-dialog-slider-config-list luckysheet-scrollbars"> </div>
                </div>
            </div>
        </div>
        </div>
        `};x0='<div class="luckysheet-chart-point-config"> <div class="luckysheet-chart-point-config-set"> <div class="luckysheet-chart-point-config-left"> <div class="luckysheet-chart-point-config-left-top"> <div class="luckysheet-chart-point-searchcondition"> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 0px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u9009\u62E9\u7EF4\u5EA6</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="\u7EF4\u5EA6\u9009\u62E9" name="luckysheetpointconfigsearchdim" id="luckysheetpointconfigsearchdim"> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 3px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;">\u6392\u5E8F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <label data-tips="\u65E0\u6392\u5E8F" for="luckysheetpointconfigsearchorderno">\u65E0\u6392\u5E8F</label> <input type="radio" checked="checked" value="0" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderno"> <label data-tips="\u5347\u5E8F" for="luckysheetpointconfigsearchorderasc">\u5347\u5E8F</label> <input type="radio" value="1" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderasc"> <label data-tips="\u964D\u5E8F" for="luckysheetpointconfigsearchorderdesc">\u964D\u5E8F</label> <input type="radio" value="2" name="luckysheetpointconfigsearchorder" id="luckysheetpointconfigsearchorderdesc"> </div> </div> <div class="luckysheet-datavisual-content-row" style="margin-bottom: 0px;margin-top: 5px;height: 30px;"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:90%;text-align: left;"> <select data-width="70" data-tips="\u6309\u7167\u4EC0\u4E48\u65B9\u5F0F\u67E5\u8BE2" name="luckysheetpointconfigsearchtype" id="luckysheetpointconfigsearchtype"> <option value="0" selected="selected">\u6309\u7167\u540D\u79F0</option> <option value="1">\u6309\u6392\u5E8F\u524D%</option> </select> <input data-tips="\u67E5\u8BE2\u5173\u4E8E\u70B9\u7684\u5173\u952E\u5B57" id="luckysheetpointconfigsearchcontent" type="text" class="luckysheet-datavisual-config-input-no" style="width:40%;" placeholder="\u67E5\u8BE2\u5185\u5BB9" /> <button id="luckysheetpointconfigsearchcomfirm" class="btn btn-primary luckysheet-model-conform-btn">\u67E5\u8BE2</button> </div> </div> </div> </div> <div class="luckysheet-chart-point-config-left-mid"> <span id="luckysheet-chart-point-btn-all" class="luckysheet-mousedown-cancel">\u5168\u9009</span> - <span id="luckysheet-chart-point-btn-clear" class="luckysheet-mousedown-cancel">\u6E05\u9664</span> - <span id="luckysheet-chart-point-btn-contra" class="luckysheet-mousedown-cancel">\u53CD\u9009</span><span style="text-decoration:none;color:#8D8D8D;float:right;margin-right:40px;cursor:default;" class="luckysheet-mousedown-cancel">\u53EF\u4EE5\u76F4\u63A5\u6846\u9009\u6570\u636E\u70B9</span> </div> <div class="luckysheet-chart-point-config-left-bottom"> <div class="luckysheet-chart-point-searchitem-c luckysheet-noselected-text">  </div> </div> </div> <div class="luckysheet-chart-point-config-right"> <div class="luckysheet-chart-point-itemconfig"> <div class="luckysheet-datavisual-content-row" style="font-size: 16px;font-weight: bold;"> \u6570\u636E\u70B9\u8BBE\u7F6E </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u56FE\u5F62\u989C\u8272</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <input data-tips="\u989C\u8272" class="luckysheet-datavisual-config-colorOpacity" id="scattersingleitemstylecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="color" /> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u56FE\u5F62\u5927\u5C0F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleallsymbolsizeslider" data-tips="\u70B9\u5927\u5C0F\u8BBE\u7F6E" name="scattersingleallsymbolsize" id="scattersingleallsymbolsize" data-width="50" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize"> <option value="4" selected="selected">4px</option> <option value="6">6px</option> <option value="8">8px</option> <option value="10">10px</option> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u70B9\u5927\u5C0F" id="scattersingleallsymbolsizeslider" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="1" data-max="50" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u70B9\u5927\u5C0F" data-sliderid="scattersingleallsymbolsizeslider" id="scattersingleallsymbolsizesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleallsymbolsizesliderdiy">px</label> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u56FE\u5F62\u5F62\u72B6</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="\u70B9\u7C7B\u578B\u8BBE\u7F6E" data-width="70" name="scattersingleallsymboltype" id="scattersingleallsymboltype" data-bigclass="scattersingle" data-attr="all" data-func="symboltype"> <option value="emptyCircle" selected="selected">\u7A7A\u5FC3\u5706</option> <option value="circle">\u5706\u5F62</option> <option value="emptyRectangle">\u7A7A\u5FC3\u77E9\u5F62</option> <option value="rect">\u77E9\u5F62</option> <option value="roundRect">\u5706\u89D2\u77E9\u5F62</option> <option value="emptyTriangle">\u7A7A\u5FC3\u4E09\u89D2</option> <option value="triangle">\u4E09\u89D2\u5F62</option> <option value="emptyDiamond">\u7A7A\u5FC3\u83F1\u5F62</option> <option value="diamond">\u83F1\u5F62</option> <option value="droplet">\u6C34\u6EF4</option> <option value="pin">\u6807\u6CE8</option> <option value="arrow">\u7BAD\u5934</option> <option value="heart">\u5FC3\u5F62</option> <option value="star">\u661F\u661F</option> </select> </div> </div> <div class="luckysheet-datavisual-content-rowsplit-sub"></div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u8FB9\u6846\u7C97\u7EC6</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleitemstyleborderwidthslider" data-tips="\u70B9\u8FB9\u6846\u7C97\u7EC6" name="scattersingleitemstyleborderwidth" id="scattersingleitemstyleborderwidth" data-width="50" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth"><option value="0" selected="selected">\u65E0</option> <option value="1">1px</option> <option value="2">2px</option> <option value="3">3px</option> <option value="4">4px</option> <option value="5">5px</option> <option value="6">6px</option> <option value="7">7px</option> <option value="8">8px</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u8FB9\u6846\u7C97\u7EC6" id="scattersingleitemstyleborderwidthslider" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u8FB9\u6846\u7C97\u7EC6" data-sliderid="scattersingleitemstyleborderwidthslider" id="scattersingleitemstyleborderwidthsliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleitemstyleborderwidthsliderdiy">%</label> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u8FB9\u6846\u6837\u5F0F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-tips="\u70B9\u8FB9\u6846\u7C7B\u578B\u8BBE\u7F6E" data-width="50" name="scattersingleitemstyleborderlinetype" id="scattersingleitemstyleborderlinetype" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinetype"> <option value="solid" selected="selected">\u5B9E\u7EBF</option> <option value="dashed">\u865A\u7EBF</option> <option value="dotted">\u70B9\u7EBF</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u8FB9\u6846\u989C\u8272</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <input data-tips="\u70B9\u8FB9\u6846\u989C\u8272" class="luckysheet-datavisual-config-colorOpacity" id="scattersingleitemstyleborderlinecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinecolor" /> </div> </div> <div class="luckysheet-datavisual-content-rowsplit-sub"></div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"><i class="fa fa-th-large" aria-hidden="true"></i> \u6587\u5B57\u6807\u7B7E</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <label data-tips="\u663E\u793A\u6570\u636E\u70B9\u7684\u6807\u7B7E" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow">\u663E\u793A</label> <input type="radio" checked="checked" value="1" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> <label data-tips="\u9690\u85CF\u6570\u636E\u70B9\u7684\u6807\u7B7E" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow1">\u9690\u85CF</label> <input type="radio" value="0" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow1" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> </div> </div> <div class="luckysheet-datavisual-content-row" style="height:auto;line-height: initial;margin-left:auto;" showfor="scattersinglelabellabelshow1" hidefor="scattersinglelabellabelshow"> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:40%;">\u6570\u503C\u6BD4\u4F8B</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:50%;"> <select data-tips="\u523B\u5EA6\u6570\u503C\u653E\u5927\u6BD4\u4F8B" name="scattersinglelabelformatratio" id="scattersinglelabelformatratio" data-bigclass="scattersingle" data-attr="label" data-func="formatratio"> <option value="0.01">\u4E58\u4EE5100</option> <option value="0.1">\u4E58\u4EE510</option> <option value="1" selected="selected">\u9ED8\u8BA4</option> <option value="10">\u9664\u4EE510</option> <option value="100">\u9664\u4EE5100</option> <option value="1000">\u9664\u4EE51000</option> <option value="10000">\u9664\u4EE51\u4E07</option> <option value="100000">\u9664\u4EE510\u4E07</option> <option value="1000000">\u9664\u4EE5\u4E00\u767E\u4E07</option> <option value="10000000">\u9664\u4EE5\u4E00\u5343\u4E07</option> <option value="100000000">\u9664\u4EE5\u4E00\u4EBF</option> <option value="1000000000">\u9664\u4EE5\u5341\u4EBF</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:40%;white-space: nowrap;">\u5C0F\u6570\u4F4D\u6570</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:50%;"> <select data-tips="\u6570\u503C\u5C0F\u6570\u70B9\u4F4D\u6570" name="scattersinglelabelfloatlen" id="scattersinglelabelfloatlen" data-bigclass="scattersingle" data-attr="label" data-func="floatlen"> <option value="auto" selected="selected">\u81EA\u52A8\u663E\u793A</option> <option value="0">\u6574\u6570</option> <option value="1">1\u4F4D\u5C0F\u6570</option> <option value="2">2\u4F4D\u5C0F\u6570</option> <option value="3">3\u4F4D\u5C0F\u6570</option> <option value="4">4\u4F4D\u5C0F\u6570</option> <option value="5">5\u4F4D\u5C0F\u6570</option> <option value="6">6\u4F4D\u5C0F\u6570</option> <option value="7">7\u4F4D\u5C0F\u6570</option> <option value="8">8\u4F4D\u5C0F\u6570</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row"> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:20%;">\u6807\u7B7E\u683C\u5F0F</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:70%;"> <select data-sliderdiy="scattersinglelabelcontentformatslider" data-tips="\u6807\u7B7E\u663E\u793A\u683C\u5F0F" name="scattersinglelabelcontentformat" id="scattersinglelabelcontentformat" data-bigclass="scattersingle" data-attr="label" data-func="contentformat"> <option value="default" selected="selected">\u9ED8\u8BA4</option> <option value="1">\u4EC5\u6570\u636E\u540D</option> <option value="2">\u6570\u636E\u540D+2\u7EF4\u6570\u503C</option> <option value="5">\u6570\u636E\u540D+\u5168\u90E8\u6570\u503C</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> </div> </div> <div style="display:none;"> <div class="luckysheet-datavisual-content-row" id="scattersinglelabelcontentformatslider"> <div style="text-align:center; width:60px; display:inline-block;">\u6570\u636E\u540D\u79F0</div> <label data-tips="\u662F\u5426\u663E\u793A\u6570\u636E\u540D" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow" for="scattersinglelabeldatalabelshow" style="font-weight:bold;"><i class="fa fa-eye" aria-hidden="true"></i></label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelshow" id="scattersinglelabeldatalabelshow" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow"> <input data-tips="\u663E\u793A\u5728\u6570\u636E\u540D\u524D\u90E8\u6587\u5B57" placeholder="\u524D\u7F00" id="scattersinglelabeldatalabelprefix" type="text" class="luckysheet-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelprefix" /> <input data-tips="\u663E\u793A\u5728\u6570\u636E\u540D\u5C3E\u90E8\u6587\u5B57" placeholder="\u540E\u7F00" id="scattersinglelabeldatalabelsuffix" type="text" class="luckysheet-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelsuffix" /> <label data-tips="\u662F\u5426\u5728\u6570\u636E\u540D\u540E\u6362\u884C" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline" for="scattersinglelabeldatalabelline" style="font-weight:bold;">\u6362\u884C</label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelline" id="scattersinglelabeldatalabelline" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline"> </div> </div> <div class="luckysheet-datavisual-content-row" > <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-title luckysheet-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">\u6807\u7B7E\u4F4D\u7F6E</div> <div class="luckysheet-datavisual-content-column luckysheet-datavisual-content-column-right luckysheet-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersinglelabellabelplaceslider" data-tips="\u6807\u7B7E\u8DDD\u79BB\u56FE\u5F62\u4F4D\u7F6E" data-width="70" name="scattersinglelabellabelplace" id="scattersinglelabellabelplace" data-bigclass="scattersingle" data-attr="label" data-func="labelplace"> <option value="top" selected="selected">\u9876\u7AEF</option> <option value="left">\u5DE6\u4FA7</option> <option value="right">\u53F3\u4FA7</option> <option value="bottom">\u5E95\u90E8</option> <option value="inside">\u5185\u90E8\u5C45\u4E2D</option> <option value="diy">\u81EA\u5B9A\u4E49</option> <option value="insideLeft">\u5185\u90E8\u5DE6\u4FA7</option> <option value="insideRight">\u5185\u90E8\u53F3\u4FA7</option> <option value="insideTop">\u5185\u90E8\u9876\u7AEF</option> <option value="insideBottom">\u5185\u90E8\u5E95\u7AEF</option> <option value="insideTopLeft">\u5185\u90E8\u5DE6\u4E0A</option> <option value="insideBottomLeft">\u5185\u90E8\u5DE6\u4E0B</option> <option value="insideTopRight">\u5185\u90E8\u53F3\u4E0A</option> <option value="insideBottomRight">\u5185\u90E8\u53F3\u4E0B</option> </select> </div> </div> <div class="luckysheet-datavisual-content-row" style="display:none;height:65px;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u70B9\u6587\u672C\u6C34\u5E73\u4F4D\u7F6E" id="scattersinglelabellabelplaceslider" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u70B9\u6587\u672C\u6C34\u5E73\u4F4D\u7F6E" data-sliderid="scattersinglelabellabelplaceslider" id="scattersinglelabellabelplacesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplacesliderdiy">px</label> <br /> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u70B9\u6587\u672C\u5782\u76F4\u4F4D\u7F6E" id="scattersinglelabellabelplaceslider1" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u70B9\u6587\u672C\u5782\u76F4\u4F4D\u7F6E" data-sliderid="scattersinglelabellabelplaceslider1" id="scattersinglelabellabelplaceslider1diy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplaceslider1diy">px</label> </div> <div class="luckysheet-datavisual-content-row"> <label data-tips="\u52A0\u7C97" data-bigclass="scattersingle" data-attr="label" data-func="labelbold" for="scattersinglelabellabelbold" style="font-weight:bold;"><i class="fa fa-bold" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelbold" id="scattersinglelabellabelbold" data-bigclass="scattersingle" data-attr="label" data-func="labelbold"> <label data-tips="\u659C\u4F53" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic" for="scattersinglelabellabelitalic" class="luckysheet-datavisual-content-column-italic"><i class="fa fa-italic" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelitalic" id="scattersinglelabellabelitalic" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic"> <select data-sliderdiy="scattersinglelabellabelfontsizeslider" data-width="50" data-tips="\u5B57\u4F53\u5927\u5C0F" name="scattersinglelabellabelfontsize" id="scattersinglelabellabelfontsize" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize"> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="18">18px</option> <option value="20">20px</option> <option value="22">22px</option> <option value="24">24px</option> <option value="30">30px</option> <option value="36">36px</option> <option value="diy">\u81EA\u5B9A\u4E49</option> </select> <input data-tips="\u5B57\u4F53\u989C\u8272" class="luckysheet-datavisual-config-color" id="scattersinglelinelabelcolor" type="text" data-bigclass="scattersingle" data-attr="label" data-func="labelcolor" /> </div> <div class="luckysheet-datavisual-content-row" style="display:none;"> <div data-tips="\u6ED1\u52A8\u4FEE\u6539\u5B57\u4F53\u5927\u5C0F" id="scattersinglelabellabelfontsizeslider" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" class="luckysheet-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="\u81EA\u5B9A\u4E49\u5B57\u4F53\u5927\u5C0F" data-sliderid="scattersinglelabellabelfontsizeslider" id="scattersinglelabellabelfontsizesliderdiy" type="text" class="luckysheet-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" placeholder="\u8BF7\u8F93\u5165" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelfontsizesliderdiy">px</label> </div> </div> </div> </div> </div> <div class="luckysheet-chart-point-config-chart"> <div id="luckysheet-chart-point-config-chart-c" class="luckysheet-chart-point-config-chart-c"> </div> </div> </div>',_0='<div id="luckysheet-tooltip-up" class="jfk-tooltip" role="tooltip" aria-hidden="true" style="left: 505px; top: 410px;"><div class="jfk-tooltip-contentId">\u7EC4\u5408\u56FE\u8868</div><div class="jfk-tooltip-arrow jfk-tooltip-arrowup" style="left: 35.5px;"><div class="jfk-tooltip-arrowimplbefore"></div><div class="jfk-tooltip-arrowimplafter"></div></div></div>';Sw=function(e){if(typeof e.image=="function")return e.image();let t=new RegExp("^(image|path)://").exec(e.image),l="";if(t!==null){let o=t[0],a=t[1],s=t.input.substring(o.length);switch(a){case"image":l=`<div class="image-type" style="background-image: url(${s});"></div>`;break;case"path":let u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.setAttribute("class","path-type"),u.setAttribute("viewBox",e.viewBox);let f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttribute("d",s),f.setAttribute("fill","currentColor"),u.appendChild(f),l=u.outerHTML;break;default:break}}return l},Wo=function(e,n){if(!e)return;let t=$w();if(n&&JSON.stringify(n)!=="{}"&&Object.assign(t,n),typeof t.enable=="boolean"&&t.enable===!1)return{el:"",show:u,close:f};let l=Sw(t),o="luckysheet-loading-"+uuid.v4(),a=`
        <div class="luckysheet-loading-content"> 
            <div class="${t.imageClass} luckysheet-loading-image">
                ${l}
            </div>
            <div class="${t.textClass} luckysheet-loading-text">
            <span>${t.text}</span>
            </div>    
        </div>`,s=document.createElement("div");s.id=o,s.className="luckysheet-loading-mask "+t.customClass,$(s).html(a),$(e).append(s);function u(){o&&$("#"+o).show()}function f(){o&&$("#"+o).hide()}return{el:s,show:u,close:f}},Pi=["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],xl={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:33,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,WIN:91,WIN_R:92,MENU:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145},Kn={fillStyle:"#000000",textBaseline:"middle",strokeStyle:"#dfdfdf",rowFillStyle:"#5e5e5e",textAlign:"center"},Gs=function(){return"normal normal normal "+h.defaultFontSize+"pt "+Be().fontarray[0]+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC",  "WenQuanYi Micro Hei", sans-serif'},zc=new Image;zc.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZoAAAGACAYAAACUS6SeAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAHBbSURBVHja7J13mFxV+cc/M7OzLbvpjZBKQhISUgAhgAlVkADSRcDyky4iYAAhAmpQQtMIiqigYkV6FRHphgBBKSGBkB5IIb1sdrO72dmZ+f3xniGTzZR755a5s/t+nmefTGbuPec7Z8497ynveU9on5m3YJMuwNnAt4B9gA3A48CPgY0UyPxJUzN/MLMShxwDXAMcAmwGbgD+UlBKhzVn/+yqqwrVFwIuBL7tZnkyYwaK98yaNb/QW6uBk4DLgfHAduDfwI+ApYUmOnHiKC+0AowAfgh8EYgAvwF+AMTd1OlQ40nAtcB+QIMpzx8Cy70oT8U6YZvXn2x+tN8A44ByYE/gMmA18B9g7wB9v58AzwNfADoBA4A/m4c5KPwWuCdDef4X6KVVtF1yGPAx8IDpAFUBPYGvAguBucCRAdJ7CvAecA7QA+gKfB94DKgMiMargaeAQ0159gK+BrwNqLUoIUNzFPAw0C3L5+XmAXoZ6B+A7/ZNM3rJxDTgl2Y0UUwmAxdl+WwI8HOtou2OzwFP5+hERIAxwDPAhADoHQvcbxrvTB3PZ4HaImscDmSbmukO/F6rXWkYmgnAP4wxyUd/U/m6FPF7lQO35bnmMuCvQLSIOs/J8/npQIVW03bDPjaejWrgn8boFJPpRks2jgReKfLo+yygLMfnhwCDtPoF29CMMUam2ka6Y8wDVV2k73Uw0NvCdV9F1kOqiqQzX+WvQqfP2gsDkWlcO79nD/McFWuGoAJZk8nHAcBM8x2LwRAL1+ytVTC4hmawqeiFNHaHInPQkSJ8rxob156ILBp2LYLOkAu/kRJ8egEvFWgw+iPT0cXocJTnGSmkMxJ4zfxbDJ1WjKYSQEPTC3jBYW/qJODX+L8WMhuos3H9JDP876NVQnGZLsbIDHOQxt5mVqGTz9rrgTdtjtpmmhGOouQ1NF2MkRnmQh4XATf7/L02GyO3zcY944FZZhSnKG5QDfwLd9ZZJiBOBOU+f4evAAtsjt5eIVhec0oADU21qdDjXMxnKnCJz99tJuIpt97GPcOA14HRWjUUh5QDTyAL0W5xFPAn/J2OXoV4k75j455aZMr9ZK0GSiZDE0XWVQ7zIK+7kI2efvKO+S6f2LinnzFSB2v1UAokAvwNONaDtM82z5KfbDBG7lUb91Qi+2z+T6uDkm5oQsAfkSknrx6+P5kK6ycLkTWYj2zc0x14EYkqoCh2CCGbcL/sYR6XIDve/WQbsu/rKZvP/B+BKVotOjbpHiW/RNx9vZ5OeByZv32vwDQmG51DsOdJYne/TCdk09xXgUcdfN9DkE2urwGbXCjDLsDvEG+5rcCTSASENVqdA8HtwAU+5HOjGWn8psD7RxmDNRZ7TgZ2p+1CyMbjzkZzoR3izyGOSf8DVrrUFv0S2cvWgqyl3Qgs0SrsnaH5IfAdn/LsgrgTH2rzR031FC/ysXzKzSjsBex5sQGci2wa7ZXWIzzZ5vRDW6oR76NJ5v9VprE4wxie/2qVLirXIaFQ/OIu03l52OZ93wTuxd/NytOQdZv/2bzvGMRzNeWY1Aqch2y2djLqvK9Nx/prSKidc8wzprhI2PxoN/qcby/Tg7CzN+BbPhuZ9JHNWTbvmW4qcvr362xGH/sXqCOCrJ9NylKezwB9tUoXjfPM7+4nEdPg2pmOHoXE1itGRIyLbV7/VdNODGvTOXY6xf8rMs/e1AAPoc5Anhia64uU9zDsxSD6VhHL6ds2e2DX5RjNPYd9t/GQeThOymO8r9cqXTSKVfblyNRuZ4vXX4D/LtLpowarcdGGmPYhksXAPkhh671T8zzPVfi/HaNDGJo9LF77EWAlhvetNvK342s/oojlZGe387UWRnN2A4/ebNHQnqpVumhYfY5WIfu18vFzZO3ACt2QfWBW2KeIZVSB9ZhjV5A7MnQVst5rZ3PoNy0akckUL3xWuzU0b1h8OI5FNkLm4zc2jI2dDZUbi1hOG2xce6iFawYg61TdLVx7iemFWaGzVumi8YbFenQcsMLCtS8jrsxWz3tpKIHnCGCLxeusRK7ugkytWYl1dpIZIVmJUhLFXhgrxYKhud3Cw3GUMTZWuQ5ZuM/HEzbSfLqI5fSkjWuten+Nwto5GVNt5P2KVumike8EwTrEYeNDG2k+jkQZz8cyrHtxPlHEMnoLObfKTYPUC2ubYi/Cusfc+9jb6K1YMDTP5xhO1plh5GKb6SYRL7an8/Ss7Cye/gg5LMpvmhCPGatML9JvuQR/3GqVzLyU47dvBE6jMK/A35B9zS/1rH3X/GvV0DxVpDK6zsa1P8H61KHbsxdnaHV239CALGSex65TRNsQd793Ckw7bob+r2X5MU8E1tqsABOQHdfNPpbRbJvTDffZNExuPRyTsTfFp7jPDchO+LVtjMyZyFSYk9HS3VmesSuw546bRDaT3oi/02hbsrQF2XgT2SIQ91FjI/AldC+N66Rv2PwjcpLeoUjI/FkuVMTUD/d7Y1i24GyD4Xrg66bn3gfrIcwxUxDftZnfJxTmUn2jGdJf6sNvmBp16sMRDP6CuKEfjBzP/KbNDlWu+rsNcQqJIGGSbkKmo+wSM52hn5jnyM5xzIcj0+J2PNe2m05nzKbOvyPrML/24XdrQQKIvqVV2FtDkyrsVz1oCN0Ox7EDawuqIIt/PynAyHyALNyudtAwdMXbaAstZkrmHa3KgSJms/dudSRyHfamn6zMOnxq4/pTTaNvx8hsAk5w0ID/BnGaucnD3yuJzOg8o1XXG9r7oVoRJFyL3T0Os5BgnKtdqLxeOTHETfovazVWfOAi4BGbo5+V5jlyOkqYDvzCw+92HTKbo6ihsU3Kz/58m/c9jbhyb3FBQwvZ16mccpk+HIpP/BCJJmAnztl84PNY23tnhSke1fefYW/vn6KG5jO6IN50dsNU/AGZimpyUUtqnWqei2neSuHBFBXFKiHECcFuiKo3kVBJK13UkkQ2XLo5Q3A/cI3+zGpoCuVeYGIBw/ML8cbLpQ44GncW7H+Hu/P0ipKNb2Mv/BLIOscXsLa52y6tZobgPy6k9SIy9ZzUn1kNTaF80ca1CeByxDXVy0q3AZmSW+UgjaeRSAH6cCh+MNnm9X9CHAYaPdTUiERBn+sgjbdMGi36EwfT0Fhp4BIB+F5Wp75akLDgfp1YuBw4nsLOpXkDeyFJFMUp221ce5sZIbT6oKvOjJoKmSFYgkxlN+rPG1xDk8+luIlgbBq0Emaj3jT6D/msbR7i7tlo857j9eFoN6x04VnzAysRBJLIQv1Un0fahcwQrEK2LOjG5oAbmnxeH48he1yKzfQ8lWkdEjn6pSLpewtxVGix+HAcj/2D15Tg8mCekf/7uOs84kTnm3lmBL4G3FkkfXZmCOrMtUu1+vlPmc3r/4UsRl+Y5Ue/MiDfa7UZNfyT3Q9XW4as4RR7J/1LyE7k+5Aw722JmYf8Apyt6yjBYw4Su+8nGT7bioSxCQIJJAzVv9j9wL4G4HTEu7OYzEPWkv6BRDloS9xcc4mbxnvWrPmB+IEmThxVEhW+EGeAi82PNtf0aFYju4UPCtiQ9H/AOGT9ZRUyrfcY4tsflHAtTyIhzi/NUJ79kHAfi1HaIzchMdBmI7H7NpsRxEFmRBMU1iMenFORM6l2GM2HB8DIpD/rQ0x5vmnKcxMyA7M3sJ/RrJTIiAZkHva3WDsGoNisQTzKLg+wxjpjWH6t1bFDUY1sgEyav4TpfScCqLUJWey/LcDl2YRELnikBH77k5EDEsebkeG/KF50en8MzfxJU/WRd4MZM7QMFKschhy/nD6tW4XExTsL2U1/BR3wfKHUVFCxp6Y8nJK6po3BrgK+gawfTQIW6IimKI9kM4rSjvgcsh+qS5bPI8AYZOPjUbgYTXjixFFWGvAIsmbY3fzb9nWuz3Yga7h3k8VrzmEDPhwYbUYBb2L9VNFUg/4dY8hHmbZvCTKd/jNkbcxrRpL97K+eSJifw9XQKIrihH2AZ3MYmXSqEWeWI/HOA60PEl7mc0APYzScHAdebXrs1yBrjlchO/Cd0h/4K3BE2nv1yHTTneR3q+6OBJ8dl6Hhv96MJCfhvdPN2eSOF3cYMJBguLa7a2hGvVb8eHLtYvruqquCo0Wn8YLIQGTxvJeNe3oYw3SIB41gZyRK+TCPvu9Y4DkkUsA/HKTTAwlKO7jN+7XAz5HF/kvzGJvpGYxMOoMR54xvelwHBlu4ZkB7NDRhff4VxXN6Ie7s/Qvszb9s00BZ4bseGpkUEeTQw04O0rg+TwN9CRIMN9dIYYKFfD7nR8fewjWh9vgAhB1WgM3m73qUFF8CPkRCcSR9+ms1eZ6kxR84uhgj46RR39uMCjq5qOsMn75/byQieqGcbuGac5GTTbMZGysLvT20qgbP0HzJDDVTi4A3aSP3GX9GFhsjPuYZMXn+RYs/UFQjrqtjXEhrAuJEUO6StmE+lsP3HdxrdRR4DvBwlvKxEkm6m1bXYBma/mTe8zHDg+F9KfJQB81b2ZVyJObeIS6meRQSIdmNToyf+3VGOrjXztrUaYgXWUUBhqYC8UxTAmBouiCLk/2z9JAecrHHVapcgr1z2N3ieiRqg1J8IsDfkKCPbnM27kQb93OjipN1h6dsXn8iMs1Ynfae1dNydVTjEWU2H57780wDHImc7X2JawpnVgantKzv6TkTWcD1y+g+CNyi1TkQhJCoGV/2uDOzFvixgzQeBg70qUycbIb7MbKTfqCNe44xHeITkb02dgzNp1qFizuiuQsJVJmPb2H/VL72xuv4d3rf28D56GFoQeF2JBCq19zosEP3K5wdHmYHJxHdNxrDYfdY6FQsti42DI1Th4Awspb2JSRWoRuUIxs5601Z/AUY2l4NzVSblfpOZD7ZbWqR8A2fIHPMXnlxJUwet5k8C+F+vD9y+VO8P9FQsc51wNU+5neXGT0XOso4GtnJPx8JTPk8Mv39G2QH+/eQTZfFrl+LjOH42OZ9hyAef1an7pxMnU0GFiLBO59Gotmf5fB7p6ZgLwJqjCH8OhL9e3IpPRhWps5OQjY82SFqKuwhuBcpuRqYiQSi82P6YyCyw/lYJOJzIQ/brchu8G94NB1xGnqEQFA4r4DnxCkRZMf8RmSqtpDRwkU5Pu9sjE91AMp3ObJz/kUkFI1VDjDPoJeG5qtmpBFuMxL5i2k3nnbQkcg0BVuDxMo7gBKJjZZvRDMBeIDCvNN6Il43XVzSer1PRqYt43G2T+jCAhsBK+m+hRIUirWXrNw0Op1dTrcaibc2IUBlvBIJQ/NRAd/FK0OzN7JhNJylw/2AMZB2yTeLVF2Ejo0nhmYvdvfesMu+Zujnhjvm2UUsJyd5t5iRh5vxqm435aoEhz0sXrcKCf2Sj59j7QTWVAPpZiesCvH2mhTAcl6DTKPN8SDtQgzNVezuTt3WIDyNhOSxyiVkD76ZzomzZs0vD8ohbIUYmi7IoVxu7Is50WKh5WPPIpaT07zrkLUUNw6Gewbv134U+7xh4ZoNyJn1VmJZvWw6OHGL+Te49D1SI6QvBLisNyDrS28HwNAcYOGaLsiU3xAL156ETJmFLP5WnUrh4QhnEf847uxmTnENcra4E1YXsZzcyHsp4o3iZGH1Q1OOcZSgkc+9vM50uj60kebjwGUWrlsGvOfCdyhDXOWPd7ls6jwo783GGL7uYprdC7hnq8XremFt8+73sD4D9DbWPeoCZ2juxRuPsd/hbL73gSKWk1t5v2V6qYW4Im9Czm+vQwkiL5F9zrwRmT79bwHp/ibPCDaJBMh06t6e8nA6tYTKvM6MEP9TREPzQ6xPcbo9qju7VH6otoZmKvB/HuVVaXpo/Qu8fzrezMvmYw7uLro9jf2pr1bEjXUJSpC5wTw/a9sYmdQGXiejpbszvB9HTuL8h0PdISTK8lds3vc84tJbTBrMCOzfLqRVyNTZm/i3Zy69Tn2plNqDdEPzVdxZS8lFP2Nsqgss3MOQmGp+nNewAlmQPQz39xHcanqqVvku3niuKe7zF8Q1/jAzihmKHGDmlMuMwdkCbEPW6j6P83A0IVMXv2nzvv+Y0Y9fvfnO5rvOR6ahlwLvINNHM3FnDbdQ9+b7kdM7/aDFzGyUlMdpah/NocB9+HMWwoGIO+A5BfQC6pENcVdT+lyGnLORb+PVPVl6s0pwiSGHdblJ0oyE3XYE+Tn2Y+S9ifP1Rrsd4ieREFde4mTD5q+RdZhpHupLmtHTC6X2QKQMzSP4GwzzLMTdN/8I6rBm2ilxZI71NbI7XrwCXK7ttuIRl5vRsh3eMZ2jeh91nuaDkXFqaEDCAvVCTvz0gmvN6KnkCJthc78i5D0dCT7YkalD5pcz7e5fisyZt6Ao7lNlGkY7zAO+yK4OKVY2czvtLZ7uU5m40au9zCNjcCvw01KtbGG8jTJrZWTT0VlF5iCkV+LOvhtFycQEoKuN6z9C9q5savO+lViAOxxqHe5TmfzZhTRS01vPuKjLj7iJnhua85EFNj/3ZsRNnv+nzzsgXkM3ID75683rp7VYFA+xEyx2CRJBeUOBowCnbUvYpzL5lUvptJjZCDf2+PwT/73aXKcMCTXxlD53RWc6JRS7SCl5rG4c/QTZV5dt0/LLFkYcTj2kluB9nMMluOuq3Ygcq5JrDRYL5XYm7WD6vEyfN5eYMUPLQCklliFhUXKFmlllPs91FsxU05B+PsvnryOL2E54AjjDw7JIIjvy3R411CHR319DTiC2a/j89Ozz1tDMnzRVHzlF8Rcrh3j5sVfsXNMIDs6i8RjybwqsQ/YMnYl4h40w7y9FTvF8GDnfyQkPIftUDvGgDLYi3ndPelTGaxEvvVexvtdnFeJl127WaHVEoyj+86DpQWdbe3gfd6N952rQPocccfBlJGrHKmRT9XRkvdAKCfOdHvRIZxyZhrrNGLVo2mchcjs1VJM5uvJyxJPrYazHKyuUJcbYvEb+Y1NyeaKWrqEZ9dqtgRCiIyufuOqqYOnpmFOOc4AfAT/J0sP200lmE+LheGVQCidL2Pst5D6kzRMNEyeOcivJecg02jNkjorfYurFFW52MoJyhEDpjGhmVhY3//a7cVQpDjchi89XIgvdjUjssB8Ci7V42iX/RaYpT0M2dY4HtgP/An6A/aOqS2dEU8A9XZAd7d9CjkjdYIbaP0aOhu3YtF+DGEJO9fy2/u6uUI1ETE6avwQyRZTQonHEPsZYH2PK91dIWJigHK3RiETJLoWDC7+JbEAdbUa+T5myXG83IbuG5mTgj+waqmFPI+ZiYDZwgY89sj2Rk0ArkXnaKvOXel1ptKa/rmxzTRVyBvd7wJ3I/pXt+rzuxm/bTF2kfvcTkc1/urnUOocjYZ/Sp1CqkMC2ZyF7zK5AQhAp1jkN2dyY3tu7ARiFxFbc4VZGqSm1Yk9NuTi115Y7TR1M0Q85+fN4YCI215DsGJqjkIWzbDHRypGFupcR7xAvF7MipuE7H/cCgR4E/N00mBfizt6iEOLZc4Xpae1AFgSnYf9skqh5YHoCnwKLfOylTSb7/PgQJDDj17Wds8SBpm51yVG3xyBz+UfhfZTersjR4HYX2TtlaQuWIlGmH0GiTPvFOPP8VmQxQM8iUY/9iNE2wjyrDUgAUjunn1aZ9uJMk0YYcSZ4xDxnfpxHdVgbI5POIKPjTDsJWt1xOwHZvW4l8GZ/86N28bAgrjYjJy+iTfcCHjOF7dTI3IdEqh5rHuIa02i/bvRboQb4mTGAc5C9D/ONsbkO66fxOeGcPJ+fTu5z05Wd0zr/tPhsVJtrx3ioJ2Ke1QtN47hX2t8QMwOQ7S9bWzAUOdtmKd7ufWnLLXnq4FHI4XQ9PNTQ34xCFyDTys+b5/S7Fu/vaTqgtwD7me8TZed04DvAHj6UZb4D1U7B5hHSVgzNGGNk7JwhM8ZU4GqPHg6vPWQipnF32jh/M8dI8l5knSsX5UhI8KsyNE69ERfUe32oeIMs9MJ6qR3JW4bP2yynHuY56u+Rpq/gzd6UVKP5EOJp5TVVFvM50MwoeFGePUzaR7R5vxa4A1krytcxvhnYN8fnQ43B8ZoBFmZXbJVhPkMz2FT0QhqRQ5EjkN3uce9jGlk/pjic9B7yGZEQcoZFrgOTTgUOzpPOuRYqhlNCLtSljkxvMxItpIHrj0xHe2HIvT62OYwcVOg1lTbamX2AWbgfqPN6Mm98TXEpcrZUrufkIAv5HBSQOl1utyJko5fpTTux/ieZxtTNKa4ePhbmjx0aRCsN+C/JfubMEItpDEIJKl2MkRnmII29zaxCJ5e1DfXh++9rsR47YQty0qad0eVMZHrKLawcZXAhEiE6m1GMWUijWyk+BOEcD8cLDh+OFBfh7hHRW30sHyfHGFhdAAwBvyDzdGCTxTRqUYJINbJHwo11lgmIR6SbBxT6FRH4Uh/yOANxkLFKHyQszOEu5W+1Q/41xGkhmsVg5qN7ezE01aZCj3Mxn6mIa5wbzMe/0/2cjMRetHn9DHY/otpqQL1qlKBRjgSDdHMN5CjgT7g3Hb3Ip7I414c8PkEceN61cU9n0xH4kgv52/GyPZPMpxpbMTRd8McByFNDE0XWVQ7zIK+7yO/NYIUY8DufysdJ5NRbsO+K+FNjlFNY3c+jhiZYRJD9HF4shJ9tniU3eMyn8vBrF/M6JBjlf2zcU4V4iH3NYd52t0OcbO6psmlooASnz8Jteu9/RNZVvHr4/mR6ZU6ZhvinB9nQLEWm3pps3ncLO0/Ts7oPoUbb9sAQQhZ9vXTtvQR3vI8eR6aPvGaLj+W/DdlC8A8b95QBfyH7WqkVfoz9vYPHsatH76b2amjSN2z+EtmZ7PV0wuOm1/Geg3TqETfCVMTZHcYo1JmGvRHx5jrZhUrrhOcQn/MnbI46ppvfZpbF62td+F0OMRX4NRsVPt8Q/3dI5ICtSBj2nwBr2rmhuR3ZSOw1NyJ7q37jII2EeUamI8c0p/ah1LEzFE4lEoLECZsd3LsvEnVkLPacIexGPUmtldZQ2JryRuTsHrvehUcD/0aiU/s1ooki3qw9gTfMSNApnZGtFieZ+vOPdOOb+jF+SG43WzfpYgr2UPKfdZGLFjM9kYkfuWBkwJ1QNM+bwn/aprG5EXEtt4KTqbNzkfDrvdKM68kOe7rVpqJNSpueuMT08k/EflSEUuE6dl9n85K7TKfgYYedqcty/I5PFtHQnGdGh34G//0JslH2/QLuXcjO6CiDbdw30bQTj/hgaL6C7Ozvl9bGnWmjrcnWUX2CnbNVVYiH3anGgP43bH7MG31+IHshi3Be7A24HplacwO3Trd7yRS43fSO99jQTEeiF/Rq0zN5Eti/wDQjyDrfpCy/+zNA33ZoZM7D/6O4I8BfcWc6ui01pvE5xoW0Cpk6G10EIwOynODEcWk54slmtxM9AevbKQo1NNcgZwb1S3uvkzFwBzuog/dnqYM9U8972DTMxWAYEqrCTaYi4dfdws1jVF9F5o4bPGoU7HIMO9eCMo06n8O+e3sI2QF9Up5ORrHqnJcU6zuVA4+aDoKbsw7P457rbyGG5iKKd4zJN3G2Z2mFKbuPCpgJsEIhLs4HI+u/2fJ9jsLc8O8i93pkL+AHYazvfv8IcS3Oh52T1I50sXJcnaMgnUwruMlMY2zcds8uZI0m3znuvcwUgJ355pvJHxEBvN+RXgysPkersLb29nNkethqD3e8S9+juxmBu+mWXYih2aeIv2UFzjdBf4qsI8/1QF8hI5qryb1Bv5DOpdVtKyeHkcUgKw/HsViba/2NDWPjVkM+BXENdhsvjguYZYyNm1FYC5k6O9TCNQOQ9TQrPahL2NU1OxedaX9YeY42IJ5GKyxc+zLiymw1QrcbI+XeJt8DXC6bQgzNpiL/nm7kvx6ZUnrXZW3dPHre+yFLGr0tPu9WO/a9w4iXTL6H4yjsue5dh4Txz8cTLhT6Fab3ZwerD2+jR5X4ddPguGVsCjE0Vr2/Rpk/K70bq7THc1byPXR1iCPEhzbSfJzsC/XpLMOZF2dqRPYq7m7UdmJonijib/km7nhipQzWUbi7HaMQQ7PW4nXDkDiPVgyNVf4RRuZib87xcEzG/kFmScSL7ekc12zE+eLpZUhkVDvUYX0+vdHDyjzbjBK3upBWIWs004v0EC/B+hEJpcRLOcq0ETkTpRBvu9+QfS0t9ax9F2fhZAYaI2N3usrq81HI6OARZCG5GHzf5fTqgC8iWweKZWhuxr+QQ+ksBS5Pzdldj3jNpJ+SuA3ZA/JOgRnEzdD/tSyjpBNtWNlsFvUX2AsTU4csgltdpHM6tRdBDgSbgUwnXofENLsI2czZz7zvtAIUskZzH+5551llg+m4tNfTOG8A/q9NvW5E3EdfdjhaujvLM3YF9jYntmUIspPebjTj/2F902ghI5qkMc434e802mbTCXSbejOL8aILaRViaB5Fjhvx+3k/Dlid7tXxR8RN7VDkZL1ZOD8LvhGJI/R7Y1i24M7GvQvMg2fXyBxnHpBzLN7jZI0mjIT4ONmHH7RQ9+YbkUV/P4IepkbHS2jf/AVx705tiHvTYYcqffS+DXG2iCCOJTfh7ATO4abhs3vMxCzzPFsdmRY6ao8BPzAdoj7YC2VzpBkNRm3csx3nRz53ZvcNsFvTOpNuhOMp1L35DvO8f9+H5yDV9i+B3d0HW3A/JEUdsoPfLQ4yFciOkalH9qTMtjkCcDJ19nWfjIwTQ5NqwLribVSIFtM7fYeOQczFaZL0Hv515J5Gs0NPJEK7XSPzimlAttto8JyGoIkjXlxWOcN0RO0YmU3IXjcnhjuMxC87wuP65eSolOvM836Jx8/7yellWYqHVV2PPf/6BmNk3iigYXZiaM7zsUycxDpLGq1Pe6QtbtJ/GSVI/ABZm7HDv81IJjXSt7qfw89YZ99GNiXaOVr8E2R3/lsO8z7NByPjZEST3rl80CNtqfbkxbYWuNSws/em0fRSZhU4AnCyRrOfj2VS5UIP5GwPeuGpSn2/tuuB4xSb1z+NbMRN73wFzdDcaEYydsLofwB8HljgQv6n+/Q9dzi8P46sJb7ggbZrMz3vpWhorM5xNpqRzEwHIwAnazRVPpbJHBfSSM2pznNR1604C/qoeEc/G9c+ikx/txTQs64HWj3+LqmI2XYjWs9CYpOtdknHCJ9+u/tcSKPFdDbecvl5z7ifsRQNjZWGsNH0vv7j0Ag4MTQrfSwTt85lr0MWMd1YsP8d7q0nKO5jdc3jfsRDMlOUAiuGxg+PscsRT067I7RjXR5thXz67e52KZ1UZ9yNzuX9uZ73UjQ0v87zeZOx1C/luMbK5rbN2Ntc15YXfSqPjTiLvNqWDeYBXOUgjaeRxcYkSlCxcujZH5AplmwbnK0cK+3HtJndEzL/gKynNLmsww+Pyg+Aj11Mb7MxNssdpPFPZF0m6ZahsdJwJHwYNv4xxzD9FPLPPf6N3HsPms0D5sQZ4Kd4u+ET0wCcj/uBOpebyldIb/QN7IVOUYrD9DwN1m+QUO+5fkcr0y7/8+G71Nn83hd6VD+9jmaQwJu9MKkQY4Xsb3sL2SeWMy6fXUOTL0ZTE95vxkuaxvUbSCiXTUbXn5AF+OctNtCnGGPyH2Og4ubBuxeJYup0V/Ji0+Bu9qgc3jaVwytvsXnYP9pgnjFQjSi5WOnCs+aUTchRDq9m6KxdieytytexvN70sLOxDH+OILHSwCeQKbYbPBxpP4Q3mz1TMxdnWmzfCh2NfcGm0V5iRpN5n3e7YbjvJ/d+i8dw7hFh1dj81fw56R38xfx5xdPIPoXhyL6FSmR9qFva667m39TrSsQrLv11F/N5Ajnk6gfY21dQKG8ha13PWpgmWWWMTB1KPh4Evpejo/c+7jpl5PrNjjT1c7QZGb9pY4S8EdnXdoVpBEchHl9LTFvwM9wJsZSPBxC35mwRp1tMx/QhH2YYjkcOEjyMXffxhMwznY1OWZ6xpUhkiEdwP5p8W+aa5/1f5PfMTdUdSwMLu4bmX8gi74VZpluu7LBNx8ysznCNuOMVZl3HYc1upvgScirffWRe/I2ZxukCnK3r7MpVVwXr950xw83U5iCnwP4kw2dbzUjbTxaZv0JoQryNbi3irxNHNmlmOlOlHjmW4iWftGzBvmNCoFoyxMPw76aDm+l5fxuZVbL8vBdysNDFSNjrS4CRxqI9ZR6cjZ59fXcbT8UeTyI7wr9qfn//fvf2y03I0b9XImfJNJppkR9iP4itIiP8CWZ09Q1gr7R26n0tHls8i5xDdZYZKY5GplqfMbMptiNbF2JoUmeJJNv0KIo1YvAH7w3dMchRq4cg6zo34O20nl3qEI+/Xwf8IQmZEfe3kWjEG5Bw+z8OoEF8BOvnxLvCxImjaMf4Prpqx+XZgMSodOUUZLuG5mTE4yt9CmVPZPf3xchC2AXaI7PNT4xhSdEJ+DMSWdfdxdTUFFD7Ndy/bTN1kaqfJ5oer6vOKu284VZKnKDUTzuG5ihkITrbonA5sgD2sumVr/JB/56mMU5fVK80hjD9db5F+Bpkb82diNtzg4+/wTfbGJl0piEB9K7A2z0pIeBck88+iEPHayZ/u2eoRJFF4Z5mOmMR/rk6Tyb7/PgQ5IC8r2vzo42jEkxDM8E0wFY2aPVH5vgm4Z0HUgj4pZkecWvT6UHIAthGMyp7yofyL0c8VHJxGRJT6lxkIc6LsrzPGLx0YzEZmc67xOLwucYYpgvYdRFxPXJu0G0+GJx8xz+cbvTt0EdfUfzDSiM9xhgZO6HoxxhjU+2R7suREzy9iGzQE3HNPMyH8j8Ya+dzfxVZZ/Aifto5bYxM247IvcgZKPkM5gvIZrK2niq9kU1y9/pQnoPyfF6FnMehKEqADM1gYzAKeTgPRfzbIy5rDgFXe1wuEWQPgNfYCe9/IhKmvavLGr5lobx/bQx7Nk41RjMX52L/7JNC6oYbnStFUXwyNL1ML7W/g/RPMo2Um8HmhjrUZJUDgT08zmM29qYXJyFuxn1c1GDlnPjUVOXlWT4fYjGNQfrIKYoamhRdjJEZ5kIeFwE3u6i5t4/l82OP099sjLGdHb/jkfDmg13SYNXxIYSstWTalGs1OGGtPnKKooYGZF3laWCci/lMxb2jQ/3cC3GWD3nMRDz61tu4ZxgS5220C/nbjTI9g92nLq3GNqvWR05R1NBEkXUVLxbC70KCTDplCf6ccZHqxfvBO6bMP7FxTz9jpA52mPct2PcO/KnpPKSwem6PGhpF6eCGJoRsxjzJo7wiSITloxymk0A25fmBn1GIFyJrMB/ZuKe7GZEc4yDfpWbkZvdsjlvYedCR1am/Gn3kFKXjkb6P5pfkjszsBuWIm+6RWDt8LBs3mxHApAAbmsmmPIcAFTbui9rMpxMSg+iryJG7hfAccmzCEzZHHdNNHZpl8fpaF+rPIcjG29dcGtl2QQLFnogEtHwSidSwRpsHRXHX0PyQ3O6rbtIFcdM9lMJPpGtEjhz+MuIyu8O8V4ccWrYdWRM6zaHWQsJyh9g9DIrXlJvR4gsUvkn2eTOafdqmsbkR6yd8Opk6OxfZ9Nkr7bc5md3PU7FDNbJHLNVhqTL15gxjeP6rTYSiuGNozsOfw4nS6YUcOXAohceeiiE7+TPxfReMDFhfe0jnWxQnTHgnZArsHgdpvIQcdvZPm0bheI8NzXR2P4+8sxl9HIVE6bVLBFmPnJSlfj4DjAXWajOhKM4II6fkFYNhuBQZtA3fwz136kKmzr5VxN/z2y6k8Soy7edFvLdC1miOyWBk0kfHz2HfDT8E/Irc65G9ivhsKEq7MzRWNyV+BMy3cJ2dEN1Huvx9pgC3u5heIYZmRBF/z5EupTPTGJt6l/UVskYz1cLo+GXsbeK92WKH4FRtIhTFHUPzhoXrViHn02+2cO1vbBgbN48mvQKJzusmhegr5pknbobAn2WMjZuBUQuZOjvEwjUDkHW/7hauvcSC8UrRWZsIRXHH0OQbAWxA5sHthP2/DmsuyE+49D2+A9zhQfkUskbzdBF/zyddTu914DgXjU0hhsaq99co8+d0hJTOK9pEKIo7huZ5sq9p1Jlerd2DzJKm8X86T89/ugvf4RLENTtkU58VCpk6+xHwcRF+yyYkTL/bzDaj2a0upFXIGs30Ij0bS5AjBRRFcUjKvfl682C1dR89Bdm1XghxJBLAc+zu2bMB+BLOPXouBO62aWTqTONlZS2nEEOzATm/ZwbiJuvXUZazKXzaLoIcFzAe8ebbhriJN6S9vhXZpOkkWkIhazT3IVNj03x8LjaYDtYGbSIUxT1DAxIV4H7E5bgrMkfvdL2h0RiU3yP7Erbg3oa48xBXXrtGZjLW5vJTxrYQ1iMnOV6ARFq2c5LpZcB3beb3CYW7VIeR83dO9qG+FerefKPpAF3qg8ZUHVmizYOiuG9oAFpwtgEu24P7ZZfT/Bqym9uOkalH9nu8ifWYa9sd6twBrLB4bcgYYLtG5gNkHWV1gRq/7pORcWJoUga4K95Gr2hB9l+9o02DonhnaEqB/YE/YO8Aq+3GyLxhs8HzK9ZZxIzOzrd53yxkL8gWhyNDv3AS6yxptNbiTTy+uEn/ZW0WFMVdSvG0weuQkCtWaTRGZlYBPWs/DE0VEv/NrpF5Glmk3+Iw//18/O2cHkXdYkajr3mg7TJk6lhRFDU0tgJpNiJrQzPbvN/J4v3bPP4uXdgZY8wOf0CmeJpc0FDl4283x4U0Uut+81zUdSuy/0tRFDU0toxEI+I1l2kvhNWNeNs9/i73AhNt3jMd8baLu6RhpY+/3QyX0qlDgqq6sWD/O7KHuFEUpYMamrkWrmk2Pf4XsnxudW3Ka0PzRRvXJoDLgRuwvg/ICi/69LttxHqUZytsQKYOVzlI42lkH1ZSmwJFCY6hsfJAJjzWfFeez1uQGFX/znGNlbNwNgMfevxdrE59tSD7XO7yQMNP8X4tKo6sQbkdqHM5sv5WyLk0byDrPXFtBhQlWIYmn6tuE95vcnsAme7IRIMxMs/lSeNhcoe/aQb+z4cG2EoInpRb9kMeaVhsGtzNHqX/thl5eBWaZx5ytEGjzXuOx98TVBWlw2LXvfl+cu9jeAzZO+I1FyFuqJcAo02D8Qqyc32BxR72Gch+nHMRl+lOyHrF86aX78eGvelGR68sn68zjajX+zqeRnbfDwd6ItEMqpCTLFOvu5p/U68rEe+99NddzOcJY8x/AHzqQzm+hThUPEt+j8RVxsjU6eOvKME0NP8yo4kLs0xjXOm6wplZI7g8aP4KJQH8xfxZ03FYc/bPnypo0/pqTr47ddBYW2OzDPgiT11q3+AdVlB5NOKOV1ixeAn4ChKypluGz2PIZt0LcLauo3jMxRdfHBgt99xzj/4gRTA0ABcjJxpegpx/sgF4CgkmuVGL1CZPXfo/Tr57HHIq6KlAD9Mz/w5PXaqnO9rjSTOy/aqpp57Xz1JpFLXxVkrF0NQg0zhHIsEX+yLOAT2R6Z8DTI/4FdNDbyjSd2qrcwgypQMyXbI8cDqfurStzkmm0fROZ67RWWlTB/za/BWDPZCp3QPwbo9SEzKdei+FxwwsFZ19kaC/JyKH25UhzjG5PEIbzAg2E0l2j0QeQyKuP4Ksm6oXYhEMzTDgWmTBONselt7mb4LpSW5HFu1vw8Jax/xJU934Lp7rdIlS0VlcZswoRdWnIFOxtT7k9SXgKiRW3VPtVOcYxP2+d5v3y8m9FtetAJ0HA2eZTt2ZqKOIq+TyOqtEdkx/iMxrd7KRbidzz4emcfQyVL7qVILAvsiaYa2PedYi3oj7tkOd5WZ00dvn3/EE3NtYrOQxNEORhdNrsRdXLFNlucakNcwD/apTCQo/ACqKkG+Fybu96TzJPDfF4EJkmk7x0NDsjxzhO97FfMYjQS33dzFN1emuTsUZRxUx7yPboc4Di6gzQqG+m0pG2q7RDEM2O/byIK8+Ju1Dcb7OoDrd1ak4p6edi+NlYbb0q6KuTyVNtVGSYQgloKo+Rpd1zXT7tIlIq+UgG7280llR1srofqsZ0WctvWrqiYQTxBNhNjTUsnBdXz78dE92tJZ5odPW1F6nUIgxkQj7lpWxRzhMp1CIeDJJXTLJikSCD1pbmR+P2wlb0kWrtDeGpgp41KNGMb2iPYYsvBUaeVh1uqtT8ZGWqggrxnRl3dBaEpHdz+3bQhWfjuhMOJ6kz9J6Bs7bSnmT/1FyOlc1ccK+7/P5oUuIRjLnf8TwBcTiEV5fOox/fjCObU1VvuvsFApxXHk5R0ajRNt+GArRExgaiXBkNMrmZJJnW1qYFYupW5nPpE+dTQPG+ZDnWJyd/6463dWp+MSGwZ14++T+rBneOaORSScRCbFmeGfePrk/GwZ38lXngYOWc9NJj3PE8IVZjUyKaCTOEcMXctNJj3PgoOW+6hwdiXBjdTXHZjIyGegeCvG1igqmVFXRORTSClkEQzMUmOJjvlMobDFbdbqrU/GJT8Z1Y8HE3sTL7IUXjJeFWTCxN5+M6+aLzi+NncP5E2dSUdZq676KslbOnziTk8bO8ccYlpXxnaoqagswGCMiEa6tqqKbGhvfDc1UsNQpcIuoydMuqtNdnYoPrN6nCyvGdHWUxooxXVm9j7fLBl8YOZ8Tx7xPoc1vCDhhzPt8YeR8N+RkXfjZOxLhm5WVjs446RkOc1lVVS4XUJ1dc9nQ1CKbB/3mLOwt+KlOd3UqPrC9WznL93NnNLJ8v25s71buic7+3TZz6n7uxG49db93GNDNcTDwjPOFFaEQ51VWFhQ7qy17hsOcWpHV03ub1l53Dc3x2Ns86BadTN5WUZ3u6lR8YNkB3UmG3ZmiSYZDLDuguyc6v7z/25SF3TlKqiyc4Iz93/ZE59HRKN1dnPI6IhqldzisFdUHQ3N0EfM/2qNrVadSdBq6l7O1r7ueWFv7VtHQ3d1RzYBumxnZd42raY7su8aNUc1ujdWR0Wjg01Qyl/PYIuY/1qNrVadSdDYMqimJdA8c7I23mNvpDotEPPEW26+sTCurD4ZmaBHzH+rRtapTKTp1fSpLIt29e6/zRKfb6Q6NRDzR2S0Uood6oHluaDoXMf/OHl2rOpWi01xbVhLp9q71Zt3b7XR7e2gMdJ3Ge0OjKIoHxMq96YHHKtxNt1N5iyc6O1U4OtV9t8WtMg8NTYa0m7UGu2toiunGt82ja1WnUnQicW+2YkRa3U23Je6NQWxpdTTy2s3jwctAPK3J3cp0h9Zgdw3N0iLmv9Sja1WnUnQqtreWRLqbt3vjje92uhsTCc9+q01J3Z/ptaGZW8T853p0repUik7N5h0lke6KzT080el2usvj3oxp6pNJNnhoxBQxNC8VMf+XPLpWdSpFp8dKb04D7rHK3XTnrBroic73Vw1wNb2F8TjbPRh5zGlt1XgzPhiaZ5Ez6f2m0eRtFdXprk7Fa0OzqtH1EP/lTXHXDdjcVQPY2lTtappbm6p532UD1grMisVcTTMJvOpymkpmQ1OPnCHuNw+YvC2PcFWnqzoVjwklkgx6f4uraQ56fwuhhLv979ZEmGfmunuixTNzx9GacN+p9d+xGPUujmr+29rKKp0288XQANwK+GnWY8BtBdynOt3VqXhM3yX1dPvUnTPpun3aRN+l3vQlZi0Zzodr+rmS1odr+jFr6d5Ok8kYIHZ7Mslfd+xwZaprUzLJQzuyrnepB6cHhmYJcIeP+d4JLC7gPtXprk7FB0a+tp5OW5ztVem0pYWRr633LHh9Evjda4ezaquzSNOrtnbjd68dTjLpeM9L1uHQ+62tPObQ2NQnk/yqqSnXmo8u23hgaEBOafTDa2kuzk+uVJ3u6VQ8piyWYOwLa+i6rrA9gF3XNTP2hTWUxbyd4mmKlfPzF77IwnV9C7p/4bq+/PyFL9IUK/e8TF+IxfhTczOFmO9PEwlub2riU50yK4qhaQJOBzZ4mN8Gk4eT1UzV6a5OxQ9j05Jg3xfXsNc7mylrSVi+Z693NrPvi2ss3+OU7S0V3PnSsTzyzoE0tlgzGI0t5TzyzoHc+dKxbG+p8K1MZ7e2cmNjI/+z6DXWnEzyj5YWbm5sZL0aGX/rf5v/LwGOQ7yX+ric1zrkvJQlLqSlOt3VqTinGcgZ7TKUhD0/qqPvknrW7VXDpv7V1PesIB7d2d+LxBLUbtxBj1WN9FnWQMTaKKbZTZ2JZIgXF4xi1tK9OXjIUsYPWMGQHhupjO5cdmyORVm+qSdzVg5k9vKhNMeibuu0tEayMZHg983NPB0Os19ZGaMjEXqGQnQxscu2JhKsTCT4MB7n7dZWmqw7EmzXKu2doQF4F5gIPIZ7Yefnmp63m42i6lQjEyTmAAdbuTASS9Bv4Tb6LZS2NFYZIV4WItKaJNocLzRv13U2x6K8umgkry4aCUBtZTMVZTF2tEapb670Wucb2DjIb30iwb9bWvi3O79lE7BQq7R7hHP0xCcAt+PMeypm0pjgUaOoOpWgcG+hN0ab41Q2tBZqZOzmXbDO+uZKNjbUFmpk7OZ9D7C5SL/lfeh0tC+GJjXMvRYYDfzeZsE3AX8w916Lt5FQVWdbrrpKa7b//Am4vwj53m/ybm86NwKnAVt91vkOMFWrs7tYCa+6GLgQmAKcCBwJjAeGAF3NNVuB5WZo/ArwDNDghsBRoWlWL10MXDg/Oc2WzlGhaZZ1znenzItanopnJIFvAP8Fvmt+Ty9ZjrjQ3409V9xg69y1k/QfYIx5Vo5G9tZUA7k8DroChfhWrzYjmVutdAJnzZofmIo3ceKodmFo2lbS9L9ElveLhjEcD1Kc3fl2SNc5wlTwY035zQKuBpZp+11SJIBfmr8eQJe2F8Sj4fDy/bqNbexafmhrNDwyGQ7tmQzJdaEkdaFEcnVZLLGgemvszSHvbX4/EsvoHlUHbPJSZ2U0Fj51/Dtj9+y69dDKaGxkWTixZziU7AKQSIbqWhPh1c2x6II1dV3ffOy9A95vjkW90AmwCsg6RL+npiYMHGgM0ThgEJDaDLQF+AR4H3j5rqam9z6IxzPF2on50JGzrNN0AtqVW5wVQzPMTNecDWSL+93b/E0ALkY8Nh5AdqsXey3hOGTaqRm4FHguYL/B54Dn0yodwKnAJOAY7C2gKsFhU3oj+9rXhnQz9e9CIFcQsPHACXW9K1kzvHYF8Dvg7kl/W77FD533fPXPtnTu3Xsdh+298DOdF9//f1v8KNx7amqs6pwAnAlwWVXVTp0NDVt8qge2dQKf6TRGqOQJ7TPzlmyfVSIbAaeQ4RAii7Qgu9Z/RI51hfmTsk+JjnrtViffr4cZFaSOON5mpgoKWmTMpbPAdZHPAS+wc8qsLRsLNjYzZmhT78cIOn/9DAHfBm7K8TvnYyvwA+DXuXq6OevnzMrA6OSwZifPkX86czxDFqbOfNNZClNn2ZwBhgJvmpGMk22+5cA1Jq1hRfh+J6UZGczrEwM0knkhTyXsaa4Zr016SVIDPAH8ykFjg7n3LuBxk6bqVJ0lRSZDsz/wusuN23hk3WF/H79b1Bi5tlxOYYuFfhsZNTalzWDTwTrZxTRPNmkOVp2qs5QNzTBkDaOPB3n1MWn7NbK5FBiZ4f0DgHNKxMiosSlNepnfa18P0t7XpN1LdarOUjQ0VcCjHn+RXsgO+SqPv1dPZF0oG9PJ7SIZJCOjxqa0iJg67mWHahgynVKmOlVnqRmaaYjbndeMxftowz/O05gPAr5TQkZGjU3pcC3iMeg1E8k8Naw6VWdgDc1QxLvML6Z4aPn3RVwJ83E90L2EjIwam+DT39Qrv7je5Kk6VWdJGJqpyOK5X0TxLszDnRaHlt2AG0rMyKixCTZXIzvX/aLa5Kk6VWfgDU0tshnTb84iy3GtDjgF2XlrlW/jrSeHF0ZGjU0wqQTOLUK+52JvzVN1dkydRTc0x5N9x7+XdMJGGHALVCCRje3ec3MJGhk1NsFjMrvu2fKLziZv1ak6A21oji5i/m7mfRmwd4EjqwNL0MiosQkWXyiR50h1dkydRTc0Y4uYv1t590FCNRRCqICRUC729tHIpBub54G9tL0vGsU09ONUp+oMuqEZWsT83cr7JofD1yNwLzTNz3w2Mil6IRGgleKwdxHzHq46VWfQDU3nIubvRt7jgfNcSOc23NkIVcyh9LHa3pd0XfYjb9XZMXUW3dCUOne69D1GuWSwikkcpSM+S2HVqTqD/nBsK2L+TvP+MnC4i3puxLkH3vNFLM8Xtb0v2brsV96qs2PqLLqhWVrE/J3kXYlMd7lJX5xvhLoa2FCEstxACYamaEcsL2Ley1Sn6gy6oZlbxPyd5H0l3px3frUxOE6M57E4P8LWrpE5EjkOVim9uuxn3qqzY+osuqF5qYj5F5r3HsD3PdJUg0yhOWEO4hTgh7FJGZkPta0vKi8XMe9XVKfqDLqheRbYXoS8G03ehXAL3p44dx6wTwkYGzUyweEfQFMR8m0GnlGdqjPohqYeeLAIeT9g8rbL54BveKytDHf2pHhpbNTIBIttwMNFyPchoE51qs6gGxpMoxrzMd8YhS3kh4Bf4M9RzCfhjkebF8ZGjUwwuQVo9TG/1gI7RKqzY+osuqFZAtzhY753AosLuO8s4FAfdf7UJaPmprFRIxNcFgJ3+ZjfXcAC1ak6S8XQgJx66YcXw1wKP2Fzms/lcyBwpktpuWFs1MgEnxuA+T7kMx9n5ympzo6ps+iGpgk4HW/3gGwweTQWcO9eFCe2z624F6zSibFRI1MaNAIn+/AcnVzgc6Q6O7bOohsakCm044B1HuS1zqS9pMD77y1SGQ0G7nMxvUKMzXo1MiXFEuSsEC8anQ0m7SWqU3WWqqEBeBeYiLvTaHNNmu86SGNCEcvpEJfTs2Ns1gNHqZEpOd4BPg984GKaH5g031GdqrPUDU3KMk9Azmlx4o0WM2lMcMES/7eI5TTbgzStGBs1MqXNYlP3Z+DMK6kV+LlJa7HqVJ2lRq6w+M3AtcDvkRha5wDVFtNtAv6OuDC7VUAXAn82lj3kU/kkgdfx7kzwlLF5EejR5rN1yAl6rhqZiy++ODCV75577ukIxqYRCWt0DzAVOBvrZ703IfvNbvWhoVGdHVNn0Q1NunW+EJiCHA52JHIGzBB2HvC1FQkuNwcJi/AM0OCy1mXApHbYEM0BDjIjv6ONcXsOuA74WAcF7Wp0cz7wXeAEM1Idl+U5eh8JbfIs/kfoVZ0dU2fRDU3bHn76XyLL+0Vj/pMbaswPmm4Qu5iP69oYxH+OOqVXQzF0zjr1/Ew6Uz2eo5FoDZ/pnPjEHxqKVKS2ytODDkZ7IxWJ40HVqTo7CqF9Zt6S75phyBTa2Vg/q2W7GfrdhoW1mfmTpmb/8KqrrH4Xz3UyY4ZjnbNOPd+RzolP/MHaWlcWrTamzjwvzw4ydaYoHZ5cI5pKZIPkFKDcZrqdgAuQmGR3Aj9C1ny8IBA6Z516vi86Z516fl6dEyeOKvnyVBSl/ZDN62wo8Kbp0ZY7SL8ccSR40/SQ3UZ1dkydiqKUuKHZH/G0Gu9iPuOBWSZtt1CdHVOnoiglbmiGIR5PfTzIq49J240erursmDoVRSlxQ1MFPAr08jC/XsBjWPcnz4Tq7Jg6FUVpB4ZmGuLf7TVjcRaFWXV2TJ2KopS4oRmKeBn5xRQKm0pRnR1Tp6Io7cDQTAWiPuYbNXnaRXV2TJ2KopS4oalFNuX5zVkmb6uozo6pU1GUdmBojsf6zm836WTytorq7Jg6FUVpB4bm6CLmf7RH16rO9qNTUZR2YGjGFjH/sR5dqzrbj05FUdqBoRlaxPyHenSt6mw/OhVFaQeGpnMR8+/s0bWqs/3oVBSlHRgaRVEURfHU0BTzJLdtHl2rOtuPTkVR2oGhWVrE/Jd6dK3qbD86FUVpB4ZmbhHzn+vRtaqz/ehUFKUdGJqXipj/Sx5dqzrbj05FUdqBoXkWOevdbxpN3lZRnR1Tp6Io7cDQ1AMPFiHvB0zeVlGdHVOnoijtwNAA3ArEfMw3BtxWwH2qs2PqVBSlHRiaJcAdPuZ7J7C4gPtUZ8fUqShKOzA0IKcf+uENNBfnJ0Kqzo6nU1GUdmBomoDTgQ0e5rfB5NHoIA3V2TF1KorSDgwNyFTKccA6D/JaZ9Je4kJaqrNj6lQUpR0YGoB3gYm4O50y16T5rotpqs6OqVNRlHZgaFI93AnA7TjzSoqZNCZ41KNVnR1Tp6IoJURon5m35Ltmb+Aa4Byg2mK6TcDfEVdWS15G8ydNzfzBzEprOT51qTOdJ99tzRvqsObM7191laXbZ516viOdE5/4gzWdM2ZkfPviiy+2Wjc8/93vuecefQKVgp4j38jyHCn2KLNwzWLgQmAKcCJwJDAeGAJ0NddsBZYDc4BXgGeABl+/iRiKC3nqUns6T77bV53GUFw469Tzbemc+MQfGnyuG6XxuyveYLWDZ7UjpqihaVecfHdJyJz4xB9KpUQbkAgCD+rj0mEZCnwPmAz0BdYD/7YzY1EghwJTgdHARuBfyF6srS6lvwdwHXAS0AP4ELgBeEF/cv8NzTDgWnJPofQyfwcBFyFTKPcj8/R+bdBTnRbQ6SrFJieYTkZN2nv9gfNNHf4G8KgH+U5Cgq9Gzf/3Ms/DhcBpwFsO0z8GeDhtdI5J/1/A4cDr+tP7Y2gqgRuB7wLl5r1VSEDE2cBCYLN5vzswAjgYON5UxAtMJbwT+BHg1Zi6ves8AdjTR52KDUa9dmug9GRd6yyM4aYxztYhqjIdoI/MaMBNbkwzMun0A140z+9rBaZ9LPCk0d+WiOkInqS123tDMwx4DBhr/j8LuNkMlxNZ7nkD+CPiyfZFMySdiCwoH4ds2HPbAymfzu7AZaaHAvAf4K4A6gxKeSpKOt8nvyNIOXC9Gd24ybgcn9WYkcfxwEyb6X4BeCKLkUmxj/707pLJvXl/0xCOReZCv2aGsf/K0SimkzDXHmbu3WrSmmXSdot8Oochi9TTkIXsI83rOeazoOgMSnkqweeL5ndvMqPfv5hRuVcca6Pxdpu6PJ93Ms/FUTbSPBJ4yoLx3KRVzVtDMwx4DugDLAIOMEPjQkiaew8w00J9TNrDXBoh5NP5B2BAhnsHmM+CorOQ8lzksk4l+HwbmWb9PDIN2w34OvBfZGrVC/aweF0vD/J+0cI11cA/LBq6wxGvSCuu+s9rdfPO0FQhi3q9zJTMJGCZC3ksM73xJSbtx/IMW/NhRedgk2c2DkPcdIuhM4TsUdnHvM5HCBiFeN6ETRqTXNSpBJ9LgV9lmYHYA++OXggV8Tv/FGixaGyeMqO9XM/7sxaNzFZkel3xyNBMQ+ZF65A1gPUu5rPeVIStyLTPNAdpWdFppZc/tAg6RyELp4uA+UholiE50hgCvI0stH5g/kaZtCabtJ3qVILNd0zDl6vRP6Edfu/FwHlmJG/F2DxpnrO2TLJhZFqBr+JtgNkObWiGIhvzUhV7qYt5VCOLd8uQhXlMXoVM+VjVWWEhrYocIzAvdIaQRcgRadeNRxYzh2ZJYya7rsPsY0ZJITOi+Y5DnUqwuRz4pYWRRXU7/f73I1OGVoxNpTE2x6e9N9EYmU4W7o8jDg16zLiHhmYq4ko4i8LXENrSHXgE2Gb+/o3sHp9l8irED/P7HujMVsHd1jkMcRdtS39TLkPbGJlXybzQu0+aUXGqUwkuVyCu7Famr95qx+XwW+Bii8amwnTmvoSsZT3Lrvt/8hmZR7TaeWdoaoGzzf9vtviDWjEyLwBnIH7pIcSD5QkgFVztbJO3VbzQmY2kyQPgLJd0xnPcMyDN2Aw1r/vneTDa6rRbnkpw+S5y8qkVIxNH9py0Z36H7COz4qVZbkb9z1p8HuKIN+fDWu28NTTHm6HlajPqcMvIZHK9PRBYaf6qkRhaVjnB3OOWznz82+js1GY4XqjOZYhrdT5j8wqZveVSvMeuzg//LrA8Fe/oCQwke3T0XEyxYWSSprf/Ugco0/uQNZu4RWPT2aKR+QYaXskXQ3O0ef2MxR5DoUYmvRKk5kGPtJH2US7qtEIiTefRLuk8A4kGkMvY5DIyq4Azc+g8Uqt0UdkfeBNZTP4EWMPOdTQrXAn83Eb9vIBdXfXbO38GzrVobKwYmW8i0cYVHwxNarf6bB+MzErkMKw3zf/H2UjfLZ12eLNN3k51LgWOyGNschmZI8gcDaCQ8lTcZTQSEuXgtPd6Ix5j+bzGAK4GrMakTxmZ+zpgOf/VjEKcGJu4GR39Tautf4YmtQi9oM1nZWSONVSokakHvowcirXIvLeXDa3ZdBaKlTWeRW3ydkNnIcYmZWSW5tG5l1bponET2b2/voPsg8lmbL6H7Bux2khegIQn8ppkQMv674gbciHGJlV+f9Eq66+hSc1lpkI+9EHcBOuQEPF/IfeimhUjsw3Z95Hyjtli/u1sQ2tbnblYa+EaK/uEvNJpx9iszGNkCtWpuEu+UCjfBu7OYGyuQaJyW20kz/fJyIBM/VmhGPtOHkIcYOycBJtAoj//Saur/4amLY8CJ5veWTkS5uJ5oIsDI3M8/obdnpun8m8E3g9A+Sddvk4JNpcAv04zNlOxvqs/Nd3zZx/1Wg3F8mKRynMJsN3m85bQalgcQ7PNvO6C7DqfmOG6g5G4Wl1cMjLd0j63SrrOfMTIva/kWos9Ia90plyYB1hIbwCyp2Yvl3Uq7vKyxeu+hewNuY6drv5WjMy5+D/dcyv5j6NoYaeLvZ+MN+1PVxv3RBDniXO1uvpvaFJTMiPIvYM23dg4Hcnsbf61E0stXacV7jOjsfTpqVXmPauLqHu3ydsNnanNmANspJkyNkPz6FymVbpoXA80Wrz2ImC6DSPzf8giuN8sRDYyZhs1NCFrJR/4rGucaX96FHBvythcoFXWX0Mz17w+BJlOWm3B2DidLjvU/DvXhtZ0nVb5GzDINPojzGs7niZu6xxG9h3/VozNK1mMTSE6FXeZj+yhanQxzdQ+j/uL+L2eMKOHe5H1wphpI+4z7z/qs56xpv3p6SCNkPk+F2m19c/QpDZ7ncjOoHKNeYyNEyOT2iRqZ7oB08imdFrdCNcJ8fi5xfx9B2txj9rqfMklnY/kMTIryb/P5mGXylNxn1fNb+GGsYmb0XcQ9nksQTaGDkTWbVNHOS/yWce+yHqQG8cShJApzG9rtfXH0DxrhsZ7IpGL/2MayUIeFisL/8eaBrMR2dRolWfMPSmd+egPvAP8Ajlj/DTz+h2LI4p0nc+6oHMv0wPMZWRSB7TlMjb7s+t6TaHlqXjDfxAPy+0O0oibDt8DAflOIeTMl5+ZGYGfI5GS/TxGYLTpSFkxMklgh8Xv9SvsbapVCjQ09ewMwXBdWq/c7jSAVe+y682/D5i8rVKf9uBdZ+H635N5nWSE+QyfdUZy3LPKGJilpveYz9hEXNCpeMdMY2waCjQyZyPuu0FgD2M8XwCuMgZwCnK65evYW2sslFE2jcwUJLCmlfYrhETIvkKrrbeGBsS7JIZ4nH0tbRrAqrGxamS+avKIUdhhTZl0ZhvN5Br1fDHPA+KFziXI4momI3MEuzocLCH7PpuF7IwO4FSn4h2vmWfCjrFpNUYmKFGEOyGx9CZl+fwQYwC83L+1j8mjt8XrrzQzFy/YNDZ3mnsVDw3NEiSQH0i4jCE2jI1VIzPEDFMxP+riAvRm05kpr3wM8llnEpm++yjtuneR0/8yebUtRY6fndPGyJxm0trLBZ2K98ZmssWRZixgRgYkivSYPNcMQyIbeMEAY2T62DAyd6b9/2XTflmdxpyB7HVSPDI0IKc0zkX80p9P60HkMjapHf/5jExv0zPqavKY5kBzNp3prLSQzuoi6JyPzDUPN9MBnwOW50hjGbImsy8y5TfKpOGmTsVbZplnZJsFI/NowLSfbfG6r3iQdwiZ0u9r8fqr0zp36byKvWnMu9CYgZ4amibgdGRH/TAkKOS+aT/W8ey62z517PEbefLYFwn6uLe5/3SceeXk0pniY9ObzPXwLy+SzqQZfXyEtR3/SeQo50XIruYxJq1hLulUvOd18/xkCku0wzTojwVQt9VTW4d4kPcX2Om2n49ryB2Q1M7IMoIcXKh4ZGhSUz7HAetM5XkDWQcAWRAchoSnOdZ8ni+S8tdMGnuZNI8jc/Rhu+TSmeK8LCObley+M7iYOu3wNdNoDXFZp+KPsZmA7EupM9M5LyDrH48FVPMmi9dt8SDvYy1eNxVrAUlnmefFSqzEL2h19dbQgKwbTDRTMrWIO2O6F83T5gFpzJHmZHPPX00ac02a77qoPZfOsGmA90OmlV41f9PMe0sCpNPKb+SHTsV7UmtsXZEjho8F/hdgvcWMdWZlQ+Z12HOCecOisemiVdVdynL0xCcgR8ROMb2uScAKJDLAG2b6J9Xj6Y6sOxxiGsWB5v0YMm/6I/LHTCp0xJBP5wvsdN/ujuwRCqLOTOV5qNE5wCedipLOrchR5pU5rvEq1tlHeT6/Aeux4tKZDRxjjGjXLNdohA2XCe0zM+9vtTcyB3oO2c/baEsTsqP5Nix6Q82flCUG5sxKq9/FF50clqV9v+qqYOmcMUNrt1I4O5+7U81IulOWevkN0p0YDnPY/9n5HPVAYqi1dQZIkH9NxgrjgKfY3fs0DpxEapO2PkeejmjSWYyc4TDFjAaORHa4D0nrEWxFFtfnIJs9n6GwzWpOUJ2K4j6pWGffQ6ad+iKOQM+bjo9XYWg2Ia7/M8wz0oJMH9+GO6fsvo8451yBeNX2Mc/mT7EXckqxYWgms/Ps8fORXb9nmh+5GtkA9QQyBfVgEfWqTkXxn1SsM79ZbEYXXtGARNGerj+xt6Smzj5FQk2AnKrXD9jMznNOUryKrDO86rYQi1NnRddpceqs+Dp1yK+UItanoP1BnyNXDU3b/Rwhcu/xmGkaSMfRgrMamMzGpmg6Lc0973xIiqdTHwxFUQJGuMD7DkPmMV9DPDiCiupUFEUpUUOTYiKyKPg6slAYVFSnoihKiRqaFIciC96z2XkIVxBRnYqiKCVqaFJMAP4J/Bdx3Q0F9HurTkVRlBI1NCkOBP6BhNc4KcANpOpUFEUpUUOT4gBk9+07wCkBbiBVp6IoSokamhT7IRsU30PC2tcEtDxUp6IoSokamhTjkLhI64BLA1wuqlNRFMUHQxP3MN9qJAKxG6hOd3UqiqL4Zmi8DOIYY9ezvZ2gOt3VqSiK4iplPuc3F7gdOSNmfYDLRXUqiqKUmKF5Azmk6J/kjvlVbFSnoihKiRma55BT+v4T8HJQnYqiKCVkaBLA48jxru8F+LurTkVRlBIzNC3A3/D21D3VqSiK0gENzXbg98jpkSsD/F1Vp6IoSokZmi3A3cixxBsD/B1Vp6IoSokZmrXAz4HfAvUB/m6qU1EUJeCGZivQJe3/y4CfAn8CmgP0HVSnoihKgMkVGeAyZI2gHnGpHWF63UFrFFWnoihKiY5o/mH+go7qVBRFKdERjaIoiqKooVEURVHU0CiKoihqaBRFURRFDY2iKIqihkZRFEVRdiWU/E8Fo0LTPgX2MO+tnZ+ctofvSg7Lsp1kZmX6/3bRmfY6WDqfunRXnSffHRydiqIoRRrRXGAa7tXA+QHWqzoVRVFKcUTjwEg9D4SAY5BzU7we0ahOHdEEkilXrPUzu0OQI7yHAzOBKXf8ou+qYuls2B5mwIAYx03eSjwO8Xgo9VE34FFgLHLc+LkTJ47a4YXObdsijB7dxJFHb6OxMUzS3rmzruls2RGiulOCE760lepOCVp2hNws6oJ1Fhsn0ZvPAI42r78MPBTQ76g6lfZEGXAHMMH8/xRgA/DtYgmKhGFHc4jWVohEIB7/7KOngEnm9dmmE3V2AMtUdXqME2eAi7O8DhqqU2lP7JVmZFKGp6iNTUV5gk2byti4sYyqqs8G4kPTGsUUpwWwPFVngA1NH+DwtP8fZt4LGqpTaW/0zvBe16I2ImXQ3BxmyeJKQjtblJ4ZLo0HsDxVZ4ANzalABJgPLDCvTw3g91OdSqnRBTgPuBQYk+HzUIC0HgGcQhKqq+OsXFHBpo0RKisTIEeRt6XVSzGhUB6dmfFdZ97yDL5O3wzNmebfR4CHzesvB/D7qU6llKgBbgamAz8BbkMW/NNJBkTrr4FXgCeAuRUVyZ5btkRYtqySikr/JaYW/8Ph3DqzjAwCV54B1umboRmITO2AeEA8Yl4fDgwI0HdTnUqpMQlZ1O+LeBhNBs4NoM7jgEvS/j8GmBEOw7o1UVpjoVyjC08oiyTZVh8mFttlZJNRZ6mUZ0c3NNciUztzgA/N33vmvakB+m5tdX5QAjo/CLBOxXsOyfDeoQHUeUSG9yaEw5BIiNeZ34amsirBmk/LWbMmSk1NPDXCyaizVMqzIxuak4Bvmdc/Ar5o/m40733LXFNsMumkBHQSUJ2Ku0SyvF9u49piEsvw3g6QqatQEVaRysqguSnM4oVVhMPJlIasOkulPDuiobkQmdYJA38GnjY97qmIf/efzGePmGuLRTadlIBOAqhTcdfA7Ad8BTgggxHJtLhRrDWZPoj77OAMn8UtvuebzmSSwTU1cZYvq2Dt2ijV1Ymi6QyF5C9ZmuVZFENTARwPvAzca3pczyD7PA5B1hEON68vNp+Vm2tfNvdW+PA9rOhMEVSdbSmmTsUbJpvf9PfIsd4nBlTnocBi4DHz7wmloLO8InnCtvoIixdWEo0W32ciVHrl6d2I01T+84D+QNS838181jdtOB8DbjXTOnF2XT+4FnHLO8VMAU0FjjR/LUjcr1ZgS1paq4A/As/aeEid6sToCaJOfNapeDNiCZtRSCbX0+lAP/O6CvEqeyZgvdcw8CBQm9ZGPAp0B5qCrDOZ5NFoWbL7+g3RpuYdIVJrRr5WgDLYvj3M9u0hunZN0LIjUirl6bmheRhxq8zGZuBxxAtigXlvFPCltGtOMu/NB34I/B24ygwVuyOeVZk4Lu0HyEchOke30Zk+LA2Szmx4qVNxl1rgeuBgYDnwY/Nvih5IjKp0RiBurOt81noVEu5oBXA5u+7R6Mfu3o6VwEjESSXQOiPh5MhkkvcS8RChUBKfth19pjMSSV5eXx9p+eTjCgYMaAlaeRbV0PwWuNr8f7lp2NaZXtla4CPT4NUi88rDgYva/IIh4G4zxbPI/F2ILGbvY3ryIWSe8sfAEHPfvTa02tH5OaPzwjw1bUERddrBC52Ku0xBNlnWABOR3fqnszM4aqcs91X6rPNaM5JOsTc7Y+xBZoeE1Ggt8DqTEPHZIWE3nRXlyaM/Xl7JmLFNRKPJ8lgsFITyLLqhuQbxcLjONFiXmQdklRkRPG96XnvmSesIdnXTWw0sND2RF41Vv8nkkUQ2pv3AhlYrOkemTU3YIc5O12IvdTrFTZ2Ku1ycNpKNINOeg9JGNdmaPr8XE65r8/+jzEhrblody1b3VKcFndHy5NimpvDchoYwvXu3xrMYmnhHejhS88k3INGD64GDgHeRRfQPjZHYs4C09wReMmkcArxj0q43ed1g8yGzorOfw/LwWqdbuKFTcZd+ed4Lym9TleG9/gEsz5LVmUzSPxIRF+ukPpGfGZoUjyObhBYAvUzDvR9wCzCtgLSnmV7255CzE3qZEc4Ek1ehuK0zhV86neK2TsWf5ysoZNqf0aI63dcZCukDkO1B+Mj0lucA1ciZKFWIZ9R0G+nebO6pBh5A5qffRxZKP3JBdyad1QXoTO+V/N3onOODTie9Jy90Kt6QLBFNqrP96wxcj2srspN+PbIAd5l5/wbgLgtp/grxvsHcO8ykdaxJ2y3a6vyOTZ3pXG7SWG/S9ENnIXipU1EUxdeh/Xp2hkH5Ttp1cyyk+V5a2pea1zeaNN3GiU4CoJOA6VQURfHN0AD8BdlQNAA40Ly3j4U0U9ccaO5tMml5RaE6CYBOAqhTURTFN0PTAMw2rw8y/46ykOaoNvfMNml5RaE6CYBOAqhTURTFN0MD8LH5d2CGBnwJslP9NPO6raEZ2CYNL7GiMxupe5YXQacd/NSpKIrim6HZbv6NIJ5Og4CNyCL/aOQ0uCfM68vMZ4PMtZG0nrzXWNGZjUibNPzSaRc/dSqKovhmaIaaf9eYxvs2xOvpV+zq095i3tsbuN30vteYz/by4XtY1ZmJlM5hPuu0i586FUVRXKMsx2flyNGyAP9FAmZ+HwmzcQayZtDHfL7OXPMcO6Ml9zb/TkSiGMc8+g6F6mxIuweThp86U9QgwTCDolNRFMU3Q/N50wjWAW8gmwW/j+zl6JLlnjrgl8gu/TfM/7sYY/OKR99BdSqKopSooUkdzvM8srj+ADvdhj9FwqCkFqaHAMcgsZ1+YEYSZ5l7v2zS8qphVJ1KUAlleY2F93HpekUpCUPTF3GprUQW2K8G/sbu0UcjwNeAn5kG9C12TvecwM7Q+V414KpTCRrpoUiyRetNtPnN8z2jTsObRPO8V2bhvvJsn6fF94rabG981Zknn/aos6hkcwYYhITcB1kTqDQ96PHI+fbZzrj+s7nmFXPPYeazkSZNt1GdSlCoy/DehrTX29oYlZTRSPfKzHQA2uY2/88UEWKrDZ2ZjFlDG52ZSH8/li3dROKziMV1DhtGT3Xm+d3ao87ijmhmhd/d7c2Jif3T96G0IscJ3zor/K6Vg1FXT0zs/wVk/WFaWmGMmhV+95MMeTnRn1Fnhgc6o04go07gE5fLuVR0lhyzZs13dP/EiaPckvIAcEHa7/MWsLRNw/I0cDI7p7+eZedx3CDHaqxjp1PIduDJNvksM2lPSKtPD9jQ+ZAZKadYC/yvjXF8AZm6TfEBu54G+whyoF86fw2FksQTIRKJEKFQciGE5rLrqaIvBkFnm/8vRM64ae86AzmiWWJ6Uq8Ch84Kv3uzRSMjD3/43cSs8LvTgUNNGpvZdVOnW+yiE4kabeeU8AQS7Vl1Kk6ZbozCemAWcKUxAulch6yzrTdG5Zo2n8811yw0HYzfAfe3uaYVOc1zlknnSVOfrHIBsq9ss8nvKHYPdf8Vo3OzyWdym88/AM5BNiBvRE7XvSUUgkQilH4Gy5dMo7sZ+HebBrloOjPk1RF0FndEk8VQLEbOOP+MjRsX1SBrA0ea6Zwh7PSWqkMWsueYaZ5/9uw5vGFW+N3/mesd8+TmBzO9vYvOUChEMpm0pdMMc/PqPKX7Wa7pNNjSGQ6HGxKJhHs6n3wy62emHAmHwyQSiULKMy+nnHKKqxW5kPrp8rO0CnHUyMVHiCt7rg7FfebPK3aQO1IGZpT1RQsjuAcAGraHGTAgxtlf3UQ8DmknStabv4RpHLd7pXPbtgijRzdx5NHbaGwM09IS2k1nDlzT2bIjRHWnBCd8aSvVnRI0NYVtl6cXOp2O/G1yCLKfcjgwE5hSZuEBHgZcC6Gzy8urO0WjnYhGKwmHo4RCMiBKJhO9E4lY71iseUIstv3ilpbG7Rs3LnoAuK1nz+F+9byHAddWVFSe06NH7+q+ffegS5daKisriETCvPnmgow6IfkAssHTV53ZyvOQQ0YSjyd6Nzfv6F1XVz9h/fp1F69fv6axtTX2oOnl+Knz+2Vl0bN69uxd3bt3b7p160KnTtU0NcVYtmwd9fXbfSnPjz7aeeROeXk54XCY1tZWamtr2bhx0bBIJPL9aLT8rJ49U797Z6qrqygrk/rZ2pro3djY1LuubtuEtWvXXLxx4/rGLVuWPhiPx29Zu7b7kvr6esrKykgkErS07Nzfu88++xBAyoA70qbOTjHTM98ulqBIGHY0h2hthUgE4jtXHJ9i596xs82U4dkBLFPV6XH9LMthYCqBaaFQeEpVVbfyysquhMORLD3gCOFwhLKySqqqupJIxDs1N2+9oKlpyzc2blx0J/Cjnj2HN2e8+bDm3LJTn2fvgVcC02pqaq8cOHCv6MCB/ams3NVBI5lMEgqFcupMJhN3ImsnnurMV56RSJiysggVFVG6dKlh4MA9iMX2rV6x4tPzPv54ydfr67fd4UhnfiqBH1dVVX934MDB0UGD+lNdvetZbS0tccLhEOGwg/J0yIcfflgJTKuu7nTlgAGDo4MGDaCyspxQKLzbyYbl5WHKy2vp0qWWAQP2oLm5pfqTT1aet3Llx1+fPXv2HcCPxo0b10xpsFfaQ5x6sM8upqGpKE+waVMZGzeWMXhwC7FYBCQKxqQ2l54WwPJUnT7Uz7IsRmYo8GhFRe34Tp16EQ7bc24IhyNUV/egsrJL+fbtG67ZsaP+2I0bF33Zg9HN0HA4/NigQUPHDR8+jKqqCsc6zfTHEg8qScHlGY2WMXToQAYO7BddtGjpNR9/vGRyLBY7zQud4XD48X79BowdOXI4NTWdAlme77///tBQKPTYnnsOHDdy5AiqqysJh/Mf8RMKQSgUprq6khEjhjJgwJ7RBQsWXrN69Yovvv/++2eMGTOmFNa9emd4r2sxBYXLoHlbmCWLKxmy12cjwp4ZLo0HsDxVpw/1M5zByOwPvF5T03t8be0ethvFXRueMmpr96Cmpvd4YJZJ2y32j0ajb4wf/7lx48aNtm1kcukEXNXpVnlGo2WMHj2C/fc/aExlZeUbbuuMRqNvjho1Zuz48WNsGxm/ynPevHn7R6PRN0ePHjduzJjR1NRUWzIyu2sMU1NTzZgxoxk9ety4aDT6xrx58/YPwIPaBTgPOeRuTCZ7GaBG5QjgFJJQXR1n5YoKNm2MUFmZgMwxBlu9FBMK5dGZGd915i3PYOssqH6G2xiZYcBztbV79KmsdK+TVFnZldraPfoAz5k8nDIsGo3+e7/9Duo9cGA/T3TiTvBKT8pzjz16cdBBh/SqrKx83i2d0Wj0hX33HddryJBBlJWVBbI8Fy5cOCwajT6/777jew0e3J+KinLn0z4V5Qwe3J999x3fKxqNPr9w4cJiBi2tQTzIpgM/Qda6hre5Jijn0f8acax4AphbUZHsuWVLhGXLKqmo9F9iytMtQ59jF51ZRgaBK8+A6iy4fobTjEwV8GhNTe9eFRW1riusqKilpqZ3L+Axk1ehVIXD4cf23Xe/nv369fJUJxKPrGCdXpZn9+5dOOCAg3qUlZU94VRnOBx+bMSIUd3799+DSCQcyPJcuHBhFfDoyJH79thzzz6uGUOAsrIy9tyzLyNH7tsDeMzkVQwmIWstfYFuiBvsuQFscI4DLkn7/xhgRjgM69ZEaY2Fco0uPKEskmRbfZhYbJeRTUadpVKeAdRZcP1Mb1WmVVTUjnOz552ph1tRUTsW2XhYKNMGDRo6duDAPQKv0+vy7NWrO3vvPXLfcDj848KnG0I37rnnwLEDB/YnEokEsjzLy8sBpvXvP2jcgAH9XDUyO41NhAED+tG//6CxwDSTp98ckuG9QwPY4ByR4b0J4bBEBojH8d3QVFYlWPNpOWvWRKmpiadGOBl1lkp5BlBnwfUzbEYzQ0Oh8JROnXp5rrRTp96EQuEpBU6hDa2pqb1y+PBhhDyuySmdBU75+Faew4btRW1t5+8WqrOysmrKiBF7U14eDWx5zps3b2hVVdWVw4cP91RneXmU4cOHU1VVfeW8efO8nELLZtHLbVxbTDKFTNkBMnUVKsIqUlkZNDeFWbywinA4mdKQVWeplGeRcL1+pkY0U6uqukWdLFRbJRyOUFXVLcrOc2vs9L6nDhy4V5mThX8/dPpZnpFImOHD9ymLRCLX2f+O4esHDBhUVlVVGfTf/bqBA/cqq6mp9lxnTU01AwcOKQuFQtd59ADvh+wUPyDDQ5ppfrtYazJ9EPfZwRk+i1t8zzedySSDa2riLF9Wwdq1UaqrE0XTKd6Nu/1wpVCentXP8MaNi2ohdLaXUzyZplIgdJbkbZna8vKKcwYO3NN3nYAtnX6X5x579Ka8vOIrdnVGImVfGTx4oGdTZm6U55NPPlkbiZSdNXjwQMJh77vK4XAIKZOyrzz55JNuL65NBp4Bfg/8AziRYHIoEs3iMfPvCaWgs7wiecK2+giLF1YSjRbfZyJUeuXpWf0MA8eXl1d3yrYZ06vebXl5dSfgeBu3Hd+zZ+/qysrywOv0vzxD9OvXv9quzl69eldXVlYEvjx79epT7ccodqdBrKBXrz52yzPVI4ySParudOSMoSpgD8RrJ2hTY2HgwbTOQBnwKM4cTnzRmUzyaLQsWbV+Q5TmHSHCYf9FRcpg+/Yw27eHqChPBK08i1Y/w8DR0Wgn37+xyfNoG7cc3afPHiWhsxjl2atXb9s6e/fu7flalxvl2bdvX397oiEwedrRWWse1BeQYJhD2nzeg10j7wKMoDhurFchkaN/y+7z7v2AAW1tLzuPuQi0zkg4OTKZhEQ8RCiU9F1nJJIsb2wM88nHFYTDySCVZ1HrZxkwtqyswvcaZPIca+OWsZ0715aEzmKUZ21tp3Zbnl27dvFdp8nTjs4pyCa2GuSo7a7A6eyM0p2t91Hp81e7FjmiIsXebQxqeY7ecOB1JiHis0PCbjorypNHf7y8kjFjm4hGk+VpQUaLWZ5FrZ9hYGgk4r8rp8lzqI1bhlZXV5SEzmKUp9m8aLM8q30f0RRSnlVV/s8ymDzt6LzYPMSpRuQUdj2cLltB+72Y0NbJ4ag2BjXbInRcdVrTGS1Pjm1qCtPQECYaTQZFZ1HrZxjoHC7CZKbJs7ONWzqHw2GSyaTtv0Qi6bvOUijPaLRwr7iUgZJgpdb/jOOBLZ2pKMz+jrxsl2e/PO8FZUd/Jqvdn+BRsjqTSfpHIuJinUwGRmdR62fJHAUKMHv2AoIV6ik4JBIJ3/KqqalizJjCTpKOx+M888yijvKzhAOoaQe7nz/fojrd1xkKaf1Mz2ibn41Um4Zxm41bVGcOWlpitnXGYoXH5LM7kkn9tbbGbetsbfW/PE2e2xwmkwxg45JUnR1SZ1HrZxhYGo/731EweS61cYvqzEF9faNtnY2NjSR9HNsnk0kaG+3rbGpq8r08TZ5LURTFFUMzt7XV/2gH8fgOkCilVlGdOdi8eYttndu21fuu0+RpS+fWrXW+6zR5ztUmQlHcMTQvxWLbfc+4pWU7wEs2blGdWUgkkqxZ86ltnevXr/d9RLN+/XrbOteuXevromoyCWvXrrWrU1GUHIbm2ZaWxu2JhH/edolEnJaWxkZkk5NVVGcW1q/fSkPDVts6N2xY39jc7N/oq7l5Bxs2rG+yr3NdEXSus6tTUZRshqZnz+H1kHywuXmrjw/yViD5gORtmaLplLyDqTMeT7Bs2XISibhtnfF468OffLKSeDzug844klfrQ3Z0nnLKKfXxeOtDH3+8wpGbup3R4ccfryAeb33wlFNOqdcmQlHcGdEA3NrUtCXmRy88kYjT1LQlhsTRsYvqbMOKFevZuHF1QToTicT0FSs+bm1qavZcZ1NTMytXftyaSCRutntvMpm8ecWK5a0NDY2e69y+vZEVK5a3JpPJW7R5UBQXDU3PnsOXJJOJO7ZvX+/Dg7yeZDJxZ8+ewxcXcLvvOpFoq4HUuWlTPYsXLyCRiBess7m56Y6FCxen3KM9oaUlxsKFi2lsbLyjEJ1jxoxZ0tTU+PNFixb5orOpqfGOMWPGLNbmQVHcHdEATNuxo36ul1M+zc1b2bGjfi4OT65UnbB163bmz19IY+NWRzqTyeSPVq9eMW/FilWeTKHF43FWrFjF6tUr5hWqs6WlBWDaqlWfzF258tPUXhxXaW1tZeXKT1m9+pN5wDSTp6Iobhqanj2HNwGnNzSs37Bjh/tT0zt21NPQsH4DcHrPnsOdzIH4phMIpM716+v44IOFbNq0yhWdiUTitIUL529etWoN8bh7myPj8QSrVq1h4cL5mxOJxGlOdI4YMaIJOH3Bgg82rV691lVj09oaZ/XqdSxY8MGmZDJ52ogRIxq1aVAUb0Y09Ow5fAlwXH39mnVu9sSbm7dSX79mHXCcycMpnus0eQRKZyzWytKla5g/fwEbN65wVWcsFjvmgw/e37h8+Se0trY6TrC1tZXlyz/hgw/e3xiLxY5xQ+eIESOWxGKxYz/4YM6Gjz9eyY4dzkcdO3a08PHHK/nggzkbYrHYsSNGjFji4vMVyvIaC+/j0vWKUvT6uVusm549h78LTGxoWD+3vn4NiUThjU4iEae+fg0NDevnAhNN2m7hmU6TdmB0xmJxVqzYwJw5y1i0aD5bt67xRGcsFjtk/vx5H8yZM4+GhsL3AjU0bGfOnHnMnz/vg1gsdoibOseMGfNuLBY7dP78ufPmzfuQhobGguK8JRIJGhoamTfvQ+bPnzsvFosdOmbMmHddfpDT3eSyDcHSxWcKHV+WI81CiOZ5r8zCfeXZPk+L7xW18F2KpjNPPu1RZ1HrZ8agambUMWHHjvrbt2z5ONbYuAk7HlSJRJzGxk1s2bI8tmNH/e3ABJdGMplGDK7qdGmEULDOeDxJS0sr27Y18umnm5k/fyVvv72QhQsX8umnCzzXmUgkDly9esXPXn/99daPPlqUChljicbGRj76aBGvv/566+rVK36WSCQO9ELnuHHjliQSiYNWrfrk9jfeeL114cKlNDY2k0gkcm7sTCbFwDQ2NrNw4VLeeOP11lWrPrk9kUgcNG7cOKc6M4Uv2JD2elubhzb1UDak/X9dhjQ2t/l/Jg8TO8PlTI1FQxudmUh/P5Yt3UTis4jFdQ4bRk915vnd2qPOotbPrEJ79hzeDFy7ceOi3zc2brqmsXHzOeXl1dXRaCei0UrC4WgqND2JRIJEIkYs1kwstp2WlsYmSP4duK1A7zJbM17AtclkwpFOCvPacl3n7NkfBUHn95qaGu9dvHjB1KVLF5/ds2fvqt69e9OtWxeqq6soKyv7bHqssbGJLVvqWL9+PRs3rm9OJOIPJBKJW0KhkKc6R48e3VxbW3vt7Nmzf79kyYKpy5aJzr59+9K1axeqqqooK4sYnXGamprYurWOtWvXfqYzHo/fcvDBBy+ur3dlDe0B4IK0h/8tdo2Vtg14Gjg5bXrhWWBL2jUvmYe5j/n/duDJNvksM2lPSM1Smryt8hDwtbT/rwX+16bxeQE4Ju29D4AFaf9/BPhhm3T/GgoliSdCJBIhQqHkQgjNZdczZF4Mgs42/1+IhBpq7zqLWj9Dr732oSWVGzcuqgFOBI4ExiNHgXZN61EtB+YArwDP9Ow5vMFKuo890p07fpH9qN4pV6wF4PAjZ1stUFs621js7K1vUwVnnT056+cPPvAvACqrdpS8zlAoRDKZJBwOk0gkbOkMh8MNiUTiszSc6sxH/wGDHNXPVSs/yZtHLp1p9bQ/cAdwGLAIOXnxjTaX7WOu2Q+YB1wOzG8zw/BN4BpTPx4Brmd3J4pDgNuB4cBMYModv+i7ykp5TblibYVpdA4HVgFnAR+1uawbcs7954y+s8216ZwN3Gx0PgR8Z/v2MHv2j3Hc5K0kEhCPhwYCjyIHyP0POGfixFGbvdS5vSG8qv/AFo6bXEc8DvF4aDedGbJzVWcsFvooGk0y+YSt9OjRSlNTuKDydFPnrFnzi1o/Q9+9fE034H7gWKwdL9oCPAycf/qXN7cYY1GJnEP9lSxziW1pNVb+bKDOiqExlaognUDLhIPfAzmWtGCdFhtGRzrNe6rTBZ39BwxqMcbEM52KouQnDPwCmIz1M6zLzVDx+sce6c5jj3QH+IF5L2oxjTKT5502tBasM+091dmBdK5a+UlqxOKHTkVRchiaQrtr6fcd50Iabl6rOlWn3zoVRclhaHoWeG+ftNdupJEP1ak6g6xTUZQchkZRlCzo+oyiqKFRFEVR1NAoiqIoamgURVEURQ2NoiiKooZGURRFUdTQKIqiKGpoFEVRlHZlaOoKvDc9mJsbaeRDdarOIOtUFCWHoXm0wHsfS3vtRhr5UJ2qM8g6FUXJQhlwFVALfAFrx3a2mgfw9rT3bgX6IefXWwl+mEDOUvieDa2qU3UGWaeiKDkMTR0SPt0JLcC3zJ9XqE7VGWSdiqLkMDQdgrdm7+c4jbPO9jZ9t/BDpznfR1EUxZKh6QLci/WpiTgyNXE5Ow/AKgfuAk6zODWRRA6WuhjrC7WqU3UGWaeiKDkMzQzgTJv3XYwcRXqT+f9U4CKbaXwFOafa6n2qU3UGWaeiKFkIA2cUeO/paa/dSCMfqlN1Blmnoig5DE2XAu/t3mZ6w2ka+VCdqjPIOhVFyWFoFEVRFEUNjaIoiqKGRlEURVHU0CiKoihqaBRFURQ1NIqiKIqihkZRFEVRQ6MoiqJ0BEOzscB716W9diONfKhO1RlknYqi5DA0/yrw3mfTXj/nQhr5UJ2qM8g6FUXJYWguNw9zq8V7WoC/Ajenvfdj4G/sjJabj1bzEE+xoVV1qs4g61QUJQv/PwAlukJhy2ScjQAAAABJRU5ErkJggg==";ga={border:{"border-top":" iconfont luckysheet-iconfont-shangbiankuang","border-bottom":" iconfont luckysheet-iconfont-xiabiankuang","border-left":" iconfont luckysheet-iconfont-zuobiankuang","border-right":" iconfont luckysheet-iconfont-youbiankuang","border-none":" iconfont luckysheet-iconfont-wubiankuang","border-all":" iconfont luckysheet-iconfont-quanjiabiankuang","border-outside":" iconfont luckysheet-iconfont-sizhoujiabiankuang","border-inside":" iconfont luckysheet-iconfont-neikuangxian","border-horizontal":" iconfont luckysheet-iconfont-neikuanghengxian","border-vertical":" iconfont luckysheet-iconfont-neikuangshuxian"},align:{left:" iconfont luckysheet-iconfont-wenbenzuoduiqi",center:" iconfont luckysheet-iconfont-wenbenjuzhongduiqi",right:" iconfont luckysheet-iconfont-wenbenyouduiqi",top:" iconfont luckysheet-iconfont-dingbuduiqi",middle:" iconfont luckysheet-iconfont-shuipingduiqi",bottom:" iconfont luckysheet-iconfont-dibuduiqi"},textWrap:{overflow:" iconfont luckysheet-iconfont-yichu1",wrap:" iconfont luckysheet-iconfont-zidonghuanhang",clip:" iconfont luckysheet-iconfont-jieduan"},rotation:{none:" iconfont luckysheet-iconfont-wuxuanzhuang",angleup:" iconfont luckysheet-iconfont-xiangshangqingxie",angledown:" iconfont luckysheet-iconfont-xiangxiaqingxie",vertical:" iconfont luckysheet-iconfont-shupaiwenzi","rotation-up":" iconfont luckysheet-iconfont-wenbenxiangshang","rotation-down":" iconfont luckysheet-iconfont-xiangxia90"}}});function Me(e){for(let n=0;n<h.luckysheetfile.length;n++)if(h.luckysheetfile[n].index==e)return n;return null}function Kl(e,n,t){let l="";t==null&&(t=h.currentSheetIndex),e!=t&&(l=h.luckysheetfile[Me(e)].name.replace(/'/g,"''"),/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/.test(l)?l=l+"!":l="'"+l+"'!");let o=n.row[0],a=n.row[1],s=n.column[0],u=n.column[1];return o==null&&a==null?l+yl(s)+":"+yl(u):s==null&&u==null?l+(o+1)+":"+(a+1):s==u&&o==a?l+yl(s)+(o+1):l+yl(s)+(o+1)+":"+yl(u)+(a+1)}function $0(){return h.luckysheet_select_save}function ur(e){return e&&h.luckysheetfile.forEach(n=>{n.chart&&n.chart.forEach(t=>{let l=h.getChartJson(t.chart_id);t.chartOptions=l})}),h.luckysheetfile}function S0(){return h.config}function Kf(){return h.visibledatarow}function Jf(){return h.visibledatacolumn}var import_plugin,fr=Nt(()=>{import_plugin=qe(Ye());Ol();il()});function I0(e){h.luckysheet_select_save=e}function pa(e){h.luckysheet_scroll_status=e}function Ys(e){h.luckysheetfile=e}var import_plugin,gs=Nt(()=>{import_plugin=qe(Ye());fr();il()});var import_plugin,Rw,co,Oc=Nt(()=>{import_plugin=qe(Ye()),Rw={mobilecheck:function(){var e=!1;return function(n){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(n.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),document.body&&document.body.clientWidth&&document.body.clientHeight&&document.body.clientWidth<350&&document.body.clientHeight<500&&(e=!0),e},iphoneCheck:function(){var e=!1;return/iPhone/i.test(navigator.userAgent)&&(e=!0),!0},isWeixin:function(){var e=navigator.userAgent.toLowerCase();return e.match(/MicroMessenger/i)=="micromessenger"},isAndroid:function(){var e=navigator.userAgent,n=(navigator.appVersion,e.indexOf("Android")>-1||e.indexOf("Linux")>-1);return n},tabletCheck:function(){var e=/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase());return e},BrowserType:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,l=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1,a=e.indexOf("Firefox")>-1,s=e.indexOf("Safari")>-1&&e.indexOf("Chrome")==-1,u=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(t){var f=new RegExp("MSIE (\\d+\\.\\d+);");f.test(e);var m=parseFloat(RegExp.$1);return m==7?"IE7":m==8?"IE8":m==9?"IE9":m==10?"IE10":"0"}if(a)return"FF";if(n)return"Opera";if(s)return"Safari";if(u)return"Chrome";if(o)return"Edge";if(l)return"IE11"},isIE:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,l=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1;return t||l?"1":"-1"},IEVersion:function(){var e=navigator.userAgent,n=e.indexOf("Opera")>-1,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!n,l=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Windows NT 6.1; Trident/7.0;")>-1&&!t;if(t){var a=new RegExp("MSIE (\\d+\\.\\d+);");a.test(e);var s=parseFloat(RegExp.$1);return s==7?"IE7":s==8?"IE8":s==9?"IE9":s==10?"IE10":"0"}else return o?"Edge":l?"IE11":"-1"},luckysheetrefreshfixednum:null,luckysheetrefreshfixed:function(){var e=this;return e.luckysheetrefreshfixednum==null&&(e.BrowserType()=="FF"?e.luckysheetrefreshfixednum=5:e.luckysheetrefreshfixednum=0),e.luckysheetrefreshfixednum},detectOS(){var e=navigator.userAgent,n=navigator.platform=="Win32"||navigator.platform=="Windows",t=navigator.platform=="Mac68K"||navigator.platform=="MacPPC"||navigator.platform=="Macintosh"||navigator.platform=="MacIntel";if(t)return"Mac";var l=navigator.platform=="X11"&&!n&&!t;if(l)return"Unix";var o=String(navigator.platform).indexOf("Linux")>-1;if(o)return"Linux";if(n){var a=e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1;if(a)return"Win2000";var s=e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1;if(s)return"WinXP";var u=e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1;if(u)return"Win2003";var f=e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1;if(f)return"WinVista";var m=e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1;if(m)return"Win7"}return"other"}},co=Rw});var Wa=Fn(Ei=>{var import_plugin=qe(Ye());"use strict";var Fw=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function Mw(e,n){return Object.prototype.hasOwnProperty.call(e,n)}Ei.assign=function(e){for(var n=Array.prototype.slice.call(arguments,1);n.length;){var t=n.shift();if(!!t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(var l in t)Mw(t,l)&&(e[l]=t[l])}}return e};Ei.shrinkBuf=function(e,n){return e.length===n?e:e.subarray?e.subarray(0,n):(e.length=n,e)};var Dw={arraySet:function(e,n,t,l,o){if(n.subarray&&e.subarray){e.set(n.subarray(t,t+l),o);return}for(var a=0;a<l;a++)e[o+a]=n[t+a]},flattenChunks:function(e){var n,t,l,o,a,s;for(l=0,n=0,t=e.length;n<t;n++)l+=e[n].length;for(s=new Uint8Array(l),o=0,n=0,t=e.length;n<t;n++)a=e[n],s.set(a,o),o+=a.length;return s}},Aw={arraySet:function(e,n,t,l,o){for(var a=0;a<l;a++)e[o+a]=n[t+a]},flattenChunks:function(e){return[].concat.apply([],e)}};Ei.setTyped=function(e){e?(Ei.Buf8=Uint8Array,Ei.Buf16=Uint16Array,Ei.Buf32=Int32Array,Ei.assign(Ei,Dw)):(Ei.Buf8=Array,Ei.Buf16=Array,Ei.Buf32=Array,Ei.assign(Ei,Aw))};Ei.setTyped(Fw)});var Z0=Fn(Nc=>{var import_plugin=qe(Ye());"use strict";var zw=Wa(),Ow=4,T0=0,R0=1,Pw=2;function Pc(e){for(var n=e.length;--n>=0;)e[n]=0}var Ew=0,F0=1,Nw=2,Lw=3,Hw=258,Gd=29,Ou=256,Pu=Ou+1+Gd,Ec=30,Yd=19,M0=2*Pu+1,Xs=15,Xd=16,jw=7,Zd=256,D0=16,A0=17,z0=18,Kd=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Qf=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Bw=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O0=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Vw=512,qa=new Array((Pu+2)*2);Pc(qa);var Eu=new Array(Ec*2);Pc(Eu);var Nu=new Array(Vw);Pc(Nu);var Lu=new Array(Hw-Lw+1);Pc(Lu);var Jd=new Array(Gd);Pc(Jd);var eh=new Array(Ec);Pc(eh);function Qd(e,n,t,l,o){this.static_tree=e,this.extra_bits=n,this.extra_base=t,this.elems=l,this.max_length=o,this.has_stree=e&&e.length}var P0,E0,N0;function em(e,n){this.dyn_tree=e,this.max_code=0,this.stat_desc=n}function L0(e){return e<256?Nu[e]:Nu[256+(e>>>7)]}function Hu(e,n){e.pending_buf[e.pending++]=n&255,e.pending_buf[e.pending++]=n>>>8&255}function Gi(e,n,t){e.bi_valid>Xd-t?(e.bi_buf|=n<<e.bi_valid&65535,Hu(e,e.bi_buf),e.bi_buf=n>>Xd-e.bi_valid,e.bi_valid+=t-Xd):(e.bi_buf|=n<<e.bi_valid&65535,e.bi_valid+=t)}function va(e,n,t){Gi(e,t[n*2],t[n*2+1])}function H0(e,n){var t=0;do t|=e&1,e>>>=1,t<<=1;while(--n>0);return t>>>1}function Ww(e){e.bi_valid===16?(Hu(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function qw(e,n){var t=n.dyn_tree,l=n.max_code,o=n.stat_desc.static_tree,a=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,u=n.stat_desc.extra_base,f=n.stat_desc.max_length,m,d,p,b,g,v,x=0;for(b=0;b<=Xs;b++)e.bl_count[b]=0;for(t[e.heap[e.heap_max]*2+1]=0,m=e.heap_max+1;m<M0;m++)d=e.heap[m],b=t[t[d*2+1]*2+1]+1,b>f&&(b=f,x++),t[d*2+1]=b,!(d>l)&&(e.bl_count[b]++,g=0,d>=u&&(g=s[d-u]),v=t[d*2],e.opt_len+=v*(b+g),a&&(e.static_len+=v*(o[d*2+1]+g)));if(x!==0){do{for(b=f-1;e.bl_count[b]===0;)b--;e.bl_count[b]--,e.bl_count[b+1]+=2,e.bl_count[f]--,x-=2}while(x>0);for(b=f;b!==0;b--)for(d=e.bl_count[b];d!==0;)p=e.heap[--m],!(p>l)&&(t[p*2+1]!==b&&(e.opt_len+=(b-t[p*2+1])*t[p*2],t[p*2+1]=b),d--)}}function j0(e,n,t){var l=new Array(Xs+1),o=0,a,s;for(a=1;a<=Xs;a++)l[a]=o=o+t[a-1]<<1;for(s=0;s<=n;s++){var u=e[s*2+1];u!==0&&(e[s*2]=H0(l[u]++,u))}}function Uw(){var e,n,t,l,o,a=new Array(Xs+1);for(t=0,l=0;l<Gd-1;l++)for(Jd[l]=t,e=0;e<1<<Kd[l];e++)Lu[t++]=l;for(Lu[t-1]=l,o=0,l=0;l<16;l++)for(eh[l]=o,e=0;e<1<<Qf[l];e++)Nu[o++]=l;for(o>>=7;l<Ec;l++)for(eh[l]=o<<7,e=0;e<1<<Qf[l]-7;e++)Nu[256+o++]=l;for(n=0;n<=Xs;n++)a[n]=0;for(e=0;e<=143;)qa[e*2+1]=8,e++,a[8]++;for(;e<=255;)qa[e*2+1]=9,e++,a[9]++;for(;e<=279;)qa[e*2+1]=7,e++,a[7]++;for(;e<=287;)qa[e*2+1]=8,e++,a[8]++;for(j0(qa,Pu+1,a),e=0;e<Ec;e++)Eu[e*2+1]=5,Eu[e*2]=H0(e,5);P0=new Qd(qa,Kd,Ou+1,Pu,Xs),E0=new Qd(Eu,Qf,0,Ec,Xs),N0=new Qd(new Array(0),Bw,0,Yd,jw)}function B0(e){var n;for(n=0;n<Pu;n++)e.dyn_ltree[n*2]=0;for(n=0;n<Ec;n++)e.dyn_dtree[n*2]=0;for(n=0;n<Yd;n++)e.bl_tree[n*2]=0;e.dyn_ltree[Zd*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function V0(e){e.bi_valid>8?Hu(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Gw(e,n,t,l){V0(e),l&&(Hu(e,t),Hu(e,~t)),zw.arraySet(e.pending_buf,e.window,n,t,e.pending),e.pending+=t}function W0(e,n,t,l){var o=n*2,a=t*2;return e[o]<e[a]||e[o]===e[a]&&l[n]<=l[t]}function tm(e,n,t){for(var l=e.heap[t],o=t<<1;o<=e.heap_len&&(o<e.heap_len&&W0(n,e.heap[o+1],e.heap[o],e.depth)&&o++,!W0(n,l,e.heap[o],e.depth));)e.heap[t]=e.heap[o],t=o,o<<=1;e.heap[t]=l}function q0(e,n,t){var l,o,a=0,s,u;if(e.last_lit!==0)do l=e.pending_buf[e.d_buf+a*2]<<8|e.pending_buf[e.d_buf+a*2+1],o=e.pending_buf[e.l_buf+a],a++,l===0?va(e,o,n):(s=Lu[o],va(e,s+Ou+1,n),u=Kd[s],u!==0&&(o-=Jd[s],Gi(e,o,u)),l--,s=L0(l),va(e,s,t),u=Qf[s],u!==0&&(l-=eh[s],Gi(e,l,u)));while(a<e.last_lit);va(e,Zd,n)}function lm(e,n){var t=n.dyn_tree,l=n.stat_desc.static_tree,o=n.stat_desc.has_stree,a=n.stat_desc.elems,s,u,f=-1,m;for(e.heap_len=0,e.heap_max=M0,s=0;s<a;s++)t[s*2]!==0?(e.heap[++e.heap_len]=f=s,e.depth[s]=0):t[s*2+1]=0;for(;e.heap_len<2;)m=e.heap[++e.heap_len]=f<2?++f:0,t[m*2]=1,e.depth[m]=0,e.opt_len--,o&&(e.static_len-=l[m*2+1]);for(n.max_code=f,s=e.heap_len>>1;s>=1;s--)tm(e,t,s);m=a;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],tm(e,t,1),u=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=u,t[m*2]=t[s*2]+t[u*2],e.depth[m]=(e.depth[s]>=e.depth[u]?e.depth[s]:e.depth[u])+1,t[s*2+1]=t[u*2+1]=m,e.heap[1]=m++,tm(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],qw(e,n),j0(t,f,e.bl_count)}function U0(e,n,t){var l,o=-1,a,s=n[0*2+1],u=0,f=7,m=4;for(s===0&&(f=138,m=3),n[(t+1)*2+1]=65535,l=0;l<=t;l++)a=s,s=n[(l+1)*2+1],!(++u<f&&a===s)&&(u<m?e.bl_tree[a*2]+=u:a!==0?(a!==o&&e.bl_tree[a*2]++,e.bl_tree[D0*2]++):u<=10?e.bl_tree[A0*2]++:e.bl_tree[z0*2]++,u=0,o=a,s===0?(f=138,m=3):a===s?(f=6,m=3):(f=7,m=4))}function G0(e,n,t){var l,o=-1,a,s=n[0*2+1],u=0,f=7,m=4;for(s===0&&(f=138,m=3),l=0;l<=t;l++)if(a=s,s=n[(l+1)*2+1],!(++u<f&&a===s)){if(u<m)do va(e,a,e.bl_tree);while(--u!=0);else a!==0?(a!==o&&(va(e,a,e.bl_tree),u--),va(e,D0,e.bl_tree),Gi(e,u-3,2)):u<=10?(va(e,A0,e.bl_tree),Gi(e,u-3,3)):(va(e,z0,e.bl_tree),Gi(e,u-11,7));u=0,o=a,s===0?(f=138,m=3):a===s?(f=6,m=3):(f=7,m=4)}}function Yw(e){var n;for(U0(e,e.dyn_ltree,e.l_desc.max_code),U0(e,e.dyn_dtree,e.d_desc.max_code),lm(e,e.bl_desc),n=Yd-1;n>=3&&e.bl_tree[O0[n]*2+1]===0;n--);return e.opt_len+=3*(n+1)+5+5+4,n}function Xw(e,n,t,l){var o;for(Gi(e,n-257,5),Gi(e,t-1,5),Gi(e,l-4,4),o=0;o<l;o++)Gi(e,e.bl_tree[O0[o]*2+1],3);G0(e,e.dyn_ltree,n-1),G0(e,e.dyn_dtree,t-1)}function Zw(e){var n=4093624447,t;for(t=0;t<=31;t++,n>>>=1)if(n&1&&e.dyn_ltree[t*2]!==0)return T0;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return R0;for(t=32;t<Ou;t++)if(e.dyn_ltree[t*2]!==0)return R0;return T0}var Y0=!1;function Kw(e){Y0||(Uw(),Y0=!0),e.l_desc=new em(e.dyn_ltree,P0),e.d_desc=new em(e.dyn_dtree,E0),e.bl_desc=new em(e.bl_tree,N0),e.bi_buf=0,e.bi_valid=0,B0(e)}function X0(e,n,t,l){Gi(e,(Ew<<1)+(l?1:0),3),Gw(e,n,t,!0)}function Jw(e){Gi(e,F0<<1,3),va(e,Zd,qa),Ww(e)}function Qw(e,n,t,l){var o,a,s=0;e.level>0?(e.strm.data_type===Pw&&(e.strm.data_type=Zw(e)),lm(e,e.l_desc),lm(e,e.d_desc),s=Yw(e),o=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=o&&(o=a)):o=a=t+5,t+4<=o&&n!==-1?X0(e,n,t,l):e.strategy===Ow||a===o?(Gi(e,(F0<<1)+(l?1:0),3),q0(e,qa,Eu)):(Gi(e,(Nw<<1)+(l?1:0),3),Xw(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),q0(e,e.dyn_ltree,e.dyn_dtree)),B0(e),l&&V0(e)}function e2(e,n,t){return e.pending_buf[e.d_buf+e.last_lit*2]=n>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=n&255,e.pending_buf[e.l_buf+e.last_lit]=t&255,e.last_lit++,n===0?e.dyn_ltree[t*2]++:(e.matches++,n--,e.dyn_ltree[(Lu[t]+Ou+1)*2]++,e.dyn_dtree[L0(n)*2]++),e.last_lit===e.lit_bufsize-1}Nc._tr_init=Kw;Nc._tr_stored_block=X0;Nc._tr_flush_block=Qw;Nc._tr_tally=e2;Nc._tr_align=Jw});var rm=Fn((h4,K0)=>{var import_plugin=qe(Ye());"use strict";function t2(e,n,t,l){for(var o=e&65535|0,a=e>>>16&65535|0,s=0;t!==0;){s=t>2e3?2e3:t,t-=s;do o=o+n[l++]|0,a=a+o|0;while(--s);o%=65521,a%=65521}return o|a<<16|0}K0.exports=t2});var nm=Fn((d4,J0)=>{var import_plugin=qe(Ye());"use strict";function l2(){for(var e,n=[],t=0;t<256;t++){e=t;for(var l=0;l<8;l++)e=e&1?3988292384^e>>>1:e>>>1;n[t]=e}return n}var r2=l2();function n2(e,n,t,l){var o=r2,a=l+t;e^=-1;for(var s=l;s<a;s++)e=e>>>8^o[(e^n[s])&255];return e^-1}J0.exports=n2});var th=Fn((m4,Q0)=>{var import_plugin=qe(Ye());"use strict";Q0.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var sv=Fn(ba=>{var import_plugin=qe(Ye());"use strict";var Ni=Wa(),$o=Z0(),ev=rm(),ps=nm(),i2=th(),Zs=0,o2=1,a2=3,vs=4,tv=5,ya=0,lv=1,So=-2,s2=-3,im=-5,c2=-1,u2=1,lh=2,f2=3,h2=4,d2=0,m2=2,rh=8,g2=9,p2=15,v2=8,y2=29,k2=256,om=k2+1+y2,b2=30,w2=19,x2=2*om+1,_2=15,_r=3,ys=258,qo=ys+_r+1,C2=32,nh=42,am=69,ih=73,oh=91,ah=103,Ks=113,ju=666,Jn=1,Bu=2,Js=3,Lc=4,$2=3;function ks(e,n){return e.msg=i2[n],n}function rv(e){return(e<<1)-(e>4?9:0)}function bs(e){for(var n=e.length;--n>=0;)e[n]=0}function ws(e){var n=e.state,t=n.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(Ni.arraySet(e.output,n.pending_buf,n.pending_out,t,e.next_out),e.next_out+=t,n.pending_out+=t,e.total_out+=t,e.avail_out-=t,n.pending-=t,n.pending===0&&(n.pending_out=0))}function ki(e,n){$o._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,n),e.block_start=e.strstart,ws(e.strm)}function Dr(e,n){e.pending_buf[e.pending++]=n}function Vu(e,n){e.pending_buf[e.pending++]=n>>>8&255,e.pending_buf[e.pending++]=n&255}function S2(e,n,t,l){var o=e.avail_in;return o>l&&(o=l),o===0?0:(e.avail_in-=o,Ni.arraySet(n,e.input,e.next_in,o,t),e.state.wrap===1?e.adler=ev(e.adler,n,o,t):e.state.wrap===2&&(e.adler=ps(e.adler,n,o,t)),e.next_in+=o,e.total_in+=o,o)}function nv(e,n){var t=e.max_chain_length,l=e.strstart,o,a,s=e.prev_length,u=e.nice_match,f=e.strstart>e.w_size-qo?e.strstart-(e.w_size-qo):0,m=e.window,d=e.w_mask,p=e.prev,b=e.strstart+ys,g=m[l+s-1],v=m[l+s];e.prev_length>=e.good_match&&(t>>=2),u>e.lookahead&&(u=e.lookahead);do if(o=n,!(m[o+s]!==v||m[o+s-1]!==g||m[o]!==m[l]||m[++o]!==m[l+1])){l+=2,o++;do;while(m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&m[++l]===m[++o]&&l<b);if(a=ys-(b-l),l=b-ys,a>s){if(e.match_start=n,s=a,a>=u)break;g=m[l+s-1],v=m[l+s]}}while((n=p[n&d])>f&&--t!=0);return s<=e.lookahead?s:e.lookahead}function Qs(e){var n=e.w_size,t,l,o,a,s;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=n+(n-qo)){Ni.arraySet(e.window,e.window,n,n,0),e.match_start-=n,e.strstart-=n,e.block_start-=n,l=e.hash_size,t=l;do o=e.head[--t],e.head[t]=o>=n?o-n:0;while(--l);l=n,t=l;do o=e.prev[--t],e.prev[t]=o>=n?o-n:0;while(--l);a+=n}if(e.strm.avail_in===0)break;if(l=S2(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=l,e.lookahead+e.insert>=_r)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+_r-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<_r)););}while(e.lookahead<qo&&e.strm.avail_in!==0)}function I2(e,n){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Qs(e),e.lookahead===0&&n===Zs)return Jn;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var l=e.block_start+t;if((e.strstart===0||e.strstart>=l)&&(e.lookahead=e.strstart-l,e.strstart=l,ki(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-qo&&(ki(e,!1),e.strm.avail_out===0))return Jn}return e.insert=0,n===vs?(ki(e,!0),e.strm.avail_out===0?Js:Lc):(e.strstart>e.block_start&&(ki(e,!1),e.strm.avail_out===0),Jn)}function sm(e,n){for(var t,l;;){if(e.lookahead<qo){if(Qs(e),e.lookahead<qo&&n===Zs)return Jn;if(e.lookahead===0)break}if(t=0,e.lookahead>=_r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+_r-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-qo&&(e.match_length=nv(e,t)),e.match_length>=_r)if(l=$o._tr_tally(e,e.strstart-e.match_start,e.match_length-_r),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=_r){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+_r-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!=0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else l=$o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(l&&(ki(e,!1),e.strm.avail_out===0))return Jn}return e.insert=e.strstart<_r-1?e.strstart:_r-1,n===vs?(ki(e,!0),e.strm.avail_out===0?Js:Lc):e.last_lit&&(ki(e,!1),e.strm.avail_out===0)?Jn:Bu}function Hc(e,n){for(var t,l,o;;){if(e.lookahead<qo){if(Qs(e),e.lookahead<qo&&n===Zs)return Jn;if(e.lookahead===0)break}if(t=0,e.lookahead>=_r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+_r-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=_r-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-qo&&(e.match_length=nv(e,t),e.match_length<=5&&(e.strategy===u2||e.match_length===_r&&e.strstart-e.match_start>4096)&&(e.match_length=_r-1)),e.prev_length>=_r&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-_r,l=$o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-_r),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+_r-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!=0);if(e.match_available=0,e.match_length=_r-1,e.strstart++,l&&(ki(e,!1),e.strm.avail_out===0))return Jn}else if(e.match_available){if(l=$o._tr_tally(e,0,e.window[e.strstart-1]),l&&ki(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Jn}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(l=$o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<_r-1?e.strstart:_r-1,n===vs?(ki(e,!0),e.strm.avail_out===0?Js:Lc):e.last_lit&&(ki(e,!1),e.strm.avail_out===0)?Jn:Bu}function T2(e,n){for(var t,l,o,a,s=e.window;;){if(e.lookahead<=ys){if(Qs(e),e.lookahead<=ys&&n===Zs)return Jn;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=_r&&e.strstart>0&&(o=e.strstart-1,l=s[o],l===s[++o]&&l===s[++o]&&l===s[++o])){a=e.strstart+ys;do;while(l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&l===s[++o]&&o<a);e.match_length=ys-(a-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=_r?(t=$o._tr_tally(e,1,e.match_length-_r),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=$o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(ki(e,!1),e.strm.avail_out===0))return Jn}return e.insert=0,n===vs?(ki(e,!0),e.strm.avail_out===0?Js:Lc):e.last_lit&&(ki(e,!1),e.strm.avail_out===0)?Jn:Bu}function R2(e,n){for(var t;;){if(e.lookahead===0&&(Qs(e),e.lookahead===0)){if(n===Zs)return Jn;break}if(e.match_length=0,t=$o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(ki(e,!1),e.strm.avail_out===0))return Jn}return e.insert=0,n===vs?(ki(e,!0),e.strm.avail_out===0?Js:Lc):e.last_lit&&(ki(e,!1),e.strm.avail_out===0)?Jn:Bu}function ka(e,n,t,l,o){this.good_length=e,this.max_lazy=n,this.nice_length=t,this.max_chain=l,this.func=o}var jc;jc=[new ka(0,0,0,0,I2),new ka(4,4,8,4,sm),new ka(4,5,16,8,sm),new ka(4,6,32,32,sm),new ka(4,4,16,16,Hc),new ka(8,16,32,32,Hc),new ka(8,16,128,128,Hc),new ka(8,32,128,256,Hc),new ka(32,128,258,1024,Hc),new ka(32,258,258,4096,Hc)];function F2(e){e.window_size=2*e.w_size,bs(e.head),e.max_lazy_match=jc[e.level].max_lazy,e.good_match=jc[e.level].good_length,e.nice_match=jc[e.level].nice_length,e.max_chain_length=jc[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=_r-1,e.match_available=0,e.ins_h=0}function M2(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=rh,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Ni.Buf16(x2*2),this.dyn_dtree=new Ni.Buf16((2*b2+1)*2),this.bl_tree=new Ni.Buf16((2*w2+1)*2),bs(this.dyn_ltree),bs(this.dyn_dtree),bs(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Ni.Buf16(_2+1),this.heap=new Ni.Buf16(2*om+1),bs(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Ni.Buf16(2*om+1),bs(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function iv(e){var n;return!e||!e.state?ks(e,So):(e.total_in=e.total_out=0,e.data_type=m2,n=e.state,n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?nh:Ks,e.adler=n.wrap===2?0:1,n.last_flush=Zs,$o._tr_init(n),ya)}function ov(e){var n=iv(e);return n===ya&&F2(e.state),n}function D2(e,n){return!e||!e.state||e.state.wrap!==2?So:(e.state.gzhead=n,ya)}function av(e,n,t,l,o,a){if(!e)return So;var s=1;if(n===c2&&(n=6),l<0?(s=0,l=-l):l>15&&(s=2,l-=16),o<1||o>g2||t!==rh||l<8||l>15||n<0||n>9||a<0||a>h2)return ks(e,So);l===8&&(l=9);var u=new M2;return e.state=u,u.strm=e,u.wrap=s,u.gzhead=null,u.w_bits=l,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+_r-1)/_r),u.window=new Ni.Buf8(u.w_size*2),u.head=new Ni.Buf16(u.hash_size),u.prev=new Ni.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=u.lit_bufsize*4,u.pending_buf=new Ni.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=(1+2)*u.lit_bufsize,u.level=n,u.strategy=a,u.method=t,ov(e)}function A2(e,n){return av(e,n,rh,p2,v2,d2)}function z2(e,n){var t,l,o,a;if(!e||!e.state||n>tv||n<0)return e?ks(e,So):So;if(l=e.state,!e.output||!e.input&&e.avail_in!==0||l.status===ju&&n!==vs)return ks(e,e.avail_out===0?im:So);if(l.strm=e,t=l.last_flush,l.last_flush=n,l.status===nh)if(l.wrap===2)e.adler=0,Dr(l,31),Dr(l,139),Dr(l,8),l.gzhead?(Dr(l,(l.gzhead.text?1:0)+(l.gzhead.hcrc?2:0)+(l.gzhead.extra?4:0)+(l.gzhead.name?8:0)+(l.gzhead.comment?16:0)),Dr(l,l.gzhead.time&255),Dr(l,l.gzhead.time>>8&255),Dr(l,l.gzhead.time>>16&255),Dr(l,l.gzhead.time>>24&255),Dr(l,l.level===9?2:l.strategy>=lh||l.level<2?4:0),Dr(l,l.gzhead.os&255),l.gzhead.extra&&l.gzhead.extra.length&&(Dr(l,l.gzhead.extra.length&255),Dr(l,l.gzhead.extra.length>>8&255)),l.gzhead.hcrc&&(e.adler=ps(e.adler,l.pending_buf,l.pending,0)),l.gzindex=0,l.status=am):(Dr(l,0),Dr(l,0),Dr(l,0),Dr(l,0),Dr(l,0),Dr(l,l.level===9?2:l.strategy>=lh||l.level<2?4:0),Dr(l,$2),l.status=Ks);else{var s=rh+(l.w_bits-8<<4)<<8,u=-1;l.strategy>=lh||l.level<2?u=0:l.level<6?u=1:l.level===6?u=2:u=3,s|=u<<6,l.strstart!==0&&(s|=C2),s+=31-s%31,l.status=Ks,Vu(l,s),l.strstart!==0&&(Vu(l,e.adler>>>16),Vu(l,e.adler&65535)),e.adler=1}if(l.status===am)if(l.gzhead.extra){for(o=l.pending;l.gzindex<(l.gzhead.extra.length&65535)&&!(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>o&&(e.adler=ps(e.adler,l.pending_buf,l.pending-o,o)),ws(e),o=l.pending,l.pending===l.pending_buf_size));)Dr(l,l.gzhead.extra[l.gzindex]&255),l.gzindex++;l.gzhead.hcrc&&l.pending>o&&(e.adler=ps(e.adler,l.pending_buf,l.pending-o,o)),l.gzindex===l.gzhead.extra.length&&(l.gzindex=0,l.status=ih)}else l.status=ih;if(l.status===ih)if(l.gzhead.name){o=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>o&&(e.adler=ps(e.adler,l.pending_buf,l.pending-o,o)),ws(e),o=l.pending,l.pending===l.pending_buf_size)){a=1;break}l.gzindex<l.gzhead.name.length?a=l.gzhead.name.charCodeAt(l.gzindex++)&255:a=0,Dr(l,a)}while(a!==0);l.gzhead.hcrc&&l.pending>o&&(e.adler=ps(e.adler,l.pending_buf,l.pending-o,o)),a===0&&(l.gzindex=0,l.status=oh)}else l.status=oh;if(l.status===oh)if(l.gzhead.comment){o=l.pending;do{if(l.pending===l.pending_buf_size&&(l.gzhead.hcrc&&l.pending>o&&(e.adler=ps(e.adler,l.pending_buf,l.pending-o,o)),ws(e),o=l.pending,l.pending===l.pending_buf_size)){a=1;break}l.gzindex<l.gzhead.comment.length?a=l.gzhead.comment.charCodeAt(l.gzindex++)&255:a=0,Dr(l,a)}while(a!==0);l.gzhead.hcrc&&l.pending>o&&(e.adler=ps(e.adler,l.pending_buf,l.pending-o,o)),a===0&&(l.status=ah)}else l.status=ah;if(l.status===ah&&(l.gzhead.hcrc?(l.pending+2>l.pending_buf_size&&ws(e),l.pending+2<=l.pending_buf_size&&(Dr(l,e.adler&255),Dr(l,e.adler>>8&255),e.adler=0,l.status=Ks)):l.status=Ks),l.pending!==0){if(ws(e),e.avail_out===0)return l.last_flush=-1,ya}else if(e.avail_in===0&&rv(n)<=rv(t)&&n!==vs)return ks(e,im);if(l.status===ju&&e.avail_in!==0)return ks(e,im);if(e.avail_in!==0||l.lookahead!==0||n!==Zs&&l.status!==ju){var f=l.strategy===lh?R2(l,n):l.strategy===f2?T2(l,n):jc[l.level].func(l,n);if((f===Js||f===Lc)&&(l.status=ju),f===Jn||f===Js)return e.avail_out===0&&(l.last_flush=-1),ya;if(f===Bu&&(n===o2?$o._tr_align(l):n!==tv&&($o._tr_stored_block(l,0,0,!1),n===a2&&(bs(l.head),l.lookahead===0&&(l.strstart=0,l.block_start=0,l.insert=0))),ws(e),e.avail_out===0))return l.last_flush=-1,ya}return n!==vs?ya:l.wrap<=0?lv:(l.wrap===2?(Dr(l,e.adler&255),Dr(l,e.adler>>8&255),Dr(l,e.adler>>16&255),Dr(l,e.adler>>24&255),Dr(l,e.total_in&255),Dr(l,e.total_in>>8&255),Dr(l,e.total_in>>16&255),Dr(l,e.total_in>>24&255)):(Vu(l,e.adler>>>16),Vu(l,e.adler&65535)),ws(e),l.wrap>0&&(l.wrap=-l.wrap),l.pending!==0?ya:lv)}function O2(e){var n;return!e||!e.state?So:(n=e.state.status,n!==nh&&n!==am&&n!==ih&&n!==oh&&n!==ah&&n!==Ks&&n!==ju?ks(e,So):(e.state=null,n===Ks?ks(e,s2):ya))}function P2(e,n){var t=n.length,l,o,a,s,u,f,m,d;if(!e||!e.state||(l=e.state,s=l.wrap,s===2||s===1&&l.status!==nh||l.lookahead))return So;for(s===1&&(e.adler=ev(e.adler,n,t,0)),l.wrap=0,t>=l.w_size&&(s===0&&(bs(l.head),l.strstart=0,l.block_start=0,l.insert=0),d=new Ni.Buf8(l.w_size),Ni.arraySet(d,n,t-l.w_size,l.w_size,0),n=d,t=l.w_size),u=e.avail_in,f=e.next_in,m=e.input,e.avail_in=t,e.next_in=0,e.input=n,Qs(l);l.lookahead>=_r;){o=l.strstart,a=l.lookahead-(_r-1);do l.ins_h=(l.ins_h<<l.hash_shift^l.window[o+_r-1])&l.hash_mask,l.prev[o&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=o,o++;while(--a);l.strstart=o,l.lookahead=_r-1,Qs(l)}return l.strstart+=l.lookahead,l.block_start=l.strstart,l.insert=l.lookahead,l.lookahead=0,l.match_length=l.prev_length=_r-1,l.match_available=0,e.next_in=f,e.input=m,e.avail_in=u,l.wrap=s,ya}ba.deflateInit=A2;ba.deflateInit2=av;ba.deflateReset=ov;ba.deflateResetKeep=iv;ba.deflateSetHeader=D2;ba.deflate=z2;ba.deflateEnd=O2;ba.deflateSetDictionary=P2;ba.deflateInfo="pako deflate (from Nodeca project)"});var cm=Fn(Bc=>{var import_plugin=qe(Ye());"use strict";var sh=Wa(),cv=!0,uv=!0;try{String.fromCharCode.apply(null,[0])}catch(e){cv=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){uv=!1}var Wu=new sh.Buf8(256);for(var xs=0;xs<256;xs++)Wu[xs]=xs>=252?6:xs>=248?5:xs>=240?4:xs>=224?3:xs>=192?2:1;Wu[254]=Wu[254]=1;Bc.string2buf=function(e){var n,t,l,o,a,s=e.length,u=0;for(o=0;o<s;o++)t=e.charCodeAt(o),(t&64512)==55296&&o+1<s&&(l=e.charCodeAt(o+1),(l&64512)==56320&&(t=65536+(t-55296<<10)+(l-56320),o++)),u+=t<128?1:t<2048?2:t<65536?3:4;for(n=new sh.Buf8(u),a=0,o=0;a<u;o++)t=e.charCodeAt(o),(t&64512)==55296&&o+1<s&&(l=e.charCodeAt(o+1),(l&64512)==56320&&(t=65536+(t-55296<<10)+(l-56320),o++)),t<128?n[a++]=t:t<2048?(n[a++]=192|t>>>6,n[a++]=128|t&63):t<65536?(n[a++]=224|t>>>12,n[a++]=128|t>>>6&63,n[a++]=128|t&63):(n[a++]=240|t>>>18,n[a++]=128|t>>>12&63,n[a++]=128|t>>>6&63,n[a++]=128|t&63);return n};function fv(e,n){if(n<65534&&(e.subarray&&uv||!e.subarray&&cv))return String.fromCharCode.apply(null,sh.shrinkBuf(e,n));for(var t="",l=0;l<n;l++)t+=String.fromCharCode(e[l]);return t}Bc.buf2binstring=function(e){return fv(e,e.length)};Bc.binstring2buf=function(e){for(var n=new sh.Buf8(e.length),t=0,l=n.length;t<l;t++)n[t]=e.charCodeAt(t);return n};Bc.buf2string=function(e,n){var t,l,o,a,s=n||e.length,u=new Array(s*2);for(l=0,t=0;t<s;){if(o=e[t++],o<128){u[l++]=o;continue}if(a=Wu[o],a>4){u[l++]=65533,t+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&t<s;)o=o<<6|e[t++]&63,a--;if(a>1){u[l++]=65533;continue}o<65536?u[l++]=o:(o-=65536,u[l++]=55296|o>>10&1023,u[l++]=56320|o&1023)}return fv(u,l)};Bc.utf8border=function(e,n){var t;for(n=n||e.length,n>e.length&&(n=e.length),t=n-1;t>=0&&(e[t]&192)==128;)t--;return t<0||t===0?n:t+Wu[e[t]]>n?t:n}});var um=Fn((v4,hv)=>{var import_plugin=qe(Ye());"use strict";function E2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}hv.exports=E2});var pv=Fn(Gu=>{var import_plugin=qe(Ye());"use strict";var qu=sv(),Uu=Wa(),fm=cm(),hm=th(),N2=um(),dv=Object.prototype.toString,L2=0,dm=4,Vc=0,mv=1,gv=2,H2=-1,j2=0,B2=8;function ec(e){if(!(this instanceof ec))return new ec(e);this.options=Uu.assign({level:H2,method:B2,chunkSize:16384,windowBits:15,memLevel:8,strategy:j2,to:""},e||{});var n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N2,this.strm.avail_out=0;var t=qu.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(t!==Vc)throw new Error(hm[t]);if(n.header&&qu.deflateSetHeader(this.strm,n.header),n.dictionary){var l;if(typeof n.dictionary=="string"?l=fm.string2buf(n.dictionary):dv.call(n.dictionary)==="[object ArrayBuffer]"?l=new Uint8Array(n.dictionary):l=n.dictionary,t=qu.deflateSetDictionary(this.strm,l),t!==Vc)throw new Error(hm[t]);this._dict_set=!0}}ec.prototype.push=function(e,n){var t=this.strm,l=this.options.chunkSize,o,a;if(this.ended)return!1;a=n===~~n?n:n===!0?dm:L2,typeof e=="string"?t.input=fm.string2buf(e):dv.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new Uu.Buf8(l),t.next_out=0,t.avail_out=l),o=qu.deflate(t,a),o!==mv&&o!==Vc)return this.onEnd(o),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(a===dm||a===gv))&&(this.options.to==="string"?this.onData(fm.buf2binstring(Uu.shrinkBuf(t.output,t.next_out))):this.onData(Uu.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&o!==mv);return a===dm?(o=qu.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===Vc):(a===gv&&(this.onEnd(Vc),t.avail_out=0),!0)};ec.prototype.onData=function(e){this.chunks.push(e)};ec.prototype.onEnd=function(e){e===Vc&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Uu.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function mm(e,n){var t=new ec(n);if(t.push(e,!0),t.err)throw t.msg||hm[t.err];return t.result}function V2(e,n){return n=n||{},n.raw=!0,mm(e,n)}function W2(e,n){return n=n||{},n.gzip=!0,mm(e,n)}Gu.Deflate=ec;Gu.deflate=mm;Gu.deflateRaw=V2;Gu.gzip=W2});var yv=Fn((k4,vv)=>{var import_plugin=qe(Ye());"use strict";var ch=30,q2=12;vv.exports=function(n,t){var l,o,a,s,u,f,m,d,p,b,g,v,x,_,S,I,P,F,D,k,w,C,T,O,z;l=n.state,o=n.next_in,O=n.input,a=o+(n.avail_in-5),s=n.next_out,z=n.output,u=s-(t-n.avail_out),f=s+(n.avail_out-257),m=l.dmax,d=l.wsize,p=l.whave,b=l.wnext,g=l.window,v=l.hold,x=l.bits,_=l.lencode,S=l.distcode,I=(1<<l.lenbits)-1,P=(1<<l.distbits)-1;e:do{x<15&&(v+=O[o++]<<x,x+=8,v+=O[o++]<<x,x+=8),F=_[v&I];t:for(;;){if(D=F>>>24,v>>>=D,x-=D,D=F>>>16&255,D===0)z[s++]=F&65535;else if(D&16){k=F&65535,D&=15,D&&(x<D&&(v+=O[o++]<<x,x+=8),k+=v&(1<<D)-1,v>>>=D,x-=D),x<15&&(v+=O[o++]<<x,x+=8,v+=O[o++]<<x,x+=8),F=S[v&P];l:for(;;){if(D=F>>>24,v>>>=D,x-=D,D=F>>>16&255,D&16){if(w=F&65535,D&=15,x<D&&(v+=O[o++]<<x,x+=8,x<D&&(v+=O[o++]<<x,x+=8)),w+=v&(1<<D)-1,w>m){n.msg="invalid distance too far back",l.mode=ch;break e}if(v>>>=D,x-=D,D=s-u,w>D){if(D=w-D,D>p&&l.sane){n.msg="invalid distance too far back",l.mode=ch;break e}if(C=0,T=g,b===0){if(C+=d-D,D<k){k-=D;do z[s++]=g[C++];while(--D);C=s-w,T=z}}else if(b<D){if(C+=d+b-D,D-=b,D<k){k-=D;do z[s++]=g[C++];while(--D);if(C=0,b<k){D=b,k-=D;do z[s++]=g[C++];while(--D);C=s-w,T=z}}}else if(C+=b-D,D<k){k-=D;do z[s++]=g[C++];while(--D);C=s-w,T=z}for(;k>2;)z[s++]=T[C++],z[s++]=T[C++],z[s++]=T[C++],k-=3;k&&(z[s++]=T[C++],k>1&&(z[s++]=T[C++]))}else{C=s-w;do z[s++]=z[C++],z[s++]=z[C++],z[s++]=z[C++],k-=3;while(k>2);k&&(z[s++]=z[C++],k>1&&(z[s++]=z[C++]))}}else if((D&64)==0){F=S[(F&65535)+(v&(1<<D)-1)];continue l}else{n.msg="invalid distance code",l.mode=ch;break e}break}}else if((D&64)==0){F=_[(F&65535)+(v&(1<<D)-1)];continue t}else if(D&32){l.mode=q2;break e}else{n.msg="invalid literal/length code",l.mode=ch;break e}break}}while(o<a&&s<f);k=x>>3,o-=k,x-=k<<3,v&=(1<<x)-1,n.next_in=o,n.next_out=s,n.avail_in=o<a?5+(a-o):5-(o-a),n.avail_out=s<f?257+(f-s):257-(s-f),l.hold=v,l.bits=x}});var $v=Fn((b4,Cv)=>{var import_plugin=qe(Ye());"use strict";var kv=Wa(),Wc=15,bv=852,wv=592,xv=0,gm=1,_v=2,U2=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],G2=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Y2=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],X2=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Cv.exports=function(n,t,l,o,a,s,u,f){var m=f.bits,d=0,p=0,b=0,g=0,v=0,x=0,_=0,S=0,I=0,P=0,F,D,k,w,C,T=null,O=0,z,A=new kv.Buf16(Wc+1),E=new kv.Buf16(Wc+1),L=null,N=0,W,X,te;for(d=0;d<=Wc;d++)A[d]=0;for(p=0;p<o;p++)A[t[l+p]]++;for(v=m,g=Wc;g>=1&&A[g]===0;g--);if(v>g&&(v=g),g===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,f.bits=1,0;for(b=1;b<g&&A[b]===0;b++);for(v<b&&(v=b),S=1,d=1;d<=Wc;d++)if(S<<=1,S-=A[d],S<0)return-1;if(S>0&&(n===xv||g!==1))return-1;for(E[1]=0,d=1;d<Wc;d++)E[d+1]=E[d]+A[d];for(p=0;p<o;p++)t[l+p]!==0&&(u[E[t[l+p]]++]=p);if(n===xv?(T=L=u,z=19):n===gm?(T=U2,O-=257,L=G2,N-=257,z=256):(T=Y2,L=X2,z=-1),P=0,p=0,d=b,C=s,x=v,_=0,k=-1,I=1<<v,w=I-1,n===gm&&I>bv||n===_v&&I>wv)return 1;for(;;){W=d-_,u[p]<z?(X=0,te=u[p]):u[p]>z?(X=L[N+u[p]],te=T[O+u[p]]):(X=32+64,te=0),F=1<<d-_,D=1<<x,b=D;do D-=F,a[C+(P>>_)+D]=W<<24|X<<16|te|0;while(D!==0);for(F=1<<d-1;P&F;)F>>=1;if(F!==0?(P&=F-1,P+=F):P=0,p++,--A[d]==0){if(d===g)break;d=t[l+u[p]]}if(d>v&&(P&w)!==k){for(_===0&&(_=v),C+=b,x=d-_,S=1<<x;x+_<g&&(S-=A[x+_],!(S<=0));)x++,S<<=1;if(I+=1<<x,n===gm&&I>bv||n===_v&&I>wv)return 1;k=P&w,a[k]=v<<24|x<<16|C-s|0}}return P!==0&&(a[C+P]=d-_<<24|64<<16|0),f.bits=v,0}});var oy=Fn(Uo=>{var import_plugin=qe(Ye());"use strict";var uo=Wa(),pm=rm(),wa=nm(),Z2=yv(),Yu=$v(),K2=0,Sv=1,Iv=2,Tv=4,J2=5,uh=6,tc=0,Q2=1,ex=2,Io=-2,Rv=-3,vm=-4,tx=-5,Fv=8,Mv=1,Dv=2,Av=3,zv=4,Ov=5,Pv=6,Ev=7,Nv=8,Lv=9,Hv=10,fh=11,Ua=12,ym=13,jv=14,km=15,Bv=16,Vv=17,Wv=18,qv=19,hh=20,dh=21,Uv=22,Gv=23,Yv=24,Xv=25,Zv=26,bm=27,Kv=28,Jv=29,yn=30,wm=31,lx=32,rx=852,nx=592,ix=15,ox=ix;function Qv(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function ax(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new uo.Buf16(320),this.work=new uo.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ey(e){var n;return!e||!e.state?Io:(n=e.state,e.total_in=e.total_out=n.total=0,e.msg="",n.wrap&&(e.adler=n.wrap&1),n.mode=Mv,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new uo.Buf32(rx),n.distcode=n.distdyn=new uo.Buf32(nx),n.sane=1,n.back=-1,tc)}function ty(e){var n;return!e||!e.state?Io:(n=e.state,n.wsize=0,n.whave=0,n.wnext=0,ey(e))}function ly(e,n){var t,l;return!e||!e.state||(l=e.state,n<0?(t=0,n=-n):(t=(n>>4)+1,n<48&&(n&=15)),n&&(n<8||n>15))?Io:(l.window!==null&&l.wbits!==n&&(l.window=null),l.wrap=t,l.wbits=n,ty(e))}function ry(e,n){var t,l;return e?(l=new ax,e.state=l,l.window=null,t=ly(e,n),t!==tc&&(e.state=null),t):Io}function sx(e){return ry(e,ox)}var ny=!0,xm,_m;function cx(e){if(ny){var n;for(xm=new uo.Buf32(512),_m=new uo.Buf32(32),n=0;n<144;)e.lens[n++]=8;for(;n<256;)e.lens[n++]=9;for(;n<280;)e.lens[n++]=7;for(;n<288;)e.lens[n++]=8;for(Yu(Sv,e.lens,0,288,xm,0,e.work,{bits:9}),n=0;n<32;)e.lens[n++]=5;Yu(Iv,e.lens,0,32,_m,0,e.work,{bits:5}),ny=!1}e.lencode=xm,e.lenbits=9,e.distcode=_m,e.distbits=5}function iy(e,n,t,l){var o,a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new uo.Buf8(a.wsize)),l>=a.wsize?(uo.arraySet(a.window,n,t-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(o=a.wsize-a.wnext,o>l&&(o=l),uo.arraySet(a.window,n,t-l,o,a.wnext),l-=o,l?(uo.arraySet(a.window,n,t-l,l,0),a.wnext=l,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}function ux(e,n){var t,l,o,a,s,u,f,m,d,p,b,g,v,x,_=0,S,I,P,F,D,k,w,C,T=new uo.Buf8(4),O,z,A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Io;t=e.state,t.mode===Ua&&(t.mode=ym),s=e.next_out,o=e.output,f=e.avail_out,a=e.next_in,l=e.input,u=e.avail_in,m=t.hold,d=t.bits,p=u,b=f,C=tc;e:for(;;)switch(t.mode){case Mv:if(t.wrap===0){t.mode=ym;break}for(;d<16;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(t.wrap&2&&m===35615){t.check=0,T[0]=m&255,T[1]=m>>>8&255,t.check=wa(t.check,T,2,0),m=0,d=0,t.mode=Dv;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((m&255)<<8)+(m>>8))%31){e.msg="incorrect header check",t.mode=yn;break}if((m&15)!==Fv){e.msg="unknown compression method",t.mode=yn;break}if(m>>>=4,d-=4,w=(m&15)+8,t.wbits===0)t.wbits=w;else if(w>t.wbits){e.msg="invalid window size",t.mode=yn;break}t.dmax=1<<w,e.adler=t.check=1,t.mode=m&512?Hv:Ua,m=0,d=0;break;case Dv:for(;d<16;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(t.flags=m,(t.flags&255)!==Fv){e.msg="unknown compression method",t.mode=yn;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=yn;break}t.head&&(t.head.text=m>>8&1),t.flags&512&&(T[0]=m&255,T[1]=m>>>8&255,t.check=wa(t.check,T,2,0)),m=0,d=0,t.mode=Av;case Av:for(;d<32;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.head&&(t.head.time=m),t.flags&512&&(T[0]=m&255,T[1]=m>>>8&255,T[2]=m>>>16&255,T[3]=m>>>24&255,t.check=wa(t.check,T,4,0)),m=0,d=0,t.mode=zv;case zv:for(;d<16;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.head&&(t.head.xflags=m&255,t.head.os=m>>8),t.flags&512&&(T[0]=m&255,T[1]=m>>>8&255,t.check=wa(t.check,T,2,0)),m=0,d=0,t.mode=Ov;case Ov:if(t.flags&1024){for(;d<16;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.length=m,t.head&&(t.head.extra_len=m),t.flags&512&&(T[0]=m&255,T[1]=m>>>8&255,t.check=wa(t.check,T,2,0)),m=0,d=0}else t.head&&(t.head.extra=null);t.mode=Pv;case Pv:if(t.flags&1024&&(g=t.length,g>u&&(g=u),g&&(t.head&&(w=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),uo.arraySet(t.head.extra,l,a,g,w)),t.flags&512&&(t.check=wa(t.check,l,g,a)),u-=g,a+=g,t.length-=g),t.length))break e;t.length=0,t.mode=Ev;case Ev:if(t.flags&2048){if(u===0)break e;g=0;do w=l[a+g++],t.head&&w&&t.length<65536&&(t.head.name+=String.fromCharCode(w));while(w&&g<u);if(t.flags&512&&(t.check=wa(t.check,l,g,a)),u-=g,a+=g,w)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Nv;case Nv:if(t.flags&4096){if(u===0)break e;g=0;do w=l[a+g++],t.head&&w&&t.length<65536&&(t.head.comment+=String.fromCharCode(w));while(w&&g<u);if(t.flags&512&&(t.check=wa(t.check,l,g,a)),u-=g,a+=g,w)break e}else t.head&&(t.head.comment=null);t.mode=Lv;case Lv:if(t.flags&512){for(;d<16;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(m!==(t.check&65535)){e.msg="header crc mismatch",t.mode=yn;break}m=0,d=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=Ua;break;case Hv:for(;d<32;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}e.adler=t.check=Qv(m),m=0,d=0,t.mode=fh;case fh:if(t.havedict===0)return e.next_out=s,e.avail_out=f,e.next_in=a,e.avail_in=u,t.hold=m,t.bits=d,ex;e.adler=t.check=1,t.mode=Ua;case Ua:if(n===J2||n===uh)break e;case ym:if(t.last){m>>>=d&7,d-=d&7,t.mode=bm;break}for(;d<3;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}switch(t.last=m&1,m>>>=1,d-=1,m&3){case 0:t.mode=jv;break;case 1:if(cx(t),t.mode=hh,n===uh){m>>>=2,d-=2;break e}break;case 2:t.mode=Vv;break;case 3:e.msg="invalid block type",t.mode=yn}m>>>=2,d-=2;break;case jv:for(m>>>=d&7,d-=d&7;d<32;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if((m&65535)!=(m>>>16^65535)){e.msg="invalid stored block lengths",t.mode=yn;break}if(t.length=m&65535,m=0,d=0,t.mode=km,n===uh)break e;case km:t.mode=Bv;case Bv:if(g=t.length,g){if(g>u&&(g=u),g>f&&(g=f),g===0)break e;uo.arraySet(o,l,a,g,s),u-=g,a+=g,f-=g,s+=g,t.length-=g;break}t.mode=Ua;break;case Vv:for(;d<14;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(t.nlen=(m&31)+257,m>>>=5,d-=5,t.ndist=(m&31)+1,m>>>=5,d-=5,t.ncode=(m&15)+4,m>>>=4,d-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=yn;break}t.have=0,t.mode=Wv;case Wv:for(;t.have<t.ncode;){for(;d<3;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.lens[A[t.have++]]=m&7,m>>>=3,d-=3}for(;t.have<19;)t.lens[A[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,O={bits:t.lenbits},C=Yu(K2,t.lens,0,19,t.lencode,0,t.work,O),t.lenbits=O.bits,C){e.msg="invalid code lengths set",t.mode=yn;break}t.have=0,t.mode=qv;case qv:for(;t.have<t.nlen+t.ndist;){for(;_=t.lencode[m&(1<<t.lenbits)-1],S=_>>>24,I=_>>>16&255,P=_&65535,!(S<=d);){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(P<16)m>>>=S,d-=S,t.lens[t.have++]=P;else{if(P===16){for(z=S+2;d<z;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(m>>>=S,d-=S,t.have===0){e.msg="invalid bit length repeat",t.mode=yn;break}w=t.lens[t.have-1],g=3+(m&3),m>>>=2,d-=2}else if(P===17){for(z=S+3;d<z;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}m>>>=S,d-=S,w=0,g=3+(m&7),m>>>=3,d-=3}else{for(z=S+7;d<z;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}m>>>=S,d-=S,w=0,g=11+(m&127),m>>>=7,d-=7}if(t.have+g>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=yn;break}for(;g--;)t.lens[t.have++]=w}}if(t.mode===yn)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=yn;break}if(t.lenbits=9,O={bits:t.lenbits},C=Yu(Sv,t.lens,0,t.nlen,t.lencode,0,t.work,O),t.lenbits=O.bits,C){e.msg="invalid literal/lengths set",t.mode=yn;break}if(t.distbits=6,t.distcode=t.distdyn,O={bits:t.distbits},C=Yu(Iv,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,O),t.distbits=O.bits,C){e.msg="invalid distances set",t.mode=yn;break}if(t.mode=hh,n===uh)break e;case hh:t.mode=dh;case dh:if(u>=6&&f>=258){e.next_out=s,e.avail_out=f,e.next_in=a,e.avail_in=u,t.hold=m,t.bits=d,Z2(e,b),s=e.next_out,o=e.output,f=e.avail_out,a=e.next_in,l=e.input,u=e.avail_in,m=t.hold,d=t.bits,t.mode===Ua&&(t.back=-1);break}for(t.back=0;_=t.lencode[m&(1<<t.lenbits)-1],S=_>>>24,I=_>>>16&255,P=_&65535,!(S<=d);){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(I&&(I&240)==0){for(F=S,D=I,k=P;_=t.lencode[k+((m&(1<<F+D)-1)>>F)],S=_>>>24,I=_>>>16&255,P=_&65535,!(F+S<=d);){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}m>>>=F,d-=F,t.back+=F}if(m>>>=S,d-=S,t.back+=S,t.length=P,I===0){t.mode=Zv;break}if(I&32){t.back=-1,t.mode=Ua;break}if(I&64){e.msg="invalid literal/length code",t.mode=yn;break}t.extra=I&15,t.mode=Uv;case Uv:if(t.extra){for(z=t.extra;d<z;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.length+=m&(1<<t.extra)-1,m>>>=t.extra,d-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Gv;case Gv:for(;_=t.distcode[m&(1<<t.distbits)-1],S=_>>>24,I=_>>>16&255,P=_&65535,!(S<=d);){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if((I&240)==0){for(F=S,D=I,k=P;_=t.distcode[k+((m&(1<<F+D)-1)>>F)],S=_>>>24,I=_>>>16&255,P=_&65535,!(F+S<=d);){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}m>>>=F,d-=F,t.back+=F}if(m>>>=S,d-=S,t.back+=S,I&64){e.msg="invalid distance code",t.mode=yn;break}t.offset=P,t.extra=I&15,t.mode=Yv;case Yv:if(t.extra){for(z=t.extra;d<z;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}t.offset+=m&(1<<t.extra)-1,m>>>=t.extra,d-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=yn;break}t.mode=Xv;case Xv:if(f===0)break e;if(g=b-f,t.offset>g){if(g=t.offset-g,g>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=yn;break}g>t.wnext?(g-=t.wnext,v=t.wsize-g):v=t.wnext-g,g>t.length&&(g=t.length),x=t.window}else x=o,v=s-t.offset,g=t.length;g>f&&(g=f),f-=g,t.length-=g;do o[s++]=x[v++];while(--g);t.length===0&&(t.mode=dh);break;case Zv:if(f===0)break e;o[s++]=t.length,f--,t.mode=dh;break;case bm:if(t.wrap){for(;d<32;){if(u===0)break e;u--,m|=l[a++]<<d,d+=8}if(b-=f,e.total_out+=b,t.total+=b,b&&(e.adler=t.check=t.flags?wa(t.check,o,b,s-b):pm(t.check,o,b,s-b)),b=f,(t.flags?m:Qv(m))!==t.check){e.msg="incorrect data check",t.mode=yn;break}m=0,d=0}t.mode=Kv;case Kv:if(t.wrap&&t.flags){for(;d<32;){if(u===0)break e;u--,m+=l[a++]<<d,d+=8}if(m!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=yn;break}m=0,d=0}t.mode=Jv;case Jv:C=Q2;break e;case yn:C=Rv;break e;case wm:return vm;case lx:default:return Io}return e.next_out=s,e.avail_out=f,e.next_in=a,e.avail_in=u,t.hold=m,t.bits=d,(t.wsize||b!==e.avail_out&&t.mode<yn&&(t.mode<bm||n!==Tv))&&iy(e,e.output,e.next_out,b-e.avail_out)?(t.mode=wm,vm):(p-=e.avail_in,b-=e.avail_out,e.total_in+=p,e.total_out+=b,t.total+=b,t.wrap&&b&&(e.adler=t.check=t.flags?wa(t.check,o,b,e.next_out-b):pm(t.check,o,b,e.next_out-b)),e.data_type=t.bits+(t.last?64:0)+(t.mode===Ua?128:0)+(t.mode===hh||t.mode===km?256:0),(p===0&&b===0||n===Tv)&&C===tc&&(C=tx),C)}function fx(e){if(!e||!e.state)return Io;var n=e.state;return n.window&&(n.window=null),e.state=null,tc}function hx(e,n){var t;return!e||!e.state||(t=e.state,(t.wrap&2)==0)?Io:(t.head=n,n.done=!1,tc)}function dx(e,n){var t=n.length,l,o,a;return!e||!e.state||(l=e.state,l.wrap!==0&&l.mode!==fh)?Io:l.mode===fh&&(o=1,o=pm(o,n,t,0),o!==l.check)?Rv:(a=iy(e,n,t,t),a?(l.mode=wm,vm):(l.havedict=1,tc))}Uo.inflateReset=ty;Uo.inflateReset2=ly;Uo.inflateResetKeep=ey;Uo.inflateInit=sx;Uo.inflateInit2=ry;Uo.inflate=ux;Uo.inflateEnd=fx;Uo.inflateGetHeader=hx;Uo.inflateSetDictionary=dx;Uo.inflateInfo="pako inflate (from Nodeca project)"});var Cm=Fn((x4,ay)=>{var import_plugin=qe(Ye());"use strict";ay.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var cy=Fn((_4,sy)=>{var import_plugin=qe(Ye());"use strict";function mx(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}sy.exports=mx});var fy=Fn(Zu=>{var import_plugin=qe(Ye());"use strict";var qc=oy(),Xu=Wa(),mh=cm(),Pn=Cm(),$m=th(),gx=um(),px=cy(),uy=Object.prototype.toString;function lc(e){if(!(this instanceof lc))return new lc(e);this.options=Xu.assign({chunkSize:16384,windowBits:0,to:""},e||{});var n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,n.windowBits===0&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(e&&e.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(n.windowBits&15)==0&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new gx,this.strm.avail_out=0;var t=qc.inflateInit2(this.strm,n.windowBits);if(t!==Pn.Z_OK)throw new Error($m[t]);if(this.header=new px,qc.inflateGetHeader(this.strm,this.header),n.dictionary&&(typeof n.dictionary=="string"?n.dictionary=mh.string2buf(n.dictionary):uy.call(n.dictionary)==="[object ArrayBuffer]"&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(t=qc.inflateSetDictionary(this.strm,n.dictionary),t!==Pn.Z_OK)))throw new Error($m[t])}lc.prototype.push=function(e,n){var t=this.strm,l=this.options.chunkSize,o=this.options.dictionary,a,s,u,f,m,d=!1;if(this.ended)return!1;s=n===~~n?n:n===!0?Pn.Z_FINISH:Pn.Z_NO_FLUSH,typeof e=="string"?t.input=mh.binstring2buf(e):uy.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new Xu.Buf8(l),t.next_out=0,t.avail_out=l),a=qc.inflate(t,Pn.Z_NO_FLUSH),a===Pn.Z_NEED_DICT&&o&&(a=qc.inflateSetDictionary(this.strm,o)),a===Pn.Z_BUF_ERROR&&d===!0&&(a=Pn.Z_OK,d=!1),a!==Pn.Z_STREAM_END&&a!==Pn.Z_OK)return this.onEnd(a),this.ended=!0,!1;t.next_out&&(t.avail_out===0||a===Pn.Z_STREAM_END||t.avail_in===0&&(s===Pn.Z_FINISH||s===Pn.Z_SYNC_FLUSH))&&(this.options.to==="string"?(u=mh.utf8border(t.output,t.next_out),f=t.next_out-u,m=mh.buf2string(t.output,u),t.next_out=f,t.avail_out=l-f,f&&Xu.arraySet(t.output,t.output,u,f,0),this.onData(m)):this.onData(Xu.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(d=!0)}while((t.avail_in>0||t.avail_out===0)&&a!==Pn.Z_STREAM_END);return a===Pn.Z_STREAM_END&&(s=Pn.Z_FINISH),s===Pn.Z_FINISH?(a=qc.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===Pn.Z_OK):(s===Pn.Z_SYNC_FLUSH&&(this.onEnd(Pn.Z_OK),t.avail_out=0),!0)};lc.prototype.onData=function(e){this.chunks.push(e)};lc.prototype.onEnd=function(e){e===Pn.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Xu.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Sm(e,n){var t=new lc(n);if(t.push(e,!0),t.err)throw t.msg||$m[t.err];return t.result}function vx(e,n){return n=n||{},n.raw=!0,Sm(e,n)}Zu.Inflate=lc;Zu.inflate=Sm;Zu.inflateRaw=vx;Zu.ungzip=Sm});var my=Fn(($4,dy)=>{var import_plugin=qe(Ye());"use strict";var yx=Wa().assign,kx=pv(),bx=fy(),wx=Cm(),hy={};yx(hy,kx,bx,wx);dy.exports=hy});function Uc(e){$("#luckysheet-cell-loading").find("span").text(e).end().show()}function Ku(){$("#luckysheet-cell-loading").hide()}var import_plugin,Im=Nt(()=>{import_plugin=qe(Ye())});var import_plugin,xx,It,Wr=Nt(()=>{import_plugin=qe(Ye());Oc();Sr();Er();Ar();fr();il();xx={deepCopyFlowDataState:!1,deepCopyFlowDataCache:"",deepCopyFlowDataWorker:null,deepCopyFlowData:function(e){let n=this;return n.deepCopyFlowDataState?(n.deepCopyFlowDataWorker!=null&&n.deepCopyFlowDataWorker.terminate(),n.deepCopyFlowDataCache):(e==null&&(e=h.flowdata),$.extend(!0,[],e))},webWorkerFlowDataCache:function(e){let n=this;try{n.deepCopyFlowDataWorker!=null&&n.deepCopyFlowDataWorker.terminate();let t="data:text/javascript;chartset=US-ASCII,onmessage = function (e) { postMessage(e.data); };";n.deepCopyFlowDataState=!1;let l;if(co.isIE()==1){let o="self.onmessage=function(e){postMessage(e.data);}";l=new Worker("./plugins/Worker-helper.js"),l.postMessage(o)}else l=new Worker(t);n.deepCopyFlowDataWorker=l,l.postMessage(e),l.onmessage=function(o){n.deepCopyFlowDataCache=o.data,n.deepCopyFlowDataState=!0}}catch(t){n.deepCopyFlowDataCache=$.extend(!0,[],e)}},controlHandler:function(e,n){let l=this.deepCopyFlowData(h.flowdata),o=n||h.luckysheet_select_save[h.luckysheet_select_save.length-1],a=o.row==null?0:o.row[0],s=o.column==null?0:o.column[0],u=e.length,f=e[0].length,m=a+u-l.length,d=s+f-l[0].length;(m>0||d>0)&&(l=cn([].concat(l),m,d,!0));for(let p=0;p<u;p++){let b=[].concat(l[p+a]);for(let g=0;g<f;g++){let v="";e[p]!=null&&e[p][g]!=null&&(v=e[p][g]),b[g+s]=v}l[p+a]=b}m>0||d>0?Li(l[0].length,l.length,l,null,h.luckysheet_select_save,"datachangeAll"):Gc(l,h.luckysheet_select_save)},clearRangeByindex:function(e,n,t,l,o){let a=Me(o),s=$.extend(!0,[],h.luckysheetfile[a].data);for(let u=e;u<=n;u++){let f=[].concat(s[u]);for(let m=t;m<=l;m++)y.delFunctionGroup(u,m),y.execFunctionGroup(u,m,""),f[m]=null;s[u]=f}if(o==h.currentSheetIndex){let u=n-e+1,f=l-t+1;u>5e3?al(s,[{row:[e,n],column:[t,l]}]):Gc(s,{row:[e,n],column:[t,l]})}else h.luckysheetfile[a].data=s},controlHandlerD:function(e){let t=this.deepCopyFlowData(h.flowdata),l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],o=l.row[0],a=l.row[1],s=l.column[0],u=l.column[1],f=e.length,m=e[0].length,d=o+f-t.length,p=s+m-t[0].length;(d>0||p>0)&&(t=cn([].concat(t),d,p,!0));for(let g=o;g<=a;g++)for(let v=s;v<=u;v++)t[g][v]=null;for(let g=0;g<f;g++)for(let v=0;v<m;v++)t[o+g][s+v]=e[g][v];let b=[{row:[o,a],column:[s,u]},{row:[o,o+f-1],column:[s,s+m-1]}];al(t,b)}},It=xx});function Ju(e){let n={};if(G(e)=="array")for(let t=0;t<e.length;t++){let l=e[t].r,o=e[t].c,a=e[t].f;if(h.flowdata[l][o]!=null&&h.flowdata[l][o].f!=null&&h.flowdata[l][o].f==a){l+"_"+o in n&&(n=_x(n,l,o));let s=e[t].data,u=s.length,f=1;if(G(s[0])=="array"&&(f=s[0].length),Cx({row:[l,l+u-1],column:[o,o+f-1]},h.flowdata))for(let m=0;m<u;m++)for(let d=0;d<f;d++){let p=l+m,b=o+d;G(s[0])=="array"?n[p+"_"+b]={v:s[m][d],r:l,c:o}:n[p+"_"+b]={v:s[m],r:l,c:o}}else n[l+"_"+o]={v:"#SPILL!",r:l,c:o}}}return n}function _x(e,n,t){let l=e[n+"_"+t].r,o=e[n+"_"+t].c;for(let a in e)a==l+"_"+o?e[a].v="#SPILL!":e[a].r==l&&e[a].c==o&&delete e[a];return e}function Cx(e,n){let t=e.row[0],l=e.row[1],o=e.column[0],a=e.column[1],s=!0;for(let u=t;u<=l;u++)for(let f=o;f<=a;f++)if(!(u==t&&f==o)&&n[u][f]!=null&&n[u][f].v!=null&&n[u][f].v.toString()!=""){s=!1;break}return s}function gy(e,n){let t=h.luckysheetfile[Me(h.currentSheetIndex)].dynamicArray==null?[]:h.luckysheetfile[Me(h.currentSheetIndex)].dynamicArray,l=Ju(t);if(e+"_"+n in l&&l[e+"_"+n].v!="#SPILL!"){let o=l[e+"_"+n].r,a=l[e+"_"+n].c,s=h.flowdata[o][a].f,u,f;for(let x=0;x<t.length;x++)t[x].f==s&&(u=t[x].data.length,G(t[x].data[0])=="array"?f=t[x].data[0].length:f=1);let m=o+u-1,d=a+f-1,p=h.visibledatarow[m],b=o-1==-1?0:h.visibledatarow[o-1],g=h.visibledatacolumn[d],v=a-1==-1?0:h.visibledatacolumn[a-1];$("#luckysheet-dynamicArray-hightShow").css({left:v,width:g-v-1,top:b,height:p-b-1,display:"block"})}else $("#luckysheet-dynamicArray-hightShow").hide()}var import_plugin,gh=Nt(()=>{import_plugin=qe(Ye());Ol();fr();il()});function To(e){let n;if(document.createRange)if(e.innerHTML!=e.innerText||e.innerHTML=="")e.focus(),n=window.getSelection(),n.selectAllChildren(e),n.collapseToEnd();else{let t=e.innerText.length;n=document.createRange(),n.selectNodeContents(e),n.setStart(e.childNodes[0],t),n.collapse(!0);let l=window.getSelection();l.removeAllRanges(),l.addRange(n)}else document.selection&&(n=document.body.createTextRange(),n.moveToElementText(e),n.collapse(!1),n.select())}function Ro(e){e.target.classList&&(e.target.classList.contains("luckysheet-cols-rows-shift-left")||e.target.classList.contains("luckysheet-cols-rows-shift-right"))||!$(e.target).hasClass("luckysheet-mousedown-cancel")&&$(e.target).filter("[class*='sp-palette']").length==0&&$(e.target).filter("[class*='sp-thumb']").length==0&&$(e.target).filter("[class*='sp-']").length==0&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide(),h.luckysheet_cols_menu_status=!1)}function py(e){if(window.getSelection){let n=document.createRange();n.selectNodeContents(e),n.startContainer&&ph(n.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(n))}else if(document.selection){let n=document.body.createTextRange();n.moveToElementText(e),n.select()}}function vy(e){if(window.getSelection){let t=document.createRange();var n=e.firstChild;t.setStart(n,0),t.setEnd(n,n.length),t.startContainer&&ph(t.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(t))}else if(document.selection){let t=document.body.createTextRange();t.moveToElementText(e),t.select()}}function yy(e,n){if(window.getSelection){let o=document.createRange();var t=e.firstChild,l=n.firstChild;o.setStart(t,0),o.setEnd(l,l.length),o.startContainer&&ph(o.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(o))}}function ky(e,n){if(window.getSelection){let l=document.createRange();var t=e.firstChild;n>t.length?n=t.length:n<0&&(n=0),l.setStart(t,n),l.collapse(!0),l.startContainer&&ph(l.startContainer)&&(window.getSelection().removeAllRanges(),window.getSelection().addRange(l))}}function ph(e){return e===document.body?!1:document.body.contains(e)}var import_plugin,Ga=Nt(()=>{import_plugin=qe(Ye());il()});function Wn(e){return e&&e.ct!=null&&e.ct.t=="inlineStr"&&e.ct.s!=null&&e.ct.s.length>0}function Yc(e){return e!=null&&e.t=="inlineStr"&&e.s!=null&&e.s.length>0}function xy(e,n,t,l){var o=window.getSelection(),a;o.type=="None"?a=h.inlineStringEditRange:a=o.getRangeAt(0);let s=a.commonAncestorContainer,u;s.id=="luckysheet-rich-text-editor"?u=$(s):u=$(s).closest("#luckysheet-rich-text-editor");let f=$(s).closest("#luckysheet-functionbox-cell");if(u.length==0&&f.length==0&&h.inlineStringEditRange!=null&&(a=h.inlineStringEditRange,s=a.commonAncestorContainer,s.id=="luckysheet-rich-text-editor"?u=$(s):u=$(s).closest("#luckysheet-rich-text-editor"),f=$(s).closest("#luckysheet-functionbox-cell")),a.collapsed===!0)return;let m=a.endContainer,d=a.startContainer,p=a.endOffset,b=a.startOffset;if(u.length>0){if(d===m){let g=d.parentNode,v,x=!1,_=g.innerText;u.html().substr(0,5)!="<span"&&(x=!0);let I="",P="",F="",D=0,k=b,w=p,C=_.length;I=_.substring(D,k),P=_.substring(k,w),F=_.substring(w,C);let T="";if(I!=""){let z=g.style.cssText;if(x){let A=$(g).closest("#luckysheet-input-box").get(0);A!=null&&(z=Rm(A.style.cssText,z))}T+="<span style='"+z+"'>"+I+"</span>"}if(P!=""){let z=vh(g.style.cssText,n,t);if(x){let A=$(g).closest("#luckysheet-input-box").get(0);A!=null&&(z=Rm(A.style.cssText,z))}T+="<span style='"+z+"'>"+P+"</span>"}if(F!=""){let z=g.style.cssText;if(x){let A=$(g).closest("#luckysheet-input-box").get(0);A!=null&&(z=Rm(A.style.cssText,z))}T+="<span style='"+z+"'>"+F+"</span>"}d.parentNode.tagName=="SPAN"?(v=u.find("span").index(g),$(g).replaceWith(T)):(v=0,$(g).html(T));let O=0;D==k?O=v:O=v+1,vy(u.find("span").get(O))}else if(d.parentNode.tagName=="SPAN"&&m.parentNode.tagName=="SPAN"){let g=d.parentNode,v,x=m.parentNode,_;v=u.find("span").index(g),_=u.find("span").index(x);let S=g.innerHTML,I=x.innerHTML,P="",F="",D="",k="",w=0,C=b,T=p,O=I.length;P=S.substring(w,C),F=S.substring(C,S.length),D=I.substring(0,T),k=I.substring(T,O);let z=u.find("span"),A=z.slice(v,_+1),E="";for(let W=0;W<v;W++){let X=z.get(W),te=X.innerHTML;E+="<span style='"+X.style.cssText+"'>"+te+"</span>"}if(P!=""&&(E+="<span style='"+g.style.cssText+"'>"+P+"</span>"),F!=""){let W=vh(g.style.cssText,n,t);E+="<span style='"+W+"'>"+F+"</span>"}if(v<_)for(let W=v+1;W<_;W++){let X=z.get(W),te=X.innerHTML,ue=vh(X.style.cssText,n,t);E+="<span style='"+ue+"'>"+te+"</span>"}if(D!=""){let W=vh(x.style.cssText,n,t);E+="<span style='"+W+"'>"+D+"</span>"}k!=""&&(E+="<span style='"+x.style.cssText+"'>"+k+"</span>");for(let W=_+1;W<z.length;W++){let X=z.get(W),te=X.innerHTML;E+="<span style='"+X.style.cssText+"'>"+te+"</span>"}u.html(E);let L,N;w==C?(L=v,N=_):(L=v+1,N=_+1),z=u.find("span"),yy(z.get(L),z.get(N))}}else f.length>0}function _y(e){var n=window.getSelection();if(n.type=="None")return;var t=n.getRangeAt(0);let l=t.commonAncestorContainer,o;l.id=="luckysheet-rich-text-editor"?o=$(l):o=$(l).closest("#luckysheet-rich-text-editor");let a=$(l).closest("#luckysheet-functionbox-cell"),s=t.endContainer,u=t.startContainer,f=t.endOffset,m=t.startOffset;if(o.length>0){let d=u.parentNode;u.id=="luckysheet-rich-text-editor"&&(d=$(u).find("span"),d.length==0&&(u.innerHTML=`<span>${u.innerText}</span>`,d=$(u).find("span")),d=d.get(d.length-1),m=d.innerHTML.length),t.collapsed===!1&&t.deleteContents();let p=d.innerText,b="",g="",v=0,x=m;b=p.substring(v,x),g=p.substring(x,p.length);let _,S;if(u.parentNode.tagName=="SPAN"){let I=o.find("span");if(_=I.index(d),_==I.length-1&&g==""){let P=I[_].innerHTML;P.substr(P.length-1,1)==`
`?S="<span style='"+d.style.cssText+"'>"+b+`
</span>`:S="<span style='"+d.style.cssText+"'>"+b+`

</span>`}else S="<span style='"+d.style.cssText+"'>"+b+`
`+g+"</span>";$(d).replaceWith(S)}else{let I=d.style.cssText;if(g==""?S="<span style='"+I+"'>"+b+`

</span>`:S="<span style='"+I+"'>"+b+`
`+g+"</span>",u.id=="luckysheet-rich-text-editor"){$(d).replaceWith(S);let P=o.find("span");_=P.length-1,m=P.get(_).innerHTML.length-1}else $(d).html(S),_=0}ky(o.find("span").get(_),m+1)}else a.length>0}function Cy(e,n,t){if(e.ct==null)return;let l=e.ct.s;if(l!=null)for(let o=0;o<l.length;o++){let a=l[o];a[n]=t}}function $y(e){let n=[],t,l=null;for(let o=0;o<e.length;o++){let a=e.get(o),s=Tm(a.style.cssText),u=JSON.stringify(s),f=a.innerText;f=f.replace(/\n/g,`\r
`),u==l?t.v+=f:(s.v=f,n.push(s),l=u,t=s)}return n}function Tm(e){if(e==null||e.length==0)return{};let n=e.split(";"),t=Be(),l=t.fontarray,o=t.fontjson,a={ff:l[0],fc:"#000000",fs:10,cl:0,un:0,bl:0,it:0};return n.forEach(s=>{s=s.toLowerCase();let u=bi(s.substr(0,s.indexOf(":"))),f=bi(s.substr(s.indexOf(":")+1));if(u=="font-weight"&&(f=="bold"?a.bl=1:a.bl=0),u=="font-style"&&(f=="italic"?a.it=1:a.it=0),u=="font-family"){let m=o[f];m==null?a.ff=f:a.ff=m}u=="font-size"&&(a.fs=parseInt(f)),u=="color"&&(a.fc=f),u=="text-decoration"&&(a.cl=1),u=="border-bottom"&&(a.un=1),u=="lucky-strike"&&(a.cl=f),u=="lucky-underline"&&(a.un=f)}),a}function Iy(e,n){let t=e.split(";");if(n==null||n.length==0)return e;if(e.indexOf(n)>-1)for(let l=0;l<t.length;l++){let o=t[l];o=o.toLowerCase();let a=bi(o.substr(0,o.indexOf(":"))),s=bi(o.substr(o.indexOf(":")+1));if(a==n)return s}return""}function $x(e,n,t){let l=e.split(";"),o="";if(n==null||n.length==0)return e;if(e.indexOf(n)>-1)for(let a=0;a<l.length;a++){let s=l[a];s=s.toLowerCase();let u=bi(s.substr(0,s.indexOf(":"))),f=bi(s.substr(s.indexOf(":")+1));u==n?o+=u+":"+t+";":u.length>0&&(o+=u+":"+f+";")}else n.length>0&&(e+=n+":"+t+";",o=e);return o}function Sx(e,n){let t=e.split(";"),l="",o=n;if(n==null||n.length==0)return e;if(n in Sy&&(n=Sy[n]),e.indexOf(n)>-1)for(let a=0;a<t.length;a++){let s=t[a];s=s.toLowerCase();let u=bi(s.substr(0,s.indexOf(":"))),f=bi(s.substr(s.indexOf(":")+1));u==n||o=="cl"&&u=="lucky-strike"||o=="un"&&u=="lucky-underline"||u.length>0&&(l+=u+":"+f+";")}else l=e;return l}function vh(e,n,t){let l={};if(l[n]=t,n=="un"){let u=Iy(e,"color");u==""&&(u="#000000");let f=Iy(e,"font-size");f==""&&(f=11),f=parseInt(f),l._fontSize=f,l._color=u}let o=Qu(l,void 0,void 0,!1),a=bi(o.substr(0,o.indexOf(":"))),s=bi(o.substr(o.indexOf(":")+1));return s=s.substr(0,s.length-1),e=Sx(e,n),e=$x(e,a,s),e}function Rm(e,n,t=!0){let l=e.split(";"),o=n.split(";"),a="",s={};for(let u=0;u<l.length;u++){let f=l[u],m=!0;f=f.toLowerCase();let d=bi(f.substr(0,f.indexOf(":")));if(d=="font-size")continue;let p=bi(f.substr(f.indexOf(":")+1));if(!(t&&!(d in wy))){for(let b=0;b<o.length;b++){let g=o[b];g=g.toLowerCase();let v=bi(g.substr(0,g.indexOf(":"))),x=bi(g.substr(g.indexOf(":")+1));if(d==v){a+=v+":"+x+";",m=!1;continue}}m&&(a+=d+":"+p+";"),s[d]=1}}for(let u=0;u<o.length;u++){let f=o[u];f=f.toLowerCase();let m=bi(f.substr(0,f.indexOf(":"))),d=bi(f.substr(f.indexOf(":")+1));t&&!(m in wy)||m in s||(a+=m+":"+d+";")}return a}var import_plugin,by,wy,Sy,Ya=Nt(()=>{import_plugin=qe(Ye());Er();Ga();Xl();il();by={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1},wy={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1};Sy={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",cl:"text-decoration",un:"border-bottom"}});function hr(e,n){if(e==null&&(e=h.luckysheet_select_save[0]),e.row==null||e.row.length==0)return[];let t,l;n!=null&&n!=h.currentSheetIndex?(t=h.luckysheetfile[Me(n)].data,l=h.luckysheetfile[Me(n)].config):(t=It.deepCopyFlowData(h.flowdata),l=h.config);let o=[];for(let a=e.row[0];a<=e.row[1];a++){if(t[a]==null||l.rowhidden!=null&&l.rowhidden[a]!=null)continue;let s=[];for(let u=e.column[0];u<=e.column[1];u++)s.push(t[a][u]);o.push(s)}return o}function ef(e,n){if(n==null||n.row==null||n.row.length==0)return[];let t=Ju(h.luckysheetfile[Me(h.currentSheetIndex)].dynamicArray),l=[];if(e==null)return l;for(let o=n.row[0];o<=n.row[1];o++){if(e[o]==null)continue;let a=[];for(let s=n.column[0];s<=n.column[1];s++){let u;o+"_"+s in t?u=t[o+"_"+s]:u=e[o][s],a.push(u)}l.push(a)}return l}function Ty(e){if(e==null||e.row==null||e.row.length==0)return[];let n=[];for(let t=e.row[0];t<=e.row[1];t++){let l=[];if(!(h.config.rowhidden!=null&&h.config.rowhidden[t]!=null)){for(let o=e.column[0];o<=e.column[1];o++){let a="";h.flowdata[t]!=null&&h.flowdata[t][o]!=null&&(a=h.flowdata[t][o]),l.push(a)}n.push(l)}}return n}function Vt(e,n,t,l){l==null&&(l="v"),t==null&&(t=h.flowdata);let o;if(e!=null&&n!=null)o=t[e][n];else if(e!=null)o=t[e];else if(n!=null)o=t[0].map(function(u,f){return t.map(function(m){return m[f]})})[n];else return t;let a=o;return G(o)=="object"&&(a=o[l],l=="f"&&a!=null?a=y.functionHTMLGenerate(a):l=="f"?a=o.v:o&&o.ct&&o.ct.t=="d"&&(a=o.m)),a==null&&(a=null),a}function cn(e,n,t,l){if(n<=0&&t<=0)return e;n<=0&&(n=0),t<=0&&(t=0);let o=0;e.length==0?(e=[],o=0):o=e[0].length;let a=[];for(let u=0;u<t;u++)a.push(null);let s=[];for(let u=0;u<o+t;u++)s.push(null);for(let u=0;u<e.length;u++)e[u]=[].concat(e[u].concat(a));for(let u=0;u<n;u++)e.push([].concat(s));return l&&(Ue.saveParam("all",h.currentSheetIndex,e.length,{k:"row"}),Ue.saveParam("all",h.currentSheetIndex,e[0].length,{k:"column"})),e}function Ti(e,n,t,l){let o;return l!=null?o=l[e][n]:o=Ix(e,n,t),o==null?null:o.f}function Ix(e,n,t){if(e==null||n==null)return;let l;if(t==null?l=h.flowdata:l=kt.getSheetByIndex(t).data,!(!l||!l[e]||!l[e][n]))return l[e][n]}function Fm(e,n){let t=Vt(e,n,null,"m");if(t==null&&(t=Vt(e,n),t==null)){let l=Vt(e,n,null,"ct");Yc(l)&&(t=l.s)}return t}function Ry(e,n){let t=Vt(e,n,null,"ct");if(Yc(t)){let l=t.s,o="";for(let a=0;a<l.length;a++){let s=l[a];s.v!=null&&(o+=s.v)}return o}return""}function Fy(e,n,t){let l=Vt(e,n,t,"ct");t==null&&(t=h.flowdata);let o=t[e][n];if(Yc(l)){let a=l.s,s="";for(let u=0;u<a.length;u++){let f=a[u];if(f.v!=null){let m=Qu(f);s+="<span index='"+u+"' style='"+m+"'>"+f.v+"</span>"}}return s}return""}function Qu(e,n,t,l=!0){if(e==null)return;let o="",s=Be().fontarray;for(let u in e){let f=e[u];if(l&&(f=Fo(e,u)),u=="bl"&&f!="0"&&(o+="font-weight: bold;"),u=="it"&&f!="0"&&(o+="font-style:italic;"),u=="ff"){let m=f;isNaN(parseInt(f))?m=f:m=s[parseInt(f)],o+="font-family: "+m+";"}u=="fs"&&f!="10"&&(o+="font-size: "+f+"pt;"),(u=="fc"&&f!="#000000"||n!=null||t!=null&&t.textColor!=null)&&(t!=null&&t.textColor!=null?o+="color: "+t.textColor+";":n!=null?o+="color: "+n[0]+";":o+="color: "+f+";"),u=="cl"&&f!="0"&&(o+="text-decoration: line-through;")}return o}function Fo(e,n){let t=e;return n in{bl:1,it:1,ff:1,cl:1,un:1}||n=="fs"&&Wn(e)?t==null?t="0":(t=t[n],t==null&&(t="0")):n=="fc"?t==null?t="#000000":(t=t[n],t==null&&(t="#000000"),t.indexOf("rgba")>-1&&(t=_s(t))):n=="bg"?t==null?t=null:(t=t[n],t==null?t=null:t.toString().indexOf("rgba")>-1&&(t=_s(t))):n.substr(0,2)=="bs"?t==null?t="none":(t=t[n],t==null&&(t="none")):n.substr(0,2)=="bc"?t==null?t="#000000":(t=t[n],t==null&&(t="#000000")):n=="ht"?(t==null?t="1":(t=t[n],t==null&&(t="1")),["0","1","2"].indexOf(t.toString())==-1&&(t="1")):n=="vt"?(t==null?t="0":(t=t[n],t==null&&(t="0")),["0","1","2"].indexOf(t.toString())==-1&&(t="0")):n=="ct"?t==null?t=null:(t=t[n],t==null&&(t=null)):n=="fs"?t==null?t="10":(t=t[n],t==null&&(t="10")):n=="tb"||n=="tr"?t==null?t="0":(t=t[n],t==null&&(t="0")):n=="rt"&&(t==null?t=null:(t=t[n],t==null&&(t=null))),t}function bi(e){return e==null||e.length==0?e:e.replace(/^\s+|\s+$/gm,"")}var import_plugin,Er=Nt(()=>{import_plugin=qe(Ye());Ol();fr();qr();Sr();Wr();gh();kn();Ya();Xl();il()});function Tx(e,n){let t=0,l=e.length-1;for(;t<=l;){let o=parseInt((l+t)/2);if(n<e[o]&&(o==0||n>=e[o-1]))return o;if(n>=e[o])t=o+1;else if(n<e[o])l=o-1;else return-1}}function Rx(e,n){let t=0,l=0,o=0,a=-1,s=e.length-1;for(;t<e.length&&s>=0&&s>=t;){if(l=e[s],s==0?o=0:o=e[s-1],n>=o&&n<l){a=s;break}if(l=e[t],t==0?o=0:o=e[t-1],n>=o&&n<l){a=t;break}t++,s--}return a}function $l(e,n){let t=e.length-1;return e.length<40||n<=e[20]||n>=e[t-20]?t=Rx(e,n):t=Tx(e,n),t}var import_plugin,Go=Nt(()=>{import_plugin=qe(Ye())});function Zr(e){let n=0,t=0;return n=h.visibledatarow[e],e==0?t=0:t=h.visibledatarow[e-1],[t,n,e]}function Jl(e){let n=$l(h.visibledatarow,e);return n==-1&&e>0?n=h.visibledatarow.length-1:n==-1&&e<=0&&(n=0),Zr(n)}function or(e){let n=0,t=0;return n=h.visibledatacolumn[e],e==0?t=0:t=h.visibledatacolumn[e-1],[t,n,e]}function My(e,n){let t=0,l=0;return t=h.visibledatacolumn[e+n-1],e==0?l=0:l=h.visibledatacolumn[e-1],[l,t,e]}function Zl(e){let n=$l(h.visibledatacolumn,e);return n==-1&&e>0?n=h.visibledatacolumn.length-1:n==-1&&e<=0&&(n=0),or(n)}function wl(e,n){let t=$("#"+h.container).offset(),l=e-t.left-h.rowHeaderWidth,o=n-t.top-h.infobarHeight-h.toolbarHeight-h.calculatebarHeight-h.columnHeaderHeight;return[l,o]}var import_plugin,Ri=Nt(()=>{import_plugin=qe(Ye());Go();il()});function Cn(e,n,t,l){let o=$.extend(!0,{},l);o.rowlen==null&&(o.rowlen={}),o.customHeight==null&&(o.customHeight={});let a=$("#luckysheetTableContent").get(0).getContext("2d");a.textBaseline="top";for(let s=n;s<=t;s++){if(o.rowhidden!=null&&o.rowhidden[s]!=null)continue;let u=h.defaultrowlen;if(o.customHeight[s]!=1){delete o.rowlen[s];for(let f=0;f<e[s].length;f++){let m=e[s][f];if(m!=null&&m!=null&&(m.v!=null||Wn(m))){let d;if(m.mc)if(f===m.mc.c){let g=or(f)[0];d=or(m.mc.c+m.mc.cs-1)[1]-g-2}else continue;else d=or(f)[1]-or(f)[0]-2;let p=Mo(m,a,{r:s,c:f,cellWidth:d}),b=0;p!=null&&(b=p.textHeightAll+2),b>u&&(u=b)}}u=u/h.zoomRatio,u!=h.defaultrowlen?o.rowlen[s]=u:l.rowlen?.[s]&&(o.rowlen[s]=l.rowlen[s])}}return o}function Dy(e,n){let t=0,l=$("#luckysheetTableContent").get(0).getContext("2d");l.textBaseline="top";for(let o=0;o<e[n].length;o++){let a=e[n][o];if(a!=null&&!(a.mc!=null&&a.mc.rs!==1)&&!(h.config.colhidden!=null&&h.config.colhidden[o]!=null)&&a!=null&&(a.v!=null||Wn(a))){let s=Fx(a,o),u=Mo(a,l,{r:n,c:o,cellWidth:s}),f=0;u!=null&&(f=u.textHeightAll+2),f>t&&(t=f)}}return t}function Fx(e,n){let t=or(n);return e.mc&&e.mc.cs!==1&&(t=My(n,e.mc.cs)),t[1]-t[0]-2}function Ay(e,n,t){let l=0,o=yh(t,n),a=$("#luckysheetTableContent").get(0).getContext("2d");a.textBaseline="top";for(var s=0;s<e.length;s++){var u=e[s][n];if(u!=null&&(u.v!=null||Wn(u))){let f=o[n],m=Mo(u,a,{r:s,c:n,cellHeight:f}),d=0;m!=null&&(d=m.textWidthAll+2),d>l&&(l=d)}}return l}function yh(e,n){let t=[],l=0;for(let o=0;o<e;o++){let a=h.defaultrowlen;if(n.rowlen!=null&&n.rowlen[o]!=null&&(a=n.rowlen[o]),n.rowhidden!=null&&n.rowhidden[o]!=null){a=n.rowhidden[o],t.push(l);continue}else l+=a+1;t.push(l)}return t}function Yo(e,n,t){let l=h.measureTextCache[e+"_"+n.font];if(t!=null&&(l=h.measureTextCache[e+"_"+t]),l!=null)return l;{if(t!=null){let s=n.font;n.font=t}let o=n.measureText(e),a={};if(a.width=o.width,t!=null&&(n.font=t),a.actualBoundingBoxDescent=o.actualBoundingBoxDescent,a.actualBoundingBoxAscent=o.actualBoundingBoxAscent,a.actualBoundingBoxDescent==null||a.actualBoundingBoxAscent==null||isNaN(a.actualBoundingBoxDescent)||isNaN(a.actualBoundingBoxAscent)){let s="M";ds(e)&&(s="\u7530");let u=_t.getTextSize(s,n.font)[1]*.8;n.textBaseline=="top"?(a.actualBoundingBoxDescent=u,a.actualBoundingBoxAscent=0):n.textBaseline=="middle"?(a.actualBoundingBoxDescent=u/2,a.actualBoundingBoxAscent=u/2):(a.actualBoundingBoxDescent=0,a.actualBoundingBoxAscent=u)}if(n.textBaseline=="alphabetic"){let s="gjpqy",u="abcdABCD",f=h.measureTextCache[s+"_"+n.font];t!=null&&(f=h.measureTextCache[s+"_"+t]);let m=h.measureTextCache[u+"_"+n.font];t!=null&&(m=h.measureTextCache[u+"_"+t]),f==null&&(f=n.measureText(s)),m==null&&(m=n.measureText(u)),a.actualBoundingBoxDescent<=m.actualBoundingBoxDescent&&(a.actualBoundingBoxDescent=f.actualBoundingBoxDescent,a.actualBoundingBoxDescent==null&&(a.actualBoundingBoxDescent=0))}return a.width*=h.zoomRatio,a.actualBoundingBoxDescent*=h.zoomRatio,a.actualBoundingBoxAscent*=h.zoomRatio,h.measureTextCache[e+"_"+h.zoomRatio+"_"+n.font]=a,a}}function Mx(e){return e.measureText("\u7530").actualBoundingBoxAscent!=null}function Mo(e,n,t){let l=t.cellWidth,o=t.cellHeight,a="",s="";l==null&&(a="onlyWidth",s="_");let u=h.measureTextCellInfoCache[t.r+"_"+t.c+s+a];if(u!=null)return u;let f=t.space_width,m=t.space_height;f==null&&(f=2),m==null&&(m=2);let d=Fo(e,"ht"),p=Fo(e,"vt"),b=Fo(e,"tb"),g=Fo(e,"tr"),v=Fo(e,"rt"),x=1,_=0;v==null&&(g=="0"?v=0:g=="1"?v=45:g=="4"?v=90:g=="2"?v=135:g=="5"&&(v=180),v==null&&(v=0)),(v>180||v<0)&&(v=0),v=parseInt(v),v>90&&(v=90-v,x=0,_=1),n.textAlign="start";let S={};S.values=[];let I,P="0",F="0",D=11,k=!1,w,C=[];if(Wn(e)){let T=e.ct.s,O=0;for(let z=0;z<T.length;z++){let A=T[z],E=rc(A),L=A.fc,N=A.cl,W=A.un,X=A.v,te=A.fs;X=X.replace(/\r\n/g,"_x000D_").replace(/&#13;&#10;/g,"_x000D_").replace(/\r/g,"_x000D_").replace(/\n/g,"_x000D_");let ue=X.split("_x000D_");for(let pe=0;pe<ue.length;pe++){let ne=ue[pe];if(ne==""&&pe!=ue.length-1)C.push({fontset:E,fc:L??"#000",cl:N??0,un:W??0,wrap:!0,fs:te??11}),O++;else{let me=ne.split("");for(let Q=0;Q<me.length;Q++){let we=me[Q];C.push({fontset:E,fc:L??"#000",cl:N??0,un:W??0,v:we,si:O,fs:te??11})}pe!=ue.length-1&&(C.push({fontset:E,fc:L??"#000",cl:N??0,un:W??0,wrap:!0,fs:te??11}),O++)}}O++}k=!0}else if(I=rc(e),n.font=I,P=Fo(e,"cl"),F=Fo(e,"un"),D=Fo(e,"fs"),e instanceof Object?(w=e.m,w==null&&(w=e.v)):w=e,ft(w))return null;if(g=="3"){n.textBaseline="top";let T=0,O=0,z=0,A=0,E={},L=[];if(k){let X=null;for(let te=0;te<C.length;te++){let ue=C[te],pe=ue.v,ne=ue.v;if(ue.wrap===!0&&(pe="M",ne="",X!=null&&X.wrap!==!0&&te<C.length-1)){L.push(A),A=0,z+=1,X=ue;continue}let me=Yo(pe,n,ue.fontset),Q=me.width+f,we=me.actualBoundingBoxAscent+me.actualBoundingBoxDescent+m;A+=we,b=="2"&&!ue.wrap&&A>o&&E[z]!=null&&(L.push(A-we),A=we,z+=1),te==C.length-1&&L.push(A),E[z]==null&&(E[z]=[]);let ie={content:ne,style:ue,width:Q,height:we,left:0,top:0,colIndex:z,asc:me.actualBoundingBoxAscent,desc:me.actualBoundingBoxDescent,inline:!0};ue.wrap===!0&&(ie.wrap=!0),E[z].push(ie),console.log("normal",te,z,ue,X,E),X=ue}}else{let X=Yo(w,n),te=X.actualBoundingBoxDescent+X.actualBoundingBoxAscent;w=w.toString();let ue=[];w.length>1?ue=w.split(""):ue.push(w);let pe=Yo(ue[0],n).width;for(let ne=0;ne<ue.length;ne++){let me=pe+f,Q=te+m;A+=Q,b=="2"&&A>o&&E[z]!=null&&(L.push(A-Q),A=Q,z+=1),ne==ue.length-1&&L.push(A),E[z]==null&&(E[z]=[]),E[z].push({content:ue[ne],style:I,width:me,height:Q,left:0,top:0,colIndex:z,asc:X.actualBoundingBoxAscent,desc:X.actualBoundingBoxDescent})}}let N=[];for(let X=0;X<L.length;X++){let te=L[X],ue=E[X],pe=0;for(let ne=0;ne<ue.length;ne++){let me=ue[ne];pe=Math.max(pe,me.width)}N.push(pe),T+=pe,O=Math.max(O,te)}if(S.type="verticalWrap",S.textWidthAll=T,S.textHeightAll=O,a=="onlyWidth")return S;let W=0;for(let X=0;X<L.length;X++){let te=L[X],ue=N[X],pe=E[X],ne=0;for(let me=0;me<pe.length;me++){let Q=pe[me],we=f+W;d=="0"?we=l/2+W-T/2+f*L.length:d=="2"&&(we=l+W-T+f);let ie=o-m+ne-te;p=="0"?ie=o/2+ne-te/2:p=="1"&&(ie=m+ne),ne+=Q.height,Q.left=we,Q.top=ie,tf(Q,P,F,{width:ue,height:Q.height,left:we,top:ie+Q.height-m,asc:Q.height,desc:0,fs:D}),S.values.push(Q)}W+=ue}}else{let T=Mx(n);if(T?n.textBaseline="alphabetic":n.textBaseline="bottom",b=="2"||k){let O=0,z=0,A=0,E=0,L=0,N={},W=[];S.rotate=v,v=Math.abs(v);let X=0,te=0,ue=0,pe,ne,me,Q,we=1,ie={},ge=null,ce=null;if(k)for(;we<=C.length;){let Se=C.slice(X,we);if(Se[Se.length-1].wrap===!0){if(X=we,Se.length>1)for(let Le=0;Le<Se.length-1;Le++){let Ee=Se[Le],nt={content:Ee.v,style:Ee,width:Ee.measureText.width,height:Ee.measureText.actualBoundingBoxAscent+Ee.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:E,asc:Ee.measureText.actualBoundingBoxAscent,desc:Ee.measureText.actualBoundingBoxDescent,inline:!0,fs:Ee.fs};N[E].push(nt)}if(Se.length==1||we==C.length){let Le=Se[0],Ee=Yo("M",n,Le.fontset);N[E]==null&&(N[E]=[]),N[E].push({content:"",style:Le,width:Ee.width,height:Ee.actualBoundingBoxAscent+Ee.actualBoundingBoxDescent,left:0,top:0,splitIndex:E,asc:Ee.actualBoundingBoxAscent,desc:Ee.actualBoundingBoxDescent,inline:!0,wrap:!0,fs:Le.fs})}E+=1,we++;continue}let oe=0,be=0;for(let Le=0;Le<Se.length;Le++){let Ee=Se[Le];Ee.measureText==null&&(Ee.measureText=Yo(Ee.v,n,Ee.fontset)),oe+=Ee.measureText.width,be=Math.max(Ee.measureText.actualBoundingBoxAscent+Ee.measureText.actualBoundingBoxDescent)}let Te=oe*Math.cos(v*Math.PI/180)+be*Math.sin(v*Math.PI/180),Oe=oe*Math.sin(v*Math.PI/180)+be*Math.cos(v*Math.PI/180),Xe=Se[Se.length-1];if((Xe.v==" "||Vd(Xe.v)==2)&&(ce=we),v!=0)if(console.log(Oe,m,o,Se,Oe+m>o),Oe+m>o&&N[E]!=null&&b=="2"&&we!=C.length)if(ce!=null&&ce<we){for(let Le=0;Le<ce-X;Le++){let Ee=Se[Le];N[E].push({content:Ee.v,style:Ee,width:Ee.measureText.width,height:Ee.measureText.actualBoundingBoxAscent+Ee.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:E,asc:Ee.measureText.actualBoundingBoxAscent,desc:Ee.measureText.actualBoundingBoxDescent,inline:!0,fs:Ee.fs})}X=ce,we=ce+1,E+=1,ce=null}else{X=we-1;for(let Le=0;Le<Se.length-1;Le++){let Ee=Se[Le];N[E].push({content:Ee.v,style:Ee,width:Ee.measureText.width,height:Ee.measureText.actualBoundingBoxAscent+Ee.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:E,asc:Ee.measureText.actualBoundingBoxAscent,desc:Ee.measureText.actualBoundingBoxDescent,inline:!0,fs:Ee.fs})}E+=1}else if(we==C.length){N[E]==null&&(N[E]=[]);for(let Le=0;Le<Se.length;Le++){let Ee=Se[Le];N[E].push({content:Ee.v,style:Ee,width:Ee.measureText.width,height:Ee.measureText.actualBoundingBoxAscent+Ee.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:E,asc:Ee.measureText.actualBoundingBoxAscent,desc:Ee.measureText.actualBoundingBoxDescent,inline:!0,fs:Ee.fs})}break}else N[E]==null&&(N[E]=[]),we++;else if(Te+f>l&&N[E]!=null&&b=="2"&&we!=C.length)if(ce!=null&&ce<we){for(let Le=0;Le<ce-X;Le++){let Ee=Se[Le];N[E].push({content:Ee.v,style:Ee,width:Ee.measureText.width,height:Ee.measureText.actualBoundingBoxAscent+Ee.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:E,asc:Ee.measureText.actualBoundingBoxAscent,desc:Ee.measureText.actualBoundingBoxDescent,inline:!0,fs:Ee.fs})}X=ce,we=ce+1,E+=1,ce=null}else{X=we-1;for(let Le=0;Le<Se.length-1;Le++){let Ee=Se[Le];N[E].push({content:Ee.v,style:Ee,width:Ee.measureText.width,height:Ee.measureText.actualBoundingBoxAscent+Ee.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:E,asc:Ee.measureText.actualBoundingBoxAscent,desc:Ee.measureText.actualBoundingBoxDescent,inline:!0,fs:Ee.fs})}E+=1}else if(we==C.length){N[E]==null&&(N[E]=[]);for(let Le=0;Le<Se.length;Le++){let Ee=Se[Le];N[E].push({content:Ee.v,style:Ee,width:Ee.measureText.width,height:Ee.measureText.actualBoundingBoxAscent+Ee.measureText.actualBoundingBoxDescent,left:0,top:0,splitIndex:E,asc:Ee.measureText.actualBoundingBoxAscent,desc:Ee.measureText.actualBoundingBoxDescent,inline:!0,fs:Ee.fs})}break}else N[E]==null&&(N[E]=[]),we++}else for(w=w.toString();we<=w.length;){let Se=w.substring(X,we),oe=Yo(Se,n),be=oe.width,Te=oe.actualBoundingBoxAscent+oe.actualBoundingBoxDescent,Oe=be*Math.cos(v*Math.PI/180)+Te*Math.sin(v*Math.PI/180),Xe=be*Math.sin(v*Math.PI/180)+Te*Math.cos(v*Math.PI/180),Le=Se.substr(Se.length-1,1);if((Le==" "||Vd(Le)==2)&&Q!=null&&(ge={index:we,str:pe+Le,width:me,height:ne,asc:Q.actualBoundingBoxAscent,desc:Q.actualBoundingBoxDescent}),v!=0)if(Xe+m>o&&N[E]!=null&&we!=w.length)ge!=null&&ge.index<we?(X=ge.index,we=ge.index+1,N[E].push({content:ge.str,style:I,width:ge.width,height:ge.height,left:0,top:0,splitIndex:E,asc:ge.asc,desc:ge.desc,fs:D}),E+=1,ge=null):(X=we-1,N[E].push({content:pe,style:I,left:0,top:0,splitIndex:E,height:ne,width:me,asc:oe.actualBoundingBoxAscent,desc:oe.actualBoundingBoxDescent,fs:D}),E+=1);else if(we==w.length){N[E]==null&&(N[E]=[]),N[E].push({content:Se,style:I,left:0,top:0,splitIndex:E,height:Te,width:be,asc:oe.actualBoundingBoxAscent,desc:oe.actualBoundingBoxDescent,fs:D});break}else N[E]==null&&(N[E]=[]),we++;else if(Oe+f>l&&N[E]!=null&&we!=w.length)ge!=null&&ge.index<we?(X=ge.index,we=ge.index+1,N[E].push({content:ge.str,style:I,width:ge.width,height:ge.height,left:0,top:0,splitIndex:E,asc:ge.asc,desc:ge.desc,fs:D}),E+=1,ge=null):(ge=null,X=we-1,N[E].push({content:pe,style:I,width:me,height:ne,left:0,top:0,splitIndex:E,asc:oe.actualBoundingBoxAscent,desc:oe.actualBoundingBoxDescent,fs:D}),E+=1);else if(we==w.length){N[E]==null&&(N[E]=[]),N[E].push({content:Se,style:I,width:be,height:Te,left:0,top:0,splitIndex:E,asc:oe.actualBoundingBoxAscent,desc:oe.actualBoundingBoxDescent,fs:D});break}else N[E]==null&&(N[E]=[]),we++;pe=Se,ne=Te,me=be,Q=oe}let fe=[],ye=0,Ne=Object.keys(N).length;for(let Se=0;Se<Ne;Se++){let oe=N[Se];if(oe==null)continue;let be=0,Te=0,Oe=0,Xe=0,Le=0,Ee=0;for(let nt=0;nt<oe.length;nt++){let Ze=oe[nt];v!=0,be+=Ze.width,Te=Math.max(Te,Ze.height-(T?Ze.desc:0)),Oe=Math.max(Oe,T?Ze.desc:0),Xe=Math.max(Xe,Ze.asc),Ee++}Le=Te/2,ye=Math.max(ye,Ee),v!=0?(Te+=Le,A=Math.max(A,be),z+=Te):(Te+=Le,O=Math.max(O,be),z+=Te),fe.push({width:be,height:Te,desc:Oe,asc:Xe,lineHeight:Le,wordCount:Ee})}let xe=0,et=0,Fe=v*Math.PI/180,it=fe[Ne-1],wt=it.lineHeight;z=z-wt+it.desc;let ot=z/Math.sin(Fe)+A*Math.cos(Fe),xt=A*Math.sin(Fe),Ft=0;if(v!=0?(Ne==1?(O=A+2*(z/Math.tan(Fe)),Ft=z/Math.tan(Fe)):O=A+z/Math.tan(Fe),S.textWidthAll=ot,S.textHeightAll=xt):(S.textWidthAll=O,S.textHeightAll=z),a=="onlyWidth")return S;if(v!=0&&x=="1"){n.textAlign="end";for(let Se=0;Se<Ne;Se++){let oe=N[Se];if(oe==null)continue;let be=fe[Se];et=0;for(let Te=oe.length-1;Te>=0;Te--){let Oe=oe[Te],Xe,Le;if(v!=0){let Ee,nt=xe+be.asc;if(Ee=xe/Math.tan(Fe)-et+A,d=="0"){let Ze=z/Math.sin(Fe);p=="0"?(Xe=Ee+l/2-O/2+wt*Math.cos(Fe)/2,Le=nt+o/2-z/2-wt*Math.cos(Fe)/2):p=="1"?(Xe=Ee+l/2-O/2,Le=nt-(z/2-xt/2)):p=="2"&&(Xe=Ee+l/2-O/2+wt*Math.cos(Fe),Le=nt+o-xt/2-z/2-wt*Math.cos(Fe))}else d=="1"?p=="0"?(Xe=Ee-xt*Math.sin(Fe)/2+wt*Math.cos(Fe)/2,Le=nt+o/2+xt*Math.cos(Fe)/2-wt*Math.cos(Fe)/2):p=="1"?(Xe=Ee-xt*Math.sin(Fe),Le=nt+xt*Math.cos(Fe)):p=="2"&&(Xe=Ee+wt*Math.cos(Fe),Le=nt+o-wt*Math.cos(Fe)):d=="2"&&(p=="0"?(Xe=Ee+l-ot/2-(A/2+z/2/Math.tan(Fe))+wt*Math.cos(Fe)/2,Le=nt+o/2-z/2-wt*Math.cos(Fe)/2):p=="1"?(Xe=Ee+l-O+Ft,Le=nt-z):p=="2"&&(Xe=Ee+l-ot*Math.cos(Fe)+wt*Math.cos(Fe),Le=nt+o-ot*Math.sin(Fe)-wt*Math.cos(Fe)))}Oe.left=Xe,Oe.top=Le,tf(Oe,P,F,{width:Oe.width,height:Oe.height,left:Xe-Oe.width,top:Le,asc:be.asc,desc:be.desc,fs:Oe.fs}),S.values.push(Oe),et+=Oe.width}xe+=be.height}}else for(let Se=0;Se<Ne;Se++){let oe=N[Se];if(oe==null)continue;let be=fe[Se];et=0;for(let Te=0;Te<oe.length;Te++){let Oe=oe[Te],Xe,Le;if(v!=0){let Ee,nt=xe+be.asc;if(Ee=(z-xe)/Math.tan(Fe)+et,d=="0"){let Ze=z/Math.sin(Fe);p=="0"?(Xe=Ee+l/2-O/2-wt*Math.cos(Fe)/2,Le=nt+o/2-z/2+wt*Math.cos(Fe)/2):p=="1"?(Xe=Ee+l/2-O/2-wt*Math.cos(Fe)/2,Le=nt-(z/2-xt/2)+wt*Math.cos(Fe)/2):p=="2"&&(Xe=Ee+l/2-O/2-wt*Math.cos(Fe),Le=nt+o-xt/2-z/2-wt*Math.cos(Fe))}else d=="1"?p=="0"?(Xe=Ee-xt*Math.sin(Fe)/2-wt*Math.cos(Fe)/2,Le=nt-z+o/2-xt*Math.cos(Fe)/2-wt*Math.cos(Fe)/2):p=="1"?(Xe=Ee,Le=nt-z):p=="2"&&(Xe=Ee-xt*Math.sin(Fe)-wt*Math.cos(Fe),Le=nt-z+o-xt*Math.cos(Fe)-wt*Math.cos(Fe)):d=="2"&&(p=="0"?(Xe=Ee+l-ot/2-O/2-wt*Math.cos(Fe)/2,Le=nt+o/2-z/2-wt*Math.cos(Fe)/2):p=="1"?(Xe=Ee+l-ot*Math.cos(Fe),Le=nt+xt*Math.cos(Fe)):p=="2"&&(Xe=Ee+l-O-wt*Math.cos(Fe)+Ft,Le=nt+o-wt*Math.cos(Fe)));tf(Oe,P,F,{width:Oe.width,height:Oe.height,left:Xe,top:Le,asc:be.asc,desc:be.desc,fs:Oe.fs})}else Xe=f+et,d=="0"?Xe=l/2+et-be.width/2:d=="2"&&(Xe=l+et-be.width),Le=o-m+xe+be.asc-z,p=="0"?Le=o/2+xe-z/2+be.asc:p=="1"&&(Le=m+xe+be.asc),tf(Oe,P,F,{width:Oe.width,height:Oe.height,left:Xe,top:Le,asc:be.asc,desc:be.desc,fs:Oe.fs});Oe.left=Xe,Oe.top=Le,S.values.push(Oe),et+=Oe.width}xe+=be.height}S.type="plainWrap",v!=0&&(d=="0"?p=="0"?(S.textLeftAll=l/2,S.textTopAll=o/2):p=="1"?(S.textLeftAll=l/2,S.textTopAll=xt/2):p=="2"&&(S.textLeftAll=l/2,S.textTopAll=o-xt/2):d=="1"?p=="0"?(S.textLeftAll=0,S.textTopAll=o/2):p=="1"?(S.textLeftAll=0,S.textTopAll=0):p=="2"&&(S.textLeftAll=0,S.textTopAll=o):d=="2"&&(p=="0"?(S.textLeftAll=l-ot/2,S.textTopAll=o/2):p=="1"?(S.textLeftAll=l,S.textTopAll=0):p=="2"&&(S.textLeftAll=l,S.textTopAll=o)))}else{let O=Yo(w,n),z=O.width,A=O.actualBoundingBoxDescent+O.actualBoundingBoxAscent;S.rotate=v,v=Math.abs(v);let E=v*Math.PI/180,L=z*Math.cos(E)+A*Math.sin(E),N=z*Math.sin(E)+A*Math.cos(E);if(v!=0?S.textHeightAll=N:S.textHeightAll=N+A/2-O.actualBoundingBoxDescent-m,S.textWidthAll=L,a=="onlyWidth")return S;let W=L,X=N,te=f+A*Math.sin(E)*x;d=="0"?te=l/2-W/2+A*Math.sin(E)*x:d=="2"&&(te=l-f-W+A*Math.sin(E)*x);let ue=o-m-X+O.actualBoundingBoxAscent*Math.cos(E)+z*Math.sin(E)*x;p=="0"?ue=o/2-X/2+O.actualBoundingBoxAscent*Math.cos(E)+z*Math.sin(E)*x:p=="1"&&(ue=m+O.actualBoundingBoxAscent*Math.cos(E)+z*Math.sin(E)*x),S.type="plain";let pe={content:w,style:I,width:W,height:X,left:te,top:ue};tf(pe,P,F,{width:z,height:A,left:te,top:ue,asc:O.actualBoundingBoxAscent,desc:O.actualBoundingBoxDescent,fs:D}),S.values.push(pe),S.textLeftAll=te,S.textTopAll=ue,S.asc=O.actualBoundingBoxAscent,S.desc=O.actualBoundingBoxDescent}}return S}function tf(e,n,t,l){let o=l.left,a=l.top,s=l.width,u=l.height,f=l.asc,m=l.desc,d=l.fs;if(e.wrap!==!0&&(e.inline==!0&&e.style!=null&&(n=e.style.cl,t=e.style.un),n!="0"&&(e.cancelLine={},e.cancelLine.startX=o,e.cancelLine.startY=a-f/2+1,e.cancelLine.endX=o+s,e.cancelLine.endY=a-f/2+1,e.cancelLine.fs=d),t!="0")){if(e.underLine=[],t=="1"||t=="2"){let p={};p.startX=o,p.startY=a+3,p.endX=o+s,p.endY=a+3,p.fs=d,e.underLine.push(p)}if(t=="2"){let p={};p.startX=o,p.startY=a+m,p.endX=o+s,p.endY=a+m,p.fs=d,e.underLine.push(p)}if(t=="3"||t=="4"){let p={};p.startX=o,p.startY=a+m,p.endX=o+s,p.endY=a+m,p.fs=d,e.underLine.push(p)}if(t=="4"){let p={};p.startX=o,p.startY=a+m+2,p.endX=o+s,p.endY=a+m+2,p.fs=d,e.underLine.push(p)}}}var import_plugin,fo=Nt(()=>{import_plugin=qe(Ye());Ol();ln();Er();Ri();cr();Ya();il()});function Xa(e,n){if(Dx(),e!=null){h.visibledatarow=[],h.rh_height=0;for(let t=0;t<e;t++){let l=h.defaultrowlen;if(h.config.rowlen!=null&&h.config.rowlen[t]!=null&&(l=h.config.rowlen[t]),h.config.rowhidden!=null&&h.config.rowhidden[t]!=null){h.visibledatarow.push(h.rh_height);continue}l==="auto"&&(l=Dy(h.flowdata,t)),h.rh_height+=Math.round((l+1)*h.zoomRatio),h.visibledatarow.push(h.rh_height)}!ut.enableAddRow&&!ut.enableAddBackTop?h.rh_height+=29:h.rh_height+=80}if(n!=null){h.visibledatacolumn=[],h.ch_width=0;let t=120;for(let l=0;l<n;l++){let o=h.defaultcollen;if(h.config.columnlen!=null&&h.config.columnlen[l]!=null?o=h.config.columnlen[l]:h.flowdata[0]!=null&&h.flowdata[0][l]!=null&&(o>300?o=300:o<h.defaultcollen&&(o=h.defaultcollen),o!=h.defaultcollen&&(h.config.columnlen==null&&(h.config.columnlen={}),h.config.columnlen[l]=o)),h.config.colhidden!=null&&h.config.colhidden[l]!=null){h.visibledatacolumn.push(h.ch_width);continue}o==="auto"&&(o=Ay(h.flowdata,l,e)),h.ch_width+=Math.round((o+1)*h.zoomRatio),h.visibledatacolumn.push(h.ch_width)}h.ch_width+=t}}function Dx(){h.rowHeaderWidth=ut.rowHeaderWidth*h.zoomRatio,h.columnHeaderHeight=ut.columnHeaderHeight*h.zoomRatio,$("#luckysheet-rows-h").width(h.rowHeaderWidth-1.5),$("#luckysheet-cols-h-c").height(h.columnHeaderHeight-1.5),$("#luckysheet-left-top").css({width:h.rowHeaderWidth-1.5,height:h.columnHeaderHeight-1.5})}var import_plugin,lf=Nt(()=>{import_plugin=qe(Ye());il();fo();Vn()});var Za=Fn((Mm,Dm)=>{var import_plugin=qe(Ye());(function(e,n){typeof Mm=="object"&&typeof Dm!="undefined"?Dm.exports=n():typeof define=="function"&&define.amd?define(n):e.dayjs=n()})(Mm,function(){"use strict";var e="millisecond",n="second",t="minute",l="hour",o="day",a="week",s="month",u="quarter",f="year",m="date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,b={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},g=function(w,C,T){var O=String(w);return!O||O.length>=C?w:""+Array(C+1-O.length).join(T)+w},v={s:g,z:function(w){var C=-w.utcOffset(),T=Math.abs(C),O=Math.floor(T/60),z=T%60;return(C<=0?"+":"-")+g(O,2,"0")+":"+g(z,2,"0")},m:function w(C,T){if(C.date()<T.date())return-w(T,C);var O=12*(T.year()-C.year())+(T.month()-C.month()),z=C.clone().add(O,s),A=T-z<0,E=C.clone().add(O+(A?-1:1),s);return+(-(O+(T-z)/(A?z-E:E-z))||0)},a:function(w){return w<0?Math.ceil(w)||0:Math.floor(w)},p:function(w){return{M:s,y:f,w:a,d:o,D:m,h:l,m:t,s:n,ms:e,Q:u}[w]||String(w||"").toLowerCase().replace(/s$/,"")},u:function(w){return w===void 0}},x="en",_={};_[x]=b;var S=function(w){return w instanceof D},I=function(w,C,T){var O;if(!w)return x;if(typeof w=="string")_[w]&&(O=w),C&&(_[w]=C,O=w);else{var z=w.name;_[z]=w,O=z}return!T&&O&&(x=O),O||!T&&x},P=function(w,C){if(S(w))return w.clone();var T=typeof C=="object"?C:{};return T.date=w,T.args=arguments,new D(T)},F=v;F.l=I,F.i=S,F.w=function(w,C){return P(w,{locale:C.$L,utc:C.$u,x:C.$x,$offset:C.$offset})};var D=function(){function w(T){this.$L=I(T.locale,null,!0),this.parse(T)}var C=w.prototype;return C.parse=function(T){this.$d=function(O){var z=O.date,A=O.utc;if(z===null)return new Date(NaN);if(F.u(z))return new Date;if(z instanceof Date)return new Date(z);if(typeof z=="string"&&!/Z$/i.test(z)){var E=z.match(d);if(E){var L=E[2]-1||0,N=(E[7]||"0").substring(0,3);return A?new Date(Date.UTC(E[1],L,E[3]||1,E[4]||0,E[5]||0,E[6]||0,N)):new Date(E[1],L,E[3]||1,E[4]||0,E[5]||0,E[6]||0,N)}}return new Date(z)}(T),this.$x=T.x||{},this.init()},C.init=function(){var T=this.$d;this.$y=T.getFullYear(),this.$M=T.getMonth(),this.$D=T.getDate(),this.$W=T.getDay(),this.$H=T.getHours(),this.$m=T.getMinutes(),this.$s=T.getSeconds(),this.$ms=T.getMilliseconds()},C.$utils=function(){return F},C.isValid=function(){return this.$d.toString()!=="Invalid Date"},C.isSame=function(T,O){var z=P(T);return this.startOf(O)<=z&&z<=this.endOf(O)},C.isAfter=function(T,O){return P(T)<this.startOf(O)},C.isBefore=function(T,O){return this.endOf(O)<P(T)},C.$g=function(T,O,z){return F.u(T)?this[O]:this.set(z,T)},C.unix=function(){return Math.floor(this.valueOf()/1e3)},C.valueOf=function(){return this.$d.getTime()},C.startOf=function(T,O){var z=this,A=!!F.u(O)||O,E=F.p(T),L=function(me,Q){var we=F.w(z.$u?Date.UTC(z.$y,Q,me):new Date(z.$y,Q,me),z);return A?we:we.endOf(o)},N=function(me,Q){return F.w(z.toDate()[me].apply(z.toDate("s"),(A?[0,0,0,0]:[23,59,59,999]).slice(Q)),z)},W=this.$W,X=this.$M,te=this.$D,ue="set"+(this.$u?"UTC":"");switch(E){case f:return A?L(1,0):L(31,11);case s:return A?L(1,X):L(0,X+1);case a:var pe=this.$locale().weekStart||0,ne=(W<pe?W+7:W)-pe;return L(A?te-ne:te+(6-ne),X);case o:case m:return N(ue+"Hours",0);case l:return N(ue+"Minutes",1);case t:return N(ue+"Seconds",2);case n:return N(ue+"Milliseconds",3);default:return this.clone()}},C.endOf=function(T){return this.startOf(T,!1)},C.$set=function(T,O){var z,A=F.p(T),E="set"+(this.$u?"UTC":""),L=(z={},z[o]=E+"Date",z[m]=E+"Date",z[s]=E+"Month",z[f]=E+"FullYear",z[l]=E+"Hours",z[t]=E+"Minutes",z[n]=E+"Seconds",z[e]=E+"Milliseconds",z)[A],N=A===o?this.$D+(O-this.$W):O;if(A===s||A===f){var W=this.clone().set(m,1);W.$d[L](N),W.init(),this.$d=W.set(m,Math.min(this.$D,W.daysInMonth())).$d}else L&&this.$d[L](N);return this.init(),this},C.set=function(T,O){return this.clone().$set(T,O)},C.get=function(T){return this[F.p(T)]()},C.add=function(T,O){var z,A=this;T=Number(T);var E=F.p(O),L=function(X){var te=P(A);return F.w(te.date(te.date()+Math.round(X*T)),A)};if(E===s)return this.set(s,this.$M+T);if(E===f)return this.set(f,this.$y+T);if(E===o)return L(1);if(E===a)return L(7);var N=(z={},z[t]=6e4,z[l]=36e5,z[n]=1e3,z)[E]||1,W=this.$d.getTime()+T*N;return F.w(W,this)},C.subtract=function(T,O){return this.add(-1*T,O)},C.format=function(T){var O=this;if(!this.isValid())return"Invalid Date";var z=T||"YYYY-MM-DDTHH:mm:ssZ",A=F.z(this),E=this.$locale(),L=this.$H,N=this.$m,W=this.$M,X=E.weekdays,te=E.months,ue=function(Q,we,ie,ge){return Q&&(Q[we]||Q(O,z))||ie[we].substr(0,ge)},pe=function(Q){return F.s(L%12||12,Q,"0")},ne=E.meridiem||function(Q,we,ie){var ge=Q<12?"AM":"PM";return ie?ge.toLowerCase():ge},me={YY:String(this.$y).slice(-2),YYYY:this.$y,M:W+1,MM:F.s(W+1,2,"0"),MMM:ue(E.monthsShort,W,te,3),MMMM:ue(te,W),D:this.$D,DD:F.s(this.$D,2,"0"),d:String(this.$W),dd:ue(E.weekdaysMin,this.$W,X,2),ddd:ue(E.weekdaysShort,this.$W,X,3),dddd:X[this.$W],H:String(L),HH:F.s(L,2,"0"),h:pe(1),hh:pe(2),a:ne(L,N,!0),A:ne(L,N,!1),m:String(N),mm:F.s(N,2,"0"),s:String(this.$s),ss:F.s(this.$s,2,"0"),SSS:F.s(this.$ms,3,"0"),Z:A};return z.replace(p,function(Q,we){return we||me[Q]||A.replace(":","")})},C.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},C.diff=function(T,O,z){var A,E=F.p(O),L=P(T),N=6e4*(L.utcOffset()-this.utcOffset()),W=this-L,X=F.m(this,L);return X=(A={},A[f]=X/12,A[s]=X,A[u]=X/3,A[a]=(W-N)/6048e5,A[o]=(W-N)/864e5,A[l]=W/36e5,A[t]=W/6e4,A[n]=W/1e3,A)[E]||W,z?X:F.a(X)},C.daysInMonth=function(){return this.endOf(s).$D},C.$locale=function(){return _[this.$L]},C.locale=function(T,O){if(!T)return this.$L;var z=this.clone(),A=I(T,O,!0);return A&&(z.$L=A),z},C.clone=function(){return F.w(this.$d,this)},C.toDate=function(){return new Date(this.valueOf())},C.toJSON=function(){return this.isValid()?this.toISOString():null},C.toISOString=function(){return this.$d.toISOString()},C.toString=function(){return this.$d.toUTCString()},w}(),k=D.prototype;return P.prototype=k,[["$ms",e],["$s",n],["$m",t],["$H",l],["$W",o],["$M",s],["$y",f],["$D",m]].forEach(function(w){k[w[1]]=function(C){return this.$g(C,w[0],w[1])}}),P.extend=function(w,C){return w.$i||(w(C,D,P),w.$i=!0),P},P.locale=I,P.isDayjs=S,P.unix=function(w){return P(1e3*w)},P.en=_[x],P.Ls=_,P.p={},P})});function dr(e){if(e==null||e.toString().length<5)return!1;return!!n(e);function n(t){var l=/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/,o=/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/;if(!l.test(t)&&!o.test(t))return!1;var a=RegExp.$1,s=RegExp.$2,u=RegExp.$3;if(a<1900||s>12||u>31)return!1;if(s==2){if(new Date(a,1,29).getDate()==29&&u>29)return!1;if(new Date(a,1,29).getDate()!=29&&u>28)return!1}return!0}}function un(e,n){return(0,Am.default)(e).diff((0,Am.default)(n))}function Cs(e){let n={};return dr(e)&&(n.date=!0),!isNaN(parseFloat(e))&&!ds(e)&&(n.num=!0),n}function Yi(e){let n="string";return dr(e)?n="date":!isNaN(parseFloat(e))&&!ds(e)&&(n="num"),n}var import_plugin,Am,Xo=Nt(()=>{import_plugin=qe(Ye());cr();Am=qe(Za())});var nc=Fn((zy,kh)=>{var import_plugin=qe(Ye());(function(e,n){typeof define=="function"&&define.amd?define(n):typeof kh=="object"&&kh.exports?kh.exports=n():e.numeral=n()})(zy,function(){var e,n,t="2.0.6",l={},o={},a={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},s={currentLocale:a.currentLocale,zeroFormat:a.zeroFormat,nullFormat:a.nullFormat,defaultFormat:a.defaultFormat,scalePercentBy100:a.scalePercentBy100};function u(f,m){this._input=f,this._value=m}return e=function(f){var m,d,p,b;if(e.isNumeral(f))m=f.value();else if(f===0||typeof f=="undefined")m=0;else if(f===null||n.isNaN(f))m=null;else if(typeof f=="string")if(s.zeroFormat&&f===s.zeroFormat)m=0;else if(s.nullFormat&&f===s.nullFormat||!f.replace(/[^0-9]+/g,"").length)m=null;else{for(d in l)if(b=typeof l[d].regexps.unformat=="function"?l[d].regexps.unformat():l[d].regexps.unformat,b&&f.match(b)){p=l[d].unformat;break}p=p||e._.stringToNumber,m=p(f)}else m=Number(f)||null;return new u(f,m)},e.version=t,e.isNumeral=function(f){return f instanceof u},e._=n={numberToFormat:function(f,m,d){var p=o[e.options.currentLocale],b=!1,g=!1,v=0,x="",_=1e12,S=1e9,I=1e6,P=1e3,F="",D=!1,k,w,C,T,O,z,A,E,L,N;if(f=f||0,w=Math.abs(f),e._.includes(m,"(")?(b=!0,m=m.replace(/[\(|\)]/g,"")):(e._.includes(m,"+")||e._.includes(m,"-"))&&(E=e._.includes(m,"+")?m.indexOf("+"):f<0?m.indexOf("-"):-1,m=m.replace(/[\+|\-]/g,"")),e._.includes(m,"a")&&(k=m.match(/a(k|m|b|t)?/),k=k?k[1]:!1,e._.includes(m," a")&&(x=" "),m=m.replace(new RegExp(x+"a[kmbt]?"),""),w>=_&&!k||k==="t"?(x+=p.abbreviations.trillion,f=f/_):w<_&&w>=S&&!k||k==="b"?(x+=p.abbreviations.billion,f=f/S):w<S&&w>=I&&!k||k==="m"?(x+=p.abbreviations.million,f=f/I):(w<I&&w>=P&&!k||k==="k")&&(x+=p.abbreviations.thousand,f=f/P)),e._.includes(m,"[.]")&&(g=!0,m=m.replace("[.]",".")),z=f.toString().split(".")[0],A=m.split(".")[1],L=m.indexOf(","),v=(m.split(".")[0].split(",")[0].match(/0/g)||[]).length,A?(e._.includes(A,"[")?(A=A.replace("]",""),A=A.split("["),F=e._.toFixed(f,A[0].length+A[1].length,d,A[1].length)):F=e._.toFixed(f,A.length,d),z=F.split(".")[0],e._.includes(F,".")?F=p.delimiters.decimal+F.split(".")[1]:F="",g&&Number(F.slice(1))===0&&(F="")):z=e._.toFixed(f,0,d),x&&!k&&Number(z)>=1e3&&x!==p.abbreviations.trillion)switch(z=String(Number(z)/1e3),x){case p.abbreviations.thousand:x=p.abbreviations.million;break;case p.abbreviations.million:x=p.abbreviations.billion;break;case p.abbreviations.billion:x=p.abbreviations.trillion;break}if(e._.includes(z,"-")&&(z=z.slice(1),D=!0),z.length<v)for(var W=v-z.length;W>0;W--)z="0"+z;return L>-1&&(z=z.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p.delimiters.thousands)),m.indexOf(".")===0&&(z=""),N=z+F+(x||""),b?N=(b&&D?"(":"")+N+(b&&D?")":""):E>=0?N=E===0?(D?"-":"+")+N:N+(D?"-":"+"):D&&(N="-"+N),N},stringToNumber:function(f){var m=o[s.currentLocale],d=f,p={thousand:3,million:6,billion:9,trillion:12},b,g,v,x;if(s.zeroFormat&&f===s.zeroFormat)g=0;else if(s.nullFormat&&f===s.nullFormat||!f.replace(/[^0-9]+/g,"").length)g=null;else{g=1,m.delimiters.decimal!=="."&&(f=f.replace(/\./g,"").replace(m.delimiters.decimal,"."));for(b in p)if(x=new RegExp("[^a-zA-Z]"+m.abbreviations[b]+"(?:\\)|(\\"+m.currency.symbol+")?(?:\\))?)?$"),d.match(x)){g*=Math.pow(10,p[b]);break}g*=(f.split("-").length+Math.min(f.split("(").length-1,f.split(")").length-1))%2?1:-1,f=f.replace(/[^0-9\.]+/g,""),g*=Number(f)}return g},isNaN:function(f){return typeof f=="number"&&isNaN(f)},includes:function(f,m){return f.indexOf(m)!==-1},insert:function(f,m,d){return f.slice(0,d)+m+f.slice(d)},reduce:function(f,m){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof m!="function")throw new TypeError(m+" is not a function");var d=Object(f),p=d.length>>>0,b=0,g;if(arguments.length===3)g=arguments[2];else{for(;b<p&&!(b in d);)b++;if(b>=p)throw new TypeError("Reduce of empty array with no initial value");g=d[b++]}for(;b<p;b++)b in d&&(g=m(g,d[b],b,d));return g},multiplier:function(f){var m=f.toString().split(".");return m.length<2?1:Math.pow(10,m[1].length)},correctionFactor:function(){var f=Array.prototype.slice.call(arguments);return f.reduce(function(m,d){var p=n.multiplier(d);return m>p?m:p},1)},toFixed:function(f,m,d,p){var b=f.toString().split("."),g=m-(p||0),v,x,_,S;return b.length===2?v=Math.min(Math.max(b[1].length,g),m):v=g,_=Math.pow(10,v),S=(d(f+"e+"+v)/_).toFixed(v),p>m-v&&(x=new RegExp("\\.?0{1,"+(p-(m-v))+"}$"),S=S.replace(x,"")),S}},e.options=s,e.formats=l,e.locales=o,e.locale=function(f){return f&&(s.currentLocale=f.toLowerCase()),s.currentLocale},e.localeData=function(f){if(!f)return o[s.currentLocale];if(f=f.toLowerCase(),!o[f])throw new Error("Unknown locale : "+f);return o[f]},e.reset=function(){for(var f in a)s[f]=a[f]},e.zeroFormat=function(f){s.zeroFormat=typeof f=="string"?f:null},e.nullFormat=function(f){s.nullFormat=typeof f=="string"?f:null},e.defaultFormat=function(f){s.defaultFormat=typeof f=="string"?f:"0.0"},e.register=function(f,m,d){if(m=m.toLowerCase(),this[f+"s"][m])throw new TypeError(m+" "+f+" already registered.");return this[f+"s"][m]=d,d},e.validate=function(f,m){var d,p,b,g,v,x,_,S;if(typeof f!="string"&&(f+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",f)),f=f.trim(),f.match(/^\d+$/))return!0;if(f==="")return!1;try{_=e.localeData(m)}catch(I){_=e.localeData(e.locale())}return b=_.currency.symbol,v=_.abbreviations,d=_.delimiters.decimal,_.delimiters.thousands==="."?p="\\.":p=_.delimiters.thousands,S=f.match(/^[^\d]+/),S!==null&&(f=f.substr(1),S[0]!==b)||(S=f.match(/[^\d]+$/),S!==null&&(f=f.slice(0,-1),S[0]!==v.thousand&&S[0]!==v.million&&S[0]!==v.billion&&S[0]!==v.trillion))?!1:(x=new RegExp(p+"{2}"),f.match(/[^\d.,]/g)?!1:(g=f.split(d),g.length>2?!1:g.length<2?!!g[0].match(/^\d+.*\d$/)&&!g[0].match(x):g[0].length===1?!!g[0].match(/^\d+$/)&&!g[0].match(x)&&!!g[1].match(/^\d+$/):!!g[0].match(/^\d+.*\d$/)&&!g[0].match(x)&&!!g[1].match(/^\d+$/)))},e.fn=u.prototype={clone:function(){return e(this)},format:function(f,m){var d=this._value,p=f||s.defaultFormat,b,g,v;if(m=m||Math.round,d===0&&s.zeroFormat!==null)g=s.zeroFormat;else if(d===null&&s.nullFormat!==null)g=s.nullFormat;else{for(b in l)if(p.match(l[b].regexps.format)){v=l[b].format;break}v=v||e._.numberToFormat,g=v(d,p,m)}return g},value:function(){return this._value},input:function(){return this._input},set:function(f){return this._value=Number(f),this},add:function(f){var m=n.correctionFactor.call(null,this._value,f);function d(p,b,g,v){return p+Math.round(m*b)}return this._value=n.reduce([this._value,f],d,0)/m,this},subtract:function(f){var m=n.correctionFactor.call(null,this._value,f);function d(p,b,g,v){return p-Math.round(m*b)}return this._value=n.reduce([f],d,Math.round(this._value*m))/m,this},multiply:function(f){function m(d,p,b,g){var v=n.correctionFactor(d,p);return Math.round(d*v)*Math.round(p*v)/Math.round(v*v)}return this._value=n.reduce([this._value,f],m,1),this},divide:function(f){function m(d,p,b,g){var v=n.correctionFactor(d,p);return Math.round(d*v)/Math.round(p*v)}return this._value=n.reduce([this._value,f],m),this},difference:function(f){return Math.abs(e(this._value).subtract(f).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(f){var m=f%10;return~~(f%100/10)==1?"th":m===1?"st":m===2?"nd":m===3?"rd":"th"},currency:{symbol:"$"}}),function(){e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(f,m,d){var p=e._.includes(m," BPS")?" ":"",b;return f=f*1e4,m=m.replace(/\s?BPS/,""),b=e._.numberToFormat(f,m,d),e._.includes(b,")")?(b=b.split(""),b.splice(-1,0,p+"BPS"),b=b.join("")):b=b+p+"BPS",b},unformat:function(f){return+(e._.stringToNumber(f)*1e-4).toFixed(15)}})}(),function(){var f={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},m={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},d=f.suffixes.concat(m.suffixes.filter(function(b){return f.suffixes.indexOf(b)<0})),p=d.join("|");p="("+p.replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(p)},format:function(b,g,v){var x,_=e._.includes(g,"ib")?m:f,S=e._.includes(g," b")||e._.includes(g," ib")?" ":"",I,P,F;for(g=g.replace(/\s?i?b/,""),I=0;I<=_.suffixes.length;I++)if(P=Math.pow(_.base,I),F=Math.pow(_.base,I+1),b===null||b===0||b>=P&&b<F){S+=_.suffixes[I],P>0&&(b=b/P);break}return x=e._.numberToFormat(b,g,v),x+S},unformat:function(b){var g=e._.stringToNumber(b),v,x;if(g){for(v=f.suffixes.length-1;v>=0;v--){if(e._.includes(b,f.suffixes[v])){x=Math.pow(f.base,v);break}if(e._.includes(b,m.suffixes[v])){x=Math.pow(m.base,v);break}}g*=x||1}return g}})}(),function(){e.register("format","currency",{regexps:{format:/(\$)/},format:function(f,m,d){var p=e.locales[e.options.currentLocale],b={before:m.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:m.match(/([\+|\-|\)|\s|\$]*)$/)[0]},g,v,x;for(m=m.replace(/\s?\$\s?/,""),g=e._.numberToFormat(f,m,d),f>=0?(b.before=b.before.replace(/[\-\(]/,""),b.after=b.after.replace(/[\-\)]/,"")):f<0&&!e._.includes(b.before,"-")&&!e._.includes(b.before,"(")&&(b.before="-"+b.before),x=0;x<b.before.length;x++)switch(v=b.before[x],v){case"$":g=e._.insert(g,p.currency.symbol,x);break;case" ":g=e._.insert(g," ",x+p.currency.symbol.length-1);break}for(x=b.after.length-1;x>=0;x--)switch(v=b.after[x],v){case"$":g=x===b.after.length-1?g+p.currency.symbol:e._.insert(g,p.currency.symbol,-(b.after.length-(1+x)));break;case" ":g=x===b.after.length-1?g+" ":e._.insert(g," ",-(b.after.length-(1+x)+p.currency.symbol.length-1));break}return g}})}(),function(){e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(f,m,d){var p,b=typeof f=="number"&&!e._.isNaN(f)?f.toExponential():"0e+0",g=b.split("e");return m=m.replace(/e[\+|\-]{1}0/,""),p=e._.numberToFormat(Number(g[0]),m,d),p+"e"+g[1]},unformat:function(f){var m=e._.includes(f,"e+")?f.split("e+"):f.split("e-"),d=Number(m[0]),p=Number(m[1]);p=e._.includes(f,"e-")?p*=-1:p;function b(g,v,x,_){var S=e._.correctionFactor(g,v),I=g*S*(v*S)/(S*S);return I}return e._.reduce([d,Math.pow(10,p)],b,1)}})}(),function(){e.register("format","ordinal",{regexps:{format:/(o)/},format:function(f,m,d){var p=e.locales[e.options.currentLocale],b,g=e._.includes(m," o")?" ":"";return m=m.replace(/\s?o/,""),g+=p.ordinal(f),b=e._.numberToFormat(f,m,d),b+g}})}(),function(){e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(f,m,d){var p=e._.includes(m," %")?" ":"",b;return e.options.scalePercentBy100&&(f=f*100),m=m.replace(/\s?\%/,""),b=e._.numberToFormat(f,m,d),e._.includes(b,")")?(b=b.split(""),b.splice(-1,0,p+"%"),b=b.join("")):b=b+p+"%",b},unformat:function(f){var m=e._.stringToNumber(f);return e.options.scalePercentBy100?m*.01:m}})}(),function(){e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(f,m,d){var p=Math.floor(f/60/60),b=Math.floor((f-p*60*60)/60),g=Math.round(f-p*60*60-b*60);return p+":"+(b<10?"0"+b:b)+":"+(g<10?"0"+g:g)},unformat:function(f){var m=f.split(":"),d=0;return m.length===3?(d=d+Number(m[0])*60*60,d=d+Number(m[1])*60,d=d+Number(m[2])):m.length===2&&(d=d+Number(m[0])*60,d=d+Number(m[1])),Number(d)}})}(),e})});function zm(e,n){var t=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()),l=Date.UTC(1899,11,31,0,0,0);return n?t-=1461*24*60*60*1e3:e>=Ox&&(t+=24*60*60*1e3),(t-l)/(24*60*60*1e3)}function Ex(e,n){var t=new Date(e);if(Px)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(bh.getFullYear()==1917&&!isNaN(t.getFullYear())){var l=t.getFullYear();return e.indexOf(""+l)>-1||t.setFullYear(t.getFullYear()+100),t}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Nx(e){var n=Number(e);if(typeof e=="number")return e;if(!isNaN(n))return n;var t=1,l=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(l))||(l=l.replace(/[(](.*)[)]/,function(o,a){return t=-t,a}),!isNaN(n=Number(l)))?n/t:n}function _l(e){var n=[],t=null,l={},o=e;if(e==null)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(e)){t=e,o=Number(e.split(".")[0].replace(",",""));let S="#,##0";if(e.split(".")[1]){S="#,##0.";for(let I=0;I<e.split(".")[1].length;I++)S+=0}l={fa:S,t:"n"}}else if(e.toString().substr(0,1)==="'")t=e.toString().substr(1),l={fa:"@",t:"s"};else if(e.toString().toUpperCase()==="TRUE")t="TRUE",l={fa:"General",t:"b"},o=!0;else if(e.toString().toUpperCase()==="FALSE")t="FALSE",l={fa:"General",t:"b"},o=!1;else if(re(e))t=e.toString(),l={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))t=e.toString(),l={fa:"@",t:"s"};else if(K(e)&&Math.abs(parseFloat(e))>0&&(Math.abs(parseFloat(e))>=1e11||Math.abs(parseFloat(e))<1e-9)){o=(0,Zo.default)(e).value();var a=o.toExponential();if(a.indexOf(".")>-1){var s=a.split(".")[1].split("e")[0].length;s>5&&(s=5),l={fa:"#0."+new Array(s+1).join("0")+"E+00",t:"n"}}else l={fa:"#0.E+00",t:"n"};t=En.format(l.fa,o)}else if(e.toString().indexOf("%")>-1){var u=e.toString().indexOf("%"),f=e.toString().substr(0,u),m=f.replace(/,/g,"");if(u==e.toString().length-1&&K(m))if(f.indexOf(".")>-1)if(f.indexOf(".")==f.lastIndexOf(".")){var d=f.split(".")[0],p=f.split(".")[1],b=p.length;if(b>9&&(b=9),d.indexOf(",")>-1){for(var g=!0,v=d.split(","),x=1;x<v.length;x++)if(v[x].length<3){g=!1;break}g?(l={fa:"#,##0."+new Array(b+1).join("0")+"%",t:"n"},o=(0,Zo.default)(e).value(),t=En.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else l={fa:"0."+new Array(b+1).join("0")+"%",t:"n"},o=(0,Zo.default)(e).value(),t=En.format(l.fa,o)}else t=e.toString(),l={fa:"@",t:"s"};else if(f.indexOf(",")>-1){for(var g=!0,v=f.split(","),x=1;x<v.length;x++)if(v[x].length<3){g=!1;break}g?(l={fa:"#,##0%",t:"n"},o=(0,Zo.default)(e).value(),t=En.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else l={fa:"0%",t:"n"},o=(0,Zo.default)(e).value(),t=En.format(l.fa,o);else t=e.toString(),l={fa:"@",t:"s"}}else if(e.toString().indexOf(".")>-1)if(e.toString().indexOf(".")==e.toString().lastIndexOf(".")){var _=e.toString().split(".")[0],f=e.toString().split(".")[1],b=f.length;if(b>9&&(b=9),_.indexOf(",")>-1){for(var g=!0,v=_.split(","),x=1;x<v.length;x++)if(!K(v[x])||v[x].length<3){g=!1;break}g?(l={fa:"#,##0."+new Array(b+1).join("0"),t:"n"},o=(0,Zo.default)(e).value(),t=En.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else K(_)&&K(f)?(l={fa:"0."+new Array(b+1).join("0"),t:"n"},o=(0,Zo.default)(e).value(),t=En.format(l.fa,o)):(t=e.toString(),l={fa:"@",t:"s"})}else t=e.toString(),l={fa:"@",t:"s"};else K(e)?(t=e.toString(),l={fa:"General",t:"n"},o=parseFloat(e)):dr(e)&&(e.toString().indexOf(".")>-1||e.toString().indexOf(":")>-1||e.toString().length<16)?(o=zm(Ex(e.toString().replace(/-/g,"/"))),o.toString().indexOf(".")>-1?e.toString().length>18?l.fa="yyyy-MM-dd hh:mm:ss":e.toString().length>11?l.fa="yyyy-MM-dd hh:mm":l.fa="yyyy-MM-dd":l.fa="yyyy-MM-dd",l.t="d",t=En.format(l.fa,o)):(t=e,l.fa="General",l.t="g");return[t,l,o]}function Bl(e,n){return En.format(e,n)}function Oy(e,n){return En.is_date(e,n)}function Ka(e,n,t){var l=Vt(e,n,t,"m");return l==null?l=Vt(e,n,t,"v"):isNaN(Nx(l))?t[e][n].ct!=null&&t[e][n].ct.t=="d"||t[e][n].ct!=null&&t[e][n].ct.t=="b"||(l=Vt(e,n,t,"v")):typeof l=="string"&&l.indexOf("%")>-1||(l=Vt(e,n,t,"v")),l}var import_plugin,Zo,En,Ax,C6,$6,zx,S6,Ox,bh,Px,ui=Nt(()=>{import_plugin=qe(Ye());cr();Xo();Er();Zo=qe(nc()),En={},Ax=function(n){n.version="0.11.2";function t(ce){for(var fe="",ye=ce.length-1;ye>=0;)fe+=ce.charAt(ye--);return fe}function l(ce,fe){for(var ye="";ye.length<fe;)ye+=ce;return ye}function o(ce,fe){var ye=""+ce;return ye.length>=fe?ye:l("0",fe-ye.length)+ye}function a(ce,fe){var ye=""+ce;return ye.length>=fe?ye:l(" ",fe-ye.length)+ye}function s(ce,fe){var ye=""+ce;return ye.length>=fe?ye:ye+l(" ",fe-ye.length)}function u(ce,fe){var ye=""+Math.round(ce);return ye.length>=fe?ye:l("0",fe-ye.length)+ye}function f(ce,fe){var ye=""+ce;return ye.length>=fe?ye:l("0",fe-ye.length)+ye}var m=Math.pow(2,32);function d(ce,fe){if(ce>m||ce<-m)return u(ce,fe);var ye=Math.round(ce);return f(ye,fe)}function p(ce,fe){return fe=fe||0,ce.length>=7+fe&&(ce.charCodeAt(fe)|32)==103&&(ce.charCodeAt(fe+1)|32)==101&&(ce.charCodeAt(fe+2)|32)==110&&(ce.charCodeAt(fe+3)|32)==101&&(ce.charCodeAt(fe+4)|32)==114&&(ce.charCodeAt(fe+5)|32)==97&&(ce.charCodeAt(fe+6)|32)==108}var b=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],g=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function v(ce){ce[0]="General",ce[1]="0",ce[2]="0.00",ce[3]="#,##0",ce[4]="#,##0.00",ce[9]="0%",ce[10]="0.00%",ce[11]="0.00E+00",ce[12]="# ?/?",ce[13]="# ??/??",ce[14]="m/d/yy",ce[15]="d-mmm-yy",ce[16]="d-mmm",ce[17]="mmm-yy",ce[18]="h:mm AM/PM",ce[19]="h:mm:ss AM/PM",ce[20]="h:mm",ce[21]="h:mm:ss",ce[22]="m/d/yy h:mm",ce[37]="#,##0 ;(#,##0)",ce[38]="#,##0 ;[Red](#,##0)",ce[39]="#,##0.00;(#,##0.00)",ce[40]="#,##0.00;[Red](#,##0.00)",ce[45]="mm:ss",ce[46]="[h]:mm:ss",ce[47]="mmss.0",ce[48]="##0.0E+0",ce[49]="@",ce[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',ce[65535]="General"}var x={};v(x);var _=[],S=0;for(S=5;S<=8;++S)_[S]=32+S;for(S=23;S<=26;++S)_[S]=0;for(S=27;S<=31;++S)_[S]=14;for(S=50;S<=58;++S)_[S]=14;for(S=59;S<=62;++S)_[S]=S-58;for(S=67;S<=68;++S)_[S]=S-58;for(S=72;S<=75;++S)_[S]=S-58;for(S=67;S<=68;++S)_[S]=S-57;for(S=76;S<=78;++S)_[S]=S-56;for(S=79;S<=81;++S)_[S]=S-34;var I=[];I[5]=I[63]='"$"#,##0_);\\("$"#,##0\\)',I[6]=I[64]='"$"#,##0_);[Red]\\("$"#,##0\\)',I[7]=I[65]='"$"#,##0.00_);\\("$"#,##0.00\\)',I[8]=I[66]='"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',I[41]='_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',I[42]='_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',I[43]='_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',I[44]='_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)';function P(ce,fe,ye){for(var Ne=ce<0?-1:1,xe=ce*Ne,et=0,Fe=1,it=0,wt=1,ot=0,xt=0,Ft=Math.floor(xe);ot<fe&&(Ft=Math.floor(xe),it=Ft*Fe+et,xt=Ft*ot+wt,!(xe-Ft<5e-8));)xe=1/(xe-Ft),et=Fe,Fe=it,wt=ot,ot=xt;if(xt>fe&&(ot>fe?(xt=wt,it=et):(xt=ot,it=Fe)),!ye)return[0,Ne*it,xt];var Se=Math.floor(Ne*it/xt);return[Se,Ne*it-Se*xt,xt]}function F(ce,fe,ye){if(ce>2958465||ce<0)return null;var Ne=ce|0,xe=Math.floor(86400*(ce-Ne)),et=0,Fe=[],it={D:Ne,T:xe,u:86400*(ce-Ne)-xe,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(it.u)<1e-6&&(it.u=0),fe&&fe.date1904&&(Ne+=1462),it.u>.9999&&(it.u=0,++xe==86400&&(it.T=xe=0,++Ne,++it.D)),Ne===60)Fe=ye?[1317,10,29]:[1900,2,29],et=3;else if(Ne===0)Fe=ye?[1317,8,29]:[1900,1,0],et=6;else{Ne>60&&--Ne;var wt=new Date(1900,0,1);wt.setDate(wt.getDate()+Ne-1),Fe=[wt.getFullYear(),wt.getMonth()+1,wt.getDate()],et=wt.getDay(),Ne<60&&(et=(et+6)%7),ye&&(et=A(wt,Fe))}return it.y=Fe[0],it.m=Fe[1],it.d=Fe[2],it.S=xe%60,xe=Math.floor(xe/60),it.M=xe%60,xe=Math.floor(xe/60),it.H=xe,it.q=et,it}n.parse_date_code=F;var D=new Date(1899,11,31,0,0,0),k=D.getTime(),w=new Date(1900,2,1,0,0,0);function C(ce,fe){var ye=ce.getTime();return fe?ye-=1461*24*60*60*1e3:ce>=w&&(ye+=24*60*60*1e3),(ye-(k+(ce.getTimezoneOffset()-D.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function T(ce){return ce.toString(10)}n._general_int=T;var O=function(){var fe=/(?:\.0*|(\.\d*[1-9])0+)$/;function ye(ot){return ot.indexOf(".")==-1?ot:ot.replace(fe,"$1")}var Ne=/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,xe=/(E[+-])(\d)$/;function et(ot){return ot.indexOf("E")==-1?ot:ot.replace(Ne,"$1E").replace(xe,"$10$2")}function Fe(ot){var xt=ot<0?12:11,Ft=ye(ot.toFixed(12));return Ft.length<=xt||(Ft=ot.toPrecision(10),Ft.length<=xt)?Ft:ot.toExponential(5)}function it(ot){var xt=ye(ot.toFixed(11));return xt.length>(ot<0?12:11)||xt==="0"||xt==="-0"?ot.toPrecision(6):xt}function wt(ot){var xt=Math.floor(Math.log(Math.abs(ot))*Math.LOG10E),Ft;return xt>=-4&&xt<=-1?Ft=ot.toPrecision(10+xt):Math.abs(xt)<=9?Ft=Fe(ot):xt===10?Ft=ot.toFixed(10).substr(0,12):Ft=it(ot),ye(et(Ft.toUpperCase()))}return wt}();n._general_num=O;function z(ce,fe){switch(typeof ce){case"string":return ce;case"boolean":return ce?"TRUE":"FALSE";case"number":return(ce|0)===ce?ce.toString(10):O(ce);case"undefined":return"";case"object":if(ce==null)return"";if(ce instanceof Date)return ie(14,C(ce,fe&&fe.date1904),fe)}throw new Error("unsupported value in General format: "+ce)}n._general=z;function A(ce,fe){fe[0]-=581;var ye=ce.getDay();return ce<60&&(ye=(ye+6)%7),ye}var E="\u0E50\u0E51\u0E52\u0E53\u0E54\u0E55\u0E56\u0E57\u0E58\u0E59".split("");function L(ce,fe,ye,Ne){var xe="",et=0,Fe=0,it=ye.y,wt,ot=0;switch(ce){case 98:it=ye.y+543;case 121:switch(fe.length){case 1:case 2:wt=it%100,ot=2;break;default:wt=it%1e4,ot=4;break}break;case 109:switch(fe.length){case 1:case 2:wt=ye.m,ot=fe.length;break;case 3:return g[ye.m-1][1];case 5:return g[ye.m-1][0];default:return g[ye.m-1][2]}break;case 100:switch(fe.length){case 1:case 2:wt=ye.d,ot=fe.length;break;case 3:return b[ye.q][0];default:return b[ye.q][1]}break;case 104:switch(fe.length){case 1:case 2:wt=1+(ye.H+11)%12,ot=fe.length;break;default:throw"bad hour format: "+fe}break;case 72:switch(fe.length){case 1:case 2:wt=ye.H,ot=fe.length;break;default:throw"bad hour format: "+fe}break;case 77:switch(fe.length){case 1:case 2:wt=ye.M,ot=fe.length;break;default:throw"bad minute format: "+fe}break;case 115:if(fe!="s"&&fe!="ss"&&fe!=".0"&&fe!=".00"&&fe!=".000")throw"bad second format: "+fe;return ye.u===0&&(fe=="s"||fe=="ss")?o(ye.S,fe.length):(Ne>=2?Fe=Ne===3?1e3:100:Fe=Ne===1?10:1,et=Math.round(Fe*(ye.S+ye.u)),et>=60*Fe&&(et=0),fe==="s"?et===0?"0":""+et/Fe:(xe=o(et,2+Ne),fe==="ss"?xe.substr(0,2):"."+xe.substr(2,fe.length-1)));case 90:switch(fe){case"[h]":case"[hh]":wt=ye.D*24+ye.H;break;case"[m]":case"[mm]":wt=(ye.D*24+ye.H)*60+ye.M;break;case"[s]":case"[ss]":wt=((ye.D*24+ye.H)*60+ye.M)*60+Math.round(ye.S+ye.u);break;default:throw"bad abstime format: "+fe}ot=fe.length===3?1:2;break;case 101:wt=it,ot=1;break}var xt=ot>0?o(wt,ot):"";return xt}function N(ce){var fe=3;if(ce.length<=fe)return ce;for(var ye=ce.length%fe,Ne=ce.substr(0,ye);ye!=ce.length;ye+=fe)Ne+=(Ne.length>0?",":"")+ce.substr(ye,fe);return Ne}var W=function(){var fe=/%/g;function ye(Ze,ze,_e){var Qe=ze.replace(fe,""),Je=ze.length-Qe.length;return W(Ze,Qe,_e*Math.pow(10,2*Je))+l("%",Je)}function Ne(Ze,ze,_e){for(var Qe=ze.length-1;ze.charCodeAt(Qe-1)===44;)--Qe;return W(Ze,ze.substr(0,Qe),_e/Math.pow(10,3*(ze.length-Qe)))}function xe(Ze,ze){var _e,Qe=Ze.indexOf("E")-Ze.indexOf(".")-1;if(Ze.match(/^#+0.0E\+0$/)){if(ze==0)return"0.0E+0";if(ze<0)return"-"+xe(Ze,-ze);var Je=Ze.indexOf(".");Je===-1&&(Je=Ze.indexOf("E"));var Ke=Math.floor(Math.log(ze)*Math.LOG10E)%Je;if(Ke<0&&(Ke+=Je),_e=(ze/Math.pow(10,Ke)).toPrecision(Qe+1+(Je+Ke)%Je),_e.indexOf("e")===-1){var gt=Math.floor(Math.log(ze)*Math.LOG10E);for(_e.indexOf(".")===-1?_e=_e.charAt(0)+"."+_e.substr(1)+"E+"+(gt-_e.length+Ke):_e+="E+"+(gt-Ke);_e.substr(0,2)==="0.";)_e=_e.charAt(0)+_e.substr(2,Je)+"."+_e.substr(2+Je),_e=_e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");_e=_e.replace(/\+-/,"-")}_e=_e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(At,cl,El,bl){return cl+El+bl.substr(0,(Je+Ke)%Je)+"."+bl.substr(Ke)+"E"})}else _e=ze.toExponential(Qe);return Ze.match(/E\+00$/)&&_e.match(/e[+-]\d$/)&&(_e=_e.substr(0,_e.length-1)+"0"+_e.charAt(_e.length-1)),Ze.match(/E\-/)&&_e.match(/e\+/)&&(_e=_e.replace(/e\+/,"e")),_e.replace("e","E")}var et=/# (\?+)( ?)\/( ?)(\d+)/;function Fe(Ze,ze,_e){var Qe=parseInt(Ze[4],10),Je=Math.round(ze*Qe),Ke=Math.floor(Je/Qe),gt=Je-Ke*Qe,At=Qe;return _e+(Ke===0?"":""+Ke)+" "+(gt===0?l(" ",Ze[1].length+1+Ze[4].length):a(gt,Ze[1].length)+Ze[2]+"/"+Ze[3]+o(At,Ze[4].length))}function it(Ze,ze,_e){return _e+(ze===0?"":""+ze)+l(" ",Ze[1].length+2+Ze[4].length)}var wt=/^#*0*\.([0#]+)/,ot=/\).*[0#]/,xt=/\(###\) ###\\?-####/;function Ft(Ze){for(var ze="",_e,Qe=0;Qe!=Ze.length;++Qe)switch(_e=Ze.charCodeAt(Qe)){case 35:break;case 63:ze+=" ";break;case 48:ze+="0";break;default:ze+=String.fromCharCode(_e)}return ze}function Se(Ze,ze){var _e=Math.pow(10,ze);return""+Math.round(Ze*_e)/_e}function oe(Ze,ze){var _e=Ze-Math.floor(Ze),Qe=Math.pow(10,ze);return ze<(""+Math.round(_e*Qe)).length?0:Math.round(_e*Qe)}function be(Ze,ze){return ze<(""+Math.round((Ze-Math.floor(Ze))*Math.pow(10,ze))).length?1:0}function Te(Ze){return Ze<2147483647&&Ze>-2147483648?""+(Ze>=0?Ze|0:Ze-1|0):""+Math.floor(Ze)}function Oe(Ze,ze,_e){if(Ze.charCodeAt(0)===40&&!ze.match(ot)){var Qe=ze.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return _e>=0?Oe("n",Qe,_e):"("+Oe("n",Qe,-_e)+")"}if(ze.charCodeAt(ze.length-1)===44)return Ne(Ze,ze,_e);if(ze.indexOf("%")!==-1)return ye(Ze,ze,_e);if(ze.indexOf("E")!==-1)return xe(ze,_e);if(ze.charCodeAt(0)===36)return"$"+Oe(Ze,ze.substr(ze.charAt(1)==" "?2:1),_e);var Je,Ke,gt,At,cl=Math.abs(_e),El=_e<0?"-":"";if(ze.match(/^00+$/))return El+d(cl,ze.length);if(ze.match(/^[#?]+$/))return Je=d(_e,0),Je==="0"&&(Je=""),Je.length>ze.length?Je:Ft(ze.substr(0,ze.length-Je.length))+Je;if(Ke=ze.match(et))return Fe(Ke,cl,El);if(ze.match(/^#+0+$/))return El+d(cl,ze.length-ze.indexOf("0"));if(Ke=ze.match(wt))return Je=Se(_e,Ke[1].length).replace(/^([^\.]+)$/,"$1."+Ft(Ke[1])).replace(/\.$/,"."+Ft(Ke[1])).replace(/\.(\d*)$/,function(Re,We){return"."+We+l("0",Ft(Ke[1]).length-We.length)}),ze.indexOf("0.")!==-1?Je:Je.replace(/^0\./,".");if(ze=ze.replace(/^#+([0.])/,"$1"),Ke=ze.match(/^(0*)\.(#*)$/))return El+Se(cl,Ke[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,Ke[1].length?"0.":".");if(Ke=ze.match(/^#{1,3},##0(\.?)$/))return El+N(d(cl,0));if(Ke=ze.match(/^#,##0\.([#0]*0)$/))return _e<0?"-"+Oe(Ze,ze,-_e):N(""+(Math.floor(_e)+be(_e,Ke[1].length)))+"."+o(oe(_e,Ke[1].length),Ke[1].length);if(Ke=ze.match(/^#,#*,#0/))return Oe(Ze,ze.replace(/^#,#*,/,""),_e);if(Ke=ze.match(/^([0#]+)(\\?-([0#]+))+$/))return Je=t(Oe(Ze,ze.replace(/[\\-]/g,""),_e)),gt=0,t(t(ze.replace(/\\/g,"")).replace(/[0#]/g,function(Re){return gt<Je.length?Je.charAt(gt++):Re==="0"?"0":""}));if(ze.match(xt))return Je=Oe(Ze,"##########",_e),"("+Je.substr(0,3)+") "+Je.substr(3,3)+"-"+Je.substr(6);var bl="";if(Ke=ze.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return gt=Math.min(Ke[4].length,7),At=P(cl,Math.pow(10,gt)-1,!1),Je=""+El,bl=W("n",Ke[1],At[1]),bl.charAt(bl.length-1)==" "&&(bl=bl.substr(0,bl.length-1)+"0"),Je+=bl+Ke[2]+"/"+Ke[3],bl=s(At[2],gt),bl.length<Ke[4].length&&(bl=Ft(Ke[4].substr(Ke[4].length-bl.length))+bl),Je+=bl,Je;if(Ke=ze.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return gt=Math.min(Math.max(Ke[1].length,Ke[4].length),7),At=P(cl,Math.pow(10,gt)-1,!0),El+(At[0]||(At[1]?"":"0"))+" "+(At[1]?a(At[1],gt)+Ke[2]+"/"+Ke[3]+s(At[2],gt):l(" ",2*gt+1+Ke[2].length+Ke[3].length));if(Ke=ze.match(/^[#0?]+$/))return Je=d(_e,0),ze.length<=Je.length?Je:Ft(ze.substr(0,ze.length-Je.length))+Je;if(Ke=ze.match(/^([#0?]+)\.([#0]+)$/)){Je=""+_e.toFixed(Math.min(Ke[2].length,10)).replace(/([^0])0+$/,"$1"),gt=Je.indexOf(".");var Nr=ze.indexOf(".")-gt,li=ze.length-Je.length-Nr;return Ft(ze.substr(0,Nr)+Je+ze.substr(ze.length-li))}if(Ke=ze.match(/^00,000\.([#0]*0)$/))return gt=oe(_e,Ke[1].length),_e<0?"-"+Oe(Ze,ze,-_e):N(Te(_e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Re){return"00,"+(Re.length<3?o(0,3-Re.length):"")+Re})+"."+o(gt,Ke[1].length);switch(ze){case"###,##0.00":return Oe(Ze,"#,##0.00",_e);case"###,###":case"##,###":case"#,###":var on=N(d(cl,0));return on!=="0"?El+on:"";case"###,###.00":return Oe(Ze,"###,##0.00",_e).replace(/^0\./,".");case"#,###.00":return Oe(Ze,"#,##0.00",_e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+ze+"|")}function Xe(Ze,ze,_e){for(var Qe=ze.length-1;ze.charCodeAt(Qe-1)===44;)--Qe;return W(Ze,ze.substr(0,Qe),_e/Math.pow(10,3*(ze.length-Qe)))}function Le(Ze,ze,_e){var Qe=ze.replace(fe,""),Je=ze.length-Qe.length;return W(Ze,Qe,_e*Math.pow(10,2*Je))+l("%",Je)}function Ee(Ze,ze){var _e,Qe=Ze.indexOf("E")-Ze.indexOf(".")-1;if(Ze.match(/^#+0.0E\+0$/)){if(ze==0)return"0.0E+0";if(ze<0)return"-"+Ee(Ze,-ze);var Je=Ze.indexOf(".");Je===-1&&(Je=Ze.indexOf("E"));var Ke=Math.floor(Math.log(ze)*Math.LOG10E)%Je;if(Ke<0&&(Ke+=Je),_e=(ze/Math.pow(10,Ke)).toPrecision(Qe+1+(Je+Ke)%Je),!_e.match(/[Ee]/)){var gt=Math.floor(Math.log(ze)*Math.LOG10E);_e.indexOf(".")===-1?_e=_e.charAt(0)+"."+_e.substr(1)+"E+"+(gt-_e.length+Ke):_e+="E+"+(gt-Ke),_e=_e.replace(/\+-/,"-")}_e=_e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(At,cl,El,bl){return cl+El+bl.substr(0,(Je+Ke)%Je)+"."+bl.substr(Ke)+"E"})}else _e=ze.toExponential(Qe);return Ze.match(/E\+00$/)&&_e.match(/e[+-]\d$/)&&(_e=_e.substr(0,_e.length-1)+"0"+_e.charAt(_e.length-1)),Ze.match(/E\-/)&&_e.match(/e\+/)&&(_e=_e.replace(/e\+/,"e")),_e.replace("e","E")}function nt(Ze,ze,_e){if(Ze.charCodeAt(0)===40&&!ze.match(ot)){var Qe=ze.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return _e>=0?nt("n",Qe,_e):"("+nt("n",Qe,-_e)+")"}if(ze.charCodeAt(ze.length-1)===44)return Xe(Ze,ze,_e);if(ze.indexOf("%")!==-1)return Le(Ze,ze,_e);if(ze.indexOf("E")!==-1)return Ee(ze,_e);if(ze.charCodeAt(0)===36)return"$"+nt(Ze,ze.substr(ze.charAt(1)==" "?2:1),_e);var Je,Ke,gt,At,cl=Math.abs(_e),El=_e<0?"-":"";if(ze.match(/^00+$/))return El+o(cl,ze.length);if(ze.match(/^[#?]+$/))return Je=""+_e,_e===0&&(Je=""),Je.length>ze.length?Je:Ft(ze.substr(0,ze.length-Je.length))+Je;if(Ke=ze.match(et))return it(Ke,cl,El);if(ze.match(/^#+0+$/))return El+o(cl,ze.length-ze.indexOf("0"));if(Ke=ze.match(wt))return Je=(""+_e).replace(/^([^\.]+)$/,"$1."+Ft(Ke[1])).replace(/\.$/,"."+Ft(Ke[1])),Je=Je.replace(/\.(\d*)$/,function(Re,We){return"."+We+l("0",Ft(Ke[1]).length-We.length)}),ze.indexOf("0.")!==-1?Je:Je.replace(/^0\./,".");if(ze=ze.replace(/^#+([0.])/,"$1"),Ke=ze.match(/^(0*)\.(#*)$/))return El+(""+cl).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,Ke[1].length?"0.":".");if(Ke=ze.match(/^#{1,3},##0(\.?)$/))return El+N(""+cl);if(Ke=ze.match(/^#,##0\.([#0]*0)$/))return _e<0?"-"+nt(Ze,ze,-_e):N(""+_e)+"."+l("0",Ke[1].length);if(Ke=ze.match(/^#,#*,#0/))return nt(Ze,ze.replace(/^#,#*,/,""),_e);if(Ke=ze.match(/^([0#]+)(\\?-([0#]+))+$/))return Je=t(nt(Ze,ze.replace(/[\\-]/g,""),_e)),gt=0,t(t(ze.replace(/\\/g,"")).replace(/[0#]/g,function(Re){return gt<Je.length?Je.charAt(gt++):Re==="0"?"0":""}));if(ze.match(xt))return Je=nt(Ze,"##########",_e),"("+Je.substr(0,3)+") "+Je.substr(3,3)+"-"+Je.substr(6);var bl="";if(Ke=ze.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return gt=Math.min(Ke[4].length,7),At=P(cl,Math.pow(10,gt)-1,!1),Je=""+El,bl=W("n",Ke[1],At[1]),bl.charAt(bl.length-1)==" "&&(bl=bl.substr(0,bl.length-1)+"0"),Je+=bl+Ke[2]+"/"+Ke[3],bl=s(At[2],gt),bl.length<Ke[4].length&&(bl=Ft(Ke[4].substr(Ke[4].length-bl.length))+bl),Je+=bl,Je;if(Ke=ze.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return gt=Math.min(Math.max(Ke[1].length,Ke[4].length),7),At=P(cl,Math.pow(10,gt)-1,!0),El+(At[0]||(At[1]?"":"0"))+" "+(At[1]?a(At[1],gt)+Ke[2]+"/"+Ke[3]+s(At[2],gt):l(" ",2*gt+1+Ke[2].length+Ke[3].length));if(Ke=ze.match(/^[#0?]+$/))return Je=""+_e,ze.length<=Je.length?Je:Ft(ze.substr(0,ze.length-Je.length))+Je;if(Ke=ze.match(/^([#0]+)\.([#0]+)$/)){Je=""+_e.toFixed(Math.min(Ke[2].length,10)).replace(/([^0])0+$/,"$1"),gt=Je.indexOf(".");var Nr=ze.indexOf(".")-gt,li=ze.length-Je.length-Nr;return Ft(ze.substr(0,Nr)+Je+ze.substr(ze.length-li))}if(Ke=ze.match(/^00,000\.([#0]*0)$/))return _e<0?"-"+nt(Ze,ze,-_e):N(""+_e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Re){return"00,"+(Re.length<3?o(0,3-Re.length):"")+Re})+"."+o(0,Ke[1].length);switch(ze){case"###,###":case"##,###":case"#,###":var on=N(""+cl);return on!=="0"?El+on:"";default:if(ze.match(/\.[0#?]*$/))return nt(Ze,ze.slice(0,ze.lastIndexOf(".")),_e)+Ft(ze.slice(ze.lastIndexOf(".")))}throw new Error("unsupported format |"+ze+"|")}return function(ze,_e,Qe){return(Qe|0)===Qe?nt(ze,_e,Qe):Oe(ze,_e,Qe)}}();function X(ce){for(var fe=[],ye=!1,Ne=0,xe=0;Ne<ce.length;++Ne)switch(ce.charCodeAt(Ne)){case 34:ye=!ye;break;case 95:case 42:case 92:++Ne;break;case 59:fe[fe.length]=ce.substr(xe,Ne-xe),xe=Ne+1}if(fe[fe.length]=ce.substr(xe),ye===!0)throw new Error("Format |"+ce+"| unterminated string ");return fe}n._split=X;var te=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ue(ce){for(var fe=0,ye="",Ne="";fe<ce.length;)switch(ye=ce.charAt(fe)){case"G":p(ce,fe)&&(fe+=6),fe++;break;case'"':for(;ce.charCodeAt(++fe)!==34&&fe<ce.length;);++fe;break;case"\\":fe+=2;break;case"_":fe+=2;break;case"@":++fe;break;case"B":case"b":if(ce.charAt(fe+1)==="1"||ce.charAt(fe+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(ce.substr(fe,3).toUpperCase()==="A/P"||ce.substr(fe,5).toUpperCase()==="AM/PM"||ce.substr(fe,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++fe;break;case"[":for(Ne=ye;ce.charAt(fe++)!=="]"&&fe<ce.length;)Ne+=ce.charAt(fe);if(Ne.match(te))return!0;break;case".":case"0":case"#":for(;fe<ce.length&&("0#?.,E+-%".indexOf(ye=ce.charAt(++fe))>-1||ye=="\\"&&ce.charAt(fe+1)=="-"&&"0#".indexOf(ce.charAt(fe+2))>-1););break;case"?":for(;ce.charAt(++fe)===ye;);break;case"*":++fe,(ce.charAt(fe)==" "||ce.charAt(fe)=="*")&&++fe;break;case"(":case")":++fe;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;fe<ce.length&&"0123456789".indexOf(ce.charAt(++fe))>-1;);break;case" ":++fe;break;default:++fe;break}return!1}n.is_date=ue;function pe(ce,fe,ye,Ne){for(var xe=[],et="",Fe=0,it="",wt="t",ot,xt,Ft,Se="H";Fe<ce.length;)switch(it=ce.charAt(Fe)){case"G":if(!p(ce,Fe))throw new Error("unrecognized character "+it+" in "+ce);xe[xe.length]={t:"G",v:"General"},Fe+=7;break;case'"':for(et="";(Ft=ce.charCodeAt(++Fe))!==34&&Fe<ce.length;)et+=String.fromCharCode(Ft);xe[xe.length]={t:"t",v:et},++Fe;break;case"\\":var oe=ce.charAt(++Fe),be=oe==="("||oe===")"?oe:"t";xe[xe.length]={t:be,v:oe},++Fe;break;case"_":xe[xe.length]={t:"t",v:" "},Fe+=2;break;case"@":xe[xe.length]={t:"T",v:fe},++Fe;break;case"B":case"b":if(ce.charAt(Fe+1)==="1"||ce.charAt(Fe+1)==="2"){if(ot==null&&(ot=F(fe,ye,ce.charAt(Fe+1)==="2"),ot==null))return"";xe[xe.length]={t:"X",v:ce.substr(Fe,2)},wt=it,Fe+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":it=it.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(fe<0)return"";if(ot==null&&(ot=F(fe,ye),ot==null))return"#####";for(et=it;++Fe<ce.length&&ce.charAt(Fe).toLowerCase()===it;)et+=it;it==="m"&&wt.toLowerCase()==="h"&&(it="M"),it==="h"&&(it=Se),xe[xe.length]={t:it,v:et},wt=it;break;case"A":case"a":case"\u4E0A":var Te={t:it,v:it};if(ot==null&&(ot=F(fe,ye)),ce.substr(Fe,3).toUpperCase()==="A/P"?(ot!=null&&(Te.v=ot.H>=12?"P":"A"),Te.t="T",Se="h",Fe+=3):ce.substr(Fe,5).toUpperCase()==="AM/PM"?(ot!=null&&(Te.v=ot.H>=12?"PM":"AM"),Te.t="T",Fe+=5,Se="h"):ce.substr(Fe,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(ot!=null&&(Te.v=ot.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),Te.t="T",Fe+=5,Se="h"):(Te.t="t",++Fe),ot==null&&Te.t==="T")return"";xe[xe.length]=Te,wt=it;break;case"[":for(et=it;ce.charAt(Fe++)!=="]"&&Fe<ce.length;)et+=ce.charAt(Fe);if(et.slice(-1)!=="]")throw'unterminated "[" block: |'+et+"|";if(et.match(te)){if(ot==null&&(ot=F(fe,ye),ot==null))return"";xe[xe.length]={t:"Z",v:et.toLowerCase()},wt=et.charAt(1)}else et.indexOf("$")>-1&&(et=(et.match(/\$([^-\[\]]*)/)||[])[1]||"$",ue(ce)||(xe[xe.length]={t:"t",v:et}));break;case".":if(ot!=null){for(et=it;++Fe<ce.length&&(it=ce.charAt(Fe))==="0";)et+=it;xe[xe.length]={t:"s",v:et};break}case"0":case"#":for(et=it;++Fe<ce.length&&"0#?.,E+-%".indexOf(it=ce.charAt(Fe))>-1;)et+=it;xe[xe.length]={t:"n",v:et};break;case"?":for(et=it;ce.charAt(++Fe)===it;)et+=it;xe[xe.length]={t:it,v:et},wt=it;break;case"*":++Fe,(ce.charAt(Fe)==" "||ce.charAt(Fe)=="*")&&++Fe;break;case"(":case")":xe[xe.length]={t:Ne===1?"t":it,v:it},++Fe;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(et=it;Fe<ce.length&&"0123456789".indexOf(ce.charAt(++Fe))>-1;)et+=ce.charAt(Fe);xe[xe.length]={t:"D",v:et};break;case" ":xe[xe.length]={t:it,v:it},++Fe;break;case"$":xe[xe.length]={t:"t",v:"$"},++Fe;break;default:if("\xA4\u0E3FBsBr\u20B5\u20A1\u20AB\u0192FtRs.\u20ADkr\xA3\u20A4Lm\u20A5\u20A6\u20B1PQRSkRp\u09F2\u09F3R$S/.\u3012\u20AE\u20A9\xA5NT\uFFE5z\u0142\u20B4\u20AA\u17DB\u0440\u0443\u0431\u20AC\uFF04,$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP$\uFFE5LekdinAf$dhAflRial?\uFFE1BirrKzMOPPGKRsGsB/R$\u0440\u0440levkrKMzBsPNuFBuKPkrRD$NfkCFA?CVEGMDFrCDHTGNAfLFdjKGSFGGHSRielKCFknKshLSLL\uFFE1LtRFRONArRfMWKRMMURsMROS/KMDLMTnRC$kr\u20ACGELCHFSLLSCRDbSZLSDGSOSSomFCFPTShT$VUVQUGX\u0433\u0440\u043DsomWSTNT$FtDramRpZMWFCFA".indexOf(it)===-1)throw new Error("unrecognized character "+it+" in "+ce);xe[xe.length]={t:"t",v:it},++Fe;break}var Oe=0,Xe=0,Le;for(Fe=xe.length-1,wt="t";Fe>=0;--Fe)switch(xe[Fe].t){case"h":case"H":xe[Fe].t=Se,wt="h",Oe<1&&(Oe=1);break;case"s":(Le=xe[Fe].v.match(/\.0+$/))&&(Xe=Math.max(Xe,Le[0].length-1)),Oe<3&&(Oe=3);case"d":case"y":case"M":case"e":wt=xe[Fe].t;break;case"m":wt==="s"&&(xe[Fe].t="M",Oe<2&&(Oe=2));break;case"X":break;case"Z":Oe<1&&xe[Fe].v.match(/[Hh]/)&&(Oe=1),Oe<2&&xe[Fe].v.match(/[Mm]/)&&(Oe=2),Oe<3&&xe[Fe].v.match(/[Ss]/)&&(Oe=3)}switch(Oe){case 0:break;case 1:ot.u>=.5&&(ot.u=0,++ot.S),ot.S>=60&&(ot.S=0,++ot.M),ot.M>=60&&(ot.M=0,++ot.H);break;case 2:ot.u>=.5&&(ot.u=0,++ot.S),ot.S>=60&&(ot.S=0,++ot.M);break}var Ee="",nt;for(Fe=0;Fe<xe.length;++Fe)switch(xe[Fe].t){case"t":case"T":case" ":case"D":break;case"X":xe[Fe].v="",xe[Fe].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":xe[Fe].v=L(xe[Fe].t.charCodeAt(0),xe[Fe].v,ot,Xe),xe[Fe].t="t";break;case"n":case"?":for(nt=Fe+1;xe[nt]!=null&&((it=xe[nt].t)==="?"||it==="D"||(it===" "||it==="t")&&xe[nt+1]!=null&&(xe[nt+1].t==="?"||xe[nt+1].t==="t"&&xe[nt+1].v==="/")||xe[Fe].t==="("&&(it===" "||it==="n"||it===")")||it==="t"&&(xe[nt].v==="/"||xe[nt].v===" "&&xe[nt+1]!=null&&xe[nt+1].t=="?"));)xe[Fe].v+=xe[nt].v,xe[nt]={v:"",t:";"},++nt;Ee+=xe[Fe].v,Fe=nt-1;break;case"G":xe[Fe].t="t",xe[Fe].v=z(fe,ye);break}var Ze="",ze,_e;if(Ee.length>0){Ee.charCodeAt(0)==40?(ze=fe<0&&Ee.charCodeAt(0)===45?-fe:fe,_e=W("n",Ee,ze)):(ze=fe<0&&Ne>1?-fe:fe,_e=W("n",Ee,ze),ze<0&&xe[0]&&xe[0].t=="t"&&(_e=_e.substr(1),xe[0].v="-"+xe[0].v)),nt=_e.length-1;var Qe=xe.length;for(Fe=0;Fe<xe.length;++Fe)if(xe[Fe]!=null&&xe[Fe].t!="t"&&xe[Fe].v.indexOf(".")>-1){Qe=Fe;break}var Je=xe.length;if(Qe===xe.length&&_e.indexOf("E")===-1){for(Fe=xe.length-1;Fe>=0;--Fe)xe[Fe]==null||"n?".indexOf(xe[Fe].t)===-1||(nt>=xe[Fe].v.length-1?(nt-=xe[Fe].v.length,xe[Fe].v=_e.substr(nt+1,xe[Fe].v.length)):nt<0?xe[Fe].v="":(xe[Fe].v=_e.substr(0,nt+1),nt=-1),xe[Fe].t="t",Je=Fe);nt>=0&&Je<xe.length&&(xe[Je].v=_e.substr(0,nt+1)+xe[Je].v)}else if(Qe!==xe.length&&_e.indexOf("E")===-1){for(nt=_e.indexOf(".")-1,Fe=Qe;Fe>=0;--Fe)if(!(xe[Fe]==null||"n?".indexOf(xe[Fe].t)===-1)){for(xt=xe[Fe].v.indexOf(".")>-1&&Fe===Qe?xe[Fe].v.indexOf(".")-1:xe[Fe].v.length-1,Ze=xe[Fe].v.substr(xt+1);xt>=0;--xt)nt>=0&&(xe[Fe].v.charAt(xt)==="0"||xe[Fe].v.charAt(xt)==="#")&&(Ze=_e.charAt(nt--)+Ze);xe[Fe].v=Ze,xe[Fe].t="t",Je=Fe}for(nt>=0&&Je<xe.length&&(xe[Je].v=_e.substr(0,nt+1)+xe[Je].v),nt=_e.indexOf(".")+1,Fe=Qe;Fe<xe.length;++Fe)if(!(xe[Fe]==null||"n?(".indexOf(xe[Fe].t)===-1&&Fe!==Qe)){for(xt=xe[Fe].v.indexOf(".")>-1&&Fe===Qe?xe[Fe].v.indexOf(".")+1:0,Ze=xe[Fe].v.substr(0,xt);xt<xe[Fe].v.length;++xt)nt<_e.length&&(Ze+=_e.charAt(nt++));xe[Fe].v=Ze,xe[Fe].t="t",Je=Fe}}}for(Fe=0;Fe<xe.length;++Fe)xe[Fe]!=null&&"n?".indexOf(xe[Fe].t)>-1&&(ze=Ne>1&&fe<0&&Fe>0&&xe[Fe-1].v==="-"?-fe:fe,xe[Fe].v=W(xe[Fe].t,xe[Fe].v,ze),xe[Fe].t="t");var Ke="";for(Fe=0;Fe!==xe.length;++Fe)xe[Fe]!=null&&(Ke+=xe[Fe].v);return Ke}n._eval=pe;var ne=/\[[=<>]/,me=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Q(ce,fe){if(fe==null)return!1;var ye=parseFloat(fe[2]);switch(fe[1]){case"=":if(ce==ye)return!0;break;case">":if(ce>ye)return!0;break;case"<":if(ce<ye)return!0;break;case"<>":if(ce!=ye)return!0;break;case">=":if(ce>=ye)return!0;break;case"<=":if(ce<=ye)return!0;break}return!1}function we(ce,fe){var ye=X(ce),Ne=ye.length,xe=ye[Ne-1].indexOf("@");if(Ne<4&&xe>-1&&--Ne,ye.length>4)throw new Error("cannot find right format for |"+ye.join("|")+"|");if(typeof fe!="number")return[4,ye.length===4||xe>-1?ye[ye.length-1]:"@"];switch(ye.length){case 1:ye=xe>-1?["General","General","General",ye[0]]:[ye[0],ye[0],ye[0],"@"];break;case 2:ye=xe>-1?[ye[0],ye[0],ye[0],ye[1]]:[ye[0],ye[1],ye[0],"@"];break;case 3:ye=xe>-1?[ye[0],ye[1],ye[0],ye[2]]:[ye[0],ye[1],ye[2],"@"];break;case 4:break}var et=fe>0?ye[0]:fe<0?ye[1]:ye[2];if(ye[0].indexOf("[")===-1&&ye[1].indexOf("[")===-1)return[Ne,et];if(ye[0].match(ne)!=null||ye[1].match(ne)!=null){var Fe=ye[0].match(me),it=ye[1].match(me);return Q(fe,Fe)?[Ne,ye[0]]:Q(fe,it)?[Ne,ye[1]]:[Ne,ye[Fe!=null&&it!=null?2:1]]}return[Ne,et]}function ie(ce,fe,ye){ye==null&&(ye={});var Ne="";switch(typeof ce){case"string":ce=="m/d/yy"&&ye.dateNF?Ne=ye.dateNF:Ne=ce;break;case"number":ce==14&&ye.dateNF?Ne=ye.dateNF:Ne=(ye.table!=null?ye.table:x)[ce],Ne==null&&(Ne=ye.table&&ye.table[_[ce]]||x[_[ce]]),Ne==null&&(Ne=I[ce]||"General");break}var xe=/^(w|W)((0?)|(0\.0+))$/;if(Ne.match(xe)){if(isNaN(fe))return fe;var et=Ne.slice(1),Fe=!1;!isNaN(fe)&&Number(fe)<0&&(Fe=!0,fe=Math.abs(fe));var it=parseInt(fe),wt=it.toString().length;if(wt>4){if(wt>8){var ot=parseInt(fe/1e8),xt=parseInt(parseFloat(fe).subtract(ot*1e8)/1e4),Ft=parseFloat(fe).subtract(ot*1e8+xt*1e4);et!=""&&(Ft=(0,Zo.default)(Ft).format(et)),fe=ot+"\u4EBF"+xt+"\u4E07"+Ft}else{var xt=parseInt(fe/1e4),Ft=parseFloat(fe).subtract(xt*1e4);et!=""&&(Ft=(0,Zo.default)(Ft).format(et)),fe=xt+"\u4E07"+Ft}if(fe.indexOf("\u4EBF0\u4E070")!=-1?fe=fe.replace("0\u4E070",""):fe.indexOf("\u4EBF0\u4E07")!=-1?fe=fe.replace("0\u4E07",""):fe.indexOf("\u4E070")!=-1&&(fe=fe.replace("\u4E070","\u4E07")),fe.indexOf("\u4EBF")!=-1&&fe.indexOf("\u4E07")==-1){var Se=fe.substring(fe.indexOf("\u4EBF")+1);if(Se.substring(0,1)!=="."&&Se!=""){switch((parseInt(Se)+"").length){case 1:Se="000"+Se;break;case 2:Se="00"+Se;break;case 3:Se="0"+Se;break}fe=fe.substring(0,fe.indexOf("\u4EBF")+1)+Se}}else if(fe.indexOf("\u4EBF")==-1&&fe.indexOf("\u4E07")!=-1){var oe=fe.substring(fe.indexOf("\u4E07")+1);if(oe.substring(0,1)!=="."&&oe!=""){switch((parseInt(oe)+"").length){case 1:oe="000"+oe;break;case 2:oe="00"+oe;break;case 3:oe="0"+oe;break}fe=fe.substring(0,fe.indexOf("\u4E07")+1)+oe}}else if(fe.indexOf("\u4EBF")!=-1&&fe.indexOf("\u4E07")!=-1){var Se=fe.substring(fe.indexOf("\u4EBF")+1,fe.indexOf("\u4E07")),oe=fe.substring(fe.indexOf("\u4E07")+1);switch((parseInt(Se)+"").length){case 1:Se="000"+Se;break;case 2:Se="00"+Se;break;case 3:Se="0"+Se;break}if(fe=fe.substring(0,fe.indexOf("\u4EBF")+1)+Se+fe.substring(fe.indexOf("\u4E07")),oe.substring(0,1)!=="."&&oe!=""){switch((parseInt(oe)+"").length){case 1:oe="000"+oe;break;case 2:oe="00"+oe;break;case 3:oe="0"+oe;break}fe=fe.substring(0,fe.indexOf("\u4E07")+1)+oe}}}else et!=""&&(fe=(0,Zo.default)(fe).format(et));return Fe?"-"+fe:fe}if(p(Ne,0))return z(fe,ye);fe instanceof Date&&(fe=C(fe,ye.date1904));var be=we(Ne,fe);if(p(be[1]))return z(fe,ye);if(fe===!0)fe="TRUE";else if(fe===!1)fe="FALSE";else if(fe===""||fe==null)return"";return pe(be[1],fe,ye,be[0])}function ge(ce,fe){if(typeof fe!="number"){fe=+fe||-1;for(var ye=0;ye<392;++ye){if(x[ye]==null){fe<0&&(fe=ye);continue}if(x[ye]==ce){fe=ye;break}}fe<0&&(fe=391)}return x[fe]=ce,fe}n.load=ge,n._table=x,n.get_table=function(){return x},n.load_table=function(fe){for(var ye=0;ye!=392;++ye)fe[ye]!==void 0&&ge(fe[ye],ye)},n.init_table=v,n.format=ie};Ax(En);C6={"General Number":"General","General Date":En._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":En._table[15],"Short Date":En._table[14],"Long Time":En._table[19],"Medium Time":En._table[18],"Short Time":En._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:En._table[2],Standard:En._table[4],Percent:En._table[10],Scientific:En._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'},$6=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,n=/_x([\da-fA-F]{4})_/g;return function t(l){var o=l+"",a=o.indexOf("<![CDATA[");if(a==-1)return o.replace(e,function(u,f){return encodings[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(n,function(u,f){return String.fromCharCode(parseInt(f,16))});var s=o.indexOf("]]>");return t(o.slice(0,a))+o.slice(a+9,s)+t(o.slice(s+3))}}(),zx=new Date(1899,11,31,0,0,0),S6=zx.getTime(),Ox=new Date(1900,2,1,0,0,0);bh=new Date("2017-02-19T19:06:09.000Z");isNaN(bh.getFullYear())&&(bh=new Date("2/19/17"));Px=bh.getFullYear()==2017});function kr(e,n,t,l){t==null&&(t=h.flowdata);let o=t[e][n],a;if(G(l)=="object"?(o==null?o=l:(l.f!=null?o.f=l.f:o.hasOwnProperty("f")&&delete o.f,l.spl!=null&&(o.spl=l.spl),l.ct!=null&&(o.ct=l.ct)),G(l.v)=="object"?a=l.v.v:a=l.v):a=l,ft(a)){G(o)=="object"?(delete o.m,delete o.v):o=null,t[e][n]=o;return}(ft(o)||(G(o)==="string"||G(o)==="number")&&o===l)&&(o={});let s=a.toString();if(s.substr(0,1)=="'")o.m=s.substr(1),o.ct={fa:"@",t:"s"},o.v=s.substr(1),o.qp=1;else if(o.qp==1)o.m=s,o.ct={fa:"@",t:"s"},o.v=s;else if(s.toUpperCase()==="TRUE")o.m="TRUE",o.ct={fa:"General",t:"b"},o.v=!0;else if(s.toUpperCase()==="FALSE")o.m="FALSE",o.ct={fa:"General",t:"b"},o.v=!1;else if(s.substr(-1)==="%"&&K(s.substring(0,s.length-1)))o.ct={fa:"0%",t:"n"},o.v=s.substring(0,s.length-1)/100,o.m=a;else if(re(a))o.m=s,o.ct!=null?o.ct.t="e":o.ct={fa:"General",t:"e"},o.v=a;else if(o.f!=null&&K(a)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(a))if(o.v=parseFloat(a),o.ct==null&&(o.ct={fa:"General",t:"n"}),o.v==Infinity||o.v==-Infinity)o.m=o.v.toString();else if(o.v.toString().indexOf("e")>-1){let u;o.v.toString().split(".").length==1?u=0:u=o.v.toString().split(".")[1].split("e")[0].length,u>5&&(u=5),o.m=o.v.toExponential(u).toString()}else{let u=Math.round(o.v*1e9)/1e9;if(o.ct==null){let f=_l(u);o.m=f[0].toString()}else{let f=Bl(o.ct.fa,u);o.m=f.toString()}}else if(o.ct!=null&&o.ct.fa=="@")o.m=s,o.v=a;else if(o.ct!=null&&o.ct.fa!=null&&o.ct.fa!="General"){K(a)&&(a=parseFloat(a));let u=Bl(o.ct.fa,a);u===a?(u=_l(a),o.m=u[0].toString(),o.ct=u[1],o.v=u[2]):(o.m=u.toString(),o.v=a)}else if(K(a)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(a))if(typeof a=="string"&&a.split("").every(f=>f=="0"||f==".")&&(a=parseFloat(a)),o.v=a,o.ct={fa:"General",t:"n"},o.v==Infinity||o.v==-Infinity)o.m=o.v.toString();else{let u=_l(o.v);o.m=u[0].toString()}else{let u=_l(a);o.m=u[0].toString(),o.ct=u[1],o.v=u[2]}if(!Ue.allowUpdate&&!ut.pointEdit&&o.ct!=null&&/^(w|W)((0?)|(0\.0+))$/.test(o.ct.fa)==!1&&o.ct.t=="n"&&o.v!=null&&parseInt(o.v).toString().length>4){let u=ut.autoFormatw.toString().toUpperCase(),f=ut.accuracy,m=Lx(u,f);m!="General"&&(o.ct.fa=m,o.m=Bl(m,o.v))}t[e][n]=o}function Lx(e,n){let t="0.",l;if(e=="TRUE"){if(n==null)return"w";{let o=parseInt(n);if(o==0)return"w0";t="w0.";for(let a=0;a<o;a++)t+="0";l=t}}else{if(n==null)return"General";{let o=parseInt(n);if(o==0)return"0";for(let a=0;a<o;a++)t+="0";l=t}}return l.toString()}var import_plugin,Do=Nt(()=>{import_plugin=qe(Ye());Ol();cr();ui();qr();Vn();il()});function Nn(){if(h.luckysheet_select_save.length==0)return;let e=Infinity,n=-Infinity,t=0,l=0,o=0;for(let u=0;u<h.luckysheet_select_save.length;u++){let f=Ty(h.luckysheet_select_save[u]);for(let m=0;m<f.length;m++)for(let d=0;d<f[0].length;d++){if(ft(f[m][d])||(l++,f[m][d].ct!=null&&f[m][d].ct.t=="d"))continue;let p=f[m][d].v;!K(p)||(p=parseFloat(p),t+=p,p<e&&(e=p),p>n&&(n=p))}}let a=Be().formula,s="";s+="<span>"+a.count+":"+l+"</span>",(isFinite(n)||isFinite(e))&&(s+="<span>"+a.sum+":"+Bl("w",t)+"</span>",s+="<span>"+a.average+":"+Bl("w",Math.round(t/l*1e4)/1e4)+"</span>"),isFinite(n)&&(s+="<span>"+a.max+":"+Bl("w",n)+"</span>"),isFinite(e)&&(s+="<span>"+a.min+":"+Bl("w",e)+"</span>"),$("#luckysheet-sta-content").html(s)}var import_plugin,Xc=Nt(()=>{import_plugin=qe(Ye());il();Er();cr();ui();Xl()});function Zc(e,n,t,l,o){t==null&&(t=!0),e||(e="down"),n||(n="cell"),o==null&&(o=!1);let a=h.luckysheet_select_save[h.luckysheet_select_save.length-1],s=a.row==null?0:a.row[0],u=a.column==null?0:a.column[0],f=a.row==null?0:a.row[0],m=a.column==null?0:a.column[0],d=a.row==null?0:a.row[1],p=a.column==null?0:a.column[1];if(y.fucntionboxshow(s,u),n=="range"){var b=h.luckysheet_shiftpositon.row[0],g=h.luckysheet_shiftpositon.column[0];let P=h.luckysheet_shiftpositon.row[1],F=h.luckysheet_shiftpositon.column[1];e=="down"||e=="up"?P<d?s=a.row==null?0:a.row[1]:b>f?s=a.row==null?0:a.row[0]:P==d&&b==f&&(e=="down"?s=a.row==null?0:a.row[1]:s=a.row==null?0:a.row[0]):(e=="right"||e=="left")&&(F<p?u=a.column==null?0:a.column[1]:g>m?u=a.column==null?0:a.column[0]:F==p&&g==m&&(e=="right"?u=a.column==null?0:a.column[1]:u=a.column==null?0:a.column[0]))}let v=h.flowdata.length,x=h.flowdata[0].length,_=h.flowdata,S="",I=0;if(e=="up"){if(s==0)return;{let P=[],F=null,D=0,k=null;for(let w=m;w<=p;w++){P=[],D=0;for(let C=s-1;C>=0;C--){let T=_[C][w];if(G(T)=="object"&&ft(T.v)||ft(T)?P.push(!1):P.push(!0),P.length>1){if(P[D]==!0&&P[D-1]==!1){F=C;break}else if(P[D]==!1&&P[D-1]==!0){F=C+1;break}}D++}F==null&&(F=0),(k==null||F<k)&&(k=F)}S="down",I=k-s}}else if(e=="down"){if(s==v-1)return;{let P=[],F=null,D=0,k=null;for(let w=m;w<=p;w++){P=[],D=0;for(let C=s+1;C<_.length;C++){let T=_[C][w];if(G(T)=="object"&&ft(T.v)||ft(T)?P.push(!1):P.push(!0),P.length>1){if(P[D]==!0&&P[D-1]==!1){F=C;break}else if(P[D]==!1&&P[D-1]==!0){F=C-1;break}}D++}F==null&&(F=_.length-1),(k==null||F>k)&&(k=F)}S="down",I=k-s}}else if(e=="left"){if(u==0)return;{let P=[],F=null,D=0,k=null;for(let w=f;w<=d;w++){P=[],D=0;for(let C=u-1;C>=0;C--){let T=_[w][C];if(G(T)=="object"&&ft(T.v)||ft(T)?P.push(!1):P.push(!0),P.length>1){if(P[D]==!0&&P[D-1]==!1){F=C;break}else if(P[D]==!1&&P[D-1]==!0){F=C+1;break}}D++}F==null&&(F=0),(k==null||F<k)&&(k=F)}S="right",I=k-u}}else if(e=="right"){if(u==x-1)return;{let P=[],F=null,D=0,k=null;for(let w=f;w<=d;w++){P=[],D=0;for(let C=u+1;C<_[0].length;C++){let T=_[w][C];if(G(T)=="object"&&ft(T.v)||ft(T)?P.push(!1):P.push(!0),P.length>1){if(P[D]==!0&&P[D-1]==!1){F=C;break}else if(P[D]==!1&&P[D-1]==!0){F=C-1;break}}D++}F==null&&(F=_[0].length-1),(k==null||F>k)&&(k=F)}S="right",I=k-u}}if(n=="range"&&(e=="up"?p_endR<d&&I+s<p_endR&&(I=p_endR-s):e=="down"?b>f&&I+s>b&&(I=b-s):e=="left"?p_endC<p&&I+u<p_endC&&(I=p_endC-u):e=="right"&&g>m&&I+u>g&&(I=g-u),l!=null&&Math.abs(I)>Math.abs(l)&&(I=l)),!o)n=="cell"?Cr(S,I,"rangeOfSelect",t):n=="range"&&$s(S,I,"rangeOfSelect",t);else return I}function Cr(e,n,t,l){l==null&&(l=!0),e||e=="down";let o=h.flowdata.length,a=h.flowdata[0].length,s,u,f,m,d,p,b,g;if(t=="rangeOfSelect"){let F=h.luckysheet_select_save[h.luckysheet_select_save.length-1],D;F.row_focus==null?D=F.row[0]:D=F.row_focus;let k;F.column_focus==null?k=F.column[0]:k=F.column_focus;let w=_t.mergeborer(h.flowdata,D,k);if(w){let z=w.row[2],A=w.row[3],E=w.column[2],L=w.column[3];n>0?e=="down"?(D=A,k=E):e=="right"&&(D=z,k=L):(D=z,k=E)}let C=F.moveXY==null?D:F.moveXY.x,T=F.moveXY==null?k:F.moveXY.y;e=="down"?(D+=n,C=D):e=="right"&&(k+=n,T=k),D>=o&&(D=o-1,C=D),D<0&&(D=0,C=D),k>=a&&(k=a-1,T=k),k<0&&(k=0,T=k);let O=_t.mergeborer(h.flowdata,D,k);O?(s=O.row[1],u=O.row[0],f=O.row[2],m=O.row[3],d=O.column[1],p=O.column[0],b=O.column[2],g=O.column[3]):(s=h.visibledatarow[C],u=C-1==-1?0:h.visibledatarow[C-1],d=h.visibledatacolumn[T],p=T-1==-1?0:h.visibledatacolumn[T-1],f=m=D,b=g=k),F.row=[f,m],F.column=[b,g],F.row_focus=f,F.column_focus=b,F.moveXY={x:C,y:T},gl(),Yt.pivotclick(f,b),y.fucntionboxshow(f,b)}else if(t=="rangeOfFormula"){let F=y.func_selectedrange,D;F.row_focus==null?D=F.row[0]:D=F.row_focus;let k;F.column_focus==null?k=F.column[0]:k=F.column_focus;let w=_t.mergeborer(h.flowdata,D,k);if(w){let z=w.row[2],A=w.row[3],E=w.column[2],L=w.column[3];n>0?e=="down"?(D=A,k=E):e=="right"&&(D=z,k=L):(D=z,k=E)}let C=F.moveXY==null?D:F.moveXY.x,T=F.moveXY==null?k:F.moveXY.y;e=="down"?(D+=n,C=D):e=="right"&&(k+=n,T=k),D>=o&&(D=o-1,C=D),D<0&&(D=0,C=D),k>=a&&(k=a-1,T=k),k<0&&(k=0,T=k);let O=_t.mergeborer(h.flowdata,D,k);O?(s=O.row[1],u=O.row[0],f=O.row[2],m=O.row[3],d=O.column[1],p=O.column[0],b=O.column[2],g=O.column[3]):(s=h.visibledatarow[C],u=C-1==-1?0:h.visibledatarow[C-1],f=C,m=C,d=h.visibledatacolumn[T],p=T-1==-1?0:h.visibledatacolumn[T-1],b=T,g=T),y.func_selectedrange={left:p,width:d-p-1,top:u,height:s-u-1,left_move:p,width_move:d-p-1,top_move:u,height_move:s-u-1,row:[f,m],column:[b,g],row_focus:f,column_focus:b,moveXY:{x:C,y:T}},$("#luckysheet-formula-functionrange-select").css({left:p,width:d-p-1,top:u,height:s-u-1}).show(),y.rangeSetValue({row:[f,m],column:[b,g]})}let v=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),_=$("#luckysheet-cell-main").height(),S=$("#luckysheet-cell-main").width(),I=0,P=0;d-v-S+20>0?(I=d-S+20,l&&$("#luckysheet-scrollbar-x").scrollLeft(I)):p-v-20<0&&(I=p-20,l&&$("#luckysheet-scrollbar-x").scrollLeft(I)),s-x-_+20>0?(P=s-_+20,l&&$("#luckysheet-scrollbar-y").scrollTop(P)):u-x-20<0&&(P=u-20,l&&$("#luckysheet-scrollbar-y").scrollTop(P)),clearTimeout(h.countfuncTimeout),Nn(),Ue.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save)}function ic(e,n,t){t||(t=!0);let l,o,a,s;if(n=="rangeOfSelect"){let g=h.luckysheet_select_save[h.luckysheet_select_save.length-1],v=g.row_focus,x=g.column_focus,_=!1,S={};if(h.config.merge!=null&&v+"_"+x in h.config.merge&&(_=!0,S=h.config.merge[v+"_"+x]),e=="down"){if(v==h.flowdata.length-1)return;_?v=Ul("down",x,S.r+S.rs-1,h.flowdata.length-1):v=Ul("down",x,v,h.flowdata.length-1)}else if(e=="up"){if(v==0)return;_?v=Ul("up",x,0,S.r):v=Ul("up",x,0,v)}else if(e=="right"){if(x==h.flowdata[0].length-1)return;_?x=Ul("right",v,S.c+S.cs-1,h.flowdata[0].length-1):x=Ul("right",v,x,h.flowdata[0].length-1)}else if(e=="left"){if(x==0)return;_?x=Ul("left",v,0,S.c):x=Ul("left",v,0,x)}let I=[v,v],P=[x,x];l=h.visibledatarow[v],o=v-1==-1?0:h.visibledatarow[v-1],a=h.visibledatacolumn[x],s=x-1==-1?0:h.visibledatacolumn[x-1];let F=_t.mergeMoveMain(P,I,g,o,l-o-1,s,a-s-1);F!=null&&(P=F[0],I=F[1]),h.luckysheet_select_save=[{row:I,column:P}],gl(),Yt.pivotclick(v,x),y.fucntionboxshow(v,x)}else if(n=="rangeOfFormula"){let g=y.func_selectedrange,v=g.row_focus,x=g.column_focus,_=!1,S={};if(h.config.merge!=null&&v+"_"+x in h.config.merge&&(_=!0,S=h.config.merge[v+"_"+x]),e=="down"){if(v==h.flowdata.length-1)return;_?v=Ul("down",x,S.r+S.rs-1,h.flowdata.length-1):v=Ul("down",x,v,h.flowdata.length-1)}else if(e=="up"){if(v==0)return;_?v=Ul("up",x,0,S.r):v=Ul("up",x,0,v)}else if(e=="right"){if(x==h.flowdata[0].length-1)return;_?x=Ul("right",v,S.c+S.cs-1,h.flowdata[0].length-1):x=Ul("right",v,x,h.flowdata[0].length-1)}else if(e=="left"){if(x==0)return;_?x=Ul("left",v,0,S.c):x=Ul("left",v,0,x)}let I=[v,v],P=[x,x];l=h.visibledatarow[v],o=v-1==-1?0:h.visibledatarow[v-1],a=h.visibledatacolumn[x],s=x-1==-1?0:h.visibledatacolumn[x-1];let F=o,D=l-o-1,k=s,w=a-s-1,C=_t.mergeMoveMain(P,I,g,F,D,k,w);C!=null&&(P=C[0],I=C[1],F=C[2],D=C[3],k=C[4],w=C[5]),y.func_selectedrange={left:k,width:w,top:F,height:D,left_move:k,width_move:w,top_move:F,height_move:D,row:I,column:P,row_focus:v,column_focus:x},$("#luckysheet-formula-functionrange-select").css({left:k,width:w,top:F,height:D}).show(),y.rangeSetValue({row:I,column:P})}let u=$("#luckysheet-cell-main").scrollLeft(),f=$("#luckysheet-cell-main").scrollTop(),m=$("#luckysheet-cell-main").height(),d=$("#luckysheet-cell-main").width(),p=0,b=0;a-u-d+20>0?(p=a-d+20,t&&$("#luckysheet-scrollbar-x").scrollLeft(p)):s-u-20<0&&(p=s-20,t&&$("#luckysheet-scrollbar-x").scrollLeft(p)),l-f-m+20>0?(b=l-m+20,t&&$("#luckysheet-scrollbar-y").scrollTop(b)):o-f-20<0&&(b=o-20,t&&$("#luckysheet-scrollbar-y").scrollTop(b)),clearTimeout(h.countfuncTimeout),Nn()}function $s(e,n,t,l){l==null&&(l=!0),e||e=="down";let o,a,s,u;if(t=="rangeOfSelect"){let v=h.luckysheet_select_save[h.luckysheet_select_save.length-1],x=v.row[0],_=v.row[1],S=v.column[0],I=v.column[1],P=v.row_focus,F=v.column_focus,D=h.flowdata.length,k=h.flowdata[0].length;if(e=="down"){if(Fi(P,S,I)){let O=Xi(P,S,I),z=O[0],A=O[1];z>x&&A==_?(n>0&&Fi(x,S,I)&&(x=Xi(x,S,I)[1]),x+=n):A<_&&z==x?(n<0&&Fi(_,S,I)&&(_=Xi(_,S,I)[0]),_+=n):n>0?_+=n:x+=n}else P>x&&P==_?(n>0&&Fi(x,S,I)&&(x=Xi(x,S,I)[1]),x+=n):P<_&&P==x?(n<0&&Fi(_,S,I)&&(_=Xi(_,S,I)[0]),_+=n):P==x&&P==_&&(n>0?_+=n:x+=n);_>=D&&(_=D-1),_<0&&(_=0),x>=D&&(x=D-1),x<0&&(x=0)}else{if(Mi(F,x,_)){let O=Zi(F,x,_),z=O[0],A=O[1];z>S&&A==I?(n>0&&Mi(S,x,_)&&(S=Zi(S,x,_)[1]),S+=n):A<I&&z==S?(n<0&&Mi(I,x,_)&&(I=Zi(I,x,_)[0]),I+=n):n>0?I+=n:S+=n}else F>S&&F==I?(n>0&&Mi(S,x,_)&&(S=Zi(S,x,_)[1]),S+=n):F<I&&F==S?(n<0&&Mi(I,x,_)&&(I=Zi(I,x,_)[0]),I+=n):F==S&&F==I&&(n>0?I+=n:S+=n);I>=k&&(I=k-1),I<0&&(I=0),S>=k&&(S=k-1),S<0&&(S=0)}let w=[x,_],C=[S,I];o=h.visibledatarow[_],a=x-1==-1?0:h.visibledatarow[x-1],s=h.visibledatacolumn[I],u=S-1==-1?0:h.visibledatacolumn[S-1];let T=_t.mergeMoveMain(C,w,v,a,o-a-1,u,s-u-1);T!=null&&(C=T[0],w=T[1]),v.row=w,v.column=C,gl()}else if(t=="rangeOfFormula"){let v=y.func_selectedrange,x=v.row[0],_=v.row[1],S=v.column[0],I=v.column[1],P=v.row_focus,F=v.column_focus,D=h.flowdata.length,k=h.flowdata[0].length;if(e=="down"){if(Fi(P,S,I)){let L=Xi(P,S,I),N=L[0],W=L[1];N>x&&W==_?(n>0&&Fi(x,S,I)&&(x=Xi(x,S,I)[1]),x+=n):W<_&&N==x?(n<0&&Fi(_,S,I)&&(_=Xi(_,S,I)[0]),_+=n):n>0?_+=n:x+=n}else P>x&&P==_?(n>0&&Fi(x,S,I)&&(x=Xi(x,S,I)[1]),x+=n):P<_&&P==x?(n<0&&Fi(_,S,I)&&(_=Xi(_,S,I)[0]),_+=n):P==x&&P==_&&(n>0?_+=n:x+=n);_>=D&&(_=D-1),_<0&&(_=0),x>=D&&(x=D-1),x<0&&(x=0)}else{if(Mi(F,x,_)){let L=Zi(F,x,_),N=L[0],W=L[1];N>S&&W==I?(n>0&&Mi(S,x,_)&&(S=Zi(S,x,_)[1]),S+=n):W<I&&N==S?(n<0&&Mi(I,x,_)&&(I=Zi(I,x,_)[0]),I+=n):n>0?I+=n:S+=n}else F>S&&F==I?(n>0&&Mi(S,x,_)&&(S=Zi(S,x,_)[1]),S+=n):F<I&&F==S?(n<0&&Mi(I,x,_)&&(I=Zi(I,x,_)[0]),I+=n):F==S&&F==I&&(n>0?I+=n:S+=n);I>=k&&(I=k-1),I<0&&(I=0),S>=k&&(S=k-1),S<0&&(S=0)}let w=[x,_],C=[S,I];o=h.visibledatarow[_],a=x-1==-1?0:h.visibledatarow[x-1],s=h.visibledatacolumn[I],u=S-1==-1?0:h.visibledatacolumn[S-1];let T=a,O=o-a-1,z=u,A=s-u-1,E=_t.mergeMoveMain(C,w,v,T,O,z,A);E!=null&&(C=E[0],w=E[1],T=E[2],O=E[3],z=E[4],A=E[5]),y.func_selectedrange={left:z,width:A,top:T,height:O,left_move:z,width_move:A,top_move:T,height_move:O,row:w,column:C,row_focus:P,column_focus:F},$("#luckysheet-formula-functionrange-select").css({left:z,width:A,top:T,height:O}).show(),y.rangeSetValue({row:w,column:C})}let f=$("#luckysheet-cell-main").scrollLeft(),m=$("#luckysheet-cell-main").scrollTop(),d=$("#luckysheet-cell-main").height(),p=$("#luckysheet-cell-main").width(),b=0,g=0;s-f-p+20>0?(b=s-p+20,l&&$("#luckysheet-scrollbar-x").scrollLeft(b)):u-f-20<0&&(b=u-20,l&&$("#luckysheet-scrollbar-x").scrollLeft(b)),o-m-d+20>0?(g=o-d+20,l&&$("#luckysheet-scrollbar-y").scrollTop(g)):a-m-20<0&&(g=a-20,l&&$("#luckysheet-scrollbar-y").scrollTop(g)),clearTimeout(h.countfuncTimeout),Nn()}function xa(e,n,t){t||(t=!0);let l,o,a,s;if(n=="rangeOfSelect"){let g=h.luckysheet_select_save[h.luckysheet_select_save.length-1],v=g.row_focus,x=g.column_focus,_=g.row[0],S=g.row[1],I=g.column[0],P=g.column[1];if(e=="down"){if(S==h.flowdata.length-1)return;if(Fi(v,I,P)){let w=Xi(v,I,P),C=w[0],T=w[1];C>_&&T==S?_=Ul("down",x,_,S):S=Ul("down",x,S,h.flowdata.length-1)}else v>_&&v==S?_=Ul("down",x,_,S):S=Ul("down",x,S,h.flowdata.length-1)}else if(e=="up"){if(_==0)return;if(Fi(v,I,P)){let w=Xi(v,I,P),C=w[0];w[1]<S&&C==_?S=Ul("up",x,_,S):_=Ul("up",x,0,_)}else v<S&&v==_?S=Ul("up",x,_,S):_=Ul("up",x,0,_)}else if(e=="right"){if(P==h.flowdata[0].length-1)return;if(Mi(x,_,S)){let w=Zi(x,_,S),C=w[0],T=w[1];C>I&&T==P?I=Ul("right",v,I,P):P=Ul("right",v,P,h.flowdata[0].length-1)}else x>I&&x==P?I=Ul("right",v,I,P):P=Ul("right",v,P,h.flowdata[0].length-1)}else if(e=="left"){if(I==0)return;if(Mi(x,_,S)){let w=Zi(x,_,S),C=w[0];w[1]<P&&C==I?P=Ul("left",v,I,P):I=Ul("left",v,0,I)}else x<P&&x==I?P=Ul("left",v,I,P):I=Ul("left",v,0,I)}let F=[_,S],D=[I,P];l=h.visibledatarow[S],o=_-1==-1?0:h.visibledatarow[_-1],a=h.visibledatacolumn[P],s=I-1==-1?0:h.visibledatacolumn[I-1];let k=_t.mergeMoveMain(D,F,g,o,l-o-1,s,a-s-1);k!=null&&(D=k[0],F=k[1]),g.row=F,g.column=D,gl()}else if(n=="rangeOfFormula"){let g=y.func_selectedrange,v=g.row_focus,x=g.column_focus,_=g.row[0],S=g.row[1],I=g.column[0],P=g.column[1];if(e=="down"){if(S==h.flowdata.length-1)return;if(Fi(v,I,P)){let z=Xi(v,I,P),A=z[0],E=z[1];A>_&&E==S?_=Ul("down",x,_,S):S=Ul("down",x,S,h.flowdata.length-1)}else v>_&&v==S?_=Ul("down",x,_,S):S=Ul("down",x,S,h.flowdata.length-1)}else if(e=="up"){if(_==0)return;if(Fi(v,I,P)){let z=Xi(v,I,P),A=z[0];z[1]<S&&A==_?S=Ul("up",x,_,S):_=Ul("up",x,0,_)}else v<S&&v==_?S=Ul("up",x,_,S):_=Ul("up",x,0,_)}else if(e=="right"){if(P==h.flowdata[0].length-1)return;if(Mi(x,_,S)){let z=Zi(x,_,S),A=z[0],E=z[1];A>I&&E==P?I=Ul("right",v,I,P):P=Ul("right",v,P,h.flowdata[0].length-1)}else x>I&&x==P?I=Ul("right",v,I,P):P=Ul("right",v,P,h.flowdata[0].length-1)}else if(e=="left"){if(I==0)return;if(Mi(x,_,S)){let z=Zi(x,_,S),A=z[0];z[1]<P&&A==I?P=Ul("left",v,I,P):I=Ul("left",v,0,I)}else x<P&&x==I?P=Ul("left",v,I,P):I=Ul("left",v,0,I)}let F=[_,S],D=[I,P];l=h.visibledatarow[S],o=_-1==-1?0:h.visibledatarow[_-1],a=h.visibledatacolumn[P],s=I-1==-1?0:h.visibledatacolumn[I-1];let k=o,w=l-o-1,C=s,T=a-s-1,O=_t.mergeMoveMain(D,F,g,k,w,C,T);O!=null&&(D=O[0],F=O[1],k=O[2],w=O[3],C=O[4],T=O[5]),y.func_selectedrange={left:C,width:T,top:k,height:w,left_move:C,width_move:T,top_move:k,height_move:w,row:F,column:D,row_focus:v,column_focus:x},$("#luckysheet-formula-functionrange-select").css({left:C,width:T,top:k,height:w}).show(),y.rangeSetValue({row:F,column:D})}let u=$("#luckysheet-cell-main").scrollLeft(),f=$("#luckysheet-cell-main").scrollTop(),m=$("#luckysheet-cell-main").height(),d=$("#luckysheet-cell-main").width(),p=0,b=0;a-u-d+20>0?(p=a-d+20,t&&$("#luckysheet-scrollbar-x").scrollLeft(p)):s-u-20<0&&(p=s-20,t&&$("#luckysheet-scrollbar-x").scrollLeft(p)),l-f-m+20>0?(b=l-m+20,t&&$("#luckysheet-scrollbar-y").scrollTop(b)):o-f-20<0&&(b=o-20,t&&$("#luckysheet-scrollbar-y").scrollTop(b)),clearTimeout(h.countfuncTimeout),Nn()}function Fi(e,n,t){let l=!1;for(let o=n;o<=t;o++){let a=h.flowdata[e][o];if(G(a)=="object"&&"mc"in a){l=!0;break}}return l}function Mi(e,n,t){let l=!1;for(let o=n;o<=t;o++){let a=h.flowdata[o][e];if(G(a)=="object"&&"mc"in a){l=!0;break}}return l}function Xi(e,n,t){let l=0,o=h.flowdata.length-1,a=null;if(e>l)for(let u=e;u>=l;u--){for(let f=n;f<=t;f++){let m=h.flowdata[u][f];if(G(m)=="object"&&"mc"in m){let d=h.config.merge[m.mc.r+"_"+m.mc.c];(a==null||d.r<a)&&(a=d.r)}}if(Fi(a-1,n,t)&&a>l)u=a-1;else break}else a=l;let s=null;if(e<o)for(let u=e;u<=o;u++){for(let f=n;f<=t;f++){let m=h.flowdata[u][f];if(G(m)=="object"&&"mc"in m){let d=h.config.merge[m.mc.r+"_"+m.mc.c];(s==null||d.r+d.rs-1>s)&&(s=d.r+d.rs-1)}}if(Fi(s+1,n,t)&&s<o)u=s+1;else break}else s=o;return[a,s]}function Zi(e,n,t){let l=0,o=h.flowdata[0].length-1,a=null;if(e>l)for(let u=e;u>=l;u--){for(let f=n;f<=t;f++){let m=h.flowdata[f][u];if(G(m)=="object"&&"mc"in m){let d=h.config.merge[m.mc.r+"_"+m.mc.c];(a==null||d.c<a)&&(a=d.c)}}if(Mi(a-1,n,t)&&a>l)u=a-1;else break}else a=l;let s=null;if(e<o)for(let u=e;u<=o;u++){for(let f=n;f<=t;f++){let m=h.flowdata[f][u];if(G(m)=="object"&&"mc"in m){let d=h.config.merge[m.mc.r+"_"+m.mc.c];(s==null||d.c+d.cs-1>s)&&(s=d.c+d.cs-1)}}if(Mi(s+1,n,t)&&s<o)u=s+1;else break}else s=o;return[a,s]}function Ul(e,n,t,l){let o=null,a;if(e=="down"){let s=h.flowdata[t][n];G(s)=="object"&&ft(s.v)||ft(s)?a=!0:a=!1,console.log(a,"stNull");let u=[],f=0;for(let m=t+1;m<=l;m++){let d=h.flowdata[m][n];if(G(d)=="object"&&ft(d.v)||ft(d)?u.push(!0):u.push(!1),u.length==1&&a==!0&&u[f]==!1){o=t+f+1;break}else if(u.length>1){if(a&&u[f]==!1){o=t+f+1;break}else if(!a){if(u[f]==!1&&u[f-1]==!0){o=t+f+1;break}else if(u[f]==!0&&u[f-1]==!1){o=t+f;break}}}m==l&&(o=l),f++}}else if(e=="up"){let s=h.flowdata[l][n];G(s)=="object"&&ft(s.v)||ft(s)?a=!0:a=!1;let u=[],f=0;for(let m=l-1;m>=t;m--){let d=h.flowdata[m][n];if(G(d)=="object"&&ft(d.v)||ft(d)?u.push(!0):u.push(!1),u.length==1&&a&&u[f]==!1){o=l-(f+1);break}else if(u.length>1){if(a&&u[f]==!1){o=l-(f+1);break}else if(!a){if(u[f]==!1&&u[f-1]==!0){o=l-(f+1);break}else if(u[f]==!0&&u[f-1]==!1){o=l-f;break}}}m==t&&(o=t),f++}}else if(e=="right"){let s=h.flowdata[n][t];G(s)=="object"&&ft(s.v)||ft(s)?a=!0:a=!1;let u=[],f=0;for(let m=t+1;m<=l;m++){let d=h.flowdata[n][m];if(G(d)=="object"&&ft(d.v)||ft(d)?u.push(!0):u.push(!1),u.length==1&&a&&u[f]==!1){o=t+f+1;break}else if(u.length>1){if(a&&u[f]==!1){o=t+f+1;break}else if(!a){if(u[f]==!1&&u[f-1]==!0){o=t+f+1;break}else if(u[f]==!0&&u[f-1]==!1){o=t+f;break}}}m==l&&(o=l),f++}}else if(e=="left"){let s=h.flowdata[n][l];G(s)=="object"&&ft(s.v)||ft(s)?a=!0:a=!1;let u=[],f=0;for(let m=l-1;m>=t;m--){let d=h.flowdata[n][m];if(G(d)=="object"&&ft(d.v)||ft(d)?u.push(!0):u.push(!1),u.length==1&&a&&u[f]==!1){o=l-(f+1);break}else if(u.length>1){if(a&&u[f]==!1){o=l-(f+1);break}else if(!a){if(u[f]==!1&&u[f-1]==!0){o=l-(f+1);break}else if(u[f]==!0&&u[f-1]==!1){o=l-f;break}}}m==t&&(o=t),f++}}return o}var import_plugin,Kc=Nt(()=>{import_plugin=qe(Ye());Ol();Sr();cr();Xc();ln();jr();_a();il();qr()});var import_plugin,Hx,Ur,Jc=Nt(()=>{import_plugin=qe(Ye());fr();Ol();Sr();cr();Kr();Ar();Rr();ho();qr();jr();il();Xl();Hx={rangefocus:!1,modelfocusIndex:null,FixedModelColor:[{head:{fc:"#000",bc:"#bfbdbe"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f3f7"},foot:{fc:"#000",bc:"#dde2de"}},{head:{fc:"#000",bc:"#4bd4e7"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eaf7ff"},foot:{fc:"#000",bc:"#aae9f8"}},{head:{fc:"#000",bc:"#5ed593"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#e5fbee"},foot:{fc:"#000",bc:"#a5efcc"}},{head:{fc:"#000",bc:"#f6cb4b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fff9e7"},foot:{fc:"#000",bc:"#ffebac"}},{head:{fc:"#000",bc:"#f96420"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ffe5d9"},foot:{fc:"#000",bc:"#ffcfba"}},{head:{fc:"#000",bc:"#5599fc"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ecf2fe"},foot:{fc:"#000",bc:"#afcbfa"}},{head:{fc:"#000",bc:"#22a69b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#dff2f8"},foot:{fc:"#000",bc:"#8dd4d0"}},{head:{fc:"#000",bc:"#7a939a"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0eff7"},foot:{fc:"#000",bc:"#bdcad0"}},{head:{fc:"#000",bc:"#d7a270"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fdf3f1"},foot:{fc:"#000",bc:"#ead2b6"}},{head:{fc:"#000",bc:"#89c54b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f1f7e9"},foot:{fc:"#000",bc:"#c5e3a7"}},{head:{fc:"#000",bc:"#8f88f0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0e5ff"},foot:{fc:"#000",bc:"#c6c4f6"}},{head:{fc:"#000",bc:"#fd1664"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#feddee"},foot:{fc:"#000",bc:"#f98ab5"}},{head:{fc:"#000",bc:"#da96d3"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fce8fb"},foot:{fc:"#000",bc:"#f2caee"}},{head:{fc:"#000",bc:"#b49191"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f5ebe8"},foot:{fc:"#000",bc:"#d8c3c3"}},{head:{fc:"#000",bc:"#91b493"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0fbf0"},foot:{fc:"#000",bc:"#b4cfb6"}},{head:{fc:"#000",bc:"#b4a891"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f6f1"},foot:{fc:"#000",bc:"#d3cab8"}},{head:{fc:"#000",bc:"#91abb4"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eff7fa"},foot:{fc:"#000",bc:"#b7cbd3"}},{head:{fc:"#000",bc:"#b7ba82"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fafbeb"},foot:{fc:"#000",bc:"#dadcb4"}},{head:{fc:"#000",bc:"#df3e3e"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fde9e9"},foot:{fc:"#000",bc:"#f89292"}},{head:{fc:"#000",bc:"#f2711c"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fef0d7"},foot:{fc:"#000",bc:"#fbb335"}},{head:{fc:"#000",bc:"#b5cc18"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f9fbd4"},foot:{fc:"#000",bc:"#e2ed2a"}},{head:{fc:"#000",bc:"#00b5ad"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ccfaf9"},foot:{fc:"#000",bc:"#00e4df"}},{head:{fc:"#000",bc:"#2185d0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#d8f3fc"},foot:{fc:"#000",bc:"#3cc4f0"}},{head:{fc:"#000",bc:"#a5673f"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f6ede5"},foot:{fc:"#000",bc:"#d3a47c"}}],getModelBox:function(e,n){let t=this;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").empty(),$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").empty();let l="";for(let a=0;a<t.FixedModelColor.length;a++){let s=t.FixedModelColor[a],u,f,m,d;e&&n?(u=s.head,f=s.one,m=s.two,d=s.foot):e?(u=s.head,f=s.one,m=s.two,d=s.one):n?(u=s.one,f=s.two,m=s.one,d=s.foot):(u=s.one,f=s.two,m=s.one,d=s.two),l+='<div class="modelbox"><div class="box"><span style="color:'+u.fc+";background-color:"+u.bc+'"> \u2014 </span><span style="color:'+f.fc+";background-color:"+f.bc+'"> \u2014 </span><span style="color:'+m.fc+";background-color:"+m.bc+'"> \u2014 </span><span style="color:'+d.fc+";background-color:"+d.bc+'"> \u2014 </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelList").append(l);let o=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(o!=null&&o.length>0){let a="";for(let s=0;s<o.length;s++){let u=o[s],f,m,d,p;e&&n?(f=u.head,m=u.one,d=u.two,p=u.foot):e?(f=u.head,m=u.one,d=u.two,p=u.one):n?(f=u.one,m=u.two,d=u.one,p=u.foot):(f=u.one,m=u.two,d=u.one,p=u.two),a+='<div class="modelbox"><div class="box"><span style="color:'+f.fc+";background-color:"+f.bc+'"> \u2014 </span><span style="color:'+m.fc+";background-color:"+m.bc+'"> \u2014 </span><span style="color:'+d.fc+";background-color:"+d.bc+'"> \u2014 </span><span style="color:'+p.fc+";background-color:"+p.bc+'"> \u2014 </span></div></div>'}$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-modelCustom").append(a)}},init:function(){let e=this;$("#luckysheet-modal-dialog-slider-alternateformat").remove(),$("body").first().append(w0()),mr(),$("#luckysheet-modal-dialog-slider-alternateformat .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),mr()}),$(document).off("focus.AFrangeInput").on("focus.AFrangeInput","#luckysheet-alternateformat-range input",function(){e.rangefocus=!0}),$(document).off("blur.AFrangeInput").on("blur.AFrangeInput","#luckysheet-alternateformat-range input",function(){e.rangefocus=!1}),$(document).off("keydown.AFrangeInput").on("keydown.AFrangeInput","#luckysheet-alternateformat-range input",function(n){let t=$(this).val().trim();n.keyCode==13&&e.update()}),$(document).off("click.AFrangeIcon").on("click.AFrangeIcon","#luckysheet-alternateformat-range .fa-table",function(){$("#luckysheet-modal-dialog-slider-alternateformat").hide(),mr();let n=$(this).parents("#luckysheet-alternateformat-range").find("input").val().trim();e.rangeDialog(n)}),$(document).off("click.AFrDCf").on("click.AFrDCf","#luckysheet-alternateformat-rangeDialog-confirm",function(){let n=$(this).parents("#luckysheet-alternateformat-rangeDialog").find("input").val().trim();$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val(n),$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),mr(),e.update()}),$(document).off("click.AFrDCl").on("click.AFrDCl","#luckysheet-alternateformat-rangeDialog-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),mr()}),$(document).off("click.AFrDTitle").on("click.AFrDTitle","#luckysheet-alternateformat-rangeDialog .luckysheet-modal-dialog-title-close",function(){$(this).parents("#luckysheet-alternateformat-rangeDialog").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").show(),mr()}),$(document).off("change.AFrowHeader").on("change.AFrowHeader","#luckysheet-alternateformat-rowHeader",function(){let n;$(this).is(":checked")?n=!0:n=!1;let t;$("#luckysheet-alternateformat-rowFooter").is(":checked")?t=!0:t=!1,e.checkboxChange(n,t),e.modelboxOn(),e.update()}),$(document).off("change.AFrowFooter").on("change.AFrowFooter","#luckysheet-alternateformat-rowFooter",function(){let n;$("#luckysheet-alternateformat-rowHeader").is(":checked")?n=!0:n=!1;let t;$(this).is(":checked")?t=!0:t=!1,e.checkboxChange(n,t),e.modelboxOn(),e.update()}),$(document).off("click.AFmodelbox").on("click.AFmodelbox","#luckysheet-modal-dialog-slider-alternateformat .modelbox",function(){let n=$(this).index(),t=$(this).parents(".cf").attr("id");if(t=="luckysheet-alternateformat-modelList")e.modelfocusIndex=n;else if(t=="luckysheet-alternateformat-modelCustom"){let l=e.FixedModelColor.length;e.modelfocusIndex=n+l}e.modelboxOn(),e.update()}),$(document).off("click.AFselectColor").on("click.AFselectColor","#luckysheet-modal-dialog-slider-alternateformat .luckysheet-color-menu-button-indicator",function(){let n=$(this).closest(".toningbox"),t,l;$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-text-color")?(t="fc",l=n.find(".toningShow").data("fc")):$(this).find(".luckysheet-icon-img").hasClass("luckysheet-icon-cell-color")&&(t="bc",l=n.find(".toningShow").data("bc"));let o;n.hasClass("header")?o="0":n.hasClass("ctOne")?o="1":n.hasClass("ctTwo")?o="2":n.hasClass("footer")&&(o="3"),e.colorSelectDialog(l,t,o)}),$(document).off("click.AFselectColorConfirm").on("click.AFselectColorConfirm","#luckysheet-alternateformat-colorSelect-dialog-confirm",function(){let n=$(this).parents("#luckysheet-alternateformat-colorSelect-dialog"),l=Be().alternatingColors;$("#luckysheet-modal-dialog-mask").hide(),n.hide();let o=n.find(".currenColor span").attr("title"),a;n.find(".luckysheet-modal-dialog-title-text").text()==l.selectionTextColor?a="fc":n.find(".luckysheet-modal-dialog-title-text").text()==l.selectionCellColor&&(a="bc");let s=n.find(".currenColor").attr("data-source");s=="0"?(a=="fc"&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .header .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o))):s=="1"?(a=="fc"&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o))):s=="2"?(a=="fc"&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o))):s=="3"&&(a=="fc"&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("color",o),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",o),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)),a=="bc"&&($("#luckysheet-alternateformat-modelToning .footer .toningShow").css("background-color",o),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("bc",o),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",o)));let u;$("#luckysheet-alternateformat-rowHeader").is(":checked")?u=!0:u=!1;let f;$("#luckysheet-alternateformat-rowFooter").is(":checked")?f=!0:f=!1;let m=e.modelfocusIndex,d=e.FixedModelColor.length,p,b;if(m<d)p=$.extend(!0,{},e.getFormatByIndex());else{b=h.luckysheetfile[Me(h.currentSheetIndex)];let g=b.luckysheet_alternateformat_save_modelCustom;p=$.extend(!0,{},g[m-d])}s=="0"?a=="fc"?p.head.fc=o:a=="bc"&&(p.head.bc=o):s=="1"?a=="fc"?p.one.fc=o:a=="bc"&&(p.one.bc=o):s=="2"?a=="fc"?p.two.fc=o:a=="bc"&&(p.two.bc=o):s=="3"&&(a=="fc"&&(p.foot.fc=o),a=="bc"&&(p.foot.bc=o)),e.modelfocusIndex<d?(e.addCustomModel(p),e.modelfocusIndex=e.getIndexByFormat(p)):(b.luckysheet_alternateformat_save_modelCustom[m-d]=p,Ue.allowUpdate&&Ue.saveParam("all",h.currentSheetIndex,b.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})),e.getModelBox(u,f),e.modelboxOn(),e.update()}),$(document).off("click.AFremove").on("click.AFremove","#luckysheet-alternateformat-remove",function(){let n=$(this).data("index"),l=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_alternateformat_save,o=$.extend(!0,[],l);l.length>1?l.splice(n,1):l=[];let a=$.extend(!0,[],l);e.ref(o,a),Ue.allowUpdate&&Ue.saveParam("all",h.currentSheetIndex,l,{k:"luckysheet_alternateformat_save"}),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-alternateformat").hide(),mr()})},perfect:function(){let e=this,n=$.extend(!0,{},h.luckysheet_select_save[0]),t=e.rangeIsExists(n)[1],l=$.extend(!0,{},h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_alternateformat_save[t]),o=l.cellrange;$("#luckysheet-alternateformat-range input").val(Kl(h.currentSheetIndex,{row:o.row,column:o.column},h.currentSheetIndex)),h.luckysheet_select_save=[{row:o.row,column:o.column}],gl();let a=l.hasRowHeader,s=l.hasRowFooter,u=l.format;e.modelfocusIndex=e.getIndexByFormat(u),e.modelfocusIndex==null&&(e.addCustomModel(u),e.modelfocusIndex=e.getIndexByFormat(u)),e.checkboxChange(a,s),e.modelboxOn(),$("#luckysheet-alternateformat-remove").data("index",t)},checkboxChange:function(e,n){e?($("#luckysheet-alternateformat-rowHeader").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .header").show()):($("#luckysheet-alternateformat-rowHeader").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .header").hide()),n?($("#luckysheet-alternateformat-rowFooter").prop("checked",!0),$("#luckysheet-alternateformat-modelToning .footer").show()):($("#luckysheet-alternateformat-rowFooter").removeAttr("checked"),$("#luckysheet-alternateformat-modelToning .footer").hide()),this.getModelBox(e,n)},modelboxOn:function(){let e=this;$("#luckysheet-modal-dialog-slider-alternateformat .modelbox").removeClass("on");let n=e.modelfocusIndex,t=e.FixedModelColor.length;n<t?$("#luckysheet-alternateformat-modelList .modelbox").eq(n).addClass("on"):$("#luckysheet-alternateformat-modelCustom .modelbox").eq(n-t).addClass("on"),e.modelToningColor()},modelToningColor:function(){let e=this.getFormatByIndex();$("#luckysheet-alternateformat-modelToning .header .toningShow").css({color:e.head.fc,"background-color":e.head.bc}),$("#luckysheet-alternateformat-modelToning .header .toningShow").data("fc",e.head.fc).data("bc",e.head.bc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.fc),$("#luckysheet-alternateformat-modelToning .header .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.head.bc),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").css({color:e.one.fc,"background-color":e.one.bc}),$("#luckysheet-alternateformat-modelToning .ctOne .toningShow").data("fc",e.one.fc).data("bc",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.fc),$("#luckysheet-alternateformat-modelToning .ctOne .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.one.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").css({color:e.two.fc,"background-color":e.two.bc}),$("#luckysheet-alternateformat-modelToning .ctTwo .toningShow").data("fc",e.two.fc).data("bc",e.two.bc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.fc),$("#luckysheet-alternateformat-modelToning .ctTwo .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.two.bc),$("#luckysheet-alternateformat-modelToning .footer .toningShow").css({color:e.foot.fc,"background-color":e.foot.bc}),$("#luckysheet-alternateformat-modelToning .footer .toningShow").data("fc",e.foot.fc).data("bc",e.foot.bc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-text-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.fc),$("#luckysheet-alternateformat-modelToning .footer .luckysheet-icon-cell-color").parents(".luckysheet-color-menu-button-indicator").css("border-bottom-color",e.foot.bc)},addCustomModel:function(e){let n=h.luckysheetfile[Me(h.currentSheetIndex)];n.luckysheet_alternateformat_save_modelCustom==null&&(n.luckysheet_alternateformat_save_modelCustom=[]),n.luckysheet_alternateformat_save_modelCustom.push(e),Ue.allowUpdate&&Ue.saveParam("all",h.currentSheetIndex,n.luckysheet_alternateformat_save_modelCustom,{k:"luckysheet_alternateformat_save_modelCustom"})},colorSelectDialog:function(e,n,t){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-alternateformat-colorSelect-dialog").remove();let l=Be(),o=l.alternatingColors,a=l.button,s=l.toolbar,u;n=="fc"?u=o.selectionTextColor:n=="bc"&&(u=o.selectionCellColor),$("body").first().append(Tt(Ll,{id:"luckysheet-alternateformat-colorSelect-dialog",addclass:"luckysheet-alternateformat-colorSelect-dialog",title:u,content:"<div class='currenColor' data-source='"+t+"'>"+o.currentColor+"\uFF1A<span title='"+e+"' style='background-color:"+e+"'></span></div><div class='colorshowbox'></div>",botton:'<button id="luckysheet-alternateformat-colorSelect-dialog-confirm" class="btn btn-primary">'+a.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+a.cancel+"</button>",style:"z-index:100003"}));let f=$("#luckysheet-alternateformat-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),m=f.outerHeight(),d=f.outerWidth(),p=$(window).width(),b=$(window).height(),g=$(document).scrollLeft(),v=$(document).scrollTop();$("#luckysheet-alternateformat-colorSelect-dialog").css({left:(p+g-d)/2,top:(b+v-m)/3}).show(),$("#luckysheet-alternateformat-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:a.cancel,chooseText:s.confirmColor,togglePaletteMoreText:s.customColor,togglePaletteLessText:s.collapse,togglePaletteOnly:!0,clearText:s.clearText,noColorSelectedText:s.noColorSelectedText,localStorageKey:"spectrum.textcolor"+Ue.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(x){x!=null?x=x.toHexString():x="#000",$("#luckysheet-alternateformat-colorSelect-dialog .currenColor span").css("background-color",x).attr("title",x)}})},rangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-alternateformat-rangeDialog").remove();let n=Be(),t=n.alternatingColors,l=n.button;$("body").first().append(Tt(Ll,{id:"luckysheet-alternateformat-rangeDialog",addclass:"luckysheet-alternateformat-rangeDialog",title:t.selectRange,content:'<input readonly="readonly" placeholder="'+t.tipSelectRange+'" value="'+e+'"/>',botton:'<button id="luckysheet-alternateformat-rangeDialog-confirm" class="btn btn-primary">'+l.confirm+'</button><button id="luckysheet-alternateformat-rangeDialog-close" class="btn btn-default">'+l.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-alternateformat-rangeDialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-alternateformat-rangeDialog").css({left:(u+m-s)/2,top:(f+d-a)/3}).show()},rangeIsExists:function(e,n){let t=this,l=!1,o=null,a=$.extend(!0,[],h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_alternateformat_save);if(n!=null&&n!=null&&(a.length>1?a.splice(n,1):a=[]),a.length>0){let s=[];for(let f=0;f<a.length;f++){let m={index:f,map:t.getRangeMap(a[f].cellrange.row,a[f].cellrange.column)};s.push(m)}let u=t.getRangeMap(e.row,e.column);for(let f in u){if(l)break;for(let m=0;m<s.length;m++)if(f in s[m].map){l=!0,o=s[m].index;break}}}return[l,o]},getRangeMap:function(e,n){let t={},l=e[0],o=e[1],a=n[0],s=n[1];for(let u=l;u<=o;u++)for(let f=a;f<=s;f++)t[u+"_"+f]=0;return t},getIndexByFormat:function(e){let n=this,t=null,l=n.FixedModelColor;for(let a=0;a<l.length;a++){let s=l[a];if(e.head.fc==s.head.fc&&e.head.bc==s.head.bc&&e.one.fc==s.one.fc&&e.one.bc==s.one.bc&&e.two.fc==s.two.fc&&e.two.bc==s.two.bc&&e.foot.fc==s.foot.fc&&e.foot.bc==s.foot.bc){t=a;break}}let o=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom;if(o!=null&&o.length>0)for(let a=0;a<o.length;a++){let s=o[a];if(e.head.fc==s.head.fc&&e.head.bc==s.head.bc&&e.one.fc==s.one.fc&&e.one.bc==s.one.bc&&e.two.fc==s.two.fc&&e.two.bc==s.two.bc&&e.foot.fc==s.foot.fc&&e.foot.bc==s.foot.bc){t=l.length+a;break}}return t},getFormatByIndex:function(){let e=this,n=e.modelfocusIndex,t=e.FixedModelColor.length,l={};return n<t?l=e.FixedModelColor[n]:l=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_alternateformat_save_modelCustom[n-t],l},new:function(e){let n=this,t=n.getFormatByIndex(),o=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_alternateformat_save;o==null&&(o=[]);let a=$.extend(!0,[],o),s={cellrange:{row:e.row,column:e.column},format:t,hasRowHeader:!0,hasRowFooter:!1};o.push(s);let u=$.extend(!0,[],o);n.ref(a,u),Ue.allowUpdate&&Ue.saveParam("all",h.currentSheetIndex,o,{k:"luckysheet_alternateformat_save"})},update:function(){let e=this,t=Be().alternatingColors,l=$("#luckysheet-alternateformat-remove").data("index"),o=$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-range input").val().trim();if(!y.iscelldata(o)){at()?alert(t.errorNoRange):ke.info(t.errorNoRange,"");return}let a=y.getcellrange(o);if(e.rangeIsExists(a,l)[0]){at()?alert(t.errorExistColors):ke.info(t.errorExistColors,"");return}let u;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowHeader").is(":checked")?u=!0:u=!1;let f;$("#luckysheet-modal-dialog-slider-alternateformat #luckysheet-alternateformat-rowFooter").is(":checked")?f=!0:f=!1;let m=e.getFormatByIndex(),p=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_alternateformat_save;p==null&&(p=[]);let b=$.extend(!0,[],p),g={cellrange:{row:a.row,column:a.column},format:m,hasRowHeader:u,hasRowFooter:f};p[l]=g;let v=$.extend(!0,[],p);e.ref(b,v),Ue.allowUpdate&&Ue.saveParam("all",h.currentSheetIndex,p,{k:"luckysheet_alternateformat_save"})},checksAF:function(e,n,t){return e+"_"+n in t?t[e+"_"+n]:null},getComputeMap:function(){let n=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_alternateformat_save;return this.compute(n)},compute:function(e){let n={};if(e!=null&&e.length>0)for(let t=0;t<e.length;t++){let l=e[t].cellrange,o=e[t].format,a=e[t].hasRowHeader,s=e[t].hasRowFooter,u=l.row[0],f=l.row[1],m=l.column[0],d=l.column[1];if(a&&s){for(let p=m;p<=d;p++)n[u+"_"+p]=[o.head.fc,o.head.bc];if(f-u>1)for(let p=u+1;p<f;p++){let b,g;(p-u)%2!=0?(b=o.one.fc,g=o.one.bc):(b=o.two.fc,g=o.two.bc);for(let v=m;v<=d;v++)n[p+"_"+v]=[b,g]}if(f>u)for(let p=m;p<=d;p++)n[f+"_"+p]=[o.foot.fc,o.foot.bc]}else if(a){for(let p=m;p<=d;p++)n[u+"_"+p]=[o.head.fc,o.head.bc];if(f>u)for(let p=u+1;p<=f;p++){let b,g;(p-u)%2!=0?(b=o.one.fc,g=o.one.bc):(b=o.two.fc,g=o.two.bc);for(let v=m;v<=d;v++)n[p+"_"+v]=[b,g]}}else if(s){if(f>u)for(let p=u;p<f;p++){let b,g;(p-u)%2==0?(b=o.one.fc,g=o.one.bc):(b=o.two.fc,g=o.two.bc);for(let v=m;v<=d;v++)n[p+"_"+v]=[b,g]}for(let p=m;p<=d;p++)n[f+"_"+p]=[o.foot.fc,o.foot.bc]}else for(let p=u;p<=f;p++){let b,g;(p-u)%2==0?(b=o.one.fc,g=o.one.bc):(b=o.two.fc,g=o.two.bc);for(let v=m;v<=d;v++)n[p+"_"+v]=[b,g]}}return n},ref:function(e,n){if(h.clearjfundo){h.jfundo.length=0;let l={};l.type="updateAF",l.sheetIndex=h.currentSheetIndex,l.data={historyRules:e,currentRules:n},h.jfredo.push(l)}let t=Me(h.currentSheetIndex);h.luckysheetfile[t].luckysheet_alternateformat_save=n,setTimeout(function(){Xt()},1)}},Ur=Hx});var import_plugin,jx,Ss,Qc=Nt(()=>{import_plugin=qe(Ye());Ol();jx={parseJsonParm:function(e){if(e==null)return{};if(G(e)=="string")try{return new Function("return "+e)()}catch(n){return{}}else return e},hasKey:function(e){let t=this.parseJsonParm(e);for(let l in t)return!0;return!1}},Ss=jx});function Is(e,n,t,l,o,a,s,u,f,m){if(n?(e.addClass("luckysheet-filter-options-active").data("rowhidden",JSON.stringify(t)).data("caljs",JSON.stringify(l)).html('<i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i>'),l!=null&&(e.data("byconditionvalue",l.value).data("byconditiontype",l.type).data("byconditiontext",l.text),l.value1!=null&&e.data("byconditionvalue1",l.value1),l.value2!=null&&e.data("byconditionvalue2",l.value2))):(e.removeClass("luckysheet-filter-options-active").data("rowhidden","").data("caljs","").html('<i class="fa fa-caret-down luckysheet-mousedown-cancel" aria-hidden="true"></i>'),e.data("byconditionvalue","null").data("byconditiontype","0").data("byconditiontext","\u65E0").data("byconditionvalue1","").data("byconditionvalue2","")),o){let d=h.luckysheetfile[Me(h.currentSheetIndex)];if(d.filter==null&&(d.filter={}),n){let p={caljs:l,rowhidden:t,optionstate:n,str:a,edr:s,cindex:u,stc:f,edc:m};d.filter[u-f]=p}else delete d.filter[u-f];Ue.saveParam("all",h.currentSheetIndex,d.filter,{k:"filter"})}}function Py(e,n,t,l,o,a){let s=It.deepCopyFlowData(h.flowdata);e=e+1;let u=!1,f=[];for(let d=e;d<=t;d++){let p=[];for(let b=n;b<=l;b++){if(s[d][b]!=null&&s[d][b].mc!=null){u=!0;break}p.push(s[d][b])}f.push(p)}if(u){let d=Be().filter;at()?alert(d.mergeError):ke.info(d.mergeError,"");return}f=Ko(f,o-n,a);for(let d=e;d<=t;d++)for(let p=n;p<=l;p++)s[d][p]=f[d-e][p-n];let m={};if(h.config.rowlen!=null){let d=$.extend(!0,{},h.config);d=Cn(s,e,t,d),m={cfg:d,RowlChange:!0}}al(s,[{row:[e,t],column:[n,l]}],m)}function rf(){if(!nr(h.currentSheetIndex,"filter"))return;if(h.luckysheet_select_save.length>1){$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#"+h.container).attr("tabindex",0).focus();let n=Be().splitText;at()?alert(n.tipNoMulti):ke.info(n.tipNoMulti,"");return}if(h.luckysheetfile[Me(h.currentSheetIndex)].isPivotTable)return;$("#luckysheet-filter-selected-sheet"+h.currentSheetIndex+", #luckysheet-filter-options-sheet"+h.currentSheetIndex).remove();let e=h.luckysheet_select_save[0];if(e.row[0]==e.row[1]&&e.column[0]==e.column[1]){let n,t,l=e.row[1];for(let o=0;o<h.flowdata[l].length;o++){let a=h.flowdata[l][o];if(a!=null&&!ft(a.v))n==null&&(n=o);else if(n!=null){t=o-1;break}}t==null&&(t=h.flowdata[l].length-1),h.luckysheet_select_save=[{row:[l,l],column:[n,t]}],gl(),h.luckysheet_shiftpositon=$.extend(!0,{},e),Zc("down","range")}else e.row[1]-e.row[0]<2&&(h.luckysheet_shiftpositon=$.extend(!0,{},e),Zc("down","range"));h.luckysheet_filter_save=$.extend(!0,{},h.luckysheet_select_save[0]),fi(h.luckysheet_filter_save),Ue.saveParam("all",h.currentSheetIndex,h.luckysheet_filter_save,{k:"filter_select"}),h.filterchage&&h.jfredo.push({type:"filtershow",data:[],curdata:[],sheetIndex:h.currentSheetIndex,filter_save:h.luckysheet_filter_save})}function fi(e,n){if($("#luckysheet-filter-selected-sheet"+h.currentSheetIndex).remove(),$("#luckysheet-filter-options-sheet"+h.currentSheetIndex).remove(),e==null||JSON.stringify(e)=="{}")return;let t=e.row[0],l=e.row[1],o=e.column[0],a=e.column[1],s=h.visibledatarow[l],u=t-1==-1?0:h.visibledatarow[t-1],f=h.visibledatacolumn[a],m=o-1==-1?0:h.visibledatacolumn[o-1],d='<div id="luckysheet-filter-selected-sheet'+h.currentSheetIndex+'" class="luckysheet-cell-selected luckysheet-filter-selected"  style="left:'+m+"px;width:"+(f-m-1)+"px;top:"+u+"px;height:"+(s-u-1)+'px;display:block;border-color:#897BFF;z-index:20;background:none;"></div>';$("#luckysheet-cell-main").append(d);let p="";for(let g=o;g<=a;g++)if(n==null||n[g-o]==null)p+='<div data-rowhidden="" data-str="'+t+'" data-edr="'+l+'" data-cindex="'+g+'" data-stc="'+o+'" data-edc="'+a+'" class="luckysheet-filter-options" style="left:'+(h.visibledatacolumn[g]-20)+"px;top:"+u+'px;display:block;"><i class="fa fa-caret-down" aria-hidden="true"></i></div>';else{let v;if(n[g-o].caljs!=null){let x;n[g-o].caljs.value1!=null?x='data-byconditionvalue1="'+n[g-o].caljs.value1+'" ':x="";let _;n[g-o].caljs.value2!=null?_='data-byconditionvalue2="'+n[g-o].caljs.value2+'" ':_="",v='data-caljs="'+JSON.stringify(n[g-o].caljs)+'" data-byconditionvalue="'+n[g-o].caljs.value+'" data-byconditiontype="'+n[g-o].caljs.type+'" data-byconditiontext="'+n[g-o].caljs.text+'" '+x+_}else v="";p+='<div data-rowhidden="'+JSON.stringify(n[g-o].rowhidden).replace(/\"/g,"'")+'" '+v+' data-str="'+t+'" data-edr="'+l+'" data-cindex="'+g+'" data-stc="'+o+'" data-edc="'+a+'" class="luckysheet-filter-options luckysheet-filter-options-active" style="left:'+(h.visibledatacolumn[g]-20)+"px;top:"+u+'px;display:block;"><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i></div>'}$("#luckysheet-cell-main").append('<div id="luckysheet-filter-options-sheet'+h.currentSheetIndex+'" class="luckysheet-filter-options-c">'+p+"</div>"),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#luckysheet-cell-main").scrollTop()>e.top_move&&$("#luckysheet-scrollbar-y").scrollTop(e.top_move);let b=h.luckysheetfile[Me(h.currentSheetIndex)];b.filter_select=e}function Ey(){let e=null,n=Be(),t=n.filter,l=n.button;$("#luckysheetfilter").click(rf);let o=null,a=null;$(".luckysheet-cols-menu .luckysheet-cols-submenu").hover(function(){let s=$(this),u=s.attr("id"),f=$("#"+u+"_sub"),m=s.parent(),d=$(window).width(),p=$(window).height(),b=m.width(),g=f.height()+25,v=f.width()+5,x=s.offset(),_=x.top,S=x.left+b;S+v>d&&(S=x.left-v),_+g>p&&(_=p-g),f.css({top:_,left:S}).show(),a=s},function(){let s=$(this),u=s.attr("id"),f=$("#"+u+"_sub");o=setTimeout(function(){f.hide()},200)}),$(".luckysheet-rightgclick-menu-sub").hover(function(){a.addClass("luckysheet-cols-menuitem-hover"),clearTimeout(o)},function(){a.removeClass("luckysheet-cols-menuitem-hover"),$(this).hide()}),$("#luckysheet-filter-menu").mouseover(function(){clearTimeout(e),e=setTimeout(function(){$("#luckysheet-filter-submenu").hide()},500)}),$("#luckysheet-filter-submenu").mouseover(function(){clearTimeout(e)}).find(".luckysheet-cols-menuitem").click(function(s){$("#luckysheet-filter-selected span").html($(this).find(".luckysheet-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide();let u=$(this).data("type"),f=$(this).attr("data-value");u=="2"?($("#luckysheet-filter-selected span").data("type","2"),$("#luckysheet-filter-menu .luckysheet-filter-selected-input2").show(),$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","number")):u=="0"?$("#luckysheet-filter-selected span").data("type","0"):($("#luckysheet-filter-selected span").data("type","1"),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).show(),f=="dateequal"||f=="datelessthan"||f=="datemorethan"?$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","date"):f=="morethan"||f=="moreequalthan"||f=="lessthan"||f=="lessequalthan"||f=="equal"||f=="noequal"?$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","number"):$("#luckysheet-filter-menu .luckysheet-filter-selected-input input").prop("type","text")),$("#luckysheet-filter-byvalue").next().slideUp(),$("#luckysheet-filter-submenu").hide()}),$("#luckysheet-filter-bycondition, #luckysheet-filter-byvalue").click(function(){let s=$(this);s.next().slideToggle(200),setTimeout(function(){s.attr("id")=="luckysheet-filter-bycondition"&&$("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-selected span").text()!=t.filiterInputNone&&$("#luckysheet-filter-byvalue").next().slideUp(200),s.is($("#luckysheet-filter-bycondition"))&&$("#luckysheet-filter-bycondition").next().is(":hidden")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-byvalue").next().slideDown(200)},300)}),$("#luckysheet-filter-selected").click(function(){let s=$(this),u=s.offset(),f=$("#luckysheet-filter-submenu");f.hide();let m=$(window).height(),d=$(window).width(),p=f.width(),b=f.height(),g=u.top,v=u.left,x=m-u.top-20;u.left+p>d&&(v=u.left-p),u.top>m/2&&(g=m-u.top,g<0&&(g=0),x=u.top-20),f.css({top:g,left:v,height:x}).show(),clearTimeout(e)}),$("#luckysheet-cell-main").on("click",".luckysheet-filter-options",function(s){if(!nr(h.currentSheetIndex,"filter"))return;let u=$(s.currentTarget),f=u.offset(),m=$("#luckysheet-filter-menu"),d=$(window).height(),p=$(window).width(),b=u.data("str"),g=u.data("edr"),v=u.data("cindex"),x=u.data("stc"),_=u.data("edc"),S=u.data("rowhidden")==""?{}:JSON.parse(u.data("rowhidden").replace(/\'/g,'"'));$("body .luckysheet-cols-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),$("#luckysheet-filter-byvalue-input").val(""),$("#luckysheet-filter-bycondition").next().hide(),$("#luckysheet-filter-byvalue").next().show(),m.data("str",b),m.data("edr",g),m.data("cindex",v),m.data("stc",x),m.data("edc",_),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text(t.filiterInputNone);let I=u.data("byconditiontype");if($("#luckysheet-filter-selected span").data("value",u.data("byconditionvalue")).data("type",I).text(u.data("byconditiontext")),I=="2"){let k=$("#luckysheet-filter-menu .luckysheet-filter-selected-input2").show().find("input");k.eq(0).val(u.data("byconditionvalue1")),k.eq(1).val(u.data("byconditionvalue2"))}else I=="1"&&$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).show().find("input").val(u.data("byconditionvalue1"));$("#luckysheet-filter-orderby-asc").off("click").on("click",function(){Py(b,x,g,_,v,!0)}),$("#luckysheet-filter-orderby-desc").off("click").on("click",function(){Py(b,x,g,_,v,!1)});let P=Wo("#luckysheet-filter-byvalue-select",{text:t.filiterMoreDataTip});$("#luckysheet-filter-byvalue-select").empty().append(P.el);let F={};$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").not(this).each(function(){let k=$(this),w=k.data("rowhidden");if(w=="")return!0;w=JSON.parse(w.replace(/\'/g,'"'));for(let C in w)F[C]=0});let D=h.flowdata;return setTimeout(function(){let k={},w={},C={},T={};for(let A=b+1;A<=g;A++){if(A in F||h.flowdata[A]==null)continue;let E=h.flowdata[A][v];if(E!=null&&!ft(E.v)&&E.ct!=null&&E.ct.t=="d"){let L=Bl("YYYY-MM-DD",E.v),N=L.split("-")[0],W=L.split("-")[1],X=L.split("-")[2];N in k||(k[N]={}),W in k[N]||(k[N][W]={}),X in k[N][W]||(k[N][W][X]=0),k[N][W][X]++,A in S&&(w[N]=0,w[W]=0,w[X]=0)}else{let L,N;E==null||ft(E.v)?(L=null,N=null):(L=E.v,N=E.m),L in C||(C[L]={}),N in C[L]||(C[L][N]=0),C[L][N]++,A in S&&(T[L+"#$$$#"+N]=0)}}let O=[];if(JSON.stringify(k).length>2)for(let A in k){let E=0,L="";for(let W in k[A]){let X=0,te="";for(let pe in k[A][W]){let ne=k[A][W][pe];X+=ne;let me;Number(W)<10?me="0"+Number(W):me=W;let Q;Number(pe)<10?Q="0"+Number(pe):Q=pe,A in w&&W in w&&pe in w?te+='<div class="day luckysheet-mousedown-cancel cf" data-check="false" title="'+A+"-"+me+"-"+Q+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+pe+'</label><span class="count luckysheet-mousedown-cancel">( '+ne+" )</span></div>":te+='<div class="day luckysheet-mousedown-cancel cf" data-check="true" title="'+A+"-"+me+"-"+Q+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+pe+'</label><span class="count luckysheet-mousedown-cancel">( '+ne+" )</span></div>"}E+=X;let ue;Number(W)<10?ue="0"+Number(W):ue=W,A in w&&W in w?L+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="false" title="'+A+"-"+ue+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+W+""+t.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+X+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+te+"</div></div>":L+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="true" title="'+A+"-"+ue+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+W+""+t.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+X+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+te+"</div></div>"}let N;A in w?N='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="false" title="'+A+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+A+""+t.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+E+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+L+"</div></div>":N='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="true" title="'+A+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+A+""+t.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+E+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+L+"</div></div>",O.unshift(N)}if(JSON.stringify(C).length>2){let A=Object.keys(C);A=wh(A,!0);for(let E=0;E<A.length;E++){let L=A[E];for(let N in C[L]){let W;L+"#$$$#"+N=="null#$$$#null"?W=t.valueBlank:W=N;let X;L+"#$$$#"+N in T?X='<div class="textBox luckysheet-mousedown-cancel cf" data-check="false" data-filter="'+(L+"#$$$#"+N)+'" title="'+W+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+W+'</label><span class="luckysheet-mousedown-cancel count">( '+C[L][N]+" )</span></div>":X='<div class="textBox luckysheet-mousedown-cancel cf" data-check="true" data-filter="'+(L+"#$$$#"+N)+'" title="'+W+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+W+'</label><span class="luckysheet-mousedown-cancel count">( '+C[L][N]+" )</span></div>",O.push(X)}}}let z=d-f.top-350;z<0&&(z=100),$("#luckysheet-filter-byvalue-select").append("<div class='ListBox luckysheet-mousedown-cancel' style='min-height: 100px; max-height: "+z+"px; overflow-y: auto; overflow-x: hidden;'><table cellspacing='0' style='width:100%;' class='luckysheet-mousedown-cancel'>"+O.join("")+"</table></div>"),P.close()},1),Ca(m,f.left,f.top+20),s.stopPropagation(),!1}),$("#luckysheet-filter-orderby-color").hover(function(){let s=$("#luckysheet-filter-menu"),u=s.data("str"),f=s.data("edr"),m=s.data("cindex"),d=s.data("stc"),p=s.data("edc"),b={},g={},v=Ur.getComputeMap(),x=Mt.getComputeMap();for(let E=u+1;E<=f;E++){let L=h.flowdata[E][m],N=_t.checkstatus(h.flowdata,E,m,"bg");N==null&&(N="#ffffff");let W=Ur.checksAF(E,m,v);W!=null&&(N=W[1]);let X=Mt.checksCF(E,m,x);X!=null&&X.cellColor!=null&&(N=X.cellColor),N.indexOf("rgb")>-1&&(N=_s(N)),N.length==4&&(N=N.substr(0,1)+N.substr(1,1).repeat(2)+N.substr(2,1).repeat(2)+N.substr(3,1).repeat(2));let te=_t.checkstatus(h.flowdata,E,m,"fc");W!=null&&(te=W[0]),X!=null&&X.textColor!=null&&(te=X.textColor),te.indexOf("rgb")>-1&&(te=_s(te)),te.length==4&&(te=te.substr(0,1)+te.substr(1,1).repeat(2)+te.substr(2,1).repeat(2)+te.substr(3,1).repeat(2)),h.config!=null&&h.config.rowhidden!=null&&E in h.config.rowhidden?(b[N]=1,L!=null&&!ft(L.v)&&(g[te]=1)):(b[N]=0,L!=null&&!ft(L.v)&&(g[te]=0))}let _="";if(JSON.stringify(b).length>2&&Object.keys(b).length>1){let E="";for(let L in b)b[L]==0?E+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+L+'" title="'+L+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/></div>':E+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+L+'" title="'+L+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox"/></div>';_='<div id="filterBgColor" class="box luckysheet-mousedown-cancel"><div class="title luckysheet-mousedown-cancel">'+t.filiterByColorTip+'</div><div style="max-height:128px;overflow:auto;" class="luckysheet-mousedown-cancel">'+E+"</div></div>"}let S="";if(JSON.stringify(g).length>2&&Object.keys(g).length>1){let E="";for(let L in g)g[L]==0?E+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+L+'" title="'+L+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/></div>':E+='<div class="item luckysheet-mousedown-cancel"><label class="luckysheet-mousedown-cancel" style="background-color: '+L+'" title="'+L+'"></label><input class="luckysheet-mousedown-cancel" type="checkbox"/></div>';S='<div id="filterFcColor" class="box luckysheet-mousedown-cancel"><div class="title luckysheet-mousedown-cancel">'+t.filiterByTextColorTip+'</div><div style="max-height:128px;overflow:auto;" class="luckysheet-mousedown-cancel">'+E+"</div></div>"}let I;_==""&&S==""?I='<div class="luckysheet-mousedown-cancel" style="padding: 10px 30px;text-align: center;">'+t.filterContainerOneColorTip+"</div>":I=_+S+'<div class="luckysheet-mousedown-cancel"><button id="luckysheet-filter-orderby-color-confirm" class="btn btn-primary luckysheet-mousedown-cancel" style="margin: 5px 20px;width: 70px;">'+l.confirm+"</button></div>",$("#luckysheet-filter-orderby-color-submenu").remove(),$("body").first().append('<div id="luckysheet-filter-orderby-color-submenu" class="luckysheet-cols-menu luckysheet-mousedown-cancel">'+I+"</div>");let P=$("#luckysheet-filter-orderby-color-submenu").end(),F=$(this).parent(),D=$(window).width(),k=$(window).height(),w=F.width(),C=P.height()+25,T=P.width()+5,O=$(this).offset(),z=O.top,A=O.left+w;A+T>D&&(A=O.left-T),z+C>k&&(z=k-C),$("#luckysheet-filter-orderby-color-submenu").css({top:z,left:A}).show()},function(){o=setTimeout(function(){$("#luckysheet-filter-orderby-color-submenu").hide()},200)}),$(document).on("mouseover mouseleave","#luckysheet-filter-orderby-color-submenu",function(s){s.type==="mouseover"?clearTimeout(o):$(this).hide()}),$(document).on("click","#luckysheet-filter-orderby-color-submenu .item label",function(){$(this).siblings("input[type='checkbox']").click()}),$(document).off("click.orderbyColorConfirm").on("click.orderbyColorConfirm","#luckysheet-filter-orderby-color-submenu #luckysheet-filter-orderby-color-confirm",function(){let s={},u={};$("#luckysheet-filter-orderby-color-submenu .item").each(function(z,A){if($(A).find("input[type='checkbox']").is(":checked")){let E=$(this).find("label").attr("title"),L=$(this).closest(".box").attr("id");L=="filterBgColor"?s[E]=0:L=="filterFcColor"&&(u[E]=0)}});let f;$("#luckysheet-filter-orderby-color-submenu #filterBgColor").length>0?f=!0:f=!1;let m;$("#luckysheet-filter-orderby-color-submenu #filterFcColor").length>0?m=!0:m=!1;let d=$("#luckysheet-filter-menu"),p=d.data("str"),b=d.data("edr"),g=d.data("cindex"),v=d.data("stc"),x=d.data("edc"),_={};$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").not($("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(g-v).get(0)).each(function(){let z=$(this),A=z.data("rowhidden");if(A=="")return!0;A=JSON.parse(A);for(let E in A)_[E]=0});let S={},I={},P={},F=Ur.getComputeMap(),D=Mt.getComputeMap();for(let z=p+1;z<=b;z++){if(z in _||h.flowdata[z]==null)continue;let A=h.flowdata[z][g],E=_t.checkstatus(h.flowdata,z,g,"bg"),L=Ur.checksAF(z,g,F);L!=null&&(E=L[1]);let N=Mt.checksCF(z,g,D);N!=null&&N.cellColor!=null&&(E=N.cellColor),E=E??"#ffffff",E.indexOf("rgb")>-1&&(E=_s(E)),E.length==4&&(E=E.substr(0,1)+E.substr(1,1).repeat(2)+E.substr(2,1).repeat(2)+E.substr(3,1).repeat(2));let W=_t.checkstatus(h.flowdata,z,g,"fc");L!=null&&(W=L[0]),N!=null&&N.textColor!=null&&(W=N.textColor),W.indexOf("rgb")>-1&&(W=_s(W)),W.length==4&&(W=W.substr(0,1)+W.substr(1,1).repeat(2)+W.substr(2,1).repeat(2)+W.substr(3,1).repeat(2)),f&&m?!(E in s)&&(!(W in u)||A==null||ft(A.v))&&(I[z]=0):f?E in s||(I[z]=0):m&&(!(W in u)||A==null||ft(A.v))&&(I[z]=0)}let k=$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(g-v),w=Object.keys(I).length>0,C=$.extend(!0,_,I),T=Ss.parseJsonParm(k.data("rowhidden"));Is(k,w,I,P,!0,p,b,g,v,x);let O=$.extend(!0,{},h.config);if(O.rowhidden=C,h.clearjfundo){let z={};z.type="datachangeAll_filter",z.sheetIndex=h.currentSheetIndex,z.config=$.extend(!0,{},h.config),z.curconfig=O,z.optionstate=w,z.optionsindex=g-v,z.rowhidden=$.extend(!0,{},I),z.rowhidenPre=$.extend(!0,{},T),P!=null&&(z.caljs=P),h.jfundo.length=0,h.jfredo.push(z)}h.config=O,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,O.rowhidden,{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu, #luckysheet-filter-orderby-color-submenu").hide(),Jr()}),$(document).off("click.filterCheckbox1").on("click.filterCheckbox1","#luckysheet-filter-byvalue-select .textBox",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox2").on("click.filterCheckbox2","#luckysheet-filter-byvalue-select .year",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox3").on("click.filterCheckbox3","#luckysheet-filter-byvalue-select .month",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));let s=!0;$(this).parents(".yearBox").find(".day").each(function(f,m){$(m).attr("data-check")=="true"||(s=!1)}),s?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterCheckbox4").on("click.filterCheckbox4","#luckysheet-filter-byvalue-select .day",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));let s=!0;$(this).parents(".monthBox").find(".day").each(function(d,p){$(p).attr("data-check")=="true"||(s=!1)}),s?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));let f=!0;$(this).parents(".yearBox").find(".day").each(function(d,p){$(p).attr("data-check")=="true"||(f=!1)}),f?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterYearDropdown").on("click.filterYearDropdown","#luckysheet-filter-byvalue-select .yearBox .fa-caret-right",function(s){let u=$(this).parents(".luckysheet-mousedown-cancel");u.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),u.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle(),s.stopPropagation()}),$("#luckysheet-filter-byvalue-btn-all").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","true")}),$("#luckysheet-filter-byvalue-btn-clear").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","false")}),$("#luckysheet-filter-byvalue-btn-contra").click(function(){$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(m,d){$(d).is(":checked")?($(d).removeAttr("checked"),$(d).parents(".luckysheet-mousedown-cancel").attr("data-check","false")):($(d).prop("checked",!0),$(d).parents(".luckysheet-mousedown-cancel").attr("data-check","true"))}),$("#luckysheet-filter-byvalue-select .ListBox .monthBox").each(function(m,d){let p=!0;$(d).find(".day input[type='checkbox']").each(function(g,v){$(v).is(":checked")||(p=!1)}),p?($(d).find(".month input[type='checkbox']").prop("checked",!0),$(d).attr("data-check","true")):($(d).find(".month input[type='checkbox']").removeAttr("checked"),$(d).attr("data-check","false"))}),$("#luckysheet-filter-byvalue-select .ListBox .yearBox").each(function(m,d){let p=!0;$(d).find(".day input[type='checkbox']").each(function(g,v){$(v).is(":checked")||(p=!1)}),p?($(d).find(".year input[type='checkbox']").prop("checked",!0),$(d).attr("data-check","true")):($(d).find(".year input[type='checkbox']").removeAttr("checked"),$(d).attr("data-check","false"))})}),$("#luckysheet-filter-initial").click(function(){if(!nr(h.currentSheetIndex,"filter"))return;$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text(t.conditionNone);let s={};s.type="datachangeAll_filter_clear",s.sheetIndex=h.currentSheetIndex,s.config=$.extend(!0,{},h.config),h.config.rowhidden={},s.curconfig=$.extend(!0,{},h.config),s.filter_save=$.extend(!0,{},h.luckysheet_filter_save);let u=[];$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(){let f=$(this),m=f.hasClass("luckysheet-filter-options-active"),d=Ss.parseJsonParm(f.data("rowhidden")),p=Ss.parseJsonParm(f.data("caljs"));u.push({optionstate:m,rowhidden:d,caljs:p,str:f.data("str"),edr:f.data("edr"),cindex:f.data("cindex"),stc:f.data("stc"),edc:f.data("edc")})}),s.optiongroups=u,h.jfundo.length=0,h.jfredo.push(s),$("#luckysheet-filter-selected-sheet"+h.currentSheetIndex+", #luckysheet-filter-options-sheet"+h.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),h.luckysheetfile[Me(h.currentSheetIndex)].filter=null,h.luckysheetfile[Me(h.currentSheetIndex)].filter_select=null,Ue.saveParam("fsc",h.currentSheetIndex,null),h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,{},{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length)}),$("#luckysheet-filter-byvalue-input").on("input propertychange",function(){let s=$(this).val().toString();$("#luckysheet-filter-byvalue-select .ListBox .luckysheet-mousedown-cancel").show(),s!=""&&$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(u,f){if($(f).closest(".day").length>0){let m=$(f).siblings("label").text().toString(),d=$(f).closest(".monthBox").find(".month label").text().toString();($(f).closest(".yearBox").find(".year label").text().toString()+"-"+d+"-"+m).indexOf(s)==-1&&($(f).closest(".day").hide(),$(f).closest(".dayList").find(".day:visible").length==0&&$(f).closest(".monthBox").find(".month").hide(),$(f).closest(".monthList").find(".day:visible").length==0&&$(f).closest(".yearBox").find(".year").hide())}$(f).closest(".textBox").length>0&&$(f).siblings("label").text().toString().indexOf(s)==-1&&$(f).parents(".textBox").hide()})}),$("#luckysheet-filter-cancel").click(function(){$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}),$("#luckysheet-filter-confirm").click(function(){let s=$("#luckysheet-filter-menu"),u=s.data("str"),f=s.data("edr"),m=s.data("cindex"),d=s.data("stc"),p=s.data("edc"),b={};$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").not($("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(m-d).get(0)).each(function(){let D=$(this),k=D.data("rowhidden");if(k=="")return!0;k=JSON.parse(k.replace(/\'/g,'"'));for(let w in k)b[w]=0});let g={},v={},x={};if($("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-selected span").data("value")!="null"){let D=$("#luckysheet-filter-selected span"),k=D.data("type"),w=D.data("value");if(x.value=w,x.text=D.text(),k=="0")x.type="0";else if(k=="2"){let C=$("#luckysheet-filter-menu .luckysheet-filter-selected-input2 input");x.type="2",x.value1=C.eq(0).val(),x.value2=C.eq(1).val()}else x.type="1",x.value1=$("#luckysheet-filter-menu .luckysheet-filter-selected-input").eq(0).find("input").val();for(let C=u+1;C<=f;C++){if(C in b||h.flowdata[C]==null)continue;let T=h.flowdata[C][m];if(w=="cellnull")T!=null&&!ft(T.v)&&(v[C]=0);else if(w=="cellnonull")(T==null||ft(T.v))&&(v[C]=0);else if(w=="textinclude"){let O=x.value1;(T==null||ft(T.v)||T.m.indexOf(O)==-1)&&(v[C]=0)}else if(w=="textnotinclude"){let O=x.value1;T==null||ft(T.v)||T.m.indexOf(O)>-1&&(v[C]=0)}else if(w=="textstart"){let O=x.value1,z=O.length;(T==null||ft(T.v)||T.m.substr(0,z)!=O)&&(v[C]=0)}else if(w=="textend"){let O=x.value1,z=O.length;(T==null||ft(T.v)||z>T.m.length||T.m.substr(T.m.length-z,z)!=O)&&(v[C]=0)}else if(w=="textequal"){let O=x.value1;(T==null||ft(T.v)||T.m!=O)&&(v[C]=0)}else if(w=="dateequal"){let O=_l(x.value1)[2];T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="d"?parseInt(T.v)!=O&&(v[C]=0):v[C]=0}else if(w=="datelessthan"){let O=_l(x.value1)[2];T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="d"?parseInt(T.v)>=O&&(v[C]=0):v[C]=0}else if(w=="datemorethan"){let O=_l(x.value1)[2];T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="d"?parseInt(T.v)<=O&&(v[C]=0):v[C]=0}else if(w=="morethan"){let O=parseFloat(x.value1);T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="n"?T.v<=O&&(v[C]=0):v[C]=0}else if(w=="moreequalthan"){let O=parseFloat(x.value1);T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="n"?T.v<O&&(v[C]=0):v[C]=0}else if(w=="lessthan"){let O=parseFloat(x.value1);T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="n"?T.v>=O&&(v[C]=0):v[C]=0}else if(w=="lessequalthan"){let O=parseFloat(x.value1);T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="n"?T.v>O&&(v[C]=0):v[C]=0}else if(w=="equal"){let O=parseFloat(x.value1);T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="n"?T.v!=O&&(v[C]=0):v[C]=0}else if(w=="noequal"){let O=parseFloat(x.value1);T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="n"?T.v==O&&(v[C]=0):v[C]=0}else if(w=="include"){let O=parseFloat(x.value1),z=parseFloat(x.value2),A,E;O<z?(A=O,E=z):(E=O,A=z),T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="n"?(T.v<A||T.v>E)&&(v[C]=0):v[C]=0}else if(w=="noinclude"){let O=parseFloat(x.value1),z=parseFloat(x.value2),A,E;O<z?(A=O,E=z):(E=O,A=z),T==null||ft(T.v)?v[C]=0:T.ct!=null&&T.ct.t=="n"?T.v>=A&&T.v<=E&&(v[C]=0):v[C]=0}}}else{$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']").each(function(D,k){if($(k).is(":visible")&&$(k).is(":checked"))return!0;if($(k).closest(".day").length>0){let w=$(k).siblings("label").text();Number(w)<10&&(w="0"+Number(w));let C=$(k).closest(".monthBox").find(".month label").text().replace(t.filiterMonthText,"");Number(C)<10&&(C="0"+Number(C));let T=$(k).closest(".yearBox").find(".year label").text().replace(t.filiterYearText,""),O=t.filterDateFormatTip+"#$$$#"+T+"-"+C+"-"+w;g[O]="1"}if($(k).closest(".textBox").length>0){let w=$(k).closest(".textBox").data("filter");g[w]="1"}});for(let D=u+1;D<=f;D++){if(D in b||h.flowdata[D]==null)continue;let k=h.flowdata[D][m],w;if(k==null||ft(k.v))w="null#$$$#null";else if(k.ct!=null&&k.ct.t=="d"){let C=Bl("YYYY-MM-DD",k.v);w=t.filterDateFormatTip+"#$$$#"+C}else w=k.v+"#$$$#"+k.m;w in g&&(v[D]=0)}}let _=$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(m-d),S=$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#luckysheet-filter-byvalue-select .ListBox input[type='checkbox']:visible").length||$("#luckysheet-filter-byvalue-input").val().length>0||$("#luckysheet-filter-bycondition").next().is(":visible")&&$("#luckysheet-filter-byvalue").next().is(":hidden")&&$("#luckysheet-filter-selected span").data("value")!="null",I=$.extend(!0,b,v),P=Ss.parseJsonParm(_.data("rowhidden"));Is(_,S,v,x,!0,u,f,m,d,p);let F=$.extend(!0,{},h.config);if(F.rowhidden=I,h.clearjfundo){let D={};D.type="datachangeAll_filter",D.sheetIndex=h.currentSheetIndex,D.config=$.extend(!0,{},h.config),D.curconfig=F,D.optionstate=S,D.optionsindex=m-d,D.rowhidden=$.extend(!0,{},v),D.rowhidenPre=$.extend(!0,{},P),x!=null&&(D.caljs=x),h.jfundo.length=0,h.jfredo.push(D)}h.config=F,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,F.rowhidden,{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),Jr()})}var import_plugin,Ja=Nt(()=>{import_plugin=qe(Ye());fr();Wr();cr();Kr();fo();jr();Kc();Rr();qr();Xl();il();ln();mo();Jc();hi();Ol();Jo();Ar();oc();Qc();ui()});var import_plugin,Om,Pt,Qo=Nt(()=>{import_plugin=qe(Ye());Ri();qr();ho();Rr();hi();fr();gs();Ol();il();Xl();Kr();wi();Om={imgItem:{type:"3",src:"",originWidth:null,originHeight:null,default:{width:null,height:null,left:null,top:null},crop:{width:null,height:null,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:null,fixedTop:null,border:{width:0,radius:0,style:"solid",color:"#000"}},images:null,currentImgId:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,cropChange:null,cropChangeXY:null,cropChangeObj:null,copyImgItemObj:null,insertImg:function(e){let n=h.toJsonOptions&&h.toJsonOptions.uploadImage;if(typeof n=="function")n(e).then(t=>{Om._insertImg(t)}).catch(t=>{ke.info('<i class="fa fa-exclamation-triangle"></i>',"\u56FE\u7247\u4E0A\u4F20\u5931\u8D25")});else{let t=new FileReader;t.readAsDataURL(e),t.onload=function(l){let o=l.target.result;Om._insertImg(o),$("#luckysheet-imgUpload").val("")}}},_insertImg:function(e){let n=this,t=h.luckysheet_select_save[h.luckysheet_select_save.length-1],l=t.row_focus||0,o=t.column_focus||0,a=o==0?0:h.visibledatacolumn[o-1],s=l==0?0:h.visibledatarow[l-1],u=new Image;u.onload=function(){let m=u.width,d=u.height,p={src:e,left:a,top:s,originWidth:m,originHeight:d};n.addImgItem(p)};let f=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle;u.src=typeof f=="function"?f(e):e},generateRandomId:function(e){e==null&&(e="img");let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="";for(let o=0;o<12;o++)t+=n[Math.round(Math.random()*(n.length-1))];let l=new Date().getTime();return e+"_"+t+"_"+l},modelHtml:function(e,n){let t=this,l=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,o=typeof l=="function"?l(n.src):n.src,a=t.getImgItemParam(n),s=a.width*h.zoomRatio,u=a.height*h.zoomRatio,f=a.left*h.zoomRatio,m=a.top*h.zoomRatio,d=a.position,p=n.border.width;return`<div id="${e}" class="luckysheet-modal-dialog luckysheet-modal-dialog-image" style="width:${s}px;height:${u}px;padding:0;position:${d};left:${f}px;top:${m}px;z-index:200;">
                    <div class="luckysheet-modal-dialog-content" style="width:100%;height:100%;overflow:hidden;position:relative;">
                        <img src="${o}" style="position:absolute;width:${n.default.width*h.zoomRatio}px;height:${n.default.height*h.zoomRatio}px;left:${-n.crop.offsetLeft*h.zoomRatio}px;top:${-n.crop.offsetTop*h.zoomRatio}px;" />
                    </div>
                    <div class="luckysheet-modal-dialog-border" style="border:${p}px ${n.border.style} ${n.border.color};border-radius:${n.border.radius*h.zoomRatio}px;position:absolute;left:${-p}px;right:${-p}px;top:${-p}px;bottom:${-p}px;"></div>
                </div>`},getSliderHtml:function(){let e=Be().imageText;return`<div id="luckysheet-modal-dialog-slider-imageCtrl" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-imageCtrl" style="display:block;">
                    <div class="luckysheet-modal-dialog-slider-title">
                        <span>${e.imageSetting}</span>
                        <span class="luckysheet-model-close-btn" title="${e.close}">
                            <i class="fa fa-times" aria-hidden="true"></i>
                        </span>
                    </div>
                    <div class="luckysheet-modal-dialog-slider-content">
                        <div class="slider-box">
                            <div class="slider-box-title">${e.conventional}</div>
                            <div class="slider-box-radios">
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType1" name="imgItemType" value="1">
                                    <label for="imgItemType1">${e.moveCell1}</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType2" name="imgItemType" value="2">
                                    <label for="imgItemType2">${e.moveCell2}</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" id="imgItemType3" name="imgItemType" value="3">
                                    <label for="imgItemType3">${e.moveCell3}</label>
                                </div>
                            </div>
                            <div class="slider-box-checkbox">
                                <input type="checkbox" id="imgItemIsFixedPos">
                                <label for="imgItemIsFixedPos">${e.fixedPos}</label>
                            </div>
                        </div>
                        <div class="slider-box">
                            <div class="slider-box-title">${e.border}</div>
                            <div class="slider-box-borderConfig">
                                <div class="border-item">
                                    <label>${e.width}</label>
                                    <input type="number" id="imgItemBorderWidth" min="0">
                                </div>
                                <div class="border-item">
                                    <label>${e.radius}</label>
                                    <input type="number" id="imgItemBorderRadius" min="0">
                                </div>
                                <div class="border-item">
                                    <label>${e.style}</label>
                                    <select id="imgItemBorderStyle">
                                        <option value="solid">${e.solid}</option>
                                        <option value="dashed">${e.dashed}</option>
                                        <option value="dotted">${e.dotted}</option>
                                        <option value="double">${e.double}</option>
                                    </select>
                                </div>
                                <div class="border-item">
                                    <label>${e.color}</label>
                                    <div id="imgItemBorderColor" class="imgItemBorderColor">
                                        <span></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`},sliderHtmlShow:function(){let e=this;$("#luckysheet-modal-dialog-slider-imageCtrl").remove();let n=e.getSliderHtml();$("body").first().append(n),mr();let t=e.images[e.currentImgId],l=t.type;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemType"+l).prop("checked",!0);let o=t.isFixedPos;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemIsFixedPos").prop("checked",o);let a=t.border;$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderWidth").val(a.width),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderRadius").val(a.radius),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderStyle").val(a.style),$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span").css("background-color",a.color).attr("title",a.color),e.init()},colorSelectDialog:function(e){let n=Be(),t=n.button,l=n.toolbar,o=n.imageCtrl;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-imageCtrl-colorSelect-dialog").remove(),$("body").first().append(Tt(Ll,{id:"luckysheet-imageCtrl-colorSelect-dialog",addclass:"luckysheet-imageCtrl-colorSelect-dialog",title:o.borderTile,content:`<div class="currenColor">
                            ${o.borderCur}:<span title="${e}" style="background-color:${e}"></span>
                        </div>
                        <div class="colorshowbox"></div>`,botton:`<button id="luckysheet-imageCtrl-colorSelect-dialog-confirm" class="btn btn-primary">${t.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${t.cancel}</button>`,style:"z-index:100003"}));let a=$("#luckysheet-imageCtrl-colorSelect-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),s=a.outerHeight(),u=a.outerWidth(),f=$(window).width(),m=$(window).height(),d=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-imageCtrl-colorSelect-dialog").css({left:(f+d-u)/2,top:(m+p-s)/3}).show(),$("#luckysheet-imageCtrl-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:t.cancel,chooseText:l.confirmColor,togglePaletteMoreText:l.customColor,togglePaletteLessText:l.collapse,togglePaletteOnly:!0,clearText:l.clearText,noColorSelectedText:l.noColorSelectedText,localStorageKey:"spectrum.textcolor"+Ue.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(b){b!=null?b=b.toHexString():b="#000",$("#luckysheet-imageCtrl-colorSelect-dialog .currenColor span").css("background-color",b).attr("title",b)}})},init:function(){let e=this;$("#luckysheet-modal-dialog-slider-imageCtrl .luckysheet-model-close-btn").click(function(){$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),mr()}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.radio").on("change.radio",".radio-item input[type=radio][name=imgItemType]",function(){e.configChange("type",this.value)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.checkbox").on("change.checkbox",".slider-box-checkbox input[type=checkbox]",function(){e.configChange("fixedPos",this.checked)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderWidth").on("change.borderWidth","#imgItemBorderWidth",function(){e.configChange("border-width",this.valueAsNumber)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderRadius").on("change.borderRadius","#imgItemBorderRadius",function(){e.configChange("border-radius",this.valueAsNumber)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("change.borderStyle").on("change.borderStyle","#imgItemBorderStyle",function(){e.configChange("border-style",this.value)}),$("#luckysheet-modal-dialog-slider-imageCtrl").off("click.color").on("click.color","#imgItemBorderColor",function(){let n=$(this).find("span").attr("title");e.colorSelectDialog(n)}),$(document).off("click.selectColorConfirm").on("click.selectColorConfirm","#luckysheet-imageCtrl-colorSelect-dialog-confirm",function(){let n=$(this).parents("#luckysheet-imageCtrl-colorSelect-dialog");$("#luckysheet-modal-dialog-mask").hide(),n.hide();let t=n.find(".currenColor span").attr("title");$("#luckysheet-modal-dialog-slider-imageCtrl #imgItemBorderColor span").css("background-color",t).attr("title",t),e.configChange("border-color",t)}),$("#luckysheet-image-showBoxs").off("mousedown.active").on("mousedown.active",".luckysheet-modal-dialog-image",function(n){if(!nr(h.currentSheetIndex,"editObjects",!1))return;$(this).hide();let t=$(this).attr("id");e.currentImgId!=null&&e.currentImgId!=t&&e.cancelActiveImgItem(),e.currentImgId=t;let l=e.images[t],o=e.getImgItemParam(l),a=o.width*h.zoomRatio,s=o.height*h.zoomRatio,u=o.left*h.zoomRatio,f=o.top*h.zoomRatio,m=o.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:a,height:s,left:u,top:f,position:m});let d=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,p=typeof d=="function"?d(l.src):l.src;$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+p+")","background-size":l.default.width*h.zoomRatio+"px "+l.default.height*h.zoomRatio+"px","background-position":-l.crop.offsetLeft*h.zoomRatio+"px "+-l.crop.offsetTop*h.zoomRatio+"px"}),$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css({"border-width":l.border.width*h.zoomRatio,"border-style":l.border.style,"border-color":l.border.color,"border-radius":l.border.radius*h.zoomRatio,left:-l.border.width*h.zoomRatio,right:-l.border.width*h.zoomRatio,top:-l.border.width*h.zoomRatio,bottom:-l.border.width*h.zoomRatio}),e.sliderHtmlShow(),n.stopPropagation()}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.move").on("mousedown.move",".luckysheet-modal-dialog-content",function(n){if(!nr(h.currentSheetIndex,"editObjects",!1))return;$("#luckysheet-modal-dialog-slider-imageCtrl").is(":visible")||e.sliderHtmlShow(),e.move=!0,e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight;let t=$("#luckysheet-modal-dialog-activeImage").offset();e.moveXY=[n.pageX-t.left,n.pageY-t.top],pa(!0),n.stopPropagation()}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.resize").on("mousedown.resize",".luckysheet-modal-dialog-resize-item",function(n){if(!nr(h.currentSheetIndex,"editObjects",!1))return;e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.resize=$(this).data("type");let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=wl(n.pageX,n.pageY),a=o[0]+l,s=o[1]+t,u=$("#luckysheet-modal-dialog-activeImage").position(),f=$("#luckysheet-modal-dialog-activeImage").width(),m=$("#luckysheet-modal-dialog-activeImage").height();e.resizeXY=[a,s,f,m,u.left+l,u.top+t,l,t],pa(!0),n.stopPropagation()}),$("#luckysheet-modal-dialog-activeImage").off("mousedown.croppingEnter").on("mousedown.croppingEnter",".luckysheet-modal-controll-crop",function(n){e.croppingEnter(),n.stopPropagation()}),$("#luckysheet-modal-dialog-cropping").off("mousedown.croppingExit").on("mousedown.croppingExit",".luckysheet-modal-controll-crop",function(n){e.croppingExit(),n.stopPropagation()}),$("#luckysheet-modal-dialog-cropping").off("mousedown.cropChange").on("mousedown.cropChange",".resize-item",function(n){e.cropChange=$(this).data("type");let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=wl(n.pageX,n.pageY),a=o[0]+l,s=o[1]+t;e.cropChangeXY=[a,s],pa(!0),n.stopPropagation()}),$("#luckysheet-image-showBoxs").off("mousedown.restore").on("mousedown.restore",".luckysheet-modal-controll-restore",function(n){e.restoreImgItem(),n.stopPropagation()}),$("#luckysheet-image-showBoxs").off("mousedown.delete").on("mousedown.delete",".luckysheet-modal-controll-del",function(n){e.removeImgItem(),n.stopPropagation()})},configChange:function(e,n){let t=this,l=t.images[t.currentImgId];switch(e){case"type":l.type=n;break;case"fixedPos":l.isFixedPos=n;let o=t.getImgItemParam(l),a=o.width,s=o.height,u=o.left,f=o.top,m=o.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:a,height:s,left:u,top:f,position:m});break;case"border-width":l.border.width=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css({"border-width":n,left:-n,right:-n,top:-n,bottom:-n});break;case"border-radius":l.border.radius=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-radius",n);break;case"border-style":l.border.style=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-style",n);break;case"border-color":l.border.color=n,$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-border").css("border-color",n);break}t.ref()},getImgItemParam(e){let n=e.isFixedPos,t=e.default.width,l=e.default.height,o=e.default.left,a=e.default.top;(e.crop.width!=t||e.crop.height!=l)&&(t=e.crop.width,l=e.crop.height,o+=e.crop.offsetLeft,a+=e.crop.offsetTop);let s="absolute";return n&&(s="fixed",o=e.fixedLeft+e.crop.offsetLeft,a=e.fixedTop+e.crop.offsetTop),{width:t,height:l,left:o,top:a,position:s}},cancelActiveImgItem:function(){let e=this;$("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide();let n=e.images[e.currentImgId],t=e.getImgItemParam(n),l=t.width*h.zoomRatio,o=t.height*h.zoomRatio,a=t.left*h.zoomRatio,s=t.top*h.zoomRatio,u=t.position;$("#"+e.currentImgId).show().css({width:l,height:o,left:a,top:s,position:u}),$("#"+e.currentImgId+" img").css({width:n.default.width*h.zoomRatio,height:n.default.height*h.zoomRatio,left:-n.crop.offsetLeft*h.zoomRatio,top:-n.crop.offsetTop*h.zoomRatio}),$("#"+e.currentImgId+" .luckysheet-modal-dialog-border").css({"border-width":n.border.width*h.zoomRatio,"border-style":n.border.style,"border-color":n.border.color,"border-radius":n.border.radius*h.zoomRatio,left:-n.border.width*h.zoomRatio,right:-n.border.width*h.zoomRatio,top:-n.border.width*h.zoomRatio,bottom:-n.border.width*h.zoomRatio}),e.currentImgId=null},addImgItem:function(e){let n=this,t,l,o=400;e.originHeight<e.originWidth?(l=Math.round(e.originHeight*(o/e.originWidth)),t=o):(t=Math.round(e.originWidth*(o/e.originHeight)),l=o),n.images==null&&(n.images={});let a=$.extend(!0,{},n.imgItem);a.src=e.src,a.originWidth=e.originWidth,a.originHeight=e.originHeight,a.default.width=t,a.default.height=l,a.default.left=e.left,a.default.top=e.top,a.crop.width=t,a.crop.height=l;let s=$("#luckysheet-cell-main").scrollTop(),u=$("#luckysheet-cell-main").scrollLeft();a.fixedLeft=e.left-u+h.rowHeaderWidth,a.fixedTop=e.top-s+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight;let f=n.generateRandomId(),m=n.modelHtml(f,a);$("#luckysheet-image-showBoxs .img-list").append(m),n.images[f]=a,n.ref(),n.init()},moveImgItem:function(){let e=this;e.move=!1;let n=$("#luckysheet-modal-dialog-activeImage")[0],t=e.images[e.currentImgId];t.isFixedPos?(t.fixedLeft=n.offsetLeft-t.crop.offsetLeft,t.fixedTop=n.offsetTop-t.crop.offsetTop):(t.default.left=n.offsetLeft-t.crop.offsetLeft,t.default.top=n.offsetTop-t.crop.offsetTop),e.ref()},resizeImgItem:function(){let e=this;e.resize=null;let n=$("#luckysheet-modal-dialog-activeImage")[0],t=e.images[e.currentImgId],l=n.clientWidth/t.crop.width,o=n.clientHeight/t.crop.height;t.default.width=Math.round(t.default.width*l),t.default.height=Math.round(t.default.height*o),t.crop.width=Math.round(t.crop.width*l),t.crop.height=Math.round(t.crop.height*o),t.crop.offsetLeft=Math.round(t.crop.offsetLeft*l),t.crop.offsetTop=Math.round(t.crop.offsetTop*o),t.isFixedPos?(t.fixedLeft=n.offsetLeft,t.fixedTop=n.offsetTop):(t.default.left=n.offsetLeft-t.crop.offsetLeft,t.default.top=n.offsetTop-t.crop.offsetTop),e.ref()},croppingEnter:function(){let e=this;if(e.cropping=!0,!nr(h.currentSheetIndex,"editObjects",!1))return;$("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide();let n=e.images[e.currentImgId],t=e.getImgItemParam(n),l=t.width,o=t.height,a=t.left,s=t.top,u=t.position;$("#luckysheet-modal-dialog-cropping").show().css({width:l,height:o,left:a,top:s,position:u});let f=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,m=typeof f=="function"?f(n.src):n.src;$("#luckysheet-modal-dialog-cropping .cropping-mask").css({width:n.default.width,height:n.default.height,"background-image":"url("+m+")",left:-n.crop.offsetLeft,top:-n.crop.offsetTop}),$("#luckysheet-modal-dialog-cropping .cropping-content").css({"background-image":"url("+m+")","background-size":n.default.width+"px "+n.default.height+"px","background-position":-n.crop.offsetLeft+"px "+-n.crop.offsetTop+"px"}),$("#luckysheet-modal-dialog-cropping .luckysheet-modal-dialog-border").css({"border-width":n.border.width,"border-style":n.border.style,"border-color":n.border.color,"border-radius":n.border.radius,left:-n.border.width,right:-n.border.width,top:-n.border.width,bottom:-n.border.width})},croppingExit:function(){let e=this;e.cropping=!1,$("#luckysheet-modal-dialog-cropping").hide();let n=e.images[e.currentImgId],t=e.getImgItemParam(n),l=t.width,o=t.height,a=t.left,s=t.top,u=t.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:l,height:o,left:a,top:s,position:u});let f=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,m=typeof f=="function"?f(n.src):n.src;$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+m+")","background-size":n.default.width+"px "+n.default.height+"px","background-position":-n.crop.offsetLeft+"px "+-n.crop.offsetTop+"px"})},cropChangeImgItem:function(){let e=this;e.cropChange=null;let n=e.images[e.currentImgId];n.crop.width=e.cropChangeObj.width,n.crop.height=e.cropChangeObj.height,n.crop.offsetLeft=e.cropChangeObj.offsetLeft,n.crop.offsetTop=e.cropChangeObj.offsetTop,e.ref()},restoreImgItem:function(){let e=this,n=e.images[e.currentImgId];n.default.width=n.originWidth,n.default.height=n.originHeight,n.crop.width=n.originWidth,n.crop.height=n.originHeight,n.crop.offsetLeft=0,n.crop.offsetTop=0;let t=e.getImgItemParam(n),l=t.width,o=t.height,a=t.left,s=t.top,u=t.position;$("#luckysheet-modal-dialog-activeImage").show().css({width:l,height:o,left:a,top:s,position:u});let f=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,m=typeof f=="function"?f(n.src):n.src;$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-image":"url("+m+")","background-size":n.default.width+"px "+n.default.height+"px","background-position":-n.crop.offsetLeft+"px "+-n.crop.offsetTop+"px"}),e.ref()},removeImgItem:function(){let e=this,n=e.images[e.currentImgId];!sl.createHookFunction("imageDeleteBefore",n)||($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),$("#"+e.currentImgId).remove(),delete e.images[e.currentImgId],e.currentImgId=null,sl.createHookFunction("imageDeleteAfter",n),e.ref())},copyImgItem:function(e){let n=this;n.copyImgItemObj=$.extend(!0,{},n.images[n.currentImgId]);let t=window.clipboardData;t||(t=e.originalEvent.clipboardData);let l='<table data-type="luckysheet_copy_action_image"><tr><td><td></tr></table>';if(t)return t.setData("Text",l),!1;{let o=$("#luckysheet-copy-content");o.html(l),o.focus(),o.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){$("#luckysheet-copy-content").blur()},10)}},pasteImgItem:function(){let e=this;e.images==null&&(e.images={});let n=h.luckysheet_select_save[0].row_focus||0,t=h.luckysheet_select_save[0].column_focus||0,l=t==0?0:h.visibledatacolumn[t-1],o=n==0?0:h.visibledatarow[n-1],a=$.extend(!0,{},e.copyImgItemObj);a.default.left=l-a.crop.offsetLeft,a.default.top=o-a.crop.offsetTop;let s=$("#luckysheet-cell-main").scrollTop(),u=$("#luckysheet-cell-main").scrollLeft();a.fixedLeft=a.default.left-u+h.rowHeaderWidth,a.fixedTop=a.default.top-s+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight;let f=e.generateRandomId(),m=e.modelHtml(f,a);$("#luckysheet-image-showBoxs .img-list").append(m),e.images[f]=a,e.ref(),e.init()},allImagesShow:function(){let e=this;if($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide(),$("#luckysheet-image-showBoxs .img-list").empty(),e.images!=null)for(let n in e.images){let t=e.images[n],l=e.modelHtml(n,t);$("#luckysheet-image-showBoxs .img-list").append(l)}},moveChangeSize:function(e,n,t){let l=this,o=$.extend(!0,{},l.images);if(e=="row"){let a=h.visibledatarow[n],s=n-1==-1?0:h.visibledatarow[n-1],u=t-(a-s-1);for(let f in o){let m=o[f],d=l.getImgItemParam(m),p=m.type;if(p=="1"){if(d.top>=a)m.default.top=d.top+u-m.crop.offsetTop;else if(d.top+d.height>=a-2)if(d.top<a+u){let b=(d.height+u)/d.height;m.default.height=Math.round(m.default.height*b),m.crop.height=Math.round(m.crop.height*b),m.crop.offsetTop=Math.round(m.crop.offsetTop*b)}else{let b=(d.top+d.height-a)/d.height;m.default.height=Math.round(m.default.height*b),m.crop.height=Math.round(m.crop.height*b),m.crop.offsetTop=Math.round(m.crop.offsetTop*b),m.default.top=a+u-m.crop.offsetTop}else if(d.top>a+u){let b=1/d.height;m.default.height=Math.round(m.default.height*b),m.crop.height=Math.round(m.crop.height*b),m.crop.offsetTop=Math.round(m.crop.offsetTop*b),m.default.top=a+u-m.crop.offsetTop}else if(d.top+d.height>a+u){let b=(a+u-d.top)/d.height;m.default.height=Math.round(m.default.height*b),m.crop.height=Math.round(m.crop.height*b),m.crop.offsetTop=Math.round(m.crop.offsetTop*b)}}else p=="2"&&(d.top>=a?m.default.top=d.top+u-m.crop.offsetTop:d.top>a+u&&(m.default.top=a+u-m.crop.offsetTop))}}else if(e=="column"){let a=h.visibledatacolumn[n],s=n-1==-1?0:h.visibledatacolumn[n-1],u=t-(a-s-1);for(let f in o){let m=o[f],d=l.getImgItemParam(m),p=m.type;if(p=="1"){if(d.left>=a)m.default.left=d.left+u-m.crop.offsetLeft;else if(d.left+d.width>=a-2)if(d.left<a+u){let b=(d.width+u)/d.width;m.default.width=Math.round(m.default.width*b),m.crop.width=Math.round(m.crop.width*b),m.crop.offsetLeft=Math.round(m.crop.offsetLeft*b)}else{let b=(d.left+d.width-a)/d.width;m.default.width=Math.round(m.default.width*b),m.crop.width=Math.round(m.crop.width*b),m.crop.offsetLeft=Math.round(m.crop.offsetLeft*b),m.default.left=a+u-m.crop.offsetLeft}else if(d.left>a+u){let b=1/d.width;m.default.width=Math.round(m.default.width*b),m.crop.width=Math.round(m.crop.width*b),m.crop.offsetLeft=Math.round(m.crop.offsetLeft*b),m.default.left=a+u-m.crop.offsetLeft}else if(d.left+d.width>a+u){let b=(a+u-d.left)/d.width;m.default.width=Math.round(m.default.width*b),m.crop.width=Math.round(m.crop.width*b),m.crop.offsetLeft=Math.round(m.crop.offsetLeft*b)}}else p=="2"&&(d.left>=a?m.default.left=d.left+u-m.crop.offsetLeft:d.left>a+u&&(m.default.left=a+u-m.crop.offsetLeft))}}return o},ref:function(){let e=this,n=h.luckysheetfile[Me(h.currentSheetIndex)],t=e.images;h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"imageCtrl",sheetIndex:h.currentSheetIndex,images:n.images==null?null:$.extend(!0,{},n.images),curImages:t})),n.images=$.extend(!0,{},t),Ue.saveParam("all",h.currentSheetIndex,n.images,{k:"images"})}},Pt=Om});function Vx(e){var n=/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/;if(n.test(e)){if(e.length==18){for(var t=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),l=new Array(1,0,10,9,8,7,6,5,4,3,2),o=0,a=0;a<17;a++)o+=e.substring(a,a+1)*t[a];var s=o%11,u=e.substring(17);return s==2?u=="X"||u=="x":u==l[s]}}else return!1}var import_plugin,Bx,ll,go=Nt(()=>{import_plugin=qe(Ye());Ol();Sr();cr();Xo();Ar();Kr();Do();Er();Wr();Rr();jr();qr();ln();kn();fr();Xl();il();Bx={defaultItem:{type:"dropdown",type2:null,value1:"",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},curItem:null,dataVerification:null,selectRange:[],selectStatus:!1,optionLabel:{number:"\u6570\u503C",number_integer:"\u6574\u6570",number_decimal:"\u5C0F\u6570",bw:"\u4ECB\u4E8E",nb:"\u4E0D\u4ECB\u4E8E",eq:"\u7B49\u4E8E",ne:"\u4E0D\u7B49\u4E8E",gt:"\u5927\u4E8E",lt:"\u5C0F\u4E8E",gte:"\u5927\u4E8E\u7B49\u4E8E",lte:"\u5C0F\u4E8E\u7B49\u4E8E",include:"\u5305\u62EC",exclude:"\u4E0D\u5305\u62EC",equal:"\u7B49\u4E8E",bf:"\u65E9\u4E8E",nbf:"\u4E0D\u65E9\u4E8E",af:"\u665A\u4E8E",naf:"\u4E0D\u665A\u4E8E",card:"\u8EAB\u4EFD\u8BC1\u53F7\u7801",phone:"\u624B\u673A\u53F7"},optionLabel_en:{number:"numeric",number_integer:"integer",number_decimal:"decimal",bw:"between",nb:"not between",eq:"equal to",ne:"not equal to",gt:"greater",lt:"less than",gte:"greater or equal to",lte:"less than or equal to",include:"include",exclude:"not include",equal:"equal to",bf:"earlier than",nbf:"not earlier than",af:"later than",naf:"not later than",card:"identification number",phone:"phone number"},createDialog:function(){let e=this,n=Be(),t=n.dataVerification,l=n.toolbar,o=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").remove();let a=`<div class="box">
                            <div class="box-item" style="border-top:1px solid #E1E4E8;">
                                <div class="box-item-title">${t.cellRange}</div>
                                <div id="data-verification-range" class="range">
                                    <input class="formulaInputFocus" spellcheck="false">
                                    <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>
                                </div>
                            </div>
                            <div class="box-item">
                                <div class="box-item-title">${t.verificationCondition}</div>
                                <select id="data-verification-type-select">
                                    <option value="dropdown">${t.dropdown}</option>
                                    <option value="checkbox">${t.checkbox}</option>
                                    <option value="number">${t.number}</option>
                                    <option value="number_integer">${t.number_integer}</option>
                                    <option value="number_decimal">${t.number_decimal}</option>
                                    <option value="text_content">${t.text_content}</option>
                                    <option value="text_length">${t.text_length}</option>
                                    <option value="date">${t.date}</option>
                                    <option value="validity">${t.validity}</option>
                                </select>
                                <div class="show-box">
                                    <div class="show-box-item show-box-item-dropdown">
                                        <div class="range">
                                            <input class="formulaInputFocus data-verification-value1" placeholder="${t.placeholder1}" spellcheck="false">
                                            <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>
                                        </div>
                                        <div class="multi">
                                            <input type="checkbox" id="data-verification-multi" class="data-verification-multi">
                                            <label for="data-verification-multi">${t.allowMultiSelect}</label>
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-checkbox">
                                        <div class="check-box">
                                            <span>${t.selected} \u2014\u2014</span>
                                            <input type="text" class="data-verification-value1" placeholder="${t.placeholder2}">
                                        </div>
                                        <div class="check-box">
                                            <span>${t.notSelected} \u2014\u2014</span>
                                            <input type="text" class="data-verification-value2" placeholder="${t.placeholder2}">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-number">
                                        <select id="data-verification-number-select">
                                            <option value="bw">${t.between}</option>
                                            <option value="nb">${t.notBetween}</option>
                                            <option value="eq">${t.equal}</option>
                                            <option value="ne">${t.notEqualTo}</option>
                                            <option value="gt">${t.moreThanThe}</option>
                                            <option value="lt">${t.lessThan}</option>
                                            <option value="gte">${t.greaterOrEqualTo}</option>
                                            <option value="lte">${t.lessThanOrEqualTo}</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="number" class="data-verification-value1" placeholder="1">
                                            <span>-</span>
                                            <input type="number" class="data-verification-value2" placeholder="100">
                                        </div>
                                        <div class="input input2">
                                            <input type="number" class="data-verification-value1" placeholder="${t.placeholder3}">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-text">
                                        <select id="data-verification-text-select">
                                            <option value="include">${t.include}</option>
                                            <option value="exclude">${t.exclude}</option>
                                            <option value="equal">${t.equal}</option>
                                        </select>
                                        <div class="input input2">
                                            <input type="text" class="data-verification-value1" placeholder="${t.placeholder4}"/>
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-textLength">
                                        <select id="data-verification-textLength-select">
                                            <option value="bw">${t.between}</option>
                                            <option value="nb">${t.notBetween}</option>
                                            <option value="eq">${t.equal}</option>
                                            <option value="ne">${t.notEqualTo}</option>
                                            <option value="gt">${t.moreThanThe}</option>
                                            <option value="lt">${t.lessThan}</option>
                                            <option value="gte">${t.greaterOrEqualTo}</option>
                                            <option value="lte">${t.lessThanOrEqualTo}</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="number" class="data-verification-value1" placeholder="1">
                                            <span>-</span>
                                            <input type="number" class="data-verification-value2" placeholder="100">
                                        </div>
                                        <div class="input input2">
                                            <input type="number" class="data-verification-value1" placeholder="${t.placeholder3}">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-date">
                                        <select id="data-verification-date-select">
                                            <option value="bw">${t.between}</option>
                                            <option value="nb">${t.notBetween}</option>
                                            <option value="eq">${t.equal}</option>
                                            <option value="ne">${t.notEqualTo}</option>
                                            <option value="bf">${t.earlierThan}</option>
                                            <option value="nbf">${t.noEarlierThan}</option>
                                            <option value="af">${t.laterThan}</option>
                                            <option value="naf">${t.noLaterThan}</option>
                                        </select>
                                        <div class="input input1">
                                            <input type="date" class="data-verification-value1" placeholder="2020/9/10">
                                            <span>-</span>
                                            <input type="date" class="data-verification-value2" placeholder="2020/9/10">
                                        </div>
                                        <div class="input input2">
                                            <input type="date" class="data-verification-value1" placeholder="2020/9/10">
                                        </div>
                                    </div>
                                    <div class="show-box-item show-box-item-validity">
                                        <select id="data-verification-validity-select">
                                            <option value="card">${t.identificationNumber}</option>
                                            <option value="phone">${t.phoneNumber}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="box-item">
                                <div class="check">
                                    <input type="checkbox" id="data-verification-remote" class="data-verification-remote">
                                    <label for="data-verification-remote">${t.remote}</label>
                                </div>
                                <div class="check">
                                    <input type="checkbox" id="data-verification-prohibitInput">
                                    <label for="data-verification-prohibitInput">${t.prohibitInput}</label>
                                </div>
                                <div class="check">
                                    <input type="checkbox" id="data-verification-hint-show">
                                    <label for="data-verification-hint-show">${t.hintShow}</label>
                                </div>
                                <div class="data-verification-hint-text">
                                    <input type="text" placeholder="${t.placeholder5}">
                                </div>
                            </div>
                        </div>`;$("body").first().append(Tt(Ll,{id:"luckysheet-dataVerification-dialog",addclass:"luckysheet-dataVerification-dialog",title:l.dataVerification,content:a,botton:`<button id="luckysheet-dataVerification-dialog-confirm" class="btn btn-primary">${o.confirm}</button>
                        <button id="luckysheet-dataVerification-dialog-delete" class="btn btn-default">${t.deleteVerification}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${o.cancel}</button>`,style:"z-index:100003"}));let s=$("#luckysheet-dataVerification-dialog").find(".luckysheet-modal-dialog-content").css("min-width",350).end(),u=s.outerHeight(),f=s.outerWidth(),m=$(window).width(),d=$(window).height(),p=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-dataVerification-dialog").css({left:(m+p-f)/2,top:(d+b-u)/3}).show(),e.dataAllocation()},init:function(){let e=this,n=Be().dataVerification;$(document).off("click.dropdownBtn").on("click.dropdownBtn","#luckysheet-dataVerification-dropdown-btn",function(t){e.dropdownListShow(),t.stopPropagation()}),$(document).off("click.dropdownListItem").on("click.dropdownListItem","#luckysheet-dataVerification-dropdown-List .dropdown-List-item",function(t){var l=$(this);let o=t.target.innerText;l.hasClass("multi")?(l.toggleClass("checked"),o=$.map($("#luckysheet-dataVerification-dropdown-List").children().filter(".checked"),function(f){return f.innerText}).join(",")):$("#luckysheet-dataVerification-dropdown-List").hide();let a=h.luckysheet_select_save[h.luckysheet_select_save.length-1],s=a.row_focus,u=a.column_focus;$("#luckysheet-rich-text-editor").text(o),y.updatecell(s,u),t.stopPropagation()}),$(document).off("click.dvRange").on("click.dvRange","#data-verification-range .fa-table",function(t){$("#luckysheet-dataVerification-dialog").hide();let l="0",o=$(this).siblings("input").val().trim();e.rangeDialog(l,o),e.selectRange=[];let a=e.getRangeByTxt(o);if(y.rangetosheet=h.currentSheetIndex,a[0].sheetIndex!=h.currentSheetIndex&&kt.changeSheetExec(a[0].sheetIndex),a.length>0)for(let s=0;s<a.length;s++){let u=a[s].row[0],f=a[s].row[1],m=a[s].column[0],d=a[s].column[1],p=h.visibledatarow[f],b=u-1==-1?0:h.visibledatarow[u-1],g=h.visibledatacolumn[d],v=m-1==-1?0:h.visibledatacolumn[m-1];e.selectRange.push({left:v,width:g-v-1,top:b,height:p-b-1,left_move:v,width_move:g-v-1,top_move:b,height_move:p-b-1,row:[u,f],column:[m,d],row_focus:u,column_focus:m})}gr(e.selectRange)}),$(document).off("click.dvRange2").on("click.dvRange2","#luckysheet-dataVerification-dialog .show-box-item-dropdown .range .fa-table",function(t){$("#luckysheet-dataVerification-dialog").hide();let l="1",o=$(this).siblings("input").val().trim();e.rangeDialog(l,o),e.selectRange=[];let a=e.getRangeByTxt(o);if(y.rangetosheet=h.currentSheetIndex,a[0].sheetIndex!=h.currentSheetIndex&&kt.changeSheetExec(a[0].sheetIndex),a.length>0)for(let s=0;s<a.length;s++){let u=a[s].row[0],f=a[s].row[1],m=a[s].column[0],d=a[s].column[1],p=h.visibledatarow[f],b=u-1==-1?0:h.visibledatarow[u-1],g=h.visibledatacolumn[d],v=m-1==-1?0:h.visibledatacolumn[m-1];e.selectRange.push({left:v,width:g-v-1,top:b,height:p-b-1,left_move:v,width_move:g-v-1,top_move:b,height_move:p-b-1,row:[u,f],column:[m,d],row_focus:u,column_focus:m})}gr(e.selectRange)}),$(document).off("click.dvRangeConfirm").on("click.dvRangeConfirm","#luckysheet-dataVerificationRange-dialog-confirm",function(t){let l=$(this).attr("data-source"),o=$(this).parents("#luckysheet-dataVerificationRange-dialog").find("input").val();if(e.getRangeByTxt(o).length>1){ke.info('<i class="fa fa-exclamation-triangle"></i>',"\u4E0D\u80FD\u5BF9\u591A\u91CD\u9009\u62E9\u533A\u57DF\u6267\u884C\u6B64\u64CD\u4F5C\uFF0C\u8BF7\u9009\u62E9\u5355\u4E2A\u533A\u57DF\uFF0C\u7136\u540E\u518D\u8BD5");return}l=="0"?$("#luckysheet-dataVerification-dialog #data-verification-range input").val(o):l=="1"&&$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .range input").val(o),$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),y.rangetosheet!=null&&y.rangetosheet!=h.currentSheetIndex&&(kt.changeSheetExec(y.rangetosheet),y.rangetosheet=null),gr([])}),$(document).off("click.dvRangeClose").on("click.dvRangeClose","#luckysheet-dataVerificationRange-dialog-close",function(t){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),y.rangetosheet!=null&&y.rangetosheet!=h.currentSheetIndex&&(kt.changeSheetExec(y.rangetosheet),y.rangetosheet=null),gr([])}),$(document).on("click","#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close",function(t){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-dataVerification-dialog").show(),y.rangetosheet!=null&&y.rangetosheet!=h.currentSheetIndex&&(kt.changeSheetExec(y.rangetosheet),y.rangetosheet=null),gr([])}),$(document).off("change.typeSelect").on("change.typeSelect","#data-verification-type-select",function(t){$("#luckysheet-dataVerification-dialog .show-box .show-box-item").hide();let l=this.value,o=e.curItem;if(l=="dropdown"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown").show();let a="";l==o.type&&(a=o.value1),$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val(a),$("#luckysheet-dataVerification-dialog #data-verification-multi").prop("checked",!!o.type2)}else if(l=="checkbox"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox").show();let a="",s="";l==o.type&&(a=o.value1,s=o.value2),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val(a),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val(s)}else if(l=="number"||l=="number_integer"||l=="number_decimal"){$("#luckysheet-dataVerification-dialog .show-box-item-number").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide();let a="bw",s="",u="";(o.type=="number"||o.type=="number_integer"||o.type=="number_decimal")&&(a=o.type2,s=o.value1,u=o.value2),$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(a),a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1").val(s),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2").val(u)}else if(l=="text_content"){$("#luckysheet-dataVerification-dialog .show-box-item-text").show();let a="include",s="";l==o.type&&(a=o.type2,s=o.value1),$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(a),$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val(s)}else if(l=="text_length"){$("#luckysheet-dataVerification-dialog .show-box-item-textLength").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide();let a="bw",s="",u="";l==o.type&&(a=o.type2,s=o.value1,u=o.value2),$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(a),a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1").val(s),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2").val(u)}else if(l=="date"){$("#luckysheet-dataVerification-dialog .show-box-item-date").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide();let a="bw",s="",u="";l==o.type&&(a=o.type2,s=o.value1,u=o.value2),$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(a),a=="bw"||a=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1").val(s),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2").val(u)}else if(l=="validity"){$("#luckysheet-dataVerification-dialog .show-box .show-box-item-validity").show();let a="card";l==o.type&&(a=o.type2),$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val(a)}}),$(document).off("change.numberSelect").on("change.numberSelect","#data-verification-number-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide();let l=this.value;l=="bw"||l=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show()}),$(document).off("change.textLengthSelect").on("change.textLengthSelect","#data-verification-textLength-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide();let l=this.value;l=="bw"||l=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show()}),$(document).off("change.dateSelect").on("change.dateSelect","#data-verification-date-select",function(t){$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide();let l=this.value;l=="bw"||l=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show()}),$(document).off("change.hintShow").on("change.hintShow","#data-verification-hint-show",function(t){this.checked?$("#luckysheet-dataVerification-dialog .data-verification-hint-text").show():$("#luckysheet-dataVerification-dialog .data-verification-hint-text").hide()}),$(document).off("click.dvSaveConfirm").on("click.dvSaveConfirm","#luckysheet-dataVerification-dialog-confirm",function(t){let l=$("#luckysheet-dataVerification-dialog #data-verification-range input").val().trim(),o=e.getRangeByTxt(l);if(o.length==0){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.selectCellRange2);return}let a=o[o.length-1].row[0],s=o[o.length-1].row[1],u=o[o.length-1].column[0],f=o[o.length-1].column[1],m=It.deepCopyFlowData(h.flowdata);a<0&&(a=0),s>m.length-1&&(s=m.length-1),u<0&&(u=0),f>m[0].length-1&&(f=m[0].length-1);let d=$("#luckysheet-dataVerification-dialog #data-verification-type-select").val(),p=null,b="",g="";if(d=="dropdown"){if(b=$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val().trim(),b.length==0){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo1);return}p=$("#luckysheet-dataVerification-dialog #data-verification-multi").is(":checked")}else if(d=="checkbox"){if(b=$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val().trim(),g=$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val().trim(),b.length==0||g.length==0){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo2);return}}else if(d=="number"||d=="number_integer"||d=="number_decimal"){if(p=$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(),b=$("#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value1").val().trim(),!K(b)){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(p=="bw"||p=="nb"){if(g=$("#luckysheet-dataVerification-dialog .show-box-item-number .input:visible .data-verification-value2").val().trim(),!K(g)){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(Number(g)<Number(b)){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo4);return}}}else if(d=="text_content"){if(p=$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(),b=$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val().trim(),b.length==0){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo5);return}}else if(d=="text_length"){if(p=$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(),b=$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value1").val().trim(),!K(b)){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(!Number.isInteger(Number(b))||Number(b)<0){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.textlengthInteger);return}if(p=="bw"||p=="nb"){if(g=$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input:visible .data-verification-value2").val().trim(),!K(g)){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo3);return}if(!Number.isInteger(Number(g))||Number(g)<0){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.textlengthInteger);return}if(Number(g)<Number(b)){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo4);return}}}else if(d=="date"){if(p=$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(),b=$("#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value1").val().trim(),!dr(b)){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo6);return}if(p=="bw"||p=="nb"){if(g=$("#luckysheet-dataVerification-dialog .show-box-item-date .input:visible .data-verification-value2").val().trim(),!dr(g)){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo6);return}if(un(b,g)>0){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.tooltipInfo7);return}}}else d=="validity"&&(p=$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val());let v=$("#luckysheet-dataVerification-dialog #data-verification-remote").is(":checked"),x=$("#luckysheet-dataVerification-dialog #data-verification-prohibitInput").is(":checked"),_=$("#luckysheet-dataVerification-dialog #data-verification-hint-show").is(":checked"),S="";_&&(S=$("#luckysheet-dataVerification-dialog .data-verification-hint-text input").val().trim());let I={type:d,type2:p,value1:b,value2:g,checked:!1,remote:v,prohibitInput:x,hintShow:_,hintText:S},P=$.extend(!0,{},e.dataVerification),F=$.extend(!0,{},e.dataVerification);for(let D=a;D<=s;D++)for(let k=u;k<=f;k++)F[D+"_"+k]=I,d=="checkbox"&&kr(D,k,m,I.value2);d=="checkbox"?e.refOfCheckbox(P,F,h.currentSheetIndex,m,o[o.length-1]):e.ref(P,F,h.currentSheetIndex),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerification-dialog").hide()}),$(document).off("click.delete").on("click.delete","#luckysheet-dataVerification-dialog-delete",function(t){let l=$("#luckysheet-dataVerification-dialog #data-verification-range input").val().trim(),o=e.getRangeByTxt(l);if(o.length==0){ke.info('<i class="fa fa-exclamation-triangle"></i>',n.selectCellRange2);return}let a=$.extend(!0,{},e.dataVerification),s=$.extend(!0,{},e.dataVerification),u=o[o.length-1].row[0],f=o[o.length-1].row[1],m=o[o.length-1].column[0],d=o[o.length-1].column[1];for(let p=u;p<=f;p++)for(let b=m;b<=d;b++)delete s[p+"_"+b];e.ref(a,s,h.currentSheetIndex),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerification-dialog").hide()}),$(document).on("click","#luckysheet-info .luckysheet-modal-dialog-title-close, #luckysheet-info .luckysheet-model-close-btn",function(t){$(this).parents("#luckysheet-info").hide(),$("#luckysheet-dataVerification-dialog").is(":visible")&&$("#luckysheet-modal-dialog-mask").show(),t.stopPropagation()})},dataAllocation:function(){let e=this,n=h.luckysheet_select_save[h.luckysheet_select_save.length-1],t=Kl(h.currentSheetIndex,n,h.currentSheetIndex);$("#luckysheet-dataVerification-dialog #data-verification-range input").val(t);let l=n.row_focus||n.row[0],o=n.column_focus||n.column[0],s=$.extend(!0,{},e.dataVerification)[l+"_"+o];s==null&&(s=$.extend(!0,{},e.defaultItem)),e.curItem=s,$("#luckysheet-dataVerification-dialog #data-verification-type-select").val(s.type),$("#luckysheet-dataVerification-dialog .show-box .show-box-item").hide(),s.type=="dropdown"?($("#luckysheet-dataVerification-dialog .show-box .show-box-item-dropdown").show(),$("#luckysheet-dataVerification-dialog .show-box-item-dropdown .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog #data-verification-multi").prop("checked",!!s.type2)):s.type=="checkbox"?($("#luckysheet-dataVerification-dialog .show-box .show-box-item-checkbox").show(),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-checkbox .data-verification-value2").val(s.value2)):s.type=="number"||s.type=="number_integer"||s.type=="number_decimal"?($("#luckysheet-dataVerification-dialog .show-box-item-number").show(),$("#luckysheet-dataVerification-dialog #data-verification-number-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-number .input").hide(),s.type2=="bw"||s.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-number .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-number .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-number .data-verification-value2").val(s.value2)):s.type=="text_content"?($("#luckysheet-dataVerification-dialog .show-box-item-text").show(),$("#luckysheet-dataVerification-dialog #data-verification-text-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-text .data-verification-value1").val(s.value1)):s.type=="text_length"?($("#luckysheet-dataVerification-dialog .show-box-item-textLength").show(),$("#luckysheet-dataVerification-dialog #data-verification-textLength-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input").hide(),s.type2=="bw"||s.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-textLength .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-textLength .data-verification-value2").val(s.value2)):s.type=="date"?($("#luckysheet-dataVerification-dialog .show-box-item-date").show(),$("#luckysheet-dataVerification-dialog #data-verification-date-select").val(s.type2),$("#luckysheet-dataVerification-dialog .show-box-item-date .input").hide(),s.type2=="bw"||s.type2=="nb"?$("#luckysheet-dataVerification-dialog .show-box-item-date .input1").show():$("#luckysheet-dataVerification-dialog .show-box-item-date .input2").show(),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value1").val(s.value1),$("#luckysheet-dataVerification-dialog .show-box-item-date .data-verification-value2").val(s.value2)):s.type=="validity"&&($("#luckysheet-dataVerification-dialog .show-box .show-box-item-validity").show(),$("#luckysheet-dataVerification-dialog #data-verification-validity-select").val(s.type2)),$("#luckysheet-dataVerification-dialog #data-verification-remote").prop("checked",s.remote),$("#luckysheet-dataVerification-dialog #data-verification-prohibitInput").prop("checked",s.prohibitInput),$("#luckysheet-dataVerification-dialog #data-verification-hint-show").prop("checked",s.hintShow),s.hintShow?$("#luckysheet-dataVerification-dialog .data-verification-hint-text").show():$("#luckysheet-dataVerification-dialog .data-verification-hint-text").hide(),$("#luckysheet-dataVerification-dialog .data-verification-hint-text input").val(s.hintText)},rangeDialog:function(e,n){let t=this,l=Be(),o=l.dataVerification,a=l.button;$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-dataVerificationRange-dialog").remove(),$("body").first().append(Tt(Ll,{id:"luckysheet-dataVerificationRange-dialog",addclass:"luckysheet-dataVerificationRange-dialog",title:o.selectCellRange,content:`<input readonly="readonly" placeholder="${o.selectCellRange2}" value="${n}"/>`,botton:`<button id="luckysheet-dataVerificationRange-dialog-confirm" class="btn btn-primary" data-source="${e}">${a.confirm}</button>
                        <button id="luckysheet-dataVerificationRange-dialog-close" class="btn btn-default">${a.close}</button>`,style:"z-index:100003"}));let s=$("#luckysheet-dataVerificationRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),u=s.outerHeight(),f=s.outerWidth(),m=$(window).width(),d=$(window).height(),p=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-dataVerificationRange-dialog").css({left:(m+p-f)/2,top:(d+b-u)/3}).show()},getTxtByRange:function(e){if(e.length>0){let n=[];for(let t=0;t<e.length;t++){let l=e[t].row[0],o=e[t].row[1],a=e[t].column[0],s=e[t].column[1];n.push(Kl(h.currentSheetIndex,{row:[l,o],column:[a,s]},h.currentSheetIndex))}return n.join(",")}},getRangeByTxt:function(e){let n=[];if(e.indexOf(",")!=-1){let t=e.split(",");for(let l=0;l<t.length;l++)if(y.iscelldata(t[l]))n.push(y.getcellrange(t[l]));else{n=[];break}}else y.iscelldata(e)&&n.push(y.getcellrange(e));return n},cellFocus:function(e,n,t){$("#luckysheet-dataVerification-dropdown-btn").hide(),$("#luckysheet-dataVerification-showHintBox").hide();let l=this;if(l.dataVerification==null||l.dataVerification[e+"_"+n]==null){$("#luckysheet-dataVerification-dropdown-List").hide();return}let o=h.visibledatarow[e],a=e==0?0:h.visibledatarow[e-1],s=h.visibledatacolumn[n],u=n==0?0:h.visibledatacolumn[n-1],f=_t.mergeborer(h.flowdata,e,n);f&&(o=f.row[1],a=f.row[0],s=f.column[1],u=f.column[0]);let m=l.dataVerification[e+"_"+n];if(t&&m.type=="checkbox"){l.checkboxChange(e,n);return}if(m.type=="dropdown"?($("#luckysheet-dataVerification-dropdown-btn").show().css({"max-width":s-u,"max-height":o-a,left:s-20,top:a+(o-a-20)/2}),$("#luckysheet-dataVerification-dropdown-List").is(":visible")&&$("#luckysheet-dataVerification-dropdown-List").prop("data-index")!=e+"_"+n&&$("#luckysheet-dataVerification-dropdown-List").hide()):$("#luckysheet-dataVerification-dropdown-List").hide(),m.hintShow){let b;h.lang=="en"?b='<span style="color:#f5a623;">Hint: </span>':b='<span style="color:#f5a623;">\u63D0\u793A\uFF1A</span>',b+=l.getHintText(m),$("#luckysheet-dataVerification-showHintBox").html(b).show().css({left:u,top:o});return}let d=Vt(e,n,null);if(ft(d))return;if(!l.validateCellData(d,m)){let b;h.lang=="en"?b='<span style="color:#f72626;">Failure: </span>':b='<span style="color:#f72626;">\u5931\u6548\uFF1A</span>',b+=l.getFailureText(m),$("#luckysheet-dataVerification-showHintBox").html(b).show().css({left:u,top:o})}},getHintText:function(e){let n=this,t=e.hintText||"";return t.length==0&&(h.lang=="en"?e.type=="dropdown"?t+="please select an option in the drop-down list":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="please enter a "+n.optionLabel_en[e.type]+" "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="text_content"?t+="please enter text "+n.optionLabel_en[e.type2]+" "+e.value1:e.type=="text_length"?(t+="please enter text with length "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="date"?(t+="please enter a date "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="validity"&&(t+="please enter the correct "+n.optionLabel_en[e.type2])):e.type=="dropdown"?t+="\u8BF7\u9009\u62E9\u4E0B\u62C9\u5217\u8868\u4E2D\u7684\u9009\u9879":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="\u8BF7\u8F93\u5165"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684"+n.optionLabel[e.type]):e.type=="text_content"?t+="\u8BF7\u8F93\u5165\u5185\u5BB9"+n.optionLabel[e.type2]+e.value1+"\u7684\u6587\u672C":e.type=="text_length"?(t+="\u8BF7\u8F93\u5165\u957F\u5EA6"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u6587\u672C"):e.type=="date"?(t+="\u8BF7\u8F93\u5165"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u65E5\u671F"):e.type=="validity"&&(t+="\u8BF7\u8F93\u5165\u6B63\u786E\u7684"+n.optionLabel[e.type2]))),t},getFailureText:function(e){let n=this,t="";return h.lang=="en"?e.type=="dropdown"?t+="what you selected is not an option in the drop-down list":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="what you entered is not a "+n.optionLabel_en[e.type]+" "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="text_content"?t+="what you entered is not text that "+n.optionLabel_en[e.type2]+" "+e.value1:e.type=="text_length"?(t+="the text you entered is not length "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="date"?(t+="the date you entered is not "+n.optionLabel_en[e.type2]+" "+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+=" and "+e.value2)):e.type=="validity"&&(t+="what you entered is not a correct "+n.optionLabel_en[e.type2])):e.type=="dropdown"?t+="\u4F60\u9009\u62E9\u7684\u4E0D\u662F\u4E0B\u62C9\u5217\u8868\u4E2D\u7684\u9009\u9879":e.type=="checkbox"||(e.type=="number"||e.type=="number_integer"||e.type=="number_decimal"?(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684"+n.optionLabel[e.type]):e.type=="text_content"?t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F\u5185\u5BB9"+n.optionLabel[e.type2]+e.value1+"\u7684\u6587\u672C":e.type=="text_length"?(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F\u957F\u5EA6"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u6587\u672C"):e.type=="date"?(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F"+n.optionLabel[e.type2]+e.value1,(e.type2=="bw"||e.type2=="nb")&&(t+="\u548C"+e.value2+"\u4E4B\u95F4"),t+="\u7684\u65E5\u671F"):e.type=="validity"&&(t+="\u4F60\u8F93\u5165\u7684\u4E0D\u662F\u4E00\u4E2A\u6B63\u786E\u7684"+n.optionLabel[e.type2])),t},validateCellData:function(e,n){let t=this,l=n.type,o=n.type2,a=n.value1,s=n.value2;if(l=="dropdown"){let u=t.getDropdownList(a);if(o&&e)return e.split(",").every(function(m){return u.indexOf(m)!==-1});let f=!1;for(let m=0;m<u.length;m++)if(u[m]==e){f=!0;break}return f}else if(l!="checkbox"){if(l=="number"||l=="number_integer"||l=="number_decimal"){if(!K(e)||(e=Number(e),l=="number_integer"&&e%1!=0)||l=="number_decimal"&&e%1==0||(a=Number(a),s=Number(s),o=="bw"&&(e<a||e>s))||o=="nb"&&e>=a&&e<=s||o=="eq"&&e!=a||o=="ne"&&e==a||o=="gt"&&e<=a||o=="lt"&&e>=a||o=="gte"&&e<a||o=="lte"&&e>a)return!1}else if(l=="text_content"){if(e=e.toString(),a=a.toString(),o=="include"&&e.indexOf(a)==-1||o=="exclude"&&e.indexOf(a)>-1||o=="equal"&&e!=a)return!1}else if(l=="text_length"){if(e=e.toString().length,a=Number(a),s=Number(s),o=="bw"&&(e<a||e>s)||o=="nb"&&e>=a&&e<=s||o=="eq"&&e!=a||o=="ne"&&e==a||o=="gt"&&e<=a||o=="lt"&&e>=a||o=="gte"&&e<a||o=="lte"&&e>a)return!1}else if(l=="date"){if(!dr(e)||o=="bw"&&(un(e,a)<0||un(e,s)>0)||o=="nb"&&un(e,a)>=0&&un(e,s)<=0||o=="eq"&&un(e,a)!=0||o=="ne"&&un(e,a)==0||o=="bf"&&un(e,a)>=0||o=="nbf"&&un(e,a)<0||o=="af"&&un(e,a)<=0||o=="naf"&&un(e,a)>0)return!1}else if(l=="validity"&&(o=="card"&&!Vx(e)||o=="phone"&&!/^1[3456789]\d{9}$/.test(e)))return!1}return!0},dropdownListShow:function(){$("#luckysheet-dataVerification-showHintBox").hide();let e=this,n=h.luckysheet_select_save[h.luckysheet_select_save.length-1],t=n.row_focus,l=n.column_focus,o=h.visibledatarow[t],a=t==0?0:h.visibledatarow[t-1],s=h.visibledatacolumn[l],u=l==0?0:h.visibledatacolumn[l-1],f=_t.mergeborer(h.flowdata,t,l);f&&(o=f.row[1],a=f.row[0],s=f.column[1],u=f.column[0]);let m=e.dataVerification[t+"_"+l],d=e.getDropdownList(m.value1),p="";if(m.type==="dropdown"&&m.type2){let v=Vt(t,l,null),x=ft(v)?[]:v.split(",");d.forEach(_=>{p+=`<div class="dropdown-List-item  luckysheet-mousedown-cancel multi${x.indexOf(_)!==-1?" checked":""}">${_}</div>`})}else d.forEach(v=>{p+=`<div class="dropdown-List-item luckysheet-mousedown-cancel">${v}</div>`});$("#luckysheet-dataVerification-dropdown-List").html(p).prop("data-index",t+"_"+l).show().css({width:s-u-1,left:u,top:o});let b=$("#luckysheet-dataVerification-dropdown-List").outerHeight(),g=$("#luckysheet-cell-main")[0].scrollHeight;o+b>g-42-6&&$("#luckysheet-dataVerification-dropdown-List").css({top:a-b})},getDropdownList:function(e){let n=[];if(y.iscelldata(e)){let t=y.getcellrange(e),l=h.luckysheetfile[Me(t.sheetIndex)].data;for(let o=t.row[0];o<=t.row[1];o++)for(let a=t.column[0];a<=t.column[1];a++){if(l[o]==null)continue;let s=l[o][a];if(s==null||s.v==null)continue;let u=s.m||s.v;n.includes(u)||n.push(u)}}else{let t=e.split(",");for(let l=0;l<t.length;l++){let o=t[l];o.length!=0&&(n.includes(o)||n.push(o))}}return n},checkboxChange:function(e,n){let t=this,l=$.extend(!0,{},t.dataVerification),o=$.extend(!0,{},t.dataVerification),a=o[e+"_"+n];a.checked=!a.checked;let s=a.value2;a.checked&&(s=a.value1);let u=It.deepCopyFlowData(h.flowdata);kr(e,n,u,s),t.refOfCheckbox(l,o,h.currentSheetIndex,u,{row:[e,e],column:[n,n]})},ref:function(e,n,t){let l=this;if(h.clearjfundo){h.jfundo.length=0;let o={};o.type="updateDataVerification",o.sheetIndex=t,o.historyDataVerification=e,o.currentDataVerification=n,h.jfredo.push(o)}l.dataVerification=n,h.luckysheetfile[Me(t)].dataVerification=n,Ue.allowUpdate&&Ue.saveParam("all",t,n,{k:"dataVerification"}),setTimeout(function(){Xt()},1)},refOfCheckbox:function(e,n,t,l,o){let a=this;if(h.clearjfundo){h.jfundo.length=0;let s={};s.type="updateDataVerificationOfCheckbox",s.sheetIndex=t,s.historyDataVerification=e,s.currentDataVerification=n,s.data=h.flowdata,s.curData=l,s.range=o,h.jfredo.push(s)}a.dataVerification=n,h.luckysheetfile[Me(t)].dataVerification=n,h.flowdata=l,It.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[Me(t)].data=h.flowdata,Ue.allowUpdate&&(Ue.saveParam("all",t,n,{k:"dataVerification"}),Ue.historyParam(h.flowdata,t,o)),setTimeout(function(){Xt()},1)}};ll=Bx});function Ao(e,n,t,l,o){if(o=o||h.currentSheetIndex,e=="row"&&!nr(o,"insertRows"))return;if(e=="column"&&!nr(o,"insertColumns"))return;let a=Me(o),s=h.luckysheetfile[a],u=$.extend(!0,[],s.data);t=Math.floor(t);let f=$.extend(!0,{},s.config);f.merge==null&&(f.merge={});let m={};for(let A in f.merge){let E=f.merge[A],L=E.r,N=E.c,W=E.rs,X=E.cs;e=="row"?n<L?m[L+t+"_"+N]={r:L+t,c:N,rs:W,cs:X}:n==L&&W!=1?l=="lefttop"?m[L+t+"_"+N]={r:L+t,c:N,rs:W,cs:X}:m[L+"_"+N]={r:L,c:N,rs:W+t,cs:X}:n<L+W-1?m[L+"_"+N]={r:L,c:N,rs:W+t,cs:X}:n==L+W-1?l=="lefttop"?W==1?m[L+t+"_"+N]={r:L+t,c:N,rs:W,cs:X}:m[L+"_"+N]={r:L,c:N,rs:W+t,cs:X}:m[L+"_"+N]={r:L,c:N,rs:W,cs:X}:m[L+"_"+N]={r:L,c:N,rs:W,cs:X}:e=="column"&&(n<N?m[L+"_"+(N+t)]={r:L,c:N+t,rs:W,cs:X}:n==N&&X!=1?l=="lefttop"?m[L+"_"+(N+t)]={r:L,c:N+t,rs:W,cs:X}:m[L+"_"+N]={r:L,c:N,rs:W,cs:X+t}:n<N+X-1?m[L+"_"+N]={r:L,c:N,rs:W,cs:X+t}:n==N+X-1?l=="lefttop"?X==1?m[L+"_"+(N+t)]={r:L,c:N+t,rs:W,cs:X}:m[L+"_"+N]={r:L,c:N,rs:W,cs:X+t}:m[L+"_"+N]={r:L,c:N,rs:W,cs:X}:m[L+"_"+N]={r:L,c:N,rs:W,cs:X})}f.merge=m;let d=s.calcChain,p=[];if(d!=null&&d.length>0)for(let A=0;A<d.length;A++){let E=$.extend(!0,{},d[A]),L=E.r,N=E.c,W=E.index,X=Ti(L,N,W);if(e=="row"){let te="="+y.functionStrChange(X,"add","row",l,n,t);u[L][N]&&u[L][N].f==X&&(u[L][N].f=te),l=="lefttop"?L>=n&&(E.r+=t):l=="rightbottom"&&L>n&&(E.r+=t),p.push(E)}else if(e=="column"){let te="="+y.functionStrChange(X,"add","col",l,n,t);u[L][N]&&u[L][N].f==X&&(u[L][N].f=te),l=="lefttop"?N>=n&&(E.c+=t):l=="rightbottom"&&N>n&&(E.c+=t),p.push(E)}}let b=s.filter_select,g=s.filter,v=null;if(b!=null&&JSON.stringify(b)!="{}"){v={filter_select:null,filter:null};let A=b.row[0],E=b.row[1],L=b.column[0],N=b.column[1];if(e=="row"){if(A<n?(E==n&&l=="lefttop"||E>n)&&(E+=t):A==n?l=="lefttop"?(A+=t,E+=t):l=="rightbottom"&&E>n&&(E+=t):(A+=t,E+=t),g!=null){v.filter={};for(let W in g){let X=g[W].rowhidden,te={};for(let ue in X)ue=parseFloat(ue),ue<n?te[ue]=0:ue==n?l=="lefttop"?te[ue+t]=0:l=="rightbottom"&&(te[ue]=0):te[ue+t]=0;v.filter[W]=$.extend(!0,{},g[W]),v.filter[W].rowhidden=te,v.filter[W].str=A,v.filter[W].edr=E}}}else if(e=="column"&&(L<n?(N==n&&l=="lefttop"||N>n)&&(N+=t):L==n?l=="lefttop"?(L+=t,N+=t):l=="rightbottom"&&N>n&&(N+=t):(L+=t,N+=t),g!=null)){v.filter={};for(let W in g){let X=g[W].cindex;(X==n&&l=="lefttop"||X>n)&&(X+=t),v.filter[X-L]=$.extend(!0,{},g[W]),v.filter[X-L].cindex=X,v.filter[X-L].stc=L,v.filter[X-L].edc=N}}v.filter_select={row:[A,E],column:[L,N]}}if(v!=null&&v.filter!=null){f.rowhidden==null&&(f.rowhidden={});for(let A in v.filter){let E=v.filter[A].rowhidden;for(let L in E)f.rowhidden[L]=0}}let x=s.luckysheet_conditionformat_save,_=[];if(x!=null&&x.length>0)for(let A=0;A<x.length;A++){let E=x[A].cellrange,L=[];for(let W=0;W<E.length;W++){let X=E[W].row[0],te=E[W].row[1],ue=E[W].column[0],pe=E[W].column[1];e=="row"?X<n?(te==n&&l=="lefttop"||te>n)&&(te+=t):X==n?l=="lefttop"?(X+=t,te+=t):l=="rightbottom"&&te>n&&(te+=t):(X+=t,te+=t):e=="column"&&(ue<n?(pe==n&&l=="lefttop"||pe>n)&&(pe+=t):ue==n?l=="lefttop"?(ue+=t,pe+=t):l=="rightbottom"&&pe>n&&(pe+=t):(ue+=t,pe+=t)),L.push({row:[X,te],column:[ue,pe]})}let N=$.extend(!0,{},x[A]);N.cellrange=L,_.push(N)}let S=s.luckysheet_alternateformat_save,I=[];if(S!=null&&S.length>0)for(let A=0;A<S.length;A++){let E=S[A].cellrange.row[0],L=S[A].cellrange.row[1],N=S[A].cellrange.column[0],W=S[A].cellrange.column[1],X=$.extend(!0,{},S[A]);e=="row"?E<n?(L==n&&l=="lefttop"||L>n)&&(L+=t):E==n?l=="lefttop"?(E+=t,L+=t):l=="rightbottom"&&L>n&&(L+=t):(E+=t,L+=t):e=="column"&&(N<n?(W==n&&l=="lefttop"||W>n)&&(W+=t):N==n?l=="lefttop"?(N+=t,W+=t):l=="rightbottom"&&W>n&&(W+=t):(N+=t,W+=t)),X.cellrange={row:[E,L],column:[N,W]},I.push(X)}let P={freezenhorizontaldata:null,freezenverticaldata:null};if(Ie.freezenhorizontaldata!=null&&e=="row"){let A=Ie.freezenhorizontaldata[2],E=Ie.freezenhorizontaldata[1]-1;(E==n&&l=="lefttop"||E>n)&&(E+=t);let L=h.visibledatarow[E]-2-A+h.columnHeaderHeight;P.freezenhorizontaldata=[h.visibledatarow[E],E+1,A,Ie.cutVolumn(h.visibledatarow,E+1),L]}else P.freezenhorizontaldata=Ie.freezenhorizontaldata;if(Ie.freezenverticaldata!=null&&e=="column"){let A=Ie.freezenverticaldata[2],E=Ie.freezenverticaldata[1]-1;(E==n&&l=="lefttop"||E>n)&&(E+=t);let L=h.visibledatacolumn[E]-2-A+h.rowHeaderWidth;P.freezenverticaldata=[h.visibledatacolumn[E],E+1,A,Ie.cutVolumn(h.visibledatacolumn,E+1),L]}else P.freezenverticaldata=Ie.freezenverticaldata;let F=s.dataVerification,D={};if(F!=null)for(let A in F){let E=Number(A.split("_")[0]),L=Number(A.split("_")[1]),N=F[A];if(e=="row")if(n<E)D[E+t+"_"+L]=N;else if(n==E)if(l=="lefttop"){D[E+t+"_"+L]=N;for(let W=0;W<t;W++)D[E+W+"_"+L]=N}else{D[E+"_"+L]=N;for(let W=0;W<t;W++)D[E+W+1+"_"+L]=N}else D[E+"_"+L]=N;else if(e=="column")if(n<L)D[E+"_"+(L+t)]=N;else if(n==L)if(l=="lefttop"){D[E+"_"+(L+t)]=N;for(let W=0;W<t;W++)D[E+"_"+(L+W)]=N}else{D[E+"_"+L]=N;for(let W=0;W<t;W++)D[E+"_"+(L+W+1)]=N}else D[E+"_"+L]=N}let k=s.hyperlink,w={};if(k!=null)for(let A in k){let E=Number(A.split("_")[0]),L=Number(A.split("_")[1]),N=k[A];e=="row"?n<E||n==E&&l=="lefttop"?w[E+t+"_"+L]=N:w[E+"_"+L]=N:e=="column"&&(n<L||n==L&&l=="lefttop"?w[E+"_"+(L+t)]=N:w[E+"_"+L]=N)}let C;if(e=="row"){if(C="r",f.rowlen!=null){let L={};for(let N in f.rowlen)N=parseFloat(N),N<n?L[N]=f.rowlen[N]:N==n?l=="lefttop"?L[N+t]=f.rowlen[N]:l=="rightbottom"&&(L[N]=f.rowlen[N]):L[N+t]=f.rowlen[N];f.rowlen=L}if(f.rowhidden!=null){let L={};for(let N in f.rowhidden)N=parseFloat(N),N<n?L[N]=f.rowhidden[N]:N==n?l=="lefttop"?L[N+t]=f.rowhidden[N]:l=="rightbottom"&&(L[N]=f.rowhidden[N]):L[N+t]=f.rowhidden[N];f.rowhidden=L}let A=[];for(let L=0;L<u[0].length;L++)A.push(null);var T=[];if(f.borderInfo&&f.borderInfo.length>0){let L=[];for(let N=0;N<f.borderInfo.length;N++){let W=f.borderInfo[N].rangeType;if(W=="range"){let X=f.borderInfo[N].range,te=[];for(let ue=0;ue<X.length;ue++){let pe=X[ue].row[0],ne=X[ue].row[1];l=="lefttop"?n<=pe?(pe+=t,ne+=t):n<=ne&&(ne+=t):n<pe?(pe+=t,ne+=t):n<ne&&(ne+=t),ne>=pe&&te.push({row:[pe,ne],column:X[ue].column})}if(te.length>0){let ue={rangeType:"range",borderType:f.borderInfo[N].borderType,style:f.borderInfo[N].style,color:f.borderInfo[N].color,range:te};L.push(ue)}}else if(W=="cell"){let X=f.borderInfo[N].value.row_index;X===n&&T.push(JSON.parse(JSON.stringify(f.borderInfo[N]))),l=="lefttop"?n<=X&&(X+=t):n<X&&(X+=t),f.borderInfo[N].value.row_index=X,L.push(f.borderInfo[N])}}f.borderInfo=L}let E=[];for(let L=0;L<t;L++)if(E.push(JSON.stringify(A)),T.length){var O=JSON.parse(JSON.stringify(T));O.forEach(N=>{l==="rightbottom"?N.value.row_index+=L+1:l==="lefttop"&&(N.value.row_index+=L)}),f.borderInfo.push(...O)}l=="lefttop"?n==0?new Function("d","return d.unshift("+E.join(",")+")")(u):new Function("d","return d.splice("+n+", 0, "+E.join(",")+")")(u):new Function("d","return d.splice("+(n+1)+", 0, "+E.join(",")+")")(u)}else{if(C="c",f.columnlen!=null){let L={};for(let N in f.columnlen)N=parseFloat(N),N<n?L[N]=f.columnlen[N]:N==n?l=="lefttop"?L[N+t]=f.columnlen[N]:l=="rightbottom"&&(L[N]=f.columnlen[N]):L[N+t]=f.columnlen[N];f.columnlen=L}if(f.colhidden!=null){let L={};for(let N in f.colhidden)N=parseFloat(N),N<n?L[N]=f.colhidden[N]:N==n?l=="lefttop"?L[N+t]=f.colhidden[N]:l=="rightbottom"&&(L[N]=f.colhidden[N]):L[N+t]=f.colhidden[N];f.colhidden=L}let A=[];for(let L=0;L<u.length;L++)A.push(null);var T=[];if(f.borderInfo&&f.borderInfo.length>0){let L=[];for(let N=0;N<f.borderInfo.length;N++){let W=f.borderInfo[N].rangeType;if(W=="range"){let X=f.borderInfo[N].range,te=[];for(let ue=0;ue<X.length;ue++){let pe=X[ue].column[0],ne=X[ue].column[1];l=="lefttop"?n<=pe?(pe+=t,ne+=t):n<=ne&&(ne+=t):n<pe?(pe+=t,ne+=t):n<ne&&(ne+=t),ne>=pe&&te.push({row:X[ue].row,column:[pe,ne]})}if(te.length>0){let ue={rangeType:"range",borderType:f.borderInfo[N].borderType,style:f.borderInfo[N].style,color:f.borderInfo[N].color,range:te};L.push(ue)}}else if(W=="cell"){let X=f.borderInfo[N].value.col_index;X===n&&T.push(JSON.parse(JSON.stringify(f.borderInfo[N]))),l=="lefttop"?n<=X&&(X+=t):n<X&&(X+=t),f.borderInfo[N].value.col_index=X,L.push(f.borderInfo[N])}}f.borderInfo=L}if(T.length)for(let L=0;L<t;L++){var O=JSON.parse(JSON.stringify(T));O.forEach(W=>{l==="rightbottom"?W.value.col_index+=L+1:l==="lefttop"&&(W.value.col_index+=L)}),f.borderInfo.push(...O)}for(let L=0;L<u.length;L++){let N=u[L];for(let W=0;W<t;W++){let X=JSON.parse(JSON.stringify(A[L]));l=="lefttop"?n==0?N.unshift(X):N.splice(n,0,X):N.splice(n+1,0,X)}}}s.index==h.currentSheetIndex?Rs(u,f,"addRC",{index:n,len:t,direction:l,rc:C,restore:!1},p,v,_,I,P,D,w):(s.data=u,s.config=f,s.calcChain=p,s.filter=v.filter,s.filter_select=v.filter_select,s.luckysheet_conditionformat_save=_,s.luckysheet_alternateformat_save=I,s.dataVerification=D,s.hyperlink=w);let z=null;if(e=="row"?l=="lefttop"?z=[{row:[n,n+t-1],column:[0,u[0].length-1]}]:z=[{row:[n+1,n+t],column:[0,u[0].length-1]}]:l=="lefttop"?z=[{row:[0,u.length-1],column:[n,n+t-1]}]:z=[{row:[0,u.length-1],column:[n+1,n+t]}],s.luckysheet_select_save=z,s.index==h.currentSheetIndex&&(h.luckysheet_select_save=z,gl()),e=="row"){let A=$("#luckysheet-cell-main").scrollLeft(),E=$("#luckysheet-cell-main").scrollTop(),L=$("#luckysheet-cell-main").height(),N=$("#luckysheet-cell-main").width(),W=h.visibledatarow[z[0].row[1]],X=z[0].row[0]-1==-1?0:h.visibledatarow[z[0].row[0]-1];W-E-L+20>0?$("#luckysheet-scrollbar-y").scrollTop(W-L+20):X-E-20<0&&$("#luckysheet-scrollbar-y").scrollTop(X-20),t>30&&($("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide())}}function xh(e,n){let t=It.deepCopyFlowData(h.flowdata),l=$.extend(!0,{},h.config);l.merge==null&&(l.merge={});let o=t[0].length,a=cn([],e,o);t=t.concat(a);for(let s=0;s<n.length;s++){let u=n[s].r,f=n[s].c,m=n[s].v;kr(u,f,t,m),m!=null&&m.mc!=null&&m.mc.rs!=null&&(l.merge[m.mc.r+"_"+m.mc.c]=$.extend(!0,{},m.mc))}h.flowdata=t,It.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[Me(h.currentSheetIndex)].data=t,h.config=l,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,tr(h.flowdata.length,h.flowdata[0].length)}function Ts(e,n,t,l){if(l=l||h.currentSheetIndex,e=="row"&&!nr(l,"deleteRows"))return;if(e=="column"&&!nr(l,"deleteColumns"))return;let o=Me(l),a=h.luckysheetfile[o],s=$.extend(!0,[],a.data);if(n<0&&(n=0),t<0&&(t=0),e=="row"?(n>s.length-1&&(n=s.length-1),t>s.length-1&&(t=s.length-1)):(n>s[0].length-1&&(n=s[0].length-1),t>s[0].length-1&&(t=s[0].length-1)),n>t)return;let u=t-n+1,f=$.extend(!0,{},a.config);f.merge==null&&(f.merge={});let m={};for(let T in f.merge){let O=f.merge[T],z=O.r,A=O.c,E=O.rs,L=O.cs;e=="row"?z<n?z+E-1<n?m[z+"_"+A]={r:z,c:A,rs:E,cs:L}:z+E-1>=n&&z+E-1<t?m[z+"_"+A]={r:z,c:A,rs:n-z,cs:L}:z+E-1>=t&&(m[z+"_"+A]={r:z,c:A,rs:E-u,cs:L}):z>=n&&z<=t?z+E-1>t&&(m[n+"_"+A]={r:n,c:A,rs:z+E-1-t,cs:L}):z>t&&(m[z-u+"_"+A]={r:z-u,c:A,rs:E,cs:L}):e=="column"&&(A<n?A+L-1<n?m[z+"_"+A]={r:z,c:A,rs:E,cs:L}:A+L-1>=n&&A+L-1<t?m[z+"_"+A]={r:z,c:A,rs:E,cs:n-A}:A+L-1>=t&&(m[z+"_"+A]={r:z,c:A,rs:E,cs:L-u}):A>=n&&A<=t?A+L-1>t&&(m[z+"_"+n]={r:z,c:n,rs:E,cs:A+L-1-t}):A>t&&(m[z+"_"+(A-u)]={r:z,c:A-u,rs:E,cs:L}))}f.merge=m;let d=a.calcChain,p=[];if(d!=null&&d.length>0)for(let T=0;T<d.length;T++){let O=$.extend(!0,{},d[T]),z=O.r,A=O.c,E=O.index,L=Ti(z,A,E);if(e=="row"){if(z<n||z>t){let N="="+y.functionStrChange(L,"del","row",null,n,u);s[z][A]&&s[z][A].f==L&&(s[z][A].f=N),z>t&&(O.r=z-u),p.push(O)}}else if(e=="column"&&(A<n||A>t)){let N="="+y.functionStrChange(L,"del","col",null,n,u);s[z][A]&&s[z][A].f==L&&(s[z][A].f=N),A>t&&(O.c=A-u),p.push(O)}}let b=a.filter_select,g=a.filter,v=null;if(b!=null&&JSON.stringify(b)!="{}"){v={filter_select:null,filter:null};let T=b.row[0],O=b.row[1],z=b.column[0],A=b.column[1];if(e=="row"){if(T>t?(T-=u,O-=u,v.filter_select={row:[T,O],column:[z,A]}):T<n&&(O<n||(O<=t?O=n-1:O-=u),v.filter_select={row:[T,O],column:[z,A]}),v.filter_select!=null&&g!=null)for(let E in g){let L=g[E].rowhidden,N={};for(let W in L)W<n?N[W]=0:W>t&&(N[W-u]=0);JSON.stringify(N)!="{}"&&(v.filter==null&&(v.filter={}),v.filter[E]=$.extend(!0,{},g[E]),v.filter[E].rowhidden=N,v.filter[E].str=T,v.filter[E].edr=O)}}else if(e=="column"&&(z>t?(z-=u,A-=u,v.filter_select={row:[T,O],column:[z,A]}):z<n?(A<n||(A<=t?A=n-1:A-=u),v.filter_select={row:[T,O],column:[z,A]}):A>t&&(z=n,A-=u,v.filter_select={row:[T,O],column:[z,A]}),v.filter_select!=null&&g!=null))for(let E in g){let L=g[E].cindex;L<n?(v.filter==null&&(v.filter={}),v.filter[L-z]=$.extend(!0,{},g[E]),v.filter[L-z].edc=A):L>t&&(L-=u,v.filter==null&&(v.filter={}),v.filter[L-z]=$.extend(!0,{},g[E]),v.filter[L-z].cindex=L,v.filter[L-z].stc=z,v.filter[L-z].edc=A)}}if(v!=null&&v.filter!=null){f.rowhidden==null&&(f.rowhidden={});for(let T in v.filter){let O=v.filter[T].rowhidden;for(let z in O)f.rowhidden[z]=0}}let x=a.luckysheet_conditionformat_save,_=[];if(x!=null&&x.length>0)for(let T=0;T<x.length;T++){let O=x[T].cellrange,z=[];for(let A=0;A<O.length;A++){let E=O[A].row[0],L=O[A].row[1],N=O[A].column[0],W=O[A].column[1];e=="row"?E>=n&&L<=t||(E>t?(E-=u,L-=u):E<n?L<n||(L<=t?L=n-1:L-=u):L>t&&(E=n,L-=u),z.push({row:[E,L],column:[N,W]})):e=="column"&&(N>=n&&W<=t||(N>t?(N-=u,W-=u):N<n?W<n||(W<=t?W=n-1:W-=u):W>t&&(N=n,W-=u),z.push({row:[E,L],column:[N,W]})))}if(z.length>0){let A=$.extend(!0,{},x[T]);A.cellrange=z,_.push(A)}}let S=a.luckysheet_alternateformat_save,I=[];if(S!=null&&S.length>0)for(let T=0;T<S.length;T++){let O=S[T].cellrange.row[0],z=S[T].cellrange.row[1],A=S[T].cellrange.column[0],E=S[T].cellrange.column[1];if(e=="row"){if(!(O>=n&&z<=t)){let L=$.extend(!0,{},S[T]);O>t?(O-=u,z-=u):O<n?z<n||(z<=t?z=n-1:z-=u):z>t&&(O=n,z-=u),L.cellrange={row:[O,z],column:[A,E]},I.push(L)}}else if(e=="column"&&!(A>=n&&E<=t)){let L=$.extend(!0,{},S[T]);A>t?(A-=u,E-=u):A<n?E<n||(E<=t?E=n-1:E-=u):E>t&&(A=n,E-=u),L.cellrange={row:[O,z],column:[A,E]},I.push(L)}}let P={freezenhorizontaldata:null,freezenverticaldata:null};if(Ie.freezenhorizontaldata!=null&&e=="row"){let T=Ie.freezenhorizontaldata[2],O=$l(h.visibledatarow,T);O==-1&&(O=0);let z=Ie.freezenhorizontaldata[1]-1;z>=n&&(z<t?z=n-1:z-=u),z<O&&(z=O);let A=h.visibledatarow[z]-2-T+h.columnHeaderHeight;P.freezenhorizontaldata=[h.visibledatarow[z],z+1,T,Ie.cutVolumn(h.visibledatarow,z+1),A]}else P.freezenhorizontaldata=Ie.freezenhorizontaldata;if(Ie.freezenverticaldata!=null&&e=="column"){let T=Ie.freezenverticaldata[2],O=$l(h.visibledatacolumn,T);O==-1&&(O=0);let z=Ie.freezenverticaldata[1]-1;z>=n&&(z<t?z=n-1:z-=u),z<O&&(z=O);let A=h.visibledatacolumn[z]-2-T+h.rowHeaderWidth;P.freezenverticaldata=[h.visibledatacolumn[z],z+1,T,Ie.cutVolumn(h.visibledatacolumn,z+1),A]}else P.freezenverticaldata=Ie.freezenverticaldata;let F=a.dataVerification,D={};if(F!=null)for(let T in F){let O=Number(T.split("_")[0]),z=Number(T.split("_")[1]),A=F[T];e=="row"?O<n?D[O+"_"+z]=A:O>t&&(D[O-u+"_"+z]=A):e=="column"&&(z<n?D[O+"_"+z]=A:z>t&&(D[O+"_"+(z-u)]=A))}let k=a.hyperlink,w={};if(k!=null)for(let T in k){let O=Number(T.split("_")[0]),z=Number(T.split("_")[1]),A=k[T];e=="row"?O<n?w[O+"_"+z]=A:O>t&&(w[O-u+"_"+z]=A):e=="column"&&(z<n?w[O+"_"+z]=A:z>t&&(w[O+"_"+(z-u)]=A))}let C;if(e=="row"){C="r",f.rowlen==null&&(f.rowlen={});let T={};for(let z in f.rowlen)z<n?T[z]=f.rowlen[z]:z>t&&(T[z-u]=f.rowlen[z]);f.rowlen=T,f.rowhidden==null&&(f.rowhidden={});let O={};for(let z in f.rowhidden)z<n?O[z]=f.rowhidden[z]:z>t&&(O[z-u]=f.rowhidden[z]);if(f.rowhidden=O,f.borderInfo&&f.borderInfo.length>0){let z=[];for(let A=0;A<f.borderInfo.length;A++){let E=f.borderInfo[A].rangeType;if(E=="range"){let L=f.borderInfo[A].range,N=[];for(let W=0;W<L.length;W++){let X=L[W].row[0],te=L[W].row[1];for(let ue=n;ue<=t;ue++)ue<L[W].row[0]?(X-=1,te-=1):ue<=L[W].row[1]&&(te-=1);te>=X&&N.push({row:[X,te],column:L[W].column})}if(N.length>0){let W={rangeType:"range",borderType:f.borderInfo[A].borderType,style:f.borderInfo[A].style,color:f.borderInfo[A].color,range:N};z.push(W)}}else if(E=="cell"){let L=f.borderInfo[A].value.row_index;L<n?z.push(f.borderInfo[A]):L>t&&(f.borderInfo[A].value.row_index=L-(t-n+1),z.push(f.borderInfo[A]))}}f.borderInfo=z}s.splice(n,u);for(let z=0;z<u;z++){let A=[];for(let E=0;E<s[0].length;E++)A.push(null);s.push(A)}}else{C="c",f.columnlen==null&&(f.columnlen={});let T={};for(let A in f.columnlen)A<n?T[A]=f.columnlen[A]:A>t&&(T[A-u]=f.columnlen[A]);f.columnlen=T,f.colhidden==null&&(f.colhidden={});let O={};for(let A in f.colhidden)A<n?O[A]=f.colhidden[A]:A>t&&(O[A-u]=f.colhidden[A]);if(f.colhidden=O,f.borderInfo&&f.borderInfo.length>0){let A=[];for(let E=0;E<f.borderInfo.length;E++){let L=f.borderInfo[E].rangeType;if(L=="range"){let N=f.borderInfo[E].range,W=[];for(let X=0;X<N.length;X++){let te=N[X].column[0],ue=N[X].column[1];for(let pe=n;pe<=t;pe++)pe<N[X].column[0]?(te-=1,ue-=1):pe<=N[X].column[1]&&(ue-=1);ue>=te&&W.push({row:N[X].row,column:[te,ue]})}if(W.length>0){let X={rangeType:"range",borderType:f.borderInfo[E].borderType,style:f.borderInfo[E].style,color:f.borderInfo[E].color,range:W};A.push(X)}}else if(L=="cell"){let N=f.borderInfo[E].value.col_index;N<n?A.push(f.borderInfo[E]):N>t&&(f.borderInfo[E].value.col_index=N-(t-n+1),A.push(f.borderInfo[E]))}}f.borderInfo=A}let z=[];for(let A=0;A<u;A++)z.push(null);for(let A=0;A<s.length;A++){let E=[].concat(s[A]);E.splice(n,u),s[A]=E.concat(z)}}a.index==h.currentSheetIndex?Rs(s,f,"delRC",{index:n,len:t-n+1,rc:C},p,v,_,I,P,D,w):(a.data=s,a.config=f,a.calcChain=p,a.filter=v.filter,a.filter_select=v.filter_select,a.luckysheet_conditionformat_save=_,a.luckysheet_alternateformat_save=I,a.dataVerification=D,a.hyperlink=w)}function ac(e,n,t,l,o,a){if(a=a||h.currentSheetIndex,!ea(a))return;let s=Me(a),u=h.luckysheetfile[s],f=$.extend(!0,[],u.data),m=t-n+1,d=o-l+1,p=$.extend(!0,{},h.config);p.merge==null&&(p.merge={});let b={};for(let T in p.merge){let O=p.merge[T],z=O.r,A=O.c,E=O.rs,L=O.cs;if(e=="moveLeft")if(n>z+E-1||t<z||l>A+L-1)b[z+"_"+A]={r:z,c:A,rs:E,cs:L};else if(n<=z&&t>=z+E-1&&o<A)b[z+"_"+(A-d)]={r:z,c:A-d,rs:E,cs:L};else for(let N=z;N<=z+E-1;N++)for(let W=A;W<=A+L-1;W++)delete f[N][W].mc;else if(e=="moveUp")if(l>A+L-1||o<A||n>z+E-1)b[z+"_"+A]={r:z,c:A,rs:E,cs:L};else if(l<=A&&o>=A+L-1&&t<z)b[z-m+"_"+A]={r:z-m,c:A,rs:E,cs:L};else for(let N=z;N<=z+E-1;N++)for(let W=A;W<=A+L-1;W++)delete f[N][W].mc}p.merge=b;let g=u.calcChain,v=[];if(g!=null&&g.length>0)for(let T=0;T<g.length;T++){let O=$.extend(!0,{},g[T]),z=O.r,A=O.c,E=O.index,L=Ti(z,A,E);if(z<n||z>t||A<l||A>o){let N;e=="moveLeft"?(N="="+y.functionStrChange(L,"del","col",null,l,d),A>o&&z>=n&&z<=t&&(O.c=A-d)):e=="moveUp"&&(N="="+y.functionStrChange(L,"del","row",null,n,m),z>t&&A>=l&&A<=o&&(O.r=z-m)),f[z][A]&&f[z][A].f==L&&(f[z][A].f=N),v.push(O)}}let x=u.filter_select,_=u.filter,S=null;if(x!=null&&JSON.stringify(x)!="{}"){S={filter_select:null,filter:null};let T=x.row[0],O=x.row[1],z=x.column[0],A=x.column[1];if(e=="moveUp")if(z>=l&&A<=o){if(T>t?S.filter_select={row:[T-m,O-m],column:[z,A]}:O<n?S.filter_select={row:[T,O],column:[z,A]}:T<n&&(O>t?S.filter_select={row:[T,O-m],column:[z,A]}:S.filter_select={row:[T,n-1],column:[z,A]}),S.filter_select!=null&&_!=null)for(let E in _){let L=_[E].rowhidden,N={};for(let W in L)W<n?N[W]=0:W>t&&(N[W-slen]=0);S.filter==null&&(S.filter={}),S.filter[E]=$.extend(!0,{},_[E]),JSON.stringify(N)!="{}"&&(S.filter[E].rowhidden=N),S.filter[E].str=S.filter_select.row[0],S.filter[E].edr=S.filter_select.row[1]}}else if(T>=n&&O<=t){if(z>o?S.filter_select={row:[T,O],column:[z,A]}:z>=l?A>o&&(S.filter_select={row:[T,O],column:[l,A-d]}):A<l?S.filter_select={row:[T,O],column:[z,A]}:A<=o?S.filter_select={row:[T,O],column:[z,l-1]}:S.filter_select={row:[T,O],column:[z,A-d]},S.filter_select!=null&&_!=null)for(let E in _){let L=S.filter_select.column[0],N=S.filter_select.column[1],W=_[E].cindex;if(W<l||W>o){S.filter==null&&(S.filter={}),W>o&&(W-=d);let X=W-L;S.filter[X]=$.extend(!0,{},_[E]),S.filter[X].cindex=W,S.filter[X].stc=L,S.filter[X].edc=N}}}else S.filter_select={row:[T,O],column:[z,A]},_!=null&&(S.filter=_);else if(e=="moveLeft")if(T>=n&&O<=t){if(z>o?S.filter_select={row:[T,O],column:[z-d,A-d]}:A<l?S.filter_select={row:[T,O],column:[z,A]}:z<l&&(A>o?S.filter_select={row:[T,O],column:[z,A-d]}:S.filter_select={row:[T,O],column:[z,l-1]}),S.filter_select!=null&&_!=null)for(let E in _){let L=S.filter_select.column[0],N=S.filter_select.column[1],W=_[E].cindex;if(W<l||W>o){S.filter==null&&(S.filter={}),W>o&&(W-=d);let X=W-L;S.filter[X]=$.extend(!0,{},_[E]),S.filter[X].cindex=W,S.filter[X].stc=L,S.filter[X].edc=N}}}else z>=l&&A<=o?(T<n||T>t)&&(S.filter_select={row:[T,O],column:[z,A]},_!=null&&(S.filter=_)):(S.filter_select={row:[T,O],column:[z,A]},_!=null&&(S.filter=_))}if(S!=null&&S.filter!=null){p.rowhidden==null&&(p.rowhidden={});for(let T in S.filter){let O=S.filter[T].rowhidden;for(let z in O)p.rowhidden[z]=0}}let I=u.luckysheet_conditionformat_save,P=[];if(I!=null&&I.length>0)for(let T=0;T<I.length;T++){let O=I[T].cellrange,z=[];for(let A=0;A<O.length;A++){let E=O[A].row[0],L=O[A].row[1],N=O[A].column[0],W=O[A].column[1];n<=E&&t>=L&&l<=N&&o>=W||(z=Ny(e,n,t,l,o,E,L,N,W,m,d))}if(z.length>0){let A=$.extend(!0,{},I[T]);A.cellrange=z,P.push(A)}}let F=u.dataVerification,D={};if(F!=null)for(let T in F){let O=Number(T.split("_")[0]),z=Number(T.split("_")[1]),A=F[T];(O<n||O>t||z<l||z>o)&&(e=="moveLeft"?z>o&&O>=n&&O<=t?D[O+"_"+(z-d)]=A:D[O+"_"+z]=A:e=="moveUp"&&(O>t&&z>=l&&z<=o?D[O-m+"_"+z]=A:D[O+"_"+z]=A))}let k=u.hyperlink,w={};if(k!=null)for(let T in k){let O=Number(T.split("_")[0]),z=Number(T.split("_")[1]),A=k[T];(O<n||O>t||z<l||z>o)&&(e=="moveLeft"?z>o&&O>=n&&O<=t?w[O+"_"+(z-d)]=A:w[O+"_"+z]=A:e=="moveUp"&&(O>t&&z>=l&&z<=o?w[O-m+"_"+z]=A:w[O+"_"+z]=A))}if(p.borderInfo&&p.borderInfo.length>0){let T=[];for(let O=0;O<p.borderInfo.length;O++){let z=p.borderInfo[O].rangeType;if(z=="range"){let A=p.borderInfo[O].range,E=[];for(let L=0;L<A.length;L++){let N=A[L].row[0],W=A[L].row[1],X=A[L].column[0],te=A[L].column[1];n<=N&&t>=W&&l<=X&&o>=te||(E=Ny(e,n,t,l,o,N,W,X,te,m,d))}if(E.length>0){let L={rangeType:"range",borderType:p.borderInfo[O].borderType,style:p.borderInfo[O].style,color:p.borderInfo[O].color,range:E};T.push(L)}}else if(z=="cell"){let A=p.borderInfo[O].value.row_index,E=p.borderInfo[O].value.col_index;(A<n||A>t||E<l||E>o)&&(e=="moveLeft"?E>o&&A>=n&&A<=t&&(E-=d,p.borderInfo[O].value.col_index=E):e=="moveUp"&&A>t&&E>=l&&E<=o&&(A-=m,p.borderInfo[O].value.row_index=A),T.push(p.borderInfo[O]))}}p.borderInfo=T}let C=[];for(let T=l;T<=o;T++)C.push(null);if(e=="moveUp"){let T=[];for(let z=n;z<=f.length-1;z++){let A=[];for(let E=l;E<=o;E++)A.push(f[z][E]);T.push(A)}T.splice(0,m);let O=[];for(let z=n;z<=t;z++)O.push(C);T=T.concat(O);for(let z=n;z<=f.length-1;z++)for(let A=l;A<=o;A++)f[z][A]=T[z-n][A-l]}else if(e=="moveLeft")for(let T=n;T<=t;T++)f[T].splice(l,d),f[T]=f[T].concat(C);u.index==h.currentSheetIndex?nf(f,p,{type:e,str:n,edr:t,stc:l,edc:o},v,S,P,D,w):(u.data=f,u.config=p,u.calcChain=v,u.filter=S.filter,u.filter_select=S.filter_select,u.luckysheet_conditionformat_save=P,u.dataVerification=D,u.hyperlink=w)}function Ny(e,n,t,l,o,a,s,u,f,m,d){let p=[];if(e=="moveLeft"){if(n>s||t<a||l>f)p.push({row:[a,s],column:[u,f]});else if(o<u){if(n<=a&&t>=s)p.push({row:[a,s],column:[u-d,f-d]});else if(n>a&&t<s){let b=[{row:[a,n-1],column:[u,f]},{row:[t+1,s],column:[u,f]},{row:[n,t],column:[u-d,f-d]}];p=p.concat(b)}else if(n>a){let b=[{row:[a,n-1],column:[u,f]},{row:[n,s],column:[u-d,f-d]}];p=p.concat(b)}else if(t<s){let b=[{row:[a,t],column:[u-d,f-d]},{row:[t+1,s],column:[u,f]}];p=p.concat(b)}}else if(o>=u){if(l<=u&&o>=f){if(n>a&&t<s){let b=[{row:[a,n-1],column:[u,f]},{row:[t+1,s],column:[u,f]}];p=p.concat(b)}else if(n>a){let b=[{row:[a,n-1],column:[u,f]}];p=p.concat(b)}else if(t<s){let b=[{row:[t+1,s],column:[u,f]}];p=p.concat(b)}}else if(l>u&&o<f){if(n<=a&&t>=s)p.push({row:[a,s],column:[u,f-d]});else if(n>a&&t<s){let b=[{row:[a,n-1],column:[u,f]},{row:[t+1,s],column:[u,f]},{row:[n,t],column:[u,f-d]}];p=p.concat(b)}else if(n>a){let b=[{row:[a,n-1],column:[u,f]},{row:[n,s],column:[u,f-d]}];p=p.concat(b)}else if(t<s){let b=[{row:[a,t],column:[u,f-d]},{row:[t+1,s],column:[u,f]}];p=p.concat(b)}}else if(l>u){if(n<=a&&t>=s)p.push({row:[a,s],column:[u,l-1]});else if(n>a&&t<s){let b=[{row:[a,n-1],column:[u,f]},{row:[t+1,s],column:[u,f]},{row:[n,t],column:[u,l-1]}];p=p.concat(b)}else if(n>a){let b=[{row:[a,n-1],column:[u,f]},{row:[n,s],column:[u,l-1]}];p=p.concat(b)}else if(t<s){let b=[{row:[a,t],column:[u,l-1]},{row:[t+1,s],column:[u,f]}];p=p.concat(b)}}else if(o<f){if(n<=a&&t>=s)p.push({row:[a,s],column:[u-d,f-d]});else if(n>a&&t<s){let b=[{row:[a,n-1],column:[u,f]},{row:[t+1,s],column:[u,f]},{row:[n,t],column:[u-d,f-d]}];p=p.concat(b)}else if(n>a){let b=[{row:[a,n-1],column:[u,f]},{row:[n,s],column:[u-d,f-d]}];p=p.concat(b)}else if(t<s){let b=[{row:[a,t],column:[u-d,f-d]},{row:[t+1,s],column:[u,f]}];p=p.concat(b)}}}}else if(e=="moveUp"){if(l>f||o<u||n>s)p.push({row:[a,s],column:[u,f]});else if(t<a){if(l<=u&&o>=f)p.push({row:[a-m,s-m],column:[u,f]});else if(l>u&&o<f){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,f]},{row:[a-m,s-m],column:[l,o]}];p=p.concat(b)}else if(l>u){let b=[{row:[a,s],column:[u,l-1]},{row:[a-m,s-m],column:[l,f]}];p=p.concat(b)}else if(o<f){let b=[{row:[a-m,s-m],column:[u,o]},{row:[a,s],column:[o+1,f]}];p=p.concat(b)}}else if(t>=a){if(n<=a&&t>=s){if(l>u&&o<f){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,f]}];p=p.concat(b)}else if(l>u){let b=[{row:[a,s],column:[u,l-1]}];p=p.concat(b)}else if(o<f){let b=[{row:[a,s],column:[o+1,f]}];p=p.concat(b)}}else if(n>a&&t<s){if(l<=u&&o>=f)p.push({row:[a,s-m],column:[u,f]});else if(l>u&&o<f){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,f]},{row:[a,s-m],column:[l,o]}];p=p.concat(b)}else if(l>u){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s-m],column:[l,f]}];p=p.concat(b)}else if(o<f){let b=[{row:[a,s-m],column:[u,o]},{row:[a,s],column:[o+1,f]}];p=p.concat(b)}}else if(n>a){if(l<=u&&o>=f)p.push({row:[a,n-1],column:[u,f]});else if(l>u&&o<f){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,f]},{row:[a,n-1],column:[l,o]}];p=p.concat(b)}else if(l>u){let b=[{row:[a,s],column:[u,l-1]},{row:[a,n-1],column:[l,f]}];p=p.concat(b)}else if(o<f){let b=[{row:[a,n-1],column:[u,o]},{row:[a,s],column:[o+1,f]}];p=p.concat(b)}}else if(t<s){if(l<=u&&o>=f)p.push({row:[a-m,s-m],column:[u,f]});else if(l>u&&o<f){let b=[{row:[a,s],column:[u,l-1]},{row:[a,s],column:[o+1,f]},{row:[a-m,s-m],column:[l,o]}];p=p.concat(b)}else if(l>u){let b=[{row:[a,s],column:[u,l-1]},{row:[a-m,s-m],column:[l,f]}];p=p.concat(b)}else if(o<f){let b=[{row:[a-m,s-m],column:[u,o]},{row:[a,s],column:[o+1,f]}];p=p.concat(b)}}}}return p}var import_plugin,sc=Nt(()=>{import_plugin=qe(Ye());Wr();Sr();Ar();Er();Do();mo();Di();jr();Go();hi();fr();il()});function Pm(e,n,t,l,o){o==null&&(o=!0),h.visibledatarow=[],h.visibledatacolumn=[],h.ch_width=0,h.rh_height=0,h.zoomRatio=1,l!=null?h.config=l:h.config={},t.length==0?h.flowdata=cn(t,n,e):t.length<n&&t[0].length<e?h.flowdata=cn(t,n-t.length,e-t[0].length):t.length<n?h.flowdata=cn(t,n-t.length,0):t[0].length<e?h.flowdata=cn(t,0,e-t[0].length):h.flowdata=t,It.webWorkerFlowDataCache(h.flowdata),Xa(n,e),o&&(kt.showSheet(),setTimeout(function(){kt.restoreCache(),y.execFunctionGroup(),kt.restoreSheetAll(h.currentSheetIndex),Xt()},1))}var import_plugin,Ly=Nt(()=>{import_plugin=qe(Ye());Er();Wr();lf();Sr();Ar();kn();il()});var import_plugin,eu,Wx,sl,wi=Nt(()=>{import_plugin=qe(Ye());qr();Rr();kn();Sr();Qo();go();_a();Di();fr();sc();Vn();Wr();Ly();il();eu={defaultStore:{container:null,luckysheetfile:null,defaultcolumnNum:60,defaultrowNum:84,fullscreenmode:!0,devicePixelRatio:1,currentSheetIndex:0,calculateSheetIndex:0,flowdata:[],config:{},visibledatarow:[],visibledatacolumn:[],ch_width:0,rh_height:0,cellmainWidth:0,cellmainHeight:0,toolbarHeight:0,infobarHeight:0,calculatebarHeight:0,rowHeaderWidth:46,columnHeaderHeight:20,cellMainSrollBarSize:12,sheetBarHeight:31,statisticBarHeight:23,luckysheetTableContentHW:[0,0],defaultcollen:73,defaultrowlen:19,jfcountfuncTimeout:null,jfautoscrollTimeout:null,luckysheet_select_status:!1,luckysheet_select_save:[{row:[0,0],column:[0,0]}],luckysheet_selection_range:[],luckysheet_copy_save:{},luckysheet_paste_iscut:!1,filterchage:!0,luckysheet_filter_save:{row:[],column:[]},luckysheet_sheet_move_status:!1,luckysheet_sheet_move_data:[],luckysheet_scroll_status:!1,luckysheetisrefreshdetail:!0,luckysheetisrefreshtheme:!0,luckysheetcurrentisPivotTable:!1,luckysheet_rows_selected_status:!1,luckysheet_cols_selected_status:!1,luckysheet_rows_change_size:!1,luckysheet_rows_change_size_start:[],luckysheet_cols_change_size:!1,luckysheet_cols_change_size_start:[],luckysheet_cols_dbclick_timeout:null,luckysheet_cols_dbclick_times:0,luckysheetCellUpdate:[],luckysheet_shiftpositon:null,iscopyself:!0,orderbyindex:0,luckysheet_model_move_state:!1,luckysheet_model_xy:[0,0],luckysheet_model_move_obj:null,luckysheet_cell_selected_move:!1,luckysheet_cell_selected_move_index:[],luckysheet_cell_selected_extend:!1,luckysheet_cell_selected_extend_index:[],luckysheet_cell_selected_extend_time:null,clearjfundo:!0,jfredo:[],jfundo:[],lang:"en",createChart:"",highlightChart:"",zIndex:15,chartparam:{luckysheetCurrentChart:null,luckysheetCurrentChartActive:!1,luckysheetCurrentChartMove:null,luckysheetCurrentChartMoveTimeout:null,luckysheetCurrentChartMoveObj:null,luckysheetCurrentChartMoveXy:null,luckysheetCurrentChartMoveWinH:null,luckysheetCurrentChartMoveWinW:null,luckysheetCurrentChartResize:null,luckysheetCurrentChartResizeObj:null,luckysheetCurrentChartResizeXy:null,luckysheetCurrentChartResizeWinH:null,luckysheetCurrentChartResizeWinW:null,luckysheetInsertChartTosheetChange:!0,luckysheetCurrentChartZIndexRank:100,luckysheet_chart_redo_click:!1,luckysheetCurrentChartMaxState:!1,jfrefreshchartall:"",changeChartCellData:"",renderChart:"",getChartJson:""},functionList:null,luckysheet_function:null,chart_selection:{},currentChart:"",scrollRefreshSwitch:!0,measureTextCache:{},measureTextCellInfoCache:{},measureTextCacheTimeOut:null,cellOverflowMapCache:{},zoomRatio:1,visibledatacolumn_unique:null,visibledatarow_unique:null,showGridLines:!0,toobarObject:{},inlineStringEditCache:null,inlineStringEditRange:null,fontList:[],currentSheetView:"viewNormal"},defaultFormula:{searchFunctionCell:null,functionlistPosition:{},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangedrag_column_start:!1,rangedrag_row_start:!1,rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,functionHTMLIndex:0,functionRangeIndex:null,execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},cellTextToIndexList:{},isFunctionRangeSave:!1,execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},formulaContainCellList:{},cellTextToIndexList:{},execFunctionGlobalData:{},groupValuesRefreshData:[],functionResizeData:{},functionResizeStatus:!1,functionResizeTimeout:null,data_parm_index:0},defaultSheet:{sheetMaxIndex:0,nulldata:null,mergeCalculationSheet:{},checkLoadSheetIndexToDataIndex:{},CacheNotLoadControll:[]},defaultPivotTable:{pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,luckysheet_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},drawPivotTable:!0,pivotTableBoundary:[12,6]},defaultImage:{imgItem:{type:"3",src:"",originWidth:null,originHeight:null,default:{width:null,height:null,left:null,top:null},crop:{width:null,height:null,offsetLeft:0,offsetTop:0},isFixedPos:!1,fixedLeft:null,fixedTop:null,border:{width:0,radius:0,style:"solid",color:"#000"}},images:null,currentImgId:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,cropChange:null,cropChangeXY:null,cropChangeObj:null,copyImgItemObj:null},defaultDataVerification:{defaultItem:{type:"dropdown",type2:null,value1:"",value2:"",checked:!1,remote:!1,prohibitInput:!1,hintShow:!1,hintText:""},curItem:null,dataVerification:null,selectRange:[],selectStatus:!1}},Wx={addDataAjax:function(e,n,t,l){let o=this;n==null&&(n=h.currentSheetIndex),t==null&&(t=Ue.loadSheetUrl),$("#luckysheet-grid-window-1").append(Wo()),e.currentPage++;let a="application/json;charset=UTF-8",s=sessionStorage.getItem("x-auth-token");$.ajax({method:"POST",url:t,headers:{"x-auth-token":s},data:JSON.stringify(e),contentType:a,success:function(u){typeof u=="string"&&(u=JSON.parse(u));let f=u.data,m=f.celldata;xh(f.row,m),setTimeout(function(){h.loadingObj.close()},500),l&&typeof l=="function"&&l(f)}})},reload:function(e,n,t,l){let o=this;n==null&&(n=h.currentSheetIndex),t==null&&(t=Ue.loadSheetUrl),$("#luckysheet-grid-window-1").append(Wo());let a={gridKey:Ue.gridKey,index:n};e=$.extend(!0,e,a);let s=h.luckysheetfile[Me(n)];$.post(t,e,function(u){let f=new Function("return "+u)();s.celldata=f[n.toString()];let m=kt.buildGridData(s);setTimeout(function(){h.loadingObj.close()},500),s.data=m,h.flowdata=m,It.webWorkerFlowDataCache(m),Pm(m[0].length,m.length,m,null,!1),s.load="1",h.luckysheet_select_save.length=0,h.luckysheet_selection_range=[],Ue.saveParam("shs",null,h.currentSheetIndex),kt.changeSheet(n),l&&typeof l=="function"&&l()})},clearSheetByIndex:function(e){let n=Me(e),t=h.luckysheetfile[n];t.isPivotTable?delete h.luckysheetfile[n]:(t.data=[],t.row=h.defaultrowNum,t.column=h.defaultcolumnNum,t.chart=[],t.config=null,t.filter=null,t.filter_select=null,t.celldata=[],t.pivotTable={},t.calcChain=[],t.status=0,t.load=0,h.flowdata=[],It.webWorkerFlowDataCache(h.flowdata),$("#"+h.container+" .luckysheet-data-visualization-chart").remove(),$("#"+h.container+" .luckysheet-datavisual-selection-set").remove(),$("#luckysheet-row-count-show, #luckysheet-formula-functionrange-select, #luckysheet-row-count-show, #luckysheet-column-count-show, #luckysheet-change-size-line, #luckysheet-cell-selected-focus, #luckysheet-selection-copy, #luckysheet-cell-selected-extend, #luckysheet-cell-selected-move, #luckysheet-cell-selected").hide(),delete t.load)},clear:function(e){let n=this;if(e=="all")for(let t=0;t<h.luckysheetfile.length;t++){let l=h.luckysheetfile[t];n.clearSheetByIndex(l.index)}else e==null&&(e=h.currentSheetIndex),n.clearSheetByIndex(e);kt.changeSheet(h.luckysheetfile[0].index)},destroy:function(){$("#"+h.container).empty(),$("body > .luckysheet-cols-menu").remove(),$("#luckysheet-modal-dialog-mask, #luckysheetTextSizeTest, #luckysheet-icon-morebtn-div").remove(),$("#luckysheet-input-box").parent().remove(),$("#luckysheet-formula-help-c").remove(),$(".chartSetting, .luckysheet-modal-dialog-slider").remove(),$(document).off(".luckysheetEvent"),$(document).off(".luckysheetProtection"),Ie.initialHorizontal=!0,Ie.initialVertical=!0;let e=$.extend(!0,{},eu.defaultStore);for(let s in e)s in h&&(h[s]=e[s]);let n=$.extend(!0,{},eu.defaultFormula);for(let s in n)s in y&&(y[s]=n[s]);let t=$.extend(!0,{},eu.defaultSheet);for(let s in t)s in kt&&(kt[s]=t[s]);let l=$.extend(!0,{},eu.defaultPivotTable);for(let s in l)s in Yt&&(Yt[s]=l[s]);let o=$.extend(!0,{},eu.defaultImage);for(let s in o)s in Pt&&(Pt[s]=o[s]);let a=$.extend(!0,{},eu.defaultDataVerification);for(let s in a)s in ll&&(ll[s]=a[s]);h.asyncLoad=["core"]},editorChart:function(e){let n=Pi[0],t="luckysheetEditMode-datav-chart",l=t+"_selection";e.chart_id=t;let o=e.chartTheme;o=o??"default0000",luckysheet.insertChartTosheet(e.sheetIndex,e.dataSheetIndex,e.option,e.chartType,e.selfOption,e.defaultOption,e.row,e.column,n,t,l,e.chartStyle,e.rangeConfigCheck,e.rangeRowCheck,e.rangeColCheck,e.chartMarkConfig,e.chartTitleConfig,e.winWidth,e.winHeight,e.scrollLeft,e.scrollTop,o,e.myWidth,e.myHeight,e.myLeft!=null?parseFloat(e.myLeft):null,e.myTop!=null?parseFloat(e.myTop):null,e.myindexrank,!0),$("#"+t).find(".luckysheet-modal-controll-update").click()},createHookFunction:function(){let e=arguments[0];if(ut.hook&&ut.hook[e]!=null&&typeof ut.hook[e]=="function"){var n=Array.prototype.slice.apply(arguments);return n.shift(),ut.hook[e].apply(this,n)!==!1}return!0}},sl=Wx});var import_plugin,qx,Zt,ta=Nt(()=>{import_plugin=qe(Ye());Ri();Wr();Sr();Ga();Ar();gs();fr();Ol();Di();ln();hi();qr();il();wi();qx={defaultWidth:144,defaultHeight:84,currentObj:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,init:function(){let e=this;$("#luckysheet-postil-showBoxs").off("mousedown.showPs").on("mousedown.showPs",".luckysheet-postil-show",function(n){if(!!nr(h.currentSheetIndex,"editObjects",!1)){if(e.currentObj=$(this).find(".luckysheet-postil-show-main"),$(this).hasClass("luckysheet-postil-show-active")){n.stopPropagation();return}e.removeActivePs(),$(this).addClass("luckysheet-postil-show-active"),$(this).find(".luckysheet-postil-dialog-resize").show(),$(this).find(".arrowCanvas").css("z-index",200),$(this).find(".luckysheet-postil-show-main").css("z-index",200),n.stopPropagation()}}),$("#luckysheet-postil-showBoxs").off("mouseup.showPs").on("mouseup.showPs",".luckysheet-postil-show",function(n){n.which=="3"&&n.stopPropagation()}),$("#luckysheet-postil-showBoxs").off("mousedown.resize").on("mousedown.resize",".luckysheet-postil-show .luckysheet-postil-dialog-resize .luckysheet-postil-dialog-resize-item",function(n){if(!nr(h.currentSheetIndex,"editObjects",!1))return;e.currentObj=$(this).closest(".luckysheet-postil-show-main"),e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.resize=$(this).data("type");let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=wl(n.pageX,n.pageY),a=o[0]+l,s=o[1]+t,u=e.currentObj.position(),f=e.currentObj.width(),m=e.currentObj.height();if(e.resizeXY=[a,s,f,m,u.left+l,u.top+t,l,t],pa(!0),$(this).closest(".luckysheet-postil-show").hasClass("luckysheet-postil-show-active")){n.stopPropagation();return}e.removeActivePs(),$(this).closest(".luckysheet-postil-show").addClass("luckysheet-postil-show-active"),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-dialog-resize").show(),$(this).closest(".luckysheet-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-show-main").css("z-index",200),n.stopPropagation()}),$("#luckysheet-postil-showBoxs").off("mousedown.move").on("mousedown.move",".luckysheet-postil-show .luckysheet-postil-dialog-move .luckysheet-postil-dialog-move-item",function(n){if(!nr(h.currentSheetIndex,"editObjects",!1))return;e.currentObj=$(this).closest(".luckysheet-postil-show-main"),e.currentWinW=$("#luckysheet-cell-main")[0].scrollWidth,e.currentWinH=$("#luckysheet-cell-main")[0].scrollHeight,e.move=!0;let t=$("#luckysheet-cell-main").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=e.currentObj.offset(),a=e.currentObj.position();if(e.moveXY=[n.pageX-o.left,n.pageY-o.top,a.left,a.top,l,t],pa(!0),$(this).closest(".luckysheet-postil-show").hasClass("luckysheet-postil-show-active")){n.stopPropagation();return}e.removeActivePs(),$(this).closest(".luckysheet-postil-show").addClass("luckysheet-postil-show-active"),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-dialog-resize").show(),$(this).closest(".luckysheet-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".luckysheet-postil-show").find(".luckysheet-postil-show-main").css("z-index",200),n.stopPropagation()})},overshow:function(e){let n=this;if($("#luckysheet-postil-overshow").remove(),$(e.target).closest("#luckysheet-cell-main").length==0)return;let t=wl(e.pageX,e.pageY),l=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").scrollTop(),a=t[0],s=t[1],u=0,f=0;Ie.freezenverticaldata!=null&&t[0]<Ie.freezenverticaldata[0]-Ie.freezenverticaldata[2]?u=l:a+=l,Ie.freezenhorizontaldata!=null&&t[1]<Ie.freezenhorizontaldata[0]-Ie.freezenhorizontaldata[2]?f=o:s+=o;let m=Jl(s)[2],d=Zl(a)[2],p=_t.mergeborer(h.flowdata,m,d);if(p&&(m=p.row[2],d=p.column[2]),h.flowdata[m]==null||h.flowdata[m][d]==null||h.flowdata[m][d].ps==null)return;let b=h.flowdata[m][d].ps;if(b.isshow||$("#luckysheet-postil-show_"+m+"_"+d).length>0)return;let g=b.value==null?"":b.value,v=h.visibledatarow[m],x=m-1==-1?0:h.visibledatarow[m-1],_=h.visibledatacolumn[d],S=d-1==-1?0:h.visibledatacolumn[d-1];p&&(v=p.row[1],x=p.row[0],_=p.column[1],S=p.column[0]);let I=_+u,P=x+f,F=I+18*h.zoomRatio,D=P-18*h.zoomRatio;D<0&&(D=2);let k=b.width==null?n.defaultWidth*h.zoomRatio:b.width*h.zoomRatio,w=b.height==null?n.defaultHeight*h.zoomRatio:b.height*h.zoomRatio,C=n.getArrowCanvasSize(F,D,I,P),T="",O=g.split(`
`);for(let E of O)T+="<div>"+n.htmlEscape(E)+"</div>";let z='<div id="luckysheet-postil-overshow"><canvas class="arrowCanvas" width="'+C[2]+'" height="'+C[3]+'" style="position:absolute;left:'+C[0]+"px;top:"+C[1]+'px;z-index:100;pointer-events:none;"></canvas><div style="width:'+(k-12)+"px;min-height:"+(w-12)+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+F+"px;top:"+D+'px;z-index:100;">'+T+"</div></div>";$(z).appendTo($("#luckysheet-cell-main"));let A=$("#luckysheet-postil-overshow .arrowCanvas").get(0).getContext("2d");n.drawArrow(A,C[4],C[5],C[6],C[7])},getArrowCanvasSize:function(e,n,t,l){let o=t-5;e<t&&(o=e-5);let a=l-5;n<l&&(a=n-5);let s=Math.abs(e-t)+10,u=Math.abs(n-l)+10,f=s-5,m=5;e<t&&(f=5,m=s-5);let d=u-5,p=5;return n<l&&(d=5,p=u-5),[o,a,s,u,f,d,m,p]},drawArrow:function(e,n,t,l,o,a,s,u,f){a=G(a)=="undefined"?30:a,s=G(s)=="undefined"?6:s,u=G(u)=="undefined"?1:u,f=G(f)=="undefined"?"#000":f;let m=Math.atan2(t-o,n-l)*180/Math.PI,d=(m+a)*Math.PI/180,p=(m-a)*Math.PI/180,b=s*Math.cos(d),g=s*Math.sin(d),v=s*Math.cos(p),x=s*Math.sin(p);e.save(),e.beginPath();let _=n-b,S=t-g;e.moveTo(_,S),e.moveTo(n,t),e.lineTo(l,o),e.lineWidth=u,e.strokeStyle=f,e.stroke(),_=l+b,S=o+g,e.moveTo(_,S),e.lineTo(l,o),_=l+v,S=o+x,e.lineTo(_,S),e.fillStyle=f,e.fill(),e.restore()},buildAllPs:function(e){let n=this;$("#luckysheet-cell-main #luckysheet-postil-showBoxs").empty();for(let t=0;t<e.length;t++)for(let l=0;l<e[0].length;l++)if(e[t][l]!=null&&e[t][l].ps!=null){let o=e[t][l].ps;n.buildPs(t,l,o)}n.init()},buildPs:function(e,n,t){if($("#luckysheet-postil-show_"+e+"_"+n).length>0&&$("#luckysheet-postil-show_"+e+"_"+n).remove(),t==null)return;let l=this;if(t.isshow==null?!1:t.isshow){let a=h.visibledatarow[e],s=e-1==-1?0:h.visibledatarow[e-1],u=h.visibledatacolumn[n],f=n-1==-1?0:h.visibledatacolumn[n-1],m=_t.mergeborer(h.flowdata,e,n);m&&(a=m.row[1],s=m.row[0],u=m.column[1],f=m.column[0]);let d=u,p=s,b=t.left==null?d+18*h.zoomRatio:t.left*h.zoomRatio,g=t.top==null?p-18*h.zoomRatio:t.top*h.zoomRatio,v=t.width==null?l.defaultWidth*h.zoomRatio:t.width*h.zoomRatio,x=t.height==null?l.defaultHeight*h.zoomRatio:t.height*h.zoomRatio,_=t.value==null?"":t.value;g<0&&(g=2);let S=l.getArrowCanvasSize(b,g,d,p),I="",P=_.split(`
`);for(let k of P)I+="<div>"+l.htmlEscape(k)+"</div>";let F='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+S[2]+'" height="'+S[3]+'" style="position:absolute;left:'+S[0]+"px;top:"+S[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+v+"px;height:"+x+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+b+"px;top:"+g+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(v-12)+"px;height:"+(x-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+I+"</div></div></div></div>";$(F).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let D=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");l.drawArrow(D,S[4],S[5],S[6],S[7])}},newPs:function(e,n){if(!nr(h.currentSheetIndex,"editObjects")||!sl.createHookFunction("commentInsertBefore",e,n))return;let t=this,l=h.visibledatarow[e],o=e-1==-1?0:h.visibledatarow[e-1],a=h.visibledatacolumn[n],s=n-1==-1?0:h.visibledatacolumn[n-1],u=_t.mergeborer(h.flowdata,e,n);u&&(l=u.row[1],o=u.row[0],a=u.column[1],s=u.column[0]);let f=a,m=o,d=f+18*h.zoomRatio,p=m-18*h.zoomRatio;p<0&&(p=2);let b=t.defaultWidth*h.zoomRatio,g=t.defaultHeight*h.zoomRatio,v=t.getArrowCanvasSize(d,p,f,m),x='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show luckysheet-postil-show-active"><canvas class="arrowCanvas" width="'+v[2]+'" height="'+v[3]+'" style="position:absolute;left:'+v[0]+"px;top:"+v[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+b+"px;height:"+g+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+d+"px;top:"+p+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:132px;height:72px;line-height:20px;box-sizing:border-box;text-align: center;word-break:break-all;" spellcheck="false" contenteditable="true"></div></div></div></div>';$(x).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let _=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");t.drawArrow(_,v[4],v[5],v[6],v[7]),$("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").focus(),t.init();let S=It.deepCopyFlowData(h.flowdata),I=[];S[e][n]==null&&(S[e][n]={}),S[e][n].ps={left:null,top:null,width:null,height:null,value:"",isshow:!1},I.push(e+"_"+n),t.ref(S,I),setTimeout(()=>{sl.createHookFunction("commentInsertAfter",e,n,S[e][n])},0)},editPs:function(e,n){let t=this;if(!!nr(h.currentSheetIndex,"editObjects")){if($("#luckysheet-postil-show_"+e+"_"+n).length>0)$("#luckysheet-postil-show_"+e+"_"+n).show(),$("#luckysheet-postil-show_"+e+"_"+n).addClass("luckysheet-postil-show-active"),$("#luckysheet-postil-show_"+e+"_"+n).find(".luckysheet-postil-dialog-resize").show();else{let l=h.flowdata[e][n].ps,o=h.visibledatarow[e],a=e-1==-1?0:h.visibledatarow[e-1],s=h.visibledatacolumn[n],u=n-1==-1?0:h.visibledatacolumn[n-1],f=_t.mergeborer(h.flowdata,e,n);f&&(o=f.row[1],a=f.row[0],s=f.column[1],u=f.column[0]);let m=s,d=a,p=l.left==null?m+18*h.zoomRatio:l.left*h.zoomRatio,b=l.top==null?d-18*h.zoomRatio:l.top*h.zoomRatio,g=l.width==null?t.defaultWidth*h.zoomRatio:l.width*h.zoomRatio,v=l.height==null?t.defaultHeight*h.zoomRatio:l.height*h.zoomRatio,x=l.value==null?"":l.value;b<0&&(b=2);let _=t.getArrowCanvasSize(p,b,m,d),S="",I=x.split(`
`);for(let D of I)S+="<div>"+t.htmlEscape(D)+"</div>";let P='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show luckysheet-postil-show-active"><canvas class="arrowCanvas" width="'+_[2]+'" height="'+_[3]+'" style="position:absolute;left:'+_[0]+"px;top:"+_[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+g+"px;height:"+v+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+p+"px;top:"+b+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(g-12)+"px;height:"+(v-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+S+"</div></div></div></div>";$(P).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let F=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");t.drawArrow(F,_[4],_[5],_[6],_[7])}$("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").focus(),To($("#luckysheet-postil-show_"+e+"_"+n+" .formulaInputFocus").get(0)),t.init()}},delPs:function(e,n){if(!nr(h.currentSheetIndex,"editObjects")||!sl.createHookFunction("commentDeleteBefore",e,n,h.flowdata[e][n]))return;$("#luckysheet-postil-show_"+e+"_"+n).length>0&&$("#luckysheet-postil-show_"+e+"_"+n).remove();let t=It.deepCopyFlowData(h.flowdata),l=[];delete t[e][n].ps,l.push(e+"_"+n),this.ref(t,l),setTimeout(()=>{sl.createHookFunction("commentDeleteAfter",e,n,h.flowdata[e][n])},0)},showHidePs:function(e,n){let t=this,l=h.flowdata[e][n].ps,o=l.isshow,a=It.deepCopyFlowData(h.flowdata),s=[];if(o)a[e][n].ps.isshow=!1,$("#luckysheet-postil-show_"+e+"_"+n).remove();else{a[e][n].ps.isshow=!0;let u=h.visibledatarow[e],f=e-1==-1?0:h.visibledatarow[e-1],m=h.visibledatacolumn[n],d=n-1==-1?0:h.visibledatacolumn[n-1],p=_t.mergeborer(h.flowdata,e,n);p&&(u=p.row[1],f=p.row[0],m=p.column[1],d=p.column[0]);let b=$("#luckysheet-cell-main").scrollLeft(),g=$("#luckysheet-cell-main").scrollTop(),v=m,x=f;Ie.freezenverticaldata!=null&&v<Ie.freezenverticaldata[0]-Ie.freezenverticaldata[2]&&(v+=b),Ie.freezenhorizontaldata!=null&&x<Ie.freezenhorizontaldata[0]-Ie.freezenhorizontaldata[2]&&(x+=g);let _=l.left==null?v+18*h.zoomRatio:l.left*h.zoomRatio,S=l.top==null?x-18*h.zoomRatio:l.top*h.zoomRatio,I=l.width==null?t.defaultWidth*h.zoomRatio:l.width*h.zoomRatio,P=l.height==null?t.defaultHeight*h.zoomRatio:l.height*h.zoomRatio,F=l.value==null?"":l.value;S<0&&(S=2);let D=t.getArrowCanvasSize(_,S,v,x),k="",w=F.split(`
`);for(let O of w)k+="<div>"+t.htmlEscape(O)+"</div>";let C='<div id="luckysheet-postil-show_'+e+"_"+n+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+D[2]+'" height="'+D[3]+'" style="position:absolute;left:'+D[0]+"px;top:"+D[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+I+"px;height:"+P+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+_+"px;top:"+S+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(I-12)+"px;height:"+(P-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+k+"</div></div></div></div>";$(C).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let T=$("#luckysheet-postil-show_"+e+"_"+n+" .arrowCanvas").get(0).getContext("2d");t.drawArrow(T,D[4],D[5],D[6],D[7]),t.init()}s.push(e+"_"+n),t.ref(a,s)},showHideAllPs:function(){let e=this,n=It.deepCopyFlowData(h.flowdata),t=!0,l=[];for(let a=0;a<n.length;a++)for(let s=0;s<n[0].length;s++)n[a]!=null&&n[a][s]!=null&&n[a][s].ps!=null&&(l.push(a+"_"+s),n[a][s].ps.isshow||(t=!1));let o=[];if(l.length>0)if(t){$("#luckysheet-cell-main #luckysheet-postil-showBoxs").empty();for(let a=0;a<l.length;a++){let s=l[a].split("_")[0],u=l[a].split("_")[1];n[s][u].ps.isshow&&(n[s][u].ps.isshow=!1,o.push(l[a]))}}else for(let a=0;a<l.length;a++){let s=l[a].split("_")[0],u=l[a].split("_")[1],f=n[s][u].ps;if(!f.isshow){let m=h.visibledatarow[s],d=s-1==-1?0:h.visibledatarow[s-1],p=h.visibledatacolumn[u],b=u-1==-1?0:h.visibledatacolumn[u-1],g=_t.mergeborer(h.flowdata,s,u);g&&(m=g.row[1],d=g.row[0],p=g.column[1],b=g.column[0]);let v=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),_=p,S=d;Ie.freezenverticaldata!=null&&_<Ie.freezenverticaldata[0]-Ie.freezenverticaldata[2]&&(_+=v),Ie.freezenhorizontaldata!=null&&S<Ie.freezenhorizontaldata[0]-Ie.freezenhorizontaldata[2]&&(S+=x);let I=f.left==null?_+18*h.zoomRatio:f.left*h.zoomRatio,P=f.top==null?S-18*h.zoomRatio:f.top*h.zoomRatio,F=f.width==null?e.defaultWidth*h.zoomRatio:f.width*h.zoomRatio,D=f.height==null?e.defaultHeight*h.zoomRatio:f.height*h.zoomRatio,k=f.value==null?"":f.value;P<0&&(P=2);let w=e.getArrowCanvasSize(I,P,_,S),C="",T=k.split(`
`);for(let A of T)C+="<div>"+e.htmlEscape(A)+"</div>";let O='<div id="luckysheet-postil-show_'+s+"_"+u+'" class="luckysheet-postil-show"><canvas class="arrowCanvas" width="'+w[2]+'" height="'+w[3]+'" style="position:absolute;left:'+w[0]+"px;top:"+w[1]+'px;z-index:100;pointer-events:none;"></canvas><div class="luckysheet-postil-show-main" style="width:'+F+"px;height:"+D+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+I+"px;top:"+P+'px;box-sizing:border-box;z-index:100;"><div class="luckysheet-postil-dialog-move"><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-t" data-type="t"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-r" data-type="r"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-b" data-type="b"></div><div class="luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-l" data-type="l"></div></div><div class="luckysheet-postil-dialog-resize" style="display:none;"><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lt" data-type="lt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mt" data-type="mt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lm" data-type="lm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rm" data-type="rm"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rt" data-type="rt"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-lb" data-type="lb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-mb" data-type="mb"></div><div class="luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(F-12)+"px;height:"+(D-12)+'px;line-height:20px;box-sizing:border-box;text-align: center;;word-break:break-all;" spellcheck="false" contenteditable="true">'+C+"</div></div></div></div>";$(O).appendTo($("#luckysheet-cell-main #luckysheet-postil-showBoxs"));let z=$("#luckysheet-postil-show_"+s+"_"+u+" .arrowCanvas").get(0).getContext("2d");e.drawArrow(z,w[4],w[5],w[6],w[7]),n[s][u].ps.isshow=!0,o.push(l[a])}}e.ref(n,o),e.init()},removeActivePs:function(){if($("#luckysheet-postil-showBoxs .luckysheet-postil-show-active").length>0){let e=$("#luckysheet-postil-showBoxs .luckysheet-postil-show-active").attr("id"),n=e.split("luckysheet-postil-show_")[1].split("_")[0],t=e.split("luckysheet-postil-show_")[1].split("_")[1],l=$("#"+e).find(".formulaInputFocus").html().replaceAll("<div>",`
`).replaceAll(/<(.*)>.*?|<(.*) \/>/g,"").trim();if(!sl.createHookFunction("commentUpdateBefore",n,t,l)){h.flowdata[n][t].ps.isshow||$("#"+e).remove();return}let o=$.extend(!0,{},h.flowdata[n][t]);$("#"+e).removeClass("luckysheet-postil-show-active"),$("#"+e).find(".luckysheet-postil-dialog-resize").hide(),$("#"+e).find(".arrowCanvas").css("z-index",100),$("#"+e).find(".luckysheet-postil-show-main").css("z-index",100);let a=It.deepCopyFlowData(h.flowdata),s=[];a[n][t].ps.value=l,s.push(n+"_"+t),this.ref(a,s),a[n][t].ps.isshow||$("#"+e).remove(),setTimeout(()=>{sl.createHookFunction("commentUpdateAfter",n,t,o,a[n][t])},0)}},ref:function(e,n){if(h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"postil",data:h.flowdata,curdata:e,sheetIndex:h.currentSheetIndex,rc:n})),h.flowdata=e,It.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[Me(h.currentSheetIndex)].data=h.flowdata,Ue.allowUpdate)for(let t=0;t<n.length;t++){let l=n[t].split("_")[0],o=n[t].split("_")[1];Ue.saveParam("v",h.currentSheetIndex,h.flowdata[l][o],{r:l,c:o})}setTimeout(function(){Xt()},1)},positionSync:function(){let e=this;$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(n,t){let l=$(t).attr("id"),o=l.split("luckysheet-postil-show_")[1].split("_")[0],a=l.split("luckysheet-postil-show_")[1].split("_")[1],s=h.flowdata[o][a];s!=null&&s.ps!=null?e.buildPs(o,a,s.ps):$("#"+l).hide()})},htmlEscape:function(e){return e.replace(/[<>"&]/g,function(n,t,l){switch(console.log(n,t,l),n){case"<":return"&lt";case">":return"&gt";case"&":return"&amp";case'"':return"&quot;"}})}},Zt=qx});function Em(e,n,t,l,o){let a={},s,u;o==null?(s=h.config,u=h.flowdata):(s=h.luckysheetfile[Me(o)].config,u=h.luckysheetfile[Me(o)].data);let f=s.borderInfo;if(f!=null&&f.length>0)for(let m=0;m<f.length;m++){let d=f[m].rangeType;if(d=="range"){let p=f[m].borderType,b=f[m].color,g=f[m].style,v=f[m].range;for(let x=0;x<v.length;x++){let _=v[x].row[0],S=v[x].row[1],I=v[x].column[0],P=v[x].column[1];if(_<e&&(_=e),S>n&&(S=n),I<t&&(I=t),P>l&&(P=l),p=="border-left")for(let F=_;F<=S;F++){if(s.rowhidden!=null&&s.rowhidden[F]!=null)continue;a[F+"_"+I]==null&&(a[F+"_"+I]={}),a[F+"_"+I].l={color:b,style:g};let D=I-1;if(D>=0&&a[F+"_"+D])if(u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null){let w=u[F][D],C=s.merge[w.mc.r+"_"+w.mc.c];C.c+C.cs-1==D&&(a[F+"_"+D].r={color:b,style:g})}else a[F+"_"+D].r={color:b,style:g};let k=s.merge||{};for(let w in k){let{c:C,r:T,cs:O,rs:z}=k[w];I<=C+O-1&&I>C&&F>=T&&F<=T+z-1&&(a[F+"_"+I].l=null)}}else if(p=="border-right")for(let F=_;F<=S;F++){if(s.rowhidden!=null&&s.rowhidden[F]!=null)continue;a[F+"_"+P]==null&&(a[F+"_"+P]={}),a[F+"_"+P].r={color:b,style:g};let D=P+1;if(D<u[0].length&&a[F+"_"+D])if(u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null){let w=u[F][D];s.merge[w.mc.r+"_"+w.mc.c].c==D&&(a[F+"_"+D].l={color:b,style:g})}else a[F+"_"+D].l={color:b,style:g};let k=s.merge||{};for(let w in k){let{c:C,r:T,cs:O,rs:z}=k[w];P<C+O-1&&P>=C&&F>=T&&F<=T+z-1&&(a[F+"_"+P].r=null)}}else if(p=="border-top"){if(s.rowhidden!=null&&s.rowhidden[_]!=null)continue;for(let F=I;F<=P;F++){a[_+"_"+F]==null&&(a[_+"_"+F]={}),a[_+"_"+F].t={color:b,style:g};let D=_-1;if(D>=0&&a[D+"_"+F])if(u[D]!=null&&G(u[D][F])=="object"&&u[D][F].mc!=null){let w=u[D][F],C=s.merge[w.mc.r+"_"+w.mc.c];C.r+C.rs-1==D&&(a[D+"_"+F].b={color:b,style:g})}else a[D+"_"+F].b={color:b,style:g};let k=s.merge||{};for(let w in k){let{c:C,r:T,cs:O,rs:z}=k[w];_<=T+z-1&&_>T&&F>=C&&F<=C+O-1&&(a[_+"_"+F].t=null)}}}else if(p=="border-bottom"){if(s.rowhidden!=null&&s.rowhidden[S]!=null)continue;for(let F=I;F<=P;F++){a[S+"_"+F]==null&&(a[S+"_"+F]={}),a[S+"_"+F].b={color:b,style:g};let D=S+1;if(D<u.length&&a[D+"_"+F])if(u[D]!=null&&G(u[D][F])=="object"&&u[D][F].mc!=null){let w=u[D][F];s.merge[w.mc.r+"_"+w.mc.c].r==D&&(a[D+"_"+F].t={color:b,style:g})}else a[D+"_"+F].t={color:b,style:g};let k=s.merge||{};for(let w in k){let{c:C,r:T,cs:O,rs:z}=k[w];S<T+z-1&&S>=T&&F>=C&&F<=C+O-1&&(a[S+"_"+F].b=null)}}}else if(p=="border-all"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null))for(let D=I;D<=P;D++){if(u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.r==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:g}),w.r+w.rs-1==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:g}),w.c==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g}),w.c+w.cs-1==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:g})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g},a[F+"_"+D].r={color:b,style:g},a[F+"_"+D].t={color:b,style:g},a[F+"_"+D].b={color:b,style:g};if(F==_){let k=_-1;if(k>=0&&a[k+"_"+D])if(u[k]!=null&&G(u[k][D])=="object"&&u[k][D].mc!=null){let w=u[k][D],C=s.merge[w.mc.r+"_"+w.mc.c];C.r+C.rs-1==k&&(a[k+"_"+D].b={color:b,style:g})}else a[k+"_"+D].b={color:b,style:g}}if(F==S){let k=S+1;if(k<u.length&&a[k+"_"+D])if(u[k]!=null&&G(u[k][D])=="object"&&u[k][D].mc!=null){let w=u[k][D];s.merge[w.mc.r+"_"+w.mc.c].r==k&&(a[k+"_"+D].t={color:b,style:g})}else a[k+"_"+D].t={color:b,style:g}}if(D==I){let k=I-1;if(k>=0&&a[F+"_"+k])if(u[F]!=null&&G(u[F][k])=="object"&&u[F][k].mc!=null){let w=u[F][k],C=s.merge[w.mc.r+"_"+w.mc.c];C.c+C.cs-1==k&&(a[F+"_"+k].r={color:b,style:g})}else a[F+"_"+k].r={color:b,style:g}}if(D==P){let k=P+1;if(k<u[0].length&&a[F+"_"+k])if(u[F]!=null&&G(u[F][k])=="object"&&u[F][k].mc!=null){let w=u[F][k];s.merge[w.mc.r+"_"+w.mc.c].c==k&&(a[F+"_"+k].l={color:b,style:g})}else a[F+"_"+k].l={color:b,style:g}}}}else if(p=="border-outside"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null)){for(let D=I;D<=P;D++)if(F==_||F==S||D==I||D==P){if(F==_){a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:g};let k=_-1;if(k>=0&&a[k+"_"+D])if(u[k]!=null&&G(u[k][D])=="object"&&u[k][D].mc!=null){let w=u[k][D],C=s.merge[w.mc.r+"_"+w.mc.c];C.r+C.rs-1==k&&(a[k+"_"+D].b={color:b,style:g})}else a[k+"_"+D].b={color:b,style:g}}if(F==S){a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:g};let k=S+1;if(k<u.length&&a[k+"_"+D])if(u[k]!=null&&G(u[k][D])=="object"&&u[k][D].mc!=null){let w=u[k][D];s.merge[w.mc.r+"_"+w.mc.c].r==k&&(a[k+"_"+D].t={color:b,style:g})}else a[k+"_"+D].t={color:b,style:g}}if(D==I){a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g};let k=I-1;if(k>=0&&a[F+"_"+k])if(u[F]!=null&&G(u[F][k])=="object"&&u[F][k].mc!=null){let w=u[F][k],C=s.merge[w.mc.r+"_"+w.mc.c];C.c+C.cs-1==k&&(a[F+"_"+k].r={color:b,style:g})}else a[F+"_"+k].r={color:b,style:g}}if(D==P){a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:g};let k=P+1;if(k<u[0].length&&a[F+"_"+k])if(u[F]!=null&&G(u[F][k])=="object"&&u[F][k].mc!=null){let w=u[F][k];s.merge[w.mc.r+"_"+w.mc.c].c==k&&(a[F+"_"+k].l={color:b,style:g})}else a[F+"_"+k].l={color:b,style:g}}}}}else if(p=="border-inside"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null))for(let D=I;D<=P;D++)if(F==_&&D==I)u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:g},a[F+"_"+D].b={color:b,style:g});else if(F==S&&D==I)u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:g},a[F+"_"+D].t={color:b,style:g});else if(F==_&&D==P)u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g},a[F+"_"+D].b={color:b,style:g});else if(F==S&&D==P)u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g},a[F+"_"+D].t={color:b,style:g});else if(F==_)if(u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.c==D?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g}):w.c+w.cs-1==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:g})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g},a[F+"_"+D].r={color:b,style:g},a[F+"_"+D].b={color:b,style:g};else if(F==S)if(u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.c==D?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g}):w.c+w.cs-1==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:g})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g},a[F+"_"+D].r={color:b,style:g},a[F+"_"+D].t={color:b,style:g};else if(D==I)if(u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.r==F?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:g}):w.r+w.rs-1==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:g})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:g},a[F+"_"+D].t={color:b,style:g},a[F+"_"+D].b={color:b,style:g};else if(D==P)if(u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.r==F?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:g}):w.r+w.rs-1==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:g})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g},a[F+"_"+D].t={color:b,style:g},a[F+"_"+D].b={color:b,style:g};else if(u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.r==F?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:g}):w.r+w.rs-1==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:g}),w.c==D?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g}):w.c+w.cs-1==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:g})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g},a[F+"_"+D].r={color:b,style:g},a[F+"_"+D].t={color:b,style:g},a[F+"_"+D].b={color:b,style:g}}else if(p=="border-horizontal"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null))for(let D=I;D<=P;D++)if(F==_)u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:g});else if(F==S)u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:g});else if(u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c];w.r==F?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:g}):w.r+w.rs-1==F&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].b={color:b,style:g})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].t={color:b,style:g},a[F+"_"+D].b={color:b,style:g}}else if(p=="border-vertical"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null))for(let D=I;D<=P;D++)if(D==I)u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:g});else if(D==P)u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null||(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g});else if(u[F]!=null&&G(u[F][D])=="object"&&u[F][D].mc!=null){let k=u[F][D],w=s.merge[k.mc.r+"_"+k.mc.c]||{};w.c==D?(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g}):w.c+w.cs-1==D&&(a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].r={color:b,style:g})}else a[F+"_"+D]==null&&(a[F+"_"+D]={}),a[F+"_"+D].l={color:b,style:g},a[F+"_"+D].r={color:b,style:g}}else if(p=="border-none"){for(let F=_;F<=S;F++)if(!(s.rowhidden!=null&&s.rowhidden[F]!=null))for(let D=I;D<=P;D++){if(a[F+"_"+D]!=null&&delete a[F+"_"+D],F==_){let k=_-1;k>=0&&a[k+"_"+D]&&delete a[k+"_"+D].b}if(F==S){let k=S+1;k<u.length&&a[k+"_"+D]&&delete a[k+"_"+D].t}if(D==I){let k=I-1;k>=0&&a[F+"_"+k]&&delete a[F+"_"+k].r}if(D==P){let k=P+1;k<u[0].length&&a[F+"_"+k]&&delete a[F+"_"+k].l}}}}}else if(d=="cell"){let p=f[m].value,b=p.row_index,g=p.col_index;if(b<e||b>n||g<t||g>l||s.rowhidden!=null&&s.rowhidden[b]!=null)continue;if(p.l!=null||p.r!=null||p.t!=null||p.b!=null)if(a[b+"_"+g]==null&&(a[b+"_"+g]={}),u[b]!=null&&G(u[b][g])=="object"&&u[b][g].mc!=null){let v=u[b][g],x=s.merge[v.mc.r+"_"+v.mc.c]||{};if(p.l!=null&&g==x.c){a[b+"_"+g].l={color:p.l.color,style:p.l.style};let _=g-1;if(_>=0&&a[b+"_"+_])if(u[b]!=null&&G(u[b][_])=="object"&&u[b][_].mc!=null){let S=u[b][_],I=s.merge[S.mc.r+"_"+S.mc.c];I.c+I.cs-1==_&&(a[b+"_"+_].r={color:p.l.color,style:p.l.style})}else a[b+"_"+_].r={color:p.l.color,style:p.l.style}}else a[b+"_"+g].l=null;if(p.r!=null&&g==x.c+x.cs-1){a[b+"_"+g].r={color:p.r.color,style:p.r.style};let _=g+1;if(_<u[0].length&&a[b+"_"+_])if(u[b]!=null&&G(u[b][_])=="object"&&u[b][_].mc!=null){let S=u[b][_];s.merge[S.mc.r+"_"+S.mc.c].c==_&&(a[b+"_"+_].l={color:p.r.color,style:p.r.style})}else a[b+"_"+_].l={color:p.r.color,style:p.r.style}}else a[b+"_"+g].r=null;if(p.t!=null&&b==x.r){a[b+"_"+g].t={color:p.t.color,style:p.t.style};let _=b-1;if(_>=0&&a[_+"_"+g])if(u[_]!=null&&G(u[_][g])=="object"&&u[_][g].mc!=null){let S=u[_][g],I=s.merge[S.mc.r+"_"+S.mc.c];I.r+I.rs-1==_&&(a[_+"_"+g].b={color:p.t.color,style:p.t.style})}else a[_+"_"+g].b={color:p.t.color,style:p.t.style}}else a[b+"_"+g].t=null;if(p.b!=null&&b==x.r+x.rs-1){a[b+"_"+g].b={color:p.b.color,style:p.b.style};let _=b+1;if(_<u.length&&a[_+"_"+g])if(u[_]!=null&&G(u[_][g])=="object"&&u[_][g].mc!=null){let S=u[_][g];s.merge[S.mc.r+"_"+S.mc.c].r==_&&(a[_+"_"+g].t={color:p.b.color,style:p.b.style})}else a[_+"_"+g].t={color:p.b.color,style:p.b.style}}else a[b+"_"+g].b=null}else{if(p.l!=null){a[b+"_"+g].l={color:p.l.color,style:p.l.style};let v=g-1;if(v>=0&&a[b+"_"+v])if(u[b]!=null&&G(u[b][v])=="object"&&u[b][v].mc!=null){let x=u[b][v],_=s.merge[x.mc.r+"_"+x.mc.c];_.c+_.cs-1==v&&(a[b+"_"+v].r={color:p.l.color,style:p.l.style})}else a[b+"_"+v].r={color:p.l.color,style:p.l.style}}else a[b+"_"+g].l=null;if(p.r!=null){a[b+"_"+g].r={color:p.r.color,style:p.r.style};let v=g+1;if(v<u[0].length&&a[b+"_"+v])if(u[b]!=null&&G(u[b][v])=="object"&&u[b][v].mc!=null){let x=u[b][v];s.merge[x.mc.r+"_"+x.mc.c].c==v&&(a[b+"_"+v].l={color:p.r.color,style:p.r.style})}else a[b+"_"+v].l={color:p.r.color,style:p.r.style}}else a[b+"_"+g].r=null;if(p.t!=null){a[b+"_"+g].t={color:p.t.color,style:p.t.style};let v=b-1;if(v>=0&&a[v+"_"+g])if(u[v]!=null&&G(u[v][g])=="object"&&u[v][g].mc!=null){let x=u[v][g],_=s.merge[x.mc.r+"_"+x.mc.c];_.r+_.rs-1==v&&(a[v+"_"+g].b={color:p.t.color,style:p.t.style})}else a[v+"_"+g].b={color:p.t.color,style:p.t.style}}else a[b+"_"+g].t=null;if(p.b!=null){a[b+"_"+g].b={color:p.b.color,style:p.b.style};let v=b+1;if(v<u.length&&a[v+"_"+g])if(u[v]!=null&&G(u[v][g])=="object"&&u[v][g].mc!=null){let x=u[v][g];s.merge[x.mc.r+"_"+x.mc.c].r==v&&(a[v+"_"+g].t={color:p.b.color,style:p.b.style})}else a[v+"_"+g].t={color:p.b.color,style:p.b.style}}else a[b+"_"+g].b=null}else delete a[b+"_"+g]}}return a}function la(e){let n={},t,l;return e==null?(t=h.config,l=h.flowdata):(t=h.luckysheetfile[Me(e)].config,l=h.luckysheetfile[Me(e)].data),n=Em(0,l.length,0,l[0].length,e),n}var import_plugin,tu=Nt(()=>{import_plugin=qe(Ye());fr();Ol();il()});var import_plugin,zt,Ux,Qr,Nm=Nt(()=>{import_plugin=qe(Ye());Ri();Xc();tu();cr();ui();Ar();Wr();Sr();mo();hi();jr();fr();Ol();il();Xl();zt=qe(Za()),Ux={iconHtml:'<div id="luckysheet-dropCell-icon" style="position: absolute;padding: 2px;background-color: #f1f1f1;z-index: 990;cursor: pointer;"><div id="icon_dropCell"></div></div>',typeListHtml:'<div id="luckysheet-dropCell-typeList" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="0"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${copyCell}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="1"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${sequence}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="2"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${onlyFormat}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="3"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${noFormat}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="4"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${day}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="5"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${workDay}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="6"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${month}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="7"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${year}</div></div><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" data-type="8"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span>${chineseNumber}</div></div></div>',copyRange:{},applyRange:{},applyType:null,direction:null,chnNumChar:{\u96F6:0,\u4E00:1,\u4E8C:2,\u4E09:3,\u56DB:4,\u4E94:5,\u516D:6,\u4E03:7,\u516B:8,\u4E5D:9},chnNameValue:{\u5341:{value:10,secUnit:!1},\u767E:{value:100,secUnit:!1},\u5343:{value:1e3,secUnit:!1},\u4E07:{value:1e4,secUnit:!0},\u4EBF:{value:1e8,secUnit:!0}},ChineseToNumber:function(e){let n=this,t=0,l=0,o=0,a=!1,s=e.split("");for(let u=0;u<s.length;u++){let f=n.chnNumChar[s[u]];if(typeof f!="undefined")o=f,u==s.length-1&&(l+=o);else{let m=n.chnNameValue[s[u]].value;a=n.chnNameValue[s[u]].secUnit,a?(l=(l+o)*m,t+=l,l=0):l+=o*m,o=0}}return t+l},chnNumChar2:["\u96F6","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D"],chnUnitSection:["","\u4E07","\u4EBF","\u4E07\u4EBF","\u4EBF\u4EBF"],chnUnitChar:["","\u5341","\u767E","\u5343"],SectionToChinese:function(e){let n=this,t="",l="",o=0,a=!0;for(;e>0;){let s=e%10;s==0?a||(a=!0,l=n.chnNumChar2[s]+l):(a=!1,t=n.chnNumChar2[s],t+=n.chnUnitChar[o],l=t+l),o++,e=Math.floor(e/10)}return l},NumberToChinese:function(e){let n=this,t=0,l="",o="",a=!1;if(e==0)return n.chnNumChar2[0];for(;e>0;){let s=e%1e4;a&&(o=n.chnNumChar2[0]+o),l=n.SectionToChinese(s),l+=s!=0?n.chnUnitSection[t]:n.chnUnitSection[0],o=l+o,a=s<1e3&&s>0,e=Math.floor(e/1e4),t++}return o},isChnNumber:function(e){let n=this,t=!0;if(e.length==1)e=="\u65E5"||e in n.chnNumChar?t=!0:t=!1;else{let l=e.split("");for(let o=0;o<l.length;o++)if(!(l[o]in n.chnNumChar||l[o]in n.chnNameValue)){t=!1;break}}return t},isExtendNumber:function(e){let n=/0|([1-9]+[0-9]*)/g,t=n.test(e);if(t){let l=e.match(n),o=l[l.length-1],a=e.lastIndexOf(o),s=e.substr(0,a),u=e.substr(a+o.length);return[t,Number(o),s,u]}else return[t]},isChnWeek1:function(e){let n=this,t;return e.length==1&&(e=="\u65E5"||n.ChineseToNumber(e)<7)?t=!0:t=!1,t},isChnWeek2:function(e){let n;return e.length==2&&(e=="\u5468\u4E00"||e=="\u5468\u4E8C"||e=="\u5468\u4E09"||e=="\u5468\u56DB"||e=="\u5468\u4E94"||e=="\u5468\u516D"||e=="\u5468\u65E5")?n=!0:n=!1,n},isChnWeek3:function(e){let n;return e.length==3&&(e=="\u661F\u671F\u4E00"||e=="\u661F\u671F\u4E8C"||e=="\u661F\u671F\u4E09"||e=="\u661F\u671F\u56DB"||e=="\u661F\u671F\u4E94"||e=="\u661F\u671F\u516D"||e=="\u661F\u671F\u65E5")?n=!0:n=!1,n},createIcon:function(){let e=this,n=e.copyRange.row[1],t=e.copyRange.column[1],l=e.applyRange.row[1],o=e.applyRange.column[1],a,s;l>=n&&o>=t?(a=l,s=o):(a=n,s=t);let u=Zr(a)[1],f=Zr(a)[0],m=or(s)[1],d=or(s)[0];$("#luckysheet-dropCell-icon").remove(),$("#luckysheet-cell-main").append(e.iconHtml),$("#luckysheet-dropCell-icon").css({left:m,top:u}),$("#luckysheet-dropCell-icon").mouseover(function(){$(this).css("background-color","#ffe8e8")}).mouseleave(function(){$(this).css("background-color","#f1f1f1")}).mousedown(function(p){$("#luckysheet-dropCell-typeList").remove();let g=Be().dropCell;$("body").first().append(Tt(e.typeListHtml,{copyCell:g.copyCell,sequence:g.sequence,onlyFormat:g.onlyFormat,noFormat:g.noFormat,day:g.day,workDay:g.workDay,month:g.month,year:g.year,chineseNumber:g.chineseNumber}));let v=e.typeItemHide();!v[0]&&!v[1]&&!v[2]&&!v[3]&&!v[4]&&!v[5]&&!v[6]&&($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=1]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide()),v[2]||($("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=4]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=5]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=6]").hide(),$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=7]").hide()),v[3]||$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type=8]").hide();let x=$(this).offset().left,_=$(this).offset().top+25,S=$(window).height(),I=$(window).width(),P=$("#luckysheet-dropCell-typeList").width(),F=$("#luckysheet-dropCell-typeList").height();x+P>I&&(x=x-P),_+F>S&&(_=_-F-38),_<0&&(_=0),$("#luckysheet-dropCell-typeList").css({left:x,top:_}).show(),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#ffe8e8")});let D=e.applyType;$("#luckysheet-dropCell-typeList .luckysheet-cols-menuitem[data-type="+D+"]").find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'),p.stopPropagation()}),$(document).off("click.dCtypeList").on("click.dCtypeList","#luckysheet-dropCell-typeList .luckysheet-cols-menuitem",function(){$("#luckysheet-dropCell-typeList .fa-check").remove(),$(this).find("span").append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>');let p=$(this).attr("data-type");e.applyType=p,e.update(),$("#luckysheet-dropCell-typeList").hide(),$("#luckysheet-dropCell-icon").css("backgroundColor","#f1f1f1"),$("#luckysheet-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#f1f1f1")}),Nn()})},typeItemHide:function(){let e=this,n=e.copyRange,t=n.row[0],l=n.row[1],o=n.column[0],a=n.column[1],s=!1,u=!1,f=!1,m=!1,d=!1,p=!1,b=!1;for(let g=t;g<=l;g++)for(let v=o;v<=a;v++)if(h.flowdata[g][v]){let x=h.flowdata[g][v];G(x)=="object"&&x.v!=null&&x.f==null&&(x.ct!=null&&x.ct.t=="n"?s=!0:x.ct!=null&&x.ct.t=="d"?f=!0:e.isExtendNumber(x.m)[0]?u=!0:e.isChnNumber(x.m)&&x.m!="\u65E5"?m=!0:x.m=="\u65E5"?d=!0:e.isChnWeek2(x.m)?p=!0:e.isChnWeek3(x.m)&&(b=!0))}return[s,u,f,m,d,p,b]},update:function(){let e=this;if(!po([e.applyRange],h.currentSheetIndex)||h.allowEdit===!1)return;let n=It.deepCopyFlowData(h.flowdata),t=h.luckysheetfile[Me(h.currentSheetIndex)],l=$.extend(!0,{},h.config),o=la(),a=$.extend(!0,{},t.dataVerification),s=e.direction,u=e.applyType,f=e.copyRange,m=f.row[0],d=f.row[1],p=f.column[0],b=f.column[1],g=e.getCopyData(n,m,d,p,b,s),v;s=="down"||s=="up"?v=d-m+1:(s=="right"||s=="left")&&(v=b-p+1);let x=e.applyRange,_=x.row[0],S=x.row[1],I=x.column[0],P=x.column[1];if(s=="down"||s=="up"){let k=S-_+1;for(let w=I;w<=P;w++){let C=g[w-I],T=e.getApplyData(C,v,k);if(s=="down")for(let O=_;O<=S;O++){let z=T[O-_];if(z.f!=null){let L="="+y.functionCopy(z.f,"down",O-_+1),N=y.execfunction(L,O,w);if(y.execFunctionGroup(O,w,N[1],void 0,n),z.f=N[2],z.v=N[1],z.spl!=null)z.spl=N[3].data;else if(K(z.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(z.v)){if(z.v==Infinity||z.v==-Infinity)z.m=z.v.toString();else if(z.v.toString().indexOf("e")>-1){let W=z.v.toString().split(".")[1].split("e")[0].length;W>5&&(W=5),z.m=z.v.toExponential(W).toString()}else{let W;z.ct.fa==="##0.00"?(W=_l(Math.round(z.v*1e9)/1e9+".00"),z.m=W[0].toString()):(W=_l(Math.round(z.v*1e9)/1e9),z.m=W[0].toString())}z.ct=z.ct||{fa:"General",t:"n"}}else{let W=_l(z.v);z.m=W[0].toString(),z.ct=W[1]}}n[O][w]=z;let A=m+(O-_)%v,E=w;if(o[A+"_"+E]){let L={rangeType:"cell",value:{row_index:O,col_index:w,l:o[A+"_"+E].l,r:o[A+"_"+E].r,t:o[A+"_"+E].t,b:o[A+"_"+E].b}};l.borderInfo.push(L)}else if(o[O+"_"+w]){let L={rangeType:"cell",value:{row_index:O,col_index:w,l:null,r:null,t:null,b:null}};l.borderInfo.push(L)}a[A+"_"+E]&&(a[O+"_"+w]=a[A+"_"+E])}if(s=="up")for(let O=S;O>=_;O--){let z=T[S-O];if(z.f!=null){let L="="+y.functionCopy(z.f,"up",S-O+1),N=y.execfunction(L,O,w);if(y.execFunctionGroup(O,w,N[1],void 0,n),z.f=N[2],z.v=N[1],z.spl!=null)z.spl=N[3].data;else if(K(z.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(z.v)){if(z.v==Infinity||z.v==-Infinity)z.m=z.v.toString();else if(z.v.toString().indexOf("e")>-1){let W=z.v.toString().split(".")[1].split("e")[0].length;W>5&&(W=5),z.m=z.v.toExponential(W).toString()}else{let W=_l(Math.round(z.v*1e9)/1e9);z.m=W[0].toString()}z.ct={fa:"General",t:"n"}}else{let W=_l(z.v);z.m=W[0].toString(),z.ct=W[1]}}n[O][w]=z;let A=d-(S-O)%v,E=w;if(o[A+"_"+E]){let L={rangeType:"cell",value:{row_index:O,col_index:w,l:o[A+"_"+E].l,r:o[A+"_"+E].r,t:o[A+"_"+E].t,b:o[A+"_"+E].b}};l.borderInfo.push(L)}else if(o[O+"_"+w]){let L={rangeType:"cell",value:{row_index:O,col_index:w,l:null,r:null,t:null,b:null}};l.borderInfo.push(L)}a[A+"_"+E]&&(a[O+"_"+w]=a[A+"_"+E])}}}else if(s=="right"||s=="left"){let k=P-I+1;for(let w=_;w<=S;w++){let C=g[w-_],T=e.getApplyData(C,v,k);if(s=="right")for(let O=I;O<=P;O++){let z=T[O-I];if(z.f!=null){let L="="+y.functionCopy(z.f,"right",O-I+1),N=y.execfunction(L,w,O);if(y.execFunctionGroup(w,O,N[1],void 0,n),z.f=N[2],z.v=N[1],z.spl!=null)z.spl=N[3].data;else if(K(z.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(z.v)){if(z.v==Infinity||z.v==-Infinity)z.m=z.v.toString();else if(z.v.toString().indexOf("e")>-1){let W=z.v.toString().split(".")[1].split("e")[0].length;W>5&&(W=5),z.m=z.v.toExponential(W).toString()}else{let W=_l(Math.round(z.v*1e9)/1e9);z.m=W[0].toString()}z.ct={fa:"General",t:"n"}}else{let W=_l(z.v);z.m=W[0].toString(),z.ct=W[1]}}n[w][O]=z;let A=w,E=p+(O-I)%v;if(o[A+"_"+E]){let L={rangeType:"cell",value:{row_index:w,col_index:O,l:o[A+"_"+E].l,r:o[A+"_"+E].r,t:o[A+"_"+E].t,b:o[A+"_"+E].b}};l.borderInfo.push(L)}else if(o[w+"_"+O]){let L={rangeType:"cell",value:{row_index:w,col_index:O,l:null,r:null,t:null,b:null}};l.borderInfo.push(L)}a[A+"_"+E]&&(a[w+"_"+O]=a[A+"_"+E])}if(s=="left")for(let O=P;O>=I;O--){let z=T[P-O];if(z.f!=null){let L="="+y.functionCopy(z.f,"left",P-O+1),N=y.execfunction(L,w,O);if(y.execFunctionGroup(w,O,N[1],void 0,n),z.f=N[2],z.v=N[1],z.spl!=null)z.spl=N[3].data;else if(K(z.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(z.v)){if(z.v==Infinity||z.v==-Infinity)z.m=z.v.toString();else if(z.v.toString().indexOf("e")>-1){let W=z.v.toString().split(".")[1].split("e")[0].length;W>5&&(W=5),z.m=z.v.toExponential(W).toString()}else{let W=_l(Math.round(z.v*1e9)/1e9);z.m=W[0].toString()}z.ct={fa:"General",t:"n"}}else{let W=_l(z.v);z.m=W[0].toString(),z.ct=W[1]}}n[w][O]=z;let A=w,E=b-(P-O)%v;if(o[A+"_"+E]){let L={rangeType:"cell",value:{row_index:w,col_index:O,l:o[A+"_"+E].l,r:o[A+"_"+E].r,t:o[A+"_"+E].t,b:o[A+"_"+E].b}};l.borderInfo.push(L)}else if(o[w+"_"+O]){let L={rangeType:"cell",value:{row_index:w,col_index:O,l:null,r:null,t:null,b:null}};l.borderInfo.push(L)}a[A+"_"+E]&&(a[w+"_"+O]=a[A+"_"+E])}}}let F=$.extend(!0,[],t.luckysheet_conditionformat_save);if(F!=null&&F.length>0)for(let k=0;k<F.length;k++){let w=F[k].cellrange,C=[];for(let T=0;T<w.length;T++){let O=Mt.CFSplitRange(w[T],{row:f.row,column:f.column},{row:x.row,column:x.column},"operatePart");O.length>0&&(C=C.concat(O))}C.length>0&&F[k].cellrange.push(x)}let D={cfg:l,cdformat:F,dataVerification:a};al(n,h.luckysheet_select_save,D),gl()},getCopyData:function(e,n,t,l,o,a){let s=this,u=[],f,m,d,p;a=="down"||a=="up"?(f=l,m=o,d=n,p=t):(a=="right"||a=="left")&&(f=n,m=t,d=l,p=o);for(let b=f;b<=m;b++){let g={},v=[],x=[],_="",S=null,I=null,P=!0;for(let F=d;F<=p;F++){let D;a=="down"||a=="up"?D=e[F][b]:(a=="right"||a=="left")&&(D=e[b][F]);let k;if(!!D&&!!D.v&&D.f==null)if(!!D.ct&&D.ct.t=="n")k="number",S=null,I=null;else if(!!D.ct&&D.ct.t=="d")k="date",S=null,I=null;else if(s.isExtendNumber(D.m)[0]){k="extendNumber";let w=s.isExtendNumber(D.m);S==null||I==null?(P=!0,S=w[2],I=w[3]):w[2]!=S||w[3]!=I?(P=!1,S=w[2],I=w[3]):P=!0}else s.isChnNumber(D.m)?(k="chnNumber",S=null,I=null):s.isChnWeek2(D.m)?(k="chnWeek2",S=null,I=null):s.isChnWeek3(D.m)?(k="chnWeek3",S=null,I=null):(k="other",S=null,I=null);else k="other",S=null,I=null;k=="extendNumber"?F==d?d==p?(_=k,v.push(D),x.push(F-d+1),g[_]=[],g[_].push({data:v,index:x})):(_=k,v.push(D),x.push(F-d+1)):F==p?_==k&&P?(v.push(D),x.push(F-d+1),_ in g?g[_].push({data:v,index:x}):(g[_]=[],g[_].push({data:v,index:x}))):(_ in g?g[_].push({data:v,index:x}):(g[_]=[],g[_].push({data:v,index:x})),_=k,v=[],v.push(D),x=[],x.push(F-d+1),_ in g?g[_].push({data:v,index:x}):(g[_]=[],g[_].push({data:v,index:x}))):_==k&&P?(v.push(D),x.push(F-d+1)):(_ in g?g[_].push({data:v,index:x}):(g[_]=[],g[_].push({data:v,index:x})),_=k,v=[],v.push(D),x=[],x.push(F-d+1)):F==d?d==p?(_=k,v.push(D),x.push(F-d+1),g[_]=[],g[_].push({data:v,index:x})):(_=k,v.push(D),x.push(F-d+1)):F==p?_==k?(v.push(D),x.push(F-d+1),_ in g?g[_].push({data:v,index:x}):(g[_]=[],g[_].push({data:v,index:x}))):(_ in g?g[_].push({data:v,index:x}):(g[_]=[],g[_].push({data:v,index:x})),_=k,v=[],v.push(D),x=[],x.push(F-d+1),_ in g?g[_].push({data:v,index:x}):(g[_]=[],g[_].push({data:v,index:x}))):_==k?(v.push(D),x.push(F-d+1)):(_ in g?g[_].push({data:v,index:x}):(g[_]=[],g[_].push({data:v,index:x})),_=k,v=[],v.push(D),x=[],x.push(F-d+1))}u.push(g)}return u},getApplyData:function(e,n,t){let l=this,o=[],a=l.direction,s=l.applyType,u=Math.floor(t/n),f=t%n,m=e.number,d=[];if(m)for(let w=0;w<m.length;w++){let C=l.getLenS(m[w].index,f),T=m[w].index.length*u+C,O;s=="1"||s=="3"?O=l.getDataByType(m[w].data,T,a,s,"number"):s=="2"?O=l.getDataByType(m[w].data,T,a,s):O=l.getDataByType(m[w].data,T,a,"0");let z=l.getDataIndex(n,t,m[w].index);d.push({data:O,index:z})}let p=e.extendNumber,b=[];if(p)for(let w=0;w<p.length;w++){let C=l.getLenS(p[w].index,f),T=p[w].index.length*u+C,O;s=="1"||s=="3"?O=l.getDataByType(p[w].data,T,a,s,"extendNumber"):s=="2"?O=l.getDataByType(p[w].data,T,a,s):O=l.getDataByType(p[w].data,T,a,"0");let z=l.getDataIndex(n,t,p[w].index);b.push({data:O,index:z})}let g=e.date,v=[];if(g)for(let w=0;w<g.length;w++){let C=l.getLenS(g[w].index,f),T=g[w].index.length*u+C,O;s=="1"||s=="3"?O=l.getDataByType(g[w].data,T,a,s,"date"):s=="8"?O=l.getDataByType(g[w].data,T,a,"0"):O=l.getDataByType(g[w].data,T,a,s);let z=l.getDataIndex(n,t,g[w].index);v.push({data:O,index:z})}let x=e.chnNumber,_=[];if(x)for(let w=0;w<x.length;w++){let C=l.getLenS(x[w].index,f),T=x[w].index.length*u+C,O;s=="1"||s=="3"?O=l.getDataByType(x[w].data,T,a,s,"chnNumber"):s=="2"||s=="8"?O=l.getDataByType(x[w].data,T,a,s):O=l.getDataByType(x[w].data,T,a,"0");let z=l.getDataIndex(n,t,x[w].index);_.push({data:O,index:z})}let S=e.chnWeek2,I=[];if(S)for(let w=0;w<S.length;w++){let C=l.getLenS(S[w].index,f),T=S[w].index.length*u+C,O;s=="1"||s=="3"?O=l.getDataByType(S[w].data,T,a,s,"chnWeek2"):s=="2"?O=l.getDataByType(S[w].data,T,a,s):O=l.getDataByType(S[w].data,T,a,"0");let z=l.getDataIndex(n,t,S[w].index);I.push({data:O,index:z})}let P=e.chnWeek3,F=[];if(P)for(let w=0;w<P.length;w++){let C=l.getLenS(P[w].index,f),T=P[w].index.length*u+C,O;s=="1"||s=="3"?O=l.getDataByType(P[w].data,T,a,s,"chnWeek3"):s=="2"?O=l.getDataByType(P[w].data,T,a,s):O=l.getDataByType(P[w].data,T,a,"0");let z=l.getDataIndex(n,t,P[w].index);F.push({data:O,index:z})}let D=e.other,k=[];if(D)for(let w=0;w<D.length;w++){let C=l.getLenS(D[w].index,f),T=D[w].index.length*u+C,O;s=="2"||s=="3"?O=l.getDataByType(D[w].data,T,a,s):O=l.getDataByType(D[w].data,T,a,"0");let z=l.getDataIndex(n,t,D[w].index);k.push({data:O,index:z})}for(let w=1;w<=t;w++){if(d.length>0)for(let C=0;C<d.length;C++)w in d[C].index&&o.push(d[C].data[d[C].index[w]]);if(b.length>0)for(let C=0;C<b.length;C++)w in b[C].index&&o.push(b[C].data[b[C].index[w]]);if(v.length>0)for(let C=0;C<v.length;C++)w in v[C].index&&o.push(v[C].data[v[C].index[w]]);if(_.length>0)for(let C=0;C<_.length;C++)w in _[C].index&&o.push(_[C].data[_[C].index[w]]);if(I.length>0)for(let C=0;C<I.length;C++)w in I[C].index&&o.push(I[C].data[I[C].index[w]]);if(F.length>0)for(let C=0;C<F.length;C++)w in F[C].index&&o.push(F[C].data[F[C].index[w]]);if(k.length>0)for(let C=0;C<k.length;C++)w in k[C].index&&o.push(k[C].data[k[C].index[w]])}return o},getLenS:function(e,n){let t=0;for(let l=0;l<e.length&&e[l]<=n;l++)t++;return t},getDataIndex:function(e,n,t){let l={},o=Math.floor(n/e),a=n%e,s=0;if(o>0){for(let u=1;u<=o;u++)for(let f=0;f<t.length;f++)l[t[f]+(u-1)*e]=s,s++;for(let u=0;u<t.length&&t[u]<=a;u++)l[t[u]+e*o]=s,s++}else for(let u=0;u<t.length&&t[u]<=a;u++)l[t[u]]=s,s++;return l},getDataByType:function(e,n,t,l,o){let a=this,s=[];if(l=="0")(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n);else if(l=="1")if(o=="number")s=a.FillSeries(e,n,t);else if(o=="extendNumber")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillExtendNumber(e,n,u)}else{let u=[];for(let f=0;f<e.length;f++){let m=e[f].m;u.push(Number(a.isExtendNumber(m)[1]))}if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let f=u[1]-u[0];s=a.FillExtendNumber(e,n,f)}else s=a.FillCopy(e,n)}else if(o=="date")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillDays(e,n,u)}else{(t=="up"||t=="left")&&e.reverse();let u=a.judgeDate(e);if(u[0]&&u[3]){let f=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"months");s=a.FillMonths(e,n,f)}else if(!u[0]&&u[2]){let f=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"days");s=a.FillDays(e,n,f)}else s=a.FillCopy(e,n)}else if(o=="chnNumber")if(e.length==1)if(e[0].m=="\u65E5"||a.ChineseToNumber(e[0].m)<7){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnWeek(e,n,u)}else{let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnNumber(e,n,u)}else{let u=!1;for(let d=0;d<e.length;d++)if(e[d].m=="\u65E5"){u=!0;break}let f=[],m=0;for(let d=0;d<e.length;d++)e[d].m=="\u65E5"?d==0?f.push(0):(m++,f.push(m*7)):u&&a.ChineseToNumber(e[d].m)>0&&a.ChineseToNumber(e[d].m)<7?f.push(a.ChineseToNumber(e[d].m)+m*7):f.push(a.ChineseToNumber(e[d].m));if((t=="up"||t=="left")&&(e.reverse(),f.reverse()),a.isEqualDiff(f))if(u||f[f.length-1]<6&&f[0]>0||f[0]<6&&f[f.length-1]>0){let d=f[1]-f[0];s=a.FillChnWeek(e,n,d)}else{let d=f[1]-f[0];s=a.FillChnNumber(e,n,d)}else s=a.FillCopy(e,n)}else if(o=="chnWeek2")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnWeek2(e,n,u)}else{let u=[],f=0;for(let m=0;m<e.length;m++){let d=e[m].m.substr(e[m].m.length-1,1);e[m].m=="\u5468\u65E5"?m==0?u.push(0):(f++,u.push(f*7)):u.push(a.ChineseToNumber(d)+f*7)}if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let m=u[1]-u[0];s=a.FillChnWeek2(e,n,m)}else s=a.FillCopy(e,n)}else if(o=="chnWeek3")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnWeek3(e,n,u)}else{let u=[],f=0;for(let m=0;m<e.length;m++){let d=e[m].m.substr(e[m].m.length-1,1);e[m].m=="\u661F\u671F\u65E5"?m==0?u.push(0):(f++,u.push(f*7)):u.push(a.ChineseToNumber(d)+f*7)}if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let m=u[1]-u[0];s=a.FillChnWeek3(e,n,m)}else s=a.FillCopy(e,n)}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n);else if(l=="2")(t=="up"||t=="left")&&e.reverse(),s=a.FillOnlyFormat(e,n);else if(l=="3"){let u=a.getDataByType(e,n,t,"1",o);s=a.FillWithoutFormat(u)}else if(l=="4")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillDays(e,n,u)}else if(e.length==2){(t=="up"||t=="left")&&e.reverse();let u=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"days");s=a.FillDays(e,n,u)}else{(t=="up"||t=="left")&&e.reverse();let u=a.judgeDate(e);if(u[0]&&u[3]){let f=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"months");s=a.FillMonths(e,n,f)}else if(!u[0]&&u[2]){let f=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"days");s=a.FillDays(e,n,f)}else s=a.FillCopy(e,n)}else if(l=="5")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1);let f=Math.round(n*1.5);for(let m=1;m<=f;m++){let d=$.extend(!0,{},e[0]),p=(0,zt.default)(d.m).add(m,"days").day();if(p==0||p==6)continue;let b=(0,zt.default)(d.m).add(u*m,"days").format("YYYY-MM-DD");if(d.m=b,d.v=_l(b)[2],s.push(d),s.length==n)break}}else if(e.length==2)if((0,zt.default)(e[1].m).date()==(0,zt.default)(e[0].m).date()&&(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"months")!=0){(t=="up"||t=="left")&&e.reverse();let u=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"months");for(let f=1;f<=n;f++){let m=(f-1)%e.length,d=$.extend(!0,{},e[m]),p=(0,zt.default)(e[e.length-1]).add(u*f,"months").day(),b;p==0?b=(0,zt.default)(e[e.length-1]).add(u*f,"months").subtract(2,"days").format("YYYY-MM-DD"):p==6?b=(0,zt.default)(e[e.length-1]).add(u*f,"months").subtract(1,"days").format("YYYY-MM-DD"):b=(0,zt.default)(e[e.length-1]).add(u*f,"months").format("YYYY-MM-DD"),d.m=b,d.v=_l(b)[2],s.push(d)}}else if(Math.abs((0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m)))>7){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1,e.reverse());let f;for(let m=1;m<=n;m++){let d=(m-1)%e.length,p=$.extend(!0,{},e[d]),b=Math.ceil(m/e.length);d==0&&(f=(0,zt.default)(p.m).add(u*b,"months").diff((0,zt.default)(p.m),"days"));let g=(0,zt.default)(p.m).add(f,"days").day(),v;g==0?v=(0,zt.default)(p.m).add(f,"days").subtract(2,"days").format("YYYY-MM-DD"):g==6?v=(0,zt.default)(p.m).add(f,"days").subtract(1,"days").format("YYYY-MM-DD"):v=(0,zt.default)(p.m).add(f,"days").format("YYYY-MM-DD"),p.m=v,p.v=_l(v)[2],s.push(p)}}else{let u;t=="down"||t=="right"?u=7:(t=="up"||t=="left")&&(u=-7,e.reverse());let f;for(let m=1;m<=n;m++){let d=(m-1)%e.length,p=$.extend(!0,{},e[d]),b=Math.ceil(m/e.length);d==0&&(f=(0,zt.default)(p.m).add(u*b,"days").diff((0,zt.default)(p.m),"days"));let g=(0,zt.default)(p.m).add(f,"days").day(),v;g==0?v=(0,zt.default)(p.m).add(f,"days").subtract(2,"days").format("YYYY-MM-DD"):g==6?v=(0,zt.default)(p.m).add(f,"days").subtract(1,"days").format("YYYY-MM-DD"):v=(0,zt.default)(p.m).add(f,"days").format("YYYY-MM-DD"),p.m=v,p.v=_l(v)[2],s.push(p)}}else{let u=a.judgeDate(e);if(u[0]&&u[3]){(t=="up"||t=="left")&&e.reverse();let f=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"months");for(let m=1;m<=n;m++){let d=(m-1)%e.length,p=$.extend(!0,{},e[d]),b=(0,zt.default)(e[e.length-1].m).add(f*m,"months").day(),g;b==0?g=(0,zt.default)(e[e.length-1].m).add(f*m,"months").subtract(2,"days").format("YYYY-MM-DD"):b==6?g=(0,zt.default)(e[e.length-1].m).add(f*m,"months").subtract(1,"days").format("YYYY-MM-DD"):g=(0,zt.default)(e[e.length-1].m).add(f*m,"months").format("YYYY-MM-DD"),p.m=g,p.v=_l(g)[2],s.push(p)}}else if(!u[0]&&u[2])if(Math.abs((0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m)))>7){let f;t=="down"||t=="right"?f=1:(t=="up"||t=="left")&&(f=-1,e.reverse());let m;for(let d=1;d<=n;d++){let p=(d-1)%e.length,b=$.extend(!0,{},e[p]),g=Math.ceil(d/e.length);p==0&&(m=(0,zt.default)(b.m).add(f*g,"months").diff((0,zt.default)(b.m),"days"));let v=(0,zt.default)(b.m).add(m,"days").day(),x;v==0?x=(0,zt.default)(b.m).add(m,"days").subtract(2,"days").format("YYYY-MM-DD"):v==6?x=(0,zt.default)(b.m).add(m,"days").subtract(1,"days").format("YYYY-MM-DD"):x=(0,zt.default)(b.m).add(m,"days").format("YYYY-MM-DD"),b.m=x,b.v=_l(x)[2],s.push(b)}}else{let f;t=="down"||t=="right"?f=7:(t=="up"||t=="left")&&(f=-7,e.reverse());let m;for(let d=1;d<=n;d++){let p=(d-1)%e.length,b=$.extend(!0,{},e[p]),g=Math.ceil(d/e.length);p==0&&(m=(0,zt.default)(b.m).add(f*g,"days").diff((0,zt.default)(b.m),"days"));let v=(0,zt.default)(b.m).add(m,"days").day(),x;v==0?x=(0,zt.default)(b.m).add(m,"days").subtract(2,"days").format("YYYY-MM-DD"):v==6?x=(0,zt.default)(b.m).add(m,"days").subtract(1,"days").format("YYYY-MM-DD"):x=(0,zt.default)(b.m).add(m,"days").format("YYYY-MM-DD"),b.m=x,b.v=_l(x)[2],s.push(b)}}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n)}else if(l=="6")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillMonths(e,n,u)}else if(e.length==2)if((0,zt.default)(e[1].m).date()==(0,zt.default)(e[0].m).date()&&(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"months")!=0){(t=="up"||t=="left")&&e.reverse();let u=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"months");s=a.FillMonths(e,n,u)}else{let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1,e.reverse());let f;for(let m=1;m<=n;m++){let d=(m-1)%e.length,p=$.extend(!0,{},e[d]),b=Math.ceil(m/e.length);d==0&&(f=(0,zt.default)(p.m).add(u*b,"months").diff((0,zt.default)(p.m),"days"));let g=(0,zt.default)(p.m).add(f,"days").format("YYYY-MM-DD");p.m=g,p.v=_l(g)[2],s.push(p)}}else{let u=a.judgeDate(e);if(u[0]&&u[3]){(t=="up"||t=="left")&&e.reverse();let f=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"months");s=a.FillMonths(e,n,f)}else if(!u[0]&&u[2]){let f;t=="down"||t=="right"?f=1:(t=="up"||t=="left")&&(f=-1,e.reverse());let m;for(let d=1;d<=n;d++){let p=(d-1)%e.length,b=$.extend(!0,{},e[p]),g=Math.ceil(d/e.length);p==0&&(m=(0,zt.default)(b.m).add(f*g,"months").diff((0,zt.default)(b.m),"days"));let v=(0,zt.default)(b.m).add(m,"days").format("YYYY-MM-DD");b.m=v,b.v=_l(v)[2],s.push(b)}}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n)}else if(l=="7")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillYears(e,n,u)}else if(e.length==2)if((0,zt.default)(e[1].m).date()==(0,zt.default)(e[0].m).date()&&(0,zt.default)(e[1].m).month()==(0,zt.default)(e[0].m).month()&&(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"years")!=0){(t=="up"||t=="left")&&e.reverse();let u=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"years");s=a.FillYears(e,n,u)}else{let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1,e.reverse());let f;for(let m=1;m<=n;m++){let d=(m-1)%e.length,p=$.extend(!0,{},e[d]),b=Math.ceil(m/e.length);d==0&&(f=(0,zt.default)(p.m).add(u*b,"years").diff((0,zt.default)(p.m),"days"));let g=(0,zt.default)(p.m).add(f,"days").format("YYYY-MM-DD");p.m=g,p.v=_l(g)[2],s.push(p)}}else{let u=a.judgeDate(e);if(u[0]&&u[1]&&u[4]){(t=="up"||t=="left")&&e.reverse();let f=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"years");s=a.FillYears(e,n,f)}else if(u[0]&&u[3]||u[2]){let f;t=="down"||t=="right"?f=1:(t=="up"||t=="left")&&(f=-1,e.reverse());let m;for(let d=1;d<=n;d++){let p=(d-1)%e.length,b=$.extend(!0,{},e[p]),g=Math.ceil(d/e.length);p==0&&(m=(0,zt.default)(b.m).add(f*g,"years").diff((0,zt.default)(b.m),"days"));let v=(0,zt.default)(b.m).add(m,"days").format("YYYY-MM-DD");b.m=v,b.v=_l(v)[2],s.push(b)}}else(t=="up"||t=="left")&&e.reverse(),s=a.FillCopy(e,n)}else if(l=="8")if(e.length==1){let u;t=="down"||t=="right"?u=1:(t=="up"||t=="left")&&(u=-1),s=a.FillChnNumber(e,n,u)}else{let u=[];for(let f=0;f<e.length;f++)u.push(a.ChineseToNumber(e[f].m));if((t=="up"||t=="left")&&(e.reverse(),u.reverse()),a.isEqualDiff(u)){let f=u[1]-u[0];s=a.FillChnNumber(e,n,f)}else s=a.FillCopy(e,n)}return s},FillCopy:function(e,n){let t=[];for(let l=1;l<=n;l++){let o=(l-1)%e.length,a=$.extend(!0,{},e[o]);t.push(a)}return t},FillSeries:function(e,n,t){let l=this,o=[],a=[];for(let s=0;s<e.length;s++)a.push(Number(e[s].v));if(e.length>2&&l.isEqualRatio(a))for(let s=1;s<=n;s++){let u=(s-1)%e.length,f=$.extend(!0,{},e[u]),m;t=="down"||t=="right"?m=Number(e[e.length-1].v)*Math.pow(Number(e[1].v)/Number(e[0].v),s):(t=="up"||t=="left")&&(m=Number(e[0].v)/Math.pow(Number(e[1].v)/Number(e[0].v),s)),f.v=m,f.m=Bl(f.ct.fa,m),o.push(f)}else{let s=l.getXArr(e.length);for(let u=1;u<=n;u++){let f=(u-1)%e.length,m=$.extend(!0,{},e[f]),d;t=="down"||t=="right"?d=l.forecast(e.length+u,a,s):(t=="up"||t=="left")&&(d=l.forecast(1-u,a,s)),m.v=d,m.m=Bl(m.ct.fa,d),o.push(m)}}return o},FillExtendNumber:function(e,n,t){let l=this,o=[],a=/0|([1-9]+[0-9]*)/g;for(let s=1;s<=n;s++){let u=(s-1)%e.length,f=$.extend(!0,{},e[u]),m=e[e.length-1].m,d=m.match(a),p=d[d.length-1],b=Math.abs(Number(p)+t*s),g=m.lastIndexOf(p),v=m.substr(0,g)+b.toString()+m.substr(g+p.length);f.v=v,f.m=v,o.push(f)}return o},FillOnlyFormat:function(e,n){let t=[];for(let l=1;l<=n;l++){let o=(l-1)%e.length,a=$.extend(!0,{},e[o]);delete a.f,delete a.m,delete a.v,t.push(a)}return t},FillWithoutFormat:function(e){let n=[];for(let t=0;t<e.length;t++){let l=$.extend(!0,{},e[t]),o;l.f==null?o={m:l.v.toString(),v:l.v}:o={f:l.f,m:l.v.toString(),v:l.v},n.push(o)}return n},FillDays:function(e,n,t){let l=[];for(let o=1;o<=n;o++){let a=(o-1)%e.length,s=$.extend(!0,{},e[a]),u=Bl("yyyy-MM-dd",s.v);u=(0,zt.default)(u).add(t*o,"days").format("YYYY-MM-DD"),s.v=_l(u)[2],s.m=Bl(s.ct.fa,s.v),l.push(s)}return l},FillMonths:function(e,n,t){let l=[];for(let o=1;o<=n;o++){let a=(o-1)%e.length,s=$.extend(!0,{},e[a]),u=Bl("yyyy-MM-dd",s.v);u=(0,zt.default)(u).add(t*o,"months").format("YYYY-MM-DD"),s.v=_l(u)[2],s.m=Bl(s.ct.fa,s.v),l.push(s)}return l},FillYears:function(e,n,t){let l=[];for(let o=1;o<=n;o++){let a=(o-1)%e.length,s=$.extend(!0,{},e[a]),u=Bl("yyyy-MM-dd",s.v);u=(0,zt.default)(u).add(t*o,"years").format("YYYY-MM-DD"),s.v=_l(u)[2],s.m=Bl(s.ct.fa,s.v),l.push(s)}return l},FillChnWeek:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),f;e[e.length-1].m=="\u65E5"?f=7+t*a:f=l.ChineseToNumber(e[e.length-1].m)+t*a,f<0&&(f=Math.ceil(Math.abs(f)/7)*7+f);let m=f%7;m==0?(u.m="\u65E5",u.v="\u65E5"):m==1?(u.m="\u4E00",u.v="\u4E00"):m==2?(u.m="\u4E8C",u.v="\u4E8C"):m==3?(u.m="\u4E09",u.v="\u4E09"):m==4?(u.m="\u56DB",u.v="\u56DB"):m==5?(u.m="\u4E94",u.v="\u4E94"):m==6&&(u.m="\u516D",u.v="\u516D"),o.push(u)}return o},FillChnWeek2:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),f;if(e[e.length-1].m=="\u5468\u65E5")f=7+t*a;else{let d=e[e.length-1].m,p=d.substr(d.length-1,1);f=l.ChineseToNumber(p)+t*a}f<0&&(f=Math.ceil(Math.abs(f)/7)*7+f);let m=f%7;m==0?(u.m="\u5468\u65E5",u.v="\u5468\u65E5"):m==1?(u.m="\u5468\u4E00",u.v="\u5468\u4E00"):m==2?(u.m="\u5468\u4E8C",u.v="\u5468\u4E8C"):m==3?(u.m="\u5468\u4E09",u.v="\u5468\u4E09"):m==4?(u.m="\u5468\u56DB",u.v="\u5468\u56DB"):m==5?(u.m="\u5468\u4E94",u.v="\u5468\u4E94"):m==6&&(u.m="\u5468\u516D",u.v="\u5468\u516D"),o.push(u)}return o},FillChnWeek3:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),f;if(e[e.length-1].m=="\u661F\u671F\u65E5")f=7+t*a;else{let d=e[e.length-1].m,p=d.substr(d.length-1,1);f=l.ChineseToNumber(p)+t*a}f<0&&(f=Math.ceil(Math.abs(f)/7)*7+f);let m=f%7;m==0?(u.m="\u661F\u671F\u65E5",u.v="\u661F\u671F\u65E5"):m==1?(u.m="\u661F\u671F\u4E00",u.v="\u661F\u671F\u4E00"):m==2?(u.m="\u661F\u671F\u4E8C",u.v="\u661F\u671F\u4E8C"):m==3?(u.m="\u661F\u671F\u4E09",u.v="\u661F\u671F\u4E09"):m==4?(u.m="\u661F\u671F\u56DB",u.v="\u661F\u671F\u56DB"):m==5?(u.m="\u661F\u671F\u4E94",u.v="\u661F\u671F\u4E94"):m==6&&(u.m="\u661F\u671F\u516D",u.v="\u661F\u671F\u516D"),o.push(u)}return o},FillChnNumber:function(e,n,t){let l=this,o=[];for(let a=1;a<=n;a++){let s=(a-1)%e.length,u=$.extend(!0,{},e[s]),f=l.ChineseToNumber(e[e.length-1].m)+t*a,m;f<=0?m="\u96F6":m=l.NumberToChinese(f),u.v=m,u.m=m.toString(),o.push(u)}return o},isEqualDiff:function(e){let n=!0,t=e[1]-e[0];for(let l=1;l<e.length;l++)if(e[l]-e[l-1]!=t){n=!1;break}return n},isEqualRatio:function(e){let n=!0,t=e[1]/e[0];for(let l=1;l<e.length;l++)if(e[l]/e[l-1]!=t){n=!1;break}return n},getXArr:function(e){let n=[];for(let t=1;t<=e;t++)n.push(t);return n},forecast:function(e,n,t){function l(d){let p=0;for(let b=0;b<d.length;b++)p+=d[b];return p/d.length}let o=l(t),a=l(n),s=0,u=0;for(let d=0;d<t.length;d++)s+=(t[d]-o)*(n[d]-a),u+=(t[d]-o)*(t[d]-o);let f;u==0?f=1:f=s/u;let m=a-f*o;return Math.round((m+f*e)*1e5)/1e5},judgeDate:function(e){let n=!0,t=!0,l=!0,o=!0,a=!0,s=(0,zt.default)(e[0].m).date(),u=(0,zt.default)(e[0].m).month(),f=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"days"),m=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"months"),d=(0,zt.default)(e[1].m).diff((0,zt.default)(e[0].m),"years");for(let p=1;p<e.length;p++)(0,zt.default)(e[p].m).date()!=s&&(n=!1),(0,zt.default)(e[p].m).month()!=u&&(t=!1),(0,zt.default)(e[p].m).diff((0,zt.default)(e[p-1].m),"days")!=f&&(l=!1),(0,zt.default)(e[p].m).diff((0,zt.default)(e[p-1].m),"months")!=m&&(o=!1),(0,zt.default)(e[p].m).diff((0,zt.default)(e[p-1].m),"years")!=d&&(a=!1);return f==0&&(l=!1),m==0&&(o=!1),d==0&&(a=!1),[n,t,l,o,a]}},Qr=Ux});var import_plugin,$a,Ie,Di=Nt(()=>{import_plugin=qe(Ye());fr();Go();jr();Ja();qr();ln();ta();Nm();Ri();il();Xl();Ar();$a={freezenHorizontalHTML:'<div id="luckysheet-freezebar-horizontal" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-horizontal-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-horizontal-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-horizontal-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-horizontal-drop-bar" >&nbsp;</div></div></div>',freezenVerticalHTML:'<div id="luckysheet-freezebar-vertical" class="luckysheet-freezebar" tabindex="0"><div class="luckysheet-freezebar-handle luckysheet-freezebar-vertical-handle" ><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-title" ></div><div class="luckysheet-freezebar-handle-bar luckysheet-freezebar-vertical-handle-bar" ></div></div><div class="luckysheet-freezebar-drop luckysheet-freezebar-vertical-drop" ><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-title" ></div><div class="luckysheet-freezebar-drop-bar luckysheet-freezebar-vertical-drop-bar" >&nbsp;</div></div></div>',initialHorizontal:!0,initialVertical:!0,horizontalmovestate:!1,horizontalmoveposition:null,verticalmovestate:!1,verticalmoveposition:null,windowHeight:null,windowWidth:null,freezenhorizontaldata:null,freezenverticaldata:null,freezenRealFirstRowColumn:!0,cutVolumn:function(e,n){if(n<=0)return e;let t=e.slice(0,n),l=t[t.length-1];return e.slice(n)},cancelFreezenVertical:function(e){let n=this,l=Be().freezen,o=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${l.default}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(o),$("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> '+l.freezenColumn),n.freezenverticaldata=null;let a=$("#luckysheet-freezebar-vertical").is(":visible");$("#luckysheet-freezebar-vertical").hide(),e==null&&(e=h.currentSheetIndex);let s=h.luckysheetfile[Me(e)];s.freezen!=null&&(s.freezen.vertical=null),s.frozen!=null&&a&&Ue.saveParam("all",e,s.frozen,{k:"frozen"})},createFreezenVertical:function(e,n){let t=this;if(t.initialVertical){t.initialVertical=!1,$("#luckysheet-grid-window-1").append(t.freezenVerticalHTML),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").mousedown(function(){t.verticalmovestate=!0,t.verticalmoveposition=$(this).position().left,t.windowWidth=$("#luckysheet-grid-window-1").width(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grabbing")});let o=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:o-10,width:"4px",cursor:"-webkit-grab",top:"0px"}).end().find(".luckysheet-freezebar-vertical-drop").css({height:o-10,width:"4px",top:"0px",cursor:"-webkit-grab"})}if(e==null){if(t.freezenRealFirstRowColumn){let o=0;n=h.visibledatacolumn[o]-2+h.rowHeaderWidth,e=[h.visibledatacolumn[o],o+1,0,t.cutVolumn(h.visibledatacolumn,o+1),n]}else{let o=$("#luckysheet-cell-main").scrollLeft(),a=$l(h.visibledatacolumn,o);a==-1&&(a=0),n=h.visibledatacolumn[a]-2-o+h.rowHeaderWidth,e=[h.visibledatacolumn[a],a+1,o,t.cutVolumn(h.visibledatacolumn,a+1),n]}t.saveFreezen(null,null,e,n)}t.freezenverticaldata=e;let l=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${Be().freezen.freezenCancel}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(l),$("#luckysheet-freezebar-vertical").show().find(".luckysheet-freezebar-vertical-handle").css({left:n}).end().find(".luckysheet-freezebar-vertical-drop").css({left:n})},saveFreezen:function(e,n,t,l){let o=h.luckysheetfile[Me(h.currentSheetIndex)];o.freezen==null&&(o.freezen={}),e!=null&&(o.freezen.horizontal==null&&(o.freezen.horizontal={}),o.freezen.horizontal.freezenhorizontaldata=e,o.freezen.horizontal.top=n),t!=null&&(o.freezen.vertical==null&&(o.freezen.vertical={}),o.freezen.vertical.freezenverticaldata=t,o.freezen.vertical.left=l),o.frozen!=null&&Ue.saveParam("all",h.currentSheetIndex,o.frozen,{k:"frozen"})},initialFreezen:function(e){let n=this;n.frozenTofreezen();let t=h.luckysheetfile[Me(e)];t.freezen!=null&&t.freezen.horizontal!=null&&t.freezen.horizontal.freezenhorizontaldata!=null?n.createFreezenHorizontal(t.freezen.horizontal.freezenhorizontaldata,t.freezen.horizontal.top):n.cancelFreezenHorizontal(e),t.freezen!=null&&t.freezen.vertical!=null&&t.freezen.vertical.freezenverticaldata!=null?n.createFreezenVertical(t.freezen.vertical.freezenverticaldata,t.freezen.vertical.left):n.cancelFreezenVertical(e),n.createAssistCanvas()},changeFreezenIndex:function(e,n){let t=this;if(n=="v"&&t.freezenverticaldata!=null){let l=t.freezenverticaldata[1],o=$l(h.visibledatacolumn,$("#luckysheet-cell-main").scrollLeft());e-o<l&&(e=e-o)}else if(n=="h"&&t.freezenhorizontaldata!=null){let l=t.freezenhorizontaldata[1],o=$l(h.visibledatarow,$("#luckysheet-cell-main").scrollTop());e-o<l&&(e=e-o)}return e},scrollFreezen:function(){let e=this,n,t=h.luckysheet_select_save[0].row_focus;t==h.luckysheet_select_save[0].row[0]?n=h.luckysheet_select_save[0].row[1]:t==h.luckysheet_select_save[0].row[1]&&(n=h.luckysheet_select_save[0].row[0]);let l,o=h.luckysheet_select_save[0].column_focus;if(o==h.luckysheet_select_save[0].column[0]?l=h.luckysheet_select_save[0].column[1]:o==h.luckysheet_select_save[0].column[1]&&(l=h.luckysheet_select_save[0].column[0]),e.freezenverticaldata!=null){let a=e.freezenverticaldata[1],s=$l(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()),u=e.freezenverticaldata[4];a+=s,l>=h.visibledatacolumn.length&&(l=h.visibledatacolumn.length-1),a>=h.visibledatacolumn.length&&(a=h.visibledatacolumn.length-1);let f=h.visibledatacolumn[l],m=h.visibledatacolumn[a];f<=m+u&&setTimeout(function(){$("#luckysheet-scrollbar-x").scrollLeft(0)},100)}if(e.freezenhorizontaldata!=null){let a=e.freezenhorizontaldata[1],s=$l(e.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()),u=e.freezenhorizontaldata[4];a+=s,n>=h.visibledatarow.length&&(n=h.visibledatarow.length-1),a>=h.visibledatarow.length&&(a=h.visibledatarow.length-1);let f=h.visibledatarow[n],m=h.visibledatarow[a];f<=m+u&&setTimeout(function(){$("#luckysheet-scrollbar-y").scrollTop(0)},100)}},cancelFreezenHorizontal:function(e){let n=this,t=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${Be().freezen.default}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(t),n.freezenhorizontaldata=null;let l=$("#luckysheet-freezebar-horizontal").is(":visible");$("#luckysheet-freezebar-horizontal").hide(),e==null&&(e=h.currentSheetIndex);let o=h.luckysheetfile[Me(e)];o.freezen!=null&&(o.freezen.horizontal=null),o.frozen!=null&&l&&Ue.saveParam("all",e,o.frozen,{k:"frozen"})},createFreezenHorizontal:function(e,n){let t=this;if(t.initialHorizontal){t.initialHorizontal=!1,$("#luckysheet-grid-window-1").append(t.freezenHorizontalHTML),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").hover(function(){$(this).parent().addClass("luckysheet-freezebar-hover")},function(){$(this).parent().removeClass("luckysheet-freezebar-hover")}),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").mousedown(function(){t.horizontalmovestate=!0,t.horizontalmoveposition=$(this).position().top,t.windowHeight=$("#luckysheet-grid-window-1").height(),$(this).parent().addClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grabbing")});let o=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:o-10,height:"4px",cursor:"-webkit-grab",left:"0px"}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:o-10,height:"4px",left:"0px",cursor:"-webkit-grab"})}if(e==null){let o;if(t.freezenRealFirstRowColumn)o=0,n=h.visibledatarow[o]-2+h.columnHeaderHeight,e=[h.visibledatarow[o],o+1,0,t.cutVolumn(h.visibledatarow,o+1),n],t.saveFreezen(e,n,null,null),setTimeout(()=>{$a.createAssistCanvas(),Xt()});else{let a=$("#luckysheet-cell-main").scrollTop();o=$l(h.visibledatarow,a),o==-1&&(o=0),n=h.visibledatarow[o]-2-a+h.columnHeaderHeight,e=[h.visibledatarow[o],o+1,a,t.cutVolumn(h.visibledatarow,o+1),n],t.saveFreezen(e,n,null,null)}}t.freezenhorizontaldata=e;let l=`
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block"
            style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block"
                style="user-select: none;">
                    <div class="luckysheet-icon luckysheet-inline-block " style="user-select: none;">
                        <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-function iconfont luckysheet-iconfont-dongjie1"
                        style="user-select: none;">
                        </div>
                    </div>
                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block"
                    style="user-select: none;">
                        ${Be().freezen.freezenCancel}
                    </div>
                </div>
            </div>
        `;$("#luckysheet-freezen-btn-horizontal").html(l),$("#luckysheet-freezebar-horizontal").show().find(".luckysheet-freezebar-horizontal-handle").css({top:n}).end().find(".luckysheet-freezebar-horizontal-drop").css({top:n})},createAssistCanvas:function(){let e=this;if(e.removeAssistCanvas(),e.freezenverticaldata!=null||e.freezenhorizontaldata!=null){let n,t,l,o,a,s,u=h.luckysheetTableContentHW[0],f=h.luckysheetTableContentHW[1];e.freezenverticaldata!=null&&e.freezenhorizontaldata!=null?(n=e.freezenhorizontaldata[0],t=e.freezenhorizontaldata[1],l=e.freezenhorizontaldata[2],o=e.freezenverticaldata[0],a=e.freezenverticaldata[1],s=e.freezenverticaldata[2],e.createCanvas("freezen_3",o-s,n-l+1,h.rowHeaderWidth-1,h.columnHeaderHeight-1),e.createCanvas("freezen_4",u-o+s,n-l+1,o-s+h.rowHeaderWidth-1,h.columnHeaderHeight-1),e.createCanvas("freezen_7",o-s,f-n+l-h.columnHeaderHeight,h.rowHeaderWidth-1,n-l+h.columnHeaderHeight-1)):e.freezenhorizontaldata!=null?(n=e.freezenhorizontaldata[0],t=e.freezenhorizontaldata[1],l=e.freezenhorizontaldata[2],e.createCanvas("freezen_h",u,n-l+1,h.rowHeaderWidth-1,h.columnHeaderHeight-1)):e.freezenverticaldata!=null&&(o=e.freezenverticaldata[0],a=e.freezenverticaldata[1],s=e.freezenverticaldata[2],e.createCanvas("freezen_v",o-s,f,h.rowHeaderWidth-1,h.columnHeaderHeight-1)),e.scrollAdapt()}},createCanvas:function(e,n,t,l,o){let a=$("<canvas/>").appendTo("#luckysheet-grid-window-1").attr({id:e,width:Math.ceil(n*h.devicePixelRatio),height:Math.ceil(t*h.devicePixelRatio)}).css({"user-select":"none",postion:"absolute",left:l,top:o,width:n,height:t,"z-index":10,"pointer-events":"none"})},removeAssistCanvas:function(){$("#luckysheet-grid-window-1 > canvas").not($("#luckysheetTableContent")).remove(),$("#luckysheet-cell-selected").css("z-index",15)},scrollAdapt:function(){let e=this;if(h.luckysheet_select_save!=null&&h.luckysheet_select_save.length>0&&e.scrollAdaptOfselect(),$("#luckysheet-cell-main .luckysheet-data-visualization-chart").length>0){let n=h.luckysheetfile[Me(h.currentSheetIndex)].chart;n!=null&&n.length>0&&e.scrollAdaptOfchart()}$("#luckysheet-postil-showBoxs .luckysheet-postil-show").length>0&&e.scrollAdaptOfpostil(),$("#luckysheet-dropCell-icon").length>0&&e.scrollAdaptOfdpicon(),$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").length>0&&e.scrollAdaptOffilteroptions()},scrollAdaptOfselect:function(){let e=this;$("#luckysheet-row-count-show").is(":visible")&&$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").is(":visible")&&$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty();let n=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let l=e.freezenhorizontaldata[0],o=e.freezenhorizontaldata[1],a=n-e.freezenhorizontaldata[2],s=e.freezenverticaldata[0],u=e.freezenverticaldata[1],f=t-e.freezenverticaldata[2];for(let m=0;m<h.luckysheet_select_save.length;m++){let d=$.extend(!0,{},h.luckysheet_select_save[m]),p=d.row[0],b=d.row[1],g=h.visibledatarow[b],v=p-1==-1?0:h.visibledatarow[p-1],x=v,_=g-v-1,S=!0;p>=o?x+_<l+a?S=!1:x<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({top:l+a,height:_-(l+a-x)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({top:x,height:_}):b>=o?x+_<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({top:x+a,height:l-x}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({top:x+a,height:_-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css("top",x+a);let I=d.column[0],P=d.column[1],F=h.visibledatacolumn[P],D=I-1==-1?0:h.visibledatacolumn[I-1],k=D,w=F-D-1;if(I>=u?k+w<s+f?S=!1:k<s+f?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({left:s+f,width:w-(s+f-k)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({left:k,width:w}):P>=u?k+w<s+f?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({left:k+f,width:s-k}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css({left:k+f,width:w-f}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).show().css("left",k+f),S||$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(m).hide(),m==h.luckysheet_select_save.length-1){let C=d.row_focus==null?p:d.row_focus,T=d.column_focus==null?I:d.column_focus,O=h.visibledatarow[C],z=C-1==-1?0:h.visibledatarow[C-1],A=h.visibledatacolumn[T],E=T-1==-1?0:h.visibledatacolumn[T-1],L=_t.mergeborer(h.flowdata,C,T);L&&(O=L.row[1],z=L.row[0],A=L.column[1],E=L.column[0]);let N=z,W=O-z-1,X=E,te=A-E-1,ue=!0;N>=l?N+W<l+a?ue=!1:N<l+a?$("#luckysheet-cell-selected-focus").show().css({top:l+a,height:W-(l+a-N)}):$("#luckysheet-cell-selected-focus").show().css({top:N,height:W}):N+W>=l?N+W<l+a?$("#luckysheet-cell-selected-focus").show().css({top:N+a,height:l-N}):$("#luckysheet-cell-selected-focus").show().css({top:N+a,height:W-a}):$("#luckysheet-cell-selected-focus").show().css("top",N+a),X>=s?X+te<s+f?ue=!1:X<s+f?$("#luckysheet-cell-selected-focus").show().css({left:s+f,width:te-(s+f-X)}):$("#luckysheet-cell-selected-focus").show().css({left:X,width:te}):X+te>=s?X+te<s+f?$("#luckysheet-cell-selected-focus").show().css({left:X+f,width:s-X}):$("#luckysheet-cell-selected-focus").show().css({left:X+f,width:te-f}):$("#luckysheet-cell-selected-focus").show().css("left",X+f),ue||$("#luckysheet-cell-selected-focus").hide()}}}else if(e.freezenhorizontaldata!=null){let l=e.freezenhorizontaldata[0],o=e.freezenhorizontaldata[1],a=n-e.freezenhorizontaldata[2];for(let s=0;s<h.luckysheet_select_save.length;s++){let u=$.extend(!0,{},h.luckysheet_select_save[s]),f=u.row[0],m=u.row[1],d=h.visibledatarow[m],p=f-1==-1?0:h.visibledatarow[f-1],b=p,g=d-p-1;if(f>=o?b+g<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).hide():b<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:l+a,height:g-(l+a-b)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:b,height:g}):m>=o?b+g<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:b+a,height:l-b}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({top:b+a,height:g-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css("top",b+a),s==h.luckysheet_select_save.length-1){let v=u.row_focus==null?f:u.row_focus,x=u.column_focus==null?u.column[0]:u.column_focus,_=h.visibledatarow[v],S=v-1==-1?0:h.visibledatarow[v-1],I=_t.mergeborer(h.flowdata,v,x);I&&(_=I.row[1],S=I.row[0]);let P=S,F=_-S-1;P>=l?P+F<l+a?$("#luckysheet-cell-selected-focus").hide():P<l+a?$("#luckysheet-cell-selected-focus").show().css({top:l+a,height:F-(l+a-P)}):$("#luckysheet-cell-selected-focus").show().css({top:P,height:F}):P+F>=l?P+F<l+a?$("#luckysheet-cell-selected-focus").show().css({top:P+a,height:l-P}):$("#luckysheet-cell-selected-focus").show().css({top:P+a,height:F-a}):$("#luckysheet-cell-selected-focus").show().css("top",P+a)}}}else if(e.freezenverticaldata!=null){let l=e.freezenverticaldata[0],o=e.freezenverticaldata[1],a=t-e.freezenverticaldata[2];for(let s=0;s<h.luckysheet_select_save.length;s++){let u=$.extend(!0,{},h.luckysheet_select_save[s]),f=u.column[0],m=u.column[1],d=h.visibledatacolumn[m],p=f-1==-1?0:h.visibledatacolumn[f-1],b=p,g=d-p-1;if(f>=o?b+g<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).hide():b<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:l+a,width:g-(l+a-b)}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:b,width:g}):m>=o?b+g<l+a?$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:b+a,width:l-b}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css({left:b+a,width:g-a}):$("#luckysheet-cell-selected-boxs").find(".luckysheet-cell-selected").eq(s).show().css("left",b+a),s==h.luckysheet_select_save.length-1){let v=u.row_focus==null?u.row[0]:u.row_focus,x=u.column_focus==null?f:u.column_focus,_=h.visibledatacolumn[x],S=x-1==-1?0:h.visibledatacolumn[x-1],I=_t.mergeborer(h.flowdata,v,x);I&&(_=I.column[1],S=I.column[0]);let P=S,F=_-S-1;P>=l?P+F<l+a?$("#luckysheet-cell-selected-focus").hide():P<l+a?$("#luckysheet-cell-selected-focus").show().css({left:l+a,width:F-(l+a-P)}):$("#luckysheet-cell-selected-focus").show().css({left:P,width:F}):P+F>=l?P+F<l+a?$("#luckysheet-cell-selected-focus").show().css({left:P+a,width:l-P}):$("#luckysheet-cell-selected-focus").show().css({left:P+a,width:F-a}):$("#luckysheet-cell-selected-focus").show().css("left",P+a)}}}else gl()},scrollAdaptOfchart:function(){let e=this,n=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let l=e.freezenhorizontaldata[0]-e.freezenhorizontaldata[2],o=e.freezenverticaldata[0]-e.freezenverticaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(a,s){let u=$(s).position(),f=$(s).width(),m=$(s).height(),d=$(s).find("canvas").width(),p=$(s).find("canvas").height(),b=p-m,g=d-f;if(u.top-b<l){let v=l-(u.top-b);v>p+40+2?$(s).css("visibility","hidden"):($(s).css({top:l+n,height:p-v,visibility:"visible"}),$(s).find("canvas").css("top",-v))}else $(s).css({top:u.top-b+n,height:p,visibility:"visible"}),$(s).find("canvas").css("top",0);if(u.left-g<o){let v=o-(u.left-g);v>d+20+2?$(s).css("visibility","hidden"):($(s).css({left:o+t,width:d-v,visibility:"visible"}),$(s).find("canvas").css("left",-v))}else $(s).css({left:u.left-g+t,width:d,visibility:"visible"}),$(s).find("canvas").css("left",0)})}else if(e.freezenhorizontaldata!=null){let l=e.freezenhorizontaldata[0]-e.freezenhorizontaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(o,a){let s=$(a).position(),u=$(a).height(),f=$(a).find("canvas").height(),m=f-u;if(s.top-m<l){let d=l-(s.top-m);d>f+40+2?$(a).css("visibility","hidden"):($(a).css({top:l+n,height:f-d,visibility:"visible"}),$(a).find("canvas").css("top",-d))}else $(a).css({top:s.top-m+n,height:f,visibility:"visible"}),$(a).find("canvas").css("top",0)})}else if(e.freezenverticaldata!=null){let l=e.freezenverticaldata[0]-e.freezenverticaldata[2];$("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(o,a){let s=$(a).position(),u=$(a).width(),f=$(a).find("canvas").width(),m=f-u;if(s.left-m<l){let d=l-(s.left-m);d>f+20+2?$(a).css("visibility","hidden"):($(a).css({left:l+t,width:f-d,visibility:"visible"}),$(a).find("canvas").css("left",-d))}else $(a).css({left:s.left-m+t,width:f,visibility:"visible"}),$(a).find("canvas").css("left",0)})}else $("#luckysheet-cell-main .luckysheet-data-visualization-chart").each(function(l,o){let a=$(o).position(),s=$(o).width(),u=$(o).height(),f=$(o).find("canvas").width(),m=$(o).find("canvas").height(),d=m-u,p=f-s;$(o).css({top:a.top-d+n,height:m,left:a.left-p+t,width:f,visibility:"visible"}),$(o).find("canvas").css({top:0,left:0})})},scrollAdaptOfpostil:function(){let e=this,n=$("#luckysheet-cell-main").scrollTop(),t=$("#luckysheet-cell-main").scrollLeft();if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let l=e.freezenhorizontaldata[0],o=e.freezenverticaldata[0],a=n-e.freezenhorizontaldata[2],s=t-e.freezenverticaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(u,f){let m=$(f).attr("id"),d=m.split("luckysheet-postil-show_")[1].split("_")[0],p=m.split("luckysheet-postil-show_")[1].split("_")[1],b=h.flowdata[d][p].ps,g=h.visibledatarow[d],v=d-1==-1?0:h.visibledatarow[d-1],x=h.visibledatacolumn[p],_=p-1==-1?0:h.visibledatacolumn[p-1],S=_t.mergeborer(h.flowdata,d,p);S&&(g=S.row[1],v=S.row[0],x=S.column[1],_=S.column[0]);let I=x,P=v,F=b.left==null?I+18:b.left,D=b.top==null?P-18:b.top,k=b.width==null?Zt.defaultWidth:b.width,w=b.height==null?Zt.defaultHeight:b.height;D<0&&(D=2);let C=Zt.getArrowCanvasSize(F,D,I,P),T=!0,O=!0;d>=e.freezenhorizontaldata[1]?D+w<l?($(f).show().find(".luckysheet-postil-show-main").css("top",D+a),$(f).show().find(".arrowCanvas").css("top",C[1]+a)):D<l+a?D+w<=l+a?T=!1:($(f).show().find(".luckysheet-postil-show-main").css({top:l+a,height:w-(l+a-D)}),$(f).show().find(".formulaInputFocus").css("margin-top",-(l+a-D)),$(f).show().find(".arrowCanvas").hide(),O=!1):($(f).show().find(".luckysheet-postil-show-main").css({top:D,height:w}),$(f).show().find(".formulaInputFocus").css("margin-top",0),$(f).show().find(".arrowCanvas").css("top",C[1])):($(f).show().find(".luckysheet-postil-show-main").css("top",D+a),$(f).show().find(".arrowCanvas").css("top",C[1]+a)),p>=e.freezenverticaldata[1]?F+k<o?($(f).show().find(".luckysheet-postil-show-main").css("left",F+s),$(f).show().find(".arrowCanvas").css("left",C[0]+s)):F<o+s?F+k<=o+s?T=!1:($(f).show().find(".luckysheet-postil-show-main").css({left:o+s,width:k-(o+s-F)}),$(f).show().find(".formulaInputFocus").css("margin-left",-(o+s-F)),$(f).show().find(".arrowCanvas").hide(),O=!1):($(f).show().find(".luckysheet-postil-show-main").css({left:F,width:k}),$(f).show().find(".formulaInputFocus").css("margin-left",0),$(f).show().find(".arrowCanvas").css("left",C[0])):($(f).show().find(".luckysheet-postil-show-main").css("left",F+s),$(f).show().find(".arrowCanvas").css("left",C[0]+s)),T||$(f).hide(),T&&O&&$(f).show().find(".arrowCanvas").show()})}else if(e.freezenhorizontaldata!=null){let l=e.freezenhorizontaldata[0],o=n-e.freezenhorizontaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(a,s){let u=$(s).attr("id"),f=u.split("luckysheet-postil-show_")[1].split("_")[0],m=u.split("luckysheet-postil-show_")[1].split("_")[1],d=h.flowdata[f][m].ps,p=h.visibledatarow[f],b=f-1==-1?0:h.visibledatarow[f-1],g=h.visibledatacolumn[m],v=m-1==-1?0:h.visibledatacolumn[m-1],x=_t.mergeborer(h.flowdata,f,m);x&&(p=x.row[1],b=x.row[0],g=x.column[1],v=x.column[0]);let _=g,S=b,I=d.left==null?_+18:d.left,P=d.top==null?S-18:d.top,F=d.width==null?Zt.defaultWidth:d.width,D=d.height==null?Zt.defaultHeight:d.height;P<0&&(P=2);let k=Zt.getArrowCanvasSize(I,P,_,S);f>=e.freezenhorizontaldata[1]?P+D<l?($(s).show().find(".luckysheet-postil-show-main").css("top",P+o),$(s).show().find(".arrowCanvas").css("top",k[1]+o)):P<l+o?P+D<=l+o?$(s).hide():($(s).show().find(".luckysheet-postil-show-main").css({top:l+o,height:D-(l+o-P)}),$(s).show().find(".formulaInputFocus").css("margin-top",-(l+o-P)),$(s).show().find(".arrowCanvas").hide()):Zt.buildPs(f,m,d):($(s).show().find(".luckysheet-postil-show-main").css("top",P+o),$(s).show().find(".arrowCanvas").css("top",k[1]+o))})}else if(e.freezenverticaldata!=null){let l=e.freezenverticaldata[0],o=t-e.freezenverticaldata[2];$("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(a,s){let u=$(s).attr("id"),f=u.split("luckysheet-postil-show_")[1].split("_")[0],m=u.split("luckysheet-postil-show_")[1].split("_")[1],d=h.flowdata[f][m].ps,p=h.visibledatarow[f],b=f-1==-1?0:h.visibledatarow[f-1],g=h.visibledatacolumn[m],v=m-1==-1?0:h.visibledatacolumn[m-1],x=_t.mergeborer(h.flowdata,f,m);x&&(p=x.row[1],b=x.row[0],g=x.column[1],v=x.column[0]);let _=g,S=b,I=d.left==null?_+18:d.left,P=d.top==null?S-18:d.top,F=d.width==null?Zt.defaultWidth:d.width,D=d.height==null?Zt.defaultHeight:d.height;P<0&&(P=2);let k=Zt.getArrowCanvasSize(I,P,_,S);m>=e.freezenverticaldata[1]?I+F<l?($(s).show().find(".luckysheet-postil-show-main").css("left",I+o),$(s).show().find(".arrowCanvas").css("left",k[0]+o)):I<l+o?I+F<=l+o?$(s).hide():($(s).show().find(".luckysheet-postil-show-main").css({left:l+o,width:F-(l+o-I)}),$(s).show().find(".formulaInputFocus").css("margin-left",-(l+o-I)),$(s).show().find(".arrowCanvas").hide()):Zt.buildPs(f,m,d):($(s).show().find(".luckysheet-postil-show-main").css("left",I+o),$(s).show().find(".arrowCanvas").css("left",k[0]+o))})}else $("#luckysheet-postil-showBoxs .luckysheet-postil-show").each(function(l,o){let a=$(o).attr("id"),s=a.split("luckysheet-postil-show_")[1].split("_")[0],u=a.split("luckysheet-postil-show_")[1].split("_")[1],f=h.flowdata[s][u].ps;Zt.buildPs(s,u,f)})},scrollAdaptOfdpicon:function(){let e=this,n=Qr.copyRange.row[1],t=Qr.copyRange.column[1],l=Qr.applyRange.row[1],o=Qr.applyRange.column[1],a,s;if(l>=n&&o>=t?(a=l,s=o):(a=n,s=t),e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let u=e.freezenhorizontaldata[1],f=$l(e.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-e.freezenhorizontaldata[2]),m=e.freezenverticaldata[1],d=$l(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);if(a>=u&&s>=m)a<u+f-1||s<m+d-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else if(a>=u)if(a<u+f-1)$("#luckysheet-dropCell-icon").hide();else{let p=or(s+d)[1];$("#luckysheet-dropCell-icon").show().css("left",p)}else if(s>=m)if(s<m+d-1)$("#luckysheet-dropCell-icon").hide();else{let p=Zr(a+f)[1];$("#luckysheet-dropCell-icon").show().css("top",p)}else{let p=Zr(a+f)[1],b=or(s+d)[1];$("#luckysheet-dropCell-icon").show().css({left:b,top:p})}}else if(e.freezenhorizontaldata!=null){let u=e.freezenhorizontaldata[1],f=$l(e.freezenhorizontaldata[3],$("#luckysheet-cell-main").scrollTop()-e.freezenhorizontaldata[2]);if(a>=u)a<u+f-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else{let m=Zr(a+f)[1];$("#luckysheet-dropCell-icon").show().css("top",m)}}else if(e.freezenverticaldata!=null){let u=e.freezenverticaldata[1],f=$l(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);if(s>=u)s<u+f-1?$("#luckysheet-dropCell-icon").hide():$("#luckysheet-dropCell-icon").show();else{let m=or(s+f)[1];$("#luckysheet-dropCell-icon").show().css("left",m)}}else{let u=Zr(a)[1],f=or(s)[1];$("#luckysheet-dropCell-icon").show().css({left:f,top:u})}},scrollAdaptOffilteroptions:function(){let e=this;if(e.freezenhorizontaldata!=null&&e.freezenverticaldata!=null){let n=e.freezenhorizontaldata[1],t=e.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop(),l=e.freezenverticaldata[1],o=$l(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(a,s){let u=$(s).data("str"),f=u-1==-1?0:h.visibledatarow[u-1],m=$(s).data("cindex");if(u>=n&&m>=l)f<t||m<l+o?$(s).hide():$(s).show();else if(u>=n)if(f<t)$(s).hide();else{let d=h.visibledatacolumn[m+o]-20;$(s).show().css("left",d)}else if(m>=l)m<l+o?$(s).hide():$(s).show().css("top",f+$("#luckysheet-cell-main").scrollTop());else{let d=h.visibledatacolumn[m+o]-20;$(s).show().css({left:d,top:f+$("#luckysheet-cell-main").scrollTop()})}})}else if(e.freezenhorizontaldata!=null){let n=e.freezenhorizontaldata[1],t=e.freezenhorizontaldata[0]+$("#luckysheet-cell-main").scrollTop();$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(l,o){let a=$(o).data("str"),s=a-1==-1?0:h.visibledatarow[a-1];a>=n?s<t?$(o).hide():$(o).show():$(o).show().css("top",s+$("#luckysheet-cell-main").scrollTop())})}else if(e.freezenverticaldata!=null){let n=e.freezenverticaldata[1],t=$l(e.freezenverticaldata[3],$("#luckysheet-cell-main").scrollLeft()-e.freezenverticaldata[2]);$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(l,o){let a=$(o).data("cindex");if(a>=n)a<n+t?$(o).hide():$(o).show();else{let s=h.visibledatacolumn[a+t]-20;$(o).show().css("left",s)}})}else $("#luckysheet-filter-options-sheet"+h.currentSheetIndex).empty(),fi(h.luckysheetfile[Me(h.currentSheetIndex)].filter_select)},saveFrozen:function(e,n,t={}){n==null&&(n=Me(h.currentSheetIndex));let l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],o=l.row_focus==null?l.row[0]:l.row_focus,a=l.column_focus==null?l.column[0]:l.column_focus,s={row_focus:t.row_focus||o,column_focus:t.column_focus||a},u={freezenRow:{type:"row"},freezenColumn:{type:"column"},freezenRC:{type:"both"},freezenRowRange:{type:"rangeRow",range:s},freezenColumnRange:{type:"rangeColumn",range:s},freezenRCRange:{type:"rangeBoth",range:s},freezenCancel:{type:"cancel"}};h.luckysheetfile[n].frozen=u[e]},frozenTofreezen:function(){let e=h.luckysheetfile[Me(h.currentSheetIndex)],n=e.frozen;if(n==null)return;let t=null;if(n.type==="row"){let l=0,o=$l(h.visibledatarow,l);o==-1&&(o=0);let a=h.visibledatarow[o]-2-l+h.columnHeaderHeight;t={horizontal:{freezenhorizontaldata:[h.visibledatarow[o],o+1,l,$a.cutVolumn(h.visibledatarow,o+1),a],top:a}}}else if(n.type==="column"){let l=0,o=$l(h.visibledatacolumn,l);o==-1&&(o=0);let a=h.visibledatacolumn[o]-2-l+h.rowHeaderWidth;t={vertical:{freezenverticaldata:[h.visibledatacolumn[o],o+1,l,$a.cutVolumn(h.visibledatacolumn,o+1),a],left:a}}}else if(n.type==="both"){let l=0,o=$l(h.visibledatarow,l);o==-1&&(o=0);let a=h.visibledatarow[o]-2-l+h.columnHeaderHeight,s=[h.visibledatarow[o],o+1,l,$a.cutVolumn(h.visibledatarow,o+1),a],u=0,f=$l(h.visibledatacolumn,u);f==-1&&(f=0);let m=h.visibledatacolumn[f]-2-u+h.rowHeaderWidth,d=[h.visibledatacolumn[f],f+1,u,$a.cutVolumn(h.visibledatacolumn,f+1),m];t={horizontal:{freezenhorizontaldata:s,top:a},vertical:{freezenverticaldata:d,left:m}}}else if(n.type==="rangeRow"){let l=0,o=$l(h.visibledatarow,l),a=n.range.row_focus;a>o&&(o=a),o==-1&&(o=0);let s=h.visibledatarow[o]-2-l+h.columnHeaderHeight;t={horizontal:{freezenhorizontaldata:[h.visibledatarow[o],o+1,l,$a.cutVolumn(h.visibledatarow,o+1),s],top:s}}}else if(n.type==="rangeColumn"){let l=0,o=$l(h.visibledatacolumn,l),a=n.range.column_focus;a>o&&(o=a),o==-1&&(o=0);let s=h.visibledatacolumn[o]-2-l+h.rowHeaderWidth;t={vertical:{freezenverticaldata:[h.visibledatacolumn[o],o+1,l,$a.cutVolumn(h.visibledatacolumn,o+1),s],left:s}}}else if(n.type==="rangeBoth"){let l=0,o=$l(h.visibledatarow,l),a=n.range.row_focus;a>o&&(o=a),o==-1&&(o=0);let s=h.visibledatarow[o]-2-l+h.columnHeaderHeight,u=[h.visibledatarow[o],o+1,l,$a.cutVolumn(h.visibledatarow,o+1),s],f=0,m=$l(h.visibledatacolumn,f),d=n.range.column_focus;d>m&&(m=d),m==-1&&(m=0);let p=h.visibledatacolumn[m]-2-f+h.rowHeaderWidth,b=[h.visibledatacolumn[m],m+1,f,$a.cutVolumn(h.visibledatacolumn,m+1),p];t={horizontal:{freezenhorizontaldata:u,top:s},vertical:{freezenverticaldata:b,left:p}}}else n.type==="cancel"&&(t={horizontal:null,vertical:null});e.freezen=t}},Ie=$a});function mr(e=!0){ut.showinfobar?($("#luckysheet_info_detail").show(),h.infobarHeight=document.querySelector("#luckysheet_info_detail").offsetHeight):(h.infobarHeight=0,$("#luckysheet_info_detail").hide()),!!h.toobarObject&&!!h.toobarObject.toobarElements&&h.toobarObject.toobarElements.length===0?($("#"+h.container).find(".luckysheet-wa-editor").hide(),h.toolbarHeight=0):($("#"+h.container).find(".luckysheet-wa-editor").show(),h.toolbarHeight=document.querySelector("#"+h.container+" .luckysheet-wa-editor").offsetHeight),Gx(),Yx();let n=document.querySelector("#"+h.container+" .luckysheet-wa-calculate");ut.sheetFormulaBar?(n.style.display="block",h.calculatebarHeight=n.offsetHeight):(n.style.display="none",h.calculatebarHeight=0),$("#"+h.container).find(".luckysheet-grid-container").css("top",h.toolbarHeight+h.infobarHeight+h.calculatebarHeight),Fs=$("#"+h.container).width(),ut.showConfigWindowResize&&($("#luckysheet-modal-dialog-slider-pivot").is(":visible")?Fs-=$("#luckysheet-modal-dialog-slider-pivot").outerWidth():$(".chartSetting").is(":visible")?Fs-=$(".chartSetting").outerWidth():$("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")&&(Fs-=$("#luckysheet-modal-dialog-slider-alternateformat").outerWidth()),$("#luckysheet-modal-dialog-slider-protection").is(":visible")&&(Fs-=$("#luckysheet-modal-dialog-slider-protection").outerWidth()));let l=Be().toolbar,o=!1,a=0,s=`<div class="luckysheet-toolbar-button luckysheet-inline-block" data-tips="${l.toolMoreTip}" id="luckysheet-icon-morebtn" role="button" style="user-select: none;">
            <div class="luckysheet-toolbar-button-outer-box luckysheet-inline-block" style="user-select: none;">
                <div class="luckysheet-toolbar-button-inner-box luckysheet-inline-block" style="user-select: none;">

                    <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                        ${l.toolMore}
                    </div>
                    <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige" style="user-select: none;font-size:12px;">
                    </div>

                </div>
            </div>
         </div>`,u='<div id="luckysheet-icon-morebtn-div" class="luckysheet-wa-editor" style="position:absolute;top:'+(h.infobarHeight+h.toolbarHeight+$("#"+h.container).offset().top+$("body").first().scrollTop())+'px;right:0px;z-index:1003;padding:5.5px;visibility:hidden;height:auto;white-space:initial;"></div>';$("#luckysheet-icon-morebtn-div").length==0&&$("body").first().append(u),tl("#luckysheet-icon-morebtn-div").style.visibility="hidden",$("#luckysheet-icon-morebtn-div > div").each(function(){let p=$(this)[0],b=$("#luckysheet-wa-editor")[0];b.appendChild(document.createTextNode(" ")),b.appendChild(p)}),$("#luckysheet-icon-morebtn").remove();let f=h.toobarObject.toobarWidths,m=h.toobarObject.toobarElements,d=0;if(f!=null){for(let p=f.length-1;p>=0;p--)if(f[p]<Fs-90){d=p,d<f.length-1&&(o=!0);break}for(let p=d;p<m.length;p++){let b=m[p];if(b instanceof Array)for(let g of b)$("#luckysheet-icon-morebtn-div").append($(`${g}`));else $("#luckysheet-icon-morebtn-div").append($(`${b}`))}o&&($("#luckysheet-wa-editor").append(s),$("#luckysheet-icon-morebtn").click(function(){tl("#luckysheet-icon-morebtn-div").style.left="";let p=tl(`#${h.container}`).getBoundingClientRect?tl(`#${h.container}`).getBoundingClientRect().left:0;tl("#luckysheet-icon-morebtn-div").getBoundingClientRect().left<p&&(tl("#luckysheet-icon-morebtn-div").style.left=p+"px");let g=$(window).width()-$("#luckysheet-icon-morebtn").offset().left-$("#luckysheet-icon-morebtn").width()+$("body").first().scrollLeft();if(tl("#luckysheet-icon-morebtn-div").style.right=g<0?0:g+"px",tl("#luckysheet-icon-morebtn-div").style.visibility==="hidden"?tl("#luckysheet-icon-morebtn-div").style.visibility="visible":tl("#luckysheet-icon-morebtn-div").style.visibility="hidden",$(this).find(".luckysheet-toolbar-menu-button-caption").text().indexOf(l.toolMore)>-1){let x=`
                <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                    ${l.toolClose}
                </div>
                <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-shangyige" style="user-select: none;font-size:12px;">
                </div>
                `;$(this).find(".luckysheet-toolbar-button-inner-box").html(x)}else{let x=`
                <div class="luckysheet-toolbar-menu-button-caption luckysheet-inline-block" style="user-select: none;">
                    ${l.toolMore}
                </div>
                <div class="luckysheet-toolbar-menu-button-dropdown luckysheet-inline-block iconfont luckysheet-iconfont-xiayige" style="user-select: none;font-size:12px;">
                </div>
                `;$(this).find(".luckysheet-toolbar-button-inner-box").html(x)}}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#luckysheet-icon-morebtn-div .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")}),ke.createHoverTip("#luckysheet-icon-morebtn-div",".luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button")),$("#"+h.container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".luckysheet-toolbar-button-split-right").addClass("luckysheet-toolbar-button-split-right-hover")},function(){$(this).next(".luckysheet-toolbar-button-split-right").removeClass("luckysheet-toolbar-button-split-right-hover")}),$("#"+h.container+" .luckysheet-wa-editor .luckysheet-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".luckysheet-toolbar-button-split-left").addClass("luckysheet-toolbar-button-hover")},function(){$(this).prev(".luckysheet-toolbar-button-split-left").removeClass("luckysheet-toolbar-button-hover")}),Lm=$("#"+h.container).height(),$("#"+h.container).find(".luckysheet").height(Lm-2).width(Fs-2),Hm(Fs,Lm),e&&Xt($("#luckysheet-cell-main").scrollLeft(),$("#luckysheet-cell-main").scrollTop()),kt.sheetArrowShowAndHide(),kt.sheetBarShowAndHide()}}function Hm(e,n){e==null&&(e=$("#"+h.container).width()),n==null&&(n=$("#"+h.container).height()),h.cellmainHeight=n-(h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight+h.sheetBarHeight+h.statisticBarHeight),h.cellmainWidth=e-h.rowHeaderWidth,$("#luckysheet-cols-h-c, #luckysheet-cell-main").width(h.cellmainWidth),$("#luckysheet-cell-main").height(h.cellmainHeight),$("#luckysheet-rows-h").height(h.cellmainHeight-h.cellMainSrollBarSize),$("#luckysheet-scrollbar-y").height(h.cellmainHeight+h.columnHeaderHeight-h.cellMainSrollBarSize-3),$("#luckysheet-scrollbar-x").height(h.cellMainSrollBarSize),$("#luckysheet-scrollbar-y").width(h.cellMainSrollBarSize),$("#luckysheet-scrollbar-x").width(h.cellmainWidth).css("left",h.rowHeaderWidth-2),h.luckysheetTableContentHW=[h.cellmainWidth+h.rowHeaderWidth-h.cellMainSrollBarSize,h.cellmainHeight+h.columnHeaderHeight-h.cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(h.luckysheetTableContentHW[0]*h.devicePixelRatio),height:Math.ceil(h.luckysheetTableContentHW[1]*h.devicePixelRatio)}).css({width:h.luckysheetTableContentHW[0],height:h.luckysheetTableContentHW[1]}),$("#"+h.container).find("#luckysheet-grid-window-1").css("bottom",h.sheetBarHeight),$("#"+h.container).find(".luckysheet-grid-window").css("bottom",h.statisticBarHeight);let t=$("#luckysheet-grid-window-1").width();$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({width:t-10}).end().find(".luckysheet-freezebar-horizontal-drop").css({width:t-10});let l=$("#luckysheet-grid-window-1").height();$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({height:l-10}).end().find(".luckysheet-freezebar-vertical-drop").css({height:l-10}),Ie.createAssistCanvas()}function Hy(){let e=ut.showtoolbar,n=ut.showtoolbarConfig,t=h.toobarObject.toobarWidths=[],l=h.toobarObject.toobarElements=[],o=h.toobarObject.toolbarConfig=a();function a(){let f={};function m(p){let b={},g,v,x=0;for(let _=0;_<p.length;_++)g=p[_],v=p[_+1],g!=="|"&&(b[g]={ele:qd[g],index:x++}),v==="|"&&(G(b[g].ele)==="array"?b[g].ele.push(`#toolbar-separator-${ms(g)}`):b[g].ele=[b[g].ele,`#toolbar-separator-${ms(g)}`]);return b}if(G(n)==="array")return e?m(n):f;let d=Vo.reduce(function(p,b){return b!=="|"&&(p[b]=!0),p},{});if(!e)for(let p in d)d[p]=!1;if(JSON.stringify(n)!=="{}"){n.hasOwnProperty("undoRedo")&&(d.undo=d.redo=n.undoRedo),Object.assign(d,n);let p,b,g=0;for(let v=0;v<Vo.length;v++)p=Vo[v],b=Vo[v+1],d[p]!==!1&&(p!=="|"&&d[p]&&(f[p]={ele:qd[p],index:g++}),b==="|"&&(G(f[p].ele)==="array"?f[p].ele.push(`#toolbar-separator-${ms(p)}`):f[p].ele=[f[p].ele,`#toolbar-separator-${ms(p)}`]))}else f=e?m(Vo):{};return f}for(let f in o)Object.prototype.hasOwnProperty.call(o,f)&&l.push($.extend(!0,{},o[f]));l.sort(s);function s(f,m){return f.index>m.index?1:-1}l.forEach((f,m,d)=>{d[m]=f.ele,m!==l.length-1?f.ele instanceof Array?t.push($(f.ele[0]).offset().left):t.push($(f.ele).offset().left):f.ele instanceof Array?(t.push($(f.ele[0]).offset().left),t.push($(f.ele[0]).offset().left+$(f.ele[0]).outerWidth()+5)):(t.push($(f.ele).offset().left),t.push($(f.ele).offset().left+$(f.ele).outerWidth()+5))});let u=$("#"+h.container).offset().left;t.forEach((f,m)=>{t[m]-=u})}function Gx(){if(!ut.initShowsheetbarConfig){ut.initShowsheetbarConfig=!0;let t={add:!0,menu:!0,sheet:!0};if(!ut.showsheetbar)for(let l in t)t[l]=!1;JSON.stringify(ut.showsheetbarConfig)!=="{}"&&Object.assign(t,ut.showsheetbarConfig),ut.showsheetbarConfig=t}let e=ut.showsheetbarConfig,n=0;for(let t in e)if(!e[t])switch(t){case"add":$("#luckysheet-sheets-add").hide(),n++;break;case"menu":$("#luckysheet-sheets-m").hide(),n++;break;case"sheet":$("#luckysheet-sheet-container").hide(),$("#luckysheet-sheets-leftscroll").hide(),$("#luckysheet-sheets-rightscroll").hide(),n++;break;default:break}n===3?($("#"+h.container).find("#luckysheet-sheet-area").hide(),h.sheetBarHeight=0):($("#"+h.container).find("#luckysheet-sheet-area").show(),h.sheetBarHeight=31)}function Yx(){if(!ut.initStatisticBarConfig){ut.initStatisticBarConfig=!0;let t={count:!0,view:!0,zoom:!0};if(!ut.showstatisticBar)for(let l in t)t[l]=!1;JSON.stringify(ut.showstatisticBarConfig)!=="{}"&&Object.assign(t,ut.showstatisticBarConfig),ut.showstatisticBarConfig=t}let e=ut.showstatisticBarConfig,n=0;for(let t in e)if(!e[t])switch(t){case"count":$("#luckysheet-sta-content").hide(),n++;break;case"view":$(".luckysheet-print-viewList").hide(),n++;break;case"zoom":$("#luckysheet-zoom-content").hide(),n++;break;default:break}n===3?($("#"+h.container).find(".luckysheet-stat-area").hide(),h.statisticBarHeight=0):($("#"+h.container).find(".luckysheet-stat-area").show(),h.statisticBarHeight=23)}var import_plugin,Fs,Lm,ho=Nt(()=>{import_plugin=qe(Ye());Vn();Di();Ar();il();Xl();kn();Kr();Ol();Ud();Fs=0,Lm=0});function Uy(e){let n=Be(),t=n.protection,l=n.button,o=e.name,a=e.sqref,s=e.password,u="";s!=null&&s.length>0&&(u='<i class="icon iconfont luckysheet-iconfont-bianji2" title="'+t.rangeItemHasPassword+'"></i>');let f=`
        <div class="luckysheet-protection-rangeItem" title="${t.rangeItemDblclick}">
            <div class="luckysheet-protection-rangeItem-del" title="${l.delete}">
                <i class="icon iconfont luckysheet-iconfont-shanchu"></i>
            </div>
            <div class="luckysheet-protection-rangeItem-name" title="${o}">
                ${o}${u}
            </div>
            <div class="luckysheet-protection-rangeItem-range" title="${a}">
                ${a}
            </div>
            <div class="luckysheet-protection-rangeItem-update" title="${l.update}">
                <i class="icon iconfont luckysheet-iconfont-bianji"></i>
            </div>
        </div>
    `;$("#luckysheet-protection-rangeItem-container").append(f)}function Xx(e){let n=Be(),t=n.protection,l=n.button;$("#luckysheet-slider-protection-ok").click(function(){let o=$("#protection-password").val(),a=$("#protection-swichProtectionState").is(":checked"),s=$("#protection-hint").val(),u=Wy,f={};u!=null&&u.config!=null&&u.config.authority!=null&&(f=u.config.authority);let m={},d="None";o!="\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"?(m.password=o,m.algorithmName="None",m.saltValue=null):f!=null?(m.algorithmName=f.algorithmName,m.saltValue=f.saltValue,m.password=f.password):(m.algorithmName="None",m.saltValue=null,m.password=""),m.hintText=s,m.sheet=a==!0?1:0;for(let p=0;p<lu.length;p++){let b=lu[p],g="luckysheet-protection-check-"+b,v=$("#"+g).is(":checked");m[b]=v==!0?1:0}m.allowRangeList=Sa,Sa=[],Bm=!0,u.config==null&&(u.config={}),u.config.authority=m,Vm={},Xy()}),$("#luckysheet-slider-protection-cancel, #luckysheet-modal-dialog-protection-close").click(function(){Xy()}),$("#luckysheet-slider-protection-addRange").click(function(){Gy(),jm=!0,$("#luckysheet-protection-rangeItem-confirm").html(l.insert),cc("luckysheet-protection-rangeItem-dialog"),$("#protection-allowRangeAdd-title").val("Default"+Sa.length),$("#protection-allowRangeAdd-range input").val(""),$("#protection-allowRangeAdd-password").val(""),$("#protection-allowRangeAdd-hint").val("")}),$(document).off("click.luckysheetProtection.rangeItemUpdate").on("click.luckysheetProtection.rangeItemUpdate","#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-update",function(o){Gy(),jm=!1,$("#luckysheet-protection-rangeItem-confirm").html(l.update),cc("luckysheet-protection-rangeItem-dialog");let a=$(o.target).closest(".luckysheet-protection-rangeItem"),u=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").index(a),f=Sa[u];Vy=u,$("#protection-allowRangeAdd-title").val(f.name),$("#protection-allowRangeAdd-range input").val(f.sqref),f.algorithmName=="None"?$("#protection-allowRangeAdd-password").val(f.password):$("#protection-allowRangeAdd-password").val("\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"),$("#protection-allowRangeAdd-hint").val(f.hintText)}),$(document).off("click.luckysheetProtection.rangeItemDelete").on("click.luckysheetProtection.rangeItemDelete","#luckysheet-protection-rangeItem-container .luckysheet-protection-rangeItem-del",function(o){let a=$(o.target).closest(".luckysheet-protection-rangeItem"),u=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").index(a),f=Sa[u];Sa.splice(u,1),a.remove()}),$(document).off("click.luckysheetProtection.rangeItemConfirm").on("click.luckysheetProtection.rangeItemConfirm","#luckysheet-protection-rangeItem-confirm",function(){let o=$("#protection-allowRangeAdd-title").val(),a=$("#protection-allowRangeAdd-range input").val(),s=$("#protection-allowRangeAdd-password").val(),u=$("#protection-allowRangeAdd-hint").val();if(o.length==0){alert(t.rangeItemErrorTitleNull);return}let f=ll.getRangeByTxt(a);if(a.length==0){alert(t.rangeItemErrorRangeNull);return}if(f.length==0){alert(t.rangeItemErrorRange);return}if(a=Zy(a),jm){let m={name:o,password:s,hintText:u,algorithmName:"None",saltValue:null,checkRangePasswordUrl:null,sqref:a};Uy(m),Sa.push(m)}else{let m=Vy,d=Sa[m];d.name=o,d.sqref=a,d.hintText=u,s!="\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"&&(d.password=s,d.algorithmName="None");let b=$("#luckysheet-protection-rangeItem-container").find("> div.luckysheet-protection-rangeItem").eq(m),g=b.find(".luckysheet-protection-rangeItem-name"),v="";s!=null&&s.length>0&&(v='<i class="icon iconfont luckysheet-iconfont-bianji2" title="'+t.rangeItemHasPassword+'"></i>'),g.html(o+v).attr("title",o),b.find(".luckysheet-protection-rangeItem-range").html(a).attr("title",a)}$("#luckysheet-protection-rangeItem-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide()}),$(document).off("click.luckysheetProtection.validationConfirm").on("click.luckysheetProtection.validationConfirm","#luckysheet-protection-sheet-validation-confirm",function(o){let a=$("#luckysheet-protection-sheet-validation"),s=_h;if(s==null){Wm(_h),a.hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-protection").show(),mr();return}let f=a.find("input").val();if(f==null||f.length==0){alert(t.checkPasswordNullalert);return}if(s.algorithmName!=null&&s.algorithmName!="None")if(s.saltValue!=null&&s.saltValue.length>0){var m=CryptoApi.getHasher(s.algorithmName);f=CryptoApi.hmac(s.saltValue,f,m)}else f=CryptoApi.hash(s.algorithmName,f);f==s.password?(Wm(_h),a.hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-modal-dialog-slider-protection").show(),mr(),Bm=!1):alert(t.checkPasswordWrongalert)}),$("#luckysheet-protection-check-selectLockedCells").change(function(){let o=$("#luckysheet-protection-check-selectLockedCells"),a=$("#luckysheet-protection-check-selectunLockedCells"),s=o.is(":checked"),u=a.is(":checked");s&&a.prop("checked",!0)}),$("#luckysheet-protection-check-selectunLockedCells").change(function(){let o=$("#luckysheet-protection-check-selectLockedCells"),a=$("#luckysheet-protection-check-selectunLockedCells"),s=o.is(":checked");a.is(":checked")||o.prop("checked",!1)}),$(document).off("click.luckysheetProtection.dvRange").on("click.luckysheetProtection.dvRange","#protection-allowRangeAdd-range .fa-table",function(o){$("#luckysheet-protection-rangeItem-dialog").hide();let a="0",s=$(this).siblings("input").val().trim();ll.rangeDialog(a,s),ll.selectRange=[];let u=ll.getRangeByTxt(s);if(u.length>0)for(let f=0;f<u.length;f++){let m=u[f].row[0],d=u[f].row[1],p=u[f].column[0],b=u[f].column[1],g=h.visibledatarow[d],v=m-1==-1?0:h.visibledatarow[m-1],x=h.visibledatacolumn[b],_=p-1==-1?0:h.visibledatacolumn[p-1];ll.selectRange.push({left:_,width:x-_-1,top:v,height:g-v-1,left_move:_,width_move:x-_-1,top_move:v,height_move:g-v-1,row:[m,d],column:[p,b],row_focus:m,column_focus:p})}gr(ll.selectRange)}),$(document).off("click.luckysheetProtection.dvRange2").on("click.luckysheetProtection.dvRange2","#luckysheet-protection-rangeItem-dialog .show-box-item-dropdown .range .fa-table",function(o){$("#luckysheet-protection-rangeItem-dialog").hide();let a="1",s=$(this).siblings("input").val().trim();ll.rangeDialog(a,s),ll.selectRange=[];let u=ll.getRangeByTxt(s);if(u.length>0)for(let f=0;f<u.length;f++){let m=u[f].row[0],d=u[f].row[1],p=u[f].column[0],b=u[f].column[1],g=h.visibledatarow[d],v=m-1==-1?0:h.visibledatarow[m-1],x=h.visibledatacolumn[b],_=p-1==-1?0:h.visibledatacolumn[p-1];ll.selectRange.push({left:_,width:x-_-1,top:v,height:g-v-1,left_move:_,width_move:x-_-1,top_move:v,height_move:g-v-1,row:[m,d],column:[p,b],row_focus:m,column_focus:p})}gr(ll.selectRange)}),$(document).off("click.luckysheetProtection.dvRangeConfirm").on("click.luckysheetProtection.dvRangeConfirm","#luckysheet-dataVerificationRange-dialog-confirm",function(o){let a=$(this).parents("#luckysheet-dataVerificationRange-dialog").find("input").val(),s=$("#protection-allowRangeAdd-range input"),u=s.val();u.substr(u.length-1,1)==","?s.val(u+a):s.val(a),$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),gr([])}),$(document).off("click.luckysheetProtection.dvRangeClose").on("click.dvRangeClose","#luckysheet-dataVerificationRange-dialog-close",function(o){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),gr([])}),$(document).on("click.luckysheetProtection.luckysheetProtection","#luckysheet-dataVerificationRange-dialog .luckysheet-modal-dialog-title-close",function(o){$("#luckysheet-dataVerificationRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-protection-rangeItem-dialog").show(),gr([])})}function Gy(e){if(By)return;By=!0;let n=Be(),t=n.protection,l=n.button;$("body").first().append(Tt(Ll,{id:"luckysheet-protection-rangeItem-dialog",addclass:"luckysheet-protection-rangeItem-dialog",title:t.allowRangeTitle,content:`
            <div class="luckysheet-protection-rangeItem-content">
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddTitle}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <input class="luckysheet-protection-rangeItemiInput" id="protection-allowRangeAdd-title"  placeHolder="${t.allowRangeAddtitleDefault}">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddSqrf}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <div id="protection-allowRangeAdd-range" class="range">
                            <input class="formulaInputFocus" spellcheck="false" placeHolder="${t.selectCellRangeHolder}">
                            <i class="fa fa-table" aria-hidden="true" title="${t.selectCellRange}"></i>
                        </div>
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddTitlePassword}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <input class="luckysheet-protection-rangeItemiInput" id="protection-allowRangeAdd-password"  placeHolder="${t.enterPassword}">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x">
                        ${t.allowRangeAddTitleHint}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:30%">
                        <textarea class="luckysheet-protection-rangeItemTextarea" id="protection-allowRangeAdd-hint"  placeHolder="${t.allowRangeAddTitleHintTitle}"></textarea>
                    </div>
                </div>
            </div>
        `,botton:`<button id="luckysheet-protection-rangeItem-confirm" class="btn btn-primary">${l.insert}</button>
                    <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:100003"}))}function Zx(e){let n=Be(),t=n.protection,l=n.button,o="";for(let s=0;s<lu.length;s++){let u=lu[s];o+=`
            <div class="luckysheet-slider-protection-row" style="height:18px;">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                <label for="luckysheet-protection-check-${u}"><input id="luckysheet-protection-check-${u}" name="luckysheet-protection-check-${u}" type="checkbox">${t[u]}</label>
                </div>
            </div>
        `}let a=`
    <div id="luckysheet-modal-dialog-slider-protection" class="luckysheet-modal-dialog-slider luckysheet-modal-dialog-slider-pivot" style="display:none;">
        <div class="luckysheet-modal-dialog-slider-title"> <span>${t.protectiontTitle}</span> <span id="luckysheet-modal-dialog-protection-close" title="${l.close}"><i class="fa fa-times" aria-hidden="true"></i></span> </div>
        <div class="luckysheet-modal-dialog-slider-content">
            <div class="luckysheet-slider-protection-config" style="top:10px;height:115px">
                <div class="luckysheet-slider-protection-row">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    <label for="protection-swichProtectionState"><input id="protection-swichProtectionState" name="protection-swichProtectionState" type="checkbox">${t.swichProtectionTip}</label>
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="height:23px;">
                    <div class="luckysheet-slider-protection-column" style="width:98%;">
                        <input class="luckysheet-protection-input" id="protection-password"  placeHolder="${t.enterPassword}">
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="height:47px;margin-top:4px;">
                    <div class="luckysheet-slider-protection-column" style="width:98%;">
                        <textarea class="luckysheet-protection-textarea" id="protection-hint"  placeHolder="${t.enterHint}"></textarea>
                    </div>
                </div>
            </div>
            <div class="luckysheet-slider-protection-config" style="top:130px;height:290px;border-top:1px solid #c5c5c5">
                <div class="luckysheet-slider-protection-row" style="height:20px;">
                    ${t.authorityTitle}
                </div>
                ${o}
            </div>
            <div class="luckysheet-slider-protection-config" style="top:440px;bottom:45px;border-top:1px solid #c5c5c5">
                <div class="luckysheet-slider-protection-row" style="height:25px;">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-7x" style="left:0px;line-height: 25px;">
                        ${t.allowRangeTitle}
                    </div>
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-3x" style="left:70%;">
                        <div class="luckysheet-slider-protection-ok luckysheet-slider-protection-addRange" id="luckysheet-slider-protection-addRange">
                            ${t.allowRangeAdd}
                        </div>
                    </div>
                </div>

                <div id="luckysheet-protection-rangeItem-container" class="luckysheet-slider-protection-row" style="top:25px;bottom:0px;position:absolute">
                   
                </div>
            </div>
            <div class="luckysheet-slider-protection-config" style="bottom:0px;height:45px">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-5x" style="left:0px;">
                    <div class="luckysheet-slider-protection-ok" id="luckysheet-slider-protection-ok">
                        ${l.confirm}
                    </div>
                </div>
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-5x" style="left:50%;">
                    <div class="luckysheet-slider-protection-cancel" id="luckysheet-slider-protection-cancel">
                        ${l.cancel}
                    </div>
                </div>
            </div>
        </div>
    </div>
    `;$("body").first().append(a),$("body").first().append(Tt(Ll,{id:"luckysheet-protection-sheet-validation",addclass:"luckysheet-protection-sheet-validation",title:t.validationTitle,content:`
            <div class="luckysheet-slider-protection-row">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    ${t.validationTips}
                </div>
            </div>
            <div class="luckysheet-slider-protection-row" style="margin-top:20px">
                <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                    <input type="password" class="luckysheet-protection-rangeItemiInput" placeHolder="${t.validationInputHint}">
                </div>
            </div>
        `,botton:`<button id="luckysheet-protection-sheet-validation-confirm" class="btn btn-primary">${l.confirm}</button>
                    <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:100003"}))}function Wm(e){e==null&&(e={});for(let o=0;o<lu.length;o++){let a=lu[o],s="luckysheet-protection-check-"+a,u=e[a];u==null&&(u=0),u==null&&a in{selectLockedCells:1,selectunLockedCells:1}&&(u=1),$("#"+s).prop("checked",u==1)}e.password!=null&&e.password.length>0?e.algorithmName=="None"||e.algorithmName==null?$("#protection-password").val(e.password):$("#protection-password").val("\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"):$("#protection-password").val("");let n=e.sheet;e.sheet==null&&(n=0),$("#protection-swichProtectionState").prop("checked",n==1);let t=e.hintText;t==null&&(t=""),$("#protection-hint").val(t),Sa=[],$("#luckysheet-protection-rangeItem-container").empty();let l=e.allowRangeList;if(l!=null&&l.length>0)for(let o=0;o<l.length;o++){let a=l[o];Uy(a),Sa.push(a)}}function Yy(e){if(jy||(Zx(e),Xx(e),jy=!0),Wy=e,e!=null&&e.config!=null&&e.config.authority!=null){let n=e.config.authority;if(Bm&&n.sheet==1&&n.password!=null&&n.password.length>0){_h=n,$("#luckysheet-protection-sheet-validation input").val(""),cc("luckysheet-protection-sheet-validation");return}else Wm(n)}else $("#luckysheet-protection-check-selectLockedCells").prop("checked",!0),$("#luckysheet-protection-check-selectunLockedCells").prop("checked",!0);$("#luckysheet-modal-dialog-slider-protection").show(),mr()}function Xy(){$("#luckysheet-protection-rangeItem-dialog").hide(),$("#luckysheet-modal-dialog-slider-protection").hide(),mr()}function qm(e,n,t,l,o=!0,a=!0){let s=!1,u=t.allowRangeList;if(u!=null&&u.length>0){let f=!1;for(let m=0;m<u.length;m++){let d=u[m],p=d.sqref,b=ll.getRangeByTxt(p);if(b.length>0)for(let g=0;g<b.length;g++){let v=b[g].row[0],x=b[g].row[1],_=b[g].column[0],S=b[g].column[1];if(e>=v&&e<=x&&n>=_&&n<=S){f=!0;break}}if(f){let g=d.password;if(g!=null&&g.length>0&&!(p in Vm))return o&&(Kx(d),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide()),!1;s=!0;break}}}if(!s&&!a&&(s=!0),!s&&o){let f;t.hintText!=null&&t.hintText.length>0?f=t.hintText:f=l.defaultSheetHintText,ke.info("",f),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide()}return s}function Kx(e){let n=Be(),t=n.protection,l=n.button;qy||$("body").first().append(Tt(Ll,{id:"luckysheet-protection-range-validation",addclass:"luckysheet-protection-sheet-validation",title:t.validationTitle,content:`
                <div class="luckysheet-slider-protection-row">
                    <div id="luckysheet-protection-range-validation-hint" class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                        
                    </div>
                </div>
                <div class="luckysheet-slider-protection-row" style="margin-top:20px">
                    <div class="luckysheet-slider-protection-column luckysheet-protection-column-10x">
                        <input type="password" class="luckysheet-protection-rangeItemiInput" placeHolder="${t.validationInputHint}">
                    </div>
                </div>
            `,botton:`<button id="luckysheet-protection-range-validation-confirm" class="btn btn-primary">${l.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:100003"})),qy=!0,cc("luckysheet-protection-range-validation");let o=$("#luckysheet-protection-range-validation-hint");e.hintText!=null&&e.hintText.length>0?o.html(e.hintText):o.html(t.defaultRangeHintText);let a=$("#luckysheet-protection-range-validation"),s=a.find("input");s.val(""),$("#luckysheet-protection-range-validation-confirm").off("click").on("click",function(){let u=s.val();if(u==null||u.length==0){alert(t.checkPasswordNullalert);return}if(e.algorithmName!=null&&e.algorithmName!="None")if(e.saltValue!=null&&e.saltValue.length>0){var f=CryptoApi.getHasher(e.algorithmName);u=CryptoApi.hmac(e.saltValue,u,f)}else u=CryptoApi.hash(e.algorithmName,u);u==e.password?(Vm[e.sqref]=1,a.hide(),$("#luckysheet-modal-dialog-mask").hide(),alert(t.checkPasswordSucceedalert)):alert(t.checkPasswordWrongalert)})}function ea(e){let n=kt.getSheetByIndex(e);if(n==null||n.config==null||n.config.authority==null)return!0;let t=n.config.authority;if(t==null||t.sheet==null||t.sheet==0)return!0;let o=Be().protection,a;return t.hintText!=null&&t.hintText.length>0?a=t.hintText:a=o.defaultSheetHintText,ke.info("",a),!1}function Qa(e,n,t,l=!0,o=!0){let a=kt.getSheetByIndex(t);if(a==null||a.config==null||a.config.authority==null)return!0;let s=a.data,u=s[e][n],f=a.config.authority;if(f==null||f.sheet==null||f.sheet==0||u&&u.lo===0)return!0;let d=Be().protection;return qm(e,n,f,d,l,o)}function Ch(e,n,t){let l=kt.getSheetByIndex(t);if(!l||l.data&&!l.data[e]||l.data&&!l.data[e][n]||l.config==null||l.config.authority==null)return!0;let o=l.data,a=o[e][n],s=l.config.authority;return s==null||s.sheet==null||s.sheet==0||a==null||a.hi==null||a.hi==0}function po(e,n){let t=kt.getSheetByIndex(n);if(t==null||t.config==null||t.config.authority==null)return!0;let l=t.config.authority;if(l==null||l.sheet==null||l.sheet==0||e==null||e.length==0)return!0;let a=Be().protection;for(let s=0;s<e.length;s++){let u=e[s].row[0],f=e[s].row[1],m=e[s].column[0],d=e[s].column[1];for(let p=u;p<=f;p++)for(let b=m;b<=d;b++){let g=t.data[p][b]||{},v=g.lo===void 0||g.lo===1;if(!qm(p,b,l,a,!0,v))return!1}}return!0}function Um(e,n,t){let o=Be().protection,a=kt.getSheetByIndex(t);if(a==null||a.config==null||a.config.authority==null)return!0;let s=a.data,u=s[e][n],f=a.config.authority;return f==null||f.sheet==null||f.sheet==0?!0:u&&u.lo===0||qm(e,n,f,o,!1)?f.selectunLockedCells==1||f.selectunLockedCells==null:f.selectLockedCells==1||f.selectLockedCells==null}function of(e){let t=Be().protection,l=kt.getSheetByIndex(e);if(l==null||l.config==null||l.config.authority==null)return!0;let o=l.config.authority;if(o==null||o.sheet==null||o.sheet==0)return!0;let a=!1;(o.selectunLockedCells==1||o.selectunLockedCells==null)&&(a=!0);let s=!1;return(o.selectLockedCells==1||o.selectLockedCells==null)&&(s=!0),!!(a&&s)}function zo(e){let n=kt.getSheetByIndex(e);if(n==null||n.config==null||n.config.authority==null)return!0;let t=n.config.authority;if(t==null||t.sheet==null||t.sheet==0||t.formatCells==1||t.formatCells==null)return!0;let o=Be().protection,a;return t.hintText!=null&&t.hintText.length>0?a=t.hintText:a=o.defaultSheetHintText,ke.info("",a),!1}function nr(e,n="formatColumns",t=!0){let l=kt.getSheetByIndex(e);if(l==null||l.config==null||l.config.authority==null)return!0;let o=l.config.authority;if(o==null||o.sheet==null||o.sheet==0||o[n]==1||o[n]==null)return!0;if(t){let s=Be().protection,u;o.hintText!=null&&o.hintText.length>0?u=o.hintText:u=s.defaultSheetHintText,ke.info("",u)}return!1}var import_plugin,jy,By,Sa,jm,Vy,_h,Wy,Bm,Vm,qy,lu,hi=Nt(()=>{import_plugin=qe(Ye());il();Xl();Rr();fr();gs();kn();ho();go();Ol();jr();Kr();Jo();jy=!1,By=!1,Sa=[],jm=!0,Vy=null,_h=null,Wy=null,Bm=!0,Vm={},qy=!1,lu=["selectLockedCells","selectunLockedCells","formatCells","formatColumns","formatRows","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","filter","usePivotTablereports","editObjects","editScenarios"]});function Ko(e,n,t){t==null&&(t=!0);let l=function(a,s){let u=a[n],f=s[n];if(G(a[n])=="object"&&(u=a[n].v),G(s[n])=="object"&&(f=s[n].v),ft(u))return 1;if(ft(f))return-1;if(dr(u)&&dr(f))return un(u,f);if(K(u)&&K(f))return(0,es.default)(u).value()-(0,es.default)(f).value();if(!K(u)&&!K(f))return u.localeCompare(f,"zh");if(K(u)){if(!K(f))return-1}else return 1},o=function(a,s){let u=a[n],f=s[n];if(G(a[n])=="object"&&(u=a[n].v),G(s[n])=="object"&&(f=s[n].v),ft(u))return 1;if(ft(f))return-1;if(dr(u)&&dr(f))return un(f,u);if(K(u)&&K(f))return(0,es.default)(f).value()-(0,es.default)(u).value();if(!K(u)&&!K(f))return f.localeCompare(u,"zh");if(K(u)){if(!K(f))return 1}else return-1};return t?e.sort(l):e.sort(o)}function wh(e,n){n==null&&(n=!0);let t=function(o,a){let s=o,u=a;if(G(o)=="object"&&(s=o.v),G(a)=="object"&&(u=a.v),s==null&&(s=""),u==null&&(u=""),dr(s)&&dr(u))return un(s,u);if(K(s)&&K(u))return(0,es.default)(s).value()-(0,es.default)(u).value();if(!K(s)&&!K(u))return s.localeCompare(u,"zh");if(K(s)){if(!K(u))return-1}else return 1},l=function(o,a){let s=o,u=a;if(G(o)=="object"&&(s=o.v),G(a)=="object"&&(u=a.v),s==null&&(s=""),u==null&&(u=""),dr(s)&&dr(u))return un(u,s);if(K(s)&&K(u))return(0,es.default)(u).value()-(0,es.default)(s).value();if(!K(s)&&!K(u))return u.localeCompare(s,"zh");if(K(s)){if(!K(u))return 1}else return-1};return n?e.sort(t):e.sort(l)}function Gm(e){if(!nr(h.currentSheetIndex,"sort"))return;let t=Be().sort;if(h.luckysheet_select_save.length>1){at()?alert(t.noRangeError):ke.info(t.noRangeError,"");return}e==null&&(e=!0);let l=It.deepCopyFlowData(h.flowdata),o=h.luckysheet_select_save[0].row[0],a=h.luckysheet_select_save[0].row[1],s=h.luckysheet_select_save[0].column[0],u=h.luckysheet_select_save[0].column[1],f,m;for(let g=o;g<=a;g++)if(l[g]!=null&&l[g][s]!=null){let v=l[g][s];if(v.mc!=null||ft(v.v))continue;if(f==null&&/[\u4e00-\u9fa5]+/g.test(v.v)){f=g+1,m=g+1;continue}f==null&&(f=g),m=g}if(f==null||f>a)return;let d=!1,p=[];for(let g=f;g<=m;g++){let v=[];for(let x=s;x<=u;x++){if(l[g][x]!=null&&l[g][x].mc!=null){d=!0;break}v.push(l[g][x])}p.push(v)}if(d){at()?alert(t.mergeError):ke.info(t.mergeError,"");return}p=Ko(p,0,e);for(let g=f;g<=m;g++)for(let v=s;v<=u;v++)l[g][v]=p[g-f][v-s];let b={};if(h.config.rowlen!=null){let g=$.extend(!0,{},h.config);g=Cn(l,f,m,g),b={cfg:g,RowlChange:!0}}al(l,[{row:[f,m],column:[s,u]}],b)}function Ym(e,n){if(!nr(h.currentSheetIndex,"sort"))return;n==null&&(n=!0);let t=It.deepCopyFlowData(h.flowdata),l=0,o=t.length-1,a=0,s=t[0].length-1,u,f;for(let b=l;b<=o;b++)if(!(t[b][e]!=null&&t[b][e].mc!=null)){if(t[b][e]!=null&&!ft(t[b][e].v)&&/[\u4e00-\u9fa5]+/g.test(t[b][e].v)&&u==null){u=b+1,f=b+1;continue}u==null&&(u=b),t[b][e]!=null&&!ft(t[b][e].v)&&(f=b)}if(u==null||u>o)return;let m=!1,d=[];for(let b=u;b<=f;b++){let g=[];for(let v=a;v<=s;v++){if(t[b][v]!=null&&t[b][v].mc!=null){m=!0;break}g.push(t[b][v])}d.push(g)}if(m){at()?alert("\u5217\u6392\u5E8F\u4F1A\u6269\u5C55\u81F3\u6574\u4E2A\u8868\u683C\u9009\u533A\uFF0C\u9009\u533A\u6709\u5408\u5E76\u5355\u5143\u683C\uFF0C\u65E0\u6CD5\u6267\u884C\u6B64\u64CD\u4F5C\uFF0C\u8BF7\u9009\u62E9\u529F\u80FD\u680F\u6392\u5E8F\u529F\u80FD\uFF01"):ke.info("\u5217\u6392\u5E8F\u4F1A\u6269\u5C55\u81F3\u6574\u4E2A\u8868\u683C\u9009\u533A\uFF0C\u9009\u533A\u6709\u5408\u5E76\u5355\u5143\u683C\uFF0C\u65E0\u6CD5\u6267\u884C\u6B64\u64CD\u4F5C\uFF0C\u8BF7\u9009\u62E9\u529F\u80FD\u680F\u6392\u5E8F\u529F\u80FD\uFF01","");return}d=Ko(d,e,n);for(let b=u;b<=f;b++)for(let g=a;g<=s;g++)t[b][g]=d[b-u][g-a];let p={};if(h.config.rowlen!=null){let b=$.extend(!0,{},h.config);b=Cn(t,u,f,b),p={cfg:b,RowlChange:!0}}al(t,[{row:[u,f],column:[a,s]}],p)}var import_plugin,es,oc=Nt(()=>{import_plugin=qe(Ye());Ol();cr();Xo();Kr();Wr();fo();Ar();hi();il();Xl();es=qe(nc())});var import_plugin,Jx,Ky,Jy=Nt(()=>{import_plugin=qe(Ye());Er();Jx={transpose:function(e,n=!0){let t=[];if(e.length==0)return[];if(e[0].length==0)return[];for(let l=0;l<e[0].length;l++){let o=[];for(let a=0;a<e.length;a++){let s="";e[a]!=null&&e[a][l]!=null&&(n?s=Vt(a,l,e):s=e[a][l]),o.push(s)}t.push(o)}return t},minusClear:function(e,n){if(n.row[0]>e.row[1]||n.row[1]<e.row[0]||n.column[0]>e.column[1]||n.column[1]<e.column[0])return null;if(n.row[0]==e.row[0]&&n.row[1]<e.row[1]&&n.column[0]>e.column[0]&&n.column[1]<e.column[1])return[];let t=[],l={row:[],column:[]},o=null,a=[e.column[0],e.column[1]];n.row[1]>e.row[0]&&n.row[1]<e.row[1]?o=[n.row[1]+1,e.row[1]]:n.row[0]>e.row[0]&&n.row[0]<e.row[1]&&(o=[e.row[0],n.row[0]-1]),o!=null&&t.push({row:o,column:a});let s=[e.row[0],e.row[1]],u=null;return n.column[1]>e.column[0]&&n.column[1]<e.column[1]?u=[n.column[1]+1,e.column[1]]:n.column[0]>e.column[0]&&n.column[0]<e.column[1]&&(u=[e.column[0],n.column[0]-1]),u!=null&&t.push({row:s,column:u}),t}},Ky=Jx});var import_plugin,Qx,af,Qy=Nt(()=>{import_plugin=qe(Ye());Ol();Qx={STDEVP:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Qn(Math.sqrt(t/n.length))},STDEV:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Qn(Math.sqrt(t/(n.length-1)))},VARP:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Qn(t/n.length)},let:function(e,n){let t=0;for(let l=0;l<n.length;l++){let o=n[l];t+=Math.pow(o-e,2)}return Qn(t/(n.length-1))}},af=Qx});var import_plugin,sf,e1,Yt,_a=Nt(()=>{import_plugin=qe(Ye());fr();Ol();Er();Xo();ui();cr();oc();Ar();Kr();Wr();Jo();Jy();Qy();jr();Go();Rr();kn();ho();qr();hi();il();Xl();sf=qe(nc());Rr();e1={pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,getCellData:function(e,n,t){let l=this,o;e!=null?o=e:o=h.currentSheetIndex;let a=Me(o);G(h.luckysheetfile[a].pivotTable)!="object"&&(h.luckysheetfile[a].pivotTable=new Function("return "+h.luckysheetfile[a].pivotTable)()),h.luckysheetfile[a].pivotTable!=null?(l.column=h.luckysheetfile[a].pivotTable.column,l.row=h.luckysheetfile[a].pivotTable.row,l.values=h.luckysheetfile[a].pivotTable.values,l.filter=h.luckysheetfile[a].pivotTable.filter,l.showType=h.luckysheetfile[a].pivotTable.showType,l.filterparm=h.luckysheetfile[a].pivotTable.filterparm,h.luckysheetfile[a].pivotTable.drawPivotTable!=null?l.drawPivotTable=h.luckysheetfile[a].pivotTable.drawPivotTable:l.drawPivotTable=!0,h.luckysheetfile[a].pivotTable.pivotTableBoundary!=null?l.pivotTableBoundary=h.luckysheetfile[a].pivotTable.pivotTableBoundary:l.pivotTableBoundary=[12,6],t!=null?l.pivot_select_save=t:l.pivot_select_save=h.luckysheetfile[a].pivotTable.pivot_select_save,n!=null?l.pivotDataSheetIndex=n:l.pivotDataSheetIndex=h.luckysheetfile[a].pivotTable.pivotDataSheetIndex):(l.column=null,l.row=null,l.values=null,l.filter=null,l.showType=null,l.filterparm=null,l.drawPivotTable=!0,l.pivotTableBoundary=[12,6],t!=null?l.pivot_select_save=t:l.pivot_select_save=h.luckysheet_select_save,n!=null?l.pivotDataSheetIndex=n:l.pivotDataSheetIndex=o);let s=Me(l.pivotDataSheetIndex),u=h.luckysheetfile[s];u.data==null&&(u.data=kt.buildGridData(u)),l.origindata=ef(u.data,l.pivot_select_save);let f={};if(l.filterparm!=null)for(let d in l.filterparm)for(let p in l.filterparm[d])p==="rowhidden"&&l.filterparm[d][p]!=null&&(f=$.extend(!0,f,l.filterparm[d][p]));l.rowhidden=f,l.pivotSheetIndex=o;let m=[];for(let d=0;d<l.origindata.length;d++)l.rowhidden!=null&&l.rowhidden[d]!=null||m.push([].concat(l.origindata[d]));l.celldata=m,l.pivot_data_type={};for(let d=0;d<l.celldata[1].length;d++){let p=Yi(l.celldata[1][d]);l.pivot_data_type[d.toString()]=p}},pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,luckysheet_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},showvaluecolrow:function(){let e=this;$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").length>=2?($("#luckysheetpivottablevaluecolrowshow").show(),e.showType=="column"?($("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#luckysheetpivottablevaluecolrow1").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").removeClass("ui-state-active"))):$("#luckysheetpivottablevaluecolrowshow").hide()},resetOrderby:function(e){let n=$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").index(e);$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("orderby")==n&&$(this).data("orderby","self")})},luckysheetsliderlistclearfilter:function(e){let n=this,t=e.parent(),l=t.data("index"),o={},a={},s=n.origindata,u={};t.data("rowhidden","").find(".luckysheet-slider-list-item-filtered").hide(),n.setDatatojsfile("selected",{},l),n.setDatatojsfile("rowhidden",null,l);let f=[];for(let m=0;m<s.length;m++)o[m]==null&&f.push([].concat(s[m]));n.celldata=f,n.refreshPivotTable(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide()},luckysheetsliderlistitemfilter:function(e){let n=this,l=Be().filter,o=e.parent(),a=o.offset(),s=$("#luckysheet-pivotTableFilter-menu"),u=$(window).height(),f=$(window).width(),m=o.data("index"),d=o.data("rowhidden");d==null||d==""?d={}:G(d)=="string"&&(d=JSON.parse(d)),$("body .luckysheet-cols-menu").hide(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),$("#luckysheet-pivotTableFilter-byvalue-input").val(""),$("#luckysheet-pivotTableFilter-bycondition").next().hide(),$("#luckysheet-pivotTableFilter-byvalue").next().show(),s.data("index",m),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide().find("input").val(),$("#luckysheet-pivotTableFilter-selected span").data("type","0").data("type",null).text(l.filiterInputNone);let p=o.data("byconditiontype");if($("#luckysheet-pivotTableFilter-selected span").data("value",o.data("byconditionvalue")).data("type",p).text(o.data("byconditiontext")),p=="2"){let x=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2").show().find("input");x.eq(0).val(o.data("byconditionvalue1")),x.eq(1).val(o.data("byconditionvalue2"))}else p=="1"&&$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).show().find("input").val(o.data("byconditionvalue1"));let b=Wo("#luckysheet-pivotTableFilter-byvalue-select",{text:l.filiterMoreDataTip});$("#luckysheet-pivotTableFilter-byvalue-select").empty().append(b.el);let g={};$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").not(o.get(0)).each(function(){let x=$(this),_=x.data("rowhidden");if(_==null||_=="")return!0;G(_)=="string"&&(_=JSON.parse(_));for(let S in _)g[S]=0});let v=n.origindata;setTimeout(function(){let x={},_={},S={},I={};for(let D=1;D<v.length;D++){if(D in g||v[D]==null)continue;let k=v[D][m];if(k!=null&&k.ct!=null&&k.ct.t=="d"){let w=Bl("YYYY-MM-DD",k.v),C=w.split("-")[0],T=w.split("-")[1],O=w.split("-")[2];C in x||(x[C]={}),T in x[C]||(x[C][T]={}),O in x[C][T]||(x[C][T][O]=0),x[C][T][O]++,D in d&&(_[C]=0,_[T]=0,_[O]=0)}else{let w,C;k==null||ft(k.v)?(w=null,C=null):(w=k.v,C=k.m),w in S||(S[w]={}),C in S[w]||(S[w][C]=0),S[w][C]++,D in d&&(I[w+"#$$$#"+C]=0)}}let P=[];if(JSON.stringify(x).length>2)for(let D in x){let k=0,w="";for(let T in x[D]){let O=0,z="";for(let E in x[D][T]){let L=x[D][T][E];O+=L;let N;Number(T)<10?N="0"+Number(T):N=T;let W;Number(E)<10?W="0"+Number(E):W=E,D in _&&T in _&&E in _?z+='<div class="day luckysheet-mousedown-cancel cf" data-check="false" title="'+D+"-"+N+"-"+W+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+E+'</label><span class="count luckysheet-mousedown-cancel">( '+L+" )</span></div>":z+='<div class="day luckysheet-mousedown-cancel cf" data-check="true" title="'+D+"-"+N+"-"+W+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+E+'</label><span class="count luckysheet-mousedown-cancel">( '+L+" )</span></div>"}k+=O;let A;Number(T)<10?A="0"+Number(T):A=T,D in _&&T in _?w+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="false" title="'+D+"-"+A+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+T+""+l.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+O+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+z+"</div></div>":w+='<div class="monthBox luckysheet-mousedown-cancel"><div class="month luckysheet-mousedown-cancel cf" data-check="true" title="'+D+"-"+A+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+T+""+l.filiterMonthText+'</label><span class="count luckysheet-mousedown-cancel">( '+O+' )</span></div><div class="dayList luckysheet-mousedown-cancel">'+z+"</div></div>"}let C;D in _?C='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="false" title="'+D+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+D+""+l.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+k+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+w+"</div></div>":C='<div class="yearBox luckysheet-mousedown-cancel"><div class="year luckysheet-mousedown-cancel cf" data-check="true" title="'+D+'"><i class="fa fa-caret-right luckysheet-mousedown-cancel" aria-hidden="true"></i><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+D+""+l.filiterYearText+'</label><span class="count luckysheet-mousedown-cancel">( '+k+' )</span></div><div class="monthList luckysheet-mousedown-cancel">'+w+"</div></div>",P.unshift(C)}if(JSON.stringify(S).length>2){let D=Object.keys(S);D=wh(D,!0);for(let k=0;k<D.length;k++){let w=D[k];for(let C in S[w]){let T;w+"#$$$#"+C=="null#$$$#null"?T=l.valueBlank:T=C;let O;w+"#$$$#"+C in I?O='<div class="textBox luckysheet-mousedown-cancel cf" data-check="false" data-filter="'+(w+"#$$$#"+C)+'" title="'+C+'"><input class="luckysheet-mousedown-cancel" type="checkbox"/><label class="luckysheet-mousedown-cancel">'+T+'</label><span class="luckysheet-mousedown-cancel count">( '+S[w][C]+" )</span></div>":O='<div class="textBox luckysheet-mousedown-cancel cf" data-check="true" data-filter="'+(w+"#$$$#"+C)+'" title="'+C+'"><input class="luckysheet-mousedown-cancel" type="checkbox" checked="checked"/><label class="luckysheet-mousedown-cancel">'+T+'</label><span class="luckysheet-mousedown-cancel count">( '+S[w][C]+" )</span></div>",P.push(O)}}}let F=u-a.top-350;F<0&&(F=100),$("#luckysheet-pivotTableFilter-byvalue-select").append("<div class='ListBox luckysheet-mousedown-cancel' style='max-height:"+F+"px;overflow-y:auto;overflow-x:hidden;'>"+P.join("")+"</div>"),b.close()},1),Ca(s,a.left-250,a.top)},getSumTypeName:function(e){let n="",l=Be().pivotTable;return e=="SUM"?n=l.valueStatisticsSUM:e=="COUNT"?n=l.valueStatisticsCOUNT:e=="COUNTA"?n=l.valueStatisticsCOUNTA:e=="COUNTUNIQUE"?n=l.valueStatisticsCOUNTUNIQUE:e=="AVERAGE"?n=l.valueStatisticsAVERAGE:e=="MAX"?n=l.valueStatisticsMAX:e=="MIN"?n=l.valueStatisticsMIN:e=="MEDIAN"?n=l.valueStatisticsMEDIAN:e=="PRODUCT"?n=l.valueStatisticsPRODUCT:e=="STDEV"?n=l.valueStatisticsSTDEV:e=="STDEVP"?n=l.valueStatisticsSTDEVP:e=="let"?n=l.valueStatisticslet:e=="VARP"&&(n=l.valueStatisticsVARP),n},setDatatojsfile:function(e,n,t){let l=this,o=Me(l.pivotSheetIndex);h.luckysheetfile[o].pivotTable==null&&(h.luckysheetfile[o].pivotTable={}),t==null?(h.luckysheetfile[o].pivotTable[e]=n,l[e]=n):(h.luckysheetfile[o].pivotTable.filterparm==null&&(h.luckysheetfile[o].pivotTable.filterparm={}),h.luckysheetfile[o].pivotTable.filterparm[t.toString()]==null&&(h.luckysheetfile[o].pivotTable.filterparm[t.toString()]={}),h.luckysheetfile[o].pivotTable.filterparm[t.toString()][e]=n,l.filterparm==null&&(l.filterparm={}),l.filterparm[t.toString()]==null&&(l.filterparm[t.toString()]={}),l.filterparm[t.toString()][e]=n)},createPivotTable:function(e){if(at()||h.allowEdit===!1)return;let n=this,t=h.currentSheetIndex,o=Be().pivotTable;if(at()){alert(o.errorNotAllowEdit);return}if(h.luckysheet_select_save.length>1){ke.info("",o.errorNotAllowMulti);return}if(h.luckysheet_select_save.length==0||h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]||h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]){ke.info("",o.errorSelectRange);return}let a=$.extend(!0,{},h.luckysheet_select_save[0]);kt.addNewSheet(e,!0),n.getCellData(h.currentSheetIndex,t,a),n.setDatatojsfile("pivot_select_save",a),n.setDatatojsfile("pivotDataSheetIndex",t),n.initialPivotManage()},changePivotTable:function(e){let n=this,l=Be().pivotTable,o=h.luckysheetfile[Me(e)].pivotTable.pivotDataSheetIndex;if(Me(o)==null){ke.info(l.errorIsDamage,"");return}n.getCellData(e),n.initialPivotManage(!0),n.refreshPivotTable()},refreshPivotTable:function(e=!0){let n=this,t={};t.pivotTable=e1,t.data=It.deepCopyFlowData(h.flowdata),n.storePivotTableParam();let l=n.dataHandler(n.column,n.row,n.values,n.showType,n.celldata);n.setDatatojsfile("pivotDatas",l);let o=$.extend(!0,[],kt.nulldata),a=o,s=0,u=0;if(l.length==0)n.setDatatojsfile("drawPivotTable",!0),n.setDatatojsfile("pivotTableBoundary",[12,6]);else{n.setDatatojsfile("drawPivotTable",!1),n.setDatatojsfile("pivotTableBoundary",[l.length,l[0].length]);let f=l.length,m=l[0].length;s=f-o.length,u=m-o[0].length,a=cn(o,s+20,u+10,!0);for(let d=0;d<f;d++){let p=[].concat(a[d]);for(let b=0;b<m;b++){let g="";l[d]!=null&&l[d][b]!=null&&(g=Vt(d,b,l)),p[b]=g}a[d]=p}}t.type="pivotTable_change",t.curdata=$.extend(!0,[],a),t.sheetIndex=h.currentSheetIndex,t.pivotTablecur=n.getPivotTableData(),h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push(t)),Jr(),h.clearjfundo=!1,s>0||u>0?Li(a[0].length,a.length,a,null,h.luckysheet_select_save,"datachangeAll",void 0,void 0,e):(al(a,h.luckysheet_select_save,{},null,e),gl()),h.clearjfundo=!0},drawPivotTable:!0,pivotTableBoundary:[12,6],pivotclick:function(e,n,t){t==null&&(t=h.currentSheetIndex);let l=h.luckysheetfile[Me(t)];if(!l.isPivotTable)return;let o=l.pivotTable.pivotDataSheetIndex;if(Me(o)==null)return;let s=$("#luckysheet-modal-dialog-slider-pivot"),u=this.isPivotRange(e,n);if(u&&s.is(":hidden")){if(!nr(t,"usePivotTablereports",!1))return;s.show(),mr(),$("#luckysheet-sta-content").css("padding-right",260)}else!u&&s.is(":visible")&&(s.hide(),mr(),$("#luckysheet-sta-content").css("padding-right",10))},isPivotRange:function(e,n){let t=this;if(h.luckysheetcurrentisPivotTable)return e<t.pivotTableBoundary[0]&&n<t.pivotTableBoundary[1]},storePivotTableParam:function(){let e=this,n=[],t=[],l=[],o=[];$("#luckysheet-modal-dialog-config-filter .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),l.push(u)}),$("#luckysheet-modal-dialog-config-row .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),u.order=$(this).data("order"),u.orderby=$(this).data("orderby"),u.stastic=$(this).data("stastic"),t.push(u)}),$("#luckysheet-modal-dialog-config-column .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),u.order=$(this).data("order"),u.orderby=$(this).data("orderby"),u.stastic=$(this).data("stastic"),n.push(u)}),$("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").each(function(){let u={};u.index=$(this).data("index"),u.name=$(this).data("name"),u.fullname=$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text(),u.sumtype=$(this).data("sumtype"),u.nameindex=$(this).data("nameindex"),o.push(u)}),e.setDatatojsfile("column",n),e.setDatatojsfile("row",t),e.setDatatojsfile("filter",l),e.setDatatojsfile("values",o);let a=$("#luckysheetpivottablevaluecolrow:checked, #luckysheetpivottablevaluecolrow1:checked").val();e.setDatatojsfile("showType",a=="0"?"row":"column");let s=e.getPivotTableData();delete s.pivotDatas,Ue.saveParam("all",e.pivotSheetIndex,s,{k:"pivotTable"})},getPivotTableData:function(e){e==null&&(e=this.pivotSheetIndex);let n=Me(e),t=h.luckysheetfile[n].pivotTable;return G(t)=="object"?t=$.extend(!0,{},h.luckysheetfile[n].pivotTable):t=new Function("return "+t)(),t},addValuesToTitle:function(e,n){let t=e.length*n.length,l=e[0].length+1,o=[];if(e.length==0&&n.length>0){for(let a=0;a<n.length;a++)o.push(n[a].fullname);return o}if(n.length==0&&e.length>0)return e;for(let a=0;a<t;a++){o[a]=new Array(l);for(let s=0;s<l-1;s++)o[a][s]=e[Math.floor(a/n.length)][s];o[a][l-1]=n[a%n.length].fullname}return o},initialPivotManage:function(e){let n=this,t=Be(),l=t.pivotTable,o=t.button,a=t.filter;if(n.initial){n.initial=!1,$("body").first().append(b0()),$("#luckysheet-modal-dialog-slider-close").click(function(){$("#luckysheet-modal-dialog-slider-pivot").hide(),mr()}),$("body").first().append(Tt(Ll,{id:"luckysheet-data-pivotTable-selection",addclass:"luckysheet-data-pivotTable-selection",title:l.titleSelectionDataRange,content:'<input id="luckysheet-pivotTable-range-selection-input" class="luckysheet-datavisual-range-container" style="font-size: 14px;padding:5px;max-width:none;" spellcheck="false" aria-label="'+l.titleDataRange+'" placeholder="'+l.titleDataRange+'">',botton:'<button id="luckysheet-pivotTable-selection-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>"})),$("body").first().append(Tt(Xf(),{menuid:"pivotTableFilter"})),$("body").first().append(Tt(Zf(),{menuid:"pivotTableFilter"})),$("body").first().append(h0()),$("body").first().append(d0()),$("#luckysheet-pivotTableFilter-orderby-asc").remove(),$("#luckysheet-pivotTableFilter-orderby-desc").next().remove(),$("#luckysheet-pivotTableFilter-orderby-desc").remove(),$("#luckysheet-pivotTableFilter-orderby-color").next().remove(),$("#luckysheet-pivotTableFilter-orderby-color").remove(),$("#luckysheetpivottablevaluecolrow, #luckysheetpivottablevaluecolrow1").checkboxradio({icon:!1}).change(function(){n.refreshPivotTable()});let d=null;$("#luckysheet-pivotTableFilter-menu").mouseover(function(){clearTimeout(d),d=setTimeout(function(){$("#luckysheet-pivotTableFilter-submenu").hide()},500)}),$(document).off("click.ptFilterCheckbox1").on("click.ptFilterCheckbox1","#luckysheet-pivotTableFilter-byvalue-select .textBox",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox2").on("click.ptFilterCheckbox2","#luckysheet-pivotTableFilter-byvalue-select .year",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox3").on("click.ptFilterCheckbox3","#luckysheet-pivotTableFilter-byvalue-select .month",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));let p=!0;$(this).parents(".yearBox").find(".day").each(function(g,v){$(v).attr("data-check")=="true"||(p=!1)}),p?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterCheckbox4").on("click.ptFilterCheckbox4","#luckysheet-pivotTableFilter-byvalue-select .day",function(){$(this).attr("data-check")=="true"?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));let p=!0;$(this).parents(".monthBox").find(".day").each(function(x,_){$(_).attr("data-check")=="true"||(p=!1)}),p?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));let g=!0;$(this).parents(".yearBox").find(".day").each(function(x,_){$(_).attr("data-check")=="true"||(g=!1)}),g?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterYearDropdown").on("click.ptFilterYearDropdown","#luckysheet-pivotTableFilter-byvalue-select .yearBox .fa-caret-right",function(){let p=$(this).parents(".luckysheet-mousedown-cancel");p.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),p.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle()}),$("#luckysheet-pivotTableFilter-byvalue-btn-all").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","true")}),$("#luckysheet-pivotTableFilter-byvalue-btn-contra").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(v,x){$(x).is(":checked")?($(x).removeAttr("checked"),$(x).parents(".luckysheet-mousedown-cancel").attr("data-check","false")):($(x).prop("checked",!0),$(x).parents(".luckysheet-mousedown-cancel").attr("data-check","true"))}),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .monthBox").each(function(v,x){let _=!0;$(x).find(".day input[type='checkbox']").each(function(I,P){$(P).is(":checked")||(_=!1)}),_?($(x).find(".month input[type='checkbox']").prop("checked",!0),$(x).attr("data-check","true")):($(x).find(".month input[type='checkbox']").removeAttr("checked"),$(x).attr("data-check","false"))}),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .yearBox").each(function(v,x){let _=!0;$(x).find(".day input[type='checkbox']").each(function(I,P){$(P).is(":checked")||(_=!1)}),_?($(x).find(".year input[type='checkbox']").prop("checked",!0),$(x).attr("data-check","true")):($(x).find(".year input[type='checkbox']").removeAttr("checked"),$(x).attr("data-check","false"))})}),$("#luckysheet-pivotTableFilter-byvalue-btn-clear").click(function(){$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".luckysheet-mousedown-cancel").attr("data-check","false")}),$("#luckysheet-pivotTableFilter-byvalue-input").on("input propertychange",function(){let p=$(this).val().toString();$("#luckysheet-pivotTableFilter-byvalue-select .ListBox .luckysheet-mousedown-cancel").show(),p!=""&&$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(g,v){let x=$(v).parents(".luckysheet-mousedown-cancel");if(x.hasClass("day")){let _=$(v).siblings("label").text().toString(),S=$(v).parents(".monthBox").find(".month label").text().toString();($(v).parents(".yearBox").find(".year label").text().toString()+"-"+S+"-"+_).indexOf(p)==-1&&($(v).parents(".day").hide(),$(v).parents(".dayList").find(".day:visible").length==0&&$(v).parents(".monthBox").find(".month").hide(),$(v).parents(".monthList").find(".day:visible").length==0&&$(v).parents(".yearBox").find(".year").hide())}x.hasClass("textBox")&&$(v).siblings("label").text().toString().indexOf(p)==-1&&$(v).parents(".textBox").hide()})}),$("#luckysheet-pivotTableFilter-bycondition, #luckysheet-pivotTableFilter-byvalue").click(function(){let p=$(this);p.next().slideToggle(200),setTimeout(function(){p.attr("id")=="luckysheet-pivotTableFilter-bycondition"&&$("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-selected span").text()!=a.filiterInputNone&&$("#luckysheet-pivotTableFilter-byvalue").next().slideUp(200),p.is($("#luckysheet-pivotTableFilter-bycondition"))&&$("#luckysheet-pivotTableFilter-bycondition").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-byvalue").next().slideDown(200)},300)}),$("#luckysheet-pivotTableFilter-cancel").click(function(){$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide()}),$("#luckysheet-pivotTableFilter-selected").click(function(){let p=$(this),b=p.offset(),g=$("#luckysheet-pivotTableFilter-submenu");g.hide();let v=$(window).height(),x=$(window).width(),_=g.width(),S=g.height(),I=b.top,P=b.left,F=v-b.top-20;b.left+_>x&&(P=b.left-_),b.top>v/2&&(I=v-b.top,I<0&&(I=0),F=b.top-20),g.css({top:I,left:P,height:F}).show(),clearTimeout(d)}),$("#luckysheet-pivotTableFilter-submenu").mouseover(function(){clearTimeout(d)}).find(".luckysheet-cols-menuitem").click(function(p){$("#luckysheet-pivotTableFilter-selected span").html($(this).find(".luckysheet-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide(),$(this).data("type")=="2"?($("#luckysheet-pivotTableFilter-selected span").data("type","2"),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2").show()):$(this).data("type")=="0"?$("#luckysheet-pivotTableFilter-selected span").data("type","0"):($("#luckysheet-pivotTableFilter-selected span").data("type","1"),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).show(),$(this).attr("data-value")=="dateequal"||$(this).attr("data-value")=="datelessthan"||$(this).attr("data-value")=="datemorethan"?$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input").prop("type","date"):$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input input").prop("type","text")),$("#luckysheet-pivotTableFilter-byvalue").next().slideUp(),$("#luckysheet-pivotTableFilter-submenu").hide()}),$("#luckysheet-modal-dialog-pivotTable-list").on("click"," .luckysheet-slider-list-item-filter",function(p){return n.luckysheetsliderlistitemfilter($(this)),p.stopPropagation(),!1}),$("#luckysheet-modal-dialog-pivotTable-list").on("click"," .luckysheet-slider-list-item-filtered",function(p){return n.luckysheetsliderlistclearfilter($(this).next()),p.stopPropagation(),!1}),$("#luckysheet-dialog-pivotTable-range-seleted").click(function(){$("#luckysheet-modal-dialog-slider-pivot").hide(),mr();let p=$("#luckysheet-data-pivotTable-selection"),b=p.outerHeight(),g=p.outerWidth(),v=$(window).width(),x=$(window).height(),_=$(document).scrollLeft(),S=$(document).scrollTop();$("#luckysheet-data-pivotTable-selection").css({left:(v+_-g)/2,top:(x+S-b)/4}).show(),n.jgridCurrentPivotInput=$("#luckysheet-dialog-pivotTable-range").html(),$("#luckysheet-pivotTable-range-selection-input").val(n.jgridCurrentPivotInput),n.luckysheet_pivotTable_select_state=!0}),$("#luckysheet-pivotTableFilter-initial").click(function(){$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-slider-list-item-filtered").hide(),$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").data("rowhidden",""),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").hide().find("input").val(),$("#luckysheet-pivotTableFilter-selected span").data("type","0").data("type",null).text(a.filiterInputNone),n.setDatatojsfile("filterparm",null),n.celldata=n.origindata,n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(p){let b=$(p.target),g=b.closest(".luckysheet-modal-dialog-slider-config-item"),v=g.data("index"),x=g.offset(),_=g.data("order"),S=g.data("orderby"),I=g.data("stastic");_==null&&(_="default");let P='<option value="self">'+g.find(".luckysheet-modal-dialog-slider-config-item-txt").data("name")+"</option>";return $("#luckysheet-modal-dialog-config-value .luckysheet-modal-dialog-slider-config-item").each(function(F){P+='<option value="'+F+'">'+$(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text()+"</option>"}),$("#luckysheet-pivotTable-config-option-orderby").empty().html(P),S==null&&(S="self"),I==null&&(I="1"),$("#luckysheet-pivotTable-config-option-order").val(_).data("index",v),$("#luckysheet-pivotTable-config-option-orderby").val(S).data("index",v),$("#luckysheet-pivotTable-config-option-stastic").val(I).data("index",v),bn($("#luckysheet-pivotTable-config-option"),x.left+g.outerWidth(),x.top-13,"rightbottom"),p.stopPropagation(),!1}),$("#luckysheet-pivotTable-config-option-order,#luckysheet-pivotTable-config-option-orderby,#luckysheet-pivotTable-config-option-stastic").change(function(){let p=$(this),b=p.data("index");$("#luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==b&&$(this).data(p.attr("id").replace("luckysheet-pivotTable-config-option-",""),p.val())}),n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-value").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(p){let b=$(p.target),g=b.closest(".luckysheet-modal-dialog-slider-config-item"),v=g.data("index"),x=g.offset(),_=g.data("sumtype"),S=n.pivot_data_type[v.toString()];_==null&&(S=="num"?_="SUM":_="COUNTA");let I=$("#luckysheet-pivotTable-config-option-sumtype");return I.find(".luckysheet-submenu-arrow").hide(),I.find(".luckysheet-cols-menuitem[sumtype='"+_+"'] .luckysheet-submenu-arrow").css("display","inline"),I.data("item",g),bn(I,x.left+g.outerWidth(),x.top-13,"rightbottom"),p.stopPropagation(),!1}),$("#luckysheet-pivotTable-config-option-sumtype .luckysheet-cols-menuitem").click(function(){let p=$("#luckysheet-pivotTable-config-option-sumtype").data("item"),b=$(this).attr("sumtype");p.data("sumtype",$(this).attr("sumtype"));let g=n.getSumTypeName(b)+":"+p.data("name");p.attr("title",g).find(".luckysheet-modal-dialog-slider-config-item-txt").html(g),$("#luckysheet-pivotTable-config-option-sumtype").hide(),n.refreshPivotTable()}),$("#luckysheet-modal-dialog-config-filter").on("click",".luckysheet-modal-dialog-slider-config-item-icon",function(p){let b=$(p.target),g=b.closest(".luckysheet-modal-dialog-slider-config-item").data("index");return n.luckysheetsliderlistitemfilter($("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(g).find(".luckysheet-slider-list-item-filter")),p.stopPropagation(),!1}),$("#luckysheet-pivotTableFilter-confirm").click(function(){let b=$("#luckysheet-pivotTableFilter-menu").data("index"),g={};$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").each(function(){let F=$(this),D=F.data("rowhidden");if(F.data("index")!=b){if(D==null||D=="")return!0;G(D)=="string"&&(D=JSON.parse(D));for(let k in D)g[k]=0}});let v=n.origindata,x={},_={},S={};if($("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-selected span").data("value")!="null"){let F=$("#luckysheet-pivotTableFilter-selected span"),D=F.data("type"),k=F.data("value");if(S.value=k,S.text=F.text(),D=="0")S.type="0";else if(D=="2"){let w=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input2 input");S.type="2",S.value1=w.eq(0).val(),S.value2=w.eq(1).val()}else S.type="1",S.value1=$("#luckysheet-pivotTableFilter-menu .luckysheet-pivotTableFilter-selected-input").eq(0).find("input").val();for(let w=1;w<v.length;w++){if(w in g||v[w]==null)continue;let C=v[w][b];if(k=="cellnull")C!=null&&!ft(C.v)&&(_[w]=0);else if(k=="cellnonull")(C==null||ft(C.v))&&(_[w]=0);else if(k=="textinclude"){let T=S.value1;(C==null||ft(C.v)||C.m.indexOf(T)==-1)&&(_[w]=0)}else if(k=="textnotinclude"){let T=S.value1;C==null||ft(C.v)||C.m.indexOf(T)>-1&&(_[w]=0)}else if(k=="textstart"){let T=S.value1,O=T.length;(C==null||ft(C.v)||C.m.substr(0,O)!=T)&&(_[w]=0)}else if(k=="textend"){let T=S.value1,O=T.length;(C==null||ft(C.v)||O>C.m.length||C.m.substr(C.m.length-O,O)!=T)&&(_[w]=0)}else if(k=="textequal"){let T=S.value1;(C==null||ft(C.v)||C.m!=T)&&(_[w]=0)}else if(k=="dateequal"){let T=_l(S.value1)[2];C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="d"?parseInt(C.v)!=T&&(_[w]=0):_[w]=0}else if(k=="datelessthan"){let T=_l(S.value1)[2];C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="d"?parseInt(C.v)>=T&&(_[w]=0):_[w]=0}else if(k=="datemorethan"){let T=_l(S.value1)[2];C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="d"?parseInt(C.v)<=T&&(_[w]=0):_[w]=0}else if(k=="morethan"){let T=parseFloat(S.value1);C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v<=T&&(_[w]=0):_[w]=0}else if(k=="moreequalthan"){let T=parseFloat(S.value1);C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v<T&&(_[w]=0):_[w]=0}else if(k=="lessthan"){let T=parseFloat(S.value1);C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v>=T&&(_[w]=0):_[w]=0}else if(k=="lessequalthan"){let T=parseFloat(S.value1);C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v>T&&(_[w]=0):_[w]=0}else if(k=="equal"){let T=parseFloat(S.value1);C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v!=T&&(_[w]=0):_[w]=0}else if(k=="noequal"){let T=parseFloat(S.value1);C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v==T&&(_[w]=0):_[w]=0}else if(k=="include"){let T=parseFloat(S.value1),O=parseFloat(S.value2),z,A;T<O?(z=T,A=O):(A=T,z=O),C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?(C.v<z||C.v>A)&&(_[w]=0):_[w]=0}else if(k=="noinclude"){let T=parseFloat(S.value1),O=parseFloat(S.value2),z,A;T<O?(z=T,A=O):(A=T,z=O),C==null||ft(C.v)?_[w]=0:C.ct!=null&&C.ct.t=="n"?C.v>=z&&C.v<=A&&(_[w]=0):_[w]=0}}}else{$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(F,D){if($(D).is(":visible")&&$(D).is(":checked"))return!0;if($(D).closest(".day").length>0){let k=$(D).siblings("label").text();Number(k)<10&&(k="0"+k);let w=$(D).closest(".monthBox").find(".month label").text().replace(a.filiterMonthText,"");Number(w)<10&&(w="0"+w);let C=$(D).closest(".yearBox").find(".year label").text().replace(a.filiterYearText,""),T=a.filterDateFormatTip+"#$$$#"+C+"-"+w+"-"+k;x[T]="1"}if($(D).closest(".textBox").length>0){let k=$(D).closest(".textBox").data("filter");x[k]="1"}});for(let F=1;F<v.length;F++){if(F in g||v[F]==null)continue;let D=v[F][b],k;if(D==null||ft(D.v))k="null#$$$#null";else if(D.ct!=null&&D.ct.t=="d"){let w=Bl("YYYY-MM-DD",D.v);k=a.filterDateFormatTip+"#$$$#"+w}else k=D.v+"#$$$#"+D.m;k in x&&(_[F]=0)}}let I=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(b);$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#luckysheet-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible").length||$("#luckysheet-pivotTableFilter-byvalue-input").val().length>0||$("#luckysheet-pivotTableFilter-bycondition").next().is(":visible")&&$("#luckysheet-pivotTableFilter-byvalue").next().is(":hidden")&&$("#luckysheet-pivotTableFilter-selected span").data("value")!="null"?(I.data("rowhidden",JSON.stringify(_)).find(".luckysheet-slider-list-item-filtered").show(),n.setDatatojsfile("rowhidden",_,b),S!=null&&(I.data("byconditionvalue",S.value).data("byconditiontype",S.type).data("byconditiontext",S.text),S.value1!=null&&I.data("byconditionvalue1",S.value1),S.value2!=null&&I.data("byconditionvalue2",S.value2),n.setDatatojsfile("caljs",S,b))):(I.data("rowhidden","").find(".luckysheet-slider-list-item-filtered").hide(),n.setDatatojsfile("rowhidden",null,b));let P=[];for(let F=0;F<v.length;F++)F in _||F in g||P.push([].concat(v[F]));n.celldata=P,n.refreshPivotTable(),$("#luckysheet-pivotTableFilter-menu, #luckysheet-pivotTableFilter-submenu").hide(),Jr()}),$("#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn, #luckysheet-data-pivotTable-selection .luckysheet-modal-dialog-title-close").click(function(){$("#luckysheet-modal-dialog-slider-pivot").show(),mr(),$("#luckysheet-cell-main .luckysheet-pivotTable-selection-set div").show(),$("#luckysheet-data-pivotTable-selection").hide(),kt.changeSheetExec(n.pivotSheetIndex),n.luckysheet_pivotTable_select_state=!1,Jr()}),$("#luckysheet-pivotTable-selection-confirm").click(function(){let p=$("#luckysheet-pivotTable-range-selection-input"),b=p.val();if($.trim(b).length==0||$.trim(b).toUpperCase()==n.jgridCurrentPivotInput.toUpperCase()){p.val(n.jgridCurrentPivotInput),$("#luckysheet-data-pivotTable-selection .luckysheet-model-close-btn").click();return}else{let g=b.split("!"),v="",x="",_=-1;if(g.length>1){v=g[0],x=g[1];for(let P in h.luckysheetfile)if(v==h.luckysheetfile[P].name){_=h.luckysheetfile[P].index;break}_==-1&&(_=0)}else{let P=Me(h.currentSheetIndex);v=h.luckysheetfile[P].name,_=h.luckysheetfile[P].index,x=g[0]}if(h.luckysheetfile[Me(_)].isPivotTable){at()?alert(l.errorNotAllowPivotData):ke.info("",l.errorNotAllowPivotData),p.val(n.jgridCurrentPivotInput);return}if(x.indexOf(":")==-1){at()?alert(l.errorSelectionRange):ke.info("",l.errorSelectionRange),p.val(n.jgridCurrentPivotInput);return}x=x.split(":");let S=[],I=[];if(S[0]=parseInt(x[0].replace(/[^0-9]/g,""))-1,S[1]=parseInt(x[1].replace(/[^0-9]/g,""))-1,S[0]>S[1]){at()?alert(l.errorSelectionRange):ke.info("",l.errorSelectionRange),p.val(n.jgridCurrentPivotInput);return}if(I[0]=fn(x[0].replace(/[^A-Za-z]/g,"")),I[1]=fn(x[1].replace(/[^A-Za-z]/g,"")),I[0]>I[1]){at()?alert(l.errorSelectionRange):ke.info(l.errorSelectionRange),p.val(n.jgridCurrentPivotInput);return}kt.changeSheetExec(n.pivotSheetIndex),n.setDatatojsfile("pivot_select_save",{row:S,column:I}),n.setDatatojsfile("pivotDataSheetIndex",_),n.getCellData(n.pivotSheetIndex,_,{row:S,column:I}),n.initialPivotManage(),$("#luckysheet-dialog-pivotTable-range").html(b),$("#luckysheet-modal-dialog-slider-pivot").show(),$("#luckysheet-data-pivotTable-selection").hide(),n.luckysheet_pivotTable_select_state=!1,n.refreshPivotTable(),mr(),Jr()}}),$("#luckysheet-modal-dialog-slider-pivot").on("mousedown",".luckysheet-slider-list-item-name, .luckysheet-modal-dialog-slider-config-item-txt",function(p){let b=$(p.target);n.movestate=!0,n.movesave.obj=b.parent(),n.movesave.name=b.data("name"),n.movesave.containerid=b.parent().parent().attr("id"),n.movesave.index=b.data("index"),$("#luckysheet-modal-dialog-slider-pivot-move").length==0&&$("body").first().append('<div id="luckysheet-modal-dialog-slider-pivot-move">'+n.movesave.name+"</div>"),n.movesave.width=$("#luckysheet-modal-dialog-slider-pivot-move").outerWidth(),n.movesave.height=$("#luckysheet-modal-dialog-slider-pivot-move").outerHeight(),$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default")}),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").mousemove(function(p){if(n.movestate){n.moveitemposition.length==0&&(n.moveitemposition=[0],$(this).find(".luckysheet-modal-dialog-slider-config-item").each(function(I){let P=$(this),F=P.outerHeight();n.moveitemposition.push(n.moveitemposition[I]+F+2)}),$(this).append('<div id="luckysheet-modal-dialog-config-order-help" style="position:absolute;height:3px;width:100%;background:#007ACC;z-index:1;pointer-events: none;user-select:none;"></div>')),$("#luckysheet-modal-dialog-slider-pivot-move").css({background:"#FD8585",color:"#fff",border:"1px solid #FD7070"});let b=event.pageX,g=event.pageY,v=$(this),x=g-v.offset().top+v.scrollTop(),_=n.moveitemposition,S=$l(_,x);S==-1?$("#luckysheet-modal-dialog-config-order-help").css({top:_[_.length-1]}):x-_[S-1]>(_[S]-_[S-1])/2?$("#luckysheet-modal-dialog-config-order-help").css({top:_[S]}):$("#luckysheet-modal-dialog-config-order-help").css({top:_[S-1]})}}).mouseleave(function(){n.movestate&&($("#luckysheet-modal-dialog-slider-pivot-move").css({background:"#fff",color:"#000",border:"1px dotted #000"}),n.moveitemposition=[],$("#luckysheet-modal-dialog-config-order-help").remove())}).mouseup(function(p){if(n.movestate){let b=$(this),g;if(n.movesave.containerid==b.attr("id"))g=n.movesave.obj.clone();else{let F=n.movesave.name,D="",k="";b.attr("id")=="luckysheet-modal-dialog-config-value"&&(n.pivot_data_type[n.movesave.index.toString()]=="num"?(F=l.valueStatisticsSUM+":"+F,D="data-sumtype='SUM'",k="data-nameindex='0'"):(F=l.valueStatisticsCOUNTA+":"+F,D="data-sumtype='COUNTA'",k="data-nameindex='0'"),$("#luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){if($(this).find(".luckysheet-modal-dialog-slider-config-item-txt").text()==F){let C=parseFloat($(this).data("nameindex"))+1;return F=F+C.toString(),$(this).data("nameindex",C),!1}})),g='<div title="'+F+'" class="luckysheet-modal-dialog-slider-config-item" '+k+" "+D+' data-index="'+n.movesave.index+'" data-name="'+n.movesave.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+k+" "+D+' data-index="'+n.movesave.index+'" data-name="'+n.movesave.name+'">'+F+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'}let v=event.pageX,x=event.pageY,_=$(this),S=x-_.offset().top+_.scrollTop(),I=n.moveitemposition,P=$l(I,S);(n.movesave.containerid=="luckysheet-modal-dialog-pivotTable-list"||n.movesave.containerid=="luckysheet-modal-dialog-config-value"&&n.movesave.containerid!=b.attr("id"))&&$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==n.movesave.index&&$(this).remove()}),P==-1?b.find(".luckysheet-modal-dialog-slider-config-item").length==0?b.append(g):b.find(".luckysheet-modal-dialog-slider-config-item").last().after(g):S-I[P-1]>(I[P]-I[P-1])/2?b.find(".luckysheet-modal-dialog-slider-config-item").eq(P-1).after(g):b.find(".luckysheet-modal-dialog-slider-config-item").eq(P-1).before(g),n.movesave.containerid=="luckysheet-modal-dialog-pivotTable-list"||n.movesave.containerid=="luckysheet-modal-dialog-config-value"&&n.movesave.containerid!=b.attr("id")||n.movesave.obj.remove(),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){let F=$(this).find(".luckysheet-slider-list-item-selected");$(this).data("index")==n.movesave.index&&F.find("i").length==0&&F.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}),n.refreshPivotTable(),$("#luckysheet-modal-dialog-slider-pivot-move").remove(),n.movestate=!1,$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default"),n.moveitemposition=[],$("#luckysheet-modal-dialog-config-order-help").remove(),n.showvaluecolrow(),p.stopPropagation()}}),$("#luckysheet-modal-dialog-pivotTable-list").on("click",".luckysheet-slider-list-item-selected",function(){let p=$(this),b=p.parent(),g=b.data("index"),v=b.data("name");if(p.find("i").length==0){p.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>');let x=n.pivot_data_type[g.toString()],_;if(x=="num")_='<div title="'+v+'" class="luckysheet-modal-dialog-slider-config-item" data-nameindex="0" data-sumtype="SUM" data-index="'+g+'" data-name="'+v+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-nameindex="0" data-sumtype="SUM" data-index="'+g+'" data-name="'+v+'">\u6C42\u548C:'+v+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>',$("#luckysheet-modal-dialog-config-value").append(_);else{_='<div title="'+v+'" class="luckysheet-modal-dialog-slider-config-item" data-index="'+g+'" data-name="'+v+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-index="'+g+'" data-name="'+v+'">'+v+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';let S=$("#luckysheet-modal-dialog-config-column"),I=$("#luckysheet-modal-dialog-config-row"),P=S.find(".luckysheet-modal-dialog-slider-config-item"),F=I.find(".luckysheet-modal-dialog-slider-config-item");P.length<2?S.append(_):F.length<2?I.append(_):S.append(_)}}else p.find("i").remove(),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).data("index")==g&&($(this).parent().attr("id")=="luckysheet-modal-dialog-config-value"&&n.resetOrderby($(this)),$(this).remove())});n.refreshPivotTable(),n.showvaluecolrow()}),$("#luckysheet-dialog-pivotTable-clearitem").click(function(){$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){$(this).remove()}),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){$(this).find(".luckysheet-slider-list-item-selected").find("i").remove()}),n.refreshPivotTable(),n.showvaluecolrow()})}e==null&&(e=!1),n.celldata.length<=1&&n.celldata[0].length<=1&&(at()?alert(l.errorIncreaseRange):ke.info("",l.errorIncreaseRange));let s="",u=1,f={},m=1;for(let d=0;d<n.celldata[0].length;d++){let p;!!n.celldata[0][d]&&!!n.celldata[0][d].m?p=n.celldata[0][d].m:p=Vt(0,d,n.celldata),p!=null&&(p=p.toString()),(p==null||$.trim(p.toString()).length==0)&&(p=l.titleColumn+" "+m),m++,p in f&&(p=p+u++,p in f&&(p=p+u++,p in f&&(p=p+u++))),f[p]=1;let b="",g="";if(e&&n.filterparm!=null&&n.filterparm[d.toString()]!=null){let v=n.filterparm[d.toString()];if(v.rowhidden!=null&&(b+="data-rowhidden='"+JSON.stringify(v.rowhidden)+"'"),v.selected!=null&&(b+="data-selected='"+JSON.stringify(v.selected)+"'"),v.caljs!=null){let x=v.caljs;x.value!=null&&(b+="data-byconditionvalue='"+x.value+"'"),x.type!=null&&(b+="data-byconditiontype='"+x.type+"'"),x.text!=null&&(b+="data-byconditiontext='"+x.text+"'"),x.value1!=null&&(b+="data-byconditionvalue1='"+x.value1+"'"),x.value2!=null&&(b+="data-byconditionvalue2='"+x.value2+"'")}}b.length>0&&(g="display:block;"),s+='<div class="luckysheet-modal-dialog-slider-list-item" '+b+' data-index="'+d+'" data-name="'+p+'"><div title="'+l.titleAddColumn+'" class="luckysheet-slider-list-item-selected"><div></div></div><div title="'+l.titleMoveColumn+'" class="luckysheet-slider-list-item-name" '+b+' data-index="'+d+'" data-name="'+p+'">'+p+'</div><div title="'+l.titleClearColumnFilter+'" class="luckysheet-slider-list-item-filtered" style="'+g+'"><i class="fa fa-filter luckysheet-mousedown-cancel" aria-hidden="true"></i><i class="fa fa-times" aria-hidden="true"></i></div><div title="'+l.titleFilterColumn+'" class="luckysheet-slider-list-item-filter"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'}if($("#luckysheet-modal-dialog-pivotTable-list").html(s),$("#luckysheetpivottablevaluecolrowshow").hide(),$("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").empty(),e){if(n.filter!=null&&n.filter.length>0)for(let d=0;d<n.filter.length;d++){let p=n.filter[d],b='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" data-index="'+p.index+'" data-name="'+p.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" data-index="'+p.index+'" data-name="'+p.name+'">'+p.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-filter").append(b);let g=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(p.index).find(".luckysheet-slider-list-item-selected");g.find("i").length==0&&g.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.row!=null&&n.row.length>0)for(let d=0;d<n.row.length;d++){let p=n.row[d],b="";p.order!=null&&(b+="data-order = '"+p.order+"'"),p.orderby!=null&&(b+="data-orderby = '"+p.orderby+"'"),p.order!=null&&(b+="data-stastic = '"+p.stastic+"'");let g='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+b+' data-index="'+p.index+'" data-name="'+p.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+b+' data-index="'+p.index+'" data-name="'+p.name+'">'+p.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-row").append(g);let v=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(p.index).find(".luckysheet-slider-list-item-selected");v.find("i").length==0&&v.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.column!=null&&n.column.length>0)for(let d=0;d<n.column.length;d++){let p=n.column[d],b="";p.order!=null&&(b+="data-order = '"+p.order+"'"),p.orderby!=null&&(b+="data-orderby = '"+p.orderby+"'"),p.order!=null&&(b+="data-stastic = '"+p.stastic+"'");let g='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+b+' data-index="'+p.index+'" data-name="'+p.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+b+' data-index="'+p.index+'" data-name="'+p.name+'">'+p.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-column").append(g);let v=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(p.index).find(".luckysheet-slider-list-item-selected");v.find("i").length==0&&v.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}if(n.values!=null&&n.values.length>0){for(let d=0;d<n.values.length;d++){let p=n.values[d],b="";p.sumtype!=null&&(b+="data-sumtype = '"+p.sumtype+"'"),p.nameindex!=null&&(b+="data-nameindex = '"+p.nameindex+"'");let g='<div title="'+name+'" class="luckysheet-modal-dialog-slider-config-item" '+b+' data-index="'+p.index+'" data-name="'+p.name+'"><div class="luckysheet-modal-dialog-slider-config-item-txt" '+b+' data-index="'+p.index+'" data-name="'+p.name+'">'+n.getSumTypeName(p.sumtype)+":"+p.name+'</div><div class="luckysheet-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#luckysheet-modal-dialog-config-value").append(g);let v=$("#luckysheet-modal-dialog-pivotTable-list .luckysheet-modal-dialog-slider-list-item").eq(p.index).find(".luckysheet-slider-list-item-selected");v.find("i").length==0&&v.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')}n.values.length>=2&&($("#luckysheetpivottablevaluecolrowshow").show(),n.showType=="column"?($("#luckysheetpivottablevaluecolrow").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow1").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#luckysheetpivottablevaluecolrow1").prop("checked",!0),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow1']").addClass("ui-state-active"),$("#luckysheetpivottablevaluecolrow").prop("checked",!1),$("#luckysheetpivottablevaluecolrowshow label[for='luckysheetpivottablevaluecolrow']").removeClass("ui-state-active")))}}$("#luckysheet-dialog-pivotTable-range").html(Kl(n.pivotDataSheetIndex,n.pivot_select_save)),$("#luckysheet-modal-dialog-slider-pivot").show(),mr(!1)},getComposeArray:function(e){if(e.length==0)return[];let n=[];for(let t=0;t<e.length;t++){let l="";for(let o=0;o<=t;o++)!!e[o]&&!!e[o].m?l+=e[o].m:l+=Vt(o,null,e);n.push(l)}return n},getnameArray:function(e,n){if(e.length==0)return[];if(n.length==0)return[];let t=[];for(let l=0;l<n.length;l++){let o;!!e[n[l].index]&&!!e[n[l].index].m?o=e[n[l].index].m:o=Vt(n[l].index,null,e),t.push(o)}return t},getTitleFromGroup:function(e,n,t){let l=this,o=l.orderbygroup(e,n,t);return l.generategrouparraymain(o,n)},orderbygroup:function(e,n,t){let l=this,o=[];if(e.length==0)return[];o=e;let a=null,s=o.length,u=o.length,f=0;for(;s!=0;)if(a=o[f++],s--,a.children!=null&&a.children.length>0){a.children=l.orderbygroupchildren(a.children,n[a.index].orderby,n[a.index].order,t);for(let m=0;m<a.children.length;m++)o.push(a.children[m]),s++}return e.splice(0,u)},orderbygroupchildren:function(e,n,t,l){if(e.length==0)return[];let o=!1;(t==null||t=="asc")&&(o=!0);let s=Be().filter,u=function(m,d){let p=null,b=null;if(n=="self"||n==null){if(m.name==null?p=s.valueBlank:p=m.name.toString(),d.name==null?b=s.valueBlank:b=d.name.toString(),dr(p)&&dr(b))return un(p,b)}else p=parseFloat(l[m.orderby].result),b=parseFloat(l[d.orderby].result);if(!isNaN(p)&&!isNaN(b))return(0,sf.default)(p).value()-(0,sf.default)(b).value();if(isNaN(p)&&isNaN(b))return p.localeCompare(b);if(isNaN(p))return 1;if(isNaN(b))return-1},f=function(m,d){let p=null,b=null;if(n=="self"||n==null){if(m.name==null?p=s.valueBlank:p=m.name.toString(),d.name==null?b=s.valueBlank:b=d.name.toString(),dr(p)&&dr(b))return un(p,b)}else p=parseFloat(l[m.orderby].result),b=parseFloat(l[d.orderby].result);if(!isNaN(p)&&!isNaN(b))return(0,sf.default)(b).value()-(0,sf.default)(p).value();if(isNaN(p)&&isNaN(b))return b.localeCompare(p);if(isNaN(p))return-1;if(isNaN(b))return 1};return o?e.sort(u):e.sort(f)},generategroupaddstatic:function(e,n){let t=[],o=Be().pivotTable;for(let a=0;a<e[0].length;a++)a==0?n==o.valueSum?t.push(n):t.push({name:n,issum:!0}):t.push("");return t},generategrouparraymain:function(e,n){let t=this,l=[];for(let o=0;o<e.length;o++){let a=e[o].name,s=t.generategrouparray(e[o].children,n,1);(n[0].stastic=="1"||n[0].stastic==null)&&s.push(t.generategroupaddstatic(s,a)),l=l.concat(s)}return l},generategrouparray:function(e,n,t){let l=this,o=[];for(let a=0;a<e.length;a++){let s=e[a].name,u;if(e[a].children==0||e[a].children.length==0)u=[s],o.push(u);else{u=l.generategrouparray(e[a].children,n,t+1);for(let f=0;f<u.length;f++)u[f].unshift(s);(n[t].stastic=="1"||n[t].stastic==null)&&u.push(l.generategroupaddstatic(u,s)),o=o.concat(u)}}return o},addStatisticsData:function(e,n,t,l){if(e[t]==null&&(e[t]={data:[],count:0,max:-Infinity,min:Infinity,counta:0,countunique:0,countuniquedata:{},sum:0,digitaldata:[],sumtype:n.sumtype,index:n.index,name:n.fullname,acc:0}),Cs(l).num===!0){let o=Qn(l,6);e[t].digitaldata.push(o),e[t].count+=1,e[t].sum+=o,o>e[t].max&&(e[t].max=o),o<e[t].min&&(e[t].min=o);let a=Xm(o);a>e[t].acc&&(e[t].acc=a)}l!=""&&(e[t].data.push(l),e[t].counta+=1,l in e[t].countuniquedata||(e[t].countuniquedata[l]=1,e[t].countunique+=1))},dataHandler:function(e,n,t,l,o){let a=this,s=Be(),u=s.filter,f=s.pivotTable;if(l==null&&(l="column"),e.length==0&&n.length==0&&t.length==0||o.length==0)return a.pivotDatas=[],[];let m={},d=o,p=[],b=[],g={},v=0,x=[],_=[],S={},I=0;for(let O=1;O<d.length;O++){let z=d[O],A="",E="",L="",N=[],W=[],X="",te=[],ue=[];W=a.getnameArray(z,n),ue=a.getnameArray(z,e),N=a.getComposeArray(W),te=a.getComposeArray(ue),N.length>0&&N.unshift(f.valueSum),te.length>0&&te.unshift(f.valueSum);let pe=g,ne=b;for(let ie=0;ie<N.length;ie++){let ge=N[ie],ce=ie==0?f.valueSum:W[ie-1];if(pe[ie.toString()]!=null&&pe[ie.toString()][ge]!=null)ne=ne[pe[ie.toString()][ge]].children;else{let fe=ie==0?"self":n[ie-1].orderby=="self"||n[ie-1].orderby==null?ge:l=="column"?ge+t[parseInt(n[ie-1].orderby)].fullname:ge+f.valueSum;ce==null&&(ce=u.valueBlank),ne.push({name:ce,fullname:ge,index:ie,orderby:fe,children:[]}),pe[ie.toString()]==null&&(pe[ie.toString()]={}),pe[ie.toString()][ge]==null&&(pe[ie.toString()][ge]=ne.length-1),ne=ne[ne.length-1].children}}let me=S,Q=_;for(let ie=0;ie<te.length;ie++){let ge=te[ie],ce=ie==0?f.valueSum:ue[ie-1];if(me[ie.toString()]!=null&&me[ie.toString()][ge]!=null)Q=Q[me[ie.toString()][ge]].children;else{let fe=ie==0?"self":e[ie-1].orderby=="self"||e[ie-1].orderby==null?ge:l=="column"?f.valueSum+ge:t[parseInt(e[ie-1].orderby)].fullname+ge;ce==null&&(ce=u.valueBlank),Q.push({name:ce,fullname:ge,index:ie,orderby:fe,children:[]}),me[ie.toString()]==null&&(me[ie.toString()]={}),me[ie.toString()][ge]==null&&(me[ie.toString()][ge]=Q.length-1),Q=Q[Q.length-1].children}}let we="";for(let ie=0;ie<t.length;ie++){let ge=Vt(t[ie].index,null,z),ce=[].concat(te),fe=[].concat(N);l=="column"?ce.length>0?(ce.push(""),ce=ce.join(t[ie].fullname+"|||").split("|||").slice(0,ce.length-1)):ce.push(t[ie].fullname):fe.length>0?(fe.push(""),fe=fe.join(t[ie].fullname+"|||").split("|||").slice(0,fe.length-1)):fe.push(t[ie].fullname),ce.length==0&&ce.push(""),fe.length==0&&fe.push("");for(let ye=0;ye<fe.length;ye++)for(let Ne=0;Ne<ce.length;Ne++){let xe=fe[ye]+ce[Ne];a.addStatisticsData(m,t[ie],xe,ge)}}}for(let O in m){let z=m[O];if(z.sumtype=="SUM")z.result=z.sum;else if(z.sumtype=="COUNT")z.result=z.count;else if(z.sumtype=="COUNTA")z.result=z.counta;else if(z.sumtype=="COUNTUNIQUE")z.result=z.countunique;else if(z.sumtype=="AVERAGE")z.result=Qn(z.sum/z.count);else if(z.sumtype=="MAX")z.result=z.max;else if(z.sumtype=="MIN")z.result=z.min;else if(z.sumtype=="MEDIAN"){let E=z.digitaldata.sort(function(W,X){return W-X}),L=E.length,N=parseInt(L/2);L%2==0?z.result=(E[N-1]+E[N])/2:z.result=E[N]}else if(z.sumtype=="PRODUCT")z.result=new Function("return "+z.digitaldata.join("*"))();else if(z.sumtype=="STDEV"){let E=z.sum/z.count;z.result=af.STDEV(E,z.digitaldata)}else if(z.sumtype=="STDEVP"){let E=z.sum/z.count;z.result=af.STDEVP(E,z.digitaldata)}else if(z.sumtype=="let"){let E=z.sum/z.count;z.result=af.let(E,z.digitaldata)}else if(z.sumtype=="VARP"){let E=z.sum/z.count;z.result=af.VARP(E,z.digitaldata)}let A=Xm(z.result);A>z.acc&&(z.acc=A),z.result=Qn(z.result,z.acc)}if(p=a.getTitleFromGroup(b,n,m),x=a.getTitleFromGroup(_,e,m),l=="column")if(x.length>0&&x[0].length>0)x=a.addValuesToTitle(x,t);else for(let O=0;O<t.length;O++)x.push([t[O].fullname]);else if(p.length>0&&p[0].length>0)p=a.addValuesToTitle(p,t);else for(let O=0;O<t.length;O++)p.push([t[O].fullname]);let P=x;x=Ky.transpose(x,!1);let F=t.length==0?0:1,D=(x.length==0?F:x.length)+(p.length==0?F:p.length),k=(x.length==0?F:x[0].length)+(p.length==0?F:p[0].length),w=x.length,C=p.length==0?0:p[0].length,T=[];for(let O=0;O<D;O++){T[O]=new Array(k);for(let z=0;z<k;z++){let A=p[O-w];if(O<w&&z<C)T[O][z]="";else if(O<w&&z>=C)x[O]!=null?G(x[O][z-C])=="object"?T[O][z]=x[O][z-C].name+f.valueSum:T[O][z]=x[O][z-C]:T[O][z]="";else if(O>=w&&z<C)A!=null?G(A[z])=="object"?T[O][z]=A[z].name+f.valueSum:T[O][z]=A[z]:T[O][z]="";else{let E="";if(A!=null)if(!(A instanceof Array)||A.length==1)A instanceof Array?E=A[0]:E=A;else for(let X=0;X<A.length;X++)G(A[X])=="object"?E+=A[X].name:E+=A[X];let L="",N=P[z-C];if(N!=null)if(!(N instanceof Array)||N.length==1)N instanceof Array?L=N[0]:L=N;else for(let X=0;X<N.length;X++)G(N[X])=="object"?L+=N[X].name:L+=N[X];let W=E;E!=""&&L!=""?W=E+L:E==""&&(W=L),m[W]==null?T[O][z]="":T[O][z]=m[W].result}}}if(t.length==1&&e.length>0&&n.length>0)T[0][0]=t[0].fullname,T.splice(e.length,1);else if(t.length==1&&e.length>0){let O=T.splice(e.length,1),z=[];for(let A=0;A<T.length;A++){let E=[];A==T.length-1?E.push(O[0][0]):E.push("");for(let L=0;L<T[A].length-1;L++)E.push(T[A][L]);z.push(E)}T=z}return a.pivotDatas=T,T},drillDown:function(e,n){if(!nr(h.currentSheetIndex,"usePivotTablereports"))return;let t=this,l=t.pivotDatas[e][n],o=$.extend(!0,[],kt.nulldata),a=Be(),s=a.filter,u=a.pivotTable,f=1;for(let p=0;p<t.celldata[0].length;p++){let b;!!t.celldata[0][p]&&!!t.celldata[0][p].m?b=t.celldata[0][p].m:b=Vt(0,p,t.celldata),b!=null&&(b=b.toString()),(b==null||$.trim(b.toString()).length==0)&&(b=u.titleColumn+" "+f),f++,o[0][p]=b}let m={};if(t.row!=null&&t.row.length>0)for(let p=0;p<t.row.length;p++)m[t.row[p].index]=t.pivotDatas[e][p];if(t.column!=null&&t.column.length>0)for(let p=0;p<t.column.length;p++)m[t.column[p].index]=t.pivotDatas[p][n];let d=[];for(let p=1;p<t.celldata.length;p++){let b=!0;for(let g in m){let v;if(!!t.celldata[p][g]&&!!t.celldata[p][g].m?v=t.celldata[p][g].m:v=Vt(p,g,t.celldata),v!=null?v=v.toString():v=s.valueBlank,v!=m[g]){b=!1;break}}b&&d.push(p)}for(let p=0;p<d.length;p++)for(let b=0;b<t.celldata[0].length;b++){let g;!!t.celldata[d[p]][b]&&!!t.celldata[d[p]][b].m?g=t.celldata[d[p]][b].m:g=Vt(d[p],b,t.celldata),g!=null?g=g.toString():g="",o[p+1][b]=g}h.luckysheet_select_save=[{row:[0,d.length],column:[0,t.celldata[0].length-1]}],h.clearjfundo=!1,al(o,h.luckysheet_select_save),gl(),h.clearjfundo=!0}},Yt=e1});var import_plugin,t1,e3,cf,Zm,Km,Jm,$h,l1,t3,l3,uf,Oo,r1,r3,n3,Hi,Qm=Nt(()=>{import_plugin=qe(Ye());il();t1=function(){let e,n;return e=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(e.prototype=$.extend(new arguments[0],arguments[arguments.length-1]),e._super=arguments[0].prototype):e.prototype=arguments[arguments.length-1],arguments.length>2&&(n=Array.prototype.slice.call(arguments,1,-1),n.unshift(e.prototype),$.extend.apply($,n))):e.prototype=arguments[0],e.prototype.cls=e,e},e3=t1({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(e,n){this.format=e,this.fclass=n},render:function(e,n,t){let l=this,o=e,a,s,u,f,m;return this.format.replace(this.fre,function(){let d;return s=arguments[1],u=arguments[3],a=l.precre.exec(s),a?(m=a[2],s=a[1]):m=!1,f=o[s],f===void 0?"":u&&n&&n[u]?(d=n[u],d.get?n[u].get(f)||f:n[u][f]||f):(t3(f)&&(t.get("numberFormatter")?f=t.get("numberFormatter")(f):f=l3(f,m,t.get("numberDigitGroupCount"),t.get("numberDigitGroupSep"),t.get("numberDecimalMark"))),f)})}});$.spformat=function(e,n){return new e3(e,n)};cf=function(e,n,t){return e<n?n:e>t?t:e},Zm=function(e,n){let t;return n===2?(t=Math.floor(e.length/2),e.length%2?e[t]:(e[t-1]+e[t])/2):e.length%2?(t=(e.length*n+n)/4,t%1?(e[Math.floor(t)]+e[Math.floor(t)-1])/2:e[t-1]):(t=(e.length*n+2)/4,t%1?(e[Math.floor(t)]+e[Math.floor(t)-1])/2:e[t-1])},Km=function(e){let n;switch(e){case"undefined":e=void 0;break;case"null":e=null;break;case"true":e=!0;break;case"false":e=!1;break;default:n=parseFloat(e),e==n&&(e=n)}return e},Jm=function(e){let n,t=[];for(n=e.length;n--;)t[n]=Km(e[n]);return t},$h=function(e,n,t){let l;for(l=n.length;l--;)if(!(t&&n[l]===null)&&n[l]!==e)return!1;return!0},l1=function(e,n){let t,l,o=[];for(t=0,l=e.length;t<l;t++)e[t]!==n&&o.push(e[t]);return o},t3=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},l3=function(e,n,t,l,o){let a,s;for(e=(n===!1?parseFloat(e).toString():e.toFixed(n)).split(""),a=(a=$.inArray(".",e))<0?e.length:a,a<e.length&&(e[a]=o),s=a-t;s>0;s-=t)e.splice(s,0,l);return e.join("")},uf=t1({init:function(e){let n,t,l=[];for(n in e)e.hasOwnProperty(n)&&typeof n=="string"&&n.indexOf(":")>-1&&(t=n.split(":"),t[0]=t[0].length===0?-Infinity:parseFloat(t[0]),t[1]=t[1].length===0?Infinity:parseFloat(t[1]),t[2]=e[n],l.push(t));this.map=e,this.rangelist=l||!1},get:function(e){let n=this.rangelist,t,l,o;if((o=this.map[e])!==void 0)return o;if(n){for(t=n.length;t--;)if(l=n[t],l[0]<=e&&l[1]>=e)return l[2]}}});$.range_map=function(e){return new uf(e)};Oo={defaultOption:{common:{type:"line",lineColor:"#2ec7c9",fillColor:"#CCF3F4",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!0,disableInteraction:!0,offsetX:0,offsetY:0},line:{spotColor:0,highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:0,maxSpotColor:0,lineWidth:1,normalRangeMin:void 0,normalRangeMax:void 0,normalRangeColor:"#ccc",drawNormalOnTop:!0,chartRangeMin:void 0,chartRangeMax:void 0,chartRangeMinX:void 0,chartRangeMaxX:void 0},bar:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},column:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},tristate:{barWidth:4,barSpacing:1,posBarColor:"#fc5c5c",negBarColor:"#97b552",zeroBarColor:"#999",colorMap:{}},discrete:{lineHeight:"auto",thresholdColor:"#fc5c5c",thresholdValue:0,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff","#6D87FF","#5876FF","#4465FF","#2F54FF","#1A43FF","#0532FF"],base:void 0},pie:{offset:0,sliceColors:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],borderWidth:0,borderColor:"#000"},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#5E5E5E",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:void 0,targetColor:"#4a2",chartRangeMax:void 0,chartRangeMin:void 0}},line:{type:"line",init:function(e,n,t,l,o){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null},getRegion:function(e,n,t){let l,o=this.regionMap;for(l=o.length;l--;)if(o[l]!==null&&n>=o[l][0]&&n<=o[l][1])return o[l][2]},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.yvalues[e]===null,x:this.xvalues[e],y:this.yvalues[e],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:e}},renderHighlight:function(){let e=this.currentRegion,n=this.target,t=this.vertices[e],l=this.options,o=l.get("spotRadius"),a=l.get("highlightSpotColor"),s=l.get("highlightLineColor"),u,f;!t||(o&&a&&(u=n.drawCircle(t[0],t[1],o,void 0,a),this.highlightSpotId=u.id,n.insertAfterShape(this.lastShapeId,u)),s&&(f=n.drawLine(t[0],this.canvasTop,t[0],this.canvasTop+this.canvasHeight,s),this.highlightLineId=f.id,n.insertAfterShape(this.lastShapeId,f)))},removeHighlight:function(){let e=this.target;this.highlightSpotId&&(e.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(e.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){let e=this.values,n=e.length,t=this.xvalues,l=this.yvalues,o=this.yminmax,a,s,u,f,m;for(a=0;a<n;a++)s=e[a],u=typeof e[a]=="string",f=typeof e[a]=="object"&&e[a]instanceof Array,m=u&&e[a].split(":"),u&&m.length===2?(t.push(Number(m[0])),l.push(Number(m[1])),o.push(Number(m[1]))):f?(t.push(s[0]),l.push(s[1]),o.push(s[1])):(t.push(a),e[a]===null||e[a]==="null"?l.push(null):(l.push(Number(s)),o.push(Number(s))));this.options.get("xvalues")&&(t=this.options.get("xvalues")),this.maxy=this.maxyorg=Math.max.apply(Math,o),this.miny=this.minyorg=Math.min.apply(Math,o),this.maxx=Math.max.apply(Math,t),this.minx=Math.min.apply(Math,t),this.xvalues=t,this.yvalues=l,this.yminmax=o},processRangeOptions:function(){let e=this.options,n=e.get("normalRangeMin"),t=e.get("normalRangeMax");n!==void 0&&(n<this.miny&&(this.miny=n),t>this.maxy&&(this.maxy=t)),e.get("chartRangeMin")!==void 0&&(e.get("chartRangeClip")||e.get("chartRangeMin")<this.miny)&&(this.miny=e.get("chartRangeMin")),e.get("chartRangeMax")!==void 0&&(e.get("chartRangeClip")||e.get("chartRangeMax")>this.maxy)&&(this.maxy=e.get("chartRangeMax")),e.get("chartRangeMinX")!==void 0&&(e.get("chartRangeClipX")||e.get("chartRangeMinX")<this.minx)&&(this.minx=e.get("chartRangeMinX")),e.get("chartRangeMaxX")!==void 0&&(e.get("chartRangeClipX")||e.get("chartRangeMaxX")>this.maxx)&&(this.maxx=e.get("chartRangeMaxX"))},drawNormalRange:function(e,n,t,l,o){let a=this.options.get("normalRangeMin"),s=this.options.get("normalRangeMax"),u=n+Math.round(t-t*((s-this.miny)/o)),f=Math.round(t*(s-a)/o);f==0&&a==s&&(f=1),this.target.drawRect(e,u,l,f,void 0,this.options.get("normalRangeColor")).append()},render:function(e,n){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.values=n;let t=this.options,l=this.target,o=e.mergedOptions.width,a=e.mergedOptions.height,s=this.vertices,u=t.get("spotRadius"),f=this.regionMap,m,d,p,b,g,v,x,_,S,I,P,F,D,k,w,C,T,O,z,A,E,L,N,W,X;if(this.scanValues(),this.processRangeOptions(),N=this.xvalues,W=this.yvalues,!(!this.yminmax.length||this.yvalues.length<2)){for(b=g=0,m=this.maxx-this.minx==0?1:this.maxx-this.minx,d=this.maxy-this.miny==0?1:this.maxy-this.miny,p=this.yvalues.length-1,u&&(o<u*4||a<u*4)&&(u=0),u&&(E=t.get("highlightSpotColor")&&!t.get("disableInteraction"),(E||t.get("minSpotColor")||t.get("spotColor")&&W[p]===this.miny)&&(a-=Math.ceil(u)),(E||t.get("maxSpotColor")||t.get("spotColor")&&W[p]===this.maxy)&&(a-=Math.ceil(u),b+=Math.ceil(u)),(E||(t.get("minSpotColor")||t.get("maxSpotColor"))&&(W[0]===this.miny||W[0]===this.maxy))&&(g+=Math.ceil(u),o-=Math.ceil(u)),(E||t.get("spotColor")||t.get("minSpotColor")||t.get("maxSpotColor")&&(W[p]===this.miny||W[p]===this.maxy))&&(o-=Math.ceil(u))),a--,t.get("normalRangeMin")!==void 0&&!t.get("drawNormalOnTop")&&this.drawNormalRange(g,b,a,o,d),x=[],_=[x],k=w=null,C=W.length,X=0;X<C;X++)S=N[X],P=N[X+1],I=W[X],F=g+Math.round((S-this.minx)*(o/m)),D=X<C-1?g+Math.round((P-this.minx)*(o/m)):o,w=F+(D-F)/2,f[X]=[k||0,w,X],k=w,I===null?X&&(W[X-1]!==null&&(x=[],_.push(x)),s.push(null)):(I<this.miny&&(I=this.miny),I>this.maxy&&(I=this.maxy),x.length||x.push([F,b+a]),v=[F,b+Math.round(a-a*((I-this.miny)/d))],x.push(v),s.push(v));for(T=[],O=[],z=_.length,X=0;X<z;X++)x=_[X],x.length&&(t.get("fillColor")&&(x.push([x[x.length-1][0],b+a]),O.push(x.slice(0)),x.pop()),x.length>2&&(x[0]=[x[0][0],x[1][1]]),T.push(x));for(z=O.length,X=0;X<z;X++)l.drawShape(O[X],t.get("fillColor"),t.get("fillColor")).append();for(z=T.length,X=0;X<z;X++)l.drawShape(T[X],t.get("lineColor"),void 0,t.get("lineWidth")).append();if(t.get("normalRangeMin")!==void 0&&t.get("drawNormalOnTop")&&this.drawNormalRange(g,b,a,o,d),u&&t.get("valueSpots"))for(A=t.get("valueSpots"),A.get===void 0&&(A=new uf(A)),X=0;X<C;X++)L=A.get(W[X]),L&&l.drawCircle(g+Math.round((N[X]-this.minx)*(o/m)),b+Math.round(a-a*((W[X]-this.miny)/d)),u,void 0,L).append();u&&t.get("spotColor")&&W[p]!==null&&l.drawCircle(g+Math.round((N[N.length-1]-this.minx)*(o/m)),b+Math.round(a-a*((W[p]-this.miny)/d)),u,void 0,t.get("spotColor")).append(),this.maxy!==this.minyorg&&(u&&t.get("minSpotColor")&&(S=N[$.inArray(this.minyorg,W)],l.drawCircle(g+Math.round((S-this.minx)*(o/m)),b+Math.round(a-a*((this.minyorg-this.miny)/d)),u,void 0,t.get("minSpotColor")).append()),u&&t.get("maxSpotColor")&&(S=N[$.inArray(this.maxyorg,W)],l.drawCircle(g+Math.round((S-this.minx)*(o/m)),b+Math.round(a-a*((this.maxyorg-this.miny)/d)),u,void 0,t.get("maxSpotColor")).append()))}}},bar:{type:"bar",init:function(e,n){let t=this.options,l=e.mergedOptions.height,o=e.mergedOptions.width;this.canvasWidth=e.mergedOptions.height,this.canvasHeight=e.mergedOptions.width;let a=parseInt(t.get("barWidth"),10),s=parseInt(t.get("barSpacing"),10),u=t.get("chartRangeMin"),f=t.get("chartRangeMax"),m=t.get("chartRangeClip"),d=Infinity,p=-Infinity,b,g,v,x,_,S,I,P,F,D,k,w,C,T,O,z,A,E,L,N,W,X,te;for(this.values=n,S=0,I=n.length;S<I;S++)N=n[S],b=typeof N=="string"&&N.indexOf(":")>-1,(b||$.isArray(N))&&(O=!0,b&&(N=n[S]=Jm(N.split(":"))),N=l1(N,null),g=Math.min.apply(Math,N),v=Math.max.apply(Math,N),g<d&&(d=g),v>p&&(p=v));this.stacked=O,this.regionShapes={},this.barWidth=Math.floor(l/n.length)-s,this.barSpacing=s,this.totalBarWidth=this.barWidth+s,this.width=l,m&&(C=u===void 0?-Infinity:u,T=f===void 0?Infinity:f),_=[],x=O?[]:_;let ue=[],pe=[];for(S=0,I=n.length;S<I;S++)if(O)for(z=n[S],n[S]=L=[],ue[S]=0,x[S]=pe[S]=0,A=0,E=z.length;A<E;A++)N=L[A]=m?cf(z[A],C,T):z[A],N!==null&&(N>0&&(ue[S]+=N),d<0&&p>0?N<0?pe[S]+=Math.abs(N):x[S]+=N:x[S]+=Math.abs(N),_.push(N));else N=m?cf(n[S],C,T):n[S],N=n[S]=Km(N),N!==null&&_.push(N);this.max=w=Math.max.apply(Math,_),this.min=k=Math.min.apply(Math,_),this.stackMax=p=O?Math.max.apply(Math,ue):w,this.stackMin=d=O?Math.min.apply(Math,_):k,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<k)&&(k=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>w)&&(w=t.get("chartRangeMax")),this.zeroAxis=F=t.get("zeroAxis",!0),k<=0&&w>=0&&F?D=0:F==!1?D=k:k>0?D=0:D=w,this.xaxisOffset=D,P=O?Math.max.apply(Math,x)+Math.max.apply(Math,pe):w-D,this.canvasHeightEf=F&&k<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,k<D?(W=Math.floor(this.canvasHeight/2),this.isNeg=!0,W!==Math.ceil(W)&&(this.canvasHeightEf-=2,W=Math.ceil(W))):W=0,this.yoffset=W,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new uf(this.colorMapByValue))),this.range=P},getRegion:function(e,n,t){let l=Math.floor(n/this.totalBarWidth);return l<0||l>=this.values.length?void 0:l},getCurrentRegionFields:function(){let e=this.currentRegion,n=ensureArray(this.values[e]),t=[],l,o;for(o=n.length;o--;)l=n[o],t.push({isNull:l===null,value:l,color:this.calcColor(o,l,e),offset:e});return t},calcColor:function(e,n,t){let l=this.colorMapByIndex,o=this.colorMapByValue,a=this.options,s,u;return this.stacked?s=a.get("stackedBarColor"):s=n<0?a.get("negBarColor"):a.get("barColor"),n===0&&a.get("zeroColor")!==void 0&&(s=a.get("zeroColor")),o&&(u=o.get(n))?s=u:l&&l.length>t&&(s=l[t]),$.isArray(s)?s[e%s.length]:s},renderRegion:function(e,n){let t=this.values[e],l=this.options,o=this.xaxisOffset,a=[],s=this.range,u=this.stacked,f=this.target,m=e*this.totalBarWidth,d=this.canvasHeightEf,p=this.yoffset,b,g,v,x,_,S,I,P,F,D;if(t=$.isArray(t)?t:[t],I=t.length,P=t[0],x=$h(null,t),D=$h(o,t,!0),x)return l.get("nullColor")?(v=n?l.get("nullColor"):this.calcHighlightColor(l.get("nullColor"),l),b=p>0?p-1:p,f.drawRect(b,m,0,this.barWidth-1,v,v)):void 0;for(_=p,this.isNeg&&(d=Math.floor(d/2)),S=0;S<I;S++){if(P=t[S],u&&P===o){if(!D||F)continue;F=!0}s>0?g=Math.floor(d*(Math.abs(P-o)/s)):g=d,P<o||P===o&&p===0?(b=_-g,_+=g):u?(b=p,p+=g):(b=p,p-=g),v=this.calcColor(S,P,e),n&&(v=this.calcHighlightColor(v,l)),a.push(f.drawRect(b,m,g-1,this.barWidth-1,v,v))}return a.length===1?a[0]:a}},column:{type:"column",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a=parseInt(t.get("barWidth"),10),s=parseInt(t.get("barSpacing"),10),u=t.get("chartRangeMin"),f=t.get("chartRangeMax"),m=t.get("chartRangeClip"),d=Infinity,p=-Infinity,b,g,v,x,_,S,I,P,F,D,k,w,C,T,O,z,A,E,L,N,W,X,te;for(this.values=n,S=0,I=n.length;S<I;S++)N=n[S],b=typeof N=="string"&&N.indexOf(":")>-1,(b||$.isArray(N))&&(O=!0,b&&(N=n[S]=Jm(N.split(":"))),N=l1(N,null),g=Math.min.apply(Math,N),v=Math.max.apply(Math,N),g<d&&(d=g),v>p&&(p=v));this.stacked=O,this.regionShapes={},this.barWidth=Math.floor(l/n.length)-s,this.barSpacing=s,this.totalBarWidth=this.barWidth+s,this.width=l,m&&(C=u===void 0?-Infinity:u,T=f===void 0?Infinity:f),_=[],x=O?[]:_;let ue=[],pe=[];for(S=0,I=n.length;S<I;S++)if(O)for(z=n[S],n[S]=L=[],ue[S]=0,x[S]=pe[S]=0,A=0,E=z.length;A<E;A++)N=L[A]=m?cf(z[A],C,T):z[A],N!==null&&(N>0&&(ue[S]+=N),d<0&&p>0?N<0?pe[S]+=Math.abs(N):x[S]+=N:x[S]+=Math.abs(N),_.push(N));else N=m?cf(n[S],C,T):n[S],N=n[S]=Km(N),N!==null&&_.push(N);this.max=w=Math.max.apply(Math,_),this.min=k=Math.min.apply(Math,_),this.stackMax=p=O?Math.max.apply(Math,ue):w,this.stackMin=d=O?Math.min.apply(Math,_):k,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<k)&&(k=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>w)&&(w=t.get("chartRangeMax")),this.zeroAxis=F=t.get("zeroAxis",!0),k<=0&&w>=0&&F?D=0:F==!1?D=k:k>0?D=0:D=w,this.xaxisOffset=D,P=O?Math.max.apply(Math,x)+Math.max.apply(Math,pe):w-D,this.canvasHeightEf=F&&k<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,k<D?(W=Math.floor(this.canvasHeight/2),this.isNeg=!0,W!==Math.ceil(W)&&(this.canvasHeightEf-=2,W=Math.ceil(W))):W=this.canvasHeight,this.yoffset=W,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new uf(this.colorMapByValue))),this.range=P},getRegion:function(e,n,t){let l=Math.floor(n/this.totalBarWidth);return l<0||l>=this.values.length?void 0:l},getCurrentRegionFields:function(){let e=this.currentRegion,n=ensureArray(this.values[e]),t=[],l,o;for(o=n.length;o--;)l=n[o],t.push({isNull:l===null,value:l,color:this.calcColor(o,l,e),offset:e});return t},calcColor:function(e,n,t){let l=this.colorMapByIndex,o=this.colorMapByValue,a=this.options,s,u;return this.stacked?s=a.get("stackedBarColor"):s=n<0?a.get("negBarColor"):a.get("barColor"),n===0&&a.get("zeroColor")!==void 0&&(s=a.get("zeroColor")),o&&(u=o.get(n))?s=u:l&&l.length>t&&(s=l[t]),$.isArray(s)?s[e%s.length]:s},renderRegion:function(e,n){let t=this.values[e],l=this.options,o=this.xaxisOffset,a=[],s=this.range,u=this.stacked,f=this.target,m=e*this.totalBarWidth,d=this.canvasHeightEf,p=this.yoffset,b,g,v,x,_,S,I,P,F,D;if(t=$.isArray(t)?t:[t],I=t.length,P=t[0],x=$h(null,t),D=$h(o,t,!0),x)return l.get("nullColor")?(v=n?l.get("nullColor"):this.calcHighlightColor(l.get("nullColor"),l),b=p>0?p-1:p,f.drawRect(m,b,this.barWidth-1,0,v,v)):void 0;for(_=p,this.isNeg&&(d=Math.floor(d/2)),S=0;S<I;S++){if(P=t[S],u&&P===o){if(!D||F)continue;F=!0}s>0?g=Math.floor(d*(Math.abs(P-o)/s)):g=d,P<o||P===o&&p===0?(b=_,_+=g):(b=p-g,p-=g),v=this.calcColor(S,P,e),n&&(v=this.calcHighlightColor(v,l)),a.push(f.drawRect(m,b,this.barWidth-1,g-1,v,v))}return a.length===1?a[0]:a}},tristate:{type:"tristate",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a=parseInt(t.get("barWidth"),10),s=parseInt(t.get("barSpacing"),10);this.regionShapes={},this.barWidth=a,this.barSpacing=s,this.totalBarWidth=a+s,this.values=$.map(n,Number),this.width=l=n.length*a+(n.length-1)*s,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===void 0&&(this.colorMapByValue=new uf(this.colorMapByValue)))},getRegion:function(e,n,t){return Math.floor(n/this.totalBarWidth)},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],color:this.calcColor(this.values[e],e),offset:e}},calcColor:function(e,n){let t=this.values,l=this.options,o=this.colorMapByIndex,a=this.colorMapByValue,s,u;return a&&(u=a.get(e))?s=u:o&&o.length>n?s=o[n]:t[n]<0?s=l.get("negBarColor"):t[n]>0?s=l.get("posBarColor"):s=l.get("zeroBarColor"),s},renderRegion:function(e,n){let t=this.values,l=this.options,o=this.target,a,s,u,f,m,d;if(a=this.canvasHeight,u=Math.round(a/2),f=e*this.totalBarWidth,t[e]<0?(m=u,s=u-1):t[e]>0?(m=0,s=u-1):(m=u-1,s=2),d=this.calcColor(t[e],e),d!==null)return n&&(d=this.calcHighlightColor(d,l)),o.drawRect(f,m,this.barWidth-1,s-1,d,d)}},discrete:{type:"discrete",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.regionShapes={},this.values=n=$.map(n,Number),this.min=Math.min.apply(Math,n),this.max=Math.max.apply(Math,n),this.range=this.max-this.min,this.width=l,this.interval=Math.floor(l/n.length),this.itemWidth=l/n.length,t.get("chartRangeMin")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.min)&&(this.min=t.get("chartRangeMin")),t.get("chartRangeMax")!==void 0&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.max)&&(this.max=t.get("chartRangeMax")),this.target&&(this.lineHeight=t.get("lineHeight")==="auto"?Math.round(this.canvasHeight*.3):t.get("lineHeight"))},getRegion:function(e,n,t){return Math.floor(n/this.itemWidth)},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],offset:e}},renderRegion:function(e,n){let t=this.values,l=this.options,o=this.min,a=this.max,s=this.range,u=this.interval,f=this.target,m=this.canvasHeight,d=this.lineHeight,p=m-d,b,g,v,x;return g=cf(t[e],o,a),x=e*u,b=Math.round(p-p*((g-o)/s)),v=l.get("thresholdColor")&&g<l.get("thresholdValue")?l.get("thresholdColor"):l.get("lineColor"),n&&(v=this.calcHighlightColor(v,l)),this.target.drawRect(x,b,u<=2?1:u-2,d,v,v)}},bullet:{type:"bullet",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a,s,u;this.values=n=Jm(n),u=n.slice(),u[0]=u[0]===null?u[2]:u[0],u[1]=n[1]===null?u[2]:u[1],a=Math.min.apply(Math,n),s=Math.max.apply(Math,n),t.get("base")===void 0?a=a<0?a:0:a=t.get("base"),this.min=a,this.max=s,this.range=s-a,this.shapes={},this.valueShapes={},this.regiondata={},this.width=l,n.length||(this.disabled=!0)},getRegion:function(e,n,t){let l=this.target.getShapeAt(e,n,t);return l!==void 0&&this.shapes[l]!==void 0?this.shapes[l]:void 0},getCurrentRegionFields:function(){let e=this.currentRegion;return{fieldkey:e.substr(0,1),value:this.values[e.substr(1)],region:e}},changeHighlight:function(e){let n=this.currentRegion,t=this.valueShapes[n],l;switch(delete this.shapes[t],n.substr(0,1)){case"r":l=this.renderRange(n.substr(1),e);break;case"p":l=this.renderPerformance(e);break;case"t":l=this.renderTarget(e);break}this.valueShapes[n]=l.id,this.shapes[l.id]=n,this.target.replaceWithShape(t,l)},renderRange:function(e,n){let t=this.values[e],l=Math.round(this.canvasWidth*((t-this.min)/this.range)),o=this.options.get("rangeColors")[e-2];return n&&(o=this.calcHighlightColor(o,this.options)),this.target.drawRect(0,0,l-1,this.canvasHeight-1,o,o)},renderPerformance:function(e){let n=this.values[1],t=Math.round(this.canvasWidth*((n-this.min)/this.range)),l=this.options.get("performanceColor");return e&&(l=this.calcHighlightColor(l,this.options)),this.target.drawRect(0,Math.round(this.canvasHeight*.3),t-1,Math.round(this.canvasHeight*.4)-1,l,l)},renderTarget:function(e){let n=this.values[0],t=Math.round(this.canvasWidth*((n-this.min)/this.range)-this.options.get("targetWidth")/2),l=Math.round(this.canvasHeight*.1),o=this.canvasHeight-l*2,a=this.options.get("targetColor");return e&&(a=this.calcHighlightColor(a,this.options)),this.target.drawRect(t,l,this.options.get("targetWidth")-1,o-1,a,a)},render:function(e,n){this.init(e,n);let t=this.values.length,l=this.target,o,a;for(o=2;o<t;o++)a=this.renderRange(o).append(),this.shapes[a.id]="r"+o,this.valueShapes["r"+o]=a.id;this.values[1]!==null&&(a=this.renderPerformance().append(),this.shapes[a.id]="p1",this.valueShapes.p1=a.id),this.values[0]!==null&&(a=this.renderTarget().append(),this.shapes[a.id]="t0",this.valueShapes.t0=a.id)}},pie:{type:"pie",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;let a=0,s;if(this.shapes={},this.valueShapes={},this.values=n=$.map(n,Number),t.get("width")==="auto"&&(this.width=this.height),n.length>0)for(s=n.length;s--;)a+=n[s];this.total=a,this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(e,n,t){let l=this.target.getShapeAt(e,n,t);return l!==void 0&&this.shapes[l]!==void 0?this.shapes[l]:void 0},getCurrentRegionFields:function(){let e=this.currentRegion;return{isNull:this.values[e]===void 0,value:this.values[e],percent:this.values[e]/this.total*100,color:this.options.get("sliceColors")[e%this.options.get("sliceColors").length],offset:e}},changeHighlight:function(e){let n=this.currentRegion,t=this.renderSlice(n,e),l=this.valueShapes[n];delete this.shapes[l],this.target.replaceWithShape(l,t),this.valueShapes[n]=t.id,this.shapes[t.id]=n},renderSlice:function(e,n){let t=this.target,l=this.options,o=this.radius,a=l.get("borderWidth"),s=l.get("offset"),u=2*Math.PI,f=this.values,m=this.total,d=s?2*Math.PI*(s/360):0,p,b,g,v,x;for(v=f.length,g=0;g<v;g++){if(p=d,b=d,m>0&&(b=d+u*(f[g]/m)),e===g)return x=l.get("sliceColors")[g%l.get("sliceColors").length],n&&(x=this.calcHighlightColor(x,l)),t.drawPieSlice(o,o,o-a,p,b,void 0,x);d=b}},render:function(e,n){this.init(e,n);let t=this.target,l=this.values,o=this.options,a=this.radius,s=o.get("borderWidth"),u,f;for(s&&t.drawCircle(a,a,Math.floor(a-s/2),o.get("borderColor"),void 0,s).append(),f=l.length;f--;)l[f]&&(u=this.renderSlice(f).append(),this.valueShapes[f]=u.id,this.shapes[u.id]=f)}},box:{type:"box",init:function(e,n){let t=this.options,l=e.mergedOptions.width,o=e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.values=$.map(n,Number),this.width=t.get("width")==="auto"?"4.0em":l,this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){let e=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==void 0&&e.push({field:"lo",value:this.loutlier}),this.routlier!==void 0&&e.push({field:"ro",value:this.routlier}),this.lwhisker!==void 0&&e.push({field:"lw",value:this.lwhisker}),this.rwhisker!==void 0&&e.push({field:"rw",value:this.rwhisker}),e},render:function(e,n){this.init(e,n);let t=this.target,l=this.values,o=l.length,a=this.options,s=this.canvasWidth,u=this.canvasHeight,f=a.get("chartRangeMin")===void 0?Math.min.apply(Math,l):a.get("chartRangeMin"),m=a.get("chartRangeMax")===void 0?Math.max.apply(Math,l):a.get("chartRangeMax"),d=0,p,b,g,v,x,_,S,I,P,F,D;if(a.get("raw"))a.get("showOutliers")&&l.length>5?(b=l[0],p=l[1],v=l[2],x=l[3],_=l[4],S=l[5],I=l[6]):(p=l[0],v=l[1],x=l[2],_=l[3],S=l[4]);else if(l.sort(function(k,w){return k-w}),v=Zm(l,1),x=Zm(l,2),_=Zm(l,3),g=_-v,a.get("showOutliers")){for(p=S=void 0,P=0;P<o;P++)p===void 0&&l[P]>v-g*a.get("outlierIQR")&&(p=l[P]),l[P]<_+g*a.get("outlierIQR")&&(S=l[P]);b=l[0],I=l[o-1]}else p=l[0],S=l[o-1];this.quartiles=[v,x,_],this.lwhisker=p,this.rwhisker=S,this.loutlier=b,this.routlier=I,D=s/(m-f+1),a.get("showOutliers")&&(d=Math.ceil(a.get("spotRadius")),s-=2*Math.ceil(a.get("spotRadius")),D=s/(m-f+1),b<p&&t.drawCircle((b-f)*D+d,u/2,a.get("spotRadius"),a.get("outlierLineColor"),a.get("outlierFillColor")).append(),I>S&&t.drawCircle((I-f)*D+d,u/2,a.get("spotRadius"),a.get("outlierLineColor"),a.get("outlierFillColor")).append()),t.drawRect(Math.round((v-f)*D+d),Math.round(u*.1),Math.round((_-v)*D),Math.round(u*.8),a.get("boxLineColor"),a.get("boxFillColor")).append(),t.drawLine(Math.round((p-f)*D+d),Math.round(u/2),Math.round((v-f)*D+d),Math.round(u/2),a.get("lineColor")).append(),t.drawLine(Math.round((p-f)*D+d),Math.round(u/4),Math.round((p-f)*D+d),Math.round(u-u/4),a.get("whiskerColor")).append(),t.drawLine(Math.round((S-f)*D+d),Math.round(u/2),Math.round((_-f)*D+d),Math.round(u/2),a.get("lineColor")).append(),t.drawLine(Math.round((S-f)*D+d),Math.round(u/4),Math.round((S-f)*D+d),Math.round(u-u/4),a.get("whiskerColor")).append(),t.drawLine(Math.round((x-f)*D+d),Math.round(u*.1),Math.round((x-f)*D+d),Math.round(u*.9),a.get("medianColor")).append(),a.get("target")&&(F=Math.ceil(a.get("spotRadius")),t.drawLine(Math.round((a.get("target")-f)*D+d),Math.round(u/2-F),Math.round((a.get("target")-f)*D+d),Math.round(u/2+F),a.get("targetColor")).append(),t.drawLine(Math.round((a.get("target")-f)*D+d-F),Math.round(u/2),Math.round((a.get("target")-f)*D+d+F),Math.round(u/2),a.get("targetColor")).append())}},shapeCount:0,shapes:{},shapeseq:[],lastShapeId:null,mergedOptions:null,init:function(e,n){let t,l,o;n=n||{};let a=this;return l=this.defaultOption,o=l.common,t=l[n.type||o.type],a.shapeCount=0,a.shapes={},a.shapeseq=[],a.lastShapeId=null,a.mergedOptions=$.extend({},o,t,n),a.mergedOptions.width=a.mergedOptions.width,a.mergedOptions.height=a.mergedOptions.height,a[a.mergedOptions.type].render(a,e),{shapes:a.shapes,shapeseq:a.shapeseq,offsetX:a.mergedOptions.offsetX,offsetY:a.mergedOptions.offsetY,pixelWidth:a.mergedOptions.width,pixelHeight:a.mergedOptions.height}},_getContext:function(e,n,t){let l;return this.ctx!=null?l=this.ctx:l=$("#"+this._canvasID).get(0).getContext("2d"),e!==void 0&&(l.strokeStyle=e),l.lineWidth=t===void 0?1:t,n!==void 0&&(l.fillStyle=n),l},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0},_drawShape:function(e,n,t,l,o){let a=this._getContext(t,l,o),s,u;for(a.beginPath(),a.moveTo(n[0][0]+.5+this.offsetX,n[0][1]+.5+this.offsetY),s=1,u=n.length;s<u;s++)a.lineTo(n[s][0]+.5+this.offsetX,n[s][1]+.5+this.offsetY);t!==void 0&&a.stroke(),l!==void 0&&a.fill(),this.targetX!==void 0&&this.targetY!==void 0&&a.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawCircle:function(e,n,t,l,o,a,s){let u=this._getContext(o,a,s);u.beginPath(),n+=this.offsetX,t+=this.offsetY,u.arc(n,t,l,0,2*Math.PI,!1),this.targetX!==void 0&&this.targetY!==void 0&&u.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e),o!==void 0&&u.stroke(),a!==void 0&&u.fill()},_drawPieSlice:function(e,n,t,l,o,a,s,u){let f=this._getContext(s,u);n+=this.offsetX,t+=this.offsetY,f.beginPath(),f.moveTo(n,t),f.arc(n,t,l,o,a,!1),f.lineTo(n,t),f.closePath(),s!==void 0&&f.stroke(),u&&f.fill(),this.targetX!==void 0&&this.targetY!==void 0&&f.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawRect:function(e,n,t,l,o,a,s){return this._drawShape(e,[[n,t],[n+l,t],[n+l,t+o],[n,t+o],[n,t]],a,s)},appendShape:function(e){return this.shapes[e.id]=e,this.shapeseq.push(e.id),this.lastShapeId=e.id,e.id},replaceWithShape:function(e,n){let t=this.shapeseq,l;for(this.shapes[n.id]=n,l=t.length;l--;)t[l]==e&&(t[l]=n.id);delete this.shapes[e]},replaceWithShapes:function(e,n){let t=this.shapeseq,l={},o,a,s;for(a=e.length;a--;)l[e[a]]=!0;for(a=t.length;a--;)o=t[a],l[o]&&(t.splice(a,1),delete this.shapes[o],s=a);for(a=n.length;a--;)t.splice(s,0,n[a].id),this.shapes[n[a].id]=n[a]},insertAfterShape:function(e,n){let t=this.shapeseq,l;for(l=t.length;l--;)if(t[l]===e){t.splice(l+1,0,n.id),this.shapes[n.id]=n;return}},removeShapeId:function(e){let n=this.shapeseq,t;for(t=n.length;t--;)if(n[t]===e){n.splice(t,1);break}delete this.shapes[e]},getShapeAt:function(e,n,t){return this.targetX=n,this.targetY=t,this.render(),this.currentTargetShapeId},_canvasID:"luckysheetTableContent",render:function(e,n,t,l,o,a,s,u){s==null&&(s="luckysheetTableContent"),this._canvasID=s,u!=null&&(this.ctx=u);let f=e.length,m=this._getContext(),d,p,b;for(this.offsetX=t,this.offsetY=l,this.pixelWidth=o,this.pixelHeight=a,b=0;b<f;b++)d=e[b],p=n[d],this["_draw"+p.type].apply(this,p.args)},drawLine:function(e,n,t,l,o,a){return this.drawShape([[e,n],[t,l]],o,a)},drawShape:function(e,n,t,l){return this._genShape("Shape",[e,n,t,l])},drawCircle:function(e,n,t,l,o,a){return this._genShape("Circle",[e,n,t,l,o,a])},drawPieSlice:function(e,n,t,l,o,a,s){return this._genShape("PieSlice",[e,n,t,l,o,a,s])},drawRect:function(e,n,t,l,o,a){return this._genShape("Rect",[e,n,t,l,o,a])},_genShape:function(e,n){let t=this.shapeCount++;n.unshift(t);let l={id:t,type:e,args:n};return this.shapes[t]=l,this.shapeseq.push(t),this.lastShapeId=t,{append:function(){return l},get:function(){return t}}}},r1={changeHighlight:function(e){let n=this.currentRegion,t=this.target,l=this.regionShapes[n],o;l&&(o=this.renderRegion(n,e),$.isArray(o)||$.isArray(l)?(t.replaceWithShapes(l,o),this.regionShapes[n]=$.map(o,function(a){return a.id})):(t.replaceWithShape(l,o),this.regionShapes[n]=o.id))},render:function(e,n){this.init(e,n);let t=this.values,l=this.target,o=this.regionShapes,a,s,u,f;for(u=t.length;u--;)if(a=this.renderRegion(u),a)if($.isArray(a)){for(s=[],f=a.length;f--;)a[f].append(),s.push(a[f].id);o[u]=s}else a.append(),o[u]=a.id;else o[u]=null}},r3={get:function(e){return Oo.mergedOptions[e]}},n3={drawLine:function(e,n,t,l,o,a){return Oo.drawLine(e,n,t,l,o,a)},drawShape:function(e,n,t,l){return Oo.drawShape(e,n,t,l)},drawCircle:function(e,n,t,l,o,a){return Oo.drawCircle(e,n,t,l,o,a)},drawPieSlice:function(e,n,t,l,o,a,s){return Oo.drawPieSlice(e,n,t,l,o,a,s)},drawRect:function(e,n,t,l,o,a){return Oo.drawRect(e,n,t,l,o,a)}};for(let e in Oo)e in{line:null,bar:null,column:null,tristate:null,discrete:null,bullet:null,pie:null,box:null}&&(Oo[e].options=r3,Oo[e].target=n3),e in{bar:null,column:null,tristate:null,discrete:null}&&(Oo[e].changeHighlight=r1.changeHighlight,Oo[e].render=r1.render);Hi=Oo});function uc(e,n,t){e==null&&(e=$("#luckysheet-cell-main").scrollTop()),n==null&&(n=h.luckysheetTableContentHW[1]),t==null&&(t=h.columnHeaderHeight);let l=$("#luckysheetTableContent").get(0).getContext("2d");l.save(),l.scale(h.devicePixelRatio,h.devicePixelRatio),l.clearRect(0,t,h.rowHeaderWidth-1,n),l.font=Gs(),l.textBaseline=Kn.textBaseline,l.fillStyle=Kn.fillStyle;let o,a;o=$l(h.visibledatarow,e),a=$l(h.visibledatarow,e+n),o==-1&&(o=0),a==-1&&(a=h.visibledatarow.length-1),l.save(),l.beginPath(),l.rect(0,t-1,h.rowHeaderWidth-1,n-2),l.clip();let s,u,f=.5,m;for(let d=o;d<=a;d++){d==0?u=-e-1:u=h.visibledatarow[d-1]-e-1,s=h.visibledatarow[d]-e;let p=o==d?-2:0,b=a==d?-2:0;if(!!sl.createHookFunction("rowTitleCellRenderBefore",d+1,{r:d,top:u+t+p,width:h.rowHeaderWidth-1,height:s-u+1+b-p},l)){if(!(h.config.rowhidden!=null&&h.config.rowhidden[d]!=null)){l.fillStyle="#ffffff",l.fillRect(0,u+t+p,h.rowHeaderWidth-1,s-u+1+b-p),l.fillStyle="#000000",l.save(),l.scale(h.zoomRatio,h.zoomRatio);let g=Yo(d+1,l),v=(h.rowHeaderWidth-g.width)/2,x=u+(s-u)/2+t;l.fillText(d+1,v/h.zoomRatio,x/h.zoomRatio),l.restore()}l.beginPath(),l.moveTo(h.rowHeaderWidth-2+f,u+t-2),l.lineTo(h.rowHeaderWidth-2+f,s+t-2),l.lineWidth=1,l.strokeStyle=Kn.strokeStyle,l.stroke(),l.closePath(),h.config.rowhidden!=null&&h.config.rowhidden[d]==null&&h.config.rowhidden[d+1]!=null?(l.beginPath(),l.moveTo(-1,s+t-4+f),l.lineTo(h.rowHeaderWidth-1,s+t-4+f),l.closePath(),l.stroke()):(h.config.rowhidden==null||h.config.rowhidden[d]==null)&&(l.beginPath(),l.moveTo(-1,s+t-2+f),l.lineTo(h.rowHeaderWidth-1,s+t-2+f),l.closePath(),l.stroke()),h.config.rowhidden!=null&&h.config.rowhidden[d-1]!=null&&m!=null&&(l.beginPath(),l.moveTo(-1,m+t+f),l.lineTo(h.rowHeaderWidth-1,m+t+f),l.closePath(),l.stroke()),m=s,sl.createHookFunction("rowTitleCellRenderAfter",d+1,{r:d,top:u+t+p,width:h.rowHeaderWidth-1,height:s-u+1+b-p},l)}}l.restore(),l.restore()}function fc(e,n,t){e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=h.luckysheetTableContentHW[0]),t==null&&(t=h.rowHeaderWidth);let l=$("#luckysheetTableContent").get(0).getContext("2d");l.save(),l.scale(h.devicePixelRatio,h.devicePixelRatio),l.clearRect(t,0,n,h.columnHeaderHeight-1),l.font=Gs(),l.textBaseline=Kn.textBaseline,l.fillStyle=Kn.fillStyle;let o,a;o=$l(h.visibledatacolumn,e),a=$l(h.visibledatacolumn,e+n),o==-1&&(o=0),a==-1&&(a=h.visibledatacolumn.length-1),l.save(),l.beginPath(),l.rect(t-1,0,n,h.columnHeaderHeight-1),l.clip();let s,u,f=.5,m;for(let d=o;d<=a;d++){d==0?u=-e:u=h.visibledatacolumn[d-1]-e,s=h.visibledatacolumn[d]-e;let p=yl(d);if(!!sl.createHookFunction("columnTitleCellRenderBefore",p,{c:d,left:u+t-1,width:s-u,height:h.columnHeaderHeight-1},l)){if(!(h.config.colhidden!=null&&h.config.colhidden[d]!=null)){l.fillStyle="#ffffff",l.fillRect(u+t-1,0,s-u,h.columnHeaderHeight-1),l.fillStyle="#000000",l.save(),l.scale(h.zoomRatio,h.zoomRatio);let b=Yo(p,l),g=Math.round(u+(s-u)/2+t-b.width/2),v=Math.round(h.columnHeaderHeight/2);l.fillText(p,g/h.zoomRatio,v/h.zoomRatio),l.restore()}h.config.colhidden!=null&&h.config.colhidden[d]==null&&h.config.colhidden[d+1]!=null?(l.beginPath(),l.moveTo(s+t-4+f,0),l.lineTo(s+t-4+f,h.columnHeaderHeight-2),l.lineWidth=1,l.strokeStyle=Kn.strokeStyle,l.closePath(),l.stroke()):(h.config.colhidden==null||h.config.colhidden[d]==null)&&(l.beginPath(),l.moveTo(s+t-2+f,0),l.lineTo(s+t-2+f,h.columnHeaderHeight-2),l.lineWidth=1,l.strokeStyle=Kn.strokeStyle,l.closePath(),l.stroke()),h.config.colhidden!=null&&h.config.colhidden[d-1]!=null&&m!=null&&(l.beginPath(),l.moveTo(m+t+f,0),l.lineTo(m+t+f,h.columnHeaderHeight-2),l.closePath(),l.stroke()),l.beginPath(),l.moveTo(u+t-1,h.columnHeaderHeight-2+f),l.lineTo(s+t-1,h.columnHeaderHeight-2+f),l.stroke(),l.closePath(),m=s,sl.createHookFunction("columnTitleCellRenderAfter",p,{c:d,left:u+t-1,width:s-u,height:h.columnHeaderHeight-1},l)}}l.restore(),l.restore()}function Ki(e,n,t,l,o,a,s,u,f){if(h.flowdata==null)return;let m=kt.getSheetByIndex();clearTimeout(h.measureTextCacheTimeOut),e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=$("#luckysheet-cell-main").scrollTop()),t==null&&(t=h.luckysheetTableContentHW[0]),l==null&&(l=h.luckysheetTableContentHW[1]),o==null&&(o=h.rowHeaderWidth),a==null&&(a=h.columnHeaderHeight),s==null&&(s=0),u==null&&(u=0);let d=null;if(f==null)d=$("#luckysheetTableContent").get(0).getContext("2d");else if(G(f)=="object")try{d=f.get(0).getContext("2d")}catch(A){d=f}else d=$("#"+f).get(0).getContext("2d");d.save(),d.scale(h.devicePixelRatio,h.devicePixelRatio),d.clearRect(0,0,h.luckysheetTableContentHW[0],h.luckysheetTableContentHW[1]);let p,b,g,v;p=$l(h.visibledatarow,n),b=$l(h.visibledatarow,n+l),p==-1&&(p=0),p+=u,b==-1&&(b=h.visibledatarow.length-1),b+=u,b>=h.visibledatarow.length&&(b=h.visibledatarow.length-1),g=$l(h.visibledatacolumn,e),v=$l(h.visibledatacolumn,e+t),g==-1&&(g=0),g+=s,v==-1&&(v=h.visibledatacolumn.length-1),v+=s,v>=h.visibledatacolumn.length&&(v=h.visibledatacolumn.length-1);let x,_,S,I;p==0?x=0:x=h.visibledatarow[p-1],_=h.visibledatarow[b],g==0?S=0:S=h.visibledatacolumn[g-1],I=h.visibledatacolumn[v],d.fillStyle="#ffffff",d.fillRect(o-1,a-1,I-e,_-n),d.font=Gs(),d.fillStyle=Kn.fillStyle;let P=[],F={},D={},k=.5;sl.createHookFunction("cellAllRenderBefore",h.flowdata,m,d);for(let A=p;A<=b;A++){let E;A==0?E=-n-1:E=h.visibledatarow[A-1]-n-1;let L=h.visibledatarow[A]-n;if(!(h.config.rowhidden!=null&&h.config.rowhidden[A]!=null))for(let N=g;N<=v;N++){let W;N==0?W=-e:W=h.visibledatacolumn[N-1]-e;let X=h.visibledatacolumn[N]-e;if(h.config.colhidden!=null&&h.config.colhidden[N]!=null)continue;let te=h.defaultcollen;if(h.config.columnlen!=null&&h.config.columnlen[N]!=null&&(te=h.config.columnlen[N]),h.flowdata[A]!=null&&h.flowdata[A][N]!=null){let ue=h.flowdata[A][N];if(G(ue)=="object"&&"mc"in ue)if(D[A+"_"+N]={start_r:E,start_c:W,end_r:L,end_c:X},"rs"in ue.mc){let pe="r"+A+"c"+N;F[pe]=P.length}else{let pe="r"+ue.mc.r+"c"+ue.mc.c,ne=P[F[pe]];ne==null?(F[pe]=P.length,P.push({r:A,c:N,start_c:W,start_r:E,end_r:L,end_c:X,firstcolumnlen:te})):(ne.c==N&&(ne.end_r+=L-E-1),ne.r==A&&(ne.end_c+=X-W,ne.firstcolumnlen+=te));continue}}P.push({r:A,c:N,start_r:E,start_c:W,end_r:L,end_c:X,firstcolumnlen:te}),D[A+"_"+N]={start_r:E,start_c:W,end_r:L,end_c:X}}}let w=Ju(h.luckysheetfile[Me(h.currentSheetIndex)].dynamicArray),C=Ur.getComputeMap(),T=Mt.getComputeMap(),O=i3(d,g,v,p,b),z=[];for(let A=0;A<P.length;A++){let E=P[A],L=E.r,N=E.c,W=E.start_r,X=E.start_c,te=E.end_r,ue=E.end_c,pe=E.firstcolumnlen;if(h.flowdata[L]!=null)if(h.flowdata[L][N]==null)eg(L,N,W,X,te,ue,d,C,T,o,a,w,O,g,v,n,e,k);else{let ne=h.flowdata[L][N],me=null;if(typeof ne=="object"&&"mc"in ne?z.push(P[A]):me=Fm(L,N),me==null||me.toString().length==0){eg(L,N,W,X,te,ue,d,C,T,o,a,w,O,g,v,n,e,k);let Q=_t.borderfix(h.flowdata,L,N),we=[X+o+Q[0],W+a+Q[1],ue-X-3+Q[2],te-W-3-1+Q[3]];n1(L,N,we[0],we[1],"luckysheetTableContent",d)}else L+"_"+N in w&&(me=w[L+"_"+N].v),i1(L,N,W,X,te,ue,me,d,C,T,o,a,w,O,g,v,n,e,k)}}for(let A=0;A<z.length;A++){let E=z[A],L=E.r,N=E.c,W=E.start_r,X=E.start_c,te=E.end_r-1,ue=E.end_c-1,pe=E.firstcolumnlen,ne=h.flowdata[L][N],me=null,Q=ne.mc;me=Fm(Q.r,Q.c),L=Q.r,N=Q.c;let we=h.flowdata[L][N];if(N==0?X=-e:X=h.visibledatacolumn[N-1]-e,L==0?W=-n-1:W=h.visibledatarow[L-1]-n-1,te=h.visibledatarow[L+we.mc.rs-1]-n,ue=h.visibledatacolumn[N+we.mc.cs-1]-e,me==null||me.toString().length==0){eg(L,N,W,X,te,ue,d,C,T,o,a,w,O,g,v,n,e,k,!0);let ie=_t.borderfix(h.flowdata,L,N),ge=[X+o+ie[0],W+a+ie[1],ue-X-3+ie[2],te-W-3-1+ie[3]];n1(L,N,ge[0],ge[1],"luckysheetTableContent",d)}else L+"_"+N in w&&(me=w[L+"_"+N].v),i1(L,N,W,X,te,ue,me,d,C,T,o,a,w,O,g,v,n,e,k,!0)}for(let A=p;A<=b;A++){let E;A==0?E=-n-1:E=h.visibledatarow[A-1]-n-1;let L=h.visibledatarow[A]-n;for(let N=g;N<=v;N++){let W;N==0?W=-e:W=h.visibledatacolumn[N-1]-e;let X=h.visibledatacolumn[N]-e;!!h.luckysheetcurrentisPivotTable&&Yt.drawPivotTable?((N==0||N==5)&&A<=11&&(d.beginPath(),d.moveTo(X-2+k+o,E+a),d.lineTo(X-2+k+o,L-2+k+a),d.lineWidth=1,d.strokeStyle="#000000",d.closePath(),d.stroke()),(A==2||A==11)&&N<=5&&(d.beginPath(),d.moveTo(W-1+o,L-2+k+a),d.lineTo(X-2+k+o,L-2+k+a),d.lineWidth=1,d.strokeStyle="#000000",d.closePath(),d.stroke()),A==6&&N==3&&(d.save(),d.font="bold 30px Arial",d.fillStyle="#626675",d.textAlign="center",d.fillText(Be().pivotTable.title,W+(X-W)/2+4+o,E+(L-E)/2-1+a),d.restore())):h.luckysheetcurrentisPivotTable&&N<Yt.pivotTableBoundary[1]&&A<Yt.pivotTableBoundary[0]&&(d.beginPath(),d.moveTo(X-2+k+o,E+a),d.lineTo(X-2+k+o,L-2+k+a),d.lineWidth=1,d.strokeStyle="#000000",d.closePath(),d.stroke(),d.beginPath(),d.moveTo(W-1+o,L-2+k+a),d.lineTo(X-2+o,L-2+k+a),d.lineWidth=1,d.strokeStyle="#000000",d.closePath(),d.stroke())}}if(h.config.borderInfo!=null&&h.config.borderInfo.length>0){let A=function(X,te,ue,pe,ne,me,Q,we,ie){let ge=X,ce=pe-2+k+Q,fe=ue+we-1,ye=pe-2+k+Q,Ne=ne-2+k+we;ie.save(),_t.setLineDash(ie,ge,"v",ce,fe,ye,Ne),ie.strokeStyle=te,ie.stroke(),ie.closePath(),ie.restore()},E=function(X,te,ue,pe,ne,me,Q,we,ie){let ge=X,ce=me-2+k+Q,fe=ue+we-1,ye=me-2+k+Q,Ne=ne-2+k+we;ie.save(),_t.setLineDash(ie,ge,"v",ce,fe,ye,Ne),ie.strokeStyle=te,ie.stroke(),ie.closePath(),ie.restore()},L=function(X,te,ue,pe,ne,me,Q,we,ie){let ge=X,ce=pe-2+k+Q,fe=ne-2+k+we,ye=me-2+k+Q,Ne=ne-2+k+we;ie.save(),_t.setLineDash(ie,ge,"h",ce,fe,ye,Ne),ie.strokeStyle=te,ie.stroke(),ie.closePath(),ie.restore()},N=function(X,te,ue,pe,ne,me,Q,we,ie){let ge=X,ce=pe-2+k+Q,fe=ue-1+k+we,ye=me-2+k+Q,Ne=ue-1+k+we;ie.save(),_t.setLineDash(ie,ge,"h",ce,fe,ye,Ne),ie.strokeStyle=te,ie.stroke(),ie.closePath(),ie.restore()},W=Em(p,b,g,v);for(let X in W){let te=X.substr(0,X.indexOf("_")),ue=X.substr(X.indexOf("_")+1);if(D[te+"_"+ue]){let pe=D[te+"_"+ue].start_r,ne=D[te+"_"+ue].start_c,me=D[te+"_"+ue].end_r,Q=D[te+"_"+ue].end_c,we=tg(O,te,ue,g,v),ie=W[X].l;ie!=null&&(!we.colIn||we.stc==ue)&&A(ie.style,ie.color,pe,ne,me,Q,o,a,d);let ge=W[X].r;ge!=null&&(!we.colIn||we.colLast)&&E(ge.style,ge.color,pe,ne,me,Q,o,a,d);let ce=W[X].t;ce!=null&&N(ce.style,ce.color,pe,ne,me,Q,o,a,d);let fe=W[X].b;fe!=null&&L(fe.style,fe.color,pe,ne,me,Q,o,a,d)}}}v==h.visibledatacolumn.length-1&&d.clearRect(I-e+o-1,a-1,h.ch_width-h.visibledatacolumn[v],_-n),d.restore(),h.measureTextCacheTimeOut=setTimeout(()=>{h.measureTextCache={},h.measureTextCellInfoCache={},h.cellOverflowMapCache={}},100)}function i3(e,n,t,l,o){let a={},s=h.flowdata;for(let u=l;u<=o;u++){if(s[u]==null)continue;if(h.cellOverflowMapCache[u]!=null){a[u]=h.cellOverflowMapCache[u];continue}let f=!1;for(let m=0;m<s[u].length;m++){let d=s[u][m];if(!(h.config.colhidden!=null&&h.config.colhidden[m]!=null)&&d!=null&&(!ft(d.v)||Wn(d))&&d.mc==null&&d.tb=="1"){let p=_t.checkstatus(s,u,m,"ht"),b=Mo(d,e,{r:u,c:m}),g=0;b!=null&&(g=b.textWidthAll);let v=m-1<0?0:h.visibledatacolumn[m-1],x=h.visibledatacolumn[m],_,S;if(x-v<g){if(p=="0"){let I=ru(u,m,m-1,"forward",p,g),P=ru(u,m,m+1,"backward",p,g);I.success?_=I.c:_=I.c+1,P.success?S=P.c:S=P.c-1}else if(p=="1"){let I=ru(u,m,m+1,"backward",p,g);_=m,I.success?S=I.c:S=I.c-1}else if(p=="2"){let I=ru(u,m,m-1,"forward",p,g);S=m,I.success?_=I.c:_=I.c+1}}else _=m,S=m;if((_<=t||S>=n)&&_<S){let I={r:u,stc:_,edc:S};a[u]==null&&(a[u]={}),a[u][m]=I,f=!0}}}f&&(h.cellOverflowMapCache[u]=a[u])}return a}function ru(e,n,t,l,o,a){let s=h.flowdata;if(l=="forward"&&t<0)return{success:!1,r:e,c:t};if(l=="backward"&&t>s[e].length-1)return{success:!1,r:e,c:t};let u=s[e][t];if(u!=null&&(!ft(u.v)||u.mc!=null))return{success:!1,r:e,c:t};let f=n-1<0?0:h.visibledatacolumn[n-1],m=h.visibledatacolumn[n],d=a-(m-f);o=="0"?(f-=d/2,m+=d/2):o=="1"?m+=d:o=="2"&&(f-=d);let p=t-1<0?0:h.visibledatacolumn[t-1],b=h.visibledatacolumn[t];if(l=="forward")return f<p?ru(e,n,t-1,l,o,a):f<b?{success:!0,r:e,c:t}:{success:!1,r:e,c:t};if(l=="backward")return m>b?ru(e,n,t+1,l,o,a):m>p?{success:!0,r:e,c:t}:{success:!1,r:e,c:t}}function tg(e,n,t,l,o){let a=!1,s=!1,u,f,m,d;for(let p in e){for(let b in e[p]){u=p,f=b;let g=e[p][b];if(m=g.stc,d=g.edc,u==n&&t>=m&&t<=d&&(a=!0,t==d||t==o)){s=!0;break}}if(s)break}return{colIn:a,colLast:s,rowIndex:u,colIndex:f,stc:m,edc:d}}function s1(e,n,t){if(e==null)return;let l=e.values,o=t.pos_x,a=t.pos_y;if(l!=null){e.rotate!=0&&e.type!="verticalWrap"&&(n.save(),n.translate((o+e.textLeftAll)/h.zoomRatio,(a+e.textTopAll)/h.zoomRatio),n.rotate(-e.rotate*Math.PI/180),n.translate(-(e.textLeftAll+o)/h.zoomRatio,-(a+e.textTopAll)/h.zoomRatio));for(let s=0;s<l.length;s++){let u=l[s];u.inline===!0&&u.style!=null?(n.font=u.style.fontset,n.fillStyle=u.style.fc):n.font=u.style;let f=typeof u.content=="object"?u.content.m:u.content;if(n.fillText(f,(o+u.left)/h.zoomRatio,(a+u.top)/h.zoomRatio),u.cancelLine!=null){let m=u.cancelLine;n.beginPath(),n.moveTo(Math.floor((o+m.startX)/h.zoomRatio)+.5,Math.floor((a+m.startY)/h.zoomRatio)+.5),n.lineTo(Math.floor((o+m.endX)/h.zoomRatio)+.5,Math.floor((a+m.endY)/h.zoomRatio)+.5),n.lineWidth=Math.floor(m.fs/9),n.strokeStyle=n.fillStyle,n.stroke(),n.closePath()}if(u.underLine!=null){let m=u.underLine;for(let d=0;d<m.length;d++){let p=m[d];n.beginPath(),n.moveTo(Math.floor((o+p.startX)/h.zoomRatio)+.5,Math.floor((a+p.startY)/h.zoomRatio)),n.lineTo(Math.floor((o+p.endX)/h.zoomRatio)+.5,Math.floor((a+p.endY)/h.zoomRatio)+.5),n.lineWidth=Math.floor(p.fs/9),n.strokeStyle=n.fillStyle,n.stroke(),n.closePath()}}}e.rotate!=0&&e.type!="verticalWrap"&&n.restore()}}var import_plugin,n1,eg,i1,o1,Sh=Nt(()=>{import_plugin=qe(Ye());_a();mo();Jc();Qm();ln();go();Rr();Go();gh();Oc();cr();fo();Er();tu();fr();Ol();Ya();wi();il();Xl();kn();n1=function(e,n,t,l,o,a){if(h.flowdata[e]==null||h.flowdata[e][n]==null)return;let s=h.flowdata[e][n].spl;if(s!=null){if(typeof s=="string"&&(s=new Function("return "+s)()),G(s)=="object"){let u=s,f=u.offsetX,m=u.offsetY;f=f??0,m=m??0,Hi.render(u.shapeseq,u.shapes,t+f,l+m,u.pixelWidth,u.pixelHeight,o,a)}else if(G(s)=="array"&&G(s[0])=="object")for(let u=0;u<s.length;u++){let f=s[u],m=f.offsetX,d=f.offsetY;m=m??0,d=d??0,Hi.render(f.shapeseq,f.shapes,t+m,l+d,f.pixelWidth,f.pixelHeight,o,a)}}},eg=function(e,n,t,l,o,a,s,u,f,m,d,p,b,g,v,x,_,S,I){let P=Ur.checksAF(e,n,u),F=Mt.checksCF(e,n,f),D=_t.borderfix(h.flowdata,e,n),k=_t.checkstatus(h.flowdata,e,n,"bg");P!=null&&P[1]!=null&&(k=P[1]),F!=null&&F.cellColor!=null&&(k=F.cellColor),h.flowdata[e][n]!=null&&h.flowdata[e][n].tc!=null&&(k=h.flowdata[e][n].tc),k==null?s.fillStyle="#FFFFFF":s.fillStyle=k;let w=[l+m+D[0]+1,t+d+D[1]+1,a-l+D[2]-(I?1:0)-1,o-t+D[3]-1];if(!sl.createHookFunction("cellRenderBefore",h.flowdata[e][n],{r:e,c:n,start_r:w[1],start_c:w[0],end_r:w[3]+w[1],end_c:w[2]+w[0]},kt.getSheetByIndex(),s))return;if(s.fillRect(w[0],w[1],w[2],w[3]),e+"_"+n in p){let T=p[e+"_"+n].v;s.fillStyle="#000000";let O=Gs();s.font=O;let z=l+4+m,A=co.luckysheetrefreshfixed(),E=o+d-2;s.textBaseline="bottom",s.fillText(T??"",z,E)}if(h.flowdata[e][n]!=null&&h.flowdata[e][n].ps!=null){let T=8*h.zoomRatio,O=8*h.zoomRatio;s.beginPath(),s.moveTo(a+m-1-T,t+d),s.lineTo(a+m-1,t+d),s.lineTo(a+m-1,t+d+O),s.fillStyle="#FC6666",s.fill(),s.closePath()}let C=tg(b,e,n,g,v);C.colLast&&o1(C.rowIndex,C.colIndex,C.stc,C.edc,s,x,_,m,d,u,f),(!C.colIn||C.colLast)&&!h.luckysheetcurrentisPivotTable&&h.showGridLines&&(s.beginPath(),s.moveTo(a+m-2+S,t+d),s.lineTo(a+m-2+S,o+d),s.lineWidth=1,s.strokeStyle=Kn.strokeStyle,s.stroke(),s.closePath()),!h.luckysheetcurrentisPivotTable&&h.showGridLines&&(s.beginPath(),s.moveTo(l+m-1,o+d-2+S),s.lineTo(a+m-1,o+d-2+S),s.lineWidth=1,s.strokeStyle=Kn.strokeStyle,s.stroke(),s.closePath()),sl.createHookFunction("cellRenderAfter",h.flowdata[e][n],{r:e,c:n,start_r:w[1],start_c:w[0],end_r:w[3]+w[1],end_c:w[2]+w[0]},kt.getSheetByIndex(),s)},i1=function(e,n,t,l,o,a,s,u,f,m,d,p,b,g,v,x,_,S,I,P){let F=h.flowdata[e][n],D=a-l-2,k=o-t-2,w=2,C=2,T=_t.checkstatus(h.flowdata,e,n,"ht"),O=_t.checkstatus(h.flowdata,e,n,"vt"),z=Ur.checksAF(e,n,f),A=Mt.checksCF(e,n,m),E=_t.checkstatus(h.flowdata,e,n,"bg");z!=null&&z[1]!=null&&(E=z[1]),A!=null&&A.cellColor!=null&&(E=A.cellColor),E==null?u.fillStyle="#FFFFFF":u.fillStyle=E;let L=_t.borderfix(h.flowdata,e,n),N=[l+d+L[0]+1,t+p+L[1]+1,a-l+L[2]-(P?1:0)-1,o-t+L[3]+1];if(!sl.createHookFunction("cellRenderBefore",h.flowdata[e][n],{r:e,c:n,start_r:N[1],start_c:N[0],end_r:N[3]+N[1],end_c:N[2]+N[0]},kt.getSheetByIndex(),u))return;u.fillRect(N[0],N[1],N[2],N[3]);let W=ll.dataVerification;if(W!=null&&W[e+"_"+n]!=null&&!ll.validateCellData(s,W[e+"_"+n])){let ue=5*h.zoomRatio,pe=5*h.zoomRatio;u.beginPath(),u.moveTo(l+d,t+p),u.lineTo(l+d+ue,t+p),u.lineTo(l+d,t+p+pe),u.fillStyle="#FC6666",u.fill(),u.closePath()}if(F.ps!=null){let ue=8*h.zoomRatio,pe=8*h.zoomRatio;u.beginPath(),u.moveTo(a+d-ue,t+p),u.lineTo(a+d,t+p),u.lineTo(a+d,t+p+pe),u.fillStyle="#FC6666",u.fill(),u.closePath()}if(F.qp==1&&K(F.v)){let ue=6*h.zoomRatio,pe=6*h.zoomRatio;u.beginPath(),u.moveTo(l+d+ue-1,t+p),u.lineTo(l+d-1,t+p),u.lineTo(l+d-1,t+p+pe),u.fillStyle="#487f1e",u.fill(),u.closePath()}let X=!0,te=tg(g,e,n,v,x);if(F.tb=="1"&&te.colIn)te.colLast?o1(te.rowIndex,te.colIndex,te.stc,te.edc,u,_,S,d,p,f,m):X=!1;else if(W!=null&&W[e+"_"+n]!=null&&W[e+"_"+n].type=="checkbox"){let ue=l+d,pe=t+p+1;u.save(),u.beginPath(),u.rect(ue,pe,D,k),u.clip(),u.scale(h.zoomRatio,h.zoomRatio);let ne=Yo(s,u),me=ne.width+14,Q=ne.actualBoundingBoxDescent+ne.actualBoundingBoxAscent,we=ue+w;T=="0"?we=ue+D/2-me/2:T=="2"&&(we=ue+D-w-me);let ie=k>Q?k:Q,ge=pe+ie-C;u.textBaseline="bottom";let ce=ge-13*h.zoomRatio;O=="0"?(ge=pe+ie/2,u.textBaseline="middle",ce=ge-6*h.zoomRatio):O=="1"&&(ge=pe+C,u.textBaseline="top",ce=ge+1*h.zoomRatio),we=we/h.zoomRatio,ge=ge/h.zoomRatio,ce=ce/h.zoomRatio,u.lineWidth=1,u.strokeStyle="#000",u.strokeRect(we,ce,10,10),W[e+"_"+n].checked&&(u.beginPath(),u.lineTo(we+1,ce+6),u.lineTo(we+4,ce+9),u.lineTo(we+9,ce+2),u.stroke(),u.closePath()),u.fillStyle=_t.checkstatus(h.flowdata,e,n,"fc"),u.fillText(s??"",we+14,ge),u.restore()}else{if(A!=null&&A.dataBar!=null&&A.dataBar.valueLen&&A.dataBar.valueLen.toString()!=="NaN"){let me=l+d+w,Q=t+p+C,we=D-w*2,ie=k-C*2,ge=A.dataBar.valueType,ce=A.dataBar.valueLen,fe=A.dataBar.format;if(ge=="minus"){let ye=A.dataBar.minusLen;if(fe.length>1){let Ne=u.createLinearGradient(me+we*ye*(1-ce),Q,me+we*ye,Q);Ne.addColorStop(0,"#ffffff"),Ne.addColorStop(1,"#ff0000"),u.fillStyle=Ne}else u.fillStyle="#ff0000";u.fillRect(me+we*ye*(1-ce),Q,we*ye*ce,ie),u.beginPath(),u.moveTo(me+we*ye*(1-ce),Q),u.lineTo(me+we*ye*(1-ce),Q+ie),u.lineTo(me+we*ye,Q+ie),u.lineTo(me+we*ye,Q),u.lineTo(me+we*ye*(1-ce),Q),u.lineWidth=1,u.strokeStyle="#ff0000",u.stroke(),u.closePath()}else if(ge=="plus"){let ye=A.dataBar.plusLen;if(ye==1){if(fe.length>1){let Ne=u.createLinearGradient(me,Q,me+we*ce,Q);Ne.addColorStop(0,fe[0]),Ne.addColorStop(1,fe[1]),u.fillStyle=Ne}else u.fillStyle=fe[0];u.fillRect(me,Q,we*ce,ie),u.beginPath(),u.moveTo(me,Q),u.lineTo(me,Q+ie),u.lineTo(me+we*ce,Q+ie),u.lineTo(me+we*ce,Q),u.lineTo(me,Q),u.lineWidth=1,u.strokeStyle=fe[0],u.stroke(),u.closePath()}else{let Ne=A.dataBar.minusLen;if(fe.length>1){let xe=u.createLinearGradient(me+we*Ne,Q,me+we*Ne+we*ye*ce,Q);xe.addColorStop(0,fe[0]),xe.addColorStop(1,fe[1]),u.fillStyle=xe}else u.fillStyle=fe[0];u.fillRect(me+we*Ne,Q,we*ye*ce,ie),u.beginPath(),u.moveTo(me+we*Ne,Q),u.lineTo(me+we*Ne,Q+ie),u.lineTo(me+we*Ne+we*ye*ce,Q+ie),u.lineTo(me+we*Ne+we*ye*ce,Q),u.lineTo(me+we*Ne,Q),u.lineWidth=1,u.strokeStyle=fe[0],u.stroke(),u.closePath()}}}let ue=l+d,pe=t+p+1;u.save(),u.beginPath(),u.rect(ue,pe,D,k),u.clip(),u.scale(h.zoomRatio,h.zoomRatio);let ne=Mo(F,u,{cellWidth:D,cellHeight:k,space_width:w,space_height:C,r:e,c:n});if(A!=null&&A.icons!=null&&ne.type=="plain"){let me=A.icons.left,Q=A.icons.top,we=ne.values[0],ie=ue+we.left,ge=pe+we.top-ne.textHeightAll;O=="0"?ge=pe+k/2-ne.textHeightAll/2:O=="1"?ge=pe:O=="2"&&(ge=ge-ne.desc),ge=ge/h.zoomRatio,ie=ie/h.zoomRatio,u.drawImage(zc,me*42,Q*32,32,32,ue/h.zoomRatio,ge,ne.textHeightAll/h.zoomRatio,ne.textHeightAll/h.zoomRatio),T!="0"&&T!="2"&&(ie=ie+ne.textHeightAll/h.zoomRatio)}u.fillStyle=_t.checkstatus(h.flowdata,e,n,"fc"),z!=null&&z[0]!=null&&(u.fillStyle=z[0]),A!=null&&A.textColor!=null&&(u.fillStyle=A.textColor),F.ct&&F.ct.fa&&F.ct.fa.indexOf("[Red]")>-1&&F.ct.t=="n"&&F.v<0&&(u.fillStyle="#ff0000"),s1(ne,u,{pos_x:ue,pos_y:pe}),u.restore()}X&&!h.luckysheetcurrentisPivotTable&&h.showGridLines&&(u.beginPath(),u.moveTo(a+d-2+I,t+p),u.lineTo(a+d-2+I,o+p),u.lineWidth=1,u.strokeStyle=Kn.strokeStyle,u.stroke(),u.closePath()),!h.luckysheetcurrentisPivotTable&&h.showGridLines&&(u.beginPath(),u.moveTo(l+d-1,o+p-2+I),u.lineTo(a+d-1,o+p-2+I),u.lineWidth=1,u.strokeStyle=Kn.strokeStyle,u.stroke(),u.closePath()),sl.createHookFunction("cellRenderAfter",h.flowdata[e][n],{r:e,c:n,start_r:N[1],start_c:N[0],end_r:N[3]+N[1],end_c:N[2]+N[0]},kt.getSheetByIndex(),u)},o1=function(e,n,t,l,o,a,s,u,f,m,d){let p;e==0?p=-a-1:p=h.visibledatarow[e-1]-a-1;let b=h.visibledatarow[e]-a,g;t==0?g=-s:g=h.visibledatacolumn[t-1]-s;let v=h.visibledatacolumn[l]-s,x=h.flowdata[e][n],_=v-g-2,S=b-p-2,I=2,P=2,F=g+u,D=p+f+1,k=rc(x);o.font=k,o.save(),o.beginPath(),o.rect(F,D,_,S),o.clip(),o.scale(h.zoomRatio,h.zoomRatio);let w=Mo(x,o,{cellWidth:_,cellHeight:S,space_width:I,space_height:P,r:e,c:n}),C=Ur.checksAF(e,n,m),T=Mt.checksCF(e,n,d);o.fillStyle=_t.checkstatus(h.flowdata,e,n,"fc"),C!=null&&C[0]!=null&&(o.fillStyle=C[0]),T!=null&&T.textColor!=null&&(o.fillStyle=T.textColor),s1(w,o,{pos_x:F,pos_y:D}),o.restore()}});var import_plugin,o3,ei,nu=Nt(()=>{import_plugin=qe(Ye());Ol();Er();Ar();Ri();Sr();Kr();Wr();Rr();jr();qr();kn();Di();ln();fr();Xl();il();o3={item:{linkType:"external",linkAddress:"",linkTooltip:""},hyperlink:null,createDialog:function(){let e=this,n=Be(),t=n.insertLink,l=n.toolbar,o=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-insertLink-dialog").remove();let a="";h.luckysheetfile.forEach(v=>{a+=`<option value="${v.name}">${v.name}</option>`});let s=`<div class="box">
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkText">${t.linkText}\uFF1A</label>
                                <input type="text" id="luckysheet-insertLink-dialog-linkText"/>
                            </div>
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkType">${t.linkType}\uFF1A</label>
                                <select id="luckysheet-insertLink-dialog-linkType">
                                    <option value="external">${t.external}</option>
                                    <option value="internal">${t.internal}</option>
                                </select>
                            </div>
                            <div class="show-box show-box-external">
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkAddress">${t.linkAddress}\uFF1A</label>
                                    <input type="text" id="luckysheet-insertLink-dialog-linkAddress" placeholder="${t.placeholder1}" />
                                </div>
                            </div>
                            <div class="show-box show-box-internal">
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkSheet">${t.linkSheet}\uFF1A</label>
                                    <select id="luckysheet-insertLink-dialog-linkSheet">
                                        ${a}
                                    </select>
                                </div>
                                <div class="box-item">
                                    <label for="luckysheet-insertLink-dialog-linkCell">${t.linkCell}\uFF1A</label>
                                    <input type="text" id="luckysheet-insertLink-dialog-linkCell" value="A1" placeholder="${t.placeholder2}" />
                                </div>
                            </div>
                            <div class="box-item">
                                <label for="luckysheet-insertLink-dialog-linkTooltip">${t.linkTooltip}\uFF1A</label>
                                <input type="text" id="luckysheet-insertLink-dialog-linkTooltip" placeholder="${t.placeholder3}" />
                            </div>
                        </div>`;$("body").first().append(Tt(Ll,{id:"luckysheet-insertLink-dialog",addclass:"luckysheet-insertLink-dialog",title:l.insertLink,content:s,botton:`<button id="luckysheet-insertLink-dialog-confirm" class="btn btn-primary">${o.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${o.cancel}</button>`,style:"z-index:100003"}));let u=$("#luckysheet-insertLink-dialog").find(".luckysheet-modal-dialog-content").css("min-width",350).end(),f=u.outerHeight(),m=u.outerWidth(),d=$(window).width(),p=$(window).height(),b=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-insertLink-dialog").css({left:(d+b-m)/2,top:(p+g-f)/3}).show(),e.dataAllocation()},init:function(){let e=this,t=Be().insertLink;$(document).off("change.linkType").on("change.linkType","#luckysheet-insertLink-dialog-linkType",function(l){let o=this.value;$("#luckysheet-insertLink-dialog .show-box").hide(),$("#luckysheet-insertLink-dialog .show-box-"+o).show()}),$(document).off("click.confirm").on("click.confirm","#luckysheet-insertLink-dialog-confirm",function(l){let o=h.luckysheet_select_save[h.luckysheet_select_save.length-1],a=o.row_focus||o.row[0],s=o.column_focus||o.column[0],u=$("#luckysheet-insertLink-dialog-linkText").val(),f=$("#luckysheet-insertLink-dialog-linkType").val(),m=$("#luckysheet-insertLink-dialog-linkAddress").val(),d=$("#luckysheet-insertLink-dialog-linkSheet").val(),p=$("#luckysheet-insertLink-dialog-linkCell").val(),b=$("#luckysheet-insertLink-dialog-linkTooltip").val();if(f=="external"){if(/^http[s]?:\/\//.test(m)||(m="https://"+m),!/^http[s]?:\/\/([\w\-\.]+)+[\w-]*([\w\-\.\/\?%&=]+)?$/ig.test(m)){ke.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo1);return}}else{if(!y.iscelldata(p)){ke.info('<i class="fa fa-exclamation-triangle"></i>',t.tooltipInfo2);return}m=d+"!"+p}(u==null||u.replace(/\s/g,"")=="")&&(u=m);let g={linkType:f,linkAddress:m,linkTooltip:b},v=$.extend(!0,{},e.hyperlink),x=$.extend(!0,{},e.hyperlink);x[a+"_"+s]=g;let _=It.deepCopyFlowData(h.flowdata),S=_[a][s];S==null&&(S={}),S.fc="rgb(0, 0, 255)",S.un=1,S.v=S.m=u,_[a][s]=S,e.ref(v,x,h.currentSheetIndex,_,[{row:[a,a],column:[s,s]}]),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-insertLink-dialog").hide()})},dataAllocation:function(){let e=this,n=h.luckysheet_select_save[h.luckysheet_select_save.length-1],t=n.row_focus||n.row[0],l=n.column_focus||n.column[0],a=(e.hyperlink||{})[t+"_"+l]||{},s=Vt(t,l,null,"m");$("#luckysheet-insertLink-dialog-linkText").val(s);let u=a.linkType||"external";$("#luckysheet-insertLink-dialog-linkType").val(u),$("#luckysheet-insertLink-dialog .show-box").hide(),$("#luckysheet-insertLink-dialog .show-box-"+u).show();let f=a.linkAddress||"";if(u=="external")$("#luckysheet-insertLink-dialog-linkAddress").val(f);else if(y.iscelldata(f)){let d=f.split("!")[0],p=f.split("!")[1];$("#luckysheet-insertLink-dialog-linkSheet").val(d),$("#luckysheet-insertLink-dialog-linkCell").val(p)}let m=a.linkTooltip||"";$("#luckysheet-insertLink-dialog-linkTooltip").val(m)},cellFocus:function(e,n){let t=this;if(t.hyperlink==null||t.hyperlink[e+"_"+n]==null)return;let l=t.hyperlink[e+"_"+n];if(l.linkType=="external")window.open(l.linkAddress);else{let o=y.getcellrange(l.linkAddress),a=o.sheetIndex,s=[{row:o.row,column:o.column}];a!=h.currentSheetIndex&&($("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),kt.changeSheet(a)),h.luckysheet_select_save=s,gl(!0);let u=o.row[0]-1==-1?0:h.visibledatarow[o.row[0]-1],f=o.column[0]-1==-1?0:h.visibledatacolumn[o.column[0]-1];$("#luckysheet-scrollbar-x").scrollLeft(f),$("#luckysheet-scrollbar-y").scrollTop(u)}},overshow:function(e){let n=this;if($("#luckysheet-hyperlink-overshow").remove(),$(e.target).closest("#luckysheet-cell-main").length==0)return;let t=wl(e.pageX,e.pageY),l=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").scrollTop(),a=t[0]+l,s=t[1]+o;if(Ie.freezenverticaldata!=null&&t[0]<Ie.freezenverticaldata[0]-Ie.freezenverticaldata[2]||Ie.freezenhorizontaldata!=null&&t[1]<Ie.freezenhorizontaldata[0]-Ie.freezenhorizontaldata[2])return;let u=Jl(s)[2],f=Zl(a)[2],m=_t.mergeborer(h.flowdata,u,f);if(m&&(u=m.row[2],f=m.column[2]),n.hyperlink==null||n.hyperlink[u+"_"+f]==null)return;let d=n.hyperlink[u+"_"+f],p=d.linkTooltip;(p==null||p.replace(/\s/g,"")=="")&&(p=d.linkAddress);let b=h.visibledatarow[u],g=u-1==-1?0:h.visibledatarow[u-1],v=h.visibledatacolumn[f],x=f-1==-1?0:h.visibledatacolumn[f-1];m&&(b=m.row[1],g=m.row[0],v=m.column[1],x=m.column[0]);let _=`<div id="luckysheet-hyperlink-overshow" style="background:#fff;padding:5px 10px;border:1px solid #000;box-shadow:2px 2px #999;position:absolute;left:${x}px;top:${b+5}px;z-index:100;">
                        <div>${p}</div>
                        <div>\u5355\u51FB\u9F20\u6807\u53EF\u4EE5\u8FFD\u8E2A</div>
                    </div>`;$(_).appendTo($("#luckysheet-cell-main"))},ref:function(e,n,t,l,o){let a=this;if(h.clearjfundo){h.jfundo.length=0;let s={};s.type="updateHyperlink",s.sheetIndex=t,s.historyHyperlink=e,s.currentHyperlink=n,s.data=h.flowdata,s.curData=l,s.range=o,h.jfredo.push(s)}a.hyperlink=n,h.luckysheetfile[Me(t)].hyperlink=n,h.flowdata=l,It.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[Me(t)].data=h.flowdata,Ue.allowUpdate&&(Ue.saveParam("all",t,n,{k:"hyperlink"}),Ue.historyParam(h.flowdata,t,o[0])),setTimeout(function(){Xt()},1)}},ei=o3});function lg(e,n,t){y.execFunctionExist=[];for(let l=0;l<e.length;l++)for(let o=e[l].row[0];o<=e[l].row[1];o++)for(let a=e[l].column[0];a<=e[l].column[1];a++)y.execFunctionExist.push({r:o,c:a,i:n});y.execFunctionExist.reverse(),y.execFunctionGroup(null,null,null,null,t),y.execFunctionGlobalData=null}function al(e,n,t,l=!0,o=!0){e==null&&(e=h.flowdata),n==null&&(n=h.luckysheet_select_save),n=JSON.parse(JSON.stringify(n)),clearTimeout(Po),t==null&&(t={});let a=t.cfg,s=t.RowlChange,u=t.cdformat,f=t.dataVerification,m=t.dynamicArray,d=h.luckysheetfile[Me(h.currentSheetIndex)];if(h.clearjfundo){h.jfundo.length=0;let p;a==null?p=$.extend(!0,{},h.config):p=$.extend(!0,{},a);let b;u==null?b=$.extend(!0,[],d.luckysheet_conditionformat_save):b=u;let g;f==null?g=$.extend(!0,{},d.dataVerification):g=f;let v;m==null?v=$.extend(!0,[],d.dynamicArray):v=m,h.jfredo.push({type:"datachange",data:h.flowdata,curdata:e,sheetIndex:h.currentSheetIndex,config:$.extend(!0,{},h.config),curConfig:p,cdformat:$.extend(!0,[],d.luckysheet_conditionformat_save),curCdformat:b,RowlChange:s,dataVerification:$.extend(!0,[],d.dataVerification),curDataVerification:g,dynamicArray:$.extend(!0,[],d.dynamicArray),curDynamicArray:v,range:n,dataRange:[...d.luckysheet_select_save]})}h.flowdata=e,It.webWorkerFlowDataCache(h.flowdata),d.data=h.flowdata,a!=null&&(h.config=a,d.config=h.config,Ue.saveParam("all",h.currentSheetIndex,a,{k:"config"}),s!=null&&tr(h.flowdata.length,h.flowdata[0].length)),u!=null&&u.length!==0&&(d.luckysheet_conditionformat_save=u,Ue.saveParam("all",h.currentSheetIndex,u,{k:"luckysheet_conditionformat_save"})),f!=null&&Object.keys(f).length!==0&&(ll.dataVerification=f,d.dataVerification=f,Ue.saveParam("all",h.currentSheetIndex,f,{k:"dataVerification"})),m!=null&&(d.dynamicArray=m,Ue.saveParam("all",h.currentSheetIndex,m,{k:"dynamicArray"}));for(let p=0;p<n.length;p++){let b=n[p].row[0],g=n[p].column[0];if(h.flowdata[b][g]!=null&&h.flowdata[b][g].spl!=null){window.luckysheetCurrentRow=b,window.luckysheetCurrentColumn=g,window.luckysheetCurrentFunction=h.flowdata[b][g].f;let v=$.trim(y.functionParserExe(h.flowdata[b][g].f)),x=new Function("return "+v)();h.flowdata[b][g].spl=x}Ue.allowUpdate&&Ue.historyParam(h.flowdata,h.currentSheetIndex,n[p]),typeof h.chartparam.jfrefreshchartall=="function"&&h.chartparam.jfrefreshchartall(h.flowdata,n[p].row[0],n[p].row[1],n[p].column[0],n[p].column[1])}l&&lg(n,h.currentSheetIndex,e),o&&(Po=setTimeout(function(){Xt()},1)),gl(),window.luckysheet_getcelldata_cache=null}function Li(e,n,t,l,o,a,s,u,f=!0){let m={},d=!1;if(clearTimeout(Po),a=="cellRowChange"){m.type="cellRowChange",m.config=$.extend(!0,{},h.config),m.curconfig=$.extend(!0,{},l),m.range=$.extend(!0,[],h.luckysheet_select_save),m.currange=o,m.ctrlType=a,m.ctrlValue=s;let p=l.rowlen;p==null&&(p={}),Ue.saveParam("cg",h.currentSheetIndex,p,{k:"rowlen"})}else if(a=="resizeC"){m.type="resize",m.config=$.extend(!0,{},h.config),m.curconfig=$.extend(!0,{},l),m.range=$.extend(!0,[],h.luckysheet_select_save),m.currange=o,m.ctrlType=a,m.ctrlValue=s;let p=l.columnlen;p==null&&(p={}),Ue.saveParam("cg",h.currentSheetIndex,p,{k:"columnlen"})}else if(a.indexOf("extend")>-1)m.type="extend",m.config=$.extend(!0,{},h.config),m.curconfig=$.extend(!0,{},l),m.range=$.extend(!0,[],h.luckysheet_select_save),m.currange=o,m.ctrlType=a,m.ctrlValue=s,Ue.saveParam("arc",h.currentSheetIndex,{index:s.index,len:s.len,direction:s.direction,mc:l.merge},{rc:s.type});else if(a.indexOf("dele")>-1)m.type="dele",m.config=$.extend(!0,{},h.config),m.curconfig=$.extend(!0,{},l),m.range=$.extend(!0,[],h.luckysheet_select_save),m.currange=o,m.ctrlType=a,m.ctrlValue=s,Ue.saveParam("drc",h.currentSheetIndex,{index:s.index,len:s.len,mc:l.merge,borderInfo:l.borderInfo},{rc:s.type});else{m.type="datachangeAll",m.range=$.extend(!0,[],h.luckysheet_select_save),m.currange=o,m.ctrlType=a,m.ctrlValue=s,d=!0;for(let p=0;p<o.length;p++)Ue.historyParam(t,h.currentSheetIndex,o[p])}h.clearjfundo&&(h.jfundo.length=0,m.data=h.flowdata,m.curdata=t,m.sheetIndex=h.currentSheetIndex,m.cdformat=$.extend(!0,[],h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save),m.curCdformat=u,h.jfredo.push(m)),h.flowdata=t,It.webWorkerFlowDataCache(t),h.luckysheetfile[Me(h.currentSheetIndex)].data=h.flowdata,l!=null&&(h.config=l,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("all",h.currentSheetIndex,l,{k:"config"})),u!=null&&(h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save=u,Ue.saveParam("all",h.currentSheetIndex,u,{k:"luckysheet_conditionformat_save"})),h.luckysheet_select_save=$.extend(!0,[],o),h.luckysheet_select_save.length>0&&gl(),d&&lg(o,h.currentSheetIndex,t),tr(n,e),f&&(Po=setTimeout(function(){Xt()},1)),kt.storeSheetParamALL(),window.luckysheet_getcelldata_cache=null}function Gc(e,n,t){clearTimeout(Po),h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"rangechange",data:h.flowdata,curdata:e,range:n,sheetIndex:h.currentSheetIndex,cdformat:$.extend(!0,[],h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save),curCdformat:t})),h.flowdata=e,It.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[Me(h.currentSheetIndex)].data=h.flowdata,t!=null&&(h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save=t),lg(n,h.currentSheetIndex,e),Po=setTimeout(function(){Xt()},1);for(let l=0;l<n.length;l++)Ue.historyParam(h.flowdata,h.currentSheetIndex,n[l])}function Rs(e,n,t,l,o,a,s,u,f,m,d){let p=h.luckysheetfile[Me(h.currentSheetIndex)];Ms();let b=[];for(let S in n.merge){let I=n.merge[S];for(let P=I.r;P<=I.r+I.rs-1;P++)for(let F=I.c;F<=I.c+I.cs-1;F++)e[P][F]==null&&(e[P][F]={}),P==I.r&&F==I.c?e[P][F].mc=I:e[P][F].mc={r:I.r,c:I.c},b.push({r:P,c:F})}let g=[];h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:t,sheetIndex:h.currentSheetIndex,data:h.flowdata,curData:e,config:$.extend(!0,{},h.config),curConfig:n,ctrlValue:l,mcData:b,calc:$.extend(!0,[],p.calcChain),curCalc:o,funcData:g,filterObj:{filter_select:$.extend(!0,{},p.filter_select),filter:$.extend(!0,{},p.filter)},curFilterObj:a,cf:$.extend(!0,[],p.luckysheet_conditionformat_save),curCf:s,af:$.extend(!0,[],p.luckysheet_alternateformat_save),curAf:u,freezen:{freezenhorizontaldata:Ie.freezenhorizontaldata,freezenverticaldata:Ie.freezenverticaldata},curFreezen:f,dataVerification:$.extend(!0,{},p.dataVerification),curDataVerification:m,hyperlink:$.extend(!0,{},p.hyperlink),curHyperlink:d,range:p.luckysheet_select_save,dataRange:[...p.luckysheet_select_save]}));let v=l.index,x=l.len,_=l.rc;if(t=="addRC"){let S=l.direction,I=l.restore,P=[];if(I){if(_=="r"){let F;S=="lefttop"?F=v:S=="rightbottom"&&(F=v+1);let D=F+x-1;for(let k=F;k<=D;k++){let w=[];for(let C=0;C<e[0].length;C++){let T=e[k][C];w.push(T)}P.push(w)}}else if(_=="c"){let F;S=="lefttop"?F=v:S=="rightbottom"&&(F=v+1);let D=F+x-1;for(let k=0;k<e.length;k++){let w=[];for(let C=F;C<=D;C++){let T=e[k][C];w.push(T)}P.push(w)}}}Ue.saveParam("arc",h.currentSheetIndex,{index:v,len:x,direction:S,data:P},{rc:_})}else t=="delRC"&&Ue.saveParam("drc",h.currentSheetIndex,{index:v,len:x},{rc:_});h.flowdata=e,It.webWorkerFlowDataCache(h.flowdata),p.data=e,h.config=n,p.config=h.config,Ue.saveParam("all",h.currentSheetIndex,n,{k:"config"});for(let S=0;S<b.length;S++){let I=b[S].r,P=b[S].c;Ue.saveParam("v",h.currentSheetIndex,h.flowdata[I][P],{r:I,c:P})}if(o.length>0)for(let S=0;S<o.length;S++){let I=o[S],P=I.r,F=I.c,D=I.index,k=Ti(P,F,D,e),w=y.execfunction(k,P,F,D,null,!0);I.func=w,e[P][F].f==k&&kr(P,F,e,w[1])}p.calcChain=o,Ue.saveParam("all",h.currentSheetIndex,o,{k:"calcChain"});for(let S=0;S<g.length;S++){let I=g[S].r,P=g[S].c;Ue.saveParam("v",h.currentSheetIndex,h.flowdata[I][P],{r:I,c:P})}a!=null?(p.filter_select=a.filter_select,p.filter=a.filter):(p.filter_select=null,p.filter=null),fi(p.filter_select,p.filter),Ue.saveParam("all",h.currentSheetIndex,p.filter_select,{k:"filter_select"}),Ue.saveParam("all",h.currentSheetIndex,p.filter,{k:"filter"}),p.luckysheet_conditionformat_save=s,Ue.saveParam("all",h.currentSheetIndex,p.luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"}),p.luckysheet_alternateformat_save=u,Ue.saveParam("all",h.currentSheetIndex,p.luckysheet_alternateformat_save,{k:"luckysheet_alternateformat_save"}),f!=null?(Ie.freezenhorizontaldata=f.freezenhorizontaldata,Ie.freezenverticaldata=f.freezenverticaldata):(Ie.freezenhorizontaldata=null,Ie.freezenverticaldata=null),ll.dataVerification=m,p.dataVerification=m,Ue.saveParam("all",h.currentSheetIndex,p.dataVerification,{k:"dataVerification"}),ei.hyperlink=d,p.hyperlink=d,Ue.saveParam("all",h.currentSheetIndex,p.hyperlink,{k:"hyperlink"}),tr(h.flowdata.length,h.flowdata[0].length)}function nf(e,n,t,l,o,a,s,u){let f=h.luckysheetfile[Me(h.currentSheetIndex)];clearTimeout(Po),Ms();let m=[];if(JSON.stringify(n.merge)=="{}")for(let p=0;p<e.length;p++)for(let b=0;b<e[0].length;b++){let g=e[p][b];g!=null&&g.mc!=null&&(delete g.mc,m.push({r:p,c:b}))}else for(let p in n.merge){let b=n.merge[p];for(let g=b.r;g<=b.r+b.rs-1;g++)for(let v=b.c;v<=b.c+b.cs-1;v++)if(e[g][v]==null&&(e[g][v]={}),g==b.r&&v==b.c)JSON.stringify(e[g][v].mc)!=JSON.stringify(b)&&(e[g][v].mc=b,m.push({r:g,c:v}));else{let x={r:b.r,c:b.c};JSON.stringify(e[g][v].mc)!=JSON.stringify(x)&&(e[g][v].mc=x,m.push({r:g,c:v}))}}let d=[];if(h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"deleteCell",sheetIndex:h.currentSheetIndex,ctrl:t,data:h.flowdata,curData:e,config:$.extend(!0,{},h.config),curConfig:n,mcData:m,calc:$.extend(!0,[],f.calcChain),curCalc:l,funcData:d,filterObj:{filter_select:$.extend(!0,{},f.filter_select),filter:$.extend(!0,{},f.filter)},curFilterObj:o,cf:$.extend(!0,[],f.luckysheet_conditionformat_save),curCf:a,dataVerification:$.extend(!0,{},f.dataVerification),curDataVerification:s,hyperlink:$.extend(!0,{},f.hyperlink),curHyperlink:u,range:f.luckysheet_select_save,dataRange:[...f.luckysheet_select_save]})),h.flowdata=e,It.webWorkerFlowDataCache(h.flowdata),f.data=e,Ue.allowUpdate){let p=t.type,b=t.str,g=t.edr,v=t.stc,x=t.edc,_;p=="moveUp"?_={row:[b,e.length-1],column:[v,x]}:p=="moveLeft"&&(_={row:[b,g],column:[v,e[0].length-1]}),Ue.historyParam(h.flowdata,h.currentSheetIndex,_)}h.config=n,f.config=h.config,Ue.saveParam("all",h.currentSheetIndex,n,{k:"config"});for(let p=0;p<m.length;p++){let b=m[p].r,g=m[p].c;Ue.saveParam("v",h.currentSheetIndex,h.flowdata[b][g],{r:b,c:g})}if(l.length>0)for(let p=0;p<l.length;p++){let b=l[p],g=b.r,v=b.c,x=b.index,_=Ti(g,v,x,e),S=y.execfunction(_,g,v,x,null,!0);b.func=S,e[g][v].f==_&&kr(g,v,e,S[1])}f.calcChain=l,Ue.saveParam("all",h.currentSheetIndex,l,{k:"calcChain"});for(let p=0;p<d.length;p++){let b=d[p].r,g=d[p].c;Ue.saveParam("v",h.currentSheetIndex,h.flowdata[b][g],{r:b,c:g})}o!=null?(f.filter_select=o.filter_select,f.filter=o.filter):(f.filter_select=null,f.filter=null),fi(f.filter_select,f.filter),Ue.saveParam("all",h.currentSheetIndex,f.filter_select,{k:"filter_select"}),Ue.saveParam("all",h.currentSheetIndex,f.filter,{k:"filter"}),f.luckysheet_conditionformat_save=a,Ue.saveParam("all",h.currentSheetIndex,f.luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"}),ll.dataVerification=s,f.dataVerification=s,Ue.saveParam("all",h.currentSheetIndex,f.dataVerification,{k:"dataVerification"}),ei.hyperlink=u,f.hyperlink=u,Ue.saveParam("all",h.currentSheetIndex,f.hyperlink,{k:"hyperlink"}),Po=setTimeout(function(){Xt()},1)}function iu(e,n,t){let l={};y.execFunctionExist=[],clearTimeout(Po);for(let u=e.range.row[0];u<=e.range.row[1];u++)for(let f=e.range.column[0];f<=e.range.column[1];f++)u+"_"+f+"_"+e.sheetIndex in l||(l[u+"_"+f+"_"+e.sheetIndex]=0,y.execFunctionExist.push({r:u,c:f,i:e.sheetIndex}));for(let u=n.range.row[0];u<=n.range.row[1];u++)for(let f=n.range.column[0];f<=n.range.column[1];f++)u+"_"+f+"_"+n.sheetIndex in l||(l[u+"_"+f+"_"+n.sheetIndex]=0,y.execFunctionExist.push({r:u,c:f,i:n.sheetIndex}));h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"pasteCut",source:e,target:n,RowlChange:t}));let o;if(h.currentSheetIndex==e.sheetIndex?(h.config=e.curConfig,o=e.curData.length,h.luckysheetfile[Me(n.sheetIndex)].config=n.curConfig):h.currentSheetIndex==n.sheetIndex&&(h.config=n.curConfig,o=n.curData.length,h.luckysheetfile[Me(e.sheetIndex)].config=e.curConfig),t){h.visibledatarow=[],h.rh_height=0;for(let u=0;u<o;u++){let f=h.defaultrowlen;if(h.config.rowlen!=null&&h.config.rowlen[u]!=null&&(f=h.config.rowlen[u]),h.config.rowhidden!=null&&h.config.rowhidden[u]!=null){f=h.config.rowhidden[u],h.visibledatarow.push(h.rh_height);continue}else h.rh_height+=f+1;h.visibledatarow.push(h.rh_height)}if(h.rh_height+=80,h.currentSheetIndex==e.sheetIndex){let u=yh(n.curData.length,n.curConfig);h.luckysheetfile[Me(n.sheetIndex)].visibledatarow=u}else if(h.currentSheetIndex==n.sheetIndex){let u=yh(e.curData.length,e.curConfig);h.luckysheetfile[Me(e.sheetIndex)].visibledatarow=u}}h.currentSheetIndex==e.sheetIndex?(h.flowdata=e.curData,h.luckysheetfile[Me(n.sheetIndex)].data=n.curData):h.currentSheetIndex==n.sheetIndex&&(h.flowdata=n.curData,h.luckysheetfile[Me(e.sheetIndex)].data=e.curData),It.webWorkerFlowDataCache(h.flowdata),h.luckysheetfile[Me(h.currentSheetIndex)].data=h.flowdata,h.currentSheetIndex==n.sheetIndex?h.luckysheet_select_save=[{row:n.range.row,column:n.range.column}]:h.luckysheet_select_save=[{row:e.range.row,column:e.range.column}],h.luckysheet_select_save.length>0&&gl(),h.luckysheetfile[Me(e.sheetIndex)].luckysheet_conditionformat_save=e.curCdformat,h.luckysheetfile[Me(n.sheetIndex)].luckysheet_conditionformat_save=n.curCdformat,h.currentSheetIndex==e.sheetIndex?ll.dataVerification=e.curDataVerification:h.currentSheetIndex==n.sheetIndex&&(ll.dataVerification=n.curDataVerification),h.luckysheetfile[Me(e.sheetIndex)].dataVerification=e.curDataVerification,h.luckysheetfile[Me(n.sheetIndex)].dataVerification=n.curDataVerification,y.execFunctionExist.reverse(),y.execFunctionGroup(null,null,null,null,n.curData),y.execFunctionGlobalData=null;let a=Me(h.currentSheetIndex),s=h.luckysheetfile[a];s.scrollTop=$("#luckysheet-cell-main").scrollTop(),s.scrollLeft=$("#luckysheet-cell-main").scrollLeft(),kt.showSheet(),Po=setTimeout(function(){Xt()},1),kt.storeSheetParamALL(),Ue.saveParam("all",e.sheetIndex,e.curConfig,{k:"config"}),Ue.saveParam("all",n.sheetIndex,n.curConfig,{k:"config"}),Ue.historyParam(e.curData,e.sheetIndex,{row:e.range.row,column:e.range.column}),Ue.historyParam(n.curData,n.sheetIndex,{row:n.range.row,column:n.range.column}),Ue.saveParam("all",e.sheetIndex,e.curCdformat,{k:"luckysheet_conditionformat_save"}),Ue.saveParam("all",n.sheetIndex,n.curCdformat,{k:"luckysheet_conditionformat_save"}),Ue.saveParam("all",e.sheetIndex,e.curDataVerification,{k:"dataVerification"}),Ue.saveParam("all",n.sheetIndex,n.curDataVerification,{k:"dataVerification"})}function tr(e,n,t=!0){Xa(e,n),clearTimeout(Po),kt.storeSheetParam();let l=h.luckysheetfile[Me(h.currentSheetIndex)].calcChain;if(l!=null&&l.length>0){h.config.rowlen==null&&(h.config.rowlen={}),h.config.columnlen==null&&(h.config.columnlen={});for(let o=0;o<l.length;o++){let a=l[o].r,s=l[o].c;if(l[o].index==h.currentSheetIndex&&h.flowdata[a][s]!=null&&h.flowdata[a][s].spl!=null&&(a in h.config.rowlen||s in h.config.columnlen)){window.luckysheetCurrentRow=a,window.luckysheetCurrentColumn=s,window.luckysheetCurrentFunction=h.flowdata[a][s].f;let f=$.trim(y.functionParserExe(h.flowdata[a][s].f)),m=new Function("return "+f)();h.flowdata[a][s].spl=m,Ue.saveParam("v",h.currentSheetIndex,h.flowdata[a][s],{r:a,c:s})}}h.luckysheetfile[Me(h.currentSheetIndex)].data=h.flowdata}if(Zt.positionSync(),gl(),Ms(),$(".luckysheet-selection-copy").is(":visible")&&gr(),$("#luckysheet-dropCell-icon").is(":visible")&&$("#luckysheet-dropCell-icon").remove(),Ie.freezenhorizontaldata!=null&&Ie.freezenverticaldata!=null){let o=Ie.freezenhorizontaldata[1]-1,a=Ie.freezenverticaldata[1]-1,s=Ie.freezenhorizontaldata[2],u=Ie.freezenverticaldata[2],f=h.visibledatarow[o]-2-s+h.columnHeaderHeight,m=[h.visibledatarow[o],o+1,s,Ie.cutVolumn(h.visibledatarow,o+1),f],d=h.visibledatacolumn[a]-2-u+h.rowHeaderWidth,p=[h.visibledatacolumn[a],a+1,u,Ie.cutVolumn(h.visibledatacolumn,a+1),d];Ie.saveFreezen(m,f,p,d),Ie.createFreezenHorizontal(m,f),Ie.createFreezenVertical(p,d),Ie.createAssistCanvas()}else if(Ie.freezenhorizontaldata!=null){let o=Ie.freezenhorizontaldata[1]-1,a=Ie.freezenhorizontaldata[2],s=h.visibledatarow[o]-2-a+h.columnHeaderHeight,u=[h.visibledatarow[o],o+1,a,Ie.cutVolumn(h.visibledatarow,o+1),s];Ie.saveFreezen(u,s,null,null),Ie.createFreezenHorizontal(u,s),Ie.createAssistCanvas()}else if(Ie.freezenverticaldata!=null){let o=Ie.freezenverticaldata[1]-1,a=Ie.freezenverticaldata[2],s=h.visibledatacolumn[o]-2-a+h.rowHeaderWidth,u=[h.visibledatacolumn[o],o+1,a,Ie.cutVolumn(h.visibledatacolumn,o+1),s];Ie.saveFreezen(null,null,u,s),Ie.createFreezenVertical(u,s),Ie.createAssistCanvas()}else $("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").length>0&&$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(o,a){let s=$(a).data("str"),u=$(a).data("cindex"),f=h.visibledatacolumn[u]-20,m=s-1==-1?0:h.visibledatarow[s-1];$(a).css({left:f,top:m})});if($("#luckysheet-filter-selected-sheet"+h.currentSheetIndex).length>0){let o=h.luckysheetfile[Me(h.currentSheetIndex)].filter_select,a=o.row[0],s=o.row[1],u=o.column[0],f=o.column[1],m=h.visibledatarow[s],d=a-1==-1?0:h.visibledatarow[a-1],p=h.visibledatacolumn[f],b=u-1==-1?0:h.visibledatacolumn[u-1];$("#luckysheet-filter-selected-sheet"+h.currentSheetIndex).css({left:b,width:p-b-1,top:d,height:m-d-1})}kt.showSheet(),t&&(Po=setTimeout(function(){Xt()},1))}function Xt(e,n){if(y.groupValuesRefresh(),e==null&&(e=$("#luckysheet-cell-main").scrollLeft()),n==null&&(n=$("#luckysheet-cell-main").scrollTop()),Ie.freezenverticaldata!=null||Ie.freezenhorizontaldata!=null){let t,l,o,a,s,u,f=h.luckysheetTableContentHW[0],m=h.luckysheetTableContentHW[1];Ie.freezenverticaldata!=null&&Ie.freezenhorizontaldata!=null?(t=Ie.freezenhorizontaldata[0],l=Ie.freezenhorizontaldata[1],o=Ie.freezenhorizontaldata[2],a=Ie.freezenverticaldata[0],s=Ie.freezenverticaldata[1],u=Ie.freezenverticaldata[2],Ki(u,o,a,t,1,1,null,null,"freezen_3"),Ki(e+a-u,o,f-a+u,t,1,1,null,null,"freezen_4"),Ki(u,n+t-o,a,m-t+o,1,1,null,null,"freezen_7"),Ki(e+a-u,n+t-o,f-a+u,m-t+o,a-u+h.rowHeaderWidth,t-o+h.columnHeaderHeight),fc(u,a,h.rowHeaderWidth),fc(e+a-u,f-a+u,a-u+h.rowHeaderWidth),uc(o,t,h.columnHeaderHeight),uc(n+t-o,m-t+o,t-o+h.columnHeaderHeight)):Ie.freezenhorizontaldata!=null?(t=Ie.freezenhorizontaldata[0],l=Ie.freezenhorizontaldata[1],o=Ie.freezenhorizontaldata[2],Ki(e,o,f,t,1,1,null,null,"freezen_h"),Ki(e,n+t-o,f,m-t+o,null,t-o+h.columnHeaderHeight),fc(e,f,null),uc(o,t,h.columnHeaderHeight),uc(n+t-o,m-t+o,t-o+h.columnHeaderHeight)):Ie.freezenverticaldata!=null&&(a=Ie.freezenverticaldata[0],s=Ie.freezenverticaldata[1],u=Ie.freezenverticaldata[2],Ki(u,n,a,m,1,1,null,null,"freezen_v"),Ki(e+a-u,n,f-a+u,m,a-u+h.rowHeaderWidth,null),uc(n,m,null),fc(u,a,h.rowHeaderWidth),fc(e+a-u,f-a+u,a-u+h.rowHeaderWidth))}else{if($("#luckysheetTableContent").length==0)return;let t=$("#luckysheetTableContent").get(0).getContext("2d");Ki(e,n),fc(e),uc(n),t.clearRect(0,0,h.rowHeaderWidth*h.devicePixelRatio-1,h.columnHeaderHeight*h.devicePixelRatio-1)}}var import_plugin,Po,Ar=Nt(()=>{import_plugin=qe(Ye());lf();Sr();Wr();Do();Er();fo();Sh();Di();qr();kn();ta();go();nu();jr();Ja();fr();il();Po=null});function c1(e,n,t){return new Promise((l,o)=>{let a=new XMLHttpRequest||new ActiveXObject("Microsoft.XMLHTTP");a.open(e,n),a.send(JSON.stringify(t)),a.onreadystatechange=function(){a.readyState==4&&(a.status==200?l(a.responseText):o("error"))}})}var import_plugin,u1=Nt(()=>{import_plugin=qe(Ye())});var import_plugin,rg,ff,hc,Ue,qr=Nt(()=>{import_plugin=qe(Ye()),rg=qe(my());Im();Ar();Wr();Rr();kn();ln();Ja();Di();ta();Qo();go();nu();Ol();fr();il();jr();Xl();ff=qe(Za());Qc();Vn();u1();wi();hc={gridKey:null,loadUrl:null,updateUrl:null,updateImageUrl:null,title:null,loadSheetUrl:null,retryTimer:null,allowUpdate:!1,historyParam:function(e,n,t){let l=this,o=t.row[0],a=t.row[1],s=t.column[0],u=t.column[1];if(o==a&&s==u){let f=e[o][s];l.saveParam("v",n,f,{r:o,c:s})}else{let f=a-o+1,m=u-s+1,d=Math.floor(1e3/m),p=Math.ceil(f/d);for(let b=0;b<p;b++){let g=o+d*b,v;b==p-1?v=a:v=o+d*(b+1)-1;let x=[];for(let _=g;_<=v;_++){let S=[];for(let I=s;I<=u;I++)e[_]==null?S.push(null):S.push(e[_][I]);x.push(S)}l.saveParam("rv",n,x,{range:{row:[g,v],column:[s,u]}}),b==p-1&&l.saveParam("rv_end",n,null)}}},saveParam:function(e,n,t,l){let o=this;if(!o.allowUpdate)return;t==null&&(t=null);let a={};if(a.t=e,a.i=n,a.v=t,e==="shs")return;e=="rv"?a.range=l.range:e=="v"||e=="fu"||e=="fm"?(a.r=l.r,a.c=l.c):e=="fc"?(a.op=l.op,a.pos=l.pos):e=="drc"||e=="arc"||e=="h"||e=="wh"?a.rc=l.rc:e=="c"?(a.cid=l.cid,a.op=l.op):e=="f"?(a.op=l.op,a.pos=l.pos):e=="s"||(e=="sh"?(a.op=l.op,l.cur!=null&&(a.cur=l.cur)):(e=="cg"||e=="all")&&(a.k=l.k));let s=ut.imageUpdateMethodConfig;if(JSON.stringify(s)!=="{}")if(a.k!="images"){let u=rg.default.gzip(encodeURIComponent(JSON.stringify(a)),{to:"string"});o.websocket!=null&&o.websocket.send(u)}else c1(s.method,s.url,a).then(u=>{console.log(u)}).catch(u=>{console.log(u)});else{let u=rg.default.gzip(encodeURIComponent(JSON.stringify(a)),{to:"string"});o.websocket!=null&&o.websocket.send(u)}},websocket:null,wxErrorCount:0,openWebSocket:function(){let e=this;if("WebSocket"in window){let n=e.updateUrl+"?t=111&g="+encodeURIComponent(e.gridKey);e.updateUrl.indexOf("?")>-1&&(n=e.updateUrl+"&t=111&g="+encodeURIComponent(e.gridKey)),e.websocket=new WebSocket(n),e.websocket.onopen=function(){console.info(Be().websocket.success),Ku(),e.wxErrorCount=0,e.retryTimer=setInterval(function(){e.websocket.send("rub")},6e4)},e.websocket.onmessage=function(t){h.result=t;let l=new Function("return "+t.data)();sl.createHookFunction("cooperativeMessage",l),console.info(l);let o=l.type,{message:a,id:s}=l;if(a==="\u7528\u6237\u9000\u51FA"&&($("#luckysheet-multipleRange-show-"+s).hide(),h.cooperativeEdit.changeCollaborationSize=h.cooperativeEdit.changeCollaborationSize.filter(u=>u.id!=s),h.cooperativeEdit.checkoutData=h.cooperativeEdit.checkoutData.filter(u=>u.id!=s)),o==1){let u=l.data.v.index,f=h.luckysheetfile.filter(m=>m.index===u)[0];f!==null&&setTimeout(()=>{let m=l.data.i;f.index=m,h.currentSheetIndex=m,$(`#luckysheet-sheets-item${u}`).attr("data-index",m),$(`#luckysheet-sheets-item${u}`).prop("id",`luckysheet-sheets-item${m}`),$(`#luckysheet-datavisual-selection-set-${u}`).prop("id",`luckysheet-datavisual-selection-set-${m}`)},1)}else if(o==2){let u=JSON.parse(l.data);e.wsUpdateMsg(u);let f=JSON.parse(l.data);f.k=="columnlen"?Ms(f.v,null):f.k=="rowlen"&&Ms(null,f.v)}else if(o==3){let u=l.id,f=l.username,m=JSON.parse(l.data),d=m.t,p=m.i,b=m.v;h.cooperativeEdit.changeCollaborationSize.length===0&&h.cooperativeEdit.changeCollaborationSize.push({id:u,v:m.v[0],i:p}),h.cooperativeEdit.changeCollaborationSize.some(S=>S.id==u)?h.cooperativeEdit.changeCollaborationSize.forEach(S=>{S.id==u&&(S.v=m.v[0]||m.range[0],S.i=p)}):h.cooperativeEdit.changeCollaborationSize.push({id:u,v:m.v[0],i:p}),G(b)!="array"&&G(b)!=="object"&&(b=JSON.parse(b));let v=0,x=0;if(p==h.currentSheetIndex?G(b)==="object"&&b.op==="enterEdit"?(v=b.range[b.range.length-1].row[0],x=b.range[b.range.length-1].column[0],e.multipleRangeShow(u,f,v,x,b.op)):(v=b[b.length-1].row[0],x=b[b.length-1].column[0],e.multipleRangeShow(u,f,v,x)):G(b)==="object"&&b.op==="enterEdit"?(v=b.range[b.range.length-1].row[0],x=b.range[b.range.length-1].column[0]):(v=b[b.length-1].row[0],x=b[b.length-1].column[0]),h.cooperativeEdit.checkoutData.length===0&&(b.op?h.cooperativeEdit.checkoutData.push({id:u,username:f,r:v,c:x,op:b.op,index:p}):h.cooperativeEdit.checkoutData.push({id:u,username:f,r:v,c:x,index:p})),h.cooperativeEdit.checkoutData.some(S=>S.id==u)?h.cooperativeEdit.checkoutData.forEach(S=>{S.id==u&&(S.username=f,S.r=v,S.c=x,S.index=p,b.op==="enterEdit"&&(S.op=b.op))}):b.op==="enterEdit"?h.cooperativeEdit.checkoutData.push({id:u,username:f,r:v,c:x,op:b.op,index:p}):h.cooperativeEdit.checkoutData.push({id:u,username:f,r:v,c:x,index:p}),h.cooperativeEdit.checkoutData.forEach(S=>{S.index!=h.currentSheetIndex&&($("#luckysheet-multipleRange-show-"+S.id).hide(),S.op=="")}),$("#luckysheet-multipleRange-show-"+u)[0]){let S=$("#luckysheet-multipleRange-show-"+u)[0].offsetHeight-1;$("#luckysheet-multipleRange-show-"+u+">.username").css({bottom:S+"px"})}}else if(o==4){let u=l.data===""?l.data:JSON.parse(l.data);for(let f=0;f<u.length;f++)e.wsUpdateMsg(item[f])}else o==5?Uc(l.data):o==6&&Ku()},e.websocket.onerror=function(){e.wxErrorCount++,e.wxErrorCount>3?Uc(Be().websocket.refresh):(Uc(Be().websocket.wait),e.openWebSocket())},e.websocket.onclose=function(t){console.info(Be().websocket.close),t.code===1e3?(clearInterval(e.retryTimer),e.retryTimer=null):alert(Be().websocket.contact)}}else alert(Be().websocket.support)},wsUpdateMsg:function(e){let n=e.t,t=e.i,l=e.v,o=h.luckysheetfile[Me(t)];if(!(["v","rv","cg","all","fc","drc","arc","f","fsc","fsr","sh","c"].includes(n)&&o==null))if(n=="v"){if(o.data==null||o.data.length==0)return;let a=e.r,s=e.c;o.data[a][s]=l,t==h.currentSheetIndex&&(h.flowdata=o.data,It.webWorkerFlowDataCache(h.flowdata),l!=null&&l.ps!=null?Zt.buildPs(a,s,l.ps):Zt.buildPs(a,s,null),setTimeout(function(){Xt()},1))}else if(n=="rv"){if(Object.keys(e.range).length>0&&(h.cooperativeEdit.merge_range=e.range,h.cooperativeEdit.merge_range.v=e.v,Ms()),o.data==null||o.data.length==0)return;let a=e.range.row[0],s=e.range.row[1],u=e.range.column[0],f=e.range.column[1];for(let m=a;m<=s;m++)for(let d=u;d<=f;d++)o.data[m][d]=l[m-a][d-u];if(t==h.currentSheetIndex){h.flowdata=o.data,It.webWorkerFlowDataCache(h.flowdata);for(let m=a;m<=s;m++)for(let d=u;d<=f;d++)l[m-a][d-u]!=null&&l[m-a][d-u].ps!=null?Zt.buildPs(m,d,l[m-a][d-u].ps):Zt.buildPs(m,d,null);setTimeout(function(){Xt()},1)}}else if(n=="cg"){let a=e.k;a=="borderInfo"?o.config.borderInfo=l:(a in o.config||(o.config[a]={}),l&&typeof l=="object"&&(o.config[a]=l)),t==h.currentSheetIndex&&(h.config=o.config,(a=="rowlen"||a=="columnlen"||a=="rowhidden")&&tr(h.flowdata.length,h.flowdata[0].length),setTimeout(function(){Xt()},1))}else if(n=="all"){let a=e.k;if(o[a]=l,a=="name")$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+t).find("span.luckysheet-sheets-item-name").html(l);else if(a=="color"){let s=$("#luckysheet-sheet-container-c #luckysheet-sheets-item"+t);s.find(".luckysheet-sheets-item-color").remove(),(l!=null||l!="")&&s.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+l+';"></div>')}else if(a!="pivotTable")if(a=="frozen"){if(Ie.frozenTofreezen(),t==h.currentSheetIndex){let u=Be().freezen;o.freezen.horizontal==null?($("#luckysheet-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> '+u.freezenRow),Ie.freezenhorizontaldata=null,$("#luckysheet-freezebar-horizontal").hide()):Ie.createFreezenHorizontal(o.freezen.horizontal.freezenhorizontaldata,o.freezen.horizontal.top),o.freezen.vertical==null?($("#luckysheet-freezen-btn-vertical").html('<i class="fa fa-indent"></i> '+u.freezenColumn),Ie.freezenverticaldata=null,$("#luckysheet-freezebar-vertical").hide()):Ie.createFreezenVertical(o.freezen.vertical.freezenverticaldata,o.freezen.vertical.left),Ie.createAssistCanvas()}}else a=="filter_select"?t==h.currentSheetIndex&&fi(l):a=="filter"?t==h.currentSheetIndex&&fi(o.filter_select,l):a=="luckysheet_conditionformat_save"?t==h.currentSheetIndex&&setTimeout(function(){Xt()},1):a=="luckysheet_alternateformat_save"?t==h.currentSheetIndex&&setTimeout(function(){Xt()},1):a=="config"?t==h.currentSheetIndex&&(h.config=l,tr(h.flowdata.length,h.flowdata[0].length)):a=="dynamicArray"?t==h.currentSheetIndex&&setTimeout(function(){Xt()},1):a=="images"?t==h.currentSheetIndex&&(Pt.images=l,Pt.allImagesShow(),Pt.init()):a=="dataVerification"?t==h.currentSheetIndex&&(ll.dataVerification=l,ll.init()):a=="hyperlink"&&t==h.currentSheetIndex&&(ei.hyperlink=l,ei.init())}else if(n=="fc"){let a=e.op,s=e.pos;G(l)!="object"&&(l=new Function("return "+l)());let u=l.r,f=l.c,m=o.calcChain==null?[]:o.calcChain;if(a=="add")m.push(l);else if(a=="del")for(let d=0;d<m.length;d++)u==m[d].r&&f==m[d].c&&t==m[d].index&&m.splice(d,1);setTimeout(function(){Xt()},1)}else if(n=="drc"){if(o.data==null||o.data.length==0)return;let a=e.rc,s=l.index,u=l.len,f=l.mc,m=l.borderInfo,d=o.data;if(a=="r"){o.row-=u,d.splice(s,u);let p=[];for(let b=0;b<d[0].length;b++)p.push(null);for(let b=0;b<u;b++)d.push(p)}else{o.column-=u;let p=[];for(let b=0;b<u;b++)p.push(null);for(let b=0;b<d.length;b++)d[b].splice(s,u),d[b]=d[b].concat(p)}for(let p in f){let b=f[p].r,g=f[p].c;d[b][g].mc=f[p]}o.config.merge=f,o.config.borderInfo=m,t==h.currentSheetIndex&&(h.flowdata=d,It.webWorkerFlowDataCache(h.flowdata),h.config.merge=f,h.config.borderInfo=m,setTimeout(function(){Xt()},1))}else if(n=="arc"){if(o.data==null||o.data.length==0)return;let a=e.rc,s=l.index,u=l.len,f=l.data,m=l.direction,d=l.mc,p=l.borderInfo,b=$.extend(!0,[],o.data);if(a=="r"){o.row+=u;let g=[];for(let x=0;x<b[0].length;x++)g.push(null);let v=[];for(let x=0;x<u;x++)f[x]==null?v.push(JSON.stringify(g)):v.push(JSON.stringify(f[x]));m=="lefttop"?s==0?new Function("data","return data.unshift("+v.join(",")+")")(b):new Function("data","return data.splice("+s+", 0, "+v.join(",")+")")(b):new Function("data","return data.splice("+(s+1)+", 0, "+v.join(",")+")")(b)}else{o.column+=u;for(let g=0;g<b.length;g++)for(let v=0;v<u;v++)m=="lefttop"?b[g].splice(s,0,f[v]):b[g].splice(s+1,0,f[v])}for(let g in d){let v=d[g].r,x=d[g].c;b[v][x].mc=d[g]}o.data=b,o.config.merge=d,o.config.borderInfo=p,t==h.currentSheetIndex&&(h.flowdata=b,It.webWorkerFlowDataCache(h.flowdata),h.config.merge=d,h.config.borderInfo=p,setTimeout(function(){Xt()},1))}else if(n=="f"){let a=e.op,s=e.pos,u=o.filter;u==null&&(u={}),a=="upOrAdd"?u[s]=l:a=="del"&&delete u[s],t==h.currentSheetIndex&&fi(o.filter_select,u)}else if(n=="fsc")o.filter=null,o.filter_select=null,t==h.currentSheetIndex&&($("#luckysheet-filter-selected-sheet"+h.currentSheetIndex+", #luckysheet-filter-options-sheet"+h.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide());else if(n=="fsr")o.filter=l.filter,o.filter_select=l.filter_select,t==h.currentSheetIndex&&fi(o.filter_select,o.filter);else if(n=="sha"){h.luckysheetfile.push(l);let a="";l.color!=null&&(a='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+l.color+';"></div>'),$("#luckysheet-sheet-container-c").append(Tt(Ui,{index:l.index,active:"",name:l.name,style:"",colorset:a})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+l.index+'" class="luckysheet-datavisual-selection-set"></div>'),kt.locationSheet()}else if(n=="shc"){let a=l.copyindex,s=l.name,u=Me(a),f=$.extend(!0,{},h.luckysheetfile[u]);f.index=t,f.name=s,h.luckysheetfile.splice(u+1,0,f);let m=$("#luckysheet-sheets-item"+a);$("#luckysheet-sheet-container-c").append(Tt(Ui,{index:f.index,active:"",name:f.name,style:"",colorset:""})),$("#luckysheet-sheets-item"+f.index).insertAfter(m),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+f.index+'" class="luckysheet-datavisual-selection-set"></div>')}else if(n=="shd"){for(let a=0;a<h.luckysheetfile.length;a++)if(h.luckysheetfile[a].index==l.deleIndex){if(h.currentSheetIndex===l.deleIndex){let s=l.deleIndex;h.luckysheetfile[kt.getSheetIndex(s)].hide=1;let u=$("#luckysheet-sheets-item"+s);u.hide(),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active");let f=u.nextAll(":visible");u.nextAll(":visible").length>0?f=f.eq(0).data("index"):f=u.prevAll(":visible").eq(0).data("index"),$("#luckysheet-sheets-item"+f).addClass("luckysheet-sheets-item-active"),kt.changeSheetExec(f)}hc.sheetDeleSave.push(h.luckysheetfile[a]),h.luckysheetfile.splice(a,1);break}$("#luckysheet-sheets-item"+l.deleIndex).remove(),$("#luckysheet-datavisual-selection-set-"+l.deleIndex).remove(),kt.locationSheet()}else if(n=="shr")for(let a in l)h.luckysheetfile[Me(a)].order=l[a];else if(n=="shre"){for(let a=0;a<hc.sheetDeleSave.length;a++)if(hc.sheetDeleSave[a].index==l.reIndex){let s=hc.sheetDeleSave[a];h.luckysheetfile.push(s);let u="";l.color!=null&&(u='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+s.color+';"></div>'),$("#luckysheet-sheet-container-c").append(Tt(Ui,{index:s.index,active:"",name:s.name,style:"",colorset:u})),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+s.index+'" class="luckysheet-datavisual-selection-set"></div>');break}}else if(n=="sh"){let a=e.op,s=e.cur;a=="hide"?(o.hide=1,$("#luckysheet-sheets-item"+t).hide(),t==h.currentSheetIndex&&($("#luckysheet-sheets-item"+s).addClass("luckysheet-sheets-item-active"),kt.changeSheetExec(s))):a=="show"&&(o.hide=0,$("#luckysheet-sheets-item"+t).show()),kt.locationSheet()}else if(n=="c"){let a=e.op,s=e.cid;if(a=="add")o.chart.push(l),luckysheet.insertChartTosheet(l.sheetIndex,l.dataSheetIndex,l.option,l.chartType,l.selfOption,l.defaultOption,l.row,l.column,l.chart_selection_color,l.chart_id,l.chart_selection_id,l.chartStyle,l.rangeConfigCheck,l.rangeRowCheck,l.rangeColCheck,l.chartMarkConfig,l.chartTitleConfig,l.winWidth,l.winHeight,l.scrollLeft1,l.scrollTop1,l.chartTheme,l.myWidth,l.myHeight,l.myLeft,l.myTop,l.myindexrank1,!0);else if(a=="xy"||a=="wh"||a=="update")for(let u=0;u<o.chart.length;u++){let f=o.chart[u];if(f.chart_id==s){for(let m in f)for(let d in l)m==d&&(f[m]=l[d]);kt.saveChart(f);return}}else if(a=="del"){for(let u=0;u<o.chart.length;u++)if(o.chart[u].chart_id==s){o.chart.splice(u,1),$("#"+s).remove(),kt.delChart($("#"+s).attr("chart_id"),$("#"+s).attr("sheetIndex"));return}}}else n=="na"&&$("#luckysheet_info_detail_input").val(l).css("width",dc(l)*10)},multipleIndex:0,multipleRangeShow:function(e,n,t,l,o){let a=this,s=n,u=h.visibledatarow[t],f=t-1==-1?0:h.visibledatarow[t-1],m=h.visibledatacolumn[l],d=l-1==-1?0:h.visibledatacolumn[l-1],p=_t.mergeborer(h.flowdata,t,l);if(p&&(u=p.row[1],f=p.row[0],m=p.column[1],d=p.column[0]),d<=0&&(d+=1),f<=0&&(f+=1),dc(n)>16&&(n=dc(n,16)+"..."),o==="enterEdit"&&(n+=" "+Be().edit.typing),$("#luckysheet-multipleRange-show-"+e).length>0)$("#luckysheet-multipleRange-show-"+e).css({position:"absolute",left:d-1,width:m-d-1,top:f-1,height:u-f-1}),$("#luckysheet-multipleRange-show-"+e+" .username").text(n),$("#luckysheet-multipleRange-show-"+e+" .username").show(),h.cooperativeEdit.usernameTimeout["user"+e]!=null&&clearTimeout(h.cooperativeEdit.usernameTimeout["user"+e]),h.cooperativeEdit.usernameTimeout["user"+e]=setTimeout(()=>{clearTimeout(h.cooperativeEdit.usernameTimeout["user"+e]),h.cooperativeEdit.usernameTimeout["user"+e]=null},10*1e3);else{let b=`<div
								id="luckysheet-multipleRange-show-${e}"
								class="luckysheet-multipleRange-show"
								data-color="${Pi[a.multipleIndex]}"
								title="${s}"
								style="position: absolute;left: ${d-1}px;width: ${m-d-1}px;top: ${f-1}px;height: ${u-f-1}px;border: 1px solid ${Pi[a.multipleIndex]};z-index: 15;">

								<div class="username" style="height: 19px;line-height:19px;width: max-content;position: absolute;bottom: ${u-f-1}px;right: 0;background-color: ${Pi[a.multipleIndex]};color:#ffffff;padding:0 10px;">
								${n}
								</div>

								<div style="width: 100%;height: 100%;position: absolute;top: 0;right: 0;bottom: 0;left: 0;opacity: 0.03;background-color: ${Pi[a.multipleIndex]}">
								</div>

							</div>`;$(b).appendTo($("#luckysheet-cell-main #luckysheet-multipleRange-show")),a.multipleIndex++,h.cooperativeEdit.usernameTimeout["user"+e]!=null&&clearTimeout(h.cooperativeEdit.usernameTimeout["user"+e]),h.cooperativeEdit.usernameTimeout["user"+e]=setTimeout(()=>{clearTimeout(h.cooperativeEdit.usernameTimeout["user"+e]),h.cooperativeEdit.usernameTimeout["user"+e]=null},10*1e3)}},sheetDeleSave:[],submitInterval:1e3,imagesubmitInterval:5e3,submitdatalimit:50,submitcompresslimit:1e3,checksubmit:function(e){let n=this;n.submitTimeout(),clearTimeout(n.imageRequestTimeout),n.imageRequestTimeout=setTimeout(function(){n.imageRequest()},n.imagesubmitInterval)},submitTimeout:function(){let e=this;clearTimeout(e.requestTimeOut),!e.requestLock&&e.requestlast!=null&&e.requestlast.clone().add(1,"seconds").isBefore((0,ff.default)())&&e.request(),e.requestTimeOut=setTimeout(function(){e.submitTimeout()},e.submitInterval)},requestLock:!1,requestlast:null,firstchange:!0,requestTimeOut:null,request:function(){let e=this,t=this.gridKey+"__qkcache";e.cachelocaldata(function(l,o){if(o.length==0)return;o=encodeURIComponent(JSON.stringify(o));let a=o.length,s=!1;e.requestLock=!0,e.updateUrl!=""&&$.post(e.updateUrl,{compress:s,gridKey:e.gridKey,data:o},function(u){new Function("return "+u)().status?($("#luckysheet_info_detail_update").html("\u6700\u8FD1\u5B58\u6863\u65F6\u95F4:"+(0,ff.default)().format("M-D H:m:s")),$("#luckysheet_info_detail_save").html("\u540C\u6B65\u6210\u529F"),e.clearcachelocaldata()):($("#luckysheet_info_detail_save").html("<span style='color:#ff2121'>\u540C\u6B65\u5931\u8D25</span>"),e.restorecachelocaldata()),e.requestlast=(0,ff.default)(),e.requestLock=!1})})},imageRequestLast:null,imageRequestLock:!1,imageRequestTimeout:null,imageRequest:function(){let e=this;html2canvas($("#"+container).find(".luckysheet-grid-window").get(0),{onrendered:function(n){let t=$(n).appendTo("body");t.hide();let l=t.width(),o=t.height(),a=t.get(0).getContext("2d").getImageData(0,0,l,o),s=l,u=o;s*.54>u?s=u/.54:u=s*.54;let f=$("<canvas>").attr("width",s).attr("height",u)[0];f.getContext("2d").putImageData(a,0,0),t.attr("width",350),t.attr("height",189),t.get(0).getContext("2d").drawImage(f,0,0,350,189);let m=t.get(0).toDataURL("image/jpeg",.9),d=luckysheet.sheetmanage.getCurSheetnoset();e.imageRequestLock=!0;let p=encodeURIComponent(JSON.stringify({t:"thumb",img:m,curindex:d}));t.remove(),e.updateImageUrl!=""&&$.post(e.updateImageUrl,{compress:!1,gridKey:e.gridKey,data:p},function(b){new Function("return "+b)().status?imageRequestLast=(0,ff.default)():$("#luckysheet_info_detail_save").html("<span style='color:#ff2121'>\u7F51\u7EDC\u4E0D\u7A33\u5B9A</span>"),e.imageRequestLock=!0})}})},localdata:[],matchOpt:function(e,n){for(let t in e){if(t=="t"&&e.t in{drc:1,arc:1,sha:1,shc:1,shd:1})return!1;if(t!="v"&&(!(t in n)||n[t]!=e[t]))return!1}return!0},deleteRepeatOpt:function(e,n){let t=e,l=this;if(n instanceof Array)for(let a=0;a<n.length;a++){let s=n[a];for(let u=0;u<t.length;u++){let f=e[a];l.matchOpt(s,f)&&delete t[u]}}else for(let a=0;a<t.length;a++){let s=t[a];l.matchOpt(n,s)&&delete t[a]}let o=[];for(let a=0;a<t.length;a++)t[a]!=null&&o.push(t[a]);return o},setlocaldata:function(e,n){let t=this.gridKey,l=this;l.getlocaldata(function(o){o==null&&(o=[]),e instanceof Array?o=o.concat(e):o.push(e),l.localdata=o,n(l.localdata)})},getlocaldata:function(e){let n=this.gridKey;e(this.localdata)},clearlocaldata:function(e){let n=this.gridKey;this.localdata=[],e()},cachelocaldata:function(e){let n=this.gridKey,t=this,l=n+"__qkcache",o=t.localdata,a=o.length;if(a>1){let s=[];s[0]=o[0];for(let u=1;u<a;u++){let f=o[u],m=!0;for(let d=0;d<s.length;d++){let p=s[d];if(t.matchOpt(f,p)){s.splice(d,1,f),m=!1;break}}m&&(s=s.concat(f))}o=s}o==null||o.length==0||t.clearlocaldata(function(){localforage.setItem(l,o).then(function(){e(l,o)})})},clearcachelocaldata:function(e){let t=this.gridKey+"__qkcache";localforage.removeItem(t,function(l,o){e&&typeof e=="function"&&e()})},restorecachelocaldata:function(e){let t=this.gridKey+"__qkcache",l=this;localforage.getItem(t).then(function(o){let a=o;l.getlocaldata(function(s){s==null&&(s=[]);let u=a.concat(s);l.localdata=u,e instanceof Function&&e(l.localdata)})})},keepHighLightBox:function(){h.cooperativeEdit.checkoutData.forEach(e=>{e.index==h.currentSheetIndex&&(e.op==="enterEdit"?hc.multipleRangeShow(e.id,e.username,e.r,e.c,e.op):hc.multipleRangeShow(e.id,e.username,e.r,e.c))})}},Ue=hc});var import_plugin,a3,ke,Kr=Nt(()=>{import_plugin=qe(Ye());Rr();Oc();Ol();Xl();qr();a3={info:function(e,n){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-info").remove();let l=Be().button;$("body").first().append(Tt(Ll,{id:"luckysheet-info",addclass:"",title:e,content:n,botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;'+l.close+"&nbsp;&nbsp;</button>",style:"z-index:100003"}));let o=$("#luckysheet-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-info").css({left:(u+m-s)/2,top:(f+d-a)/3}).show()},confirm:function(e,n,t,l,o,a){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove();let u=Be().button;o==null&&(o=u.confirm),a==null&&(a=u.cancel),$("body").first().append(Tt(Ll,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:e,content:n,botton:'<button class="btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+o+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+a+"&nbsp;&nbsp;</button>"}));let f=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),m=f.outerHeight(),d=f.outerWidth(),p=$(window).width(),b=$(window).height(),g=$(document).scrollLeft(),v=$(document).scrollTop();$("#luckysheet-confirm").css({left:(p+g-d)/2,top:(b+v-m)/3}).show(),f.find(".luckysheet-model-conform-btn").click(function(){typeof t=="function"&&t(),Ue.keepHighLightBox(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),f.find(".luckysheet-model-cancel-btn").click(function(){typeof l=="function"&&l(),$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()})},screenshot:function(e,n,t){let o=Be().screenshot;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-confirm").remove(),$("body").first().append(Tt(Ll,{id:"luckysheet-confirm",addclass:"",style:"z-index:100003",title:e,content:n,botton:'<a style="text-decoration:none;color:#fff;" class="download btn btn-primary luckysheet-model-conform-btn">&nbsp;&nbsp;'+o.downLoadBtn+'&nbsp;&nbsp;</a>&nbsp;&nbsp;<button class="btn btn-primary luckysheet-model-copy-btn">&nbsp;&nbsp;'+o.downLoadCopy+'&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-cancel-btn">&nbsp;&nbsp;'+o.downLoadClose+"&nbsp;&nbsp;</button>"}));let a=$("#luckysheet-confirm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),s=a.outerHeight(),u=a.outerWidth(),f=$(window).width(),m=$(window).height(),d=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-confirm").css({left:(f+d-u)/2,top:(m+p-s)/3}).show(),a.find(".luckysheet-model-conform-btn").click(function(){co.isIE()=="1"?alert(o.browserNotTip):(!!window.ActiveXObject||"ActiveXObject"in window)&&($("#IframeReportImg").length===0&&$('<iframe style="display:none;" id="IframeReportImg" name="IframeReportImg" onload="downloadImg();" width="0" height="0" src="about:blank"></iframe>').appendTo("body"),$("#IframeReportImg").attr("src")!=t?$("#IframeReportImg").attr("src",t):$("#IframeReportImg").src!="about:blank"&&window.frames.IframeReportImg.document.execCommand("SaveAs"))}),a.find(".luckysheet-model-cancel-btn").click(function(){$("#luckysheet-confirm").hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#luckysheet-confirm .luckysheet-model-copy-btn").click(function(){let b=new clipboard.DT;b.setData("text/html","<img src='"+t+"'>"),co.isIE()=="1"?alert(o.rightclickTip):(clipboard.write(b),alert(o.successTip))})},chartPointConfig:function(e,n,t){$("body").first().append(Tt(Ll,{id:e,addclass:"luckysheet-chart-point-config-c",title:"\u6570\u636E\u70B9\u6279\u91CF\u8BBE\u7F6E",content:x0,botton:'<button class="btn btn-danger luckysheet-model-save-btn">&nbsp;&nbsp;\u4FDD\u5B58\u8BBE\u7F6E&nbsp;&nbsp;</button><button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;\u53D6\u6D88&nbsp;&nbsp;</button>',style:"z-index:100003;height:80%;width:80%;top:10%;left:10%;"})),$("#luckysheet-modal-dialog-mask").show();let l=$(window).width(),o=$(window).height();$("#"+e).find(".luckysheet-chart-point-config").css("height",o-160),$("#"+e).css({height:o-90,width:l-100,left:7,top:14}).show().find(".luckysheet-model-save-btn").click(function(){typeof n=="function"&&n(),$("#"+e).hide(),$("#luckysheet-modal-dialog-mask").hide()}),$("#"+e).find(".luckysheet-model-save-btn").click(function(){typeof t=="function"&&t(),$("#"+e).hide(),$("#luckysheet-modal-dialog-mask").hide()})},sheetConfig:function(){},hoverTipshowState:!1,hoverTipshowTimeOut:null,createHoverTip:function(e,n){let t=this;$(e).on("mouseover",n,function(l){t.hoverTipshowState||(clearTimeout(t.hoverTipshowTimeOut),t.hoverTipshowTimeOut=setTimeout(function(){let o=$(l.currentTarget),a=o.offset(),s=$("#luckysheet-tooltip-up"),u=o.data("tips");if((u==null||u.length==0)&&(u=o.prev().data("tips"),u==null||u.length==0))return;s.length==0&&($("body").first().append(_0),s=$("#luckysheet-tooltip-up")),s.removeClass("jfk-tooltip-hide").find("div.jfk-tooltip-contentId").html(u);let f=s.outerWidth();s.find("div.jfk-tooltip-arrow").css("left",f/2);let m=a.left+(o.outerWidth()-f)/2;m<2&&(m=2,s.find("div.jfk-tooltip-arrow").css("left",o.outerWidth()/2)),s.css({top:a.top+o.outerHeight()+1,left:m})},300))}).on("mouseout",n,function(l){t.hoverTipshowState=!1,clearTimeout(t.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")}).on("click",n,function(l){t.hoverTipshowState=!0,clearTimeout(t.hoverTipshowTimeOut),$("#luckysheet-tooltip-up").addClass("jfk-tooltip-hide")})},popover:function(e,n,t,l,o,a){let s=Be(),u=s.button,f=s.paint;o==null&&(o=u.close);let m='<div id="luckysheetpopover" class="luckysheetpopover"><div class="luckysheetpopover-content">'+f.start+'</div><div class="luckysheetpopover-btn">'+o+"</div></div>";$("#luckysheetpopover").remove(),$("body").first().append(m),$("#luckysheetpopover .luckysheetpopover-content").html(e);let d=$("#luckysheetpopover").outerWidth(),p=$("#luckysheetpopover").outerHeight(),b={};n=="topLeft"?(b.top="20px",b.left="20px"):n=="topCenter"?(b.top="20px",b.left="50%",b["margin-left"]=-d/2):n=="topRight"?(b.top="20px",b.right="20px"):n=="midLeft"?(b.top="50%",b["margin-top"]=-p/2,b.left="20px"):n=="center"?(b.top="50%",b["margin-top"]=-p/2,b.left="50%",b["margin-left"]=-d/2):n=="midRight"?(b.top="50%",b["margin-top"]=-p/2,b.right="20px"):n=="bottomLeft"?(b.bottom="20px",b.left="20px"):n=="bottomCenter"?(b.bottom="20px",b.left="50%",b["margin-left"]=-d/2):n=="bottomRight"?(b.bottom="20px",b.right="20px"):(b.top="20px",b.left="50%",b["margin-left"]=-d/2),l=="white"&&(b.background="rgba(255, 255, 255, 0.65)",b.color="#000",$("#luckysheetpopover .luckysheetpopover-btn").css({border:"1px solid #000"})),setTimeout(function(){$("#luckysheetpopover .luckysheetpopover-content").css({"margin-left":-$("#luckysheetpopover .luckysheetpopover-btn").outerWidth()/2})},1),$("#luckysheetpopover").css(b).fadeIn(),$("#luckysheetpopover .luckysheetpopover-btn").click(function(){typeof a=="function"&&a()}),t!=null&&typeof t=="number"&&setTimeout(function(){$("#luckysheetpopover").fadeOut().remove(),typeof a=="function"&&a()},t)}},ke=a3});var import_plugin,Ih,s3,Mt,mo=Nt(()=>{import_plugin=qe(Ye());fr();Ol();Sr();cr();Kr();Ar();Er();ui();Rr();qr();jr();kn();Xl();hi();il();Ih=qe(Za()),s3={fileClone:[],editorRule:null,ruleTypeHtml:function(){let e=Be().conditionformat;return`<div class="ruleTypeBox">
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem1}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem2}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem3}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem4}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem5}</span>
                    </div>
                    <div class="ruleTypeItem">
                        <span class="icon iconfont luckysheet-iconfont-youjiantou"></span>
                        <span>${e.ruleTypeItem6}</span>
                    </div>
                </div>`},textCellColorHtml:function(){let e=Be().conditionformat;return`<div id="textCellColor">
                    <div class="colorbox">
                        <input id="checkTextColor" type="checkbox" checked="checked">
                        <label for="checkTextColor">${e.textColor}\uFF1A</label>
                        <input id="textcolorshow" data-tips="${e.textColor}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#9c0006" style="display: none;">
                    </div>
                    <div class="colorbox">
                        <input id="checkCellColor" type="checkbox" checked="checked">
                        <label for="checkCellColor">${e.cellColor}\uFF1A</label>
                        <input id="cellcolorshow" data-tips="${e.cellColor}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#ffc7ce" style="display: none;">
                    </div>
                </div>`},selectRange:[],selectStatus:!1,dataBarList:[{format:["#638ec6","#ffffff"]},{format:["#63c384","#ffffff"]},{format:["#ff555a","#ffffff"]},{format:["#ffb628","#ffffff"]},{format:["#008aef","#ffffff"]},{format:["#d6007b","#ffffff"]},{format:["#638ec6"]},{format:["#63c384"]},{format:["#ff555a"]},{format:["#ffb628"]},{format:["#008aef"]},{format:["#d6007b"]}],colorGradationList:[{format:["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(255, 235, 132)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(90, 138, 198)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(90, 138, 198)"]},{format:["rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)"]},{format:["rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(255, 235, 132)"]},{format:["rgb(255, 235, 132)","rgb(99, 190, 123)"]}],init:function(){let e=this,n=Be().conditionformat;$(document).off("change.CFchooseSheet").on("change.CFchooseSheet","#luckysheet-administerRule-dialog .chooseSheet",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();e.getConditionRuleList(t)}),$(document).off("click.CFadministerRuleItem").on("click.CFadministerRuleItem","#luckysheet-administerRule-dialog .ruleList .listBox .item",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.CFadministerRuleConfirm").on("click.CFadministerRuleConfirm","#luckysheet-administerRule-dialog-confirm",function(){if(!zo(h.currentSheetIndex))return;let t=$.extend(!0,[],h.luckysheetfile),l=e.getHistoryRules(t),o=$.extend(!0,[],e.fileClone);for(let u=0;u<o.length;u++){let f=o[u].index;h.luckysheetfile[Me(f)].luckysheet_conditionformat_save=o[Me(f)].luckysheet_conditionformat_save}let a=$.extend(!0,[],h.luckysheetfile),s=e.getCurrentRules(a);if(e.ref(l,s),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-administerRule-dialog").hide(),Ue.allowUpdate){let u=$.extend(!0,[],h.luckysheetfile);for(let f=0;f<u.length;f++)Ue.saveParam("all",u[f].index,u[f].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}}),$(document).off("click.CFadministerRuleClose").on("click.CFadministerRuleClose","#luckysheet-administerRule-dialog-close",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-administerRule-dialog").hide(),e.fileClone=[]}),$(document).off("click.CFadministerRuleFa").on("click.CFadministerRuleFa","#luckysheet-administerRule-dialog .item .fa-table",function(){$(this).parents("#luckysheet-administerRule-dialog").hide();let t=$("#luckysheet-administerRule-dialog .chooseSheet select option:selected").val();t!=h.currentSheetIndex&&kt.changeSheetExec(t);let l=$(this).siblings("input").val().trim(),o=$(this).parents(".item").attr("data-item");e.multiRangeDialog(o,l),e.selectRange=[];let a=e.getRangeByTxt(l);if(a.length>0)for(let s=0;s<a.length;s++){let u=a[s].row[0],f=a[s].row[1],m=a[s].column[0],d=a[s].column[1],p=h.visibledatarow[f],b=u-1==-1?0:h.visibledatarow[u-1],g=h.visibledatacolumn[d],v=m-1==-1?0:h.visibledatacolumn[m-1];e.selectRange.push({left:v,width:g-v-1,top:b,height:p-b-1,left_move:v,width_move:g-v-1,top_move:b,height_move:p-b-1,row:[u,f],column:[m,d],row_focus:u,column_focus:m})}gr(e.selectRange)}),$(document).off("click.CFmultiRangeConfirm").on("click.CFmultiRangeConfirm","#luckysheet-multiRange-dialog-confirm",function(){$(this).parents("#luckysheet-multiRange-dialog").hide();let t=$(this).attr("data-item"),l=$(this).parents("#luckysheet-multiRange-dialog").find("input").val();$("#luckysheet-administerRule-dialog .item[data-item="+t+"] input").val(l);let o=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();e.fileClone[Me(o)].luckysheet_conditionformat_save[t].cellrange=e.getRangeByTxt(l),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),gr([])}),$(document).off("click.CFmultiRangeClose").on("click.CFmultiRangeClose","#luckysheet-multiRange-dialog-close",function(){$(this).parents("#luckysheet-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),gr([])}),$(document).off("click.CFnewConditionRule").on("click.CFnewConditionRule","#newConditionRule",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(!!zo(t)){if(h.luckysheet_select_save.length==0){at()?alert(n.pleaseSelectRange):ke.info(n.pleaseSelectRange,"");return}e.newConditionRuleDialog(1)}}),$(document).off("click.CFnewConditionRuleConfirm").on("click.CFnewConditionRuleConfirm","#luckysheet-newConditionRule-dialog-confirm",function(){if(!zo(h.currentSheetIndex))return;let t=$("#luckysheet-newConditionRule-dialog .ruleTypeItem.on").index(),l=$("#luckysheet-newConditionRule-dialog #type1 option:selected").val(),o=$("#luckysheet-newConditionRule-dialog ."+l+"Box #type2 option:selected").val(),a,s;if(t==0){if(l=="dataBar"){let f=$(this).parents("#luckysheet-newConditionRule-dialog").find(".dataBarBox .luckysheet-conditionformat-config-color").spectrum("get").toHexString();o=="gradient"?a=[f,"#ffffff"]:o=="solid"&&(a=[f]),s={type:"dataBar",cellrange:$.extend(!0,[],h.luckysheet_select_save),format:a}}else if(l=="colorGradation"){let f=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),m=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),d=$(this).parents("#luckysheet-newConditionRule-dialog").find(".colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString();o=="threeColor"?a=[f,m,d]:o=="twoColor"&&(a=[f,d]),s={type:"colorGradation",cellrange:$.extend(!0,[],h.luckysheet_select_save),format:a}}else if(l=="icons"){let f=$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-len"),m=$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),d=$(this).parents("#luckysheet-newConditionRule-dialog").find(".iconsBox .model").attr("data-top");a={len:f,leftMin:m,top:d},s={type:"icons",cellrange:$.extend(!0,[],h.luckysheet_select_save),format:a}}}else{let f="",m=[],d=[];if(t==1){if(l=="number")if(f=o,o=="betweenness"){let g=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),v=$("#luckysheet-newConditionRule-dialog #conditionVal2 input").val().trim(),x=e.getRangeByTxt(g);if(x.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(x.length==1){let S=x[0].row[0],I=x[0].row[1],P=x[0].column[0],F=x[0].column[1];if(S==I&&P==F)g=Vt(S,P,h.flowdata),m.push({row:x[0].row,column:x[0].column}),d.push(g);else{e.infoDialog(n.onlySingleCell,"");return}}else if(x.length==0)if(isNaN(g)||g==""){e.infoDialog(n.conditionValueCanOnly,"");return}else d.push(g);let _=e.getRangeByTxt(v);if(_.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(_.length==1){let S=_[0].row[0],I=_[0].row[1],P=_[0].column[0],F=_[0].column[1];if(S==I&&P==F)v=Vt(S,P,h.flowdata),m.push({row:_[0].row,column:_[0].column}),d.push(v);else{e.infoDialog(n.onlySingleCell,"");return}}else if(_.length==0)if(isNaN(v)||v==""){e.infoDialog(n.conditionValueCanOnly,"");return}else d.push(v)}else{let g=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),v=e.getRangeByTxt(g);if(v.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(v.length==1){let x=v[0].row[0],_=v[0].row[1],S=v[0].column[0],I=v[0].column[1];if(x==_&&S==I)g=Vt(x,S,h.flowdata),m.push({row:v[0].row,column:v[0].column}),d.push(g);else{e.infoDialog(n.onlySingleCell,"");return}}else if(v.length==0)if(isNaN(g)||g==""){e.infoDialog(n.conditionValueCanOnly,"");return}else d.push(g)}else if(l=="text"){f="textContains";let g=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim(),v=e.getRangeByTxt(g);if(v.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(v.length==1){let x=v[0].row[0],_=v[0].row[1],S=v[0].column[0],I=v[0].column[1];if(x==_&&S==I)g=Vt(x,S,h.flowdata),m.push({row:v[0].row,column:v[0].column}),d.push(g);else{e.infoDialog(n.onlySingleCell,"");return}}else if(v.length==0)if(g==""){e.infoDialog(n.conditionValueCanOnly,"");return}else d.push(g)}else if(l=="date"){f="occurrenceDate";let g=$("#luckysheet-newConditionRule-dialog #daterange-btn").val();if(g==""||g==null){e.infoDialog(n.pleaseSelectADate,"");return}d.push(g)}}else if(t==2){l=="top"?$("#luckysheet-newConditionRule-dialog #isPercent").is(":selected")?f="top10%":f="top10":l=="last"&&($("#luckysheet-newConditionRule-dialog #isPercent").is(":selected")?f="last10%":f="last10");let g=$("#luckysheet-newConditionRule-dialog #conditionVal input").val().trim();if(parseInt(g)!=g||parseInt(g)<1||parseInt(g)>1e3){e.infoDialog(n.pleaseEnterInteger,"");return}d.push(parseInt(g))}else if(t==3)l=="AboveAverage"?(f="AboveAverage",d.push("AboveAverage")):l=="SubAverage"&&(f="SubAverage",d.push("SubAverage"));else if(t==4)f="duplicateValue",d.push(l);else if(t==5){f="formula";let g=$("#luckysheet-newConditionRule-dialog #formulaConditionVal input").val().trim();if(g==""){e.infoDialog("Condition value cannot be empty!","");return}d.push(g)}let p;$("#luckysheet-newConditionRule-dialog #checkTextColor").is(":checked")?p=$("#luckysheet-newConditionRule-dialog #textcolorshow").spectrum("get").toHexString():p=null;let b;$("#luckysheet-newConditionRule-dialog #checkCellColor").is(":checked")?b=$("#luckysheet-newConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():b=null,a={textColor:p,cellColor:b},s={type:"default",cellrange:$.extend(!0,[],h.luckysheet_select_save),format:a,conditionName:f,conditionRange:m,conditionValue:d}}$("#luckysheet-newConditionRule-dialog").hide();let u=$(this).attr("data-source");if(u==0){$("#luckysheet-modal-dialog-mask").hide();let f=$.extend(!0,[],h.luckysheetfile),m=e.getHistoryRules(f),d=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save==null?[]:h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save;d.push(s),h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save=d;let p=$.extend(!0,[],h.luckysheetfile),b=e.getCurrentRules(p);e.ref(m,b),Ue.allowUpdate&&Ue.saveParam("all",h.currentSheetIndex,d,{k:"luckysheet_conditionformat_save"})}else if(u==1){let f=e.fileClone[Me(h.currentSheetIndex)].luckysheet_conditionformat_save?e.fileClone[Me(h.currentSheetIndex)].luckysheet_conditionformat_save:[];f.push(s),e.fileClone[Me(h.currentSheetIndex)].luckysheet_conditionformat_save=f,e.administerRuleDialog()}}),$(document).off("click.CFnewConditionRuleClose").on("click.CFnewConditionRuleClose","#luckysheet-newConditionRule-dialog-close",function(){let t=$(this).attr("data-source");t==0&&$("#luckysheet-modal-dialog-mask").hide(),t==1&&$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-newConditionRule-dialog").hide(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()}),$(document).off("click.CFeditorConditionRule").on("click.CFeditorConditionRule","#editorConditionRule",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(!zo(t))return;let l=$("#luckysheet-administerRule-dialog .ruleList .listBox .item.on").attr("data-item"),o={sheetIndex:t,itemIndex:l,data:e.fileClone[Me(t)].luckysheet_conditionformat_save[l]};e.editorRule=o,e.editorConditionRuleDialog()}),$(document).off("click.CFeditorConditionRuleConfirm").on("click.CFeditorConditionRuleConfirm","#luckysheet-editorConditionRule-dialog-confirm",function(){let t=$("#luckysheet-editorConditionRule-dialog .ruleTypeItem.on").index(),l=$("#luckysheet-editorConditionRule-dialog #type1 option:selected").val(),o=$("#luckysheet-editorConditionRule-dialog ."+l+"Box #type2 option:selected").val(),a=e.editorRule.data.cellrange,s,u;if(t==0){if(l=="dataBar"){let d=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".dataBarBox .luckysheet-conditionformat-config-color").spectrum("get").toHexString();o=="gradient"?s=[d,"#ffffff"]:o=="solid"&&(s=[d]),u={type:"dataBar",cellrange:a,format:s}}else if(l=="colorGradation"){let d=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),p=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString(),b=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("get").toRgbString();o=="threeColor"?s=[d,p,b]:o=="twoColor"&&(s=[d,b]),u={type:"colorGradation",cellrange:a,format:s}}else if(l=="icons"){let d=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-len"),p=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),b=$(this).parents("#luckysheet-editorConditionRule-dialog").find(".iconsBox .model").attr("data-top");s={len:d,leftMin:p,top:b},u={type:"icons",cellrange:a,format:s}}}else{let d="",p=[],b=[];if(t==1){if(l=="number")if(d=o,o=="betweenness"){let x=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),_=$("#luckysheet-editorConditionRule-dialog #conditionVal2 input").val().trim(),S=e.getRangeByTxt(x);if(S.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(S.length==1){let P=S[0].row[0],F=S[0].row[1],D=S[0].column[0],k=S[0].column[1];if(P==F&&D==k)x=Vt(P,D,h.flowdata),p.push({row:S[0].row,column:S[0].column}),b.push(x);else{e.infoDialog(n.onlySingleCell,"");return}}else if(S.length==0)if(isNaN(x)||x==""){e.infoDialog(n.conditionValueCanOnly,"");return}else b.push(x);let I=e.getRangeByTxt(_);if(I.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(I.length==1){let P=I[0].row[0],F=I[0].row[1],D=I[0].column[0],k=I[0].column[1];if(P==F&&D==k)_=Vt(P,D,h.flowdata),p.push({row:I[0].row,column:I[0].column}),b.push(_);else{e.infoDialog(n.onlySingleCell,"");return}}else if(I.length==0)if(isNaN(_)||_==""){e.infoDialog(n.conditionValueCanOnly,"");return}else b.push(_)}else{let x=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),_=e.getRangeByTxt(x);if(_.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(_.length==1){let S=_[0].row[0],I=_[0].row[1],P=_[0].column[0],F=_[0].column[1];if(S==I&&P==F)x=Vt(S,P,h.flowdata),p.push({row:_[0].row,column:_[0].column}),b.push(x);else{e.infoDialog(n.onlySingleCell,"");return}}else if(_.length==0)if(isNaN(x)||x==""){e.infoDialog(n.conditionValueCanOnly,"");return}else b.push(x)}else if(l=="text"){d="textContains";let x=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim(),_=e.getRangeByTxt(x);if(_.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(_.length==1){let S=_[0].row[0],I=_[0].row[1],P=_[0].column[0],F=_[0].column[1];if(S==I&&P==F)x=Vt(S,P,h.flowdata),p.push({row:_[0].row,column:_[0].column}),b.push(x);else{e.infoDialog(n.onlySingleCell,"");return}}else if(_.length==0)if(isNaN(x)||x==""){e.infoDialog(n.conditionValueCanOnly,"");return}else b.push(x)}else if(l=="date"){d="occurrenceDate";let x=$("#luckysheet-editorConditionRule-dialog #daterange-btn").val();if(x==""||x==null){e.infoDialog(n.pleaseSelectADate,"");return}b.push(x)}}else if(t==2){l=="top"?$("#luckysheet-editorConditionRule-dialog #isPercent").is(":selected")?d="top10%":d="top10":l=="last"&&($("#luckysheet-editorConditionRule-dialog #isPercent").is(":selected")?d="last10%":d="last10");let x=$("#luckysheet-editorConditionRule-dialog #conditionVal input").val().trim();if(parseInt(x)!=x||parseInt(x)<1||parseInt(x)>1e3){e.infoDialog(n.pleaseEnterInteger,"");return}b.push(x)}else if(t==3)l=="AboveAverage"?(d="AboveAverage",b.push("AboveAverage")):l=="SubAverage"&&(d="SubAverage",b.push("SubAverage"));else if(t==4)d="duplicateValue",b.push(l);else if(t==5){d="formula";let x=$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val().trim();if(console.log(x),x==""){e.infoDialog("Condition value cannot be empty!","");return}b.push(x)}let g;$("#luckysheet-editorConditionRule-dialog #checkTextColor").is(":checked")?g=$("#luckysheet-editorConditionRule-dialog #textcolorshow").spectrum("get").toHexString():g=null;let v;$("#luckysheet-editorConditionRule-dialog #checkCellColor").is(":checked")?v=$("#luckysheet-editorConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():v=null,s={textColor:g,cellColor:v},u={type:"default",cellrange:a,format:s,conditionName:d,conditionRange:p,conditionValue:b}}let f=e.editorRule.sheetIndex,m=e.editorRule.itemIndex;e.fileClone[Me(f)].luckysheet_conditionformat_save[m]=u,$("#luckysheet-editorConditionRule-dialog").hide(),e.administerRuleDialog()}),$(document).off("click.CFeditorConditionRuleClose").on("click.CFeditorConditionRuleClose","#luckysheet-editorConditionRule-dialog-close",function(){$("#luckysheet-editorConditionRule-dialog").hide(),$("#luckysheet-administerRule-dialog").show(),$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide()}),$(document).off("click.CFnewEditorRuleItem").on("click.CFnewEditorRuleItem",".luckysheet-newEditorRule-dialog .ruleTypeItem",function(){$(this).addClass("on").siblings().removeClass("on");let t=$(this).index();$(this).parents(".luckysheet-newEditorRule-dialog").find(".ruleExplainBox").html(e.getRuleExplain(t)),e.colorSelectInit()}),$(document).off("change.CFnewEditorRuleType1").on("change.CFnewEditorRuleType1",".luckysheet-newEditorRule-dialog #type1",function(){let t=$(this).find("option:selected").val();(t=="dataBar"||t=="colorGradation"||t=="icons"||t=="number"||t=="text"||t=="date")&&$(this).parents(".luckysheet-newEditorRule-dialog").find("."+t+"Box").show().siblings().hide(),t=="date"&&e.daterangeInit($(this).parents(".luckysheet-newEditorRule-dialog").attr("id"))}),$(document).off("change.CFnewEditorRuleType2").on("change.CFnewEditorRuleType2",".luckysheet-newEditorRule-dialog #type2",function(){let t=$(this).parents(".luckysheet-newEditorRule-dialog").find("#type1 option:selected").val();t=="colorGradation"?$(this).find("option:selected").val()=="threeColor"?$(this).parents(".luckysheet-newEditorRule-dialog").find(".midVal").show():$(this).parents(".luckysheet-newEditorRule-dialog").find(".midVal").hide():t=="number"&&($(this).find("option:selected").val()=="betweenness"?($(this).parents(".luckysheet-newEditorRule-dialog").find(".txt").show(),$(this).parents(".luckysheet-newEditorRule-dialog").find("#conditionVal2").show()):($(this).parents(".luckysheet-newEditorRule-dialog").find(".txt").hide(),$(this).parents(".luckysheet-newEditorRule-dialog").find("#conditionVal2").hide()))}),$(document).off("click.CFiconsShowbox").on("click.CFiconsShowbox",".luckysheet-newEditorRule-dialog .iconsBox .showbox",function(){$(this).parents(".iconsBox").find("ul").toggle()}),$(document).off("click.CFiconsLi").on("click.CFiconsLi",".luckysheet-newEditorRule-dialog .iconsBox li",function(){let t=$(this).find("div").attr("data-len"),l=$(this).find("div").attr("data-leftmin"),o=$(this).find("div").attr("data-top"),a=$(this).find("div").attr("title"),s=$(this).find("div").css("background-position");$(this).parents(".iconsBox").find(".showbox .model").css("background-position",s),$(this).parents(".iconsBox").find(".showbox .model").attr("data-len",t),$(this).parents(".iconsBox").find(".showbox .model").attr("data-leftmin",l),$(this).parents(".iconsBox").find(".showbox .model").attr("data-top",o),$(this).parents(".iconsBox").find(".showbox .model").attr("title",a),$(this).parents("ul").hide()}),$(document).off("click.CFdeleteConditionRule").on("click.CFdeleteConditionRule","#deleteConditionRule",function(){let t=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();if(!zo(t))return;let l=$("#luckysheet-administerRule-dialog .ruleList .listBox .item.on").attr("data-item");e.fileClone[Me(t)].luckysheet_conditionformat_save.splice(l,1),e.administerRuleDialog()}),$(document).off("click.CFdefault").on("click.CFdefault","#luckysheet-conditionformat-dialog-confirm",function(){if(!zo(h.currentSheetIndex))return;let t=$("#luckysheet-conditionformat-dialog .box").attr("data-itemvalue"),l=[],o=[];if(t=="greaterThan"||t=="lessThan"||t=="equal"||t=="textContains"){let g=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim(),v=e.getRangeByTxt(g);if(v.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(v.length==1){let x=v[0].row[0],_=v[0].row[1],S=v[0].column[0],I=v[0].column[1];if(x==_&&S==I)g=Vt(x,S,h.flowdata),l.push({row:v[0].row,column:v[0].column}),o.push(g);else{e.infoDialog(n.onlySingleCell,"");return}}else if(v.length==0)if(isNaN(g)||g==""){e.infoDialog(n.conditionValueCanOnly,"");return}else o.push(g)}else if(t=="betweenness"){let g=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim(),v=$("#luckysheet-conditionformat-dialog #conditionVal2").val().trim(),x=e.getRangeByTxt(g);if(x.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(x.length==1){let S=x[0].row[0],I=x[0].row[1],P=x[0].column[0],F=x[0].column[1];if(S==I&&P==F)g=Vt(S,P,h.flowdata),l.push({row:x[0].row,column:x[0].column}),o.push(g);else{e.infoDialog(n.onlySingleCell,"");return}}else if(x.length==0)if(isNaN(g)||g==""){e.infoDialog(n.conditionValueCanOnly,"");return}else o.push(g);let _=e.getRangeByTxt(v);if(_.length>1){e.infoDialog(n.onlySingleCell,"");return}else if(_.length==1){let S=_[0].row[0],I=_[0].row[1],P=_[0].column[0],F=_[0].column[1];if(S==I&&P==F)v=Vt(S,P,h.flowdata),l.push({row:_[0].row,column:_[0].column}),o.push(v);else{e.infoDialog(n.onlySingleCell,"");return}}else if(_.length==0)if(isNaN(v)||v==""){e.infoDialog(n.conditionValueCanOnly,"");return}else o.push(v)}else if(t=="occurrenceDate"){let g=$("#luckysheet-conditionformat-dialog #daterange-btn").val();if(g==""||g==null){e.infoDialog(n.pleaseSelectADate,"");return}o.push(g)}else if(t=="duplicateValue")o.push($("#luckysheet-conditionformat-dialog #conditionVal option:selected").val());else if(t=="top10"||t=="top10%"||t=="last10"||t=="last10%"){let g=$("#luckysheet-conditionformat-dialog #conditionVal").val().trim();if(parseInt(g)!=g||parseInt(g)<1||parseInt(g)>1e3){e.infoDialog(n.pleaseEnterInteger,"");return}o.push(g)}else t=="AboveAverage"?o.push("AboveAverage"):t=="SubAverage"&&o.push("SubAverage");let a;$("#checkTextColor").is(":checked")?a=$("#textcolorshow").spectrum("get").toHexString():a=null;let s;$("#checkCellColor").is(":checked")?s=$("#cellcolorshow").spectrum("get").toHexString():s=null;let u=$.extend(!0,[],h.luckysheetfile),f=e.getHistoryRules(u),m={type:"default",cellrange:$.extend(!0,[],h.luckysheet_select_save),format:{textColor:a,cellColor:s},conditionName:t,conditionRange:l,conditionValue:o},d=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save==null?[]:h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save;d.push(m),h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save=d;let p=$.extend(!0,[],h.luckysheetfile),b=e.getCurrentRules(p);e.ref(f,b),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-conditionformat-dialog").hide(),Ue.allowUpdate&&Ue.saveParam("all",h.currentSheetIndex,d,{k:"luckysheet_conditionformat_save"})}),$(document).off("click.CFicons").on("click.CFicons","#luckysheet-CFicons-dialog .item",function(){if($("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-CFicons-dialog").hide(),h.luckysheet_select_save.length>0){let t=$.extend(!0,[],h.luckysheet_select_save),l={len:$(this).attr("data-len"),leftMin:$(this).attr("data-leftMin"),top:$(this).attr("data-top")};e.updateItem("icons",t,l)}}),$(document).on("click",".range .fa-table",function(){let t=$(this).parents(".luckysheet-modal-dialog").attr("id");$("#"+t).hide();let l;if(t=="luckysheet-conditionformat-dialog")$(this).siblings("input").attr("id")=="conditionVal"?l="0_1":l="0_2";else if(t=="luckysheet-newConditionRule-dialog"){let a=$(this).parents(".range").attr("id");a=="formulaConditionVal"?l="1_0":a=="conditionVal"?l="1_1":l="1_2"}else if(t=="luckysheet-editorConditionRule-dialog"){let a=$(this).parents(".range").attr("id");a=="formulaConditionVal"?l="2_0":a=="conditionVal"?l="2_1":l="2_2"}let o=$(this).siblings("input").val();e.singleRangeDialog(l,o),gr(e.getRangeByTxt(o))}),$(document).on("click","#luckysheet-singleRange-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").show(),$(this).parents("#luckysheet-singleRange-dialog").hide();let t=$(this).attr("data-source"),l=$(this).parents("#luckysheet-singleRange-dialog").find("input").val();t=="0_1"?($("#luckysheet-conditionformat-dialog").show(),$("#luckysheet-conditionformat-dialog #conditionVal").val(l)):t=="0_2"?($("#luckysheet-conditionformat-dialog").show(),$("#luckysheet-conditionformat-dialog #conditionVal2").val(l)):t=="1_0"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #formulaConditionVal input").val(l)):t=="1_1"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #conditionVal input").val(l)):t=="1_2"?($("#luckysheet-newConditionRule-dialog").show(),$("#luckysheet-newConditionRule-dialog #conditionVal2 input").val(l)):t=="2_0"?($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val(l)):t=="2_1"?($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #conditionVal input").val(l)):t=="2_2"&&($("#luckysheet-editorConditionRule-dialog").show(),$("#luckysheet-editorConditionRule-dialog #conditionVal2 input").val(l)),gr([])}),$(document).on("click","#luckysheet-singleRange-dialog-close",function(){$("#luckysheet-modal-dialog-mask").show(),$(this).parents("#luckysheet-singleRange-dialog").hide();let t=$(this).attr("data-source");t=="0_1"||t=="0_2"?$("#luckysheet-conditionformat-dialog").show():t=="1_0"||t=="1_1"||t=="1_2"?$("#luckysheet-newConditionRule-dialog").show():(t=="2_0"||t=="2_1"||t=="2_2")&&$("#luckysheet-editorConditionRule-dialog").show(),gr([])}),$(document).on("click",".luckysheet-modal-dialog-title-close",function(){let t=$(this).parents(".luckysheet-modal-dialog").attr("id");if(t=="luckysheet-newConditionRule-dialog"&&$("#"+t).find("#luckysheet-newConditionRule-dialog-close").attr("data-source")==1&&$("#luckysheet-administerRule-dialog").show(),t=="luckysheet-editorConditionRule-dialog"&&$("#luckysheet-administerRule-dialog").show(),t=="luckysheet-singleRange-dialog"){$("#luckysheet-modal-dialog-mask").show();let l=$(this).parents("#luckysheet-singleRange-dialog").find("#luckysheet-singleRange-dialog-confirm").attr("data-source");l=="0_1"||l=="0_2"?$("#luckysheet-conditionformat-dialog").show():l=="1_1"||l=="1_2"?$("#luckysheet-newConditionRule-dialog").show():(l=="2_1"||l=="2_2")&&$("#luckysheet-editorConditionRule-dialog").show(),gr([])}t=="luckysheet-multiRange-dialog"&&($("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").show(),gr([])),t=="luckysheet-conditionformat-info-dialog"&&$("#luckysheet-modal-dialog-mask").show()}),$(document).on("click","#luckysheet-conditionformat-info-dialog-close",function(){$(this).parents("#luckysheet-conditionformat-info-dialog").hide()})},singleRangeDialog:function(e,n){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-singleRange-dialog").remove();let t=Be().conditionformat;$("body").first().append(Tt(Ll,{id:"luckysheet-singleRange-dialog",addclass:"luckysheet-singleRange-dialog",title:t.selectCell,content:`<input readonly="readonly" placeholder="${t.pleaseSelectCell}" value="${n}"/>`,botton:`<button id="luckysheet-singleRange-dialog-confirm" class="btn btn-primary" data-source="${e}">${t.confirm}</button>
                        <button id="luckysheet-singleRange-dialog-close" class="btn btn-default" data-source="${e}">${t.cancel}</button>`,style:"z-index:100003"}));let l=$("#luckysheet-singleRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),f=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-singleRange-dialog").css({left:(s+f-a)/2,top:(u+m-o)/3}).show()},multiRangeDialog:function(e,n){let t=this;$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-multiRange-dialog").remove();let l=Be().conditionformat;$("body").first().append(Tt(Ll,{id:"luckysheet-multiRange-dialog",addclass:"luckysheet-multiRange-dialog",title:l.selectRange,content:`<input readonly="readonly" placeholder="${l.pleaseSelectRange}" value="${n}"/>`,botton:`<button id="luckysheet-multiRange-dialog-confirm" class="btn btn-primary" data-item="${e}">${l.confirm}</button>
                        <button id="luckysheet-multiRange-dialog-close" class="btn btn-default">${l.cancel}</button>`,style:"z-index:100003"}));let o=$("#luckysheet-multiRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-multiRange-dialog").css({left:(u+m-s)/2,top:(f+d-a)/3}).show(),gr(t.getRangeByTxt(n))},getTxtByRange:function(e){if(e.length>0){let n=[];for(let t=0;t<e.length;t++){let l=e[t].row[0],o=e[t].row[1],a=e[t].column[0],s=e[t].column[1];n.push(Kl(h.currentSheetIndex,{row:[l,o],column:[a,s]},h.currentSheetIndex))}return n.join(",")}},getRangeByTxt:function(e){let n=[];if(e=e.toString(),e.indexOf(",")!=-1){let t=e.split(",");for(let l=0;l<t.length;l++)if(y.iscelldata(t[l]))n.push(y.getcellrange(t[l]));else{n=[];break}}else y.iscelldata(e)&&n.push(y.getcellrange(e));return n},colorSelectInit:function(){let e=Be().conditionformat;$(".luckysheet-conditionformat-config-color").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:e.cancel,chooseText:e.confirmColor,togglePaletteMoreText:"\u81EA\u5B9A\u4E49",togglePaletteLessText:"\u6536\u8D77",togglePaletteOnly:!0,clearText:e.clearColorSelect,noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",localStorageKey:"spectrum.textcolor"+Ue.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(n){n!=null&&(n=n.toHexString())}})},conditionformatDialog:function(e,n){let t=this;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-conditionformat-dialog").remove();let l=Be().conditionformat;$("body").first().append(Tt(Ll,{id:"luckysheet-conditionformat-dialog",addclass:"luckysheet-conditionformat-dialog",title:e,content:n,botton:`<button id="luckysheet-conditionformat-dialog-confirm" class="btn btn-primary">${l.confirm}</button>
                        <button class="btn btn-default luckysheet-model-close-btn">${l.cancel}</button>`,style:"z-index:9999"}));let o=$("#luckysheet-conditionformat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-conditionformat-dialog").css({left:(u+m-s)/2,top:(f+d-a)/3}).show(),t.init(),t.colorSelectInit(),e==Be().conditionformat.conditionformat_occurrenceDate&&t.daterangeInit("luckysheet-conditionformat-dialog")},CFiconsDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-CFicons-dialog").remove();let e=Be().conditionformat,n=`<div class="box">
                            <div style="margin-bottom: 10px;">${e.pleaseSelectIcon}</div>
                            <div class="title">${e.direction}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="0" title="${e.threeWayArrow}(${e.multicolor})"><div style="background-position:0 0;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="1" title="${e.threeTriangles}"><div style="background-position:0 -20px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="0" data-top="2" title="${e.fourWayArrow}(${e.multicolor})"><div style="background-position:0 -40px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="3" title="${e.fiveWayArrow}(${e.multicolor})"><div style="background-position:0 -60px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="0" title="${e.threeWayArrow}(${e.grayColor})"><div style="background-position:-131px 0;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="5" data-top="1" title="${e.fourWayArrow}(${e.grayColor})"><div style="background-position:-131px -20px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="5" data-top="2" title="${e.fiveWayArrow}(${e.grayColor})"><div style="background-position:-131px -40px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">${e.shape}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="4" title="${e.threeColorTrafficLight}(${e.rimless})"><div style="background-position:0 -80px;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="5" title="${e.threeSigns}"><div style="background-position:0 -100px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="0" data-top="6" title="${e.greenRedBlackGradient}"><div style="background-position:0 -120px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="4" title="${e.threeColorTrafficLight}(${e.bordered})"><div style="background-position:-131px -80px;"></div></div>
                                    <div class="item" data-len="4" data-leftMin="5" data-top="5" title="${e.fourColorTrafficLight}"><div style="background-position:-131px -100px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">${e.mark}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="7" title="${e.threeSymbols}(${e.circled})"><div style="background-position:0 -140px;"></div></div>
                                    <div class="item" data-len="3" data-leftMin="0" data-top="8" title="${e.tricolorFlag}"><div style="background-position:0 -160px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="3" data-leftMin="5" data-top="7" title="${e.threeSymbols}(${e.noCircle})"><div style="background-position:-131px -140px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                            <div class="title">${e.grade}</div>
                            <div class="list">
                                <div class="left">
                                    <div class="item" data-len="3" data-leftMin="0" data-top="9" title="${e.threeStars}"><div style="background-position:0 -180px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="10" title="${e.fiveQuadrantDiagram}"><div style="background-position:0 -200px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="0" data-top="11" title="${e.fiveBoxes}"><div style="background-position:0 -220px;"></div></div>
                                </div>
                                <div class="right">
                                    <div class="item" data-len="4" data-leftMin="5" data-top="9" title="${e.grade4}"><div style="background-position:-131px -180px;"></div></div>
                                    <div class="item" data-len="5" data-leftMin="5" data-top="10" title="${e.grade5}"><div style="background-position:-131px -200px;"></div></div>
                                </div>
                                <div style="clear:both;"></div>
                            </div>
                        </div>`;$("body").first().append(Tt(Ll,{id:"luckysheet-CFicons-dialog",addclass:"luckysheet-CFicons-dialog",title:e.icons,content:n,botton:`<button class="btn btn-default luckysheet-model-close-btn">${e.close}</button>`,style:"z-index:100003"}));let t=$("#luckysheet-CFicons-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),l=t.outerHeight(),o=t.outerWidth(),a=$(window).width(),s=$(window).height(),u=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-CFicons-dialog").css({left:(a+u-o)/2,top:(s+f-l)/3}).show()},administerRuleDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").remove();let e=Be().conditionformat,n="";for(let p=0;p<h.luckysheetfile.length;p++)h.luckysheetfile[p].status=="1"?n+=`<option value="${h.luckysheetfile[p].index}" selected="selected">
                                ${e.currentSheet}\uFF1A${h.luckysheetfile[p].name}
                            </option>`:n+=`<option value="${h.luckysheetfile[p].index}">
                                ${e.sheet}\uFF1A${h.luckysheetfile[p].name}
                            </option>`;let t=`<div class="chooseSheet">
                            <label>${e.showRules}\uFF1A</label>
                            <select>${n}</select>
                        </div>
                        <div class="ruleBox">
                            <div class="ruleBtn">
                                <button id="newConditionRule" class="btn btn-default">${e.newRule}</button>
                                <button id="editorConditionRule" class="btn btn-default">${e.editRule}</button>
                                <button id="deleteConditionRule" class="btn btn-default">${e.deleteRule}</button>
                            </div>
                            <div class="ruleList">
                                <div class="listTitle">
                                    <span>${e.rule}</span>
                                    <span>${e.format}</span>
                                    <span>${e.applyRange}</span>
                                </div>
                                <div class="listBox"></div>
                            </div>
                        </div>`;$("body").first().append(Tt(Ll,{id:"luckysheet-administerRule-dialog",addclass:"luckysheet-administerRule-dialog",title:e.conditionformatManageRules,content:t,botton:`<button id="luckysheet-administerRule-dialog-confirm" class="btn btn-primary">${e.confirm}</button>
                        <button id="luckysheet-administerRule-dialog-close" class="btn btn-default">${e.close}</button>`,style:"z-index:100003"}));let l=$("#luckysheet-administerRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),f=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-administerRule-dialog").css({left:(s+f-a)/2,top:(u+m-o)/3}).show();let d=$("#luckysheet-administerRule-dialog .chooseSheet option:selected").val();this.getConditionRuleList(d)},getConditionRuleList:function(e){let n=this;$("#luckysheet-administerRule-dialog .ruleList .listBox").empty();let t=n.fileClone[Me(e)].luckysheet_conditionformat_save;if(t!=null&&t.length>0){let l=Be().conditionformat;for(let o=0;o<t.length;o++){let a=t[o].type,s=t[o].format,u=t[o].cellrange,f,m="";a=="dataBar"?(f=l.dataBar,m='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):a=="colorGradation"?(f=l.colorGradation,m='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):a=="icons"?(f=l.icons,m='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):(f=n.getConditionRuleName(t[o].conditionName,t[o].conditionRange,t[o].conditionValue),s.textColor!=null&&(m+='<span class="colorbox" title="'+l.textColor+'" style="background-color:'+s.textColor+'"></span>'),s.cellColor!=null&&(m+='<span class="colorbox" title="'+l.cellColor+'" style="background-color:'+s.cellColor+'"></span>'));let d=[];for(let b=0;b<u.length;b++){let g=u[b].row[0],v=u[b].row[1],x=u[b].column[0],_=u[b].column[1];d.push(yl(x)+(g+1)+":"+yl(_)+(v+1))}let p='<div class="item" data-item="'+o+'"><div class="ruleName" title="'+f+'">'+f+'</div><div class="format">'+m+'</div><div class="ruleRange"><input class="formulaInputFocus" readonly="true" value="'+d.join(",")+'"/><i class="fa fa-table" aria-hidden="true" title="'+l.selectRange+'"></i></div></div>';$("#luckysheet-administerRule-dialog .ruleList .listBox").prepend(p)}$("#luckysheet-administerRule-dialog .ruleList .listBox .item canvas").each(function(o){let a=$(this).closest(".item").attr("data-item"),s=t[a].type,u=t[a].format,f=$(this).get(0).getContext("2d");if(s=="dataBar")if(u.length==2){let m=f.createLinearGradient(0,0,46,0);m.addColorStop(0,u[0]),m.addColorStop(1,u[1]),f.fillStyle=m,f.fillRect(0,0,46,18),f.beginPath(),f.moveTo(0,0),f.lineTo(0,18),f.lineTo(46,18),f.lineTo(46,0),f.lineTo(0,0),f.lineWidth=h.devicePixelRatio,f.strokeStyle=u[0],f.stroke(),f.closePath()}else u.length==1&&(f.fillStyle=u[0],f.fillRect(0,0,46,18),f.beginPath(),f.moveTo(0,0),f.lineTo(0,18),f.lineTo(46,18),f.lineTo(46,0),f.lineTo(0,0),f.lineWidth=h.devicePixelRatio,f.strokeStyle=u[0],f.stroke(),f.closePath());else if(s=="colorGradation"){let m=f.createLinearGradient(0,0,46,0);u.length==3?(m.addColorStop(0,u[0]),m.addColorStop(.5,u[1]),m.addColorStop(1,u[2])):u.length==2&&(m.addColorStop(0,u[0]),m.addColorStop(1,u[1])),f.fillStyle=m,f.fillRect(0,0,46,18)}else if(s=="icons"){let m=u.len,d=u.leftMin,p=u.top,b=32*m+10*(m-1),g=32,v=46,x=46*32/b;d=="0"?f.drawImage(zc,0,p*32,b,g,0,(18-x)/2,v,x):d=="5"&&f.drawImage(zc,210,p*32,b,g,0,(18-x)/2,v,x)}}),$("#luckysheet-administerRule-dialog .ruleList .listBox .item").eq(0).addClass("on")}},getConditionRuleName:function(e,n,t){let l;n[0]!=null?l=yl(n[0].column[0])+(n[0].row[0]+1):l=t[0];let o=Be().conditionformat;if(e=="greaterThan")return o.cellValue+" > "+l;if(e=="lessThan")return o.cellValue+" < "+l;if(e=="betweenness"){let a;return n[1]!=null?a=yl(n[1].column[0])+(n[1].row[0]+1):a=t[1],o.cellValue+" "+o.between+" "+l+" "+o.in+" "+a+" "+o.between2}else{if(e=="equal")return o.cellValue+" = "+l;if(e=="textContains")return o.cellValue+o.contain+" ="+l;if(e=="occurrenceDate")return t;if(e=="duplicateValue"){if(t=="0")return o.duplicateValue;if(t=="1")return o.uniqueValue}else{if(e=="top10")return o.top+" "+l+" "+o.oneself;if(e=="top10%")return o.top+" "+l+"% "+o.oneself;if(e=="last10")return o.last+" "+l+" "+o.oneself;if(e=="last10%")return o.last+" "+l+"% "+o.oneself;if(e=="AboveAverage")return o.aboveAverage;if(e=="SubAverage")return o.belowAverage;if(e=="formula")return l.slice(0,1)!="="&&(l="="+l),o.formula+": "+l}}},newConditionRuleDialog:function(e){let n=this,t=Be().conditionformat,l=n.getRuleExplain(0);$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").hide(),$("#luckysheet-newConditionRule-dialog").remove();let o='<div><div class="boxTitle">'+t.chooseRuleType+"\uFF1A</div>"+n.ruleTypeHtml()+'<div class="boxTitle">'+t.editRuleDescription+'\uFF1A</div><div class="ruleExplainBox">'+l+"</div></div>";$("body").first().append(Tt(Ll,{id:"luckysheet-newConditionRule-dialog",addclass:"luckysheet-newEditorRule-dialog",title:t.newFormatRule,content:o,botton:`<button id="luckysheet-newConditionRule-dialog-confirm" class="btn btn-primary" data-source="${e}">${t.confirm}</button>
                        <button id="luckysheet-newConditionRule-dialog-close" class="btn btn-default" data-source="${e}">${t.cancel}</button>`,style:"z-index:100003"}));let a=$("#luckysheet-newConditionRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),s=a.outerHeight(),u=a.outerWidth(),f=$(window).width(),m=$(window).height(),d=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-newConditionRule-dialog").css({left:(f+d-u)/2,top:(m+p-s)/3}).show(),$("#luckysheet-newConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq(0)").addClass("on").siblings().removeClass("on"),n.colorSelectInit()},editorConditionRuleDialog:function(){let e=this,n=Be().conditionformat,t=e.editorRule.data;if(t==null)return;let l=t.type,o=t.format,a=t.conditionName,s,u;l=="dataBar"||l=="colorGradation"||l=="icons"?(s=0,u=l):a=="greaterThan"||a=="lessThan"||a=="betweenness"||a=="equal"||a=="textContains"||a=="occurrenceDate"?(s=1,a=="greaterThan"||a=="lessThan"||a=="betweenness"||a=="equal"?u="number":a=="textContains"?u="text":a=="occurrenceDate"&&(u="date")):a=="top10"||a=="top10%"||a=="last10"||a=="last10%"?(s=2,a=="top10"||a=="top10%"?u="top":(a=="last10"||a=="last10%")&&(u="last")):a=="AboveAverage"||a=="SubAverage"?(s=3,u=a):a=="duplicateValue"?(s=4,u=t.conditionValue):a=="formula"&&(s=5);let f=e.getRuleExplain(s);$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-administerRule-dialog").hide(),$("#luckysheet-editorConditionRule-dialog").remove();let m='<div><div class="boxTitle">'+n.chooseRuleType+"\uFF1A</div>"+e.ruleTypeHtml()+'<div class="boxTitle">'+n.editRuleDescription+'\uFF1A</div><div class="ruleExplainBox">'+f+"</div></div>";$("body").first().append(Tt(Ll,{id:"luckysheet-editorConditionRule-dialog",addclass:"luckysheet-newEditorRule-dialog",title:n.editFormatRule,content:m,botton:`<button id="luckysheet-editorConditionRule-dialog-confirm" class="btn btn-primary">${n.confirm}</button>
                        <button id="luckysheet-editorConditionRule-dialog-close" class="btn btn-default">${n.cancel}</button>`,style:"z-index:100003"}));let d=$("#luckysheet-editorConditionRule-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),p=d.outerHeight(),b=d.outerWidth(),g=$(window).width(),v=$(window).height(),x=$(document).scrollLeft(),_=$(document).scrollTop();if($("#luckysheet-editorConditionRule-dialog").css({left:(g+x-b)/2,top:(v+_-p)/3}).show(),e.colorSelectInit(),$("#luckysheet-editorConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq("+s+")").addClass("on").siblings().removeClass("on"),$("#luckysheet-editorConditionRule-dialog #type1").val(u),(u=="dataBar"||u=="colorGradation"||u=="icons"||u=="number"||u=="text"||u=="date")&&($("#luckysheet-editorConditionRule-dialog ."+u+"Box").show(),$("#luckysheet-editorConditionRule-dialog ."+u+"Box").siblings().hide()),u=="date"&&e.daterangeInit("luckysheet-editorConditionRule-dialog"),l=="dataBar"||l=="colorGradation"||l=="icons"){if(u=="dataBar")o.length==2?$("#luckysheet-editorConditionRule-dialog .dataBarBox #type2").val("gradient"):o.length==1&&$("#luckysheet-editorConditionRule-dialog .dataBarBox #type2").val("solid"),$("#luckysheet-editorConditionRule-dialog .dataBarBox .luckysheet-conditionformat-config-color").spectrum("set",o[0]);else if(u=="colorGradation")o.length==3?($("#luckysheet-editorConditionRule-dialog .colorGradationBox #type2").val("threeColor"),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal").show(),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("set",o[0]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal .luckysheet-conditionformat-config-color").spectrum("set",o[1]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("set",o[2])):o.length==2&&($("#luckysheet-editorConditionRule-dialog .colorGradationBox #type2").val("twoColor"),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .midVal").hide(),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .maxVal .luckysheet-conditionformat-config-color").spectrum("set",o[0]),$("#luckysheet-editorConditionRule-dialog .colorGradationBox .minVal .luckysheet-conditionformat-config-color").spectrum("set",o[1]));else if(u=="icons"){let S=o.len,I=o.leftMin,P=o.top;$("#luckysheet-editorConditionRule-dialog .iconsBox li").each(function(F,D){if($(D).find("div").attr("data-len")==S&&$(D).find("div").attr("data-leftmin")==I&&$(D).find("div").attr("data-top")==P)return $("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").css("background-position",$(D).find("div").css("background-position")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-len",$(D).find("div").attr("data-len")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-leftmin",$(D).find("div").attr("data-leftmin")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-top",$(D).find("div").attr("data-leftmin")),$("#luckysheet-editorConditionRule-dialog .iconsBox .showbox .model").attr("title",$(D).find("div").attr("title")),!0})}}else{if(u=="number"){$("#luckysheet-editorConditionRule-dialog .numberBox #type2").val(a);let S;if(t.conditionRange[0]!=null?S=Kl(h.currentSheetIndex,{row:t.conditionRange[0].row,column:t.conditionRange[0].column},h.currentSheetIndex):S=t.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal input").val(S),a=="betweenness"){$("#luckysheet-editorConditionRule-dialog .numberBox .txt").show(),$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2").show();let I;t.conditionRange[1]!=null?I=Kl(h.currentSheetIndex,{row:t.conditionRange[1].row,column:t.conditionRange[1].column},h.currentSheetIndex):I=t.conditionValue[1],$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2 input").val(I)}else $("#luckysheet-editorConditionRule-dialog .numberBox .txt").hide(),$("#luckysheet-editorConditionRule-dialog .numberBox #conditionVal2").hide()}else if(u=="text"){let S;t.conditionRange[0]!=null?S=Kl(h.currentSheetIndex,{row:t.conditionRange[0].row,column:t.conditionRange[0].column},h.currentSheetIndex):S=t.conditionValue[0],$("#luckysheet-editorConditionRule-dialog .textBox #conditionVal input").val(S)}else if(u=="date"){e.daterangeInit("luckysheet-editorConditionRule-dialog");let S=t.conditionValue[0];$("#luckysheet-editorConditionRule-dialog .dateBox #daterange-btn").val(S)}else if(u=="top"||u=="last"){let S=t.conditionValue[0];(a=="top10%"||a=="last10%")&&$("#luckysheet-editorConditionRule-dialog #isPercent").attr("checked","checked")}else if(a=="formula"){let S=t.conditionValue[0];$("#luckysheet-editorConditionRule-dialog #formulaConditionVal input").val(S)}$("#luckysheet-editorConditionRule-dialog #textcolorshow").spectrum("set",o.textColor),$("#luckysheet-editorConditionRule-dialog #cellcolorshow").spectrum("set",o.cellColor)}},infoDialog:function(e,n){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-conditionformat-info-dialog").remove(),$("body").first().append(Tt(Ll,{id:"luckysheet-conditionformat-info-dialog",addclass:"",title:e,content:n,botton:`<button id="luckysheet-conditionformat-info-dialog-close" class="btn btn-default">${Be().conditionformat.close}</button>`,style:"z-index:100003"}));let t=$("#luckysheet-conditionformat-info-dialog").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=t.outerHeight(),o=t.outerWidth(),a=$(window).width(),s=$(window).height(),u=$(document).scrollLeft(),f=$(document).scrollTop();$("#luckysheet-conditionformat-info-dialog").css({left:(a+u-o)/2,top:(s+f-l)/3}).show()},getRuleExplain:function(e){let n=Be().conditionformat,t=this.textCellColorHtml(),l;switch(e){case 0:l=`<div class="title">${n.ruleTypeItem1}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 5px;">
                                        <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.formatStyle}\uFF1A</label>
                                        <select id="type1">
                                            <option value="dataBar">${n.dataBar}</option>
                                            <option value="colorGradation">${n.colorGradation}</option>
                                            <option value="icons">${n.icons}</option>
                                        </select>
                                    </div>
                                    <div>
                                        <div class="type1Box dataBarBox">
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.fillType}\uFF1A</label>
                                                <select id="type2">
                                                    <option value="gradient">${n.gradient}</option>
                                                    <option value="solid">${n.solid}</option>
                                                </select>
                                            </div>
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.color}\uFF1A</label>
                                                <input data-tips="${n.dataBarColor}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="#638ec6" style="display: none;"> 
                                            </div>
                                        </div>
                                        <div class="type1Box colorGradationBox" style="display: none;">
                                            <div style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.fillType}\uFF1A</label>
                                                <select id="type2">
                                                    <option value="threeColor">${n.tricolor}</option>
                                                    <option value="twoColor">${n.twocolor}</option>
                                                </select>
                                            </div>
                                            <div class="maxVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.maxValue}\uFF1A</label>
                                                <input data-tips="${n.maxValue} ${n.color}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(99, 190, 123)" style="display: none;">
                                            </div>
                                            <div class="midVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.medianValue}\uFF1A</label>
                                                <input data-tips="${n.medianValue} ${n.color}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(255, 235, 132)" style="display: none;">
                                            </div>
                                            <div class="minVal" style="height: 30px;margin-bottom: 5px;">
                                                <label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">${n.minValue}\uFF1A</label>
                                                <input data-tips="${n.minValue} ${n.color}" data-func="background" class="luckysheet-conditionformat-config-color" type="text" value="rgb(248, 105, 107)" style="display: none;">
                                            </div>
                                        </div>
                                        <div class="type1Box iconsBox" style="display: none;">
                                            <label>${n.fillType}\uFF1A</label>
                                            <div class="showbox">
                                                <div class="model" data-len="3" data-leftmin="0" data-top="0" title="${n.threeWayArrow}(${n.multicolor})" style="background-position: 0 0;"></div>
                                                <span class="ui-selectmenu-icon ui-icon ui-icon-triangle-1-s" style="margin-top: 2px;"></span>
                                            </div>
                                            <ul>
                                                <li><div data-len="3" data-leftmin="0" data-top="0" title="${n.threeWayArrow}(${n.multicolor})" style="background-position: 0 0;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="0" title="${n.threeWayArrow}(${n.grayColor})" style="background-position: -131px 0;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="1" title="${n.threeTriangles}" style="background-position: 0 -20px;"></div></li>
                                                <li><div data-len="4" data-leftmin="0" data-top="2" title="${n.fourWayArrow}(${n.multicolor})" style="background-position: 0 -40px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="1" title="${n.fourWayArrow}(${n.grayColor})" style="background-position: -131px -20px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="3" title="${n.fiveWayArrow}(${n.multicolor})" style="background-position: 0 -60px;"></div></li>
                                                <li><div data-len="5" data-leftmin="5" data-top="2" title="${n.fiveWayArrow}(${n.grayColor})" style="background-position: -131px -40px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="4" title="${n.threeColorTrafficLight}(${n.rimless})" style="background-position: 0 -80px;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="4" title="${n.threeColorTrafficLight}(${n.bordered})" style="background-position: -131px -80px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="5" title="${n.threeSigns}" style="background-position: 0 -100px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="5" title="${n.fourColorTrafficLight}" style="background-position: -131px -100px;"></div></li>
                                                <li><div data-len="4" data-leftmin="0" data-top="6" title="${n.greenRedBlackGradient}" style="background-position: 0 -120px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="7" title="${n.threeSymbols}(${n.circled})" style="background-position: 0 -140px;"></div></li>
                                                <li><div data-len="3" data-leftmin="5" data-top="7" title="${n.threeSymbols}(${n.noCircle})" style="background-position: -131px -140px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="8" title="${n.tricolorFlag}" style="background-position: 0 -160px;"></div></li>
                                                <li><div data-len="3" data-leftmin="0" data-top="9" title="${n.threeStars}" style="background-position: 0 -180px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="10" title="${n.fiveQuadrantDiagram}" style="background-position: 0 -200px;"></div></li>
                                                <li><div data-len="5" data-leftmin="0" data-top="11" title="${n.fiveBoxes}" style="background-position: 0 -220px;"></div></li>
                                                <li><div data-len="4" data-leftmin="5" data-top="9" title="${n.grade4}" style="background-position: -131px -180px;"></div></li>
                                                <li><div data-len="5" data-leftmin="5" data-top="10" title="${n.grade5}" style="background-position: -131px -200px;"></div></li>
                                            </ul>
                                        </div>
                                    </div>`;break;case 1:l=`<div class="title">${n.ruleTypeItem2_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="number">${n.cellValue}</option>
                                            <option value="text">${n.specificText}</option>
                                            <option value="date">${n.occurrence}</option>
                                        </select>
                                        <div>
                                            <div class="type1Box numberBox">
                                                <select id="type2">
                                                    <option value="greaterThan">${n.greaterThan}</option>
                                                    <option value="lessThan">${n.lessThan}</option>
                                                    <option value="betweenness">${n.between}</option>
                                                    <option value="equal">${n.equal}</option>
                                                </select>
                                                <div class="inpbox range" id="conditionVal">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${n.selectCell}"></i>
                                                </div>
                                                <span class="txt" style="display: none;">${n.in}</span>
                                                <div class="inpbox range" id="conditionVal2" style="display: none;">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${n.selectDataRange}"></i>
                                                </div>
                                            </div>
                                            <div class="type1Box textBox" style="display: none;">
                                                <select id="type2">
                                                    <option value="">${n.contain}</option>
                                                </select>
                                                <div class="inpbox range" id="conditionVal">
                                                    <input class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${n.selectCell}"></i>
                                                </div>
                                            </div>
                                            <div class="type1Box dateBox" style="display: none;">
                                                <div style="width: 162px;" class="inpbox">
                                                    <input style="width: 150px;" id="daterange-btn" readonly="readonly" placeholder="${n.pleaseSelectADate}"/>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="title">${n.setFormat}: </div>${t}`;break;case 2:l=`<div class="title">${n.ruleTypeItem3_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="top">${n.top}</option>
                                            <option value="last">${n.last}</option>
                                        </select>
                                        <div class="inpbox" id="conditionVal">
                                            <input class="formulaInputFocus" type="number" value="10"/>
                                        </div>
                                        <input id="isPercent" type="checkbox"/>
                                        <label for="isPercent" class="txt">${n.selectRange_percent}</label>
                                    </div>
                                    <div class="title">${n.setFormat}\uFF1A</div>${t}`;break;case 3:l=`<div class="title">${n.ruleTypeItem4_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="AboveAverage">${n.above}</option>
                                            <option value="SubAverage">${n.below}</option>
                                        </select>
                                        <span class="txt">${n.selectRange_average}</span>
                                    </div>
                                    <div class="title">${n.setFormat}\uFF1A</div>${t}`;break;case 4:l=`<div class="title">${n.all}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <select id="type1">
                                            <option value="0">${n.duplicateValue}</option>
                                            <option value="1">${n.uniqueValue}</option>
                                        </select>
                                        <span class="txt">${n.selectRange_value}</span>
                                    </div>
                                    <div class="title">${n.setFormat}\uFF1A</div>${t}`;break;case 5:l=`<div class="title">${n.ruleTypeItem2_title}\uFF1A</div>
                                    <div style="height: 30px;margin-bottom: 10px;">
                                        <div class="inpbox range" id="formulaConditionVal" style="width: 250px;">
                                            <input class="formulaInputFocus" style="width: 200px;"/>
                                            <i class="fa fa-table" aria-hidden="true" title="${n.selectCell}"></i>
                                        </div>
                                    </div>
                                    <div class="title">${n.setFormat}: </div>${t}`;break}return l},daterangeInit:function(e){let n=Be().conditionformat;$(".ranges_1 ul").remove(),$("#"+e).find("#daterange-btn").flatpickr({mode:"range",onChange:function(t,l){let[o,a]=t,s=[n.yesterday,n.today],u=[n.lastWeek,n.thisWeek,n.lastMonth,n.thisMonth,n.lastYear,n.thisYear,n.last7days,n.last30days];l==n.all?$("#daterange-btn").val(""):s.indexOf(l)>-1?$("#daterange-btn").val((0,Ih.default)(o).format("YYYY/MM/DD")):u.indexOf(l)>-1&&$("#daterange-btn").val((0,Ih.default)(o).format("YYYY/MM/DD")+"-"+(0,Ih.default)(a).format("YYYY/MM/DD"))}})},CFSplitRange:function(e,n,t,l){let o=[],a=t.row[0]-n.row[0],s=t.column[0]-n.column[0],u=e.row[0],f=e.row[1],m=e.column[0],d=e.column[1];return u>=n.row[0]&&f<=n.row[1]&&m>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u+a,f+a],column:[m+s,d+s]}]:l=="restPart"?o=[]:l=="operatePart"&&(o=[{row:[u+a,f+a],column:[m+s,d+s]}]):u>=n.row[0]&&u<=n.row[1]&&m>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[n.row[1]+1,f],column:[m,d]},{row:[u+a,n.row[1]+a],column:[m+s,d+s]}]:l=="restPart"?o=[{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[m+s,d+s]}]):f>=n.row[0]&&f<=n.row[1]&&m>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0]+a,f+a],column:[m+s,d+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,f+a],column:[m+s,d+s]}]):u<n.row[0]&&f>n.row[1]&&m>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[1]+1,f],column:[m,d]},{row:[n.row[0]+a,n.row[1]+a],column:[m+s,d+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[m+s,d+s]}]):m>=n.column[0]&&m<=n.column[1]&&u>=n.row[0]&&f<=n.row[1]?l=="allPart"?o=[{row:[u,f],column:[n.column[1]+1,d]},{row:[u+a,f+a],column:[m+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,f],column:[n.column[1]+1,d]}]:l=="operatePart"&&(o=[{row:[u+a,f+a],column:[m+s,n.column[1]+s]}]):d>=n.column[0]&&d<=n.column[1]&&u>=n.row[0]&&f<=n.row[1]?l=="allPart"?o=[{row:[u,f],column:[m,n.column[0]-1]},{row:[u+a,f+a],column:[n.column[0]+s,d+s]}]:l=="restPart"?o=[{row:[u,f],column:[m,n.column[0]-1]}]:l=="operatePart"&&(o=[{row:[u+a,f+a],column:[n.column[0]+s,d+s]}]):m<n.column[0]&&d>n.column[1]&&u>=n.row[0]&&f<=n.row[1]?l=="allPart"?o=[{row:[u,f],column:[m,n.column[0]-1]},{row:[u,f],column:[n.column[1]+1,d]},{row:[u+a,f+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,f],column:[m,n.column[0]-1]},{row:[u,f],column:[n.column[1]+1,d]}]:l=="operatePart"&&(o=[{row:[u+a,f+a],column:[n.column[0]+s,n.column[1]+s]}]):u>=n.row[0]&&u<=n.row[1]&&m>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]},{row:[u+a,n.row[1]+a],column:[m+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[m+s,n.column[1]+s]}]):u>=n.row[0]&&u<=n.row[1]&&d>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[1]+1,f],column:[m,d]},{row:[u+a,n.row[1]+a],column:[n.column[0]+s,d+s]}]:l=="restPart"?o=[{row:[u,n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[n.column[0]+s,d+s]}]):f>=n.row[0]&&f<=n.row[1]&&m>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[n.column[1]+1,d]},{row:[n.row[0]+a,f+a],column:[m+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[n.column[1]+1,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,f+a],column:[m+s,n.column[1]+s]}]):f>=n.row[0]&&f<=n.row[1]&&d>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[m,n.column[0]-1]},{row:[n.row[0]+a,f+a],column:[n.column[0]+s,d+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[m,n.column[0]-1]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,f+a],column:[n.column[0]+s,d+s]}]):u<n.row[0]&&f>n.row[1]&&m>=n.column[0]&&m<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]},{row:[n.row[0]+a,n.row[1]+a],column:[m+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[m+s,n.column[1]+s]}]):u<n.row[0]&&f>n.row[1]&&d>=n.column[0]&&d<=n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[1]+1,f],column:[m,d]},{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,d+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,d+s]}]):m<n.column[0]&&d>n.column[1]&&u>=n.row[0]&&u<=n.row[1]?l=="allPart"?o=[{row:[u,n.row[1]],column:[m,n.column[0]-1]},{row:[u,n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]},{row:[u+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[1]],column:[m,n.column[0]-1]},{row:[u,n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[u+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]):m<n.column[0]&&d>n.column[1]&&f>=n.row[0]&&f<=n.row[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[m,n.column[0]-1]},{row:[n.row[0],f],column:[n.column[1]+1,d]},{row:[n.row[0]+a,f+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],f],column:[m,n.column[0]-1]},{row:[n.row[0],f],column:[n.column[1]+1,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,f+a],column:[n.column[0]+s,n.column[1]+s]}]):u<n.row[0]&&f>n.row[1]&&m<n.column[0]&&d>n.column[1]?l=="allPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]},{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]:l=="restPart"?o=[{row:[u,n.row[0]-1],column:[m,d]},{row:[n.row[0],n.row[1]],column:[m,n.column[0]-1]},{row:[n.row[0],n.row[1]],column:[n.column[1]+1,d]},{row:[n.row[1]+1,f],column:[m,d]}]:l=="operatePart"&&(o=[{row:[n.row[0]+a,n.row[1]+a],column:[n.column[0]+s,n.column[1]+s]}]):l=="allPart"?o=[{row:[u,f],column:[m,d]}]:l=="restPart"?o=[{row:[u,f],column:[m,d]}]:l=="operatePart"&&(o=[]),o},getcolorGradation:function(e,n,t,l,o){let a=e.split(","),s=parseInt(a[0].split("(")[1]),u=parseInt(a[1]),f=parseInt(a[2].split(")")[0]),m=n.split(","),d=parseInt(m[0].split("(")[1]),p=parseInt(m[1]),b=parseInt(m[2].split(")")[0]),g=Math.round(s-(s-d)/(t-l)*(t-o)),v=Math.round(u-(u-p)/(t-l)*(t-o)),x=Math.round(f-(f-b)/(t-l)*(t-o));return"rgb("+g+", "+v+", "+x+")"},getCFPartRange:function(e,n,t){let l=[],o=h.luckysheetfile[Me(e)].luckysheet_conditionformat_save;if(o!=null&&o.length>0){e:for(let a=0;a<o.length;a++){let s=o[a].cellrange;for(let u=0;u<s.length;u++){let f=s[u].row[0],m=s[u].row[1],d=s[u].column[0],p=s[u].column[1];for(let b=0;b<range.length;b++)if(range[b].row[0]>=f&&range[b].row[0]<=m||range[b].row[1]>=f&&range[b].row[1]<=m||range[b].column[0]>=d&&range[b].column[0]<=p||range[b].column[1]>=d&&range[b].column[1]<=p){l.push(o[a]);continue e}}}}return l},checksCF:function(e,n,t){return t!=null&&e+"_"+n in t?t[e+"_"+n]:null},getComputeMap:function(e){let n=Me(h.currentSheetIndex);e!=null&&(n=Me(e));let t=h.luckysheetfile[n].luckysheet_conditionformat_save,l=h.luckysheetfile[n].data;return l==null?null:this.compute(t,l)},compute:function(e,n){let t=this;e==null&&(e=[]);let l={};if(e.length>0)for(let o=0;o<e.length;o++){let a=e[o].type,s=e[o].cellrange,u=e[o].format;if(a=="dataBar"){let f=null,m=null;for(let d=0;d<s.length;d++)for(let p=s[d].row[0];p<=s[d].row[1];p++)for(let b=s[d].column[0];b<=s[d].column[1];b++){if(n[p]==null||n[p][b]==null)continue;let g=n[p][b];G(g)=="object"&&g.ct!=null&&g.ct.t=="n"&&g.v!=null&&((f==null||parseInt(g.v)>f)&&(f=parseInt(g.v)),(m==null||parseInt(g.v)<m)&&(m=parseInt(g.v)))}if(f!=null&&m!=null)if(m<0){let d=Math.round(f/(f-m)*10)/10,p=Math.round(Math.abs(m)/(f-m)*10)/10;for(let b=0;b<s.length;b++)for(let g=s[b].row[0];g<=s[b].row[1];g++)for(let v=s[b].column[0];v<=s[b].column[1];v++){if(n[g]==null||n[g][v]==null)continue;let x=n[g][v];if(G(x)=="object"&&x.ct!=null&&x.ct.t=="n"&&x.v!=null){if(parseInt(x.v)<0){let _=Math.round(Math.abs(parseInt(x.v))/Math.abs(m)*100)/100;g+"_"+v in l?l[g+"_"+v].dataBar={valueType:"minus",minusLen:p,valueLen:_,format:u}:l[g+"_"+v]={dataBar:{valueType:"minus",minusLen:p,valueLen:_,format:u}}}if(parseInt(x.v)>0){let _=Math.round(parseInt(x.v)/f*100)/100;g+"_"+v in l?l[g+"_"+v].dataBar={valueType:"plus",plusLen:d,minusLen:p,valueLen:_,format:u}:l[g+"_"+v]={dataBar:{valueType:"plus",plusLen:d,minusLen:p,valueLen:_,format:u}}}}}}else{let d=1;for(let p=0;p<s.length;p++)for(let b=s[p].row[0];b<=s[p].row[1];b++)for(let g=s[p].column[0];g<=s[p].column[1];g++){if(n[b]==null||n[b][g]==null)continue;let v=n[b][g];if(G(v)=="object"&&v.ct!=null&&v.ct.t=="n"&&v.v!=null){let x;f==0?x=1:x=Math.round(parseInt(v.v)/f*100)/100,b+"_"+g in l?l[b+"_"+g].dataBar={valueType:"plus",plusLen:d,valueLen:x,format:u}:l[b+"_"+g]={dataBar:{valueType:"plus",plusLen:d,valueLen:x,format:u}}}}}}else if(a=="colorGradation"){let f=null,m=null,d=0,p=0;for(let b=0;b<s.length;b++)for(let g=s[b].row[0];g<=s[b].row[1];g++)for(let v=s[b].column[0];v<=s[b].column[1];v++){if(n[g]==null||n[g][v]==null)continue;let x=n[g][v];G(x)=="object"&&x.ct!=null&&x.ct.t=="n"&&x.v!=null&&(p++,d+=parseInt(x.v),(f==null||parseInt(x.v)>f)&&(f=parseInt(x.v)),(m==null||parseInt(x.v)<m)&&(m=parseInt(x.v)))}if(f!=null&&m!=null){if(u.length==3){let b=Math.floor(d/p);for(let g=0;g<s.length;g++)for(let v=s[g].row[0];v<=s[g].row[1];v++)for(let x=s[g].column[0];x<=s[g].column[1];x++){if(n[v]==null||n[v][x]==null)continue;let _=n[v][x];G(_)=="object"&&_.ct!=null&&_.ct.t=="n"&&_.v!=null&&(parseInt(_.v)==m?v+"_"+x in l?l[v+"_"+x].cellColor=u[2]:l[v+"_"+x]={cellColor:u[2]}:parseInt(_.v)>m&&parseInt(_.v)<b?v+"_"+x in l?l[v+"_"+x].cellColor=t.getcolorGradation(u[2],u[1],m,b,parseInt(_.v)):l[v+"_"+x]={cellColor:t.getcolorGradation(u[2],u[1],m,b,parseInt(_.v))}:parseInt(_.v)==b?v+"_"+x in l?l[v+"_"+x].cellColor=u[1]:l[v+"_"+x]={cellColor:u[1]}:parseInt(_.v)>b&&parseInt(_.v)<f?v+"_"+x in l?l[v+"_"+x].cellColor=t.getcolorGradation(u[1],u[0],b,f,parseInt(_.v)):l[v+"_"+x]={cellColor:t.getcolorGradation(u[1],u[0],b,f,parseInt(_.v))}:parseInt(_.v)==f&&(v+"_"+x in l?l[v+"_"+x].cellColor=u[0]:l[v+"_"+x]={cellColor:u[0]}))}}else if(u.length==2)for(let b=0;b<s.length;b++)for(let g=s[b].row[0];g<=s[b].row[1];g++)for(let v=s[b].column[0];v<=s[b].column[1];v++){if(n[g]==null||n[g][v]==null)continue;let x=n[g][v];G(x)=="object"&&x.ct!=null&&x.ct.t=="n"&&x.v!=null&&(parseInt(x.v)==m?g+"_"+v in l?l[g+"_"+v].cellColor=u[1]:l[g+"_"+v]={cellColor:u[1]}:parseInt(x.v)>m&&parseInt(x.v)<f?g+"_"+v in l?l[g+"_"+v].cellColor=t.getcolorGradation(u[1],u[0],m,f,parseInt(x.v)):l[g+"_"+v]={cellColor:t.getcolorGradation(u[1],u[0],m,f,parseInt(x.v))}:parseInt(x.v)==f&&(g+"_"+v in l?l[g+"_"+v].cellColor=u[0]:l[g+"_"+v]={cellColor:u[0]}))}}}else if(a=="icons"){let f=parseInt(u.len),m=parseInt(u.leftMin),d=parseInt(u.top),p=null,b=null;for(let g=0;g<s.length;g++)for(let v=s[g].row[0];v<=s[g].row[1];v++)for(let x=s[g].column[0];x<=s[g].column[1];x++){if(n[v]==null||n[v][x]==null)continue;let _=n[v][x];G(_)=="object"&&_.ct!=null&&_.ct.t=="n"&&_.v!=null&&((p==null||parseInt(_.v)>p)&&(p=parseInt(_.v)),(b==null||parseInt(_.v)<b)&&(b=parseInt(_.v)))}if(p!=null&&b!=null){let g=Math.floor((p-b+1)/f),v=(p-b+1)%f;if(f==3){let x,_,S;v==2?(x=[b,b+g],_=[b+g+1,b+g*2],S=[b+g*2+1,p]):(x=[b,b+g-1],_=[b+g,b+g*2-1],S=[b+g*2,p]);for(let I=0;I<s.length;I++)for(let P=s[I].row[0];P<=s[I].row[1];P++)for(let F=s[I].column[0];F<=s[I].column[1];F++){if(n[P]==null||n[P][F]==null)continue;let D=n[P][F];G(D)=="object"&&D.ct!=null&&D.ct.t=="n"&&D.v!=null&&(parseInt(D.v)>=x[0]&&parseInt(D.v)<=x[1]?P+"_"+F in l?l[P+"_"+F].icons={left:m+2,top:d}:l[P+"_"+F]={icons:{left:m+2,top:d}}:parseInt(D.v)>=_[0]&&parseInt(D.v)<=_[1]?P+"_"+F in l?l[P+"_"+F].icons={left:m+1,top:d}:l[P+"_"+F]={icons:{left:m+1,top:d}}:parseInt(D.v)>=S[0]&&parseInt(D.v)<=S[1]&&(P+"_"+F in l?l[P+"_"+F].icons={left:m,top:d}:l[P+"_"+F]={icons:{left:m,top:d}}))}}else if(f==4){let x,_,S,I;v==2?(x=[b,b+g],_=[b+g+1,b+g*2],S=[b+g*2+1,b+g*3],I=[b+g*3+1,p]):v==3?(x=[b,b+g],_=[b+g+1,b+g*2],S=[b+g*2+1,b+g*3+1],I=[b+g*3+2,p]):(x=[b,b+g-1],_=[b+g,b+g*2-1],S=[b+g*2,b+g*3-1],I=[b+g*3,p]);for(let P=0;P<s.length;P++)for(let F=s[P].row[0];F<=s[P].row[1];F++)for(let D=s[P].column[0];D<=s[P].column[1];D++){if(n[F]==null||n[F][D]==null)continue;let k=n[F][D];G(k)=="object"&&k.ct!=null&&k.ct.t=="n"&&k.v!=null&&(parseInt(k.v)>=x[0]&&parseInt(k.v)<=x[1]?F+"_"+D in l?l[F+"_"+D].icons={left:m+3,top:d}:l[F+"_"+D]={icons:{left:m+3,top:d}}:parseInt(k.v)>=_[0]&&parseInt(k.v)<=_[1]?F+"_"+D in l?l[F+"_"+D].icons={left:m+2,top:d}:l[F+"_"+D]={icons:{left:m+2,top:d}}:parseInt(k.v)>=S[0]&&parseInt(k.v)<=S[1]?F+"_"+D in l?l[F+"_"+D].icons={left:m+1,top:d}:l[F+"_"+D]={icons:{left:m+1,top:d}}:parseInt(k.v)>=I[0]&&parseInt(k.v)<=I[1]&&(F+"_"+D in l?l[F+"_"+D].icons={left:m,top:d}:l[F+"_"+D]={icons:{left:m,top:d}}))}}else if(f==5){let x,_,S,I,P;v==2?(x=[b,b+g],_=[b+g+1,b+g*2],S=[b+g*2+1,b+g*3],I=[b+g*3+1,b+g*4],P=[b+g*4+1,p]):v==3?(x=[b,b+g],_=[b+g+1,b+g*2],S=[b+g*2+1,b+g*3+1],I=[b+g*3+2,b+g*4+1],P=[b+g*4+2,p]):v==4?(x=[b,b+g],_=[b+g+1,b+g*2+1],S=[b+g*2+2,b+g*3+1],I=[b+g*3+2,b+g*4+2],P=[b+g*4+3,p]):(x=[b,b+g-1],_=[b+g,b+g*2-1],S=[b+g*2,b+g*3-1],I=[b+g*3,b+g*4-1],P=[b+g*4,p]);for(let F=0;F<s.length;F++)for(let D=s[F].row[0];D<=s[F].row[1];D++)for(let k=s[F].column[0];k<=s[F].column[1];k++){if(n[D]==null||n[D][k]==null)continue;let w=n[D][k];G(w)=="object"&&w.ct!=null&&w.ct.t=="n"&&w.v!=null&&(parseInt(w.v)>=x[0]&&parseInt(w.v)<=x[1]?D+"_"+k in l?l[D+"_"+k].icons={left:m+4,top:d}:l[D+"_"+k]={icons:{left:m+4,top:d}}:parseInt(w.v)>=_[0]&&parseInt(w.v)<=_[1]?D+"_"+k in l?l[D+"_"+k].icons={left:m+3,top:d}:l[D+"_"+k]={icons:{left:m+3,top:d}}:parseInt(w.v)>=S[0]&&parseInt(w.v)<=S[1]?D+"_"+k in l?l[D+"_"+k].icons={left:m+2,top:d}:l[D+"_"+k]={icons:{left:m+2,top:d}}:parseInt(w.v)>=I[0]&&parseInt(w.v)<=I[1]?D+"_"+k in l?l[D+"_"+k].icons={left:m+1,top:d}:l[D+"_"+k]={icons:{left:m+1,top:d}}:parseInt(w.v)>=P[0]&&parseInt(w.v)<=P[1]&&(D+"_"+k in l?l[D+"_"+k].icons={left:m,top:d}:l[D+"_"+k]={icons:{left:m,top:d}}))}}}}else{let f=e[o].conditionName,m=e[o].conditionValue[0],d=e[o].conditionValue[1],p=u.textColor,b=u.cellColor;for(let g=0;g<s.length;g++)if(f=="greaterThan"||f=="lessThan"||f=="equal"||f=="textContains")for(let v=s[g].row[0];v<=s[g].row[1];v++)for(let x=s[g].column[0];x<=s[g].column[1];x++){if(n[v]==null||n[v][x]==null)continue;let _=n[v][x];G(_)!="object"||ft(_.v)||(f=="greaterThan"&&_.v>m?v+"_"+x in l?(l[v+"_"+x].textColor=p,l[v+"_"+x].cellColor=b):l[v+"_"+x]={textColor:p,cellColor:b}:f=="lessThan"&&_.v<m?v+"_"+x in l?(l[v+"_"+x].textColor=p,l[v+"_"+x].cellColor=b):l[v+"_"+x]={textColor:p,cellColor:b}:f=="equal"&&_.v==m?v+"_"+x in l?(l[v+"_"+x].textColor=p,l[v+"_"+x].cellColor=b):l[v+"_"+x]={textColor:p,cellColor:b}:f=="textContains"&&_.v.toString().indexOf(m)!=-1&&(v+"_"+x in l?(l[v+"_"+x].textColor=p,l[v+"_"+x].cellColor=b):l[v+"_"+x]={textColor:p,cellColor:b}))}else if(f=="betweenness"){let v,x;m>d?(v=m,x=d):(v=d,x=m);for(let _=s[g].row[0];_<=s[g].row[1];_++)for(let S=s[g].column[0];S<=s[g].column[1];S++){if(n[_]==null||n[_][S]==null)continue;let I=n[_][S];G(I)!="object"||ft(I.v)||I.v>=x&&I.v<=v&&(_+"_"+S in l?(l[_+"_"+S].textColor=p,l[_+"_"+S].cellColor=b):l[_+"_"+S]={textColor:p,cellColor:b})}}else if(f=="occurrenceDate"){let v,x;if(m.toString().indexOf("-")==-1)v=_l(m)[2],x=_l(m)[2];else{let _=m.toString().split("-");v=_l(_[1].trim())[2],x=_l(_[0].trim())[2]}for(let _=s[g].row[0];_<=s[g].row[1];_++)for(let S=s[g].column[0];S<=s[g].column[1];S++)if(!(n[_]==null||n[_][S]==null)&&n[_][S].ct!=null&&n[_][S].ct.t=="d"){let I=Vt(_,S,n);I>=x&&I<=v&&(_+"_"+S in l?(l[_+"_"+S].textColor=p,l[_+"_"+S].cellColor=b):l[_+"_"+S]={textColor:p,cellColor:b})}}else if(f=="duplicateValue"){let v={};for(let x=s[g].row[0];x<=s[g].row[1];x++)for(let _=s[g].column[0];_<=s[g].column[1];_++){let S=Vt(x,_,n);S in v||(v[S]=[]),v[S].push({r:x,c:_})}if(m=="0"){for(let x in v)if(x!="null"&&x!="undefined"&&v[x].length>1)for(let _=0;_<v[x].length;_++)v[x][_].r+"_"+v[x][_].c in l?(l[v[x][_].r+"_"+v[x][_].c].textColor=p,l[v[x][_].r+"_"+v[x][_].c].cellColor=b):l[v[x][_].r+"_"+v[x][_].c]={textColor:p,cellColor:b}}if(m=="1")for(let x in v)x!="null"&&x!="undefined"&&v[x].length==1&&(v[x][0].r+"_"+v[x][0].c in l?(l[v[x][0].r+"_"+v[x][0].c].textColor=p,l[v[x][0].r+"_"+v[x][0].c].cellColor=b):l[v[x][0].r+"_"+v[x][0].c]={textColor:p,cellColor:b})}else if(f=="top10"||f=="top10%"||f=="last10"||f=="last10%"||f=="AboveAverage"||f=="SubAverage"){let v=[];for(let x=s[g].row[0];x<=s[g].row[1];x++)for(let _=s[g].column[0];_<=s[g].column[1];_++)n[x]==null||n[x][_]==null||n[x][_].ct!=null&&n[x][_].ct.t=="n"&&v.push(Vt(x,_,n));if(f=="top10"||f=="top10%"||f=="last10"||f=="last10%"){for(let _=0;_<v.length;_++)for(let S=0;S<v.length-1-_;S++)if(v[S]<v[S+1]){let I=v[S];v[S]=v[S+1],v[S+1]=I}let x;f=="top10"?x=v.slice(0,m):f=="top10%"?x=v.slice(0,Math.floor(m*v.length/100)):f=="last10"?x=v.slice(v.length-m,v.length):f=="last10%"&&(x=v.slice(v.length-Math.floor(m*v.length/100),v.length));for(let _=s[g].row[0];_<=s[g].row[1];_++)for(let S=s[g].column[0];S<=s[g].column[1];S++){if(n[_]==null||n[_][S]==null)continue;let I=Vt(_,S,n);x.indexOf(I)!=-1&&(_+"_"+S in l?(l[_+"_"+S].textColor=p,l[_+"_"+S].cellColor=b):l[_+"_"+S]={textColor:p,cellColor:b})}}else if(f=="AboveAverage"||f=="SubAverage"){let x=0;for(let S=0;S<v.length;S++)x+=v[S];let _=x/v.length;if(f=="AboveAverage")for(let S=s[g].row[0];S<=s[g].row[1];S++)for(let I=s[g].column[0];I<=s[g].column[1];I++){if(n[S]==null||n[S][I]==null)continue;Vt(S,I,n)>_&&(S+"_"+I in l?(l[S+"_"+I].textColor=p,l[S+"_"+I].cellColor=b):l[S+"_"+I]={textColor:p,cellColor:b})}else if(f=="SubAverage")for(let S=s[g].row[0];S<=s[g].row[1];S++)for(let I=s[g].column[0];I<=s[g].column[1];I++){if(n[S]==null||n[S][I]==null)continue;Vt(S,I,n)<_&&(S+"_"+I in l?(l[S+"_"+I].textColor=p,l[S+"_"+I].cellColor=b):l[S+"_"+I]={textColor:p,cellColor:b})}}}else if(f=="formula"){let v=s[g].row[0],x=s[g].row[1],_=s[g].column[0],S=s[g].column[1],I=m;m.toString().slice(0,1)!="="&&(I="="+m);for(let P=v;P<=x;P++)for(let F=_;F<=S;F++){let D=I,k=P-v,w=F-_;k>0&&(D="="+y.functionCopy(D,"down",k)),w>0&&(D="="+y.functionCopy(D,"right",w));let T=y.execfunction(D)[1];typeof T!="boolean"&&(T=!!Number(T)),!!T&&(P+"_"+F in l?(l[P+"_"+F].textColor=p,l[P+"_"+F].cellColor=b):l[P+"_"+F]={textColor:p,cellColor:b})}}}}return l},updateItem:function(e,n,t){if(!zo(h.currentSheetIndex))return;let l=this,o=Me(h.currentSheetIndex),a=$.extend(!0,[],h.luckysheetfile),s=l.getHistoryRules(a),u;if(e=="delSheet")u=[];else{let d={type:e,cellrange:n,format:t};u=h.luckysheetfile[o].luckysheet_conditionformat_save==null?[]:h.luckysheetfile[o].luckysheet_conditionformat_save,u.push(d)}h.luckysheetfile[o].luckysheet_conditionformat_save=u;let f=$.extend(!0,[],h.luckysheetfile),m=l.getCurrentRules(f);l.ref(s,m),Ue.allowUpdate&&Ue.saveParam("all",h.currentSheetIndex,u,{k:"luckysheet_conditionformat_save"})},getHistoryRules:function(e){let n=[];for(let t=0;t<e.length;t++)n.push({sheetIndex:e[t].index,luckysheet_conditionformat_save:e[t].luckysheet_conditionformat_save});return n},getCurrentRules:function(e){let n=[];for(let t=0;t<e.length;t++)n.push({sheetIndex:e[t].index,luckysheet_conditionformat_save:e[t].luckysheet_conditionformat_save});return n},ref:function(e,n){if(h.clearjfundo){h.jfundo.length=0;let t={};t.type="updateCF",t.data={historyRules:e,currentRules:n},h.jfredo.push(t)}setTimeout(function(){Xt()},1)}},Mt=s3});var import_plugin,c3,Ql,ou=Nt(()=>{import_plugin=qe(Ye());jr();ln();mo();hi();Wr();Kr();Sr();tu();Er();fo();cr();Ar();ui();fr();Ol();il();Xl();Qo();c3={clearcopy:function(e){let n=window.clipboardData;n||e&&(n=e.originalEvent.clipboardData);let t=" ";if(h.luckysheet_selection_range=[],gr(),n)return n.setData("Text",t),!1;{let l=$("#luckysheet-copy-content").css("visibility","hidden");l.val(t),l.focus(),l.select(),setTimeout(function(){l.blur().css("visibility","visible")},10)}},getHtmlBorderStyle:function(e,n){let t="";return e={"0":"none","1":"Thin","2":"Hair","3":"Dotted","4":"Dashed","5":"DashDot","6":"DashDotDot","7":"Double","8":"Medium","9":"MediumDashed","10":"MediumDashDot","11":"MediumDashDotDot","12":"SlantedDashDot","13":"Thick"}[e.toString()],e.indexOf("Medium")>-1?t+="1pt ":e=="Thick"?t+="1.5pt ":t+="0.5pt ",e=="Hair"?t+="double ":e.indexOf("DashDotDot")>-1?t+="dotted ":e.indexOf("DashDot")>-1?t+="dashed ":e.indexOf("Dotted")>-1?t+="dotted ":e.indexOf("Dashed")>-1?t+="dashed ":t+="solid ",t+n+";"},copy:function(e){let n=window.clipboardData;n||(n=e.originalEvent.clipboardData),h.luckysheet_selection_range=[];let t=[],l=[],o=[],a=!1,s=!1;for(let b=0;b<h.luckysheet_select_save.length;b++){let g=h.luckysheet_select_save[b],v=g.row[0],x=g.row[1],_=g.column[0],S=g.column[1];for(let I=v;I<=x;I++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[I]!=null)){t.includes(I)||t.push(I),h.config.rowlen!=null&&I in h.config.rowlen&&(a=!0);for(let P=_;P<=S;P++){if(h.config.colhidden!=null&&h.config.colhidden[P]!=null)continue;l.includes(P)||l.push(P);let F=h.flowdata[I][P];G(F)=="object"&&"mc"in F&&F.mc.rs!=null&&(s=!0)}}h.luckysheet_selection_range.push({row:g.row,column:g.column}),o.push({row:g.row,column:g.column})}gr(),h.luckysheet_copy_save={dataSheetIndex:h.currentSheetIndex,copyRange:o,RowlChange:a,HasMC:s};let u=this,f;h.config.borderInfo&&h.config.borderInfo.length>0&&(f=la());let m="",d=It.deepCopyFlowData(h.flowdata),p="";for(let b=0;b<t.length;b++){let g=t[b];if(!(h.config.rowhidden!=null&&h.config.rowhidden[g]!=null)){h.config==null||h.config.rowlen==null||h.config.rowlen[g.toString()]==null?m+='<tr height="19">':m+=`<tr height="${h.config.rowlen[g.toString()]}">`;for(let v=0;v<l.length;v++){let x=l[v];if(g==t[0]&&(h.config==null||h.config.columnlen==null||h.config.columnlen[x.toString()]==null?p+='<col width="72px"></col>':p+='<col width="'+h.config.columnlen[x.toString()]+'px"></col>'),h.config.colhidden!=null&&h.config.colhidden[x]!=null)continue;let _='<td ${span} style="${style}">';if(d[g]!=null&&d[g][x]!=null){let S="",I="",P=/^(w|W)((0?)|(0\.0+))$/,F;if(d[g][x].ct!=null&&d[g][x].ct.fa!=null&&d[g][x].ct.fa.match(P)?F=Vt(g,x,d):F=Vt(g,x,d,"m"),S+=_t.getStyleByCell(d,g,x),G(d[g][x])=="object"&&"mc"in d[g][x])if("rs"in d[g][x].mc){if(I='rowspan="'+d[g][x].mc.rs+'" colspan="'+d[g][x].mc.cs+'"',f&&f[g+"_"+x]){let D={color:{},style:{}},k={color:{},style:{}},w={color:{},style:{}},C={color:{},style:{}};for(let z=g;z<g+d[g][x].mc.rs;z++)for(let A=x;A<x+d[g][x].mc.cs;A++){if(z==g&&f[z+"_"+A]&&f[z+"_"+A].t){let E=f[z+"_"+A].t.style,L=f[z+"_"+A].t.color;w.style[E]==null?w.style[E]=1:w.style[E]=w.style[E]+1,w.color[L]==null?w.color[L]=1:w.color[L]=w.color[L]+1}if(z==g+d[g][x].mc.rs-1&&f[z+"_"+A]&&f[z+"_"+A].b){let E=f[z+"_"+A].b.style,L=f[z+"_"+A].b.color;C.style[E]==null?C.style[E]=1:C.style[E]=C.style[E]+1,C.color[L]==null?C.color[L]=1:C.color[L]=C.color[L]+1}if(A==x&&f[z+"_"+A]&&f[z+"_"+A].l){let E=f[g+"_"+x].l.style,L=f[z+"_"+A].l.color;D.style[E]==null?D.style[E]=1:D.style[E]=D.style[E]+1,D.color[L]==null?D.color[L]=1:D.color[L]=D.color[L]+1}if(A==x+d[g][x].mc.cs-1&&f[z+"_"+A]&&f[z+"_"+A].r){let E=f[z+"_"+A].r.style,L=f[z+"_"+A].r.color;k.style[E]==null?k.style[E]=1:k.style[E]=k.style[E]+1,k.color[L]==null?k.color[L]=1:k.color[L]=k.color[L]+1}}let T=d[g][x].mc.rs,O=d[g][x].mc.cs;if(JSON.stringify(D).length>23){let z=null,A=null;for(let E in D.color)D.color[E]>=T/2&&(z=E);for(let E in D.style)D.style[E]>=T/2&&(A=E);z!=null&&A!=null&&(S+="border-left:"+u.getHtmlBorderStyle(A,z))}if(JSON.stringify(k).length>23){let z=null,A=null;for(let E in k.color)k.color[E]>=T/2&&(z=E);for(let E in k.style)k.style[E]>=T/2&&(A=E);z!=null&&A!=null&&(S+="border-right:"+u.getHtmlBorderStyle(A,z))}if(JSON.stringify(w).length>23){let z=null,A=null;for(let E in w.color)w.color[E]>=O/2&&(z=E);for(let E in w.style)w.style[E]>=O/2&&(A=E);z!=null&&A!=null&&(S+="border-top:"+u.getHtmlBorderStyle(A,z))}if(JSON.stringify(C).length>23){let z=null,A=null;for(let E in C.color)C.color[E]>=O/2&&(z=E);for(let E in C.style)C.style[E]>=O/2&&(A=E);z!=null&&A!=null&&(S+="border-bottom:"+u.getHtmlBorderStyle(A,z))}}}else continue;else if(f&&f[g+"_"+x]){if(f[g+"_"+x].l){let D=f[g+"_"+x].l.style,k=f[g+"_"+x].l.color;S+="border-left:"+u.getHtmlBorderStyle(D,k)}if(f[g+"_"+x].r){let D=f[g+"_"+x].r.style,k=f[g+"_"+x].r.color;S+="border-right:"+u.getHtmlBorderStyle(D,k)}if(f[g+"_"+x].b){let D=f[g+"_"+x].b.style,k=f[g+"_"+x].b.color;S+="border-bottom:"+u.getHtmlBorderStyle(D,k)}if(f[g+"_"+x].t){let D=f[g+"_"+x].t.style,k=f[g+"_"+x].t.color;S+="border-top:"+u.getHtmlBorderStyle(D,k)}}_=Tt(_,{style:S,span:I}),F==null&&(F=Vt(g,x,d)),F==null&&d[g][x]&&d[g][x].ct&&d[g][x].ct.t=="inlineStr"&&(F=d[g][x].ct.s.map(D=>{let k=$('<br style="mso-data-placement:same-cell;">');return D.v.split(`\r
`).map(C=>{if(!C)return"";let T=$("<font></font>");return D.fs&&T.css("font-size",`${D.fs}pt`),D.bl&&T.css("font-weight","bold"),D.it&&T.css("font-style","italic"),D.un&&T.css("text-decoration","underline"),D.fc&&T.css("color",D.fc),D.cl?T.append(`<s>${C}</s>`):T.text(C),T[0].outerHTML}).join(k[0].outerHTML)}).join("")),F==null&&(F=""),F=y.ltGtSignDeal(F),_+=F}else{let S="";if(f&&f[g+"_"+x]){if(f[g+"_"+x].l){let I=f[g+"_"+x].l.style,P=f[g+"_"+x].l.color;S+="border-left:"+u.getHtmlBorderStyle(I,P)}if(f[g+"_"+x].r){let I=f[g+"_"+x].r.style,P=f[g+"_"+x].r.color;S+="border-right:"+u.getHtmlBorderStyle(I,P)}if(f[g+"_"+x].b){let I=f[g+"_"+x].b.style,P=f[g+"_"+x].b.color;S+="border-bottom:"+u.getHtmlBorderStyle(I,P)}if(f[g+"_"+x].t){let I=f[g+"_"+x].t.style,P=f[g+"_"+x].t.color;S+="border-top:"+u.getHtmlBorderStyle(I,P)}}_+="",_=Tt(_,{style:S,span:""}),_+=""}_+="</td>",m+=_}m+="</tr>"}}if(m=`<table data-type="luckysheet_copy_action_table"><colgroup>${p}</colgroup>`+m+"</table>",h.iscopyself=!0,n)return n.setData("Text",m),!1;{let b=$("#luckysheet-copy-content");b.html(m),b.focus(),b.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){$("#luckysheet-copy-content").blur()},10)}},copybyformat:function(e,n){let t=window.clipboardData;t||(t=e.originalEvent&&e.originalEvent.clipboardData),h.luckysheet_selection_range=[{row:h.luckysheet_select_save[0].row,column:h.luckysheet_select_save[0].column}],gr();let l=n;if(h.iscopyself=!0,t)return t.setData("Text",l),!1;{let o=$("#luckysheet-copy-content");o.text(l),o.focus(),o.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){o.blur()},10)}},isPasteAction:!1,paste:function(e,n){let t=this;if(h.allowEdit===!1)return;let o=Be().drag,a=$("#luckysheet-copy-content");a.focus(),a.select(),setTimeout(function(){let s=a.html();s.indexOf("luckysheet_copy_action_table")>-1&&h.luckysheet_copy_save.copyRange!=null&&h.luckysheet_copy_save.copyRange.length>0?h.luckysheet_paste_iscut?(h.luckysheet_paste_iscut=!1,t.pasteHandlerOfCutPaste(h.luckysheet_copy_save),t.clearcopy(e)):t.pasteHandlerOfCopyPaste(h.luckysheet_copy_save):s.indexOf("luckysheet_copy_action_image")>-1?Pt.pasteImgItem():n!="btn"?t.pasteHandler(s):at()?alert(o.pasteMustKeybordAlert):ke.info(o.pasteMustKeybordAlertHTMLTitle,o.pasteMustKeybordAlertHTML)},10)},pasteHandler:function(e,n){if(!po(h.luckysheet_select_save,h.currentSheetIndex)||h.allowEdit===!1)return;let l=Be().paste;if(h.luckysheet_select_save.length>1&&(at()?alert(l.errorNotAllowMulti):ke.info(`<i class="fa fa-exclamation-triangle"></i>${l.warning}`,l.errorNotAllowMulti)),typeof e=="object"){if(e.length==0)return;let o=$.extend(!0,{},h.config);o.merge==null&&(o.merge={}),JSON.stringify(n).length>2&&o.borderInfo==null&&(o.borderInfo=[]);let a=e.length,s=e[0].length,u=h.luckysheet_select_save[0].row[0],f=u+a-1,m=h.luckysheet_select_save[0].column[0],d=m+s-1,p=!1;if(o.merge!=null&&(p=sr(o,u,f,m,d)),p){at()?alert(l.errorNotAllowMerged):ke.info(`<i class="fa fa-exclamation-triangle"></i>${l.warning}`,l.errorNotAllowMerged);return}let b=It.deepCopyFlowData(h.flowdata),g=b.length,v=b[0].length,x=f-g+1,_=d-v+1;(x>0||_>0)&&(b=cn([].concat(b),x,_,!0)),o.rowlen==null&&(o.rowlen={});let S=!1,I={};for(let P=u;P<=f;P++){let F=[].concat(b[P]),D=h.defaultrowlen;o.rowlen[P]!=null&&(D=o.rowlen[P]);for(let k=m;k<=d;k++){G(F[k])=="object"&&"mc"in F[k]&&("rs"in F[k].mc&&delete o.merge[F[k].mc.r+"_"+F[k].mc.c],delete F[k].mc);let w=null;if(e[P-u]!=null&&e[P-u][k-m]!=null&&(w=e[P-u][k-m]),F[k]=$.extend(!0,{},w),w!=null&&"mc"in F[k]&&(F[k].mc.rs!=null?(F[k].mc.r=P,F[k].mc.c=k,o.merge[F[k].mc.r+"_"+F[k].mc.c]=F[k].mc,I[w.mc.r+"_"+w.mc.c]=[F[k].mc.r,F[k].mc.c]):F[k]={mc:{r:I[w.mc.r+"_"+w.mc.c][0],c:I[w.mc.r+"_"+w.mc.c][1]}}),n[P-u+"_"+(k-m)]){let O={rangeType:"cell",value:{row_index:P,col_index:k,l:n[P-u+"_"+(k-m)].l,r:n[P-u+"_"+(k-m)].r,t:n[P-u+"_"+(k-m)].t,b:n[P-u+"_"+(k-m)].b}};o.borderInfo.push(O)}let C=rc(F[k]),T=_t.getTextSize("\u7530",C)[1];T>D&&(D=T,S=!0)}b[P]=F,D!=h.defaultrowlen&&(o.rowlen[P]=D)}if(h.luckysheet_select_save=[{row:[u,f],column:[m,d]}],x>0||_>0||S){let P={cfg:o,RowlChange:!0};al(b,h.luckysheet_select_save,P)}else{let P={cfg:o};al(b,h.luckysheet_select_save,P),gl()}}else{e=e.replace(/\r/g,"");let o=[],a=e.split(`
`),s=a[0].split("	").length;for(let _=0;_<a.length;_++)a[_].split("	").length<s||o.push(a[_].split("	"));let u=It.deepCopyFlowData(h.flowdata),f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row==null?0:f.row[0],d=f.column==null?0:f.column[0],p=o.length,b=o[0].length,g=!1;if(h.config.merge!=null&&(g=sr(h.config,m,m+p-1,d,d+b-1)),g){at()?alert(l.errorNotAllowMerged):ke.info(`<i class="fa fa-exclamation-triangle"></i>${l.warning}`,l.errorNotAllowMerged);return}let v=m+p-u.length,x=d+b-u[0].length;(v>0||x>0)&&(u=cn([].concat(u),v,x,!0));for(let _=0;_<p;_++){let S=[].concat(u[_+m]);for(let I=0;I<b;I++){let P=S[I+d],F=o[_][I];if(K(F)&&(P&&P.ct&&P.ct.fa==="@"?F=String(F):F=parseFloat(F)),P instanceof Object)P.v=F,P.ct!=null&&P.ct.fa!=null?P.m=Bl(P.ct.fa,F):P.m=F,P.f!=null&&P.f.length>0&&(P.f="",y.delFunctionGroup(_+m,I+d,h.currentSheetIndex));else{let D={},k=_l(F);D.v=k[2],D.ct=k[1],D.m=k[0],S[I+d]=D}}u[_+m]=S}if(f.row=[m,m+p-1],f.column=[d,d+b-1],v>0||x>0){let _={RowlChange:!0};al(u,h.luckysheet_select_save,_)}else al(u,h.luckysheet_select_save),gl()}},pasteHandlerOfCutPaste:function(e){if(!po(h.luckysheet_select_save,h.currentSheetIndex)||h.allowEdit===!1)return;let t=Be().paste,l=$.extend(!0,{},h.config);l.merge==null&&(l.merge={});let o=e.HasMC,a=e.RowlChange,s=e.dataSheetIndex,u=e.copyRange[0].row[0],f=e.copyRange[0].row[1],m=e.copyRange[0].column[0],d=e.copyRange[0].column[1],p=$.extend(!0,[],hr({row:[u,f],column:[m,d]},s)),b=p.length,g=p[0].length,v=h.luckysheet_select_save[h.luckysheet_select_save.length-1],x=v.row_focus,_=x+b-1,S=v.column_focus,I=S+g-1,P=!1;if(l.merge!=null&&(P=sr(l,x,_,S,I)),P){at()?alert(t.errorNotAllowMerged):ke.info(`<i class="fa fa-exclamation-triangle"></i>${t.warning}`,t.errorNotAllowMerged);return}let F=It.deepCopyFlowData(h.flowdata),D=F.length,k=F[0].length,w=b+x-D,C=g+S-k;(w>0||C>0)&&(F=cn([].concat(F),w,C,!0));let T=la(s),O=$.extend(!0,{},h.luckysheetfile[Me(s)].dataVerification),z=$.extend(!0,{},h.luckysheetfile[Me(h.currentSheetIndex)].dataVerification);if(h.currentSheetIndex==s){for(let N=u;N<=f;N++)for(let W=m;W<=d;W++){let X=F[N][W];G(X)=="object"&&"mc"in X&&("rs"in X.mc&&delete l.merge[X.mc.r+"_"+X.mc.c],delete X.mc),F[N][W]=null,delete z[N+"_"+W]}if(l.borderInfo&&l.borderInfo.length>0){let N=[];for(let W=0;W<l.borderInfo.length;W++){let X=l.borderInfo[W].rangeType;if(X=="range"){let te=l.borderInfo[W].range,ue=[];for(let pe=0;pe<te.length;pe++)ue=ue.concat(Mt.CFSplitRange(te[pe],{row:[u,f],column:[m,d]},{row:[x,_],column:[S,I]},"restPart"));l.borderInfo[W].range=ue,N.push(l.borderInfo[W])}else if(X=="cell"){let te=l.borderInfo[W].value.row_index,ue=l.borderInfo[W].value.col_index;te>=u&&te<=f&&ue>=m&&ue<=d||N.push(l.borderInfo[W])}}l.borderInfo=N}}let A={};for(let N=x;N<=_;N++){let W=[].concat(F[N]);for(let X=S;X<=I;X++){if(T[u+N-x+"_"+(m+X-S)]){let ue={rangeType:"cell",value:{row_index:N,col_index:X,l:T[u+N-x+"_"+(m+X-S)].l,r:T[u+N-x+"_"+(m+X-S)].r,t:T[u+N-x+"_"+(m+X-S)].t,b:T[u+N-x+"_"+(m+X-S)].b}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(ue)}else if(T[N+"_"+X]){let ue={rangeType:"cell",value:{row_index:N,col_index:X,l:null,r:null,t:null,b:null}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(ue)}O[u+N-x+"_"+(m+X-S)]&&(z[N+"_"+X]=O[u+N-x+"_"+(m+X-S)]),G(W[X])=="object"&&"mc"in W[X]&&("rs"in W[X].mc&&delete l.merge[W[X].mc.r+"_"+W[X].mc.c],delete W[X].mc);let te=null;p[N-x]!=null&&p[N-x][X-S]!=null&&(te=p[N-x][X-S]),W[X]=$.extend(!0,{},te),te!=null&&o&&"mc"in W[X]&&(W[X].mc.rs!=null?(W[X].mc.r=N,W[X].mc.c=X,l.merge[W[X].mc.r+"_"+W[X].mc.c]=W[X].mc,A[te.mc.r+"_"+te.mc.c]=[W[X].mc.r,W[X].mc.c]):W[X]={mc:{r:A[te.mc.r+"_"+te.mc.c][0],c:A[te.mc.r+"_"+te.mc.c][1]}})}F[N]=W}v.row=[x,_],v.column=[S,I],a&&(h.currentSheetIndex!=s?l=Cn(F,x,_,l):(l=Cn(F,u,f,l),l=Cn(F,x,_,l)));let E,L;if(h.currentSheetIndex!=s){let N=$.extend(!0,[],h.luckysheetfile[Me(s)].data),W=$.extend(!0,{},h.luckysheetfile[Me(s)].config),X=$.extend(!0,[],N),te=$.extend(!0,{},W);te.merge==null&&(te.merge={});for(let we=u;we<=f;we++)for(let ie=m;ie<=d;ie++){let ge=X[we][ie];G(ge)=="object"&&"mc"in ge&&("rs"in ge.mc&&delete te.merge[ge.mc.r+"_"+ge.mc.c],delete ge.mc),X[we][ie]=null}if(a&&(te=Cn(X,u,f,te)),te.borderInfo&&te.borderInfo.length>0){let we=[];for(let ie=0;ie<te.borderInfo.length;ie++){let ge=te.borderInfo[ie].rangeType;if(ge=="range"){let ce=te.borderInfo[ie].range,fe=[];for(let ye=0;ye<ce.length;ye++)fe=fe.concat(Mt.CFSplitRange(ce[ye],{row:[u,f],column:[m,d]},{row:[x,_],column:[S,I]},"restPart"));te.borderInfo[ie].range=fe,we.push(te.borderInfo[ie])}else if(ge=="cell"){let ce=te.borderInfo[ie].value.row_index,fe=te.borderInfo[ie].value.col_index;ce>=u&&ce<=f&&fe>=m&&fe<=d||we.push(te.borderInfo[ie])}}te.borderInfo=we}let ue=$.extend(!0,[],h.luckysheetfile[Me(s)].luckysheet_conditionformat_save),pe=$.extend(!0,[],ue),ne=[];if(pe!=null&&pe.length>0)for(let we=0;we<pe.length;we++){let ie=pe[we].cellrange,ge=[],ce=[];for(let fe=0;fe<ie.length;fe++){let ye=Mt.CFSplitRange(ie[fe],{row:[u,f],column:[m,d]},{row:[x,_],column:[S,I]},"restPart");ge=ge.concat(ye);let Ne=Mt.CFSplitRange(ie[fe],{row:[u,f],column:[m,d]},{row:[x,_],column:[S,I]},"operatePart");Ne.length>0&&(ce=ce.concat(Ne))}if(pe[we].cellrange=ge,ce.length>0){let fe=$.extend(!0,{},pe[we]);fe.cellrange=ce,ne.push(fe)}}let me=$.extend(!0,[],h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save),Q=$.extend(!0,[],me);ne.length>0&&(Q=Q.concat(ne));for(let we=u;we<=f;we++)for(let ie=m;ie<=d;ie++)delete O[we+"_"+ie];E={sheetIndex:s,data:N,curData:X,config:W,curConfig:te,cdformat:ue,curCdformat:pe,dataVerification:$.extend(!0,{},h.luckysheetfile[Me(s)].dataVerification),curDataVerification:O,range:{row:[u,f],column:[m,d]}},L={sheetIndex:h.currentSheetIndex,data:h.flowdata,curData:F,config:$.extend(!0,{},h.config),curConfig:l,cdformat:me,curCdformat:Q,dataVerification:$.extend(!0,{},h.luckysheetfile[Me(h.currentSheetIndex)].dataVerification),curDataVerification:z,range:{row:[x,_],column:[S,I]}}}else{let N=$.extend(!0,[],h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save),W=$.extend(!0,[],N);if(W!=null&&W.length>0)for(let X=0;X<W.length;X++){let te=W[X].cellrange,ue=[];for(let pe=0;pe<te.length;pe++){let ne=Mt.CFSplitRange(te[pe],{row:[u,f],column:[m,d]},{row:[x,_],column:[S,I]},"allPart");ue=ue.concat(ne)}W[X].cellrange=ue}E={sheetIndex:h.currentSheetIndex,data:h.flowdata,curData:F,config:$.extend(!0,{},h.config),curConfig:l,cdformat:N,curCdformat:W,dataVerification:$.extend(!0,{},h.luckysheetfile[Me(h.currentSheetIndex)].dataVerification),curDataVerification:z,range:{row:[u,f],column:[m,d]}},L={sheetIndex:h.currentSheetIndex,data:h.flowdata,curData:F,config:$.extend(!0,{},h.config),curConfig:l,cdformat:N,curCdformat:W,dataVerification:$.extend(!0,{},h.luckysheetfile[Me(h.currentSheetIndex)].dataVerification),curDataVerification:z,range:{row:[x,_],column:[S,I]}}}w>0||C>0?iu(E,L,!0):iu(E,L,a)},pasteHandlerOfCopyPaste:function(e){if(!po(h.luckysheet_select_save,h.currentSheetIndex))return;let t=Be().paste,l=$.extend(!0,{},h.config);l.merge==null&&(l.merge={});let o=e.HasMC,a=e.RowlChange,s=e.dataSheetIndex,u=e.copyRange[0].row[0],f=e.copyRange[0].row[1],m=e.copyRange[0].column[0],d=e.copyRange[0].column[1],p=[],b=!1;for(let Q=0;Q<e.copyRange.length;Q++){let we=hr({row:e.copyRange[Q].row,column:e.copyRange[Q].column},s);e.copyRange.length>1?u==e.copyRange[1].row[0]&&f==e.copyRange[1].row[1]?(we=we[0].map(function(ie,ge){return we.map(function(ce){return ce[ge]})}),p=p.concat(we),b=!0):m==e.copyRange[1].column[0]&&d==e.copyRange[1].column[1]&&(p=p.concat(we)):p=we}b&&(p=p[0].map(function(Q,we){return p.map(function(ie){return ie[we]})}));let g=$.extend(!0,[],p);if(e.copyRange.length>1)for(let Q=0;Q<g.length;Q++)for(let we=0;we<g[Q].length;we++)g[Q][we]!=null&&g[Q][we].f!=null&&(delete g[Q][we].f,delete g[Q][we].spl);let v=g.length,x=g[0].length,_=h.luckysheet_select_save[h.luckysheet_select_save.length-1],S=_.row[0],I=_.row[1],P=_.column[0],F=_.column[1],D=(I-S+1)%v,k=(F-P+1)%x;(D!=0||k!=0)&&(I=S+v-1,F=P+x-1);let w=!1;if(l.merge!=null&&(w=sr(l,S,I,P,F)),w){at()?alert(t.errorNotAllowMerged):ke.info(`<i class="fa fa-exclamation-triangle"></i>${t.warning}`,t.errorNotAllowMerged);return}let C=(I-S+1)/v,T=(F-P+1)/x,O=It.deepCopyFlowData(h.flowdata),z=O.length,A=O[0].length,E=v+S-z,L=x+P-A;(E>0||L>0)&&(O=cn([].concat(O),E,L,!0));let N=la(s),W=$.extend(!0,{},h.luckysheetfile[Me(s)].dataVerification),X=null,te=0,ue=0,pe=0,ne=0;for(let Q=1;Q<=C;Q++)for(let we=1;we<=T;we++){te=S+(Q-1)*v,ue=P+(we-1)*x,ne=S+Q*v,pe=P+we*x;let ie=te-u,ge=ue-m,ce={};for(let fe=te;fe<ne;fe++){let ye=[].concat(O[fe]);for(let Ne=ue;Ne<pe;Ne++){if(N[u+fe-te+"_"+(m+Ne-ue)]){let et={rangeType:"cell",value:{row_index:fe,col_index:Ne,l:N[u+fe-te+"_"+(m+Ne-ue)].l,r:N[u+fe-te+"_"+(m+Ne-ue)].r,t:N[u+fe-te+"_"+(m+Ne-ue)].t,b:N[u+fe-te+"_"+(m+Ne-ue)].b}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(et)}else if(N[fe+"_"+Ne]){let et={rangeType:"cell",value:{row_index:fe,col_index:Ne,l:null,r:null,t:null,b:null}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(et)}W[u+fe-te+"_"+(m+Ne-ue)]&&(X==null&&(X=$.extend(!0,{},h.luckysheetfile[Me(h.currentSheetIndex)].dataVerification)),X[fe+"_"+Ne]=W[u+fe-te+"_"+(m+Ne-ue)]),G(ye[Ne])=="object"&&"mc"in ye[Ne]&&("rs"in ye[Ne].mc&&delete l.merge[ye[Ne].mc.r+"_"+ye[Ne].mc.c],delete ye[Ne].mc);let xe=null;if(g[fe-te]!=null&&g[fe-te][Ne-ue]!=null&&(xe=$.extend(!0,{},g[fe-te][Ne-ue])),xe!=null&&xe.f!=null){let et=xe.f;ie>0&&(et="="+y.functionCopy(et,"down",ie)),ie<0&&(et="="+y.functionCopy(et,"up",Math.abs(ie))),ge>0&&(et="="+y.functionCopy(et,"right",ge)),ge<0&&(et="="+y.functionCopy(et,"left",Math.abs(ge)));let Fe=y.execfunction(et,fe,Ne,void 0,!0);xe.spl!=null?(xe.f=Fe[2],xe.v=Fe[1],xe.spl=Fe[3].data):(xe.f=Fe[2],xe.v=Fe[1],xe.ct!=null&&xe.ct.fa!=null&&(xe.m=Bl(xe.ct.fa,Fe[1])))}ye[Ne]=$.extend(!0,{},xe),xe!=null&&o&&"mc"in ye[Ne]&&(ye[Ne].mc.rs!=null?(ye[Ne].mc.r=fe,ye[Ne].mc.c=Ne,l.merge[ye[Ne].mc.r+"_"+ye[Ne].mc.c]=ye[Ne].mc,ce[xe.mc.r+"_"+xe.mc.c]=[ye[Ne].mc.r,ye[Ne].mc.c]):ye[Ne]={mc:{r:ce[xe.mc.r+"_"+xe.mc.c][0],c:ce[xe.mc.r+"_"+xe.mc.c][1]}})}O[fe]=ye}}let me=null;if(e.copyRange.length==1){let Q=h.luckysheetfile[Me(s)],we=h.luckysheetfile[Me(h.currentSheetIndex)],ie=$.extend(!0,[],Q.luckysheet_conditionformat_save);if(ie!=null&&ie.length>0){me=$.extend(!0,[],we.luckysheet_conditionformat_save);for(let ge=0;ge<ie.length;ge++){let ce=ie[ge].cellrange,fe=[];for(let ye=1;ye<=C;ye++)for(let Ne=1;Ne<=T;Ne++){te=S+(ye-1)*v,ue=P+(Ne-1)*x,ne=S+ye*v,pe=P+Ne*x;for(let xe=0;xe<ce.length;xe++){let et=Mt.CFSplitRange(ce[xe],{row:[u,f],column:[m,d]},{row:[te,ne-1],column:[ue,pe-1]},"operatePart");et.length>0&&(fe=fe.concat(et))}}fe.length>0&&(ie[ge].cellrange=fe,me.push(ie[ge]))}}}if(_.row=[S,I],_.column=[P,F],a||E>0||L>0){l=Cn(O,S,I,l);let Q={cfg:l,RowlChange:!0,cdformat:me,dataVerification:X};al(O,h.luckysheet_select_save,Q)}else{let Q={cfg:l,cdformat:me,dataVerification:X};al(O,h.luckysheet_select_save,Q),gl()}},pasteHandlerOfPaintModel:function(e){if(!po(h.luckysheet_select_save,h.currentSheetIndex))return;let t=Be().paste,l=$.extend(!0,{},h.config);l.merge==null&&(l.merge={});let o=e.HasMC,a=e.RowlChange,s=e.dataSheetIndex,u=e.copyRange[0].row[0],f=e.copyRange[0].row[1],m=e.copyRange[0].column[0],d=e.copyRange[0].column[1],p=$.extend(!0,[],hr({row:[u,f],column:[m,d]},s)),b=h.luckysheet_select_save[h.luckysheet_select_save.length-1],g=b.row[0],v=b.row[1],x=b.column[0],_=b.column[1],S=p.length,I=p[0].length;if(g==v&&x==_){let X=!1;if(l.merge!=null&&(X=sr(l,g,g+S-1,x,x+I-1)),X){at()?alert(t.errorNotAllowMerged):ke.info(`<i class="fa fa-exclamation-triangle"></i>${t.warning}`,t.errorNotAllowMerged);return}v=g+S-1,_=x+I-1}let P=Math.ceil((v-g+1)/S),F=Math.ceil((_-x+1)/I),D=It.deepCopyFlowData(h.flowdata),k=D[0].length,w=D.length,C=la(s),T=$.extend(!0,{},h.luckysheetfile[Me(s)].dataVerification),O=null,z=0,A=0,E=0,L=0;for(let X=1;X<=P;X++)for(let te=1;te<=F;te++){z=g+(X-1)*S,A=x+(te-1)*I,L=g+X*S>w?w:g+X*S,L>v+1&&(L=v+1),E=x+te*I>k?k:x+te*I,E>_+1&&(E=_+1);let ue={};for(let pe=z;pe<L;pe++){let ne=[].concat(D[pe]);for(let me=A;me<E;me++){if(C[u+pe-z+"_"+(m+me-A)]){let we={rangeType:"cell",value:{row_index:pe,col_index:me,l:C[u+pe-z+"_"+(m+me-A)].l,r:C[u+pe-z+"_"+(m+me-A)].r,t:C[u+pe-z+"_"+(m+me-A)].t,b:C[u+pe-z+"_"+(m+me-A)].b}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(we)}else if(C[pe+"_"+me]){let we={rangeType:"cell",value:{row_index:pe,col_index:me,l:null,r:null,t:null,b:null}};l.borderInfo==null&&(l.borderInfo=[]),l.borderInfo.push(we)}T[u+pe-z+"_"+(m+me-A)]&&(O==null&&(O=$.extend(!0,{},h.luckysheetfile[Me(h.currentSheetIndex)].dataVerification)),O[pe+"_"+me]=T[u+pe-z+"_"+(m+me-A)]),G(ne[me])=="object"&&"mc"in ne[me]&&("rs"in ne[me].mc&&delete l.merge[ne[me].mc.r+"_"+ne[me].mc.c],delete ne[me].mc);let Q=null;if(p[pe-z]!=null&&p[pe-z][me-A]!=null&&(Q=p[pe-z][me-A]),Q!=null&&(delete Q.v,delete Q.m,delete Q.f,delete Q.spl,Q.ct&&Q.ct.t=="inlineStr"&&delete Q.ct,G(ne[me])=="object"?ne[me].ct&&ne[me].ct.t==="inlineStr"?delete Q.ct:["bg","fc","ct","ht","vt","bl","it","cl","un","fs","ff","tb"].forEach(ie=>{Reflect.deleteProperty(ne[me],ie)}):ne[me]={v:ne[me]},ne[me]=$.extend(!0,ne[me],Q),ne[me].ct&&ne[me].ct.t==="inlineStr"&&ne[me].ct.s.forEach(we=>we=$.extend(!0,we,Q)),o&&"mc"in ne[me]&&(ne[me].mc.rs!=null?(ne[me].mc.r=pe,ne[me].mc.rs+pe>=L&&(ne[me].mc.rs=L-pe),ne[me].mc.c=me,ne[me].mc.cs+me>=E&&(ne[me].mc.cs=E-me),l.merge[ne[me].mc.r+"_"+ne[me].mc.c]=ne[me].mc,ue[Q.mc.r+"_"+Q.mc.c]=[ne[me].mc.r,ne[me].mc.c]):ne[me]={mc:{r:ue[Q.mc.r+"_"+Q.mc.c][0],c:ue[Q.mc.r+"_"+Q.mc.c][1]}}),ne[me].v!=null&&Q.ct!=null&&Q.ct.fa!=null)){let we=Bl(Q.ct.fa,ne[me].v);ne[me].m=we}}D[pe]=ne}}let N=null,W=$.extend(!0,[],h.luckysheetfile[Me(s)].luckysheet_conditionformat_save);if(W!=null&&W.length>0){N=$.extend(!0,[],h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save);for(let X=0;X<W.length;X++){let te=W[X].cellrange,ue=[];for(let pe=0;pe<te.length;pe++){let ne=Mt.CFSplitRange(te[pe],{row:[u,f],column:[m,d]},{row:[g,v],column:[x,_]},"operatePart");ne.length>0&&(ue=ue.concat(ne))}ue.length>0&&(W[X].cellrange=[{row:[g,v],column:[x,_]}],N.push(W[X]))}}if(b.row=[g,v],b.column=[x,_],a){l=Cn(D,g,v,l);let X={cfg:l,RowlChange:!0,cdformat:N,dataVerification:O};al(D,h.luckysheet_select_save,X)}else{v>=D.length&&(v=D.length-1),l=Cn(D,g,v,l);let X={cfg:l,RowlChange:!0,cdformat:N,dataVerification:O};al(D,h.luckysheet_select_save,X),gl()}},matchcopy:function(e,n){let t=[],l=[],o,a;if(typeof e=="object")t=e;else{t=e.split(`
`);for(let s=0;s<t.length;s++)t[s]=t[s].split("	")}if(o=t.length,typeof n=="object")l=n;else{l=n.split(`
`);for(let s=0;s<l.length;s++)l[s]=l[s].split("	")}if(a=l.length,o!=a)return!1;for(let s=0;s<o;s++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[s]!=null)){for(let u=0;u<a;u++)if(t[s].length!=l[u].length)return!1}for(let s=0;s<o;s++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[s]!=null)){for(let u=0;u<t[0].length;u++)if(Vt(s,u,t)!=Vt(s,u,l))return!1}return!0}},Ql=c3});function Jr(e){$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cell-selected-boxs .luckysheet-cell-selected").hide(),$("#luckysheet-cols-h-selected .luckysheet-cols-h-selected").hide(),$("#luckysheet-rows-h-selected .luckysheet-rows-h-selected").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-selection-copy .luckysheet-selection-copy").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),e||Ql.clearcopy(e),$("#luckysheet-dropCell-icon").is(":visible")&&e&&$("#luckysheet-dropCell-icon").remove(),_t.luckysheetPaintModelOn&&!e&&_t.cancelPaintModel()}var import_plugin,Jo=Nt(()=>{import_plugin=qe(Ye());ou();ln()});function ng(e,n,t,l,o){let a=s0();a=Tt(a,{logotitle:o}),a=Tt(a,{menu:C0()});let s=c0;h.config==null&&(h.config={}),Xa(n,e);let f=Be().info,m='<button id="luckysheet-bottom-add-row" class="btn btn-default">'+f.add+'</button><input id="luckysheet-bottom-add-row-input" type="text" class="luckysheet-datavisual-config-input luckysheet-mousedown-cancel" placeholder="'+(ut.addRowCount||100)+'"><span style="font-size: 14px;">'+f.row+'</span><span style="font-size: 14px;color: #9c9c9c;">('+f.addLast+")</span>",d=' <button id="luckysheet-bottom-bottom-top" class="btn btn-default" style="">'+f.backTop+"</button>",p=Tt(f.pageInfo,{total:ut.total?ut.total:"",totalPage:ut.pageInfo.totalPage?ut.pageInfo.totalPage:"",currentPage:ut.pageInfo.currentPage?ut.pageInfo.currentPage:""}),b=' <span id="luckysheet-bottom-page-info" style="font-size: 14px;color: #f34141;">'+p+'</span> <button id="luckysheet-bottom-page-next" class="btn btn-danger" style="">\u4E0B\u4E00\u9875</button>',g=' <span id="luckysheet-bottom-page-info" style="font-size: 14px;color: #f34141;">'+p+"</span>",v="";ut.enableAddRow&&(v+=m),ut.enablePage&&(parseInt(ut.pageInfo.totalPage)==1?v+=g:v+=b),ut.enableAddBackTop&&(v+=d);let x=Tt('<div id="luckysheetcoltable_0" class="luckysheet-cell-flow-col"> <div id ="luckysheet-sheettable_0" class="luckysheet-cell-sheettable" style="height:${height}px;width:${width}px;"></div><div id="luckysheet-bottom-controll-row" class="luckysheet-bottom-controll-row"> '+v+" </div> </div>",{height:h.rh_height,width:h.ch_width-1}),_=Tt(m0,{width:h.ch_width,index:0,column:""});s=Tt(s,{width:h.ch_width,flow:x,index:0}),a=Tt(a,{flow:s,rowHeader:"<div style='height:"+h.rh_height+"px' id='luckysheetrowHeader_0' class='luckysheetsheetchange'></div>",columnHeader:_,functionButton:ut.functionButton}),$("#"+h.container).append(a),$("#luckysheet-scrollbar-x div").width(h.ch_width),$("#luckysheet-scrollbar-y div").height(h.rh_height+h.columnHeaderHeight-h.cellMainSrollBarSize-3),$("body").first().append(y0),$("body").first().append(u0),$("body").first().append(f0()),$("body").first().append(v0),$("body").first().append(Tt(Xf(),{menuid:"filter"})),$("body").first().append(Tt(Zf(),{menuid:"filter"})),$("body").first().append(k0()),$("#luckysheet-rows-h").width(h.rowHeaderWidth-1.5),$("#luckysheet-cols-h-c").height(h.columnHeaderHeight-1.5),$("#luckysheet-left-top").css({width:h.rowHeaderWidth-1.5,height:h.columnHeaderHeight-1.5}),$("#luckysheet_info_detail_input").val(ut.title)}var import_plugin,f1=Nt(()=>{import_plugin=qe(Ye());Rr();Vn();ta();Er();Wr();lf();Ol();il();Xl()});function h1(e){e==null&&(e="chart");for(var n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="",l=0;l<12;l++)t+=n[Math.round(Math.random()*(n.length-1))];var o=new Date().getTime();return e+"_"+t+"_"+o}function ig(e,n){return e.replace(/\$\{([\w]+)\}/g,function(t,l){var o=n[l];return typeof o!="undefined"?o:t})}var import_plugin,d1=Nt(()=>{import_plugin=qe(Ye())});var import_plugin,vo,ts,u3,q,hf=Nt(()=>{import_plugin=qe(Ye());Ol();cr();ui();Sr();vo=qe(Za()),ts={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},u3={getCellDataArr:function(e,n,t){let l=[];if(e.data==null)t||(n==="number"?l.push(0):n==="text"&&l.push(""));else if(G(e.data)==="array")for(let o=0;o<e.data.length;o++)for(let a=0;a<e.data[o].length;a++){let s=e.data[o][a],u=s;G(s)==="object"&&(u=s.v),u==null?t||(n==="number"?u=0:n==="text"&&(u=""),l.push(u)):l.push(u)}else ft(e.data.v)?t||(n=="number"?l.push(0):n=="text"&&l.push("")):l.push(e.data.v);return l},getCellDataDyadicArr:function(e,n){let t=[];if(e.data==null){let l=[];n=="number"?l.push(0):n=="text"&&l.push(""),t.push(l)}else if(G(e.data)=="array")for(let l=0;l<e.data.length;l++){let o=[];for(let a=0;a<e.data[l].length;a++){let s=e.data[l][a],u=s;G(s)==="object"&&(u=s.v),u==null&&(n==="number"?u=0:n==="text"&&(u="")),o.push(u)}t.push(o)}else{let l=[],o=e.data.v;ft(o)&&(n=="number"?o=0:n=="text"&&(o="")),l.push(o),t.push(l)}return t},getDataArr:function(e,n){let t=[];if(n==null&&(n=!1),G(e[0])=="array")for(let l=0;l<e.length;l++)for(let o=0;o<e[l].length;o++)n&&!K(e[l][o])||t.push(e[l][o]);else for(let l=0;l<e.length;l++)n&&!K(e[l])||t.push(e[l]);return t},getDataDyadicArr:function(e){let n=[];if(G(e[0])=="array")for(let t=0;t<e.length;t++){let l=[];for(let o=0;o<e[t].length;o++)l.push(e[t][o]);n.push(l)}else{let t=[];for(let l=0;l<e.length;l++)t.push(e[l]);n.push(t)}return n},isDyadicArr:function(e){let n=!0;if(e.length>1){let t=e[0].length;for(let l=1;l<e.length;l++)if(e[l].length!=t){n=!1;break}}return n},getFirstValue:function(e,n){let t=this;n==null&&(n="number");let l;if(G(e)=="array")if(G(e[0])=="array"){if(!t.isDyadicArr(e))return ts.v;l=e[0][0]}else l=e[0];else if(G(e)=="object"&&e.startCell!=null)if(e.data==null)n=="number"?l=0:n=="text"&&(l="");else{let o=window.luckysheetCurrentRow,a=window.luckysheetCurrentColumn;if(e.rowl==1&&e.coll==1)l=e.data,l==null||ft(l.v)?n=="number"?l=0:n=="text"&&(l=""):l=l.v;else if(e.data[0][0].mc!=null&&e.data[0][0].mc.rs==e.rowl&&e.data[0][0].mc.cs==e.coll)l=e.data[0][0],l==null||ft(l.v)?n=="number"?l=0:n=="text"&&(l=""):l=l.v;else if(e.rowl==1||e.coll==1){let s=y.getcellrange(e.startCell),u=s.row[0],f=u+e.rowl-1,m=s.column[0],d=m+e.coll-1;if(e.rowl==1){if(a<m||a>d)return ts.v;l=e.data[0][a-m]}else if(e.coll==1){if(o<u||o>f)return ts.v;l=e.data[o-u][0]}l==null||ft(l.v)||l.mc!=null?n=="number"?l=0:n=="text"&&(l=""):l=l.v}else return ts.v}else l=e;return l},getCellBoolen:function(e){let t=this.getFirstValue(e);if(re(t))return t;if(G(t)!="boolean")if(G(t)=="string"&&(t.toLowerCase()=="true"||t.toLowerCase()=="false"))t.toLowerCase()=="true"?t=!0:t.toLowerCase()=="false"&&(t=!1);else if(K(t))t=parseFloat(t),t=t!=0;else return ts.v;return t},getCellDate:function(e){let n=this,t;if(G(e)=="array")if(G(e[0])=="array"){if(!n.isDyadicArr(e))return ts.v;t=e[0][0]}else t=e[0];else if(G(e)=="object"&&e.startCell!=null){if(e.data==null||G(e.data)=="array"||ft(e.data.v))return ts.v;t=e.data.v,e.data.ct!=null&&e.data.ct.t=="d"&&(t=Bl("YYYY-MM-DD h:mm:ss",t))}else t=e;return t},getCellrangeDate:function(e){let n=this,t=[];if(G(e)=="array"){if(G(e[0])=="array"&&!n.isDyadicArr(e))return ts.v;t=t.concat(n.getDataArr(e,!1))}else if(G(e)=="object"&&e.startCell!=null)if(e.data==null)t.push(0);else if(G(e.data)=="array")for(let l=0;l<e.data.length;l++)for(let o=0;o<e.data[l].length;o++)if(e.data[l][o]!=null&&!ft(e.data[l][o].v)){let a=e.data[l][o].v;e.data[l][o].ct!=null&&e.data[l][o].ct.t=="d"&&(a=Bl("YYYY-MM-DD h:mm:ss",a)),t.push(a)}else t.push(0);else{let l=e.data.v;e.data.ct!=null&&e.data.ct.t=="d"&&(l=Bl("YYYY-MM-DD h:mm:ss",l)),t.push(l)}else t.push(e);return t},getRegExpStr:function(e){return e.replace("~*","\\*").replace("~?","\\?").replace(".","\\.").replace("*",".*").replace("?",".")},factorial:function(e){return e==0||e==1?1:e*this.factorial(e-1)},factorialDouble:function(e){return e<=0?1:e*this.factorialDouble(e-2)},variance:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return o/t},variance_s:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return o/(t-1)},standardDeviation:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return Math.sqrt(o/t)},standardDeviation_s:function(e){let n=0,t=0;for(let a=0;a<e.length;a++)n+=e[a],t++;let l=n/t,o=0;for(let a=0;a<e.length;a++){let s=e[a];o+=(s-l)*(s-l)}return Math.sqrt(o/(t-1))},isLeapYear:function(e){return new Date(e,1,29).getMonth()===1},feb29Between:function(e,n){let t=this,l=(0,vo.default)(e).year(),o=(0,vo.default)().set({year:l,month:2,date:1});if(t.isLeapYear(l)&&(0,vo.default)(e)<(0,vo.default)(o)&&(0,vo.default)(n)>=(0,vo.default)(o))return!0;let a=(0,vo.default)(n).year(),s=(0,vo.default)().set({year:a,month:2,date:1});return t.isLeapYear(a)&&(0,vo.default)(n)>=(0,vo.default)(s)&&(0,vo.default)(e)<(0,vo.default)(s)},findResultIndex:function(e,n){let t={};for(let a=1;a<e[0].length;++a)t[a]=!0;let l=n[0].length;for(i=1;i<n.length;++i)n[i].length>l&&(l=n[i].length);for(let a=1;a<e.length;++a)for(let s=1;s<e[a].length;++s){let u=!1,f=!1;for(let m=0;m<n.length;++m){let d=n[m];if(d.length<l)continue;let p=d[0];if(e[a][0]===p){f=!0;for(let b=1;b<d.length;++b)u=u||new Function("return "+e[a][s]+d[b])()}}f&&(t[s]=t[s]&&u)}let o=[];for(let a=0;a<e[0].length;++a)t[a]&&o.push(a-1);return o},findField:function(e,n){let t=null;for(let l=0;l<e.length;l++)if(e[l][0]==n){t=l;break}return t??ts.v},rest:function(e,n){return n=n||1,!e||typeof e.slice!="function"?e:e.slice(n)},compact:function(e){if(!e)return e;let n=[];for(let t=0;t<e.length;++t)!e[t]||n.push(e[t]);return n}},q=u3});function Th(e){var n=m1.sylvester_matrix.create(e);return n.inverse().elements}var import_plugin,m1,f3,og=Nt(()=>{import_plugin=qe(Ye()),m1={},f3=function(n){var t=function(){};t.precision=1e-6,t.create=function(o){var a=new t;return a.setElements(o)};var l=t.create;t.I=function(o){for(var a=[],s=o,u;s--;)for(u=o,a[s]=[];u--;)a[s][u]=s===u?1:0;return t.create(a)},t.prototype={e:function(o,a){return o<1||o>this.elements.length||a<1||a>this.elements[0].length?null:this.elements[o-1][a-1]},dimensions:function(){var o=this.elements.length===0?0:this.elements[0].length;return{rows:this.elements.length,cols:o}},rows:function(){return this.elements.length},cols:function(){return this.elements.length===0?0:this.elements[0].length},eql:function(o){var a=o.elements||o;if((!a[0]||typeof a[0][0]=="undefined")&&(a=t.create(a).elements),this.elements.length===0||a.length===0)return this.elements.length===a.length;if(this.elements.length!==a.length||this.elements[0].length!==a[0].length)return!1;for(var s=this.elements.length,u=this.elements[0].length,f;s--;)for(f=u;f--;)if(Math.abs(this.elements[s][f]-a[s][f])>t.precision)return!1;return!0},dup:function(){return t.create(this.elements)},map:function(o,a){if(this.elements.length===0)return t.create([]);for(var s=[],u=this.elements.length,f=this.elements[0].length,m;u--;)for(m=f,s[u]=[];m--;)s[u][m]=o.call(a,this.elements[u][m],u+1,m+1);return t.create(s)},isSameSizeAs:function(o){var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.elements.length===0?a.length===0:this.elements.length===a.length&&this.elements[0].length===a[0].length},add:function(o){if(this.elements.length===0)return this.map(function(s){return s});var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.isSameSizeAs(a)?this.map(function(s,u,f){return s+a[u-1][f-1]}):null},subtract:function(o){if(this.elements.length===0)return this.map(function(s){return s});var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.isSameSizeAs(a)?this.map(function(s,u,f){return s-a[u-1][f-1]}):null},canMultiplyFromLeft:function(o){if(this.elements.length===0)return!1;var a=o.elements||o;return typeof a[0][0]=="undefined"&&(a=t.create(a).elements),this.elements[0].length===a.length},multiply:function(o){if(this.elements.length===0)return null;if(!o.elements)return this.map(function(v){return v*o});var a=!!o.modulus,s=o.elements||o;if(typeof s[0][0]=="undefined"&&(s=t.create(s).elements),!this.canMultiplyFromLeft(s))return null;for(var u=this.elements.length,f=s[0].length,m,d=this.elements[0].length,p,b=[],g;u--;)for(m=f,b[u]=[];m--;){for(p=d,g=0;p--;)g+=this.elements[u][p]*s[p][m];b[u][m]=g}var s=t.create(b);return a?s.col(1):s},minor:function(o,a,s,u){if(this.elements.length===0)return null;for(var f=[],m=s,d,p,b,g=this.elements.length,v=this.elements[0].length;m--;)for(d=s-m-1,f[d]=[],p=u;p--;)b=u-p-1,f[d][b]=this.elements[(o+d-1)%g][(a+b-1)%v];return t.create(f)},transpose:function(){if(this.elements.length===0)return t.create([]);for(var o=this.elements.length,a,s=this.elements[0].length,u,f=[],a=s;a--;)for(u=o,f[a]=[];u--;)f[a][u]=this.elements[u][a];return t.create(f)},isSquare:function(){var o=this.elements.length===0?0:this.elements[0].length;return this.elements.length===o},max:function(){if(this.elements.length===0)return null;for(var o=0,a=this.elements.length,s=this.elements[0].length,u;a--;)for(u=s;u--;)Math.abs(this.elements[a][u])>Math.abs(o)&&(o=this.elements[a][u]);return o},indexOf:function(o){if(this.elements.length===0)return null;var a=null,s=this.elements.length,u,f=this.elements[0].length,m;for(u=0;u<s;u++)for(m=0;m<f;m++)if(this.elements[u][m]===o)return{i:u+1,j:m+1};return null},diagonal:function(){if(!this.isSquare)return null;for(var o=[],a=this.elements.length,s=0;s<a;s++)o.push(this.elements[s][s]);return t.create(o)},toRightTriangular:function(){if(this.elements.length===0)return t.create([]);var o=this.dup(),a,s=this.elements.length,u,f,m=this.elements[0].length,d;for(u=0;u<s;u++){if(o.elements[u][u]===0){for(f=u+1;f<s;f++)if(o.elements[f][u]!==0){for(a=[],d=0;d<m;d++)a.push(o.elements[u][d]+o.elements[f][d]);o.elements[u]=a;break}}if(o.elements[u][u]!==0)for(f=u+1;f<s;f++){var p=o.elements[f][u]/o.elements[u][u];for(a=[],d=0;d<m;d++)a.push(d<=u?0:o.elements[f][d]-o.elements[u][d]*p);o.elements[f]=a}}return o},determinant:function(){if(this.elements.length===0)return 1;if(!this.isSquare())return null;for(var o=this.toRightTriangular(),a=o.elements[0][0],s=o.elements.length,u=1;u<s;u++)a=a*o.elements[u][u];return a},isSingular:function(){return this.isSquare()&&this.determinant()===0},trace:function(){if(this.elements.length===0)return 0;if(!this.isSquare())return null;for(var o=this.elements[0][0],a=this.elements.length,s=1;s<a;s++)o+=this.elements[s][s];return o},rank:function(){if(this.elements.length===0)return 0;for(var o=this.toRightTriangular(),a=0,s=this.elements.length,u=this.elements[0].length,f;s--;)for(f=u;f--;)if(Math.abs(o.elements[s][f])>t.precision){a++;break}return a},augment:function(o){if(this.elements.length===0)return this.dup();var a=o.elements||o;typeof a[0][0]=="undefined"&&(a=t.create(a).elements);var s=this.dup(),u=s.elements[0].length,f=s.elements.length,m=a[0].length,d;if(f!==a.length)return null;for(;f--;)for(d=m;d--;)s.elements[f][u+d]=a[f][d];return s},inverse:function(){if(this.elements.length===0||!this.isSquare()||this.isSingular())return null;for(var o=this.elements.length,a=o,s,u=this.augment(t.I(o)).toRightTriangular(),f=u.elements[0].length,m,d,p,b=[],g;a--;){for(d=[],b[a]=[],p=u.elements[a][a],m=0;m<f;m++)g=u.elements[a][m]/p,d.push(g),m>=o&&b[a].push(g);for(u.elements[a]=d,s=a;s--;){for(d=[],m=0;m<f;m++)d.push(u.elements[s][m]-u.elements[a][m]*u.elements[s][a]);u.elements[s]=d}}return t.create(b)},round:function(){return this.map(function(o){return Math.round(o)})},snapTo:function(o){return this.map(function(a){return Math.abs(a-o)<=t.precision?o:a})},setElements:function(o){var a,s,u=o.elements||o;if(u[0]&&typeof u[0][0]!="undefined"){for(a=u.length,this.elements=[];a--;)for(s=u[a].length,this.elements[a]=[];s--;)this.elements[a][s]=u[a][s];return this}var f=u.length;for(this.elements=[],a=0;a<f;a++)this.elements.push([u[a]]);return this}},n.sylvester_matrix=t};f3(m1)});function au(){let e=arguments[1],n=arguments[0],t;G(n)=="object"&&n.startCell!=null?(e=="&"?t=q.getCellDataDyadicArr(n,"text"):t=q.getCellDataDyadicArr(n,"number"),t.length==1&&t[0].length==1&&(t=t[0][0])):t=n;let l=arguments[2],o;if(G(l)=="object"&&l.startCell!=null?(e=="&"?o=q.getCellDataDyadicArr(l,"text"):o=q.getCellDataDyadicArr(l,"number"),o.length==1&&o[0].length==1&&(o=o[0][0])):o=l,re(t))return t;if(re(o))return o;if(G(t)=="array"&&G(t[0])=="array"&&!q.isDyadicArr(t))return Et.v;if(G(o)=="array"&&G(o[0])=="array"&&!q.isDyadicArr(o))return Et.v;if(e=="<>"&&(e="!="),e=="="&&(e="=="),t==null&&o==null)return"#INVERSE!";if(t=="#INVERSE!")t=0,e=="-"?e="+":e=="+"&&(e="-");else if(e=="-"&&t==null)t=0;else if(e=="/"&&(o==0||o==null))return Et.d;function a(u,f,m){if(K(u)&&(u=parseFloat(u)),K(m)&&(m=parseFloat(m)),f=="==")return u==m;if(f=="!=")return u!=m;if(f==">=")return u>=m;if(f=="<=")return u<=m;if(f==">")return u>m;if(f=="<")return u<m}function s(u){return u==null?u:u.toString().toLowerCase()=="true"?1:u.toString().toLowerCase()=="false"?0:u}if(e=="*")if(G(t)=="array"&&G(o)=="array"){let u=[];if(G(t[0])=="array"&&G(o[0])=="array")if(t.length==o.length&&t[0].length==o[0].length)for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[f][d]=s(o[f][d]);let p;K(t[f][d])&&K(o[f][d])?p=er(t[f][d],e,o[f][d]):p=Et.v,m.push(p)}u.push(m)}else if(t[0].length==o.length){let f=t.length,m=o[0].length;for(let d=0;d<f;d++){let p=[];for(let b=0;b<m;b++){let g=0;for(let v=0;v<t[0].length;v++)t[d][v]=s(t[d][v]),o[v][b]=s(o[v][b]),K(t[d][v])&&K(o[v][b])?g+=er(t[d][v],e,o[v][b]):g+=Et.v;g.toString()=="NaN"&&(g=Et.v),p.push(g)}u.push(p)}}else if(t.length==o[0].length){let f=o.length,m=t[0].length;for(let d=0;d<f;d++){let p=[];for(let b=0;b<m;b++){let g=0;for(let v=0;v<o[0].length;v++)t[v][b]=s(t[v][b]),o[d][v]=s(o[d][v]),K(o[d][v])&&K(t[v][b])?g+=er(t[v][b],e,o[d][v]):g+=Et.v;g.toString()=="NaN"&&(g=Et.v),p.push(g)}u.push(p)}}else return Et.na;else if(G(t[0])=="array")if(t[0].length==o.length)for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[d]=s(o[d]);let p;K(t[f][d])&&K(o[d])?p=er(t[f][d],e,o[d]):p=Et.v,m.push(p)}u.push(m)}else if(t[0].length==1){let f=t.length,m=o.length;for(let d=0;d<f;d++){let p=[];for(let b=0;b<m;b++){t[d][0]=s(t[d][0]),o[b]=s(o[b]);let g;K(t[d][0])&&K(o[b])?g=er(t[d][0],e,o[b]):g=Et.v,p.push(g)}u.push(p)}}else return Et.na;else if(G(o[0])=="array")if(o[0].length==t.length)for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){t[d]=s(t[d]),o[f][d]=s(o[f][d]);let p;K(t[d])&&K(o[f][d])?p=er(t[d],e,o[f][d]):p=Et.v,m.push(p)}u.push(m)}else if(o[0].length==1){let f=o.length,m=t.length;for(let d=0;d<f;d++){let p=[];for(let b=0;b<m;b++){t[b]=s(t[b]),o[d][0]=s(o[d][0]);let g;K(t[b])&&K(o[d][0])?g=er(t[b],e,o[d][0]):g=Et.v,p.push(g)}u.push(p)}}else return Et.na;else{if(t.length!=o.length)return Et.na;for(let f=0;f<t.length;f++){t[f]=s(t[f]),o[f]=s(o[f]);let m;K(t[f])&&K(o[f])?m=er(t[f],e,o[f]):m=Et.v,u.push(m)}}return u}else if(G(t)=="array"){o=s(o);let u=[];if(G(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]);let p;K(t[f][d])&&K(o)?p=er(t[f][d],e,o):p=Et.v,m.push(p)}u.push(m)}else for(let f=0;f<t.length;f++){t[f]=s(t[f]);let m;K(t[f])&&K(o)?m=er(t[f],e,o):m=Et.v,u.push(m)}return u}else if(G(o)=="array"){t=s(t);let u=[];if(G(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){o[f][d]=s(o[f][d]);let p;K(t)&&K(o[f][d])?p=er(t,e,o[f][d]):p=Et.v,m.push(p)}u.push(m)}else for(let f=0;f<o.length;f++){o[f]=s(o[f]);let m;K(t)&&K(o[f])?m=er(t,e,o[f]):m=Et.v,u.push(m)}return u}else{t=s(t),o=s(o);let u;return K(t)&&K(o)?u=er(t,e,o):u=Et.v,u}else if(e=="/")if(G(t)=="array"&&G(o)=="array"){let u=[];if(G(t[0])=="array"&&G(o[0])=="array")if(t.length==o.length&&t[0].length==o[0].length)for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[f][d]=s(o[f][d]);let p;K(t[f][d])&&K(o[f][d])?parseFloat(o[f][d])==0?p=Et.d:p=er(t[f][d],e,o[f][d]):p=Et.v,m.push(p)}u.push(m)}else if(t[0].length==o.length){let f=Th(o),m=t.length,d=f[0].length;for(let p=0;p<m;p++){let b=[];for(let g=0;g<d;g++){let v=0;for(let x=0;x<t[0].length;x++)t[p][x]=s(t[p][x]),f[x][g]=s(f[x][g]),K(t[p][x])&&K(f[x][g])?v+=er(t[p][x],"*",f[x][g]):v+=Et.v;v.toString()=="NaN"&&(v=Et.v),b.push(v)}u.push(b)}}else return Et.na;else if(G(t[0])=="array")if(t[0].length==o.length)for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[d]=s(o[d]);let p;K(t[f][d])&&K(o[d])?parseFloat(o[d])==0?p=Et.d:p=er(t[f][d],e,o[d]):p=Et.v,m.push(p)}u.push(m)}else if(t[0].length==1){let f=t.length,m=o.length;for(let d=0;d<f;d++){let p=[];for(let b=0;b<m;b++){t[d][0]=s(t[d][0]),o[b]=s(o[b]);let g;K(t[d][0])&&K(o[b])?parseFloat(o[b])==0?g=Et.d:g=er(t[d][0],e,o[b]):g=Et.v,p.push(g)}u.push(p)}}else return Et.na;else if(G(o[0])=="array")if(o[0].length==t.length)for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){t[d]=s(t[d]),o[f][d]=s(o[f][d]);let p;K(t[d])&&K(o[f][d])?parseFloat(o[f][d])==0?p=Et.d:p=er(t[d],e,o[f][d]):p=Et.v,m.push(p)}u.push(m)}else if(o[0].length==1){let f=o.length,m=t.length;for(let d=0;d<f;d++){let p=[];for(let b=0;b<m;b++){t[b]=s(t[b]),o[d][0]=s(o[d][0]);let g;K(t[b])&&K(o[d][0])?parseFloat(o[d][0])==0?g=Et.d:g=er(t[b],e,o[d][0]):g=Et.v,p.push(g)}u.push(p)}}else return Et.na;else{if(t.length!=o.length)return Et.na;for(let f=0;f<t.length;f++){t[f]=s(t[f]),o[f]=s(o[f]);let m;K(t[f])&&K(o[f])?parseFloat(o[f])==0?m=Et.d:m=er(t[f],e,o[f]):m=Et.v,u.push(m)}}return u}else if(G(t)=="array"){o=s(o);let u=[];if(G(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]);let p;K(t[f][d])&&K(o)?parseFloat(o)==0?p=Et.d:p=er(t[f][d],e,o):p=Et.v,m.push(p)}u.push(m)}else for(let f=0;f<t.length;f++){t[f]=s(t[f]);let m;K(t[f])&&K(o)?parseFloat(o)==0?m=Et.d:m=er(t[f],e,o):m=Et.v,u.push(m)}return u}else if(G(o)=="array"){t=s(t);let u=[];if(G(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){o[f][d]=s(o[f][d]);let p;K(t)&&K(o[f][d])?parseFloat(o[f][d])==0?p=Et.d:p=er(t,e,o[f][d]):p=Et.v,m.push(p)}u.push(m)}else for(let f=0;f<o.length;f++){o[f]=s(o[f]);let m;K(t)&&K(o[f])?parseFloat(o[f])==0?m=Et.d:m=er(t,e,o[f]):m=Et.v,u.push(m)}return u}else{t=s(t),o=s(o);let u;return K(t)&&K(o)?parseFloat(o)==0?u=Et.d:u=er(t,e,o):u=Et.v,u}else if(e=="+"||e=="-"||e=="%")if(G(t)=="array"&&G(o)=="array"){let u=[];if(G(t[0])=="array"&&G(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return Et.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[f][d]=s(o[f][d]);let p;K(t[f][d])&&K(o[f][d])?e=="%"&&parseFloat(o[f][d])==0?p=Et.d:p=er(t[f][d],e,o[f][d]):p=Et.v,m.push(p)}u.push(m)}}else if(G(t[0])=="array"){if(t[0].length!=o.length)return Et.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[d]=s(o[d]);let p;K(t[f][d])&&K(o[d])?e=="%"&&parseFloat(o[d])==0?p=Et.d:p=er(t[f][d],e,o[d]):p=Et.v,m.push(p)}u.push(m)}}else if(G(o[0])=="array"){if(o[0].length!=t.length)return Et.na;for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){t[d]=s(t[d]),o[f][d]=s(o[f][d]);let p;K(t[d])&&K(o[f][d])?e=="%"&&parseFloat(o[f][d])==0?p=Et.d:p=er(t[d],e,o[f][d]):p=Et.v,m.push(p)}u.push(m)}}else{if(t.length!=o.length)return Et.na;for(let f=0;f<t.length;f++){t[f]=s(t[f]),o[f]=s(o[f]);let m;K(t[f])&&K(o[f])?e=="%"&&parseFloat(o[f])==0?m=Et.d:m=er(t[f],e,o[f]):m=Et.v,u.push(m)}}return u}else if(G(t)=="array"){o=s(o);let u=[];if(G(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]);let p;K(t[f][d])&&K(o)?e=="%"&&parseFloat(o)==0?p=Et.d:p=er(t[f][d],e,o):p=Et.v,m.push(p)}u.push(m)}else for(let f=0;f<t.length;f++){t[f]=s(t[f]);let m;K(t[f])&&K(o)?e=="%"&&parseFloat(o)==0?m=Et.d:m=er(t[f],e,o):m=Et.v,u.push(m)}return u}else if(G(o)=="array"){t=s(t);let u=[];if(G(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){o[f][d]=s(o[f][d]);let p;K(t)&&K(o[f][d])?e=="%"&&parseFloat(o[f][d])==0?p=Et.d:p=er(t,e,o[f][d]):p=Et.v,m.push(p)}u.push(m)}else for(let f=0;f<o.length;f++){o[f]=s(o[f]);let m;K(t)&&K(o[f])?e=="%"&&parseFloat(o[f])==0?m=Et.d:m=er(t,e,o[f]):m=Et.v,u.push(m)}return u}else{t=s(t),o=s(o);let u;return K(t)&&K(o)?e=="%"&&parseFloat(o)==0?u=Et.d:u=er(t,e,o):u=Et.v,u}else if(e=="=="||e=="!="||e==">="||e=="<="||e==">"||e=="<")if(G(t)=="array"&&G(o)=="array"){let u=[];if(G(t[0])=="array"&&G(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return Et.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){let p=a(t[f][d],e,o[f][d]);m.push(p)}u.push(m)}}else if(G(t[0])=="array"){if(t[0].length!=o.length)return Et.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){let p=a(t[f][d],e,o[d]);m.push(p)}u.push(m)}}else if(G(o[0])=="array"){if(o[0].length!=t.length)return Et.na;for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){let p=a(t[d],e,o[f][d]);m.push(p)}u.push(m)}}else{if(t.length!=o.length)return Et.na;for(let f=0;f<t.length;f++){let m=a(t[f],e,o[f]);u.push(m)}}return u}else if(G(t)=="array"){let u=[];if(G(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){let p=a(t[f][d],e,o);m.push(p)}u.push(m)}else for(let f=0;f<t.length;f++){let m=a(t[f],e,o);u.push(m)}return u}else if(G(o)=="array"){let u=[];if(G(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){let p=a(t,e,o[f][d]);m.push(p)}u.push(m)}else for(let f=0;f<o.length;f++){let m=a(t,e,o[f]);u.push(m)}return u}else return a(t,e,o);else if(e=="&")if(G(t)=="array"&&G(o)=="array"){let u=[];if(G(t[0])=="array"&&G(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return Et.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++)m.push(t[f][d]+""+o[f][d]);u.push(m)}}else if(G(t[0])=="array"){if(t[0].length!=o.length)return Et.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++)m.push(t[f][d]+""+o[d]);u.push(m)}}else if(G(o[0])=="array"){if(o[0].length!=t.length)return Et.na;for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++)m.push(t[d]+""+o[f][d]);u.push(m)}}else{if(t.length!=o.length)return Et.na;for(let f=0;f<t.length;f++)u.push(t[f]+""+o[f])}return u}else if(G(t)=="array"){let u=[];if(G(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++)m.push(t[f][d]+""+o);u.push(m)}else for(let f=0;f<t.length;f++)u.push(t[f]+""+o);return u}else if(G(o)=="array"){let u=[];if(G(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++)m.push(t+""+o[f][d]);u.push(m)}else for(let f=0;f<o.length;f++)u.push(t+""+o[f]);return u}else return t+""+o;else if(e=="^")if(G(t)=="array"&&G(o)=="array"){let u=[];if(G(t[0])=="array"&&G(o[0])=="array"){if(t.length!=o.length&&t[0].length!=o[0].length)return Et.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[f][d]=s(o[f][d]);let p;K(t[f][d])&&K(o[f][d])?p=Math.pow(parseFloat(t[f][d]),parseFloat(o[f][d])):p=Et.v,m.push(p)}u.push(m)}}else if(G(t[0])=="array"){if(t[0].length!=o.length)return Et.na;for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]),o[d]=s(o[d]);let p;K(t[f][d])&&K(o[d])?p=Math.pow(parseFloat(t[f][d]),parseFloat(o[d])):p=Et.v,m.push(p)}u.push(m)}}else if(G(o[0])=="array"){if(o[0].length!=t.length)return Et.na;for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){t[d]=s(t[d]),o[f][d]=s(o[f][d]);let p;K(t[d])&&K(o[f][d])?p=Math.pow(parseFloat(t[d]),parseFloat(o[f][d])):p=Et.v,m.push(p)}u.push(m)}}else{if(t.length!=o.length)return Et.na;for(let f=0;f<t.length;f++){t[f]=s(t[f]),o[f]=s(o[f]);let m;K(t[f])&&K(o[f])?m=Math.pow(parseFloat(t[f]),parseFloat(o[f])):m=Et.v,u.push(m)}}return u}else if(G(t)=="array"){o=s(o);let u=[];if(G(t[0])=="array")for(let f=0;f<t.length;f++){let m=[];for(let d=0;d<t[f].length;d++){t[f][d]=s(t[f][d]);let p;K(t[f][d])&&K(o)?p=Math.pow(parseFloat(t[f][d]),parseFloat(o)):p=Et.v,m.push(p)}u.push(m)}else for(let f=0;f<t.length;f++){t[f]=s(t[f]);let m;K(t[f])&&K(o)?m=Math.pow(parseFloat(t[f]),parseFloat(o)):m=Et.v,u.push(m)}return u}else if(G(o)=="array"){t=s(t);let u=[];if(G(o[0])=="array")for(let f=0;f<o.length;f++){let m=[];for(let d=0;d<o[f].length;d++){o[f][d]=s(o[f][d]);let p;K(t)&&K(o[f][d])?p=Math.pow(parseFloat(t),parseFloat(o[f][d])):p=Et.v,m.push(p)}u.push(m)}else for(let f=0;f<o.length;f++){o[f]=s(o[f]);let m;K(t)&&K(o[f])?m=Math.pow(parseFloat(t),parseFloat(o[f])):m=Et.v,u.push(m)}return u}else{t=s(t),o=s(o);let u;return K(t)&&K(o)?u=Math.pow(parseFloat(t),parseFloat(o)):u=Et.v,u}}function ag(){let e=arguments[0];e=e.replace("{","").replace("}","").replace(/\"/g,"");let n=[];if(e.indexOf(";")>-1){n=e.split(";");for(let t=0;t<n.length;t++)n[t]=n[t].split(",")}else n=e.split(",");return n}function er(e,n,t){let l;return n=="+"?l=(0,df.default)(e).add(t).value():n=="-"?l=(0,df.default)(e).subtract(t).value():n=="%"?l=new Function("return "+parseFloat(e)+n+"("+parseFloat(t)+")")():n=="/"?l=(0,df.default)(e).divide(t).value():n=="*"&&(l=(0,df.default)(e).multiply(t).value()),l}function Ji(e){if(window.luckysheet_getcelldata_cache==null&&(window.luckysheet_getcelldata_cache={}),e in window.luckysheet_getcelldata_cache)return window.luckysheet_getcelldata_cache[e];let n=ur(),t=e.split("!"),l="",o="",a=-1,s=null;if(t.length>1){l=t[0].replace(/''/g,"'"),o=t[1],l.substr(0,1)=="'"&&l.substr(l.length-1,1)=="'"&&(l=l.substring(1,l.length-1));for(let u in n)if(l==n[u].name){a=n[u].index,s=n[u].data;break}a==-1&&(a=0)}else{let u=Me(h.calculateSheetIndex);l=n[u].name,a=n[u].index,s=n[u].data,o=t[0]}if(o.indexOf(":")==-1){let u=parseInt(o.replace(/[^0-9]/g,""))-1,f=fn(o.replace(/[^A-Za-z]/g,""));if(!isNaN(u)&&!isNaN(f)){let m=ef(s,{row:[u,u],column:[f,f]})[0][0];if(y.execFunctionGlobalData!=null){let g=y.execFunctionGlobalData[u+"_"+f+"_"+a];g!=null&&(m=g)}let b={sheetName:l,startCell:o,rowl:1,coll:1,data:m};return window.luckysheet_getcelldata_cache[e]=b,b}else return[]}else{o=o.split(":");let u=[],f=[];if(u[0]=parseInt(o[0].replace(/[^0-9]/g,""))-1,u[1]=parseInt(o[1].replace(/[^0-9]/g,""))-1,isNaN(u[0])&&(u[0]=0),isNaN(u[1])&&(u[1]=s.length-1),u[0]>u[1])return ke.info("\u9009\u62E9\u5931\u8D25","\u8F93\u5165\u8303\u56F4\u9519\u8BEF\uFF01"),[];if(f[0]=fn(o[0].replace(/[^A-Za-z]/g,"")),f[1]=fn(o[1].replace(/[^A-Za-z]/g,"")),isNaN(f[0])&&(f[0]=0),isNaN(f[1])&&(f[1]=s[0].length-1),f[0]>f[1])return ke.info("\u9009\u62E9\u5931\u8D25","\u8F93\u5165\u8303\u56F4\u9519\u8BEF\uFF01"),[];let m=ef(s,{row:u,column:f});if(y.execFunctionGlobalData!=null)for(let g=u[0];g<=u[1];g++)for(let v=f[0];v<=f[1];v++){let x=y.execFunctionGlobalData[g+"_"+v+"_"+a];x!=null&&(m[g-u[0]][v-f[0]]=x)}let d=u[1]-u[0]+1,p=f[1]-f[0]+1,b={sheetName:l,startCell:o[0],rowl:d,coll:p,data:m};return window.luckysheet_getcelldata_cache[e]=b,b}}function su(e){if(typeof e=="object")return e==null?"":Array.isArray(e)?_l(e[0])[2]:Array.isArray(e.data)?Et.v:e.data.v===void 0?"":e.data.v;if(y.isCompareOperator(e).flag){if(typeof e=="string"||typeof e=="number")return e}else return _l(e)[2];return Et.v}function ls(){let e=arguments[0];for(let n=0;n<e.length;n++){let t=e[n];typeof t=="object"?t==null?t="":Array.isArray(t)?t=_l(t[0])[2]:Array.isArray(t.data)?t=t.data:t.data.v===void 0?t="":t=t.data.v:y.isCompareOperator(t).flag||(t=_l(t)[2]),e[n]=t}}function sg(){let e=arguments[0];return e==null||e.length==0?null:e}function cg(e){return e}function ug(){if(!(G(arguments[0])=="object"&&arguments[0].startCell!=null))return y.error.v;var e=arguments[0].startCell,n=q.getFirstValue(arguments[1]);if(re(n))return n;if(!K(n))return y.error.v;n=parseInt(n);var t=q.getFirstValue(arguments[2]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=arguments[0].rowl;if(arguments.length>=4){if(l=q.getFirstValue(arguments[3]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}var o=arguments[0].coll;if(arguments.length==5){if(o=q.getFirstValue(arguments[4]),re(o))return o;if(!K(o))return y.error.v;o=parseInt(o)}if(l<1||o<1)return y.error.r;var a=y.getcellrange(e),s=a.row[0],u=a.column[0];s+=n,u+=t;var f=s+l-1,m=u+o-1;return s<0||f>=h.flowdata.length||u<0||m>=h.flowdata[0].length?y.error.r:Kl(h.calculateSheetIndex,{row:[s,f],column:[u,m]})}function fg(e,n,t){let l,o;if(e?(o=n,l=t):(l=n,o=t),l.startCell.indexOf(":")>-1||o.indexOf(":")>-1)return Et.v;if(e)return Ji(o+":"+l.startCell);{let a=o,s="";if(o.indexOf("!")>-1){let u=o.split("!");s=u[0]+"!",a=u[1]}return Ji(s+l.startCell+":"+a)}}var import_plugin,df,mf=Nt(()=>{import_plugin=qe(Ye());hf();Sr();Kr();cr();Er();ui();og();fr();Ol();il();df=qe(nc())});function v1(e,n){Mh(d3),Fh(h3,null,function(){let t=new Vuex.Store;console.info("chartmix::",chartmix.default),Vue.use(chartmix.default,{store:t});let l=document.getElementsByTagName("body")[0];chartmix.default.initChart(l,h.lang),$(".chartSetting").css({top:"1px",bottom:"1px",position:"absolute",right:"0px",width:"350px",background:"#fff",border:"1px solid #E5E5E5","z-index":1004,"box-shadow":"0px 2px 4px rgba(0,0,0,0.2)","-webkit-box-shadow":"0px 2px 4px rgba(0,0,0,0.2)","-moz-box-shadow":"0px 2px 4px rgba(0,0,0,0.2)","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none","padding-left":"30px",display:"none"}),h.createChart=chartmix.default.createChart,h.highlightChart=chartmix.default.highlightChart,h.deleteChart=chartmix.default.deleteChart,h.resizeChart=chartmix.default.resizeChart,h.changeChartRange=chartmix.default.changeChartRange,h.changeChartCellData=chartmix.default.changeChartCellData,h.getChartJson=chartmix.default.getChartJson,h.chart_selection=p3(),h.chartparam.jfrefreshchartall=g3,h.chartparam.changeChartCellData=chartmix.default.changeChartCellData,h.chartparam.renderChart=chartmix.default.renderChart,h.chartparam.getChartJson=chartmix.default.getChartJson,h.chartparam.insertToStore=chartmix.default.insertToStore;for(let o=0;o<e.length;o++)m3(e[o].chart,n);for(let o=0;o<e.length;o++)e[o].status=="1"&&mg(e[o].index);Dh(h.asyncLoad,"chart")})}function m3(e,n){if(e!=null)for(let t=0;t<e.length;t++){let l=e[t];n&&h.chartparam.insertToStore({chart_id:l.chart_id,chartOptions:l.chartOptions});let o=l.chart_id,a=o+"_c",s='<div id="${id}"class="luckysheet-modal-dialog luckysheet-modal-dialog-chart ${addclass}"tabindex="0"role="dialog"aria-labelledby=":41e"dir="ltr"><div class="luckysheet-modal-dialog-resize"><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt"data-type="lt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt"data-type="mt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm"data-type="lm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm"data-type="rm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt"data-type="rt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb"data-type="lb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb"data-type="mb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb"data-type="rb"></div></div><div class="luckysheet-modal-dialog-controll"><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-update"role="button"tabindex="0"aria-label="\u4FEE\u6539\u56FE\u8868"title="\u4FEE\u6539\u56FE\u8868"><i class="fa fa-pencil"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-max"role="butluckysheet_chartIns_indexton"tabindex="0"aria-label="\u6700\u5927\u5316"title="\u6700\u5927\u5316"><i class="fa fa-window-maximize"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del"role="button"tabindex="0"aria-label="\u5220\u9664"title="\u5220\u9664"><i class="fa fa-trash"aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-content">${content}</div></div>',u=$(ig(s,{id:a,addclass:"luckysheet-data-visualization-chart",title:"\u56FE\u8868\u751F\u6210",content:""})).appendTo($(".luckysheet-cell-main"));y1(u),$(`#${a}`).children(".luckysheet-modal-dialog-content")[0].id=o;let f=document.getElementById(a),m;m=h.chartparam.getChartJson(l.chart_id),h.chartparam.renderChart({chart_id:l.chart_id,chartOptions:m}),h.currentChart=m,cu(o),$(`#${o}_c .luckysheet-modal-controll-del`).click(function(v){k1(o)}),$(`#${o}_c .luckysheet-modal-controll-update`).click(function(v){x1()}),u.children(".luckysheet-modal-dialog-content").mousedown(function(v){h.chartparam.luckysheetCurrentChartMaxState||cu(o),v.stopPropagation()}),u.mousedown(function(v){if(!h.chartparam.luckysheetCurrentChartMaxState){cu(o),pa(!0),!$(v.target).is(".luckysheet-modal-dialog-controll")&&!$(v.target).is(".luckysheet-modal-controll-btn")&&!$(v.target).is("i")&&(h.chartparam.luckysheetCurrentChartMoveTimeout=setTimeout(function(){h.chartparam.luckysheetCurrentChartMove=!0},100));var x=h.chartparam.luckysheetCurrentChartMoveObj.offset(),_=h.chartparam.luckysheetCurrentChartMoveObj.position();h.chartparam.luckysheetCurrentChartMoveXy=[v.pageX-x.left,v.pageY-x.top,_.left,_.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()],h.chartparam.luckysheetCurrentChartMoveWinH=$("#luckysheet-cell-main")[0].scrollHeight,h.chartparam.luckysheetCurrentChartMoveWinW=$("#luckysheet-cell-main")[0].scrollWidth,!$(v.target).hasClass("luckysheet-mousedown-cancel")&&$(v.target).filter("[class*='sp-palette']").length==0&&$(v.target).filter("[class*='sp-thumb']").length==0&&$(v.target).filter("[class*='sp-']").length==0&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide()),v.stopPropagation()}}).find(".luckysheet-modal-dialog-resize-item").mousedown(function(v){if(h.chartparam.luckysheetCurrentChartActive){h.chartparam.luckysheetCurrentChartResize=$(this).data("type");var x=wl(v.pageX,v.pageY),_=$("#luckysheet-scrollbar-x").scrollLeft(),S=$("#luckysheet-scrollbar-y").scrollTop(),I=x[0]+_,P=x[1]+S,F=h.chartparam.luckysheetCurrentChartResizeObj.position();h.chartparam.luckysheetCurrentChartResizeXy=[I,P,u.width(),u.height(),F.left+_,F.top+S,_,S],h.chartparam.luckysheetCurrentChartResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,h.chartparam.luckysheetCurrentChartResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,h.chartparam.luckysheetCurrentChart=o,v.stopPropagation()}});let d=l.width,p=l.height,b=l.left,g=l.top;f.style.width=d+"px",f.style.height=p+"px",f.style.position="absolute",f.style.background="#fff",f.style.left=b+"px",f.style.top=g+"px",f.style.zIndex=h.zIndex?h.zIndex:15,h.zIndex++}}function g3(e,n,t,l,o){let a=h.currentChart;if(!!a&&a.rangeArray.length==1){var s=a.rangeArray[0].row,u=a.rangeArray[0].column;if(n>s[1]||t<s[0]||l>u[1]||o<u[0])return;var f=y.getcellrange(a.rangeTxt),m=f.sheetIndex==-1?0:f.sheetIndex,d={row:f.row,column:f.column,dataSheetIndex:m},p=Ji(a.rangeTxt);if(typeof p=="object"&&p.length!=0&&p.data.length!=null){var b=p.data;h.chartparam.changeChartCellData(a.chart_id,b)}}}function p3(){return{create:function(){var e=h.currentChart;if(e.rangeArray.length>1)return;$("#luckysheet-chart-rangeShow").empty(),$("#luckysheet-cell-selected-boxs").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide();var n=e.rangeArray[0].row[0],t=e.rangeArray[0].column[0],l=e.rangeSplitArray,o=e.rangeRowCheck;if(o.exits)var a=m("rowtitle",l.rowtitle.row[0]+n,l.rowtitle.row[1]+n,l.rowtitle.column[0]+t,l.rowtitle.column[1]+t);else var a="";var s=e.rangeColCheck;if(s.exits)var u=m("coltitle",l.coltitle.row[0]+n,l.coltitle.row[1]+n,l.coltitle.column[0]+t,l.coltitle.column[1]+t);else var u="";var f=m("content",l.content.row[0]+n,l.content.row[1]+n,l.content.column[0]+t,l.content.column[1]+t);$("#luckysheet-chart-rangeShow").append(a+u+f);function m(d,p,b,g,v){var x=Kf(),_=Jf(),S=x[b],I=p-1==-1?0:x[p-1],P=_[v],F=g-1==-1?0:_[g-1];if(d=="rowtitle")var D="#C65151";if(d=="coltitle")var D="#9667C0";if(d=="content")var D="#4970D1";var k='<div id="luckysheet-chart-rangeShow-'+d+'" style="left: '+F+"px;width: "+(P-F-1)+"px;top: "+I+"px;height: "+(S-I-1)+'px;border: none;margin: 0;position: absolute;z-index: 14;"><div class="luckysheet-chart-rangeShow-move" data-type="top" style="height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: '+D+';position: absolute;left: 0;right: 0;top: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="right" style="width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: '+D+';position: absolute;top: 0;bottom: 0;right: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="bottom" style="height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: '+D+';position: absolute;left: 0;right: 0;bottom: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="luckysheet-chart-rangeShow-move" data-type="left" style="width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: '+D+';position: absolute;top: 0;bottom: 0;left: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div style="border: 2px solid #85c0fc;background: '+D+';position: absolute;top: 0;right: 0;bottom: 0;left: 0;z-index: 15;opacity: 0.1;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="lt" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+D+';position: absolute;left: -3px;top: -3px;z-index: 19;cursor: se-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="rt" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+D+';position: absolute;right: -3px;top: -3px;z-index: 19;cursor: ne-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="lb" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+D+';position: absolute;left: -3px;bottom: -3px;z-index: 19;cursor: ne-resize;"></div><div class="luckysheet-chart-rangeShow-resize" data-type="rb" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+D+';position: absolute;right: -3px;bottom: -3px;z-index: 19;cursor: se-resize;"></div></div>';return k}},rangeMove:!1,rangeMovexy:null,rangeMoveIndex:null,rangeMoveObj:null,rangeMoveDraging:function(e,n,t){var l=h.currentChart,o=l.rangeArray[0].row[0],a=l.rangeArray[0].column[0],s=l.rangeRowCheck,u=l.rangeColCheck,f=l.rangeSplitArray,m=wl(e.pageX,e.pageY),d=$("#luckysheet-cell-main").scrollLeft(),p=$("#luckysheet-cell-main").scrollTop(),b=m[0]+d,g=m[1]+p,v=$(window).height()+p-n-t,x=$(window).width()+d,_=g1(g),S=_[2],I=p1(b),P=I[2],F=Kf(),D=Jf(),k=h.chart_selection.rangeMoveObj.attr("id");if(k=="luckysheet-chart-rangeShow-content"){var w=h.chart_selection.rangeMoveIndex[0]-h.chart_selection.rangeMovexy[0]+S;s.exits?(w<o+s.range[1]+1||g<0)&&(w=o+s.range[1]+1):(w<0||g<0)&&(w=0);var C=f.content.row[1]-f.content.row[0]+w;(C>=F.length-1||g>v)&&(w=F.length-1-f.content.row[1]+f.content.row[0],C=F.length-1);var T=h.chart_selection.rangeMoveIndex[1]-h.chart_selection.rangeMovexy[1]+P;u.exits?(T<a+u.range[1]+1||b<0)&&(T=a+u.range[1]+1):(T<0||b<0)&&(T=0);var O=f.content.column[1]-f.content.column[0]+T;(O>=D.length-1||b>x)&&(T=D.length-1-f.content.column[1]+f.content.column[0],O=D.length-1),s.exits&&u.exits?(l.rangeArray=[{row:[o,C],column:[a,O]}],l.rangeSplitArray.range={row:[o,C],column:[a,O]},l.rangeSplitArray.content={row:[w-o,C-o],column:[T-a,O-a]},l.rangeSplitArray.rowtitle={row:l.rangeSplitArray.rowtitle.row,column:[T-a,O-a]},l.rangeSplitArray.coltitle={row:[w-o,C-o],column:l.rangeSplitArray.coltitle.column}):s.exits?(l.rangeArray=[{row:[o,C],column:[T,O]}],l.rangeSplitArray.range={row:[o,C],column:[T,O]},l.rangeSplitArray.content={row:[w-o,C-o],column:l.rangeSplitArray.content.column}):u.exits?(l.rangeArray=[{row:[w,C],column:[a,O]}],l.rangeSplitArray.range={row:[w,C],column:[a,O]},l.rangeSplitArray.content={row:l.rangeSplitArray.content.row,column:[T-a,O-a]}):(l.rangeArray=[{row:[w,C],column:[T,O]}],l.rangeSplitArray.range={row:[w,C],column:[T,O]})}else if(k=="luckysheet-chart-rangeShow-rowtitle"){var T=h.chart_selection.rangeMoveIndex[1]-h.chart_selection.rangeMovexy[1]+P;u.exits?(T<a+u.range[1]+1||b<0)&&(T=a+u.range[1]+1):(T<0||b<0)&&(T=0);var O=f.rowtitle.column[1]-f.rowtitle.column[0]+T;(O>=D.length-1||b>x)&&(T=D.length-1-f.rowtitle.column[1]+f.rowtitle.column[0],O=D.length-1),u.exits?(l.rangeArray=[{row:l.rangeArray[0].row,column:[a,O]}],l.rangeSplitArray.range={row:l.rangeArray[0].row,column:[a,O]},l.rangeSplitArray.rowtitle={row:l.rangeSplitArray.rowtitle.row,column:[T-a,O-a]},l.rangeSplitArray.content={row:l.rangeSplitArray.content.row,column:[T-a,O-a]}):(l.rangeArray=[{row:l.rangeArray[0].row,column:[T,O]}],l.rangeSplitArray.range={row:l.rangeArray[0].row,column:[T,O]})}else if(k=="luckysheet-chart-rangeShow-coltitle"){var w=h.chart_selection.rangeMoveIndex[0]-h.chart_selection.rangeMovexy[0]+S;s.exits?(w<o+s.range[1]+1||g<0)&&(w=o+s.range[1]+1):(w<0||g<0)&&(w=0);var C=f.coltitle.row[1]-f.coltitle.row[0]+w;(C>=F.length-1||g>v)&&(w=F.length-1-f.coltitle.row[1]+f.coltitle.row[0],C=F.length-1),s.exits?(l.rangeArray=[{row:[o,C],column:l.rangeArray[0].column}],l.rangeSplitArray.range={row:[o,C],column:l.rangeArray[0].column},l.rangeSplitArray.coltitle={row:[w-o,C-o],column:l.rangeSplitArray.coltitle.column},l.rangeSplitArray.content={row:[w-o,C-o],column:l.rangeSplitArray.content.column}):(l.rangeArray=[{row:[w,C],column:l.rangeArray[0].column}],l.rangeSplitArray.range={row:[w,C],column:l.rangeArray[0].column})}h.chart_selection.create()},rangeMoveDragged:function(){h.chart_selection.rangeMove=!1;var e=h.currentChart;e.rangeTxt=Kl(h.currentSheetIndex,e.rangeArray[0],h.currentSheetIndex),e.chartData=hr(e.rangeArray[0],h.currentSheetIndex),h.changeChartRange(e.chart_id,e.chartData,e.rangeArray,e.rangeTxt)},rangeResize:!1,rangeResizexy:null,rangeResizeIndex:null,rangeResizeObj:null,rangeResizeDraging:function(e,n,t){var l=h.currentChart,o=l.rangeArray[0].row[0],a=l.rangeArray[0].column[0],s=l.rangeRowCheck,u=l.rangeColCheck,f=l.rangeSplitArray,m=wl(e.pageX,e.pageY),d=$("#luckysheet-cell-main").scrollLeft(),p=$("#luckysheet-cell-main").scrollTop(),b=m[0]+d,g=m[1]+p,v=$(window).height()+p-n-t,x=$(window).width()+d,_=g1(g),S=_[2],I=p1(b),P=I[2],F=Kf(),D=Jf(),k=h.chart_selection.rangeResizeObj.attr("id");if(k=="luckysheet-chart-rangeShow-content"){var w,C,T,O;if(h.chart_selection.rangeResize=="lt"?(w=h.chart_selection.rangeResizeIndex.row[0],T=h.chart_selection.rangeResizeIndex.column[0],C=h.chart_selection.rangeResizeIndex.row[1],O=h.chart_selection.rangeResizeIndex.column[1]):h.chart_selection.rangeResize=="lb"?(w=h.chart_selection.rangeResizeIndex.row[1],T=h.chart_selection.rangeResizeIndex.column[0],C=h.chart_selection.rangeResizeIndex.row[0],O=h.chart_selection.rangeResizeIndex.column[1]):h.chart_selection.rangeResize=="rt"?(w=h.chart_selection.rangeResizeIndex.row[0],T=h.chart_selection.rangeResizeIndex.column[1],C=h.chart_selection.rangeResizeIndex.row[1],O=h.chart_selection.rangeResizeIndex.column[0]):h.chart_selection.rangeResize=="rb"&&(w=h.chart_selection.rangeResizeIndex.row[1],T=h.chart_selection.rangeResizeIndex.column[1],C=h.chart_selection.rangeResizeIndex.row[0],O=h.chart_selection.rangeResizeIndex.column[0]),s.exits){var z=w-h.chart_selection.rangeResizexy[0]+S;z<o+s.range[1]+1||g<0?z=o+s.range[1]+1:(z>=F.length-1||g>v)&&(z=F.length-1)}else{var z=o-h.chart_selection.rangeResizexy[0]+S;z<0||g<0?z=0:(z>=F.length-1||g>v)&&(z=F.length-1)}if(u.exits){var A=T-h.chart_selection.rangeResizexy[1]+P;A<a+u.range[1]+1||b<0?A=a+u.range[1]+1:(A>=D.length-1||b>x)&&(A=D.length-1)}else{var A=a-h.chart_selection.rangeResizexy[1]+P;A<0||b<0?A=0:(A>=D.length-1||b>x)&&(A=D.length-1)}var E,L,N,W;z>C?(E=C,L=z):(E=z,L=C),A>O?(N=O,W=A):(N=A,W=O),!s.exits&&!u.exits?(l.rangeArray=[{row:[E,L],column:[N,W]}],l.rangeSplitArray.range={row:[E,L],column:[N,W]}):(l.rangeArray=[{row:[o,L],column:[a,W]}],l.rangeSplitArray.range={row:[o,L],column:[a,W]},l.rangeSplitArray.content={row:[E-o,L-o],column:[N-a,W-a]},s.exits&&(l.rangeSplitArray.rowtitle={row:l.rangeSplitArray.rowtitle.row,column:[N-a,W-a]}),u.exits&&(l.rangeSplitArray.coltitle={row:[E-o,L-o],column:l.rangeSplitArray.coltitle.column}))}else if(k=="luckysheet-chart-rangeShow-rowtitle"){var T,O;if(h.chart_selection.rangeResize=="lt"||h.chart_selection.rangeResize=="lb"?(T=h.chart_selection.rangeResizeIndex.column[0],O=h.chart_selection.rangeResizeIndex.column[1]):(h.chart_selection.rangeResize=="rt"||h.chart_selection.rangeResize=="rb")&&(T=h.chart_selection.rangeResizeIndex.column[1],O=h.chart_selection.rangeResizeIndex.column[0]),u.exits){var A=T-h.chart_selection.rangeResizexy[1]+P;A<a+u.range[1]+1||b<0?A=a+u.range[1]+1:(A>=D.length-1||b>x)&&(A=D.length-1)}else{var A=a-h.chart_selection.rangeResizexy[1]+P;A<0||b<0?A=0:(A>=D.length-1||b>x)&&(A=D.length-1)}var N,W;A>O?(N=O,W=A):(N=A,W=O),u.exits?(l.rangeArray=[{row:l.rangeArray[0].row,column:[a,W]}],l.rangeSplitArray.range={row:l.rangeArray[0].row,column:[a,W]},l.rangeSplitArray.rowtitle={row:l.rangeSplitArray.rowtitle.row,column:[N-a,W-a]},l.rangeSplitArray.content={row:l.rangeSplitArray.content.row,column:[N-a,W-a]}):(l.rangeArray=[{row:l.rangeArray[0].row,column:[N,W]}],l.rangeSplitArray.range={row:l.rangeArray[0].row,column:[N,W]})}else if(k=="luckysheet-chart-rangeShow-coltitle"){var w,C;if(h.chart_selection.rangeResize=="lt"||h.chart_selection.rangeResize=="rt"?(w=h.chart_selection.rangeResizeIndex.row[0],C=h.chart_selection.rangeResizeIndex.row[1]):(h.chart_selection.rangeResize=="lb"||h.chart_selection.rangeResize=="rb")&&(w=h.chart_selection.rangeResizeIndex.row[1],C=h.chart_selection.rangeResizeIndex.row[0]),s.exits){var z=w-h.chart_selection.rangeResizexy[0]+S;z<o+s.range[1]+1||g<0?z=o+s.range[1]+1:(z>=F.length-1||g>v)&&(z=F.length-1)}else{var z=o-h.chart_selection.rangeResizexy[0]+S;z<0||g<0?z=0:(z>=F.length-1||g>v)&&(z=F.length-1)}var E,L;z>C?(E=C,L=z):(E=z,L=C),s.exits?(l.rangeArray=[{row:[o,L],column:l.rangeArray[0].column}],l.rangeSplitArray.range={row:[o,L],column:l.rangeArray[0].column},l.rangeSplitArray.coltitle={row:[E-o,L-o],column:l.rangeSplitArray.coltitle.column},l.rangeSplitArray.content={row:[E-o,L-o],column:l.rangeSplitArray.content.column}):(l.rangeArray=[{row:[E,L],column:l.rangeArray[0].column}],l.rangeSplitArray.range={row:[E,L],column:l.rangeArray[0].column})}h.chart_selection.create()},rangeResizeDragged:function(){h.chart_selection.rangeResize=null;var e=h.currentChart;e.rangeTxt=Kl(h.currentSheetIndex,e.rangeArray[0],h.currentSheetIndex),e.chartData=hr(e.rangeArray[0],h.currentSheetIndex),h.changeChartRange(e.chart_id,e.chartData,e.rangeArray,e.rangeTxt)}}}function hg(e,n,t,l){var o=luckysheet.getluckysheet_select_save();o.length==1&&o[0].row[0]==o[0].row[1]&&o[0].column[0]==o[0].column[1]&&(xa("right","rangeOfSelect"),xa("down","rangeOfSelect"),o=luckysheet.getluckysheet_select_save());for(var a=-1,s=o[0].row[1]-o[0].row[0],u=o[0].row[0];u<=o[0].row[1];u++){for(var f=o[0].column[0];f<=o[0].column[1];f++){var m=Vt(u,f,luckysheet.flowdata());if(m!=null&&m.toString().length>0){a=u;break}}if(a!==-1)break}a==-1&&(a=0),o[0].row=[a,a],o[0].row_focus=a,luckysheet.setluckysheet_select_save(o),h.luckysheet_shiftpositon=$.extend(!0,{},o[0]),Zc("down","range",!1,s),o=luckysheet.getluckysheet_select_save();for(var d=-1,p=o[0].column[1]-o[0].column[0],f=o[0].column[0];f<=o[0].column[1];f++){for(var u=o[0].row[0];u<=o[0].row[1];u++){var m=Vt(u,f,luckysheet.flowdata());if(m!=null&&m.toString().length>0){d=f;break}}if(d!==-1)break}d==-1&&(d=0),o[0].column=[d,d],o[0].column_focus=d,luckysheet.setluckysheet_select_save(o),h.luckysheet_shiftpositon=$.extend(!0,{},o[0]),Zc("right","range",!1,p),o=luckysheet.getluckysheet_select_save();var b=$.extend(!0,[],o),g=Kl(h.currentSheetIndex,b[0],h.currentSheetIndex);let v=hr();console.dir(v);let x=h1("chart"),_=x+"_c",S='<div id="${id}"class="luckysheet-modal-dialog luckysheet-modal-dialog-chart ${addclass}"tabindex="0"role="dialog"aria-labelledby=":41e"dir="ltr"><div class="luckysheet-modal-dialog-resize"><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lt"data-type="lt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mt"data-type="mt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lm"data-type="lm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rm"data-type="rm"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rt"data-type="rt"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-lb"data-type="lb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-mb"data-type="mb"></div><div class="luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-rb"data-type="rb"></div></div><div class="luckysheet-modal-dialog-controll"><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-update"role="button"tabindex="0"aria-label="\u4FEE\u6539\u56FE\u8868"title="\u4FEE\u6539\u56FE\u8868"><i class="fa fa-pencil"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-max"role="butluckysheet_chartIns_indexton"tabindex="0"aria-label="\u6700\u5927\u5316"title="\u6700\u5927\u5316"><i class="fa fa-window-maximize"aria-hidden="true"></i></span><span class="luckysheet-modal-controll-btn luckysheet-modal-controll-del"role="button"tabindex="0"aria-label="\u5220\u9664"title="\u5220\u9664"><i class="fa fa-trash"aria-hidden="true"></i></span></div><div class="luckysheet-modal-dialog-content">${content}</div></div>',I=$(ig(S,{id:_,addclass:"luckysheet-data-visualization-chart",title:"\u56FE\u8868\u751F\u6210",content:""})).appendTo($(".luckysheet-cell-main")),P=document.getElementById(_),{render:F,chart_json:D}=h.createChart($(`#${_}`).children(".luckysheet-modal-dialog-content")[0],v,x,b,g);console.dir(JSON.stringify(D)),e=e||400,n=n||250,t=t||0,l=l||0,P.style.width=e+"px",P.style.height=n+"px",P.style.position="absolute",P.style.background="#fff",P.style.left=t+"px",P.style.top=l+"px",F.style.width="100%",F.style.height="100%",P.style.zIndex=h.zIndex?h.zIndex:15,h.zIndex++;let k=h.luckysheetfile[Me(h.currentSheetIndex)];k.chart||(k.chart=[]),k.chart.push({chart_id:x,width:e,height:n,left:t,top:l,sheetIndex:k.index}),cu(x),$(`#${x}_c .luckysheet-modal-controll-del`).click(function(w){k1(x)}),y1(I),$(`#${x}_c .luckysheet-modal-controll-update`).click(function(w){x1()}),I.children(".luckysheet-modal-dialog-content").mousedown(function(w){h.chartparam.luckysheetCurrentChartMaxState||cu(x),w.stopPropagation()}),I.mousedown(function(w){if(!h.chartparam.luckysheetCurrentChartMaxState){cu(x),pa(!0),!$(w.target).is(".luckysheet-modal-dialog-controll")&&!$(w.target).is(".luckysheet-modal-controll-btn")&&!$(w.target).is("i")&&(h.chartparam.luckysheetCurrentChartMoveTimeout=setTimeout(function(){h.chartparam.luckysheetCurrentChartMove=!0},100));var C=h.chartparam.luckysheetCurrentChartMoveObj.offset(),T=h.chartparam.luckysheetCurrentChartMoveObj.position();h.chartparam.luckysheetCurrentChartMoveXy=[w.pageX-C.left,w.pageY-C.top,T.left,T.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()],h.chartparam.luckysheetCurrentChartMoveWinH=$("#luckysheet-cell-main")[0].scrollHeight,h.chartparam.luckysheetCurrentChartMoveWinW=$("#luckysheet-cell-main")[0].scrollWidth,!$(w.target).hasClass("luckysheet-mousedown-cancel")&&$(w.target).filter("[class*='sp-palette']").length==0&&$(w.target).filter("[class*='sp-thumb']").length==0&&$(w.target).filter("[class*='sp-']").length==0&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu, #luckysheet-user-menu").hide(),$("body > .luckysheet-filter-menu, body > .luckysheet-filter-submenu, body > .luckysheet-cols-menu").hide()),w.stopPropagation()}}).find(".luckysheet-modal-dialog-resize-item").mousedown(function(w){if(h.chartparam.luckysheetCurrentChartActive){h.chartparam.luckysheetCurrentChartResize=$(this).data("type");var C=wl(w.pageX,w.pageY),T=$("#luckysheet-scrollbar-x").scrollLeft(),O=$("#luckysheet-scrollbar-y").scrollTop(),z=C[0]+T,A=C[1]+O,E=h.chartparam.luckysheetCurrentChartResizeObj.position();h.chartparam.luckysheetCurrentChartResizeXy=[z,A,I.width(),I.height(),E.left+T,E.top+O,T,O],h.chartparam.luckysheetCurrentChartResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,h.chartparam.luckysheetCurrentChartResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,h.chartparam.luckysheetCurrentChart=x,w.stopPropagation()}})}function y1(e){e.find(".luckysheet-modal-dialog-content").hover(function(){e.removeClass("chart-moveable")},function(){e.addClass("chart-moveable")}),e.hover(function(){e.addClass("chart-moveable")},function(){e.removeClass("chart-moveable")})}function k1(e){$(`.luckysheet-cell-main #${e}_c`).remove(),dg();let n=h.luckysheetfile[Me(h.currentSheetIndex)],t=n.chart.findIndex(l=>l.chart_id==e);n.chart.splice(t,1),h.deleteChart(e)}function cu(e){let n=h.luckysheetfile[Me(h.currentSheetIndex)].chart;for(let t in n)n[t].needRangeShow=!1,n[t].chart_id==e&&(n[t].needRangeShow=!0,h.currentChart=h.getChartJson(e));b1(e)}function dg(){let e=h.luckysheetfile[Me(h.currentSheetIndex)].chart;for(let n in e)e[n].needRangeShow=!1;w1()}function b1(e){let n=$("#"+e+"_c");h.chart_selection.create(),h.chartparam.luckysheetCurrentChartActive=!0,h.chartparam.luckysheetCurrentChartMoveObj=n,h.chartparam.luckysheetCurrentChartResizeObj=n,h.chartparam.luckysheetCurrentChart=e,$("#luckysheet-cell-main").find(".luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize").hide(),$("#luckysheet-cell-main").find(".luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll").hide(),n.css("z-index",h.chartparam.luckysheetCurrentChartZIndexRank++),n.find(".luckysheet-modal-dialog-resize").show(),n.find(".luckysheet-modal-dialog-controll").show(),($(".chartSetting").is(":visible")||h.chartparam.luckysheet_chart_redo_click)&&e!=h.chartparam.luckysheetCurrentChart&&$("body .luckysheet-cols-menu").hide(),h.currentChart=h.highlightChart(e)}function w1(e){$("#luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize, #luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll").hide(),$("#luckysheet-cell-main").find(".luckysheet-datavisual-selection-set div").remove(),h.chartparam.luckysheetCurrentChartActive=!1,$("#luckysheet-chart-rangeShow").empty(),!e&&$(".chartSetting").is(":visible")&&!at()&&v3()}function x1(e,n){$(".chartSetting").is(":visible")||($(".chartSetting").show(),$("#luckysheet-cell-main").find(".luckysheet-datavisual-selection-set div").show(),h.chartparam.luckysheetCurrentChartActive=!0,setTimeout(function(){mr()},0))}function v3(e){$(".chartSetting").is(":visible")&&($(".chartSetting").hide(),$("#luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-resize, #luckysheet-cell-main .luckysheet-modal-dialog-chart .luckysheet-modal-dialog-controll").hide(),$("#luckysheet-cell-main").find(".luckysheet-datavisual-selection-set div").remove(),h.chartparam.luckysheetCurrentChartActive=!1,!at()&&!e&&setTimeout(function(){mr()},0))}function mg(e){w1("true"),h.luckysheetfile.forEach(t=>{t.index==e?(t.chart||[]).forEach(o=>{o.isShow=!0,$("#"+o.chart_id+"_c").show(),h.resizeChart(o.chart_id),o.needRangeShow==!0&&(h.currentChart=h.getChartJson(o.chart_id),b1(o.chart_id))}):(t.chart||[]).forEach(o=>{o.isShow=!1,$("#"+o.chart_id+"_c").hide()})})}var import_plugin,g1,p1,h3,d3,Rh=Nt(()=>{import_plugin=qe(Ye());Ol();d1();Er();il();Sr();mf();fr();Ri();gs();Kc();cr();ho();g1=Jl,p1=Zl,h3=["https://cdn.jsdelivr.net/npm/vue@2.6.11","https://unpkg.com/vuex@3.4.0","https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.2/index.js","https://cdn.bootcdn.net/ajax/libs/echarts/4.8.0/echarts.min.js","expendPlugins/chart/chartmix.umd.min.js"],d3=["https://cdn.bootcdn.net/ajax/libs/element-ui/2.13.2/theme-chalk/index.css","expendPlugins/chart/chartmix.css"]});function rs(e){h.flowdata==null||h.flowdata.length==0||(clearTimeout(_1),_1=setTimeout(()=>{h.clearjfundo&&h.jfredo.push({type:"zoomChange",zoomRatio:h.zoomRatio,curZoomRatio:e,sheetIndex:h.currentSheetIndex}),ra=null,h.zoomRatio=e;let n=kt.getSheetByIndex();Zt.buildAllPs(n.data),Pt.images=n.images,Pt.allImagesShow(),Pt.init(),n.config==null&&(n.config={}),n.config.sheetViewZoom==null&&(n.config.sheetViewZoom={});let t=n.config.curentsheetView;t==null&&(t="viewNormal"),n.config.sheetViewZoom[t+"ZoomScale"]=e,Ue.saveParam("all",h.currentSheetIndex,h.zoomRatio,{k:"zoomRatio"}),Ue.saveParam("cg",h.currentSheetIndex,n.config.sheetViewZoom,{k:"sheetViewZoom"}),uu()},100))}function uu(){tr(h.flowdata.length,h.flowdata[0].length),Hm()}function C1(){let e=.02,n=.1,t=4,l=.1;$("#luckysheet-zoom-minus").click(function(){let o;h.zoomRatio==null?o=h.zoomRatio=1:o=Math.ceil(h.zoomRatio*10)/10,o=o-n,o==h.zoomRatio&&(o=o-n),o<=l&&(o=l),rs(o),Qi(o)}),$("#luckysheet-zoom-plus").click(function(){let o;h.zoomRatio==null?o=h.zoomRatio=1:o=Math.floor(h.zoomRatio*10)/10,o=o+n,o==h.zoomRatio&&(o=o+n),o>=t&&(o=t),rs(o),Qi(o)}),$("#luckysheet-zoom-slider").mousedown(function(o){let a=$(this).offset().left,s=o.pageX,u=$1(s-a);rs(u),Qi(u)}),$("#luckysheet-zoom-cursor").mousedown(function(o){let a=o.pageX,s=parseFloat($("#luckysheet-zoom-cursor").css("left"));$("#luckysheet-zoom-cursor").css("transition","none"),$(document).off("mousemove.zoomCursor").on("mousemove.zoomCursor",function(u){let m=u.pageX-a,d=s+m,p=$1(d);p>t&&(p=t,d=100),p<l&&(p=l,d=0),rs(p);let b=Math.round(p*100)+"%";$("#luckysheet-zoom-ratioText").html(b),$("#luckysheet-zoom-cursor").css("left",d-4)}),$(document).off("mouseup.zoomCursor").on("mouseup.zoomCursor",function(u){$(document).off(".zoomCursor"),$("#luckysheet-zoom-cursor").css("transition","all 0.3s")}),o.stopPropagation()}).click(function(o){o.stopPropagation()}),$("#luckysheet-zoom-ratioText").click(function(){rs(1),Qi(1)}),Qi(h.zoomRatio),ra=null,document.addEventListener("wheel",function(o){!o.ctrlKey||!o.deltaY||(ra===null&&(ra=h.zoomRatio||1),ra+=o.deltaY<0?e:-e,ra>=t?ra=t:ra<l&&(ra=l),rs(ra),Qi(ra),o.preventDefault(),o.stopPropagation())},{capture:!0,passive:!1}),document.addEventListener("keydown",function(o){if(!o.ctrlKey)return;let a=!1,s=h.zoomRatio||1;o.key==="-"||o.which===189?(s-=n,a=!0):o.key==="+"||o.which===187?(s+=n,a=!0):(o.key==="0"||o.which===48)&&(s=1,a=!0),a&&(o.preventDefault(),s>=t?s=t:s<l&&(s=l),rs(s),Qi(s))},{capture:!0})}function $1(e){let n=1;return e<50?n=Math.round((e*1.8/100+.1)*100)/100:e>50&&(n=Math.round(((e-50)*6/100+1)*100)/100),n}function y3(e){let n=50;e<1?n=Math.round((e-.1)*100/.18)/10:e>1&&(n=Math.round((e-1)*100/.6)/10+50),$("#luckysheet-zoom-cursor").css("left",n-4)}function Qi(e){let n=Math.round(e*100)+"%";$("#luckysheet-zoom-ratioText").html(n),y3(e)}var import_plugin,_1,ra,fu=Nt(()=>{import_plugin=qe(Ye());il();Xl();Ol();kn();ho();Ar();qr();ta();Qo();_1=null;ra=null});var import_plugin,k3,kt,kn=Nt(()=>{import_plugin=qe(Ye());cr();Jo();Er();Do();f1();Kr();Sr();Ar();lf();Wr();sc();cr();Ol();Rr();qr();Vn();_a();ho();ta();Qo();go();nu();Di();Ja();jr();il();Xl();Rh();ho();fu();ln();wi();k3={generateRandomSheetIndex:function(e){e==null&&(e="Sheet");let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="";for(let o=0;o<12;o++)t+=n[Math.round(Math.random()*(n.length-1))];let l=new Date().getTime();return e+"_"+t+"_"+l},generateRandomSheetName:function(e,n){let t=e.length,o=Be().pivotTable.title;for(let a=0;a<e.length;a++)if(e[a].name.indexOf("Sheet")>-1||e[a].name.indexOf(o)>-1){let s=parseFloat(e[a].name.replace("Sheet","").replace(o,""));s!="NaN"&&Math.ceil(s)>t&&(t=Math.ceil(s))}return n?o+(t+1):"Sheet"+(t+1)},generateCopySheetName:function(e,n){let t="",o=Be().info;if(n.toString().indexOf("("+o.copy)>-1){let a=n.toString().indexOf("("+o.copy),s=n.toString().substring(0,a)+"("+o.copy,u=null;for(let f=0;f<e.length;f++){let m=e[f].name.toString(),d=m.indexOf(s);if(d>-1){let p=m.indexOf(")",d+s.length),b=m.substring(d+s.length,p);K(b)&&(u==null||parseInt(b)>u)&&(u=parseInt(b))}}u==null?t=s+"2)":(u++,t=s+u+")")}else{let a=null,s=!1,u=n+"("+o.copy;for(let f=0;f<e.length;f++){let m=e[f].name.toString(),d=m.indexOf(u);if(d>-1){s=!0;let p=m.indexOf(")",d+u.length),b=m.substring(d+u.length,p);K(b)&&(a==null||parseInt(b)>a)&&(a=parseInt(b))}}s?a==null?t=n+"("+o.copy+"2)":(a++,t=n+"("+o.copy+""+a+")"):t=n+"("+o.copy+")"}return t},getSheetByIndex:function(e){let n=this;e==null&&(e=h.currentSheetIndex);let t=n.getSheetIndex(e);return h.luckysheetfile[t]},getSheetByName:function(e){let n=this;if(e==null)return null;for(let t=0;t<h.luckysheetfile.length;t++){let l=h.luckysheetfile[t];if(l.name==e)return l}return null},getCurSheetnoset:function(){let e=0;for(let n=0;n<h.luckysheetfile.length;n++)if(h.luckysheetfile[n].status==1){e=h.luckysheetfile[n].index;break}return e},getCurSheet:function(){if(h.luckysheetfile.length){let e=!1,n=[];h.luckysheetfile.forEach(t=>{typeof t.index=="undefined"&&(t.index=this.generateRandomSheetIndex()),n.includes(t.index)?t.index=this.generateRandomSheetIndex():n.push(t.index),typeof t.status=="undefined"&&(t.status=0),t.status==1&&(e?t.status=0:e=!0)}),e||(h.luckysheetfile[0].status=1)}h.currentSheetIndex=h.luckysheetfile[0].index;for(let e=0;e<h.luckysheetfile.length;e++)if(h.luckysheetfile[e].status==1){h.currentSheetIndex=h.luckysheetfile[e].index;break}return h.currentSheetIndex},addNewSheet:function(e,n){if(at()||h.allowEdit===!1||!sl.createHookFunction("sheetCreateBefore"))return;let t=this,l=h.luckysheetfile.length,o=t.generateRandomSheetIndex(),a=t.generateRandomSheetName(h.luckysheetfile,n);$("#luckysheet-sheet-container-c").append(Tt(Ui,{index:o,active:"",name:a,style:"",colorset:""}));let s={name:a,color:"",status:"0",order:l,index:o,celldata:[],row:h.defaultrowNum,column:h.defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!!n};if(h.luckysheetfile.push(s),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+o).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+o+'" class="luckysheet-datavisual-selection-set"></div>'),Jr(e),Ue.saveParam("sha",null,$.extend(!0,{},s)),h.clearjfundo){h.jfundo.length=0;let u={};u.type="addSheet",u.sheetconfig=$.extend(!0,{},s),u.index=o,u.currentSheetIndex=h.currentSheetIndex,h.jfredo.push(u)}t.changeSheetExec(o,n,!0)},setSheetHide:function(e,n){let t=this,l=t.getSheetIndex(e);if(!n&&!sl.createHookFunction("sheetHideBefore",{sheet:h.luckysheetfile[l]}))return;h.luckysheetfile[l].hide=1;let o=$("#luckysheet-sheets-item"+e);o.hide(),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active");let a;if(ut.showsheetbarConfig.sheet)a=o.nextAll(":visible"),o.nextAll(":visible").length>0?a=a.eq(0).data("index"):a=o.prevAll(":visible").eq(0).data("index");else{let s,u=[];h.luckysheetfile.forEach((m,d)=>{m.hide!==1&&u.push(d)});let f=u.length;f===1?s=u[0]:s=u[f-1]>l?u.find(m=>m>l):u[f-1],a=h.luckysheetfile[s].index}$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),t.changeSheetExec(a),t.locationSheet(),Ue.saveParam("sh",o.data("index"),1,{op:"hide",cur:a}),n||sl.createHookFunction("sheetHideAfter",{sheet:h.luckysheetfile[l]})},setSheetShow:function(e){let n=this,t=h.luckysheetfile[n.getSheetIndex(e)];!sl.createHookFunction("sheetShowBefore",{sheet:t})||(t.hide=0,n.changeSheetExec(e),Ue.saveParam("sh",e,0,{op:"show",cur:null}),sl.createHookFunction("sheetShowAfter",{sheet:t}))},sheetMaxIndex:0,ordersheet:function(e){return function(n,t){let l=n[e],o=t[e];return l-o}},getCurrentOrder:function(){let e={};return $("#luckysheet-sheet-area div.luckysheet-sheets-item").each(function(n){let t=$(this).data("index");for(let l=0;l<h.luckysheetfile.length;l++)if(h.luckysheetfile[l].index==t){e[t.toString()]=n;break}}),e},reOrderAllSheet:function(){let e={};$("#luckysheet-sheet-area div.luckysheet-sheets-item").each(function(n){let t=$(this).data("index");for(let l=0;l<h.luckysheetfile.length;l++)if(h.luckysheetfile[l].index==t){h.luckysheetfile[l].order=n,e[t.toString()]=n;break}}),Ue.saveParam("shr",null,e),h.luckysheetfile.sort((n,t)=>{let l=n.order,o=t.order;return l!=null&&o!=null?l-o:l!=null?-1:(o!=null,1)})},createSheet:function(){let e=this,n=[];h.luckysheetfile.sort(e.ordersheet("order"));for(let t=0;t<h.luckysheetfile.length;t++){let l="",o=h.luckysheetfile[t].index,a="";h.luckysheetfile[t].color!=null&&(a='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+h.luckysheetfile[t].color+';"></div>'),h.currentSheetIndex==o?n.push(Tt(Ui,{index:o,active:"luckysheet-sheets-item-active",name:h.luckysheetfile[t].name,style:"",colorset:a})):(h.luckysheetfile[t].hide==1?n.push(Tt(Ui,{index:o,active:"",name:h.luckysheetfile[t].name,style:"display:none;",colorset:a})):n.push(Tt(Ui,{index:o,active:"",name:h.luckysheetfile[t].name,style:"",colorset:a})),l="style='display:none;'"),$("#luckysheet-cell-main").append("<div "+l+' id="luckysheet-datavisual-selection-set-'+o+'" class="luckysheet-datavisual-selection-set"></div>')}$("#luckysheet-sheet-container-c").append(n.join("")),e.locationSheet()},locationSheet:function(){let e=$("#luckysheet-sheet-container-c"),n=$("#"+h.container).width(),t=$("#luckysheet-sheet-container-c > div.luckysheet-sheets-item-active").eq(0),l=0,o=0;$("#luckysheet-sheet-container-c > div.luckysheet-sheets-item:visible").each(function(){$(this).hasClass("luckysheet-sheets-item-active")&&(l=o),o+=$(this).outerWidth()}),setTimeout(function(){e.scrollLeft(l-10),ut.showsheetbarConfig.sheet&&(o>=n*.7?($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","inline-block"),$("#luckysheet-sheet-container .docs-sheet-fade-left").show()):($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","none"),$("#luckysheet-sheet-container .docs-sheet-fade-left").hide()))},1)},copySheet:function(e,n){if(at()||h.allowEdit===!1)return;let t=this,l=h.luckysheetfile.length,o=t.generateRandomSheetIndex(),a=t.getSheetIndex(e),s=$.extend(!0,{},h.luckysheetfile[a]);if(s.order=l,s.index=o,s.name=t.generateCopySheetName(h.luckysheetfile,s.name),!sl.createHookFunction("sheetCopyBefore",{targetSheet:h.luckysheetfile[a],copySheet:s}))return;let u="";s.color!=null&&(u='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+s.color+';"></div>');let f=$("#luckysheet-sheets-item"+e);if($("#luckysheet-sheet-container-c").append(Tt(Ui,{index:s.index,active:"",name:s.name,order:s.order,style:"",colorset:u})),$("#luckysheet-sheets-item"+s.index).insertAfter(f),h.luckysheetfile.splice(a+1,0,s),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+o).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+o+'" class="luckysheet-datavisual-selection-set"></div>'),Jr(n),Ue.saveParam("shc",o,{copyindex:e,name:s.name}),t.changeSheetExec(o,void 0,void 0,!0),t.reOrderAllSheet(),h.clearjfundo)h.jfredo.push({type:"copySheet",copyindex:e,index:s.index,sheetIndex:s.index});else if(h.jfredo.length>0){let m=h.jfredo[h.jfredo.length-1];m.type=="copySheet"&&(m.index=s.index,m.sheetIndex=s.index)}},hasSheet:function(e){return!(e==null||(e=this.getSheetIndex(e),e==null))},createSheetbydata:function(e,n,t=!0){let l=this,o="";if(e.color!=null&&(o='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e.color+';"></div>'),$("#luckysheet-sheet-container-c").append(Tt(Ui,{index:e.index,active:"",name:e.name,order:e.order,style:"",colorset:o})),t){let a=e.order;a>=h.luckysheetfile.length?(a=h.luckysheetfile.length-1,$("#luckysheet-sheets-item"+e.index).insertAfter($("#luckysheet-sheets-item"+h.luckysheetfile[a].index))):$("#luckysheet-sheets-item"+e.index).insertBefore($("#luckysheet-sheets-item"+h.luckysheetfile[a].index))}h.luckysheetfile.push(e),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+e.index).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+e.index+'" class="luckysheet-datavisual-selection-set"></div>'),Jr(),n!=null?(Ue.saveParam("shre",null,{reIndex:e.index}),e.hide=0,Ue.saveParam("sh",e.index,0,{op:"show",cur:null})):Ue.saveParam("sha",null,e),l.changeSheetExec(e.index,e.isPivotTable,!0),l.reOrderAllSheet()},deleteSheet:function(e){let n=this;if(h.allowEdit===!1)return;let t=n.getSheetIndex(e),l=h.luckysheetfile[t];if(!sl.createHookFunction("sheetDeleteBefore",{sheet:l}))return;n.setSheetHide(e,!0),$("#luckysheet-sheets-item"+e).remove(),$("#luckysheet-datavisual-selection-set-"+e).remove();let o=h.luckysheetfile.splice(t,1);n.reOrderAllSheet(),Ue.saveParam("shd",null,{deleIndex:e}),h.clearjfundo&&(o[0].type="deleteSheet",h.jfredo.push(o[0])),sl.createHookFunction("sheetDeleteAfter",{sheet:l})},nulldata:null,getGridData:function(e){let n=[];for(let t=0;t<e.length;t++)for(let l=0;l<e[0].length;l++)e[t][l]!=null&&n.push({r:t,c:l,v:e[t][l]});return n},buildGridData:function(e){let n=e.row==null?h.defaultrowNum:e.row,t=e.column==null?h.defaultcolumnNum:e.column,l=e.data&&e.data.length>0?e.data:cn([],n,t),o=e.celldata;if(e.data&&e.data.length>0)for(let a=0;a<l.length;a++)for(let s=0;s<l[0].length;s++)kr(a,s,l,l[a][s]);else if(o&&o.length>0)for(let a=0;a<o.length;a++){let s=o[a],u=s.r,f=s.c,m=s.v;u>=l.length&&(l=cn(l,u-l.length+1,0)),f>=l[0].length&&(l=cn(l,0,f-l[0].length+1)),kr(u,f,l,m)}return ut.autoFormatw=!1,ut.accuracy=void 0,l},cutGridData:function(e){let n=0;for(let t=e.length-1;t>=0;t--){let l=!0;for(let o=0;o<e[0].length;o++){let a=Vt(t,o);if(a!=null&&$.trim(a).length>0){l=!1;break}}if(l)n=t;else break}return e.slice(0,n)},addGridData:function(e,n,t){let l=cn([],n,t);if(e!=null)for(let o=0;o<e.length;o++){let a=e[o],s=a.r,u=a.c,f=a.v;s>=l.length&&(l=cn(l,s-l.length+1,0)),u>=l[0].length&&(l=cn(l,0,u-l[0].length+1)),kr(s,u,l,f)}return l},sheetParamRestore:function(e,n){if(h.luckysheet_select_save=e.luckysheet_select_save,(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0)&&(n[0]!=null&&n[0][0]!=null&&n[0][0].mc!=null?h.luckysheet_select_save=[{row:[0,n[0][0].mc.rs-1],column:[0,n[0][0].mc.cs-1]}]:h.luckysheet_select_save=[{row:[0,0],column:[0,0]}]),h.luckysheet_selection_range=e.luckysheet_selection_range==null?[]:e.luckysheet_selection_range,h.config=e.config==null?{}:e.config,h.zoomRatio=e.zoomRatio==null?1:e.zoomRatio,e.defaultRowHeight!=null?h.defaultrowlen=parseFloat(e.defaultRowHeight):h.defaultrowlen=ut.defaultRowHeight,e.defaultColWidth!=null?h.defaultcollen=parseFloat(e.defaultColWidth):h.defaultcollen=ut.defaultColWidth,e.showGridLines!=null){let t=e.showGridLines;t==0||t==!1?h.showGridLines=!1:h.showGridLines=!0}else h.showGridLines=!0},initialjfFile:function(e,n){let t=this;t.getCurSheet();let l=h.luckysheetfile[t.getSheetIndex(h.currentSheetIndex)];t.nulldata=cn([],h.defaultrowNum,h.defaultcolumnNum);let o=t.buildGridData(l),a=[];l.jfgird_select_save=l.jfgird_select_save||[],l.jfgird_select_save.forEach(d=>a.push({row:d.row,column:d.column})),l.luckysheet_select_save=a,this.sheetParamRestore(l,o);let s=h.luckysheet_select_save[0].row[1],u=h.luckysheet_select_save[0].column[1];if(h.luckysheet_select_save.length>1)for(let d=0;d<h.luckysheet_select_save.length;d++)h.luckysheet_select_save[d].row[1]>s&&(s=h.luckysheet_select_save[d].row[1]),h.luckysheet_select_save[d].column[1]>u&&(u=h.luckysheet_select_save[d].column[1]);_t.fontInitial(h.fontList),l.data=o;let f=o.length;s>f-1&&(f=s+1);let m=o[0].length;u>m-1&&(m=u+1),typeof ut.beforeCreateDom=="function"&&ut.beforeCreateDom(luckysheet),typeof ut.workbookCreateBefore=="function"&&ut.workbookCreateBefore(luckysheet),ng(m,f,o,e,n),setTimeout(function(){ke.createHoverTip("#luckysheet_info_detail",".luckysheet_info_detail_back, .luckysheet_info_detail_input, .luckysheet_info_detail_update"),ke.createHoverTip("#luckysheet-wa-editor",".luckysheet-toolbar-menu-button, .luckysheet-toolbar-button, .luckysheet-toolbar-combo-button"),h.luckysheetTableContentHW=[$("#luckysheet-cell-main").width()+h.rowHeaderWidth-h.cellMainSrollBarSize,$("#luckysheet-cell-main").height()+h.columnHeaderHeight-h.cellMainSrollBarSize],$("#luckysheetTableContent, #luckysheetTableContentF").attr({width:Math.ceil(h.luckysheetTableContentHW[0]*h.devicePixelRatio),height:Math.ceil(h.luckysheetTableContentHW[1]*h.devicePixelRatio)}).css({width:h.luckysheetTableContentHW[0],height:h.luckysheetTableContentHW[1]}).get(0).getContext("2d");let d=Be().info,b=Ue.gridKey+"__qkcache",g=function(){l.load="1",t.createSheet();let v=function(){t.mergeCalculation(l.index),t.setSheetParam(!1),t.storeSheetParam(),t.restoreselect(),t.CacheNotLoadControll=[],t.restoreCache(),y.execFunctionGroupForce(ut.forceCalculation),t.restoreSheetAll(h.currentSheetIndex),$("#luckysheet_info_detail_save").html(d.detailSave),l.isPivotTable?h.luckysheetcurrentisPivotTable=!0:(h.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide()),Hy(),mr(),l.scrollLeft!=null&&l.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(l.scrollLeft):$("#luckysheet-scrollbar-x").scrollLeft(0),l.scrollTop!=null&&l.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(l.scrollTop):$("#luckysheet-scrollbar-y").scrollTop(0),Dh(h.asyncLoad,"core"),ut.pointEdit?setTimeout(function(){h.loadingObj.close()},0):setTimeout(function(){h.loadingObj.close()},500)},x=Ue.loadSheetUrl;if(x=="")t.loadOtherFile(l),v();else{let _=t.checkLoadSheetIndex(l),S=[];for(let I=0;I<_.length;I++){let P=_[I];P!=l.index&&S.push(P)}if(S.length===0){v();return}$.post(x,{gridKey:Ue.gridKey,index:S.join(",")},function(I){let P=new Function("return "+I)();for(let F in P){if(F==l.index)continue;let D=h.luckysheetfile[t.getSheetIndex(F)];(D.load==null||D.load=="0")&&(D.celldata=P[F.toString()],D.data=t.buildGridData(D),D.load="1")}v()})}};try{localforage.getItem(b).then(function(v){v!=null&&(t.CacheNotLoadControll=v),Ue.clearcachelocaldata(function(){g()})})}catch(v){g(),console.log("\u7F13\u5B58\u64CD\u4F5C\u5931\u8D25")}},1)},storeSheetParam:function(){let e=this.getSheetIndex(h.currentSheetIndex),n=h.luckysheetfile[e];n.config=h.config,n.visibledatarow=h.visibledatarow,n.visibledatacolumn=h.visibledatacolumn,n.ch_width=h.ch_width,n.rh_height=h.rh_height,n.luckysheet_select_save=$.extend(!0,[],h.luckysheet_select_save),n.luckysheet_selection_range=$.extend(!0,[],h.luckysheet_selection_range),$("#luckysheet-scrollbar-x")[0].scrollWidth>$("#luckysheet-scrollbar-x")[0].offsetWidth&&(n.scrollLeft=$("#luckysheet-scrollbar-x").scrollLeft()),$("#luckysheet-scrollbar-y")[0].scrollHeight>$("#luckysheet-scrollbar-y")[0].offsetHeight&&(n.scrollTop=$("#luckysheet-scrollbar-y").scrollTop()),n.zoomRatio=h.zoomRatio},setSheetParam:function(e=!0){let n=this.getSheetIndex(h.currentSheetIndex),t=h.luckysheetfile[n];h.flowdata=t.data,It.webWorkerFlowDataCache(h.flowdata),y.execFunctionGlobalData=null,window.luckysheet_getcelldata_cache=null,this.sheetParamRestore(t,h.flowdata),t.freezen==null?(Ie.freezenhorizontaldata=null,Ie.freezenverticaldata=null):(Ie.freezenhorizontaldata=t.freezen.horizontal==null?null:t.freezen.horizontal.freezenhorizontaldata,Ie.freezenverticaldata=t.freezen.vertical==null?null:t.freezen.vertical.freezenverticaldata),e&&Xa(h.flowdata.length,h.flowdata[0].length),Zt.buildAllPs(h.flowdata),Pt.currentImgId=null,Pt.images=t.images,Pt.allImagesShow(),Pt.init(),ll.dataVerification=t.dataVerification,ll.init(),ei.hyperlink=t.hyperlink,ei.init(),fi(t.filter_select,t.filter)},restoreselect:function(){let e=this.getSheetIndex(h.currentSheetIndex),n=h.luckysheetfile[e];gl(!0),gr(),n.scrollLeft!=null&&n.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft):$("#luckysheet-scrollbar-x").scrollLeft(0),n.scrollTop!=null&&n.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop):$("#luckysheet-scrollbar-y").scrollTop(0)},storeSheetParamALL:function(){let e=this;e.storeSheetParam();let n=e.getSheetIndex(h.currentSheetIndex);h.luckysheetfile[n].data=h.flowdata,h.luckysheetfile[n].config=$.extend(!0,{},h.config)},mergeCalculationSheet:{},mergeCalculation:function(e){let n=h.luckysheetfile[this.getSheetIndex(e)],t=n.config,l=n.data;if(t==null)return;let o=t.merge;if(!(o==null||e in this.mergeCalculationSheet||n.autoCalculationMerge===!1)){this.mergeCalculationSheet[e]=1;for(let a in o){let s=parseInt(a.substr(0,a.indexOf("_"))),u=parseInt(a.substr(a.indexOf("_")+1)),f=o[a];l[s][u]==null&&(l[s][u]={}),l[s][u].mc={r:s,c:u,rs:f.rs,cs:f.cs};for(let m=s;m<s+f.rs;m++)for(let d=u;d<u+f.cs;d++)m==s&&d==u||(l[m][d]==null&&(l[m][d]={}),l[m][d].mc={r:s,c:u})}}},loadOtherFile:function(e){let n=this;for(let t=0;t<h.luckysheetfile.length;t++){let l=h.luckysheetfile[t];l.index!=e.index&&(l.load==null||l.load=="0")&&(l.data=n.buildGridData(l),l.load="1")}},changeSheet:function(e,n,t,l){if(at())return;let o=this;if(e==h.currentSheetIndex)return;Ue.allowUpdate&&($("#luckysheet-cell-main #luckysheet-multipleRange-show").empty(),Ue.multipleIndex=0);let a=h.luckysheetfile[o.getSheetIndex(e)];if(t&&sl.createHookFunction("sheetCreateAfter",{sheet:a}),l&&sl.createHookFunction("sheetCopyAfter",{sheet:a}),sl.createHookFunction("sheetActivate",e,n,t),$("#luckysheet-filter-selected-sheet"+h.currentSheetIndex+", #luckysheet-filter-options-sheet"+h.currentSheetIndex).hide(),$("#luckysheet-filter-selected-sheet"+e+", #luckysheet-filter-options-sheet"+e).show(),o.storeSheetParamALL(),o.setCurSheet(e),a.isPivotTable?(h.luckysheetcurrentisPivotTable=!0,n||Yt.changePivotTable(e)):(h.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide(),mr(!1)),a.load!=null){let u=o.buildGridData(a);a.data=u,o.mergeCalculation(e),o.setSheetParam(!0),o.showSheet(),setTimeout(function(){y.execFunctionGroup(),Xt(),Ue.saveParam("shs",null,h.currentSheetIndex)},1)}else{let u=Ue.loadSheetUrl;if(u==""||h.luckysheetcurrentisPivotTable||!!t){let f=o.buildGridData(a);a.data=f,a.load="1",o.mergeCalculation(e),o.setSheetParam(),o.showSheet(),setTimeout(function(){o.restoreCache(),y.execFunctionGroupForce(ut.forceCalculation),o.restoreSheetAll(h.currentSheetIndex),Xt()},1),Ue.saveParam("shs",null,h.currentSheetIndex)}else{$("#luckysheet-grid-window-1").append(Wo());let f=o.checkLoadSheetIndex(a);$.post(u,{gridKey:Ue.gridKey,index:f.join(",")},function(m){let d=new Function("return "+m)();a.celldata=d[e.toString()];let p=o.buildGridData(a);setTimeout(function(){h.loadingObj.close()},500);for(let b in d){if(b==e)continue;let g=h.luckysheetfile[o.getSheetIndex(b)];(g.load==null||g.load=="0")&&(g.celldata=d[b.toString()],g.data=o.buildGridData(g),g.load="1")}a.data=p,a.load="1",o.mergeCalculation(e),o.setSheetParam(),o.showSheet(),setTimeout(function(){o.restoreCache(),y.execFunctionGroupForce(ut.forceCalculation),o.restoreSheetAll(h.currentSheetIndex),Xt()},1),Ue.saveParam("shs",null,h.currentSheetIndex)})}}$("#luckysheet-cell-main .luckysheet-datavisual-selection-set").hide(),$("#luckysheet-datavisual-selection-set-"+e).show(),mg(e),Ie.initialFreezen(e),o.restoreselect()},checkLoadSheetIndexToDataIndex:{},checkLoadSheetIndex:function(e){let n=y.getAllFunctionGroup(),t=e.chart,l=e.pivotTable,o=[],a={};if(e.index in this.checkLoadSheetIndexToDataIndex)return[];if(o.push(e.index),a[e.index.toString()]=1,this.checkLoadSheetIndexToDataIndex[e.index]=1,n!=null){let s={};for(let u=0;u<n.length;u++){let f=n[u],m=f.index,d=Ti(f.r,f.c,m);if(d==null){let p=h.luckysheetfile[this.getSheetIndex(m)];if(p.data=this.buildGridData(p),d=Ti(f.r,f.c,m),d==null)continue}if(d.indexOf("!")==-1)y.addToSheetIndexList(d,m);else if(y.formulaContainSheetList!=null&&y.formulaContainSheetList[d]!=null)for(let p in y.formulaContainSheetList[d])s[p]=1;else y.functionParser(d,p=>{if(y.addToCellList(d,p),p.indexOf("!")>-1){let b=p.substr(0,p.indexOf("!")),g=this.getSheetByName(b);if(g!=null){let v=g.index;s[v]=1,y.addToSheetIndexList(d,v)}}}),y.formulaContainSheetList[d]==null&&y.addToSheetIndexList(d,m);m!=null}for(let u in s){let f=u;a[f.toString()]==null&&(o.push(f),a[f.toString()]=1,this.checkLoadSheetIndexToDataIndex[f]=1)}}if(t!=null)for(let s=0;s<t.length;s++){let f=t[s].dataSheetIndex;f!=null&&a[f.toString()]==null&&(o.push(f),a[f.toString()]=1)}if(l!=null){let s=l.pivotDataSheetIndex;s!=null&&a[s.toString()]==null&&(o.push(s),a[s.toString()]=1)}return o},showSheet:function(){$("#luckysheet-cell-flow_0").css({width:h.ch_width,top:"-1px"}),$("#luckysheet-sheettable_0").css({width:h.ch_width-1,height:h.rh_height}),$("#luckysheetrowHeader_0").css("height",h.rh_height),$("#luckysheet-cols-h-cells_0").css("width",h.ch_width),$("#luckysheet-scrollbar-x div").width(h.ch_width),$("#luckysheet-scrollbar-y div").height(h.rh_height+h.columnHeaderHeight-h.cellMainSrollBarSize-3);let e=this.getSheetIndex(h.currentSheetIndex),n=h.luckysheetfile[e];h.scrollRefreshSwitch=!1,n.scrollLeft!=null&&n.scrollLeft>0?$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft*h.zoomRatio):$("#luckysheet-scrollbar-x").scrollLeft(0),n.scrollTop!=null&&n.scrollTop>0?$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop*h.zoomRatio):$("#luckysheet-scrollbar-y").scrollTop(0),setTimeout(()=>{h.scrollRefreshSwitch=!0},0),Qi(h.zoomRatio)},setCurSheet:function(e){for(let n=0;n<h.luckysheetfile.length;n++)h.luckysheetfile[n].index==e?h.luckysheetfile[n].status=1:h.luckysheetfile[n].status=0;h.currentSheetIndex=e},getSheetIndex:function(e){for(let n=0;n<h.luckysheetfile.length;n++)if(h.luckysheetfile[n].index==e)return n;return null},changeSheetExec:function(e,n,t,l){let o=$("#luckysheet-sheets-item"+e);window.luckysheet_getcelldata_cache=null,$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),o.addClass("luckysheet-sheets-item-active").show(),Jr(),this.changeSheet(e,n,t,l),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),y.rangestart&&y.createRangeHightlight(),this.sheetBarShowAndHide(e)},sheetArrowShowAndHide(){let e=$("#luckysheet-sheet-container-c");if(!!e.length){var n=e[0].scrollWidth,t=Math.ceil(e.width());n>t?ut.showsheetbarConfig.sheet&&($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","inline-block"),$("#luckysheet-sheet-container .docs-sheet-fade-left").show()):($("#luckysheet-sheet-area .luckysheet-sheets-scroll").css("display","none"),$("#luckysheet-sheet-container .docs-sheet-fade-left").hide())}},sheetBarShowAndHide(e){let n=$("#luckysheet-sheet-container-c");if(e!=null){let a=$("#luckysheet-sheets-item"+e);n.scrollLeft(a.offset().left)}let t=n.width(),l=n[0].scrollWidth,o=n.scrollLeft();o<=0?$("#luckysheet-sheet-container .docs-sheet-fade-left").hide():$("#luckysheet-sheet-container .docs-sheet-fade-left").show(),t+o>=l?$("#luckysheet-sheet-container .docs-sheet-fade-right").hide():$("#luckysheet-sheet-container .docs-sheet-fade-right").show()},delChart:function(e,n){let t=this.getSheetIndex(n),l=h.luckysheetfile[t];if(l.chart==null)l.chart=[];else for(let o=0;o<l.chart.length;o++)if(l.chart[o].chart_id==e){h.luckysheetfile[t].chart.splice(o,1);break}},saveChart:function(e){let n=this.getSheetIndex(e.sheetIndex),t=h.luckysheetfile[n];if(t.chart==null)t.chart=[],t.chart.push(e);else{for(let l=0;l<t.chart.length;l++)if(t.chart[l].chart_id==e.chart_id){let o=$.extend(!0,{},t.chart[l]);t.chart[l]=$.extend(!0,{},o,e);return}t.chart.push(e)}},getChart:function(e,n){let t=this.getSheetIndex(e),l=h.luckysheetfile[t];if(l.chart==null)return null;for(let o=0;o<l.chart.length;o++)if(l.chart[o].chart_id==n)return l.chart[o];return null},getRangetxt:function(e,n,t){let l="";t==null&&(t=h.currentSheetIndex),e!=t&&(l=h.luckysheetfile[this.getSheetIndex(e)].name+"!");let o=n.row[0],a=n.row[1],s=n.column[0],u=n.column[1];return o==null&&a==null?l+yl(s)+":"+yl(u):s==null&&u==null?l+(o+1)+":"+(a+1):s==u&&o==a?l+yl(s)+(o+1):l+yl(s)+(o+1)+":"+yl(u)+(a+1)},getSheetName:function(e){return e==null&&(e=h.currentSheetIndex),h.luckysheetfile[this.getSheetIndex(e)].name},getSheetMerge:function(){return h.config.merge==null?null:h.config.merge},getSheetData:function(e){return e==null&&(e=h.currentSheetIndex),h.luckysheetfile[this.getSheetIndex(e)].data},getSheetConfig:function(e){let n=this;return e==null&&(e=h.currentSheetIndex),h.luckysheetfile[n.getSheetIndex(e)].config==null&&(h.luckysheetfile[n.getSheetIndex(e)].config={}),h.luckysheetfile[n.getSheetIndex(e)].config},restoreFilter:function(e){let n=this.getSheetIndex(e),t=h.luckysheetfile[n];if(G(t.filter_select)=="string"&&(t.filter_select=JSON.parse(t.filter_select)),t.filter_select==null||t.filter_select.row==null||t.filter_select.column==null)return;fi(t.filter_select),G(t.filter)!="object"&&t.filter!=null&&G(t.filter)=="string"&&(t.filter=JSON.parse(t.filter));let l={};t.config!=null&&t.config.rowhidden!=null&&(l=t.config.rowhidden),$("#luckysheet-filter-options-sheet"+e+" .luckysheet-filter-options").each(function(o){if(t.filter==null)return!1;let a=$(this),s=t.filter[o];if(s==null)return!0;G(s)!="object"&&(s=JSON.parse(s)),Is(a,s.optionstate,s.rowhidden,s.caljs,!1,s.st_r,s.ed_r,s.cindex,s.st_c,s.ed_c),l=$.extend(!0,l,s.rowhidden)}),t.config==null&&(t.config={}),t.config.rowhidden=l,h.config=t.config,tr(h.flowdata.length,h.flowdata[0].length,!1)},restorePivot:function(e){let n=this.getSheetIndex(e);!h.luckysheetfile[n].isPivotTable||(Yt.getCellData(e),Yt.initialPivotManage(!0),Yt.refreshPivotTable(!1))},restoreSheetAll:function(e){let n=this;n.restorePivot(e),n.restoreFilter(e),n.restoreFreezen(e)},restoreFreezen:function(e){Ie.initialFreezen(e)},restoreCache:function(){let e=this,n=e.CacheNotLoadControll;if(e.CacheNotLoadControll=[],n.length!=0)for(let t=0;t<n.length;t++){let l=n[t];e.execCache(l)}},CacheNotLoadControll:[],execCache:function(e){let n=this,t=e.t,l=e.i,o=e.v,a=h.luckysheetfile[n.getSheetIndex(l)];if(t=="sha")h.luckysheetfile.push(o);else if(t=="shc"){let s=$.extend(!0,{},h.luckysheetfile[n.getSheetIndex(o.copyindex)]);s.index=l,h.luckysheetfile.push(s)}else if(t=="shd")h.luckysheetfile.splice(o.deleIndex,1);else if(t=="shr")for(let s in o)h.luckysheetfile[n.getSheetIndex(s)].order=o[s];if((a==null||a.load!="1")&&!(t in{sha:0,shc:0,shd:0,shr:0})){n.CacheNotLoadControll.push(e);return}if(t=="v"){let s=e.r,u=e.c,f=e.v,m=n.getSheetData(l);a.data[s][u]=f}else if(t=="fc"){let s=e.op,u=e.pos;G(o)!="object"&&(o=new Function("return "+o)());let f=o.r,m=o.c;s=="del"?y.delFunctionGroup(f,m,l):y.insertUpdateFunctionGroup(f,m,l)}else if(t=="cg"){let s=o,u=e.k,f=n.getSheetConfig(l);u in f||(f[u]={});for(let m in s)f[u][m]=s[m];h.config=f}else if(t=="f"){let s=o,u=e.op,f=e.pos,m=a.filter;m==null&&(m={}),u=="upOrAdd"?m[f]=s:u=="del"&&delete m[f]}else if(t=="fsc")a.filter=null,a.filter_select=null;else if(t=="fsr"){let s=o;a.filter=s.filter,a.filter_select=s.filter_select}else if(t=="sh"){let s=e.op,u=e.cur,f=o;if(s=="hide")a.status=0,h.luckysheetfile[n.getSheetIndex(u)].status=1;else if(s=="show"){for(let m=0;m<h.luckysheetfile.length;m++)h.luckysheetfile[m].status=0;a.status=1}}else if(t=="all"){let s=e.k;e.s&&G(o)!="object"?a[s]=JSON.stringify(o):a[s]=o}else if(t=="c"){let s=e.op,u=e.cid;if(s=="add")a.chart.push(o);else if(s=="xy"||s=="wh"||s=="update"){for(let f=0;f<a.chart.length;f++)if(a.chart[f].chart_id==u){for(let m in a.chart[f])for(let d in o)m==d&&(a.chart[f][m]=o[d]);return}}else if(s=="del"){for(let f=0;f<a.chart.length;f++)if(a.chart[f].chart_id==u){a.chart.splice(f,1);return}}}else if(t=="drc"){let s=e.rc,u=o.index,f=o.len,m=a.celldata;if(s=="r"){for(let v=0;m.length==0;v++){let x=m[v];x.r>=u&&x.r<u+f?delete m[v]:x.r>=u+f&&(x.r-=f)}a.row-=f}else{for(let v=0;m.length==0;v++){let x=m[v];x.c>=u&&x.c<u+f?delete m[v]:x.c>=u+f&&(x.c-=f)}a.column-=f}let d=[];for(let v=0;v<m.length;v++)m[v]!=null&&d.push(m[v]);a.celldata=d;let p,b,g;s=="r"?p="row":p="column",b=u,g=u+f-1,Ts(p,b,g,!0)}else if(t=="arc"){let s=e.rc,u=o.index,f=o.len,m=a.celldata;if(s=="r"){for(let p=0;p<m.length;p++){let b=m[p];b.r>u&&(b.r+=f)}a.row+=f}else{for(let p=0;p<m.length;p++){let b=m[p];b.c>u&&(b.c+=f)}a.column+=f}let d;s=="r"?d="row":d="column",Ao(d,u,f,!0)}else t=="na"?Ue.saveParam("na",null,o):t=="thumb"&&setTimeout(function(){n.imageRequest()},2e3)}},kt=k3});var import_plugin,b3,y,Sr=Nt(()=>{import_plugin=qe(Ye());Ol();fr();gs();Rr();kn();ln();qr();Di();hi();go();jr();cr();Xo();fo();Er();Do();ui();Wr();Kr();Ri();Ga();Ar();Ya();mf();il();Xl();Qc();wi();b3={error:{v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},errorInfo:function(e){return e},errorParamCheck:function(e,n,t){let l,o,s=Be().formulaMore;return t<e.length?(l=e[t].type,o=e[t].require):(l=e[e.length-1].type,o=e[e.length-1].require),o=="o"&&(n==null||n=="")?[!0,s.tipSuccessText]:l.indexOf("all")>-1?[!0,s.tipSuccessText]:l.indexOf("range")>-1&&(G(n)=="object"||G(n)=="array")?[!0,s.tipSuccessText]:l.indexOf("number")>-1&&(K(n)||G(n)=="boolean")?[!0,s.tipSuccessText]:l.indexOf("string")>-1&&G(n)=="string"?[!0,s.tipSuccessText]:l.indexOf("date")>-1&&dr(n)?[!0,s.tipSuccessText]:[!1,s.tipParamErrorText]},getPureValueByData:function(e){if(e.length==0)return[];let n=[];if(G(e)=="array")if(G(e[0])=="array")for(let t=0;t<e.length;t++){let l=[];for(let o=0;o<e[0].length;o++){let a=e[t][o];G(a)=="object"?l.push(a.v):l.push(a)}n.push(l)}else for(let t=0;t<e.length;t++){let l=e[t];G(l)=="object"?n.push(l.v):n.push(l)}else{let t=e;G(t)=="object"?n.push(t.v):n.push(t)}return n},readCellDataToOneArray:function(e){let n=this;if(e==null)return[];if(G(e)!="object")return[e];let t=[],l=[];if(e!=null&&e.data!=null)l=e.data;else return e!=null&&!ft(e.v)?[e.v]:[];if(G(l)=="array")l=n.getPureValueByData(l);else{if(G(l)=="object")return l=l.v,[l];/\{.*?\}/.test(l)&&(l=l.replace(/\{/g,"[").replace(/\}/g,"]")),l=new Function("return "+l)()}if(G(l[0])=="array")for(let o=0;o<l.length;o++)t=t.concat(l[o]);else t=l;return t},getValueByFuncData:function(e,n){if(e==null)return null;let t=this;return G(e)=="array"?n=="avg"?luckysheet_function.AVERAGE.f.apply(luckysheet_function.AVERAGE,e):n=="sum"?luckysheet_function.SUM.f.apply(luckysheet_function.SUM,e):G(e[0])=="object"?luckysheet.mask.getValueByFormat(e[0]):e[0]:G(e)=="object"?luckysheet.mask.getValueByFormat(e):e},sparklinesColorMap:function(e,n){let t=this,l=null;n==null&&(n=5);let o=0;if(e.length>n)for(let a=n;a<e.length;a++){let s=e[a],u=t.readCellDataToOneArray(s);for(let f=0;f<u.length;f++){let m=u[f];if(m.indexOf(":")>-1){l||(l={});let d=m.split(":");d.length==2?l[d[0]]=d[1]:d.length>1&&(l[d[0]+":"+d[1]]=d[2])}else l||(l=[]),l.push(m)}o++}return l},colorList:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],classlist:{province:{11:"\u5317\u4EAC",12:"\u5929\u6D25",13:"\u6CB3\u5317",14:"\u5C71\u897F",15:"\u5185\u8499\u53E4",21:"\u8FBD\u5B81",22:"\u5409\u6797",23:"\u9ED1\u9F99\u6C5F",31:"\u4E0A\u6D77",32:"\u6C5F\u82CF",33:"\u6D59\u6C5F",34:"\u5B89\u5FBD",35:"\u798F\u5EFA",36:"\u6C5F\u897F",37:"\u5C71\u4E1C",41:"\u6CB3\u5357",42:"\u6E56\u5317",43:"\u6E56\u5357",44:"\u5E7F\u4E1C",45:"\u5E7F\u897F",46:"\u6D77\u5357",50:"\u91CD\u5E86",51:"\u56DB\u5DDD",52:"\u8D35\u5DDE",53:"\u4E91\u5357",54:"\u897F\u85CF",61:"\u9655\u897F",62:"\u7518\u8083",63:"\u9752\u6D77",64:"\u5B81\u590F",65:"\u65B0\u7586",71:"\u53F0\u6E7E",81:"\u9999\u6E2F",82:"\u6FB3\u95E8",91:"\u56FD\u5916"}},oldvalue:null,dontupdate:function(){let e=this;h.luckysheetCellUpdate.length=0,$("#luckysheet-functionbox-cell, #luckysheet-rich-text-editor").html(e.oldvalue),e.cancelNormalSelected(),e.rangetosheet!=h.currentSheetIndex&&kt.changeSheetExec(e.rangetosheet)},xssDeal:function(e){return typeof e!="string"?e:e.replace(/<script>/g,"&lt;script&gt;").replace(/<\/script>/,"&lt;/script&gt;")},ltGtSignDeal:function(e){return typeof e!="string"||e.substr(0,5)==="<span"||e.startsWith("=")?e:e.replace(/</g,"&lt;").replace(/>/g,"&gt;")},fucntionboxshow:function(e,n){if(!Ch(e,n,h.currentSheetIndex)){$("#luckysheet-functionbox-cell").html("");return}let t=this,l=h.flowdata,o="";if(l[e]!=null&&l[e][n]!=null){let a=$.extend(!0,{},l[e][n]);Wn(a)?o=Ry(e,n):a.f!=null?o=Vt(e,n,l,"f"):o=Ka(e,n,l)}o=this.xssDeal(o),t.oldvalue=o,$("#luckysheet-functionbox-cell").html(o)},cellOffset:function(e,n,t,l,o){let a=e.startCell,s=e.rowl,u=e.coll,f=parseInt(a.replace(/[^0-9]/g,"")),m=fn(a.replace(/[^A-Za-z]/g,"")),d=[],p=[],b;d[0]=f+n,p[0]=m+t,d[1]=d[0]+l-1,p[1]=p[0]+o-1,p[0]=yl(p[0]),p[1]=yl(p[1]);let g=p[0]+d[0],v=p[1]+d[1];return g==v?b=e.sheetName+"!"+g:b=e.sheetName+"!"+g+":"+v,b},parseDatetoNum:function(e){let n=this;if(typeof e=="object"&&typeof e.v=="number")e=e.v;else if(Yi(e)=="num")e=parseFloat(e);else if(Yi(e)=="date")e=_l(e)[2];else return n.error.v;return e},getRangeArray:function(e){let n=[],t="General";if(e.length==1)for(let l=0;l<e[0].length;l++)if(e[0][l]!=null&&e[0][l].v){n.push(e[0][l].v);let o=e[0][l].ct.fa;t=t=="General"?o:t}else n.push(null);else if(e[0].length==1)for(let l=0;l<e.length;l++)if(e[l][0]!=null&&e[l][0].v){n.push(e[l][0].v);let o=e[l][0].ct.fa;t=t=="General"?o:t}else n.push(null);else for(let l=0;l<e.length;l++)for(let o=0;o<e[l].length;o++)if(e[l][o]!=null&&e[l][o].v){n.push(e[l][o].v);let a=e[l][o].ct.fa;t=t=="General"?a:t}else n.push(null);return e=n,[e,t]},getRangeArrayTwo:function(e){let n=$.extend(!0,[],e);if(n.length==1)for(let t=0;t<n[0].length;t++)n[0][t]instanceof Object&&(n[0][t]!=null&&n[0][t]instanceof Object&&!!n[0][t].m?n[0][t]=n[0][t].m:n[0][t]!=null&&n[0][t]instanceof Object&&!!n[0][t].v?n[0][t]=n[0][t].v:n[0][t]=null);else if(n[0].length==1)for(let t=0;t<n.length;t++)n[t][0]instanceof Object&&(n[t][0]!=null&&n[t][0]instanceof Object&&!!n[t][0].m?n[t][0]=n[t][0].m:n[t][0]!=null&&n[t][0]instanceof Object&&!!n[t][0].v?n[t][0]=n[t][0].v:n[t][0]=null);else for(let t=0;t<n.length;t++)for(let l=0;l<n[t].length;l++)n[t][l]instanceof Object&&(n[t][l]!=null&&n[t][l]instanceof Object&&!!n[t][l].m?n[t][l]=n[t][l].m:n[t][l]!=null&&n[t][l]instanceof Object&&!!n[t][l].v?n[t][l]=n[t][l].v:n[t][l]=null);return n},isWildcard:function(e,n){let t=this;e=e.toString(),n=n.toString(),t.isCompareOperator(n).flag&&(n=t.isCompareOperator(n).num);let l="";for(let a=0;a<n.length;a++){let s=n.charAt(a);s=="*"?l+=".*":s=="?"?l+=".":s=="~"?n.charAt(a+1)=="*"?(l+="\\*",a++):n.charAt(a+1)=="?"?(l+="\\?",a++):l+="~":l+=s}let o=new RegExp("^"+l+"$","g");return!!e.match(o)},isCompareOperator:function(e){e=e.toString();let n="",t="",l=e.substr(0,1),o=e.substr(1,1),a=!1,s;return l==">"?o=="="?(n=e.substr(0,2),t=e.substr(2),a=!0):o!="="&&(n=e.substr(0,1),t=e.substr(1),a=!0):l=="<"?o=="="||o==">"?(n=e.substr(0,2),t=e.substr(2),a=!0):o!="="&&o!=">"&&(n=e.substr(0,1),t=e.substr(1),a=!0):l=="="&&o!="="&&(n=e.substr(0,1),t=e.substr(1),a=!0),s={flag:a,ope:n,num:t},s},acompareb:function(e,n){let t=this,l=!1;if(K(n))l=au(e,"==",n);else if(typeof n=="string"){if(n.indexOf("*")!=-1||n.indexOf("?")!=-1)return t.isWildcard(e,n);if(t.isCompareOperator(n).flag){let o=t.isCompareOperator(n).ope,a=t.isCompareOperator(n).num;l=au(e,o,a)}else l=au(e,"==",n)}return l},compareParams:function(e,n,t){let l=!1,o=toString.call(e),a=toString.call(n);if((t==">"&&e>n||t==">="&&e>=n||t=="<"&&e<n||t=="<="&&e<=n||t=="="&&e==n||t=="<>"&&e!=n)&&(l=!0),o=="[object Object]"&&a=="[object Object]"){let s=Object.getOwnPropertyNames(e),u=Object.getOwnPropertyNames(n);if(s.length!=u.length)return!1;for(let f=0;f<s.length;f++){let m=s[f];if(e[m]!==n[m])return!1}return!0}return o=="[object Array]"&&a=="[object Array]"?e.toString()==n.toString():l},parseDecimal:function(e){e=parseFloat(e);let n=parseInt(e,10);return n==0||(e=e%n),e},getcellrange:function(e,n){if(e==null||e.length==0)return;let t="",l="",o=null,a=null,s=ur();if(e.indexOf("!")>-1){if(e in this.cellTextToIndexList)return this.cellTextToIndexList[e];let u=e.split("!");t=u[0],l=u[1],t=t.replace(/\\'/g,"'").replace(/''/g,"'"),t.substr(0,1)=="'"&&t.substr(t.length-1,1)=="'"&&(t=t.substring(1,t.length-1));for(let f in s)if(t==s[f].name){o=s[f].index,a=s[f].data;break}}else{let u=n;if(u==null&&(u=h.currentSheetIndex),e+"_"+u in this.cellTextToIndexList)return this.cellTextToIndexList[e+"_"+u];let f=Me(u);t=s[f].name,o=s[f].index,a=h.flowdata,l=e}if(l.indexOf(":")==-1){let u=parseInt(l.replace(/[^0-9]/g,""))-1,f=fn(l.replace(/[^A-Za-z]/g,""));if(!isNaN(u)&&!isNaN(f)){let m={row:[u,u],column:[f,f],sheetIndex:o};return this.addToCellIndexList(e,m),m}else return null}else{l=l.split(":");let u=[],f=[];if(u[0]=parseInt(l[0].replace(/[^0-9]/g,""))-1,u[1]=parseInt(l[1].replace(/[^0-9]/g,""))-1,isNaN(u[0])&&(u[0]=0),isNaN(u[1])&&(u[1]=a.length-1),u[0]>u[1]||(f[0]=fn(l[0].replace(/[^A-Za-z]/g,"")),f[1]=fn(l[1].replace(/[^A-Za-z]/g,"")),isNaN(f[0])&&(f[0]=0),isNaN(f[1])&&(f[1]=a[0].length-1),f[0]>f[1]))return null;let m={row:u,column:f,sheetIndex:o};return this.addToCellIndexList(e,m),m}},rangeHightlightHTML:'<div id="luckysheet-formula-functionrange-highlight-${id}" rangeindex="${id}"  class="luckysheet-selection-highlight luckysheet-formula-functionrange-highlight"><div data-type="top" class="luckysheet-selection-copy-top luckysheet-copy"></div><div data-type="right" class="luckysheet-selection-copy-right luckysheet-copy"></div><div data-type="bottom" class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div data-type="left" class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div><div data-type="lt" class="luckysheet-selection-highlight-topleft luckysheet-highlight"></div><div data-type="rt" class="luckysheet-selection-highlight-topright luckysheet-highlight"></div><div data-type="lb" class="luckysheet-selection-highlight-bottomleft luckysheet-highlight"></div><div data-type="rb" class="luckysheet-selection-highlight-bottomright luckysheet-highlight"></div></div>',createRangeHightlight:function(){let e=this,n=$("#luckysheet-rich-text-editor").find("span.luckysheet-formula-functionrange-cell");$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),n.each(function(){let t=$(this).attr("rangeindex"),l=$(this).text();$("#luckysheet-formula-functionrange").append(Tt(e.rangeHightlightHTML,{id:t}));let o=e.getcellrange(l),a="luckysheet-formula-functionrange-highlight-"+t;o==null||(o.sheetIndex==h.currentSheetIndex||o.sheetIndex==-1&&e.rangetosheet==h.currentSheetIndex)&&($("#"+a).data("range",o).find(".luckysheet-copy").css({background:Pi[t]}).end().find(".luckysheet-highlight").css({background:Pi[t]}).end().find(".luckysheet-selection-copy-hc").css({background:Pi[t]}),S1(a,o.row[0],o.row[1],o.column[0],o.column[1]))}),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").show()},searchHTML:'<div id="luckysheet-formula-search-c" class="luckysheet-formula-search-c"></div>',helpHTML:'<div id="luckysheet-formula-help-c" class="luckysheet-formula-help-c"> <div class="luckysheet-formula-help-close" title="${helpClose}"><i class="fa fa-times" aria-hidden="true"></i></div> <div class="luckysheet-formula-help-collapse" title="${helpCollapse}"><i class="fa fa-angle-up" aria-hidden="true"></i></div> <div class="luckysheet-formula-help-title"><div class="luckysheet-formula-help-title-formula"> <span class="luckysheet-arguments-help-function-name">SUM</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> <span class="luckysheet-arguments-help-parameter luckysheet-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="luckysheet-arguments-help-parameter" dir="auto">101</span> </span> <span class="luckysheet-arguments-paren">)</span> </div></div> <div class="luckysheet-formula-help-content"> <div class="luckysheet-formula-help-content-example"> <div class="luckysheet-arguments-help-section-title">${helpExample}</div> <div class="luckysheet-arguments-help-formula"> <span class="luckysheet-arguments-help-function-name">SUM</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> <span class="luckysheet-arguments-help-parameter luckysheet-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="luckysheet-arguments-help-parameter" dir="auto">101</span> </span> <span class="luckysheet-arguments-paren">)</span> </div> </div> <div class="luckysheet-formula-help-content-detail"> <div class="luckysheet-arguments-help-section"> <div class="luckysheet-arguments-help-section-title luckysheet-arguments-help-parameter-name">${helpAbstract}</div> <span class="luckysheet-arguments-help-parameter-content">${helpAbstract}</span> </div> </div> <div class="luckysheet-formula-help-content-param"> ${param} </div> </div> <div class="luckysheet-formula-help-foot"></div></div>',getrangeseleciton:function(){let e=window.getSelection(),n=$(e.anchorNode),t=e.anchorOffset;if(n.parent().is("span")&&t!=0){let l=$.trim(n.text()),o="";if(l.length==0&&n.parent().prev().length>0){let a=n.parent().prev();return l=$.trim(a.text()),o=l.substr(l.length-1,1),a}else return o=l.substr(t-1,1),n.parent()}else if(n.is("#luckysheet-rich-text-editor")||n.is("#luckysheet-functionbox-cell")){let l=$.trim(n.find("span").last().text());if(l.length==0&&n.find("span").length>1){let o=n.find("span");return l=$.trim(o.eq(o.length-2).text()),o}else return n.find("span").last()}else if((n.parent().is("#luckysheet-rich-text-editor")||n.parent().is("#luckysheet-functionbox-cell")||t==0)&&(t==0&&(n=n.parent()),n.prev().length>0)){let l=$.trim(n.prev().text()),o=l.substr(l.length-1,1);return n.prev()}return null},searchFunctionPosition:function(e,n,t,l,o){let a=$(window).height(),s=$(window).width(),u=e.outerWidth(),f=e.outerHeight();o==null&&(o=!1);let m=t;t+u>s?m=t-u+n.outerWidth():m=t;let d=l;l+f>a?d=l-f:(d=l+n.outerHeight(),o||e.html(e.find(".luckysheet-formula-search-item").get().reverse())),d<0&&(d=0),m<0&&(m=0),e.css({top:d,left:m}).show()},searchFunctionCell:null,searchFunction:function(e){let n=this,t=h.functionlist,l=n.getrangeseleciton();if(n.searchFunctionCell=l,l==null||e==null)return;let o=e.text(),a=l.text().toUpperCase();if(!/^[a-zA-Z]|[a-zA-Z_]+$/.test(a)||o.substr(0,1)!="=")return;let u={f:[],s:[],t:[]},f=0;for(let g=0;g<t.length;g++){let v=t[g],x=v.n;if(x==a?(u.f.unshift(v),f++):x.substr(0,a.length)==a?(u.s.unshift(v),f++):x.indexOf(a)>-1&&(u.t.unshift(v),f++),f>=10)break}let m=u.t.concat(u.s.concat(u.f));if(m.length<=0)return;let d=n.searchFunctionHTML(m);$("#luckysheet-formula-search-c").html(d).show(),$("#luckysheet-formula-help-c").hide();let p=e.parent(),b=p.offset();n.searchFunctionPosition($("#luckysheet-formula-search-c"),p,b.left,b.top)},searchFunctionEnter:function(e){let n=this,t=e.data("func");n.searchFunctionCell.text(t).after('<span dir="auto" class="luckysheet-formula-text-color">(</span>'),n.setCaretPosition(n.searchFunctionCell.next().get(0),0,1),$("#luckysheet-formula-search-c").hide(),n.helpFunctionExe(n.searchFunctionCell.closest("div"),n.searchFunctionCell.next())},searchFunctionHTML:function(e){let n=this;$("#luckysheet-formula-search-c").length==0&&($("body").first().append(n.searchHTML),$("#luckysheet-formula-search-c").on("mouseover",".luckysheet-formula-search-item",function(){$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),$(this).addClass("luckysheet-formula-search-item-active")}).on("mouseout",".luckysheet-formula-search-item",function(){}).on("click",".luckysheet-formula-search-item",function(){n.searchFunctionCell!=null&&n.searchFunctionEnter($(this))}));let t='<div data-func="${n}" class="luckysheet-formula-search-item ${class}"><div class="luckysheet-formula-search-func">${n}</div><div class="luckysheet-formula-search-detail">${a}</div></div>',l="";for(let o=0;o<e.length;o++){let a=e[o];o==e.length-1?l+=Tt(t,{class:"luckysheet-formula-search-item-active",n:a.n,a:a.a}):l+=Tt(t,{class:"",n:a.n,a:a.a})}return l},functionlistPosition:{},helpFunction:function(e,n,t){let l=this,a=h.functionlist[l.functionlistPosition[$.trim(n).toUpperCase()]];if(a==null)return;let u=Be().formulaMore;$("#luckysheet-formula-help-c .luckysheet-arguments-help-function-name").html(a.n),$("#luckysheet-formula-help-c .luckysheet-arguments-help-parameter-content").html(a.d);let f='<span class="luckysheet-arguments-help-function-name">${name}</span> <span class="luckysheet-arguments-paren">(</span> <span class="luckysheet-arguments-parameter-holder"> ${param} </span> <span class="luckysheet-arguments-paren">)</span>',m='<span class="luckysheet-arguments-help-parameter" dir="auto">${param}</span>',d='<div class="luckysheet-arguments-help-section"><div class="luckysheet-arguments-help-section-title">${param}</div><span class="luckysheet-arguments-help-parameter-content">${content}</span></div>',p="",b="",g="";for(let _=0;_<a.p.length;_++){let S=a.p[_],I=S.name,P=S.name;S.repeat=="y"&&(I+=", ...",P+='<span class="luckysheet-arguments-help-argument-info">...-'+u.allowRepeatText+"</span>"),S.require=="o"&&(I="["+I+"]",P+='<span class="luckysheet-arguments-help-argument-info">-['+u.allowOptionText+"]</span>"),p+='<span class="luckysheet-arguments-help-parameter" dir="auto">'+I+"</span>, ",b+='<span class="luckysheet-arguments-help-parameter" dir="auto">'+S.example+"</span>, ",g+=Tt(d,{param:P,content:S.detail})}if(p=p.substr(0,p.length-2),b=b.substr(0,b.length-2),$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder").html(p),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder").html(b),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param").html(g),t==null)$("#luckysheet-formula-help-c .luckysheet-formula-help-title-formula .luckysheet-arguments-help-function-name").css("font-weight","bold");else{$("#luckysheet-formula-help-c .luckysheet-formula-help-title-formula .luckysheet-arguments-help-function-name").css("font-weight","normal");let _=t>=a.p.length?a.p.length-1:t;$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-title .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").eq(_).addClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-arguments-help-formula .luckysheet-arguments-parameter-holder .luckysheet-arguments-help-parameter").eq(_).addClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param .luckysheet-arguments-help-section").removeClass("luckysheet-arguments-help-parameter-active"),$("#luckysheet-formula-help-c .luckysheet-formula-help-content-param .luckysheet-arguments-help-section").eq(_).addClass("luckysheet-arguments-help-parameter-active")}let v=e.parent(),x=v.offset();l.searchFunctionPosition($("#luckysheet-formula-help-c"),v,x.left,x.top,!0)},helpFunctionExe:function(e,n){let t=this,l=h.functionlist,a=Be().formulaMore;if($("#luckysheet-formula-help-c").length==0){$("body").first().after(Tt(t.helpHTML,{helpClose:a.helpClose,helpCollapse:a.helpCollapse,helpExample:a.helpExample,helpAbstract:a.helpAbstract})),$("#luckysheet-formula-help-c .luckysheet-formula-help-close").click(function(){$("#luckysheet-formula-help-c").hide()}),$("#luckysheet-formula-help-c .luckysheet-formula-help-collapse").click(function(){let g=$("#luckysheet-formula-help-c .luckysheet-formula-help-content");g.slideToggle(100,function(){let v=t.rangeResizeTo.parent(),x=v.offset();t.searchFunctionPosition($("#luckysheet-formula-help-c"),v,x.left,x.top,!0)}),g.is(":hidden")?$(this).html('<i class="fa fa-angle-up" aria-hidden="true"></i>'):$(this).html('<i class="fa fa-angle-down" aria-hidden="true"></i>')});for(let g=0;g<l.length;g++)t.functionlistPosition[l[g].n]=g}if(!n)return;let s=n,u=e.length,f=e.find("span"),m=n.index(),d=m;if(s==null)return;let p=null,b=null;if(f.eq(d).is(".luckysheet-formula-text-func"))p=f.eq(d).text();else{let g=null,v=[-1,-1];for(;--d>0;)if(g=f.eq(d),g.is(".luckysheet-formula-text-func")||$.trim(g.text()).toUpperCase()in t.functionlistPosition){p=g.text(),b=null;let x=!0;for(let _=d;_<=m;_++)if(b||(b=0),!(_>=v[0]&&_<=v[1])){if(g=f.eq(_),g.is(".luckysheet-formula-text-rpar")){v=[d,_],p=null,x=!1;break}g.is(".luckysheet-formula-text-comma")&&b++}if(x)break}}p!=null&&t.helpFunction(e,p,b)},rangeHightlightselected:function(e,n){let t=this,l=t.getrangeseleciton();if($("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide(),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight .luckysheet-selection-copy-hc").css("opacity","0.03"),$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide(),t.helpFunctionExe(e,l),$(l).closest(".luckysheet-formula-functionrange-cell").length==0){t.searchFunction(e);return}let a=$(l).closest(".luckysheet-formula-functionrange-cell").attr("rangeindex"),s="luckysheet-formula-functionrange-highlight-"+a;$("#"+s).find(".luckysheet-selection-copy-hc").css({opacity:"0.13"})},updatecell:function(e,n,t,l=!0){let o=this,a=$("#luckysheet-rich-text-editor"),s=a.text(),u=a.html();if(o.rangetosheet!=null&&o.rangetosheet!=h.currentSheetIndex&&kt.changeSheetExec(o.rangetosheet),!Qa(e,n,h.currentSheetIndex))return;if(ll.dataVerification!=null){let F=ll.dataVerification[e+"_"+n];if(F!=null&&F.prohibitInput&&!ll.validateCellData(s,F)){let D=ll.getFailureText(F);ke.info(D,""),o.cancelNormalSelected();return}}let f=h.flowdata[e][n],m=JSON.stringify(f),d=Wn(f),p=s.slice(0,1)!="="&&u.substr(0,5)=="<span",b=!1;if(!p&&s&&s.length>0){let F=s.replace(/\r\n/g,"_x000D_").replace(/&#13;&#10;/g,"_x000D_").replace(/\r/g,"_x000D_").replace(/\n/g,"_x000D_").split("_x000D_");F.length>1&&(b=!0,p=!0,s=F.join(`\r
`))}if(!t&&!p&&d?(delete f.ct.s,f.ct.t="g",f.ct.fa="General",t=""):p&&(G(f)!="object"&&(f={}),delete f.f,delete f.v,delete f.m,f.ct==null&&(f.ct={},f.ct.fa="General"),f.ct.t="inlineStr",f.ct.s=$y(a.find("span")),b&&(f.ct.s=[{v:s}])),t=t||a.text(),!sl.createHookFunction("cellUpdateBefore",e,n,t,l)){o.cancelNormalSelected();return}if(!p){if(ft(t)&&!d){if(f==null||ft(f.v)&&f.spl==null&&f.f==null){o.cancelNormalSelected();return}}else if(f!=null&&f.qp!=1){if(G(f)=="object"&&(t==f.f||t==f.v||t==f.m)){o.cancelNormalSelected();return}else if(t==f){o.cancelNormalSelected();return}}G(t)=="string"&&t.slice(0,1)=="="&&t.length>1||G(f)=="object"&&f.ct!=null&&f.ct.fa!=null&&f.ct.fa!="@"&&!ft(t)&&(delete f.m,f.f!=null&&(delete f.f,delete f.spl))}window.luckysheet_getcelldata_cache=null;let g=!0,v=It.deepCopyFlowData(h.flowdata),x=null;if(G(f)=="object"){if(!p)if(G(t)=="string"&&t.slice(0,1)=="="&&t.length>1){let F=o.execfunction(t,e,n,void 0,!0);if(g=!1,f=$.extend(!0,{},v[e][n]),f.v=F[1],f.f=F[2],F.length==4&&F[3].type=="sparklines"){delete f.m,delete f.v;let D=F[3].data;G(D)=="array"&&G(D[0])!="object"?f.v=D[0]:f.spl=F[3].data}else F.length==4&&F[3].type=="dynamicArrayItem"&&(x=F[3].data)}else if(G(t)=="object"){let F=t.f;if(G(F)=="string"&&F.slice(0,1)=="="&&F.length>1){let D=o.execfunction(F,e,n,void 0,!0);if(g=!1,f=$.extend(!0,{},v[e][n]),f.v=D[1],f.f=D[2],D.length==4&&D[3].type=="sparklines"){delete f.m,delete f.v;let k=D[3].data;G(k)=="array"&&G(k[0])!="object"?f.v=k[0]:f.spl=D[3].data}else D.length==4&&D[3].type=="dynamicArrayItem"&&(x=D[3].data)}else for(let D in t)f[D]=t[D]}else o.delFunctionGroup(e,n),o.execFunctionGroup(e,n,t),g=!1,f=$.extend(!0,{},v[e][n]),f.v=t,delete f.f,delete f.spl,f.qp==1&&(""+t).substr(0,1)!="'"&&(f.qp=0,f.ct!=null&&(f.ct.fa="General",f.ct.t="n"));t=f}else if(G(t)=="string"&&t.slice(0,1)=="="&&t.length>1){let F=o.execfunction(t,e,n,void 0,!0);if(g=!1,t={v:F[1],f:F[2]},F.length==4&&F[3].type=="sparklines"){let D=F[3].data;G(D)=="array"&&G(D[0])!="object"?t.v=D[0]:t.spl=F[3].data}else F.length==4&&F[3].type=="dynamicArrayItem"&&(x=F[3].data)}else if(G(t)=="object"){let F=t.f;if(G(F)=="string"&&F.slice(0,1)=="="&&F.length>1){let D=o.execfunction(F,e,n,void 0,!0);if(g=!1,t.v=D[1],t.f=D[2],D.length==4&&D[3].type=="sparklines"){let k=D[3].data;G(k)=="array"&&G(k[0])!="object"?t.v=k[0]:t.spl=D[3].data}else D.length==4&&D[3].type=="dynamicArrayItem"&&(x=D[3].data)}else{let D=f;t.v==null&&(t.v=D)}}else o.delFunctionGroup(e,n),o.execFunctionGroup(e,n,t),g=!1;kr(e,n,v,t),o.cancelNormalSelected();let _=!1,S=$.extend(!0,{},ur()[Me(h.currentSheetIndex)].config);if(S.rowlen==null&&(S.rowlen={}),v[e][n].tb=="2"&&v[e][n].v!=null||Wn(v[e][n])&&typeof v[e][n].mc=="undefined"){let F=h.defaultrowlen,D=$("#luckysheetTableContent").get(0).getContext("2d");if(!(S.customHeight&&S.customHeight[e]==1)){let k=or(n)[1]-or(n)[0]-2,w=Mo(v[e][n],D,{r:e,c:n,cellWidth:k}),C=F;w!=null&&(C=w.textHeightAll+2),C>F&&(S.rowlen[e]=C,_=!0)}}let I=null;x&&(I=$.extend(!0,[],this.insertUpdateDynamicArray(x)));let P={dynamicArray:I};if(_&&(P={cfg:S,dynamicArray:I,RowlChange:_}),setTimeout(()=>{sl.createHookFunction("cellUpdated",e,n,JSON.parse(m),h.flowdata[e][n],l)},0),l)al(v,[{row:[e,e],column:[n,n]}],P,g),o.execFunctionGlobalData=null;else return{data:v,allParam:P}},cancelNormalSelected:function(){let e=this;e.canceFunctionrangeSelected(),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-input-box-index").hide(),$("#luckysheet-wa-functionbox-cancel, #luckysheet-wa-functionbox-confirm").removeClass("luckysheet-wa-calculate-active"),e.rangestart=!1,e.rangedrag_column_start=!1,e.rangedrag_row_start=!1},canceFunctionrangeSelected:function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),$("#luckysheet-formula-search-c, #luckysheet-formula-help-c").hide()},iscellformat:function(e){let n=/[abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ][123456789]/},iscelldata:function(e){let n=e.split("!"),t;n.length>1?t=n[1]:t=n[0];let l=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g,o=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(t.indexOf(":")==-1){let a=parseInt(t.replace(/[^0-9]/g,""))-1,s=fn(t.replace(/[^A-Za-z]/g,""));return!isNaN(a)&&!isNaN(s)&&t.toString().match(l)?!0:(isNaN(a)&&isNaN(s),!1)}else{o=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,t=t.split(":");let a=[],s=[];return a[0]=parseInt(t[0].replace(/[^0-9]/g,""))-1,a[1]=parseInt(t[1].replace(/[^0-9]/g,""))-1,a[0]>a[1]||(s[0]=fn(t[0].replace(/[^A-Za-z]/g,"")),s[1]=fn(t[1].replace(/[^A-Za-z]/g,"")),s[0]>s[1])?!1:!!(t[0].toString().match(o)&&t[1].toString().match(o))}},operator:"==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",operatorjson:null,functionCopy:function(e,n,t){let l=this;if(l.operatorjson==null){let d=l.operator.split("|"),p={};for(let b=0;b<d.length;b++)p[d[b].toString()]=1;l.operatorjson=p}n==null&&(n="down"),t==null&&(t=1),e.substr(0,1)=="="&&(e=e.substr(1));let o=e.split(""),a=0,s="",u="",f=!0,m={bracket:0,comma:0,squote:0,dquote:0};for(;a<o.length;){let d=o[a];if(d=="("&&m.dquote==0)m.bracket+=1,s.length>0?u+=s+"(":u+="(",s="";else if(d==")"&&m.dquote==0)m.bracket-=1,u+=l.functionCopy(s,n,t)+")",s="";else if(d=='"'&&m.squote==0)m.dquote>0?(u+=s+'"',m.dquote-=1,s=""):(m.dquote+=1,s+='"');else if(d==","&&m.dquote==0)u+=l.functionCopy(s,n,t)+",",s="";else if(d=="&"&&m.dquote==0)s.length>0?(u+=l.functionCopy(s,n,t)+"&",s=""):u+="&";else if(d in l.operatorjson&&m.dquote==0){let p="";a+1<o.length&&(p=o[a+1]);let b=a-1,g=null;if(b>=0)do g=o[b--];while(b>=0&&g==" ");d+p in l.operatorjson?(s.length>0?(u+=l.functionCopy(s,n,t)+d+p,s=""):u+=d+p,a++):!/[^0-9]/.test(p)&&d=="-"&&(g=="("||g==null||g==","||g==" "||g in l.operatorjson)?s+=d:s.length>0?(u+=l.functionCopy(s,n,t)+d,s=""):u+=d}else s+=d;a==o.length-1&&(l.iscelldata($.trim(s))?n=="down"?u+=l.downparam($.trim(s),t):n=="up"?u+=l.upparam($.trim(s),t):n=="left"?u+=l.leftparam($.trim(s),t):n=="right"&&(u+=l.rightparam($.trim(s),t)):u+=$.trim(s)),a++}return u},isfreezonFuc:function(e){let n=e.replace(/[^0-9]/g,""),t=e.replace(/[^A-Za-z]/g,""),l=e.substr(e.indexOf(n)-1,1),o=e.substr(e.indexOf(t)-1,1),a=[!1,!1];return l=="$"&&(a[0]=!0),o=="$"&&(a[1]=!0),a},setfreezonFuceExe:function(e){let n=parseInt(e.replace(/[^0-9]/g,"")),t=fn(e.replace(/[^A-Za-z]/g,"")),l="$",o="$";return!isNaN(n)&&!isNaN(t)?o+yl(t)+l+n:isNaN(n)?isNaN(t)?e:o+yl(t):l+n},setfreezonFuc:function(e){let n=this,t=n.getrangeseleciton();if(!n.iscelldata(t.text()))return;let l=t.text(),o=window.getSelection().anchorOffset,a=l.split("!"),s,u="";a.length>1?(s=a[1],u=a[0]+"!"):s=a[0];let f="",m="",d=s.indexOf(":");if(d==-1)f=u+n.setfreezonFuceExe(s),m=f.length;else if(s=s.split(":"),o>d){let p=u+s[0]+":"+n.setfreezonFuceExe(s[1]);f=p,m=p.length}else{let p=u+n.setfreezonFuceExe(s[0]);f=p+":"+s[1],m=p.length}t.text(u+f),n.setCaretPosition(t.get(0),0,m)},updateparam:function(e,n,t){let l=this,o=n.split("!"),a,s="";if(o.length>1?(a=o[1],s=o[0]+"!"):a=o[0],a.indexOf(":")==-1){let u=parseInt(a.replace(/[^0-9]/g,"")),f=fn(a.replace(/[^A-Za-z]/g,"")),m=l.isfreezonFuc(a),d=m[0]?"$":"",p=m[1]?"$":"";return e=="u"&&!m[0]?u-=t:e=="r"&&!m[1]?f+=t:e=="l"&&!m[1]?f-=t:e=="d"&&!m[0]&&(u+=t),u[0]<0||f[0]<0?l.error.r:!isNaN(u)&&!isNaN(f)?s+p+yl(f)+d+u:isNaN(u)?isNaN(f)?n:s+p+yl(f):s+d+u}else{a=a.split(":");let u=[],f=[];if(u[0]=parseInt(a[0].replace(/[^0-9]/g,"")),u[1]=parseInt(a[1].replace(/[^0-9]/g,"")),u[0]>u[1]||(f[0]=fn(a[0].replace(/[^A-Za-z]/g,"")),f[1]=fn(a[1].replace(/[^A-Za-z]/g,"")),f[0]>f[1]))return n;let m=l.isfreezonFuc(a[0]),d=l.isfreezonFuc(a[1]),p=m[0]?"$":"",b=m[1]?"$":"",g=d[0]?"$":"",v=d[1]?"$":"";return e=="u"?(m[0]||(u[0]-=t),d[0]||(u[1]-=t)):e=="r"?(m[1]||(f[0]+=t),d[1]||(f[1]+=t)):e=="l"?(m[1]||(f[0]-=t),d[1]||(f[1]-=t)):e=="d"&&(m[0]||(u[0]+=t),d[0]||(u[1]+=t)),u[0]<0||f[0]<0?l.error.r:isNaN(f[0])&&isNaN(f[1])?s+p+u[0]+":"+g+u[1]:isNaN(u[0])&&isNaN(u[1])?s+b+yl(f[0])+":"+v+yl(f[1]):s+b+yl(f[0])+p+u[0]+":"+v+yl(f[1])+g+u[1]}},downparam:function(e,n){return this.updateparam("d",e,n)},upparam:function(e,n){return this.updateparam("u",e,n)},leftparam:function(e,n){return this.updateparam("l",e,n)},rightparam:function(e,n){return this.updateparam("r",e,n)},functionStrChange:function(e,n,t,l,o,a){let s=this;if(s.operatorjson==null){let g=s.operator.split("|"),v={};for(let x=0;x<g.length;x++)v[g[x].toString()]=1;s.operatorjson=v}e.substr(0,1)=="="&&(e=e.substr(1));let u=e.split(""),f=0,m="",d="",p=!0,b={bracket:0,comma:0,squote:0,dquote:0};for(;f<u.length;){let g=u[f];if(g=="("&&b.dquote==0)b.bracket+=1,m.length>0?d+=m+"(":d+="(",m="";else if(g==")"&&b.dquote==0)b.bracket-=1,d+=s.functionStrChange(m,n,t,l,o,a)+")",m="";else if(g=='"'&&b.squote==0)b.dquote>0?(d+=m+'"',b.dquote-=1,m=""):(b.dquote+=1,m+='"');else if(g==","&&b.dquote==0)d+=s.functionStrChange(m,n,t,l,o,a)+",",m="";else if(g=="&"&&b.dquote==0)m.length>0?(d+=s.functionStrChange(m,n,t,l,o,a)+"&",m=""):d+="&";else if(g in s.operatorjson&&b.dquote==0){let v="";f+1<u.length&&(v=u[f+1]);let x=f-1,_=null;if(x>=0)do _=u[x--];while(x>=0&&_==" ");g+v in s.operatorjson?(m.length>0?(d+=s.functionStrChange(m,n,t,l,o,a)+g+v,m=""):d+=g+v,f++):!/[^0-9]/.test(v)&&g=="-"&&(_=="("||_==null||_==","||_==" "||_ in s.operatorjson)?m+=g:m.length>0?(d+=s.functionStrChange(m,n,t,l,o,a)+g,m=""):d+=g}else m+=g;f==u.length-1&&(s.iscelldata($.trim(m))?d+=s.functionStrChange_range($.trim(m),n,t,l,o,a):d+=$.trim(m)),f++}return d},functionStrChange_range:function(e,n,t,l,o,a){let s=this,u=e.split("!"),f,m="";u.length>1?(f=u[1],m=u[0]+"!"):f=u[0];let d,p,b,g,v,x,_,S;if(f.indexOf(":")==-1){d=p=parseInt(f.replace(/[^0-9]/g,""))-1,b=g=fn(f.replace(/[^A-Za-z]/g,""));let I=s.isfreezonFuc(f);v=x=I[0]?"$":"",_=S=I[1]?"$":""}else{if(f=f.split(":"),d=parseInt(f[0].replace(/[^0-9]/g,""))-1,p=parseInt(f[1].replace(/[^0-9]/g,""))-1,d>p||(b=fn(f[0].replace(/[^A-Za-z]/g,"")),g=fn(f[1].replace(/[^A-Za-z]/g,"")),b>g))return e;let I=s.isfreezonFuc(f[0]);v=I[0]?"$":"",_=I[1]?"$":"";let P=s.isfreezonFuc(f[1]);x=P[0]?"$":"",S=P[1]?"$":""}if(n=="del"){if(t=="row"){if(d>=o&&p<=o+a-1)return s.error.r;d>o+a-1?d-=a:d>=o&&(d=o),p>o+a-1?p-=a:p>=o&&(p=o-1),d<0&&(d=0),p<d&&(p=d)}else if(t=="col"){if(b>=o&&g<=o+a-1)return s.error.r;b>o+a-1?b-=a:b>=o&&(b=o),g>o+a-1?g-=a:g>=o&&(g=o-1),b<0&&(b=0),g<b&&(g=b)}return d==p&&b==g?!isNaN(d)&&!isNaN(b)?m+_+yl(b)+v+(d+1):isNaN(d)?isNaN(b)?e:m+_+yl(b):m+v+(d+1):isNaN(b)&&isNaN(g)?m+v+(d+1)+":"+x+(p+1):isNaN(d)&&isNaN(p)?m+_+yl(b)+":"+S+yl(g):m+_+yl(b)+v+(d+1)+":"+S+yl(g)+x+(p+1)}else if(n=="add")return t=="row"?l=="lefttop"?(d>=o&&(d+=a),p>=o&&(p+=a)):l=="rightbottom"&&(d>o&&(d+=a),p>o&&(p+=a)):t=="col"&&(l=="lefttop"?(b>=o&&(b+=a),g>=o&&(g+=a)):l=="rightbottom"&&(b>o&&(b+=a),g>o&&(g+=a))),d==p&&b==g?!isNaN(d)&&!isNaN(b)?m+_+yl(b)+v+(d+1):isNaN(d)?isNaN(b)?e:m+_+yl(b):m+v+(d+1):isNaN(b)&&isNaN(g)?m+v+(d+1)+":"+x+(p+1):isNaN(d)&&isNaN(p)?m+_+yl(b)+":"+S+yl(g):m+_+yl(b)+v+(d+1)+":"+S+yl(g)+x+(p+1)},israngeseleciton:function(e){let n=this;if(n.operatorjson==null){let a=n.operator.split("|"),s={};for(let u=0;u<a.length;u++)s[a[u].toString()]=1;n.operatorjson=s}e==null&&(e=!1);let t=window.getSelection(),l=$(t.anchorNode),o=t.anchorOffset;if(l.parent().is("span")&&o!=0){let a=$.trim(l.text()),s="";if(a.length==0&&l.parent().prev().length>0){let u=l.parent().prev();a=$.trim(u.text()),s=a.substr(a.length-1,1),n.rangeSetValueTo=u}else s=a.substr(o-1,1),n.rangeSetValueTo=l.parent();if(e&&(s=="("||s==",")||!e&&(s=="("||s==","||s=="="||s in n.operatorjson||s=="&"))return!0}else if(l.is("#luckysheet-rich-text-editor")||l.is("#luckysheet-functionbox-cell")){let a=$.trim(l.find("span").last().text()),s;if(n.rangeSetValueTo=l.find("span").last(),a.length==0&&l.find("span").length>1){let u=l.find("span");a=$.trim(u.eq(u.length-2).text()),n.rangeSetValueTo=u}if(s=a.substr(a.length-1,1),e&&(s=="("||s==",")||!e&&(s=="("||s==","||s=="="||s in n.operatorjson||s=="&"))return!0}else if((l.parent().is("#luckysheet-rich-text-editor")||l.parent().is("#luckysheet-functionbox-cell")||o==0)&&(o==0&&(l=l.parent()),l.prev().length>0)){let a=$.trim(l.prev().text()),s=a.substr(a.length-1,1);if(n.rangeSetValueTo=l.prev(),e&&(s=="("||s==",")||!e&&(s=="("||s==","||s=="="||s in n.operatorjson||s=="&"))return!0}return!1},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangeSetValue:function(e,n){let t=this,l="",o=e.row[0],a=e.column[0];h.config.merge!=null&&o+"_"+a in h.config.merge?l=Kl(h.currentSheetIndex,{column:[a,a],row:[o,o]},t.rangetosheet):l=Kl(h.currentSheetIndex,e,t.rangetosheet);let s;if(t.rangestart||t.rangedrag_column_start||t.rangedrag_row_start)if($("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")){s=$("#luckysheet-rich-text-editor"),$("#luckysheet-search-formula-parm-select-input").val(l),$("#luckysheet-search-formula-parm .parmBox").eq(t.data_parm_index).find(".txt input").val(l);let u=Ji(l).data;if(u instanceof Array){let g=[];for(let v=0;v<u.length;v++)for(let x=0;x<u[v].length;x++)u[v][x]==null?g.push(null):g.push(u[v][x].v);$("#luckysheet-search-formula-parm .parmBox").eq(t.data_parm_index).find(".val").text(" = {"+g.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(t.data_parm_index).find(".val").text(" = {"+u.v+"}");let f=!0,m=[],d=-1;$("#luckysheet-search-formula-parm .parmBox").each(function(g,v){let x=$(v).find(".txt input").val();x==""&&$(v).find(".txt input").attr("data_parm_require")=="m"&&(f=!1),x!=""&&(d=g)});let p;if(d==-1)p="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"()";else if(d==0)p="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+$("#luckysheet-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(let g=0;g<=d;g++)m.push($("#luckysheet-search-formula-parm .parmBox").eq(g).find(".txt input").val());p="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+m.join(",")+")"}let b=t.functionHTMLGenerate(p);if($("#luckysheet-rich-text-editor").html(b),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),f){let g=$.trim(t.functionParserExe($("#luckysheet-rich-text-editor").text())),v=new Function("return "+g)();$("#luckysheet-search-formula-parm .result span").text(v)}}else{let f=window.getSelection().anchorNode;s=$(f).closest("div");let m=s.find("span[rangeindex='"+t.rangechangeindex+"']").html(l);t.setCaretPosition(m.get(0),0,l.length)}else{let u='<span class="luckysheet-formula-functionrange-cell" rangeindex="'+t.functionHTMLIndex+'" dir="auto" style="color:'+Pi[t.functionHTMLIndex]+';">'+l+"</span>",f=$(u).insertAfter(t.rangeSetValueTo);t.rangechangeindex=t.functionHTMLIndex,s=$(t.rangeSetValueTo).closest("div"),t.setCaretPosition(s.find("span[rangeindex='"+t.rangechangeindex+"']").get(0),0,l.length),t.functionHTMLIndex++}s.attr("id")=="luckysheet-rich-text-editor"?$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()):$("#luckysheet-rich-text-editor").html($("#luckysheet-functionbox-cell").html())},rangedrag:function(e){let n=this,t=wl(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),o=t[1]+$("#luckysheet-cell-main").scrollTop(),a=Jl(o),s=a[1],u=a[0],f=a[2],m=Zl(l),d=m[1],p=m[0],b=m[2],g=0,v=0,x=[];n.func_selectedrange.top>u?(g=u,v=n.func_selectedrange.top+n.func_selectedrange.height-u,x=[f,n.func_selectedrange.row[1]]):n.func_selectedrange.top==u?(g=u,v=n.func_selectedrange.top+n.func_selectedrange.height-u,x=[f,n.func_selectedrange.row[0]]):(g=n.func_selectedrange.top,v=s-n.func_selectedrange.top-1,x=[n.func_selectedrange.row[0],f]);let _=0,S=0,I=[];n.func_selectedrange.left>p?(_=p,S=n.func_selectedrange.left+n.func_selectedrange.width-p,I=[b,n.func_selectedrange.column[1]]):n.func_selectedrange.left==p?(_=p,S=n.func_selectedrange.left+n.func_selectedrange.width-p,I=[b,n.func_selectedrange.column[0]]):(_=n.func_selectedrange.left,S=d-n.func_selectedrange.left-1,I=[n.func_selectedrange.column[0],b]),x[0]=Ie.changeFreezenIndex(x[0],"h"),x[1]=Ie.changeFreezenIndex(x[1],"h"),I[0]=Ie.changeFreezenIndex(I[0],"v"),I[1]=Ie.changeFreezenIndex(I[1],"v");let P=_t.mergeMoveMain(I,x,n.func_selectedrange,g,v,_,S);if(P!=null&&(I=P[0],x=P[1],g=P[2],v=P[3],_=P[4],S=P[5]),n.func_selectedrange.row=x,n.func_selectedrange.column=I,n.func_selectedrange.left_move=_,n.func_selectedrange.width_move=S,n.func_selectedrange.top_move=g,n.func_selectedrange.height_move=v,eo(_,g,S,v,x,I),$("#luckysheet-formula-functionrange-select").css({left:_,width:S,top:g,height:v}).show(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let F=Kl(h.currentSheetIndex,{row:x,column:I},h.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(F)}else n.rangeSetValue({row:x,column:I});Ie.scrollFreezen(x,I)},rangedrag_column_start:!1,rangedrag_row_start:!1,rangedrag_column:function(e){let n=this,t=wl(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),o=t[1]+$("#luckysheet-cell-main").scrollTop(),a=h.visibledatarow,s=a.length-1,u=a[s],f=0,m=Zl(l),d=m[1],p=m[0],b=m[2],g=0,v=0,x=[];n.func_selectedrange.left>p?(g=p,v=n.func_selectedrange.left+n.func_selectedrange.width-p,x=[b,n.func_selectedrange.column[1]]):n.func_selectedrange.left==p?(g=p,v=n.func_selectedrange.left+n.func_selectedrange.width-p,x=[b,n.func_selectedrange.column[0]]):(g=n.func_selectedrange.left,v=d-n.func_selectedrange.left-1,x=[n.func_selectedrange.column[0],b]),x[0]=Ie.changeFreezenIndex(x[0],"v"),x[1]=Ie.changeFreezenIndex(x[1],"v");let _=_t.mergeMoveMain(x,[0,s],n.func_selectedrange,f,u-f-1,g,v);_!=null&&(x=_[0],g=_[4],v=_[5]),n.func_selectedrange.column=x,n.func_selectedrange.left_move=g,n.func_selectedrange.width_move=v,eo(g,f,v,u-f-1,[0,s],x),n.rangeSetValue({row:[null,null],column:x}),$("#luckysheet-formula-functionrange-select").css({left:g,width:v,top:f,height:u-f-1}).show(),Ie.scrollFreezen([0,s],x)},rangedrag_row:function(e){let n=this,t=wl(e.pageX,e.pageY),l=t[0]+$("#luckysheet-cell-main").scrollLeft(),o=t[1]+$("#luckysheet-cell-main").scrollTop(),a=Jl(o),s=a[1],u=a[0],f=a[2],m=h.visibledatacolumn,d=m.length-1,p=m[d],b=0,g=0,v=0,x=[];n.func_selectedrange.top>u?(g=u,v=n.func_selectedrange.top+n.func_selectedrange.height-u,x=[f,n.func_selectedrange.row[1]]):n.func_selectedrange.top==u?(g=u,v=n.func_selectedrange.top+n.func_selectedrange.height-u,x=[f,n.func_selectedrange.row[0]]):(g=n.func_selectedrange.top,v=s-n.func_selectedrange.top-1,x=[n.func_selectedrange.row[0],f]),x[0]=Ie.changeFreezenIndex(x[0],"h"),x[1]=Ie.changeFreezenIndex(x[1],"h");let _=_t.mergeMoveMain([0,d],x,n.func_selectedrange,g,v,b,p-b-1);_!=null&&(x=_[1],g=_[2],v=_[3]),n.func_selectedrange.row=x,n.func_selectedrange.top_move=g,n.func_selectedrange.height_move=v,eo(b,g,p-b-1,v,x,[0,d]),n.rangeSetValue({row:x,column:[null,null]}),$("#luckysheet-formula-functionrange-select").css({left:b,width:p-b-1,top:g,height:v}).show(),Ie.scrollFreezen(x,[0,d])},rangedragged:function(){},rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeResizeDraging:function(e,n,t,l,o,a,s,u){let f=this,m=$("#luckysheet-scrollbar-y").scrollTop(),d=$("#luckysheet-scrollbar-x").scrollLeft(),p=wl(e.pageX,e.pageY),b=p[0]+d,g=p[1]+m,v=Jl(g),x=v[1],_=v[0],S=v[2],I=Zl(b),P=I[1],F=I[0],D=I[2];if(b<0||g<0)return!1;let k=_-t[1],w=F-t[0],C=t[5],T=t[3],O=t[4],z=t[2];if(l=="lt"||l=="lb"){if(t[0]+t[2]<F)return;O=F,z=t[2]-w,O>t[2]+t[4]-P+F?(O=t[2]+t[4]-P+F,z=t[2]-(t[2]+t[4]-P+F-t[0])):O<=0&&(O=0,z=t[2]+t[0])}if(l=="rt"||l=="rb"){if(t[6]-t[2]>P)return;z=t[2]+P-t[6],z<P-F-1?z=P-F-1:z>=s-O&&(z=s-O)}if(l=="lt"||l=="rt"){if(t[1]+t[3]<_)return;C=_,T=t[3]-k,C>t[3]+t[5]-x+_?(C=t[3]+t[5]-x+_,T=t[3]-(t[3]+t[5]-x+_-t[1])):C<=0&&(C=0,T=t[3]+t[1])}if(l=="lb"||l=="rb"){if(t[7]-t[3]>x)return;T=t[3]+x-t[7],T<x-_-1?T=x-_-1:T>=u-C&&(T=u-C)}let A=f.rangeResizeIndex,E={top:C,left:O,height:T,width:z},L=f.getSelectedFromRange(E),N=Kl(h.currentSheetIndex,L,f.rangetosheet),W=f.rangeResizeTo.find("span[rangeindex='"+A+"']").html(N);To(f.rangeResizeTo[0]),n.css(E).data("range",L)},getSelectedFromRange:function(e){let n=e.top+2,t=e.top+e.height-2,l=e.left+2,o=e.left+e.width-2;return{row:[Jl(n)[2],Jl(t)[2]],column:[Zl(l)[2],Zl(o)[2]]}},rangeResizeDragged:function(e,n,t,l,o,a){let s=this;s.rangeResize=null,$("#luckysheet-formula-functionrange-highlight-"+s.rangeResizeIndex).find(".luckysheet-selection-copy-hc").css("opacity",.03)},rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,rangeMoveDraging:function(e,n,t,l,o,a){let s=this,u=wl(e.pageX,e.pageY),f=$("#luckysheet-scrollbar-x").scrollLeft(),m=$("#luckysheet-scrollbar-y").scrollTop(),d=u[0]+f,p=u[1]+m,b=$(window).height()+m-o-a,g=$(window).width()+f,v=n[0],x=n[1],_=t.row[0]-v+Jl(p)[2],S=t.row[1]-v+Jl(p)[2],I=t.column[0]-x+Zl(d)[2],P=t.column[1]-x+Zl(d)[2];(_<0||p<0)&&(_=0,S=t.row[1]-t.row[0]),(I<0||d<0)&&(I=0,P=t.column[1]-t.column[0]);let F=h.visibledatarow;(S>=F[F.length-1]||p>b)&&(_=F.length-1-t.row[1]+t.row[0],S=F.length-1);let D=h.visibledatacolumn;(P>=D[D.length-1]||d>g)&&(I=D.length-1-t.column[1]+t.column[0],P=D.length-1);let k=I-1==-1?0:D[I-1],w=D[P],C=_-1==-1?0:F[_-1],T=F[S],O=s.rangeMoveIndex,z={left:k,width:w-k-2,top:C,height:T-C-2,display:"block"},A=s.getSelectedFromRange(z),E=Kl(h.currentSheetIndex,A,s.rangetosheet),L=s.rangeResizeTo.find("span[rangeindex='"+O+"']").html(E);To(s.rangeResizeTo[0]),s.rangeMoveRangedata=A,l.css(z)},rangeMoveDragged:function(e){let n=this;n.rangeMove=!1,$("#luckysheet-formula-functionrange-highlight-"+n.rangeMoveIndex).data("range",n.rangeMoveRangedata).find(".luckysheet-selection-copy-hc").css("opacity",.03)},functionHTMLIndex:0,functionRangeIndex:null,findrangeindex:function(e,n){let t=this,l=/<span.*?>/g,o=e.replace(l,""),a=n.replace(l,"");o=o.split("</span>"),a=a.split("</span>"),o.pop(),a.pop();let s=t.functionRangeIndex,u=0,f=a.length>o.length?o.length:a.length,m=a.length,d=o.length;if(m==d){let p=s[0],b=a[p],g=o[p];if(b==null)return a.length<=p?s=[a.length-1,a.length-1]:o.length<=p&&(s=[o.length-1,o.length-1]),s;if(b.length==g.length)return a[p+1]!=null&&o[p+1]!=null&&a[p+1].length<o[p+1].length&&(s[0]=s[0]+1,s[1]=1),s;if(b.length>g.length)return b!=null&&o[p+1]!=null&&o[p+1].substr(0,1)=='"'&&(b.indexOf("{")>-1||b.indexOf("}")>-1)&&(s[0]=s[0]+1,s[1]=1),s;if(b.length<g.length)return s[1]>g.length&&(s[1]=g.length),s}else if(m>d){let p=s[0],b=a[p],g=o[p];if(g==null)if(o[p-1].indexOf("{")>-1){s[0]=s[0]-1;let v=o[p-1].search("{");s[1]=s[1]+v}else s[0]=0,s[1]=0;else{if(b.length==g.length)return o[p+1]!=null&&(o[p+1].substr(0,1)=='"'||o[p+1].substr(0,1)=="{"||o[p+1].substr(0,1)=="}")?(s[0]=s[0]+1,s[1]=1):b!=null&&b.length>2&&b.substr(0,1)=='"'&&b.substr(b.length-1,1)=='"'||(o[p]!=null&&o[p]=='")'||o[p]!=null&&o[p]=='"}'||o[p]!=null&&o[p]=="{)"?s[1]=1:s[1]=g.length),s;if(b.length>g.length)return o[p+1]!=null&&(o[p+1].substr(0,1)=='"'||o[p+1].substr(0,1)=="{"||o[p+1].substr(0,1)=="}")&&(s[0]=s[0]+1,s[1]=1),s;if(b.length<g.length)return s}return s}else if(m<d){let p=s[0],b=a[p],g=o[p];if(b==null)s[0]=o.length-1,g!=null?s[1]=g.length:s[1]=1;else{if(b.length==g.length)return a[p+1]!=null&&(a[p+1].substr(0,1)=='"'||a[p+1].substr(0,1)=="{"||a[p+1].substr(0,1)=="}")?s[1]=g.length:o[p+1]!=null&&o[p+1].substr(0,1)=='"'&&(o[p+1].substr(0,1)=="{"||o[p+1].substr(0,1)=="}")?(s[0]=s[0]+1,s[1]=1):g!=null&&g.substr(0,1)=='"'&&g.substr(g.length-1,1)=='"'&&b.substr(0,1)=='"'&&b.substr(b.length-1,1)==")"||g!=null&&g.substr(0,1)=="{"&&g.substr(g.length-1,1)=="}"&&b.substr(0,1)=="{"&&b.substr(b.length-1,1)==")"?s[1]=g.length:(s[0]=s[0]+d-m,o.length>a.length?s[1]=o[p+1].length:s[1]=1),s;if(b.length>g.length)return b!=null&&b.substr(0,1)=='"'?s[1]=g.length:o[p+1]!=null&&/{.*?}/.test(o[p+1])?(s[0]=s[0]+1,s[1]=o[p+1].length):b!=null&&o[p+1].substr(0,1)=='"'&&(b.indexOf("{")>-1||b.indexOf("}")>-1)?(s[0]=s[0]+1,s[1]=1):b!=null&&(b.indexOf("{")>-1||b.indexOf("}")>-1)||(s[0]=s[0]+d-m-1,s[1]=o[p-1].length),s;if(b.length<g.length)return s}return s}return null},setCaretPosition:function(e,n,t){try{let l=e,o=document.createRange(),a=window.getSelection();o.setStart(l.childNodes[n],t),o.collapse(!0),a.removeAllRanges(),a.addRange(o),l.focus()}catch(l){To(this.rangeResizeTo[0])}},functionRange:function(e,n,t){let l=this;if(window.getSelection){let o=window.getSelection(),a=l.findrangeindex(n,t);a==null?(o.selectAllChildren(e.get(0)),o.collapseToEnd()):l.setCaretPosition(e.find("span").get(a[0]),0,a[1])}else document.selection&&(l.functionRangeIndex.moveToElementText(e),l.functionRangeIndex.collapse(!1),l.functionRangeIndex.select())},functionInputHanddler:function(e,n,t){if(at())return;let l=this,o=e,a=n,s=a.html(),u=a.text(),f=this.xssDeal;setTimeout(function(){let m=a.text(),d=m;if(m=f(m),m.length>0&&m.substr(0,1)=="="&&(t!=229||m.length==1)){if(m=l.functionHTMLGenerate(m),s=l.functionHTMLGenerate(u),window.getSelection){let p=window.getSelection();if($(p.anchorNode).is("div")){let b=$("#luckysheet-rich-text-editor span").length;l.functionRangeIndex=[b-1,$("#luckysheet-rich-text-editor").find("span").eq(b-1).text().length]}else l.functionRangeIndex=[$(p.anchorNode).parent().index(),p.anchorOffset]}else{let p=document.selection.createRange();l.functionRangeIndex=p}a.html(m),l.functionRange(a,m,s),l.canceFunctionrangeSelected(),t!=46&&l.createRangeHightlight(),o.html(m),l.rangestart=!1,l.rangedrag_column_start=!1,l.rangedrag_row_start=!1,l.rangeHightlightselected(a,t)}else u.substr(0,1)!="="&&(o.attr("id")=="luckysheet-rich-text-editor"&&o.html().substr(0,5)=="<span"||(m=l.ltGtSignDeal(m),o.html(m)))},1)},functionHTMLGenerate:function(e){let n=this;return e.length==0||e.substr(0,1)!="="?e:(n.functionHTMLIndex=0,'<span dir="auto" class="luckysheet-formula-text-color">=</span>'+n.functionHTML(e))},functionHTML:function(e){let n=this;if(n.operatorjson==null){let f=n.operator.split("|"),m={};for(let d=0;d<f.length;d++)m[f[d].toString()]=1;n.operatorjson=m}e.substr(0,1)=="="&&(e=e.substr(1));let t=e.split(""),l=0,o="",a="",s=!0,u={bracket:0,comma:0,squote:0,dquote:0,braces:0};for(;l<t.length;){let f=t[l];if(f=="("&&u.squote==0&&u.dquote==0&&u.braces==0)u.bracket+=1,o.length>0?a+='<span dir="auto" class="luckysheet-formula-text-func">'+o+'</span><span dir="auto" class="luckysheet-formula-text-lpar">(</span>':a+='<span dir="auto" class="luckysheet-formula-text-lpar">(</span>',o="";else if(f==")"&&u.squote==0&&u.dquote==0&&u.braces==0)u.bracket-=1,a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-rpar">)</span>',o="";else if(f=="{"&&u.squote==0&&u.dquote==0)o+="{",u.braces+=1;else if(f=="}"&&u.squote==0&&u.dquote==0)o+="}",u.braces-=1;else if(f=='"'&&u.squote==0)u.dquote>0?(o.length>0?a+=o+'"</span>':a+='"</span>',u.dquote-=1,o=""):(u.dquote+=1,o.length>0?a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-string">"':a+='<span dir="auto" class="luckysheet-formula-text-string">"',o="");else if(f=="'"&&u.dquote==0)o+="'",u.squote=u.squote==0?1:0;else if(f==","&&u.squote==0&&u.dquote==0&&u.braces==0)a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-comma">,</span>',o="";else if(f=="&"&&u.squote==0&&u.dquote==0&&u.braces==0)o.length>0?(a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-calc">&</span>',o=""):a+='<span dir="auto" class="luckysheet-formula-text-calc">&</span>';else if(f in n.operatorjson&&u.squote==0&&u.dquote==0&&u.braces==0){let m="";l+1<t.length&&(m=t[l+1]);let d=l-1,p=null;if(d>=0)do p=t[d--];while(d>=0&&p==" ");f+m in n.operatorjson?(o.length>0?(a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-calc">'+f+m+"</span>",o=""):a+='<span dir="auto" class="luckysheet-formula-text-calc">'+f+m+"</span>",l++):!/[^0-9]/.test(m)&&f=="-"&&(p=="("||p==null||p==","||p==" "||p in n.operatorjson)?o+=f:o.length>0?(a+=n.functionHTML(o)+'<span dir="auto" class="luckysheet-formula-text-calc">'+f+"</span>",o=""):a+='<span dir="auto" class="luckysheet-formula-text-calc">'+f+"</span>"}else o+=f;if(l==t.length-1){if(n.iscelldata($.trim(o)))a+='<span class="luckysheet-formula-functionrange-cell" rangeindex="'+n.functionHTMLIndex+'" dir="auto" style="color:'+Pi[n.functionHTMLIndex]+';">'+o+"</span>",n.functionHTMLIndex++;else if(u.dquote>0)a+=o+"</span>";else if(o.indexOf("</span>")==-1&&o.length>0){let m=/{.*?}/;if(m.test($.trim(o))){let d=m.exec(o)[0],p=o.search(m),b="";p>0&&(b+='<span dir="auto" class="luckysheet-formula-text-color">'+o.substr(0,p)+"</span>"),b+='<span dir="auto" style="color:#959a05" class="luckysheet-formula-text-array">'+d+"</span>",p+d.length<o.length&&(b+='<span dir="auto" class="luckysheet-formula-text-color">'+o.substr(p+d.length,o.length)+"</span>"),a+=b}else a+='<span dir="auto" class="luckysheet-formula-text-color">'+o+"</span>"}}l++}return a},getfunctionParam:function(e){let n=this;if(n.operatorjson==null){let d=n.operator.split("|"),p={};for(let b=0;b<d.length;b++)p[d[b].toString()]=1;n.operatorjson=p}e.substr(0,1)=="="&&(e=e.substr(1));let t=e.split(""),l=0,o="",a="",s={bracket:0,comma:0,squote:0,dquote:0,compare:0},u=null,f=[],m=[];for(;l<t.length;){let d=t[l];if(d=="("&&s.dquote==0)o.length>0&&m.length==0?(u=o.toUpperCase(),m.push(1),o=""):m.length==0?(m.push(0),o=""):(m.push(0),o+=d);else if(d==")"&&s.dquote==0){let p=m.pop();m.length==0?(f.push(o),o=""):o+=d}else if(d=='"')o+='"',s.dquote>0?(s.dquote-=1,o=""):s.dquote+=1;else if(d==","&&s.dquote==0)m.length<=1?(f.push(o),o=""):o+=",";else if(d in n.operatorjson&&s.dquote==0){let p="";l+1<t.length&&(p=t[l+1]);let b=l-1,g=null;if(b>=0)do g=t[b--];while(b>=0&&g==" ");!/[^0-9]/.test(p)&&d=="-"&&(g=="("||g==null||g==","||g==" "||g in n.operatorjson)?s.dquote==0?o+=$.trim(d):o+=d:(a="",o="")}else s.dquote==0?o+=$.trim(d):o+=d;l++}return{fn:u,param:f}},calPostfixExpression:function(e){if(e.length==0)return"";let n=[];for(let t=e.length-1;t>=0;t--){let l=e[t];if(l in this.operatorjson){let o=n.pop(),a=n.pop(),s="luckysheet_compareWith("+a+",'"+l+"', "+o+")";n.push(s)}else n.push(l)}return n.length>0?n[0]:""},checkBracketNum:function(e){let n=e.match(/\(/g),t=e.match(/\)/g),l=e.match(/(['"])(?:(?!\1).)*?\1/g),o=e.match(/(['"])(?:(?!\1).)*?\1/g),a=0,s=0;n!=null&&(a+=n.length),t!=null&&(s+=t.length);let u=0,f=0;if(l!=null)for(let m=0;m<l.length;m++){let d=l[m].match(/\(/g);d!=null&&(u+=d.length)}if(o!=null)for(let m=0;m<o.length;m++){let d=o[m].match(/\)/g);d!=null&&(f+=d.length)}return a-=u,s-=f,a==s},operatorPriority:{"^":0,"%":1,"*":1,"/":1,"+":2,"-":2},functionParserExe:function(e){let n=this;return this.functionParser(e)},functionParser:function(e,n){let t=this;if(t.operatorjson==null){let b=t.operator.split("|"),g={};for(let v=0;v<b.length;v++)g[b[v].toString()]=1;t.operatorjson=g}if(e==null)return"";e.substr(0,2)=="=+"?e=e.substr(2):e.substr(0,1)=="="&&(e=e.substr(1));let l=e.split(""),o=0,a="",s="",u={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0},f=[],m=[],d=[],p=-1;for(;o<l.length;){let b=l[o];if(b=="("&&u.squote==0&&u.dquote==0&&u.braces==0)if(a.length>0&&d.length==0){if(a=a.toUpperCase(),a.indexOf(":")>-1){let g=a.split(":");s+="luckysheet_getSpecialReference(true,'"+$.trim(g[0]).replace(/'/g,"\\'")+"', luckysheet_function."+g[1]+".f(#lucky#"}else s+="luckysheet_function."+a+".f(";d.push(1),a=""}else d.length==0?(s+="(",d.push(0),a=""):(d.push(0),a+=b);else if(b==")"&&u.squote==0&&u.dquote==0&&u.braces==0){let g=d.pop();if(d.length==0){let v=t.functionParser(a,n);v.indexOf("#lucky#")>-1&&(v=v.replace(/#lucky#/g,"")+")"),s+=v+")",a=""}else a+=b}else if(b=="{"&&u.squote==0&&u.dquote==0)a+="{",u.braces+=1;else if(b=="}"&&u.squote==0&&u.dquote==0)a+="}",u.braces-=1;else if(b=='"'&&u.squote==0)u.dquote>0?o<l.length-1&&l[o+1]=='"'?(o++,a+="\x7F"):(u.dquote-=1,a+='"'):(u.dquote+=1,a+='"');else if(b=="'"&&u.dquote==0)if(a+="'",u.squote>0){if(p==o-1)return"";if(o<l.length-1&&l[o+1]=="'")o++,a+="'";else{if(l[o-1]=="'")return"";u.squote-=1}}else u.squote+=1,p=o;else if(b==","&&u.squote==0&&u.dquote==0&&u.braces==0)if(d.length<=1){let g=t.functionParser(a,n);g.indexOf("#lucky#")>-1&&(g=g.replace(/#lucky#/g,"")+")"),s+=g+",",a=""}else a+=",";else if(b in t.operatorjson&&u.squote==0&&u.dquote==0&&u.braces==0){let g="",v=t.operatorPriority;if(o+1<l.length&&(g=l[o+1]),b+g in t.operatorjson){if(d.length==0){if($.trim(a).length>0?m.unshift(t.functionParser($.trim(a),n)):$.trim(s).length>0&&m.unshift($.trim(s)),f[0]in t.operatorjson){let x=v[f[0]];for(;f.length>0&&x!=null;)m.unshift(f.shift()),x=v[f[0]]}f.unshift(b+g),s="",a=""}else a+=b+g;o++}else if(d.length==0){if($.trim(a).length>0?m.unshift(t.functionParser($.trim(a),n)):$.trim(s).length>0&&m.unshift($.trim(s)),f[0]in t.operatorjson){let x=v[f[0]];x=x??1e3;let _=v[b];for(_=_??1e3;f.length>0&&_>=x;)m.unshift(f.shift()),x=v[f[0]],x=x??1e3}f.unshift(b),s="",a=""}else a+=b}else u.dquote==0&&u.squote==0,a+=b;if(o==l.length-1){let g="",v=$.trim(a).replace(/'/g,"\\'");if(t.iscelldata(v)&&v.substr(0,1)!=":")g="luckysheet_getcelldata('"+v+"')",typeof n=="function"&&n(v);else if(v.substr(0,1)==":")v=v.substr(1),t.iscelldata(v)&&(g="luckysheet_getSpecialReference(false,"+s+",'"+v+"')");else{a=$.trim(a);let x=/{.*?}/;if(x.test(a)&&a.substr(0,1)!='"'&&a.substr(a.length-1,1)!='"'){let _=x.exec(a)[0],S=a.search(x),I="";S>0&&(g+=a.substr(0,S)),g+="luckysheet_getarraydata('"+_+"')",S+_.length<a.length&&(g+=a.substr(S+_.length,a.length))}else g=a}if(g.length>0&&m.unshift(g),f.length>0)for(s.length>0&&(m.unshift(s),s="");f.length>0;)m.unshift(f.shift());m.length>0?s=t.calPostfixExpression(m):s+=g}o++}return s},insertUpdateDynamicArray:function(e){let n=e.r,t=e.c,l=e.index;l==null&&(l=h.currentSheetIndex);let s=ur()[Me(l)].dynamicArray;s==null&&(s=[]);for(let u=0;u<s.length;u++){let f=s[u];if(f.r==n&&f.c==t&&f.index==l)return f.data=e.data,f.f=e.f,s}return s.push(e),s},addFunctionGroup:function(e,n,t,l){l==null&&(l=h.currentSheetIndex);let o=ur(),a=o[Me(l)];a.calcChain==null&&(a.calcChain=[]);let s={r:e,c:n,index:l,func:t};a.calcChain.push(s),Ue.saveParam("fc",l,JSON.stringify(s),{op:"add",pos:a.calcChain.length-1}),Ys(o)},getAllFunctionGroup:function(){let e=ur(),n=[];for(let t=0;t<e.length;t++){let l=e[t],o=l.calcChain;if(o){let s=[];o.forEach((u,f)=>{typeof u=="string"?s.push(JSON.parse(u)):s.push(u)}),o=l.calcChain=s}let a=l.dynamicArray_compute;o==null&&(o=[]),a==null&&(a=[]),n=n.concat(o);for(let s=0;s<a.length;s++){let u=a[0];n.push({r:u.r,c:u.c,index:u.index})}}return n},getFunctionGroup:function(e){e==null&&(e=h.currentSheetIndex);let t=ur()[Me(e)];return t.calcChain==null?[]:t.calcChain},updateFunctionGroup:function(e,n,t){t==null&&(t=h.currentSheetIndex);let l=ur(),a=l[Me(t)].calcChain;if(a!=null)for(let s=0;s<a.length;s++){let u=a[s];if(u.r==e&&u.c==n&&u.index==t){Ue.saveParam("fc",t,JSON.stringify(u),{op:"update",pos:s});break}}Ys(l)},insertUpdateFunctionGroup:function(e,n,t){t==null&&(t=h.currentSheetIndex);let l=ur(),o=l[Me(t)],a=o.calcChain;a==null&&(a=[]);for(let u=0;u<a.length;u++){let f=a[u];if(f.r==e&&f.c==n&&f.index==t){Ue.saveParam("fc",t,JSON.stringify(f),{op:"update",pos:u});return}}let s={r:e,c:n,index:t};a.push(s),o.calcChain=a,Ue.saveParam("fc",t,JSON.stringify(s),{op:"add",pos:o.calcChain.length-1}),Ys(l)},isFunctionRangeSave:!1,isFunctionRangeSimple:function(e,n,t,l,o){if(e==null||e.length==0)return;let a=e.split(/==|!=|<>|<=|>=|[,()=+-\/*%&^><]/g);if(a.length>0)for(let s=0;s<a.length;s++){let u=a[s];u.length<=1||u.substr(0,1)=='"'&&u.substr(u.length-1,1)=='"'||this.isFunctionRangeSaveChange(u,n,t,l,o)}},isFunctionRangeSimple1:function(e,n,t,l,o){let a=this;if(a.operatorjson==null){let g=a.operator.split("|"),v={};for(let x=0;x<g.length;x++)v[g[x].toString()]=1;a.operatorjson=v}e.substr(0,1)=="="&&(e=e.substr(1));let s=e.split(""),u=0,f="",m="",d=!0,p={bracket:0,comma:0,squote:0,dquote:0},b=ur();for(;u<s.length;){let g=s[u];if(g=="("&&p.dquote==0)p.bracket+=1,f.length>0?m+="luckysheet_function."+f.toUpperCase()+".f(":m+="(",f="";else if(g==")"&&p.dquote==0)p.bracket-=1,m+=a.isFunctionRangeSimple(f,n,t,l,o)+")",f="";else if(g==","&&p.dquote==0)m+=a.isFunctionRangeSimple(f,n,t,l,o)+",",f="";else if(g in a.operatorjson&&p.dquote==0){let v="";u+1<s.length&&(v=s[u+1]),g+v in a.operatorjson?(f.length>0?(m+=a.isFunctionRangeSimple(f,n,t,l,o)+g+v,f=""):m+=g+v,u++):f.length>0?(m+=a.isFunctionRangeSimple(f,n,t,l,o)+g,f=""):m+=g}else f+=g;u==s.length-1&&a.iscelldata($.trim(f))&&a.isFunctionRangeSaveChange(f,n,t,l,o),u++}return m},isFunctionRangeSelect:function(e,n,t,l,o){if(e==null||e=="")return;l==null&&(l=h.currentSheetIndex),o==null&&(o={});let a=this,s=e.toUpperCase(),u=s.indexOf("INDIRECT(")>-1||s.indexOf("OFFSET(")>-1||s.indexOf("INDEX(")>-1;if(e in this.formulaContainCellList){let f=this.formulaContainCellList[e];if(u)if(f.__LuckyisOff__==!0)for(let d in f)d!="__LuckyisOff__"&&this.isFunctionRangeSaveChange(d,n,t,l,o);else this.isFunctionRange(e,n,t,l,o,function(d){a.addToCellList(e,d)}),f.__LuckyisOff__=!0;else for(let m in f)m!="__LuckyisOff__"&&this.isFunctionRangeSaveChange(m,n,t,l,o);return}u?this.isFunctionRange(e,n,t,l,o):this.isFunctionRangeSimple(e,n,t,l,o)},isFunctionRange:function(e,n,t,l,o,a){let s=this;if(s.operatorjson==null){let S=s.operator.split("|"),I={};for(let P=0;P<S.length;P++)I[S[P].toString()]=1;s.operatorjson=I}e.substr(0,1)=="="&&(e=e.substr(1));let u=e.split(""),f=0,m="",d="",p=!0,b={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0},g=[],v=[],x=[],_=-1;for(;f<u.length;){let S=u[f];if(S=="("&&b.squote==0&&b.dquote==0&&b.braces==0)if(m.length>0&&x.length==0){if(m=m.toUpperCase(),m.indexOf(":")>-1){let I=m.split(":");d+="luckysheet_getSpecialReference(true,'"+$.trim(I[0]).replace(/'/g,"\\'")+"', luckysheet_function."+I[1]+".f(#lucky#"}else d+="luckysheet_function."+m+".f(";x.push(1),m=""}else x.length==0?(d+="(",x.push(0),m=""):(x.push(0),m+=S);else if(S==")"&&b.squote==0&&b.dquote==0&&b.braces==0){let I=x.pop();if(x.length==0){let P=s.isFunctionRange(m,n,t,l,o,a);P.indexOf("#lucky#")>-1&&(P=P.replace(/#lucky#/g,"")+")"),d+=P+")",m=""}else m+=S}else if(S=="{"&&b.squote==0&&b.dquote==0)m+="{",b.braces+=1;else if(S=="}"&&b.squote==0&&b.dquote==0)m+="}",b.braces-=1;else if(S=='"'&&b.squote==0)b.dquote>0?f<u.length-1&&u[f+1]=='"'?(f++,m+="\x7F"):(b.dquote-=1,m+='"'):(b.dquote+=1,m+='"');else if(S=="'"&&b.dquote==0)m+="'",b.squote>0?f<u.length-1&&u[f+1]=="'"?(f++,m+="'"):b.squote-=1:(b.squote+=1,_=f);else if(S==","&&b.squote==0&&b.dquote==0&&b.braces==0)if(x.length<=1){let I=s.isFunctionRange(m,n,t,l,o,a);I.indexOf("#lucky#")>-1&&(I=I.replace(/#lucky#/g,"")+")"),d+=I+",",m=""}else m+=",";else if(S in s.operatorjson&&b.squote==0&&b.dquote==0&&b.braces==0){let I="",P=s.operatorPriority;if(f+1<u.length&&(I=u[f+1]),S+I in s.operatorjson){if(x.length==0){if($.trim(m).length>0?v.unshift(s.isFunctionRange($.trim(m),n,t,l,o,a)):$.trim(d).length>0&&v.unshift($.trim(d)),g[0]in s.operatorjson){let F=P[g[0]];for(;g.length>0&&F!=null;)v.unshift(g.shift()),F=P[g[0]]}g.unshift(S+I),d="",m=""}else m+=S+I;f++}else if(x.length==0){if($.trim(m).length>0?v.unshift(s.isFunctionRange($.trim(m),n,t,l,o,a)):$.trim(d).length>0&&v.unshift($.trim(d)),g[0]in s.operatorjson){let F=P[g[0]];F=F??1e3;let D=P[S];for(D=D??1e3;g.length>0&&D>=F;)v.unshift(g.shift()),F=P[g[0]],F=F??1e3}g.unshift(S),d="",m=""}else m+=S}else b.dquote==0&&b.squote==0?m+=$.trim(S):m+=S;if(f==u.length-1){let I="",P=$.trim(m).replace(/'/g,"\\'");if(s.iscelldata(P)&&P.substr(0,1)!=":")I="luckysheet_getcelldata('"+P+"')",s.isFunctionRangeSaveChange(m,n,t,l,o);else if(P.substr(0,1)==":")P=P.substr(1),s.iscelldata(P)&&(I="luckysheet_getSpecialReference(false,"+d+",'"+P+"')");else{m=$.trim(m);let F=/{.*?}/;if(F.test(m)&&m.substr(0,1)!='"'&&m.substr(m.length-1,1)!='"'){let D=F.exec(m)[0],k=m.search(F),w="";k>0&&(I+=m.substr(0,k)),I+="luckysheet_getarraydata('"+D+"')",k+D.length<m.length&&(I+=m.substr(k+D.length,m.length))}else I=m}if(I.length>0&&v.unshift(I),g.length>0)for(d.length>0&&(v.unshift(d),d="");g.length>0;)v.unshift(g.shift());v.length>0?d=s.calPostfixExpression(v):d+=I}f++}return s.checkSpecialFunctionRange(d,n,t,l,o,a),d},isFunctionRangeSaveChange:function(e,n,t,l,o){let a=this;if(n!=null&&t!=null){let s=a.getcellrange($.trim(e),l);if(s==null)return;let u=s.row,f=s.column,m=s.sheetIndex;if(n+"_"+t in o&&(l==m||l==null)){let d=!1;for(let p=u[0];p<=u[1];p++)for(let b=f[0];b<=f[1];b++)p+"_"+b in o&&o[p+"_"+b].r==n&&o[p+"_"+b].c==t&&(d=!0);d?a.isFunctionRangeSave=a.isFunctionRangeSave||!0:a.isFunctionRangeSave=a.isFunctionRangeSave||!1}else n>=u[0]&&n<=u[1]&&t>=f[0]&&t<=f[1]&&(l==m||l==null)?a.isFunctionRangeSave=a.isFunctionRangeSave||!0:a.isFunctionRangeSave=a.isFunctionRangeSave||!1}else a.isFunctionRangeSave=a.isFunctionRangeSave||!1},checkSpecialFunctionRange:function(e,n,t,l,o,a){if(e.substr(0,30)=="luckysheet_getSpecialReference"||e.substr(0,20)=="luckysheet_function."){if(e.substr(0,20)=="luckysheet_function."){let s=e.split(".")[1];if(s!=null&&(s=s.toUpperCase(),s!="INDIRECT"&&s!="OFFSET"&&s!="INDEX"))return}try{h.calculateSheetIndex=l;let s=new Function("return "+e)();s instanceof Object&&s.startCell!=null&&(s=s.startCell);let u=$.trim(s);this.iscelldata(u)&&typeof a=="function"&&a(u)}catch{}}},execvertex:{},execFunctionGroupData:null,execFunctionExist:null,formulaContainSheetList:{},formulaContainCellList:{},cellTextToIndexList:{},addToCellList:function(e,n){e==null||e.length==0||n==null||n.length==0||(this.formulaContainCellList==null&&(this.formulaContainCellList={}),this.formulaContainCellList[e]==null&&(this.formulaContainCellList[e]={}),this.formulaContainCellList[e][n]=1)},addToCellIndexList:function(e,n){e==null||e.length==0||n==null||(this.cellTextToIndexList==null&&(this.cellTextToIndexList={}),e.indexOf("!")>-1?(e=e.replace(/\\'/g,"'").replace(/''/g,"'"),this.cellTextToIndexList[e]=n):this.cellTextToIndexList[e+"_"+n.sheetIndex]=n)},addToSheetIndexList:function(e,n,t){e==null||e.length==0||((n==null||n.length==0)&&(n=h.currentSheetIndex),(t==null||t.length==0)&&(t=""),this.formulaContainSheetList==null&&(this.formulaContainSheetList={}),this.formulaContainSheetList[e]==null&&(this.formulaContainSheetList[e]={}),this.formulaContainSheetList[e][n]=t)},execFunctionGlobalData:{},execFunctionGroupForce:function(e){e?this.execFunctionGroup(void 0,void 0,void 0,void 0,void 0,!0):this.execFunctionGroup()},execFunctionGroup:function(e,n,t,l,o,a=!1){let s=this;if(o==null&&(o=h.flowdata),window.luckysheet_compareWith||(window.luckysheet_compareWith=au,window.luckysheet_getarraydata=ag,window.luckysheet_getcelldata=Ji,window.luckysheet_parseData=su,window.luckysheet_getValue=ls,window.luckysheet_indirect_check=sg,window.luckysheet_indirect_check_return=cg,window.luckysheet_offset_check=ug,window.luckysheet_calcADPMM=er,window.luckysheet_getSpecialReference=fg),s.execFunctionGlobalData==null&&(s.execFunctionGlobalData={}),l==null&&(l=h.currentSheetIndex),t!=null){let F=[[{v:null}]];kr(0,0,F,t),s.execFunctionGlobalData[e+"_"+n+"_"+l]=F[0][0]}let u=s.getAllFunctionGroup(),f={},m=ur(),d={};for(let F=0;F<m.length;F++){let D=m[F];d[D.index]=D.data}let p={},b=[];if(s.execFunctionExist==null){let F="r"+e+"c"+n+"i"+l;p[F]=1}else for(let F=0;F<s.execFunctionExist.length;F++){let D=s.execFunctionExist[F],k="r"+D.r+"c"+D.c+"i"+D.i;p[k]=1}let g={},v=function(F,D,k,w){for(let C=0;C<F.length;C++){let T=F[C],O="r"+T.row[0]+""+T.row[1]+"c"+T.column[0]+""+T.column[1]+"index"+T.sheetIndex;if(O in g)g[O].forEach(A=>{w(A.key,A.r,A.c,A.sheetIndex)});else{let z=[];for(let A=T.row[0];A<=T.row[1];A++)for(let E=T.column[0];E<=T.column[1];E++){let L="r"+A+"c"+E+"i"+T.sheetIndex;w(L,A,E,T.sheetIndex),(D&&L in D||k&&L in k)&&z.push({key:L,r:A,c:E,sheetIndex:T.sheetIndex})}(D||k)&&(g[O]=z)}}},x={},_=0;for(let F=0;F<u.length;F++){let D=u[F],k="r"+D.r+"c"+D.c+"i"+D.index,w=Ti(D.r,D.c,D.index);if(w==null)continue;let C=w.toUpperCase(),T=C.indexOf("INDIRECT(")>-1||C.indexOf("OFFSET(")>-1||C.indexOf("INDEX(")>-1,O=[];if(T)this.isFunctionRange(w,null,null,D.index,null,function(A){let E=s.getcellrange($.trim(A),D.index);E!=null&&O.push(E)});else if(!(w.substr(0,2)=='="'&&w.substr(w.length-1,1)=='"')){let A=0,E=-1,L=-1,N=[],W=[],X=w.length;for(let te=0;te<X;te++){let ue=w.charAt(te);ue=="'"&&L==-1&&(E==-1?(A!=te&&N.push(...w.substring(A,te).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/)),E=te,A=te):te<X-1&&w.charAt(te+1)=="'"?te++:(A=te+1,N.push(w.substring(E,A)),W.push(N.length-1),E=-1)),ue=='"'&&E==-1&&(L==-1?(A!=te&&N.push(...w.substring(A,te).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/)),L=te,A=te):te<X-1&&w.charAt(te+1)=='"'?te++:(A=te+1,N.push(w.substring(L,A)),L=-1))}A!=X&&N.push(...w.substring(A,X).split(/==|!=|<>|<=|>=|[,()=+-\/*%&\^><]/));for(let te=W.length-1;te>=0;te--)W[te]!=N.length-1&&(N[W[te]]=N[W[te]]+N[W[te]+1],N.splice(W[te]+1,1));for(let te=0;te<N.length;te++){let ue=N[te];if(ue.length<=1||ue.substr(0,1)=='"'&&ue.substr(ue.length-1,1)=='"'&&!s.iscelldata(ue))continue;let pe=s.getcellrange($.trim(ue),D.index);pe!=null&&O.push(pe)}}let z={formulaArray:O,calc_funcStr:w,key:k,r:D.r,c:D.c,index:D.index,parents:{},chidren:{},color:"w"};f[k]=z}Object.keys(f).forEach(F=>{let D=f[F];v(D.formulaArray,f,p,function(k){if(k in f){let w=f[k];D.chidren[k]=1,w.parents[F]=1}!a&&k in p&&b.push(D)}),a&&b.push(D)});let S=[],I=b,P={};for(;I.length>0;){let F=I.pop();if(F==null||F.key in P)continue;if(F.color=="b"){S.push(F),P[F.key]=1;continue}let D=[];Object.keys(F.parents).forEach(k=>{let w=f[k];w!=null&&D.push(w)}),_++,D.length==0?(S.push(F),P[F.key]=1):(F.color="b",I.push(F),I=I.concat(D))}S.reverse();for(let F=0;F<S.length;F++){let D=S[F];if(D.level==Math.max)continue;window.luckysheet_getcelldata_cache=null;let k=D.calc_funcStr,w=s.execfunction(k,D.r,D.c,D.index);s.groupValuesRefreshData.push({r:D.r,c:D.c,v:w[1],f:w[2],spe:w[3],index:D.index}),s.execFunctionGlobalData[D.r+"_"+D.c+"_"+D.index]={v:w[1],f:w[2]}}s.execFunctionExist=null},execFunctionGroup1:function(e,n,t,l,o,a=!1){let s=this;o==null&&(o=h.flowdata),window.luckysheet_compareWith||(window.luckysheet_compareWith=au,window.luckysheet_getarraydata=ag,window.luckysheet_getcelldata=Ji,window.luckysheet_parseData=su,window.luckysheet_getValue=ls,window.luckysheet_indirect_check=sg,window.luckysheet_indirect_check_return=cg,window.luckysheet_offset_check=ug,window.luckysheet_calcADPMM=er,window.luckysheet_getSpecialReference=fg),s.execFunctionGlobalData==null&&(s.execFunctionGlobalData={});let u=ur(),f=u[Me(h.currentSheetIndex)].dynamicArray_compute==null?{}:u[Me(h.currentSheetIndex)].dynamicArray_compute;if(l==null&&(l=h.currentSheetIndex),t!=null){let v=[[{v:null}]];kr(0,0,v,t),s.execFunctionGlobalData[e+"_"+n+"_"+l]=v[0][0]}let m=s.getAllFunctionGroup(),d={},p=[],b=0;if(s.execvertex={},s.execFunctionExist==null)for(let v=0;v<m.length;v++){let x=m[v],_=u[Me(x.index)];if(_==null)continue;let S=_.data[x.r][x.c],I=Ti(x.r,x.c,x.index);S!=null&&S.f!=null&&S.f==I&&(x instanceof Object||(x=new Function("return "+x)()),x.color="w",x.parent=null,x.chidren={},x.times=0,d["r"+x.r+"c"+x.c+"i"+x.index]=x,s.isFunctionRangeSave=!1,a?s.isFunctionRangeSave=!0:e!=null&&n!=null&&s.isFunctionRangeSelect(I,e,n,l,f),s.isFunctionRangeSave&&(p.push(x),s.execvertex["r"+x.r+"c"+x.c+"i"+x.index]=x,b++))}else for(let v=0;v<s.execFunctionExist.length;v++){let x=s.execFunctionExist[v];if(!("r"+x.r+"c"+x.c+"i"+x.i in d))for(let _=0;_<m.length;_++){let S=m[_],I=Ti(S.r,S.c,S.index);S.color="w",S.parent=null,S.chidren={},S.times=0,d["r"+S.r+"c"+S.c+"i"+S.index]=S,s.isFunctionRangeSave=!1,a?s.isFunctionRangeSave=!0:s.isFunctionRangeSelect(I,x.r,x.c,x.i,f),s.isFunctionRangeSave&&(p.push(S),s.execvertex["r"+S.r+"c"+S.c+"i"+S.index]=S,b++)}}for(;p.length>0;){let v=p.shift(),x={};s.getChildrenVertex(v,d,x);for(let _ in d){let S=d[_];if(S==null)continue;let I="r"+v.r+"c"+v.c+"i"+v.index;if(_ in x)continue;s.isFunctionRangeSave=!1;let P=Ti(S.r,S.c,S.index);s.isFunctionRangeSelect(P,v.r,v.c,v.index,f),s.isFunctionRangeSave&&(_ in s.execvertex||(p.push(S),s.execvertex[_]=S),b++,s.execvertex[_].chidren[I]=1)}}s.groupValuesRefreshData=[];let g=0;for(;g<b;)for(let v in s.execvertex){let x=s.execvertex[v];x.color=="w"?s.functionDFS(x):x.color=="b"&&g++}s.execFunctionExist=null},getChildrenVertex:function(e,n,t){let l="r"+e.r+"c"+e.c+"i"+e.index;if(t[l]=1,e.chidren!=null)for(let o in e.chidren)n[o]&&!(o in t)&&this.getChildrenVertex(n[o],n,t)},functionDFS:function(e){let n=this;e.color="g",e.times+=1;for(let o in e.chidren){let a=n.execvertex[o];a.color=="w"&&(a.parent="r"+e.r.toString()+"c"+e.c.toString()+"i"+e.index,n.functionDFS(a))}e.color="b",window.luckysheet_getcelldata_cache=null;let t=Ti(e.r,e.c,e.index),l=n.execfunction(t,e.r,e.c,e.index);n.groupValuesRefreshData.push({r:e.r,c:e.c,v:l[1],f:l[2],spe:l[3],index:e.index}),n.execFunctionGlobalData[e.r+"_"+e.c+"_"+e.index]={v:l[1],f:l[2]}},groupValuesRefreshData:[],groupValuesRefresh:function(){let e=this,n=ur();if(e.groupValuesRefreshData.length>0){for(let t=0;t<e.groupValuesRefreshData.length;t++){let l=e.groupValuesRefreshData[t],o=n[Me(l.index)],a=o.data;if(a==null)continue;let s={};l.spe!=null&&(l.spe.type=="sparklines"?s.spl=l.spe.data:l.spe.type=="dynamicArrayItem"&&(o.dynamicArray=e.insertUpdateDynamicArray(l.spe.data))),s.v=l.v,s.f=l.f,kr(l.r,l.c,a,s),Ue.saveParam("v",l.index,l.v,{r:l.r,c:l.c})}It.webWorkerFlowDataCache(h.flowdata),e.groupValuesRefreshData=[]}},delFunctionGroup:function(e,n,t){t==null&&(t=h.currentSheetIndex);let l=ur(),o=l[Me(t)],a=o.calcChain;if(a!=null)for(let u=0;u<a.length;u++){let f=a[u];if(f.r==e&&f.c==n&&f.index==t){a.splice(u,1),Ue.saveParam("fc",t,null,{op:"del",pos:u});break}}let s=o.dynamicArray;if(s!=null)for(let u=0;u<s.length;u++){let f=s[u];if(f.r==e&&f.c==n&&(f.index==null||f.index==t)){s.splice(u,1),Ue.saveParam("ac",t,null,{op:"del",pos:u});break}}Ys(l)},execfunction:function(e,n,t,l,o,a){let s=this,f=Be().formulaMore;if(e.indexOf(s.error.r)>-1)return[!1,s.error.r,e];s.checkBracketNum(e)||(e+=")"),l==null&&(l=h.currentSheetIndex),h.calculateSheetIndex=l;let m=$.trim(s.functionParserExe(e));if((m.substr(0,20)=="luckysheet_function."||m.substr(0,22)=="luckysheet_compareWith")&&(s.functionHTMLIndex=0),!s.testFunction(e,m)||m=="")return ke.info("",f.execfunctionError),[!1,s.error.n,e];let d=null;window.luckysheetCurrentRow=n,window.luckysheetCurrentColumn=t,window.luckysheetCurrentIndex=l,window.luckysheetCurrentFunction=e;let p=null;try{if(m.indexOf("luckysheet_getcelldata")>-1){let g=m.split("luckysheet_getcelldata('");for(let v=1;v<g.length;v++){let x=g[v].split("')")[0],_=s.getcellrange(x);if(_.row[0]<0||_.column[0]<0)return[!0,s.error.r,e];if(_.sheetIndex==h.calculateSheetIndex&&n>=_.row[0]&&n<=_.row[1]&&t>=_.column[0]&&t<=_.column[1])return at()?alert(f.execfunctionSelfError):ke.info("",f.execfunctionSelfErrorResult),[!1,0,e]}}d=new Function("return "+m)(),typeof d=="string"&&(d=d.replace(/\x7F/g,'"')),m.indexOf("SPLINES")>-1&&(p=d,d="")}catch(g){let v=g;console.log(g,m),v=s.errorInfo(v),d=[s.error.n,v]}G(d)=="object"&&d.startCell!=null&&(G(d.data)=="array"?d=s.error.v:G(d.data)=="object"&&!ft(d.data.v)?d=d.data.v:ft(d.data)?d=0:d.cell>1||d.rowl>1?d=d.data:d=0);let b=null;if(G(d)=="array"){let g=!1;G(d[0])!="array"&&d.length==2&&(g=re(d[0])),g?d=d[0]:G(d[0])=="array"&&d.length==1&&d[0].length==1?d=d[0][0]:(b={r:n,c:t,f:e,index:l,data:d},d="")}return window.luckysheetCurrentRow=null,window.luckysheetCurrentColumn=null,window.luckysheetCurrentIndex=null,window.luckysheetCurrentFunction=null,n!=null&&t!=null&&(o&&s.execFunctionGroup(n,t,d,l),a||s.insertUpdateFunctionGroup(n,t,l)),p?[!0,d,e,{type:"sparklines",data:p}]:b?[!0,d,e,{type:"dynamicArrayItem",data:b}]:[!0,d,e]},testFunction:function(e,n){return e.substr(0,1)=="="},execstringformula:function(e,n,t,l){let o=this;return this.execfunction(e,n,t,l)},functionResizeData:{},functionResizeStatus:!1,functionResizeTimeout:null,data_parm_index:0},y=b3});function Ah(e,n="redo"){if(e==null)return;let t=e.data;n=="undo"&&(t=e.curdata);for(let l=0;l<e.range.length;l++){let o=e.range[l].row[0],a=e.range[l].row[1],s=e.range[l].column[0],u=e.range[l].column[1];for(let f=o;f<a+1;f++)for(let m=s;m<u+1&&!(f>t.length-1);m++)t[f][m]==null||t[f][m].f==null||t[f][m].f==""?y.delFunctionGroup(f,m,e.sheetIndex):t[f][m]!=null&&t[f][m].f!=null&&t[f][m].f.length>0&&y.insertUpdateFunctionGroup(f,m,e.sheetIndex)}}var import_plugin,w3,ns,zh=Nt(()=>{import_plugin=qe(Ye());kn();qr();_a();mo();ta();Qo();go();nu();fu();Ja();Sr();Qc();Jo();Ar();fr();il();jr();wi();w3={redo:function(e){if(h.jfredo.length==0)return;let n=h.jfredo.pop();if(h.jfundo.push(n),h.clearjfundo=!1,kt.hasSheet(n.sheetIndex)&&h.currentSheetIndex!=n.sheetIndex&&kt.changeSheetExec(n.sheetIndex),n.type=="datachange"){Ah(n);let l={cfg:n.config,RowlChange:n.RowlChange,cdformat:n.cdformat,dataVerification:n.dataVerification,dynamicArray:n.dynamicArray};al(n.data,n.dataRange,l)}else if(n.type=="pasteCut"){let l={sheetIndex:n.source.sheetIndex,data:n.source.curData,curData:n.source.data,config:n.source.curConfig,curConfig:n.source.config,cdformat:n.source.curCdformat,curCdformat:n.source.cdformat,dataVerification:n.source.curDataVerification,curDataVerification:n.source.dataVerification,range:n.source.range},o={sheetIndex:n.target.sheetIndex,data:n.target.curData,curData:n.target.data,config:n.target.curConfig,curConfig:n.target.config,cdformat:n.target.curCdformat,curCdformat:n.target.cdformat,dataVerification:n.target.curDataVerification,curDataVerification:n.target.dataVerification,range:n.target.range};iu(l,o,n.RowlChange)}else if(n.type=="rangechange")Ah(n),Gc(n.data,n.range,n.cdformat);else if(n.type=="resize"){h.config=n.config,h.luckysheetfile[Me(n.sheetIndex)].config=h.config,n.ctrlType=="resizeR"?Ue.saveParam("cg",n.sheetIndex,n.config.rowlen,{k:"rowlen"}):n.ctrlType=="resizeC"&&Ue.saveParam("cg",n.sheetIndex,n.config.columnlen,{k:"columnlen"});let l=$.extend(!0,{},n.images);h.luckysheetfile[Me(n.sheetIndex)].images=l,Ue.saveParam("all",n.sheetIndex,l,{k:"images"}),Pt.images=l,Pt.allImagesShow(),tr(h.flowdata.length,h.flowdata[0].length)}else if(n.type=="cellRowChange")Li(n.data[0].length,n.data.length,n.data,n.config,n.range,n.ctrlType,n.ctrlValue,n.cdformat);else if(n.type=="extend")Li(n.data[0].length,n.data.length,n.data,n.config,n.range,"dele",n.ctrlValue);else if(n.type=="dele"){let l=$.extend(!0,{},n.ctrlValue);l.restore=!0,Li(n.data[0].length,n.data.length,n.data,n.config,n.range,"extend",l)}else if(n.type=="addRC"){let l=$.extend(!0,{},n.ctrlValue);l.direction=="rightbottom"&&(l.index=l.index+1),Rs(n.data,n.config,"delRC",l,n.calc,n.filterObj,n.cf,n.af,n.freezen,n.dataVerification,n.hyperlink)}else if(n.type=="delRC"){let l=$.extend(!0,{},n.ctrlValue);l.restore=!0,l.direction="lefttop",Rs(n.data,n.config,"addRC",l,n.calc,n.filterObj,n.cf,n.af,n.freezen,n.dataVerification,n.hyperlink)}else if(n.type=="deleteCell")nf(n.data,n.config,n.ctrl,n.calc,n.filterObj,n.cf,n.dataVerification,n.hyperlink);else if(n.type=="showHidRows")h.config=n.config,h.luckysheetfile[Me(n.sheetIndex)].config=n.config,Ue.saveParam("cg",n.sheetIndex,n.config.rowhidden,{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length);else if(n.type=="showHidCols")h.config=n.config,h.luckysheetfile[Me(n.sheetIndex)].config=n.config,Ue.saveParam("cg",n.sheetIndex,n.config.colhidden,{k:"colhidden"}),tr(h.flowdata.length,h.flowdata[0].length);else if(n.type=="datachangeAll")y.execFunctionGroup(),Li(n.data[0].length,n.data.length,n.data,null,n.range,"datachangeAll",n.ctrlValue);else if(n.type=="datachangeAll_filter_clear")fi(n.filter_save),$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").each(function(l){let o=$(this),a=n.optiongroups[l];Is(o,a.optionstate,a.rowhidden,a.caljs,!1,a.st_r,a.ed_r,a.cindex,a.st_c,a.ed_c)}),Ue.saveParam("fsr",h.currentSheetIndex,{filter:n.optiongroups,filter_select:n.filter_save}),h.config=n.config,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,h.config.rowhidden==null&&(h.config.rowhidden={}),Ue.saveParam("cg",h.currentSheetIndex,h.config.rowhidden,{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();else if(n.type=="datachangeAll_filter"){let l=$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(n.optionsindex),o=l.data("str"),a=l.data("edr"),s=l.data("cindex"),u=l.data("stc"),f=l.data("edc");Is(l,Ss.hasKey(n.rowhidenPre),n.rowhidenPre,n.caljs,!0,o,a,s,u,f),h.config=n.config,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,h.config.rowhidden==null&&(h.config.rowhidden={}),Ue.saveParam("cg",h.currentSheetIndex,h.config.rowhidden,{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}else if(n.type=="filtershow")$("#luckysheet-filter-selected-sheet"+n.sheetIndex+", #luckysheet-filter-options-sheet"+n.sheetIndex).remove(),Ue.allowUpdate&&Ue.saveParam("all",n.sheetIndex,null,{k:"filter_select"});else if(n.type=="pivotTable_change")h.luckysheetfile[Me(n.sheetIndex)].pivotTable=n.pivotTable,Yt.getCellData(n.sheetIndex),Yt.initialPivotManage(!0),Yt.refreshPivotTable();else if(n.type=="addSheet")kt.deleteSheet(n.index),kt.changeSheetExec(n.currentSheetIndex),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(n.type=="copySheet")kt.deleteSheet(n.index),kt.changeSheetExec(n.copyindex);else if(n.type=="deleteSheet"){let l=!1;for(let o=0;o<h.luckysheetfile.length;o++)h.luckysheetfile[o].name==n.name&&(l=!0);l||(kt.createSheetbydata(n,"isrenew"),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide())}else if(n.type=="sheetName")h.luckysheetfile[Me(n.sheetIndex)].name=n.oldtxt,$("#luckysheet-sheets-item"+n.sheetIndex).find(".luckysheet-sheets-item-name").html(n.oldtxt),Ue.saveParam("all",n.sheetIndex,n.oldtxt,{k:"name"});else if(n.type=="sheetColor"){h.luckysheetfile[Me(n.sheetIndex)].color=n.oldcolor;let l=$("#luckysheet-sheets-item"+n.sheetIndex);l.find(".luckysheet-sheets-item-color").remove(),n.oldcolor!=null&&l.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+n.oldcolor+';"></div>'),Ue.saveParam("all",n.sheetIndex,n.oldcolor,{k:"color"})}else if(n.type=="mergeChange"){let l={cfg:n.config};al(n.data,n.range,l)}else if(n.type=="updateDataVerification")ll.ref(n.currentDataVerification,n.historyDataVerification,n.sheetIndex);else if(n.type=="updateDataVerificationOfCheckbox")ll.refOfCheckbox(n.currentDataVerification,n.historyDataVerification,n.sheetIndex,n.data,n.range);else if(n.type=="updateHyperlink")ei.ref(n.currentHyperlink,n.historyHyperlink,n.sheetIndex,n.data,n.range);else if(n.type=="updateCF"){let l=n.data.historyRules;for(let o=0;o<l.length;o++){let a=l[o].sheetIndex;h.luckysheetfile[Me(a)].luckysheet_conditionformat_save=l[o].luckysheet_conditionformat_save,Ue.allowUpdate&&Ue.saveParam("all",a,l[o].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}Mt.ref()}else if(n.type=="updateAF"){let l=n.data.historyRules,o=Me(n.sheetIndex);h.luckysheetfile[o].luckysheet_alternateformat_save=$.extend(!0,[],l),setTimeout(function(){Xt()},1)}else if(n.type=="borderChange")n.config.borderInfo==null?Ue.saveParam("cg",n.sheetIndex,[],{k:"borderInfo"}):Ue.saveParam("cg",n.sheetIndex,n.config.borderInfo,{k:"borderInfo"}),h.config=n.config,h.luckysheetfile[Me(n.sheetIndex)].config=h.config,setTimeout(function(){Xt()},1);else if(n.type=="postil"){Zt.ref(n.data,n.rc);for(let l=0;l<n.rc.length;l++){let o=n.rc[l].split("_")[0],a=n.rc[l].split("_")[1];n.data[o][a]!=null&&n.data[o][a].ps!=null?Zt.buildPs(o,a,n.data[o][a].ps):Zt.buildPs(o,a,null)}}else n.type=="imageCtrl"?(Pt.images=$.extend(!0,{},n.images),Pt.allImagesShow(),Pt.ref()):n.type=="zoomChange"&&(h.zoomRatio=n.zoomRatio,Ue.saveParam("all",n.currentSheetIndex,n.zoomRatio,{k:"zoomRatio"}),Qi(),uu());Jr(e),n.range&&(h.luckysheet_select_save=n.range,gl()),h.clearjfundo=!0;let t={...n,data:n.curdata,curdata:n.data};sl.createHookFunction("updated",t)},undo:function(){if(h.jfundo.length==0)return;let e=h.jfundo.pop();if(h.jfredo.push(e),h.clearjfundo=!1,kt.hasSheet(e.sheetIndex)&&h.currentSheetIndex!=e.sheetIndex&&kt.changeSheetExec(e.sheetIndex),e.type=="datachange"){y.execFunctionGroup();let n={cfg:e.curConfig,RowlChange:e.RowlChange,cdformat:e.curCdformat,dataVerification:e.curDataVerification,dynamicArray:e.curDynamicArray};Ah(e,"undo"),al(e.curdata,e.range,n)}else if(e.type=="pasteCut")iu(e.source,e.target,e.RowlChange);else if(e.type=="rangechange")Ah(e,"undo"),Gc(e.curdata,e.range,e.curCdformat);else if(e.type=="resize"){h.config=e.curconfig,h.luckysheetfile[Me(e.sheetIndex)].config=h.config,e.ctrlType=="resizeR"?Ue.saveParam("cg",e.sheetIndex,e.curconfig.rowlen,{k:"rowlen"}):e.ctrlType=="resizeC"&&Ue.saveParam("cg",e.sheetIndex,e.curconfig.columnlen,{k:"columnlen"});let n=$.extend(!0,{},e.curImages);h.luckysheetfile[Me(e.sheetIndex)].images=n,Ue.saveParam("all",e.sheetIndex,n,{k:"images"}),Pt.images=n,Pt.allImagesShow(),tr(h.flowdata.length,h.flowdata[0].length)}else if(e.type=="cellRowChange")Li(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue,e.curCdformat);else if(e.type=="extend")Li(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue);else if(e.type=="dele"){let n=$.extend(!0,{},e.ctrlValue);n.restore=!0,Li(e.curdata[0].length,e.curdata.length,e.curdata,e.curconfig,e.currange,e.ctrlType,e.ctrlValue)}else if(e.type=="addRC")Rs(e.curData,e.curConfig,"addRC",e.ctrlValue,e.curCalc,e.curFilterObj,e.curCf,e.curAf,e.curFreezen,e.curDataVerification,e.curHyperlink);else if(e.type=="delRC")Rs(e.curData,e.curConfig,"delRC",e.ctrlValue,e.curCalc,e.curFilterObj,e.curCf,e.curAf,e.curFreezen,e.curDataVerification,e.curHyperlink);else if(e.type=="deleteCell")nf(e.curData,e.curConfig,e.ctrl,e.curCalc,e.curFilterObj,e.curCf,e.curDataVerification,e.curHyperlink);else if(e.type=="showHidRows")h.config=e.curconfig,h.luckysheetfile[Me(e.sheetIndex)].config=e.curconfig,Ue.saveParam("cg",e.sheetIndex,e.curconfig.rowhidden,{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length);else if(e.type=="showHidCols")h.config=e.curconfig,h.luckysheetfile[Me(e.sheetIndex)].config=e.curconfig,Ue.saveParam("cg",e.sheetIndex,e.curconfig.colhidden,{k:"colhidden"}),tr(h.flowdata.length,h.flowdata[0].length);else if(e.type=="datachangeAll")y.execFunctionGroup(),Li(e.curdata[0].length,e.curdata.length,e.curdata,null,e.currange,"datachangeAll",e.ctrlValue);else if(e.type=="datachangeAll_filter_clear")Ue.saveParam("fsc",h.currentSheetIndex,null),h.config=e.curconfig,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,{},{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu .luckysheet-filter-selected-input").hide().find("input").val(),$("#luckysheet-filter-selected span").data("type","0").data("type",null).text("\u65E0"),$("#luckysheet-filter-selected-sheet"+h.currentSheetIndex+", #luckysheet-filter-options-sheet"+h.currentSheetIndex).remove(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide();else if(e.type=="datachangeAll_filter"){let n=$("#luckysheet-filter-options-sheet"+h.currentSheetIndex+" .luckysheet-filter-options").eq(e.optionsindex),t=n.data("str"),l=n.data("edr"),o=n.data("cindex"),a=n.data("stc"),s=n.data("edc");Is(n,Ss.hasKey(e.rowhidden),e.rowhidden,e.caljs,!0,t,l,o,a,s),h.config=e.curconfig,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,h.config.rowhidden,{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide()}else if(e.type=="filtershow")h.luckysheet_select_save=[e.filter_save],h.filterchage=!1,rf(),h.filterchage=!0,Ue.saveParam("all",e.sheetIndex,e.filter_save,{k:"filter_select"});else if(e.type=="pivotTable_change")h.luckysheetfile[Me(e.sheetIndex)].pivotTable=e.pivotTablecur,Yt.getCellData(e.sheetIndex),Yt.initialPivotManage(!0),Yt.refreshPivotTable();else if(e.type=="addSheet")kt.createSheetbydata(e.sheetconfig),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(e.type=="copySheet")kt.copySheet(e.copyindex);else if(e.type=="deleteSheet")kt.deleteSheet(e.index),e.order==0?kt.changeSheetExec(h.luckysheetfile[0].index):kt.changeSheetExec(h.luckysheetfile[e.order-1].index),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide();else if(e.type=="sheetName")h.luckysheetfile[Me(e.sheetIndex)].name=e.txt,$("#luckysheet-sheets-item"+e.sheetIndex).find(".luckysheet-sheets-item-name").html(e.txt),Ue.saveParam("all",e.sheetIndex,e.txt,{k:"name"});else if(e.type=="sheetColor"){h.luckysheetfile[Me(e.sheetIndex)].color=e.color;let n=$("#luckysheet-sheets-item"+e.sheetIndex);n.find(".luckysheet-sheets-item-color").remove(),e.color!=null&&n.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e.color+';"></div>'),Ue.saveParam("all",e.sheetIndex,e.color,{k:"color"})}else if(e.type=="mergeChange"){let n={cfg:e.curConfig};al(e.curData,e.range,n)}else if(e.type=="updateDataVerification")ll.ref(e.historyDataVerification,e.currentDataVerification,e.sheetIndex);else if(e.type=="updateDataVerificationOfCheckbox")ll.refOfCheckbox(e.historyDataVerification,e.currentDataVerification,e.sheetIndex,e.curData,e.range);else if(e.type=="updateHyperlink")ei.ref(e.historyHyperlink,e.currentHyperlink,e.sheetIndex,e.curData,e.range);else if(e.type=="updateCF"){let n=e.data.currentRules;for(let t=0;t<n.length;t++){let l=n[t].sheetIndex;h.luckysheetfile[Me(l)].luckysheet_conditionformat_save=n[t].luckysheet_conditionformat_save,Ue.allowUpdate&&Ue.saveParam("all",l,n[t].luckysheet_conditionformat_save,{k:"luckysheet_conditionformat_save"})}Mt.ref()}else if(e.type=="updateAF"){let n=e.data.currentRules,t=Me(e.sheetIndex);h.luckysheetfile[t].luckysheet_alternateformat_save=$.extend(!0,[],n),setTimeout(function(){Xt()},1)}else if(e.type=="borderChange")Ue.saveParam("cg",e.sheetIndex,e.curconfig.borderInfo,{k:"borderInfo"}),h.config=e.curconfig,h.luckysheetfile[Me(e.sheetIndex)].config=h.config,setTimeout(function(){Xt()},1);else if(e.type=="postil"){Zt.ref(e.curdata,e.rc);for(let n=0;n<e.rc.length;n++){let t=e.rc[n].split("_")[0],l=e.rc[n].split("_")[1];e.curdata[t][l]!=null&&e.curdata[t][l].ps!=null?Zt.buildPs(t,l,e.curdata[t][l].ps):Zt.buildPs(t,l,null)}}else e.type=="imageCtrl"?(Pt.images=$.extend(!0,{},e.curImages),Pt.allImagesShow(),Pt.ref()):e.type=="zoomChange"&&(h.zoomRatio=e.curZoomRatio,Ue.saveParam("all",e.currentSheetIndex,e.curZoomRatio,{k:"zoomRatio"}),Qi(),uu());e.range&&(h.luckysheet_select_save=e.range,gl()),h.clearjfundo=!0}},ns=w3});var import_plugin,Oh,Ds,gg=Nt(()=>{import_plugin=qe(Ye()),Oh=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],Ds={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:e=>typeof console!="undefined"&&console.warn(e),getWeek:e=>{let n=new Date(e.getTime());n.setHours(0,0,0,0),n.setDate(n.getDate()+3-(n.getDay()+6)%7);var t=new Date(n.getFullYear(),0,4);return 1+Math.round(((n.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1}});var import_plugin,Ph,Eh,pg=Nt(()=>{import_plugin=qe(Ye()),Ph={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:e=>{let n=e%100;if(n>3&&n<21)return"th";switch(n%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Eh=Ph});function vg(e,n){let t;return function(){clearTimeout(t),t=setTimeout(()=>e.apply(this,arguments),n)}}var import_plugin,Ai,to,Nh,yg=Nt(()=>{import_plugin=qe(Ye()),Ai=(e,n=2)=>`000${e}`.slice(n*-1),to=e=>e===!0?1:0;Nh=e=>e instanceof Array?e:[e]});function zi(e,n,t){if(t===!0)return e.classList.add(n);e.classList.remove(n)}function zr(e,n,t){let l=window.document.createElement(e);return n=n||"",t=t||"",l.className=n,t!==void 0&&(l.textContent=t),l}function gf(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function kg(e,n){if(n(e))return e;if(e.parentNode)return kg(e.parentNode,n)}function pf(e,n){let t=zr("div","numInputWrapper"),l=zr("input","numInput "+e),o=zr("span","arrowUp"),a=zr("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?l.type="number":(l.type="text",l.pattern="\\d*"),n!==void 0)for(let s in n)l.setAttribute(s,n[s]);return t.appendChild(l),t.appendChild(o),t.appendChild(a),t}function lo(e){try{return typeof e.composedPath=="function"?e.composedPath()[0]:e.target}catch(n){return e.target}}var import_plugin,I1=Nt(()=>{import_plugin=qe(Ye())});var import_plugin,bg,vf,T1,yf,hu,wg=Nt(()=>{import_plugin=qe(Ye());yg();bg=()=>{},vf=(e,n,t)=>t.months[n?"shorthand":"longhand"][e],T1={D:bg,F:function(e,n,t){e.setMonth(t.months.longhand.indexOf(n))},G:(e,n)=>{e.setHours(parseFloat(n))},H:(e,n)=>{e.setHours(parseFloat(n))},J:(e,n)=>{e.setDate(parseFloat(n))},K:(e,n,t)=>{e.setHours(e.getHours()%12+12*to(new RegExp(t.amPM[1],"i").test(n)))},M:function(e,n,t){e.setMonth(t.months.shorthand.indexOf(n))},S:(e,n)=>{e.setSeconds(parseFloat(n))},U:(e,n)=>new Date(parseFloat(n)*1e3),W:function(e,n,t){let l=parseInt(n),o=new Date(e.getFullYear(),0,2+(l-1)*7,0,0,0,0);return o.setDate(o.getDate()-o.getDay()+t.firstDayOfWeek),o},Y:(e,n)=>{e.setFullYear(parseFloat(n))},Z:(e,n)=>new Date(n),d:(e,n)=>{e.setDate(parseFloat(n))},h:(e,n)=>{e.setHours(parseFloat(n))},i:(e,n)=>{e.setMinutes(parseFloat(n))},j:(e,n)=>{e.setDate(parseFloat(n))},l:bg,m:(e,n)=>{e.setMonth(parseFloat(n)-1)},n:(e,n)=>{e.setMonth(parseFloat(n)-1)},s:(e,n)=>{e.setSeconds(parseFloat(n))},u:(e,n)=>new Date(parseFloat(n)),w:bg,y:(e,n)=>{e.setFullYear(2e3+parseFloat(n))}},yf={D:"(\\w+)",F:"(\\w+)",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"(\\w+)",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"(\\w+)",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},hu={Z:e=>e.toISOString(),D:function(e,n,t){return n.weekdays.shorthand[hu.w(e,n,t)]},F:function(e,n,t){return vf(hu.n(e,n,t)-1,!1,n)},G:function(e,n,t){return Ai(hu.h(e,n,t))},H:e=>Ai(e.getHours()),J:function(e,n){return n.ordinal!==void 0?e.getDate()+n.ordinal(e.getDate()):e.getDate()},K:(e,n)=>n.amPM[to(e.getHours()>11)],M:function(e,n){return vf(e.getMonth(),!0,n)},S:e=>Ai(e.getSeconds()),U:e=>e.getTime()/1e3,W:function(e,n,t){return t.getWeek(e)},Y:e=>Ai(e.getFullYear(),4),d:e=>Ai(e.getDate()),h:e=>e.getHours()%12?e.getHours()%12:12,i:e=>Ai(e.getMinutes()),j:e=>e.getDate(),l:function(e,n){return n.weekdays.longhand[e.getDay()]},m:e=>Ai(e.getMonth()+1),n:e=>e.getMonth()+1,s:e=>e.getSeconds(),u:e=>e.getTime(),w:e=>e.getDay(),y:e=>String(e.getFullYear()).substring(2)}});function ro(e,n,t=!0){return t!==!1?new Date(e.getTime()).setHours(0,0,0,0)-new Date(n.getTime()).setHours(0,0,0,0):e.getTime()-n.getTime()}function Hh(e){let n=e.defaultHour,t=e.defaultMinute,l=e.defaultSeconds;if(e.minDate!==void 0){let o=e.minDate.getHours(),a=e.minDate.getMinutes(),s=e.minDate.getSeconds();n<o&&(n=o),n===o&&t<a&&(t=a),n===o&&t===a&&l<s&&(l=e.minDate.getSeconds())}if(e.maxDate!==void 0){let o=e.maxDate.getHours(),a=e.maxDate.getMinutes();n=Math.min(n,o),n===o&&(t=Math.min(a,t)),n===o&&t===a&&(l=e.maxDate.getSeconds())}return{hours:n,minutes:t,seconds:l}}var import_plugin,xg,Lh,R1,F1,M1=Nt(()=>{import_plugin=qe(Ye());wg();gg();pg();xg=({config:e=Ds,l10n:n=Ph,isMobile:t=!1})=>(l,o,a)=>{let s=a||n;return e.formatDate!==void 0&&!t?e.formatDate(l,o,s):o.split("").map((u,f,m)=>hu[u]&&m[f-1]!=="\\"?hu[u](l,s,e):u!=="\\"?u:"").join("")},Lh=({config:e=Ds,l10n:n=Ph})=>(t,l,o,a)=>{if(t!==0&&!t)return;let s=a||n,u,f=t;if(t instanceof Date)u=new Date(t.getTime());else if(typeof t!="string"&&t.toFixed!==void 0)u=new Date(t);else if(typeof t=="string"){let m=l||(e||Ds).dateFormat,d=String(t).trim();if(d==="today")u=new Date,o=!0;else if(/Z$/.test(d)||/GMT$/.test(d))u=new Date(t);else if(e&&e.parseDate)u=e.parseDate(t,m);else{u=!e||!e.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0));let p,b=[];for(let g=0,v=0,x="";g<m.length;g++){let _=m[g],S=_==="\\",I=m[g-1]==="\\"||S;if(yf[_]&&!I){x+=yf[_];let P=new RegExp(x).exec(t);P&&(p=!0)&&b[_!=="Y"?"push":"unshift"]({fn:T1[_],val:P[++v]})}else S||(x+=".");b.forEach(({fn:P,val:F})=>u=P(u,F,s)||u)}u=p?u:void 0}}if(!(u instanceof Date&&!isNaN(u.getTime()))){e.errorHandler(new Error(`Invalid date provided: ${f}`));return}return o===!0&&u.setHours(0,0,0,0),u};R1=(e,n,t)=>e>Math.min(n,t)&&e<Math.max(n,t),F1={DAY:864e5}});var import_plugin,D1=Nt(()=>{import_plugin=qe(Ye());"use strict";typeof Object.assign!="function"&&(Object.assign=function(e,...n){if(!e)throw TypeError("Cannot convert undefined or null to object");for(let t of n)t&&Object.keys(t).forEach(l=>e[l]=t[l]);return e})});function _3(e,n){let t={config:Object.assign(Object.assign({},Ds),qn.defaultConfig),l10n:Eh};t.parseDate=Lh({config:t.config,l10n:t.l10n}),t._handlers=[],t.pluginElements=[],t.loadedPlugins=[],t._bind=v,t._setHoursFromDate=p,t._positionCalendar=Ft,t.changeMonth=pe,t.changeYear=ge,t.clear=ne,t.close=me,t._createElement=zr,t.destroy=Q,t.isEnabled=ce,t.jumpToDate=S,t.open=Fe,t.redraw=be,t.set=Le,t.setDate=nt,t.toggle=Je;function l(){t.utils={getDaysInMonth(Re=t.currentMonth,We=t.currentYear){return Re===1&&(We%4==0&&We%100!=0||We%400==0)?29:t.l10n.daysInMonth[Re]}}}function o(){t.element=t.input=e,t.isOpen=!1,wt(),xt(),_e(),ze(),l(),t.isMobile||F(),_(),(t.selectedDates.length||t.config.noCalendar)&&(t.config.enableTime&&p(t.config.noCalendar?t.latestSelectedDateObj:void 0),Nr(!1)),s();let Re=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!t.isMobile&&Re&&Ft(),Ke("onReady")}function a(Re){return Re.bind(t)}function s(){let Re=t.config;Re.weekNumbers===!1&&Re.showMonths===1||Re.noCalendar!==!0&&window.requestAnimationFrame(function(){if(t.calendarContainer!==void 0&&(t.calendarContainer.style.visibility="hidden",t.calendarContainer.style.display="block"),t.daysContainer!==void 0){let We=(t.days.offsetWidth+1)*Re.showMonths;t.daysContainer.style.width=We+"px",t.calendarContainer.style.width=We+(t.weekWrapper!==void 0?t.weekWrapper.offsetWidth:0)+"px",t.calendarContainer.style.removeProperty("visibility"),t.calendarContainer.style.removeProperty("display")}})}function u(Re){if(t.selectedDates.length===0){let ht=t.config.minDate===void 0||ro(new Date,t.config.minDate)>=0?new Date:new Date(t.config.minDate.getTime()),Ct=Hh(t.config);ht.setHours(Ct.hours,Ct.minutes,Ct.seconds,ht.getMilliseconds()),t.selectedDates=[ht],t.latestSelectedDateObj=ht}Re!==void 0&&Re.type!=="blur"&&on(Re);let We=t._input.value;d(),Nr(),t._input.value!==We&&t._debouncedChange()}function f(Re,We){return Re%12+12*to(We===t.l10n.amPM[1])}function m(Re){switch(Re%24){case 0:case 12:return 12;default:return Re%12}}function d(){if(t.hourElement===void 0||t.minuteElement===void 0)return;let Re=(parseInt(t.hourElement.value.slice(-2),10)||0)%24,We=(parseInt(t.minuteElement.value,10)||0)%60,ht=t.secondElement!==void 0?(parseInt(t.secondElement.value,10)||0)%60:0;t.amPM!==void 0&&(Re=f(Re,t.amPM.textContent));let Ct=t.config.minTime!==void 0||t.config.minDate&&t.minDateHasTime&&t.latestSelectedDateObj&&ro(t.latestSelectedDateObj,t.config.minDate,!0)===0;if(t.config.maxTime!==void 0||t.config.maxDate&&t.maxDateHasTime&&t.latestSelectedDateObj&&ro(t.latestSelectedDateObj,t.config.maxDate,!0)===0){let Dt=t.config.maxTime!==void 0?t.config.maxTime:t.config.maxDate;Re=Math.min(Re,Dt.getHours()),Re===Dt.getHours()&&(We=Math.min(We,Dt.getMinutes())),We===Dt.getMinutes()&&(ht=Math.min(ht,Dt.getSeconds()))}if(Ct){let Dt=t.config.minTime!==void 0?t.config.minTime:t.config.minDate;Re=Math.max(Re,Dt.getHours()),Re===Dt.getHours()&&We<Dt.getMinutes()&&(We=Dt.getMinutes()),We===Dt.getMinutes()&&(ht=Math.max(ht,Dt.getSeconds()))}b(Re,We,ht)}function p(Re){let We=Re||t.latestSelectedDateObj;We&&b(We.getHours(),We.getMinutes(),We.getSeconds())}function b(Re,We,ht){t.latestSelectedDateObj!==void 0&&t.latestSelectedDateObj.setHours(Re%24,We,ht||0,0),!(!t.hourElement||!t.minuteElement||t.isMobile)&&(t.hourElement.value=Ai(t.config.time_24hr?Re:(12+Re)%12+12*to(Re%12==0)),t.minuteElement.value=Ai(We),t.amPM!==void 0&&(t.amPM.textContent=t.l10n.amPM[to(Re>=12)]),t.secondElement!==void 0&&(t.secondElement.value=Ai(ht)))}function g(Re){let We=lo(Re),ht=parseInt(We.value)+(Re.delta||0);(ht/1e3>1||Re.key==="Enter"&&!/[^\d]/.test(ht.toString()))&&ge(ht)}function v(Re,We,ht,Ct){if(We instanceof Array)return We.forEach(Lt=>v(Re,Lt,ht,Ct));if(Re instanceof Array)return Re.forEach(Lt=>v(Lt,We,ht,Ct));Re.addEventListener(We,ht,Ct),t._handlers.push({remove:()=>Re.removeEventListener(We,ht)})}function x(){Ke("onChange")}function _(){if(t.config.wrap&&["open","close","toggle","clear"].forEach(We=>{Array.prototype.forEach.call(t.element.querySelectorAll(`[data-${We}]`),ht=>v(ht,"click",t[We]))}),t.isMobile){Qe();return}let Re=vg(et,50);if(t._debouncedChange=vg(x,x3),t.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&v(t.daysContainer,"mouseover",We=>{t.config.mode==="range"&&xe(lo(We))}),v(window.document.body,"keydown",Ne),!t.config.inline&&!t.config.static&&v(window,"resize",Re),window.ontouchstart!==void 0?v(window.document,"touchstart",ie):v(window.document,"mousedown",ie),v(window.document,"focus",ie,{capture:!0}),t.config.clickOpens===!0&&(v(t._input,"focus",t.open),v(t._input,"click",t.open)),t.daysContainer!==void 0&&(v(t.monthNav,"click",li),v(t.monthNav,["keyup","increment"],g),v(t.daysContainer,"click",Oe)),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0){let We=ht=>lo(ht).select();v(t.timeContainer,["increment"],u),v(t.timeContainer,"blur",u,{capture:!0}),v(t.timeContainer,"click",I),v([t.hourElement,t.minuteElement],["focus","click"],We),t.secondElement!==void 0&&v(t.secondElement,"focus",()=>t.secondElement&&t.secondElement.select()),t.amPM!==void 0&&v(t.amPM,"click",ht=>{u(ht),x()})}t.config.allowInput&&v(t._input,"blur",ye)}function S(Re,We){let ht=Re!==void 0?t.parseDate(Re):t.latestSelectedDateObj||(t.config.minDate&&t.config.minDate>t.now?t.config.minDate:t.config.maxDate&&t.config.maxDate<t.now?t.config.maxDate:t.now),Ct=t.currentYear,Lt=t.currentMonth;try{ht!==void 0&&(t.currentYear=ht.getFullYear(),t.currentMonth=ht.getMonth())}catch(Dt){Dt.message="Invalid date supplied: "+ht,t.config.errorHandler(Dt)}We&&t.currentYear!==Ct&&(Ke("onYearChange"),A()),We&&(t.currentYear!==Ct||t.currentMonth!==Lt)&&Ke("onMonthChange"),t.redraw()}function I(Re){let We=lo(Re);~We.className.indexOf("arrow")&&P(Re,We.classList.contains("arrowUp")?1:-1)}function P(Re,We,ht){let Ct=Re&&lo(Re),Lt=ht||Ct&&Ct.parentNode&&Ct.parentNode.firstChild,Dt=gt("increment");Dt.delta=We,Lt&&Lt.dispatchEvent(Dt)}function F(){let Re=window.document.createDocumentFragment();if(t.calendarContainer=zr("div","flatpickr-calendar"),t.calendarContainer.tabIndex=-1,!t.config.noCalendar){if(Re.appendChild(N()),t.innerContainer=zr("div","flatpickr-innerContainer"),t.config.weekNumbers){let{weekWrapper:ht,weekNumbers:Ct}=ue();t.innerContainer.appendChild(ht),t.weekNumbers=Ct,t.weekWrapper=ht}t.rContainer=zr("div","flatpickr-rContainer"),t.rContainer.appendChild(X()),t.daysContainer||(t.daysContainer=zr("div","flatpickr-days"),t.daysContainer.tabIndex=-1),z(),t.rContainer.appendChild(t.daysContainer),t.innerContainer.appendChild(t.rContainer),Re.appendChild(t.innerContainer)}t.config.enableTime&&Re.appendChild(W()),zi(t.calendarContainer,"rangeMode",t.config.mode==="range"),zi(t.calendarContainer,"animate",t.config.animate===!0),zi(t.calendarContainer,"multiMonth",t.config.showMonths>1),t.calendarContainer.appendChild(Re);let We=t.config.appendTo!==void 0&&t.config.appendTo.nodeType!==void 0;if((t.config.inline||t.config.static)&&(t.calendarContainer.classList.add(t.config.inline?"inline":"static"),t.config.inline&&(!We&&t.element.parentNode?t.element.parentNode.insertBefore(t.calendarContainer,t._input.nextSibling):t.config.appendTo!==void 0&&t.config.appendTo.appendChild(t.calendarContainer)),t.config.static)){let ht=zr("div","flatpickr-wrapper");t.element.parentNode&&t.element.parentNode.insertBefore(ht,t.element),ht.appendChild(t.element),t.altInput&&ht.appendChild(t.altInput),ht.appendChild(t.calendarContainer)}!t.config.static&&!t.config.inline&&(t.config.appendTo!==void 0?t.config.appendTo:window.document.body).appendChild(t.calendarContainer)}function D(Re,We,ht,Ct){let Lt=ce(We,!0),Dt=zr("span","flatpickr-day "+Re,We.getDate().toString());return Dt.dateObj=We,Dt.$i=Ct,Dt.setAttribute("aria-label",t.formatDate(We,t.config.ariaDateFormat)),Re.indexOf("hidden")===-1&&ro(We,t.now)===0&&(t.todayDateElem=Dt,Dt.classList.add("today"),Dt.setAttribute("aria-current","date")),Lt?(Dt.tabIndex=-1,At(We)&&(Dt.classList.add("selected"),t.selectedDateElem=Dt,t.config.mode==="range"&&(zi(Dt,"startRange",t.selectedDates[0]&&ro(We,t.selectedDates[0],!0)===0),zi(Dt,"endRange",t.selectedDates[1]&&ro(We,t.selectedDates[1],!0)===0),Re==="nextMonthDay"&&Dt.classList.add("inRange")))):Dt.classList.add("flatpickr-disabled"),t.config.mode==="range"&&cl(We)&&!At(We)&&Dt.classList.add("inRange"),t.weekNumbers&&t.config.showMonths===1&&Re!=="prevMonthDay"&&ht%7==1&&t.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+t.config.getWeek(We)+"</span>"),Ke("onDayCreate",Dt),Dt}function k(Re){Re.focus(),t.config.mode==="range"&&xe(Re)}function w(Re){let We=Re>0?0:t.config.showMonths-1,ht=Re>0?t.config.showMonths:-1;for(let Ct=We;Ct!=ht;Ct+=Re){let Lt=t.daysContainer.children[Ct],Dt=Re>0?0:Lt.children.length-1,ol=Re>0?Lt.children.length:-1;for(let el=Dt;el!=ol;el+=Re){let Al=Lt.children[el];if(Al.className.indexOf("hidden")===-1&&ce(Al.dateObj))return Al}}}function C(Re,We){let ht=Re.className.indexOf("Month")===-1?Re.dateObj.getMonth():t.currentMonth,Ct=We>0?t.config.showMonths:-1,Lt=We>0?1:-1;for(let Dt=ht-t.currentMonth;Dt!=Ct;Dt+=Lt){let ol=t.daysContainer.children[Dt],el=ht-t.currentMonth===Dt?Re.$i+We:We<0?ol.children.length-1:0,Al=ol.children.length;for(let Vl=el;Vl>=0&&Vl<Al&&Vl!=(We>0?Al:-1);Vl+=Lt){let lr=ol.children[Vl];if(lr.className.indexOf("hidden")===-1&&ce(lr.dateObj)&&Math.abs(Re.$i-Vl)>=Math.abs(We))return k(lr)}}t.changeMonth(Lt),T(w(Lt),0)}function T(Re,We){let ht=fe(document.activeElement||document.body),Ct=Re!==void 0?Re:ht?document.activeElement:t.selectedDateElem!==void 0&&fe(t.selectedDateElem)?t.selectedDateElem:t.todayDateElem!==void 0&&fe(t.todayDateElem)?t.todayDateElem:w(We>0?1:-1);Ct===void 0?t._input.focus():ht?C(Ct,We):k(Ct)}function O(Re,We){let ht=(new Date(Re,We,1).getDay()-t.l10n.firstDayOfWeek+7)%7,Ct=t.utils.getDaysInMonth((We-1+12)%12,Re),Lt=t.utils.getDaysInMonth(We,Re),Dt=window.document.createDocumentFragment(),ol=t.config.showMonths>1,el=ol?"prevMonthDay hidden":"prevMonthDay",Al=ol?"nextMonthDay hidden":"nextMonthDay",Vl=Ct+1-ht,lr=0;for(;Vl<=Ct;Vl++,lr++)Dt.appendChild(D(el,new Date(Re,We-1,Vl),Vl,lr));for(Vl=1;Vl<=Lt;Vl++,lr++)Dt.appendChild(D("",new Date(Re,We,Vl),Vl,lr));for(let en=Lt+1;en<=42-ht&&(t.config.showMonths===1||lr%7!=0);en++,lr++)Dt.appendChild(D(Al,new Date(Re,We+1,en%Lt),en,lr));let hn=zr("div","dayContainer");return hn.appendChild(Dt),hn}function z(){if(t.daysContainer===void 0)return;gf(t.daysContainer),t.weekNumbers&&gf(t.weekNumbers);let Re=document.createDocumentFragment();for(let We=0;We<t.config.showMonths;We++){let ht=new Date(t.currentYear,t.currentMonth,1);ht.setMonth(t.currentMonth+We),Re.appendChild(O(ht.getFullYear(),ht.getMonth()))}t.daysContainer.appendChild(Re),t.days=t.daysContainer.firstChild,t.config.mode==="range"&&t.selectedDates.length===1&&xe()}function A(){if(t.config.showMonths>1||t.config.monthSelectorType!=="dropdown")return;let Re=function(We){return t.config.minDate!==void 0&&t.currentYear===t.config.minDate.getFullYear()&&We<t.config.minDate.getMonth()?!1:!(t.config.maxDate!==void 0&&t.currentYear===t.config.maxDate.getFullYear()&&We>t.config.maxDate.getMonth())};t.monthsDropdownContainer.tabIndex=-1,t.monthsDropdownContainer.innerHTML="";for(let We=0;We<12;We++){if(!Re(We))continue;let ht=zr("option","flatpickr-monthDropdown-month");ht.value=new Date(t.currentYear,We).getMonth().toString(),ht.textContent=vf(We,t.config.shorthandCurrentMonth,t.l10n),ht.tabIndex=-1,t.currentMonth===We&&(ht.selected=!0),t.monthsDropdownContainer.appendChild(ht)}}function E(){let Re=zr("div","flatpickr-month"),We=window.document.createDocumentFragment(),ht;t.config.showMonths>1||t.config.monthSelectorType==="static"?ht=zr("span","cur-month"):(t.monthsDropdownContainer=zr("select","flatpickr-monthDropdown-months"),t.monthsDropdownContainer.setAttribute("aria-label",t.l10n.monthAriaLabel),v(t.monthsDropdownContainer,"change",ol=>{let el=lo(ol),Al=parseInt(el.value,10);t.changeMonth(Al-t.currentMonth),Ke("onMonthChange")}),A(),ht=t.monthsDropdownContainer);let Ct=pf("cur-year",{tabindex:"-1"}),Lt=Ct.getElementsByTagName("input")[0];Lt.setAttribute("aria-label",t.l10n.yearAriaLabel),t.config.minDate&&Lt.setAttribute("min",t.config.minDate.getFullYear().toString()),t.config.maxDate&&(Lt.setAttribute("max",t.config.maxDate.getFullYear().toString()),Lt.disabled=!!t.config.minDate&&t.config.minDate.getFullYear()===t.config.maxDate.getFullYear());let Dt=zr("div","flatpickr-current-month");return Dt.appendChild(ht),Dt.appendChild(Ct),We.appendChild(Dt),Re.appendChild(We),{container:Re,yearElement:Lt,monthElement:ht}}function L(){gf(t.monthNav),t.monthNav.appendChild(t.prevMonthNav),t.config.showMonths&&(t.yearElements=[],t.monthElements=[]);for(let Re=t.config.showMonths;Re--;){let We=E();t.yearElements.push(We.yearElement),t.monthElements.push(We.monthElement),t.monthNav.appendChild(We.container)}t.monthNav.appendChild(t.nextMonthNav)}function N(){return t.monthNav=zr("div","flatpickr-months"),t.yearElements=[],t.monthElements=[],t.prevMonthNav=zr("span","flatpickr-prev-month"),t.prevMonthNav.innerHTML=t.config.prevArrow,t.nextMonthNav=zr("span","flatpickr-next-month"),t.nextMonthNav.innerHTML=t.config.nextArrow,L(),Object.defineProperty(t,"_hidePrevMonthArrow",{get:()=>t.__hidePrevMonthArrow,set(Re){t.__hidePrevMonthArrow!==Re&&(zi(t.prevMonthNav,"flatpickr-disabled",Re),t.__hidePrevMonthArrow=Re)}}),Object.defineProperty(t,"_hideNextMonthArrow",{get:()=>t.__hideNextMonthArrow,set(Re){t.__hideNextMonthArrow!==Re&&(zi(t.nextMonthNav,"flatpickr-disabled",Re),t.__hideNextMonthArrow=Re)}}),t.currentYearElement=t.yearElements[0],El(),t.monthNav}function W(){t.calendarContainer.classList.add("hasTime"),t.config.noCalendar&&t.calendarContainer.classList.add("noCalendar");let Re=Hh(t.config);t.timeContainer=zr("div","flatpickr-time"),t.timeContainer.tabIndex=-1;let We=zr("span","flatpickr-time-separator",":"),ht=pf("flatpickr-hour",{"aria-label":t.l10n.hourAriaLabel});t.hourElement=ht.getElementsByTagName("input")[0];let Ct=pf("flatpickr-minute",{"aria-label":t.l10n.minuteAriaLabel});if(t.minuteElement=Ct.getElementsByTagName("input")[0],t.hourElement.tabIndex=t.minuteElement.tabIndex=-1,t.hourElement.value=Ai(t.latestSelectedDateObj?t.latestSelectedDateObj.getHours():t.config.time_24hr?Re.hours:m(Re.hours)),t.minuteElement.value=Ai(t.latestSelectedDateObj?t.latestSelectedDateObj.getMinutes():Re.minutes),t.hourElement.setAttribute("step",t.config.hourIncrement.toString()),t.minuteElement.setAttribute("step",t.config.minuteIncrement.toString()),t.hourElement.setAttribute("min",t.config.time_24hr?"0":"1"),t.hourElement.setAttribute("max",t.config.time_24hr?"23":"12"),t.hourElement.setAttribute("maxlength","2"),t.minuteElement.setAttribute("min","0"),t.minuteElement.setAttribute("max","59"),t.minuteElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(ht),t.timeContainer.appendChild(We),t.timeContainer.appendChild(Ct),t.config.time_24hr&&t.timeContainer.classList.add("time24hr"),t.config.enableSeconds){t.timeContainer.classList.add("hasSeconds");let Lt=pf("flatpickr-second");t.secondElement=Lt.getElementsByTagName("input")[0],t.secondElement.value=Ai(t.latestSelectedDateObj?t.latestSelectedDateObj.getSeconds():Re.seconds),t.secondElement.setAttribute("step",t.minuteElement.getAttribute("step")),t.secondElement.setAttribute("min","0"),t.secondElement.setAttribute("max","59"),t.secondElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(zr("span","flatpickr-time-separator",":")),t.timeContainer.appendChild(Lt)}return t.config.time_24hr||(t.amPM=zr("span","flatpickr-am-pm",t.l10n.amPM[to((t.latestSelectedDateObj?t.hourElement.value:t.config.defaultHour)>11)]),t.amPM.title=t.l10n.toggleTitle,t.amPM.tabIndex=-1,t.timeContainer.appendChild(t.amPM)),t.timeContainer}function X(){t.weekdayContainer?gf(t.weekdayContainer):t.weekdayContainer=zr("div","flatpickr-weekdays");for(let Re=t.config.showMonths;Re--;){let We=zr("div","flatpickr-weekdaycontainer");t.weekdayContainer.appendChild(We)}return te(),t.weekdayContainer}function te(){if(!t.weekdayContainer)return;let Re=t.l10n.firstDayOfWeek,We=[...t.l10n.weekdays.shorthand];Re>0&&Re<We.length&&(We=[...We.splice(Re,We.length),...We.splice(0,Re)]);for(let ht=t.config.showMonths;ht--;)t.weekdayContainer.children[ht].innerHTML=`
      <span class='flatpickr-weekday'>
        ${We.join("</span><span class='flatpickr-weekday'>")}
      </span>
      `}function ue(){t.calendarContainer.classList.add("hasWeeks");let Re=zr("div","flatpickr-weekwrapper");Re.appendChild(zr("span","flatpickr-weekday",t.l10n.weekAbbreviation));let We=zr("div","flatpickr-weeks");return Re.appendChild(We),{weekWrapper:Re,weekNumbers:We}}function pe(Re,We=!0){let ht=We?Re:Re-t.currentMonth;ht<0&&t._hidePrevMonthArrow===!0||ht>0&&t._hideNextMonthArrow===!0||(t.currentMonth+=ht,(t.currentMonth<0||t.currentMonth>11)&&(t.currentYear+=t.currentMonth>11?1:-1,t.currentMonth=(t.currentMonth+12)%12,Ke("onYearChange"),A()),z(),Ke("onMonthChange"),El())}function ne(Re=!0,We=!0){if(t.input.value="",t.altInput!==void 0&&(t.altInput.value=""),t.mobileInput!==void 0&&(t.mobileInput.value=""),t.selectedDates=[],t.latestSelectedDateObj=void 0,We===!0&&(t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth()),t.config.enableTime===!0){let{hours:ht,minutes:Ct,seconds:Lt}=Hh(t.config);b(ht,Ct,Lt)}t.redraw(),Re&&Ke("onChange")}function me(){t.isOpen=!1,t.isMobile||(t.calendarContainer!==void 0&&t.calendarContainer.classList.remove("open"),t._input!==void 0&&t._input.classList.remove("active")),Ke("onClose")}function Q(){t.config!==void 0&&Ke("onDestroy");for(let Re=t._handlers.length;Re--;)t._handlers[Re].remove();if(t._handlers=[],t.mobileInput)t.mobileInput.parentNode&&t.mobileInput.parentNode.removeChild(t.mobileInput),t.mobileInput=void 0;else if(t.calendarContainer&&t.calendarContainer.parentNode)if(t.config.static&&t.calendarContainer.parentNode){let Re=t.calendarContainer.parentNode;if(Re.lastChild&&Re.removeChild(Re.lastChild),Re.parentNode){for(;Re.firstChild;)Re.parentNode.insertBefore(Re.firstChild,Re);Re.parentNode.removeChild(Re)}}else t.calendarContainer.parentNode.removeChild(t.calendarContainer);t.altInput&&(t.input.type="text",t.altInput.parentNode&&t.altInput.parentNode.removeChild(t.altInput),delete t.altInput),t.input&&(t.input.type=t.input._type,t.input.classList.remove("flatpickr-input"),t.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(Re=>{try{delete t[Re]}catch(We){}})}function we(Re){return t.config.appendTo&&t.config.appendTo.contains(Re)?!0:t.calendarContainer.contains(Re)}function ie(Re){if(t.isOpen&&!t.config.inline){let We=lo(Re),ht=we(We),Ct=We===t.input||We===t.altInput||t.element.contains(We)||Re.path&&Re.path.indexOf&&(~Re.path.indexOf(t.input)||~Re.path.indexOf(t.altInput)),Lt=Re.type==="blur"?Ct&&Re.relatedTarget&&!we(Re.relatedTarget):!Ct&&!ht&&!we(Re.relatedTarget),Dt=!t.config.ignoredFocusElements.some(ol=>ol.contains(We));Lt&&Dt&&(t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0&&t.input.value!==""&&t.input.value!==void 0&&u(),t.close(),t.config&&t.config.mode==="range"&&t.selectedDates.length===1&&(t.clear(!1),t.redraw()))}}function ge(Re){if(!Re||t.config.minDate&&Re<t.config.minDate.getFullYear()||t.config.maxDate&&Re>t.config.maxDate.getFullYear())return;let We=Re,ht=t.currentYear!==We;t.currentYear=We||t.currentYear,t.config.maxDate&&t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth=Math.min(t.config.maxDate.getMonth(),t.currentMonth):t.config.minDate&&t.currentYear===t.config.minDate.getFullYear()&&(t.currentMonth=Math.max(t.config.minDate.getMonth(),t.currentMonth)),ht&&(t.redraw(),Ke("onYearChange"),A())}function ce(Re,We=!0){var ht;let Ct=t.parseDate(Re,void 0,We);if(t.config.minDate&&Ct&&ro(Ct,t.config.minDate,We!==void 0?We:!t.minDateHasTime)<0||t.config.maxDate&&Ct&&ro(Ct,t.config.maxDate,We!==void 0?We:!t.maxDateHasTime)>0)return!1;if(!t.config.enable&&t.config.disable.length===0)return!0;if(Ct===void 0)return!1;let Lt=!!t.config.enable,Dt=(ht=t.config.enable)!==null&&ht!==void 0?ht:t.config.disable;for(let ol=0,el;ol<Dt.length;ol++){if(el=Dt[ol],typeof el=="function"&&el(Ct))return Lt;if(el instanceof Date&&Ct!==void 0&&el.getTime()===Ct.getTime())return Lt;if(typeof el=="string"){let Al=t.parseDate(el,void 0,!0);return Al&&Al.getTime()===Ct.getTime()?Lt:!Lt}else if(typeof el=="object"&&Ct!==void 0&&el.from&&el.to&&Ct.getTime()>=el.from.getTime()&&Ct.getTime()<=el.to.getTime())return Lt}return!Lt}function fe(Re){return t.daysContainer!==void 0?Re.className.indexOf("hidden")===-1&&Re.className.indexOf("flatpickr-disabled")===-1&&t.daysContainer.contains(Re):!1}function ye(Re){Re.target===t._input&&(t.selectedDates.length>0||t._input.value.length>0)&&!(Re.relatedTarget&&we(Re.relatedTarget))&&t.setDate(t._input.value,!0,Re.target===t.altInput?t.config.altFormat:t.config.dateFormat)}function Ne(Re){let We=lo(Re),ht=t.config.wrap?e.contains(We):We===t._input,Ct=t.config.allowInput,Lt=t.isOpen&&(!Ct||!ht),Dt=t.config.inline&&ht&&!Ct;if(Re.keyCode===13&&ht){if(Ct)return t.setDate(t._input.value,!0,We===t.altInput?t.config.altFormat:t.config.dateFormat),We.blur();t.open()}else if(we(We)||Lt||Dt){let ol=!!t.timeContainer&&t.timeContainer.contains(We);switch(Re.keyCode){case 13:ol?(Re.preventDefault(),u(),Te()):Oe(Re);break;case 27:Re.preventDefault(),Te();break;case 8:case 46:ht&&!t.config.allowInput&&(Re.preventDefault(),t.clear());break;case 37:case 39:if(!ol&&!ht){if(Re.preventDefault(),t.daysContainer!==void 0&&(Ct===!1||document.activeElement&&fe(document.activeElement))){let Al=Re.keyCode===39?1:-1;Re.ctrlKey?(Re.stopPropagation(),pe(Al),T(w(1),0)):T(void 0,Al)}}else t.hourElement&&t.hourElement.focus();break;case 38:case 40:Re.preventDefault();let el=Re.keyCode===40?1:-1;t.daysContainer&&We.$i!==void 0||We===t.input||We===t.altInput?Re.ctrlKey?(Re.stopPropagation(),ge(t.currentYear-el),T(w(1),0)):ol||T(void 0,el*7):We===t.currentYearElement?ge(t.currentYear-el):t.config.enableTime&&(!ol&&t.hourElement&&t.hourElement.focus(),u(Re),t._debouncedChange());break;case 9:if(ol){let Al=[t.hourElement,t.minuteElement,t.secondElement,t.amPM].concat(t.pluginElements).filter(lr=>lr),Vl=Al.indexOf(We);if(Vl!==-1){let lr=Al[Vl+(Re.shiftKey?-1:1)];Re.preventDefault(),(lr||t._input).focus()}}else!t.config.noCalendar&&t.daysContainer&&t.daysContainer.contains(We)&&Re.shiftKey&&(Re.preventDefault(),t._input.focus());break;default:break}}if(t.amPM!==void 0&&We===t.amPM)switch(Re.key){case t.l10n.amPM[0].charAt(0):case t.l10n.amPM[0].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[0],d(),Nr();break;case t.l10n.amPM[1].charAt(0):case t.l10n.amPM[1].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[1],d(),Nr();break}(ht||we(We))&&Ke("onKeyDown",Re)}function xe(Re){if(t.selectedDates.length!==1||Re&&(!Re.classList.contains("flatpickr-day")||Re.classList.contains("flatpickr-disabled")))return;let We=Re?Re.dateObj.getTime():t.days.firstElementChild.dateObj.getTime(),ht=t.parseDate(t.selectedDates[0],void 0,!0).getTime(),Ct=Math.min(We,t.selectedDates[0].getTime()),Lt=Math.max(We,t.selectedDates[0].getTime()),Dt=!1,ol=0,el=0;for(let Al=Ct;Al<Lt;Al+=F1.DAY)ce(new Date(Al),!0)||(Dt=Dt||Al>Ct&&Al<Lt,Al<ht&&(!ol||Al>ol)?ol=Al:Al>ht&&(!el||Al<el)&&(el=Al));for(let Al=0;Al<t.config.showMonths;Al++){let Vl=t.daysContainer.children[Al];for(let lr=0,hn=Vl.children.length;lr<hn;lr++){let en=Vl.children[lr],Dn=en.dateObj.getTime(),An=ol>0&&Dn<ol||el>0&&Dn>el;if(An){en.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(Br=>{en.classList.remove(Br)});continue}else if(Dt&&!An)continue;["startRange","inRange","endRange","notAllowed"].forEach(Br=>{en.classList.remove(Br)}),Re!==void 0&&(Re.classList.add(We<=t.selectedDates[0].getTime()?"startRange":"endRange"),ht<We&&Dn===ht?en.classList.add("startRange"):ht>We&&Dn===ht&&en.classList.add("endRange"),Dn>=ol&&(el===0||Dn<=el)&&R1(Dn,ht,We)&&en.classList.add("inRange"))}}}function et(){t.isOpen&&!t.config.static&&!t.config.inline&&Ft()}function Fe(Re,We=t._positionElement){if(t.isMobile===!0){if(Re){Re.preventDefault();let Ct=lo(Re);Ct&&Ct.blur()}t.mobileInput!==void 0&&(t.mobileInput.focus(),t.mobileInput.click()),Ke("onOpen");return}else if(t._input.disabled||t.config.inline)return;let ht=t.isOpen;t.isOpen=!0,ht||(t.calendarContainer.classList.add("open"),t._input.classList.add("active"),Ke("onOpen"),Ft(We)),t.config.enableTime===!0&&t.config.noCalendar===!0&&t.config.allowInput===!1&&(Re===void 0||!t.timeContainer.contains(Re.relatedTarget))&&setTimeout(()=>t.hourElement.select(),50)}function it(Re){return We=>{let ht=t.config[`_${Re}Date`]=t.parseDate(We,t.config.dateFormat),Ct=t.config[`_${Re==="min"?"max":"min"}Date`];ht!==void 0&&(t[Re==="min"?"minDateHasTime":"maxDateHasTime"]=ht.getHours()>0||ht.getMinutes()>0||ht.getSeconds()>0),t.selectedDates&&(t.selectedDates=t.selectedDates.filter(Lt=>ce(Lt)),!t.selectedDates.length&&Re==="min"&&p(ht),Nr()),t.daysContainer&&(be(),ht!==void 0?t.currentYearElement[Re]=ht.getFullYear().toString():t.currentYearElement.removeAttribute(Re),t.currentYearElement.disabled=!!Ct&&ht!==void 0&&Ct.getFullYear()===ht.getFullYear())}}function wt(){let Re=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],We=Object.assign(Object.assign({},JSON.parse(JSON.stringify(e.dataset||{}))),n),ht={};t.config.parseDate=We.parseDate,t.config.formatDate=We.formatDate,Object.defineProperty(t.config,"enable",{get:()=>t.config._enable,set:Dt=>{t.config._enable=Ze(Dt)}}),Object.defineProperty(t.config,"disable",{get:()=>t.config._disable,set:Dt=>{t.config._disable=Ze(Dt)}});let Ct=We.mode==="time";if(!We.dateFormat&&(We.enableTime||Ct)){let Dt=qn.defaultConfig.dateFormat||Ds.dateFormat;ht.dateFormat=We.noCalendar||Ct?"H:i"+(We.enableSeconds?":S":""):Dt+" H:i"+(We.enableSeconds?":S":"")}if(We.altInput&&(We.enableTime||Ct)&&!We.altFormat){let Dt=qn.defaultConfig.altFormat||Ds.altFormat;ht.altFormat=We.noCalendar||Ct?"h:i"+(We.enableSeconds?":S K":" K"):Dt+` h:i${We.enableSeconds?":S":""} K`}Object.defineProperty(t.config,"minDate",{get:()=>t.config._minDate,set:it("min")}),Object.defineProperty(t.config,"maxDate",{get:()=>t.config._maxDate,set:it("max")});let Lt=Dt=>ol=>{t.config[Dt==="min"?"_minTime":"_maxTime"]=t.parseDate(ol,"H:i:S")};Object.defineProperty(t.config,"minTime",{get:()=>t.config._minTime,set:Lt("min")}),Object.defineProperty(t.config,"maxTime",{get:()=>t.config._maxTime,set:Lt("max")}),We.mode==="time"&&(t.config.noCalendar=!0,t.config.enableTime=!0),Object.assign(t.config,ht,We);for(let Dt=0;Dt<Re.length;Dt++)t.config[Re[Dt]]=t.config[Re[Dt]]===!0||t.config[Re[Dt]]==="true";Oh.filter(Dt=>t.config[Dt]!==void 0).forEach(Dt=>{t.config[Dt]=Nh(t.config[Dt]||[]).map(a)}),t.isMobile=!t.config.disableMobile&&!t.config.inline&&t.config.mode==="single"&&!t.config.disable.length&&!t.config.enable&&!t.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(let Dt=0;Dt<t.config.plugins.length;Dt++){let ol=t.config.plugins[Dt](t)||{};for(let el in ol)Oh.indexOf(el)>-1?t.config[el]=Nh(ol[el]).map(a).concat(t.config[el]):typeof We[el]=="undefined"&&(t.config[el]=ol[el])}We.altInputClass||(t.config.altInputClass=ot().className+" "+t.config.altInputClass),Ke("onParseConfig")}function ot(){return t.config.wrap?e.querySelector("[data-input]"):e}function xt(){typeof t.config.locale!="object"&&typeof qn.l10ns[t.config.locale]=="undefined"&&t.config.errorHandler(new Error(`flatpickr: invalid locale ${t.config.locale}`)),t.l10n=Object.assign(Object.assign({},qn.l10ns.default),typeof t.config.locale=="object"?t.config.locale:t.config.locale!=="default"?qn.l10ns[t.config.locale]:void 0),yf.K=`(${t.l10n.amPM[0]}|${t.l10n.amPM[1]}|${t.l10n.amPM[0].toLowerCase()}|${t.l10n.amPM[1].toLowerCase()})`,Object.assign(Object.assign({},n),JSON.parse(JSON.stringify(e.dataset||{}))).time_24hr===void 0&&qn.defaultConfig.time_24hr===void 0&&(t.config.time_24hr=t.l10n.time_24hr),t.formatDate=xg(t),t.parseDate=Lh({config:t.config,l10n:t.l10n})}function Ft(Re){if(typeof t.config.position=="function")return void t.config.position(t,Re);if(t.calendarContainer===void 0)return;Ke("onPreCalendarPosition");let We=Re||t._positionElement,ht=Array.prototype.reduce.call(t.calendarContainer.children,(Ln,ri)=>Ln+ri.offsetHeight,0),Ct=t.calendarContainer.offsetWidth,Lt=t.config.position.split(" "),Dt=Lt[0],ol=Lt.length>1?Lt[1]:null,el=We.getBoundingClientRect(),Al=window.innerHeight-el.bottom,Vl=Dt==="above"||Dt!=="below"&&Al<ht&&el.top>ht,lr=window.pageYOffset+el.top+(Vl?-ht-2:We.offsetHeight+2);if(zi(t.calendarContainer,"arrowTop",!Vl),zi(t.calendarContainer,"arrowBottom",Vl),t.config.inline)return;let hn=window.pageXOffset+el.left,en=!1,Mn=!1;ol==="center"?(hn-=(Ct-el.width)/2,en=!0):ol==="right"&&(hn-=Ct-el.width,Mn=!0),zi(t.calendarContainer,"arrowLeft",!en&&!Mn),zi(t.calendarContainer,"arrowCenter",en),zi(t.calendarContainer,"arrowRight",Mn);let Dn=window.document.body.offsetWidth-(window.pageXOffset+el.right),An=hn+Ct>window.document.body.offsetWidth,Br=Dn+Ct>window.document.body.offsetWidth;if(zi(t.calendarContainer,"rightMost",An),!t.config.static)if(t.calendarContainer.style.top=`${lr}px`,!An)t.calendarContainer.style.left=`${hn}px`,t.calendarContainer.style.right="auto";else if(!Br)t.calendarContainer.style.left="auto",t.calendarContainer.style.right=`${Dn}px`;else{let Ln=Se();if(Ln===void 0)return;let ri=window.document.body.offsetWidth,dn=Math.max(0,ri/2-Ct/2),zn=".flatpickr-calendar.centerMost:before",Hn=".flatpickr-calendar.centerMost:after",$n=Ln.cssRules.length,di=`{left:${el.left}px;right:auto;}`;zi(t.calendarContainer,"rightMost",!1),zi(t.calendarContainer,"centerMost",!0),Ln.insertRule(`${zn},${Hn}${di}`,$n),t.calendarContainer.style.left=`${dn}px`,t.calendarContainer.style.right="auto"}}function Se(){let Re=null;for(let We=0;We<document.styleSheets.length;We++){let ht=document.styleSheets[We];try{ht.cssRules}catch(Ct){continue}Re=ht;break}return Re??oe()}function oe(){let Re=document.createElement("style");return document.head.appendChild(Re),Re.sheet}function be(){t.config.noCalendar||t.isMobile||(A(),El(),z())}function Te(){t._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(t.close,0):t.close()}function Oe(Re){Re.preventDefault(),Re.stopPropagation();let We=ol=>ol.classList&&ol.classList.contains("flatpickr-day")&&!ol.classList.contains("flatpickr-disabled")&&!ol.classList.contains("notAllowed"),ht=kg(lo(Re),We);if(ht===void 0)return;let Ct=ht,Lt=t.latestSelectedDateObj=new Date(Ct.dateObj.getTime()),Dt=(Lt.getMonth()<t.currentMonth||Lt.getMonth()>t.currentMonth+t.config.showMonths-1)&&t.config.mode!=="range";if(t.selectedDateElem=Ct,t.config.mode==="single")t.selectedDates=[Lt];else if(t.config.mode==="multiple"){let ol=At(Lt);ol?t.selectedDates.splice(parseInt(ol),1):t.selectedDates.push(Lt)}else t.config.mode==="range"&&(t.selectedDates.length===2&&t.clear(!1,!1),t.latestSelectedDateObj=Lt,t.selectedDates.push(Lt),ro(Lt,t.selectedDates[0],!0)!==0&&t.selectedDates.sort((ol,el)=>ol.getTime()-el.getTime()));if(d(),Dt){let ol=t.currentYear!==Lt.getFullYear();t.currentYear=Lt.getFullYear(),t.currentMonth=Lt.getMonth(),ol&&(Ke("onYearChange"),A()),Ke("onMonthChange")}if(El(),z(),Nr(),!Dt&&t.config.mode!=="range"&&t.config.showMonths===1?k(Ct):t.selectedDateElem!==void 0&&t.hourElement===void 0&&t.selectedDateElem&&t.selectedDateElem.focus(),t.hourElement!==void 0&&t.hourElement!==void 0&&t.hourElement.focus(),t.config.closeOnSelect){let ol=t.config.mode==="single"&&!t.config.enableTime,el=t.config.mode==="range"&&t.selectedDates.length===2&&!t.config.enableTime;(ol||el)&&Te()}x()}let Xe={locale:[xt,te],showMonths:[L,s,X],minDate:[S],maxDate:[S],clickOpens:[()=>{t.config.clickOpens===!0?(v(t._input,"focus",t.open),v(t._input,"click",t.open)):(t._input.removeEventListener("focus",t.open),t._input.removeEventListener("click",t.open))}]};function Le(Re,We){if(Re!==null&&typeof Re=="object"){Object.assign(t.config,Re);for(let ht in Re)Xe[ht]!==void 0&&Xe[ht].forEach(Ct=>Ct())}else t.config[Re]=We,Xe[Re]!==void 0?Xe[Re].forEach(ht=>ht()):Oh.indexOf(Re)>-1&&(t.config[Re]=Nh(We));t.redraw(),Nr(!0)}function Ee(Re,We){let ht=[];if(Re instanceof Array)ht=Re.map(Ct=>t.parseDate(Ct,We));else if(Re instanceof Date||typeof Re=="number")ht=[t.parseDate(Re,We)];else if(typeof Re=="string")switch(t.config.mode){case"single":case"time":ht=[t.parseDate(Re,We)];break;case"multiple":ht=Re.split(t.config.conjunction).map(Ct=>t.parseDate(Ct,We));break;case"range":ht=Re.split(t.l10n.rangeSeparator).map(Ct=>t.parseDate(Ct,We));break;default:break}else t.config.errorHandler(new Error(`Invalid date supplied: ${JSON.stringify(Re)}`));t.selectedDates=t.config.allowInvalidPreload?ht:ht.filter(Ct=>Ct instanceof Date&&ce(Ct,!1)),t.config.mode==="range"&&t.selectedDates.sort((Ct,Lt)=>Ct.getTime()-Lt.getTime())}function nt(Re,We=!1,ht=t.config.dateFormat){if(Re!==0&&!Re||Re instanceof Array&&Re.length===0)return t.clear(We);Ee(Re,ht),t.latestSelectedDateObj=t.selectedDates[t.selectedDates.length-1],t.redraw(),S(void 0,We),p(),t.selectedDates.length===0&&t.clear(!1),Nr(We),We&&Ke("onChange")}function Ze(Re){return Re.slice().map(We=>typeof We=="string"||typeof We=="number"||We instanceof Date?t.parseDate(We,void 0,!0):We&&typeof We=="object"&&We.from&&We.to?{from:t.parseDate(We.from,void 0),to:t.parseDate(We.to,void 0)}:We).filter(We=>We)}function ze(){t.selectedDates=[],t.now=t.parseDate(t.config.now)||new Date;let Re=t.config.defaultDate||((t.input.nodeName==="INPUT"||t.input.nodeName==="TEXTAREA")&&t.input.placeholder&&t.input.value===t.input.placeholder?null:t.input.value);Re&&Ee(Re,t.config.dateFormat),t._initialDate=t.selectedDates.length>0?t.selectedDates[0]:t.config.minDate&&t.config.minDate.getTime()>t.now.getTime()?t.config.minDate:t.config.maxDate&&t.config.maxDate.getTime()<t.now.getTime()?t.config.maxDate:t.now,t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth(),t.selectedDates.length>0&&(t.latestSelectedDateObj=t.selectedDates[0]),t.config.minTime!==void 0&&(t.config.minTime=t.parseDate(t.config.minTime,"H:i")),t.config.maxTime!==void 0&&(t.config.maxTime=t.parseDate(t.config.maxTime,"H:i")),t.minDateHasTime=!!t.config.minDate&&(t.config.minDate.getHours()>0||t.config.minDate.getMinutes()>0||t.config.minDate.getSeconds()>0),t.maxDateHasTime=!!t.config.maxDate&&(t.config.maxDate.getHours()>0||t.config.maxDate.getMinutes()>0||t.config.maxDate.getSeconds()>0)}function _e(){if(t.input=ot(),!t.input){t.config.errorHandler(new Error("Invalid input element specified"));return}t.input._type=t.input.type,t.input.type="text",t.input.classList.add("flatpickr-input"),t._input=t.input,t.config.altInput&&(t.altInput=zr(t.input.nodeName,t.config.altInputClass),t._input=t.altInput,t.altInput.placeholder=t.input.placeholder,t.altInput.disabled=t.input.disabled,t.altInput.required=t.input.required,t.altInput.tabIndex=t.input.tabIndex,t.altInput.type="text",t.input.setAttribute("type","hidden"),!t.config.static&&t.input.parentNode&&t.input.parentNode.insertBefore(t.altInput,t.input.nextSibling)),t.config.allowInput||t._input.setAttribute("readonly","readonly"),t._positionElement=t.config.positionElement||t._input}function Qe(){let Re=t.config.enableTime?t.config.noCalendar?"time":"datetime-local":"date";t.mobileInput=zr("input",t.input.className+" flatpickr-mobile"),t.mobileInput.tabIndex=1,t.mobileInput.type=Re,t.mobileInput.disabled=t.input.disabled,t.mobileInput.required=t.input.required,t.mobileInput.placeholder=t.input.placeholder,t.mobileFormatStr=Re==="datetime-local"?"Y-m-d\\TH:i:S":Re==="date"?"Y-m-d":"H:i:S",t.selectedDates.length>0&&(t.mobileInput.defaultValue=t.mobileInput.value=t.formatDate(t.selectedDates[0],t.mobileFormatStr)),t.config.minDate&&(t.mobileInput.min=t.formatDate(t.config.minDate,"Y-m-d")),t.config.maxDate&&(t.mobileInput.max=t.formatDate(t.config.maxDate,"Y-m-d")),t.input.getAttribute("step")&&(t.mobileInput.step=String(t.input.getAttribute("step"))),t.input.type="hidden",t.altInput!==void 0&&(t.altInput.type="hidden");try{t.input.parentNode&&t.input.parentNode.insertBefore(t.mobileInput,t.input.nextSibling)}catch(We){}v(t.mobileInput,"change",We=>{t.setDate(lo(We).value,!1,t.mobileFormatStr),Ke("onChange"),Ke("onClose")})}function Je(Re){if(t.isOpen===!0)return t.close();t.open(Re)}function Ke(Re,We){if(t.config===void 0)return;let ht=t.config[Re];if(ht!==void 0&&ht.length>0)for(let Ct=0;ht[Ct]&&Ct<ht.length;Ct++)ht[Ct](t.selectedDates,t.input.value,t,We);Re==="onChange"&&(t.input.dispatchEvent(gt("change")),t.input.dispatchEvent(gt("input")))}function gt(Re){let We=document.createEvent("Event");return We.initEvent(Re,!0,!0),We}function At(Re){for(let We=0;We<t.selectedDates.length;We++)if(ro(t.selectedDates[We],Re)===0)return""+We;return!1}function cl(Re){return t.config.mode!=="range"||t.selectedDates.length<2?!1:ro(Re,t.selectedDates[0])>=0&&ro(Re,t.selectedDates[1])<=0}function El(){t.config.noCalendar||t.isMobile||!t.monthNav||(t.yearElements.forEach((Re,We)=>{let ht=new Date(t.currentYear,t.currentMonth,1);ht.setMonth(t.currentMonth+We),t.config.showMonths>1||t.config.monthSelectorType==="static"?t.monthElements[We].textContent=vf(ht.getMonth(),t.config.shorthandCurrentMonth,t.l10n)+" ":t.monthsDropdownContainer.value=ht.getMonth().toString(),Re.value=ht.getFullYear().toString()}),t._hidePrevMonthArrow=t.config.minDate!==void 0&&(t.currentYear===t.config.minDate.getFullYear()?t.currentMonth<=t.config.minDate.getMonth():t.currentYear<t.config.minDate.getFullYear()),t._hideNextMonthArrow=t.config.maxDate!==void 0&&(t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth+1>t.config.maxDate.getMonth():t.currentYear>t.config.maxDate.getFullYear()))}function bl(Re){return t.selectedDates.map(We=>t.formatDate(We,Re)).filter((We,ht,Ct)=>t.config.mode!=="range"||t.config.enableTime||Ct.indexOf(We)===ht).join(t.config.mode!=="range"?t.config.conjunction:t.l10n.rangeSeparator)}function Nr(Re=!0){t.mobileInput!==void 0&&t.mobileFormatStr&&(t.mobileInput.value=t.latestSelectedDateObj!==void 0?t.formatDate(t.latestSelectedDateObj,t.mobileFormatStr):""),t.input.value=bl(t.config.dateFormat),t.altInput!==void 0&&(t.altInput.value=bl(t.config.altFormat)),Re!==!1&&Ke("onValueUpdate")}function li(Re){let We=lo(Re),ht=t.prevMonthNav.contains(We),Ct=t.nextMonthNav.contains(We);ht||Ct?pe(ht?-1:1):t.yearElements.indexOf(We)>=0?We.select():We.classList.contains("arrowUp")?t.changeYear(t.currentYear+1):We.classList.contains("arrowDown")&&t.changeYear(t.currentYear-1)}function on(Re){Re.preventDefault();let We=Re.type==="keydown",ht=lo(Re),Ct=ht;t.amPM!==void 0&&ht===t.amPM&&(t.amPM.textContent=t.l10n.amPM[to(t.amPM.textContent===t.l10n.amPM[0])]);let Lt=parseFloat(Ct.getAttribute("min")),Dt=parseFloat(Ct.getAttribute("max")),ol=parseFloat(Ct.getAttribute("step")),el=parseInt(Ct.value,10),Al=Re.delta||(We?Re.which===38?1:-1:0),Vl=el+ol*Al;if(typeof Ct.value!="undefined"&&Ct.value.length===2){let lr=Ct===t.hourElement,hn=Ct===t.minuteElement;Vl<Lt?(Vl=Dt+Vl+to(!lr)+(to(lr)&&to(!t.amPM)),hn&&P(void 0,-1,t.hourElement)):Vl>Dt&&(Vl=Ct===t.hourElement?Vl-Dt-to(!t.amPM):Lt,hn&&P(void 0,1,t.hourElement)),t.amPM&&lr&&(ol===1?Vl+el===23:Math.abs(Vl-el)>ol)&&(t.amPM.textContent=t.l10n.amPM[to(t.amPM.textContent===t.l10n.amPM[0])]),Ct.value=Ai(Vl)}}return o(),t}function du(e,n){let t=Array.prototype.slice.call(e).filter(o=>o instanceof HTMLElement),l=[];for(let o=0;o<t.length;o++){let a=t[o];try{if(a.getAttribute("data-fp-omit")!==null)continue;a._flatpickr!==void 0&&(a._flatpickr.destroy(),a._flatpickr=void 0),a._flatpickr=_3(a,n||{}),l.push(a._flatpickr)}catch(s){console.error(s)}}return l.length===1?l[0]:l}var import_plugin,x3,qn,jh,_g=Nt(()=>{import_plugin=qe(Ye());gg();pg();yg();I1();M1();wg();D1();x3=300;typeof HTMLElement!="undefined"&&typeof HTMLCollection!="undefined"&&typeof NodeList!="undefined"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return du(this,e)},HTMLElement.prototype.flatpickr=function(e){return du([this],e)});qn=function(e,n){return typeof e=="string"?du(window.document.querySelectorAll(e),n):e instanceof Node?du([e],n):du(e,n)};qn.defaultConfig={};qn.l10ns={en:Object.assign({},Eh),default:Object.assign({},Eh)};qn.localize=e=>{qn.l10ns.default=Object.assign(Object.assign({},qn.l10ns.default),e)};qn.setDefaults=e=>{qn.defaultConfig=Object.assign(Object.assign({},qn.defaultConfig),e)};qn.parseDate=Lh({});qn.formatDate=xg({});qn.compareDates=ro;typeof jQuery!="undefined"&&typeof jQuery.fn!="undefined"&&(jQuery.fn.flatpickr=function(e){return du(this,e)});Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof e=="string"?parseInt(e,10):e))};typeof window!="undefined"&&(window.flatpickr=qn);jh=qn});var import_plugin,Bh,C3,$3,A1,z1=Nt(()=>{import_plugin=qe(Ye());ln();Sr();il();_g();Bh=qe(Za());ui();mc();C3=e=>{let n=e.replace(/y/g,"Y");return n=n.replace(/d/g,"D"),n=n.replace(/h/g,"H"),n=n.replace(/\//g,"A"),n=n.replace(//g,"A"),n=n.replace(//g,"A"),n=n.replace(/AM\/PM/g,"A"),n=n.replace(/AM/g,"A"),n=n.replace(/PM/g,"A"),n=n.replace(/\"/g,""),n.includes("A")&&(n=n.replace(/H/g,"h")),n},$3={cellFocus:function(e,n,t){let l=h.visibledatarow[e],o=e==0?0:h.visibledatarow[e-1],a=h.visibledatacolumn[n],s=n==0?0:h.visibledatacolumn[n-1],u=_t.mergeborer(h.flowdata,e,n),f=t.ct.fa||"YYYY-MM-DD",m=Bl("yyyy-MM-dd hh:mm:ss",t.v),d=C3(f),p=!1,b=!1,g=!1,v=!0,x=!1;u&&(l=u.row[1],o=u.row[0],a=u.column[1],s=u.column[0]),$(".cell-date-picker").show().css({width:a-s+1,height:l-o+1,left:s,top:o}),/[]/.test(f)&&(x=!0),/[Hhms]/.test(d)&&(p=!0),/[YMD]/.test(d)||(b=!0),/s/.test(d)&&(g=!0),/A/.test(d)&&(v=!1);let _=jh("#luckysheet-input-box",{allowInput:!1,noCalendar:b,enableSeconds:g,enableTime:p,dateFormat:d,time_24hr:v,defaultDate:m,onClose(){setTimeout(()=>{_.destroy()},0)},parseDate:(S,I)=>(0,Bh.default)(S).toDate(),formatDate:(S,I,P)=>x?(0,Bh.default)(S).format(I).replace("AM","\u4E0A\u5348").replace("PM","\u4E0B\u5348"):(0,Bh.default)(S).format(I),onChange:function(S,I){let P=zm(new Date(S));$("#luckysheet-rich-text-editor").html(I),mu(e,n,P,{isRefresh:!1}),Cg(e,n,"ct",t.ct),p||y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1])}});$("#luckysheet-input-box").click()}},A1=$3});function ti(e,n,t,l,o){if(!Qa(e,n,h.currentSheetIndex)){$("#luckysheet-functionbox-cell").blur();return}if(at()||h.allowEdit===!1||!sl.createHookFunction("cellEditBefore",h.luckysheet_select_save))return;if(Ue.saveParam("mv",h.currentSheetIndex,{op:"enterEdit",range:h.luckysheet_select_save}),ll.dataVerification!=null&&ll.dataVerification[e+"_"+n]!=null){let O=ll.dataVerification[e+"_"+n];if(O.type=="dropdown")ll.dropdownListShow();else if(O.type=="checkbox")return}let a=P1(e,n,t),s=a.row,u=a.row_pre,f=a.col,m=a.col_pre,d=a.row_index,p=a.col_index;$("#luckysheet-dropCell-icon").is(":visible")&&$("#luckysheet-dropCell-icon").remove();let b=$(window).height(),g=$(window).width(),v=$("#"+h.container).offset(),x=$("#luckysheet-cell-main").scrollLeft(),_=$("#luckysheet-cell-main").scrollTop();if(Yt.isPivotRange(d,p))return;let S=m+v.left+h.rowHeaderWidth-x-2;Ie.freezenverticaldata!=null&&n<=Ie.freezenverticaldata[1]&&(S=m+v.left+h.rowHeaderWidth-2);let I=u+v.top+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight-_-2;Ie.freezenhorizontaldata!=null&&e<=Ie.freezenhorizontaldata[1]&&(I=u+v.top+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight-2);let P={"min-width":f-m+1-8,"min-height":s-u+1-4,"max-width":g+x-m-20-h.rowHeaderWidth,"max-height":b+_-u-20-15-h.toolbarHeight-h.infobarHeight-h.calculatebarHeight-h.sheetBarHeight-h.statisticBarHeight,left:S,top:I},F={transform:"scale("+h.zoomRatio+")","transform-origin":"left top",width:100/h.zoomRatio+"%",height:100/h.zoomRatio+"%"};h.luckysheetCellUpdate=[d,p],o||$("#luckysheet-rich-text-editor").focus().select(),$("#luckysheet-input-box").removeAttr("style").css({"background-color":"rgb(255, 255, 255)",padding:"0px 2px","font-size":"13px",right:"auto","overflow-y":"auto","box-sizing":"initial",display:"flex"}),(Ie.freezenverticaldata!=null||Ie.freezenhorizontaldata!=null)&&$("#luckysheet-input-box").css("z-index",10002),$("#luckysheet-input-box-index").html(yl(p)+(d+1)).hide(),$("#luckysheet-wa-functionbox-cancel, #luckysheet-wa-functionbox-confirm").addClass("luckysheet-wa-calculate-active");let D="",k=!1;if(t[d]!=null&&t[d][p]!=null){let O=t[d][p],z=O.ht,A="left",E="top";z=="0"?(P={"min-width":f-m+1-8,"min-height":s-u+1-4,"max-width":g*2/3,"max-height":b+_-u-20-15-h.toolbarHeight-h.infobarHeight-h.calculatebarHeight-h.sheetBarHeight-h.statisticBarHeight,left:m+v.left+h.rowHeaderWidth-x-2,top:u+v.top+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight-_-2},h.zoomRatio<1&&(A="center"),k=!0):z=="2"&&(P={"min-width":f-m+1-8,"min-height":s-u+1-4,"max-width":f+v.left-x-8,"max-height":b+_-u-20-15-h.toolbarHeight-h.infobarHeight-h.calculatebarHeight-h.sheetBarHeight-h.statisticBarHeight,right:g-(v.left+(h.rowHeaderWidth-1)-x)-f,top:u+v.top+h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight-_-2},h.zoomRatio<1&&(A="right")),O.vt=="0"?E="center":O.vt=="2"&&(E="bottom"),F["transform-origin"]=A+" "+E,l||(Wn(O)?D=Fy(d,p,t):O.f!=null?D=Vt(d,p,t,"f"):(D=Ka(d,p,t),O.qp=="1"&&(D=D&&""+D)));let L=_t.getStyleByCell(t,d,p);L=$("#luckysheet-input-box").get(0).style.cssText+L,$("#luckysheet-input-box").get(0).style.cssText=L,$("#luckysheet-input-box").get(0).style.backgroundColor=="rgba(0, 0, 0, 0)"&&($("#luckysheet-input-box").get(0).style.background="rgb(255,255,255)")}else{let O=Ur.getComputeMap();var w=Ur.checksAF(d,p,O),C=Mt.getComputeMap(),T=Mt.checksCF(d,p,C);T!=null&&T.cellColor!=null?$("#luckysheet-input-box").get(0).style.background=T.cellColor:w!=null&&($("#luckysheet-input-box").get(0).style.background=w[1])}if(P["min-height"]>P["max-height"]&&(P["min-height"]=P["max-height"]),P["min-width"]>P["max-width"]&&(P["min-width"]=P["max-width"]),D=y.xssDeal(D),!Ch(d,p,h.currentSheetIndex)&&D.length>0&&D.substr(0,63)=='<span dir="auto" class="luckysheet-formula-text-color">=</span>'?$("#luckysheet-rich-text-editor").html(""):(D=y.ltGtSignDeal(D),$("#luckysheet-rich-text-editor").html(D),o||To($("#luckysheet-rich-text-editor")[0])),k){let O=$("#luckysheet-input-box").width();O>P["max-width"]&&(O=P["max-width"]),O<P["min-width"]&&(O=P["min-width"]);let z=P.left-O/2+(f-m)/2;z<2&&(z=2),P.left=z-2}$("#luckysheet-input-box").css(P),$("#luckysheet-rich-text-editor").css(F),t[e][n]&&t[e][n].ct&&t[e][n].ct.t=="d"&&A1.cellFocus(e,n,t[e][n]),y.rangetosheet=h.currentSheetIndex,y.createRangeHightlight(),y.rangeResizeTo=$("#luckysheet-rich-text-editor"),Jr()}function O1(e,n,t){if(e==null||n==null)return;let l=t[e][n];if(l==null)return;let o=l.ht;if(l!=null&&o!="0")return;let a=P1(e,n,t),s=a.row,u=a.row_pre,f=a.col,m=a.col_pre,d=$(window).height(),p=$(window).width(),b=$("#"+h.container).offset(),g=$("#luckysheet-cell-main").scrollLeft(),v=$("#luckysheet-cell-main").scrollTop(),x={"min-width":f-m+1-8,"max-width":p*2/3,left:m+b.left+h.rowHeaderWidth-g-2},_=$("#luckysheet-input-box").width();_>x["max-width"]&&(_=x["max-width"]),_<x["min-width"]&&(_=x["min-width"]);let S=x.left-_/2+(f-m)/2;S<2&&(S=2),x.left=S-2,$("#luckysheet-input-box").css(x)}function P1(e,n,t){let l=h.visibledatarow[e],o=e-1==-1?0:h.visibledatarow[e-1],a=h.visibledatacolumn[n],s=n-1==-1?0:h.visibledatacolumn[n-1];t==null&&(t=h.flowdata);let u=_t.mergeborer(t,e,n);return u&&(l=u.row[1],o=u.row[0],e=u.row[2],a=u.column[1],s=u.column[0],n=u.column[2]),{row:l,row_pre:o,row_index:e,col:a,col_pre:s,col_index:n}}var import_plugin,gc=Nt(()=>{import_plugin=qe(Ye());_a();Di();ln();mo();Jc();z1();go();hi();Ol();cr();Er();ui();Sr();Ga();Jo();Ya();il();qr();wi()});var Ag={};kw(Ag,{cancelFrozen:()=>qh,cancelRangeMerge:()=>B1,changLang:()=>J5,checkTheStatusOfTheSelectedCells:()=>gu,clearCell:()=>I3,clearRange:()=>g5,closeWebsocket:()=>Q5,deleteCell:()=>T3,deleteColumn:()=>H3,deleteDataVerification:()=>U5,deleteImage:()=>Y5,deleteRange:()=>p5,deleteRangeConditionalFormat:()=>m5,deleteRow:()=>L3,deleteRowOrColumn:()=>Ig,enterEditMode:()=>M3,exitEditMode:()=>F3,find:()=>E1,frozenColumnRange:()=>L1,frozenFirstColumn:()=>Wh,frozenFirstRow:()=>Vh,frozenRowRange:()=>N1,getAllSheets:()=>V1,getCellValue:()=>S3,getColumnWidth:()=>Y3,getConfig:()=>B5,getDefaultColWidth:()=>Z3,getDefaultRowHeight:()=>X3,getImageOption:()=>X5,getLuckysheetfile:()=>W5,getRange:()=>H1,getRangeArray:()=>t5,getRangeAxis:()=>J3,getRangeBoolean:()=>n5,getRangeByTxt:()=>e_,getRangeDiagonal:()=>r5,getRangeHtml:()=>e5,getRangeJson:()=>l5,getRangeValue:()=>Q3,getRangeValuesWithFlatte:()=>K3,getRangeWithFlatten:()=>Fg,getRowHeight:()=>G3,getScreenshot:()=>O5,getSheet:()=>H5,getSheetData:()=>j5,getTxtByRange:()=>t_,getWorkbookName:()=>E5,hideColumn:()=>V3,hideGridLines:()=>M5,hideRow:()=>j3,hideRowOrColumn:()=>Tg,insertColumn:()=>E3,insertColumnRight:()=>N3,insertImage:()=>G5,insertRow:()=>O3,insertRowBottom:()=>P3,insertRowBottomOrColumnRight:()=>Sg,insertRowOrColumn:()=>$g,matrixCalculation:()=>y5,matrixOperation:()=>v5,pagerInit:()=>Mg,redo:()=>L5,refresh:()=>D5,refreshFormula:()=>l_,refreshMenuButtonFocus:()=>Dg,replace:()=>R3,resize:()=>z5,scroll:()=>A5,setBothFrozen:()=>z3,setCellFormat:()=>Cg,setCellValue:()=>mu,setColumnWidth:()=>U3,setConfig:()=>V5,setDataVerification:()=>q5,setHorizontalFrozen:()=>D3,setRangeConditionalFormat:()=>d5,setRangeConditionalFormatDefault:()=>h5,setRangeFilter:()=>s5,setRangeFormat:()=>a5,setRangeMerge:()=>c5,setRangeShow:()=>i5,setRangeSort:()=>u5,setRangeSortMulti:()=>f5,setRangeValue:()=>o5,setRowHeight:()=>q3,setSheetActive:()=>C5,setSheetAdd:()=>k5,setSheetColor:()=>S5,setSheetCopy:()=>w5,setSheetDelete:()=>b5,setSheetHide:()=>x5,setSheetMove:()=>I5,setSheetName:()=>$5,setSheetOrder:()=>T5,setSheetShow:()=>_5,setSheetZoom:()=>R5,setSingleRangeFormat:()=>j1,setVerticalFrozen:()=>A3,setWorkbookName:()=>P5,showColumn:()=>W3,showGridLines:()=>F5,showRow:()=>B3,showRowOrColumn:()=>Rg,toJson:()=>Uh,transToCellData:()=>Z5,transToData:()=>K5,undo:()=>N5,updataSheet:()=>r_});function S3(e,n,t={}){if(!K(e)||!K(n))return ke.info("Arguments row or column cannot be null or undefined.","");let l=Me(h.currentSheetIndex),{type:o="v",order:a=l}={...t},u=h.luckysheetfile[a].data[e][n],f;if(G(u)=="object"){if(f=u[o],o=="f"&&f!=null)f=y.functionHTMLGenerate(f);else if(o=="f")f=u.v;else if(u&&u.ct){if(u.ct.fa=="yyyy-MM-dd")f=u.m;else if(u.ct.hasOwnProperty("t")&&u.ct.t==="inlineStr"){let m=u.ct.s;m&&(f=m.map(d=>d.v).join(""))}}}return f==null&&(f=null),f}function mu(e,n,t,l={}){let o=h.flowdata[e][n],a=JSON.stringify(o);if(!K(e)||!K(n))return ke.info("The row or column parameter is invalid.","");let{order:s=Me(h.currentSheetIndex),isRefresh:u=!0,success:f}={...l},m=h.luckysheetfile[s];if(m==null)return ke.info("The order parameter is invalid.","");if(!sl.createHookFunction("cellUpdateBefore",e,n,t,u))return;let d=m.data;u&&(d=$.extend(!0,[],m.data)),d.length==0&&(d=kt.buildGridData(m));let p={bg:1,ff:1,fc:1,bl:1,it:1,fs:1,cl:1,un:1,vt:1,ht:1,mc:1,tr:1,tb:1,rt:1,qp:1};if(t==null||t.toString().length==0)y.delFunctionGroup(e,n),kr(e,n,d,t);else if(t instanceof Object){let b={};ft(d[e][n])&&(d[e][n]={});let g=d[e][n];t.f!=null&&t.v==null?(b.f=t.f,t.ct!=null&&(b.ct=t.ct),d=y.updatecell(e,n,b,!1).data):(t.ct!=null&&(b.ct=t.ct),t.f!=null&&(b.f=t.f),t.v!=null?b.v=t.v:b.v=g.v,t.m!=null&&(b.m=t.m),y.delFunctionGroup(e,n),kr(e,n,d,b));for(let v in t){let x=t[v];v in p?_t.updateFormatCell(d,v,x,e,e,n,n):g[v]=x}d[e][n]=g}else t.toString().substr(0,1)=="="||t.toString().substr(0,5)=="<span"?d=y.updatecell(e,n,t,!1).data:(y.delFunctionGroup(e,n),kr(e,n,d,t));setTimeout(()=>{sl.createHookFunction("cellUpdated",e,n,JSON.parse(a),h.flowdata[e][n],u)},0),m.index==h.currentSheetIndex&&u?al(d,[{row:[e,e],column:[n,n]}]):m.data=d,f&&typeof f=="function"&&f(d)}function I3(e,n,t={}){if(!K(e)||!K(n))return ke.info("Arguments row and column cannot be null or undefined.","");let l=Me(h.currentSheetIndex),{order:o=l,success:a}={...t},s=$.extend(!0,[],h.luckysheetfile[o].data),u=s[e][n];G(u)=="object"?(delete u.m,delete u.v,u.f!=null&&(delete u.f,y.delFunctionGroup(e,n,o),delete u.spl)):u=null,o===l?al(s,[{row:[e,e],column:[n,n]}]):h.luckysheetfile[o].data=s,a&&typeof a=="function"&&a(u)}function T3(e,n,t,l={}){if(!e||["left","up"].indexOf(e)<0)return ke.info("Arguments move cannot be null or undefined and its value must be 'left' or 'up'","");if(!K(n)||!K(t))return ke.info("Arguments row and column cannot be null or undefined.","");let a=Me(h.currentSheetIndex),{order:s=a,success:u}={...l},f="move"+e.replace(e[0],e[0].toUpperCase()),m;s&&h.luckysheetfile[s]&&(m=h.luckysheetfile[s].index),ac(f,n,n,t,t,m),u&&typeof u=="function"&&u()}function Cg(e,n,t,l,o={}){if(!K(e)||!K(n))return ke.info("Arguments row or column cannot be null or undefined.","");if(!t)return ke.info("Arguments attr cannot be null or undefined.","");let a=Me(h.currentSheetIndex),{order:s=a,success:u}={...o},f=h.luckysheetfile[s];if(f==null)return ke.info("The order parameter is invalid.","");let m=$.extend(!0,[],f.data);m.length==0&&(m=kt.buildGridData(f));let d=m[e][n]||{},p=$.extend(!0,{},f.config);if(t=="ct"&&(!l||!l.hasOwnProperty("fa")||!l.hasOwnProperty("t")))return new TypeError("While set attribute 'ct' to cell, the value must have property 'fa' and 't'");if(t=="bd"){p.borderInfo==null&&(p.borderInfo=[]);let b={rangeType:"range",borderType:"border-all",color:"#000",style:"1",range:[{column:[n,n],row:[e,e]}],...l};p.borderInfo.push(b)}else d[t]=l;m[e][n]=d,f.index==h.currentSheetIndex?(f.config=p,h.config=p,al(m,[{row:[e,e],column:[n,n]}])):(f.config=p,f.data=m),u&&typeof u=="function"&&u(d)}function E1(e,n={}){if(!e&&e!=0)return ke.info("Search content cannot be null or empty","");let t=Me(h.currentSheetIndex),{isRegularExpression:l=!1,isWholeWord:o=!1,isCaseSensitive:a=!1,order:s=t,type:u="m"}={...n},f=h.luckysheetfile[s].data,m=[];for(let d=0;d<f.length;d++){let p=f[d];for(let b=0;b<p.length;b++){let g=p[b];if(!!g)if(g.row=d,g.column=b,o)a?e.toString()==g[u]&&m.push(g):g[u]&&e.toString().toLowerCase()==g[u].toLowerCase()&&m.push(g);else if(l){let v;a?v=new RegExp(q.getRegExpStr(e),"g"):v=new RegExp(q.getRegExpStr(e),"ig"),v.test(g[u])&&m.push(g)}else a?new RegExp(q.getRegExpStr(e),"g").test(g[u])&&m.push(g):new RegExp(q.getRegExpStr(e),"ig").test(g[u])&&m.push(g)}}return m}function R3(e,n,t={}){let l=E1(e,t),o=Me(h.currentSheetIndex),{order:a=o}={...t},s=h.luckysheetfile[a];if(s==null)return ke.info("The order parameter is invalid.","");let u=$.extend(!0,[],s.data);l.forEach(m=>{m.m=n,mu(m.row,m.column,n,{order:a,isRefresh:!1})});let f=$.extend(!0,[],s.data);return s.data.length=0,s.data.push(...u),s.index==h.currentSheetIndex&&al(f,void 0,void 0,!0,!1),Xt(),t.success&&typeof t.success=="function"&&t.success(l),l}function F3(e={}){parseInt($("#luckysheet-input-box").css("top"))>0&&($("#luckysheet-formula-search-c").is(":visible")&&y.searchFunctionCell!=null?y.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_select_save=[{row:[h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[0]],column:[h.luckysheetCellUpdate[1],h.luckysheetCellUpdate[1]],row_focus:h.luckysheetCellUpdate[0],column_focus:h.luckysheetCellUpdate[1]}]),$("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide()),e.success&&typeof e.success=="function"&&e.success()}function M3(e={}){if(!$("#luckysheet-conditionformat-dialog").is(":visible")){if($("#luckysheet-cell-selected").is(":visible")){let n=h.luckysheet_select_save[h.luckysheet_select_save.length-1],t=n.row_focus,l=n.column_focus;ti(t,l,h.flowdata)}e.success&&typeof e.success=="function"&&e.success()}}function Vh(e){if(Ie.saveFrozen("freezenRow",e),!e||e==Me(h.currentSheetIndex)){let n,t,l;if(Ie.freezenRealFirstRowColumn){let o=0;l=h.visibledatarow[o]-2+h.columnHeaderHeight,n=[h.visibledatarow[o],o+1,0,Ie.cutVolumn(h.visibledatarow,o+1),l]}else{let o=$("#luckysheet-cell-main").scrollTop();t=$l(h.visibledatarow,o),t==-1&&(t=0),l=h.visibledatarow[t]-2-o+h.columnHeaderHeight,n=[h.visibledatarow[t],t+1,o,Ie.cutVolumn(h.visibledatarow,t+1),l]}Ie.saveFreezen(n,l,null,null),Ie.freezenverticaldata!=null&&(Ie.cancelFreezenVertical(),Ie.createAssistCanvas(),Xt()),Ie.createFreezenHorizontal(n,l),Ie.createAssistCanvas(),Xt()}}function Wh(e){if(Ie.saveFrozen("freezenColumn",e),!e||e==Me(h.currentSheetIndex)){let n,t,l;if(Ie.freezenRealFirstRowColumn)t=0,l=h.visibledatacolumn[t]-2+h.rowHeaderWidth,n=[h.visibledatacolumn[t],t+1,0,Ie.cutVolumn(h.visibledatacolumn,t+1),l];else{let o=$("#luckysheet-cell-main").scrollLeft();t=$l(h.visibledatacolumn,o),t==-1&&(t=0),l=h.visibledatacolumn[t]-2-o+h.rowHeaderWidth,n=[h.visibledatacolumn[t],t+1,o,Ie.cutVolumn(h.visibledatacolumn,t+1),l]}Ie.saveFreezen(null,null,n,l),Ie.freezenhorizontaldata!=null&&(Ie.cancelFreezenHorizontal(),Ie.createAssistCanvas(),Xt()),Ie.createFreezenVertical(n,l),Ie.createAssistCanvas(),Xt()}}function N1(e,n){let t=Be().freezen;if(!e||!e.hasOwnProperty("row_focus")&&!y.iscelldata(e)){at()?alert(t.noSeletionError):ke.info(t.noSeletionError,"");return}if(typeof e=="string"&&y.iscelldata(e)&&(e=y.getcellrange(e),e={row_focus:e.row[0],column_focus:e.column[0]}),Ie.saveFrozen("freezenRowRange",n,e),!n||n==Me(h.currentSheetIndex)){let l=$("#luckysheet-cell-main").scrollTop(),o=$l(h.visibledatarow,l),a=e.row_focus;a>o&&(o=a),o==-1&&(o=0);let s=h.visibledatarow[o]-2-l+h.columnHeaderHeight,u=[h.visibledatarow[o],o+1,l,Ie.cutVolumn(h.visibledatarow,o+1),s];Ie.saveFreezen(u,s,null,null),Ie.freezenverticaldata!=null&&(Ie.cancelFreezenVertical(),Ie.createAssistCanvas(),Xt()),Ie.createFreezenHorizontal(u,s),Ie.createAssistCanvas(),Xt()}}function L1(e,n){let t=Be().freezen,l=typeof e=="string"&&y.iscelldata(e);if(!e||!e.hasOwnProperty("column_focus")&&!l){at()?alert(t.noSeletionError):ke.info(t.noSeletionError,"");return}if(l&&(e=y.getcellrange(e),e={row_focus:e.row[0],column_focus:e.column[0]}),Ie.saveFrozen("freezenColumnRange",n,e),!n||n==Me(h.currentSheetIndex)){let o=$("#luckysheet-cell-main").scrollLeft(),a=$l(h.visibledatacolumn,o),s=e.column_focus;s>a&&(a=s),a==-1&&(a=0);let u=h.visibledatacolumn[a]-2-o+h.rowHeaderWidth,f=[h.visibledatacolumn[a],a+1,o,Ie.cutVolumn(h.visibledatacolumn,a+1),u];Ie.saveFreezen(null,null,f,u),Ie.freezenhorizontaldata!=null&&(Ie.cancelFreezenHorizontal(),Ie.createAssistCanvas(),Xt()),Ie.createFreezenVertical(f,u),Ie.createAssistCanvas(),Xt()}}function qh(e){Ie.saveFrozen("freezenCancel",e),(!e||e==Me(h.currentSheetIndex))&&(Ie.freezenverticaldata!=null&&Ie.cancelFreezenVertical(),Ie.freezenhorizontaldata!=null&&Ie.cancelFreezenHorizontal(),Ie.createAssistCanvas(),Xt())}function D3(e,n={}){let t=Me(h.currentSheetIndex),{range:l,order:o=t,success:a}={...n};qh(o),e?N1(l,o):Vh(o),a&&typeof a=="function"&&a()}function A3(e,n={}){let t=Me(h.currentSheetIndex),{range:l,order:o=t,success:a}={...n};qh(o),e?L1(l,o):Wh(o),a&&typeof a=="function"&&a()}function z3(e,n={}){let t=Me(h.currentSheetIndex),{range:l,order:o=t,success:a}={...n},s=!o||o==Me(h.currentSheetIndex),u=Be().freezen;if(qh(o),e){Ie.saveFrozen("freezenRCRange",o,l);let f=typeof l=="string"&&y.iscelldata(l);if(s){if((!l||!(l.hasOwnProperty("column_focus")&&l.hasOwnProperty("row_focus")))&&!f){at()?alert(u.noSeletionError):ke.info(u.noSeletionError,"");return}f&&(l=y.getcellrange(l),l={row_focus:l.row[0],column_focus:l.column[0]});let m=$("#luckysheet-cell-main").scrollTop(),d=$l(h.visibledatarow,m),p=l.row_focus;p>d&&(d=p),d==-1&&(d=0);let b=h.visibledatarow[d]-2-m+h.columnHeaderHeight,g=[h.visibledatarow[d],d+1,m,Ie.cutVolumn(h.visibledatarow,d+1),b];Ie.saveFreezen(g,b,null,null),Ie.createFreezenHorizontal(g,b);let v=$("#luckysheet-cell-main").scrollLeft(),x=$l(h.visibledatacolumn,v),_=l.column_focus;_>x&&(x=_),x==-1&&(x=0);let S=h.visibledatacolumn[x]-2-v+h.rowHeaderWidth,I=[h.visibledatacolumn[x],x+1,v,Ie.cutVolumn(h.visibledatacolumn,x+1),S];Ie.saveFreezen(null,null,I,S),Ie.createFreezenVertical(I,S),Ie.createAssistCanvas(),Xt()}}else if(Ie.saveFrozen("freezenRC",o),s){let f=$("#luckysheet-cell-main").scrollTop(),m=$l(h.visibledatarow,f);m==-1&&(m=0);let d=h.visibledatarow[m]-2-f+h.columnHeaderHeight,p=[h.visibledatarow[m],m+1,f,Ie.cutVolumn(h.visibledatarow,m+1),d];Ie.saveFreezen(p,d,null,null),Ie.createFreezenHorizontal(p,d);let b=$("#luckysheet-cell-main").scrollLeft(),g=$l(h.visibledatacolumn,b);g==-1&&(g=0);let v=h.visibledatacolumn[g]-2-b+h.rowHeaderWidth,x=[h.visibledatacolumn[g],g+1,b,Ie.cutVolumn(h.visibledatacolumn,g+1),v];Ie.saveFreezen(null,null,x,v),Ie.createFreezenVertical(x,v),Ie.createAssistCanvas(),Xt()}}function $g(e,n=0,t={}){if(!K(n))return ke.info("The index parameter is invalid.","");let l=Me(h.currentSheetIndex),{number:o=1,order:a=l,success:s}={...t},f=Be().info;if(!K(o)){at()?alert(f.tipInputNumber):ke.info(f.tipInputNumber,"");return}if(o=parseInt(o),o<1||o>100){at()?alert(f.tipInputNumberLimit):ke.info(f.tipInputNumberLimit,"");return}let m;a&&h.luckysheetfile[a]&&(m=h.luckysheetfile[a].index),Ao(e,n,o,"lefttop",m),s&&typeof s=="function"&&s()}function Sg(e,n=0,t={}){if(!K(n))return ke.info("The index parameter is invalid.","");let l=Me(h.currentSheetIndex),{number:o=1,order:a=l,success:s}={...t},f=Be().info;if(!K(o)){at()?alert(f.tipInputNumber):ke.info(f.tipInputNumber,"");return}if(o=parseInt(o),o<1||o>100){at()?alert(f.tipInputNumberLimit):ke.info(f.tipInputNumberLimit,"");return}let m;a&&h.luckysheetfile[a]&&(m=h.luckysheetfile[a].index),Ao(e,n,o,"rightbottom",m),s&&typeof s=="function"&&s()}function O3(e=0,n={}){$g("row",e,n)}function P3(e=0,n={}){Sg("row",e,n)}function E3(e=0,n={}){$g("column",e,n)}function N3(e=0,n={}){Sg("column",e,n)}function Ig(e,n,t,l={}){if(!K(n)||!K(t))return ke.info("Please enter the index for deleting rows or columns correctly.","");let o=Me(h.currentSheetIndex),{order:a=o,success:s}={...l},u;a&&h.luckysheetfile[a]&&(u=h.luckysheetfile[a].index),Ts(e,n,t,u),s&&typeof s=="function"&&s()}function L3(e,n,t={}){Ig("row",e,n,t)}function H3(e,n,t={}){Ig("column",e,n,t)}function Tg(e,n,t,l={}){if(!K(n)||!K(t))return ke.info("Please enter the index for deleting rows or columns correctly.","");let o=Me(h.currentSheetIndex),{order:a=o,saveParam:s=!0,success:u}={...l},f=h.luckysheetfile[a],m=e==="row"?"rowhidden":"colhidden",d=$.extend(!0,{},f.config);d[m]==null&&(d[m]={});for(let p=n;p<=t;p++)d[m][p]=0;if(h.clearjfundo){let p={};p.type=e==="row"?"showHidRows":"showHidCols",p.sheetIndex=f.index,p.config=$.extend(!0,{},f.config),p.curconfig=d,h.jfundo.length=0,h.jfredo.push(p)}h.luckysheetfile[a].config=d,s&&Ue.saveParam("cg",f.index,d[m],{k:m}),a==o&&(h.config=d,tr(h.flowdata.length,h.flowdata[0].length)),u&&typeof u=="function"&&u()}function Rg(e,n,t,l={}){if(!K(n)||!K(t))return ke.info("Please enter the index for deleting rows or columns correctly.","");let o=Me(h.currentSheetIndex),{order:a=o,saveParam:s=!0,success:u}={...l},f=h.luckysheetfile[a],m=e==="row"?"rowhidden":"colhidden",d=$.extend(!0,{},f.config);if(d[m]!=null){for(let p=n;p<=t;p++)delete d[m][p];if(h.clearjfundo){let p={};p.type=e==="row"?"showHidRows":"showHidCols",p.sheetIndex=f.index,p.config=$.extend(!0,{},f.config),p.curconfig=d,h.jfundo.length=0,h.jfredo.push(p)}h.luckysheetfile[a].config=h.config,s&&Ue.saveParam("cg",f.index,d[m],{k:m}),a===o&&(h.config=d,tr(h.flowdata.length,h.flowdata[0].length)),u&&typeof u=="function"&&u()}}function j3(e,n,t={}){Tg("row",e,n,t)}function B3(e,n,t={}){Rg("row",e,n,t)}function V3(e,n,t={}){Tg("column",e,n,t)}function W3(e,n,t={}){Rg("column",e,n,t)}function q3(e,n={}){if(G(e)!="object")return ke.info("The rowInfo parameter is invalid.","");let{order:t=Me(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config);a.rowlen==null&&(a.rowlen={});for(let s in e)if(parseInt(s)>=0){let u=e[s];u==="auto"?a.rowlen[parseInt(s)]=u:Number(u)>=0&&(a.rowlen[parseInt(s)]=Number(u))}o.config=a,Ue.saveParam("cg",o.index,a.rowlen,{k:"rowlen"}),o.index==h.currentSheetIndex&&(h.config=a,tr(h.flowdata.length,h.flowdata[0].length)),l&&typeof l=="function"&&l()}function U3(e,n={}){if(G(e)!="object")return ke.info("The columnInfo parameter is invalid.","");let{order:t=Me(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config);a.columnlen==null&&(a.columnlen={});for(let s in e)if(parseInt(s)>=0){let u=e[s];u==="auto"?a.columnlen[parseInt(s)]=u:Number(u)>=0&&(a.columnlen[parseInt(s)]=Number(u))}o.config=a,Ue.saveParam("cg",o.index,a.columnlen,{k:"columnlen"}),o.index==h.currentSheetIndex&&(h.config=a,tr(h.flowdata.length,h.flowdata[0].length)),l&&typeof l=="function"&&l()}function G3(e,n={}){if(G(e)!="array"||e.length==0)return ke.info("The rowInfo parameter is invalid.","");let{order:t=Me(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");let s=$.extend(!0,{},o.config).rowlen||{},u={};return e.forEach(f=>{if(parseInt(f)>=0){let m=s[parseInt(f)]||h.defaultrowlen;u[parseInt(f)]=m}}),setTimeout(()=>{l&&typeof l=="function"&&l()},1),u}function Y3(e,n={}){if(G(e)!="array"||e.length==0)return ke.info("The columnInfo parameter is invalid.","");let{order:t=Me(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");let s=$.extend(!0,{},o.config).columnlen||{},u={};return e.forEach(f=>{if(parseInt(f)>=0){let m=s[parseInt(f)]||h.defaultcollen;u[parseInt(f)]=m}}),setTimeout(()=>{l&&typeof l=="function"&&l()},1),u}function X3(e={}){let{order:n=Me(h.currentSheetIndex),success:t}={...e};return setTimeout(()=>{t&&typeof t=="function"&&t()},1),h.luckysheetfile[n].defaultRowHeight||h.defaultrowlen}function Z3(e={}){let{order:n=Me(h.currentSheetIndex),success:t}={...e};return setTimeout(()=>{t&&typeof t=="function"&&t()},1),h.luckysheetfile[n].defaultColWidth||h.defaultcollen}function H1(){let e=JSON.parse(JSON.stringify(h.luckysheet_select_save)),n=[];for(let t=0;t<e.length;t++){let l=e[t],o={row:l.row,column:l.column};n.push(o)}return n}function Fg(e){e=e||H1();let n=[];return e.forEach(t=>{let l=t.row,o=t.column;for(let a=l[0];a<=l[1];a++)for(let s=o[0];s<=o[1];s++)n.push({r:a,c:s})}),n}function K3(e){e=e||Fg();let n=[];return e.forEach(t=>{n.push(h.flowdata[t.r][t.c])}),n}function J3(){let e=[],n=JSON.parse(JSON.stringify(h.luckysheet_select_save)),t=h.currentSheetIndex;return n.forEach(l=>{let o=Kl(t,{column:l.column,row:l.row});e.push(o)}),e}function Q3(e={}){let n=Me(h.currentSheetIndex),{range:t,order:l=n}={...e},o=h.luckysheetfile[l];if(!t||typeof t=="object")return hr(t,o.index);if(typeof t=="string"){if(y.iscelldata(t))return hr(y.getcellrange(t),o.index);ke.info("The range is invalid, please check range parameter.","")}}function e5(e={}){let{range:n=h.luckysheet_select_save,order:t=Me(h.currentSheetIndex),success:l}={...e};if(n=JSON.parse(JSON.stringify(n)),G(n)=="string"){if(!y.iscelldata(n))return ke.info("The range parameter is invalid.","");let g=y.getcellrange(n);n=[{row:g.row,column:g.column}]}else if(G(n)=="object"){if(n.row==null||n.column==null)return ke.info("The range parameter is invalid.","");n=[{row:n.row,column:n.column}]}if(G(n)!="array")return ke.info("The range parameter is invalid.","");let o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config);if(a.merge!=null){let g=!1;for(let v=0;v<n.length;v++){let x=n[v].row[0],_=n[v].row[1],S=n[v].column[0],I=n[v].column[1];if(g=sr(a,x,_,S,I),g)break}if(g)return ke.info("Cannot perform this operation on partially merged cells","")}let s=$.extend(!0,[],o.luckysheet_conditionformat_save);if(n.length>1&&s.length>0){let g=!1,v=Mt.getComputeMap(o.index);for(let x=0;x<n.length;x++){let _=n[x].row[0],S=n[x].row[1],I=n[x].column[0],P=n[x].column[1];for(let F=_;F<=S;F++){for(let D=I;D<=P;D++)if(Mt.checksCF(F,D,v)!=null){g=!0;break}if(g)break}if(g)break}if(g)return ke.info("Cannot perform this operation on multiple selection areas, please select a single area","")}if(n.length>1){let g=!0,v=n[0].row[0],x=n[0].row[1],_=!0,S=n[0].column[0],I=n[0].column[1];for(let P=1;P<n.length;P++)(n[P].row[0]!=v||n[P].row[1]!=x)&&(g=!1),(n[P].column[0]!=S||n[P].column[1]!=I)&&(_=!1);if(!g&&!_||na(n))return ke.info("Cannot perform this operation on multiple selection areas, please select a single area","")}let u=[],f=[];for(let g=0;g<n.length;g++){let v=n[g].row[0],x=n[g].row[1],_=n[g].column[0],S=n[g].column[1];for(let I=v;I<=x;I++)if(!(a.rowhidden!=null&&a.rowhidden[I]!=null)){u.includes(I)||u.push(I);for(let P=_;P<=S;P++)a.colhidden!=null&&a.colhidden[P]!=null||f.includes(P)||f.push(P)}}let m;a.borderInfo&&a.borderInfo.length>0&&(m=la(o.index));let d=o.data;(d==null||d.length==0)&&(d=kt.buildGridData(o));let p="",b="";u=u.sort((g,v)=>g-v),f=f.sort((g,v)=>g-v);for(let g=0;g<u.length;g++){let v=u[g];if(!(a.rowhidden!=null&&a.rowhidden[v]!=null)){p+="<tr>";for(let x=0;x<f.length;x++){let _=f[x];if(a.colhidden!=null&&a.colhidden[_]!=null)continue;let S='<td ${span} style="${style}">';if(d[v]!=null&&d[v][_]!=null){let I="",P="";v==u[0]&&(a.columnlen==null||a.columnlen[_.toString()]==null?b+='<colgroup width="72px"></colgroup>':b+='<colgroup width="'+a.columnlen[_.toString()]+'px"></colgroup>'),_==f[0]&&(a.rowlen==null||a.rowlen[v.toString()]==null?I+="height:19px;":I+="height:"+a.rowlen[v.toString()]+"px;");let F=/^(w|W)((0?)|(0\.0+))$/,D;if(d[v][_].ct!=null&&d[v][_].ct.fa!=null&&d[v][_].ct.fa.match(F)?D=Vt(v,_,d):D=Vt(v,_,d,"m"),I+=_t.getStyleByCell(d,v,_),G(d[v][_])=="object"&&"mc"in d[v][_])if("rs"in d[v][_].mc){if(P='rowspan="'+d[v][_].mc.rs+'" colspan="'+d[v][_].mc.cs+'"',m&&m[v+"_"+_]){let k={color:{},style:{}},w={color:{},style:{}},C={color:{},style:{}},T={color:{},style:{}};for(let A=v;A<v+d[v][_].mc.rs;A++)for(let E=_;E<_+d[v][_].mc.cs;E++){if(A==v&&m[A+"_"+E]&&m[A+"_"+E].t){let L=m[A+"_"+E].t.style,N=m[A+"_"+E].t.color;C.style[L]==null?C.style[L]=1:C.style[L]=C.style[L]+1,C.color[N]==null?C.color[N]=1:C.color[N]=C.color[N]+1}if(A==v+d[v][_].mc.rs-1&&m[A+"_"+E]&&m[A+"_"+E].b){let L=m[A+"_"+E].b.style,N=m[A+"_"+E].b.color;T.style[L]==null?T.style[L]=1:T.style[L]=T.style[L]+1,T.color[N]==null?T.color[N]=1:T.color[N]=T.color[N]+1}if(E==_&&m[A+"_"+E]&&m[A+"_"+E].l){let L=m[v+"_"+_].l.style,N=m[A+"_"+E].l.color;k.style[L]==null?k.style[L]=1:k.style[L]=k.style[L]+1,k.color[N]==null?k.color[N]=1:k.color[N]=k.color[N]+1}if(E==_+d[v][_].mc.cs-1&&m[A+"_"+E]&&m[A+"_"+E].r){let L=m[A+"_"+E].r.style,N=m[A+"_"+E].r.color;w.style[L]==null?w.style[L]=1:w.style[L]=w.style[L]+1,w.color[N]==null?w.color[N]=1:w.color[N]=w.color[N]+1}}let O=d[v][_].mc.rs,z=d[v][_].mc.cs;if(JSON.stringify(k).length>23){let A=null,E=null;for(let L in k.color)k.color[L]>=O/2&&(A=L);for(let L in k.style)k.style[L]>=O/2&&(E=L);A!=null&&E!=null&&(I+="border-left:"+Ql.getHtmlBorderStyle(E,A))}if(JSON.stringify(w).length>23){let A=null,E=null;for(let L in w.color)w.color[L]>=O/2&&(A=L);for(let L in w.style)w.style[L]>=O/2&&(E=L);A!=null&&E!=null&&(I+="border-right:"+Ql.getHtmlBorderStyle(E,A))}if(JSON.stringify(C).length>23){let A=null,E=null;for(let L in C.color)C.color[L]>=z/2&&(A=L);for(let L in C.style)C.style[L]>=z/2&&(E=L);A!=null&&E!=null&&(I+="border-top:"+Ql.getHtmlBorderStyle(E,A))}if(JSON.stringify(T).length>23){let A=null,E=null;for(let L in T.color)T.color[L]>=z/2&&(A=L);for(let L in T.style)T.style[L]>=z/2&&(E=L);A!=null&&E!=null&&(I+="border-bottom:"+Ql.getHtmlBorderStyle(E,A))}}}else continue;else if(m&&m[v+"_"+_]){if(m[v+"_"+_].l){let k=m[v+"_"+_].l.style,w=m[v+"_"+_].l.color;I+="border-left:"+Ql.getHtmlBorderStyle(k,w)}if(m[v+"_"+_].r){let k=m[v+"_"+_].r.style,w=m[v+"_"+_].r.color;I+="border-right:"+Ql.getHtmlBorderStyle(k,w)}if(m[v+"_"+_].b){let k=m[v+"_"+_].b.style,w=m[v+"_"+_].b.color;I+="border-bottom:"+Ql.getHtmlBorderStyle(k,w)}if(m[v+"_"+_].t){let k=m[v+"_"+_].t.style,w=m[v+"_"+_].t.color;I+="border-top:"+Ql.getHtmlBorderStyle(k,w)}}S=Tt(S,{style:I,span:P}),D==null&&(D=Vt(v,_,d)),D==null&&(D=" "),S+=D}else{let I="";if(m&&m[v+"_"+_]){if(m[v+"_"+_].l){let P=m[v+"_"+_].l.style,F=m[v+"_"+_].l.color;I+="border-left:"+Ql.getHtmlBorderStyle(P,F)}if(m[v+"_"+_].r){let P=m[v+"_"+_].r.style,F=m[v+"_"+_].r.color;I+="border-right:"+Ql.getHtmlBorderStyle(P,F)}if(m[v+"_"+_].b){let P=m[v+"_"+_].b.style,F=m[v+"_"+_].b.color;I+="border-bottom:"+Ql.getHtmlBorderStyle(P,F)}if(m[v+"_"+_].t){let P=m[v+"_"+_].t.style,F=m[v+"_"+_].t.color;I+="border-top:"+Ql.getHtmlBorderStyle(P,F)}}S+="",v==u[0]&&(a.columnlen==null||a.columnlen[_.toString()]==null?b+='<colgroup width="72px"></colgroup>':b+='<colgroup width="'+a.columnlen[_.toString()]+'px"></colgroup>'),_==f[0]&&(a.rowlen==null||a.rowlen[v.toString()]==null?I+="height:19px;":I+="height:"+a.rowlen[v.toString()]+"px;"),S=Tt(S,{style:I,span:""}),S+=" "}S+="</td>",p+=S}p+="</tr>"}}return p='<table data-type="luckysheet_copy_action_table">'+b+p+"</table>",p}function t5(e,n={}){if(!["oneDimensional","twoDimensional"].includes(e))return ke.info("The dimensional parameter is invalid.","");let{range:l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],order:o=Me(h.currentSheetIndex)}={...n},a=h.luckysheetfile[o];if(a==null)return ke.info("The order parameter is invalid.","");if(G(l)=="string"){if(!y.iscelldata(l))return ke.info("The range parameter is invalid.","");l=y.getcellrange(l)}if(G(l)!="object"||l.row==null||l.column==null)return ke.info("The range parameter is invalid.","");let s=l.row[0],u=l.row[1],f=l.column[0],m=l.column[1],d=$.extend(!0,{},a.config);if(d.merge!=null&&sr(d,s,u,f,m))return ke.info("Cannot perform this operation on partially merged cells","");let p=a.data;(p==null||p.length==0)&&(p=kt.buildGridData(a));let b=[];if(e=="oneDimensional")for(let g=s;g<=u;g++)for(let v=f;v<=m;v++){let x=p[g][v];x==null||x.v==null?b.push(null):b.push(x.v)}else if(e=="twoDimensional")for(let g=s;g<=u;g++){let v=[];for(let x=f;x<=m;x++){let _=p[g][x];_==null||_.v==null?v.push(null):v.push(_.v)}b.push(v)}return b}function l5(e,n={}){let t=h.luckysheet_select_save[0],l=Me(h.currentSheetIndex),{range:o=t,order:a=l}={...n},s=h.luckysheetfile[a],u=s.config;if(o&&typeof o=="string"&&y.iscelldata(o)&&(o=y.getcellrange(o)),!o||o.length>1){at()?alert(locale_drag.noMulti):ke.info(locale_drag.noMulti,"");return}if(u.merge!=null){let d=!1,p=o.row[0],b=o.row[1],g=o.column[0],v=o.column[1];if(d=sr(u,p,b,g,v),d){at()?alert(Be().drag.noPartMerge):ke.info(Be().drag.noPartMerge,"");return}}let f=hr(o,s.index),m=[];if(f.length!==0){if(e)if(f.length===1){let d={};for(let p=0;p<f[0].length;p++)d[Vt(0,p,f)]="";m.push(d)}else for(let d=1;d<f.length;d++){let p={};for(let b=0;b<f[0].length;b++)Vt(0,b,f)==null?p[""]=Vt(d,b,f):p[Vt(0,b,f)]=Vt(d,b,f);m.push(p)}else{let d=o.column[0];for(let p=0;p<f.length;p++){let b={};for(let g=0;g<f[0].length;g++)b[yl(g+d)]=Vt(p,g,f);m.push(b)}}return m}}function r5(e,n={}){if(["normal","anti","offset"].indexOf(e)<0)return ke.info("The type parameter must be included in ['normal', 'anti', 'offset']","");let l=Me(h.currentSheetIndex),o=JSON.parse(JSON.stringify(h.luckysheet_select_save)),{column:a=1,range:s=o,order:u=l}={...n},m=h.luckysheetfile[u].config;if(s&&typeof s=="string"&&y.iscelldata(s)&&(s=y.getcellrange(s)),!s||s.length>1){at()?alert(Be().drag.noMulti):ke.info(Be().drag.noMulti,"");return}if(m.merge!=null){let g=!1,v=s[0].row[0],x=s[0].row[1],_=s[0].column[0],S=s[0].column[1];if(g=sr(m,v,x,_,S),g){at()?alert(Be().drag.noPartMerge):ke.info(Be().drag.noPartMerge,"");return}}let d=hr(s,u),p=[];if(d.length===0)return;let b=d[0].length;switch(e){case"normal":for(let g=0;g<d.length&&!(g>=b);g++)p.push(d[g][g]);break;case"anti":for(let g=0;g<d.length&&!(g>=b);g++)p.push(d[g][b-g-1]);break;case"offset":if(a.toString()=="NaN"){at()?alert(Be().drag.inputCorrect):ke.info(Be().drag.inputCorrect,"");return}if(a<0){at()?alert(Be().drag.offsetColumnLessZero):ke.info(Be().drag.offsetColumnLessZero,"");return}for(let g=0;g<d.length&&!(g+a>=b);g++)p.push(d[g][g+a]);break}Ql.copybyformat(new Event,JSON.stringify(p))}function n5(e={}){let n=Me(h.currentSheetIndex),t=JSON.parse(JSON.stringify(h.luckysheet_select_save)),{range:l=t,order:o=n}={...e},s=h.luckysheetfile[o].config;if(l&&typeof l=="string"&&y.iscelldata(l)&&(l=y.getcellrange(l)),!l||l.length>1){at()?alert(Be().drag.noMulti):ke.info(Be().drag.noMulti,"");return}if(s.merge!=null){let m=!1,d=l[0].row[0],p=l[0].row[1],b=l[0].column[0],g=l[0].column[1];if(m=sr(s,d,p,b,g),m){at()?alert(Be().drag.noPartMerge):ke.info(Be().drag.noPartMerge,"");return}}let u=hr(l,o),f=[];if(u.length!==0){for(let m=0;m<u.length;m++){let d=[];for(let p=0;p<u[0].length;p++){let b=!1,g;G(u[m][p])=="object"?g=u[m][p].v:g=u[m][p],g==null||g==""?b=!1:(g=parseInt(g),g==null||g>0?b=!0:b=!1),d.push(b)}f.push(d)}Ql.copybyformat(event,JSON.stringify(f))}}function i5(e,n={}){if(G(e)=="string"){if(!y.iscelldata(e))return ke.info("The range parameter is invalid.","");let s=y.getcellrange(e);e=[{row:s.row,column:s.column}]}else if(G(e)=="object"){if(e.row==null||e.column==null)return ke.info("The range parameter is invalid.","");e=[{row:e.row,column:e.column}]}if(G(e)=="array"){for(let s=0;s<e.length;s++)if(G(e[s])==="string"){if(!y.iscelldata(e[s]))return ke.info("The range parameter is invalid.","");let u=y.getcellrange(e[s]);e[s]={row:u.row,column:u.column}}else if(G(e)=="object"){if(e.row==null||e.column==null)return ke.info("The range parameter is invalid.","");e={row:e.row,column:e.column}}}if(G(e)!="array")return ke.info("The range parameter is invalid.","");let{show:t=!0,order:l=Me(h.currentSheetIndex),success:o}={...n},a=h.luckysheetfile[l];if(a==null)return ke.info("The order parameter is invalid.","");for(let s=0;s<e.length;s++){let u=_t.mergeMoveMain(e[s].column,e[s].row,e[s]);u&&(e[s]={row:u[1],column:u[0]})}a.luckysheet_select_save=e,a.index==h.currentSheetIndex&&(h.luckysheet_select_save=e,gl(),t||($("#luckysheet-cell-selected-boxs").hide(),$("#luckysheet-cell-selected-focus").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-rows-h-selected").empty(),$("#luckysheet-cols-h-selected").empty())),o&&typeof o=="function"&&o()}function o5(e,n={}){let t=Me(h.currentSheetIndex),l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],{range:o=l,isRefresh:a=!0,order:s=t,success:u}={...n};if(e==null)return ke.info("The data which will be set to range cannot be null.","");if(o instanceof Array)return ke.info("setRangeValue only supports a single selection.","");typeof o=="string"&&y.iscelldata(o)&&(o=y.getcellrange(o));let f=o.row[1]-o.row[0]+1,m=o.column[1]-o.column[0]+1;if(e.length!==f||e[0].length!==m)return ke.info("The data to be set does not match the selection.","");let d=h.luckysheetfile[s];if(d==null)return ke.info("The order parameter is invalid.","");let p=$.extend(!0,[],d.data);for(let g=0;g<f;g++)for(let v=0;v<m;v++){let x=o.row[0]+g,_=o.column[0]+v;mu(x,_,e[g][v],{order:s,isRefresh:!1})}let b=$.extend(!0,[],d.data);d.data.length=0,d.data.push(...p),d.index==h.currentSheetIndex&&al(b,[{row:o.row,column:o.column}],void 0,!0,!1),a&&Xt(),u&&typeof u=="function"&&u()}function j1(e,n,t={}){let l=Me(h.currentSheetIndex),o=h.luckysheet_select_save[h.luckysheet_select_save.length-1],{range:a=o,order:s=l}={...t};if(!e)return ke.info("Arguments attr cannot be null or undefined.",""),"error";if(a instanceof Array)return ke.info("setRangeValue only supports a single selection.",""),"error";if(G(a)=="string"){if(!y.iscelldata(a))return ke.info("The range parameter is invalid.",""),"error";a=y.getcellrange(a)}if(G(a)!="object"||a.row==null||a.column==null)return ke.info("The range parameter is invalid.",""),"error";for(let u=a.row[0];u<=a.row[1];u++)for(let f=a.column[0];f<=a.column[1];f++)console.log("r",u),console.log("c",f),mu(u,f,{[e]:n},{order:s,isRefresh:!1})}function a5(e,n,t={}){let l=Me(h.currentSheetIndex),o=JSON.parse(JSON.stringify(h.luckysheet_select_save)),{range:a=o,order:s=l,success:u}={...t};if(G(a)=="string"){if(!y.iscelldata(a))return ke.info("The range parameter is invalid.","");let p=y.getcellrange(a);a=[{row:p.row,column:p.column}]}else if(G(a)=="object"){if(a.row==null||a.column==null)return ke.info("The range parameter is invalid.","");a=[{row:a.row,column:a.column}]}if(G(a)!="array")return ke.info("The range parameter is invalid.","");let f=h.luckysheetfile[s],m=[];for(let p=0;p<a.length;p++)m.push(j1(e,n,{range:a[p],order:s}));let d=$.extend(!0,[],f.data);if(m.some(p=>p==="error"))return f.data.length=0,f.data.push(...d),!1;f.data.length=0,f.data.push(...d),f.index==h.currentSheetIndex&&al(d,void 0,void 0,!0,!1),Xt(),u&&typeof u=="function"}function s5(e,n={}){if(!["open","close"].includes(e))return ke.info("The type parameter is invalid.","");let{range:l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],order:o=Me(h.currentSheetIndex),success:a}={...n},s=h.luckysheetfile[o];if(s==null)return ke.info("The order parameter is invalid.","");if(G(l)=="string"){if(!y.iscelldata(l))return ke.info("The range parameter is invalid.","");l=y.getcellrange(l)}if(G(l)!="object"||l.row==null||l.column==null)return ke.info("The range parameter is invalid.","");if(setTimeout(()=>{a&&typeof a=="function"&&a()},1),e=="open")return s.filter_select=l,s.index==h.currentSheetIndex&&fi(l,s.filter),{row:l.row,column:l.column};if(e=="close"){let u=$.extend(!0,{},s.filter_select);return s.filter_select=null,$("#luckysheet-filter-selected-sheet"+s.index).remove(),$("#luckysheet-filter-options-sheet"+s.index).remove(),{row:u.row,column:u.column}}}function c5(e,n={}){if(["all","horizontal","vertical"].indexOf(e)<0)return ke.info("The type parameter must be included in ['all', 'horizontal', 'vertical']","");let l=Me(h.currentSheetIndex),o=JSON.parse(JSON.stringify(h.luckysheet_select_save)),{range:a=o,order:s=l,success:u}={...n},f=h.luckysheetfile[s],m=$.extend(!0,{},f.config),d=$.extend(!0,[],f.data);if(d.length==0&&(d=$.extend(!0,[],kt.buildGridData(f))),G(a)=="string"){if(!y.iscelldata(a))return ke.info("Incorrect selection format","");let b=y.getcellrange(a);a=[{row:b.row,column:b.column}]}else if(G(a)=="object"){if(!a.hasOwnProperty("row")||!a.hasOwnProperty("column"))return ke.info("Incorrect selection format","");a=[{row:a.row,column:a.column}]}if(na(a))return ke.info("Cannot merge overlapping range","");if(m.merge!=null){let b=!1;for(let g=0;g<a.length;g++){let v=a[g].row[0],x=a[g].row[1],_=a[g].column[0],S=a[g].column[1];if(b=sr(m,v,x,_,S),b)break}if(b)return ke.info("Cannot perform this operation on partially merged cells","")}else m.merge={};let p=!1;for(let b=0;b<a.length;b++){let g=a[b].row[0],v=a[b].row[1],x=a[b].column[0],_=a[b].column[1];for(let S=g;S<=v;S++){for(let I=x;I<=_;I++){let P=d[S][I];if(G(P)=="object"&&"mc"in P){p=!0;break}}if(p)break}}if(p)B1({range:a,order:s});else{for(let b=0;b<a.length;b++){let g=a[b].row[0],v=a[b].row[1],x=a[b].column[0],_=a[b].column[1];if(!(g==v&&x==_)){if(e=="all"){let S={},I=!1;for(let P=g;P<=v;P++)for(let F=x;F<=_;F++){let D=d[P][F];D!=null&&(!ft(D.v)||D.f!=null)&&!I&&(S=$.extend(!0,{},D),I=!0),d[P][F]={mc:{r:g,c:x}}}d[g][x]=S,d[g][x].mc={r:g,c:x,rs:v-g+1,cs:_-x+1},m.merge[g+"_"+x]={r:g,c:x,rs:v-g+1,cs:_-x+1}}else if(e=="vertical")for(let S=x;S<=_;S++){let I={},P=!1;for(let F=g;F<=v;F++){let D=d[F][S];D!=null&&(!ft(D.v)||D.f!=null)&&!P&&(I=$.extend(!0,{},D),P=!0),d[F][S]={mc:{r:g,c:S}}}d[g][S]=I,d[g][S].mc={r:g,c:S,rs:v-g+1,cs:1},m.merge[g+"_"+S]={r:g,c:S,rs:v-g+1,cs:1}}else if(e=="horizontal")for(let S=g;S<=v;S++){let I={},P=!1;for(let F=x;F<=_;F++){let D=d[S][F];D!=null&&(!ft(D.v)||D.f!=null)&&!P&&(I=$.extend(!0,{},D),P=!0),d[S][F]={mc:{r:S,c:x}}}d[S][x]=I,d[S][x].mc={r:S,c:x,rs:1,cs:_-x+1},m.merge[S+"_"+x]={r:S,c:x,rs:1,cs:_-x+1}}}}s==l?(h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"mergeChange",sheetIndex:f.index,data:$.extend(!0,[],f.data),curData:d,range:a,config:$.extend(!0,{},f.config),curConfig:m})),h.clearjfundo=!1,al(d,a,{cfg:m}),h.clearjfundo=!0):(f.data=d,f.config=m)}u&&typeof u=="function"&&u()}function B1(e={}){let n=h.luckysheet_select_save,t=Me(h.currentSheetIndex),{range:l=n,order:o=t,success:a}={...e},s=h.luckysheetfile[o],u=$.extend(!0,{},s.config),f=$.extend(!0,[],s.data);if(f.length==0&&(f=$.extend(!0,[],kt.buildGridData(s))),G(l)=="string"){if(!y.iscelldata(l))return ke.info("Incorrect selection format","");let m=y.getcellrange(l);l=[{row:m.row,column:m.column}]}else if(G(l)=="object"){if(!l.hasOwnProperty("row")||!l.hasOwnProperty("column"))return ke.info("Incorrect selection format","");l=[{row:l.row,column:l.column}]}if(na(l))return ke.info("Cannot merge overlapping range","");if(u.merge!=null){let m=!1;for(let d=0;d<l.length;d++){let p=l[d].row[0],b=l[d].row[1],g=l[d].column[0],v=l[d].column[1];if(m=sr(u,p,b,g,v),m)break}if(m)return ke.info("Cannot perform this operation on partially merged cells","")}for(let m=0;m<l.length;m++){let d=l[m].row[0],p=l[m].row[1],b=l[m].column[0],g=l[m].column[1];if(d==p&&b==g)continue;let v={};for(let x=d;x<=p;x++)for(let _=b;_<=g;_++){let S=f[x][_];if(S!=null&&S.mc!=null){let I=S.mc.r,P=S.mc.c;if("rs"in S.mc)delete S.mc,delete u.merge[I+"_"+P],v[I+"_"+P]=$.extend(!0,{},S);else{let F=JSON.parse(JSON.stringify(v[I+"_"+P]));delete F.v,delete F.m,delete F.ct,delete F.f,delete F.spl,f[x][_]=F}}}}o==t?(h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"mergeChange",sheetIndex:s.index,data:$.extend(!0,[],s.data),curData:f,range:l,config:$.extend(!0,{},s.config),curConfig:u})),h.clearjfundo=!1,al(f,l,{cfg:u}),h.clearjfundo=!0):(s.data=f,s.config=u)}function u5(e,n={}){if(["asc","desc"].indexOf(e)<0)return ke.info("The type parameter must be included in ['asc', 'desc'","");let l=Me(h.currentSheetIndex),o=h.luckysheet_select_save[0],{range:a=o,order:s=l,success:u}={...n},f=h.luckysheetfile[s],m=$.extend(!0,{},f.config),d=$.extend(!0,[],f.data);if(d.length==0&&(d=$.extend(!0,[],kt.buildGridData(f))),a instanceof Array&&a.length>1){ke.info(Be().sort.noRangeError,"");return}a&&typeof a=="string"&&y.iscelldata(a)&&(a=y.getcellrange(a));let p=a.row[0],b=a.row[1],g=a.column[0],v=a.column[1],x=!1,_=[];for(let I=p;I<=b;I++){let P=[];for(let F=g;F<=v;F++){if(d[I][F]!=null&&d[I][F].mc!=null){x=!0;break}P.push(d[I][F])}_.push(P)}if(x){ke.info(Be().sort.mergeError,"");return}_=Ko([].concat(_),0,e==="asc");for(let I=p;I<=b;I++)for(let P=g;P<=v;P++)d[I][P]=_[I-p][P-g];let S={};m.rowlen!=null&&(m=Cn(d,p,b,m),S={cfg:m,RowlChange:!0}),f.index==h.currentSheetIndex?al(d,[{row:[p,b],column:[g,v]}],S):(f.data=d,f.config=m),u&&typeof u=="function"&&u()}function f5(e,n,t={}){if(!n||!(n instanceof Array))return ke.info("The sort parameter is invalid.","");let l=Me(h.currentSheetIndex),o=h.luckysheet_select_save[0],{range:a=o,order:s=l,success:u}={...t},f=h.luckysheetfile[s],m=$.extend(!0,{},f.config),d=$.extend(!0,[],f.data);if(d.length==0&&(d=$.extend(!0,[],kt.buildGridData(f))),a instanceof Array&&a.length>1){ke.info(Be().sort.noRangeError,"");return}a&&typeof a=="string"&&y.iscelldata(a)&&(a=y.getcellrange(a));let p=a.row[0],b=a.row[1],g=a.column[0],v=a.column[1],x;e?x=p+1:x=p;let _=!1,S=[];for(let P=x;P<=b;P++){let F=[];for(let D=g;D<=v;D++){if(d[P][D]!=null&&d[P][D].mc!=null){_=!0;break}F.push(d[P][D])}S.push(F)}if(_){ke.info(Be().sort.mergeError,"");return}n.forEach(P=>{let F=P.i;F-=g,S=Ko([].concat(S),F,P.sort==="asc")});for(let P=x;P<=b;P++)for(let F=g;F<=v;F++)d[P][F]=S[P-x][F-g];let I={};m.rowlen!=null&&(m=Cn(d,x,b,m),I={cfg:m,RowlChange:!0}),f.index===h.currentSheetIndex?al(d,[{row:[x,b],column:[g,v]}],I):(f.data=d,f.config=m),u&&typeof u=="function"&&u()}function h5(e,n,t={}){if(!e||!["greaterThan","lessThan","betweenness","equal","textContains","occurrenceDate","duplicateValue","top10","top10%","last10","last10%","AboveAverage","SubAverage"].includes(e))return ke.info("The conditionName parameter is invalid.","");if(G(n)!="array"||n.length==0)return ke.info("The conditionValue parameter is invalid.","");let{format:o={textColor:"#000000",cellColor:"#ff0000"},cellrange:a=h.luckysheet_select_save,order:s=Me(h.currentSheetIndex),success:u}={...t};a=JSON.parse(JSON.stringify(a));let f=h.luckysheetfile[s],m=f.data;if((m==null||m.length==0)&&(m=kt.buildGridData(f)),f==null)return ke.info("Incorrect worksheet index","");let d=Be().conditionformat,p=[],b=[];if(e=="betweenness"){let P=n[0],F=n[1],D=Mt.getRangeByTxt(P);if(D.length>1){Mt.infoDialog(d.onlySingleCell,"");return}else if(D.length==1){let w=D[0].row[0],C=D[0].row[1],T=D[0].column[0],O=D[0].column[1];if(w==C&&T==O)P=Vt(w,T,m),p.push({row:D[0].row,column:D[0].column}),b.push(P);else{Mt.infoDialog(d.onlySingleCell,"");return}}else if(D.length==0)if(isNaN(P)||P==""){Mt.infoDialog(d.conditionValueCanOnly,"");return}else b.push(P);let k=Mt.getRangeByTxt(F);if(k.length>1){Mt.infoDialog(d.onlySingleCell,"");return}else if(k.length==1){let w=k[0].row[0],C=k[0].row[1],T=k[0].column[0],O=k[0].column[1];if(w==C&&T==O)F=Vt(w,T,m),p.push({row:k[0].row,column:k[0].column}),b.push(F);else{Mt.infoDialog(d.onlySingleCell,"");return}}else if(k.length==0)if(isNaN(F)||F==""){Mt.infoDialog(d.conditionValueCanOnly,"");return}else b.push(F)}else if(e=="greaterThan"||e=="lessThan"||e=="equal"){let P=n[0],F=Mt.getRangeByTxt(P);if(F.length>1){Mt.infoDialog(d.onlySingleCell,"");return}else if(F.length==1){let D=F[0].row[0],k=F[0].row[1],w=F[0].column[0],C=F[0].column[1];if(D==k&&w==C)P=Vt(D,w,m),p.push({row:F[0].row,column:F[0].column}),b.push(P);else{Mt.infoDialog(d.onlySingleCell,"");return}}else if(F.length==0)if(isNaN(P)||P==""){Mt.infoDialog(d.conditionValueCanOnly,"");return}else b.push(P)}else if(e=="textContains"){let P=n[0],F=Mt.getRangeByTxt(P);if(F.length>1){Mt.infoDialog(d.onlySingleCell,"");return}else if(F.length==1){let D=F[0].row[0],k=F[0].row[1],w=F[0].column[0],C=F[0].column[1];if(D==k&&w==C)P=Vt(D,w,m),p.push({row:F[0].row,column:F[0].column}),b.push(P);else{Mt.infoDialog(d.onlySingleCell,"");return}}else if(F.length==0)if(P==""){Mt.infoDialog(d.conditionValueCanOnly,"");return}else b.push(P)}else if(e=="occurrenceDate"){let P=n[0],F=n[1];if(!dr(P)||!dr(F))return ke.info("The conditionValue parameter is invalid.","");let D;un(P,F)>0?D=(0,kf.default)(F).format("YYYY/MM/DD")+"-"+(0,kf.default)(P).format("YYYY/MM/DD"):D=(0,kf.default)(P).format("YYYY/MM/DD")+"-"+(0,kf.default)(F).format("YYYY/MM/DD"),b.push(D)}else if(e=="duplicateValue"){let P=n[0];if(P!="0"||P!="1")return ke.info("The conditionValue parameter is invalid.","");b.push(P)}else if(e=="top10"||e=="top10%"||e=="last10"||e=="last10%"){let P=n[0];if(parseInt(P)!=P||parseInt(P)<1||parseInt(P)>1e3){Mt.infoDialog(d.pleaseEnterInteger,"");return}b.push(parseInt(P))}else(e=="AboveAverage"||e=="SubAverage")&&b.push(e);if(!o.hasOwnProperty("textColor")||!o.hasOwnProperty("cellColor"))return ke.info("The format parameter is invalid.","");if(G(a)=="string"?a=Mt.getRangeByTxt(a):G(a)=="object"&&(a=[a]),G(a)!="array")return ke.info("The cellrange parameter is invalid.","");let g={type:"default",cellrange:a,format:o,conditionName:e,conditionRange:p,conditionValue:b},v=$.extend(!0,[],h.luckysheetfile),x=Mt.getHistoryRules(v),_=f.luckysheet_conditionformat_save||[];_.push(g),f.luckysheet_conditionformat_save=_;let S=$.extend(!0,[],h.luckysheetfile),I=Mt.getCurrentRules(S);Mt.ref(x,I),Ue.allowUpdate&&Ue.saveParam("all",f.index,_,{k:"luckysheet_conditionformat_save"}),u&&typeof u=="function"&&u()}function d5(e,n={}){if(!e||!["dataBar","colorGradation","icons"].includes(e))return ke.info("The type parameter is invalid.","");let{format:l,cellrange:o=h.luckysheet_select_save,order:a=Me(h.currentSheetIndex),success:s}={...n};o=JSON.parse(JSON.stringify(o));let u=h.luckysheetfile[a];if(u==null)return ke.info("Incorrect worksheet index","");if(e=="dataBar"){if(l==null&&(l=["#638ec6","#ffffff"]),G(l)!="array"||l.length<1||l.length>2)return ke.info("The format parameter is invalid.","")}else if(e=="colorGradation"){if(l==null&&(l=["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]),G(l)!="array"||l.length<2||l.length>3)return ke.info("The format parameter is invalid.","")}else if(e=="icons"){l==null&&(l="threeWayArrowMultiColor");let v=["threeWayArrowMultiColor","threeTriangles","fourWayArrowMultiColor","fiveWayArrowMultiColor","threeWayArrowGrayColor","fourWayArrowGrayColor","fiveWayArrowGrayColor","threeColorTrafficLightRimless","threeSigns","greenRedBlackGradient","threeColorTrafficLightBordered","fourColorTrafficLight","threeSymbolsCircled","tricolorFlag","threeSymbolsnoCircle","threeStars","fiveQuadrantDiagram","fiveBoxes","grade4","grade5"];if(G(l)!="string"||!v.includes(l))return ke.info("The format parameter is invalid.","");switch(l){case"threeWayArrowMultiColor":l={len:3,leftMin:0,top:0};break;case"threeTriangles":l={len:3,leftMin:0,top:1};break;case"fourWayArrowMultiColor":l={len:4,leftMin:0,top:2};break;case"fiveWayArrowMultiColor":l={len:5,leftMin:0,top:3};break;case"threeWayArrowGrayColor":l={len:3,leftMin:5,top:0};break;case"fourWayArrowGrayColor":l={len:4,leftMin:5,top:1};break;case"fiveWayArrowGrayColor":l={len:5,leftMin:5,top:2};break;case"threeColorTrafficLightRimless":l={len:3,leftMin:0,top:4};break;case"threeSigns":l={len:3,leftMin:0,top:5};break;case"greenRedBlackGradient":l={len:4,leftMin:0,top:6};break;case"threeColorTrafficLightBordered":l={len:3,leftMin:5,top:4};break;case"fourColorTrafficLight":l={len:4,leftMin:5,top:5};break;case"threeSymbolsCircled":l={len:3,leftMin:0,top:7};break;case"tricolorFlag":l={len:3,leftMin:0,top:8};break;case"threeSymbolsnoCircle":l={len:3,leftMin:5,top:7};break;case"threeStars":l={len:3,leftMin:0,top:9};break;case"fiveQuadrantDiagram":l={len:5,leftMin:0,top:10};break;case"fiveBoxes":l={len:5,leftMin:0,top:11};break;case"grade4":l={len:4,leftMin:5,top:9};break;case"grade5":l={len:5,leftMin:5,top:10};break}}if(G(o)=="string"?o=Mt.getRangeByTxt(o):G(o)=="object"&&(o=[o]),G(o)!="array")return ke.info("The cellrange parameter is invalid.","");let f={type:e,cellrange:o,format:l},m=$.extend(!0,[],h.luckysheetfile),d=Mt.getHistoryRules(m),p=u.luckysheet_conditionformat_save||[];p.push(f),u.luckysheet_conditionformat_save=p;let b=$.extend(!0,[],h.luckysheetfile),g=Mt.getCurrentRules(b);Mt.ref(d,g),Ue.allowUpdate&&Ue.saveParam("all",u.index,p,{k:"luckysheet_conditionformat_save"}),s&&typeof s=="function"&&s()}function m5(e,n={}){if(!K(e))return ke.info("The itemIndex parameter is invalid.","");e=Number(e);let{order:t=Me(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");let a=$.extend(!0,[],o.luckysheet_conditionformat_save);if(a.length==0)return ke.info("This worksheet has no conditional format to delete","");if(a[e]==null)return ke.info("The conditional format of the index cannot be found","");let s=a.splice(e,1),u=$.extend(!0,[],h.luckysheetfile),f=Mt.getHistoryRules(u);o.luckysheet_conditionformat_save=a;let m=$.extend(!0,[],h.luckysheetfile),d=Mt.getCurrentRules(m);return Mt.ref(f,d),Ue.allowUpdate&&Ue.saveParam("all",o.index,ruleArr,{k:"luckysheet_conditionformat_save"}),setTimeout(()=>{l&&typeof l=="function"&&l()},1),s}function g5(e={}){let{range:n=h.luckysheet_select_save,order:t=Me(h.currentSheetIndex),success:l}={...e};if(n=JSON.parse(JSON.stringify(n)),G(n)=="string"){if(!y.iscelldata(n))return ke.info("The range parameter is invalid.","");let f=y.getcellrange(n);n=[{row:f.row,column:f.column}]}else if(G(n)=="object"){if(n.row==null||n.column==null)return ke.info("The range parameter is invalid.","");n=[{row:n.row,column:n.column}]}if(G(n)!="array")return ke.info("The range parameter is invalid.","");let o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.config),s=!1;for(let f=0;f<n.length;f++){let m=n[f].row[0],d=n[f].row[1],p=n[f].column[0],b=n[f].column[1];if(s=sr(a,m,d,p,b),s)break}if(s)return ke.info("Cannot perform this operation on partially merged cells","");let u=$.extend(!0,[],o.data);u.length==0&&(u=$.extend(!0,[],kt.buildGridData(o)));for(let f=0;f<n.length;f++){let m=n[f].row[0],d=n[f].row[1],p=n[f].column[0],b=n[f].column[1];for(let g=m;g<=d;g++)for(let v=p;v<=b;v++){let x=u[g][v];G(x)=="object"?(delete x.m,delete x.v,x.f!=null&&(delete x.f,y.delFunctionGroup(g,v,o.index),delete x.spl),x.ct!=null&&x.ct.t=="inlineStr"&&delete x.ct):u[g][v]=null}}o.index==h.currentSheetIndex?al(u,n):o.data=u,l&&typeof l=="function"&&l()}function p5(e,n={}){if(!["left","up"].includes(e))return ke.info("The move parameter is invalid.","");let{range:l=h.luckysheet_select_save[h.luckysheet_select_save.length-1],order:o=Me(h.currentSheetIndex),success:a}={...n};if(G(l)=="string"){if(!y.iscelldata(l))return ke.info("The range parameter is invalid.","");let p=y.getcellrange(l);l={row:p.row,column:p.column}}if(G(l)!="object"||l.row==null||l.column==null)return ke.info("The range parameter is invalid.","");if(h.luckysheetfile[o]==null)return ke.info("The order parameter is invalid.","");let u=l.row[0],f=l.row[1],m=l.column[0],d=l.column[1];e=="left"?ac("moveLeft",u,f,m,d,o):e=="up"&&ac("moveUp",u,f,m,d,o),a&&typeof a=="function"&&a()}function v5(e,n={}){if(!e||["flipUpDown","flipLeftRight","flipClockwise","flipCounterClockwise","transpose","deleteZeroByRow","deleteZeroByColumn","removeDuplicateByRow","removeDuplicateByColumn","newMatrix"].indexOf(e)<0)return ke.info("The type parameter is invalid.","");let l=h.luckysheet_select_save[0],{range:o=l,success:a}={...n};if(o instanceof Array&&o.length>1){ke.info(Be().drag.noMulti,"");return}o&&typeof o=="string"&&y.iscelldata(o)&&(o=y.getcellrange(o));let s=hr(o),u=[];if(s.length===0)return;let f,m,d;switch(e){case"flipUpDown":for(let p=s.length-1;p>=0;p--){let b=[];for(let g=0;g<s[0].length;g++){let v="";s[p]!=null&&s[p][g]!=null&&(v=s[p][g]),b.push(v)}u.push(b)}break;case"flipLeftRight":for(let p=0;p<s.length;p++){let b=[];for(let g=s[0].length-1;g>=0;g--){let v="";s[p]!=null&&s[p][g]!=null&&(v=s[p][g]),b.push(v)}u.push(b)}break;case"flipClockwise":for(let p=0;p<s[0].length;p++){let b=[];for(let g=s.length-1;g>=0;g--){let v="";s[g]!=null&&s[g][p]!=null&&(v=s[g][p]),b.push(v)}u.push(b)}break;case"flipCounterClockwise":for(let p=s[0].length-1;p>=0;p--){let b=[];for(let g=0;g<s.length;g++){let v="";s[g]!=null&&s[g][p]!=null&&(v=s[g][p]),b.push(v)}u.push(b)}break;case"transpose":for(let p=0;p<s[0].length;p++){let b=[];for(let g=0;g<s.length;g++){let v="";s[g]!=null&&s[g][p]!=null&&(v=s[g][p]),b.push(v)}u.push(b)}break;case"deleteZeroByRow":f=s[0].length;for(let p=0;p<s.length;p++){let b=[],g=!0,v=!0;for(let _=0;_<f;_++){let S="";if(s[p]!=null&&s[p][_]!=null){if(S=s[p][_],(S.v=="0"||S.v==0)&&g)continue;g=!1}b.push(S)}let x=[];if(b.length==f)x=b;else{for(let S=b.length-1;S>=0;S--){let I="";if(b[S]!=null){if(I=b[S],(I.v=="0"||I.v==0)&&v)continue;v=!1}x.unshift(I)}let _=f-x.length;for(let S=0;S<_;S++)x.push("")}u.push(x)}break;case"deleteZeroByColumn":f=s.length,m=s[0].length;for(let p=0;p<m;p++){let b=[],g=!0,v=!0;for(let _=0;_<f;_++){let S="";if(s[_]!=null&&s[_][p]!=null){if(S=s[_][p],(S.v=="0"||S.v==0)&&g)continue;g=!1}b.push(S)}let x=[];if(b.length==f)x=b;else{for(let S=b.length-1;S>=0;S--){let I="";if(b[S]!=null){if(I=b[S],(I.v=="0"||I.v==0)&&v)continue;v=!1}x.unshift(I)}let _=f-x.length;for(let S=0;S<_;S++)x.push("")}u.push(x)}d=[];for(let p=0;p<u[0].length;p++){let b=[];for(let g=0;g<u.length;g++){let v="";u[g]!=null&&u[g][p]!=null&&(v=u[g][p]),b.push(v)}d.push(b)}break;case"removeDuplicateByRow":f=s[0].length;for(let p=0;p<s.length;p++){let b=[],g={};for(let x=0;x<f;x++){let _=null;s[p]!=null&&s[p][x]!=null&&(_=s[p][x],_.v in g||(g[_.v]=[]),g[_.v].push(_))}for(let x=0;x<f;x++){let _=null;s[p]!=null&&s[p][x]!=null&&(_=s[p][x],g[_.v].length==1&&b.push(_))}let v=f-b.length;for(let x=0;x<v;x++)b.push(null);u.push(b)}break;case"removeDuplicateByColumn":m=s[0].length,f=s.length;for(let p=0;p<m;p++){let b=[],g={};for(let x=0;x<f;x++){let _=null;s[x]!=null&&s[x][p]!=null&&(_=s[x][p],_.v in g||(g[_.v]=[]),g[_.v].push(_))}for(let x=0;x<f;x++){let _=null;s[x]!=null&&s[x][p]!=null&&(_=s[x][p],g[_.v].length==1&&b.push(_))}a1=b;let v=f-a1.length;for(let x=0;x<v;x++)a1.push(null);u.push(a1)}d=[];for(let p=0;p<u[0].length;p++){let b=[];for(let g=0;g<u.length;g++){let v=null;u[g]!=null&&u[g][p]!=null&&(v=u[g][p]),b.push(v)}d.push(b)}break;case"newMatrix":console.log("TODO");break}It.controlHandler(u,o),a&&typeof a=="function"&&a()}function y5(e,n,t={}){if(!e||["plus","minus","multiply","divided","power","root","log"].indexOf(e)<0)return ke.info("The type parameter is invalid.","");if(!K(n))return ke.info("The number parameter is invalid.","");let o=h.luckysheet_select_save[0],{range:a=o,success:s}={...t};if(a instanceof Array&&a.length>1){ke.info(Be().drag.noMulti,"");return}a&&typeof a=="string"&&y.iscelldata(a)&&(a=y.getcellrange(a));let u=hr(a);if(u.length==0)return;let f=[];for(let m=0;m<u.length;m++){let d=[];for(let p=0;p<u[0].length;p++){let b="";u[m]!=null&&u[m][p]!=null&&(b=u[m][p],parseInt(b)!=null&&u[m][p].ct!=null&&u[m][p].ct.t=="n"&&(e=="minus"?b.v=b.v-n:e=="multiply"?b.v=b.v*n:e=="divided"?b.v=numFormat(b.v/n,4):e=="power"?b.v=Math.pow(b.v,n):e=="root"?n==2?b.v=numFormat(Math.sqrt(b.v),4):n==3&&Math.cbrt?b.v=numFormat(Math.cbrt(b.v),4):b.v=numFormat(jfnqrt(b.v,n),4):e=="log"?b.v=numFormat(Math.log(b.v)*1e4/Math.log(Math.abs(n)),4):b.v=b.v+n,b.v==null?b.m="":b.m=b.v.toString())),d.push(b)}f.push(d)}It.controlHandler(f,a),s&&typeof s=="function"&&s()}function k5(e={}){let n=h.luckysheetfile.length-1,{sheetObject:t={},order:l=n,success:o}={...e};if(!K(l))return ke.info("Parameter is not a table index","");l=Number(l);let a=kt.generateRandomSheetIndex();t.calcChain&&t.calcChain.length>0&&t.calcChain.forEach(m=>{m.index=a});let s=kt.generateRandomSheetName(h.luckysheetfile,!1);if(t.name){let m=!1;for(let d=0;d<h.luckysheetfile.length;d++)if(h.luckysheetfile[d].name==t.name){m=!0;break}m||(s=t.name)}$("#luckysheet-sheet-container-c").append(Tt(Ui,{index:a,active:"",name:s,style:"",colorset:""}));let u={name:"",color:"",status:"0",order:"",index:"",celldata:[],row:h.defaultrowNum,column:h.defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!1};if(u=$.extend(!0,u,t),u.index=a,u.name=s,u.order=l,l<=0){let m=h.luckysheetfile[0].index,d=$("#luckysheet-sheets-item"+m);$("#luckysheet-sheets-item"+a).insertBefore(d),h.luckysheetfile.splice(0,0,u)}else{l>h.luckysheetfile.length&&(l=h.luckysheetfile.length);let m=h.luckysheetfile[l-1].index,d=$("#luckysheet-sheets-item"+m);$("#luckysheet-sheets-item"+a).insertAfter(d),h.luckysheetfile.splice(l,0,u)}let f={};if(h.luckysheetfile.forEach((m,d,p)=>{p[d].order=d,f[m.index.toString()]=d}),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+a).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+a+'" class="luckysheet-datavisual-selection-set"></div>'),Jr(!0),Ue.saveParam("sha",null,$.extend(!0,{},u)),Ue.saveParam("shr",null,f),h.clearjfundo){h.jfundo.length=0;let m={};m.type="addSheet",m.sheetconfig=$.extend(!0,{},u),m.index=a,m.currentSheetIndex=h.currentSheetIndex,h.jfredo.push(m)}return kt.changeSheetExec(a,!1,!0),o&&typeof o=="function"&&o(),u}function b5(e={}){let{order:n=Me(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?ke.info("The order parameter is invalid.",""):h.luckysheetfile.length===1?ke.info(Be().sheetconfig.noMoreSheet,""):(kt.deleteSheet(l.index),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function w5(e={}){let{targetOrder:n,order:t=Me(h.currentSheetIndex),success:l}={...e},o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");if(n==null&&(n=t+1),!K(n))return ke.info("The targetOrder parameter is invalid.","");let a=o.index,s=kt.generateRandomSheetIndex(),u=$.extend(!0,{},o);u.order=h.luckysheetfile.length,u.index=s,u.name=kt.generateCopySheetName(h.luckysheetfile,u.name);let f="";u.color!=null&&(f='<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+u.color+';"></div>');let m=$("#luckysheet-sheets-item"+a);if(K(n)&&(m=$("#luckysheet-sheets-item"+h.luckysheetfile[n-1].index)),$("#luckysheet-sheet-container-c").append(Tt(Ui,{index:u.index,active:"",name:u.name,order:u.order,style:"",colorset:f})),$("#luckysheet-sheets-item"+u.index).insertAfter(m),h.luckysheetfile.splice(n,0,u),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+s).addClass("luckysheet-sheets-item-active"),$("#luckysheet-cell-main").append('<div id="luckysheet-datavisual-selection-set-'+s+'" class="luckysheet-datavisual-selection-set"></div>'),Jr(!0),Ue.saveParam("shc",s,{copyindex:a,name:u.name}),kt.changeSheetExec(s),kt.reOrderAllSheet(),h.clearjfundo)h.jfredo.push({type:"copySheet",copyindex:a,index:u.index,sheetIndex:u.index});else if(h.jfredo.length>0){let d=h.jfredo[h.jfredo.length-1];d.type=="copySheet"&&(d.index=u.index,d.sheetIndex=u.index)}return setTimeout(()=>{l&&typeof l=="function"&&l()},1),u}function x5(e={}){let{order:n=Me(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?ke.info("The order parameter is invalid.",""):(kt.setSheetHide(l.index),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function _5(e={}){let{order:n=Me(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?ke.info("The order parameter is invalid.",""):(kt.setSheetShow(l.index),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function C5(e,n={}){if(e==null||!K(e)||h.luckysheetfile[e]==null)return ke.info("The order parameter is invalid.","");let t=h.luckysheetfile[e],{success:l}={...n};return $("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),$("#luckysheet-sheets-item"+t.index).addClass("luckysheet-sheets-item-active"),kt.changeSheet(t.index),setTimeout(()=>{l&&typeof l=="function"&&l()},1),Ue.multipleRangeShow(),t}function $5(e,n={}){if(G(e)!="string"||e.toString().length==0)return ke.info("The name parameter is invalid.","");let{order:t=Me(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");let a=o.name;if(o.name=e,$("#luckysheet-sheets-item"+o.index+" .luckysheet-sheets-item-name").text(e),Ue.saveParam("all",o.index,e,{k:"name"}),h.clearjfundo){let s={};s.type="sheetName",s.sheetIndex=o.index,s.oldtxt=a,s.txt=e,h.jfundo.length=0,h.jfredo.push(s)}l&&typeof l=="function"&&l()}function S5(e,n={}){if(G(e)!="string"||e.toString().length==0)return ke.info("The color parameter is invalid.","");let{order:t=Me(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");let a=o.color;if(o.color=e,$("#luckysheet-sheets-item"+o.index).find(".luckysheet-sheets-item-color").remove(),$("#luckysheet-sheets-item"+o.index).append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e+';"></div>'),Ue.saveParam("all",o.index,e,{k:"color"}),h.clearjfundo){let s={};s.type="sheetColor",s.sheetIndex=o.index,s.oldcolor=a,s.color=e,h.jfundo.length=0,h.jfredo.push(s)}l&&typeof l=="function"&&l()}function I5(e,n={}){if(e!="left"&&e!="right"&&!K(e))return ke.info("Type parameter not available","");K(e)&&(e=parseInt(e));let t=Me(h.currentSheetIndex),{order:l=t,success:o}={...n},a=h.luckysheetfile[l];if(a==null)return ke.info("ncorrect worksheet index","");let s=a.index;if(e=="left"){if(l==0)return;let f=h.luckysheetfile[l-1].index;$("#luckysheet-sheets-item"+s).insertBefore($("#luckysheet-sheets-item"+f)),h.luckysheetfile.splice(l,1),h.luckysheetfile.splice(l-1,0,a)}else if(e=="right"){if(l==h.luckysheetfile.length-1)return;let f=h.luckysheetfile[l+1].index;$("#luckysheet-sheets-item"+s).insertAfter($("#luckysheet-sheets-item"+f)),h.luckysheetfile.splice(l,1),h.luckysheetfile.splice(l+1,0,a)}else{if(e<0&&(e=0),e>h.luckysheetfile.length-1&&(e=h.luckysheetfile.length-1),e==l)return;if(e<l){let f=h.luckysheetfile[e].index;$("#luckysheet-sheets-item"+s).insertBefore($("#luckysheet-sheets-item"+f))}else{let f=h.luckysheetfile[e].index;$("#luckysheet-sheets-item"+s).insertAfter($("#luckysheet-sheets-item"+f))}h.luckysheetfile.splice(l,1),h.luckysheetfile.splice(e,0,a)}let u={};h.luckysheetfile.forEach((f,m,d)=>{d[m].order=m,u[f.index.toString()]=m}),Ue.saveParam("shr",null,u),o&&typeof o=="function"&&o()}function T5(e,n={}){if(e==null||e.length==0)return ke.info("Type orderList not available","");let t={};e.forEach(a=>{t[a.index.toString()]=a.order}),h.luckysheetfile.sort((a,s)=>{let u=t[a.index.toString()],f=t[s.index.toString()];return u!=null&&f!=null?u-f:u!=null?-1:(f!=null,1)});let l={};h.luckysheetfile.forEach((a,s,u)=>{if(u[s].order=s,l[a.index.toString()]=s,s>0){let f=u[s-1].index;$("#luckysheet-sheets-item"+a.index).insertAfter($("#luckysheet-sheets-item"+f))}}),Ue.saveParam("shr",null,l);let{success:o}={...n};o&&typeof o=="function"&&o()}function R5(e,n={}){if(!K(e)||e<.1||e>4)return ke.info("The zoom parameter is invalid.","");let{order:t=Me(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");o.zoomRatio=e,Ue.saveParam("all",o.index,e,{k:"zoomRatio"}),o.index==h.currentSheetIndex&&(h.zoomRatio=e,Qi(),uu()),l&&typeof l=="function"&&l()}function F5(e={}){let{order:n=Me(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?ke.info("The order parameter is invalid.",""):(l.showGridLines=!0,l.index==h.currentSheetIndex&&(h.showGridLines=!0,setTimeout(function(){Xt()},1)),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function M5(e={}){let{order:n=Me(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?ke.info("The order parameter is invalid.",""):(l.showGridLines=!1,l.index==h.currentSheetIndex&&(h.showGridLines=!1,setTimeout(function(){Xt()},1)),setTimeout(()=>{t&&typeof t=="function"&&t()},1),l)}function D5(e={}){al();let{success:n}={...e};n&&typeof n=="function"&&n()}function A5(e={}){let{scrollLeft:n,scrollTop:t,targetRow:l,targetColumn:o,success:a}={...e};if(n!=null){if(!K(n))return ke.info("The scrollLeft parameter is invalid.","");$("#luckysheet-scrollbar-x").scrollLeft(n)}else if(o!=null){if(!K(o))return ke.info("The targetColumn parameter is invalid.","");let s=h.visibledatacolumn[o],u=o<=0?0:h.visibledatacolumn[o-1];$("#luckysheet-scrollbar-x").scrollLeft(u)}if(t!=null){if(!K(t))return ke.info("The scrollTop parameter is invalid.","");$("#luckysheet-scrollbar-y").scrollTop(t)}else if(l!=null){if(!K(l))return ke.info("The targetRow parameter is invalid.","");let s=h.visibledatarow[l],u=l<=0?0:h.visibledatarow[l-1];$("#luckysheet-scrollbar-y").scrollTop(u)}a&&typeof a=="function"&&a()}function z5(e={}){mr();let{success:n}={...e};n&&typeof n=="function"&&n()}function O5(e={}){let{range:n=h.luckysheet_select_save[h.luckysheet_select_save.length-1]}={...e};if(G(n)=="string"){if(!y.iscelldata(n))return ke.info("The range parameter is invalid.","");let _=y.getcellrange(n);n={row:_.row,column:_.column}}if(G(n)!="object"||n.row==null||n.column==null)return ke.info("The range parameter is invalid.","");let t=n.row[0],l=n.row[1],o=n.column[0],a=n.column[1];if(sr(h.config,t,l,o,a))return ke.info("Cannot perform this operation on partially merged cells","");let u=h.visibledatarow,f=h.visibledatacolumn,m,d;t-1<0?(m=0,d=u[l]):(m=u[t-1],d=u[l]-u[t-1]);let p,b;o-1<0?(p=0,b=f[a]):(p=f[o-1],b=f[a]-f[o-1]);let g=$("<canvas>").attr({width:Math.ceil(b*h.devicePixelRatio),height:Math.ceil(d*h.devicePixelRatio)}).css({width:b,height:d});Ki(p,m,b,d,1,1,null,null,g);let v=g.get(0).getContext("2d");return v.beginPath(),v.moveTo(0,0),v.lineTo(0,h.devicePixelRatio*d),v.lineWidth=h.devicePixelRatio*2,v.strokeStyle=Kn.strokeStyle,v.stroke(),v.closePath(),v.beginPath(),v.moveTo(0,0),v.lineTo(h.devicePixelRatio*b,0),v.lineWidth=h.devicePixelRatio*2,v.strokeStyle=Kn.strokeStyle,v.stroke(),v.closePath(),g.get(0).toDataURL("image/png")}function P5(e,n={}){if(e==null||e.toString().length==0)return ke.info("The name parameter is invalid.","");$("#luckysheet_info_detail_input").val(e);let{success:t}={...n};t&&typeof t=="function"&&t()}function E5(e={}){let n="",t=$("#luckysheet_info_detail_input");if(t.length==0)return ke.info("Failed to get workbook name, label loading failed!"),n;n=$.trim(t.val());let{success:l}={...e};return setTimeout(()=>{l&&typeof l=="function"&&l()},1),n}function N5(e={}){let n=$.extend(!0,{},h.jfredo[h.jfredo.length-1]);ns.redo(new Event("custom")),Eo();let{success:t}={...e};return setTimeout(()=>{t&&typeof t=="function"&&t()},1),n}function L5(e={}){let n=$.extend(!0,{},h.jfundo[h.jfundo.length-1]);ns.undo(new Event("custom")),Eo();let{success:t}={...e};return setTimeout(()=>{t&&typeof t=="function"&&t()},1),n}function V1(){let e=$.extend(!0,[],h.luckysheetfile);return e.forEach((n,t,l)=>{n.data!=null&&n.data.length>0&&(n.celldata=kt.getGridData(n.data)),delete n.load,delete n.freezen}),e}function H5(e={}){let{index:n,order:t,name:l}={...e};return n!=null?kt.getSheetByIndex(n):t!=null?h.luckysheetfile[t]:l!=null?kt.getSheetByName(l):kt.getSheetByIndex()}function j5(e={}){let{order:n=Me(h.currentSheetIndex)}={...e},t=h.luckysheetfile[n];if(t==null)return ke.info("The order parameter is invalid.","");let l=$.extend(!0,[],t.data);return(l==null||l.length==0)&&(l=$.extend(!0,[],kt.buildGridData(t))),l}function B5(e={}){let{order:n=Me(h.currentSheetIndex)}={...e},t=h.luckysheetfile[n];return t==null?ke.info("The order parameter is invalid.",""):$.extend(!0,{},t.config)}function V5(e,n={}){if(G(e)!="object")return ke.info("The cfg parameter is invalid.","");let{order:t=Me(h.currentSheetIndex),success:l}={...n},o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");o.config=e,o.index==h.currentSheetIndex&&(h.config=e,("rowhidden"in e||"colhidden"in e||"rowlen"in e||"columnlen"in e)&&tr(h.flowdata.length,h.flowdata[0].length),setTimeout(function(){Xt()},1)),l&&typeof l=="function"&&l()}function W5(){return ur()}function q5(e,n={}){if(G(e)!="object")return ke.info("The optionItem parameter is invalid.","");let{type:t,type2:l=null,value1:o="",value2:a="",remote:s=!1,prohibitInput:u=!1,hintShow:f=!1,hintText:m="",checked:d=!1}={...e},p=["dropdown","checkbox","number","number_integer","number_decimal","text_content","text_length","date","validity"],b=["bw","nb","eq","ne","gt","lt","gte","lte"],g=["include","exclude","equal"],v=["bw","nb","eq","ne","bf","nbf","af","naf"],x=["card","phone"];if(!p.includes(t))return ke.info("The optionItem.type parameter is invalid.","");let _=Be().dataVerification;if(t=="dropdown"){if(o.length==0){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo1);return}}else if(t=="checkbox"){if(o.length==0||a.length==0){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo2);return}}else if(t=="number"||t=="number_integer"||t=="number_decimal"){if(!b.includes(l))return ke.info("The optionItem.type2 parameter is invalid.","");if(!K(o)){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo3);return}if(l=="bw"||l=="nb"){if(!K(a)){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo3);return}if(Number(a)<Number(o)){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo4);return}}}else if(t=="text_content"){if(!g.includes(l))return ke.info("The optionItem.type2 parameter is invalid.","");if(o.length==0){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo5);return}}else if(t=="text_length"){if(!b.includes(l))return ke.info("The optionItem.type2 parameter is invalid.","");if(!K(o)){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo3);return}if(l=="bw"||l=="nb"){if(!K(a)){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo3);return}if(Number(a)<Number(o)){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo4);return}}}else if(t=="date"){if(!v.includes(l))return ke.info("The optionItem.type2 parameter is invalid.","");if(!dr(o)){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo6);return}if(l=="bw"||l=="nb"){if(!dr(a)){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo6);return}if(un(o,a)>0){ke.info('<i class="fa fa-exclamation-triangle"></i>',_.tooltipInfo7);return}}}else if(t=="validity"&&!x.includes(l))return ke.info("The optionItem.type2 parameter is invalid.","");if(G(s)!="boolean")return ke.info("The optionItem.remote parameter is invalid.","");if(G(u)!="boolean")return ke.info("The optionItem.prohibitInput parameter is invalid.","");if(G(f)!="boolean")return ke.info("The optionItem.hintShow parameter is invalid.","");let{range:S=h.luckysheet_select_save[h.luckysheet_select_save.length-1],order:I=Me(h.currentSheetIndex),success:P}={...n};if(G(S)=="string"){if(!y.iscelldata(S))return ke.info("The range parameter is invalid.","");let A=y.getcellrange(S);S={row:A.row,column:A.column}}if(G(S)!="object"||S.row==null||S.column==null)return ke.info("The range parameter is invalid.","");let F=h.luckysheetfile[I];if(F==null)return ke.info("The order parameter is invalid.","");let D={type:t,type2:l,value1:o,value2:a,checked:d,remote:s,prohibitInput:u,hintShow:f,hintText:m},k=$.extend(!0,{},F.dataVerification),w=$.extend(!0,[],F.data);w.length==0&&(w=kt.buildGridData(F));let C=S.row[0],T=S.row[1],O=S.column[0],z=S.column[1];for(let A=C;A<=T;A++)for(let E=O;E<=z;E++)k[A+"_"+E]=D,t=="checkbox"&&(D.checked?kr(A,E,w,D.value1):kr(A,E,w,D.value2));if(F.index==h.currentSheetIndex){let A=$.extend(!0,{},F.dataVerification);t=="checkbox"?ll.refOfCheckbox(A,k,h.currentSheetIndex,w,S):ll.ref(A,k,h.currentSheetIndex)}else F.dataVerification=k,F.data=w;P&&typeof P=="function"&&P()}function U5(e={}){let{range:n=h.luckysheet_select_save[h.luckysheet_select_save.length-1],order:t=Me(h.currentSheetIndex),success:l}={...e};if(G(n)=="string"){if(!y.iscelldata(n))return ke.info("The range parameter is invalid.","");let d=y.getcellrange(n);n={row:d.row,column:d.column}}if(G(n)!="object"||n.row==null||n.column==null)return ke.info("The range parameter is invalid.","");let o=h.luckysheetfile[t];if(o==null)return ke.info("The order parameter is invalid.","");let a=$.extend(!0,{},o.dataVerification),s=n.row[0],u=n.row[1],f=n.column[0],m=n.column[1];for(let d=s;d<=u;d++)for(let p=f;p<=m;p++)delete a[d+"_"+p];if(o.index==h.currentSheetIndex){let d=$.extend(!0,{},o.dataVerification);ll.ref(d,a,h.currentSheetIndex)}else o.dataVerification=a;l&&typeof l=="function"&&l()}function G5(e,n={}){let{order:t=Me(h.currentSheetIndex),rowIndex:l,colIndex:o,success:a}={...n},s=h.luckysheetfile[t];if(s==null)return ke.info("The order parameter is invalid.","");if(s.index==h.currentSheetIndex){let u=h.luckysheet_select_save[h.luckysheet_select_save.length-1];l==null&&(l=u.row_focus||0),l<0&&(l=0),l>h.visibledatarow.length&&(l=h.visibledatarow.length),o==null&&(o=u.column_focus||0),o<0&&(o=0),o>h.visibledatacolumn.length&&(o=h.visibledatacolumn.length);let f=o==0?0:h.visibledatacolumn[o-1],m=l==0?0:h.visibledatarow[l-1],d=new Image;d.onload=function(){let p=d.width,b=d.height,g={src:e,left:f,top:m,originWidth:p,originHeight:b};Pt.addImgItem(g),a&&typeof a=="function"&&a()},d.src=e}else{let u=s.images||{},f=s.config,m=s.zoomRatio||1,d=s.row,p=s.visibledatarow||[];if(p.length===0){let S=0;for(let I=0;I<d;I++){let P=h.defaultrowlen;if(f.rowlen!=null&&f.rowlen[I]!=null&&(P=f.rowlen[I]),f.rowhidden!=null&&f.rowhidden[I]!=null){p.push(S);continue}S+=Math.round((P+1)*m),p.push(S)}}let b=s.column,g=s.visibledatacolumn||[];if(g.length===0){let S=0;for(let I=0;I<b;I++){let P=h.defaultcollen;if(f.columnlen!=null&&f.columnlen[I]!=null&&(P=f.columnlen[I]),f.colhidden!=null&&f.colhidden[I]!=null){g.push(S);continue}S+=Math.round((P+1)*m),g.push(S)}}l==null&&(l=0),l<0&&(l=0),l>p.length&&(l=p.length),o==null&&(o=0),o<0&&(o=0),o>g.length&&(o=g.length);let v=o==0?0:g[o-1],x=l==0?0:p[l-1],_=new Image;_.onload=function(){let S={src:e,left:v,top:x,originWidth:_.width,originHeight:_.height},I,P,F=400;S.originHeight<S.originWidth?(P=Math.round(S.originHeight*(F/S.originWidth)),I=F):(I=Math.round(S.originWidth*(F/S.originHeight)),P=F);let D=$.extend(!0,{},Pt.imgItem);D.src=S.src,D.originWidth=S.originWidth,D.originHeight=S.originHeight,D.default.width=I,D.default.height=P,D.default.left=S.left,D.default.top=S.top,D.crop.width=I,D.crop.height=P;let k=Pt.generateRandomId();u[k]=D,s.images=u,a&&typeof a=="function"&&a()},_.src=e}}function Y5(e={}){let{order:n=Me(h.currentSheetIndex),idList:t="all",success:l}={...e},o=h.luckysheetfile[n];if(o==null)return ke.info("The order parameter is invalid.","");let a=o.images;if(a==null)return ke.info("The worksheet has no pictures to delete.","");if(t!="all"&&G(t)!="array")return ke.info("The idList parameter is invalid.","");G(t)=="array"?t.forEach(s=>{delete a[s]}):a=null,o.images=a,o.index==h.currentSheetIndex&&(Pt.currentImgId!=null&&(t=="all"||t.includes(Pt.currentImgId))&&($("#luckysheet-modal-dialog-activeImage").hide(),$("#luckysheet-modal-dialog-cropping").hide(),$("#luckysheet-modal-dialog-slider-imageCtrl").hide()),Pt.images=a,Pt.allImagesShow(),Pt.init()),l&&typeof l=="function"&&l()}function X5(e={}){let{order:n=Me(h.currentSheetIndex),success:t}={...e},l=h.luckysheetfile[n];return l==null?ke.info("The order parameter is invalid.",""):(setTimeout(function(){t&&typeof t=="function"&&t()},1),l.images)}function Z5(e,n={}){let{success:t}={...n};return setTimeout(()=>{t&&typeof t=="function"&&t()},0),kt.getGridData(e)}function K5(e,n={}){let{success:t}={...n};return setTimeout(()=>{t&&typeof t=="function"&&t()},0),kt.buildGridData({celldata:e})}function Uh(){let e=h.toJsonOptions;return e.title=$("#luckysheet_info_detail_input").val(),e.data=V1(),ur().forEach((n,t)=>{n.data!=null&&(e.data[t].row=G(n.data)==="array"?n.data.length:0,e.data[t].column=G(n.data[0])==="array"?n.data[0].length:0)}),e}function J5(e="zh"){if(!["zh","en","es"].includes(e))return ke.info("The lang parameter is invalid.","");let n=Uh();n.lang=e,luckysheet.create(n)}function Q5(){Ue.websocket!=null&&Ue.websocket.close(1e3)}function e_(e){if(e==null)return{column:h.luckysheet_select_save[h.luckysheet_select_save.length-1].column,row:h.luckysheet_select_save[h.luckysheet_select_save.length-1].row};let n=Mt.getRangeByTxt(e);return{column:n[0].column,row:n[0].row}}function t_(e=h.luckysheet_select_save){return G(e)==="object"&&(e=[e]),Mt.getTxtByRange(e)}function Mg(e){let{prevPage:n,nextPage:t,total:l}=Be().button;$("#luckysheet-bottom-pager").remove(),$("#luckysheet-sheet-content").after('<div id="luckysheet-bottom-pager" style="font-size: 14px; margin-left: 10px; display: inline-block;"></div>'),$("#luckysheet-bottom-pager").sPage({page:e.pageIndex,total:e.total,selectOption:e.selectOption,pageSize:e.pageSize,showTotal:e.showTotal,showSkip:e.showSkip,showPN:e.showPN,prevPage:e.prevPage||n,nextPage:e.nextPage||t,totalTxt:e.totalTxt||l+e.total,backFun:function(o){o.pageIndex=o.page,!!sl.createHookFunction("onTogglePager",o)}})}function l_(e){y.execFunctionGroupForce(!0),Xt(),setTimeout(()=>{e&&typeof e=="function"&&e()})}function r_(e={}){let{data:n,success:t}=e,l=h.luckysheetfile;for(let s=0;s<n.length;s++)for(let u=0;u<l.length;u++)l[u].index===n[s].index&&(l[u]=n[s]);let o=l[kt.getSheetIndex(h.currentSheetIndex)],a=kt.buildGridData(o);o.data=a,o.isPivotTable?(h.luckysheetcurrentisPivotTable=!0,isPivotInitial||Yt.changePivotTable(index)):(h.luckysheetcurrentisPivotTable=!1,$("#luckysheet-modal-dialog-slider-pivot").hide(),mr(!1)),kt.mergeCalculation(o.index),kt.setSheetParam(),setTimeout(function(){kt.showSheet(),kt.restoreCache(),y.execFunctionGroupForce(ut.forceCalculation),kt.restoreSheetAll(h.currentSheetIndex),Xt(),t&&typeof t=="function"&&t()},1),Ue.saveParam("shs",null,h.currentSheetIndex)}function Dg(e,n,t,l){if(e=e||h.flowdata,n==null&&t==null){let o=h.luckysheet_select_save[h.luckysheet_select_save.length-1];n=o.row_focus||o.row[0],t=o.column_focus||o.column[0]}_t.menuButtonFocus(e,n,t),setTimeout(()=>{l&&typeof l=="function"&&l()})}function gu(e,n){return Fg().every(({r:o,c:a})=>{let s=h.flowdata[o][a];return s==null?!1:s[e]==n})}var import_plugin,kf,mc=Nt(()=>{import_plugin=qe(Ye());il();Ol();fr();Xl();wi();Sr();hf();Kr();Qc();Wr();Sr();Jo();ui();Do();oc();fo();Er();Ar();sc();cr();Xo();tu();Sh();_a();qr();ln();ou();Vn();Di();ho();kn();mo();Go();jr();Rr();Ja();zh();fu();go();Qo();kf=qe(Za());fr();gc()});function S1(e,n,t,l,o){let a=h.visibledatarow[t],s=n-1==-1?0:h.visibledatarow[n-1],u=h.visibledatacolumn[o],f=l-1==-1?0:h.visibledatacolumn[l-1];$("#"+e).css({left:f,width:u-f-1,top:s,height:a-s-1})}function gl(e=!1){if($("#luckysheet-cell-selected-boxs").show(),$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").siblings(".luckysheet-cell-selected").remove(),h.luckysheet_select_save.length>0){for(let t=0;t<h.luckysheet_select_save.length;t++){let l=h.luckysheet_select_save[t].row[0],o=h.luckysheet_select_save[t].row[1],a=h.luckysheet_select_save[t].column[0],s=h.luckysheet_select_save[t].column[1],u,f;h.luckysheet_select_save[t].row_focus==null?u=l:u=h.luckysheet_select_save[t].row_focus,h.luckysheet_select_save[t].column_focus==null?f=a:f=h.luckysheet_select_save[t].column_focus;let m=h.visibledatarow[o],d=l-1==-1?0:h.visibledatarow[l-1],p=h.visibledatacolumn[s],b=a-1==-1?0:h.visibledatacolumn[a-1],g=h.visibledatarow[u],v=u-1==-1?0:h.visibledatarow[u-1],x=h.visibledatacolumn[f],_=f-1==-1?0:h.visibledatacolumn[f-1],S=_t.mergeborer(h.flowdata,u,f);S&&(g=S.row[1],v=S.row[0],x=S.column[1],_=S.column[0]),h.luckysheet_select_save[t].row=[l,o],h.luckysheet_select_save[t].column=[a,s],h.luckysheet_select_save[t].row_focus=u,h.luckysheet_select_save[t].column_focus=f,h.luckysheet_select_save[t].left=_,h.luckysheet_select_save[t].width=x-_-1,h.luckysheet_select_save[t].top=v,h.luckysheet_select_save[t].height=g-v-1,h.luckysheet_select_save[t].left_move=b,h.luckysheet_select_save[t].width_move=p-b-1,h.luckysheet_select_save[t].top_move=d,h.luckysheet_select_save[t].height_move=m-d-1,t==0?h.luckysheet_select_save.length==1?co.mobilecheck()?$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:h.luckysheet_select_save[t].left_move,width:h.luckysheet_select_save[t].width_move,top:h.luckysheet_select_save[t].top_move,height:h.luckysheet_select_save[t].height_move,display:"block",border:"1px solid #0188fb"}).find(".luckysheet-cs-draghandle").css("display","block").end().find(".luckysheet-cs-fillhandle").css("display","none").end().find(".luckysheet-cs-touchhandle").css("display","block"):$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:h.luckysheet_select_save[t].left_move,width:h.luckysheet_select_save[t].width_move,top:h.luckysheet_select_save[t].top_move,height:h.luckysheet_select_save[t].height_move,display:"block",border:"1px solid #0188fb"}).find(".luckysheet-cs-draghandle").css("display","block").end().find(".luckysheet-cs-fillhandle").css("display","block").end().find(".luckysheet-cs-touchhandle").css("display","none"):$("#luckysheet-cell-selected-boxs #luckysheet-cell-selected").css({left:h.luckysheet_select_save[t].left_move,width:h.luckysheet_select_save[t].width_move,top:h.luckysheet_select_save[t].top_move,height:h.luckysheet_select_save[t].height_move,display:"block",border:"1px solid rgba(1, 136, 251, 0.15)"}).find(".luckysheet-cs-draghandle").css("display","none").end().find(".luckysheet-cs-fillhandle").css("display","none"):$("#luckysheet-cell-selected-boxs").append('<div class="luckysheet-cell-selected" style="left: '+h.luckysheet_select_save[t].left_move+"px; width: "+h.luckysheet_select_save[t].width_move+"px; top: "+h.luckysheet_select_save[t].top_move+"px; height: "+h.luckysheet_select_save[t].height_move+'px; border: 1px solid rgba(1, 136, 251, 0.15); display: block;"></div>'),t==h.luckysheet_select_save.length-1&&($("#luckysheet-cell-selected-focus").css({left:h.luckysheet_select_save[t].left,width:h.luckysheet_select_save[t].width,top:h.luckysheet_select_save[t].top,height:h.luckysheet_select_save[t].height,display:"block"}),eo(h.luckysheet_select_save[t].left_move,h.luckysheet_select_save[t].top_move,h.luckysheet_select_save[t].width_move,h.luckysheet_select_save[t].height_move,[l,o],[a,s]),y.fucntionboxshow(u,f),ll.cellFocus(u,f))}n_(h.luckysheet_select_save,e),Gh(),h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]&&gy(h.luckysheet_select_save[0].row[0],h.luckysheet_select_save[0].column[0]),Dg()}h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_select_save=h.luckysheet_select_save;let n=JSON.stringify(h.luckysheet_select_save);h.luckysheet_select_save_previous==null|h.luckysheet_select_save_previous!==n&&sl.createHookFunction("rangeSelect",h.luckysheetfile[Me(h.currentSheetIndex)],h.luckysheet_select_save),h.luckysheet_select_save_previous=n}function n_(e,n=!1){let t=$.extend(!0,[],e),l={},o={};for(let u=0;u<t.length;u++){let f=t[u].row[0],m=t[u].row[1],d=t[u].column[0],p=t[u].column[1];l=W1(l,f,m),o=W1(o,d,p)}$("#luckysheet-rows-h-selected").empty();let a=q1(l);for(let u=0;u<a.length;u++){let f=a[u][0],m=a[u][a[u].length-1],d=Zr(m)[1],p=Zr(f)[0];$("#luckysheet-rows-h-selected").append('<div class="luckysheet-rows-h-selected" style="top: '+p+"px; height: "+(d-p-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}$("#luckysheet-cols-h-selected").empty();let s=q1(o);for(let u=0;u<s.length;u++){let f=s[u][0],m=s[u][s[u].length-1],d=or(m)[1],p=or(f)[0];$("#luckysheet-cols-h-selected").append('<div class="luckysheet-cols-h-selected" style="left: '+p+"px; width: "+(d-p-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}}function W1(e,n,t){let l=$.extend(!0,{},e);for(let o=n;o<=t;o++)o in l||(l[o]=0);return l}function q1(e){let n=[];for(let o in e)n.push(o);n.sort(function(o,a){return o-a});let t=[],l=[];if(n.length>1)for(let o=1;o<n.length;o++)n[o]-n[o-1]==1?(l.push(n[o-1]),o==n.length-1&&(l.push(n[o]),t.push(l))):o==1?o==n.length-1?(l.push(n[o-1]),t.push(l),t.push([n[o]])):t.push(n[0]):o==n.length-1?(l.push(n[o-1]),t.push(l),t.push([n[o]])):(l.push(n[o-1]),t.push(l),l=[]);else t.push([n[0]]);return t}function na(e){e==null&&(e=h.luckysheet_select_save),e=JSON.parse(JSON.stringify(e));let n=!1,t={};for(let l=0;l<e.length;l++){let o=e[l].row[0],a=e[l].row[1],s=e[l].column[0],u=e[l].column[1];for(let f=o;f<=a;f++)for(let m=s;m<=u;m++)if(f+"_"+m in t){n=!0;break}else t[f+"_"+m]=0}return n}function Ms(){let e=h.visibledatacolumn,n=h.visibledatarow;h.cooperativeEdit.changeCollaborationSize.forEach(t=>{if(t.i==h.currentSheetIndex){let l=t.v.column,o=e[l[0]]-1;t.v.column[0]!==0&&(o=e[l[1]]-e[l[0]-1]-(l[1]-l[0]+1));let a=t.v.row,s=n[a[0]]-1;t.v.row[0]!==0&&(s=n[a[1]]-n[a[0]-1]-(a[1]-a[0]+1));let u=h.cooperativeEdit.merge_range,f=e[t.v.column[0]-1]-1,m=n[t.v.row[0]-1]-1;if(h.config.columnlen!==null){for(let g in h.config.columnlen)if(t.v.column[0]<=g&&g<=t.v.column[1]){h.luckysheet_cols_change_size_start[1]=g-0;break}}if(h.config.rowlen!==null){for(let g in h.config.rowlen)if(t.v.row[0]<=g&&g<=t.v.row[1]){h.luckysheet_rows_change_size_start[1]=g-0;break}}if(t.v.column[0]<=h.luckysheet_cols_change_size_start[1]&&h.luckysheet_cols_change_size_start[1]<=t.v.column[1])if(h.luckysheet_cols_change_size_start[1]==0)o=e[0]-1;else{let g=t.v.column;o=e[g[1]]-e[g[0]-1]-(g[1]-g[0]+1)}if(t.v.row[0]<=h.luckysheet_rows_change_size_start[1]&&h.luckysheet_rows_change_size_start[1]<=t.v.row[1])if(h.luckysheet_rows_change_size_start[1]==0)s=n[0]-1;else{let g=t.v.row;s=n[g[1]]-n[g[0]-1]-(g[1]-g[0]+1)}if(Object.keys(u).length>0){let g=!1;if(u.v.length>1&&(g=u.v[1][0]==null||Object.keys(u.v[1][0]).length>0),u.v[0].length>1&&(g=u.v[0][1]==null||Object.keys(u.v[0][1]).length>0),g){let v=u.column[0]<=t.v.column[0]&&u.column[1]>=t.v.column[1];if(f=e[u.column[0]-1]-1,m=n[u.row[0]-1]-1,o=e[u.column[1]]-1,s=n[u.row[1]]-1,v){if(u.column[0]!==0){let _=u.column;o=e[_[1]]-e[_[0]-1]-(_[1]-_[0]+1)}else f=0;t.v.column=u.column}if(u.row[0]<=t.v.row[0]&&u.row[1]>=t.v.row[1]){if(u.row[0]!==0){let _=u.row;s=n[_[1]]-n[_[0]-1]-(_[1]-_[0]+1)}else m=0;t.v.row=u.row}}else o=e[l[0]]-e[l[0]-1]-1,l[0]===0&&(o=e[l[0]]-1),s=n[a[0]]-n[a[0]-1]-1,a[0]===0&&(s=n[a[0]]-1)}$("#luckysheet-multipleRange-show-"+t.id).css({height:s,width:o,top:m+"px",left:f+"px"});let b=$("#luckysheet-multipleRange-show-"+t.id)[0].offsetHeight-1;$("#luckysheet-multipleRange-show-"+t.id+">.username").css({bottom:b+"px"})}})}function gr(e){if($("#luckysheet-selection-copy").empty(),e==null&&(e=h.luckysheet_selection_range),e=JSON.parse(JSON.stringify(e)),e.length>0)for(let n=0;n<e.length;n++){let t=e[n].row[0],l=e[n].row[1],o=e[n].column[0],a=e[n].column[1],s=h.visibledatarow[l],u=t-1==-1?0:h.visibledatarow[t-1],f=h.visibledatacolumn[a],m=o-1==-1?0:h.visibledatacolumn[o-1],d='<div class="luckysheet-selection-copy" style="display: block; left: '+m+"px; width: "+(f-m-1)+"px; top: "+u+"px; height: "+(s-u-1)+'px;"><div class="luckysheet-selection-copy-top luckysheet-copy"></div><div class="luckysheet-selection-copy-right luckysheet-copy"></div><div class="luckysheet-selection-copy-bottom luckysheet-copy"></div><div class="luckysheet-selection-copy-left luckysheet-copy"></div><div class="luckysheet-selection-copy-hc"></div></div>';$("#luckysheet-selection-copy").append(d)}}function eo(e,n,t,l,o,a){let s=o[1]-o[0]+1,u=a[1]-a[0]+1,f=h.luckysheetTableContentHW[0],m=h.luckysheetTableContentHW[1],d=$("#luckysheet-cell-main").scrollLeft(),p=$("#luckysheet-cell-main").scrollTop(),g=Be().info;if(s>=4){let v=e-25;v<0&&(v=e+5),v<d&&(v=d+10);let x=n+l/2;l>m&&(x=p+m/2),$("#luckysheet-row-count-show").css({left:v,top:x,display:"block",width:"11px"}).html("<div>"+s.toString().split("").join("</div><div>")+"</div><div>"+g.row+"</div>")}else $("#luckysheet-row-count-show").hide();if(u>=4){let v=n-25;v<0&&(v=n+5),v<p&&(v=p+10);let x=e+t/2;t>f&&(x=d+f/2),$("#luckysheet-column-count-show").css({left:x,top:v,display:"block"}).text(u+g.column)}else $("#luckysheet-column-count-show").hide()}function Gh(){let e=h.luckysheet_select_save[h.luckysheet_select_save.length-1],n=e.row_focus,t=e.column_focus;h.config.merge!=null&&n+"_"+t in h.config.merge?$("#luckysheet-helpbox-cell").text(Kl(h.currentSheetIndex,{column:[t,t],row:[n,n]})):$("#luckysheet-helpbox-cell").text(Kl(h.currentSheetIndex,e))}var import_plugin,jr=Nt(()=>{import_plugin=qe(Ye());ln();Sr();gh();Ri();Oc();go();fr();il();wi();Xl();mc()});var import_plugin,i_,zg,U1=Nt(()=>{import_plugin=qe(Ye());Ol();Rr();ln();Wr();Kr();cr();il();Xl();i_={moneyFmtList:[{name:"\u4EBA\u6C11\u5E01",pos:"before",value:"\xA5"},{name:"\u7F8E\u5143",pos:"before",value:"$"},{name:"\u6B27\u5143",pos:"before",value:"\u20AC"},{name:"\u82F1\u9551",pos:"before",value:"\uFFE1"},{name:"\u6E2F\u5143",pos:"before",value:"$"},{name:"\u65E5\u5143",pos:"before",value:"\uFFE5"},{name:"\u963F\u5C14\u5DF4\u5C3C\u4E9A\u5217\u514B",pos:"before",value:"Lek"},{name:"\u963F\u5C14\u53CA\u5229\u4E9A\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u963F\u5BCC\u6C57\u5C3C",pos:"after",value:"Af"},{name:"\u963F\u6839\u5EF7\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u963F\u62C9\u4F2F\u8054\u5408\u914B\u957F\u56FD\u8FEA\u62C9\u59C6",pos:"before",value:"dh"},{name:"\u963F\u9C81\u5DF4\u5F17\u7F57\u6797",pos:"before",value:"Afl"},{name:"\u963F\u66FC\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u963F\u585E\u62DC\u7586\u9A6C\u7EB3\u7279",pos:"before",value:"?"},{name:"\u57C3\u53CA\u9551",pos:"before",value:"\uFFE1"},{name:"\u57C3\u585E\u4FC4\u6BD4\u4E9A\u6BD4\u5C14",pos:"before",value:"Birr"},{name:"\u5B89\u54E5\u62C9\u5BBD\u624E",pos:"before",value:"Kz"},{name:"\u6FB3\u5927\u5229\u4E9A\u5143",pos:"before",value:"$"},{name:"\u6FB3\u95E8\u5143",pos:"before",value:"MOP"},{name:"\u5DF4\u5DF4\u591A\u65AF\u5143",pos:"before",value:"$"},{name:"\u5DF4\u5E03\u4E9A\u65B0\u51E0\u5185\u4E9A\u57FA\u90A3",pos:"before",value:"PGK"},{name:"\u5DF4\u54C8\u9A6C\u5143",pos:"before",value:"$"},{name:"\u5DF4\u57FA\u65AF\u5766\u5362\u6BD4",pos:"before",value:"Rs"},{name:"\u5DF4\u62C9\u572D\u74DC\u62C9\u5C3C",pos:"after",value:"Gs"},{name:"\u5DF4\u6797\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u5DF4\u62FF\u9A6C\u5DF4\u6CE2\u4E9A",pos:"before",value:"B/"},{name:"\u5DF4\u897F\u91CC\u4E9A\u4F0A",pos:"before",value:"R$"},{name:"\u767D\u4FC4\u7F57\u65AF\u5362\u5E03",pos:"after",value:"\u0440"},{name:"\u767E\u6155\u5927\u5143",pos:"before",value:"$"},{name:"\u4FDD\u52A0\u5229\u4E9A\u5217\u5F17",pos:"before",value:"lev"},{name:"\u51B0\u5C9B\u514B\u6717",pos:"before",value:"kr"},{name:"\u6CE2\u9ED1\u53EF\u5151\u6362\u9A6C\u514B",pos:"before",value:"KM"},{name:"\u6CE2\u5170\u5179\u7F57\u63D0",pos:"after",value:"z?"},{name:"\u73BB\u5229\u7EF4\u4E9A\u8BFA",pos:"before",value:"Bs"},{name:"\u4F2F\u5229\u5179\u5143",pos:"before",value:"$"},{name:"\u535A\u8328\u74E6\u7EB3\u666E\u62C9",pos:"before",value:"P"},{name:"\u4E0D\u4E39\u52AA\u624E\u59C6",pos:"before",value:"Nu"},{name:"\u5E03\u9686\u8FEA\u6CD5\u90CE",pos:"before",value:"FBu"},{name:"\u671D\u9C9C\u5706",pos:"before",value:"?KP"},{name:"\u4E39\u9EA6\u514B\u6717",pos:"after",value:"kr"},{name:"\u4E1C\u52A0\u52D2\u6BD4\u5143",pos:"before",value:"$"},{name:"\u591A\u7C73\u5C3C\u52A0\u6BD4\u7D22",pos:"before",value:"RD$"},{name:"\u4FC4\u56FD\u5362\u5E03",pos:"after",value:"?"},{name:"\u5384\u7ACB\u7279\u91CC\u4E9A\u7EB3\u514B\u6CD5",pos:"before",value:"Nfk"},{name:"\u975E\u6D32\u91D1\u878D\u5171\u540C\u4F53\u6CD5\u90CE",pos:"before",value:"CFA"},{name:"\u83F2\u5F8B\u5BBE\u6BD4\u7D22",pos:"before",value:"?"},{name:"\u6590\u6D4E\u5143",pos:"before",value:"$"},{name:"\u4F5B\u5F97\u89D2\u57C3\u65AF\u5E93\u591A",pos:"before",value:"CVE"},{name:"\u798F\u514B\u5170\u7FA4\u5C9B\u9551",pos:"before",value:"\uFFE1"},{name:"\u5188\u6BD4\u4E9A\u8FBE\u62C9\u897F",pos:"before",value:"GMD"},{name:"\u521A\u679C\u6CD5\u90CE",pos:"before",value:"FrCD"},{name:"\u54E5\u4F26\u6BD4\u4E9A\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u54E5\u65AF\u8FBE\u9ECE\u52A0\u79D1\u6717",pos:"before",value:"?"},{name:"\u53E4\u5DF4\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u53E4\u5DF4\u53EF\u5151\u6362\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u572D\u4E9A\u90A3\u5143",pos:"before",value:"$"},{name:"\u54C8\u8428\u514B\u65AF\u5766\u575A\u6208",pos:"before",value:"?"},{name:"\u6D77\u5730\u53E4\u5FB7",pos:"before",value:"HTG"},{name:"\u97E9\u5143",pos:"before",value:"?"},{name:"\u8377\u5C5E\u5B89\u7684\u5217\u65AF\u76FE",pos:"before",value:"NAf."},{name:"\u6D2A\u90FD\u62C9\u65AF\u62C9\u4F26\u76AE\u62C9",pos:"before",value:"L"},{name:"\u5409\u5E03\u63D0\u6CD5\u90CE",pos:"before",value:"Fdj"},{name:"\u5409\u5C14\u5409\u65AF\u65AF\u5766\u7D22\u59C6",pos:"before",value:"KGS"},{name:"\u51E0\u5185\u4E9A\u6CD5\u90CE",pos:"before",value:"FG"},{name:"\u52A0\u62FF\u5927\u5143",pos:"before",value:"$"},{name:"\u52A0\u7EB3\u585E\u5730",pos:"before",value:"GHS"},{name:"\u67EC\u57D4\u5BE8\u745E\u5C14",pos:"before",value:"Riel"},{name:"\u6377\u514B\u514B\u6717",pos:"after",value:"K?"},{name:"\u6D25\u5DF4\u5E03\u97E6\u5143",pos:"before",value:"$"},{name:"\u5361\u5854\u5C14\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u5F00\u66FC\u7FA4\u5C9B\u5143",pos:"before",value:"$"},{name:"\u79D1\u6469\u7F57\u6CD5\u90CE",pos:"before",value:"CF"},{name:"\u79D1\u5A01\u7279\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u514B\u7F57\u5730\u4E9A\u5E93\u7EB3",pos:"before",value:"kn"},{name:"\u80AF\u5C3C\u4E9A\u5148\u4EE4",pos:"before",value:"Ksh"},{name:"\u83B1\u7D22\u6258\u6D1B\u8482",pos:"before",value:"LSL"},{name:"\u8001\u631D\u57FA\u666E",pos:"before",value:"?"},{name:"\u9ECE\u5DF4\u5AE9\u9551",pos:"before",value:"L\uFFE1"},{name:"\u7ACB\u9676\u5B9B\u7ACB\u7279",pos:"before",value:"Lt"},{name:"\u5229\u6BD4\u4E9A\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u5229\u6BD4\u4E9A\u5143",pos:"before",value:"$"},{name:"\u5362\u65FA\u8FBE\u6CD5\u90CE",pos:"before",value:"RF"},{name:"\u7F57\u9A6C\u5C3C\u4E9A\u5217\u4F0A",pos:"before",value:"RON"},{name:"\u9A6C\u8FBE\u52A0\u65AF\u52A0\u963F\u91CC\u4E9A\u91CC",pos:"before",value:"Ar"},{name:"\u9A6C\u5C14\u4EE3\u592B\u62C9\u83F2\u4E9A",pos:"before",value:"Rf"},{name:"\u9A6C\u62C9\u7EF4\u514B\u74E6\u67E5",pos:"before",value:"MWK"},{name:"\u9A6C\u6765\u897F\u4E9A\u6797\u5409\u7279",pos:"before",value:"RM"},{name:"\u9A6C\u5176\u987F\u6234\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u6BDB\u91CC\u6C42\u65AF\u5362\u6BD4",pos:"before",value:"MURs"},{name:"\u6BDB\u91CC\u5854\u5C3C\u4E9A\u4E4C\u5409\u4E9A",pos:"before",value:"MRO"},{name:"\u8499\u53E4\u56FE\u683C\u91CC\u514B",pos:"before",value:"?"},{name:"\u5B5F\u52A0\u62C9\u5854\u5361",pos:"before",value:"?"},{name:"\u79D8\u9C81\u65B0\u7D22\u5C14",pos:"before",value:"S/"},{name:"\u7F05\u7538\u5F00\u4E9A\u7279",pos:"before",value:"K"},{name:"\u6469\u5C14\u591A\u74E6\u5217\u4F0A",pos:"before",value:"MDL"},{name:"\u6469\u6D1B\u54E5\u8FEA\u62C9\u59C6",pos:"before",value:"dh"},{name:"\u83AB\u6851\u6BD4\u514B\u6885\u8482\u5361\u5C14",pos:"before",value:"MTn"},{name:"\u58A8\u897F\u54E5\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u7EB3\u7C73\u6BD4\u4E9A\u5143",pos:"before",value:"$"},{name:"\u5357\u975E\u5170\u7279",pos:"before",value:"R"},{name:"\u5357\u82CF\u4E39\u9551",pos:"before",value:"\uFFE1"},{name:"\u5C3C\u52A0\u62C9\u74DC\u79D1\u591A\u5DF4",pos:"before",value:"C$"},{name:"\u5C3C\u6CCA\u5C14\u5362\u6BD4",pos:"before",value:"Rs"},{name:"\u5C3C\u65E5\u5229\u4E9A\u5948\u62C9",pos:"before",value:"?"},{name:"\u632A\u5A01\u514B\u6717",pos:"after",value:"kr"},{name:"\u4E54\u6CBB\u4E9A\u62C9\u745E",pos:"before",value:"GEL"},{name:"\u4EBA\u6C11\u5E01\uFF08\u79BB\u5CB8\uFF09",pos:"before",value:"\uFFE5"},{name:"\u745E\u5178\u514B\u6717",pos:"after",value:"kr"},{name:"\u745E\u58EB\u6CD5\u90CE",pos:"before",value:"CHF"},{name:"\u585E\u5C14\u7EF4\u4E9A\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u585E\u62C9\u5229\u6602\u5229\u6602",pos:"before",value:"SLL"},{name:"\u585E\u820C\u5C14\u5362\u6BD4",pos:"before",value:"SCR"},{name:"\u6C99\u7279\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u5723\u591A\u7F8E\u591A\u5E03\u62C9",pos:"before",value:"Db"},{name:"\u5723\u8D6B\u52D2\u62FF\u7FA4\u5C9B\u78C5",pos:"before",value:"\uFFE1"},{name:"\u65AF\u91CC\u5170\u5361\u5362\u6BD4",pos:"before",value:"Rs"},{name:"\u65AF\u5A01\u58EB\u5170\u91CC\u5170\u5409\u5C3C",pos:"before",value:"SZL"},{name:"\u82CF\u4E39\u9551",pos:"before",value:"SDG"},{name:"\u82CF\u91CC\u5357\u5143",pos:"before",value:"$"},{name:"\u6240\u7F57\u95E8\u7FA4\u5C9B\u5143",pos:"before",value:"$"},{name:"\u7D22\u9A6C\u91CC\u5148\u4EE4",pos:"before",value:"SOS"},{name:"\u5854\u5409\u514B\u65AF\u5766\u7D22\u83AB\u5C3C",pos:"before",value:"Som"},{name:"\u592A\u5E73\u6D0B\u6CD5\u90CE",pos:"after",value:"FCFP"},{name:"\u6CF0\u56FD\u94E2",pos:"before",value:"?"},{name:"\u5766\u6851\u5C3C\u4E9A\u5148\u4EE4",pos:"before",value:"TSh"},{name:"\u6C64\u52A0\u6F58\u52A0",pos:"before",value:"T$"},{name:"\u7279\u7ACB\u5C3C\u8FBE\u548C\u591A\u5DF4\u54E5\u5143",pos:"before",value:"$"},{name:"\u7A81\u5C3C\u65AF\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u571F\u8033\u5176\u91CC\u62C9",pos:"before",value:"?"},{name:"\u74E6\u52AA\u963F\u56FE\u74E6\u56FE",pos:"before",value:"VUV"},{name:"\u5371\u5730\u9A6C\u62C9\u683C\u67E5\u5C14",pos:"before",value:"Q"},{name:"\u59D4\u5185\u745E\u62C9\u535A\u5229\u74E6",pos:"before",value:"Bs"},{name:"\u6587\u83B1\u5143",pos:"before",value:"$"},{name:"\u4E4C\u5E72\u8FBE\u5148\u4EE4",pos:"before",value:"UGX"},{name:"\u4E4C\u514B\u5170\u683C\u91CC\u592B\u5C3C\u4E9A",pos:"before",value:"\u0433\u0440\u043D."},{name:"\u4E4C\u62C9\u572D\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u4E4C\u5179\u522B\u514B\u65AF\u5766\u82CF\u59C6",pos:"before",value:"so?m"},{name:"\u897F\u8428\u6469\u4E9A\u5854\u62C9",pos:"before",value:"WST"},{name:"\u65B0\u52A0\u5761\u5143",pos:"before",value:"$"},{name:"\u65B0\u53F0\u5E01",pos:"before",value:"NT$"},{name:"\u65B0\u897F\u5170\u5143",pos:"before",value:"$"},{name:"\u5308\u7259\u5229\u798F\u6797",pos:"before",value:"Ft"},{name:"\u53D9\u5229\u4E9A\u9551",pos:"before",value:"\uFFE1"},{name:"\u7259\u4E70\u52A0\u5143",pos:"before",value:"$"},{name:"\u4E9A\u7F8E\u5C3C\u4E9A\u5FB7\u62C9\u59C6",pos:"before",value:"Dram"},{name:"\u4E5F\u95E8\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u4F0A\u62C9\u514B\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u4F0A\u6717\u91CC\u4E9A\u5C14",pos:"before",value:"Rial"},{name:"\u4EE5\u8272\u5217\u65B0\u8C22\u514B\u5C14",pos:"before",value:"?"},{name:"\u5370\u5EA6\u5362\u6BD4",pos:"before",value:"?"},{name:"\u5370\u5EA6\u5C3C\u897F\u4E9A\u5362\u6BD4",pos:"before",value:"Rp"},{name:"\u7EA6\u65E6\u7B2C\u7EB3\u5C14",pos:"before",value:"din"},{name:"\u8D8A\u5357\u76FE",pos:"after",value:"?"},{name:"\u8D5E\u6BD4\u4E9A\u514B\u74E6\u67E5",pos:"before",value:"ZMW"},{name:"\u76F4\u5E03\u7F57\u9640\u9551",pos:"before",value:"\uFFE1"},{name:"\u667A\u5229\u6BD4\u7D22",pos:"before",value:"$"},{name:"\u4E2D\u975E\u91D1\u878D\u5408\u4F5C\u6CD5\u90CE",pos:"before",value:"FCFA"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"1930\u5E748\u67085\u65E5",value:'yyyy"\u5E74"M"\u6708"d"\u65E5"'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"8\u67085\u65E5",value:'M"\u6708"d"\u65E5"'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"\u4E0B\u534801:30",value:"\u4E0A\u5348/\u4E0B\u5348 hh:mm"},{name:"\u4E0B\u53481:30",value:"\u4E0A\u5348/\u4E0B\u5348 h:mm"},{name:"\u4E0B\u53481:30:30",value:"\u4E0A\u5348/\u4E0B\u5348 h:mm:ss"},{name:"08-05 \u4E0B\u534801:30",value:"MM-dd \u4E0A\u5348/\u4E0B\u5348 hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],createDialog:function(e){let n=this,t=Be().currencyDetail,l=Be().format,o=Be().button;this.moneyFmtList=[{name:t.RMB,pos:"before",value:"\xA5"},{name:t.USdollar,pos:"before",value:"$"},{name:t.EUR,pos:"before",value:"\u20AC"},{name:t.GBP,pos:"before",value:"\uFFE1"},{name:t.HK,pos:"before",value:"$"},{name:t.JPY,pos:"before",value:"\uFFE5"},{name:t.AlbanianLek,pos:"before",value:"Lek"},{name:t.AlgerianDinar,pos:"before",value:"din"},{name:t.Afghani,pos:"after",value:"Af"},{name:t.ArgentinePeso,pos:"before",value:"$"},{name:t.UnitedArabEmiratesDirham,pos:"before",value:"dh"},{name:t.ArubanFlorin,pos:"before",value:"Afl"},{name:t.OmaniRial,pos:"before",value:"Rial"},{name:t.Azerbaijanimanat,pos:"before",value:"?"},{name:t.EgyptianPound,pos:"before",value:"\uFFE1"},{name:t.EthiopianBirr,pos:"before",value:"Birr"},{name:t.AngolaKwanza,pos:"before",value:"Kz"},{name:t.AustralianDollar,pos:"before",value:"$"},{name:t.Patacas,pos:"before",value:"MOP"},{name:t.BarbadosDollar,pos:"before",value:"$"},{name:t.PapuaNewGuineaKina,pos:"before",value:"PGK"},{name:t.BahamianDollar,pos:"before",value:"$"},{name:t.PakistanRupee,pos:"before",value:"Rs"},{name:t.ParaguayanGuarani,pos:"after",value:"Gs"},{name:t.BahrainiDinar,pos:"before",value:"din"},{name:t.PanamanianBalboa,pos:"before",value:"B/"},{name:t.Brazilianreal,pos:"before",value:"R$"},{name:t.Belarusianruble,pos:"after",value:"\u0440"},{name:t.BermudianDollar,pos:"before",value:"$"},{name:t.BulgarianLev,pos:"before",value:"lev"},{name:t.IcelandKrona,pos:"before",value:"kr"},{name:t.BosniaHerzegovinaConvertibleMark,pos:"before",value:"KM"},{name:t.PolishZloty,pos:"after",value:"z?"},{name:t.Boliviano,pos:"before",value:"Bs"},{name:t.BelizeDollar,pos:"before",value:"$"},{name:t.BotswanaPula,pos:"before",value:"P"},{name:t.NotDannuzhamu,pos:"before",value:"Nu"},{name:t.BurundiFranc,pos:"before",value:"FBu"},{name:t.NorthKoreanWon,pos:"before",value:"?KP"},{name:t.DanishKrone,pos:"after",value:"kr"},{name:t.EastCaribbeanDollar,pos:"before",value:"$"},{name:t.DominicaPeso,pos:"before",value:"RD$"},{name:t.RussianRuble,pos:"after",value:"?"},{name:t.EritreanNakfa,pos:"before",value:"Nfk"},{name:t.CFAfranc,pos:"before",value:"CFA"},{name:t.PhilippinePeso,pos:"before",value:"?"},{name:t.FijiDollar,pos:"before",value:"$"},{name:t.CapeVerdeEscudo,pos:"before",value:"CVE"},{name:t.FalklandIslandsPound,pos:"before",value:"\uFFE1"},{name:t.GambianDalasi,pos:"before",value:"GMD"},{name:t.Congolesefranc,pos:"before",value:"FrCD"},{name:t.ColombianPeso,pos:"before",value:"$"},{name:t.CostaRicanColon,pos:"before",value:"?"},{name:t.CubanPeso,pos:"before",value:"$"},{name:t.Cubanconvertiblepeso,pos:"before",value:"$"},{name:t.GuyanaDollar,pos:"before",value:"$"},{name:t.KazakhstanTenge,pos:"before",value:"?"},{name:t.Haitiangourde,pos:"before",value:"HTG"},{name:t.won,pos:"before",value:"?"},{name:t.NetherlandsAntillesGuilder,pos:"before",value:"NAf."},{name:t.Honduraslempiras,pos:"before",value:"L"},{name:t.DjiboutiFranc,pos:"before",value:"Fdj"},{name:t.KyrgyzstanSom,pos:"before",value:"KGS"},{name:t.GuineaFranc,pos:"before",value:"FG"},{name:t.CanadianDollar,pos:"before",value:"$"},{name:t.GhanaianCedi,pos:"before",value:"GHS"},{name:t.Cambodianriel,pos:"before",value:"Riel"},{name:t.CzechKoruna,pos:"after",value:"K?"},{name:t.ZimbabweDollar,pos:"before",value:"$"},{name:t.QatariRiyal,pos:"before",value:"Rial"},{name:t.CaymanIslandsDollar,pos:"before",value:"$"},{name:t.Comorianfranc,pos:"before",value:"CF"},{name:t.KuwaitiDinar,pos:"before",value:"din"},{name:t.CroatianKuna,pos:"before",value:"kn"},{name:t.KenyanShilling,pos:"before",value:"Ksh"},{name:t.LesothoLoti,pos:"before",value:"LSL"},{name:t.LaoKip,pos:"before",value:"?"},{name:t.LebanesePound,pos:"before",value:"L\uFFE1"},{name:t.Lithuanianlitas,pos:"before",value:"Lt"},{name:t.LibyanDinar,pos:"before",value:"din"},{name:t.LiberianDollar,pos:"before",value:"$"},{name:t.RwandaFranc,pos:"before",value:"RF"},{name:t.RomanianLeu,pos:"before",value:"RON"},{name:t.MalagasyAriary,pos:"before",value:"Ar"},{name:t.MaldivianRufiyaa,pos:"before",value:"Rf"},{name:t.MalawiKwacha,pos:"before",value:"MWK"},{name:t.MalaysianRinggit,pos:"before",value:"RM"},{name:t.MacedoniawearingDinar,pos:"before",value:"din"},{name:t.MauritiusRupee,pos:"before",value:"MURs"},{name:t.MauritanianOuguiya,pos:"before",value:"MRO"},{name:t.MongolianTugrik,pos:"before",value:"?"},{name:t.BangladeshiTaka,pos:"before",value:"?"},{name:t.PeruvianNuevoSol,pos:"before",value:"S/"},{name:t.MyanmarKyat,pos:"before",value:"K"},{name:t.MoldovanLeu,pos:"before",value:"MDL"},{name:t.MoroccanDirham,pos:"before",value:"dh"},{name:t.MozambiqueMetical,pos:"before",value:"MTn"},{name:t.MexicanPeso,pos:"before",value:"$"},{name:t.NamibianDollar,pos:"before",value:"$"},{name:t.SouthAfricanRand,pos:"before",value:"R"},{name:t.SouthSudanesePound,pos:"before",value:"\uFFE1"},{name:t.NicaraguaCordoba,pos:"before",value:"C$"},{name:t.NepaleseRupee,pos:"before",value:"Rs"},{name:t.NigerianNaira,pos:"before",value:"?"},{name:t.NorwegianKrone,pos:"after",value:"kr"},{name:t.GeorgianLari,pos:"before",value:"GEL"},{name:t.RenminbiOffshore,pos:"before",value:"\uFFE5"},{name:t.SwedishKrona,pos:"after",value:"kr"},{name:t.SwissFranc,pos:"before",value:"CHF"},{name:t.SerbianDinar,pos:"before",value:"din"},{name:t.SierraLeone,pos:"before",value:"SLL"},{name:t.SeychellesRupee,pos:"before",value:"SCR"},{name:t.SaudiRiyal,pos:"before",value:"Rial"},{name:t.SaoTomeDobra,pos:"before",value:"Db"},{name:t.SaintHelenapound,pos:"before",value:"\uFFE1"},{name:t.SriLankaRupee,pos:"before",value:"Rs"},{name:t.SwazilandLilangeni,pos:"before",value:"SZL"},{name:t.SudanesePound,pos:"before",value:"SDG"},{name:t.Surinamesedollar,pos:"before",value:"$"},{name:t.SolomonIslandsDollar,pos:"before",value:"$"},{name:t.SomaliShilling,pos:"before",value:"SOS"},{name:t.TajikistanSomoni,pos:"before",value:"Som"},{name:t.PacificFranc,pos:"after",value:"FCFP"},{name:t.ThaiBaht,pos:"before",value:"?"},{name:t.TanzanianShilling,pos:"before",value:"TSh"},{name:t.TonganPaanga,pos:"before",value:"T$"},{name:t.TrinidadandTobagoDollar,pos:"before",value:"$"},{name:t.TunisianDinar,pos:"before",value:"din"},{name:t.TurkishLira,pos:"before",value:"?"},{name:t.VanuatuVatu,pos:"before",value:"VUV"},{name:t.GuatemalanQuetzal,pos:"before",value:"Q"},{name:t.CommissionBolivar,pos:"before",value:"Bs"},{name:t.BruneiDollar,pos:"before",value:"$"},{name:t.UgandanShilling,pos:"before",value:"UGX"},{name:t.UkrainianHryvnia,pos:"before",value:"\u0433\u0440\u043D."},{name:t.UruguayanPeso,pos:"before",value:"$"},{name:t.Uzbekistansom,pos:"before",value:"so?m"},{name:t.WesternSamoaTala,pos:"before",value:"WST"},{name:t.SingaporeDollar,pos:"before",value:"$"},{name:t.NT,pos:"before",value:"NT$"},{name:t.NewZealandDollar,pos:"before",value:"$"},{name:t.HungarianForint,pos:"before",value:"Ft"},{name:t.SyrianPound,pos:"before",value:"\uFFE1"},{name:t.JamaicanDollar,pos:"before",value:"$"},{name:t.ArmenianDram,pos:"before",value:"Dram"},{name:t.YemeniRial,pos:"before",value:"Rial"},{name:t.IraqiDinar,pos:"before",value:"din"},{name:t.IranianRial,pos:"before",value:"Rial"},{name:t.NewIsraeliShekel,pos:"before",value:"?"},{name:t.IndianRupee,pos:"before",value:"?"},{name:t.IndonesianRupiah,pos:"before",value:"Rp"},{name:t.JordanianDinar,pos:"before",value:"din"},{name:t.VND,pos:"after",value:"?"},{name:t.ZambianKwacha,pos:"before",value:"ZMW"},{name:t.GibraltarPound,pos:"before",value:"\uFFE1"},{name:t.ChileanPeso,pos:"before",value:"$"},{name:t.CFAFrancBEAC,pos:"before",value:"FCFA"}],this.dateFmtList=Be().dateFmtList,this.numFmtList=[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-moreFormat-dialog").remove();let a="",s="";if(e=="morecurrency"){a=l.titleCurrency;let v="";for(let x=0;x<n.moneyFmtList.length;x++){let _=n.moneyFmtList[x].name,S=n.moneyFmtList[x].pos,I=n.moneyFmtList[x].value;v+='<div class="listItem"><div class="name">'+_+'</div><div class="value">'+I+'</div><input type="hidden" value="'+S+'"/></div>'}s='<div class="box" id="morecurrency"><div class="decimal"><label>'+l.decimalPlaces+'\uFF1A</label><input type="number" class="formulaInputFocus" value="2" min="0" max="9"/></div><div class="listbox">'+v+"</div></div>"}else if(e=="moredatetime"){a=l.titleDateTime;let v="";for(let x=0;x<n.dateFmtList.length;x++){let _=n.dateFmtList[x].name,S=n.dateFmtList[x].value;v+='<div class="listItem"><div class="name">'+_+'</div><div class="value">'+S+"</div></div>"}s='<div class="box" id="moredatetime"><div class="listbox">'+v+"</div></div>"}else if(e=="moredigit"){a=l.titleNumber;let v="";for(let x=0;x<n.numFmtList.length;x++){let _=n.numFmtList[x].name,S=n.numFmtList[x].value;v+='<div class="listItem"><div class="name">'+_+'</div><div class="value">'+S+"</div></div>"}s='<div class="box" id="moredigit"><div class="listbox">'+v+"</div></div>"}$("body").first().append(Tt(Ll,{id:"luckysheet-moreFormat-dialog",addclass:"luckysheet-moreFormat-dialog",title:a,content:s,botton:'<button id="luckysheet-moreFormat-dialog-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>",style:"z-index:100003"}));let u=$("#luckysheet-moreFormat-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),f=u.outerHeight(),m=u.outerWidth(),d=$(window).width(),p=$(window).height(),b=$(document).scrollLeft(),g=$(document).scrollTop();$("#luckysheet-moreFormat-dialog").css({left:(d+b-m)/2,top:(p+g-f)/3}).show(),$("#luckysheet-moreFormat-dialog .listbox .listItem").eq(0).addClass("on")},init:function(){let e=this;$(document).on("click","#luckysheet-moreFormat-dialog .listbox .listItem",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.moreFormatConfirm").on("click.moreFormatConfirm","#luckysheet-moreFormat-dialog #luckysheet-moreFormat-dialog-confirm",function(){$("#luckysheet-moreFormat-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide();let n=It.deepCopyFlowData(h.flowdata),t=$("#luckysheet-moreFormat-dialog .listbox .listItem.on .value").text(),l=$(this).parents("#luckysheet-moreFormat-dialog").find(".box").attr("id");if(l=="morecurrency"){if(t.indexOf("?")!=-1)return;let o=parseInt($("#luckysheet-moreFormat-dialog .decimal input").val().trim());if(o.toString()=="NaN"||o<0||o>9){at()?alert("\u5C0F\u6570\u4F4D\u6570\u5FC5\u987B\u57280-9\u4E4B\u95F4\uFF01"):ke.info("\u5C0F\u6570\u4F4D\u6570\u5FC5\u987B\u57280-9\u4E4B\u95F4\uFF01","");return}let a="";if(o>0){for(let u=1;u<=o;u++)a+="0";a="0."+a}else a="#";let s=$("#luckysheet-moreFormat-dialog .listbox .listItem.on input:hidden").val();s=="before"?a='"'+t+'" '+a:s=="after"&&(a=a+' "'+t+'"'),_t.updateFormat(n,"ct",a)}else l=="moredatetime"?_t.updateFormat(n,"ct",t):l=="moredigit"&&_t.updateFormat(n,"ct",t)})}},zg=i_});var import_plugin,o_,is,Og=Nt(()=>{import_plugin=qe(Ye());Ol();fr();Rr();jr();kn();cr();ui();Do();Ar();Wr();Kr();hf();il();Xl();hi();o_={createDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-replace").remove();let n=Be(),t=n.findAndReplace,l=n.button,o='<div class="tabBox"><span id="searchTab">'+t.find+'</span><span id="replaceTab">'+t.replace+'</span></div><div class="ctBox"><div class="inputBox"><div class="textboxs" id="searchInput">'+t.findTextbox+'\uFF1A<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="textboxs" id="replaceInput">'+t.replaceTextbox+'\uFF1A<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="checkboxs"><div id="regCheck"><input type="checkbox"/><span>'+t.regexTextbox+'</span></div><div id="wordCheck"><input type="checkbox"/><span>'+t.wholeTextbox+'</span></div><div id="caseCheck"><input type="checkbox"/><span>'+t.distinguishTextbox+'</span></div></div></div><div class="btnBox"><button id="replaceAllBtn" class="btn btn-default">'+t.allReplaceBtn+'</button><button id="replaceBtn" class="btn btn-default">'+t.replaceBtn+'</button><button id="searchAllBtn" class="btn btn-default">'+t.allFindBtn+'</button><button id="searchNextBtn" class="btn btn-default">'+t.findBtn+"</button></div></div>";$("body").first().append(Tt(Ll,{id:"luckysheet-search-replace",addclass:"luckysheet-search-replace",title:"",content:o,botton:'<button class="btn btn-default luckysheet-model-close-btn">'+l.close+"</button>",style:"z-index:100003",close:l.close}));let a=$("#luckysheet-search-replace").find(".luckysheet-modal-dialog-content").css("min-width",500).end(),s=a.outerHeight(),u=a.outerWidth(),f=$(window).width(),m=$(window).height(),d=$(document).scrollLeft(),p=$(document).scrollTop();$("#luckysheet-search-replace").css({left:(f+d-u)/2,top:(m+p-s)/3}).show(),e=="0"?($("#luckysheet-search-replace #searchTab").addClass("on").siblings().removeClass("on"),$("#luckysheet-search-replace #replaceInput").hide(),$("#luckysheet-search-replace #replaceAllBtn").hide(),$("#luckysheet-search-replace #replaceBtn").hide()):e=="1"&&($("#luckysheet-search-replace #replaceTab").addClass("on").siblings().removeClass("on"),$("#luckysheet-search-replace #replaceInput").show(),$("#luckysheet-search-replace #replaceAllBtn").show(),$("#luckysheet-search-replace #replaceBtn").show())},init:function(){let e=this;$(document).off("click.SRtabBoxspan").on("click.SRtabBoxspan","#luckysheet-search-replace .tabBox span",function(){$(this).addClass("on").siblings().removeClass("on");let n=$(this).attr("id");n=="searchTab"?($("#luckysheet-search-replace #replaceInput").hide(),$("#luckysheet-search-replace #replaceAllBtn").hide(),$("#luckysheet-search-replace #replaceBtn").hide(),$("#luckysheet-search-replace #searchInput input").focus()):n=="replaceTab"&&($("#luckysheet-search-replace #replaceInput").show(),$("#luckysheet-search-replace #replaceAllBtn").show(),$("#luckysheet-search-replace #replaceBtn").show(),$("#luckysheet-search-replace #replaceInput input").focus())}),$(document).off("keyup.SRsearchInput").on("keyup.SRsearchInput","#luckysheet-search-replace #searchInput input",function(n){n.keyCode==xl.ENTER&&e.searchNext()}),$(document).off("click.SRsearchNextBtn").on("click.SRsearchNextBtn","#luckysheet-search-replace #searchNextBtn",function(){e.searchNext()}),$(document).off("click.SRsearchAllBtn").on("click.SRsearchAllBtn","#luckysheet-search-replace #searchAllBtn",function(){e.searchAll()}),$(document).off("click.SRsearchAllboxItem").on("click.SRsearchAllboxItem","#luckysheet-search-replace #searchAllbox .boxItem",function(){$(this).addClass("on").siblings().removeClass("on");let n=$(this).attr("data-row"),t=$(this).attr("data-col"),l=$(this).attr("data-sheetIndex");l!=h.currentSheetIndex&&kt.changeSheetExec(l),h.luckysheet_select_save=[{row:[n,n],column:[t,t]}],gl();let o=$("#luckysheet-cell-main").scrollLeft(),a=$("#luckysheet-cell-main").scrollTop(),s=$("#luckysheet-cell-main").height(),u=$("#luckysheet-cell-main").width(),f=h.visibledatarow[n],m=n-1==-1?0:h.visibledatarow[n-1],d=h.visibledatacolumn[t],p=t-1==-1?0:h.visibledatacolumn[t-1];d-o-u+20>0?$("#luckysheet-scrollbar-x").scrollLeft(d-u+20):p-o-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(p-20),f-a-s+20>0?$("#luckysheet-scrollbar-y").scrollTop(f-s+20):m-a-20<0&&$("#luckysheet-scrollbar-y").scrollTop(m-20)}),$(document).off("click.SRreplaceBtn").on("click.SRreplaceBtn","#luckysheet-search-replace #replaceBtn",function(){e.replace()}),$(document).off("click.SRreplaceAllBtn").on("click.SRreplaceAllBtn","#luckysheet-search-replace #replaceAllBtn",function(){e.replaceAll()})},searchNext:function(){let e=this,n=$("#luckysheet-search-replace #searchInput input").val();if(n==""||n==null)return;let l=Be().findAndReplace,o;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?o=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:o=$.extend(!0,[],h.luckysheet_select_save);let a=e.getSearchIndexArr(n,o);if(a.length==0){at()?alert(l.noFindTip):ke.info(l.noFindTip,"");return}let s=0;if(h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]){if(h.luckysheet_select_save.length==0)s=0;else for(let x=0;x<a.length;x++)if(a[x].r==h.luckysheet_select_save[0].row[0]&&a[x].c==h.luckysheet_select_save[0].column[0]){x==a.length-1?s=0:s=x+1;break}h.luckysheet_select_save=[{row:[a[s].r,a[s].r],column:[a[s].c,a[s].c]}]}else{let x=o[o.length-1].row_focus,_=o[o.length-1].column_focus;for(let S=0;S<a.length;S++)if(a[S].r==x&&a[S].c==_){S==a.length-1?s=0:s=S+1;break}for(let S=0;S<o.length;S++){let I=o[S].row[0],P=o[S].row[1],F=o[S].column[0],D=o[S].column[1];if(a[s].r>=I&&a[s].r<=P&&a[s].c>=F&&a[s].c<=D){let k=o[S];k.row_focus=a[s].r,k.column_focus=a[s].c,o.splice(S,1),o.push(k);break}}h.luckysheet_select_save=o}gl();let u=$("#luckysheet-cell-main").scrollLeft(),f=$("#luckysheet-cell-main").scrollTop(),m=$("#luckysheet-cell-main").height(),d=$("#luckysheet-cell-main").width(),p=h.visibledatarow[a[s].r],b=a[s].r-1==-1?0:h.visibledatarow[a[s].r-1],g=h.visibledatacolumn[a[s].c],v=a[s].c-1==-1?0:h.visibledatacolumn[a[s].c-1];g-u-d+20>0?$("#luckysheet-scrollbar-x").scrollLeft(g-d+20):v-u-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(v-20),p-f-m+20>0?$("#luckysheet-scrollbar-y").scrollTop(p-m+20):b-f-20<0&&$("#luckysheet-scrollbar-y").scrollTop(b-20),$("#searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox .boxItem").removeClass("on")},searchAll:function(){let e=this,t=Be().findAndReplace;$("#luckysheet-search-replace #searchAllbox").remove();let l=$("#luckysheet-search-replace #searchInput input").val();if(l==""||l==null)return;let o;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?o=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:o=$.extend(!0,[],h.luckysheet_select_save);let a=e.getSearchIndexArr(l,o);if(a.length==0){at()?alert(t.noFindTip):ke.info(t.noFindTip,"");return}let s="";for(let u=0;u<a.length;u++){let f=Ka(a[u].r,a[u].c,h.flowdata).toString();f.indexOf("</")>-1&&f.indexOf(">")>-1?s+='<div class="boxItem" data-row="'+a[u].r+'" data-col="'+a[u].c+'" data-sheetIndex="'+h.currentSheetIndex+'"><span>'+h.luckysheetfile[Me(h.currentSheetIndex)].name+"</span><span>"+yl(a[u].c)+(a[u].r+1)+"</span><span>"+f+"</span></div>":s+='<div class="boxItem" data-row="'+a[u].r+'" data-col="'+a[u].c+'" data-sheetIndex="'+h.currentSheetIndex+'"><span>'+h.luckysheetfile[Me(h.currentSheetIndex)].name+"</span><span>"+yl(a[u].c)+(a[u].r+1)+'</span><span title="'+f+'">'+f+"</span></div>"}$('<div id="searchAllbox"><div class="boxTitle"><span>'+t.searchTargetSheet+"</span><span>"+t.searchTargetCell+"</span><span>"+t.searchTargetValue+'</span></div><div class="boxMain">'+s+"</div></div>").appendTo($("#luckysheet-search-replace")),$("#luckysheet-search-replace #searchAllbox .boxItem").eq(0).addClass("on").siblings().removeClass("on"),h.luckysheet_select_save=[{row:[a[0].r,a[0].r],column:[a[0].c,a[0].c]}],gl()},getSearchIndexArr:function(e,n){let t=[],l={},o=!1;$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked")&&(o=!0);let a=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(a=!0);let s=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(s=!0);for(let u=0;u<n.length;u++){let f=n[u].row[0],m=n[u].row[1],d=n[u].column[0],p=n[u].column[1];for(let b=f;b<=m;b++)for(let g=d;g<=p;g++)if(h.flowdata[b][g]!=null){let x=Ka(b,g,h.flowdata);if(x==0&&(x=x.toString()),x!=null&&x!="")if(x=x.toString(),a)s?e==x&&(b+"_"+g in l||(l[b+"_"+g]=0,t.push({r:b,c:g}))):e.toLowerCase()==x.toLowerCase()&&(b+"_"+g in l||(l[b+"_"+g]=0,t.push({r:b,c:g})));else if(o){let _;s?_=new RegExp(q.getRegExpStr(e),"g"):_=new RegExp(q.getRegExpStr(e),"ig"),_.test(x)&&(b+"_"+g in l||(l[b+"_"+g]=0,t.push({r:b,c:g})))}else~x.indexOf(e)&&(b+"_"+g in l||(l[b+"_"+g]=0,t.push({r:b,c:g})))}}return t},replace:function(){let e=this,t=Be().findAndReplace;if(!h.allowEdit){ke.info(t.modeTip,"");return}let l=$("#luckysheet-search-replace #searchInput input").val();if(l==""||l==null){at()?alert(t.searchInputTip):ke.info(t.searchInputTip,"");return}let o;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?o=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:o=$.extend(!0,[],h.luckysheet_select_save);let a=e.getSearchIndexArr(l,o);if(a.length==0){at()?alert(t.noReplceTip):ke.info(t.noReplceTip,"");return}let s=null,u=h.luckysheet_select_save[h.luckysheet_select_save.length-1],f=u.row_focus,m=u.column_focus;for(let T=0;T<a.length;T++)if(a[T].r==f&&a[T].c==m){s=T;break}if(s==null)if(a.length==0){at()?alert(t.noMatchTip):ke.info(t.noMatchTip,"");return}else s=0;let d=!1;$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked")&&(d=!0);let p=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(p=!0);let b=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(b=!0);let g=$("#luckysheet-search-replace #replaceInput input").val(),v=It.deepCopyFlowData(h.flowdata),x,_;if(p){x=a[s].r,_=a[s].c;let T=g;if(!Qa(x,_,h.currentSheetIndex))return;kr(x,_,v,T)}else{let T;if(b?T=new RegExp(q.getRegExpStr(l),"g"):T=new RegExp(q.getRegExpStr(l),"ig"),x=a[s].r,_=a[s].c,!Qa(x,_,h.currentSheetIndex))return;let O=Ka(x,_,v).toString().replace(T,g);kr(x,_,v,O)}h.luckysheet_select_save=[{row:[x,x],column:[_,_]}],$("#luckysheet-search-replace #searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox").hide(),al(v,h.luckysheet_select_save),gl();let S=$("#luckysheet-cell-main").scrollLeft(),I=$("#luckysheet-cell-main").scrollTop(),P=$("#luckysheet-cell-main").height(),F=$("#luckysheet-cell-main").width(),D=h.visibledatarow[x],k=x-1==-1?0:h.visibledatarow[x-1],w=h.visibledatacolumn[_],C=_-1==-1?0:h.visibledatacolumn[_-1];w-S-F+20>0?$("#luckysheet-scrollbar-x").scrollLeft(w-F+20):C-S-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(C-20),D-I-P+20>0?$("#luckysheet-scrollbar-y").scrollTop(D-P+20):k-I-20<0&&$("#luckysheet-scrollbar-y").scrollTop(k-20)},replaceAll:function(){let e=this,t=Be().findAndReplace;if(!h.allowEdit){ke.info(t.modeTip,"");return}let l=$("#luckysheet-search-replace #searchInput input").val();if(l==""||l==null){at()?alert(t.searchInputTip):ke.info(t.searchInputTip,"");return}let o;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?o=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:o=$.extend(!0,[],h.luckysheet_select_save);let a=e.getSearchIndexArr(l,o);if(a.length==0){at()?alert(t.noReplceTip):ke.info(t.noReplceTip,"");return}let s=!1;$("#luckysheet-search-replace #regCheck input[type='checkbox']").is(":checked")&&(s=!0);let u=!1;$("#luckysheet-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(u=!0);let f=!1;$("#luckysheet-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(f=!0);let m=$("#luckysheet-search-replace #replaceInput input").val(),d=It.deepCopyFlowData(h.flowdata),p=0;if(u)for(let g=0;g<a.length;g++){let v=a[g].r,x=a[g].c;if(!Qa(v,x,h.currentSheetIndex,!1))continue;kr(v,x,d,m),o.push({row:[v,v],column:[x,x]}),p++}else{let g;f?g=new RegExp(q.getRegExpStr(l),"g"):g=new RegExp(q.getRegExpStr(l),"ig");for(let v=0;v<a.length;v++){let x=a[v].r,_=a[v].c;if(!Qa(x,_,h.currentSheetIndex,!1))continue;let S=Ka(x,_,d).toString().replace(g,m);kr(x,_,d,S),o.push({row:[x,x],column:[_,_]}),p++}}$("#luckysheet-search-replace #searchAllbox").is(":visible")&&$("#luckysheet-search-replace #searchAllbox").hide(),al(d,o),h.luckysheet_select_save=$.extend(!0,[],o),gl();let b=Tt(t.successTip,{xlength:p});at()?alert(b):ke.info(b,"")}},is=o_});var import_plugin,a_,ia,G1=Nt(()=>{import_plugin=qe(Ye());Ol();fr();cr();cr();Kr();Rr();jr();mo();il();Xl();a_={createDialog:function(){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-locationCell-dialog").remove();let e=Be(),n=e.findAndReplace,t=e.button,l='<div class="listbox"><div class="listItem"><input type="radio" name="locationType" checked="checked" id="locationConstant"><label for="locationConstant">'+n.locationConstant+'</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationConstantDate"><label for="locationConstantDate">'+n.locationDate+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationConstantNumber"><label for="locationConstantNumber">'+n.locationDigital+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationConstantString"><label for="locationConstantString">'+n.locationString+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationConstantBoolean"><label for="locationConstantBoolean">'+n.locationBool+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationConstantError"><label for="locationConstantError">'+n.locationBool+'</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationFormula"><label for="locationFormula">'+n.locationFormula+'</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationFormulaDate" disabled="true"><label for="locationFormulaDate" style="color: #666">'+n.locationDate+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationFormulaNumber" disabled="true"><label for="locationFormulaNumber" style="color: #666">'+n.locationDigital+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationFormulaString" disabled="true"><label for="locationFormulaString" style="color: #666">'+n.locationString+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationFormulaBoolean" disabled="true"><label for="locationFormulaBoolean" style="color: #666">'+n.locationBool+'</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationFormulaError" disabled="true"><label for="locationFormulaError" style="color: #666">'+n.locationError+'</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationNull"><label for="locationNull">'+n.locationNull+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationCF"><label for="locationCF">'+n.locationCondition+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepRow"><label for="locationStepRow">'+n.locationRowSpan+'</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepColumn"><label for="locationStepColumn">'+n.locationColumnSpan+"</label></div></div>";$("body").first().append(Tt(Ll,{id:"luckysheet-locationCell-dialog",addclass:"luckysheet-locationCell-dialog",title:n.location,content:l,botton:'<button id="luckysheet-locationCell-dialog-confirm" class="btn btn-primary">'+t.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+t.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-locationCell-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-locationCell-dialog").css({left:(u+m-s)/2,top:(f+d-a)/3}).show()},init:function(){let e=this,n=Be().findAndReplace;$(document).on("click","#luckysheet-locationCell-dialog .listItem input:radio",function(t){$("#luckysheet-locationCell-dialog .listItem input:checkbox").prop("disabled",!0),$("#luckysheet-locationCell-dialog .listItem .subbox label").css("color","#666"),$(this).siblings(".subbox").find("input:checkbox").removeAttr("disabled"),$(this).siblings(".subbox").find("label").css("color","#000")}),$(document).off("click.locationCellConfirm").on("click.locationCellConfirm","#luckysheet-locationCell-dialog #luckysheet-locationCell-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-locationCell-dialog").hide();let t=$("#luckysheet-locationCell-dialog .listItem input:radio:checked"),l=t.attr("id");if(l=="locationConstant"||l=="locationFormula"){let o=t.siblings(".subbox").find("input:checkbox:checked"),a;if(o.length==0)return;if(o.length==5)a="all";else{let u=[];for(let f=0;f<o.length;f++)$(o[f]).hasClass("date")?u.push("d"):$(o[f]).hasClass("number")?u.push("n"):$(o[f]).hasClass("string")?u.push("s,g"):$(o[f]).hasClass("boolean")?u.push("b"):$(o[f]).hasClass("error")&&u.push("e");a=u.join(",")}let s;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?s=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:s=$.extend(!0,[],h.luckysheet_select_save),e.apply(s,l,a)}else if(l=="locationStepRow"){if(h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]){at()?alert(n.locationTiplessTwoRow):ke.info("",n.locationTiplessTwoRow);return}let o=$.extend(!0,[],h.luckysheet_select_save);e.apply(o,"locationStepRow")}else if(l=="locationStepColumn"){if(h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]){at()?alert(n.locationTiplessTwoColumn):ke.info("",n.locationTiplessTwoColumn);return}let o=$.extend(!0,[],h.luckysheet_select_save);e.apply(o,"locationStepColumn")}else{let o;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]?o=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:o=$.extend(!0,[],h.luckysheet_select_save),e.apply(o,l)}})},apply:function(e,n,t){let l=Be().findAndReplace,o=[];if(n=="locationFormula"||n=="locationConstant"||n=="locationNull"){let a=null,s=null,u=null,f=null,m={};for(let d=0;d<e.length;d++){let p=e[d].row[0],b=e[d].row[1],g=e[d].column[0],v=e[d].column[1];(a==null||a<p)&&(a=p),(s==null||s>b)&&(s=b),(u==null||u<g)&&(u=g),(f==null||f>v)&&(f=v);for(let x=p;x<=b;x++)for(let _=g;_<=v;_++){let S=h.flowdata[x][_];S!=null&&S.mc!=null&&(S=h.flowdata[S.mc.r][S.mc.c]),(n=="locationFormula"&&S!=null&&!ft(S.v)&&S.f!=null&&(t=="all"||S.ct!=null&&t.indexOf(S.ct.t)>-1)||n=="locationConstant"&&S!=null&&!ft(S.v)&&(t=="all"||S.ct!=null&&t.indexOf(S.ct.t)>-1)||n=="locationNull"&&(S==null||ft(S.v)))&&(m[x+"_"+_]=0)}}o=this.getRangeArr(a,s,u,f,m,o)}else if(n=="locationCF"){let a=Me(h.currentSheetIndex),s=h.luckysheetfile[a].luckysheet_conditionformat_save,u=h.luckysheetfile[a].data;if(s==null||s.length==0){at()?alert(l.locationTipNotFindCell):ke.info("",l.locationTipNotFindCell);return}if(computeMap=Mt.compute(s,u),Object.keys(computeMap).length==0){at()?alert(l.locationTipNotFindCell):ke.info("",l.locationTipNotFindCell);return}let f=null,m=null,d=null,p=null,b={};for(let g=0;g<e.length;g++){let v=e[g].row[0],x=e[g].row[1],_=e[g].column[0],S=e[g].column[1];(f==null||f<v)&&(f=v),(m==null||m>x)&&(m=x),(d==null||d<_)&&(d=_),(p==null||p>S)&&(p=S);for(let I=v;I<=x;I++)for(let P=_;P<=S;P++)I+"_"+P in computeMap&&(b[I+"_"+P]=0)}o=this.getRangeArr(f,m,d,p,b,o)}else if(n=="locationStepRow")for(let a=0;a<e.length;a++){if(e[a].row[0]==e[a].row[1])continue;let s=e[a].row[0],u=e[a].row[1],f=e[a].column[0],m=e[a].column[1];for(let d=s;d<=u;d++)(d-s)%2==0&&o.push({row:[d,d],column:[f,m]})}else if(n=="locationStepColumn")for(let a=0;a<e.length;a++){if(e[a].column[0]==e[a].column[1])continue;let s=e[a].row[0],u=e[a].row[1],f=e[a].column[0],m=e[a].column[1];for(let d=f;d<=m;d++)(d-f)%2==0&&o.push({row:[s,u],column:[d,d]})}if(o.length==0)at()?alert(l.locationTipNotFindCell):ke.info("",l.locationTipNotFindCell);else{h.luckysheet_select_save=o,gl();let a=$("#luckysheet-cell-main").scrollLeft(),s=$("#luckysheet-cell-main").scrollTop(),u=$("#luckysheet-cell-main").height(),f=$("#luckysheet-cell-main").width(),m=h.luckysheet_select_save[0].row[0],d=h.luckysheet_select_save[0].row[1],p=h.luckysheet_select_save[0].column[0],b=h.luckysheet_select_save[0].column[1],g=h.visibledatarow[d],v=m-1==-1?0:h.visibledatarow[m-1],x=h.visibledatacolumn[b],_=p-1==-1?0:h.visibledatacolumn[p-1];x-a-f+20>0?$("#luckysheet-scrollbar-x").scrollLeft(x-f+20):_-a-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(_-20),g-s-u+20>0?$("#luckysheet-scrollbar-y").scrollTop(g-u+20):v-s-20<0&&$("#luckysheet-scrollbar-y").scrollTop(v-20)}},getRangeArr(e,n,t,l,o,a){if(Object.keys(o).length==0)return a;let s=this,u=null,f=null,m=null,d=null;for(let p=e;p<=n;p++)for(let b=t;b<=l;b++){let g=h.flowdata[p][b];if(p+"_"+b in o)if(g!=null&&g.mc!=null)if(m==null){let v={row:[g.mc.r,g.mc.r+g.mc.rs-1],column:[g.mc.c,g.mc.c+g.mc.cs-1]};return a.push(v),o=s.deleteCellInSave(o,v),s.getRangeArr(e,n,t,l,o,a)}else if(b<d){let v={row:[u,f],column:[m,d]};return a.push(v),o=s.deleteCellInSave(o,v),s.getRangeArr(e,n,t,l,o,a)}else break;else m==null?(m=b,d=b,u=p,f=p):b>d&&(d=b);else if(m!=null){if(g!=null&&g.mc!=null)break;if(!(b<m))if(b<=d){let v={row:[u,f],column:[m,d]};return a.push(v),o=s.deleteCellInSave(o,v),s.getRangeArr(e,n,t,l,o,a)}else f=p}}if(m!=null){let p={row:[u,f],column:[m,d]};return a.push(p),o=s.deleteCellInSave(o,p),s.getRangeArr(e,n,t,l,o,a)}},deleteCellInSave(e,n){for(let t=n.row[0];t<=n.row[1];t++)for(let l=n.column[0];l<=n.column[1];l++)delete e[t+"_"+l];return e}},ia=a_});var import_plugin,s_,pu,Pg=Nt(()=>{import_plugin=qe(Ye());Sr();Wr();gc();Rr();Ol();il();Xl();s_={singleRangeFocus:!1,init:function(){let e=this,n=Be(),t=n.formula,l=n.button;$(document).off("focus.IFcompareValue").on("focus.IFcompareValue","#luckysheet-ifFormulaGenerator-dialog #compareValue",function(){$("#luckysheet-modal-dialog-mask").hide(),e.singleRangeFocus=!0}),$(document).off("click.IFsingRange").on("click.IFsingRange","#luckysheet-ifFormulaGenerator-dialog .singRange",function(){let o=$("#luckysheet-ifFormulaGenerator-dialog #compareValue").val().trim();y.iscelldata(o)?e.singleRangeDialog(o):e.singleRangeDialog()}),$(document).off("click.IFsingRangeConfirm").on("click.IFsingRangeConfirm","#luckysheet-ifFormulaGenerator-singleRange-confirm",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show();let o=$(this).parents("#luckysheet-ifFormulaGenerator-singleRange-dialog").find("input").val().trim();$("#luckysheet-ifFormulaGenerator-dialog #compareValue").val(o),e.singleRangeFocus=!1}),$(document).off("click.IFsingRangeCancel").on("click.IFsingRangeCancel","#luckysheet-ifFormulaGenerator-singleRange-cancel",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show(),e.singleRangeFocus=!1}),$(document).off("click.IFsingRangeClose").on("click.IFsingRangeClose","#luckysheet-ifFormulaGenerator-singleRange-dialog .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show(),e.singleRangeFocus=!1}),$(document).off("click.IFmultiRange").on("click.IFmultiRange","#luckysheet-ifFormulaGenerator-dialog .multiRange",function(){e.multiRangeDialog(),e.singleRangeFocus=!1}),$(document).off("click.IFmultiRangeConfirm").on("click.IFmultiRangeConfirm","#luckysheet-ifFormulaGenerator-multiRange-confirm",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show();let o=$(this).parents("#luckysheet-ifFormulaGenerator-multiRange-dialog").find("input").val().trim(),a=y.getcellrange(o),s=a.row[0],u=a.row[1],f=a.column[0],m=a.column[1],d=It.deepCopyFlowData(h.flowdata),p=[];for(let v=s;v<=u;v++)for(let x=f;x<=m;x++)d[v]!=null&&d[v][x]!=null&&d[v][x].ct!=null&&d[v][x].ct.t=="n"&&p.push(d[v][x].v);for(let v=0;v<p.length;v++)for(let x=0;x<p.length-1-v;x++)if(p[x]<p[x+1]){let _=p[x];p[x]=p[x+1],p[x+1]=_}let b=p[0],g=p[p.length-1];$("#luckysheet-ifFormulaGenerator-dialog #smallRange").val(g),$("#luckysheet-ifFormulaGenerator-dialog #largeRange").val(b)}),$(document).off("click.IFmultiRangeCancel").on("click.IFmultiRangeCancel","#luckysheet-ifFormulaGenerator-multiRange-cancel",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show()}),$(document).off("click.IFmultiRangeClose").on("click.IFmultiRangeClose","#luckysheet-ifFormulaGenerator-multiRange-dialog .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-formula-functionrange-select").hide(),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide(),$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").show()}),$(document).on("change","#DivisionMethod",function(){$(this).find("option:selected").val()=="2"?$("#DivisionMethodVal").hide():$("#DivisionMethodVal").show(),$("#luckysheet-ifFormulaGenerator-dialog .ifList").empty()}),$(document).off("click.IFcreateBtn").on("click.IFcreateBtn","#luckysheet-ifFormulaGenerator-dialog #createBtn",function(){let o=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#compareValue").val().trim();if(o==""){e.info(t.ifGenTipNotNullValue);return}let a=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#DivisionMethod option:selected").val();if(a=="2"){let s='<div class="item"><input type="number" class="smallNum formulaInputFocus"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+o+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus"/><span>'+t.ifGenTipLableTitile+'\uFF1A</span><input type="text" class="markText formulaInputFocus" value=""><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#luckysheet-ifFormulaGenerator-dialog .ifList").append(s)}else{let s=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#smallRange").val().trim(),u=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#largeRange").val().trim(),f=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find("#DivisionMethodVal").val().trim();if(s==""||u==""){e.info(t.ifGenTipRangeNotforNull);return}else if(f==""){e.info(t.ifGenTipCutValueNotforNull);return}e.getIfList(o,s,u,a,f)}}),$(document).on("click","#luckysheet-ifFormulaGenerator-dialog .item .fa-remove",function(){$(this).parents(".item").remove()}),$(document).off("click.IFconfirmBtn").on("click.IFconfirmBtn","#luckysheet-ifFormulaGenerator-dialog-confirm",function(){let o=$(this).parents("#luckysheet-ifFormulaGenerator-dialog").find(".ifList .item"),a="";if($(o.toArray().reverse()).each(function(m,d){let p=$(d).find(".smallNum").val().trim(),b=$(d).find(".largeNum").val().trim(),g=$(d).find(".operator option:selected").val(),v=$(d).find(".operator2 option:selected").val(),x=$(d).find(".compareValue").text(),_=$(d).find(".markText").val().trim();if(_==""&&(_=t.ifGenTipLableTitile+(m+1)),p==""&&b=="")return!0;let S;g=="0"?S=x+">="+p:S=x+">"+p;let I;v=="0"?I=x+"<="+b:I=x+"<"+b;let P;m==0&&b==""?P=S:m==o.length-1&&p==""?P=I:P="and("+S+","+I+")",m==0?a="if("+P+',"'+_+'")':a="if("+P+',"'+_+'",'+a+")"}),a.length==0){e.info(t.ifGenTipNotGenCondition);return}$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide();let s=h.luckysheet_select_save[h.luckysheet_select_save.length-1],u=s.row_focus,f=s.column_focus;ti(u,f,h.flowdata),$("#luckysheet-rich-text-editor").html("="+a),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),$("#luckysheet-wa-functionbox-confirm").click()}),$(document).on("click","#luckysheet-ifFormulaGenerator-info .luckysheet-model-close-btn",function(){$("#luckysheet-modal-dialog-mask").show()}),$(document).on("click","#luckysheet-ifFormulaGenerator-info .luckysheet-modal-dialog-title-close",function(){$("#luckysheet-modal-dialog-mask").show()})},ifFormulaDialog:function(e){let n=this,t=Be(),l=t.formula,o=t.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-dialog").remove();let a="",s="";if(e){let x=e.split("if(");for(let _=1;_<x.length;_++){let I=x[_].replace("and(","").replace(/\)/g,"").replace(/\"/g,"").split(",");I=n.clearArr(I),a=n.splitTxt(I[0])[0];let P,F,D;I.length==3?(P=n.splitTxt(I[0])[1],F=n.splitTxt(I[1])[2],D=I[2]):(P=n.splitTxt(I[0])[1],F=n.splitTxt(I[0])[2],D=I[1]),s+='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+P+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+a+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+F+'"/><span>'+l.ifGenTipLableTitile+'\uFF1A</span><input type="text" class="markText formulaInputFocus" value="'+D+'"><i class="fa fa-remove" aria-hidden="true"></i></div>'}}let u='<div class="ifAttr"><div class="attrBox"><label for="compareValue"> '+l.ifGenCompareValueTitle+' </label><div class="inpBox"><input id="compareValue" class="formulaInputFocus" value="'+a+'"/><i class="singRange fa fa-table" aria-hidden="true" title="'+l.ifGenSelectCellTitle+'"></i></div></div><div class="attrBox"><label for="smallRange"> '+l.ifGenRangeTitle+' </label><input type="number" id="smallRange" class="formulaInputFocus"/><span class="text"> '+l.ifGenRangeTo+' </span><input type="number" id="largeRange" class="formulaInputFocus"/><div id="rangeAssess"><span> '+l.ifGenRangeEvaluate+' </span><i class="multiRange fa fa-table" aria-hidden="true" title="'+l.ifGenSelectRangeTitle+'"></i></div></div><div class="attrBox"><label for="DivisionMethod"> '+l.ifGenCutWay+' </label><select id="DivisionMethod"><option value="0"> '+l.ifGenCutSame+' </option><option value="1"> '+l.ifGenCutNpiece+' </option><option value="2"> '+l.ifGenCutCustom+' </option></select><input id="DivisionMethodVal" class="formulaInputFocus"/><div id="createBtn"> '+l.ifGenCutSame+' </div></div></div><div class="ifList">'+s+"</div>";$("body").first().append(Tt(Ll,{id:"luckysheet-ifFormulaGenerator-dialog",addclass:"luckysheet-ifFormulaGenerator-dialog",title:l.ifGenerate,content:u,botton:'<button id="luckysheet-ifFormulaGenerator-dialog-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>",style:"z-index:100003"}));let f=$("#luckysheet-ifFormulaGenerator-dialog").find(".luckysheet-modal-dialog-content").css("min-width",590).end(),m=f.outerHeight(),d=f.outerWidth(),p=$(window).width(),b=$(window).height(),g=$(document).scrollLeft(),v=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-dialog").css({left:(p+g-d)/2,top:(b+v-m)/3}).show()},clearArr:function(e){for(let n=0;n<e.length;n++)(e[n]==""||e[n]==null||e[n]==null)&&e.splice(n,1);return e},splitTxt:function(e){let n,t,l;if(e.indexOf(">=")!=-1)return n=e.split(">=")[0],t=e.split(">=")[1],[n,t,l];if(e.indexOf(">")!=-1)return n=e.split(">")[0],t=e.split(">")[1],[n,t,l];if(e.indexOf("<=")!=-1)return n=e.split("<=")[0],l=e.split("<=")[1],[n,t,l];if(e.indexOf("<")!=-1)return n=e.split("<")[0],l=e.split("<")[1],[n,t,l]},singleRangeDialog:function(e){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").remove();let n=Be(),t=n.formula,l=n.button;e==null&&(e=""),$("body").first().append(Tt(Ll,{id:"luckysheet-ifFormulaGenerator-singleRange-dialog",addclass:"luckysheet-ifFormulaGenerator-singleRange-dialog",title:t.ifGenTipSelectCell,content:'<input readonly="readonly" placeholder="'+t.ifGenTipSelectCellPlace+'" value="'+e+'">',botton:'<button id="luckysheet-ifFormulaGenerator-singleRange-confirm" class="btn btn-primary">'+l.confirm+'</button><button id="luckysheet-ifFormulaGenerator-singleRange-cancel" class="btn btn-default">'+l.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-ifFormulaGenerator-singleRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-singleRange-dialog").css({left:(u+m-s)/2,top:(f+d-a)/3}).show()},multiRangeDialog:function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-ifFormulaGenerator-dialog").hide(),$("#luckysheet-ifFormulaGenerator-multiRange-dialog").remove();let e=Be(),n=e.formula,t=e.button;$("body").first().append(Tt(Ll,{id:"luckysheet-ifFormulaGenerator-multiRange-dialog",addclass:"luckysheet-ifFormulaGenerator-multiRange-dialog",title:n.ifGenTipSelectRange,content:'<input readonly="readonly" placeholder="'+n.ifGenTipSelectRangePlace+'" value="">',botton:'<button id="luckysheet-ifFormulaGenerator-multiRange-confirm" class="btn btn-primary">'+t.confirm+'</button><button id="luckysheet-ifFormulaGenerator-multiRange-cancel" class="btn btn-default">'+t.cancel+"</button>",style:"z-index:100003"}));let l=$("#luckysheet-ifFormulaGenerator-multiRange-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),f=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-multiRange-dialog").css({left:(s+f-a)/2,top:(u+m-o)/3}).show()},getIfList:function(e,n,t,l,o){let a=Be().formula;$("#luckysheet-ifFormulaGenerator-dialog .ifList").empty(),n=parseInt(n),t=parseInt(t),o=parseInt(o);let s=[];if(l=="0"){let u=Math.ceil((t-n)/o);for(let f=0;f<=u;f++){let m=n+o*f;f==0||m>=t?s.push(""):s.push(m)}}else if(l=="1"){let u=Math.ceil((t-n)/o);for(let f=0;f<=o;f++){let m=n+u*f;f==0||m>=t?s.push(""):s.push(m)}}for(let u=0;u<s.length-1;u++){let f;u==0?f="\u5C0F\u4E8E"+s[u+1]:u==s.length-2?f="\u5927\u4E8E\u7B49\u4E8E"+s[u]:f=s[u]+"\u5230"+s[u+1];let m='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+s[u]+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+e+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+s[u+1]+'"/><span>'+a.ifGenTipLableTitile+'\uFF1A</span><input type="text" class="markText formulaInputFocus" value="'+f+'"><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#luckysheet-ifFormulaGenerator-dialog .ifList").append(m)}},info:function(e){$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-ifFormulaGenerator-info").remove();let t=Be().button;$("body").first().append(Tt(Ll,{id:"luckysheet-ifFormulaGenerator-info",addclass:"",title:e,content:"",botton:'<button class="btn btn-default luckysheet-model-close-btn">&nbsp;&nbsp;'+t.close+"&nbsp;&nbsp;</button>",style:"z-index:100003"}));let l=$("#luckysheet-ifFormulaGenerator-info").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),o=l.outerHeight(),a=l.outerWidth(),s=$(window).width(),u=$(window).height(),f=$(document).scrollLeft(),m=$(document).scrollTop();$("#luckysheet-ifFormulaGenerator-info").css({left:(s+f-a)/2,top:(u+m-o)/3}).show()}},pu=s_});var import_plugin,c_,Ia,Eg=Nt(()=>{import_plugin=qe(Ye());mf();Sr();cr();Rr();jr();Ol();il();Xl();c_={init:function(){let e=this,n=Be(),t=n.formulaMore,l=n.button;$(document).off("keyup.fxSFLI").on("keyup.fxSFLI","#searchFormulaListInput",function(){$("#formulaTypeList").empty();let o=$(this).val().toUpperCase(),a=h.functionlist;if(o=="")e.formulaListByType($("#formulaTypeSelect option:selected").val());else for(let s=0;s<a.length;s++)/^[a-zA-Z]+$/.test(o)?a[s].n.indexOf(o)!="-1"&&$('<div class="listBox" name="'+a[s].n+'"><span>'+a[s].n+"</span><span>"+a[s].a+"</span></div>").appendTo($("#formulaTypeList")):a[s].a.indexOf(o)!="-1"&&$('<div class="listBox" name="'+a[s].n+'"><span>'+a[s].n+"</span><span>"+a[s].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")}),$(document).off("change.fxFormulaTS").on("change.fxFormulaTS","#formulaTypeSelect",function(){let o=$("#formulaTypeSelect option:selected").val();e.formulaListByType(o)}),$(document).off("click.fxListbox").on("click.fxListbox","#formulaTypeList .listBox",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.fxFormulaCf").on("click.fxFormulaCf","#luckysheet-search-formula-confirm",function(){let o=$("#luckysheet-search-formula .listBox.on").attr("name"),a='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+o.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(a),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),e.formulaParmDialog(o)}),$(document).off("focus.fxParamInput").on("focus.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){let o=$(this).parents(".parmBox").index();y.data_parm_index=o;let a=$(this).parents("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-title-text").text(),s=h.luckysheet_function[a].p.length,u,f;o>=s?(u=h.luckysheet_function[a].p[s-1].detail,f=h.luckysheet_function[a].p[s-1].repeat):(u=h.luckysheet_function[a].p[o].detail,f=h.luckysheet_function[a].p[o].repeat),e.parmTxtShow($(this).val()),e.functionStrCompute(),$("#luckysheet-search-formula-parm .parmDetailsBox").empty();let m=$(this).parents(".parmBox").find(".name").text();if($("<span>"+m+":</span><span>"+u+"</span>").appendTo($("#luckysheet-search-formula-parm .parmDetailsBox")),f=="y"){let d=$("#luckysheet-search-formula-parm .parmBox").length;d<5&&o==d-1&&$('<div class="parmBox"><div class="name">'+t.valueTitle+""+(d+1)+'</div><div class="txt"><input class="formulaInputFocus" /><i class="fa fa-table" aria-hidden="true" title="'+t.tipSelectDataRange+'"></i></div><div class="val">=</div></div>').appendTo($("#luckysheet-search-formula-parm .parmListBox"))}}),$(document).off("blur.fxParamInput").on("blur.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){let o=$(this).val();y.getfunctionParam(o).fn==null&&!y.iscelldata(o)&&!K(o)&&o!=""&&o.length<=2&&o.indexOf('"')!=0&&o.lastIndexOf('"')!=0&&(o='"'+o+'"',$(this).val(o),e.parmTxtShow(o),e.functionStrCompute())}),$(document).off("keyup.fxParamInput").on("keyup.fxParamInput","#luckysheet-search-formula-parm .parmBox input",function(){e.parmTxtShow($(this).val()),e.functionStrCompute()}),$(document).off("click.fxParamI").on("click.fxParamI","#luckysheet-search-formula-parm .parmBox i",function(){y.data_parm_index=$(this).parents(".parmBox").index(),$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-formula-parm-select").remove(),$(this).parents(".parmBox").find(".txt input").val()==""?$("body").first().append(Tt(Ll,{id:"luckysheet-search-formula-parm-select",addclass:"luckysheet-search-formula-parm-select",title:t.tipSelectDataRange,content:"<input id='luckysheet-search-formula-parm-select-input' class='luckysheet-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='"+t.tipDataRangeTile+"' readonly='true' placeholder='"+t.tipDataRangeTile+"'>",botton:'<button id="luckysheet-search-formula-parm-select-confirm" class="btn btn-primary">'+l.confirm+"</button>",style:"z-index:100003"})):$("body").first().append(Tt(Ll,{id:"luckysheet-search-formula-parm-select",addclass:"luckysheet-search-formula-parm-select",title:t.tipSelectDataRange,content:"<input id='luckysheet-search-formula-parm-select-input' class='luckysheet-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='"+t.tipDataRangeTile+"' readonly='true' value='"+$(this).parents(".parmBox").find(".txt input").val()+"'>",botton:'<button id="luckysheet-search-formula-parm-select-confirm" class="btn btn-primary">'+l.confirm+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-search-formula-parm-select").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-search-formula-parm-select").css({left:(u+m-s)/2,top:(f+d-a)/3}).show(),e.parmTxtShow($(this).parents(".parmBox").find(".txt input").val())}),$(document).off("click.fxParamCf").on("click.fxParamCf","#luckysheet-search-formula-parm-confirm",function(){$("#luckysheet-wa-functionbox-confirm").click()}),$(document).off("click.fxParamSelectCf").on("click.fxParamSelectCf","#luckysheet-search-formula-parm-select-confirm",function(){let o=$("#luckysheet-search-formula-parm-select-input").attr("data_parm_index");$("#luckysheet-search-formula-parm-select").hide(),$("#luckysheet-search-formula-parm").show(),$("#luckysheet-search-formula-parm .parmBox").eq(o).find(".txt input").focus()})},formulaListDialog:function(){let e=this,n=Be(),t=n.formulaMore,l=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-search-formula").remove(),$("body").first().append(Tt(Ll,{id:"luckysheet-search-formula",addclass:"luckysheet-search-formula",title:"",content:"<div class='inpbox'><label for='searchFormulaListInput'>"+t.findFunctionTitle+"\uFF1A</label><input class='formulaInputFocus' id='searchFormulaListInput' placeholder='"+t.tipInputFunctionName+"' spellcheck='false'/></div><div class='selbox'><label>"+t.selectCategory+"\uFF1A</label><select id='formulaTypeSelect'><option value='0'>"+t.Math+"</option><option value='1'>"+t.Statistical+"</option><option value='2'>"+t.Lookup+"</option><option value='3'>"+t.luckysheet+"</option><option value='4'>"+t.dataMining+"</option><option value='5'>"+t.Database+"</option><option value='6'>"+t.Date+"</option><option value='7'>"+t.Filter+"</option><option value='8'>"+t.Financial+"</option><option value='9'>"+t.Engineering+"</option><option value='10'>"+t.Logical+"</option><option value='11'>"+t.Operator+"</option><option value='12'>"+t.Text+"</option><option value='13'>"+t.Parser+"</option><option value='14'>"+t.Array+"</option><option value='-1'>"+t.other+"</option></select></div><div class='listbox'><label>"+t.selectFunctionTitle+"\uFF1A</label><div id='formulaTypeList'></div></div>",botton:'<button id="luckysheet-search-formula-confirm" class="btn btn-primary">'+l.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+l.cancel+"</button>",style:"z-index:100003"}));let o=$("#luckysheet-search-formula").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),a=o.outerHeight(),s=o.outerWidth(),u=$(window).width(),f=$(window).height(),m=$(document).scrollLeft(),d=$(document).scrollTop();$("#luckysheet-search-formula").css({left:(u+m-s)/2,top:(f+d-a)/3,"user-select":"none"}).show(),e.formulaListByType("0"),$("#searchFormulaListInput").focus()},formulaListByType:function(e){$("#formulaTypeList").empty();let n=h.functionlist;for(let t=0;t<n.length;t++)(e=="-1"&&n[t].t>14||n[t].t==e)&&$('<div class="listBox" name="'+n[t].n+'"><span>'+n[t].n+"</span><span>"+n[t].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")},formulaParmDialog:function(e,n){let t="",l="",o="",a=Be(),s=a.formulaMore,u=a.button,f=h.functionlist;for(let _=0;_<f.length;_++)if(f[_].n==e.toUpperCase()){t=f[_].n;for(let S=0;S<f[_].p.length;S++)n==null?o+='<div class="parmBox"><div class="name">'+f[_].p[S].name+'</div><div class="txt"><input class="formulaInputFocus" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="'+s.tipSelectDataRange+'"></i></div><div class="val">=</div></div>':(n[S]==null&&(n[S]=""),o+='<div class="parmBox"><div class="name">'+f[_].p[S].name+'</div><div class="txt"><input class="formulaInputFocus" value="'+n[S]+'" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="'+s.tipSelectDataRange+'"></i></div><div class="val">=</div></div>');l='<div><div class="parmListBox">'+o+'</div><div class="formulaDetails">'+f[_].d+'</div><div class="parmDetailsBox"></div><div class="result">'+s.calculationResult+" = <span></span></div></div>"}$("#luckysheet-search-formula").hide(),$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-search-formula-parm").remove(),$("body").first().append(Tt(Ll,{id:"luckysheet-search-formula-parm",addclass:"luckysheet-search-formula-parm",title:t,content:l,botton:'<button id="luckysheet-search-formula-parm-confirm" class="btn btn-primary">'+u.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+u.cancel+"</button>",style:"z-index:100003"}));let m=$("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-content").css("min-width",300).end(),d=m.outerHeight(),p=m.outerWidth(),b=$(window).width(),g=$(window).height(),v=$(document).scrollLeft(),x=$(document).scrollTop();$("#luckysheet-search-formula-parm").css({left:(b+v-p)/2,top:(g+x-d)/3}).show(),$("#luckysheet-search-formula-parm .parmBox:eq(0) input").focus(),$("#luckysheet-search-formula-parm .parmBox").each(function(_,S){let I=$(S).find(".txt input").val();if(y.getfunctionParam(I).fn==null)if(y.iscelldata(I)){let P=Ji(I).data;if(G(P)=="array"){let F=[];for(let D=0;D<P.length;D++)for(let k=0;k<P[D].length;k++){let w=P[D][k];w==null||ft(w.v)?F.push(null):F.push(w.v)}$("#luckysheet-search-formula-parm .parmBox").eq(_).find(".val").text(" = {"+F.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(_).find(".val").text(" = {"+P.v+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(_).find(".val").text(" = {"+I+"}");else $("#luckysheet-search-formula-parm .parmBox").eq(_).find(".val").text(" = {"+new Function("return "+$.trim(y.functionParserExe("="+I)))()+"}")}),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove(),y.data_parm_index=0,y.rangestart=!0},parmTxtShow:function(e){if(y.getfunctionParam(e).fn==null)if(y.iscelldata(e)){let n=y.getcellrange(e),t=n.row[0],l=n.row[1],o=n.column[0],a=n.column[1],s=h.visibledatarow[l],u=t-1==-1?0:h.visibledatarow[t-1],f=h.visibledatacolumn[a],m=o-1==-1?0:h.visibledatacolumn[o-1];$("#luckysheet-formula-functionrange-select").css({left:m,width:f-m-1,top:u,height:s-u-1}).show(),$("#luckysheet-formula-help-c").hide(),eo(m,u,f-m-1,s-u-1,n.row,n.column);let d=Ji(e).data;if(G(d)=="array"){let p=[];for(let b=0;b<d.length;b++)for(let g=0;g<d[b].length;g++){let v=d[b][g];v==null||ft(v.v)?p.push(null):p.push(v.v)}$("#luckysheet-search-formula-parm .parmBox").eq(y.data_parm_index).find(".val").text(" = {"+p.join(",")+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(y.data_parm_index).find(".val").text(" = {"+d.v+"}")}else $("#luckysheet-search-formula-parm .parmBox").eq(y.data_parm_index).find(".val").text(" = {"+e+"}"),$("#luckysheet-formula-functionrange-select").hide();else{let n;for(let p=0;p<y.getfunctionParam(e).param.length;p++)if(y.iscelldata(y.getfunctionParam(e).param[p])){n=y.getfunctionParam(e).param[p];break}let t=y.getcellrange(n),l=t.row[0],o=t.row[1],a=t.column[0],s=t.column[1],u=h.visibledatarow[o],f=l-1==-1?0:h.visibledatarow[l-1],m=h.visibledatacolumn[s],d=a-1==-1?0:h.visibledatacolumn[a-1];$("#luckysheet-formula-functionrange-select").css({left:d,width:m-d-1,top:f,height:u-f-1}).show(),$("#luckysheet-formula-help-c").hide(),eo(d,f,m-d-1,u-f-1,t.row,t.column),$("#luckysheet-search-formula-parm .parmBox").eq(y.data_parm_index).find(".val").text(" = {"+new Function("return "+$.trim(y.functionParserExe("="+e)))()+"}")}},functionStrCompute:function(){let e=!0,n=[],t=-1,l=$("#luckysheet-search-formula-parm").find(".luckysheet-modal-dialog-title-text").text(),o=h.luckysheet_function[l].p;$("#luckysheet-search-formula-parm .parmBox").each(function(u,f){let m=$(f).find(".txt input").val(),d;u<o.length?d=o[u].require:d=o[o.length-1].require,m==""&&d=="m"&&(e=!1),m!=""&&(t=u)});let a;if(t==-1)a="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"()";else if(t==0)a="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+$("#luckysheet-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(let u=0;u<=t;u++)n.push($("#luckysheet-search-formula-parm .parmBox").eq(u).find(".txt input").val());a="="+$("#luckysheet-search-formula-parm .luckysheet-modal-dialog-title-text").text()+"("+n.join(",")+")"}let s=y.functionHTMLGenerate(a);if($("#luckysheet-rich-text-editor").html(s),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),e){let u=$.trim(y.functionParserExe($("#luckysheet-rich-text-editor").text())),f=null;try{f=new Function("return "+u)()}catch(m){f=y.error.n}$("#luckysheet-search-formula-parm .result span").text(f)}}},Ia=c_});var import_plugin,u_,_t,ln=Nt(()=>{import_plugin=qe(Ye());jr();Rr();Vn();U1();Jc();mo();qr();Go();Di();ho();Ja();Og();G1();Pg();gc();Eg();kn();ta();cr();Kr();Wr();ui();Ar();oc();Sr();Ri();Xo();fo();Do();Er();Xc();Ga();fr();gs();Ya();Ol();hi();il();Xl();mc();u_={menu:'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton ${subclass} luckysheet-mousedown-cancel" id="luckysheet-icon-${id}-menuButton">${item}</div>',item:'<div itemvalue="${value}" itemname="${name}" class="luckysheet-cols-menuitem ${sub} luckysheet-mousedown-cancel"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel" style="padding: 3px 0px 3px 1px;"><span style="margin-right:3px;width:13px;display:inline-block;" class="icon luckysheet-mousedown-cancel"></span> ${name} <span class="luckysheet-submenu-arrow luckysheet-mousedown-cancel ${iconClass}" style="user-select: none;">${example}</span></div></div>',split:'<div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div>',color:'<div class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-mousedown-cancel luckysheet-menuButton ${sub}" id="${id}"><div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel luckysheet-color-reset"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${resetColor}</div></div> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" class="luckysheet-color-selected" /> </div> </div> <div class="luckysheet-menuseparator luckysheet-mousedown-cancel" role="separator"></div> ${coloritem}</div>',coloritem:'<div class="luckysheet-cols-menuitem luckysheet-mousedown-cancel ${class}"><div class="luckysheet-cols-menuitem-content luckysheet-mousedown-cancel">${name}</div></div>',subcolor:'<div id="luckysheet-icon-${id}-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-rightgclick-menu-sub luckysheet-menuButton-sub luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <div class="luckysheet-mousedown-cancel"> <input type="text" class="luckysheet-color-selected" /> </div> </div></div>',rightclickmenu:null,submenuhide:{},focus:function(e,n){e.attr("id")=="luckysheet-icon-font-family-menuButton"&&Cs(n).num&&(n=Be().fontarray[parseInt(n)],n==null&&(n=this.defualtFont[itemvalue])),e.find(".luckysheet-cols-menuitem").find("span.icon").html(""),n==null?e.find(".luckysheet-cols-menuitem").eq(0).find("span.icon").html('<i class="fa fa-check luckysheet-mousedown-cancel"></i>'):e.find(".luckysheet-cols-menuitem[itemvalue='"+n+"']").find("span.icon").html('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')},createButtonMenu:function(e){let n="",t=this;for(let l=0;l<e.length;l++){let o=e[l];o.value=="split"?n+=t.split:o.example=="more"?n+=Tt(t.item,{value:o.value,name:o.text,example:"",sub:"luckysheet-cols-submenu",iconClass:"iconfont luckysheet-iconfont-youjiantou"}):n+=Tt(t.item,{value:o.value,name:o.text,example:o.example,sub:"",iconClass:""})}return n},cancelPaintModel:function(){let e=this;$("#luckysheet-sheettable_0").removeClass("luckysheetPaintCursor"),h.luckysheet_copy_save.dataSheetIndex==h.currentSheetIndex?(h.luckysheet_selection_range=[],gr()):h.luckysheetfile[Me(h.luckysheet_copy_save.dataSheetIndex)].luckysheet_selection_range=[],h.luckysheet_copy_save={},e.luckysheetPaintModelOn=!1,$("#luckysheetpopover").fadeOut(200,function(){$("#luckysheetpopover").remove()})},luckysheetPaintModelOn:!1,luckysheetPaintSingle:!1,initialMenuButton:function(){let e=this;$("#luckysheet-icon-paintformat").click(function(t){if(!yi()){ke.info("",Be().pivotTable.errorNotAllowEdit);return}t.stopPropagation();let o=Be().paint;if(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0){at()?alert(o.tipSelectRange):ke.info("",o.tipSelectRange);return}else if(h.luckysheet_select_save.length>1){at()?alert(o.tipNotMulti):ke.info("",o.tipNotMulti);return}let a=!1,s=h.luckysheet_select_save[0].row[0],u=h.luckysheet_select_save[0].row[1],f=h.luckysheet_select_save[0].column[0],m=h.luckysheet_select_save[0].column[1];if(a=sr(h.config,s,u,f,m),a){ke.info("\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C","");return}ke.popover("<i class='fa fa-paint-brush'></i> "+o.start+"","topCenter",!0,null,o.end,function(){e.cancelPaintModel()}),$("#luckysheet-sheettable_0").addClass("luckysheetPaintCursor"),h.luckysheet_selection_range=[{row:h.luckysheet_select_save[0].row,column:h.luckysheet_select_save[0].column}],gr();let d=!1,p=!1;for(let b=h.luckysheet_select_save[0].row[0];b<=h.luckysheet_select_save[0].row[1];b++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[b]!=null)){h.config.rowlen!=null&&b in h.config.rowlen&&(d=!0);for(let g=h.luckysheet_select_save[0].column[0];g<=h.luckysheet_select_save[0].column[1];g++){let v=h.flowdata[b][g];G(v)=="object"&&"mc"in v&&v.mc.rs!=null&&(p=!0)}}h.luckysheet_copy_save={dataSheetIndex:h.currentSheetIndex,copyRange:[{row:h.luckysheet_select_save[0].row,column:h.luckysheet_select_save[0].column}],RowlChange:d,HasMC:p},e.luckysheetPaintModelOn=!0,e.luckysheetPaintSingle=!0}),$("#luckysheet-icon-paintformat").dblclick(function(){if(!yi()){ke.info("",Be().pivotTable.errorNotAllowEdit);return}let l=Be().paint;if(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0){at()?alert(l.tipSelectRange):ke.info("",l.tipSelectRange);return}else if(h.luckysheet_select_save.length>1){at()?alert(l.tipNotMulti):ke.info("",l.tipNotMulti);return}ke.popover("<i class='fa fa-paint-brush'></i> "+l.start,"topCenter",!0,null,l.end,function(){e.cancelPaintModel()}),$("#luckysheet-sheettable_0").addClass("luckysheetPaintCursor"),h.luckysheet_selection_range=[{row:h.luckysheet_select_save[0].row,column:h.luckysheet_select_save[0].column}],gr();let o=!1,a=!1;for(let s=h.luckysheet_select_save[0].row[0];s<=h.luckysheet_select_save[0].row[1];s++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[s]!=null)){h.config.rowlen!=null&&s in h.config.rowlen&&(o=!0);for(let u=h.luckysheet_select_save[0].column[0];u<=h.luckysheet_select_save[0].column[1];u++){let f=h.flowdata[s][u];G(f)=="object"&&"mc"in f&&f.mc.rs!=null&&(a=!0)}}h.luckysheet_copy_save={dataSheetIndex:h.currentSheetIndex,copyRange:[{row:h.luckysheet_select_save[0].row,column:h.luckysheet_select_save[0].column}],RowlChange:o,HasMC:a},e.luckysheetPaintModelOn=!0,e.luckysheetPaintSingle=!1}),$("#luckysheet-icon-currency").click(function(){let t=It.deepCopyFlowData(h.flowdata);e.updateFormat(t,"ct","\xA5 #.00")}),$("#luckysheet-icon-percent").click(function(){let t=It.deepCopyFlowData(h.flowdata);e.updateFormat(t,"ct","0.00%")}),$("#luckysheet-icon-fmt-decimal-decrease").click(function(){let t=It.deepCopyFlowData(h.flowdata),l=h.luckysheet_select_save[0].row_focus,o=h.luckysheet_select_save[0].column_focus,a=e.checkstatus(t,l,o,"ct"),s=t[l][o];if(a==null||a.t!="n")return;if(a.fa=="General"&&(a=_l(s.v)[1]),/^(w|W)((0?)|(0\.0+))$/.test(a.fa)){a.fa.indexOf(".")>-1?a.fa.substr(-2)==".0"?e.updateFormat(t,"ct",a.fa.split(".")[0]):e.updateFormat(t,"ct",a.fa.substr(0,a.fa.length-1)):e.updateFormat(t,"ct",a.fa);return}let f="",m="",d=[];if(a.fa.indexOf(".")>-1)d=a.fa.split("."),f=d[0],m=d[1];else return;d=m.split("");let p="";for(let g=d.length-1;g>=0;g--){let v=d[g];if(v!="#"&&v!="0"&&v!=","&&isNaN(parseInt(v)))p=v+p;else break}let b="";if(a.fa.indexOf(".")>-1){let g=m;p.length>0&&(g=m.replace(p,""));let v=g.replace(/#/g,"0");v=v.substr(0,v.length-1),v==""?b=f+p:b=f+"."+v+p}e.updateFormat(t,"ct",b)}),$("#luckysheet-icon-fmt-decimal-increase").click(function(){let t=It.deepCopyFlowData(h.flowdata),l=h.luckysheet_select_save[0].row_focus,o=h.luckysheet_select_save[0].column_focus,a=e.checkstatus(t,l,o,"ct"),s=t[l][o];if(a==null||a.t!="n")return;if(a.fa=="General"&&(a=_l(s.v)[1]),a.fa=="General"){e.updateFormat(t,"ct","#.0");return}if(/^(w|W)((0?)|(0\.0+))$/.test(a.fa)){a.fa.indexOf(".")>-1?e.updateFormat(t,"ct",a.fa+"0"):a.fa.substr(-1)=="0"?e.updateFormat(t,"ct",a.fa+".0"):e.updateFormat(t,"ct",a.fa+"0.0");return}let f="",m="",d=[];a.fa.indexOf(".")>-1?(d=a.fa.split("."),f=d[0],m=d[1]):m=a.fa,d=m.split("");let p="";for(let g=d.length-1;g>=0;g--){let v=d[g];if(v!="#"&&v!="0"&&v!=","&&isNaN(parseInt(v)))p=v+p;else break}let b="";if(a.fa.indexOf(".")>-1){let g=m;p.length>0&&(g=m.replace(p,""));let v=g.replace(/#/g,"0");v+="0",b=f+"."+v+p}else p.length>0?b=m.replace(p,"")+".0"+p:b=m+".0"+p;e.updateFormat(t,"ct",b)}),$("#luckysheet-icon-fmt-other").click(function(){let t=Be(),l=t.format,o=t.defaultFmt,a=$(this).attr("id")+"-menuButton",s=$("#"+a);if(s.length==0){let d=o,p=e.createButtonMenu(d),b=Tt(e.menu,{id:"fmt-other",item:p,subclass:"",sub:""}),g=[{text:l.moreCurrency+"...",value:"morecurrency",example:""},{text:l.moreDateTime+"...",value:"moredatetime",example:""},{text:l.moreNumber+"...",value:"moredigit",example:""}],v=e.createButtonMenu(g),x=Tt(e.menu,{id:"fmtOtherSelf",item:v,subclass:"luckysheet-menuButton-sub"});$("body").first().append(b+x),s=$("#"+a).width(250),e.focus(s),s.find(".luckysheet-cols-menuitem").click(function(){s.hide(),kl();let _=$(this),S=_.attr("itemvalue"),I=_.attr("itemname");if($("#luckysheet-icon-fmt-other").find(".luckysheet-toolbar-menu-button-caption").html(" "+I+" "),S=="fmtOtherSelf")return;let P=It.deepCopyFlowData(h.flowdata);e.focus(s,S),e.updateFormat(P,"ct",S)}),$("#luckysheet-icon-fmtOtherSelf-menuButton").find(".luckysheet-cols-menuitem").click(function(){s.hide(),$("#luckysheet-icon-fmtOtherSelf-menuButton").hide(),kl();let _=$(this).attr("itemvalue");zg.createDialog(_),zg.init()})}else{let d=$(this).find(".luckysheet-toolbar-menu-button-caption").text().trim(),p=o.find(b=>b.text===d);p&&e.focus(s,p.value)}let u=$(this).outerWidth(),f=s.outerWidth(),m=$(this).offset().left;f>u&&f+m>$("#"+h.container).width()&&(m=m-f+u),bn(s,m,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-font-family").mousedown(function(t){Ro(t),t.stopPropagation()}).click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let u=e.createButtonMenu(e.fontSelectList),f=Tt(e.menu,{id:"font-family",item:u,subclass:"",sub:""});$("body").first().append(f),l=$("#"+t).width(200),e.focus(l),l.on("click",".luckysheet-cols-menuitem",function(){l.hide(),kl();let m=$(this),d=m.attr("itemvalue"),p=m.attr("itemname");e.focus(l,d),$("#luckysheet-icon-font-family").find(".luckysheet-toolbar-menu-button-caption").html(" "+p+" ");let b=It.deepCopyFlowData(h.flowdata);e.updateFormat(b,"ff",d)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),bn(l,s,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-text-color").mousedown(function(t){Ro(t),t.stopPropagation()}).click(function(){let t=It.deepCopyFlowData(h.flowdata),l=$(this).attr("color");l==null&&(l="#000000"),e.updateFormat(t,"fc",l)}),$("#luckysheet-icon-text-color-menu").mousedown(function(t){Ro(t),t.stopPropagation()}).click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Be(),m=f.toolbar,d=f.button,p=f.alternatingColors,b=[{name:m.alternatingColors+"...",id:"luckysheet-color-alternate",example:""}],g=e.createButtonMenu(b),v="text-color-self",x=Tt(e.coloritem,{class:"luckysheet-icon-alternateformat",name:m.alternatingColors+"..."}),_=Tt(e.color,{id:t,coloritem:x,colorself:v,sub:"",resetColor:m.resetColor});$("body").first().append(_),l=$("#"+t),$("#"+t).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:d.cancel,chooseText:d.confirm,togglePaletteMoreText:m.customColor,togglePaletteLessText:m.collapse,togglePaletteOnly:!0,clearText:m.clearText,color:ut.defaultTextColor,noColorSelectedText:m.noColorSelectedText,localStorageKey:"spectrum.textcolor"+Ue.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(S){let I=$(this);S!=null?S=S.toHexString():S="#000";let P=null;$("#luckysheet-icon-text-color .text-color-bar").css("background-color",S),$("#luckysheet-icon-text-color").attr("color",S);let F=It.deepCopyFlowData(h.flowdata);e.updateFormat(F,"fc",S),l.hide(),kl()}}),l.find(".luckysheet-color-reset").click(function(){l.hide(),kl();let S=$("#"+t).find(".luckysheet-color-selected");S.val("#000000"),$("#luckysheet-icon-text-color").attr("color",null),S.spectrum("set","#000000"),$("#luckysheet-icon-text-color .luckysheet-color-menu-button-indicator").css("border-bottom-color","#000000");let I=It.deepCopyFlowData(h.flowdata);e.updateFormat(I,"fc",null)}),l.find(".luckysheet-icon-alternateformat").click(function(){if(l.hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(p.errorInfo):ke.info(p.errorInfo,"");return}let S=$.extend(!0,{},h.luckysheet_select_save[0]);Ur.rangeIsExists(S)[0]||(Ur.modelfocusIndex=0,Ur.new(S)),Ur.init(),Ur.perfect()})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o);let u=$(this).offset().top+26;setTimeout(function(){let f=$("#"+t).find(".luckysheet-color-selected");f.spectrum("set",f.val()),bn(l,s-28,u,"lefttop")},1)}),$("#luckysheet-icon-cell-color").click(function(){let t=It.deepCopyFlowData(h.flowdata),l=$(this).attr("color");l==null&&(l="#ffffff"),e.updateFormat(t,"bg",l)}),$("#luckysheet-icon-cell-color-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f="cell-color-self",m=Be(),d=m.toolbar,p=m.button,b=m.alternatingColors,g=Tt(e.coloritem,{class:"luckysheet-icon-alternateformat",name:d.alternatingColors+"..."}),v=Tt(e.color,{id:t,coloritem:g,colorself:f,sub:"",resetColor:d.resetColor});$("body").first().append(v),l=$("#"+t),$("#"+t).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:ut.defaultCellColor,cancelText:p.cancel,chooseText:p.confirm,togglePaletteMoreText:d.customColor,togglePaletteLessText:d.collapse,togglePaletteOnly:!0,clearText:d.clearText,noColorSelectedText:d.noColorSelectedText,localStorageKey:"spectrum.bgcolor"+Ue.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(x){let _=$(this);x!=null?x=x.toHexString():x="#fff";let S=null;$("#luckysheet-icon-cell-color .text-color-bar").css("background-color",x),$("#luckysheet-icon-cell-color").attr("color",x);let I=It.deepCopyFlowData(h.flowdata);e.updateFormat(I,"bg",x),l.hide(),kl()}}),l.find(".luckysheet-color-reset").click(function(){l.hide(),kl();let x=$("#"+t).find(".luckysheet-color-selected");x.val("#ffffff"),$("#luckysheet-icon-cell-color").attr("color",null),x.spectrum("set","#ffffff"),$("#luckysheet-icon-cell-color .luckysheet-color-menu-button-indicator").css("border-bottom-color","#ffffff");let _=It.deepCopyFlowData(h.flowdata);e.updateFormat(_,"bg",null)}),l.find(".luckysheet-icon-alternateformat").click(function(){if(!yi()){ke.info("",Be().pivotTable.errorNotAllowEdit);return}if(l.hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(b.errorInfo):ke.info(b.errorInfo,"");return}let x=$.extend(!0,{},h.luckysheet_select_save[0]);Ur.rangeIsExists(x)[0]||(Ur.modelfocusIndex=0,Ur.new(x)),Ur.init(),Ur.perfect()}),$("#"+t).find(".luckysheet-color-selected").val("#fff")}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o);let u=$(this).offset().top+26;setTimeout(function(){let f=$("#"+t).find(".luckysheet-color-selected");f.spectrum("set",f.val()),bn(l,s-28,u,"lefttop")},1)});let n=null;$("#luckysheet-icon-font-size").mousedown(function(t){if(parseInt($("#luckysheet-input-box").css("top"))>0){let l=window.getSelection();if(l.type!="None"){let o=l.getRangeAt(0);o.collapsed||(h.inlineStringEditRange=o.cloneRange())}}Ro(t),t.stopPropagation()}).click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=[{text:"9",value:"9",example:""},{text:"10",value:"10",example:""},{text:"11",value:"11",example:""},{text:"12",value:"12",example:""},{text:"14",value:"14",example:""},{text:"16",value:"16",example:""},{text:"18",value:"18",example:""},{text:"20",value:"20",example:""},{text:"22",value:"22",example:""},{text:"24",value:"24",example:""},{text:"26",value:"26",example:""},{text:"28",value:"28",example:""},{text:"36",value:"36",example:""},{text:"48",value:"48",example:""},{text:"72",value:"72",example:""}],m=e.createButtonMenu(f),d=Tt(e.menu,{id:"font-size",item:m,subclass:"",sub:""});$("body").first().append(d),l=$("#"+t).width(150),e.focus(l,10),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let p=$(this),b=p.attr("itemvalue"),g=$("#luckysheet-icon-font-size input");$("#luckysheet-icon-font-size").attr("itemvalue",b),e.focus(l,b),g.val(b);let v=It.deepCopyFlowData(h.flowdata);e.updateFormat(v,"fs",b),clearTimeout(n)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$("#luckysheet-icon-font-size").attr("itemvalue");s==null&&(s=10),e.focus(l,s);let u=$(this).offset().left;a>o&&a+u>$("#"+h.container).width()&&(u=u-a+o),bn(l,u,$(this).offset().top+25,"lefttop")}).find("input.luckysheet-toolbar-textinput").keydown(function(t){Ro(t),t.stopPropagation()}).keyup(function(t){if(t.keyCode!=13)return;let l=$(this),o=parseInt(l.val()),a=$("#luckysheet-icon-font-size-menuButton");e.focus(a,o);let s=It.deepCopyFlowData(h.flowdata);e.updateFormat(s,"fs",o),n=setTimeout(function(){a.hide(),l.blur()},200)}),$("#luckysheet-icon-border-all").click(function(){if(!yi()){ke.info("",Be().pivotTable.errorNotAllowEdit);return}if(!zo(h.currentSheetIndex))return;let t=It.deepCopyFlowData(h.flowdata),l=$(this).attr("type");l==null&&(l="border-all");let o="luckysheet-icon-borderColor-menuButton",a=$("#"+o).find(".luckysheet-color-selected").val(),s=$("#luckysheetborderSizepreview").attr("itemvalue");(a==null||a=="")&&(a="#000"),(s==null||s=="")&&(s="1");let u=$.extend(!0,{},h.config);u.borderInfo==null&&(u.borderInfo=[]);let f={rangeType:"range",borderType:l,color:a,style:s,range:$.extend(!0,[],h.luckysheet_select_save)};if(u.borderInfo.push(f),h.clearjfundo){h.jfundo.length=0;let m=[];m.type="borderChange",m.config=$.extend(!0,{},h.config),m.curconfig=$.extend(!0,{},u),m.sheetIndex=h.currentSheetIndex,h.jfredo.push(m)}Ue.saveParam("cg",h.currentSheetIndex,u.borderInfo,{k:"borderInfo"}),h.config=u,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,setTimeout(function(){Xt()},1)}),$("#luckysheet-icon-border-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let u=10,f=120,m=Be(),d=m.border,p=m.toolbar,b=m.button,g=[{text:d.borderTop,value:"border-top",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-top iconfont luckysheet-iconfont-shangbiankuang" style="user-select: none;"> </div> </div>'},{text:d.borderBottom,value:"border-bottom",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-bottom iconfont luckysheet-iconfont-xiabiankuang" style="user-select: none;"> </div> </div>'},{text:d.borderLeft,value:"border-left",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-left iconfont luckysheet-iconfont-zuobiankuang" style="user-select: none;"> </div> </div>'},{text:d.borderRight,value:"border-right",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-right iconfont luckysheet-iconfont-youbiankuang" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:d.borderNone,value:"border-none",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-none iconfont luckysheet-iconfont-wubiankuang" style="user-select: none;"> </div> </div>'},{text:d.borderAll,value:"border-all",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-all iconfont luckysheet-iconfont-quanjiabiankuang" style="user-select: none;"> </div> </div>'},{text:d.borderOutside,value:"border-outside",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-outside iconfont luckysheet-iconfont-sizhoujiabiankuang" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:d.borderInside,value:"border-inside",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-inside iconfont luckysheet-iconfont-neikuangxian" style="user-select: none;"> </div> </div>'},{text:d.borderHorizontal,value:"border-horizontal",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-horizontal iconfont luckysheet-iconfont-neikuanghengxian" style="user-select: none;"> </div> </div>'},{text:d.borderVertical,value:"border-vertical",example:'<div class="luckysheet-icon luckysheet-inline-block luckysheet-material-icon luckysheet-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-border-vertical iconfont luckysheet-iconfont-neikuangshuxian" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:"<span id='luckysheet-icon-borderColor-linecolor' class='luckysheet-mousedown-cancel' style='border-bottom:3px solid #000;'>"+d.borderColor+"</span>",value:"borderColor",example:"more"},{text:""+d.borderSize+"<img id='luckysheetborderSizepreview' width=100 height=10 src='data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' style='position:absolute;bottom:-5px;right:0px;width:100px;height:10px;'>",value:"borderSize",example:"more"}],v=ga.border,x=e.createButtonMenu(g),_=Tt(e.menu,{id:"border-menu",item:x,subclass:"",sub:""}),S=[{text:d.borderNone,value:"0",example:""},{text:"<canvas type='Thin' class='border-Thin' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"1",example:""},{text:"<canvas type='Hair' class='border-Hair' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"2",example:""},{text:"<canvas type='Dotted' class='border-Dotted' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"3",example:""},{text:"<canvas type='Dashed' class='border-Dashed' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"4",example:""},{text:"<canvas type='DashDot' class='border-DashDot' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"5",example:""},{text:"<canvas type='DashDotDot' class='border-DashDotDot' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"6",example:""},{text:"<canvas type='Medium' class='border-Medium' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"8",example:""},{text:"<canvas type='MediumDashed' class='border-MediumDashed' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"9",example:""},{text:"<canvas type='MediumDashDot' class='border-MediumDashDot' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"10",example:""},{text:"<canvas type='MediumDashDotDot' class='border-MediumDashDotDot' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"11",example:""},{text:"<canvas type='Thick' class='border-Thick' width="+f+" height="+u+" style='width:"+f+"px;height:"+u+"px;position:static;'></canvas>",value:"13",example:""}],I=e.createButtonMenu(S),P=Tt(e.menu,{id:"borderSize",item:I,subclass:"luckysheet-menuButton-sub"}),F="luckysheet-icon-borderSize-menuButton",D="luckysheet-icon-borderColor-menuButton",k=Tt(e.color,{id:D,coloritem:"",colorself:"",sub:"luckysheet-menuButton-sub",resetColor:p.resetColor});$("body").first().append(_+k+P),l=$("#"+t).width(170),e.focus(l,"border-all"),$("#"+F+" canvas").each(function(w){let C=$(this).attr("type"),T=$(this).closest(".luckysheet-cols-menuitem").attr("itemvalue"),O=$(this).addClass("luckysheet-mousedown-cancel").get(0).getContext("2d");O.translate(.5,.5),e.setLineDash(O,T,"h",0,5,100,5),O.strokeStyle="#000000",O.stroke(),O.closePath()}),$("#"+F+" .luckysheet-cols-menuitem").click(function(){$("#"+F).hide();let w=$(this),C=w.attr("itemvalue");if(C==0)$("#luckysheetborderSizepreview").attr("src","data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==").attr("itemvalue",null);else{let T=w.find("canvas").get(0).toDataURL("image/png");$("#luckysheetborderSizepreview").attr("src",T).attr("itemvalue",C)}e.focus($("#"+F),C)}),l.find(".luckysheet-cols-menuitem").click(function(){if(!yi()){ke.info("",Be().pivotTable.errorNotAllowEdit);return}l.hide(),kl();let w=$(this),C=w.attr("itemvalue");if(C=="borderColor"||C=="borderSize"||!zo(h.currentSheetIndex))return;let T=It.deepCopyFlowData(h.flowdata),O=$("#"+D).find(".luckysheet-color-selected").val(),z=$("#luckysheetborderSizepreview").attr("itemvalue");(O==null||O=="")&&(O="#000"),(z==null||z=="")&&(z="1");let A=$.extend(!0,{},h.config);A.borderInfo==null&&(A.borderInfo=[]);let E={rangeType:"range",borderType:C,color:O,style:z,range:$.extend(!0,[],h.luckysheet_select_save)};if(A.borderInfo.push(E),h.clearjfundo){h.jfundo.length=0;let N=[];N.type="borderChange",N.config=$.extend(!0,{},h.config),N.curconfig=$.extend(!0,{},A),N.sheetIndex=h.currentSheetIndex,h.jfredo.push(N)}Ue.saveParam("cg",h.currentSheetIndex,A.borderInfo,{k:"borderInfo"}),h.config=A,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,setTimeout(function(){Xt()},1),$("#luckysheet-icon-border-all").attr("type",C),$("#luckysheet-icon-border-all").find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-"+C+v[C]),e.focus(l,C)}),$("#"+D).find(".luckysheet-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:"#000",cancelText:b.cancel,chooseText:b.confirm,togglePaletteMoreText:p.customColor,togglePaletteLessText:p.collapse,togglePaletteOnly:!0,clearText:p.clearText,noColorSelectedText:p.noColorSelectedText,localStorageKey:"spectrum.bordercolor"+Ue.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(w){let C=$(this);w!=null?w=w.toHexString():w="#000";let T=null;$("#luckysheet-icon-borderColor-linecolor").css("border-bottom-color",w),$("#"+D).find(".luckysheet-color-selected").val(w)}}),$("#"+D).find(".luckysheet-color-reset").click(function(){let w=$("#"+D).find(".luckysheet-color-selected");w.val("#000"),$("#luckysheet-icon-cell-color").attr("color",null),w.spectrum("set","#000"),$("#luckysheet-icon-borderColor-linecolor").css("border-bottom-color","#000")})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),bn(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-merge-button").click(function(){if(!ea(h.currentSheetIndex))return;if(na()){at()?alert("\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF"):ke.info("\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF","");return}if(h.config.merge!=null){let l=!1;for(let o=0;o<h.luckysheet_select_save.length;o++){let a=h.luckysheet_select_save[o].row[0],s=h.luckysheet_select_save[o].row[1],u=h.luckysheet_select_save[o].column[0],f=h.luckysheet_select_save[o].column[1];if(l=sr(h.config,a,s,u,f),l)break}if(l){at()?alert("\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"):ke.info("\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C","");return}}let t=It.deepCopyFlowData(h.flowdata);e.updateFormat_mc(t,"mergeAll")}),$("#luckysheet-icon-merge-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Be().merge,m=[{text:f.mergeAll,value:"mergeAll",example:""},{text:f.mergeV,value:"mergeV",example:""},{text:f.mergeH,value:"mergeH",example:""},{text:f.mergeCancel,value:"mergeCancel",example:""}],d=e.createButtonMenu(m),p=Tt(e.menu,{id:"merge-menu",item:d,subclass:"",sub:""});$("body").first().append(p),l=$("#"+t),e.focus(l),l.find(".luckysheet-cols-menuitem").click(function(){if(l.hide(),kl(),na()){at()?alert(f.overlappingError):ke.info(f.overlappingError,"");return}if(h.config.merge!=null){let x=!1;for(let _=0;_<h.luckysheet_select_save.length;_++){let S=h.luckysheet_select_save[_].row[0],I=h.luckysheet_select_save[_].row[1],P=h.luckysheet_select_save[_].column[0],F=h.luckysheet_select_save[_].column[1];if(x=sr(h.config,S,I,P,F),x)break}if(x){at()?alert(f.partiallyError):ke.info(f.partiallyError,"");return}}let b=$(this),g=b.attr("itemvalue");e.focus(l,g);let v=It.deepCopyFlowData(h.flowdata);e.updateFormat_mc(v,g)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),bn(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-align").click(function(){let t=$("#luckysheet-icon-align").attr("type");t==null&&(t="left");let l=It.deepCopyFlowData(h.flowdata);e.updateFormat(l,"ht",t)}),$("#luckysheet-icon-align-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Be().align,m=[{text:f.left,value:"left",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-left iconfont luckysheet-iconfont-wenbenzuoduiqi" style="user-select: none;"> </div> </div>'},{text:f.center,value:"center",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-center iconfont luckysheet-iconfont-wenbenjuzhongduiqi" style="user-select: none;"> </div> </div>'},{text:f.right,value:"right",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-right iconfont luckysheet-iconfont-wenbenyouduiqi" style="user-select: none;"> </div> </div>'}],d=ga.align,p=e.createButtonMenu(m),b=Tt(e.menu,{id:"align-menu",item:p,subclass:"",sub:""});$("body").first().append(b),l=$("#"+t).width(120),e.focus(l),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let g=$(this),v=g.attr("itemvalue");e.focus(l,v),$("#luckysheet-icon-align").attr("type",v).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-"+v+d[v]);let _=It.deepCopyFlowData(h.flowdata);e.updateFormat(_,"ht",v)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),bn(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-valign").click(function(){let t=$("#luckysheet-icon-valign").attr("type");t==null&&(t="bottom");let l=It.deepCopyFlowData(h.flowdata);e.updateFormat(l,"vt",t)}),$("#luckysheet-icon-valign-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Be().align;if(l.length==0){let m=[{text:a.top,value:"top",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-top iconfont luckysheet-iconfont-dingbuduiqi" style="user-select: none;"> </div> </div>'},{text:a.middle,value:"middle",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-middle iconfont luckysheet-iconfont-shuipingduiqi" style="user-select: none;"> </div> </div>'},{text:a.bottom,value:"bottom",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-bottom iconfont luckysheet-iconfont-dibuduiqi" style="user-select: none;"> </div> </div>'}],d=ga.align,p=e.createButtonMenu(m),b=Tt(e.menu,{id:"valign-menu",item:p,subclass:"",sub:""});$("body").first().append(b),l=$("#"+t).width(120),e.focus(l,"bottom"),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let g=$(this),v=g.attr("itemvalue");e.focus(l,v),$("#luckysheet-icon-valign").attr("type",v).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-"+v+d[v]);let _=It.deepCopyFlowData(h.flowdata);e.updateFormat(_,"vt",v)})}let s=$(this).outerWidth(),u=l.outerWidth(),f=$(this).offset().left;u>s&&u+f>$("#"+h.container).width()&&(f=f-u+s),bn(l,f-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-textwrap-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Be().textWrap,m=[{text:f.overflow,value:"overflow",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-overflow iconfont luckysheet-iconfont-yichu1" style="user-select: none;"> </div> </div>'},{text:f.wrap,value:"wrap",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-wrap iconfont luckysheet-iconfont-zidonghuanhang" style="user-select: none;"> </div> </div>'},{text:f.clip,value:"clip",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-clip iconfont luckysheet-iconfont-jieduan" style="user-select: none;"> </div> </div>'}],d=ga.textWrap,p=e.createButtonMenu(m),b=Tt(e.menu,{id:"textwrap-menu",item:p,subclass:"",sub:""});$("body").first().append(b),l=$("#"+t).width(120),e.focus(l,"clip"),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let g=$(this),v=g.attr("itemvalue");e.focus(l,v),$("#luckysheet-icon-textwrap").attr("type",v).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-"+v+d[v]);let _=It.deepCopyFlowData(h.flowdata);e.updateFormat(_,"tb",v)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),bn(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-rotation-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Be().rotation,m=[{text:f.none,value:"none",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-none iconfont luckysheet-iconfont-wuxuanzhuang" style="user-select: none;"> </div> </div>'},{text:f.angleup,value:"angleup",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angleup iconfont luckysheet-iconfont-xiangshangqingxie" style="user-select: none;"> </div> </div>'},{text:f.angledown,value:"angledown",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-angledown iconfont luckysheet-iconfont-xiangxiaqingxie" style="user-select: none;"> </div> </div>'},{text:f.vertical,value:"vertical",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-vertical iconfont luckysheet-iconfont-shupaiwenzi" style="user-select: none;"> </div> </div>'},{text:f.rotationUp,value:"rotation-up",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-up iconfont luckysheet-iconfont-wenbenxiangshang" style="user-select: none;"> </div> </div>'},{text:f.rotationDown,value:"rotation-down",example:'<div class="luckysheet-icon luckysheet-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-rotation-down iconfont luckysheet-iconfont-xiangxia90" style="user-select: none;"> </div> </div>'}],d=ga.rotation,p=e.createButtonMenu(m),b=Tt(e.menu,{id:"rotation-menu",item:p,subclass:"",sub:""});$("body").first().append(b),l=$("#"+t).width(160),e.focus(l),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let g=$(this),v=g.attr("itemvalue");e.focus(l,v),$("#luckysheet-icon-rotation").attr("type",v).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-"+v+d[v]);let _=It.deepCopyFlowData(h.flowdata);e.updateFormat(_,"tr",v)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),bn(l,s-28,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-freezen-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let f=Be().freezen,m=[{text:f.freezenRow,value:"freezenRow",example:""},{text:f.freezenColumn,value:"freezenColumn",example:""},{text:f.freezenRC,value:"freezenRC",example:""},{text:"",value:"split",example:""},{text:f.freezenRowRange,value:"freezenRowRange",example:""},{text:f.freezenColumnRange,value:"freezenColumnRange",example:""},{text:f.freezenRCRange,value:"freezenRCRange",example:""},{text:"",value:"split",example:""},{text:f.freezenCancel,value:"freezenCancel",example:""}],d=e.createButtonMenu(m),p=Tt(e.menu,{id:"freezen-menu",item:d,subclass:"",sub:""});$("body").first().append(p),l=$("#"+t).width(170),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let b=$(this),g=b.attr("itemvalue");if(e.focus(l,g),g==="freezenCancel"&&l.find(".fa.fa-check").remove(),Ie.saveFrozen(g),g=="freezenRow")Vh();else if(g=="freezenColumn")Wh();else if(g=="freezenRC"){if(Ie.freezenRealFirstRowColumn){let v=0,x=h.visibledatarow[v]-2+h.columnHeaderHeight,_=[h.visibledatarow[v],v+1,0,Ie.cutVolumn(h.visibledatarow,v+1),x];Ie.saveFreezen(_,x,null,null),Ie.createFreezenHorizontal(_,x);let S=0,I=h.visibledatacolumn[S]-2+h.rowHeaderWidth,P=[h.visibledatacolumn[S],S+1,0,Ie.cutVolumn(h.visibledatacolumn,S+1),I];Ie.saveFreezen(null,null,P,I),Ie.createFreezenVertical(P,I)}else{let v=$("#luckysheet-cell-main").scrollTop(),x=$l(h.visibledatarow,v);x==-1&&(x=0);let _=h.visibledatarow[x]-2-v+h.columnHeaderHeight,S=[h.visibledatarow[x],x+1,v,Ie.cutVolumn(h.visibledatarow,x+1),_];Ie.saveFreezen(S,_,null,null),Ie.createFreezenHorizontal(S,_);let I=$("#luckysheet-cell-main").scrollLeft(),P=$l(h.visibledatacolumn,I);P==-1&&(P=0);let F=h.visibledatacolumn[P]-2-I+h.rowHeaderWidth,D=[h.visibledatacolumn[P],P+1,I,Ie.cutVolumn(h.visibledatacolumn,P+1),F];Ie.saveFreezen(null,null,D,F),Ie.createFreezenVertical(D,F)}Ie.createAssistCanvas(),Xt()}else if(g=="freezenRowRange"){if(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0){at()?alert(f.noSeletionError):ke.info(f.noSeletionError,"");return}let v=h.luckysheet_select_save[h.luckysheet_select_save.length-1].top;if(Ie.freezenRealFirstRowColumn&&v>$("#luckysheet-cell-main").height())return ke.info(f.rangeRCOverErrorTitle,f.rangeRCOverError);let x=$("#luckysheet-cell-main").scrollTop(),_=$l(h.visibledatarow,x),S=h.luckysheet_select_save[h.luckysheet_select_save.length-1],I=S.row_focus==null?S.row[0]:S.row_focus;I>_&&(_=I),_==-1&&(_=0);let P,F;Ie.freezenRealFirstRowColumn?(P=h.visibledatarow[_]-2+h.columnHeaderHeight,F=[h.visibledatarow[_],_+1,0,Ie.cutVolumn(h.visibledatarow,_+1),P]):(P=h.visibledatarow[_]-2-x+h.columnHeaderHeight,F=[h.visibledatarow[_],_+1,x,Ie.cutVolumn(h.visibledatarow,_+1),P]),Ie.saveFreezen(F,P,null,null),Ie.freezenverticaldata!=null&&(Ie.cancelFreezenVertical(),Ie.createAssistCanvas(),Xt()),Ie.createFreezenHorizontal(F,P),Ie.createAssistCanvas(),Xt()}else if(g=="freezenColumnRange"){if(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0){at()?alert(f.noSeletionError):ke.info(f.noSeletionError,"");return}let v=h.luckysheet_select_save[h.luckysheet_select_save.length-1].left;if(Ie.freezenRealFirstRowColumn&&v>$("#luckysheet-cell-main").width())return ke.info(f.rangeRCOverErrorTitle,f.rangeRCOverError);let x=$("#luckysheet-cell-main").scrollLeft(),_=$l(h.visibledatacolumn,x),S=h.luckysheet_select_save[h.luckysheet_select_save.length-1],I=S.column_focus==null?S.column[0]:S.column_focus;I>_&&(_=I),_==-1&&(_=0);let P,F;Ie.freezenRealFirstRowColumn?(P=h.visibledatacolumn[_]-2+h.rowHeaderWidth,F=[h.visibledatacolumn[_],_+1,0,Ie.cutVolumn(h.visibledatacolumn,_+1),P]):(P=h.visibledatacolumn[_]-2-x+h.rowHeaderWidth,F=[h.visibledatacolumn[_],_+1,x,Ie.cutVolumn(h.visibledatacolumn,_+1),P]),Ie.saveFreezen(null,null,F,P),Ie.freezenhorizontaldata!=null&&(Ie.cancelFreezenHorizontal(),Ie.createAssistCanvas(),Xt()),Ie.createFreezenVertical(F,P),Ie.createAssistCanvas(),Xt()}else if(g=="freezenRCRange"){if(h.luckysheet_select_save==null||h.luckysheet_select_save.length==0){at()?alert(f.noSeletionError):ke.info(f.noSeletionError,"");return}let v=h.luckysheet_select_save[h.luckysheet_select_save.length-1].top,x=h.luckysheet_select_save[h.luckysheet_select_save.length-1].left;if(Ie.freezenRealFirstRowColumn&&(v>$("#luckysheet-cell-main").height()||x>$("#luckysheet-cell-main").width()))return ke.info(f.rangeRCOverErrorTitle,f.rangeRCOverError);let _=$("#luckysheet-cell-main").scrollTop(),S=$l(h.visibledatarow,_),I=h.luckysheet_select_save[h.luckysheet_select_save.length-1],P=I.row_focus==null?I.row[0]:I.row_focus;P>S&&(S=P),S==-1&&(S=0);let F,D;Ie.freezenRealFirstRowColumn?(F=h.visibledatarow[S]-2+h.columnHeaderHeight,D=[h.visibledatarow[S],S+1,0,Ie.cutVolumn(h.visibledatarow,S+1),F],Ie.saveFreezen(D,F,null,null)):(F=h.visibledatarow[S]-2-_+h.columnHeaderHeight,D=[h.visibledatarow[S],S+1,_,Ie.cutVolumn(h.visibledatarow,S+1),F],Ie.saveFreezen(D,F,null,null)),Ie.createFreezenHorizontal(D,F);let k=$("#luckysheet-cell-main").scrollLeft(),w=$l(h.visibledatacolumn,k),C=I.column_focus==null?I.column[0]:I.column_focus;C>w&&(w=C),w==-1&&(w=0);let T,O;Ie.freezenRealFirstRowColumn?(T=h.visibledatacolumn[w]-2+h.rowHeaderWidth,O=[h.visibledatacolumn[w],w+1,0,Ie.cutVolumn(h.visibledatacolumn,w+1),T]):(T=h.visibledatacolumn[w]-2-k+h.rowHeaderWidth,O=[h.visibledatacolumn[w],w+1,k,Ie.cutVolumn(h.visibledatacolumn,w+1),T]),Ie.saveFreezen(null,null,O,T),Ie.createFreezenVertical(O,T),Ie.createAssistCanvas(),Xt()}else g=="freezenCancel"&&(Ie.freezenverticaldata!=null&&(Ie.cancelFreezenVertical(),Ie.createAssistCanvas(),Xt()),Ie.freezenhorizontaldata!=null&&(Ie.cancelFreezenHorizontal(),Ie.createAssistCanvas(),Xt()),Ie.scrollAdapt());setTimeout(function(){mr()},0)})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),bn(l,s-68,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-autofilter").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t);if(l.length==0){let u=Be(),f=u.sort,m=u.filter,d=[{text:f.asc,value:"asc",example:'<i class="iconfont luckysheet-iconfont-shengxu" aria-hidden="true"></i>'},{text:f.desc,value:"desc",example:'<i class="iconfont luckysheet-iconfont-jiangxu" aria-hidden="true"></i>'},{text:f.custom+"...",value:"diysort",example:'<i class="iconfont luckysheet-iconfont-zidingyipaixu" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:m.filter,value:"filter",example:'<i class="iconfont luckysheet-iconfont-shaixuan2" aria-hidden="true"></i>'},{text:m.clearFilter,value:"clearfilter",example:'<i class="iconfont luckysheet-iconfont-qingchushaixuan" aria-hidden="true"></i>'}],p=e.createButtonMenu(d),b=Tt(e.menu,{id:"autofilter",item:p,subclass:"",sub:""});$("body").first().append(b),l=$("#"+t).width(150),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let g=$(this),v=g.attr("itemvalue");v=="diysort"?$("#luckysheetorderby").click():v=="asc"?Gm(!0):v=="desc"?Gm(!1):v=="filter"?$("#luckysheet-filter-options-sheet"+h.currentSheetIndex).length>0?$("#luckysheet-filter-initial").click():rf():v=="clearfilter"&&$("#luckysheet-filter-initial").click()})}let o=$(this).outerWidth(),a=l.outerWidth(),s=$(this).offset().left;a>o&&a+s>$("#"+h.container).width()&&(s=s-a+o),bn(l,s,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-seachmore").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Be().findAndReplace;if(l.length==0){let m=[{text:a.find+" ...",value:"search",example:'<i class="iconfont luckysheet-iconfont-sousuo" aria-hidden="true"></i>'},{text:a.replace+" ...",value:"replace",example:'<i class="iconfont luckysheet-iconfont-tihuan" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:a.location+" ...",value:"location",example:'<i class="iconfont luckysheet-iconfont-dingwei" aria-hidden="true"></i>'},{text:a.formula,value:"locationFormula",example:a.locationExample},{text:a.date,value:"locationConstantDate",example:a.locationExample},{text:a.number,value:"locationConstantNumber",example:a.locationExample},{text:a.string,value:"locationConstantString",example:a.locationExample},{text:a.error,value:"locationConstantError",example:a.locationExample},{text:a.condition,value:"locationCF",example:a.locationExample},{text:a.rowSpan,value:"locationStepRow",example:a.locationExample},{text:a.columnSpan,value:"locationStepColumn",example:a.locationExample}],d=e.createButtonMenu(m),p=Tt(e.menu,{id:"seachmore",item:d,subclass:"",sub:""});$("body").first().append(p),l=$("#"+t).width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let b=$(this),g=b.attr("itemvalue");if(g=="search"||g=="replace")g=="search"?is.createDialog(0):g=="replace"&&is.createDialog(1),is.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(g=="location")ia.createDialog(),ia.init();else if(g=="locationFormula"||g=="locationConstantDate"||g=="locationConstantNumber"||g=="locationConstantString"||g=="locationConstantError"||g=="locationCF"){let v=h.luckysheet_select_save[0],x;h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&v.row[0]==v.row[1]&&v.column[0]==v.column[1]?x=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1]}]:x=$.extend(!0,[],h.luckysheet_select_save),g=="locationFormula"?ia.apply(x,"locationFormula","all"):g=="locationConstantDate"?ia.apply(x,"locationConstant","d"):g=="locationConstantNumber"?ia.apply(x,"locationConstant","n"):g=="locationConstantString"?ia.apply(x,"locationConstant","s,g"):g=="locationConstantError"?ia.apply(x,"locationConstant","e"):g=="locationCF"&&ia.apply(x,"locationCF")}else if(g=="locationStepRow"){if(h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].row[0]==h.luckysheet_select_save[0].row[1]){at()?alert(a.lessTwoRowTip):ke.info("",a.lessTwoRowTip);return}let v=$.extend(!0,[],h.luckysheet_select_save);ia.apply(v,"locationStepRow")}else if(g=="locationStepColumn"){if(h.luckysheet_select_save.length==0||h.luckysheet_select_save.length==1&&h.luckysheet_select_save[0].column[0]==h.luckysheet_select_save[0].column[1]){at()?alert(a.lessTwoColumnTip):ke.info("",a.lessTwoColumnTip);return}let v=$.extend(!0,[],h.luckysheet_select_save);ia.apply(v,"locationStepColumn")}})}let s=$(this).outerWidth(),u=l.outerWidth(),f=$(this).offset().left;u>s&&u+f>$("#"+h.container).width()&&(f=f-u+s),bn(l,f,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-function").click(function(){e.autoSelectionFormula("SUM")}),$("#luckysheet-icon-function-menu").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Be().formula;if(l.length==0){let m=[{text:a.sum,value:"SUM",example:"SUM"},{text:a.average,value:"AVERAGE",example:"AVERAGE"},{text:a.count,value:"COUNT",example:"COUNT"},{text:a.max,value:"MAX",example:"MAX"},{text:a.min,value:"MIN",example:"MIN"},{text:"",value:"split",example:""},{text:a.ifGenerate,value:"if",example:"IF"},{text:a.find+" ...",value:"formula",example:""}],d=e.createButtonMenu(m),p=Tt(e.menu,{id:"function-menu",item:d,subclass:"",sub:""});$("body").first().append(p),l=$("#"+t).width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let b=$(this),g=b.attr("itemvalue");if(g=="if"){let v=h.luckysheet_select_save[h.luckysheet_select_save.length-1],x=v.row_focus==null?v.row[0]:v.row_focus,_=v.column_focus==null?v.column[0]:v.column_focus;if(!!h.flowdata[x]&&!!h.flowdata[x][_]&&!!h.flowdata[x][_].f){let S=h.flowdata[x][_].f.toString();if(S.indexOf("=if(")!=-1)pu.ifFormulaDialog(S);else{at()?alert(a.tipNotBelongToIf):ke.info(a.tipNotBelongToIf,"");return}}else pu.ifFormulaDialog();pu.init()}else if(g=="formula"){if(h.luckysheet_select_save.length==0){at()?alert(a.tipSelectCell):ke.info(a.tipSelectCell,"");return}let v=h.luckysheet_select_save[h.luckysheet_select_save.length-1],x=v.row_focus,_=v.column_focus;ti(x,_,h.flowdata);let S=h.flowdata[x][_];if(S!=null&&S.f!=null){let I=y.getfunctionParam(S.f);I.fn!=null?Ia.formulaParmDialog(I.fn,I.param):Ia.formulaListDialog()}else $("#luckysheet-rich-text-editor").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),Ia.formulaListDialog();Ia.init()}else e.autoSelectionFormula(g)})}let s=$(this).outerWidth(),u=l.outerWidth(),f=$(this).offset().left;u>s&&u+f>$("#"+h.container).width()&&(f=f-u+s),bn(l,f-48,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-bold").mousedown(function(t){Ro(t),t.stopPropagation()}).click(function(t){let l=It.deepCopyFlowData(h.flowdata),a=gu("bl",1)?0:1;e.updateFormat(l,"bl",a)}),$("#luckysheet-icon-italic").mousedown(function(t){Ro(t),t.stopPropagation()}).click(function(){let t=It.deepCopyFlowData(h.flowdata),o=gu("it",1)?0:1;e.updateFormat(t,"it",o)}),$("#luckysheet-icon-strikethrough").mousedown(function(t){Ro(t),t.stopPropagation()}).click(function(){let t=It.deepCopyFlowData(h.flowdata),o=gu("cl",1)?0:1;e.updateFormat(t,"cl",o)}),$("#luckysheet-icon-underline").mousedown(function(t){Ro(t),t.stopPropagation()}).click(function(){let t=It.deepCopyFlowData(h.flowdata),o=gu("un",1)?0:1;e.updateFormat(t,"un",o)}),$("#luckysheet-icon-conditionformat").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),o=Be().conditionformat;if(l.length==0){let f=[{text:o.highlightCellRules,value:"highlightCellRule",example:"more"},{text:o.itemSelectionRules,value:"projectSelectRule",example:"more"},{text:o.dataBar,value:"dataBar",example:"more"},{text:o.colorGradation,value:"colorGradation",example:"more"},{text:o.icons,value:"icons",example:""},{text:"",value:"split",example:""},{text:o.newRule,value:"newRule",example:""},{text:o.deleteRule,value:"deleteRule",example:"more"},{text:o.manageRules,value:"administerRule",example:""}],m=e.createButtonMenu(f),d=Tt(e.menu,{id:"conditionformat",item:m,subclass:"",sub:""}),p=[{text:o.greaterThan,value:"greaterThan",example:">"},{text:o.lessThan,value:"lessThan",example:"<"},{text:o.between,value:"betweenness",example:"[]"},{text:o.equal,value:"equal",example:"="},{text:o.textContains,value:"textContains",example:"()"},{text:o.occurrence,value:"occurrenceDate",example:o.yesterday},{text:o.duplicateValue,value:"duplicateValue",example:"##"}],b=e.createButtonMenu(p),g=Tt(e.menu,{id:"highlightCellRule",item:b,subclass:"luckysheet-menuButton-sub"}),v=[{text:o.top10,value:"top10",example:o.top10},{text:o.top10_percent,value:"top10%",example:o.top10_percent},{text:o.last10,value:"last10",example:o.last10},{text:o.last10_percent,value:"last10%",example:o.last10_percent},{text:o.aboveAverage,value:"AboveAverage",example:o.above},{text:o.belowAverage,value:"SubAverage",example:o.below}],x=e.createButtonMenu(v),_=Tt(e.menu,{id:"projectSelectRule",item:x,subclass:"luckysheet-menuButton-sub"}),S=`<div id="luckysheet-icon-dataBar-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel" style="width: 126px;padding: 5px;top: 118.5px;left: 1321.48px;display: none;">
                                    <div itemvalue="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="${o.gradientDataBar_1}"></div>
                                    </div>
                                    <div itemvalue="1" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="${o.gradientDataBar_2}"></div>
                                    </div>
                                    <div itemvalue="2" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="${o.gradientDataBar_3}"></div>
                                    </div>
                                    <div itemvalue="3" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="${o.gradientDataBar_4}"></div>
                                    </div>
                                    <div itemvalue="4" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="${o.gradientDataBar_5}"></div>
                                    </div>
                                    <div itemvalue="5" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="${o.gradientDataBar_6}"></div>
                                    </div>
                                    <div itemvalue="6" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="${o.solidColorDataBar_1}"></div>
                                    </div>
                                    <div itemvalue="7" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="${o.solidColorDataBar_2}"></div>
                                    </div>
                                    <div itemvalue="8" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="${o.solidColorDataBar_3}"></div>
                                    </div>
                                    <div itemvalue="9" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -108px;" title="${o.solidColorDataBar_4}"></div>
                                    </div>
                                    <div itemvalue="10" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -108px;" title="${o.solidColorDataBar_5}"></div>
                                    </div>
                                    <div itemvalue="11" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -108px;" title="${o.solidColorDataBar_6}"></div>
                                    </div>
                                </div>`,I=`<div id="luckysheet-icon-colorGradation-menuButton" class="luckysheet-cols-menu luckysheet-rightgclick-menu luckysheet-menuButton luckysheet-menuButton-sub luckysheet-mousedown-cancel" style="width: 126px;padding: 5px;top: 143.5px;left: 1321.48px;display: none;">
                                    <div itemvalue="0" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="${o.colorGradation_1}"></div>
                                    </div>
                                    <div itemvalue="1" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="${o.colorGradation_2}"></div>
                                    </div>
                                    <div itemvalue="2" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="${o.colorGradation_3}"></div>
                                    </div>
                                    <div itemvalue="3" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px 0;" title="${o.colorGradation_4}"></div>
                                    </div>
                                    <div itemvalue="4" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="${o.colorGradation_5}"></div>
                                    </div>
                                    <div itemvalue="5" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="${o.colorGradation_6}"></div>
                                    </div>
                                    <div itemvalue="6" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="${o.colorGradation_7}"></div>
                                    </div>
                                    <div itemvalue="7" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px -36px;" title="${o.colorGradation_8}"></div>
                                    </div>
                                    <div itemvalue="8" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="${o.colorGradation_9}"></div>
                                    </div>
                                    <div itemvalue="9" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="${o.colorGradation_10}"></div>
                                    </div>
                                    <div itemvalue="10" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="${o.colorGradation_11}"></div>
                                    </div>
                                    <div itemvalue="11" class="luckysheet-cols-menuitem luckysheet-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;">
                                        <div class="luckysheet-mousedown-cancel bgImgBox" style="background-position: -114px -72px;" title="${o.colorGradation_12}"></div>
                                    </div>
                                </div>`,P=[{text:o.deleteSheetRule,value:"delSheet",example:""}],F=e.createButtonMenu(P),D=Tt(e.menu,{id:"deleteRule",item:F,subclass:"luckysheet-menuButton-sub"});$("body").first().append(d+g+_+S+I+D),l=$("#"+t).width(190),$("#luckysheet-icon-highlightCellRule-menuButton").width(160),$("#luckysheet-icon-projectSelectRule-menuButton").width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let k=$(this),w=k.attr("itemvalue");if(w=="icons"){if(h.luckysheet_select_save.length==0){at()?alert(o.pleaseSelectRange):ke.info(o.pleaseSelectRange,"");return}Mt.CFiconsDialog(),Mt.init()}else if(w=="newRule"){if(h.luckysheet_select_save.length==0){at()?alert(o.pleaseSelectRange):ke.info(o.pleaseSelectRange,"");return}Mt.newConditionRuleDialog(0),Mt.init()}else if(w=="administerRule"){let C=Ue.loadSheetUrl,T=ur();if(C!=""&&C!=null){let O=[];for(let z=0;z<T.length;z++)O.push(T[z].index);$.post(C,{gridKey:Ue.gridKey,index:O.join(",")},function(z){let A=new Function("return "+z)();setTimeout(function(){h.loadingObj.close()},500);for(let E in A){if(E==h.currentSheetIndex)continue;let L=T[Me(E)];L.celldata=A[E.toString()],L.data=kt.buildGridData(L)}Ys(T),Mt.fileClone=$.extend(!0,[],T),Mt.administerRuleDialog(),Mt.init()})}else Mt.fileClone=$.extend(!0,[],T),Mt.administerRuleDialog(),Mt.init()}}),$(document).off("click.CFhighlightCellRule").on("click.CFhighlightCellRule","#luckysheet-icon-highlightCellRule-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-highlightCellRule-menuButton").hide(),kl();let k=$(this),w=k.attr("itemvalue");if(h.luckysheet_select_save.length==0){at()?alert(o.pleaseSelectRange):ke.info(o.pleaseSelectRange,"");return}else{let C=Mt.textCellColorHtml(),T,O;switch(w){case"greaterThan":T=o.conditionformat_greaterThan,O=`<div class="box" data-itemvalue="greaterThan">
                                                <div class="boxTitleOne">${o.conditionformat_greaterThan_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div> 
                                                ${C} 
                                            </div>`;break;case"lessThan":T=o.conditionformat_lessThan,O=`<div class="box" data-itemvalue="lessThan">
                                                <div class="boxTitleOne">${o.conditionformat_lessThan_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"betweenness":T=o.conditionformat_betweenness,O=`<div class="box" data-itemvalue="betweenness">
                                                <div class="boxTitleOne">${o.conditionformat_betweenness_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div class="inpbox2 range">
                                                        <input id="conditionVal" class="formulaInputFocus"/>
                                                        <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.to}</div>
                                                    <div class="inpbox2 range">
                                                        <input id="conditionVal2" class="formulaInputFocus"/>
                                                        <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                    </div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"equal":T=o.conditionformat_equal,O=`<div class="box" data-itemvalue="equal">
                                                <div class="boxTitleOne">${o.conditionformat_equal_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"textContains":T=o.conditionformat_textContains,O=`<div class="box" data-itemvalue="textContains">
                                                <div class="boxTitleOne">${o.conditionformat_textContains_title}\uFF1A</div>
                                                <div class="inpbox range">
                                                    <input id="conditionVal" class="formulaInputFocus"/>
                                                    <i class="fa fa-table" aria-hidden="true" title="${o.selectCell}"></i>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"occurrenceDate":T=o.conditionformat_occurrenceDate,O=`<div class="box" data-itemvalue="occurrenceDate">
                                                <div class="boxTitleOne">${o.conditionformat_occurrenceDate_title}\uFF1A</div>
                                                <div class="inpbox">
                                                    <input id="daterange-btn" class="formulaInputFocus" readonly="readonly" placeholder="${o.pleaseSelectADate}"/>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"duplicateValue":T=o.conditionformat_duplicateValue,O=`<div class="box" data-itemvalue="duplicateValue">
                                                <div class="boxTitleOne">${o.conditionformat_duplicateValue_title}\uFF1A</div>
                                                <select id="conditionVal" class="selectbox">
                                                    <option value="0">${o.duplicateValue}</option>
                                                    <option value="1">${o.uniqueValue}</option>
                                                </select>
                                                <div style="margin:5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break}Mt.conditionformatDialog(T,O)}}),$(document).off("click.CFprojectSelectRule").on("click.CFprojectSelectRule","#luckysheet-icon-projectSelectRule-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-projectSelectRule-menuButton").hide(),kl();let k=$(this),w=k.attr("itemvalue");if(h.luckysheet_select_save.length==0){at()?alert(o.pleaseSelectRange):ke.info(o.pleaseSelectRange,"");return}else{let C=Mt.textCellColorHtml(),T,O;switch(w){case"top10":T=o.conditionformat_top10,O=`<div class="box" data-itemvalue="top10">
                                                <div class="boxTitleOne">${o.conditionformat_top10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.top}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.oneself}</div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"top10%":T=o.conditionformat_top10_percent,O=`<div class="box" data-itemvalue="top10%">
                                                <div class="boxTitleOne">${o.conditionformat_top10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.top}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"last10":T=o.conditionformat_last10,O=`<div class="box" data-itemvalue="last10">
                                                <div class="boxTitleOne">${o.conditionformat_last10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.last}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.oneself}</div>
                                                </div>
                                                <div style="margin: 5px 0;">${o.setAs}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"last10%":T=o.conditionformat_last10_percent,O=`<div class="box" data-itemvalue="last10%">
                                                <div class="boxTitleOne">${o.conditionformat_last10_title}\uFF1A</div>
                                                <div style="height: 30px;line-height: 30px;">
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">${o.last}</div>
                                                    <div class="inpbox2">
                                                        <input id="conditionVal" class="formulaInputFocus" type="number" value="10"/>
                                                    </div>
                                                    <div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div>
                                                </div>
                                                <div style="margin:5px 0;">\u8BBE\u7F6E\u4E3A\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"AboveAverage":T=o.conditionformat_AboveAverage,O=`<div class="box" data-itemvalue="AboveAverage">
                                                <div class="boxTitleOne">${o.conditionformat_AboveAverage_title}\uFF1A</div>
                                                <div style="margin: 5px 0;">${o.setAsByArea}\uFF1A</div>
                                                ${C}
                                            </div>`;break;case"SubAverage":T=o.conditionformat_SubAverage,O=`<div class="box" data-itemvalue="SubAverage">
                                                <div class="boxTitleOne">${o.conditionformat_SubAverage_title}\uFF1A</div>
                                                <div style="margin: 5px 0;">${o.setAsByArea}\uFF1A</div>
                                                ${C}
                                            </div>`;break}Mt.conditionformatDialog(T,O)}}),$(document).off("click.CFdataBar").on("click.CFdataBar","#luckysheet-icon-dataBar-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-dataBar-menuButton").hide(),kl();let k=$(this),w=k.attr("itemvalue");if(h.luckysheet_select_save.length>0){let C=$.extend(!0,[],h.luckysheet_select_save),T=Mt.dataBarList[w].format;Mt.updateItem("dataBar",C,T)}}),$(document).off("click.CFcolorGradation").on("click.CFcolorGradation","#luckysheet-icon-colorGradation-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-colorGradation-menuButton").hide(),kl();let k=$(this),w=k.attr("itemvalue");if(h.luckysheet_select_save.length>0){let C=$.extend(!0,[],h.luckysheet_select_save),T=Mt.colorGradationList[w].format;Mt.updateItem("colorGradation",C,T)}}),$(document).off("click.CFdeleteRule").on("click.CFdeleteRule","#luckysheet-icon-deleteRule-menuButton .luckysheet-cols-menuitem",function(){l.hide(),$("#luckysheet-icon-deleteRule-menuButton").hide(),kl(),$(this).attr("itemvalue")=="delSheet"&&Mt.updateItem("delSheet")})}let a=$(this).outerWidth(),s=l.outerWidth(),u=$(this).offset().left;s>a&&s+u>$("#"+h.container).width()&&(u=u-s+a),bn(l,u,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-postil").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),o=Be().comment;l.remove(),Zt.removeActivePs();let a=h.luckysheet_select_save[h.luckysheet_select_save.length-1],s=a.row_focus;s==null&&(s=a.row[0]);let u=a.column_focus;u==null&&(u=a.column[0]);let f;h.flowdata[s][u]!=null&&h.flowdata[s][u].ps!=null?f=[{text:o.edit,value:"editPs",example:""},{text:o.delete,value:"delPs",example:""},{text:"",value:"split",example:""},{text:o.showOne,value:"showHidePs",example:""},{text:o.showAll,value:"showHideAllPs",example:""}]:f=[{text:o.insert,value:"newPs",example:""},{text:"",value:"split",example:""},{text:o.showAll,value:"showHideAllPs",example:""}];let m=e.createButtonMenu(f),d=Tt(e.menu,{id:"postil",item:m,subclass:"",sub:""});$("body").first().append(d),l=$("#"+t).width(150),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let v=$(this),x=v.attr("itemvalue");x=="newPs"?Zt.newPs(s,u):x=="editPs"?Zt.editPs(s,u):x=="delPs"?Zt.delPs(s,u):x=="showHidePs"?Zt.showHidePs(s,u):x=="showHideAllPs"&&Zt.showHideAllPs()});let p=$(this).outerWidth(),b=l.outerWidth(),g=$(this).offset().left;b>p&&b+g>$("#"+h.container).width()&&(g=g-b+p),bn(l,g,$(this).offset().top+25,"lefttop")}),$("#luckysheet-icon-protection").click(function(){let t=kt.getSheetByIndex();Yy(t)}),$("#luckysheet-icon-print").click(function(){let t=$(this).attr("id")+"-menuButton",l=$("#"+t),a=Be().print;if(l.length==0){let m=[{text:a.menuItemPrint,value:"print",example:'<i class="iconfont luckysheet-iconfont-dayin" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:a.menuItemAreas,value:"areas",example:'<i class="iconfont luckysheet-iconfont-tihuan" aria-hidden="true"></i>'},{text:a.menuItemRows,value:"rows",example:'<i class="iconfont luckysheet-iconfont-zhuandao1" aria-hidden="true"></i>'},{text:a.menuItemColumns,value:"columns",example:'<i class="iconfont luckysheet-iconfont-dingwei" aria-hidden="true"></i>'}],d=e.createButtonMenu(m),p=Tt(e.menu,{id:"print",item:d,subclass:"",sub:""});$("body").first().append(p),l=$("#"+t).width(180),l.find(".luckysheet-cols-menuitem").click(function(){l.hide(),kl();let b=$(this),g=b.attr("itemvalue");g=="print"?alert("print"):(g=="areas"||g=="rows"||g=="columns")&&alert("areas")})}let s=$(this).outerWidth(),u=l.outerWidth(),f=$(this).offset().left;u>s&&u+f>$("#"+h.container).width()&&(f=f-u+s),bn(l,f,$(this).offset().top+25,"lefttop")}),$("body").first().on("mouseover mouseleave",".luckysheet-menuButton .luckysheet-cols-submenu",function(t){let l=$(this),o=l.attr("itemvalue"),a=$("#luckysheet-icon-"+o+"-menuButton");if(t.type==="mouseover"){let s=l.parent(),u=$(window).width(),f=$(window).height(),m=s.width(),d=a.height()+25,p=a.width()+5,b=l.offset(),g=b.top,v=b.left+m;v+p>u&&(v=b.left-p),g+d>f&&(g=f-d),a.css({top:g,left:v}).show(),e.rightclickmenu=l}else clearTimeout(e.submenuhide[a.attr("id")]),e.submenuhide[a.attr("id")]=setTimeout(function(){a.hide()},200)}).on("mouseover mouseleave",".luckysheet-menuButton-sub",function(t){t.type==="mouseover"?(e.rightclickmenu.addClass("luckysheet-cols-menuitem-hover"),clearTimeout(e.submenuhide[$(this).attr("id")])):(e.rightclickmenu.removeClass("luckysheet-cols-menuitem-hover"),$(this).hide())})},getQKBorder:function(e,n,t){let l="";e.indexOf("pt")>-1?(e=parseFloat(e),e<1||(e<1.5?l="Medium":l="Thick")):(e=parseFloat(e),e<2||(e<3?l="Medium":l="Thick"));let o=0;return n=n.toLowerCase(),n=="double"?o=2:n=="dotted"?l=="Medium"||l=="Thick"?o=3:o=10:n=="dashed"?l=="Medium"||l=="Thick"?o=4:o=9:n=="solid"&&(l=="Medium"?o=8:l=="Thick"?o=13:o=1),[o,t]},updateFormatCell:function(e,n,t,l,o,a,s){if(!(e==null||n==null))if(n=="ct"){for(let u=l;u<=o;u++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[u]!=null))for(let f=a;f<=s;f++){let m=e[u][f],d=null;G(m)=="object"?d=e[u][f].v:d=e[u][f],t!="@"&&K(d)&&(d=parseFloat(d));let p=Bl(t,d),b="n";Oy(t)||t===14||t===15||t===16||t===17||t===18||t===19||t===20||t===21||t===22||t===45||t===46||t===47?b="d":t=="@"||t===49?b="s":(t=="General"||t===0)&&(b=K(d)?"n":"g"),G(m)=="object"?(e[u][f].m=p,e[u][f].ct==null&&(e[u][f].ct={}),e[u][f].ct.fa=t,e[u][f].ct.t=b):e[u][f]={ct:{fa:t,t:b},v:d,m:p}}}else{n=="ht"?t=="left"?t="1":t=="center"?t="0":t=="right"&&(t="2"):n=="vt"?t=="top"?t="1":t=="middle"?t="0":t=="bottom"&&(t="2"):n=="tb"?t=="overflow"?t="1":t=="clip"?t="0":t=="wrap"&&(t="2"):n=="tr"&&(t=="none"?t="0":t=="angleup"?t="1":t=="angledown"?t="2":t=="vertical"?t="3":t=="rotation-up"?t="4":t=="rotation-down"&&(t="5"));for(let u=l;u<=o;u++)if(!(h.config.rowhidden!=null&&h.config.rowhidden[u]!=null))for(let f=a;f<=s;f++){let m=e[u][f];G(m)=="object"?(Cy(m,n,t),e[u][f][n]=t):(e[u][f]={v:m},e[u][f][n]=t)}}},updateFormat:function(e,n,t){let l=this;if(!zo(h.currentSheetIndex))return;if(!yi()){ke.info("",Be().pivotTable.errorNotAllowEdit);return}let a=document.createElement("canvas").getContext("2d");if(n in by&&parseInt($("#luckysheet-input-box").css("top"))>0&&$("#luckysheet-input-box").text().substr(0,1)!="="){let m=e[h.luckysheetCellUpdate[0]][h.luckysheetCellUpdate[1]];xy(m,n,t,y.rangeResizeTo)}let s=$.extend(!0,{},h.config);s.rowlen==null&&(s.rowlen={});for(let f=0;f<h.luckysheet_select_save.length;f++){let m=h.luckysheet_select_save[f].row[0],d=h.luckysheet_select_save[f].row[1],p=h.luckysheet_select_save[f].column[0],b=h.luckysheet_select_save[f].column[1];this.updateFormatCell(e,n,t,m,d,p,b),(n=="tb"||n=="tr"||n=="fs")&&(s=Cn(e,m,d,s))}let u={};(n=="tb"||n=="tr"||n=="fs")&&(u={cfg:s,RowlChange:!0}),al(e,h.luckysheet_select_save,u,!1)},updateFormat_mc:function(e,n){if(!yi()){ke.info("",Be().pivotTable.errorNotAllowEdit);return}let t=$.extend(!0,{},h.config);if(t.merge==null&&(t.merge={}),!!ea(h.currentSheetIndex)){if(n=="mergeCancel")for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l],a=o.row[0],s=o.row[1],u=o.column[0],f=o.column[1];if(a==s&&u==f)continue;let m={};for(let d=a;d<=s;d++)for(let p=u;p<=f;p++){let b=e[d][p];if(b!=null&&b.mc!=null){let g=b.mc.r,v=b.mc.c;if("rs"in b.mc)delete b.mc,delete t.merge[g+"_"+v],m[g+"_"+v]=$.extend(!0,{},b);else{let x=JSON.parse(JSON.stringify(m[g+"_"+v]));delete x.v,delete x.m,delete x.ct,delete x.f,delete x.spl,e[d][p]=x}}}}else{let l=!1;for(let o=0;o<h.luckysheet_select_save.length;o++){let a=h.luckysheet_select_save[o],s=a.row[0],u=a.row[1],f=a.column[0],m=a.column[1];for(let d=s;d<=u;d++)for(let p=f;p<=m;p++){let b=e[d][p];if(G(b)=="object"&&"mc"in b){l=!0;break}}}if(l)for(let o=0;o<h.luckysheet_select_save.length;o++){let a=h.luckysheet_select_save[o],s=a.row[0],u=a.row[1],f=a.column[0],m=a.column[1];if(s==u&&f==m)continue;let d={};for(let p=s;p<=u;p++)for(let b=f;b<=m;b++){let g=e[p][b];if(g!=null&&g.mc!=null){let v=g.mc.r,x=g.mc.c;if("rs"in g.mc)delete g.mc,delete t.merge[v+"_"+x],d[v+"_"+x]=$.extend(!0,{},g);else{let _=JSON.parse(JSON.stringify(d[v+"_"+x]));delete _.v,delete _.m,delete _.ct,delete _.f,delete _.spl,e[p][b]=_}}}}else for(let o=0;o<h.luckysheet_select_save.length;o++){let a=h.luckysheet_select_save[o],s=a.row[0],u=a.row[1],f=a.column[0],m=a.column[1];if(!(s==u&&f==m)){if(n=="mergeAll"){let d={},p=!1;for(let b=s;b<=u;b++)for(let g=f;g<=m;g++){let v=e[b][g];v!=null&&(Yc(v.ct)||!ft(v.v)||v.f!=null)&&!p&&(d=$.extend(!0,{},v),p=!0),e[b][g]={mc:{r:s,c:f}}}e[s][f]=d,e[s][f].mc={r:s,c:f,rs:u-s+1,cs:m-f+1},t.merge[s+"_"+f]={r:s,c:f,rs:u-s+1,cs:m-f+1}}else if(n=="mergeV")for(let d=f;d<=m;d++){let p={},b=!1;for(let g=s;g<=u;g++){let v=e[g][d];v!=null&&(!ft(v.v)||v.f!=null)&&!b&&(p=$.extend(!0,{},v),b=!0),e[g][d]={mc:{r:s,c:d}}}e[s][d]=p,e[s][d].mc={r:s,c:d,rs:u-s+1,cs:1},t.merge[s+"_"+d]={r:s,c:d,rs:u-s+1,cs:1}}else if(n=="mergeH")for(let d=s;d<=u;d++){let p={},b=!1;for(let g=f;g<=m;g++){let v=e[d][g];v!=null&&(!ft(v.v)||v.f!=null)&&!b&&(p=$.extend(!0,{},v),b=!0),e[d][g]={mc:{r:d,c:f}}}e[d][f]=p,e[d][f].mc={r:d,c:f,rs:1,cs:m-f+1},t.merge[d+"_"+f]={r:d,c:f,rs:1,cs:m-f+1}}}}}h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"mergeChange",sheetIndex:h.currentSheetIndex,data:h.flowdata,curData:e,range:$.extend(!0,[],h.luckysheet_select_save),config:$.extend(!0,{},h.config),curConfig:t})),h.clearjfundo=!1,al(e,h.luckysheet_select_save,{cfg:t}),h.clearjfundo=!0}},borderfix:function(e,n,t){let l=e[n][t],o=null;return l==null?[-1,0,0,-1]:e[n][t].bg==null||e[n][t].bg==""?[-1,0,0,-1]:[-2,-1,1,0]},changeMenuButtonDom:function(e,n,t){let l=this;t==null&&(t=Be());let o=t.fontarray,a=t.fontjson;if(e=="bl")n!="0"?$("#luckysheet-icon-bold").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-bold").removeClass("luckysheet-toolbar-button-hover");else if(e=="it")n!="0"?$("#luckysheet-icon-italic").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-italic").removeClass("luckysheet-toolbar-button-hover");else if(e=="cl")n!="0"?$("#luckysheet-icon-strikethrough").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-strikethrough").removeClass("luckysheet-toolbar-button-hover");else if(e=="un")n!="0"?$("#luckysheet-icon-underline").addClass("luckysheet-toolbar-button-hover"):$("#luckysheet-icon-underline").removeClass("luckysheet-toolbar-button-hover");else if(e=="ff"){let s="luckysheet-icon-font-family-menuButton",u=$("#"+s),f=o[0],m=0;n!=null&&(Cs(n).num?(m=parseInt(n),f=o[m],f==null&&(m=l.defualtFont[m],f=m,m!=null&&l.addFontTolist(m))):(n=n.replace(/"/g,"").replace(/'/g,""),m=n,f=n,l.addFontTolist(m))),l.focus(u,m),$("#luckysheet-icon-font-family").find(".luckysheet-toolbar-menu-button-caption").html(" "+f+" ")}else if(e=="fs"){let s=$("#luckysheet-icon-font-size-menuButton"),u=n,f=$("#luckysheet-icon-font-size input");l.focus(s,u),$("#luckysheet-icon-font-size").attr("itemvalue",u),f.val(u)}else if(e=="ht"){let s=$("#luckysheet-icon-align-menu-menuButton"),u=$("luckysheet-icon-align"),f="left";n=="0"?f="center":n=="2"&&(f="right"),l.focus(s,f);let m=ga.align;$("#luckysheet-icon-align").attr("type",f).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-align-"+f+m[f]),s.hide()}else if(e=="vt"){let s=$("#luckysheet-icon-valign-menu-menuButton"),u=$("luckysheet-icon-valign"),f="bottom";n=="1"?f="top":n=="0"&&(f="middle"),l.focus(s,f);let m=ga.align;$("#luckysheet-icon-valign").attr("type",f).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-valign-"+f+m[f]),s.hide()}else if(e=="tb"){let s=$("#luckysheet-icon-textwrap-menu-menuButton"),u=$("luckysheet-icon-textwrap"),f="clip";n=="1"?f="overflow":n=="2"&&(f="wrap"),l.focus(s,f);let m=ga.textWrap;$("#luckysheet-icon-textwrap").attr("type",f).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-textwrap-"+f+m[f]),s.hide()}else if(e=="tr"){let s=$("#luckysheet-icon-rotation-menu-menuButton"),u=$("luckysheet-icon-rotation"),f="none";n=="1"?f="angleup":n=="2"?f="angledown":n=="3"?f="vertical":n=="4"?f="rotation-up":n=="5"&&(f="rotation-down"),l.focus(s,f);let m=ga.rotation;$("#luckysheet-icon-rotation").attr("type",f).find(".luckysheet-icon-img-container").removeAttr("class").addClass("luckysheet-icon-img-container luckysheet-icon-img luckysheet-icon-rotation-"+f+m[f]),s.hide()}else if(e=="ct"){let s=$("#luckysheet-icon-fmt-other"),f=Be().defaultFmt;if(!n){s.find(".luckysheet-toolbar-menu-button-caption").html(" "+f[0].text+" ");return}let{fa:m}=n,d=f.find(p=>p.value===m);if(d)s.find(".luckysheet-toolbar-menu-button-caption").html(" "+d.text+" ");else{let p=f.find(b=>b.value==="fmtOtherSelf");s.find(".luckysheet-toolbar-menu-button-caption").html(" "+p.text+" ")}}},inputMenuButtonFocus:function(e){var n=window.getSelection(),t=n.getRangeAt(0);let l=t.startContainer;h.inlineStringEditRange=null;let o=Be();if(l.parentNode.tagName=="SPAN"){let a=l.parentNode.style.cssText,s=Tm(a);for(let u in s)this.changeMenuButtonDom(u,s[u],o)}},menuButtonFocus:function(e,n,t){let l=this,o=["bl","it","cl","ff","ht","vt","fs","tb","tr","ct","un"],a=Be();for(let s=0;s<o.length;s++){let u=o[s],f=l.checkstatus(e,n,t,u);this.changeMenuButtonDom(u,f,a)}},checkstatus:function(e,n,t,l){if(e==null||e[n]==null)return console.warn("It's incorrect data",n,t),null;let o=e[n][t];return Fo(o,l)},setLineDash:function(e,n,t,l,o,a,s){n={"0":"none","1":"Thin","2":"Hair","3":"Dotted","4":"Dashed","5":"DashDot","6":"DashDotDot","7":"Double","8":"Medium","9":"MediumDashed","10":"MediumDashDot","11":"MediumDashDotDot","12":"SlantedDashDot","13":"Thick"}[n.toString()];try{n=="Hair"?e.setLineDash([1,2]):n.indexOf("DashDotDot")>-1?e.setLineDash([2,2,5,2,2]):n.indexOf("DashDot")>-1?e.setLineDash([2,5,2]):n.indexOf("Dotted")>-1?e.setLineDash([2]):n.indexOf("Dashed")>-1?e.setLineDash([3]):e.setLineDash([0])}catch(f){console.log(f)}e.beginPath(),n.indexOf("Medium")>-1?(t=="h"?(e.moveTo(l,o-.5),e.lineTo(a,s-.5)):(e.moveTo(l-.5,o),e.lineTo(a-.5,s)),e.lineWidth=2):n=="Thick"?(e.moveTo(l,o),e.lineTo(a,s),e.lineWidth=3):(e.moveTo(l,o),e.lineTo(a,s),e.lineWidth=1)},moveMergeData:function(e,n,t){if(ft(e))return e;let l=[],o=[],a=!1;for(let s=0;s<e.length;s++)for(let u=0;u<e[0].length;u++){let f=e[s][u];G(f)=="object"&&"mc"in f&&(f.mc.rs!=null&&(l.push({rs:f.mc.rs,cs:f.mc.cs,r:f.mc.r,c:f.mc.c}),o.push({rs:f.mc.rs,cs:f.mc.cs,r:f.mc.r+n,c:f.mc.c+t}),a=!0),e[s][u].mc.r+=n,e[s][u].mc.c+=t)}return{deleMC:l,insertMC:o,hasMC:a}},getRangeInMerge:function(e,n,t,l,o){let a=this,s=[],u=null;if(o!=null?u=$.extend(!0,{},a.getSheetConfig()):u=$.extend(!0,{},h.config),u!=null&&u.merge!=null)for(let f in u.merge){let m=u.merge[f];!(e+n-1<m.r||e>m.r+m.rs-1)&&!(t+l-1<m.c||t>m.c+m.cs-1)&&s.push(m)}return s},mergeborer:function(e,n,t){if(e==null||e[n]==null)return console.warn("Merge info is null",n,t),null;let l=e[n][t];if(G(l)=="object"&&"mc"in l){let o=l.mc;if(o==null)return console.warn("Merge info is null",n,t),null;if(t=o.c,n=o.r,e[n][t]==null)return console.warn("Main merge Cell info is null",n,t),null;let a=e[n][t].mc.cs,s=e[n][t].mc.rs,u=e[n][t].mc,f,m,d,p;for(let _=n;_<u.rs+n;_++)_==0?f=-1:f=h.visibledatarow[_-1]-1,m=h.visibledatarow[_],p==null?(p=f,d=m):d+=m-f-1;let b,g,v,x;for(let _=t;_<u.cs+t;_++)_==0?b=0:b=h.visibledatacolumn[_-1],g=h.visibledatacolumn[_],x==null?(x=b,v=g):v+=g-b;return{row:[p,d,n,n+s-1],column:[x,v,t,t+a-1]}}else return null},mergeMoveData:{},mergeMoveMain:function(e,n,t,l,o,a,s){let u=this,f=kt.getSheetMerge();if(f==null)return;let m=[];for(let p in f)m.push(p);n[0]>n[1]&&(n[1]=n[0]),e[0]>e[1]&&(e[1]=e[0]);let d=!0;for(u.mergeMoveData={};d;){d=!1;for(let p=0;p<m.length;p++){let b=m[p],g=f[b];if(b in u.mergeMoveData)continue;let v=u.mergeMove(g,e,n,t,l,o,a,s);v!=null?(u.mergeMoveData[b]=g,e=v[0],n=v[1],l=v[2],o=v[3],a=v[4],s=v[5],d=!0):delete u.mergeMoveData[b]}}return[e,n,l,o,a,s]},mergeMove:function(e,n,t,l,o,a,s,u){let f=this,m=e.r,d=e.r+e.rs-1,p=e.c,b=e.c+e.cs-1,g=!1;if(n[1]<n[0]&&(n[0]=n[1]),t[1]<t[0]&&(t[0]=t[1]),n[0]<=p&&n[1]>=b&&t[0]<=m&&t[1]>=d||!(n[1]<p||n[0]>b)&&!(t[1]<m||t[0]>d)){let v=f.mergeborer(h.flowdata,e.r,e.c);if(v){let x=v.row[1],_=v.row[0],S=v.row[2],I=v.column[1],P=v.column[0],F=v.column[2];n[1]<p||n[0]>b||(t[0]<=d&&t[0]>=m&&(a+=o-_,o=_,t[0]=m),t[1]>=m&&t[1]<=d&&(l.row_focus>=m&&l.row_focus<=d,a=x-o,t[1]=d)),t[1]<m||t[0]>d||(n[0]<=b&&n[0]>=p&&(u+=s-P,s=P,n[0]=p),n[1]>=p&&n[1]<=b&&(l.column_focus>=p&&l.column_focus<=b,u=I-s,n[1]=b)),g=!0}}return g?[n,t,o,a,s,u]:null},getCellRealSize:function(e,n,t){let l=this,o=h.defaultcollen,a=h.defaultrowlen,s=e[n][t];if(!!s&&s.mc!=null){let u=s.mc,f=l.mergeborer(e,u.r,u.c);if(f){let m=f.row[1],d=f.row[0],p=f.row[2],b=f.row[3],g=f.column[1],v=f.column[0],x=f.column[2],_=f.column[3];o=g-v-1,a=m-d-1}}else{let u=ur()[Me(h.currentSheetIndex)].config;u.columnlen!=null&&u.columnlen[t]!=null&&(o=u.columnlen[t]),u.rowlen!=null&&u.rowlen[n]!=null&&(a=u.rowlen[n])}return[o,a]},getTextHeightCache:{},getTextSize:function(e,n){let t=Be().fontarray,l=n||"10pt "+t[0],o=this;if(l in o.getTextHeightCache)return o.getTextHeightCache[l];$("#luckysheetTextSizeTest").length==0&&$('<span id="luckysheetTextSizeTest" style="float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;">'+e+"</span>").appendTo($("body"));let a=$("#luckysheetTextSizeTest").text(e).css({font:l}),s=a.innerWidth(),u=a.innerHeight();return o.getTextHeightCache[l]=[s,u],[s,u]},activeFormulaInput:function(e,n,t,l,o,a){let s=this;if(a==null&&(a=!1),ti(e,n,h.flowdata,!0),a){let b='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+o.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(b);let g=window.getSelection(),v=$("#luckysheet-rich-text-editor").find("span");y.setCaretPosition(v.get(v.length-2),0,1);return}let u=Zr(t[0])[0],f=Zr(t[1])[1],m=or(l[0])[0],d=or(l[1])[1],p='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'+o.toUpperCase()+'</span><span dir="auto" class="luckysheet-formula-text-color">(</span><span class="luckysheet-formula-functionrange-cell" rangeindex="0" dir="auto" style="color:'+Pi[0]+';">'+Kl(h.currentSheetIndex,{row:t,column:l},h.currentSheetIndex)+'</span><span dir="auto" class="luckysheet-formula-text-color">)</span>';$("#luckysheet-rich-text-editor").html(p),y.israngeseleciton(),y.rangestart=!0,y.rangedrag_column_start=!1,y.rangedrag_row_start=!1,y.rangechangeindex=0,y.rangeSetValue({row:t,column:l}),y.func_selectedrange={left:m,width:d-m-1,top:u,height:f-u-1,left_move:m,width_move:d-m-1,top_move:u,height_move:f-u-1,row:[e,e],column:[n,n]},$("#luckysheet-formula-functionrange-select").css({left:m,width:d-m-1,top:u,height:f-u-1}).show(),$("#luckysheet-formula-help-c").hide()},backFormulaInput:function(e,n,t,l,o,a){let s=this,u="="+a.toUpperCase()+"("+Kl(h.currentSheetIndex,{row:l,column:o},h.currentSheetIndex)+")",f=y.execfunction(u,n,t),m={v:f[1],f:f[2]};kr(n,t,e,m),y.execFunctionExist.push({r:n,c:t,i:h.currentSheetIndex}),Ue.historyParam(e,h.currentSheetIndex,{row:[n,n],column:[t,t]})},checkNoNullValue:function(e){let n=e;return G(n)=="object"&&(n=n.v),!!(!ft(n)&&Cs(n).num&&(e.ct==null||e.ct.t==null||e.ct.t=="n"||e.ct.t=="g"))},checkNoNullValueAll:function(e){let n=e;return G(n)=="object"&&(n=n.v),!ft(n)},getNoNullValue:function(e,n,t,l){let o=this,a=0,s=null,u=0,f=0;for(let m=t-1;m>=0;m--){let d;if(l=="c"?d=e[n][m]:d=e[m][n],o.checkNoNullValue(d))a++,s=m;else if(d==null||d.v==null||d.v==""){if(u++,u>=40)if(f<=0)f=1;else break}else break}return s},singleFormulaInput:function(e,n,t,l,o,a,s,u,f){let m=this;s==null&&(s="r"),u==null&&(u=!0),f==null&&(f=!0);let d=!0,p=!1;for(let b=l;b<=o;b++){let g=null;s=="c"?g=e[b][t]:g=e[t][b],m.checkNoNullValue(g)?(d=!1,p=!0):m.checkNoNullValueAll(g)&&(d=!1)}if(d&&f)if(m.getNoNullValue(e,n,t,s)==null)s=="c"?m.activeFormulaInput(n,t,null,null,a,!0):m.activeFormulaInput(t,n,null,null,a,!0);else if(n==l)for(let g=l;g<=o;g++){let v=m.getNoNullValue(e,g,t,s);if(v==null)break;s=="c"?m.backFormulaInput(e,g,t,[g,g],[v,t-1],a):m.backFormulaInput(e,t,g,[v,t-1],[g,g],a)}else for(let g=o;g>=l;g--){let v=m.getNoNullValue(e,g,t,s);if(v==null)break;s=="c"?m.backFormulaInput(e,g,t,[g,g],[v,t-1],a):m.backFormulaInput(e,t,g,[v,t-1],[g,g],a)}else if(p&&u){let b=null;if(s=="c"?b=e[o+1][t]:b=e[t][o+1],b!=null&&b.v!=null&&b.v.toString().length>0){let g=o+1;for(s=="c"?b=e[o+1][t]:b=e[t][o+1];b!=null&&b.v!=null&&b.v.toString().length>0;){g++;let v=null;if(s=="c"?v=e.length:v=e[0].length,g>=v)return;s=="c"?b=e[g][t]:b=e[t][g]}s=="c"?m.backFormulaInput(e,g,t,[l,o],[t,t],a):m.backFormulaInput(e,t,g,[t,t],[l,o],a)}else s=="c"?m.backFormulaInput(e,o+1,t,[l,o],[t,t],a):m.backFormulaInput(e,t,o+1,[t,t],[l,o],a)}else return!0},autoSelectionFormula:function(e){let n=this,t=It.deepCopyFlowData(h.flowdata),l=40,o=!0;y.execFunctionExist=[];let a=function(u,f,m,d,p,b){let g=n.getNoNullValue(u,f,p,"c");g==null?n.activeFormulaInput(f,d,null,null,b,!0):n.activeFormulaInput(f,d,[f,m],[g,p-1],b)},s=function(u,f,m,d,p,b){let g=n.getNoNullValue(u,d,m,"r");g==null?a(u,f,m,d,p,b):n.activeFormulaInput(f,d,[g,m-1],[d,p],b)};for(let u=0;u<h.luckysheet_select_save.length;u++){let f=h.luckysheet_select_save[u].row[0],m=h.luckysheet_select_save[u].row[1],d=h.luckysheet_select_save[u].column[0],p=h.luckysheet_select_save[u].column[1],b=h.luckysheet_select_save[u].row_focus,g=h.luckysheet_select_save[u].column_focus;if(f==m&&d==p){if(m-1<0&&p-1<0){n.activeFormulaInput(f,d,null,null,e,!0);return}m-1>=0&&n.checkNoNullValue(t[m-1][d])?s(t,f,m,d,p,e):p-1>=0&&n.checkNoNullValue(t[f][p-1])?a(t,f,m,d,p,e):s(t,f,m,d,p,e)}else if(f==m)o=n.singleFormulaInput(t,g,f,d,p,e,"r");else if(d==p)o=n.singleFormulaInput(t,b,d,f,m,e,"c");else{let v=!0;for(let _=f;_<=m;_++)v=n.singleFormulaInput(t,g,_,d,p,e,"r",!0,!1)&&v;let x=!0;for(let _=d;_<=p;_++)x=n.singleFormulaInput(t,b,_,f,m,e,"c",!0,!1)&&x;o=!!v&&!!x}o=o&&o}o||(y.execFunctionExist.reverse(),y.execFunctionGroup(null,null,null,null,t),al(t,h.luckysheet_select_save),clearTimeout(h.jfcountfuncTimeout),h.jfcountfuncTimeout=setTimeout(function(){Nn()},500))},getStyleByCell:function(e,n,t){let l=this,o="",a=Ur.getComputeMap(),s=Ur.checksAF(n,t,a),u=Mt.getComputeMap(),f=Mt.checksCF(n,t,u),m=Be().fontarray,d=e[n][t],p=d.ct,b=!1;Wn(d)&&(b=!0);for(let g in d){let v=l.checkstatus(e,n,t,g);(s!=null||f!=null&&f.cellColor!=null)&&(f!=null&&f.cellColor!=null?o+="background: "+f.cellColor+";":s!=null&&(o+="background: "+s[1]+";")),G(v)!="object"&&((g=="bg"||s!=null||f!=null&&f.cellColor!=null)&&(f!=null&&f.cellColor!=null?o+="background: "+f.cellColor+";":s!=null?o+="background: "+s[1]+";":o+="background: "+v+";"),g=="ht"&&v!="1"&&(v=="0"?o+="text-align: center;":v=="2"&&(o+="text-align: right;")),g=="vt"&&(v=="0"?o+="vertical-align: middle;":v=="1"?o+="vertical-align: top;":v=="2"&&(o+="vertical-align: bottom;")),g=="un"&&v&&(o+="text-decoration:underline;"))}return b||(o+=Qu(d,s,f)),o},fontSelectList:[],defualtFont:["Times New Roman","Arial","Tahoma","Verdana","\u5FAE\u8F6F\u96C5\u9ED1","\u5B8B\u4F53","\u9ED1\u4F53","\u6977\u4F53","\u4EFF\u5B8B","\u65B0\u5B8B\u4F53","\u534E\u6587\u65B0\u9B4F","\u534E\u6587\u884C\u6977","\u534E\u6587\u96B6\u4E66"],addFontTolist:function(e){e=e.replace(/"/g,"").replace(/'/g,"");let n=!0;for(let o=0;o<this.fontSelectList.length;o++)if(this.fontSelectList[o].value==e){n=!1;break}let l=Be().fontjson;if(e in l&&(n=!1),n){let o={};o.value=e,o.index=this.fontSelectList.length,o.type="userDefined",o.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+e+"'>"+e+"</span>",o.example="",this.fontSelectList.push(o);let a=$("#luckysheet-icon-font-family-menuButton"),s=this.createButtonMenu(this.fontSelectList);a.html(s)}},fontInitial:function(e){let n=[],t=Be().fontarray;for(let l=0;l<t.length;l++){let o=t[l],a={};a.value=o,a.index=l,a.type="inner",a.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+o+"'>"+o+"</span>",a.example="",n.push(a)}if(e!=null){for(let l=0;l<e.length;l++){let o=e[l],a={};if(a.value=o.fontName,a.index=l,a.type="userDefined",a.text="<span class='luckysheet-mousedown-cancel' style='font-size:11px;font-family:"+o.fontName+"'>"+o.fontName+"</span>",a.example="",n.push(a),document.fonts&&!document.fonts.check("12px "+o.fontName)&&o.url){let s=new FontFace(o.fontName,`url(${o.url})`);document.fonts.add(s),s.load()}}document.fonts&&document.fonts.ready.then(function(){})}this.fontSelectList=n}},_t=u_});function Ng(e,n){let t={};for(let l in e)t[l]=e[l];for(let l in n)n[l]!=null&&(t[l]=n[l]);return t}function Tt(e,n){return e.replace(/\$\{([\w]+)\}/g,function(t,l){let o=n[l];return typeof o!="undefined"?o:t})}function G(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]}function Xh(e){let n=new Date,t=n.getFullYear(),l=n.getMonth(),o=n.getDate(),a=n.getDay(),s=n.getHours(),u=n.getMinutes(),f=n.getSeconds();l=l+1,l<10&&(l="0"+l),o<10&&(o="0"+o),s<10&&(s="0"+s),u<10&&(u="0"+u),f<10&&(f="0"+f);let m="";return e==1?m=t+"-"+l+"-"+o:e==2&&(m=t+"-"+l+"-"+o+" "+s+":"+u+":"+f),m}function _s(e){let n;e.indexOf("rgba")>-1?n=e.replace("rgba(","").replace(")","").split(","):n=e.replace("rgb(","").replace(")","").split(",");let t=parseInt(n[0]),l=parseInt(n[1]),o=parseInt(n[2]);return"#"+((1<<24)+(t<<16)+(l<<8)+o).toString(16).slice(1)}function fn(e){if(e==null||e.length==0)return NaN;for(var n=e.toLowerCase().split(""),t=0,l=n.length,o=function(f){return f.charCodeAt()-96},a=0,s=0,u=0;u<l;u++)s=o(n[u]),a+=s*Math.pow(26,l-u-1);return a==0?NaN:a-1}function yl(e){for(var n="a".charCodeAt(0),t="z".charCodeAt(0),l=t-n+1,o="";e>=0;)o=String.fromCharCode(e%l+n)+o,e=Math.floor(e/l)-1;return o.toUpperCase()}function dc(e,n){if(n===0)return"";if(e==null)return 0;let t=0;for(let l=0;l<e.length;l++)if(e.charAt(l).match(/[^\x00-\xff]/ig)!=null?t+=2:t+=1,K(n)&&t===~~n)return e.substring(0,l);return t}function Lg(e){let n=[],t={};if(e.length>0)for(let l=0;l<e.length;l++){let o=e[l];t[o]||(n.push(o),t[o]=1)}return n}function rc(e){let n=Be().fontarray;if(G(e)=="object"){let t="";if(e.it=="0"||e.it==null?t+="normal ":t+="italic ",t+="normal ",e.bl=="0"||e.bl==null?t+="normal ":t+="bold ",e.fs?t+=Math.ceil(e.fs)+"pt ":t+=h.defaultFontSize+"pt ",!e.ff)t+=n[0]+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif';else{let l=null,o=Be().fontjson;Cs(e.ff).num?l=n[parseInt(e.ff)]:(l=e.ff,l=l.replace(/"/g,"").replace(/'/g,""),l.indexOf(" ")>-1&&(l='"'+l+'"'),l!=null&&document.fonts&&!document.fonts.check("12px "+l)&&_t.addFontTolist(l)),l==null&&(l=n[0]),t+=l+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif'}return t}else return Gs()}function Ca(e,n,t){let l=$(window).height(),o=$(window).width(),a=e.width(),s=e.height(),u=t,f=n;n+a>o&&(f=n-a),t+s>l&&(u=t-s),u<0&&(u=0),e.css({top:u,left:f}).show()}function Eo(){h.fullscreenmode&&setTimeout(function(){document.getElementById("luckysheet-rich-text-editor").focus({preventScroll:!0}),$("#luckysheet-rich-text-editor").select()},50)}function kl(){document.getElementById(h.container).focus({preventScroll:!0})}function Qn(e,n){if(e==null||isNaN(parseFloat(e))||ds(e)||e==-Infinity||e==Infinity)return null;let t=6,l=!1;n==null||n=="auto"?e<1?t=6:t=1:Yi(n)=="num"?(t=parseInt(n),l=!0):t=6;let o="",a=null;for(let s=0;s<t;s++)o+="0";return l||(o="["+o+"]"),e>=1e21?a=parseFloat((0,Yh.default)(e).value()):a=parseFloat((0,Yh.default)(e).format("0."+o)),a}function Xm(e){if(e!=null&&!isNaN(parseFloat(e))&&!ds(e)){let t=(0,Yh.default)(e).value().toString().split(".");return t.length==1?t=0:t=t[1].length,t}else return null}function bn(e,n,t,l){let o=$(window).height(),a=$(window).width(),s=e.width(),u=e.height(),f=t,m=n;l==null&&(l="lefttop"),l=="lefttop"?e.css({top:t,left:n}).show():l=="righttop"?e.css({top:t,left:n-s}).show():l=="leftbottom"?e.css({bottom:o-t-12,left:n}).show():l=="rightbottom"&&e.css({bottom:o-t-12,left:n-s}).show()}function tl(e,n){n=n||document;var t=n.querySelectorAll(e);return t.length==1?Array.prototype.slice.call(t)[0]:Array.prototype.slice.call(t)}function Fh(e,n,t){if(typeof e!="object")var e=[e];var l=document.getElementsByTagName("head")[0]||document.documentElement,o=[],a=e.length-1,s=function(u){if(o[u]=document.createElement("script"),o[u].setAttribute("type","text/javascript"),o[u].onload=o[u].onreadystatechange=function(){this.onload=this.onreadystatechange=null,this.parentNode.removeChild(this),u!==a?s(u+1):typeof t=="function"&&t()},o[u].setAttribute("src",e[u]),typeof n=="object")for(var f in n)o[u].setAttribute(f,n[f]);l.appendChild(o[u])};s(0)}function f_(e){var n=document,t=n.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e);var l=n.getElementsByTagName("head");l.length?l[0].appendChild(t):n.documentElement.appendChild(t)}function Mh(e){typeof e!="object"&&(e=[e]),e.length&&e.forEach(n=>{f_(n)})}function Zy(e){if(e==null||e.length==0)return null;let n=e.split(","),t="";for(let l=0;l<n.length;l++){let a=n[l].split("!"),s="",u="";a.length>1?(s=a[0],u=a[1]):u=a[0];let f=u.split(":"),m="";for(let d=0;d<f.length;d++){let p=f[d],b=p.replace(/[^0-9]/g,""),g=p.replace(/[^A-Za-z]/g,""),v="";g!=""&&(v+="$"+g),b!=""&&(v+="$"+b),m+=v+":"}m=m.substr(0,m.length-1),t+=s+m+","}return t.substr(0,t.length-1)}function cc(e,n=!0){let t=$("#"+e).find(".luckysheet-modal-dialog-content").css("min-width",300).end(),l=t.outerHeight(),o=t.outerWidth(),a=$(window).width(),s=$(window).height(),u=$(document).scrollLeft(),f=$(document).scrollTop();t.css({left:(a+u-o)/2,top:(s+f-l)/3}).show(),n&&$("#luckysheet-modal-dialog-mask").show()}function h_(e,n,t,l){e[n]=new Proxy(t,{set(o,a,s,u){return setTimeout(()=>{l(o,a,s,u)},0),Reflect.set(o,a,s,u)}})}function d_(e,n,t,l){Object.defineProperty(e,n,{enumerable:!0,configurable:!1,get(){return t},set(o){t!==o&&(console.log(`\u53D1\u73B0 ${n} \u5C5E\u6027 ${t} -> ${o}`),setTimeout(()=>{l(t,o)},0),t=o)}})}function Dh(e,n){e.some((t,l,o)=>{if(t===n)return o.splice(l,1),t===n})}function ms(e){return e.replace(/([A-Z])/g,function(n,t){return"-"+t.toLowerCase()})}var import_plugin,Yh,Zh,Ol=Nt(()=>{import_plugin=qe(Ye());Rr();ln();Xo();cr();il();Xl();Yh=qe(nc());Zh=(e,n,t)=>{if(!e.hasOwnProperty(n)){console.info("No %s in data",n);return}G(e)==="object"&&(G(e[n])==="object"||G(e[n])==="array"?h_(e,n,e[n],t):d_(e,n,e[n],t))}});function Hg(){h.cellMainSrollBarSize=0;let e=!1,n={},t=!1,l=null;$(document).on("touchstart","#luckysheet-grid-window-1",function(o){clearInterval(l),e=!0;let a=o.originalEvent.targetTouches[0];n={x:a.pageX,y:a.pageY,vy:0,moveType:"y"}}),$(document).on("touchmove","#luckysheet-grid-window-1",function(o){if(o.originalEvent.targetTouches.length>1||o.scale&&o.scale!==1)return;let a=o.originalEvent.targetTouches[0];if(e){let s=a.pageX-n.x,u=a.pageY-n.y;n.x=a.pageX,n.y=a.pageY;let f=$("#luckysheet-scrollbar-x").scrollLeft(),m=$("#luckysheet-scrollbar-y").scrollTop();f-=s,m-=u,f<0&&(f=0),m<0&&(m=0),$("#luckysheet-scrollbar-y").scrollTop(m),n.vy_y=u,n.scrollTop=m,$("#luckysheet-scrollbar-x").scrollLeft(f),n.vy_x=s,n.scrollLeft=f}else if(t){let s=wl(a.pageX,a.pageY),u=s[0]+$("#luckysheet-cell-main").scrollLeft(),f=s[1]+$("#luckysheet-cell-main").scrollTop(),m=Jl(f),d=m[1],p=m[0],b=m[2],g=Zl(u),v=g[1],x=g[0],_=g[2],S=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),I=0,P=0,F=[];S.top>p?(I=p,P=S.top+S.height-p,S.row[1]>S.row_focus&&(S.row[1]=S.row_focus),F=[b,S.row[1]]):S.top==p?(I=p,P=S.top+S.height-p,F=[b,S.row[0]]):(I=S.top,P=d-S.top-1,S.row[0]<S.row_focus&&(S.row[0]=S.row_focus),F=[S.row[0],b]);let D=0,k=0,w=[];S.left>x?(D=x,k=S.left+S.width-x,S.column[1]>S.column_focus&&(S.column[1]=S.column_focus),w=[_,S.column[1]]):S.left==x?(D=x,k=S.left+S.width-x,w=[_,S.column[0]]):(D=S.left,k=v-S.left-1,S.column[0]<S.column_focus&&(S.column[0]=S.column_focus),w=[S.column[0],_]);let C=_t.mergeMoveMain(w,F,S,I,P,D,k);C!=null&&(w=C[0],F=C[1],I=C[2],P=C[3],D=C[4],k=C[5]),S.row=F,S.column=w,S.left_move=D,S.width_move=k,S.top_move=I,S.height_move=P,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=S,gl(),Ie.scrollFreezen()}o.stopPropagation()}),$(document).on("touchend",function(o){if(e){let a=Math.abs(n.vy_x),s=((a>>31)*2+1)*.25,u=Math.abs(n.vy_y),f=((u>>31)*2+1)*.25;(a>0||u>0)&&(l=setInterval(function(){a-=s,u-=f,a<=0&&(a=0),u<=0&&(u=0),n.vy_y>0?n.scrollTop-=u:n.scrollTop+=u,$("#luckysheet-scrollbar-y").scrollTop(n.scrollTop),n.vy_x>0?n.scrollLeft-=a:n.scrollLeft+=a,$("#luckysheet-scrollbar-x").scrollLeft(n.scrollLeft),a<=0&&u<=0&&clearInterval(l)},20))}e=!1,t=!1}),$(document).on("touchstart",".luckysheet-cs-touchhandle",function(o){t=!0,e=!1,o.stopPropagation()}),document.addEventListener("touchmove",function(o){o.preventDefault()},{passive:!1})}var import_plugin,Y1=Nt(()=>{import_plugin=qe(Ye());Ri();jr();ln();Di();il()});var import_plugin,m_,jg,X1=Nt(()=>{import_plugin=qe(Ye());Ol();Rr();jr();Kr();Wr();Do();Er();Ar();il();Xl();m_={createDialog:function(){let e=this,n=Be(),t=n.splitText,l=n.punctuation,o=n.button;$("#luckysheet-modal-dialog-mask").show(),$("#luckysheet-splitColumn-dialog").remove();let a='<div class="box"><div class="boxTitle">'+t.splitDelimiters+'</div><div class="boxMain"><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_01" type="checkbox"/><label for="splitColumn_type_01">'+l.tab+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_02" type="checkbox"/><label for="splitColumn_type_02">'+l.semicolon+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_03" type="checkbox"/><label for="splitColumn_type_03">'+l.comma+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_04" type="checkbox"/><label for="splitColumn_type_04">'+l.space+'</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_05" type="checkbox"/><label for="splitColumn_type_05">'+t.splitOther+'</label><input type="text" class="formulaInputFocus" maxlength="1"/></div></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_06" type="checkbox"/><label for="splitColumn_type_06">'+t.splitContinueSymbol+'</label></div><div class="boxTitle" style="margin-top: 10px;">'+t.splitDataPreview+'</div><div class="boxMain" id="splitColumnData"></div></div>';$("body").first().append(Tt(Ll,{id:"luckysheet-splitColumn-dialog",addclass:"luckysheet-splitColumn-dialog",title:t.splitTextTitle,content:a,botton:'<button id="luckysheet-splitColumn-dialog-confirm" class="btn btn-primary">'+o.confirm+'</button><button class="btn btn-default luckysheet-model-close-btn">'+o.cancel+"</button>",style:"z-index:100003"}));let s=$("#luckysheet-splitColumn-dialog").find(".luckysheet-modal-dialog-content").css("min-width",400).end(),u=s.outerHeight(),f=s.outerWidth(),m=$(window).width(),d=$(window).height(),p=$(document).scrollLeft(),b=$(document).scrollTop();$("#luckysheet-splitColumn-dialog").css({left:(m+p-f)/2,top:(d+b-u)/3}).show();let g=e.getDataArr();e.dataPreview(g)},init:function(){let e=this,t=Be().splitText;$(document).off("change.SPCinpcheckbox").on("change.SPCcheckbox","#luckysheet-splitColumn-dialog .box input[type='checkbox']",function(){let l=e.getRegStr(),o=e.getDataArr(l);e.dataPreview(o)}),$(document).off("keyup.SPCinptext").on("keyup.SPCinptext","#luckysheet-splitColumn-dialog .box input[type='text']",function(){if($(this).siblings("input[type='checkbox']").is(":checked")){let l=e.getRegStr(),o=e.getDataArr(l);e.dataPreview(o)}}),$(document).off("click.SPCconfirm").on("click.SPCconfirm","#luckysheet-splitColumn-dialog #luckysheet-splitColumn-dialog-confirm",function(){$("#luckysheet-modal-dialog-mask").hide(),$("#luckysheet-splitColumn-dialog").hide();let l=e.getRegStr(),o=e.getDataArr(l),a=h.luckysheet_select_save[0].row[0],s=h.luckysheet_select_save[0].column[0];if(o[0].length==1)return;let u=!1;for(let f=0;f<o.length;f++)for(let m=1;m<o[0].length;m++){let d=h.flowdata[a+f][s+m];if(d!=null&&d.v!=null){u=!0;break}}if(u){let f=function(){e.update(a,s,o)};ke.confirm("",t.splitConfirmToExe,f)}else e.update(a,s,o)})},update:function(e,n,t){let l=It.deepCopyFlowData(h.flowdata);for(let u=0;u<t.length;u++)for(let f=0;f<t[0].length;f++){let m=t[u][f];kr(e+u,n+f,l,m)}let o=h.luckysheet_select_save[0].row[0],a=h.luckysheet_select_save[0].column[0],s=[{row:[o,o+t.length-1],column:[a,a+t[0].length-1]}];al(l,s),gl()},dataPreview:function(e){$("#luckysheet-splitColumn-dialog #splitColumnData").empty();let n="";for(let l=0;l<e.length;l++){let o="";for(let a=0;a<e[0].length;a++)o+="<td>"+e[l][a]+"</td>";n+="<tr>"+o+"</tr>"}let t="<table>"+n+"</table>";$("#luckysheet-splitColumn-dialog #splitColumnData").append(t)},getRegStr:function(){let e="",n=0;return $("#luckysheet-splitColumn-dialog .box input[type='checkbox']:checked").each(function(t,l){let o=$(l).attr("id");if(o=="splitColumn_type_01")e+="\\t",n++;else if(o=="splitColumn_type_02")n>0&&(e+="|"),e+=";",n++;else if(o=="splitColumn_type_03")n>0&&(e+="|"),e+=",",n++;else if(o=="splitColumn_type_04")n>0&&(e+="|"),e+="\\s",n++;else if(o=="splitColumn_type_05"){let a=$(l).siblings("input[type='text']").val().trim();a!=""&&(n>0&&(e+="|"),e+=a)}else o=="splitColumn_type_06"&&(e="["+e+"]+")}),e},getDataArr:function(e){let n=this,t=[],l=h.luckysheet_select_save[0].row[0],o=h.luckysheet_select_save[0].row[1],a=h.luckysheet_select_save[0].column[0];if(e!=null&&e!=""){let s=new RegExp(e,"g"),u=[];for(let d=l;d<=o;d++){let p=[],b=h.flowdata[d][a],g;b!=null&&b.m!=null?g=b.m:g=Vt(d,a,h.flowdata),g==null&&(g=""),p=g.toString().split(s),u.push(p)}let f=u.length,m=0;for(let d=0;d<f;d++)u[d].length>m&&(m=u[d].length);t=n.getNullData(f,m);for(let d=0;d<t.length;d++)for(let p=0;p<t[0].length;p++)u[d][p]!=null&&(t[d][p]=u[d][p])}else for(let s=l;s<=o;s++){let u=[],f=h.flowdata[s][a],m;f!=null&&f.m!=null?m=f.m:m=Vt(s,a,h.flowdata),m==null&&(m=""),u.push(m),t.push(u)}return t},getNullData:function(e,n){let t=[];for(let l=0;l<e;l++){let o=[];for(let a=0;a<n;a++)o.push("");t.push(o)}return t}},jg=m_});function g_(){let n=Be().cellFormat;$("#luckysheet-cellFormat-confirm").click(function(){let t=$("#luckysheet-protection-check-locked").is(":checked"),l=$("#luckysheet-protection-check-hidden").is(":checked");t=t==!0?1:0,l=l==!0?1:0;let o=K1(function(a,s,u,f){a==null?kr(s,u,f,{lo:t,hi:l}):(a.lo=t,a.hi=l)},function(){alert(n.sheetDataIsNullAlert)});al(o,void 0,void 0,!1),$("#luckysheet-cellFormat-config").hide(),$("#luckysheet-modal-dialog-mask").hide()})}function K1(e,n){if(h.luckysheet_select_save!=null&&h.luckysheet_select_save.length>0){let t=kt.getSheetByIndex(),l=t.data;if(l!=null)for(let o=0;o<h.luckysheet_select_save.length;o++){let a=h.luckysheet_select_save[o],s=a.row,u=a.column;for(let f=s[0];f<=s[1];f++)for(let m=u[0];m<=u[1];m++){let d,p=_t.mergeborer(l,f,m);if(p){let b=p.row[2],g=p.column[2];d=l[b][g]}else d=l[f][m];e(d,f,m,l)}}else n();return l}}function p_(){if(Z1)return;Z1=!0;let e=Be(),n=e.cellFormat,t=e.button;$("body").first().append(Tt(Ll,{id:"luckysheet-cellFormat-config",addclass:"luckysheet-cellFormat-config",title:n.cellFormatTitle,content:`
            <div class="luckysheet-cellFormat-menu-c">
                <div class="luckysheet-cellFormat-menu luckysheet-cellFormat-menu-active" id="luckysheet-cellFormat-protection">
                    ${n.protection}
                </div>
            </div>
            <div id="luckysheet-cellFormat-protection-content" class="luckysheet-cellFormat-content">
                <div class="luckysheet-cellFormat-protection">
                    <p>
                        ${n.protectionTips}
                    </p>
                    <label for="luckysheet-protection-check-locked"><input id="luckysheet-protection-check-locked" name="luckysheet-protection-check-locked" type="checkbox">${n.locked}</label><span>\u90E8\u5206\u9009\u4E2D</span>
                    <br/>
                    <label for="luckysheet-protection-check-hidden"><input id="luckysheet-protection-check-hidden" name="luckysheet-protection-check-hidden" type="checkbox">${n.hidden}</label><span>\u5168\u90E8\u9009\u4E2D</span>
                </div>
            </div>
        `,botton:`<button id="luckysheet-cellFormat-confirm" class="btn btn-primary">${t.confirm}</button>
                    <button class="btn btn-default luckysheet-model-close-btn">${t.cancel}</button>`,style:"z-index:100003"})),g_()}function J1(){p_();let e=Be(),n=e.cellFormat,t=e.button;if($("#luckysheet-rightclick-menu").hide(),!ea(h.currentSheetIndex))return;let l=!1,o=!1,a=0,s=0,u=0;if(h.luckysheet_select_save!=null&&h.luckysheet_select_save.length>0)K1(function(d){(d==null||d.lo==null||d.lo==1)&&(l=!0,a++),d!=null&&d.hi==1&&(o=!0,s++),u++},function(){l=!0});else{alert(n.selectionIsNullAlert);return}let f="",m="";l&&(f=a==u?n.tipsAll:n.tipsPart),o&&(m=s==u?n.tipsAll:n.tipsPart),$("#luckysheet-protection-check-locked").prop("checked",l).parent().next().html(f),$("#luckysheet-protection-check-hidden").prop("checked",o).parent().next().html(m),cc("luckysheet-cellFormat-config")}var import_plugin,Z1,Q1=Nt(()=>{import_plugin=qe(Ye());il();Ol();Rr();kn();ln();hi();Ar();Xl();Do();Z1=!1});function Kh(e){let n=$("#luckysheet-cell-main"),t=$("#luckysheet-scrollbar-x").scrollLeft(),l=$("#luckysheet-scrollbar-y").scrollTop(),o=$("#luckysheetTableContent").height();if(Ie.freezenhorizontaldata!=null&&l<Ie.freezenhorizontaldata[2]){l=Ie.freezenhorizontaldata[2],$("#luckysheet-scrollbar-y").scrollTop(l);return}if(Ie.freezenverticaldata!=null&&t<Ie.freezenverticaldata[2]){t=Ie.freezenverticaldata[2],$("#luckysheet-scrollbar-x").scrollLeft(t);return}$("#luckysheet-cols-h-c").scrollLeft(t),$("#luckysheet-rows-h").scrollTop(l),n.scrollLeft(t).scrollTop(l),$("#luckysheet-input-box-index").css({left:$("#luckysheet-input-box").css("left"),top:parseInt($("#luckysheet-input-box").css("top"))-20+"px","z-index":$("#luckysheet-input-box").css("z-index")}).show(),Xt(t,l),$("#luckysheet-bottom-controll-row").css("left",t),(Ie.freezenhorizontaldata!=null||Ie.freezenverticaldata!=null)&&Ie.scrollAdapt(),!!sl.createHookFunction("scroll",{scrollLeft:t,scrollTop:l,canvasHeight:o})}var import_plugin,ek=Nt(()=>{import_plugin=qe(Ye());Di();Go();Ar();il();wi()});function Bg(){let e=co.detectOS();co.mobilecheck()&&Hg(),Date.now||(Date.now=function(){return new Date().getTime()}),function(){"use strict";for(var p=["webkit","moz"],b=0;b<p.length&&!window.requestAnimationFrame;++b){var g=p[b];window.requestAnimationFrame=window[g+"RequestAnimationFrame"],window.cancelAnimationFrame=window[g+"CancelAnimationFrame"]||window[g+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var v=0;window.requestAnimationFrame=function(x){var _=Date.now(),S=Math.max(v+16,_);return setTimeout(function(){x(v=S)},S-_)},window.cancelAnimationFrame=clearTimeout}}(),$("#luckysheet-sheet-container-c").mousewheel(function(p,b){let g=p.deltaFactor<40?1:p.deltaFactor<80?2:3,v=$(this).scrollLeft();p.deltaY!=0?p.deltaY<0?v=v+10*g:v=v-10*g:p.deltaX!=0&&(p.deltaX>0?v=v+10*g:v=v-10*g),$(this).scrollLeft(v),p.preventDefault()}),$("#luckysheet-cell-main").scroll(function(){}).mousewheel(function(p,b){p.preventDefault()});let t=Be(),l=t.drag,o=t.info,a,s;$("#luckysheet-grid-window-1").mousewheel(function(p,b){let g=$("#luckysheet-scrollbar-x").scrollLeft(),v=$("#luckysheet-scrollbar-y").scrollTop(),x=h.visibledatacolumn,_=h.visibledatarow;Ie.freezenhorizontaldata!=null&&(_=Ie.freezenhorizontaldata[3]),Ie.freezenverticaldata!=null&&(x=Ie.freezenverticaldata[3]),clearTimeout(s),h.visibledatacolumn_unique!=null?x=h.visibledatacolumn_unique:(x=Lg(x),h.visibledatacolumn_unique=x),h.visibledatarow_unique!=null?_=h.visibledatarow_unique:(_=Lg(_),h.visibledatarow_unique=_);let S=$l(x,g),I=$l(_,v);Ie.freezenhorizontaldata!=null&&(I=$l(_,v+Ie.freezenhorizontaldata[0]));let P=0,F=0,D=p.deltaFactor<40?1:p.deltaFactor<80?2:3;if(p.deltaY!=0){let k,w=Math.round(D/h.zoomRatio);w=w<1?1:w,p.deltaY<0?(k=I+w,k>=_.length&&(k=_.length-1)):(k=I-w,k<0&&(k=0)),F=k==0?0:_[k-1],Ie.freezenhorizontaldata!=null&&(F-=Ie.freezenhorizontaldata[0]),$("#luckysheet-scrollbar-y").scrollTop(F)}else if(p.deltaX!=0){let k;p.deltaX>0?g=g+20*h.zoomRatio:g=g-20*h.zoomRatio,$("#luckysheet-scrollbar-x").scrollLeft(g)}s=setTimeout(()=>{h.visibledatacolumn_unique=null,h.visibledatarow_unique=null},500)}),$("#luckysheet-scrollbar-x").scroll(function(){Kh()}).mousewheel(function(p,b){p.preventDefault()}),$("#luckysheet-scrollbar-y").scroll(function(){Kh()}).mousewheel(function(p,b){p.preventDefault()}),$(window).resize(function(){document.getElementById(h.container)&&mr()}),$("#luckysheet-rich-text-editor").mouseup(function(p){_t.inputMenuButtonFocus(p.target)}),$("#luckysheet-cell-main, #luckysheetTableContent").mousedown(function(p){if($(p.target).hasClass("luckysheet-mousedown-cancel"))return;v_(),$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","default").end().find(".luckysheet-cs-draghandle").css("cursor","default"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","default"),Zt.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&Pt.cancelActiveImgItem();let b=wl(p.pageX,p.pageY);if(b[0]>=h.cellmainWidth-h.cellMainSrollBarSize||b[1]>=h.cellmainHeight-h.cellMainSrollBarSize)return;let g=b[0]+$("#luckysheet-cell-main").scrollLeft(),v=b[1]+$("#luckysheet-cell-main").scrollTop();Ie.freezenverticaldata!=null&&b[0]<Ie.freezenverticaldata[0]-Ie.freezenverticaldata[2]&&(g=b[0]+Ie.freezenverticaldata[2]),Ie.freezenhorizontaldata!=null&&b[1]<Ie.freezenhorizontaldata[0]-Ie.freezenhorizontaldata[2]&&(v=b[1]+Ie.freezenhorizontaldata[2]);let x=kt.getSheetByIndex(),_=$("#luckysheetTableContent").get(0).getContext("2d"),S=Jl(v),I=S[1],P=S[0],F=S[2],D=Zl(g),k=D[1],w=D[0],C=D[2],T=F,O=C,z=_t.mergeborer(h.flowdata,F,C);if(z&&(I=z.row[1],P=z.row[0],F=z.row[2],T=z.row[3],k=z.column[1],w=z.column[0],C=z.column[2],O=z.column[3]),!sl.createHookFunction("cellMousedownBefore",h.flowdata[F][C],{r:F,c:C,start_r:P,start_c:w,end_r:I,end_c:k},x,_))return;if(ll.cellFocus(F,C,!0),w<$("#luckysheet-cell-main").scrollLeft()&&$("#luckysheet-scrollbar-x").scrollLeft(w),P<$("#luckysheet-cell-main").scrollTop()&&$("#luckysheet-scrollbar-y").scrollTop(P),p.which=="3"){$("#luckysheet-dataVerification-showHintBox").hide();let E=!1;for(let L=0;L<h.luckysheet_select_save.length;L++)if(h.luckysheet_select_save[L].row!=null&&F>=h.luckysheet_select_save[L].row[0]&&F<=h.luckysheet_select_save[L].row[1]&&C>=h.luckysheet_select_save[L].column[0]&&C<=h.luckysheet_select_save[L].column[1]){E=!0;break}if(E)return}if(h.flowdata[F]!=null&&h.flowdata[F][C]!=null&&h.flowdata[F][C].dd!=null&&ut.fireMousedown!=null&&G(ut.fireMousedown)=="function"){ut.fireMousedown(h.flowdata[F][C].dd);return}if(ei.hyperlink&&ei.hyperlink[F+"_"+C]&&p.which!="3"){ei.cellFocus(F,C);return}h.luckysheet_scroll_status=!0;let A=$("#luckysheet-input-box");if(parseInt(A.css("top"))>0)if(y.rangestart||y.rangedrag_column_start||y.rangedrag_row_start||y.israngeseleciton()){let E=[F,T],L=[C,O],N=w,W=k-w-1,X=P,te=I-P-1;if(p.shiftKey){let ue=y.func_selectedrange,pe=0,ne=0,me=[];ue.top>P?(pe=P,ne=ue.top+ue.height-P,ue.row[1]>ue.row_focus&&(ue.row[1]=ue.row_focus),me=[F,ue.row[1]]):ue.top==P?(pe=P,ne=ue.top+ue.height-P,me=[F,ue.row[0]]):(pe=ue.top,ne=I-ue.top-1,ue.row[0]<ue.row_focus&&(ue.row[0]=ue.row_focus),me=[ue.row[0],F]);let Q=0,we=0,ie=[];ue.left>w?(Q=w,we=ue.left+ue.width-w,ue.column[1]>ue.column_focus&&(ue.column[1]=ue.column_focus),ie=[C,ue.column[1]]):ue.left==w?(Q=w,we=ue.left+ue.width-w,ie=[C,ue.column[0]]):(Q=ue.left,we=k-ue.left-1,ue.column[0]<ue.column_focus&&(ue.column[0]=ue.column_focus),ie=[ue.column[0],C]);let ge=_t.mergeMoveMain(ie,me,ue,pe,ne,Q,we);ge!=null&&(ie=ge[0],me=ge[1],pe=ge[2],ne=ge[3],Q=ge[4],we=ge[5]),eo(Q,pe,we,ne,me,ie),ue.row=me,ue.column=ie,ue.left_move=Q,ue.width_move=we,ue.top_move=pe,ue.height_move=ne,y.func_selectedrange=ue}else if(p.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){let ue=$("#luckysheet-rich-text-editor").text();if(ue[ue.length-1]===")"&&(ue=ue.substr(0,ue.length-1)),ue.length>0){let pe=ue.substr(ue.length-1,1);pe!=","&&pe!="="&&pe!="("&&(ue+=",")}if(ue.length>0&&ue.substr(0,1)=="="){if(ue=y.functionHTMLGenerate(ue),window.getSelection){let pe=window.getSelection();y.functionRangeIndex=[$(pe.anchorNode).parent().index(),pe.anchorOffset]}else{let pe=document.selection.createRange();y.functionRangeIndex=pe}$("#luckysheet-rich-text-editor").html(ue+")"),y.canceFunctionrangeSelected(),y.createRangeHightlight()}y.rangestart=!1,y.rangedrag_column_start=!1,y.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(ue+")"),y.rangeHightlightselected($("#luckysheet-rich-text-editor")),y.israngeseleciton(),y.func_selectedrange={left:N,width:W,top:X,height:te,left_move:N,width_move:W,top_move:X,height_move:te,row:E,column:L,row_focus:F,column_focus:C}}else y.func_selectedrange={left:N,width:W,top:X,height:te,left_move:N,width_move:W,top_move:X,height_move:te,row:E,column:L,row_focus:F,column_focus:C};y.rangeSetValue({row:E,column:L}),y.rangestart=!0,y.rangedrag_column_start=!1,y.rangedrag_row_start=!1,$("#luckysheet-formula-functionrange-select").css({left:N,width:W,top:X,height:te}).show(),$("#luckysheet-formula-help-c").hide(),eo(N,X,W,te,E,L),setTimeout(function(){let pe=window.getSelection().anchorNode,ne;$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")?(ne=$("#luckysheet-rich-text-editor"),y.rangechangeindex=y.data_parm_index):ne=$(pe).closest("div");let me=ne.find("span[rangeindex='"+y.rangechangeindex+"']");y.setCaretPosition(me.get(0),0,me.html().length)},1);return}else y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_select_status=!0,$("#luckysheet-info").is(":visible")&&(h.luckysheet_select_status=!1);else Um(F,C,h.currentSheetIndex)&&(h.luckysheet_select_status=!0);if($("#luckysheet-multiRange-dialog").is(":visible")){if(Mt.selectStatus=!0,h.luckysheet_select_status=!1,p.shiftKey){let L=Mt.selectRange[Mt.selectRange.length-1],N=0,W=0,X=[];L.top>P?(N=P,W=L.top+L.height-P,L.row[1]>L.row_focus&&(L.row[1]=L.row_focus),X=[F,L.row[1]]):L.top==P?(N=P,W=L.top+L.height-P,X=[F,L.row[0]]):(N=L.top,W=I-L.top-1,L.row[0]<L.row_focus&&(L.row[0]=L.row_focus),X=[L.row[0],F]);let te=0,ue=0,pe=[];L.left>w?(te=w,ue=L.left+L.width-w,L.column[1]>L.column_focus&&(L.column[1]=L.column_focus),pe=[C,L.column[1]]):L.left==w?(te=w,ue=L.left+L.width-w,pe=[C,L.column[0]]):(te=L.left,ue=k-L.left-1,L.column[0]<L.column_focus&&(L.column[0]=L.column_focus),pe=[L.column[0],C]);let ne=_t.mergeMoveMain(pe,X,L,N,W,te,ue);ne!=null&&(pe=ne[0],X=ne[1],N=ne[2],W=ne[3],te=ne[4],ue=ne[5]),L.row=X,L.column=pe,L.left_move=te,L.width_move=ue,L.top_move=N,L.height_move=W,Mt.selectRange[Mt.selectRange.length-1]=L}else p.ctrlKey?Mt.selectRange.push({left:w,width:k-w-1,top:P,height:I-P-1,left_move:w,width_move:k-w-1,top_move:P,height_move:I-P-1,row:[F,T],column:[C,O],row_focus:F,column_focus:C}):(Mt.selectRange=[],Mt.selectRange.push({left:w,width:k-w-1,top:P,height:I-P-1,left_move:w,width_move:k-w-1,top_move:P,height_move:I-P-1,row:[F,T],column:[C,O],row_focus:F,column_focus:C}));gr(Mt.selectRange);let E=Mt.getTxtByRange(Mt.selectRange);$("#luckysheet-multiRange-dialog input").val(E);return}else Mt.selectStatus=!1,Mt.selectRange=[];if($("#luckysheet-singleRange-dialog").is(":visible")){h.luckysheet_select_status=!1,gr([{row:[F,F],column:[C,C]}]);let E=Kl(h.currentSheetIndex,{row:[F,F],column:[C,C]},h.currentSheetIndex);$("#luckysheet-singleRange-dialog input").val(E);return}if($("#luckysheet-dataVerificationRange-dialog").is(":visible")){if(ll.selectStatus=!0,h.luckysheet_select_status=!1,p.shiftKey){let L=ll.selectRange[ll.selectRange.length-1],N=0,W=0,X=[];L.top>P?(N=P,W=L.top+L.height-P,L.row[1]>L.row_focus&&(L.row[1]=L.row_focus),X=[F,L.row[1]]):L.top==P?(N=P,W=L.top+L.height-P,X=[F,L.row[0]]):(N=L.top,W=I-L.top-1,L.row[0]<L.row_focus&&(L.row[0]=L.row_focus),X=[L.row[0],F]);let te=0,ue=0,pe=[];L.left>w?(te=w,ue=L.left+L.width-w,L.column[1]>L.column_focus&&(L.column[1]=L.column_focus),pe=[C,L.column[1]]):L.left==w?(te=w,ue=L.left+L.width-w,pe=[C,L.column[0]]):(te=L.left,ue=k-L.left-1,L.column[0]<L.column_focus&&(L.column[0]=L.column_focus),pe=[L.column[0],C]);let ne=_t.mergeMoveMain(pe,X,L,N,W,te,ue);ne!=null&&(pe=ne[0],X=ne[1],N=ne[2],W=ne[3],te=ne[4],ue=ne[5]),L.row=X,L.column=pe,L.left_move=te,L.width_move=ue,L.top_move=N,L.height_move=W,ll.selectRange[ll.selectRange.length-1]=L}else ll.selectRange=[],ll.selectRange.push({left:w,width:k-w-1,top:P,height:I-P-1,left_move:w,width_move:k-w-1,top_move:P,height_move:I-P-1,row:[F,T],column:[C,O],row_focus:F,column_focus:C});gr(ll.selectRange);let E=ll.getTxtByRange(ll.selectRange);y.rangetosheet!=h.currentSheetIndex&&(E=h.luckysheetfile[Me(h.currentSheetIndex)].name+"!"+E),$("#luckysheet-dataVerificationRange-dialog input").val(E);return}else ll.selectStatus=!1,ll.selectRange=[];if(pu.singleRangeFocus&&$("#luckysheet-ifFormulaGenerator-dialog .singRange").click(),$("#luckysheet-ifFormulaGenerator-singleRange-dialog").is(":visible")){h.luckysheet_select_status=!1,y.rangestart=!1,$("#luckysheet-formula-functionrange-select").css({left:w,width:k-w-1,top:P,height:I-P-1}).show(),$("#luckysheet-formula-help-c").hide();let E=Kl(h.currentSheetIndex,{row:[F,F],column:[C,C]},h.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-singleRange-dialog input").val(E);return}if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){h.luckysheet_select_status=!1,y.func_selectedrange={left:w,width:k-w-1,top:P,height:I-P-1,left_move:w,width_move:k-w-1,top_move:P,height_move:I-P-1,row:[F,F],column:[C,C],row_focus:F,column_focus:C},y.rangestart=!0,$("#luckysheet-formula-functionrange-select").css({left:w,width:k-w-1,top:P,height:I-P-1}).show(),$("#luckysheet-formula-help-c").hide();let E=Kl(h.currentSheetIndex,{row:[F,F],column:[C,C]},h.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(E),$("#luckysheet-row-count-show").hide(),$("#luckysheet-column-count-show").hide();return}if(h.luckysheet_select_status){if(p.shiftKey){let E=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),L=0,N=0,W=[];E.top>P?(L=P,N=E.top+E.height-P,E.row[1]>E.row_focus&&(E.row[1]=E.row_focus),W=[F,E.row[1]]):E.top==P?(L=P,N=E.top+E.height-P,W=[F,E.row[0]]):(L=E.top,N=I-E.top-1,E.row[0]<E.row_focus&&(E.row[0]=E.row_focus),W=[E.row[0],F]);let X=0,te=0,ue=[];E.left>w?(X=w,te=E.left+E.width-w,E.column[1]>E.column_focus&&(E.column[1]=E.column_focus),ue=[C,E.column[1]]):E.left==w?(X=w,te=E.left+E.width-w,ue=[C,E.column[0]]):(X=E.left,te=k-E.left-1,E.column[0]<E.column_focus&&(E.column[0]=E.column_focus),ue=[E.column[0],C]);let pe=_t.mergeMoveMain(ue,W,E,L,N,X,te);pe!=null&&(ue=pe[0],W=pe[1],L=pe[2],N=pe[3],X=pe[4],te=pe[5]),E.row=W,E.column=ue,E.left_move=X,E.width_move=te,E.top_move=L,E.height_move=N,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=E,$("#luckysheet-alternateformat-rangeDialog").is(":visible")&&$("#luckysheet-alternateformat-rangeDialog input").val(Kl(h.currentSheetIndex,h.luckysheet_select_save)),Yt.luckysheet_pivotTable_select_state&&$("#luckysheet-pivotTable-range-selection-input").val(h.luckysheetfile[Me(h.currentSheetIndex)].name+"!"+yl(h.luckysheet_select_save[0].column[0])+(h.luckysheet_select_save[0].row[0]+1)+":"+yl(h.luckysheet_select_save[0].column[1])+(h.luckysheet_select_save[0].row[1]+1))}else p.ctrlKey?h.luckysheet_select_save.push({left:w,width:k-w-1,top:P,height:I-P-1,left_move:w,width_move:k-w-1,top_move:P,height_move:I-P-1,row:[F,T],column:[C,O],row_focus:F,column_focus:C}):(h.luckysheet_select_save.length=0,h.luckysheet_select_save.push({left:w,width:k-w-1,top:P,height:I-P-1,left_move:w,width_move:k-w-1,top_move:P,height_move:I-P-1,row:[F,T],column:[C,O],row_focus:F,column_focus:C}),_t.menuButtonFocus(h.flowdata,F,C),y.fucntionboxshow(F,C));gl(),(Ie.freezenhorizontaldata!=null||Ie.freezenverticaldata!=null)&&Ie.scrollAdaptOfselect(),co.mobilecheck()||Eo(),Ue.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save)}Ur.rangefocus&&(Ur.rangefocus=!1,$("#luckysheet-alternateformat-range .fa-table").click()),$("#luckysheet-row-count-show, #luckysheet-column-count-show").hide(),at()||dg(),Yt.pivotclick(F,C,h.currentSheetIndex),kl(),sl.createHookFunction("cellMousedown",h.flowdata[F][C],{r:F,c:C,start_r:P,start_c:w,end_r:I,end_c:k},x,_)}).mouseup(function(p){if(p.which=="3"){if(!h.allowEdit||at())return;let b=p.pageX,g=p.pageY,v=h.flowdata,x=h.luckysheet_select_save[0],_=ut.cellRightClickConfig;if($("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-handleincell").show(),$("#luckysheet-cols-rows-add, #luckysheet-cols-rows-shift").hide(),tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block",tl("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="block",x.row!=null&&x.row[0]==0&&x.row[1]==h.flowdata.length-1){if(!_.copy&&!_.copyAs&&!_.paste&&!_.insertColumn&&!_.deleteColumn&&!_.hideColumn&&!_.columnWidth&&!_.clear&&!_.matrix&&!_.sort&&!_.filter&&!_.chart&&!_.image&&!_.link&&!_.data&&!_.cellFormat)return;h.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Be().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Be().rightclick.width),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Be().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Be().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),h.luckysheet_cols_menu_status=!0,tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",tl("#luckysheet-top-left-add-selected").style.display=_.insertColumn?"block":"none",tl("#luckysheet-bottom-right-add-selected").style.display=_.insertColumn?"block":"none",tl("#luckysheet-del-selected").style.display=_.deleteColumn?"block":"none",tl("#luckysheet-hide-selected").style.display=_.hideColumn?"block":"none",tl("#luckysheet-show-selected").style.display=_.hideColumn?"block":"none",tl("#luckysheet-column-row-width-selected").style.display=_.columnWidth?"block":"none",!_.copy&&!_.copyAs&&!_.paste&&(tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!_.insertColumn&&!_.deleteColumn&&!_.hideColumn&&!_.columnWidth&&(tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!_.insertColumn&&!_.deleteColumn&&!_.hideColumn&&!_.columnWidth&&(tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none");let S=$.extend(!0,{},h.config);S.columnlen==null&&(S.columnlen={});let I=S.columnlen[h.luckysheet_select_save[0].column[0]]==null?h.defaultcollen:S.columnlen[h.luckysheet_select_save[0].column[0]],P=!0;for(let F=0;F<h.luckysheet_select_save.length;F++){let D=h.luckysheet_select_save[F],k=D.column[0],w=D.column[1];for(let C=k;C<=w;C++)if((S.columnlen[C]==null?h.defaultcollen:S.columnlen[C])!=I){P=!1;break}}P?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(I):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}else if(x.column!=null&&x.column[0]==0&&x.column[1]==h.flowdata[0].length-1){if(!_.copy&&!_.copyAs&&!_.paste&&!_.insertRow&&!_.deleteRow&&!_.hideRow&&!_.rowHeight&&!_.clear&&!_.matrix&&!_.sort&&!_.filter&&!_.chart&&!_.image&&!_.link&&!_.data&&!_.cellFormat)return;h.luckysheetRightHeadClickIs="row",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Be().rightclick.row),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Be().rightclick.height),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Be().rightclick.top),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Be().rightclick.bottom),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),h.luckysheet_cols_menu_status=!0,tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",tl("#luckysheet-top-left-add-selected").style.display=_.insertRow?"block":"none",tl("#luckysheet-bottom-right-add-selected").style.display=_.insertRow?"block":"none",tl("#luckysheet-del-selected").style.display=_.deleteRow?"block":"none",tl("#luckysheet-hide-selected").style.display=_.hideRow?"block":"none",tl("#luckysheet-show-selected").style.display=_.hideRow?"block":"none",tl("#luckysheet-column-row-width-selected").style.display=_.rowHeight?"block":"none",!_.copy&&!_.copyAs&&!_.paste&&(tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!_.insertRow&&!_.deleteRow&&!_.hideRow&&!_.rowHeight&&(tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!_.insertRow&&!_.deleteRow&&!_.hideRow&&!_.rowHeight&&(tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none");let S=$.extend(!0,{},h.config);S.rowlen==null&&(S.rowlen={});let I=S.rowlen[h.luckysheet_select_save[0].row[0]]==null?h.defaultrowlen:S.rowlen[h.luckysheet_select_save[0].row[0]],P=!0;for(let F=0;F<h.luckysheet_select_save.length;F++){let D=h.luckysheet_select_save[F],k=D.row[0],w=D.row[1];for(let C=k;C<=w;C++)if((S.rowlen[C]==null?h.defaultrowlen:S.rowlen[C])!=I){P=!1;break}}P?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(I):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}else{if(!_.copy&&!_.copyAs&&!_.paste&&!_.insertRow&&!_.insertColumn&&!_.deleteRow&&!_.deleteColumn&&!_.deleteCell&&!_.clear&&!_.matrix&&!_.sort&&!_.filter&&!_.chart&&!_.image&&!_.link&&!_.data&&!_.cellFormat)return;!_.copy&&!_.copyAs&&!_.paste&&(tl("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="none",!_.insertRow&&!_.insertColumn&&!_.deleteRow&&!_.deleteColumn&&!_.deleteCell&&(tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!_.insertRow&&!_.insertColumn&&!_.deleteRow&&!_.deleteColumn&&!_.deleteCell&&(tl("#luckysheet-cols-rows-handleincell .luckysheet-menuseparator").style.display="none")}!_.clear&&!_.matrix&&!_.sort&&!_.filter&&!_.chart&&!_.image&&!_.link&&!_.data&&!_.cellFormat&&(tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),Ca($("#luckysheet-rightclick-menu"),b,g)}Ue.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save)}).dblclick(function(p){if($(p.target).hasClass("luckysheet-mousedown-cancel")||!h.allowEdit||parseInt($("#luckysheet-input-box").css("top"))>0)return;let b=wl(p.pageX,p.pageY);if(b[0]>=h.cellmainWidth-h.cellMainSrollBarSize||b[1]>=h.cellmainHeight-h.cellMainSrollBarSize)return;let g=$("#luckysheet-cell-main").scrollLeft(),v=$("#luckysheet-cell-main").scrollTop(),x=b[0]+g,_=b[1]+v;Ie.freezenverticaldata!=null&&b[0]<Ie.freezenverticaldata[0]-Ie.freezenverticaldata[2]&&(x=b[0]+Ie.freezenverticaldata[2]),Ie.freezenhorizontaldata!=null&&b[1]<Ie.freezenhorizontaldata[0]-Ie.freezenhorizontaldata[2]&&(_=b[1]+Ie.freezenhorizontaldata[2]);let S=Jl(_),I=S[2],P=Zl(x),F=P[2],D=_t.mergeborer(h.flowdata,I,F);if(D&&(I=D.row[2],F=D.column[2]),Yt.isPivotRange(I,F)){if((Yt.filter==null||Yt.filter.length==0)&&(Yt.row==null||Yt.row.length==0)&&(Yt.column==null||Yt.column.length==0)&&(Yt.values==null||Yt.values.length==0)||Yt.values==null||Yt.values.length==0||I==0||F==0)return;if(Yt.column!=null&&Yt.column.length>0){if(Yt.values.length>=2&&Yt.showType=="column"){if(I<=Yt.column.length||F>=Yt.pivotDatas[0].length-Yt.values.length)return}else if(I<=Yt.column.length-1||F>=Yt.pivotDatas[0].length-1)return}if(Yt.row!=null&&Yt.row.length>0){if(Yt.values.length>=2&&Yt.showType=="row"){if(F<=Yt.row.length||I>=Yt.pivotDatas.length-Yt.values.length)return}else if(F<=Yt.row.length-1||I>=Yt.pivotDatas.length-1)return}kt.addNewSheet(p),Yt.drillDown(I,F);return}if($("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible"))$("#luckysheet-cell-selected").hide();else{if($("#luckysheet-conditionformat-dialog").is(":visible")||$("#luckysheet-administerRule-dialog").is(":visible")||$("#luckysheet-newConditionRule-dialog").is(":visible")||$("#luckysheet-editorConditionRule-dialog").is(":visible")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;if($("#luckysheet-modal-dialog-slider-alternateformat").is(":visible")||$("#luckysheet-alternateformat-rangeDialog").is(":visible"))return;{_t.luckysheetPaintModelOn&&_t.cancelPaintModel();let k=h.luckysheet_select_save[0].column_focus,w=h.luckysheet_select_save[0].row_focus;(k!==F||w!==I)&&(I=w,F=k),ti(I,F,h.flowdata),gl()}}}),document.getElementById("luckysheet-cell-main").addEventListener("drop",function(p){p.preventDefault(),p.stopPropagation();let b=p.dataTransfer.files;if(b.length==1&&b[0].type.indexOf("image")>-1){if(!nr(h.currentSheetIndex,"editObjects"))return;Pt.insertImg(b[0])}u(p)},!1),document.getElementById("luckysheet-cell-main").addEventListener("dragover",function(p){p.preventDefault(),p.stopPropagation()},!1);function u(p){if(ut&&ut.hook&&ut.hook.cellDragStop){let b=wl(p.pageX,p.pageY),g=b[0]+$("#luckysheet-cell-main").scrollLeft(),v=b[1]+$("#luckysheet-cell-main").scrollTop(),x=Jl(v),_=x[1],S=x[0],I=x[2],P=Zl(g),F=P[1],D=P[0],k=P[2],w=_t.mergeborer(h.flowdata,I,k);w&&(_=w.row[1],S=w.row[0],I=w.row[2],F=w.column[1],D=w.column[0],k=w.column[2]);let C=kt.getSheetByIndex(),T=$("#luckysheetTableContent").get(0).getContext("2d");sl.createHookFunction("cellDragStop",h.flowdata[I][k],{r:I,c:k,start_r:S,start_c:D,end_r:_,end_c:F},C,T,p)}}$(document).on("mousemove.luckysheetEvent",function(p){if(Zt.overshow(p),ei.overshow(p),window.cancelAnimationFrame(h.jfautoscrollTimeout),ut&&ut.hook&&ut.hook.sheetMousemove){let b=wl(p.pageX,p.pageY),g=b[0]+$("#luckysheet-cell-main").scrollLeft(),v=b[1]+$("#luckysheet-cell-main").scrollTop(),x=Jl(v),_=x[1],S=x[0],I=x[2],P=Zl(g),F=P[1],D=P[0],k=P[2],w=_t.mergeborer(h.flowdata,I,k);w&&(_=w.row[1],S=w.row[0],I=w.row[2],F=w.column[1],D=w.column[0],k=w.column[2]);let C=kt.getSheetByIndex(),T={functionResizeStatus:y.functionResizeStatus,horizontalmoveState:!!Ie.horizontalmovestate,verticalmoveState:!!Ie.verticalmovestate,pivotTableMoveState:!!Yt&&Yt.movestate,sheetMoveStatus:h.luckysheet_sheet_move_status,scrollStatus:!!h.luckysheet_scroll_status,selectStatus:!!h.luckysheet_select_status,rowsSelectedStatus:!!h.luckysheet_rows_selected_status,colsSelectedStatus:!!h.luckysheet_cols_selected_status,cellSelectedMove:!!h.luckysheet_cell_selected_move,cellSelectedExtend:!!h.luckysheet_cell_selected_extend,colsChangeSize:!!h.luckysheet_cols_change_size,rowsChangeSize:!!h.luckysheet_rows_change_size,chartMove:!!h.chartparam.luckysheetCurrentChartMove,chartResize:!!h.chartparam.luckysheetCurrentChartResize,rangeResize:!!y.rangeResize,rangeMove:!!y.rangeMove},O=$("#luckysheetTableContent").get(0).getContext("2d");h.flowdata&&h.flowdata[I]&&sl.createHookFunction("sheetMousemove",h.flowdata[I][k],{r:I,c:k,start_r:S,start_c:D,end_r:_,end_c:F},C,T,O)}if(y.functionResizeStatus){let g=p.pageY-y.functionResizeData.y,v=y.functionResizeData.calculatebarHeight+g,x=Math.round($(window).height()/2);if(v<=28){if(v<=20)return;v=28}else if(v>=x){if(v>=x+8)return;v=x}h.calculatebarHeight=v,$("#luckysheet-wa-calculate").css("height",h.calculatebarHeight-2),$("#luckysheet-wa-calculate-size").css({background:"#5e5e5e",cursor:"ns-resize"}),clearTimeout(y.functionResizeTimeout),y.functionResizeTimeout=setTimeout(function(){mr()},15)}else if(Ie.horizontalmovestate){let b=wl(p.pageX,p.pageY),g=$("#luckysheet-cell-main").scrollLeft(),v=$("#luckysheet-cell-main").scrollTop(),x=b[0]+g,_=b[1]+v,S=Jl(_),I=S[1],P=S[0],F=S[2],D=b[1]+h.columnHeaderHeight;D<h.columnHeaderHeight&&(D=h.columnHeaderHeight),D>Ie.windowHeight-4&&(D=Ie.windowHeight-4),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css({top:D}),D+v-h.columnHeaderHeight>=P+(I-P)/2?(D=I-2-v+h.columnHeaderHeight,Ie.freezenhorizontaldata=[I,F+1,v,Ie.cutVolumn(h.visibledatarow,F+1),D]):(D=P-2-v+h.columnHeaderHeight,Ie.freezenhorizontaldata=[P,F,v,Ie.cutVolumn(h.visibledatarow,F),D]),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-drop").css({top:D}),Ie.saveFreezen(Ie.freezenhorizontaldata,D,null,null)}else if(Ie.verticalmovestate){let b=wl(p.pageX,p.pageY),g=$("#luckysheet-cell-main").scrollLeft(),v=$("#luckysheet-cell-main").scrollTop(),x=b[0]+g,_=b[1]+v,S=Zl(x),I=S[1],P=S[0],F=S[2],D=b[0]+h.rowHeaderWidth;D<h.rowHeaderWidth&&(D=h.rowHeaderWidth),D>Ie.windowWidth-4&&(D=Ie.windowWidth-4),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css({left:D}),D+g-h.rowHeaderWidth>=P+(I-P)/2?(D=I-2-g+h.rowHeaderWidth,Ie.freezenverticaldata=[I,F+1,g,Ie.cutVolumn(h.visibledatacolumn,F+1),D]):(D=P-2-g+h.rowHeaderWidth,Ie.freezenverticaldata=[P,F,g,Ie.cutVolumn(h.visibledatacolumn,F),D]),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-drop").css({left:D}),Ie.saveFreezen(null,null,Ie.freezenverticaldata,D),mr()}else if(!!Yt&&Yt.movestate){let b=p.pageX,g=p.pageY;$("#luckysheet-modal-dialog-slider-pivot-move").css({left:b-Yt.movesave.width/2,top:g-Yt.movesave.height})}else if(h.luckysheet_sheet_move_status){let b=$("#luckysheet-sheet-container-c").scrollLeft(),g=p.pageX+b;if(Math.abs(p.pageX-h.luckysheet_sheet_move_data.pageX)<3)return;let v=$("#luckysheet-sheet-container").width(),x=g-h.luckysheet_sheet_move_data.curleft-$("#luckysheet-sheet-container").offset().left;h.luckysheet_sheet_move_data.activeobject.css({left:x});let _=$l(h.luckysheet_sheet_move_data.widthlist,x+h.luckysheet_sheet_move_data.curleft);h.luckysheet_sheet_move_data.cursorobject.css({cursor:"move"}),x-b<=6&&$("#luckysheet-sheets-leftscroll").click(),x-b>=v-40&&$("#luckysheet-sheets-rightscroll").click(),_!=h.luckysheet_sheet_move_data.curindex&&(_==-1&&x>0?(_=h.luckysheet_sheet_move_data.widthlist.length-1,$("#luckysheet-sheets-item-clone").insertAfter($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(_))):_==-1&&x<=0?$("#luckysheet-sheets-item-clone").insertBefore($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(0)):$("#luckysheet-sheets-item-clone").insertAfter($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").eq(_)),h.luckysheet_sheet_move_data.widthlist=[],$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").each(function(S){S==0?h.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):h.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+h.luckysheet_sheet_move_data.widthlist[S-1])}),h.luckysheet_sheet_move_data.curindex=$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").index($("#luckysheet-sheets-item-clone")))}else if(h.luckysheet_model_move_state){let b=$(document).scrollTop(),g=$(document).scrollLeft(),v=p.pageY+b,x=p.pageX+g,_=$(window).height(),S=$(window).width(),I=h.luckysheet_model_move_obj.height(),P=h.luckysheet_model_move_obj.width(),F=v-h.luckysheet_model_xy[1],D=x-h.luckysheet_model_xy[0];F<0&&(F=0),F+I+62>_&&(F=_-I-62),D<0&&(D=0),D+P+86>S&&(D=S-P-86),h.luckysheet_model_move_obj.css({top:F,left:D}),p.preventDefault()}else if(!!h.luckysheet_scroll_status||!!h.luckysheet_select_status||!!h.luckysheet_rows_selected_status||!!h.luckysheet_cols_selected_status||!!h.luckysheet_cell_selected_move||!!h.luckysheet_cell_selected_extend||!!h.luckysheet_cols_change_size||!!h.luckysheet_rows_change_size||!!h.chartparam.luckysheetCurrentChartMove||!!h.chartparam.luckysheetCurrentChartResize||!!y.rangeResize||!!y.rangeMove){let b=function(){if(h.luckysheet_scroll_status&&!h.luckysheet_cols_change_size&&!h.luckysheet_rows_change_size){let g=wl(p.pageX,p.pageY),v=$("#luckysheet-scrollbar-x").scrollLeft(),x=$("#luckysheet-scrollbar-y").scrollTop(),_=g[0],S=g[1],I=$("#luckysheet-cell-main").height()-20*h.zoomRatio,P=$("#luckysheet-cell-main").width()-60*h.zoomRatio;if(S<0||S>I){let F;S<0?F=x+S/2:F=x+(S-I)/2,$("#luckysheet-scrollbar-y").scrollTop(F)}if(_<0||_>P){let F;_<0?F=v+_/2:F=v+(_-P)/2,$("#luckysheet-scrollbar-x").scrollLeft(F)}}if(h.luckysheet_select_status){let g=wl(p.pageX,p.pageY),v=g[0]+$("#luckysheet-cell-main").scrollLeft(),x=g[1]+$("#luckysheet-cell-main").scrollTop(),_=Jl(x),S=_[1],I=_[0],P=_[2],F=Zl(v),D=F[1],k=F[0],w=F[2];if(!Um(P,w,h.currentSheetIndex))return;let C=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),T=0,O=0,z=[];C.top>I?(T=I,O=C.top+C.height-I,C.row[1]>C.row_focus&&(C.row[1]=C.row_focus),z=[P,C.row[1]]):C.top==I?(T=I,O=C.top+C.height-I,z=[P,C.row[0]]):(T=C.top,O=S-C.top-1,C.row[0]<C.row_focus&&(C.row[0]=C.row_focus),z=[C.row[0],P]);let A=0,E=0,L=[];C.left>k?(A=k,E=C.left+C.width-k,C.column[1]>C.column_focus&&(C.column[1]=C.column_focus),L=[w,C.column[1]]):C.left==k?(A=k,E=C.left+C.width-k,L=[w,C.column[0]]):(A=C.left,E=D-C.left-1,C.column[0]<C.column_focus&&(C.column[0]=C.column_focus),L=[C.column[0],w]);let N=_t.mergeMoveMain(L,z,C,T,O,A,E);N!=null&&(L=N[0],z=N[1],T=N[2],O=N[3],A=N[4],E=N[5]),C.row=z,C.column=L,C.left_move=A,C.width_move=E,C.top_move=T,C.height_move=O,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=C,gl(),Ie.scrollFreezen(),$("#luckysheet-alternateformat-rangeDialog").is(":visible")&&$("#luckysheet-alternateformat-rangeDialog input").val(Kl(h.currentSheetIndex,h.luckysheet_select_save[h.luckysheet_select_save.length-1])),Yt.luckysheet_pivotTable_select_state&&$("#luckysheet-pivotTable-range-selection-input").val(h.luckysheetfile[Me(h.currentSheetIndex)].name+"!"+yl(h.luckysheet_select_save[0].column[0])+(h.luckysheet_select_save[0].row[0]+1)+":"+yl(h.luckysheet_select_save[0].column[1])+(h.luckysheet_select_save[0].row[1]+1))}else if(Mt.selectStatus){let g=wl(p.pageX,p.pageY),v=g[0]+$("#luckysheet-cell-main").scrollLeft(),x=g[1]+$("#luckysheet-cell-main").scrollTop(),_=Jl(x),S=_[1],I=_[0],P=_[2],F=Zl(v),D=F[1],k=F[0],w=F[2],C=Mt.selectRange[Mt.selectRange.length-1],T=0,O=0,z=[];C.top>I?(T=I,O=C.top+C.height-I,C.row[1]>C.row_focus&&(C.row[1]=C.row_focus),z=[P,C.row[1]]):C.top==I?(T=I,O=C.top+C.height-I,z=[P,C.row[0]]):(T=C.top,O=S-C.top-1,C.row[0]<C.row_focus&&(C.row[0]=C.row_focus),z=[C.row[0],P]);let A=0,E=0,L=[];C.left>k?(A=k,E=C.left+C.width-k,C.column[1]>C.column_focus&&(C.column[1]=C.column_focus),L=[w,C.column[1]]):C.left==k?(A=k,E=C.left+C.width-k,L=[w,C.column[0]]):(A=C.left,E=D-C.left-1,C.column[0]<C.column_focus&&(C.column[0]=C.column_focus),L=[C.column[0],w]);let N=_t.mergeMoveMain(L,z,C,T,O,A,E);N!=null&&(L=N[0],z=N[1],T=N[2],O=N[3],A=N[4],E=N[5]),C.row=z,C.column=L,C.left_move=A,C.width_move=E,C.top_move=T,C.height_move=O,Mt.selectRange[Mt.selectRange.length-1]=C,gr(Mt.selectRange);let W=Mt.getTxtByRange(Mt.selectRange);$("#luckysheet-multiRange-dialog input").val(W)}else if(ll.selectStatus){let g=wl(p.pageX,p.pageY),v=g[0]+$("#luckysheet-cell-main").scrollLeft(),x=g[1]+$("#luckysheet-cell-main").scrollTop(),_=Jl(x),S=_[1],I=_[0],P=_[2],F=Zl(v),D=F[1],k=F[0],w=F[2],C=ll.selectRange[ll.selectRange.length-1],T=0,O=0,z=[];C.top>I?(T=I,O=C.top+C.height-I,C.row[1]>C.row_focus&&(C.row[1]=C.row_focus),z=[P,C.row[1]]):C.top==I?(T=I,O=C.top+C.height-I,z=[P,C.row[0]]):(T=C.top,O=S-C.top-1,C.row[0]<C.row_focus&&(C.row[0]=C.row_focus),z=[C.row[0],P]);let A=0,E=0,L=[];C.left>k?(A=k,E=C.left+C.width-k,C.column[1]>C.column_focus&&(C.column[1]=C.column_focus),L=[w,C.column[1]]):C.left==k?(A=k,E=C.left+C.width-k,L=[w,C.column[0]]):(A=C.left,E=D-C.left-1,C.column[0]<C.column_focus&&(C.column[0]=C.column_focus),L=[C.column[0],w]);let N=_t.mergeMoveMain(L,z,C,T,O,A,E);N!=null&&(L=N[0],z=N[1],T=N[2],O=N[3],A=N[4],E=N[5]),C.row=z,C.column=L,C.left_move=A,C.width_move=E,C.top_move=T,C.height_move=O,ll.selectRange[ll.selectRange.length-1]=C,gr(ll.selectRange);let W=ll.getTxtByRange(ll.selectRange);y.rangetosheet!=h.currentSheetIndex&&(W=h.luckysheetfile[Me(h.currentSheetIndex)].name+"!"+W),$("#luckysheet-dataVerificationRange-dialog input").val(W)}else if(y.rangestart)y.rangedrag(p);else if(y.rangedrag_row_start)y.rangedrag_row(p);else if(y.rangedrag_column_start)y.rangedrag_column(p);else if(h.luckysheet_rows_selected_status){let v=wl(p.pageX,p.pageY)[1]+$("#luckysheet-rows-h").scrollTop();if(v<0)return!1;let x=Jl(v),_=x[1],S=x[0],I=x[2],P=h.visibledatacolumn.length-1,F=h.visibledatacolumn[P],D=0,k=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),w=0,C=0,T=[];k.top>S?(w=S,C=k.top+k.height-S,k.row[1]>k.row_focus&&(k.row[1]=k.row_focus),T=[I,k.row[1]]):k.top==S?(w=S,C=k.top+k.height-S,T=[I,k.row[0]]):(w=k.top,C=_-k.top-1,k.row[0]<k.row_focus&&(k.row[0]=k.row_focus),T=[k.row[0],I]),k.row=T,k.top_move=w,k.height_move=C,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=k,gl(),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){Nn()},500)}else if(h.luckysheet_cols_selected_status){let v=wl(p.pageX,p.pageY)[0]+$("#luckysheet-cols-h-c").scrollLeft();if(v<0)return!1;let x=h.visibledatarow.length-1,_=h.visibledatarow[x],S=0,I=Zl(v),P=I[1],F=I[0],D=I[2],k=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),w=0,C=0,T=[];k.left>F?(w=F,C=k.left+k.width-F,k.column[1]>k.column_focus&&(k.column[1]=k.column_focus),T=[D,k.column[1]]):k.left==F?(w=F,C=k.left+k.width-F,T=[D,k.column[0]]):(w=k.left,C=P-k.left-1,k.column[0]<k.column_focus&&(k.column[0]=k.column_focus),T=[k.column[0],D]),k.column=T,k.left_move=w,k.width_move=C,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=k,gl(),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){Nn()},500)}else if(h.luckysheet_cell_selected_move){let g=wl(p.pageX,p.pageY),v=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),_=g[0]+v,S=g[1]+x,I=$(window).height()+x-h.sheetBarHeight-h.statisticBarHeight,P=$(window).width()+v,F=Jl(S),D=F[1],k=F[0],w=F[2],C=Zl(_),T=C[1],O=C[0],z=C[2],A=h.luckysheet_cell_selected_move_index[0],E=h.luckysheet_cell_selected_move_index[1],L=h.luckysheet_select_save[0].row[0]-A+w,N=h.luckysheet_select_save[0].row[1]-A+w,W=h.luckysheet_select_save[0].column[0]-E+z,X=h.luckysheet_select_save[0].column[1]-E+z;(L<0||S<0)&&(L=0,N=h.luckysheet_select_save[0].row[1]-h.luckysheet_select_save[0].row[0]),(W<0||_<0)&&(W=0,X=h.luckysheet_select_save[0].column[1]-h.luckysheet_select_save[0].column[0]),(N>=h.visibledatarow[h.visibledatarow.length-1]||S>I)&&(L=h.visibledatarow.length-1-h.luckysheet_select_save[0].row[1]+h.luckysheet_select_save[0].row[0],N=h.visibledatarow.length-1),(X>=h.visibledatacolumn[h.visibledatacolumn.length-1]||_>P)&&(W=h.visibledatacolumn.length-1-h.luckysheet_select_save[0].column[1]+h.luckysheet_select_save[0].column[0],X=h.visibledatacolumn.length-1),O=W-1==-1?0:h.visibledatacolumn[W-1],T=h.visibledatacolumn[X],k=L-1==-1?0:h.visibledatarow[L-1],D=h.visibledatarow[N],$("#luckysheet-cell-selected-move").css({left:O,width:T-O-2,top:k,height:D-k-2,display:"block"})}else if(h.luckysheet_cell_selected_extend){let g=wl(p.pageX,p.pageY),v=$("#luckysheet-cell-main").scrollLeft()-5,x=$("#luckysheet-cell-main").scrollTop()-5,_=g[0]+v,S=g[1]+x,I=$(window).height()+x-h.sheetBarHeight-h.statisticBarHeight,P=$(window).width()+v,F=Jl(S),D=F[1],k=F[0],w=F[2],C=Zl(_),T=C[1],O=C[0],z=C[2],A=h.luckysheet_cell_selected_extend_index[0],E=h.luckysheet_cell_selected_extend_index[1],L=h.luckysheet_select_save[0].row[0],N=h.luckysheet_select_save[0].row[1],W=h.luckysheet_select_save[0].column[0],X=h.luckysheet_select_save[0].column[1];(L<0||S<0)&&(L=0,N=h.luckysheet_select_save[0].row[1]-h.luckysheet_select_save[0].row[0]),(W<0||_<0)&&(W=0,X=h.luckysheet_select_save[0].column[1]-h.luckysheet_select_save[0].column[0]),(N>=h.visibledatarow[h.visibledatarow.length-1]||S>I)&&(L=h.visibledatarow.length-1-h.luckysheet_select_save[0].row[1]+h.luckysheet_select_save[0].row[0],N=h.visibledatarow.length-1),(X>=h.visibledatacolumn[h.visibledatacolumn.length-1]||_>P)&&(W=h.visibledatacolumn.length-1-h.luckysheet_select_save[0].column[1]+h.luckysheet_select_save[0].column[0],X=h.visibledatacolumn.length-1);let te=h.luckysheet_select_save[0].top_move,ue=h.luckysheet_select_save[0].height_move,pe=h.luckysheet_select_save[0].left_move,ne=h.luckysheet_select_save[0].width_move;Math.abs(A-w)>Math.abs(E-z)?w>=L&&w<=N||(h.luckysheet_select_save[0].top_move>=k?(te=k,ue=h.luckysheet_select_save[0].top_move+h.luckysheet_select_save[0].height_move-k):(te=h.luckysheet_select_save[0].top_move,ue=D-h.luckysheet_select_save[0].top_move-1)):z>=W&&z<=X||(h.luckysheet_select_save[0].left_move>=O?(pe=O,ne=h.luckysheet_select_save[0].left_move+h.luckysheet_select_save[0].width_move-O):(pe=h.luckysheet_select_save[0].left_move,ne=T-h.luckysheet_select_save[0].left_move-1)),$("#luckysheet-cell-selected-extend").css({left:pe,width:ne,top:te,height:ue,display:"block"})}else if(h.luckysheet_cols_change_size){let g=wl(p.pageX,p.pageY),v=$("#luckysheet-cols-h-c").scrollLeft(),x=g[0]+v,_=$(window).width(),S=h.visibledatarow.length-1,I=h.visibledatarow[S],P=0,F=Zl(x),D=F[1],k=F[0],w=F[2];x+3-h.luckysheet_cols_change_size_start[0]>30&&x<_+v-100&&($("#luckysheet-change-size-line").css({left:x}),$("#luckysheet-cols-change-size").css({left:x-2}))}else if(h.luckysheet_rows_change_size){let g=wl(p.pageX,p.pageY),v=$("#luckysheet-rows-h").scrollTop(),x=g[1]+v,_=$(window).height(),S=Jl(x),I=S[1],P=S[0],F=S[2];x+3-h.luckysheet_rows_change_size_start[0]>19&&x<_+v-200&&($("#luckysheet-change-size-line").css({top:x}),$("#luckysheet-rows-change-size").css({top:x}))}else if(h.chartparam.luckysheetCurrentChartMove){let g=wl(p.pageX,p.pageY),v=g[0]+$("#luckysheet-cell-main").scrollLeft(),x=g[1]+$("#luckysheet-cell-main").scrollTop(),_=h.chartparam.luckysheetCurrentChartMoveObj.height(),S=h.chartparam.luckysheetCurrentChartMoveObj.width(),I=x-h.chartparam.luckysheetCurrentChartMoveXy[1],P=v-h.chartparam.luckysheetCurrentChartMoveXy[0];if(I<0&&(I=0),I+_+42+6>h.chartparam.luckysheetCurrentChartMoveWinH&&(I=h.chartparam.luckysheetCurrentChartMoveWinH-_-42-6),P<0&&(P=0),P+S+22+36>h.chartparam.luckysheetCurrentChartMoveWinW&&(P=h.chartparam.luckysheetCurrentChartMoveWinW-S-22-36),h.chartparam.luckysheetCurrentChartMoveObj.css({top:I,left:P}),Ie.freezenhorizontaldata!=null||Ie.freezenverticaldata!=null){Ie.scrollAdapt();let F=h.chartparam.luckysheetCurrentChartMoveObj.offset(),D=h.chartparam.luckysheetCurrentChartMoveObj.position();h.chartparam.luckysheetCurrentChartMoveXy=[p.pageX-F.left,p.pageY-F.top,D.left,D.top,$("#luckysheet-scrollbar-x").scrollLeft(),$("#luckysheet-scrollbar-y").scrollTop()]}}else if(h.chartparam.luckysheetCurrentChartResize){let g=$("#luckysheet-cell-main").scrollTop(),v=$("#luckysheet-cell-main").scrollLeft(),x=wl(p.pageX,p.pageY),_=x[0]+v,S=x[1]+g;if(_<0||S<0)return!1;let I=h.chartparam.luckysheetCurrentChartResizeObj.height(),P=h.chartparam.luckysheetCurrentChartResizeObj.width(),F=S-h.chartparam.luckysheetCurrentChartResizeXy[1],D=_-h.chartparam.luckysheetCurrentChartResizeXy[0],k=h.chartparam.luckysheetCurrentChartResizeXy[5],w=h.chartparam.luckysheetCurrentChartResizeXy[3],C=h.chartparam.luckysheetCurrentChartResizeXy[4],T=h.chartparam.luckysheetCurrentChartResizeXy[2];(h.chartparam.luckysheetCurrentChartResize=="lm"||h.chartparam.luckysheetCurrentChartResize=="lt"||h.chartparam.luckysheetCurrentChartResize=="lb")&&(C=_,T=h.chartparam.luckysheetCurrentChartResizeXy[2]-D,C>h.chartparam.luckysheetCurrentChartResizeXy[2]+h.chartparam.luckysheetCurrentChartResizeXy[4]-60?(C=h.chartparam.luckysheetCurrentChartResizeXy[2]+h.chartparam.luckysheetCurrentChartResizeXy[4]-60,T=h.chartparam.luckysheetCurrentChartResizeXy[2]-(h.chartparam.luckysheetCurrentChartResizeXy[2]+h.chartparam.luckysheetCurrentChartResizeXy[4]-60-h.chartparam.luckysheetCurrentChartResizeXy[0])):C<=0&&(C=0,T=h.chartparam.luckysheetCurrentChartResizeXy[2]+h.chartparam.luckysheetCurrentChartResizeXy[0])),(h.chartparam.luckysheetCurrentChartResize=="rm"||h.chartparam.luckysheetCurrentChartResize=="rt"||h.chartparam.luckysheetCurrentChartResize=="rb")&&(T=h.chartparam.luckysheetCurrentChartResizeXy[2]+D,T<60?T=60:T>=h.chartparam.luckysheetCurrentChartResizeWinW-h.chartparam.luckysheetCurrentChartResizeXy[4]-22-36&&(T=h.chartparam.luckysheetCurrentChartResizeWinW-h.chartparam.luckysheetCurrentChartResizeXy[4]-22-36)),(h.chartparam.luckysheetCurrentChartResize=="mt"||h.chartparam.luckysheetCurrentChartResize=="lt"||h.chartparam.luckysheetCurrentChartResize=="rt")&&(k=S,w=h.chartparam.luckysheetCurrentChartResizeXy[3]-F,k>h.chartparam.luckysheetCurrentChartResizeXy[3]+h.chartparam.luckysheetCurrentChartResizeXy[5]-60?(k=h.chartparam.luckysheetCurrentChartResizeXy[3]+h.chartparam.luckysheetCurrentChartResizeXy[5]-60,w=h.chartparam.luckysheetCurrentChartResizeXy[3]-(h.chartparam.luckysheetCurrentChartResizeXy[3]+h.chartparam.luckysheetCurrentChartResizeXy[5]-60-h.chartparam.luckysheetCurrentChartResizeXy[1])):k<=0&&(k=0,w=h.chartparam.luckysheetCurrentChartResizeXy[3]+h.chartparam.luckysheetCurrentChartResizeXy[1])),(h.chartparam.luckysheetCurrentChartResize=="mb"||h.chartparam.luckysheetCurrentChartResize=="lb"||h.chartparam.luckysheetCurrentChartResize=="rb")&&(w=h.chartparam.luckysheetCurrentChartResizeXy[3]+F,w<60?w=60:w>=h.chartparam.luckysheetCurrentChartResizeWinH-h.chartparam.luckysheetCurrentChartResizeXy[5]-42-6&&(w=h.chartparam.luckysheetCurrentChartResizeWinH-h.chartparam.luckysheetCurrentChartResizeXy[5]-42-6));let O={top:k,left:C,height:w,width:T};h.chartparam.luckysheetCurrentChartResizeObj.css(O),h.resizeChart(h.chartparam.luckysheetCurrentChart)}else if(Pt.move){let g=wl(p.pageX,p.pageY),v=g[0]+$("#luckysheet-cell-main").scrollLeft(),x=g[1]+$("#luckysheet-cell-main").scrollTop(),_=Pt.images[Pt.currentImgId];_.isFixedPos&&(v=p.pageX,x=p.pageY);let S=$("#luckysheet-modal-dialog-activeImage").height(),I=$("#luckysheet-modal-dialog-activeImage").width(),P=x-Pt.moveXY[1],F=v-Pt.moveXY[0],D=0,k=Pt.currentWinH-S-42-6,w=0,C=Pt.currentWinW-I-22-36;_.isFixedPos&&(D=h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight,k=D+h.cellmainHeight-h.cellMainSrollBarSize-S,w=h.rowHeaderWidth,C=w+h.cellmainWidth-h.cellMainSrollBarSize-I),P<D&&(P=D),P>k&&(P=k),F<w&&(F=w),F>C&&(F=C),$("#luckysheet-modal-dialog-activeImage").css({left:F,top:P})}else if(Pt.resize){let g=wl(p.pageX,p.pageY),v=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),_=g[0]+v,S=g[1]+x;if(_<0||S<0)return!1;let I=Pt.resizeXY,P=S-I[1],F=_-I[0],D=I[5],k=I[3],w=I[4],C=I[2],T=Pt.resize,O=Pt.images[Pt.currentImgId];if(O.isFixedPos){let X=h.infobarHeight+h.toolbarHeight+h.calculatebarHeight+h.columnHeaderHeight,te=h.rowHeaderWidth;T=="lt"?(w=I[4]-I[6]+F,w<te&&(w=te),w>I[4]-I[6]+I[2]-1&&(w=I[4]-I[6]+I[2]-1),C=I[4]-I[6]+I[2]-w,k=Math.round(C*(I[3]/I[2])),D=I[5]-I[7]+I[3]-k,D<X&&(D=X,k=I[5]-I[7]+I[3]-D,C=Math.round(k*(I[2]/I[3])),w=I[4]-I[6]+I[2]-C),D>I[5]-I[7]+I[3]-1&&(D=I[5]-I[7]+I[3]-1,k=I[5]-I[7]+I[3]-D,C=Math.round(k*(I[2]/I[3])),w=I[4]-I[6]+I[2]-C)):T=="lm"?(w=I[4]-I[6]+F,w<te&&(w=te),w>I[4]-I[6]+I[2]-1&&(w=I[4]-I[6]+I[2]-1),C=I[4]-I[6]+I[2]-w,D=I[5]-I[7],k=I[3]):T=="lb"?(w=I[4]-I[6]+F,w<te&&(w=te),w>I[4]-I[6]+I[2]-1&&(w=I[4]-I[6]+I[2]-1),C=I[4]-I[6]+I[2]-w,k=Math.round(C*(I[3]/I[2])),D=I[5]-I[7],k<1&&(k=1,C=Math.round(k*(I[2]/I[3])),w=I[4]-I[6]+I[2]-C),k>X+h.cellmainHeight-h.cellMainSrollBarSize-D&&(k=X+h.cellmainHeight-h.cellMainSrollBarSize-D,C=Math.round(k*(I[2]/I[3])),w=I[4]-I[6]+I[2]-C)):T=="rt"?(w=I[4]-I[6],C=I[2]+F,C<1&&(C=1),C>te+h.cellmainWidth-h.cellMainSrollBarSize-w&&(C=te+h.cellmainWidth-h.cellMainSrollBarSize-w),k=Math.round(C*(I[3]/I[2])),D=I[5]-I[7]+I[3]-k,D<X&&(D=X,k=I[5]-I[7]+I[3]-D,C=Math.round(k*(I[2]/I[3]))),D>I[5]-I[7]+I[3]-1&&(D=I[5]-I[7]+I[3]-1,k=I[5]-I[7]+I[3]-D,C=Math.round(k*(I[2]/I[3])))):T=="rm"?(w=I[4]-I[6],C=I[2]+F,C<1&&(C=1),C>te+h.cellmainWidth-h.cellMainSrollBarSize-w&&(C=te+h.cellmainWidth-h.cellMainSrollBarSize-w),D=I[5]-I[7],k=I[3]):T=="rb"?(w=I[4]-I[6],C=I[2]+F,C<1&&(C=1),C>te+h.cellmainWidth-h.cellMainSrollBarSize-w&&(C=te+h.cellmainWidth-h.cellMainSrollBarSize-w),k=Math.round(C*(I[3]/I[2])),D=I[5]-I[7],k<1&&(k=1,C=Math.round(k*(I[2]/I[3]))),k>X+h.cellmainHeight-h.cellMainSrollBarSize-D&&(k=X+h.cellmainHeight-h.cellMainSrollBarSize-D,C=Math.round(k*(I[2]/I[3])))):T=="mt"?(w=I[4]-I[6],C=I[2],D=I[5]-I[7]+P,D<X&&(D=X),D>I[5]-I[7]+I[3]-1&&(D=I[5]-I[7]+I[3]-1),k=I[5]-I[7]+I[3]-D):T=="mb"&&(w=I[4]-I[6],C=I[2],D=I[5]-I[7],k=I[3]+P,k<1&&(k=1),k>X+h.cellmainHeight-h.cellMainSrollBarSize-D&&(k=X+h.cellmainHeight-h.cellMainSrollBarSize-D))}else T=="lt"?(w=_,C=I[2]-F,w>I[2]+I[4]-1?(w=I[2]+I[4]-1,C=I[2]+I[0]-(I[2]+I[4]-1)):w<=0&&(w=0,C=I[2]+I[0]),k=Math.round(C*(I[3]/I[2])),D=I[3]+I[1]-k,D>I[3]+I[5]-1?(D=I[3]+I[5]-1,k=I[3]+I[1]-(I[3]+I[5]-1),C=Math.round(k*(I[2]/I[3])),w=I[2]+I[0]-C):D<=0&&(D=0,k=I[3]+I[1],C=Math.round(k*(I[2]/I[3])),w=I[2]+I[0]-C)):T=="lm"?(w=_,C=I[2]-F,w>I[2]+I[4]-1?(w=I[2]+I[4]-1,C=I[2]+I[0]-(I[2]+I[4]-1)):w<=0&&(w=0,C=I[2]+I[0])):T=="lb"?(w=_,C=I[2]-F,w>I[2]+I[4]-1?(w=I[2]+I[4]-1,C=I[2]+I[0]-(I[2]+I[4]-1)):w<=0&&(w=0,C=I[2]+I[0]),k=Math.round(C*(I[3]/I[2])),k<1?(k=1,C=Math.round(k*(I[2]/I[3])),w=I[2]+I[0]-C):k>=Pt.currentWinH-I[5]-42-6&&(k=Pt.currentWinH-I[5]-42-6,C=Math.round(k*(I[2]/I[3])),w=I[2]+I[0]-C)):T=="rt"?(C=I[2]+F,C<1?C=1:C>=Pt.currentWinW-I[4]-22-36&&(C=Pt.currentWinW-I[4]-22-36),k=Math.round(C*(I[3]/I[2])),D=I[3]+I[1]-k,D>I[3]+I[5]-1?(D=I[3]+I[5]-1,k=I[3]+I[1]-(I[3]+I[5]-1),C=Math.round(k*(I[2]/I[3]))):D<=0&&(D=0,k=I[3]+I[1],C=Math.round(k*(I[2]/I[3])))):T=="rm"?(C=I[2]+F,C<1?C=1:C>=Pt.currentWinW-I[4]-22-36&&(C=Pt.currentWinW-I[4]-22-36)):T=="rb"?(C=I[2]+F,C<1?C=1:C>=Pt.currentWinW-I[4]-22-36&&(C=Pt.currentWinW-I[4]-22-36),k=Math.round(C*(I[3]/I[2])),k<1?(k=1,C=Math.round(k*(I[2]/I[3]))):k>=Pt.currentWinH-I[5]-42-6&&(k=Pt.currentWinH-I[5]-42-6,C=Math.round(k*(I[2]/I[3])))):T=="mt"?(D=S,k=I[3]-P,D>I[3]+I[5]-1?(D=I[3]+I[5]-1,k=I[3]+I[1]-(I[3]+I[5]-1)):D<=0&&(D=0,k=I[3]+I[1])):T=="mb"&&(k=I[3]+P,k<1?k=1:k>=Pt.currentWinH-I[5]-42-6&&(k=Pt.currentWinH-I[5]-42-6));$("#luckysheet-modal-dialog-activeImage").css({width:C,height:k,left:w,top:D});let z=C/O.crop.width,A=k/O.crop.height,E=Math.round(O.default.width*z),L=Math.round(O.default.height*A),N=Math.round(O.crop.offsetLeft*z),W=Math.round(O.crop.offsetTop*A);$("#luckysheet-modal-dialog-activeImage .luckysheet-modal-dialog-content").css({"background-size":E+"px "+L+"px","background-position":-N+"px "+-W+"px"})}else if(Pt.cropChange){let g=wl(p.pageX,p.pageY),v=g[0]+$("#luckysheet-cell-main").scrollLeft(),x=g[1]+$("#luckysheet-cell-main").scrollTop();if(v<0||x<0)return!1;let _=Pt.cropChangeXY,S=x-_[1],I=v-_[0],P=Pt.images[Pt.currentImgId],F=Pt.cropChange,D,k,w,C;F=="lt"?(w=P.crop.offsetLeft+I,w<0&&(w=0),w>P.crop.width+P.crop.offsetLeft-1&&(w=P.crop.width+P.crop.offsetLeft-1),D=P.crop.width+P.crop.offsetLeft-w,C=P.crop.offsetTop+S,C<0&&(C=0),C>P.crop.height+P.crop.offsetTop-1&&(C=P.crop.height+P.crop.offsetTop-1),k=P.crop.height+P.crop.offsetTop-C):F=="lm"?(w=P.crop.offsetLeft+I,w<0&&(w=0),w>P.crop.width+P.crop.offsetLeft-1&&(w=P.crop.width+P.crop.offsetLeft-1),D=P.crop.width+P.crop.offsetLeft-w,C=P.crop.offsetTop,k=P.crop.height):F=="lb"?(w=P.crop.offsetLeft+I,w<0&&(w=0),w>P.crop.width+P.crop.offsetLeft-1&&(w=P.crop.width+P.crop.offsetLeft-1),D=P.crop.width+P.crop.offsetLeft-w,C=P.crop.offsetTop,k=P.crop.height+S,k<1&&(k=1),k>P.default.height-C&&(k=P.default.height-C)):F=="rt"?(w=P.crop.offsetLeft,D=P.crop.width+I,D<1&&(D=1),D>P.default.width-w&&(D=P.default.width-w),C=P.crop.offsetTop+S,C<0&&(C=0),C>P.crop.height+P.crop.offsetTop-1&&(C=P.crop.height+P.crop.offsetTop-1),k=P.crop.height+P.crop.offsetTop-C):F=="rm"?(w=P.crop.offsetLeft,D=P.crop.width+I,D<1&&(D=1),D>P.default.width-w&&(D=P.default.width-w),C=P.crop.offsetTop,k=P.crop.height):F=="rb"?(w=P.crop.offsetLeft,D=P.crop.width+I,D<1&&(D=1),D>P.default.width-w&&(D=P.default.width-w),C=P.crop.offsetTop,k=P.crop.height+S,k<1&&(k=1),k>P.default.height-C&&(k=P.default.height-C)):F=="mt"?(w=P.crop.offsetLeft,D=P.crop.width,C=P.crop.offsetTop+S,C<0&&(C=0),C>P.crop.height+P.crop.offsetTop-1&&(C=P.crop.height+P.crop.offsetTop-1),k=P.crop.height+P.crop.offsetTop-C):F=="mb"&&(w=P.crop.offsetLeft,D=P.crop.width,C=P.crop.offsetTop,k=P.crop.height+S,k<1&&(k=1),k>P.default.height-C&&(k=P.default.height-C));let T=P.default.left+w,O=P.default.top+C;P.isFixedPos&&(T=P.fixedLeft+w,O=P.fixedTop+C),$("#luckysheet-modal-dialog-cropping").show().css({width:D,height:k,left:T,top:O});let z=h.toJsonOptions&&h.toJsonOptions.imageUrlHandle,A=typeof z=="function"?z(P.src):P.src;$("#luckysheet-modal-dialog-cropping .cropping-mask").css({width:P.default.width,height:P.default.height,"background-image":"url("+A+")",left:-w,top:-C}),$("#luckysheet-modal-dialog-cropping .cropping-content").css({"background-image":"url("+A+")","background-size":P.default.width+"px "+P.default.height+"px","background-position":-w+"px "+-C+"px"}),Pt.cropChangeObj={width:D,height:k,offsetLeft:w,offsetTop:C}}else if(Zt.move){let g=wl(p.pageX,p.pageY),v=g[0]+$("#luckysheet-cell-main").scrollLeft(),x=g[1]+$("#luckysheet-cell-main").scrollTop(),_=Zt.currentObj.outerHeight(),S=Zt.currentObj.outerWidth(),I=x-Zt.moveXY[1],P=v-Zt.moveXY[0];I<0&&(I=0),I+_+42+6>Zt.currentWinH&&(I=Zt.currentWinH-_-42-6),P<0&&(P=0),P+S+22+36>Zt.currentWinW&&(P=Zt.currentWinW-S-22-36),Zt.currentObj.css({left:P,top:I})}else if(Zt.resize){let g=wl(p.pageX,p.pageY),v=g[0]+$("#luckysheet-cell-main").scrollLeft(),x=g[1]+$("#luckysheet-cell-main").scrollTop();if(v<0||x<0)return!1;let _=Zt.resizeXY,S=x-_[1],I=v-_[0],P=_[5],F=_[3],D=_[4],k=_[2],w=Zt.resize;(w=="lm"||w=="lt"||w=="lb")&&(D=v,k=_[2]-I,D>_[2]+_[4]-60?(D=_[2]+_[4]-60,k=_[2]-(_[2]+_[4]-60-_[0])):D<=0&&(D=0,k=_[2]+_[0])),(w=="rm"||w=="rt"||w=="rb")&&(k=_[2]+I,k<60?k=60:k>=Zt.currentWinW-_[4]-22-36&&(k=Zt.currentWinW-_[4]-22-36)),(w=="mt"||w=="lt"||w=="rt")&&(P=x,F=_[3]-S,P>_[3]+_[5]-60?(P=_[3]+_[5]-60,F=_[3]-(_[3]+_[5]-60-_[1])):P<=0&&(P=0,F=_[3]+_[1])),(w=="mb"||w=="lb"||w=="rb")&&(F=_[3]+S,F<60?F=60:F>=Zt.currentWinH-_[5]-42-6&&(F=Zt.currentWinH-_[5]-42-6)),Zt.currentObj.css({width:k,height:F,left:D,top:P})}else y.rangeResize?y.rangeResizeDraging(p,y.rangeResizeObj,y.rangeResizexy,y.rangeResize,y.rangeResizeWinW,y.rangeResizeWinH,h.ch_width,h.rh_height):y.rangeMove?y.rangeMoveDraging(p,y.rangeMovexy,y.rangeMoveObj.data("range"),y.rangeMoveObj,h.sheetBarHeight,h.statisticBarHeight):h.chart_selection.rangeResize?h.chart_selection.rangeResizeDraging(p,h.sheetBarHeight,h.statisticBarHeight):h.chart_selection.rangeMove&&h.chart_selection.rangeMoveDraging(p,h.sheetBarHeight,h.statisticBarHeight);h.jfautoscrollTimeout=window.requestAnimationFrame(b)};h.luckysheet_select_status&&(clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){Nn()},500)),h.jfautoscrollTimeout=window.requestAnimationFrame(b)}}),$(document).on("mouseup.luckysheetEvent",function(p){if(ut&&ut.hook&&ut.hook.sheetMouseup){let T=wl(p.pageX,p.pageY),O=T[0]+$("#luckysheet-cell-main").scrollLeft(),z=T[1]+$("#luckysheet-cell-main").scrollTop(),A=Jl(z),E=A[1],L=A[0],N=A[2],W=Zl(O),X=W[1],te=W[0],ue=W[2],pe=_t.mergeborer(h.flowdata,N,ue);pe&&(E=pe.row[1],L=pe.row[0],N=pe.row[2],X=pe.column[1],te=pe.column[0],ue=pe.column[2]);let ne=kt.getSheetByIndex(),me={functionResizeStatus:y.functionResizeStatus,horizontalmoveState:!!Ie.horizontalmovestate,verticalmoveState:!!Ie.verticalmovestate,pivotTableMoveState:!!Yt&&Yt.movestate,sheetMoveStatus:h.luckysheet_sheet_move_status,scrollStatus:!!h.luckysheet_scroll_status,selectStatus:!!h.luckysheet_select_status,rowsSelectedStatus:!!h.luckysheet_rows_selected_status,colsSelectedStatus:!!h.luckysheet_cols_selected_status,cellSelectedMove:!!h.luckysheet_cell_selected_move,cellSelectedExtend:!!h.luckysheet_cell_selected_extend,colsChangeSize:!!h.luckysheet_cols_change_size,rowsChangeSize:!!h.luckysheet_rows_change_size,chartMove:!!h.chartparam.luckysheetCurrentChartMove,chartResize:!!h.chartparam.luckysheetCurrentChartResize,rangeResize:!!y.rangeResize,rangeMove:!!y.rangeMove},Q=$("#luckysheetTableContent").get(0).getContext("2d");sl.createHookFunction("sheetMouseup",h.flowdata[N][ue],{r:N,c:ue,start_r:L,start_c:te,end_r:E,end_c:X},ne,me,Q)}if(h.luckysheet_select_status&&(clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){Nn()},0),_t.luckysheetPaintModelOn&&(Ql.pasteHandlerOfPaintModel(h.luckysheet_copy_save),_t.luckysheetPaintSingle&&_t.cancelPaintModel())),h.luckysheet_select_status=!1,window.cancelAnimationFrame(h.jfautoscrollTimeout),h.luckysheet_scroll_status=!1,$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","crosshair").end().find(".luckysheet-cs-draghandle").css("cursor","move"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","default"),h.luckysheet_rows_selected_status=!1,h.luckysheet_cols_selected_status=!1,h.luckysheet_model_move_state=!1,y.functionResizeStatus&&(y.functionResizeStatus=!1,$("#luckysheet-wa-calculate-size").removeAttr("style")),Ie.horizontalmovestate&&(Ie.horizontalmovestate=!1,$("#luckysheet-freezebar-horizontal").removeClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-horizontal").find(".luckysheet-freezebar-horizontal-handle").css("cursor","-webkit-grab"),Ie.freezenhorizontaldata[4]<=h.columnHeaderHeight&&Ie.cancelFreezenHorizontal(),Ie.createAssistCanvas(),Xt()),Ie.verticalmovestate&&(Ie.verticalmovestate=!1,$("#luckysheet-freezebar-vertical").removeClass("luckysheet-freezebar-active"),$("#luckysheet-freezebar-vertical").find(".luckysheet-freezebar-vertical-handle").css("cursor","-webkit-grab"),Ie.freezenverticaldata[4]<=h.rowHeaderWidth&&Ie.cancelFreezenVertical(),Ie.createAssistCanvas(),Xt()),!!Yt&&Yt.movestate&&($("#luckysheet-modal-dialog-slider-pivot-move").remove(),Yt.movestate=!1,$("#luckysheet-modal-dialog-pivotTable-list, #luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").css("cursor","default"),Yt.movesave.containerid!="luckysheet-modal-dialog-pivotTable-list"&&$(p.target).closest(".luckysheet-modal-dialog-slider-config-list").length==0&&(Yt.movesave.containerid=="luckysheet-modal-dialog-config-value"&&Yt.resetOrderby(Yt.movesave.obj),Yt.movesave.obj.remove(),Yt.showvaluecolrow(),$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){$(this).find(".luckysheet-slider-list-item-selected").find("i").remove()}),$("#luckysheet-modal-dialog-config-filter, #luckysheet-modal-dialog-config-row, #luckysheet-modal-dialog-config-column, #luckysheet-modal-dialog-config-value").find(".luckysheet-modal-dialog-slider-config-item").each(function(){let O=$(this).data("index");$("#luckysheet-modal-dialog-pivotTable-list").find(".luckysheet-modal-dialog-slider-list-item").each(function(){let z=$(this).find(".luckysheet-slider-list-item-selected");$(this).data("index")==O&&z.find("i").length==0&&z.append('<i class="fa fa-check luckysheet-mousedown-cancel"></i>')})}),Yt.refreshPivotTable())),h.luckysheet_sheet_move_status&&(h.luckysheet_sheet_move_status=!1,h.luckysheet_sheet_move_data.activeobject.insertBefore($("#luckysheet-sheets-item-clone")),h.luckysheet_sheet_move_data.activeobject.removeAttr("style"),$("#luckysheet-sheets-item-clone").remove(),h.luckysheet_sheet_move_data.cursorobject.css({cursor:"pointer"}),h.luckysheet_sheet_move_data={},kt.reOrderAllSheet()),clearTimeout(h.chartparam.luckysheetCurrentChartMoveTimeout),h.chartparam.luckysheetCurrentChartMove&&(h.chartparam.luckysheetCurrentChartMove=!1,h.chartparam.luckysheetInsertChartTosheetChange)){var b=h.chartparam.luckysheetCurrentChartMoveObj.css("top"),g=h.chartparam.luckysheetCurrentChartMoveObj.css("left"),v=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),_=h.chartparam.luckysheetCurrentChartMoveXy[2],S=h.chartparam.luckysheetCurrentChartMoveXy[3],I=h.chartparam.luckysheetCurrentChartMoveXy[4],P=h.chartparam.luckysheetCurrentChartMoveXy[5],F=h.chartparam.luckysheetCurrentChartMoveObj.find(".luckysheet-modal-dialog-content").attr("id");h.jfredo.push({type:"moveChart",chart_id:F,sheetIndex:h.currentSheetIndex,myTop:b,myLeft:g,scrollTop:x,scrollLeft:v,x:_,y:S,scrollTop1:P,scrollLeft1:I})}if(h.chartparam.luckysheetCurrentChartResize&&(h.chartparam.luckysheetCurrentChartResize=null,h.chartparam.luckysheetInsertChartTosheetChange)){var D=h.chartparam.luckysheetCurrentChartResizeObj.height(),k=h.chartparam.luckysheetCurrentChartResizeObj.width(),v=$("#luckysheet-cell-main").scrollLeft(),x=$("#luckysheet-cell-main").scrollTop(),b=h.chartparam.luckysheetCurrentChartMoveObj.css("top"),g=h.chartparam.luckysheetCurrentChartMoveObj.css("left"),F=h.chartparam.luckysheetCurrentChartResizeObj.find(".luckysheet-modal-dialog-content").attr("id"),w=h.chartparam.luckysheetCurrentChartResizeXy[2],C=h.chartparam.luckysheetCurrentChartResizeXy[3],_=h.chartparam.luckysheetCurrentChartResizeXy[4],S=h.chartparam.luckysheetCurrentChartResizeXy[5],I=h.chartparam.luckysheetCurrentChartResizeXy[6],P=h.chartparam.luckysheetCurrentChartResizeXy[7];h.jfredo.push({type:"resizeChart",chart_id:F,sheetIndex:h.currentSheetIndex,myTop:b,myLeft:g,myHeight:D,myWidth:k,scrollTop:x,scrollLeft:v,x:_,y:S,myWidth1:w,myHeight1:C,scrollTop1:P,scrollLeft1:I})}if(y.rangeResize&&y.rangeResizeDragged(p,y.rangeResizeObj,y.rangeResize,y.rangeResizexy,y.rangeResizeWinW,y.rangeResizeWinH),Pt.move&&Pt.moveImgItem(),Pt.resize&&Pt.resizeImgItem(),Pt.cropChange&&Pt.cropChangeImgItem(),Zt.move){Zt.move=!1;let T=Zt.currentObj.closest(".luckysheet-postil-show").attr("id"),O=T.split("luckysheet-postil-show_")[1].split("_")[0],z=T.split("luckysheet-postil-show_")[1].split("_")[1],A=It.deepCopyFlowData(h.flowdata),E=[];A[O][z].ps.left=Zt.currentObj.position().left,A[O][z].ps.top=Zt.currentObj.position().top,A[O][z].ps.value=Zt.currentObj.find(".formulaInputFocus").html().replaceAll("<div>",`
`).replaceAll(/<(.*)>.*?|<(.*) \/>/g,"").trim(),E.push(O+"_"+z),Zt.ref(A,E),$("#"+T).remove(),A[O][z].ps.isshow?(Zt.buildPs(O,z,A[O][z].ps),$("#"+T).addClass("luckysheet-postil-show-active"),$("#"+T).find(".luckysheet-postil-dialog-resize").show()):Zt.editPs(O,z)}if(Zt.resize){Zt.resize=null;let T=Zt.currentObj.closest(".luckysheet-postil-show").attr("id"),O=T.split("luckysheet-postil-show_")[1].split("_")[0],z=T.split("luckysheet-postil-show_")[1].split("_")[1],A=It.deepCopyFlowData(h.flowdata),E=[];A[O][z].ps.left=Zt.currentObj.position().left,A[O][z].ps.top=Zt.currentObj.position().top,A[O][z].ps.width=Zt.currentObj.outerWidth(),A[O][z].ps.height=Zt.currentObj.outerHeight(),A[O][z].ps.value=Zt.currentObj.find(".formulaInputFocus").html().replaceAll("<div>",`
`).replaceAll(/<(.*)>.*?|<(.*) \/>/g,"").trim(),E.push(O+"_"+z),Zt.ref(A,E),$("#"+T).remove(),A[O][z].ps.isshow?(Zt.buildPs(O,z,A[O][z].ps),$("#"+T).addClass("luckysheet-postil-show-active"),$("#"+T).find(".luckysheet-postil-dialog-resize").show()):Zt.editPs(O,z)}if(h.luckysheet_rows_change_size){h.luckysheet_rows_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-rows-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas").css("cursor","default");let T=wl(p.pageX,p.pageY),O=$("#luckysheet-rows-h").scrollTop(),z=T[1]+O,A=$(window).height(),E=Jl(z),L=E[1],N=E[0],W=E[2],X=z+3-h.luckysheet_rows_change_size_start[0];z+3-h.luckysheet_rows_change_size_start[0]<19&&(X=19),z>=A-200+O&&(X=A-200-h.luckysheet_rows_change_size_start[0]+O);let te=$.extend(!0,{},h.config);te.rowlen==null&&(te.rowlen={}),te.customHeight==null&&(te.customHeight={}),te.customHeight[h.luckysheet_rows_change_size_start[1]]=1;let ue=h.luckysheet_rows_change_size_start[1],pe=!1;h.luckysheet_select_save.length>0&&h.luckysheet_select_save.filter(me=>me.row_select).some(me=>(ue>=me.row[0]&&ue<=me.row[1]&&(pe=!0),pe)),pe?h.luckysheet_select_save.filter(me=>me.row_select).forEach(me=>{for(let Q=me.row[0];Q<=me.row[1];Q++)te.rowlen[Q]=Math.ceil(X/h.zoomRatio)}):te.rowlen[h.luckysheet_rows_change_size_start[1]]=Math.ceil(X/h.zoomRatio);let ne=Pt.moveChangeSize("row",h.luckysheet_rows_change_size_start[1],X);h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"resize",ctrlType:"resizeR",sheetIndex:h.currentSheetIndex,config:$.extend(!0,{},h.config),curconfig:$.extend(!0,{},te),images:$.extend(!0,{},Pt.images),curImages:$.extend(!0,{},ne)})),h.config=te,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,te.rowlen,{k:"rowlen"}),h.luckysheetfile[Me(h.currentSheetIndex)].images=ne,Ue.saveParam("all",h.currentSheetIndex,ne,{k:"images"}),Pt.images=ne,Pt.allImagesShow(),tr(h.flowdata.length,null)}if(h.luckysheet_cols_change_size){h.luckysheet_cols_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","default");let T=wl(p.pageX,p.pageY),O=$("#luckysheet-cols-h-c").scrollLeft(),z=T[0]+O,A=$(window).width(),E=h.visibledatarow.length-1,L=h.visibledatarow[E],N=0,W=Zl(z),X=W[1],te=W[0],ue=W[2],pe=z+3-h.luckysheet_cols_change_size_start[0],ne=h.defaultcollen;if(h.config.columnlen!=null&&h.config.columnlen[h.luckysheet_cols_change_size_start[1]]!=null&&(ne=h.config.columnlen[h.luckysheet_cols_change_size_start[1]]),Math.abs(pe-ne)<3)return;z+3-h.luckysheet_cols_change_size_start[0]<30&&(pe=30),z>=A-100+O&&(pe=A-100-h.luckysheet_cols_change_size_start[0]+O);let me=$.extend(!0,{},h.config);me.columnlen==null&&(me.columnlen={}),me.customWidth==null&&(me.customWidth={}),me.customWidth[h.luckysheet_cols_change_size_start[1]]=1;let Q=h.luckysheet_cols_change_size_start[1],we=!1;h.luckysheet_select_save.length>0&&h.luckysheet_select_save.filter(ge=>ge.column_select).some(ge=>(Q>=ge.column[0]&&Q<=ge.column[1]&&(we=!0),we)),we?h.luckysheet_select_save.filter(ge=>ge.column_select).forEach(ge=>{for(let ce=ge.column[0];ce<=ge.column[1];ce++)me.columnlen[ce]=Math.ceil(pe/h.zoomRatio)}):me.columnlen[h.luckysheet_cols_change_size_start[1]]=Math.ceil(pe/h.zoomRatio);let ie=Pt.moveChangeSize("column",h.luckysheet_cols_change_size_start[1],pe);h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"resize",ctrlType:"resizeC",sheetIndex:h.currentSheetIndex,config:$.extend(!0,{},h.config),curconfig:$.extend(!0,{},me),images:$.extend(!0,{},Pt.images),curImages:$.extend(!0,{},ie)})),h.config=me,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,me.columnlen,{k:"columnlen"}),h.luckysheetfile[Me(h.currentSheetIndex)].images=ie,Ue.saveParam("all",h.currentSheetIndex,ie,{k:"images"}),Pt.images=ie,Pt.allImagesShow(),tr(null,h.flowdata[0].length),setTimeout(function(){Xt()},1)}if(y.rangeMove&&y.rangeMoveDragged(y.rangeMoveObj),h.luckysheet_cell_selected_move){$("#luckysheet-cell-selected-move").hide(),h.luckysheet_cell_selected_move=!1;let T=wl(p.pageX,p.pageY);if(!po(h.luckysheet_select_save,h.currentSheetIndex))return;let O=$("#luckysheet-cell-main").scrollLeft(),z=$("#luckysheet-cell-main").scrollTop(),A=T[0]+O,E=T[1]+z,L=$(window).height()+z-h.sheetBarHeight-h.statisticBarHeight,N=$(window).width()+O,W=Jl(E)[2],X=Zl(A)[2],te=h.luckysheet_cell_selected_move_index[0],ue=h.luckysheet_cell_selected_move_index[1];if(W==te&&X==ue)return;let pe=It.deepCopyFlowData(h.flowdata),ne=h.luckysheet_select_save[h.luckysheet_select_save.length-1],me=hr(ne),Q=$.extend(!0,{},h.config);if(Q.merge==null&&(Q.merge={}),Q.rowlen==null&&(Q.rowlen={}),sr(Q,ne.row[0],ne.row[1],ne.column[0],ne.column[1])){at()?alert(l.noMerge):ke.info('<i class="fa fa-exclamation-triangle"></i>',l.noMerge);return}let we=ne.row[0]-te+W,ie=ne.row[1]-te+W,ge=ne.column[0]-ue+X,ce=ne.column[1]-ue+X;if(!po([{row:[we,ie],column:[ge,ce]}],h.currentSheetIndex))return;if((we<0||E<0)&&(we=0,ie=ne.row[1]-ne.row[0]),(ge<0||A<0)&&(ge=0,ce=ne.column[1]-ne.column[0]),(ie>=h.visibledatarow[h.visibledatarow.length-1]||E>L)&&(we=h.visibledatarow.length-1-ne.row[1]+ne.row[0],ie=h.visibledatarow.length-1),(ce>=h.visibledatacolumn[h.visibledatacolumn.length-1]||A>N)&&(ge=h.visibledatacolumn.length-1-ne.column[1]+ne.column[0],ce=h.visibledatacolumn.length-1),sr(Q,we,ie,ge,ce)){at()?alert(l.noMerge):ke.info('<i class="fa fa-exclamation-triangle"></i>',l.noMerge);return}let fe=la(h.currentSheetIndex),ye=null;for(let ot=ne.row[0];ot<=ne.row[1];ot++){ot in Q.rowlen&&(ye=!0);for(let xt=ne.column[0];xt<=ne.column[1];xt++){let Ft=pe[ot][xt];G(Ft)=="object"&&"mc"in Ft&&Ft.mc.r+"_"+Ft.mc.c in Q.merge&&delete Q.merge[Ft.mc.r+"_"+Ft.mc.c],pe[ot][xt]=null}}if(Q.borderInfo&&Q.borderInfo.length>0){let ot=[];for(let xt=0;xt<Q.borderInfo.length;xt++){let Ft=Q.borderInfo[xt].rangeType;if(Ft=="range"){let Se=Q.borderInfo[xt].range,oe=[];for(let be=0;be<Se.length;be++)oe=oe.concat(Mt.CFSplitRange(Se[be],{row:ne.row,column:ne.column},{row:[we,ie],column:[ge,ce]},"restPart"));Q.borderInfo[xt].range=oe,ot.push(Q.borderInfo[xt])}else if(Ft=="cell"){let Se=Q.borderInfo[xt].value.row_index,oe=Q.borderInfo[xt].value.col_index;Se>=ne.row[0]&&Se<=ne.row[1]&&oe>=ne.column[0]&&oe<=ne.column[1]||ot.push(Q.borderInfo[xt])}}Q.borderInfo=ot}let Ne={};for(let ot=0;ot<me.length;ot++)for(let xt=0;xt<me[0].length;xt++){if(fe[ot+ne.row[0]+"_"+(xt+ne.column[0])]){let Se={rangeType:"cell",value:{row_index:ot+we,col_index:xt+ge,l:fe[ot+ne.row[0]+"_"+(xt+ne.column[0])].l,r:fe[ot+ne.row[0]+"_"+(xt+ne.column[0])].r,t:fe[ot+ne.row[0]+"_"+(xt+ne.column[0])].t,b:fe[ot+ne.row[0]+"_"+(xt+ne.column[0])].b}};Q.borderInfo==null&&(Q.borderInfo=[]),Q.borderInfo.push(Se)}let Ft="";if(me[ot]!=null&&me[ot][xt]!=null&&(Ft=me[ot][xt]),G(Ft)=="object"&&"mc"in Ft){let Se=$.extend(!0,{},Ft.mc);"rs"in Ft.mc?(Ne[Se.r+"_"+Se.c]=[ot+we,xt+ge],Ft.mc.r=ot+we,Ft.mc.c=xt+ge,Q.merge[ot+we+"_"+(xt+ge)]=Ft.mc):(Ft.mc.r=Ne[Se.r+"_"+Se.c][0],Ft.mc.c=Ne[Se.r+"_"+Se.c][1])}pe[ot+we][xt+ge]=Ft}ye&&(Q=Cn(pe,ne.row[0],ne.row[1],Q),Q=Cn(pe,we,ie,Q));let xe=$.extend(!0,[],h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save);if(xe!=null&&xe.length>0)for(let ot=0;ot<xe.length;ot++){let xt=xe[ot].cellrange,Ft=[];for(let Se=0;Se<xt.length;Se++){let oe=Mt.CFSplitRange(xt[Se],{row:ne.row,column:ne.column},{row:[we,ie],column:[ge,ce]},"allPart");Ft=Ft.concat(oe)}xe[ot].cellrange=Ft}let et;h.luckysheet_select_save[0].row_focus==h.luckysheet_select_save[0].row[0]?et=we:et=ie;let Fe;h.luckysheet_select_save[0].column_focus==h.luckysheet_select_save[0].column[0]?Fe=ge:Fe=ce;let it=[];it.push({row:ne.row,column:ne.column}),it.push({row:[we,ie],column:[ge,ce]}),ne.row=[we,ie],ne.column=[ge,ce],ne.row_focus=et,ne.column_focus=Fe,al(pe,it,{cfg:Q,RowlChange:ye,cdformat:xe}),gl(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){Nn()},500)}if(h.chart_selection.rangeMove&&h.chart_selection.rangeMoveDragged(),h.chart_selection.rangeResize&&h.chart_selection.rangeResizeDragged(),h.luckysheet_cell_selected_extend){if(h.luckysheet_cell_selected_extend=!1,$("#luckysheet-cell-selected-extend").hide(),!po(h.luckysheet_select_save,h.currentSheetIndex))return;let T=wl(p.pageX,p.pageY),O=$("#luckysheet-cell-main").scrollLeft(),z=$("#luckysheet-cell-main").scrollTop(),A=T[0]+O-5,E=T[1]+z-5,L=$(window).height()+z-h.sheetBarHeight-h.statisticBarHeight,N=$(window).width()+O,W=Jl(E),X=W[1],te=W[0],ue=W[2],pe=Zl(A),ne=pe[1],me=pe[0],Q=pe[2],we=h.luckysheet_cell_selected_extend_index[0],ie=h.luckysheet_cell_selected_extend_index[1],ge=h.luckysheet_select_save[h.luckysheet_select_save.length-1],ce=ge.row[0],fe=ge.row[1],ye=ge.column[0],Ne=ge.column[1];(ce<0||E<0)&&(ce=0,fe=ge.row[1]-ge.row[0]),(ye<0||A<0)&&(ye=0,Ne=ge.column[1]-ge.column[0]),(fe>=h.visibledatarow[h.visibledatarow.length-1]||E>L)&&(ce=h.visibledatarow.length-1-ge.row[1]+ge.row[0],fe=h.visibledatarow.length-1),(Ne>=h.visibledatacolumn[h.visibledatacolumn.length-1]||A>N)&&(ye=h.visibledatacolumn.length-1-ge.column[1]+ge.column[0],Ne=h.visibledatacolumn.length-1),Qr.copyRange={row:$.extend(!0,[],ge.row),column:$.extend(!0,[],ge.column)};let xe=Qr.typeItemHide();if(!xe[0]&&!xe[1]&&!xe[2]&&!xe[3]&&!xe[4]&&!xe[5]&&!xe[6]?Qr.applyType="0":Qr.applyType="1",Math.abs(we-ue)>Math.abs(ie-Q)){if(ue>=ce&&ue<=fe)return;if(h.luckysheet_select_save[0].top_move>=te){if(Qr.applyRange={row:[ue,ge.row[0]-1],column:ge.column},Qr.direction="up",ce-=ge.row[0]-ue,Yt.isPivotRange(ce,Ne)){ke.info(l.affectPivot,"");return}}else if(Qr.applyRange={row:[ge.row[1]+1,ue],column:ge.column},Qr.direction="down",fe+=ue-ge.row[1],Yt.isPivotRange(fe,Ne)){ke.info(l.affectPivot,"");return}}else{if(Q>=ye&&Q<=Ne)return;if(h.luckysheet_select_save[0].left_move>=me){if(Qr.applyRange={row:ge.row,column:[Q,ge.column[0]-1]},Qr.direction="left",ye-=ge.column[0]-Q,Yt.isPivotRange(fe,ye)){ke.info(l.affectPivot,"");return}}else if(Qr.applyRange={row:ge.row,column:[ge.column[1]+1,Q]},Qr.direction="right",Ne+=Q-ge.column[1],Yt.isPivotRange(fe,Ne)){ke.info(l.affectPivot,"");return}}if(h.config.merge!=null){let et=!1;for(let Fe=ge.row[0];Fe<=ge.row[1];Fe++)for(let it=ge.column[0];it<=ge.column[1];it++){let wt=h.flowdata[Fe][it];if(wt!=null&&wt.mc!=null){et=!0;break}}if(et){at()?alert(l.noMerge):ke.info(l.noMerge,"");return}for(let Fe=ce;Fe<=fe;Fe++)for(let it=ye;it<=Ne;it++){let wt=h.flowdata[Fe][it];if(wt!=null&&wt.mc!=null){et=!0;break}}if(et){at()?alert(l.noMerge):ke.info(l.noMerge,"");return}}ge.row=[ce,fe],ge.column=[ye,Ne],Qr.update(),Qr.createIcon(),$("#luckysheet-cell-selected-move").hide(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){Nn()},500)}}),$(".luckysheet-grid-container, #luckysheet-rightclick-menu").on("contextmenu",function(p){p.preventDefault()}),$("#luckysheet-cell-main div.luckysheet-cs-draghandle").mousedown(function(p){if(at()||h.allowEdit===!1)return;$("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","move").end().find(".luckysheet-cs-draghandle").css("cursor","move"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","move"),h.luckysheet_cell_selected_move=!0,h.luckysheet_scroll_status=!0;let b=wl(p.pageX,p.pageY),g=b[0]+$("#luckysheet-cell-main").scrollLeft(),v=b[1]+$("#luckysheet-cell-main").scrollTop(),x=Jl(v),_=x[0],S=x[1],I=x[2],P=Zl(g),F=P[0],D=P[1],k=P[2];h.luckysheet_cell_selected_move_index=[I,k],$("#luckysheet-cell-selected-move").css({left:F,width:D-F-1,top:_,height:S-_-1,display:"block"}),p.stopPropagation()}),$("#luckysheet-cell-main div.luckysheet-cs-fillhandle").mousedown(function(p){at()||h.allowEdit===!1||($("#luckysheet-cell-selected").find(".luckysheet-cs-fillhandle").css("cursor","crosshair").end().find(".luckysheet-cs-draghandle").css("cursor","crosshair"),$("#luckysheet-cell-main, #luckysheetTableContent, #luckysheet-sheettable_0").css("cursor","crosshair"),h.luckysheet_cell_selected_extend_time=setTimeout(function(){h.luckysheet_cell_selected_extend=!0,h.luckysheet_scroll_status=!0;let b=wl(p.pageX,p.pageY),g=b[0]+$("#luckysheet-cell-main").scrollLeft()-5,v=b[1]+$("#luckysheet-cell-main").scrollTop()-5,x=Jl(v),_=x[0],S=x[1],I=x[2],P=Zl(g),F=P[0],D=P[1],k=P[2];h.luckysheet_cell_selected_extend_index=[I,k],$("#luckysheet-cell-selected-extend").css({left:F,width:D-F-1,top:_,height:S-_-1,display:"block"})},100),p.stopPropagation())}).click(function(){clearTimeout(h.luckysheet_cell_selected_extend_time),event.stopPropagation()}).dblclick(function(){let p=h.luckysheet_select_save[0],b=p.row[0],g=p.row[1],v=p.column[0],x=p.column[1];if(Yt.isPivotRange(b,v))return;let _=!1,S=0;for(let P=g+1;P<h.flowdata.length;P++)if(v-1>=0&&x+1<h.flowdata[0].length){let F=h.flowdata[P][v-1],D=h.flowdata[P][x+1];if(P==g+1)if((F==null||ft(F.v))&&(D==null||ft(D.v))){_=!1;break}else _=!0,S++;else{if((F==null||ft(F.v))&&(D==null||ft(D.v)))break;S++}}else if(v-1>=0){let F=h.flowdata[P][v-1];if(P==g+1)if(F==null||ft(F.v)){_=!1;break}else _=!0,S++;else{if(F==null||ft(F.v))break;S++}}else if(x+1<h.flowdata[0].length){let F=h.flowdata[P][x+1];if(P==g+1)if(F==null||ft(F.v)){_=!1;break}else _=!0,S++;else{if(F==null||ft(F.v))break;S++}}if(!_||S==0){event.stopPropagation();return}Qr.copyRange={row:[b,g],column:[v,x]};let I=Qr.typeItemHide();!I[0]&&!I[1]&&!I[2]&&!I[3]&&!I[4]&&!I[5]&&!I[6]?Qr.applyType="0":Qr.applyType="1",Qr.applyRange={row:[g+1,g+S],column:[v,x]},Qr.direction="down",h.luckysheet_select_save=[{row:[b,g+S],column:[v,x]}],Qr.update(),Qr.createIcon(),$("#luckysheet-cell-selected-move").hide(),$("#luckysheet-sheettable").css("cursor","default"),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){Nn()},500),event.stopPropagation()}),$("#luckysheet-bottom-add-row, #luckysheet-bottom-add-row-input, #luckysheet-bottom-return-top").on("mousedown dblclick mouseup",function(p){p.stopPropagation()}),$("#luckysheet-bottom-add-row").on("click",function(p){$("#luckysheet-rightclick-menu").hide(),kl();let b=$(this),g=$("#luckysheet-bottom-add-row-input").val();if(g==""&&(g=ut.addRowCount||100),isNaN(parseInt(g))){at()?alert(o.tipInputNumber):ke.info("error",o.tipInputNumber);return}if(g=parseInt(g),g<1||g>100){at()?alert(o.tipInputNumberLimit):ke.info("error",o.tipInputNumberLimit);return}Ao("row",h.flowdata.length-1,g)}),$("#luckysheet-bottom-return-top").on("click",function(p){$("#luckysheet-scrollbar-y").scrollTop(0)}),$("#luckysheet-copy-btn, #luckysheet-cols-copy-btn, #luckysheet-paste-btn-title").click(function(p){if($(this).parent().hide(),h.config.merge!=null){let g=!1;for(let v=0;v<h.luckysheet_select_save.length;v++){let x=h.luckysheet_select_save[v].row[0],_=h.luckysheet_select_save[v].row[1],S=h.luckysheet_select_save[v].column[0],I=h.luckysheet_select_save[v].column[1];if(g=sr(h.config,x,_,S,I),g)break}if(g){at()?alert(l.noPartMerge):ke.info(l.noPartMerge,"");return}}let b=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save;if(h.luckysheet_select_save.length>1&&b!=null&&b.length>0){let g=!1,v=Mt.getComputeMap();e:for(let x=0;x<h.luckysheet_select_save.length&&!g;x++){let _=h.luckysheet_select_save[x].row[0],S=h.luckysheet_select_save[x].row[1],I=h.luckysheet_select_save[x].column[0],P=h.luckysheet_select_save[x].column[1];for(let F=_;F<=S;F++)for(let D=I;D<=P;D++)if(Mt.checksCF(F,D,v)!=null){g=!0;continue e}}if(g){at()?alert(l.noMulti):ke.info(l.noMulti,"");return}}if(h.luckysheet_select_save.length>1){let g=!0,v=h.luckysheet_select_save[0].row[0],x=h.luckysheet_select_save[0].row[1],_=!0,S=h.luckysheet_select_save[0].column[0],I=h.luckysheet_select_save[0].column[1];for(let P=1;P<h.luckysheet_select_save.length;P++)(h.luckysheet_select_save[P].row[0]!=v||h.luckysheet_select_save[P].row[1]!=x)&&(g=!1),(h.luckysheet_select_save[P].column[0]!=S||h.luckysheet_select_save[P].column[1]!=I)&&(_=!1);if(!g&&!_||na()){at()?alert(l.noMulti):ke.info(l.noMulti,"");return}}Ql.copy(p)}),$("#luckysheet-copy-paste, #luckysheet-cols-paste-btn, #luckysheet-paste-btn-title").click(function(p){Ql.paste(p,"btn"),$(this).parent().hide()}),$("#luckysheet-chart-btn-title").click(function(){hg()}),$("#luckysheetdatavisual").click(function(){hg(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheet-pivot-btn-title").click(function(p){!nr(h.currentSheetIndex,"usePivotTablereports")||Yt.createPivotTable(p)}),$("#luckysheet-chart-btn-screenshot").click(function(){let p=t.screenshot;if(h.luckysheet_select_save.length==0){at()?alert(p.screenshotTipNoSelection):ke.info(p.screenshotTipTitle,p.screenshotTipNoSelection);return}if(h.luckysheet_select_save.length>1){at()?alert(p.screenshotTipHasMulti):ke.info(p.screenshotTipTitle,p.screenshotTipHasMulti);return}if(h.config.merge!=null){let T=!1;for(let O=0;O<h.luckysheet_select_save.length;O++){let z=h.luckysheet_select_save[O].row[0],A=h.luckysheet_select_save[O].row[1],E=h.luckysheet_select_save[O].column[0],L=h.luckysheet_select_save[O].column[1];if(T=sr(h.config,z,A,E,L),T)break}if(T){at()?alert(p.screenshotTipHasMerge):ke.info(p.screenshotTipTitle,p.screenshotTipHasMerge);return}}let b=h.luckysheet_select_save[0].row[0],g=h.luckysheet_select_save[0].row[1],v=h.luckysheet_select_save[0].column[0],x=h.luckysheet_select_save[0].column[1],_,S;b-1<0?(_=0,S=h.visibledatarow[g]):(_=h.visibledatarow[b-1],S=h.visibledatarow[g]-h.visibledatarow[b-1]);let I,P;v-1<0?(I=0,P=h.visibledatacolumn[x]):(I=h.visibledatacolumn[v-1],P=h.visibledatacolumn[x]-h.visibledatacolumn[v-1]);let F=$("<canvas>").attr({width:Math.ceil(P*devicePixelRatio),height:Math.ceil(S*devicePixelRatio)}).css({width:P,height:S});Ki(I,_,P,S,1,1,null,null,F);let D=F.get(0).getContext("2d");D.beginPath(),D.moveTo(0,0),D.lineTo(0,h.devicePixelRatio*S),D.lineWidth=h.devicePixelRatio*2,D.strokeStyle=Kn.strokeStyle,D.stroke(),D.closePath(),D.beginPath(),D.moveTo(0,0),D.lineTo(h.devicePixelRatio*P,0),D.lineWidth=h.devicePixelRatio*2,D.strokeStyle=Kn.strokeStyle,D.stroke(),D.closePath();let k=new Image,w=F.get(0).toDataURL("image/png");k.src=w,P>S?k.style.width="100%":k.style.height="100%";let C=$(window).height()-200;ke.screenshot(p.screenshotTipSuccess,'<div id="luckysheet-confirm-screenshot-save" style="height:'+C+'px;overflow:auto;"></div>',w),$("#luckysheet-confirm-screenshot-save").append(k),F.remove()}),$(document).on("click.luckysheetEvent","a.download",function(){let p=$("#luckysheet-confirm-screenshot-save img").attr("src"),b=t.screenshot,g=atob(p.split(",")[1]),v=g.length,x=new Uint8Array(v);for(let P=0;P<v;P++)x[P]=g.charCodeAt(P);let _=new Blob([x]),S=document.createElement("a");S.setAttribute("href",URL.createObjectURL(_)),S.setAttribute("download",b.screenshotImageName+".png"),S.style.display="none",document.body.appendChild(S),S.click();let I;S.addEventListener("click",I=function(){requestAnimationFrame(function(){URL.revokeObjectURL(S.href)}),S.removeAttribute("href"),S.removeEventListener("click",I)}),document.body.removeChild(S)}),$("#luckysheet-splitColumn-btn-title").click(function(){if(!ea(h.currentSheetIndex)||h.luckysheet_select_save==null||h.luckysheet_select_save.length==0)return;let p=t.splitText;if(h.luckysheet_select_save.length>1){ke.info(p.tipNoMulti,"");return}if(h.luckysheet_select_save[0].column[0]!=h.luckysheet_select_save[0].column[1]){ke.info(p.tipNoMultiColumn,"");return}jg.createDialog(),jg.init()}),$("#luckysheet-insertImg-btn-title").click(function(){if(!yi()){ke.info("",Be().pivotTable.errorNotAllowEdit);return}!nr(h.currentSheetIndex,"editObjects")||$("#luckysheet-imgUpload").click()}),$("#luckysheetInsertImage").click(function(){!nr(h.currentSheetIndex,"editObjects")||($("#luckysheet-imgUpload").click(),$("#luckysheet-rightclick-menu").hide())}),$("#luckysheet-imgUpload").click(function(p){p.stopPropagation()}),$("#luckysheet-imgUpload").on("change",function(p){if(!nr(h.currentSheetIndex,"editObjects",!1))return;let b=p.currentTarget.files[0];Pt.insertImg(b)}),$("#luckysheet-insertLink-btn-title").click(function(){if(!yi()){ke.info("",Be().pivotTable.errorNotAllowEdit);return}!ea(h.currentSheetIndex)||h.luckysheet_select_save==null||h.luckysheet_select_save.length==0||(ei.createDialog(),ei.init())}),$("#luckysheetInsertLink").click(function(){$("#luckysheet-insertLink-btn-title").click(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheet-dataVerification-btn-title").click(function(){!ea(h.currentSheetIndex)||h.luckysheet_select_save==null||h.luckysheet_select_save.length==0||(ll.createDialog(),ll.init())}),$("#luckysheetDataVerification").click(function(){$("#luckysheet-dataVerification-btn-title").click(),$("#luckysheet-rightclick-menu").hide()}),$("#luckysheetCellFormatRightClickMenu").click(function(){J1()}),$("#luckysheet-freezen-btn-horizontal").click(function(){$.trim($(this).text())==Be().freezen.freezenCancel?(Ie.saveFrozen("freezenCancel"),Ie.freezenverticaldata!=null&&(Ie.cancelFreezenVertical(),Ie.createAssistCanvas(),Xt()),Ie.freezenhorizontaldata!=null&&(Ie.cancelFreezenHorizontal(),Ie.createAssistCanvas(),Xt()),Ie.scrollAdapt(),$("#luckysheet-icon-freezen-menu-menuButton").find(".fa.fa-check").remove()):(Ie.saveFrozen("freezenRow"),Ie.freezenverticaldata!=null&&(Ie.cancelFreezenVertical(),Ie.createAssistCanvas(),Xt()),Ie.freezenhorizontaldata==null&&(Ie.createFreezenHorizontal(),Ie.createAssistCanvas()))}),$("#luckysheet-freezen-btn-vertical").click(function(){Ie.freezenverticaldata!=null?(Ie.saveFrozen("freezenCancel"),Ie.cancelFreezenVertical(),Xt()):(Ie.saveFrozen("freezenColumn"),Ie.createFreezenVertical()),Ie.createAssistCanvas()}),$("#luckysheet-rightclick-menu input").on("keydown",function(p){p.stopPropagation()}),$("#luckysheet-modal-dialog-mask").on("click dbclick mousedown mousemove mouseup",function(p){p.stopPropagation(),p.preventDefault()});let f=function(){(document.hidden||document.webkitHidden||document.msHidden)&&(h.iscopyself=!1)};$(document).on("visibilitychange.luckysheetEvent webkitvisibilitychange.luckysheetEvent msvisibilitychange.luckysheetEvent",f).on("mouseleave.luckysheetEvent",function(){h.iscopyself=!1}).on("mousedown.luckysheetEvent",function(p){Zt.removeActivePs(),Ro(p),$(p.target).closest("#luckysheet-wa-editor").length>0&&parseInt($("#luckysheet-input-box").css("top"))>0&&(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("down",0,"rangeOfSelect"))}),$("#luckysheet-left-top").click(function(p){!of(h.currentSheetIndex)||($("#luckysheet-wa-functionbox-confirm").click(),h.luckysheet_select_status=!1,h.luckysheet_select_save=[{row:[0,h.flowdata.length-1],column:[0,h.flowdata[0].length-1],row_focus:0,column_focus:0,row_select:!0,column_select:!0}],gl(),clearTimeout(h.countfuncTimeout),h.countfuncTimeout=setTimeout(function(){Nn()},500),Ue.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save),p.stopPropagation())}),$("#luckysheet-icon-undo").click(function(p){$(this).hasClass("disabled")||ns.redo(p)}),$("#luckysheet-icon-redo").click(function(p){$(this).hasClass("disabled")||ns.undo(p)}),$(document).on("mousedown.luckysheetEvent","div.luckysheet-modal-dialog",function(p){if(!$(p.target).is(".luckysheet-modal-dialog"))return;h.luckysheet_model_move_state=!0,h.luckysheet_model_move_obj=$(p.currentTarget);let b=h.luckysheet_model_move_obj.offset();h.luckysheet_model_xy=[p.pageX-b.left,p.pageY-b.top]}),$(document).on("click.luckysheetEvent",".luckysheet-modal-dialog-title-close, .luckysheet-model-close-btn",function(p){($("#textcolorselect").is(":visible")||$("#cellcolorselect").is(":visible"))&&$("#luckysheet-conditionformat-dialog").show(),$(p.currentTarget).parents(".luckysheet-modal-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide(),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula")&&(y.dontupdate(),Cr("down",0,"rangeOfSelect")),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula-parm")&&(y.dontupdate(),Cr("down",0,"rangeOfSelect")),$(this).parents(".luckysheet-modal-dialog").hasClass("luckysheet-search-formula-parm-select")&&(y.dontupdate(),Cr("down",0,"rangeOfSelect")),kl()}),$("#luckysheet_info_detail_title").click(function(){window.open(ut.myFolderUrl,"_self")}),$("#luckysheet-chart-rangeShow").on("mousedown.chartRangeShowMove",".luckysheet-chart-rangeShow-move",function(p){h.chart_selection.rangeMove=!0,h.luckysheet_scroll_status=!0,h.chart_selection.rangeMoveObj=$(this).parent();let b=h.currentChart,g=$(this).parent().attr("id");if(g=="luckysheet-chart-rangeShow-content"){let F=b.rangeArray[0].row[0]+b.rangeSplitArray.content.row[0],D=b.rangeArray[0].column[0]+b.rangeSplitArray.content.column[0];h.chart_selection.rangeMoveIndex=[F,D]}else if(g=="luckysheet-chart-rangeShow-rowtitle"){let F=b.rangeArray[0].row[0]+b.rangeSplitArray.rowtitle.row[0],D=b.rangeArray[0].column[0]+b.rangeSplitArray.rowtitle.column[0];h.chart_selection.rangeMoveIndex=[F,D]}else if(g=="luckysheet-chart-rangeShow-coltitle"){let F=b.rangeArray[0].row[0]+b.rangeSplitArray.coltitle.row[0],D=b.rangeArray[0].column[0]+b.rangeSplitArray.coltitle.column[0];h.chart_selection.rangeMoveIndex=[F,D]}let v=wl(p.pageX,p.pageY),x=v[0]+$("#luckysheet-cell-main").scrollLeft(),_=v[1]+$("#luckysheet-cell-main").scrollTop(),S=$(this).data("type");S=="top"?_+=3:S=="right"?x-=3:S=="bottom"?_-=3:S=="left"&&(x+=3);let I=Jl(_)[2],P=Zl(x)[2];h.chart_selection.rangeMovexy=[I,P],p.stopPropagation()}),$("#luckysheet-chart-rangeShow").on("mousedown.chartRangeShowResize",".luckysheet-chart-rangeShow-resize",function(p){h.chart_selection.rangeResize=$(this).data("type"),h.luckysheet_scroll_status=!0,h.chart_selection.rangeResizeObj=$(this).parent();let b=h.currentChart,g,v,x,_,S=$(this).parent().attr("id");if(S=="luckysheet-chart-rangeShow-content")b.rangeRowCheck.exits?(g=b.rangeArray[0].row[0]+b.rangeSplitArray.content.row[0],v=b.rangeArray[0].row[0]+b.rangeSplitArray.content.row[1]):(g=b.rangeSplitArray.content.row[0],v=b.rangeSplitArray.content.row[0]),b.rangeColCheck.exits?(x=b.rangeArray[0].column[0]+b.rangeSplitArray.content.column[0],_=b.rangeArray[0].column[0]+b.rangeSplitArray.content.column[1]):(x=b.rangeSplitArray.content.column[0],_=b.rangeSplitArray.content.column[1]),h.chart_selection.rangeResizeIndex={row:[g,v],column:[x,_]};else if(S=="luckysheet-chart-rangeShow-rowtitle"){let w=b.rangeArray[0].row[0]+b.rangeSplitArray.rowtitle.row[0],C=b.rangeArray[0].row[0]+b.rangeSplitArray.rowtitle.row[1],T=b.rangeArray[0].column[0]+b.rangeSplitArray.rowtitle.column[0],O=b.rangeArray[0].column[0]+b.rangeSplitArray.rowtitle.column[1];h.chart_selection.rangeResizeIndex={row:[w,C],column:[T,O]}}else if(S=="luckysheet-chart-rangeShow-coltitle"){let w=b.rangeArray[0].row[0]+b.rangeSplitArray.coltitle.row[0],C=b.rangeArray[0].row[0]+b.rangeSplitArray.coltitle.row[1],T=b.rangeArray[0].column[0]+b.rangeSplitArray.coltitle.column[0],O=b.rangeArray[0].column[0]+b.rangeSplitArray.coltitle.column[1];h.chart_selection.rangeResizeIndex={row:[w,C],column:[T,O]}}let I=wl(p.pageX,p.pageY),P=I[0]+$("#luckysheet-cell-main").scrollLeft(),F=I[1]+$("#luckysheet-cell-main").scrollTop();h.chart_selection.rangeResize=="lt"?(P+=3,F+=3):h.chart_selection.rangeResize=="lb"?(P+=3,F-=3):h.chart_selection.rangeResize=="rt"?(P-=3,F+=3):h.chart_selection.rangeResize=="rb"&&(P-=3,F-=3);let D=Jl(F)[2],k=Zl(P)[2];h.chart_selection.rangeResizexy=[D,k],p.stopPropagation()}),$("#luckysheet-wa-calculate-size").mousedown(function(p){let b=p.pageY;y.functionResizeData.y=b,y.functionResizeStatus=!0,y.functionResizeData.calculatebarHeight=h.calculatebarHeight,y.rangetosheet!=null&&y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1])}),_t.initialMenuButton();let m=document.getElementById("testdpidiv").offsetWidth*h.devicePixelRatio,d=document.getElementById("testdpidiv").offsetHeight*h.devicePixelRatio;$(document).on("paste.luckysheetEvent",function(p){if(!at()){if(Ql.isPasteAction){$("#luckysheet-rich-text-editor").blur(),Ql.isPasteAction=!1;let b=window.clipboardData;b||(b=p.originalEvent.clipboardData);let g=b.getData("text/html")||b.getData("text/plain"),v=!0;if(g.indexOf("luckysheet_copy_action_table")>-1&&h.luckysheet_copy_save.copyRange!=null&&h.luckysheet_copy_save.copyRange.length>0){let _=[],S=new RegExp("<tr.*?>(.*?)</tr>","gs"),I=new RegExp("<td.*?>(.*?)</td>","gs"),P=g.match(S)||[];for(let O=0;O<P.length;O++){let z=[],A=P[O].match(I);if(A!=null)for(let E=0;E<A.length;E++){let L=A[E].replace(/<td.*?>/gs,"").replace(/<\/td>/gs,"");z.push(L)}_.push(z)}let F=h.luckysheet_copy_save.copyRange[0].row[0],D=h.luckysheet_copy_save.copyRange[0].row[1],k=h.luckysheet_copy_save.copyRange[0].column[0],w=h.luckysheet_copy_save.copyRange[0].column[1],C=h.luckysheet_copy_save.dataSheetIndex,T;C==h.currentSheetIndex?T=It.deepCopyFlowData(h.flowdata):T=h.luckysheetfile[Me(C)].data;for(let O=F;O<=D&&!(O-F>_.length-1);O++)for(let z=k;z<=w;z++){let A=T[O][z],E=!1;if(A!=null&&A.mc!=null&&A.mc.rs==null)continue;let L;if(A!=null?A.ct!=null&&A.ct.fa.indexOf("w")>-1?L=T[O][z].v:L=T[O][z].m:L="",L==null&&T[O][z]&&T[O][z].ct&&T[O][z].ct.t=="inlineStr"&&(L=T[O][z].ct.s.map(N=>N.v).join(""),E=!0),L==null&&(L=""),E){let N=$(_[O-F][z-k]).text().replace(/\s|\n/g," "),W=L.replace(/\n/g,"").replace(/\s/g," ");if(N!=W){v=!1;break}}else if(_[O-F][z-k]!=L){v=!1;break}}}let x=Be().fontjson;if(!sl.createHookFunction("rangePasteBefore",h.luckysheet_select_save,g))return;if(g.indexOf("luckysheet_copy_action_table")>-1&&h.luckysheet_copy_save.copyRange!=null&&h.luckysheet_copy_save.copyRange.length>0&&v)h.luckysheet_paste_iscut?(h.luckysheet_paste_iscut=!1,Ql.pasteHandlerOfCutPaste(h.luckysheet_copy_save),Ql.clearcopy(p)):Ql.pasteHandlerOfCopyPaste(h.luckysheet_copy_save);else if(g.indexOf("luckysheet_copy_action_image")>-1)Pt.pasteImgItem();else if(g.indexOf("table")>-1){$("#luckysheet-copy-content").html(g);let _=new Array($("#luckysheet-copy-content").find("table tr").length),S=0,I="th, td";$("#luckysheet-copy-content").find("table tr").eq(0).find(I).each(function(){let D=parseInt($(this).attr("colspan"));isNaN(D)&&(D=1),S+=D});for(let D=0;D<_.length;D++)_[D]=new Array(S);let P=0,F={};$("#luckysheet-copy-content").find("table tr").each(function(){let D=$(this),k=0;D.find(I).each(function(){let w=$(this),C={},T=w.text();if($.trim(T).length==0)C.v=null,C.m="";else{let pe=_l(w.text());C.v=pe[2],C.ct=pe[1],C.m=pe[0]}let O=w.css("background-color");O=="rgba(0, 0, 0, 0)"&&(O=null),C.bg=O;let z=w.css("font-weight");z==400||z=="normal"?C.bl=0:C.bl=1,w.css("text-decoration").indexOf("underline")!=-1&&(C.un=1),w.css("font-style")=="normal"?C.it=0:C.it=1;let N=w.css("font-family").split(",");for(let pe=0;pe<N.length;pe++){let ne=$.trim(N[pe].toLowerCase());if(ne=x[ne],ne==null)C.ff=0;else{C.ff=ne;break}}let W=Math.round(parseInt(w.css("font-size"))*72/96);C.fs=W;let X=w.css("color");C.fc=X;let te=w.css("text-align");te=="center"?C.ht=0:te=="right"?C.ht=2:C.ht=1;let ue=w.css("vertical-align");for(ue=="middle"?C.vt=0:ue=="top"||ue=="text-top"?C.vt=1:C.vt=2;k<S&&_[P][k]!=null;)k++;if(k==S)return!0;if(_[P][k]==null){_[P][k]=C;let pe=parseInt(w.attr("rowspan")),ne=parseInt(w.attr("colspan"));isNaN(pe)&&(pe=1),isNaN(ne)&&(ne=1);let me=h.luckysheet_select_save[0].row[0]+P,Q=h.luckysheet_select_save[0].column[0]+k;for(let we=0;we<pe;we++)for(let ie=0;ie<ne;ie++){if(we==0){let ge=w.css("border-top");if(ge!=null&&ge.length>0&&ge.substr(0,3).toLowerCase()!="0px"){let ce=w.css("border-top-width"),fe=w.css("border-top-style"),ye=w.css("border-top-color"),Ne=_t.getQKBorder(ce,fe,ye);F[P+we+"_"+(k+ie)]==null&&(F[P+we+"_"+(k+ie)]={}),F[P+we+"_"+(k+ie)].t={style:Ne[0],color:Ne[1]}}}if(we==pe-1){let ge=w.css("border-bottom");if(ge!=null&&ge.length>0&&ge.substr(0,3).toLowerCase()!="0px"){let ce=w.css("border-bottom-width"),fe=w.css("border-bottom-style"),ye=w.css("border-bottom-color"),Ne=_t.getQKBorder(ce,fe,ye);F[P+we+"_"+(k+ie)]==null&&(F[P+we+"_"+(k+ie)]={}),F[P+we+"_"+(k+ie)].b={style:Ne[0],color:Ne[1]}}}if(ie==0){let ge=w.css("border-left");if(ge!=null&&ge.length>0&&ge.substr(0,3).toLowerCase()!="0px"){let ce=w.css("border-left-width"),fe=w.css("border-left-style"),ye=w.css("border-left-color"),Ne=_t.getQKBorder(ce,fe,ye);F[P+we+"_"+(k+ie)]==null&&(F[P+we+"_"+(k+ie)]={}),F[P+we+"_"+(k+ie)].l={style:Ne[0],color:Ne[1]}}}if(ie==ne-1){let ge=w.css("border-right");if(ge!=null&&ge.length>0&&ge.substr(0,3).toLowerCase()!="0px"){let ce=w.css("border-right-width"),fe=w.css("border-right-style"),ye=w.css("border-right-color"),Ne=_t.getQKBorder(ce,fe,ye);F[P+we+"_"+(k+ie)]==null&&(F[P+we+"_"+(k+ie)]={}),F[P+we+"_"+(k+ie)].r={style:Ne[0],color:Ne[1]}}}we==0&&ie==0||(_[P+we][k+ie]={mc:{r:me,c:Q}})}if(pe>1||ne>1){let we={rs:pe,cs:ne,r:me,c:Q};_[P][k].mc=we}}if(k++,k==S)return!0}),P++}),h.luckysheet_selection_range=[],Ql.pasteHandler(_,F),$("#luckysheet-copy-content").empty()}else if(b.files.length==1&&b.files[0].type.indexOf("image")>-1){Pt.insertImg(b.files[0]);return}else g=b.getData("text/plain"),Ql.pasteHandler(g)}else if($(p.target).closest("#luckysheet-rich-text-editor").length>0){p.preventDefault();let b=window.clipboardData;b||(b=p.originalEvent.clipboardData);let g=b.getData("text/plain");document.execCommand("insertText",!1,g)}}}),ut.enablePage&&$("#luckysheet-bottom-page-next").click(function(){let p=ut.pageInfo.queryExps,b=ut.pageInfo.reportId,g=ut.pageInfo.fields,v=ut.pageInfo.mobile,x=ut.pageInfo.frezon,_=ut.pageInfo.currentPage,S=ut.pageInfo.totalPage,I=ut.pageInfo.pageUrl;sl.addDataAjax({queryExps:p,reportId:b,fields:g,mobile:v,frezon:x,pageIndex:_,currentPage:_},h.currentSheetIndex,I,function(){if(ut.pageInfo.currentPage++,ut.pageInfo.totalPage==ut.pageInfo.currentPage){$("#luckysheet-bottom-page-next").hide();let P=Tt(o.pageInfoFull,{total:ut.total,totalPage:ut.pageInfo.totalPage});$("#luckysheet-bottom-page-info").html(P)}else{let P=Tt(o.pageInfo,{total:ut.total,totalPage:ut.pageInfo.totalPage,currentPage:ut.pageInfo.currentPage});$("#luckysheet-bottom-page-info").html(P)}})}).mousedown(function(p){p.stopPropagation()}),$("#luckysheet-bottom-bottom-top").click(function(){$("#luckysheet-scrollbar-y").scrollTop(0)}).mousedown(function(p){p.stopPropagation()}),$("#luckysheet-wa-editor,#luckysheet-icon-morebtn-div,.luckysheet-toolbar-button").click(function(p){this.id!="luckysheet-icon-paintformat"&&_t.luckysheetPaintModelOn&&_t.cancelPaintModel()})}function v_(){let e=tl(".luckysheet-multipleRange-show");e.length===void 0&&(e=[e]),e.forEach(n=>{let t=n.id.replace("luckysheet-multipleRange-show-","");h.cooperativeEdit.usernameTimeout["user"+t]===null&&(tl(".username",n).style.display="none")})}var import_plugin,tk=Nt(()=>{import_plugin=qe(Ye());Y1();Vn();Di();_a();Nm();ta();Qo();nu();go();ln();mo();Jc();Pg();kn();qr();gc();Go();ho();Kc();jr();ou();zh();X1();Ga();Rr();hi();Q1();Ol();fr();Ri();fo();cr();Xc();Oc();Sr();sc();ek();Ar();Er();Kr();Wr();ui();wi();tu();Sh();Xl();il();Rh()});function lk(){let e=Be().drag;$("#luckysheet-copy-json-head").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}if(h.config.merge!=null){let a=!1;for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].row[0],f=h.luckysheet_select_save[s].row[1],m=h.luckysheet_select_save[s].column[0],d=h.luckysheet_select_save[s].column[1];if(a=sr(h.config,u,f,m,d),a)break}if(a){at()?alert(e.noPartMerge):ke.info(e.noPartMerge,"");return}}let l=hr(h.luckysheet_select_save[0]),o=[];if(l.length!=0){if(l.length==1){let a={};for(let s=0;s<l[0].length;s++)a[Vt(0,s,l)]="";o.push(a)}else for(let a=1;a<l.length;a++){let s={};for(let u=0;u<l[0].length;u++)Vt(0,u,l)==null?s[""]=Vt(a,u,l):s[Vt(0,u,l)]=Vt(a,u,l);o.push(s)}Ql.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-copy-json-nohead").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}if(h.config.merge!=null){let s=!1;for(let u=0;u<h.luckysheet_select_save.length;u++){let f=h.luckysheet_select_save[u].row[0],m=h.luckysheet_select_save[u].row[1],d=h.luckysheet_select_save[u].column[0],p=h.luckysheet_select_save[u].column[1];if(s=sr(h.config,f,m,d,p),s)break}if(s){at()?alert(e.noPartMerge):ke.info(e.noPartMerge,"");return}}let l=hr(h.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=h.luckysheet_select_save[0].column[0];for(let s=0;s<l.length;s++){let u={};for(let f=0;f<l[0].length;f++)u[yl(f+a)]=Vt(s,f,l);o.push(u)}Ql.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-array1").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}if(h.config.merge!=null){let a=!1;for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].row[0],f=h.luckysheet_select_save[s].row[1],m=h.luckysheet_select_save[s].column[0],d=h.luckysheet_select_save[s].column[1];if(a=sr(h.config,u,f,m,d),a)break}if(a){at()?alert(e.noPartMerge):ke.info(e.noPartMerge,"");return}}let l=hr(h.luckysheet_select_save[0]),o=[];if(l.length!=0){for(let a=0;a<l.length;a++)for(let s=0;s<l[0].length;s++)o.push(Vt(a,s,l));Ql.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-copy-array2").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}if(h.config.merge!=null){let a=!1;for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].row[0],f=h.luckysheet_select_save[s].row[1],m=h.luckysheet_select_save[s].column[0],d=h.luckysheet_select_save[s].column[1];if(a=sr(h.config,u,f,m,d),a)break}if(a){at()?alert(e.noPartMerge):ke.info(e.noPartMerge,"");return}}let l=hr(h.luckysheet_select_save[0]),o=[];if(l.length!=0){for(let a=0;a<l.length;a++){let s=[];for(let u=0;u<l[0].length;u++)s.push(Vt(a,u,l));o.push(s)}Ql.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-copy-arraymore-confirm").click(function(t){if(t.target.nodeName==="INPUT")return;if($("body .luckysheet-cols-menu").hide(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}if(h.config.merge!=null){let d=!1;for(let p=0;p<h.luckysheet_select_save.length;p++){let b=h.luckysheet_select_save[p].row[0],g=h.luckysheet_select_save[p].row[1],v=h.luckysheet_select_save[p].column[0],x=h.luckysheet_select_save[p].column[1];if(d=sr(h.config,b,g,v,x),d)break}if(d){at()?alert(e.noPartMerge):ke.info(e.noPartMerge,"");return}}let l=hr(h.luckysheet_select_save[0]),o=[];if(l.length==0)return;for(let d=0;d<l.length;d++)for(let p=0;p<l[0].length;p++)o.push(l[d][p]);let a=$("#luckysheet-copy-arraymore-row").val(),s=$("#luckysheet-copy-arraymore-col").val();if(a==""&&s==""){Ql.copybyformat(t,JSON.stringify(o)),$("body .luckysheet-cols-menu").hide();return}if(a==""?a=1:(a=parseInt(a),a==null&&(a=1)),s==""?s=1:(s=parseInt(s),s==null&&(s=1)),a.toString()=="NaN"||s.toString()=="NaN"){at()?alert(e.inputCorrect):ke.info(e.inputCorrect,"");return}if(a<1||s<1){at()?alert(e.notLessOne):ke.info(e.notLessOne,"");return}let u=o.length,f=0,m=[];for(let d=0;d<a;d++){let p=[];for(let b=0;b<s;b++)if(p.push(o[f++]),f>=u){Ql.copybyformat(t,JSON.stringify(m)),$("body .luckysheet-cols-menu").hide();return}m.push(p)}Ql.copybyformat(t,JSON.stringify(m))}),$("#luckysheet-copy-diagonal").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}if(h.config.merge!=null){let s=!1;for(let u=0;u<h.luckysheet_select_save.length;u++){let f=h.luckysheet_select_save[u].row[0],m=h.luckysheet_select_save[u].row[1],d=h.luckysheet_select_save[u].column[0],p=h.luckysheet_select_save[u].column[1];if(s=sr(h.config,f,m,d,p),s)break}if(s){at()?alert(e.noPartMerge):ke.info(e.noPartMerge,"");return}}let l=hr(h.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=l[0].length;for(let s=0;s<l.length&&!(s>=a);s++)o.push(l[s][s]);Ql.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-antidiagonal").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}if(h.config.merge!=null){let s=!1;for(let u=0;u<h.luckysheet_select_save.length;u++){let f=h.luckysheet_select_save[u].row[0],m=h.luckysheet_select_save[u].row[1],d=h.luckysheet_select_save[u].column[0],p=h.luckysheet_select_save[u].column[1];if(s=sr(h.config,f,m,d,p),s)break}if(s){at()?alert(e.noPartMerge):ke.info(e.noPartMerge,"");return}}let l=hr(h.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=l[0].length;for(let s=0;s<l.length&&!(s>=a);s++)o.push(l[s][a-s-1]);Ql.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-diagonaloffset").click(function(t){if(t.target.nodeName==="INPUT")return;if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}if(h.config.merge!=null){let u=!1;for(let f=0;f<h.luckysheet_select_save.length;f++){let m=h.luckysheet_select_save[f].row[0],d=h.luckysheet_select_save[f].row[1],p=h.luckysheet_select_save[f].column[0],b=h.luckysheet_select_save[f].column[1];if(u=sr(h.config,m,d,p,b),u)break}if(u){at()?alert(e.noPartMerge):ke.info(e.noPartMerge,"");return}}let l=hr(h.luckysheet_select_save[0]),o=[];if(l.length==0)return;let a=l[0].length,s=parseInt($("#luckysheet-copy-diagonaloffset-value").val());if(s.toString()=="NaN"){at()?alert(e.inputCorrect):ke.info(e.inputCorrect,"");return}if(s<0){at()?alert(e.offsetColumnLessZero):ke.info(e.offsetColumnLessZero,"");return}s==null&&(s=1);for(let u=0;u<l.length&&!(u+s>=a);u++)o.push(l[u][u+s]);Ql.copybyformat(t,JSON.stringify(o))}),$("#luckysheet-copy-boolvalue").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}if(h.config.merge!=null){let a=!1;for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].row[0],f=h.luckysheet_select_save[s].row[1],m=h.luckysheet_select_save[s].column[0],d=h.luckysheet_select_save[s].column[1];if(a=sr(h.config,u,f,m,d),a)break}if(a){at()?alert(e.noPartMerge):ke.info(e.noPartMerge,"");return}}let l=hr(h.luckysheet_select_save[0]),o=[];if(l.length!=0){for(let a=0;a<l.length;a++){let s=[];for(let u=0;u<l[0].length;u++){let f=!1,m;G(l[a][u])=="object"?m=l[a][u].v:m=l[a][u],m==null||m==""?f=!1:(m=parseInt(m),m==null||m>0?f=!0:f=!1),s.push(f)}o.push(s)}Ql.copybyformat(t,JSON.stringify(o))}}),$("#luckysheet-matrix-turn-up").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}let l=hr(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=l.length-1;a>=0;a--){let s=[];for(let u=0;u<l[0].length;u++){let f="";l[a]!=null&&l[a][u]!=null&&(f=l[a][u]),s.push(f)}o.push(s)}It.controlHandler(o)}),$("#luckysheet-matrix-turn-left").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}let l=hr(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=0;a<l.length;a++){let s=[];for(let u=l[0].length-1;u>=0;u--){let f="";l[a]!=null&&l[a][u]!=null&&(f=l[a][u]),s.push(f)}o.push(s)}It.controlHandler(o)}),$("#luckysheet-matrix-turn-cw").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}let l=hr(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=0;a<l[0].length;a++){let s=[];for(let u=l.length-1;u>=0;u--){let f="";l[u]!=null&&l[u][a]!=null&&(f=l[u][a]),s.push(f)}o.push(s)}It.controlHandlerD(o)}),$("#luckysheet-matrix-turn-anticw").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}let l=hr(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=l[0].length-1;a>=0;a--){let s=[];for(let u=0;u<l.length;u++){let f="";l[u]!=null&&l[u][a]!=null&&(f=l[u][a]),s.push(f)}o.push(s)}It.controlHandlerD(o)}),$("#luckysheet-matrix-turn-trans").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}let l=hr(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[];for(let a=0;a<l[0].length;a++){let s=[];for(let u=0;u<l.length;u++){let f="";l[u]!=null&&l[u][a]!=null&&(f=l[u][a]),s.push(f)}o.push(s)}It.controlHandlerD(o)});let n=function(t,l){if(t==0)return 0;let o,a;for(o=t,a=(l-1)*o/l+t/(Math.pow(o,l-1)*l);Math.abs(a-o)>1e-6;)o=a,a=(l-1)*o/l+t/(Math.pow(o,l-1)*l);return a};$("#luckysheet-matrix-cal-confirm").click(function(t){if(t.target.nodeName==="INPUT"||t.target.nodeName==="SELECT")return;if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}let l=hr(h.luckysheet_select_save[0]);if(l.length==0)return;let o=$("#luckysheet-matrix-cal-type").val(),a=parseInt($("#luckysheet-matrix-cal-value").val());if(a.toString()=="NaN"){at()?alert(e.inputCorrect):ke.info(e.inputCorrect,"");return}a==null&&(a=2);let s=[];for(let u=0;u<l.length;u++){let f=[];for(let m=0;m<l[0].length;m++){let d="";l[u]!=null&&l[u][m]!=null&&(d=l[u][m],parseInt(d)!=null&&l[u][m].ct!=null&&l[u][m].ct.t=="n"&&(o=="minus"?d.v=d.v-a:o=="multiply"?d.v=d.v*a:o=="divided"?d.v=Qn(d.v/a,4):o=="power"?d.v=Math.pow(d.v,a):o=="root"?a==2?d.v=Qn(Math.sqrt(d.v),4):a==3&&Math.cbrt?d.v=Qn(Math.cbrt(d.v),4):d.v=Qn(n(d.v,a),4):o=="log"?d.v=Qn(Math.log(d.v)*1e4/Math.log(Math.abs(a)),4):d.v=d.v+a,d.v==null?d.m="":d.m=d.v.toString())),f.push(d)}s.push(f)}It.controlHandler(s)}),$("#luckysheet-matrix-delezero-row").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}let l=hr(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l[0].length;for(let s=0;s<l.length;s++){let u=[],f=!0,m=!0;for(let p=0;p<a;p++){let b="";if(l[s]!=null&&l[s][p]!=null){if(b=l[s][p],(b.v=="0"||b.v==0)&&f)continue;f=!1}u.push(b)}let d=[];if(u.length==a)d=u;else{for(let b=u.length-1;b>=0;b--){let g="";if(u[b]!=null){if(g=u[b],(g.v=="0"||g.v==0)&&m)continue;m=!1}d.unshift(g)}let p=a-d.length;for(let b=0;b<p;b++)d.push("")}o.push(d)}It.controlHandler(o)}),$("#luckysheet-matrix-delezero-column").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}let l=hr(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l.length,s=l[0].length;for(let f=0;f<s;f++){let m=[],d=!0,p=!0;for(let g=0;g<a;g++){let v="";if(l[g]!=null&&l[g][f]!=null){if(v=l[g][f],(v.v=="0"||v.v==0)&&d)continue;d=!1}m.push(v)}let b=[];if(m.length==a)b=m;else{for(let v=m.length-1;v>=0;v--){let x="";if(m[v]!=null){if(x=m[v],(x.v=="0"||x.v==0)&&p)continue;p=!1}b.unshift(x)}let g=a-b.length;for(let v=0;v<g;v++)b.push("")}o.push(b)}let u=[];for(let f=0;f<o[0].length;f++){let m=[];for(let d=0;d<o.length;d++){let p="";o[d]!=null&&o[d][f]!=null&&(p=o[d][f]),m.push(p)}u.push(m)}It.controlHandler(u)}),$("#luckysheet-matrix-delerpt-row").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}let l=hr(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l[0].length;for(let s=0;s<l.length;s++){let u=[],f={};for(let d=0;d<a;d++){let p=null;l[s]!=null&&l[s][d]!=null&&(p=l[s][d],p.v in f||(f[p.v]=[]),f[p.v].push(p))}for(let d=0;d<a;d++){let p=null;l[s]!=null&&l[s][d]!=null&&(p=l[s][d],f[p.v].length==1&&u.push(p))}let m=a-u.length;for(let d=0;d<m;d++)u.push(null);o.push(u)}It.controlHandler(o)}),$("#luckysheet-matrix-delerpt-column").click(function(t){if($("body .luckysheet-cols-menu").hide(),kl(),h.luckysheet_select_save.length>1){at()?alert(e.noMulti):ke.info(e.noMulti,"");return}let l=hr(h.luckysheet_select_save[0]);if(l.length==0)return;let o=[],a=l.length,s=l[0].length;for(let f=0;f<s;f++){let m=[],d={};for(let b=0;b<a;b++){let g=null;l[b]!=null&&l[b][f]!=null&&(g=l[b][f],g.v in d||(d[g.v]=[]),d[g.v].push(g))}for(let b=0;b<a;b++){let g=null;l[b]!=null&&l[b][f]!=null&&(g=l[b][f],d[g.v].length==1&&m.push(g))}a1=m;let p=a-a1.length;for(let b=0;b<p;b++)a1.push(null);o.push(a1)}let u=[];for(let f=0;f<o[0].length;f++){let m=[];for(let d=0;d<o.length;d++){let p=null;o[d]!=null&&o[d][f]!=null&&(p=o[d][f]),m.push(p)}u.push(m)}It.controlHandler(u)})}var import_plugin,rk=Nt(()=>{import_plugin=qe(Ye());ou();Ol();cr();Er();Kr();Wr();Xl();il()});function ok(){if(!Vg){Vg=!0;let t=Be(),l=t.toolbar;$("#luckysheetsheetconfigcolorur").spectrum({showPalette:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!1,showSelectionPalette:!0,maxPaletteSize:10,cancelText:t.sheetconfig.cancelText,chooseText:t.sheetconfig.chooseText,togglePaletteMoreText:l.toolMore,togglePaletteLessText:l.toolLess,clearText:l.clearText,noColorSelectedText:l.noColorSelectedText,palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)"],["rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)"],["rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)"],["rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)"],["rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"],["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"]],change:function(o){let a=$(this);o!=null?o=o.toHexString():o="rgb(0, 0, 0)";let s=null;wn.find(".luckysheet-sheets-item-color").length>0&&(s=wn.find(".luckysheet-sheets-item-color").css("background-color")),wn.find(".luckysheet-sheets-item-color").remove(),wn.append('<div class="luckysheet-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+o+';"></div>');let u=Me(h.currentSheetIndex);if(h.luckysheetfile[u].color=o,Ue.saveParam("all",h.currentSheetIndex,o,{k:"color"}),h.clearjfundo){let f={};f.type="sheetColor",f.sheetIndex=h.currentSheetIndex,f.oldcolor=s,f.color=o,h.jfundo.length=0,h.jfredo.push(f)}}}),$("#luckysheetsheetconfigcolorreset").click(function(){let o=null;wn.find(".luckysheet-sheets-item-color").length>0&&(o=wn.find(".luckysheet-sheets-item-color").css("background-color")),wn.find(".luckysheet-sheets-item-color").remove();let a=Me(h.currentSheetIndex);if(h.luckysheetfile[a].color=null,Ue.saveParam("all",h.currentSheetIndex,null,{k:"color"}),h.clearjfundo){let s={};s.type="sheetColor",s.sheetIndex=h.currentSheetIndex,s.oldcolor=o,s.color=null,h.jfundo.length=0,h.jfredo.push(s)}})}let e=Me(h.currentSheetIndex);h.luckysheetfile[e].color!=null&&h.luckysheetfile[e].color.length>0&&$("#luckysheetsheetconfigcolorur").spectrum("set",h.luckysheetfile[e].color),$("#luckysheetsheetconfigcolorur").parent().find("span, div, button, input, a").addClass("luckysheet-mousedown-cancel");let n=ut.sheetRightClickConfig;Object.values(n).every(t=>!t)||setTimeout(function(){bn($("#luckysheet-rightclick-sheet-menu"),wn.offset().left+wn.width(),wn.offset().top-18,"leftbottom")},1)}function sk(){let n=Be().sheetconfig;Vg=!1,$("#luckysheet-sheet-area").on("mousedown","div.luckysheet-sheets-item",function(m){if(at())return;let d=$(this),p=$(m.target),b=p.closest(".luckysheet-sheets-item");m.which=="3"&&setTimeout(()=>{ak(d,p,m),wn=b,ok()},0),b.hasClass("luckysheet-sheets-item-active")&&b.find(".luckysheet-sheets-item-name").attr("contenteditable")=="false"&&(nk=setTimeout(function(){h.luckysheet_sheet_move_status=!0,h.luckysheet_sheet_move_data={},h.luckysheet_sheet_move_data.widthlist=[],$("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").each(function(x){x==0?h.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):h.luckysheet_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+h.luckysheet_sheet_move_data.widthlist[x-1])}),h.luckysheet_sheet_move_data.curindex=$("#luckysheet-sheet-area div.luckysheet-sheets-item").index(b);let g=m.pageX;h.luckysheet_sheet_move_data.curleft=g-b.offset().left,h.luckysheet_sheet_move_data.pageX=g,h.luckysheet_sheet_move_data.activeobject=b,h.luckysheet_sheet_move_data.cursorobject=p;let v=b.clone().css("visibility","hidden").attr("id","luckysheet-sheets-item-clone");b.after(v),b.css({position:"absolute",opacity:.8,cursor:"move",transition:"initial","z-index":10})},200))}).on("click","div.luckysheet-sheets-item",function(m){if(at())return;let d=$(this),p=$(m.target);ak(d,p,m),Ue.keepHighLightBox()});let t=function(m){h.allowEdit!==!1&&(m.attr("contenteditable","true").addClass("luckysheet-mousedown-cancel").data("oldtxt",m.text()),setTimeout(function(){py(m.get(0))},1))};$("#luckysheet-sheet-area").on("dblclick","span.luckysheet-sheets-item-name",function(m){t($(this))});let l=!0;$("#luckysheet-sheet-area").on("compositionstart","span.luckysheet-sheets-item-name",()=>l=!1),$("#luckysheet-sheet-area").on("compositionend","span.luckysheet-sheets-item-name",()=>l=!0),$("#luckysheet-sheet-area").on("input","span.luckysheet-sheets-item-name",function(){if(h.allowEdit===!1||h.limitSheetNameLength===!1)return;let m=h.defaultSheetNameMaxLength;m!==0&&setTimeout(()=>{l&&$(this).text().length>=m&&setTimeout(()=>{$(this).text($(this).text().substring(0,m));let d=window.getSelection();d.selectAllChildren(this),d.collapseToEnd()},0)},0)}),$("#luckysheet-sheet-area").on("blur","span.luckysheet-sheets-item-name",function(m){if(h.allowEdit===!1)return;let d=$(this),p=d.text(),b=d.data("oldtxt");if($(this).text().length===0){ke.info("",n.sheetNamecannotIsEmptyError),d.text(b).attr("contenteditable","false");return}if(p.length>31||p.charAt(0)=="'"||p.charAt(p.length-1)=="'"||/[\:\\\/\?\*\[\]]+/.test(p)){ke.info("",n.sheetNameSpecCharError),d.text(b).attr("contenteditable","false");return}let g=Me(h.currentSheetIndex);for(let v=0;v<h.luckysheetfile.length;v++)if(g!=v&&h.luckysheetfile[v].name==p){at()?alert(n.tipNameRepeat):ke.info("",n.tipNameRepeat),d.text(b).attr("contenteditable","false");return}if(kt.sheetArrowShowAndHide(),h.luckysheetfile[g].name=p,Ue.saveParam("all",h.currentSheetIndex,p,{k:"name"}),d.attr("contenteditable","false").removeClass("luckysheet-mousedown-cancel"),h.clearjfundo){let v={};v.type="sheetName",v.sheetIndex=h.currentSheetIndex,v.oldtxt=b,v.txt=p,h.jfundo.length=0,h.jfredo.push(v)}sl.createHookFunction("sheetEditNameAfter",{i:h.luckysheetfile[g].index,oldName:b,newName:p})}),$("#luckysheet-sheet-area").on("keydown","span.luckysheet-sheets-item-name",function(m){if(h.allowEdit===!1)return;let d=m.keyCode,p=$(this);if(d==xl.ENTER){let b=Me(h.currentSheetIndex);ik=h.luckysheetfile[b].name||ik,h.luckysheetfile[b].name=p.text(),p.attr("contenteditable","false")}}),$("#luckysheetsheetconfigrename").click(function(){var m=wn.find("span.luckysheet-sheets-item-name");!sl.createHookFunction("sheetEditNameBefore",{i:wn.data("index"),name:m.text()})||(t(wn.find("span.luckysheet-sheets-item-name")),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide())}),$("#luckysheetsheetconfigshow").click(function(){$("#luckysheet-sheets-m").click(),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigmoveleft").click(function(){wn.prevAll(":visible").length>0&&(wn.insertBefore(wn.prevAll(":visible").eq(0)),kt.reOrderAllSheet()),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigmoveright").click(function(){wn.nextAll(":visible").length>0&&(wn.insertAfter(wn.nextAll(":visible").eq(0)),kt.reOrderAllSheet()),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfigdelete").click(function(m){if($("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),$("#luckysheet-sheet-container-c .luckysheet-sheets-item:visible").length<=1){at()?alert(n.noMoreSheet):ke.info(n.noMoreSheet,"");return}let d=Me(h.currentSheetIndex);ke.confirm(n.confirmDelete+"\u3010"+h.luckysheetfile[d].name+"\u3011\uFF1F","<span style='color:#9e9e9e;font-size:12px;'>"+n.redoDelete+"</span>",function(){kt.deleteSheet(wn.data("index"))},null),$("#luckysheet-input-box").removeAttr("style")}),$("#luckysheetsheetconfigcopy").click(function(m){kt.copySheet(wn.data("index"),m),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheetsheetconfighide").click(function(){if($("#luckysheet-sheet-area div.luckysheet-sheets-item:visible").length==1){at()?alert(n.noHide):ke.info("",n.noHide);return}kt.setSheetHide(wn.data("index")),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide()}),$("#luckysheet-sheets-add").click(function(m){parseInt($("#luckysheet-input-box").css("top"))>0&&y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),kt.addNewSheet(m),kt.locationSheet(),$("#luckysheet-input-box").removeAttr("style")});let o=null,a=0,s=0,u=150;$("#luckysheet-sheets-leftscroll").click(function(){let m=$("#luckysheet-sheet-container-c");a=m.scrollLeft(),s=m.scrollLeft()-u,s<=0&&$("#luckysheet-sheet-container .docs-sheet-fade-left").hide(),$("#luckysheet-sheet-container .docs-sheet-fade-right").show(),clearInterval(o),o=setInterval(function(){a-=4,m.scrollLeft(a),a<=s&&clearInterval(o)},1)}),$("#luckysheet-sheets-rightscroll").click(function(){let m=$("#luckysheet-sheet-container-c");a=m.scrollLeft(),s=m.scrollLeft()+u,a>0&&$("#luckysheet-sheet-container .docs-sheet-fade-right").hide(),$("#luckysheet-sheet-container .docs-sheet-fade-left").show(),clearInterval(o),o=setInterval(function(){a+=4,m.scrollLeft(a),a>=s&&clearInterval(o)},1)});let f=!0;$("#luckysheet-sheets-m").click(function(m){parseInt($("#luckysheet-input-box").css("top"))>0&&y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),$("#luckysheet-sheet-list").html("");let d="";for(let v=0;v<h.luckysheetfile.length;v++){let x=h.luckysheetfile[v],_="",S="";x.status==1&&(_='<i class="fa fa-check" aria-hidden="true"></i>'),x.hide==1&&(_='<i class="fa fa-low-vision" aria-hidden="true"></i>',S+="color:#BBBBBB;"),x.color!=null&&x.color.length>0&&(S+="border-right:4px solid "+x.color+";"),d+=Tt(p0,{index:x.index,name:x.name,icon:_,style:S})}f?($("#"+h.container).append(Tt(g0,{item:d})),$("#luckysheet-sheet-list").on("click",".luckysheet-cols-menuitem",function(v){if(at()){alert(n.chartEditNoOpt);return}let x=$(this),_=x.data("index");x.data("index")!=h.currentSheetIndex&&(kt.setSheetShow(_),kt.locationSheet()),Ue.keepHighLightBox()}),f=!1):$("#luckysheet-sheet-list").html(d);let p=$("#luckysheet-sheet-list"),b=$(this).offset().left-$("#"+h.container).offset().left,g=$(this).height()+$("#luckysheet-sta-content").height()+12;p.css({left:b+"px",bottom:g+"px"}).show(),$("#luckysheet-input-box").removeAttr("style")}),ut.pager&&Mg(ut.pager)}var import_plugin,Vg,wn,nk,ik,ak,ck=Nt(()=>{import_plugin=qe(Ye());kn();qr();Rr();Ol();fr();cr();Sr();Jo();Kr();Ga();Xl();il();Vn();mc();wi();Vg=!1,wn=null,nk=null,ik="";ak=function(e,n,t){clearTimeout(nk),!(n.hasClass("luckysheet-sheets-item-name")&&n.attr("contenteditable")=="true")&&(y.rangestart||y.rangedrag_column_start||y.rangedrag_row_start||y.israngeseleciton()?setTimeout(function(){y.setCaretPosition(y.rangeSetValueTo.get(0),0,y.rangeSetValueTo.text().length),y.createRangeHightlight(),$("#luckysheet-input-box-index").find(".luckysheet-input-box-index-sheettxt").remove().end().prepend("<span class='luckysheet-input-box-index-sheettxt'>"+kt.getSheetName(y.rangetosheet)+"!</span>").show(),$("#luckysheet-input-box-index").css({left:$("#luckysheet-input-box").css("left"),top:parseInt($("#luckysheet-input-box").css("top"))-20+"px","z-index":$("#luckysheet-input-box").css("z-index")})},1):(parseInt($("#luckysheet-input-box").css("top"))>0&&y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),$("#luckysheet-input-box").removeAttr("style"),$("#luckysheet-formula-functionrange .luckysheet-formula-functionrange-highlight").remove()),$("#luckysheet-sheet-area div.luckysheet-sheets-item").removeClass("luckysheet-sheets-item-active"),e.addClass("luckysheet-sheets-item-active"),Jr(t),kt.changeSheet(e.data("index")),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),(n.hasClass("luckysheet-sheets-item-menu")||n.hasClass("fa-sort-desc")||t.which=="3")&&(wn=n.closest(".luckysheet-sheets-item"),ok()))}});function uk(){let n=Be().formula;$("#luckysheet-functionbox-cell").focus(function(){if(!at()&&h.luckysheet_select_save.length>0){let t=h.luckysheet_select_save[h.luckysheet_select_save.length-1],l=t.row_focus,o=t.column_focus;ti(l,o,h.flowdata,null,!0),y.rangeResizeTo=$("#luckysheet-functionbox-cell")}}).keydown(function(t){if(at())return;let l=t.ctrlKey,o=t.altKey,a=t.shiftKey,s=t.keyCode,u=$("#luckysheet-input-box");if(s==xl.ENTER&&parseInt(u.css("top"))>0)$("#luckysheet-formula-search-c").is(":visible")&&y.searchFunctionCell!=null?y.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_select_save=[{row:[h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[0]],column:[h.luckysheetCellUpdate[1],h.luckysheetCellUpdate[1]],row_focus:h.luckysheetCellUpdate[0],column_focus:h.luckysheetCellUpdate[1]}],Cr("down",1,"rangeOfSelect"),$("#luckysheet-rich-text-editor").focus()),t.preventDefault();else if(s==xl.ESC&&parseInt(u.css("top"))>0)y.dontupdate(),Cr("down",0,"rangeOfSelect"),$("#luckysheet-rich-text-editor").focus(),t.preventDefault();else if(s==xl.F4&&parseInt(u.css("top"))>0)y.setfreezonFuc(t),t.preventDefault();else if(s==xl.UP&&parseInt(u.css("top"))>0){if($("#luckysheet-formula-search-c").is(":visible")){let f=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").prev();f.length==0&&(f=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").last()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),f.addClass("luckysheet-formula-search-item-active"),t.preventDefault()}}else if(s==xl.DOWN&&parseInt(u.css("top"))>0){if($("#luckysheet-formula-search-c").is(":visible")){let f=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").next();f.length==0&&(f=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").first()),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),f.addClass("luckysheet-formula-search-item-active"),t.preventDefault()}}else s==xl.LEFT&&parseInt(u.css("top"))>0?y.rangeHightlightselected($("#luckysheet-functionbox-cell")):s==xl.RIGHT&&parseInt(u.css("top"))>0?y.rangeHightlightselected($("#luckysheet-functionbox-cell")):(!(s>=112&&s<=123||s<=46||s==144||s==108||t.ctrlKey||t.altKey||t.shiftKey&&(s==37||s==38||s==39||s==40))||s==8||s==32||s==46||t.ctrlKey&&s==86)&&y.functionInputHanddler($("#luckysheet-rich-text-editor"),$("#luckysheet-functionbox-cell"),s)}).click(function(){at()||y.rangeHightlightselected($("#luckysheet-functionbox-cell"))}),$("#luckysheet-wa-functionbox-cancel").click(function(){!$(this).hasClass("luckysheet-wa-calculate-active")||($("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),y.dontupdate(),Cr("down",0,"rangeOfSelect"))}),$("#luckysheet-wa-functionbox-confirm").click(function(){!$(this).hasClass("luckysheet-wa-calculate-active")||($("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("down",0,"rangeOfSelect"))}),$("#luckysheet-wa-functionbox-fx").click(function(){if(h.luckysheet_select_save.length==0){at()?alert(n.tipSelectCell):ke.info(n.tipSelectCell,"");return}let t=h.luckysheet_select_save[h.luckysheet_select_save.length-1],l=t.row_focus,o=t.column_focus;ti(l,o,h.flowdata);let a=h.flowdata[l][o];if(a!=null&&a.f!=null){let s=y.getfunctionParam(a.f);s.fn!=null?Ia.formulaParmDialog(s.fn,s.param):Ia.formulaListDialog()}else $("#luckysheet-rich-text-editor").html('<span dir="auto" class="luckysheet-formula-text-color">=</span>'),$("#luckysheet-functionbox-cell").html($("#luckysheet-rich-text-editor").html()),Ia.formulaListDialog();Ia.init()}),$("#luckysheet-formula-functionrange").on("mousedown",".luckysheet-copy",function(t){y.rangeMove=!0,h.luckysheet_scroll_status=!0,y.rangeMoveObj=$(this).parent(),y.rangeMoveIndex=$(this).parent().attr("rangeindex");let l=wl(t.pageX,t.pageY),o=l[0]+$("#luckysheet-cell-main").scrollLeft(),a=l[1]+$("#luckysheet-cell-main").scrollTop();$("#luckysheet-formula-functionrange-highlight-"+y.rangeMoveIndex).find(".luckysheet-selection-copy-hc").css("opacity",.13);let s=$(this).data("type");s=="top"?a+=3:s=="right"?o-=3:s=="bottom"?a-=3:s=="left"&&(o+=3);let u=Jl(a)[2],f=Zl(o)[2];y.rangeMovexy=[u,f],$("#luckysheet-sheettable").css("cursor","move"),t.stopPropagation()}),$("#luckysheet-formula-functionrange").on("mousedown",".luckysheet-highlight",function(t){y.rangeResize=$(this).data("type"),y.rangeResizeIndex=$(this).parent().attr("rangeindex");let l=wl(t.pageX,t.pageY),o=$("#luckysheet-cell-main").scrollLeft(),a=$("#luckysheet-cell-main").scrollTop(),s=l[0]+o,u=l[1]+a;y.rangeResizeObj=$(this).parent(),$("#luckysheet-formula-functionrange-highlight-"+y.rangeResizeIndex).find(".luckysheet-selection-copy-hc").css("opacity",.13),y.rangeResize=="lt"?(s+=3,u+=3):y.rangeResize=="lb"?(s+=3,u-=3):y.rangeResize=="rt"?(s-=3,u+=3):y.rangeResize=="rb"&&(s-=3,u-=3);let f=Jl(u),m=f[1],d=f[0],p=f[2],b=Zl(s),g=b[1],v=b[0],x=b[2],_=y.rangeResizeObj.position();y.rangeResizexy=[v,d,y.rangeResizeObj.width(),y.rangeResizeObj.height(),_.left+o,_.top+a,g,m],y.rangeResizeWinH=$("#luckysheet-cell-main")[0].scrollHeight,y.rangeResizeWinW=$("#luckysheet-cell-main")[0].scrollWidth,h.luckysheet_scroll_status=!0,t.stopPropagation()})}var import_plugin,fk=Nt(()=>{import_plugin=qe(Ye());ln();gc();Rr();Kc();Eg();Ri();cr();Sr();Kr();Xl();il()});function hk(){$("#luckysheet-rows-h").mousedown(function(e){if(!of(h.currentSheetIndex))return;Zt.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&Pt.cancelActiveImgItem();let t=wl(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=Jl(t),o=l[1],a=l[0],s=l[2],u=h.visibledatacolumn.length-1,f=h.visibledatacolumn[u],m=0;if($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),e.which=="3"){let v=!1;for(let x=0;x<h.luckysheet_select_save.length;x++){let _=h.luckysheet_select_save[x];if(_.row!=null&&s>=_.row[0]&&s<=_.row[1]&&_.column[0]==0&&_.column[1]==h.flowdata[0].length-1){v=!0;break}}if(v)return}let d=a,p=o-a-1,b=[s,s];h.luckysheet_scroll_status=!0;let g=$("#luckysheet-input-box");if(parseInt(g.css("top"))>0)if(y.rangestart||y.rangedrag_column_start||y.rangedrag_row_start||y.israngeseleciton()||$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let v=_t.mergeMoveMain([0,u],b,{row_focus:s,column_focus:0},d,p,m,f);if(v!=null&&(b=v[1],d=v[2],p=v[3]),e.shiftKey){let x=y.func_selectedrange,_=0,S=0,I=[];x.top>a?(_=a,S=x.top+x.height-a,x.row[1]>x.row_focus&&(x.row[1]=x.row_focus),I=[s,x.row[1]]):x.top==a?(_=a,S=x.top+x.height-a,I=[s,x.row[0]]):(_=x.top,S=o-x.top-1,x.row[0]<x.row_focus&&(x.row[0]=x.row_focus),I=[x.row[0],s]);let P=_t.mergeMoveMain([0,u],I,{row_focus:s,column_focus:0},_,S,m,f);P!=null&&(I=P[1],_=P[2],S=P[3]),x.row=I,x.top_move=_,x.height_move=S,y.func_selectedrange=x}else if(e.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){let x=$("#luckysheet-rich-text-editor").text()+",";if(x.length>0&&x.substr(0,1)=="="){if(x=y.functionHTMLGenerate(x),window.getSelection){let _=window.getSelection();y.functionRangeIndex=[$(_.anchorNode).parent().index(),_.anchorOffset]}else{let _=document.selection.createRange();y.functionRangeIndex=_}$("#luckysheet-rich-text-editor").html(x),y.canceFunctionrangeSelected(),y.createRangeHightlight()}y.rangestart=!1,y.rangedrag_column_start=!1,y.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(x),y.rangeHightlightselected($("#luckysheet-rich-text-editor")),y.israngeseleciton(),y.func_selectedrange={left:or(0)[0],width:or(0)[1]-or(0)[0]-1,top:d,height:p,left_move:m,width_move:f-m-1,top_move:d,height_move:p,row:b,column:[0,u],row_focus:s,column_focus:0}}else y.func_selectedrange={left:or(0)[0],width:or(0)[1]-or(0)[0]-1,top:d,height:p,left_move:m,width_move:f-m-1,top_move:d,height_move:p,row:b,column:[0,u],row_focus:s,column_focus:0};if(y.rangestart||y.rangedrag_column_start||y.rangedrag_row_start||y.israngeseleciton())y.rangeSetValue({row:b,column:[null,null]});else if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let x=Kl(h.currentSheetIndex,{row:b,column:[0,u]},h.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(x)}y.rangedrag_row_start=!0,y.rangestart=!1,y.rangedrag_column_start=!1,$("#luckysheet-formula-functionrange-select").css({left:m,width:f-m-1,top:d,height:p}).show(),$("#luckysheet-formula-help-c").hide(),eo(m,d,f-m-1,p,b,[0,u]),setTimeout(function(){let _=window.getSelection().anchorNode,S;$("#luckysheet-search-formula-parm").is(":visible")||$("#luckysheet-search-formula-parm-select").is(":visible")?(S=$("#luckysheet-rich-text-editor"),y.rangechangeindex=y.data_parm_index):S=$(_).closest("div");let I=S.find("span[rangeindex='"+y.rangechangeindex+"']");y.setCaretPosition(I.get(0),0,I.html().length)},1);return}else y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_rows_selected_status=!0;else h.luckysheet_rows_selected_status=!0;if(h.luckysheet_rows_selected_status){if(e.shiftKey){let v=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),x=0,_=0,S=[];v.top>a?(x=a,_=v.top+v.height-a,v.row[1]>v.row_focus&&(v.row[1]=v.row_focus),S=[s,v.row[1]]):v.top==a?(x=a,_=v.top+v.height-a,S=[s,v.row[0]]):(x=v.top,_=o-v.top-1,v.row[0]<v.row_focus&&(v.row[0]=v.row_focus),S=[v.row[0],s]),v.row=S,v.top_move=x,v.height_move=_,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=v}else e.ctrlKey?h.luckysheet_select_save.push({left:or(0)[0],width:or(0)[1]-or(0)[0]-1,top:d,height:p,left_move:m,width_move:f-m-1,top_move:d,height_move:p,row:b,column:[0,u],row_focus:s,column_focus:0,row_select:!0}):(h.luckysheet_select_save.length=0,h.luckysheet_select_save.push({left:or(0)[0],width:or(0)[1]-or(0)[0]-1,top:d,height:p,left_move:m,width_move:f-m-1,top_move:d,height_move:p,row:b,column:[0,u],row_focus:s,column_focus:0,row_select:!0}));gl(),Ue.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save)}Gh(),setTimeout(function(){clearTimeout(h.countfuncTimeout),Nn()},101)}).mousemove(function(e){if(h.luckysheet_rows_selected_status||h.luckysheet_rows_change_size||h.luckysheet_select_status){$("#luckysheet-rows-h-hover").hide();return}let t=wl(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=Jl(t),o=l[1],a=l[0],s=l[2];$("#luckysheet-rows-h-hover").css({top:a,height:o-a-1,display:"block"}),t<o-1&&t>=o-5?$("#luckysheet-rows-change-size").css({top:o-3,opacity:0}):$("#luckysheet-rows-change-size").css("opacity",0)}).mouseleave(function(e){$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-rows-change-size").css("opacity",0)}).mouseup(function(e){if(e.which==3){if(!yi()||at())return;$("#luckysheet-cols-rows-shift").hide(),h.luckysheetRightHeadClickIs="row",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Be().rightclick.row),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Be().rightclick.height),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Be().rightclick.top),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Be().rightclick.bottom),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block";let n=ut.cellRightClickConfig;if(!n.copy&&!n.copyAs&&!n.paste&&!n.insertRow&&!n.deleteRow&&!n.hideRow&&!n.rowHeight&&!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat)return;tl("#luckysheet-top-left-add-selected").style.display=n.insertRow?"block":"none",tl("#luckysheet-bottom-right-add-selected").style.display=n.insertRow?"block":"none",tl("#luckysheet-del-selected").style.display=n.deleteRow?"block":"none",tl("#luckysheet-hide-selected").style.display=n.hideRow?"block":"none",tl("#luckysheet-show-selected").style.display=n.hideRow?"block":"none",tl("#luckysheet-column-row-width-selected").style.display=n.rowHeight?"block":"none",!n.copy&&!n.copyAs&&!n.paste&&(tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!n.insertRow&&!n.deleteRow&&!n.hideRow&&!n.rowHeight&&(tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!n.insertRow&&!n.deleteRow&&!n.hideRow&&!n.rowHeight&&(tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat&&(tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),Ca($("#luckysheet-rightclick-menu"),$(this).offset().left+46,e.pageY),h.luckysheet_cols_menu_status=!0;let t=$.extend(!0,{},h.config);t.rowlen==null&&(t.rowlen={});let l=t.rowlen[h.luckysheet_select_save[0].row[0]]==null?h.defaultrowlen:t.rowlen[h.luckysheet_select_save[0].row[0]],o=!0;for(let a=0;a<h.luckysheet_select_save.length;a++){let s=h.luckysheet_select_save[a],u=s.row[0],f=s.row[1];for(let m=u;m<=f;m++)if((t.rowlen[m]==null?h.defaultrowlen:t.rowlen[m])!=l){o=!1;break}}o?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(l):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}}),$("#luckysheet-cols-h-c").mousedown(function(e){if(!of(h.currentSheetIndex))return;Zt.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&Pt.cancelActiveImgItem();let t=wl(e.pageX,e.pageY)[0]+$(this).scrollLeft(),l=h.visibledatarow.length-1,o=h.visibledatarow[l],a=0,s=Zl(t),u=s[1],f=s[0],m=s[2];if(h.orderbyindex=m,$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-sheet-list, #luckysheet-rightclick-sheet-menu").hide(),$("#luckysheet-filter-menu, #luckysheet-filter-submenu").hide(),e.which=="3"){let v=!1;for(let x=0;x<h.luckysheet_select_save.length;x++){let _=h.luckysheet_select_save[x];if(_.column!=null&&m>=_.column[0]&&m<=_.column[1]&&_.row[0]==0&&_.row[1]==h.flowdata.length-1){v=!0;break}}if(v)return}let d=f,p=u-f-1,b=[m,m];h.luckysheet_scroll_status=!0;let g=$("#luckysheet-input-box");if(parseInt(g.css("top"))>0)if(y.rangestart||y.rangedrag_column_start||y.rangedrag_row_start||y.israngeseleciton()||$("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let v=_t.mergeMoveMain(b,[0,l],{row_focus:0,column_focus:m},a,o,d,p);if(v!=null&&(b=v[0],d=v[4],p=v[5]),e.shiftKey){let x=y.func_selectedrange,_=0,S=0,I=[];x.left>f?(_=f,S=x.left+x.width-f,x.column[1]>x.column_focus&&(x.column[1]=x.column_focus),I=[m,x.column[1]]):x.left==f?(_=f,S=x.left+x.width-f,I=[m,x.column[0]]):(_=x.left,S=u-x.left-1,x.column[0]<x.column_focus&&(x.column[0]=x.column_focus),I=[x.column[0],m]);let P=_t.mergeMoveMain(I,[0,l],{row_focus:0,column_focus:m},a,o,_,S);P!=null&&(I=P[0],_=P[4],S=P[5]),x.column=I,x.left_move=_,x.width_move=S,y.func_selectedrange=x}else if(e.ctrlKey&&$("#luckysheet-rich-text-editor").find("span").last().text()!=","){let x=$("#luckysheet-rich-text-editor").text()+",";if(x.length>0&&x.substr(0,1)=="="){if(x=y.functionHTMLGenerate(x),window.getSelection){let _=window.getSelection();y.functionRangeIndex=[$(_.anchorNode).parent().index(),_.anchorOffset]}else{let _=document.selection.createRange();y.functionRangeIndex=_}$("#luckysheet-rich-text-editor").html(x),y.canceFunctionrangeSelected(),y.createRangeHightlight()}y.rangestart=!1,y.rangedrag_column_start=!1,y.rangedrag_row_start=!1,$("#luckysheet-functionbox-cell").html(x),y.rangeHightlightselected($("#luckysheet-rich-text-editor")),y.israngeseleciton(),y.func_selectedrange={left:d,width:p,top:Zr(0)[0],height:Zr(0)[1]-Zr(0)[0]-1,left_move:d,width_move:p,top_move:a,height_move:o-a-1,row:[0,l],column:b,row_focus:0,column_focus:m}}else y.func_selectedrange={left:d,width:p,top:Zr(0)[0],height:Zr(0)[1]-Zr(0)[0]-1,left_move:d,width_move:p,top_move:a,height_move:o-a-1,row:[0,l],column:b,row_focus:0,column_focus:m};if(y.rangestart||y.rangedrag_column_start||y.rangedrag_row_start||y.israngeseleciton())y.rangeSetValue({row:[null,null],column:b});else if($("#luckysheet-ifFormulaGenerator-multiRange-dialog").is(":visible")){let x=Kl(h.currentSheetIndex,{row:[0,l],column:b},h.currentSheetIndex);$("#luckysheet-ifFormulaGenerator-multiRange-dialog input").val(x)}y.rangedrag_column_start=!0,y.rangestart=!1,y.rangedrag_row_start=!1,$("#luckysheet-formula-functionrange-select").css({left:d,width:p,top:a,height:o-a-1}).show(),$("#luckysheet-formula-help-c").hide(),eo(d,a,p,o-a-1,[0,l],b);return}else y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_cols_selected_status=!0;else h.luckysheet_cols_selected_status=!0;if(h.luckysheet_cols_selected_status){if(e.shiftKey){let v=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),x=0,_=0,S=[];v.left>f?(x=f,_=v.left+v.width-f,v.column[1]>v.column_focus&&(v.column[1]=v.column_focus),S=[m,v.column[1]]):v.left==f?(x=f,_=v.left+v.width-f,S=[m,v.column[0]]):(x=v.left,_=u-v.left-1,v.column[0]<v.column_focus&&(v.column[0]=v.column_focus),S=[v.column[0],m]),v.column=S,v.left_move=x,v.width_move=_,h.luckysheet_select_save[h.luckysheet_select_save.length-1]=v}else e.ctrlKey?h.luckysheet_select_save.push({left:d,width:p,top:Zr(0)[0],height:Zr(0)[1]-Zr(0)[0]-1,left_move:d,width_move:p,top_move:a,height_move:o-a-1,row:[0,l],column:b,row_focus:0,column_focus:m,column_select:!0}):(h.luckysheet_select_save.length=0,h.luckysheet_select_save.push({left:d,width:p,top:Zr(0)[0],height:Zr(0)[1]-Zr(0)[0]-1,left_move:d,width_move:p,top_move:a,height_move:o-a-1,row:[0,l],column:b,row_focus:0,column_focus:m,column_select:!0}));gl(),Ue.saveParam("mv",h.currentSheetIndex,h.luckysheet_select_save)}Gh(),setTimeout(function(){clearTimeout(h.countfuncTimeout),Nn()},101),h.luckysheet_cols_menu_status&&($("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),h.luckysheet_cols_menu_status=!1),e.stopPropagation()}).mousemove(function(e){if(h.luckysheet_cols_selected_status||h.luckysheet_select_status){$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide();return}if(h.luckysheet_cols_menu_status||h.luckysheet_cols_change_size)return;let t=wl(e.pageX,e.pageY)[0]+$("#luckysheet-cols-h-c").scrollLeft(),l=Zl(t),o=l[1],a=l[0],s=l[2];$("#luckysheet-cols-h-hover").css({left:a,width:o-a-1,display:"block"}),$("#luckysheet-cols-menu-btn").css({left:o-19,display:"block"}),$("#luckysheet-cols-change-size").css({left:o-5}),t<o&&t>=o-5?($("#luckysheet-cols-change-size").css({opacity:0}),$("#luckysheet-cols-menu-btn").hide()):($("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0))}).mouseleave(function(e){h.luckysheet_cols_menu_status||h.luckysheet_cols_change_size||($("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),$("#luckysheet-cols-change-size").css("opacity",0))}).mouseup(function(e){if(e.which==3){if(!yi()||at())return;h.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Be().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-size").text(Be().rightclick.width),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Be().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Be().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").show(),$("#luckysheet-cols-rows-shift").hide(),$("#luckysheet-cols-rows-handleincell").hide(),tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="block";let n=ut.cellRightClickConfig;if(!n.copy&&!n.copyAs&&!n.paste&&!n.insertColumn&&!n.deleteColumn&&!n.hideColumn&&!n.columnWidth&&!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat)return;tl("#luckysheet-top-left-add-selected").style.display=n.insertColumn?"block":"none",tl("#luckysheet-bottom-right-add-selected").style.display=n.insertColumn?"block":"none",tl("#luckysheet-del-selected").style.display=n.deleteColumn?"block":"none",tl("#luckysheet-hide-selected").style.display=n.hideColumn?"block":"none",tl("#luckysheet-show-selected").style.display=n.hideColumn?"block":"none",tl("#luckysheet-column-row-width-selected").style.display=n.columnWidth?"block":"none",!n.copy&&!n.copyAs&&!n.paste&&(tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!n.insertColumn&&!n.deleteColumn&&!n.hideColumn&&!n.columnWidth&&(tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none")),!n.insertColumn&&!n.deleteColumn&&!n.hideColumn&&!n.columnWidth&&(tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),!n.clear&&!n.matrix&&!n.sort&&!n.filter&&!n.chart&&!n.image&&!n.link&&!n.data&&!n.cellFormat&&(tl("#luckysheet-cols-rows-data .luckysheet-menuseparator").style.display="none"),Ca($("#luckysheet-rightclick-menu"),e.pageX,$(this).offset().top+18),h.luckysheet_cols_menu_status=!0;let t=$.extend(!0,{},h.config);t.columnlen==null&&(t.columnlen={});let l=t.columnlen[h.luckysheet_select_save[0].column[0]]==null?h.defaultcollen:t.columnlen[h.luckysheet_select_save[0].column[0]],o=!0;for(let a=0;a<h.luckysheet_select_save.length;a++){let s=h.luckysheet_select_save[a],u=s.column[0],f=s.column[1];for(let m=u;m<=f;m++)if((t.columnlen[m]==null?h.defaultcollen:t.columnlen[m])!=l){o=!1;break}}o?$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val(l):$("#luckysheet-cols-rows-add").find("input[type='number'].rcsize").val("")}}),$("#luckysheet-rows-change-size").mousedown(function(e){if(!yi())return;Zt.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&Pt.cancelActiveImgItem(),$("#luckysheet-input-box").hide(),$("#luckysheet-rows-change-size").css({opacity:1});let t=wl(e.pageX,e.pageY)[1]+$("#luckysheet-rows-h").scrollTop(),l=$("#luckysheet-cell-main").scrollLeft(),o=$("#luckysheet-cell-main").width(),a=Jl(t),s=a[1],u=a[0],f=a[2];h.luckysheet_rows_change_size=!0,h.luckysheet_scroll_status=!0,$("#luckysheet-change-size-line").css({height:"1px","border-width":"0 0px 1px 0",top:s-3,left:0,width:l+o,display:"block",cursor:"ns-resize"}),$("#luckysheet-sheettable, #luckysheet-rows-h, #luckysheet-rows-h canvas").css("cursor","ns-resize"),h.luckysheet_rows_change_size_start=[u,f],$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-rows-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),e.stopPropagation()}),$("#luckysheet-cols-change-size").mousedown(function(e){if(!yi())return;Zt.removeActivePs(),($("#luckysheet-modal-dialog-activeImage").is(":visible")||$("#luckysheet-modal-dialog-cropping").is(":visible"))&&Pt.cancelActiveImgItem(),$("#luckysheet-input-box").hide(),$("#luckysheet-cols-change-size").css({opacity:1});let n=wl(e.pageX,e.pageY),t=$("#luckysheet-cols-h-c").scrollLeft(),l=$("#luckysheet-cell-main").scrollTop(),o=$("#luckysheet-cell-main").height(),a=n[0]+t,s=h.visibledatarow.length-1,u=h.visibledatarow[s],f=0,m=Zl(a),d=m[1],p=m[0],b=m[2];h.luckysheet_cols_change_size=!0,h.luckysheet_scroll_status=!0,$("#luckysheet-change-size-line").css({height:o+l,"border-width":"0 1px 0 0",top:0,left:d-3,width:"1px",display:"block",cursor:"ew-resize"}),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","ew-resize"),h.luckysheet_cols_change_size_start=[p,b],$("#luckysheet-rightclick-menu").hide(),$("#luckysheet-cols-h-hover").hide(),$("#luckysheet-cols-menu-btn").hide(),h.luckysheet_cols_dbclick_times=0,e.stopPropagation()}).dblclick(function(){y_()}),$("#luckysheet-cols-menu-btn").click(function(e){if(!yi()){ke.info("",Be().pivotTable.errorNotAllowEdit);return}let n=$("#luckysheet-rightclick-menu"),t=$(this).offset();$("#luckysheet-cols-rows-shift").show(),h.luckysheetRightHeadClickIs="column",$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-word").text(Be().rightclick.column),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-left").text(Be().rightclick.left),$("#luckysheet-rightclick-menu .luckysheet-cols-rows-shift-right").text(Be().rightclick.right),$("#luckysheet-cols-rows-add").show(),$("#luckysheet-cols-rows-data").hide(),$("#luckysheet-cols-rows-shift").show(),$("#luckysheet-cols-rows-handleincell").hide(),tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="block",tl("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="block";let l=ut.cellRightClickConfig;!l.copy&&!l.copyAs&&!l.paste&&!l.insertColumn&&!l.deleteColumn&&!l.hideColumn&&!l.columnWidth&&!l.sort||(tl("#luckysheet-top-left-add-selected").style.display=l.insertColumn?"block":"none",tl("#luckysheet-bottom-right-add-selected").style.display=l.insertColumn?"block":"none",tl("#luckysheet-del-selected").style.display=l.deleteColumn?"block":"none",tl("#luckysheet-hide-selected").style.display=l.hideColumn?"block":"none",tl("#luckysheet-show-selected").style.display=l.hideColumn?"block":"none",tl("#luckysheet-column-row-width-selected").style.display=l.columnWidth?"block":"none",!l.copy&&!l.copyAs&&!l.paste&&(tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none",!l.insertColumn&&!l.deleteColumn&&!l.hideColumn&&!l.columnWidth&&(tl("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="none")),!l.insertColumn&&!l.deleteColumn&&!l.hideColumn&&!l.columnWidth&&(tl("#luckysheet-cols-rows-add .luckysheet-menuseparator").style.display="none"),l.sort||(tl("#luckysheet-cols-rows-shift .luckysheet-menuseparator").style.display="none"),Ca(n,t.left,t.top+18),h.luckysheet_cols_menu_status=!0)}),$("#luckysheet-top-left-add-selected").click(function(e){if(e.target.nodeName==="INPUT")return;$("#luckysheet-rightclick-menu").hide(),kl();let n=Be(),t=n.drag,l=n.info;if(h.luckysheet_select_save.length>1){at()?alert(t.noMulti):ke.info(t.noMulti,"");return}let o=$(this),a=o.find("input").val();if(!K(a)){at()?alert(l.tipInputNumber):ke.info(l.tipInputNumber,"");return}if(a=parseInt(a),a<1||a>100){at()?alert(l.tipInputNumberLimit):ke.info(l.tipInputNumberLimit,"");return}let s=h.luckysheet_select_save[0][h.luckysheetRightHeadClickIs][0];!sl.createHookFunction("rowInsertBefore",s,a,"lefttop")||Ao(h.luckysheetRightHeadClickIs,s,a,"lefttop")}),$("#luckysheetColsRowsHandleAdd_row").click(function(e){if($("#luckysheet-rightclick-menu").hide(),kl(),h.allowEdit===!1)return;let n=h.luckysheet_select_save[0].row[0];!sl.createHookFunction("rowInsertBefore",n,1,"lefttop")||Ao("row",n,1,"lefttop")}),$("#luckysheetColsRowsHandleAdd_column").click(function(e){if($("#luckysheet-rightclick-menu").hide(),kl(),h.allowEdit===!1)return;let n=h.luckysheet_select_save[0].column[0];Ao("column",n,1,"lefttop")}),$(".luckysheetColsRowsHandleAdd_custom").click(function(e){$("#luckysheet-rightclick-menu").hide();let n=ut.cellRightClickConfig,t=h.luckysheet_select_save[0].row[0],l=h.luckysheet_select_save[0].column[0];if(n.customs[Number(e.currentTarget.dataset.index)])try{n.customs[Number(e.currentTarget.dataset.index)].onClick(e,event,{rowIndex:t,columnIndex:l})}catch(o){console.error("custom click error",o)}}),$("#luckysheet-bottom-right-add-selected").click(function(e){if(e.target.nodeName==="INPUT")return;$("#luckysheet-rightclick-menu").hide(),kl();let n=Be(),t=n.drag,l=n.info;if(h.luckysheet_select_save.length>1){at()?alert(t.noMulti):ke.info(t.noMulti,"");return}let o=$(this),a=o.find("input").val();if(!K(a)){at()?alert(l.tipInputNumber):ke.info(l.tipInputNumber,"");return}if(a=parseInt(a),a<1||a>100){at()?alert(l.tipInputNumberLimit):ke.info(l.tipInputNumberLimit,"");return}let s=h.luckysheet_select_save[0][h.luckysheetRightHeadClickIs][1];!sl.createHookFunction("rowInsertBefore",s,a,"rightbottom")||Ao(h.luckysheetRightHeadClickIs,s,a,"rightbottom")}),$("#luckysheet-del-selected, #luckysheet-del-selected_t").click(function(e){$("#luckysheet-rightclick-menu").hide(),kl();let n=Be().drag;if(h.luckysheet_select_save.length>1){h.luckysheetRightHeadClickIs=="row"?at()?alert(n.noMulti):ke.info(n.noMulti,""):h.luckysheetRightHeadClickIs=="column"&&(at()?alert(n.noMulti):ke.info(n.noMulti,""));return}let t=h.luckysheet_select_save[0][h.luckysheetRightHeadClickIs][0],l=h.luckysheet_select_save[0][h.luckysheetRightHeadClickIs][1];!sl.createHookFunction("rowDeleteBefore",t,l)||Ts(h.luckysheetRightHeadClickIs,t,l)}),$("#luckysheet-delRows").click(function(e){$("#luckysheet-rightclick-menu").hide(),kl();let n=Be().drag;if(h.luckysheet_select_save.length>1){h.luckysheetRightHeadClickIs=="row"?at()?alert(n.noMulti):ke.info(n.noMulti,""):h.luckysheetRightHeadClickIs=="column"&&(at()?alert(n.noMulti):ke.info(n.noMulti,""));return}let t=h.luckysheet_select_save[0].row[0],l=h.luckysheet_select_save[0].row[1];!sl.createHookFunction("rowDeleteBefore",t,l)||Ts("row",t,l)}),$("#luckysheet-delCols").click(function(e){$("#luckysheet-rightclick-menu").hide(),kl();let n=Be().drag;if(h.luckysheet_select_save.length>1){h.luckysheetRightHeadClickIs=="row"?at()?alert(n.noMulti):ke.info(n.noMulti,""):h.luckysheetRightHeadClickIs=="column"&&(at()?alert(n.noMulti):ke.info(n.noMulti,""));return}let t=h.luckysheet_select_save[0].column[0],l=h.luckysheet_select_save[0].column[1];Ts("column",t,l)}),$("#luckysheet-hide-selected").click(function(e){$("#luckysheet-rightclick-menu").hide(),kl();let n=Be().drag;if(h.luckysheet_select_save.length>1){h.luckysheetRightHeadClickIs=="row"?at()?alert(n.noMulti):ke.info(n.noMulti,""):h.luckysheetRightHeadClickIs=="column"&&(at()?alert(n.noMulti):ke.info(n.noMulti,""));return}if(h.luckysheetRightHeadClickIs=="row"){if(!nr(h.currentSheetIndex,"formatRows"))return;let t=$.extend(!0,{},h.config);t.rowhidden==null&&(t.rowhidden={});for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].row[0],a=h.luckysheet_select_save[l].row[1];for(let s=o;s<=a;s++)t.rowhidden[s]=0}if(h.clearjfundo){let l={};l.type="showHidRows",l.sheetIndex=h.currentSheetIndex,l.config=$.extend(!0,{},h.config),l.curconfig=t,h.jfundo.length=0,h.jfredo.push(l)}h.config=t,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,t.rowhidden,{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length)}else if(h.luckysheetRightHeadClickIs=="column"){if(!nr(h.currentSheetIndex,"formatColumns"))return;let t=$.extend(!0,{},h.config);t.colhidden==null&&(t.colhidden={});for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].column[0],a=h.luckysheet_select_save[l].column[1];for(let s=o;s<=a;s++)t.colhidden[s]=0}if(h.clearjfundo){let l={};l.type="showHidCols",l.sheetIndex=h.currentSheetIndex,l.config=$.extend(!0,{},h.config),l.curconfig=t,h.jfundo.length=0,h.jfredo.push(l)}h.config=t,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,t.colhidden,{k:"colhidden"}),tr(h.flowdata.length,h.flowdata[0].length)}}),$("#luckysheet-show-selected").click(function(e){$("#luckysheet-rightclick-menu").hide(),kl();let n=Be().drag;if(h.luckysheet_select_save.length>1){h.luckysheetRightHeadClickIs=="row"?at()?alert(n.noMulti):ke.info(n.noMulti,""):h.luckysheetRightHeadClickIs=="column"&&(at()?alert(n.noMulti):ke.info(n.noMulti,""));return}if(h.luckysheetRightHeadClickIs=="row"){if(!nr(h.currentSheetIndex,"formatRows"))return;let t=$.extend(!0,{},h.config);if(t.rowhidden==null)return;for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].row[0],a=h.luckysheet_select_save[l].row[1];for(let s=o;s<=a;s++)delete t.rowhidden[s]}if(h.clearjfundo){let l={};l.type="showHidRows",l.sheetIndex=h.currentSheetIndex,l.config=$.extend(!0,{},h.config),l.curconfig=t,h.jfundo.length=0,h.jfredo.push(l)}h.config=t,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,t.rowhidden,{k:"rowhidden"}),tr(h.flowdata.length,h.flowdata[0].length)}else if(h.luckysheetRightHeadClickIs=="column"){if(!nr(h.currentSheetIndex,"formatColumns"))return;let t=$.extend(!0,{},h.config);if(t.colhidden==null)return;for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].column[0],a=h.luckysheet_select_save[l].column[1];for(let s=o;s<=a;s++)delete t.colhidden[s]}if(h.clearjfundo){let l={};l.type="showHidCols",l.sheetIndex=h.currentSheetIndex,l.config=$.extend(!0,{},h.config),l.curconfig=t,h.jfundo.length=0,h.jfredo.push(l)}h.config=t,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,Ue.saveParam("cg",h.currentSheetIndex,t.colhidden,{k:"colhidden"}),tr(h.flowdata.length,h.flowdata[0].length)}}),$("#luckysheet-delCellsMoveLeft").click(function(e){$("body .luckysheet-cols-menu").hide(),kl();let n=Be().drag;if(h.luckysheet_select_save.length>1){at()?alert(n.noMulti):ke.info(n.noMulti,"");return}let t=h.luckysheet_select_save[0].row[0],l=h.luckysheet_select_save[0].row[1],o=h.luckysheet_select_save[0].column[0],a=h.luckysheet_select_save[0].column[1];ac("moveLeft",t,l,o,a)}),$("#luckysheet-delCellsMoveUp").click(function(e){$("body .luckysheet-cols-menu").hide(),kl();let n=Be().drag;if(h.luckysheet_select_save.length>1){at()?alert(n.noMulti):ke.info(n.noMulti,"");return}let t=h.luckysheet_select_save[0].row[0],l=h.luckysheet_select_save[0].row[1],o=h.luckysheet_select_save[0].column[0],a=h.luckysheet_select_save[0].column[1];ac("moveUp",t,l,o,a)}),$("#luckysheet-delete-text").click(function(){if(!!po(h.luckysheet_select_save,h.currentSheetIndex)&&($("#luckysheet-rightclick-menu").hide(),kl(),h.allowEdit!==!1&&h.luckysheet_select_save.length>0)){let e=It.deepCopyFlowData(h.flowdata),n=!1;for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].row[0],a=h.luckysheet_select_save[l].row[1],s=h.luckysheet_select_save[l].column[0],u=h.luckysheet_select_save[l].column[1];if(sr(h.config,o,a,s,u)){n=!0;break}}if(n){let l=Be().drag;at()?alert(l.noPartMerge):ke.info(l.noPartMerge,"");return}let t=h.luckysheetfile[Me(h.currentSheetIndex)].hyperlink;for(let l=0;l<h.luckysheet_select_save.length;l++){let o=h.luckysheet_select_save[l].row[0],a=h.luckysheet_select_save[l].row[1],s=h.luckysheet_select_save[l].column[0],u=h.luckysheet_select_save[l].column[1];for(let f=o;f<=a;f++)for(let m=s;m<=u;m++)Yt.isPivotRange(f,m)||(G(e[f][m])=="object"?(delete e[f][m].m,delete e[f][m].v,e[f][m].f!=null&&(delete e[f][m].f,y.delFunctionGroup(f,m,h.currentSheetIndex),delete e[f][m].spl),e[f][m].ct!=null&&e[f][m].ct.t=="inlineStr"&&delete e[f][m].ct):e[f][m]=null,t&&t[`${f}_${m}`]&&delete t[`${f}_${m}`])}al(e,h.luckysheet_select_save),$("#luckysheet-rich-text-editor").html("")}}),$("#luckysheet-column-row-width-selected").click(function(e){if(e.target.nodeName==="INPUT")return;$("#luckysheet-rightclick-menu").hide(),kl();let n=parseInt($(this).closest(".luckysheet-cols-menuitem").find("input[type='number']").val().trim()),t=Be().info;if(isNaN(n)){ke.info("\u53EA\u5141\u8BB8\u4F7F\u7528\u6570\u5B57\u6765\u8BBE\u7F6E\u884C\u5217\u7684\u5BBD\u9AD8!","");return}let l=$.extend(!0,{},h.config),o,a=null;if(h.luckysheetRightHeadClickIs=="row"){if(!nr(h.currentSheetIndex,"formatRows"))return;if(n<0||n>545){at()?alert(t.tipRowHeightLimit):ke.info(t.tipRowHeightLimit,"");return}o="resizeR",l.rowlen==null&&(l.rowlen={});for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].row[0],f=h.luckysheet_select_save[s].row[1];for(let m=u;m<=f;m++)l.rowlen[m]=n,a=Pt.moveChangeSize("row",m,n)}}else if(h.luckysheetRightHeadClickIs=="column"){if(!nr(h.currentSheetIndex,"formatColumns"))return;if(n<0||n>2038){at()?alert(t.tipColumnWidthLimit):ke.info(t.tipColumnWidthLimit,"");return}o="resizeC",l.columnlen==null&&(l.columnlen={});for(let s=0;s<h.luckysheet_select_save.length;s++){let u=h.luckysheet_select_save[s].column[0],f=h.luckysheet_select_save[s].column[1];for(let m=u;m<=f;m++)l.columnlen[m]=n,a=Pt.moveChangeSize("column",m,n)}}h.clearjfundo&&(h.jfundo.length=0,h.jfredo.push({type:"resize",ctrlType:o,sheetIndex:h.currentSheetIndex,config:$.extend(!0,{},h.config),curconfig:$.extend(!0,{},l),images:$.extend(!0,{},Pt.images),curImages:$.extend(!0,{},a)})),h.config=l,h.luckysheetfile[Me(h.currentSheetIndex)].config=h.config,h.luckysheetfile[Me(h.currentSheetIndex)].images=a,Ue.saveParam("all",h.currentSheetIndex,a,{k:"images"}),Pt.images=a,Pt.allImagesShow(),h.luckysheetRightHeadClickIs=="row"?(Ue.saveParam("cg",h.currentSheetIndex,l.rowlen,{k:"rowlen"}),tr(h.flowdata.length,null)):h.luckysheetRightHeadClickIs=="column"&&(Ue.saveParam("cg",h.currentSheetIndex,l.columnlen,{k:"columnlen"}),tr(null,h.flowdata[0].length))})}function y_(){h.luckysheet_cols_change_size=!1,$("#luckysheet-change-size-line").hide(),$("#luckysheet-cols-change-size").css("opacity",0),$("#luckysheet-sheettable, #luckysheet-cols-h-c, .luckysheet-cols-h-cells, .luckysheet-cols-h-cells canvas").css("cursor","default");let e=wl(event.pageX,event.pageY),n=$("#luckysheet-cols-h-c").scrollLeft(),t=e[0]+n,l=Zl(t)[2],o=It.deepCopyFlowData(h.flowdata),a=$("#luckysheetTableContent").get(0).getContext("2d"),s=$.extend(!0,{},h.config);s.columnlen==null&&(s.columnlen={});let u={},f=$("#luckysheet-cell-main").scrollTop(),m=h.luckysheetTableContentHW[1],d=$l(h.visibledatarow,f),p=$l(h.visibledatarow,f+m);p+=p-d,p>=o.length&&(p=o.length-1);for(let b=0;b<h.luckysheet_select_save.length;b++){let g=h.luckysheet_select_save[b].column[0],v=h.luckysheet_select_save[b].column[1];if(l<g||l>v){if(l in u)continue;let x=h.defaultcollen;for(let _=d;_<=p;_++){let S=o[_][l];if(S==null||ft(S.v)&&!Wn(S))continue;let I=or(l)[1]-or(l)[0]-2,P=Mo(S,a,{r:_,c:l,cellWidth:I}),F=0;P!=null&&(F=P.textWidthAll),F+6>x&&(x=F+6)}x!=h.defaultcollen&&(s.columnlen[l]=x,s.customWidth&&delete s.customWidth[l]),u[l]=1}else for(let x=g;x<=v;x++){if(x in u)continue;let _=h.defaultcollen;for(let S=d;S<=p;S++){let I=o[S][x];if(I==null||ft(I.v)&&!Wn(I))continue;let P=or(x)[1]-or(x)[0]-2,F=Mo(I,a,{r:S,c:x,cellWidth:P}),D=0;F!=null&&(D=F.textWidthAll),D+6>_&&(_=D+6)}_!=h.defaultcollen&&(s.columnlen[x]=_,s.customWidth&&delete s.customWidth[x]),u[x]=1}}Li(h.flowdata[0].length,h.flowdata.length,h.flowdata,s,h.luckysheet_select_save,"resizeC","columnlen")}var import_plugin,dk=Nt(()=>{import_plugin=qe(Ye());_a();ta();Qo();ln();qr();wi();jr();Ol();fr();Ri();cr();Xc();Sr();sc();Ar();Er();Kr();Wr();Xl();fo();Go();Ya();hi();il();Vn()});function Jh(e,n,t,l){if($("#luckysheet-formula-search-c").is(":visible")&&(e=="up"||e=="down")){let o;e=="down"?(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").next(),o.length==0&&(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").first())):e=="up"&&(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active").prev(),o.length==0&&(o=$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").last())),$("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item").removeClass("luckysheet-formula-search-item-active"),o.addClass("luckysheet-formula-search-item-active"),l.preventDefault()}else if($("#luckysheet-formula-functionrange-select").is(":visible")){if(n&&t)xa(e,"rangeOfFormula");else if(n)ic(e,"rangeOfFormula");else if(t){let o=e,a=1;e=="up"&&(o="down",a=-1),e=="left"&&(o="right",a=-1),$s(o,a,"rangeOfFormula")}else{let o=e,a=1;e=="up"&&(o="down",a=-1),e=="left"&&(o="right",a=-1),Cr(o,a,"rangeOfFormula")}l.preventDefault()}else if(y.israngeseleciton()){let o=$(window.getSelection().anchorNode);if(o.parent().next().text()==null||o.parent().next().text()==""){let a=$("#luckysheet-input-box #luckysheet-input-box-index").text(),s=y.getcellrange(a);s==null&&(s=y.getcellrange($("#luckysheet-input-box-index").text()));let u=s.row[0],f=s.row[1],m=s.column[0],d=s.column[1],p=h.visibledatarow[f],b=u-1==-1?0:h.visibledatarow[u-1],g=h.visibledatacolumn[d],v=m-1==-1?0:h.visibledatacolumn[m-1];if(y.func_selectedrange={left:v,width:g-v-1,top:b,height:p-b-1,left_move:v,width_move:g-v-1,top_move:b,height_move:p-b-1,row:[u,f],column:[m,d],row_focus:u,column_focus:m},y.rangeSetValue({row:[u,f],column:[m,d]}),y.rangestart=!0,y.rangedrag_column_start=!1,y.rangedrag_row_start=!1,n&&t)xa(e,"rangeOfFormula");else if(n)ic(e,"rangeOfFormula");else if(t){let x=e,_=1;e=="up"&&(x="down",_=-1),e=="left"&&(x="right",_=-1),$s(x,_,"rangeOfFormula")}else{let x=e,_=1;e=="up"&&(x="down",_=-1),e=="left"&&(x="right",_=-1),Cr(x,_,"rangeOfFormula")}l.preventDefault()}}else if(!n&&!t){let o=$(window.getSelection().anchorNode),a=window.getSelection().anchorOffset;e=="up"?o.parent().is("span")&&o.parent().next().length==0&&a>0?(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("down",-1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&o.context.childElementCount==a?(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("down",-1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&o.context.length==a&&(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("down",-1,"rangeOfSelect"),l.preventDefault()):e=="down"?o.parent().is("span")&&o.parent().next().length==0&&a>0?(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("down",1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&o.context.childElementCount==a?(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("down",1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&o.context.length==a&&(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("down",1,"rangeOfSelect"),l.preventDefault()):e=="left"?o.parent().is("span")&&o.parent().prev().length==0&&a==0?(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("right",-1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&a==1?(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("right",-1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&a==0?(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("right",-1,"rangeOfSelect"),l.preventDefault()):y.rangeHightlightselected($("#luckysheet-rich-text-editor")):e=="right"&&(o.parent().is("span")&&o.parent().next().length==0&&a>0?(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("right",1,"rangeOfSelect"),l.preventDefault()):o.is("#luckysheet-rich-text-editor")&&o.context.childElementCount==a?(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("right",1,"rangeOfSelect"),l.preventDefault()):o.parent().is("#luckysheet-rich-text-editor")&&o.context.length==a?(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("right",1,"rangeOfSelect"),l.preventDefault()):y.rangeHightlightselected($("#luckysheet-rich-text-editor")))}}function gk(){let n=Be().drag;$("#luckysheet-input-box").click(function(){y.rangeHightlightselected($("#luckysheet-rich-text-editor"))}).add("#"+h.container).on("keydown",function(t){let l=t.ctrlKey,o=t.altKey,a=t.shiftKey,s=t.keyCode;if($("#luckysheet-modal-dialog-mask").is(":visible")||$(t.target).hasClass("luckysheet-mousedown-cancel")||$(t.target).hasClass("sp-input")||parseInt($("#luckysheet-input-box").css("top"))>0&&$(t.target).closest(".luckysheet-input-box").length>0&&s!=xl.ENTER&&s!=xl.TAB&&s!=xl.UP&&s!=xl.DOWN&&s!=xl.LEFT&&s!=xl.RIGHT){let f=$(window.getSelection().anchorNode);if((f.parent().is("#luckysheet-helpbox-cell")||f.is("#luckysheet-helpbox-cell"))&&s==xl.ENTER){let m=$("#luckysheet-helpbox-cell").text();if(y.iscelldata(m)){let d=y.getcellrange(m);h.luckysheet_select_save=[{row:d.row,column:d.column,row_focus:d.row[0],column_focus:d.column[0]}],gl(),$("#luckysheet-helpbox-cell").blur();let p=$("#luckysheet-cell-main").scrollLeft(),b=$("#luckysheet-cell-main").scrollTop(),g=$("#luckysheet-cell-main").height(),v=$("#luckysheet-cell-main").width(),x=h.visibledatarow[d.row[1]],_=d.row[0]-1==-1?0:h.visibledatarow[d.row[0]-1],S=h.visibledatacolumn[d.column[1]],I=d.column[0]-1==-1?0:h.visibledatacolumn[d.column[0]-1];S-p-v+20>0?$("#luckysheet-scrollbar-x").scrollLeft(S-v+20):I-p-20<0&&$("#luckysheet-scrollbar-x").scrollLeft(I-20),x-b-g+20>0?$("#luckysheet-scrollbar-y").scrollTop(x-g+20):_-b-20<0&&$("#luckysheet-scrollbar-y").scrollTop(_-20)}}return}if($("#luckysheet-modal-dialog-mask").is(":visible")||$(t.target).hasClass("luckysheet-mousedown-cancel")||$(t.target).hasClass("formulaInputFocus"))return;let u=$("#luckysheet-input-box");if((o||t.metaKey)&&s==xl.ENTER&&parseInt(u.css("top"))>0){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;_y(h.flowdata[m][d]),t.preventDefault()}else if(s==xl.ENTER&&parseInt(u.css("top"))>0)$("#luckysheet-formula-search-c").is(":visible")&&y.searchFunctionCell!=null?y.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),h.luckysheet_select_save=[{row:[h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[0]],column:[h.luckysheetCellUpdate[1],h.luckysheetCellUpdate[1]],row_focus:h.luckysheetCellUpdate[0],column_focus:h.luckysheetCellUpdate[1]}],Cr("down",1,"rangeOfSelect")),$("#luckysheet-search-formula-parm").is(":visible")&&$("#luckysheet-search-formula-parm").hide(),$("#luckysheet-search-formula-parm-select").is(":visible")&&$("#luckysheet-search-formula-parm-select").hide(),t.preventDefault();else if(s==xl.TAB){if(parseInt(u.css("top"))>0)return;Cr("right",1,"rangeOfSelect"),t.preventDefault()}else if(s==xl.F2){if(parseInt(u.css("top"))>0)return;let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;ti(m,d,h.flowdata),t.preventDefault()}else if(s==xl.F4&&parseInt(u.css("top"))>0)y.setfreezonFuc(t),t.preventDefault();else if(s==xl.ESC&&parseInt(u.css("top"))>0)y.dontupdate(),Cr("down",0,"rangeOfSelect"),t.preventDefault();else if(s==xl.ENTER){if($(t.target).hasClass("formulaInputFocus")||$("#luckysheet-conditionformat-dialog").is(":visible"))return;if(String.fromCharCode(s)!=null&&$("#luckysheet-cell-selected").is(":visible")){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;ti(m,d,h.flowdata),t.preventDefault()}}else if(l||t.metaKey){if(a){if(mk||(h.luckysheet_shiftpositon=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),h.luckysheet_shiftkeydown=!0),s==xl.UP){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;xa("up","rangeOfSelect")}else if(s==xl.DOWN){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;xa("down","rangeOfSelect")}else if(s==xl.LEFT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;xa("left","rangeOfSelect")}else if(s==xl.RIGHT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;xa("right","rangeOfSelect")}else if(s==186||s==222){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;ti(m,d,h.flowdata,!0);let p=Xh(2);$("#luckysheet-rich-text-editor").html(p),To($("#luckysheet-rich-text-editor")[0]),y.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}}else if(s==66)$("#luckysheet-icon-bold").click();else if(s==67){if(Pt.currentImgId!=null){Pt.copyImgItem(t);return}if(_t.luckysheetPaintModelOn&&_t.cancelPaintModel(),h.luckysheet_select_save.length==0)return;if(h.config.merge!=null){let m=!1;for(let d=0;d<h.luckysheet_select_save.length;d++){let p=h.luckysheet_select_save[d].row[0],b=h.luckysheet_select_save[d].row[1],g=h.luckysheet_select_save[d].column[0],v=h.luckysheet_select_save[d].column[1];if(m=sr(h.config,p,b,g,v),m)break}if(m){at()?alert(n.noMerge):ke.info(n.noMerge,"");return}}let f=h.luckysheetfile[Me(h.currentSheetIndex)].luckysheet_conditionformat_save;if(h.luckysheet_select_save.length>1&&f!=null&&f.length>0){let m=!1,d=Mt.getComputeMap();e:for(let p=0;p<h.luckysheet_select_save.length&&!m;p++){let b=h.luckysheet_select_save[p].row[0],g=h.luckysheet_select_save[p].row[1],v=h.luckysheet_select_save[p].column[0],x=h.luckysheet_select_save[p].column[1];for(let _=b;_<=g;_++)for(let S=v;S<=x;S++)if(Mt.checksCF(_,S,d)!=null){m=!0;continue e}}if(m){at()?alert(n.noMulti):ke.info(n.noMulti,"");return}}if(h.luckysheet_select_save.length>1){let m=!0,d=h.luckysheet_select_save[0].row[0],p=h.luckysheet_select_save[0].row[1],b=!0,g=h.luckysheet_select_save[0].column[0],v=h.luckysheet_select_save[0].column[1];for(let x=1;x<h.luckysheet_select_save.length;x++)(h.luckysheet_select_save[x].row[0]!=d||h.luckysheet_select_save[x].row[1]!=p)&&(m=!1),(h.luckysheet_select_save[x].column[0]!=g||h.luckysheet_select_save[x].column[1]!=v)&&(b=!1);if(!m&&!b||na()){at()?alert(n.noMulti):ke.info(n.noMulti,"");return}}Ql.copy(t),h.luckysheet_paste_iscut=!1,Eo(),t.stopPropagation();return}else if(s==70)is.createDialog(0),is.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(s==72)is.createDialog(1),is.init(),$("#luckysheet-search-replace #searchInput input").focus();else if(s==73)$("#luckysheet-icon-italic").click();else if(s==86){if(at()||h.allowEdit===!1||$(t.target).hasClass("formulaInputFocus"))return;if(h.luckysheet_select_save.length>1){at()?alert(n.noPaste):ke.info(n.noPaste,"");return}Ql.isPasteAction=!0,Eo(),t.stopPropagation();return}else if(s==88){if(_t.luckysheetPaintModelOn&&_t.cancelPaintModel(),h.luckysheet_select_save.length==0)return;if(h.config.merge!=null){let f=!1;for(let m=0;m<h.luckysheet_select_save.length;m++){let d=h.luckysheet_select_save[m].row[0],p=h.luckysheet_select_save[m].row[1],b=h.luckysheet_select_save[m].column[0],g=h.luckysheet_select_save[m].column[1];if(f=sr(h.config,d,p,b,g),f)break}if(f){ut.editMode?alert(_locale_drag.noMerge):ke.info(_locale_drag.noMerge,"");return}}if(h.luckysheet_select_save.length>1){at()?alert(n.noMulti):ke.info(n.noMulti,"");return}Ql.copy(t),h.luckysheet_paste_iscut=!0,Eo(),t.stopPropagation();return}else if(s==90){ns.redo(t),Eo(),t.stopPropagation();return}else if(s==89){ns.undo(t),Eo(),t.stopPropagation();return}else if(s==xl.UP){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ic("up","rangeOfSelect")}else if(s==xl.DOWN){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ic("down","rangeOfSelect")}else if(s==xl.LEFT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ic("left","rangeOfSelect")}else if(s==xl.RIGHT){if(parseInt(u.css("top"))>0||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;ic("right","rangeOfSelect")}else if(s==186){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;ti(m,d,h.flowdata,!0);let p=Xh(1);$("#luckysheet-rich-text-editor").html(p),To($("#luckysheet-rich-text-editor")[0]),y.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}else if(s==222){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;ti(m,d,h.flowdata,!0);let p=Xh(2);$("#luckysheet-rich-text-editor").html(p),To($("#luckysheet-rich-text-editor")[0]),y.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}else String.fromCharCode(s).toLocaleUpperCase()=="A"&&$("#luckysheet-left-top").click();t.preventDefault();return}else if(a&&(s==xl.UP||s==xl.DOWN||s==xl.LEFT||s==xl.RIGHT||o&&(s==53||s==101))){if(parseInt(u.css("top"))>0||$(t.target).hasClass("formulaInputFocus"))return;if(mk||(h.luckysheet_shiftpositon=$.extend(!0,{},h.luckysheet_select_save[h.luckysheet_select_save.length-1]),h.luckysheet_shiftkeydown=!0),s==xl.UP){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;$s("down",-1,"rangeOfSelect")}else if(s==xl.DOWN){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;$s("down",1,"rangeOfSelect")}else if(s==xl.LEFT){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;$s("right",-1,"rangeOfSelect")}else if(s==xl.RIGHT){if($("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;$s("right",1,"rangeOfSelect")}else o&&(s==53||s==101)&&$("#luckysheet-icon-strikethrough").click();t.preventDefault()}else if(s==xl.ESC)_t.luckysheetPaintModelOn?_t.cancelPaintModel():(Jr(t),t.preventDefault()),gl();else if(s==xl.DELETE||s==xl.BACKSPACE)Pt.currentImgId!=null?Pt.removeImgItem():$("#luckysheet-delete-text").click(),t.preventDefault();else if(s==8&&Pt.currentImgId!=null)Pt.removeImgItem(),t.preventDefault();else if(s==xl.UP){if(parseInt(u.css("top"))>0||h.luckysheet_cell_selected_move||h.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Cr("down",-1,"rangeOfSelect"),t.preventDefault()}else if(s==xl.DOWN){if(parseInt(u.css("top"))>0||h.luckysheet_cell_selected_move||h.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Cr("down",1,"rangeOfSelect"),t.preventDefault()}else if(s==xl.LEFT){if(parseInt(u.css("top"))>0||h.luckysheet_cell_selected_move||h.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Cr("right",-1,"rangeOfSelect"),t.preventDefault()}else if(s==xl.RIGHT){if(parseInt(u.css("top"))>0||h.luckysheet_cell_selected_move||h.luckysheet_cell_selected_extend||$(t.target).hasClass("formulaInputFocus")||$("#luckysheet-singleRange-dialog").is(":visible")||$("#luckysheet-multiRange-dialog").is(":visible"))return;Cr("right",1,"rangeOfSelect"),t.preventDefault()}else if((!(s>=112&&s<=123||s<=46||s==144||s==108||t.ctrlKey||t.altKey||t.shiftKey&&(s==37||s==38||s==39||s==40))||s==8||s==32||s==46||s==0||t.ctrlKey&&s==86)&&String.fromCharCode(s)!=null&&$("#luckysheet-cell-selected").is(":visible")&&s!=xl.CAPSLOCK&&s!=xl.WIN&&s!=18){let f=h.luckysheet_select_save[h.luckysheet_select_save.length-1],m=f.row_focus,d=f.column_focus;ti(m,d,h.flowdata,!0),s==8&&$("#luckysheet-rich-text-editor").html("<br/>"),y.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s)}Eo(),t.stopPropagation()}),$("#"+h.container).add("#luckysheet-input-box").keydown(function(t){if($("#luckysheet-modal-dialog-mask").is(":visible")||$(t.target).hasClass("luckysheet-mousedown-cancel")||$(t.target).hasClass("formulaInputFocus"))return;let l=t.ctrlKey,o=t.altKey,a=t.shiftKey,s=t.keyCode,u=$("#luckysheet-input-box");s==xl.ESC&&parseInt($("#luckysheet-input-box").css("top"))>0?(y.dontupdate(),Cr("down",0,"rangeOfSelect"),t.preventDefault()):s==xl.ENTER&&parseInt(u.css("top"))>0?$("#luckysheet-formula-search-c").is(":visible")&&y.searchFunctionCell!=null&&(y.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")),t.preventDefault()):s==xl.TAB&&parseInt(u.css("top"))>0?($("#luckysheet-formula-search-c").is(":visible")&&y.searchFunctionCell!=null?y.searchFunctionEnter($("#luckysheet-formula-search-c").find(".luckysheet-formula-search-item-active")):(y.updatecell(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1]),Cr("right",1,"rangeOfSelect")),t.preventDefault()):s==xl.F4&&parseInt(u.css("top"))>0?(y.setfreezonFuc(t),t.preventDefault()):s==xl.UP&&parseInt(u.css("top"))>0?Jh("up",l,a,t):s==xl.DOWN&&parseInt(u.css("top"))>0?Jh("down",l,a,t):s==xl.LEFT&&parseInt(u.css("top"))>0?Jh("left",l,a,t):s==xl.RIGHT&&parseInt(u.css("top"))>0?Jh("right",l,a,t):(!(s>=112&&s<=123||s<=46||s==144||s==108||t.ctrlKey||t.altKey||t.shiftKey&&(s==37||s==38||s==39||s==40||s==xl.WIN||s==xl.WIN_R||s==xl.MENU))||s==8||s==32||s==46||t.ctrlKey&&s==86)&&(y.functionInputHanddler($("#luckysheet-functionbox-cell"),$("#luckysheet-rich-text-editor"),s),O1(h.luckysheetCellUpdate[0],h.luckysheetCellUpdate[1],h.flowdata))}).keyup(function(t){let l=t.keyCode;!t.shiftKey&&l==16&&(h.luckysheet_shiftkeydown=!1,h.luckysheet_shiftpositon=null),parseInt($("#luckysheet-input-box").css("top"))>0&&(l==13||l==16||l==32),t.preventDefault()}),$("#luckysheet_info_detail_input").val(Ue.title).css("width",dc(Ue.title)*10).keydown(function(){let t=event.ctrlKey,l=event.altKey,o=event.shiftKey,a=event.keyCode,s=$(this);a==xl.ENTER&&s.blur().change()}).bind("input propertychange",function(){let t=$(this),l=dc(t.val())*10,o=$("#luckysheet_info_detail_update").outerWidth(),a=$("#luckysheet_info_detail_save").outerWidth(),s=$("#luckysheet_info_detail_user").parent().outerWidth()+60,u=$("#"+h.container).outerWidth(),f=100,m=u-a-o-s-f;l>m?$("#luckysheet_info_detail_input").css("width",m):$("#luckysheet_info_detail_input").css("width",l)}).change(function(){Ue.saveParam("na",null,$(this).val())}),$("#"+h.container).add("input.luckysheet-mousedown-cancel").keydown(function(t){let l=t.target.closest(".luckysheet-cols-menuitem");typeof l!="undefined"&&l!=null&&t.keyCode===13&&$(l).trigger("click")})}var import_plugin,mk,pk=Nt(()=>{import_plugin=qe(Ye());Vn();ln();mo();qr();gc();Rr();Kc();jr();ou();Og();zh();Qo();Ol();fr();cr();Ga();Sr();Jo();Kr();Xl();Ya();il();mk=!1});function vk(){let e=Be();$("#luckysheetorderbyasc, #luckysheetorderbyasc_t").mousedown(function(t){Jr(t),Ym(h.orderbyindex,!0),gl()}),$("#luckysheetorderbydesc, #luckysheetorderbydesc_t").click(function(t){Jr(t),Ym(h.orderbyindex,!1),gl()});let n=!0;$("#luckysheetorderby").click(function(){if(!nr(h.currentSheetIndex,"sort"))return;$("body .luckysheet-cols-menu").hide();let t=e.sort;if(h.luckysheet_select_save.length>1){at()?alert(t.noRangeError):ke.info(t.noRangeError,"");return}let l=h.luckysheet_select_save[0],o=l.row[0],a=l.row[1],s=l.column[0],u=l.column[1];if(n){n=!1;let _=`<div style="overflow: hidden;" class="luckysheet-sort-modal"><div><label><input type="checkbox" id="luckysheet-sort-haveheader"/><span>${t.hasTitle}</span></label></div><div style="overflow-y:auto;" id="luckysheet-sort-dialog-tablec"><table data-itemcount="0" cellspacing="0"> <tr><td>${t.hasTitle} <select name="sort_0"> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> </select> </td> <td> <div><label><input value="asc" type="radio" checked="checked" name="sort_0"><span>${t.asc}A-Z</span></label></div> <div><label><input value="desc" type="radio" name="sort_0"><span>${t.desc}Z-A</span></label></div></td></tr></table></div><div style="background: #e5e5e5;border-top: 1px solid #f5f5f5; height: 1px; width: 100%;margin:2px 0px;margin-bottom:10px;"></div> <div> <span style="font-weight: bold; text-decoration: underline;text-align:center;color: blue;cursor: pointer;" class="luckysheet-sort-dialog-additem">+ ${t.addOthers}</span> </div> </div>`;$("body").first().append(Tt(Ll,{id:"luckysheet-sort-dialog",addclass:"",title:e.sort.sortTitle,content:_,botton:`<button id="luckysheet-sort-modal-confirm" class="btn btn-primary">${t.confirm}</button><button class="btn btn-default luckysheet-model-close-btn">${t.close}</button>`})),$("#luckysheet-sort-dialog .luckysheet-sort-dialog-additem").click(function(){let S=h.luckysheet_select_save[0],I=S.row[0],P=S.row[1],F=S.column[0],D=S.column[1],k="",w=$("#luckysheet-sort-dialog table").data("itemcount")+1,C=$("#luckysheet-sort-haveheader").is(":checked");for(let T=F;T<=D;T++)if(C){let O=Vt(I,T,h.flowdata,"m");O==null&&(O=t.columnOperation+(T-F+1)),k+='<option value="'+T+'">'+O+"</option>"}else k+='<option value="'+T+'">'+yl(T)+"</option>";$("#luckysheet-sort-dialog table").append(`
                    <tr class="luckysheet-sort-dialog-tr">
                        <td><span class="luckysheet-sort-item-close" onclick="$(this).parent().parent().remove();"><i class="fa fa-times"
                                    aria-hidden="true"></i></span>${t.secondaryTitle} <select
                                name="sort_${w}">${k}</select> </td>
                        <td>
                            <div><label><input value="asc" type="radio" checked="checked"
                                        name="sort_${w}"><span>${t.asc}A-Z</span></label></div>
                            <div><label><input value="desc" type="radio" name="sort_${w}"><span>${t.desc}Z-A</span></label>
                            </div>
                        </td>
                    </tr>
                `),$("#luckysheet-sort-dialog table").data("itemcount",w)}),$("#luckysheet-sort-haveheader").change(function(){let S=h.luckysheet_select_save[0],I=S.row[0],P=S.row[1],F=S.column[0],D=S.column[1],k=$(this).is(":checked"),w="";for(let C=F;C<=D;C++)if(k){let T=Vt(I,C,h.flowdata,"m");T==null&&(T=t.columnOperation+(C-F+1)),w+='<option value="'+C+'">'+T+"</option>"}else w+='<option value="'+C+'">'+yl(C)+"</option>";$("#luckysheet-sort-dialog tr select").each(function(){$(this).html(w)})}),$("#luckysheet-sort-modal-confirm").click(function(){if(h.luckysheet_select_save.length>1){at()?alert(t.noRangeError):ke.info(t.noRangeError,"");return}let S=It.deepCopyFlowData(h.flowdata),I=h.luckysheet_select_save[0],P=I.row[0],F=I.row[1],D=I.column[0],k=I.column[1],w=$("#luckysheet-sort-haveheader").is(":checked"),C;w?C=P+1:C=P;let T=!1,O=[];for(let A=C;A<=F;A++){let E=[];for(let L=D;L<=k;L++){if(S[A][L]!=null&&S[A][L].mc!=null){T=!0;break}E.push(S[A][L])}O.push(E)}if(T){at()?alert(t.mergeError):ke.info(t.mergeError,"");return}$($("#luckysheet-sort-dialog table tr").toArray().reverse()).each(function(){let A=$(this).find("select").val(),E=$(this).find("input:radio:checked").val();A-=D,E=="asc"?E=!0:E=!1,O=Ko([].concat(O),A,E)});for(let A=C;A<=F;A++)for(let E=D;E<=k;E++)S[A][E]=O[A-C][E-D];let z={};if(h.config.rowlen!=null){let A=$.extend(!0,{},h.config);A=Cn(S,C,F,A),z={cfg:A,RowlChange:!0}}al(S,[{row:[C,F],column:[D,k]}],z),$("#luckysheet-sort-dialog").hide(),$("#luckysheet-modal-dialog-mask").hide()})}let f="";for(let _=s;_<=u;_++)f+='<option value="'+_+'">'+yl(_)+"</option>";$("#luckysheet-sort-dialog select").html(f),$("#luckysheet-sort-dialog .luckysheet-sort-dialog-tr").remove(),$("#luckysheet-sort-haveheader").prop("checked",!1),$("#luckysheet-sort-dialog input:radio:first").prop("checked","checked"),$("#luckysheet-sort-dialog .luckysheet-modal-dialog-title-text").html(t.sortRangeTitle+"<span>"+yl(s)+(o+1)+"</span>"+t.sortRangeTitleTo+"<span>"+yl(u)+(a+1)+"</span>");let m=$("#luckysheet-sort-dialog"),d=m.outerHeight(),p=m.outerWidth(),b=$(window).width(),g=$(window).height(),v=$(document).scrollLeft(),x=$(document).scrollTop();$("#luckysheet-sort-dialog-tablec").css("max-height",(g-d)/2),$("#luckysheet-sort-dialog").css({left:(b+v-p)/2,top:(g+x-d)/2}).show(),$("#luckysheet-modal-dialog-mask").show(),o<a&&setTimeout(function(){let _=h.flowdata[o],S=h.flowdata[o+1],I=!1;for(let P=s;P<=u;P++){let F=Yi(_[P]),D=Yi(S[P]);F!=D&&(I=!0)}I&&$("#luckysheet-sort-haveheader").prop("checked",!0).change()},10)})}var import_plugin,yk=Nt(()=>{import_plugin=qe(Ye());Rr();jr();hi();Ol();fo();cr();Jo();Ar();Er();oc();Kr();Wr();Xo();il();Xl()});function kk(e,n){Mh(b_),Fh(k_,null,function(){})}var import_plugin,k_,b_,bk=Nt(()=>{import_plugin=qe(Ye());Ol();k_=["http://localhost:8080/luckysheetPluginPrint.umd.js"],b_=["http://localhost:8080/luckysheetPluginPrint.css"]});function wk(e,n){e.length&&e.forEach(t=>{w_[t](n,x_)})}var import_plugin,w_,x_,xk=Nt(()=>{import_plugin=qe(Ye());Rh();bk();w_={chart:v1,print:kk},x_=!0});var import_plugin,ve,bf,__,_k,Ck=Nt(()=>{import_plugin=qe(Ye());Vn();mf();og();fr();ln();Qm();Sr();hf();Wr();Xo();cr();Ar();ui();oc();Er();Ol();il();ve=qe(Za()),bf=qe(nc()),__={SUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else if(K(l))t.push(l);else if(G(l)=="boolean")l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0);else return y.error.v}var o=0;if(t.length>0)for(var e=0;e<t.length;e++){if(re(t[e]))return t[e];!K(t[e])||(o=er(o,"+",t[e]))}return o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},AVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array")if(G(l[0])=="array"){if(!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else t=t.concat(l);else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"text",!0)):t.push(l)}for(var o=0,a=0,e=0;e<t.length;e++){if(re(t[e]))return t[e];if(!K(t[e]))return y.error.v;o=er(o,"+",t[e]),a++}return a==0?y.error.d:er(o,"/",a)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},COUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array")if(G(l[0])=="array"){if(!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else t=t.concat(l);else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"text",!0)):G(l)=="boolean"?l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0):t.push(l)}for(var o=0,e=0;e<t.length;e++)K(t[e])&&o++;return o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},COUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array")if(G(l[0])=="array"){if(!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l))}else t=t.concat(l);else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"text",!0)):t.push(l)}return t.length}catch(o){return o=y.errorInfo(o),[y.error.v,o]}},MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array")if(G(l[0])=="array"){if(!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else t=t.concat(l);else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=null,e=0;e<t.length;e++){if(re(t[e]))return t[e];!K(t[e])||(o==null||parseFloat(t[e])>o)&&(o=parseFloat(t[e]))}return o??0}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array")if(G(l[0])=="array"){if(!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else t=t.concat(l);else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=null,e=0;e<t.length;e++){if(re(t[e]))return t[e];!K(t[e])||(o==null||parseFloat(t[e])<o)&&(o=parseFloat(t[e]))}return o??0}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},AGE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return y.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(re(l))return l;l=(0,ve.default)(l);var o=(0,ve.default)();if(arguments.length==2){if(o=q.getFirstValue(arguments[1]),re(o))return o;o=(0,ve.default)(o)}var a=o.diff(l,"years");return a<0||a.toString()=="NaN"?y.error.v:a}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},SEX_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]).toString();return re(t)?t:window.luckysheet_function.ISIDCARD.f(t)?parseInt(t.substr(16,1))%2==1?"\u7537":"\u5973":y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},BIRTHDAY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]).toString();if(re(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return y.error.v;var l="";if(t.length==15){var o="19"+t.substring(6,8)+"/"+t.substring(8,10)+"/"+t.substring(10,12);l=o}else if(t.length==18){var o=t.substring(6,10)+"/"+t.substring(10,12)+"/"+t.substring(12,14);l=o}var a=0;if(arguments[1]!=null&&(a=q.getFirstValue(arguments[1]),re(a)))return a;if(!K(a))return y.error.v;if(a=parseInt(a),a<0||a>2)return y.error.v;if(parseInt(a)==0)return l;if(parseInt(a)==1)return(0,ve.default)(l).format("YYYY-MM-DD");if(parseInt(a)==2)return(0,ve.default)(l).format("YYYY\u5E74M\u6708D\u65E5")}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},PROVINCE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]).toString();if(re(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return y.error.v;var l="\u672A\u77E5",o=y.classlist.province;return t.substring(0,2)in o&&(l=o[t.substring(0,2)]),l}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},CITY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]).toString();if(re(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return y.error.v;for(var l=cityData.length,o="\u672A\u77E5",e=0;e<l;e++)if(t.substring(0,6)==cityData[e].code){o=cityData[e].title;break}return o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},STAR_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return y.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(re(l))return l;l=new Date(l);var o=l.getMonth(),a=l.getDate(),s=new Date(1999,o,a,0,0,0),u=[];u.push(["\u9B54\u7FAF\u5EA7",new Date(1999,0,1,0,0,0)]),u.push(["\u6C34\u74F6\u5EA7",new Date(1999,0,20,0,0,0)]),u.push(["\u53CC\u9C7C\u5EA7",new Date(1999,1,19,0,0,0)]),u.push(["\u767D\u7F8A\u5EA7",new Date(1999,2,21,0,0,0)]),u.push(["\u91D1\u725B\u5EA7",new Date(1999,3,21,0,0,0)]),u.push(["\u53CC\u5B50\u5EA7",new Date(1999,4,21,0,0,0)]),u.push(["\u5DE8\u87F9\u5EA7",new Date(1999,5,22,0,0,0)]),u.push(["\u72EE\u5B50\u5EA7",new Date(1999,6,23,0,0,0)]),u.push(["\u5904\u5973\u5EA7",new Date(1999,7,23,0,0,0)]),u.push(["\u5929\u79E4\u5EA7",new Date(1999,8,23,0,0,0)]),u.push(["\u5929\u874E\u5EA7",new Date(1999,9,23,0,0,0)]),u.push(["\u5C04\u624B\u5EA7",new Date(1999,10,22,0,0,0)]),u.push(["\u9B54\u7FAF\u5EA7",new Date(1999,11,22,0,0,0)]);for(var e=u.length-1;e>=0;e--)if(s>=u[e][1])return u[e][0];return"\u672A\u627E\u5230\u5339\u914D\u661F\u5EA7\u4FE1\u606F"}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},ANIMAL_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!window.luckysheet_function.ISIDCARD.f(t))return y.error.v;var l=window.luckysheet_function.BIRTHDAY_BY_IDCARD.f(t);if(re(l))return l;l=new Date(l);var o=new Array("\u732A","\u9F20","\u725B","\u864E","\u5154","\u9F99","\u86C7","\u9A6C","\u7F8A","\u7334","\u9E21","\u72D7"),a=(parseInt(l.getFullYear())+9)%12;return a!=null&&!isNaN(a)?o[a]:"\u672A\u627E\u5230\u5339\u914D\u751F\u8096\u4FE1\u606F"}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},ISIDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;var l=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return!!l.test(t)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},DM_TEXT_CUTWORD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=q.getFirstValue(arguments[0],"text");if(re(a))return a;var s=0;return arguments[1]!=null&&(s=q.getFirstValue(arguments[1]),re(s))?s:K(s)?(s=parseInt(s),s!=0&&s!=1&&s!=2?y.error.v:($.post("/dataqk/tu/api/cutword",{text:a,type:s},function(f){var m=[].concat(h.flowdata);y.execFunctionGroup(t,l,f),m[t][l]={v:f,f:o},al(m,[{row:[t,t],column:[l,l]}])}),"loading...")):y.error.v}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},DM_TEXT_TFIDF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=q.getFirstValue(arguments[0],"text");if(re(a))return a;var s=20;if(arguments[1]!=null&&(s=q.getFirstValue(arguments[1]),re(s)))return s;if(!K(s))return y.error.v;s=parseInt(s);var u=0;return arguments[2]!=null&&(u=q.getFirstValue(arguments[2]),re(u))?u:K(u)?(u=parseInt(u),s<0?y.error.v:u!=0&&u!=1&&u!=2?y.error.v:($.post("/dataqk/tu/api/tfidf",{text:a,count:s,set:u},function(m){var d=It.deepCopyFlowData(h.flowdata);y.execFunctionGroup(t,l,m),d[t][l]={v:m,f:o},al(d,[{row:[t,t],column:[l,l]}])}),"loading...")):y.error.v}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},DM_TEXT_TEXTRANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=q.getFirstValue(arguments[0],"text");if(re(a))return a;var s=20;if(arguments[1]!=null&&(s=q.getFirstValue(arguments[1]),re(s)))return s;if(!K(s))return y.error.v;s=parseInt(s);var u=0;return arguments[2]!=null&&(u=q.getFirstValue(arguments[2]),re(u))?u:K(u)?(u=parseInt(u),s<0?y.error.v:u!=0&&u!=1&&u!=2?y.error.v:($.post("/dataqk/tu/api/tfidf",{text:a,count:s,set:u},function(m){var d=It.deepCopyFlowData(h.flowdata);y.execFunctionGroup(t,l,m),d[t][l]={v:m,f:o},al(d,[{row:[t,t],column:[l,l]}])}),"loading...")):y.error.v}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},DATA_CN_STOCK_CLOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=q.getFirstValue(arguments[0]);if(re(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(G(u)=="array")return y.error.v;if(G(u)=="object"&&u.startCell!=null)if(u.data!=null&&G(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=Bl("yyyy-mm-dd",u.data.v);else return y.error.v;else s=u;if(!dr(s))return[y.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ve.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=q.getFirstValue(arguments[2]),re(f))?f:K(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?y.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"0"},function(d){var p=It.deepCopyFlowData(h.flowdata),b=Qn(d);b==null&&(b=d),y.execFunctionGroup(t,l,b),p[t][l]={v:b,f:o},al(p,[{row:[t,t],column:[l,l]}])}),"loading...")):y.error.v}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},DATA_CN_STOCK_OPEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=q.getFirstValue(arguments[0]);if(re(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(G(u)=="array")return y.error.v;if(G(u)=="object"&&u.startCell!=null)if(u.data!=null&&G(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=Bl("yyyy-mm-dd",u.data.v);else return y.error.v;else s=u;if(!dr(s))return[y.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ve.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=q.getFirstValue(arguments[2]),re(f))?f:K(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?y.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"1"},function(d){var p=It.deepCopyFlowData(h.flowdata);y.execFunctionGroup(t,l,d),p[t][l]={v:d,f:o},al(p,[{row:[t,t],column:[l,l]}])}),"loading...")):y.error.v}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},DATA_CN_STOCK_MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=q.getFirstValue(arguments[0]);if(re(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(G(u)=="array")return y.error.v;if(G(u)=="object"&&u.startCell!=null)if(u.data!=null&&G(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=Bl("yyyy-mm-dd",u.data.v);else return y.error.v;else s=u;if(!dr(s))return[y.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ve.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=q.getFirstValue(arguments[2]),re(f))?f:K(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?y.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"2"},function(d){var p=It.deepCopyFlowData(h.flowdata);y.execFunctionGroup(t,l,d),p[t][l]={v:d,f:o},al(p,[{row:[t,t],column:[l,l]}])}),"loading...")):y.error.v}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},DATA_CN_STOCK_MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=q.getFirstValue(arguments[0]);if(re(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(G(u)=="array")return y.error.v;if(G(u)=="object"&&u.startCell!=null)if(u.data!=null&&G(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=Bl("yyyy-mm-dd",u.data.v);else return y.error.v;else s=u;if(!dr(s))return[y.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ve.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=q.getFirstValue(arguments[2]),re(f))?f:K(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?y.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"3"},function(d){var p=It.deepCopyFlowData(h.flowdata);y.execFunctionGroup(t,l,d),p[t][l]={v:d,f:o},al(p,[{row:[t,t],column:[l,l]}])}),"loading...")):y.error.v}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},DATA_CN_STOCK_VOLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=q.getFirstValue(arguments[0]);if(re(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(G(u)=="array")return y.error.v;if(G(u)=="object"&&u.startCell!=null)if(u.data!=null&&G(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=Bl("yyyy-mm-dd",u.data.v);else return y.error.v;else s=u;if(!dr(s))return[y.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ve.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=q.getFirstValue(arguments[2]),re(f))?f:K(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?y.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"4"},function(d){var p=It.deepCopyFlowData(h.flowdata);y.execFunctionGroup(t,l,d),p[t][l]={v:d,f:o},al(p,[{row:[t,t],column:[l,l]}])}),"loading...")):y.error.v}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},DATA_CN_STOCK_AMOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=q.getFirstValue(arguments[0]);if(re(a))return a;var s=null;if(arguments[1]!=null){var u=arguments[1];if(G(u)=="array")return y.error.v;if(G(u)=="object"&&u.startCell!=null)if(u.data!=null&&G(u.data)!="array"&&u.data.ct!=null&&u.data.ct.t=="d")s=Bl("yyyy-mm-dd",u.data.v);else return y.error.v;else s=u;if(!dr(s))return[y.error.v,"\u65E5\u671F\u9519\u8BEF"];s=(0,ve.default)(s).format("YYYY-MM-DD")}var f=0;return arguments[2]!=null&&(f=q.getFirstValue(arguments[2]),re(f))?f:K(f)?(f=parseInt(f),f!=0&&f!=1&&f!=2?y.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:a,date:s,price:f,type:"5"},function(d){var p=It.deepCopyFlowData(h.flowdata);y.execFunctionGroup(t,l,d),p[t][l]={v:d,f:o},al(p,[{row:[t,t],column:[l,l]}])}),"loading...")):y.error.v}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},ISDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:dr(t)}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},SUMIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=0,l=arguments[0].data,o=arguments[0].rowl,a=arguments[0].coll,s=su(arguments[1]);if(l=y.getRangeArray(l)[0],arguments[2]){var u=[],f=arguments[2].startCell,m=arguments[2].rowl,d=arguments[2].coll,p=arguments[2].sheetName;if(o==m&&a==d)u=arguments[2].data;else{var b=[],g=[],v="",x="";b[0]=parseInt(f.replace(/[^0-9]/g,""))-1,g[0]=fn(f.replace(/[^A-Za-z]/g,"")),b[1]=b[0]+o-1,g[1]=g[0]+a-1;var _=yl(g[1]),S=b[1]+1;v=_+S,x=p+"!"+f+":"+v,u=Ji(x).data}u=y.getRangeArray(u)[0];for(var e=0;e<l.length;e++){var I=l[e];if(!!I&&y.acompareb(I,s)){if(!K(u[e]))continue;t=er(t,"+",u[e])}}}else for(var e=0;e<l.length;e++){var I=l[e];if(!!I&&y.acompareb(I,s)){if(!K(I))continue;t=er(t,"",I)}}return t}catch(F){var P=F;return P=y.errorInfo(P),[y.error.v,P]}},TAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),Math.tan(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},TANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=Math.exp(2*t);return(l-1)/(l+1)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},CEILING:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),l==0?0:t>0&&l<0?y.error.nm:Math.ceil(t/l)*l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ATAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),Math.atan(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},ASINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),Math.log(t+Math.sqrt(t*t+1))):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},ABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),Math.abs(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},ACOS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<-1||t>1?y.error.nm:Math.acos(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},ACOSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<1?y.error.nm:Math.log(t+Math.sqrt(t*t-1))):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},MULTINOMIAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=0,a=1,e=0;e<t.length;e++){var s=t[e];if(!K(s))return y.error.v;if(s=parseFloat(s),s<0)return y.error.nm;o+=s,a*=q.factorial(s)}return q.factorial(o)/a}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},ATANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<=-1||t>=1?y.error.nm:Math.log((1+t)/(1-t))/2):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},ATAN2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),t==0&&l==0?y.error.d:Math.atan2(l,t)):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},COUNTBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=0;if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return 1;if(G(t.data)=="array")for(var o=0;o<t.data.length;o++)for(var a=0;a<t.data[o].length;a++)(t.data[o][a]==null||ft(t.data[o][a].v))&&l++;else ft(t.data.v)&&l++}return l}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},COSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),(Math.exp(t)+Math.exp(-t))/2):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},INT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0];if(G(t)=="array")return G(t[0])=="array"?q.isDyadicArr(t)?K(t[0][0])?Math.floor(parseFloat(t[0][0])):y.error.v:y.error.v:K(t[0])?Math.floor(parseFloat(t[0])):y.error.v;if(G(t)=="object"&&t.startCell!=null){if(t.coll>1)return y.error.v;if(t.rowl>1){var l=y.getcellrange(t.startCell),o=l.row[0];if(window.luckysheetCurrentRow<o||window.luckysheetCurrentRow>o+t.rowl-1)return y.error.v;var a=t.data[window.luckysheetCurrentRow-o][0]}else var a=t.data;return a==null||ft(a.v)?0:K(a.v)?Math.floor(parseFloat(a.v)):y.error.v}else{if(G(t)=="boolean"){if(t.toString().toLowerCase()=="true")return 1;if(t.toString().toLowerCase()=="false")return 0}return K(t)?Math.floor(parseFloat(t)):y.error.v}}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},ISEVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseInt(t),!(Math.abs(t)&1)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},ISODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseInt(t),!!(Math.abs(t)&1)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},LCM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array")if(G(l[0])=="array"){if(!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l))}else t=t.concat(l);else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=0;o<t.length;o++){var a=t[o];if(!K(a))return y.error.v;if(a=parseInt(a),a<0)return y.error.nm;t[o]=a}for(var e,s,u,f,m=1;(u=t.pop())!==void 0;)for(u==0&&(m=0);u>1;){if(u%2){for(e=3,s=Math.floor(Math.sqrt(u));e<=s&&u%e;e+=2);f=e<=s?e:u}else f=2;for(u/=f,m*=f,e=t.length;e;t[--e]%f==0&&(t[e]/=f)===1&&t.splice(e,1));}return m>=Math.pow(2,53)?y.error.nm:m}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},LN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<=0?y.error.nm:Math.log(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},LOG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;if(t=parseFloat(t),t<=0)return y.error.nm;if(arguments.length==2){var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;if(l=parseFloat(l),l<=0)return y.error.nm}else var l=10;return Math.log(t)/Math.log(l)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},LOG10:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<=0?y.error.nm:Math.log(t)/Math.log(10)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},MOD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;if(l=parseFloat(l),l==0)return y.error.d;var o=Math.abs(t%l);return l>0?o:-o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},MROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),t*l<0?y.error.nm:Math.round(t/l)*l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=Math.ceil(Math.abs(t));return l=l&1?l:l+1,t>=0?l:-l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},SUMSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"number",!0)):t.push(l)}var o=0;if(t.length>0)for(var e=0;e<t.length;e++){var a=t[e];if(!K(a))return y.error.v;a=parseFloat(a),o+=a*a}return o}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},COMBIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseInt(l),t<0||l<0||t<l?y.error.nm:q.factorial(t)/(q.factorial(l)*q.factorial(t-l))):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},SUBTOTAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{let d=function(p){switch(p){case 1:case 101:return window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,s);case 2:case 102:return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,s);case 3:case 103:return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,s);case 4:case 104:return window.luckysheet_function.MAX.f.apply(window.luckysheet_function.MAX,s);case 5:case 105:return window.luckysheet_function.MIN.f.apply(window.luckysheet_function.MIN,s);case 6:case 106:return window.luckysheet_function.PRODUCT.f.apply(window.luckysheet_function.PRODUCT,s);case 7:case 107:return window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,s);case 8:case 108:return window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,s);case 9:case 109:return window.luckysheet_function.SUM.f.apply(window.luckysheet_function.SUM,s);case 10:case 110:return window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,s);case 11:case 111:return window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,s)}};var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=[];for(var e=0;e<t.length;e++){for(var o=[],a=0;a<t[e].length;a++)o.push(t[e][a]);l.push(o)}}else{l=[];for(var e=0;e<t.length;e++)l.push(t[e])}else G(t)=="object"&&t.startCell!=null?l=q.getFirstValue(t):l=t;var s=Array.prototype.slice.apply(arguments);if(s.shift(),G(l)=="array"){var u=[];if(G(l[0])=="array")for(var e=0;e<l.length;e++){for(var o=[],a=0;a<l[e].length;a++){var f=l[e][a];re(f)?o.push(f):K(f)?(f=parseInt(f),f<1||f>111||f>11&&f<101?o.push(y.error.v):o.push(d(f))):o.push(y.error.v)}u.push(o)}else for(var e=0;e<l.length;e++){var f=l[e];re(f)?u.push(f):K(f)?(f=parseInt(f),f<1||f>111||f>11&&f<101?u.push(y.error.v):u.push(d(f))):u.push(y.error.v)}return u}else return re(l)?l:K(l)?(l=parseInt(l),l<1||l>111||l>11&&l<101?y.error.v:d(l)):y.error.v}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},ASIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<-1||t>1?y.error.nm:Math.asin(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},COUNTIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{let d=function(p,b){/[<>=!*?]/.test(b)||(b='=="'+b+'"'),b=b.replace("<>","!=");var g=0;if(G(p)=="array"){for(var v=0;v<p.length;v++)for(var x=0;x<p[v].length;x++)if(p[v][x]!=null&&!ft(p[v][x].v)){var _=p[v][x].v;b.indexOf("*")>-1||b.indexOf("?")>-1?y.isWildcard(_,b)&&g++:typeof _!="string"?new Function("return "+_+b)()&&g++:new Function('return "'+_+'"'+b)()&&g++}}else if(p!=null&&!ft(p.v)){var _=p.v;b.indexOf("*")>-1||b.indexOf("?")>-1?y.isWildcard(_,b)&&g++:typeof _!="string"?new Function("return "+_+b)()&&g++:new Function('return "'+_+'"'+b)()&&g++}return g};var t=arguments[0],l;if(G(t)=="object"&&t.startCell!=null)l=t.data;else return y.error.v;var o=arguments[1],a;if(G(o)=="array")if(a=[],G(o[0])=="array"){if(!q.isDyadicArr(o))return y.error.v;for(var e=0;e<o.length;e++){for(var s=[],u=0;u<o[e].length;u++)s.push(o[e][u]);a.push(s)}}else for(var e=0;e<o.length;e++)a.push(o[e]);else if(G(o)=="object"&&o.startCell!=null){if(o.rowl>1||o.coll>1)return 0;a=o.data.v}else a=o;if(G(a)=="array"){var f=[];if(G(a[0])=="array")for(var e=0;e<a.length;e++){for(var s=[],u=0;u<a[e].length;u++)s.push(d(l,a[e][u]));f.push(s)}else for(var e=0;e<a.length;e++)f.push(d(l,a[e]));return f}else return d(l,a)}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},RADIANS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t*Math.PI/180):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},RAND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;try{return Math.floor(Math.random()*1e9)/1e9}catch(n){var e=n;return e=y.errorInfo(e),[y.error.v,e]}},COUNTUNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"text",!0)):t.push(l)}return window.luckysheet_function.UNIQUE.f(t)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},DEGREES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t*180/Math.PI):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},ERFC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),jStat.erfc(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},EVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=Math.ceil(Math.abs(t));return l=l&1?l+1:l,t>0?l:-l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},EXP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),Math.exp(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},FACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))if(G(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return y.error.v;return t=parseInt(t),t<0?y.error.nm:q.factorial(t)}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},FACTDOUBLE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))if(G(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return y.error.v;return t=parseInt(t),t<0?y.error.nm:q.factorialDouble(t)}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},PI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;try{return Math.PI}catch(n){var e=n;return e=y.errorInfo(e),[y.error.v,e]}},FLOOR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;if(l=parseFloat(l),l==0)return y.error.d;if(t>0&&l<0)return y.error.nm;var o=-Math.floor(Math.log(Math.abs(l))/Math.log(10));return t>=0?Math.floor(t/l)*l*Math.pow(10,o)/Math.pow(10,o):-(Math.ceil(Math.abs(t)/l)*l*Math.pow(10,o))/Math.pow(10,o)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},GCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!1))}else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"number",!1)):t.push(l)}if(!K(t[0]))return y.error.v;var o=parseInt(t[0]);if(o<0||o>=Math.pow(2,53))return y.error.nm;for(var e=1;e<t.length;e++){var a=t[e];if(!K(a))return y.error.v;if(a=parseInt(a),a<0||a>=Math.pow(2,53))return y.error.nm;for(;o&&a;)o>a?o%=a:a%=o;o+=a}return o}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},RANDBETWEEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseInt(l),t>l?y.error.nm:t+Math.ceil((l-t+1)*Math.random())-1):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=t>0?1:-1;return o*Math.round(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},ROUNDDOWN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=t>0?1:-1;return o*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},ROUNDUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=t>0?1:-1;return o*Math.ceil(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},SERIESSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=arguments[3],s=[];if(G(a)=="array"){if(G(a[0])=="array"&&!q.isDyadicArr(a))return y.error.v;s=s.concat(q.getDataArr(a,!1))}else G(a)=="object"&&a.startCell!=null?s=s.concat(q.getCellDataArr(a,"number",!1)):s.push(a);if(!K(s[0]))return y.error.v;for(var u=parseFloat(s[0])*Math.pow(t,l),e=1;e<s.length;e++){var f=s[e];if(!K(f))return y.error.v;f=parseFloat(f),u+=f*Math.pow(t,l+e*o)}return u}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},SIGN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;if(t=parseFloat(t),t>0)return 1;if(t==0)return 0;if(t<0)return-1}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},SIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),Math.sin(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},SINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),(Math.exp(t)-Math.exp(-t))/2):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},SQRT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<0?y.error.nm:Math.sqrt(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},SQRTPI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<0?y.error.nm:Math.sqrt(t*Math.PI)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},GAMMALN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<=0?y.error.nm:jStat.gammaln(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},COS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),Math.cos(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},TRUNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;if(t=parseFloat(t),arguments.length==2){var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}else var l=0;var o=t>0?1:-1;return o*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},QUOTIENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),l==0?y.error.d:parseInt(t/l,10)):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},POWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),t==0&&l==0?y.error.nm:t<0&&l.toString().indexOf(".")>-1?y.error.nm:Math.pow(t,l)):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},SUMIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=0,l=arguments;ls(l);for(var o=y.getRangeArray(l[0])[0],a=new Array(o.length),e=0;e<a.length;e++)a[e]=!0;for(var e=1;e<l.length;e+=2)for(var s=y.getRangeArray(l[e])[0],u=l[e+1],f=0;f<s.length;f++){var m=s[f];a[f]=a[f]&&!!m&&y.acompareb(m,u)}for(var e=0;e<o.length;e++)a[e]&&(t=er(t,"+",o[e]));return t}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},COUNTIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments;ls(t);for(var l=new Array(y.getRangeArray(t[0])[0].length),e=0;e<l.length;e++)l[e]=!0;for(var e=0;e<t.length;e+=2)for(var o=y.getRangeArray(t[e])[0],a=t[e+1],s=0;s<o.length;s++){var u=o[s];l[s]=l[s]&&!!u&&y.acompareb(u,a)}for(var f=0,e=0;e<l.length;e++)l[e]&&f++;return f}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},PRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=1,e=0;e<t.length;e++){var a=t[e];if(!K(a))return y.error.v;a=parseFloat(a),o*=a}return o}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},HARMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"number",!0)):t.push(l)}for(var o=0,a=0,e=0;e<t.length;e++){var s=t[e];if(!K(s))return y.error.v;if(s=parseFloat(s),s<=0)return y.error.nm;o+=1/s,a++}return a/o}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},HYPGEOMDIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{let f=function(d,p,b,g){var v=q.factorial(b)/(q.factorial(d)*q.factorial(b-d)),x=q.factorial(g-b)/(q.factorial(p-d)*q.factorial(g-b-p+d)),_=q.factorial(g)/(q.factorial(p)*q.factorial(g-p));return v*x/_},m=function(d,p,b,g){for(var v=0,x=0;x<=d;x++)v+=f(x,p,b,g);return v};var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseInt(a);var s=q.getCellBoolen(arguments[4]);return re(s)?s:t<0||t>Math.min(l,o)||t<Math.max(0,l-a+o)?y.error.nm:l<=0||l>a?y.error.nm:o<=0||o>a?y.error.nm:a<=0?y.error.nm:s?m(t,l,o,a):f(t,l,o,a)}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},INTERCEPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=0,l=arguments[0],o=[];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;o=o.concat(q.getDataArr(l,!1))}else G(l)=="object"&&l.startCell!=null?o=o.concat(q.getCellDataArr(l,"text",!1)):o.push(l);var a=arguments[1],s=[];if(G(a)=="array"){if(G(a[0])=="array"&&!q.isDyadicArr(a))return y.error.v;s=s.concat(q.getDataArr(a,!1))}else G(a)=="object"&&a.startCell!=null?s=s.concat(q.getCellDataArr(a,"text",!1)):s.push(a);if(o.length!=s.length)return y.error.na;for(var u=[],f=[],e=0;e<o.length;e++){var m=o[e],d=s[e];K(m)&&K(d)&&(u.push(parseFloat(m)),f.push(parseFloat(d)))}if(q.variance_s(f)==0)return y.error.d;for(var p=jStat.mean(f),b=jStat.mean(u),g=f.length,v=0,x=0,e=0;e<g;e++)v+=(f[e]-p)*(u[e]-b),x+=Math.pow(f[e]-p,2);var _=v/x,S=b-_*p;return S+_*t}catch(P){var I=P;return I=y.errorInfo(I),[y.error.v,I]}},KURT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"text",!0)):t.push(l)}for(var o=[],a=0;a<t.length;a++){var s=t[a];if(!K(s))return y.error.v;s=parseFloat(s),o.push(s)}if(o.length<4||q.standardDeviation_s(o)==0)return y.error.d;for(var u=jStat.mean(o),f=o.length,m=0,e=0;e<f;e++)m+=Math.pow(o[e]-u,4);return m=m/Math.pow(jStat.stdev(o,!0),4),f*(f+1)/((f-1)*(f-2)*(f-3))*m-3*(f-1)*(f-1)/((f-2)*(f-3))}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},LARGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[];if(G(arguments[0])=="array"){if(G(arguments[0][0])=="array"&&!q.isDyadicArr(arguments[0]))return y.error.v;t=t.concat(q.getDataArr(arguments[0],!0))}else G(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(q.getCellDataArr(arguments[0],"text",!0)):t.push(arguments[0]);for(var l=[],o=0;o<t.length;o++){var a=t[o];if(!K(a))return y.error.v;a=parseFloat(a),l.push(a)}var s;if(G(arguments[1])=="array"){if(G(arguments[1][0])=="array"&&!q.isDyadicArr(arguments[1]))return y.error.v;s=q.getDataArr(arguments[1])}else if(G(arguments[1])=="object"&&arguments[1].startCell!=null){if(arguments[1].rowl>1||arguments[1].coll>1)return y.error.v;var u=arguments[1].data;if(u==null||ft(u.v))var s=0;else var s=u.v}else s=arguments[1];if(G(s)=="array"){if(l.length==0)return y.error.nm;for(var f=[],e=0;e<s.length;e++){if(!K(s[e])){f.push(y.error.v);continue}if(s[e]=Math.ceil(parseFloat(s[e])),s[e]<=0||s[e]>l.length){f.push(y.error.nm);continue}f.push(t.sort(function(p,b){return b-p})[s[e]-1])}return f}else return K(s)?(s=Math.ceil(parseFloat(s)),l.length==0?y.error.nm:s<=0||s>l.length?y.error.nm:t.sort(function(d,p){return p-d})[s-1]):y.error.v}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},STDEVA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!1))}else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"text",!1)):t.push(l)}for(var o=[],a=0;a<t.length;a++){var s=t[a];K(s)?s=parseFloat(s):s.toString().toLowerCase()=="true"?s=1:s=0,o.push(s)}return o.length==0?0:o.length==1?y.error.d:q.standardDeviation_s(o)}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},STDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else G(l)=="object"&&l.startCell!=null?t=t.concat(q.getCellDataArr(l,"text",!0)):t.push(l)}for(var o=[],a=0;a<t.length;a++){var s=t[a];if(!K(s))return y.error.v;s=parseFloat(s),o.push(s)}return o.length==0?0:o.length==1?y.error.d:q.standardDeviation(o)}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},GEOMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"text",!0));else if(G(l)=="boolean")l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0);else if(K(l))t.push(l);else return y.error.v}for(var o=[],a=0;a<t.length;a++){var s=t[a];if(!!K(s)){if(s=parseFloat(s),s<=0)return y.error.nm;o.push(s)}}return o.length==0?y.error.nm:jStat.geomean(o)}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},RANK_EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;o=o.concat(q.getDataArr(l,!0))}else G(l)=="object"&&l.startCell!=null?o=o.concat(q.getCellDataArr(l,"number",!0)):o.push(l);for(var a=[],s=0;s<o.length;s++){var u=o[s];if(!K(u))return y.error.v;u=parseFloat(u),a.push(u)}if(arguments.length==3){var f=q.getCellBoolen(arguments[2]);if(re(f))return f}else var f=!1;var m=f?function(b,g){return b-g}:function(b,g){return g-b};a=a.sort(m);var d=a.indexOf(t);return d==-1?y.error.na:d+1}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},RANK_AVG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;o=o.concat(q.getDataArr(l,!0))}else G(l)=="object"&&l.startCell!=null?o=o.concat(q.getCellDataArr(l,"number",!0)):o.push(l);for(var a=[],s=0;s<o.length;s++){var u=o[s];if(!K(u))return y.error.v;u=parseFloat(u),a.push(u)}if(arguments.length==3){var f=q.getFirstValue(arguments[2]);if(re(f))return f;if(G(f)!="boolean")if(G(f)=="string"&&(f.toLowerCase()=="true"||f.toLowerCase()=="false"))f.toLowerCase()=="true"&&(f=!0),f.toLowerCase()=="false"&&(f=!1);else if(K(f))f=parseFloat(f),f=f!=0;else return y.error.v}else var f=!1;var m=f?function(b,g){return b-g}:function(b,g){return g-b};a=a.sort(m);for(var d=0,e=0;e<a.length;e++)a[e]==t&&d++;return d>1?(2*a.indexOf(t)+d+1)/2:a.indexOf(t)+1}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},PERCENTRANK_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!0))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"number",!0)):l.push(t);for(var o=[],a=0;a<l.length;a++){var s=l[a];if(!K(s))return y.error.v;s=parseFloat(s),o.push(s)}var u=q.getFirstValue(arguments[1]);if(re(u))return u;if(!K(u))return y.error.v;if(u=parseFloat(u),arguments.length==3){var f=q.getFirstValue(arguments[2]);if(re(f))return f;if(!K(f))return y.error.v;f=parseInt(f)}else var f=3;if(o.length==0)return y.error.nm;if(f<1)return y.error.nm;if(o.length==1&&o[0]==u)return 1;o=o.sort(function(S,I){return S-I});for(var m=window.luckysheet_function.UNIQUE.f(o)[0],d=o.length,p=m.length,b=Math.pow(10,f),g=0,v=!1,e=0;!v&&e<p;)u===m[e]?(g=(o.indexOf(m[e])+1)/(d+1),v=!0):u>=m[e]&&(u<m[e+1]||e===p-1)&&(g=(o.lastIndexOf(m[e])+1+(u-m[e])/(m[e+1]-m[e]))/(d+1),v=!0),e++;return isNaN(g)?y.error.na:Math.floor(g*b)/b}catch(_){var x=_;return x=y.errorInfo(x),[y.error.v,x]}},PERCENTRANK_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!0))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"number",!0)):l.push(t);for(var o=[],a=0;a<l.length;a++){var s=l[a];if(!K(s))return y.error.v;s=parseFloat(s),o.push(s)}var u=q.getFirstValue(arguments[1]);if(re(u))return u;if(!K(u))return y.error.v;if(u=parseFloat(u),arguments.length==3){var f=q.getFirstValue(arguments[2]);if(re(f))return f;if(!K(f))return y.error.v;f=parseInt(f)}else var f=3;if(o.length==0)return y.error.nm;if(f<1)return y.error.nm;if(o.length==1&&o[0]==u)return 1;o=o.sort(function(S,I){return S-I});for(var m=window.luckysheet_function.UNIQUE.f(o)[0],d=o.length,p=m.length,b=Math.pow(10,f),g=0,v=!1,e=0;!v&&e<p;)u===m[e]?(g=o.indexOf(m[e])/(d-1),v=!0):u>=m[e]&&(u<m[e+1]||e===p-1)&&(g=(o.lastIndexOf(m[e])+(u-m[e])/(m[e+1]-m[e]))/(d-1),v=!0),e++;return isNaN(g)?y.error.na:Math.floor(g*b)/b}catch(_){var x=_;return x=y.errorInfo(x),[y.error.v,x]}},FORECAST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;o=o.concat(q.getDataArr(l,!1))}else G(l)=="object"&&l.startCell!=null?o=o.concat(q.getCellDataArr(l,"text",!1)):o.push(l);var a=arguments[2],s=[];if(G(a)=="array"){if(G(a[0])=="array"&&!q.isDyadicArr(a))return y.error.v;s=s.concat(q.getDataArr(a,!1))}else G(a)=="object"&&a.startCell!=null?s=s.concat(q.getCellDataArr(a,"text",!1)):s.push(a);if(o.length!=s.length)return y.error.na;for(var u=[],f=[],e=0;e<o.length;e++){var m=o[e],d=s[e];K(m)&&K(d)&&(u.push(parseFloat(m)),f.push(parseFloat(d)))}if(q.variance_s(f)==0)return y.error.d;for(var p=jStat.mean(f),b=jStat.mean(u),g=f.length,v=0,x=0,e=0;e<g;e++)v+=(f[e]-p)*(u[e]-b),x+=Math.pow(f[e]-p,2);var _=v/x,S=b-_*p;return S+_*t}catch(P){var I=P;return I=y.errorInfo(I),[y.error.v,I]}},FISHERINV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=Math.exp(2*t);return(l-1)/(l+1)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},FISHER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<=-1||t>=1?y.error.nm:Math.log((1+t)/(1-t))/2):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},MODE_SNGL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else{if(!K(l))return y.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)&&o.push(parseFloat(a))}for(var s={},u=[],f=0,m,e=0;e<o.length;e++)m=o[e],s[m]=s[m]?s[m]+1:1,s[m]>f&&(f=s[m],u=[]),s[m]==f&&(u[u.length]=m);if(f<=1)return y.error.na;for(var d=o.indexOf(u[0]),p=0;p<u.length;p++){var b=o.indexOf(u[p]);b<d&&(d=b)}return o[d]}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},WEIBULL_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getCellBoolen(arguments[3]);return re(a)?a:t<0||l<=0||o<=0?y.error.nm:a?1-Math.exp(-Math.pow(t/o,l)):Math.pow(t,l-1)*Math.exp(-Math.pow(t/o,l))*l/Math.pow(o,l)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},AVEDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else{if(!K(l))return y.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)&&o.push(parseFloat(a))}return o.length==0?y.error.nm:jStat.sum(jStat(o).subtract(jStat.mean(o)).abs()[0])/o.length}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},AVERAGEA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!1))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else if(s.toString.toLowerCase()=="true")t.push(1);else if(s.toString.toLowerCase()=="false")t.push(0);else if(K(l))t.push(l);else return y.error.v}for(var o=0,a=0,e=0;e<t.length;e++){var s=t[e];K(s)?o+=parseFloat(s):s.toString().toLowerCase()=="true"?o+=1:o+=0,a++}return a==0?y.error.d:o/a}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},BINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getCellBoolen(arguments[3]);return re(a)?a:t<0||t>l?y.error.nm:o<0||o>1?y.error.nm:a?jStat.binomial.cdf(t,l,o):jStat.binomial.pdf(t,l,o)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},BINOM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;if(o=parseFloat(o),t<0)return y.error.nm;if(l<0||l>1)return y.error.nm;if(o<0||o>1)return y.error.nm;for(var a=0;a<=t;){if(jStat.binomial.cdf(a,t,l)>=o)return a;a++}}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},CONFIDENCE_NORM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);return re(o)?o:K(o)?(o=parseInt(o),t<=0||t>=1?y.error.nm:l<=0?y.error.nm:o<1?y.error.nm:jStat.normalci(1,t,l,o)[1]-1):y.error.v}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},CORREL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(G(o)=="array"){if(G(o[0])=="array"&&!q.isDyadicArr(o))return y.error.v;a=a.concat(q.getDataArr(o,!1))}else G(o)=="object"&&o.startCell!=null?a=a.concat(q.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return y.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];K(f)&&K(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}return s.length==0||u.length==0||q.standardDeviation(s)==0||q.standardDeviation(u)==0?y.error.d:jStat.corrcoeff(s,u)}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},COVARIANCE_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(G(o)=="array"){if(G(o[0])=="array"&&!q.isDyadicArr(o))return y.error.v;a=a.concat(q.getDataArr(o,!1))}else G(o)=="object"&&o.startCell!=null?a=a.concat(q.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return y.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];K(f)&&K(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}if(s.length==0||u.length==0)return y.error.d;for(var d=jStat.mean(s),p=jStat.mean(u),b=0,e=0;e<s.length;e++)b+=(s[e]-d)*(u[e]-p);return b=b/s.length,b}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},COVARIANCE_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(G(o)=="array"){if(G(o[0])=="array"&&!q.isDyadicArr(o))return y.error.v;a=a.concat(q.getDataArr(o,!1))}else G(o)=="object"&&o.startCell!=null?a=a.concat(q.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return y.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];K(f)&&K(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}return s.length==0||u.length==0?y.error.d:jStat.covariance(s,u)}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},DEVSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else if(K(l))t.push(l);else if(G(l)=="boolean")l.toString().toLowerCase()=="true"?t.push(1):l.toString().toLowerCase()=="false"&&t.push(0);else return y.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)&&o.push(parseFloat(a))}for(var s=jStat.mean(o),u=0,e=0;e<o.length;e++)u+=Math.pow(o[e]-s,2);return u}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},EXPON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getCellBoolen(arguments[2]);return re(o)?o:t<0?y.error.nm:l<0?y.error.nm:o?jStat.exponential.cdf(t,l):jStat.exponential.pdf(t,l)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},AVERAGEIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=0,l=0,o=arguments[0].data,a=arguments[0].rowl,s=arguments[0].coll,u=su(arguments[1]),f=[];if(arguments[2]){var m=arguments[2].startCell,d=arguments[2].rowl,p=arguments[2].coll,b=arguments[2].sheetName;if(a==d&&s==p)f=arguments[2].data;else{var g=[],v=[],x="",_="";g[0]=parseInt(m.replace(/[^0-9]/g,""))-1,v[0]=fn(m.replace(/[^A-Za-z]/g,"")),g[1]=g[0]+a-1,v[1]=v[0]+s-1;var S=yl(v[1]),I=g[1]+1;x=S+I,_=b+"!"+m+":"+x,f=Ji(_).data}f=y.getRangeArray(f)[0]}o=y.getRangeArray(o)[0];for(var e=0;e<o.length;e++){var P=o[e];if(!!P&&y.acompareb(P,u)){var F=f[e]||P;if(!K(F))continue;t+=parseFloat(F),l++}}return t==0||l==0?y.error.d:Qn(t/l)}catch(k){var D=k;return D=y.errorInfo(D),[y.error.v,D]}},AVERAGEIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=0,l=0,o=arguments;ls(o);for(var a=y.getRangeArray(o[0])[0],s=new Array(a.length),e=0;e<s.length;e++)s[e]=!0;for(var e=1;e<o.length;e+=2)for(var u=y.getRangeArray(o[e])[0],f=o[e+1],m=0;m<u.length;m++){var d=u[m];s[m]=s[m]&&!!d&&y.acompareb(d,f)}for(var e=0;e<a.length;e++)s[e]&&K(a[e])&&(t+=parseFloat(a[e]),l++);return t==0||l==0?y.error.d:Qn(t/l)}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},PERMUT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseInt(l),t<=0||l<0?y.error.nm:t<l?y.error.nm:q.factorial(t)/q.factorial(t-l)):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},TRIMMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{let d=function(b,g){return g=g||1,!b||typeof b.slice!="function"?b:b.slice(g)},p=function(b,g){return g=g||1,!b||typeof b.slice!="function"?b:b.slice(0,b.length-g)};var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];K(a)&&o.push(parseFloat(a))}var s=q.getFirstValue(arguments[1]);if(re(s))return s;if(!K(s))return y.error.v;if(s=parseFloat(s),o.length==0)return y.error.nm;if(s<0||s>1)return y.error.nm;o.sort(function(b,g){return b-g});var u=window.luckysheet_function.FLOOR.f(o.length*s,2)/2,f=d(o,u);return f=p(f,u),f=jStat.mean(f),f}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},PERCENTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];K(a)&&o.push(parseFloat(a))}var s=q.getFirstValue(arguments[1]);if(re(s))return s;if(!K(s))return y.error.v;if(s=parseFloat(s),o.length==0)return y.error.nm;if(s<=0||s>=1)return y.error.nm;o=o.sort(function(p,b){return p-b});var u=o.length;if(s<1/(u+1)||s>1-1/(u+1))return y.error.nm;var f=s*(u+1)-1,m=Math.floor(f);return f===m?o[f]:o[m]+(f-m)*(o[m+1]-o[m])}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},PERCENTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];K(a)&&o.push(parseFloat(a))}var s=q.getFirstValue(arguments[1]);if(re(s))return s;if(!K(s))return y.error.v;if(s=parseFloat(s),o.length==0)return y.error.nm;if(s<0||s>1)return y.error.nm;o=o.sort(function(p,b){return p-b});var u=o.length,f=s*(u-1),m=Math.floor(f);return f===m?o[f]:o[m]+(f-m)*(o[m+1]-o[m])}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},PEARSON:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(G(o)=="array"){if(G(o[0])=="array"&&!q.isDyadicArr(o))return y.error.v;a=a.concat(q.getDataArr(o,!1))}else G(o)=="object"&&o.startCell!=null?a=a.concat(q.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return y.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];K(f)&&K(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}if(u.length==0||s.length==0)return y.error.d;for(var d=jStat.mean(s),p=jStat.mean(u),b=s.length,g=0,v=0,x=0,e=0;e<b;e++)g+=(s[e]-d)*(u[e]-p),v+=Math.pow(s[e]-d,2),x+=Math.pow(u[e]-p,2);return g/Math.sqrt(v*x)}catch(S){var _=S;return _=y.errorInfo(_),[y.error.v,_]}},NORM_S_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),t<=0||t>=1?y.error.nm:jStat.normal.inv(t,0,1)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},NORM_S_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getCellBoolen(arguments[1]);return re(l)?l:l?jStat.normal.cdf(t,0,1):jStat.normal.pdf(t,0,1)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},NORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))if(G(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))if(G(l)=="boolean")l.toString().toLowerCase()=="true"?l=1:l.toString().toLowerCase()=="false"&&(l=0);else return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))if(G(o)=="boolean")o.toString().toLowerCase()=="true"?o=1:o.toString().toLowerCase()=="false"&&(o=0);else return y.error.v;return o=parseFloat(o),t<=0||t>=1?y.error.nm:o<=0?y.error.nm:jStat.normal.inv(t,l,o)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},NORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))if(G(t)=="boolean")t.toString().toLowerCase()=="true"?t=1:t.toString().toLowerCase()=="false"&&(t=0);else return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getCellBoolen(arguments[3]);return re(a)?a:o<=0?y.error.nm:a?jStat.normal.cdf(t,l,o):jStat.normal.pdf(t,l,o)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},NEGBINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getCellBoolen(arguments[3]);return re(a)?a:o<0||o>1?y.error.nm:t<0||l<1?y.error.nm:a?jStat.negbin.cdf(t,l,o):jStat.negbin.pdf(t,l,o)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},MINA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!1))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(K(l))t.push(l);else return y.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}return o.length===0?0:Math.min.apply(Math,o)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},MEDIAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else{if(!K(l))return y.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)&&o.push(parseFloat(a))}return jStat.median(o)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},MAXA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!1))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(K(l))t.push(l);else return y.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}return o.length===0?0:Math.max.apply(Math,o)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},LOGNORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);return re(o)?o:K(o)?(o=parseFloat(o),t<=0||t>=1?y.error.nm:o<=0?y.error.nm:jStat.lognormal.inv(t,l,o)):y.error.v}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},LOGNORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getCellBoolen(arguments[3]);return re(a)?a:t<=0||o<=0?y.error.nm:a?jStat.lognormal.cdf(t,l,o):jStat.lognormal.pdf(t,l,o)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},Z_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[];if(G(arguments[0])=="array"){if(G(arguments[0][0])=="array"&&!q.isDyadicArr(arguments[0]))return y.error.v;t=t.concat(q.getDataArr(arguments[0],!0))}else G(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(q.getCellDataArr(arguments[0],"text",!0)):t.push(arguments[0]);for(var l=[],o=0;o<t.length;o++){var a=t[o];K(a)&&l.push(parseFloat(a))}var s=q.getFirstValue(arguments[1]);if(re(s))return s;if(!K(s))return y.error.v;if(s=parseFloat(s),l.length==0)return y.error.na;var u=q.standardDeviation_s(l);if(arguments.length==3){if(u=q.getFirstValue(arguments[2]),re(u))return u;if(!K(u))return y.error.v;u=parseFloat(u)}var f=l.length,m=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,l);return 1-window.luckysheet_function.NORM_S_DIST.f((m-s)/(u/Math.sqrt(f)),"true")}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},PROB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[];if(G(arguments[0])=="array"){if(G(arguments[0][0])=="array"&&!q.isDyadicArr(arguments[0]))return y.error.v;t=t.concat(q.getDataArr(arguments[0],!1))}else G(arguments[0])=="object"&&arguments[0].startCell!=null?t=t.concat(q.getCellDataArr(arguments[0],"text",!1)):t.push(arguments[0]);var l=[];if(G(arguments[1])=="array"){if(G(arguments[1][0])=="array"&&!q.isDyadicArr(arguments[1]))return y.error.v;l=l.concat(q.getDataArr(arguments[1],!1))}else G(arguments[1])=="object"&&arguments[1].startCell!=null?l=l.concat(q.getCellDataArr(arguments[1],"text",!1)):l.push(arguments[1]);if(t.length!=l.length)return y.error.na;for(var o=[],a=[],s=0,e=0;e<t.length;e++){var u=t[e],f=l[e];if(K(u)&&K(f)&&(o.push(parseFloat(u)),a.push(parseFloat(f)),s+=parseFloat(f),parseFloat(f)<=0||parseFloat(f)>1))return y.error.nm}if(s!=1)return y.error.nm;var m=q.getFirstValue(arguments[2]);if(re(m))return m;if(!K(m))return y.error.v;m=parseFloat(m);var d=m;if(arguments.length==4){if(d=q.getFirstValue(arguments[3]),re(d))return d;if(!K(d))return y.error.v;d=parseFloat(d)}for(var p=0,e=0;e<o.length;e++)o[e]>=m&&o[e]<=d&&(p+=a[e]);return p}catch(g){var b=g;return b=y.errorInfo(b),[y.error.v,b]}},QUARTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[];if(G(arguments[0])=="array"){if(G(arguments[0][0])=="array"&&!q.isDyadicArr(arguments[0]))return y.error.v;t=t.concat(q.getDataArr(arguments[0],!0))}else if(G(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(q.getCellDataArr(arguments[0],"text",!0));else{if(!K(arguments[0]))return y.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var o=t[e];K(o)&&l.push(parseFloat(o))}var a=q.getFirstValue(arguments[1]);if(re(a))return a;if(!K(a))return y.error.v;if(a=parseInt(a),l.length==0)return y.error.nm;if(a<=0||a>=4)return y.error.nm;switch(a){case 1:return window.luckysheet_function.PERCENTILE_EXC.f(l,.25);case 2:return window.luckysheet_function.PERCENTILE_EXC.f(l,.5);case 3:return window.luckysheet_function.PERCENTILE_EXC.f(l,.75)}}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},QUARTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[];if(G(arguments[0])=="array"){if(G(arguments[0][0])=="array"&&!q.isDyadicArr(arguments[0]))return y.error.v;t=t.concat(q.getDataArr(arguments[0],!0))}else if(G(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(q.getCellDataArr(arguments[0],"text",!0));else{if(!K(arguments[0]))return y.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var o=t[e];K(o)&&l.push(parseFloat(o))}var a=q.getFirstValue(arguments[1]);if(re(a))return a;if(!K(a))return y.error.v;if(a=parseInt(a),l.length==0)return y.error.nm;if(a<0||a>4)return y.error.nm;switch(a){case 0:return Math.min.apply(Math,l);case 1:return window.luckysheet_function.PERCENTILE_INC.f(l,.25);case 2:return window.luckysheet_function.PERCENTILE_INC.f(l,.5);case 3:return window.luckysheet_function.PERCENTILE_INC.f(l,.75);case 4:return Math.max.apply(Math,l)}}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},POISSON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getCellBoolen(arguments[2]);return re(o)?o:t<0||l<0?y.error.nm:o?jStat.poisson.cdf(t,l):jStat.poisson.pdf(t,l)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},RSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else if(G(t)=="object"&&t.startCell!=null)l=l.concat(q.getCellDataArr(t,"text",!1));else{if(!K(t))return y.error.v;l.push(t)}var o=arguments[1],a=[];if(G(o)=="array"){if(G(o[0])=="array"&&!q.isDyadicArr(o))return y.error.v;a=a.concat(q.getDataArr(o,!1))}else if(G(o)=="object"&&o.startCell!=null)a=a.concat(q.getCellDataArr(o,"text",!1));else{if(!K(o))return y.error.v;a.push(o)}if(l.length!=a.length)return y.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];K(f)&&K(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}return s.length==0||u.length==0?y.error.d:Math.pow(window.luckysheet_function.PEARSON.f(s,u),2)}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},T_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getCellBoolen(arguments[2]);return re(o)?o:l<1?y.error.nm:o?jStat.studentt.cdf(t,l):jStat.studentt.pdf(t,l)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},T_DIST_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseInt(l),t<0||l<1?y.error.nm:(1-jStat.studentt.cdf(t,l))*2):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},T_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseInt(l),l<1?y.error.nm:1-jStat.studentt.cdf(t,l)):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},T_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseInt(l),t<=0||t>1?y.error.nm:l<1?y.error.nm:jStat.studentt.inv(t,l)):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},T_INV_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseInt(l),t<=0||t>1?y.error.nm:l<1?y.error.nm:Math.abs(jStat.studentt.inv(t/2,l))):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},T_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[];if(G(arguments[0])=="array"){if(G(arguments[0][0])=="array"&&!q.isDyadicArr(arguments[0]))return y.error.v;t=t.concat(q.getDataArr(arguments[0],!1))}else if(G(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(q.getCellDataArr(arguments[0],"text",!1));else{if(!K(arguments[0]))return y.error.v;t.push(arguments[0])}var l=t,o=[];if(G(arguments[1])=="array"){if(G(arguments[1][0])=="array"&&!q.isDyadicArr(arguments[1]))return y.error.v;o=o.concat(q.getDataArr(arguments[1],!1))}else if(G(arguments[1])=="object"&&arguments[1].startCell!=null)o=o.concat(q.getCellDataArr(arguments[1],"text",!1));else{if(!K(arguments[1]))return y.error.v;o.push(arguments[1])}var a=o,s=q.getFirstValue(arguments[2]);if(re(s))return s;if(!K(s))return y.error.v;s=parseInt(s);var u=q.getFirstValue(arguments[3]);if(re(u))return u;if(!K(u))return y.error.v;if(u=parseInt(u),[1,2].indexOf(s)==-1)return y.error.nm;if([1,2,3].indexOf(u)==-1)return y.error.nm;var f=null,m=null;if(u==1){var d=[];for(e=0;e<l.length;e++)d.push(l[e]-a[e]);var p=Math.abs(jStat.mean(d)),b=q.standardDeviation_s(d);f=p/(b/Math.sqrt(l.length)),m=l.length-1}else{var g=jStat.mean(l),v=jStat.mean(a),x=q.variance_s(l),_=q.variance_s(a);switch(f=Math.abs(g-v)/Math.sqrt(x/l.length+_/a.length),u){case 2:m=l.length+a.length-2;break;case 3:m=Math.pow(x/l.length+_/a.length,2)/(Math.pow(x/l.length,2)/(l.length-1)+Math.pow(_/a.length,2)/(a.length-1));break}}if(s==1)var S=window.luckysheet_function.T_DIST_RT.f(f,m);else if(s==2)var S=window.luckysheet_function.T_DIST_2T.f(f,m);return S}catch(P){var I=P;return I=y.errorInfo(I),[y.error.v,I]}},F_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=q.getCellBoolen(arguments[3]);return re(a)?a:t<0?y.error.nm:l<1?y.error.nm:o<1?y.error.nm:a?jStat.centralF.cdf(t,l,o):jStat.centralF.pdf(t,l,o)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},F_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getFirstValue(arguments[2]);return re(o)?o:K(o)?(o=parseInt(o),t<0?y.error.nm:l<1?y.error.nm:o<1?y.error.nm:1-jStat.centralF.cdf(t,l,o)):y.error.v}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},VAR_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else{if(!K(l))return y.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)&&o.push(parseFloat(a))}if(o.length==0)return y.error.d;for(var s=o.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-f,2);return u/s}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},VAR_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else{if(!K(l))return y.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)&&o.push(parseFloat(a))}if(o.length==0)return y.error.d;for(var s=o.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-f,2);return u/(s-1)}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},VARA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!1))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(K(l))t.push(l);else return y.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}for(var s=o.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-f,2);return u/(s-1)}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},VARPA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!1))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else if(a.toString.toLowerCase()=="true")t.push(1);else if(a.toString.toLowerCase()=="false")t.push(0);else if(K(l))t.push(l);else return y.error.v}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)?o.push(parseFloat(a)):a.toString().toLowerCase()=="true"?o.push(1):o.push(0)}for(var s=o.length,u=0,f=window.luckysheet_function.AVERAGE.f.apply(window.luckysheet_function.AVERAGE,o),e=0;e<s;e++)u+=Math.pow(o[e]-f,2);return u/s}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},STEYX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[];if(G(arguments[0])=="array"){if(G(arguments[0][0])=="array"&&!q.isDyadicArr(arguments[0]))return y.error.v;t=t.concat(q.getDataArr(arguments[0],!1))}else if(G(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(q.getCellDataArr(arguments[0],"text",!1));else{if(!K(arguments[0]))return y.error.v;t.push(arguments[0])}var l=[];if(G(arguments[1])=="array"){if(G(arguments[1][0])=="array"&&!q.isDyadicArr(arguments[1]))return y.error.v;l=l.concat(q.getDataArr(arguments[1],!1))}else if(G(arguments[1])=="object"&&arguments[1].startCell!=null)l=l.concat(q.getCellDataArr(arguments[1],"text",!1));else{if(!K(arguments[1]))return y.error.v;l.push(arguments[1])}if(t.length!=l.length)return y.error.na;for(var o=[],a=[],e=0;e<t.length;e++){var s=t[e],u=l[e];K(s)&&K(u)&&(o.push(parseFloat(s)),a.push(parseFloat(u)))}if(o.length<3||a.length<3)return y.error.d;for(var f=jStat.mean(a),m=jStat.mean(o),d=a.length,p=0,b=0,g=0,e=0;e<d;e++)p+=Math.pow(o[e]-m,2),b+=(a[e]-f)*(o[e]-m),g+=Math.pow(a[e]-f,2);return Math.sqrt((p-b*b/g)/(d-2))}catch(x){var v=x;return v=y.errorInfo(v),[y.error.v,v]}},STANDARDIZE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);return re(o)?o:K(o)?(o=parseFloat(o),o<=0?y.error.nm:(t-l)/o):y.error.v}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},SMALL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[];if(G(arguments[0])=="array"){if(G(arguments[0][0])=="array"&&!q.isDyadicArr(arguments[0]))return y.error.v;t=t.concat(q.getDataArr(arguments[0],!0))}else if(G(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(q.getCellDataArr(arguments[0],"number",!0));else{if(!K(arguments[0]))return y.error.v;t.push(arguments[0])}for(var l=[],e=0;e<t.length;e++){var o=t[e];K(o)&&l.push(parseFloat(o))}var a=q.getFirstValue(arguments[1]);return re(a)?a:K(a)?(a=parseInt(a),l.length==0?y.error.nm:a<=0||a>l.length?y.error.nm:l.sort(function(u,f){return u-f})[a-1]):y.error.v}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},SLOPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[];if(G(arguments[0])=="array"){if(G(arguments[0][0])=="array"&&!q.isDyadicArr(arguments[0]))return y.error.v;t=t.concat(q.getDataArr(arguments[0],!1))}else if(G(arguments[0])=="object"&&arguments[0].startCell!=null)t=t.concat(q.getCellDataArr(arguments[0],"text",!1));else{if(!K(arguments[0]))return y.error.v;t.push(arguments[0])}var l=[];if(G(arguments[1])=="array"){if(G(arguments[1][0])=="array"&&!q.isDyadicArr(arguments[1]))return y.error.v;l=l.concat(q.getDataArr(arguments[1],!1))}else if(G(arguments[1])=="object"&&arguments[1].startCell!=null)l=l.concat(q.getCellDataArr(arguments[1],"text",!1));else{if(!K(arguments[1]))return y.error.v;l.push(arguments[1])}if(t.length!=l.length)return y.error.na;for(var o=[],a=[],e=0;e<t.length;e++){var s=t[e],u=l[e];K(s)&&K(u)&&(o.push(parseFloat(s)),a.push(parseFloat(u)))}if(o.length<3||a.length<3)return y.error.d;for(var f=jStat.mean(a),m=jStat.mean(o),d=a.length,p=0,b=0,e=0;e<d;e++)p+=(a[e]-f)*(o[e]-m),b+=Math.pow(a[e]-f,2);return p/b}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},SKEW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else{if(!K(l))return y.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)&&o.push(parseFloat(a))}if(o.length<3||q.standardDeviation_s(o)==0)return y.error.d;for(var s=jStat.mean(o),u=o.length,f=0,e=0;e<u;e++)f+=Math.pow(o[e]-s,3);return u*f/((u-1)*(u-2)*Math.pow(jStat.stdev(o,!0),3))}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},SKEW_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=[],e=0;e<arguments.length;e++){var l=arguments[e];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;t=t.concat(q.getDataArr(l,!0))}else if(G(l)=="object"&&l.startCell!=null)t=t.concat(q.getCellDataArr(l,"number",!0));else{if(!K(l))return y.error.v;t.push(l)}}for(var o=[],e=0;e<t.length;e++){var a=t[e];K(a)&&o.push(parseFloat(a))}if(o.length<3||q.standardDeviation_s(o)==0)return y.error.d;for(var s=jStat.mean(o),u=o.length,f=0,m=0,e=0;e<u;e++)m+=Math.pow(o[e]-s,3),f+=Math.pow(o[e]-s,2);return m=m/u,f=f/u,m/Math.pow(f,3/2)}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},ADDRESS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=1;if(arguments.length>=3){if(o=q.getFirstValue(arguments[2]),re(o))return o;if(!K(o))return y.error.v;o=parseInt(o)}var a=!0;if(arguments.length>=4&&(a=q.getCellBoolen(arguments[3]),re(a)))return a;if(t<=0||l<=0)return y.error.v;if([1,2,3,4].indexOf(o)==-1)return y.error.v;var s;if(a)switch(l=yl(l-1),o){case 1:s="$"+l+"$"+t;break;case 2:s=l+"$"+t;break;case 3:s="$"+l+t;break;case 4:s=l+t;break}else switch(o){case 1:s="R"+t+"C"+l;break;case 2:s="R"+t+"C["+l+"]";break;case 3:s="R["+t+"]C"+l;break;case 4:s="R["+t+"]C["+l+"]";break}if(arguments.length==5){var u=q.getFirstValue(arguments[4]);return re(u)?u:u+"!"+s}else return s}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},INDIRECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;var l=!0;if(arguments.length==2&&(l=q.getCellBoolen(arguments[1]),re(l)))return l;let a=ur(),s=Me(h.calculateSheetIndex),u=a[s],f=u.data;if(y.iscelldata(t)){let m=y.getcellrange(t),d=m.row[0],p=m.column[0];if(d<0||d>=f.length||p<0||p>=f[0].length)return y.error.r;if(f[d][p]==null||ft(f[d][p].v))return 0;let b=f[d][p].v;if(y.execFunctionGlobalData!=null){let v=y.execFunctionGlobalData[d+"_"+p+"_"+h.calculateSheetIndex];v!=null&&(b=v.v)}return{sheetName:u.name,startCell:t,rowl:d,coll:p,data:b}}else return y.error.r}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ROW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{if(arguments.length==1){var t;if(G(arguments[0])=="array")return y.error.v;if(G(arguments[0])=="object"&&arguments[0].startCell!=null?t=arguments[0].startCell:t=arguments[0],y.iscelldata(t)){var l=y.getcellrange(t);return l.row[0]+1}else return y.error.v}else return window.luckysheetCurrentRow+1}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ROWS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return G(arguments[0])=="array"?G(arguments[0][0])=="array"?arguments[0].length:1:G(arguments[0])=="object"&&arguments[0].startCell!=null?arguments[0].rowl:1}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},COLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{if(arguments.length==1){var t;if(G(arguments[0])=="array")return y.error.v;if(G(arguments[0])=="object"&&arguments[0].startCell!=null?t=arguments[0].startCell:t=arguments[0],y.iscelldata(t)){var l=y.getcellrange(t);return l.column[0]+1}else return y.error.v}else return window.luckysheetCurrentColumn+1}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},COLUMNS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return G(arguments[0])=="array"?G(arguments[0][0])=="array"?arguments[0][0].length:arguments[0].length:G(arguments[0])=="object"&&arguments[0].startCell!=null?arguments[0].coll:1}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},OFFSET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{if(!(G(arguments[0])=="object"&&arguments[0].startCell!=null))return y.error.v;var t=arguments[0].startCell;let S=arguments[0].sheetName;var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=arguments[0].rowl;if(arguments.length>=4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseInt(a)}var s=arguments[0].coll;if(arguments.length==5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseInt(s)}if(a<1||s<1)return y.error.r;var u=y.getcellrange(t),f=u.row[0],m=u.column[0];f+=l,m+=o;var d=f+a-1,p=m+s-1;let I=ur(),P=Me(h.calculateSheetIndex),F=I[P].data;if(f<0||d>=F.length||m<0||p>=F[0].length)return y.error.r;for(var b=[],g=f;g<=d;g++){for(var v=[],x=m;x<=p;x++)if(y.execFunctionGlobalData!=null&&y.execFunctionGlobalData[g+"_"+x+"_"+h.calculateSheetIndex]!=null){let k=y.execFunctionGlobalData[g+"_"+x+"_"+h.calculateSheetIndex];k!=null?v.push(k.v):v.push(0)}else F[g][x]!=null&&!ft(F[g][x].v)?v.push(F[g][x].v):v.push(0);b.push(v)}return{sheetName:S,startCell:Kl(h.calculateSheetIndex,{row:[f,d],column:[m,p]}),rowl:f,coll:m,data:b}}catch(S){var _=S;return _=y.errorInfo(_),[y.error.v,_]}},MATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;var l=arguments[1],o=[];if(G(l)=="array"){if(G(l[0])=="array")return q.isDyadicArr(l)?y.error.na:y.error.v;for(var e=0;e<l.length;e++)o.push(l[e])}else if(G(l)=="object"&&l.startCell!=null){if(l.rowl>1&&l.coll>1)return y.error.na;if(l.data!=null)if(G(l.data)=="array")for(var e=0;e<l.data.length;e++)for(var a=0;a<l.data[e].length;a++)l.data[e][a]!=null&&!ft(l.data[e][a].v)&&o.push(l.data[e][a].v);else o.push(l.data.v)}var s=1;if(arguments.length==3){if(s=q.getFirstValue(arguments[2]),re(s))return s;if(!K(s))return y.error.v;s=Math.ceil(parseFloat(s))}if([-1,0,1].indexOf(s)==-1)return y.error.na;for(var u,f,m=0;m<o.length;m++)if(s===1){if(o[m]===t)return m+1;o[m]<t&&(f?o[m]>f&&(u=m+1,f=o[m]):(u=m+1,f=o[m]))}else if(s===0){if(typeof t=="string"){if(t=t.replace(/\?/g,"."),o[m].toLowerCase().match(t.toLowerCase()))return m+1}else if(o[m]===t)return m+1}else if(s===-1){if(o[m]===t)return m+1;o[m]>t&&(f?o[m]<f&&(u=m+1,f=o[m]):(u=m+1,f=o[m]))}return u||y.error.na}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},VLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;if(t.toString().replace(/\s/g,"")=="")return y.error.na;var l=arguments[1],o=[];if(G(l)=="array")if(G(l[0])=="array"){if(!q.isDyadicArr(l))return y.error.v;for(var e=0;e<l.length;e++){for(var a=[],s=0;s<l[e].length;s++)a.push(l[e][s]);o.push(a)}}else{for(var a=[],e=0;e<l.length;e++)a.push(l[e]);o.push(a)}else if(G(l)=="object"&&l.startCell!=null)o=q.getCellDataDyadicArr(l,"text");else return y.error.v;var u=q.getFirstValue(arguments[2]);if(re(u))return u;if(!K(u))return y.error.v;u=parseInt(u);var f=!0;if(arguments.length==4&&(f=q.getCellBoolen(arguments[3]),re(f)))return f;if(u<1)return y.error.v;if(u>o[0].length)return y.error.r;if(f){o=Ko(o,0,!0);for(var m=0;m<o.length;m++){var d=o[m][0],p;if(dr(t)&&dr(d)?p=un(t,d):K(t)&&K(d)?p=(0,bf.default)(t).value()-(0,bf.default)(d).value():!K(t)&&!K(d)?p=t.localeCompare(d,"zh"):K(t)?K(d)||(p=-1):p=1,p<0)return m==0?y.error.na:o[m-1][u-1];if(m==o.length-1)return o[m][u-1]}}else{for(var b=null,m=0;m<o.length;m++)if(t.toString()==o[m][0].toString()){b=m;break}return b==null?y.error.na:o[b][u-1]}}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},HLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=arguments[0];typeof o=="object"&&(o=arguments[0].data,G(o)=="array"?(o=o[r],G(o)=="array"&&(o=o[m])):o=o.v);var a=arguments[1].data,s=arguments[2],u=!1;if(arguments.length>3&&(u=!!arguments[3]),s>a.rowl)return[y.error.v,"\u7D22\u5F15\u8D85\u8FC7\u4E86\u8303\u56F4\u7684\u957F\u5EA6\uFF0C"+a[0].length];if(s<1)return[y.error.v,"\u7D22\u5F15\u5FC5\u987B\u5927\u4E8E1"];for(var f=y.error.na,m=0;m<a[0].length;m++){var d=Vt(0,m,a),p=Vt(s-1,m,a);if(u)d.indexOf(o)>-1&&(f=p);else if(y.acompareb(d,o))return f=p,f}return f}catch(g){var b=g;return b=y.errorInfo(b),[y.error.v,b]}},LOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{let v=function(x,_){return _-x};var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=arguments[0];typeof o=="object"&&(o=arguments[0].data,G(o)=="array"?(o=o[r],G(o)=="array"&&(o=o[c])):o=o.v);var a=arguments[1].data,s,u=y.error.na;if(a=y.getRangeArray(a)[0],arguments[2]&&(s=arguments[2].data,s=y.getRangeArray(s)[0]),typeof o=="string")for(var e=0;e<a.length;e++){var f=a[e],m;arguments[2]?(m=s[e],f==o&&(u=m)):y.acompareb(f,o)&&(u=f)}else if(Yi(o)=="num"){for(var d=[],e=0;e<a.length;e++){var f=a[e],m;if(arguments[2]){if(m=s[e],f==o)return u=m,u;f!=o&&Yi(f)=="num"&&d.push(f)}else{if(f==o)return u=f,u;f!=o&&Yi(f)=="num"&&d.push(f)}}if(d.length!=0){d.push(o),d.sort(v);var p=d.indexOf(o);if(p==d.length-1)return[y.error.na,"\u627E\u4E0D\u5230\u5BF9\u5E94\u53C2\u6570"];var b=d[p+1];if(arguments[2]){var e=a.indexOf(b);u=s[e]}else u=b}}return u}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},INDEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];let b=!1;if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=q.getDataDyadicArr(t)}else G(t)=="object"&&t.startCell!=null&&(l=q.getCellDataDyadicArr(t,"number"),b=!0);var o=l.length,a=l[0].length,s=q.getFirstValue(arguments[1]);if(re(s))return s;if(!K(s))return y.error.v;s=parseInt(s);var u=q.getFirstValue(arguments[2]);if(re(u))return u;if(s<0||K(u)&&u<0)return y.error.v;if(s>o||K(u)&&u>a)return y.error.r;if(b){var f=y.getcellrange(t.startCell),m=f.row[0],d=f.column[0];let g=l;s==0||u==0?(s==0?(g=l[0],s=1):g=l[s-1],K(u)?u==0?(g=g[0],u=1):g=g[u-1]:u=1):(K(s)||(s=1),K(u)||(u=1),g=l[s-1][u-1]);let v=m+s-1,x=d+u-1;return{sheetName:t.sheetName,startCell:Kl(h.calculateSheetIndex,{row:[v,v],column:[x,x]}),rowl:v,coll:x,data:g}}else return K(u)?(u=parseInt(u),s<=0||u<=0?y.error.v:l[s-1][u-1]):y.error.v}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},GETPIVOTDATA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return y.error.v}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},CHOOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;if(t=parseInt(t),t<1||t>arguments.length-1)return y.error.v;var l=arguments[t];if(G(l)=="array")return G(l[0])=="array"&&!q.isDyadicArr(l)?y.error.v:l;if(G(l)=="object"&&l.startCell!=null){if(l.data==null)return 0;if(G(l.data)=="array"){var o=q.getCellDataDyadicArr(l.data,"number");return o}else return ft(l.data.v)?0:l.data.v}else return l}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},HYPERLINK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return y.error.v}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},TIME:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;if(o=parseInt(o),t<0||t>32767)return y.error.nm;if(t>24&&(t=t%24),l<0||l>32767)return y.error.nm;if(o<0||o>32767)return y.error.nm;var a=(0,ve.default)().set({hour:t,minute:l,second:o});return(0,ve.default)(a).format("h:mm:ss a")}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},TIMEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);return re(t)?t:(0,ve.default)(t).isValid()?(3600*(0,ve.default)(t).get("hour")+60*(0,ve.default)(t).get("minute")+(0,ve.default)(t).get("second"))/86400:y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},EOMONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;if(l=parseInt(l),!(0,ve.default)(t).isValid())return y.error.v;var o=(0,ve.default)(t).add(l+1,"months").set("date",1).subtract(1,"days"),a=_l((0,ve.default)(o).format("YYYY-MM-DD H:mm:ss")),s=a[2];return s}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},EDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;if(l=parseInt(l),!(0,ve.default)(t).isValid())return y.error.v;var o=(0,ve.default)(t).add(l,"months"),a=_l((0,ve.default)(o).format("YYYY-MM-DD h:mm:ss")),s=a[2];return s}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},SECOND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=(0,ve.default)(t).seconds();return l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},MINUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=(0,ve.default)(t).minutes();return l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},HOUR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=(0,ve.default)(t).hours();return l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},NOW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return(0,ve.default)().format("YYYY-M-D HH:mm")}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},NETWORKDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{if(arguments.length==3)var t=window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1,arguments[2]);else var t=window.luckysheet_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1);return t}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},NETWORKDAYS_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],l=q.getCellDate(arguments[0]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getCellDate(arguments[1]);if(re(o))return o;if(!(0,ve.default)(o).isValid())return y.error.v;var a=t[1];if(arguments.length>=3&&(a=arguments[2],!(typeof a=="string"&&a.length=="7"&&/^[0-1]{7}$/g.test(a)))){if(a=q.getFirstValue(arguments[2]),re(a))return a;if(!K(a))return y.error.v;if(a=parseInt(a),a<1||a>7&&a<11||a>17)return y.error.nm;a=t[a]}var s=[];if(arguments.length==4&&(s=q.getCellrangeDate(arguments[3]),re(s)))return s;for(var e=0;e<s.length;e++)if(!(0,ve.default)(s[e]).isValid())return y.error.v;var u=(0,ve.default)(o).diff((0,ve.default)(l),"days")+1,f=u,m=(0,ve.default)(l);for(e=0;e<u;e++){var d=(0,ve.default)(m).weekday(),p=!1;G(a)=="array"?(d===a[0]||d===a[1])&&(p=!0):(d==0&&(d=7),a.charAt(d-1)=="0"&&(p=!0));for(var b=0;b<s.length;b++)if((0,ve.default)(m).diff((0,ve.default)(s[b]),"days")===0){p=!0;break}p&&f--,m=(0,ve.default)(m).add(1,"days")}return f}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},ISOWEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);return re(t)?t:(0,ve.default)(t).isValid()?(0,ve.default)(t).isoWeeks():y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},WEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[void 0,7,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,7],l=q.getCellDate(arguments[0]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=1;if(arguments.length==2){if(o=q.getFirstValue(arguments[1]),re(o))return o;if(!K(o))return y.error.v;o=parseInt(o)}if(o==21)return window.luckysheet_function.ISOWEEKNUM.f(arguments[0]);if([1,2,11,12,13,14,15,16,17].indexOf(o)==-1)return y.error.nm;var a=t[o],s=(0,ve.default)(l).isoWeekday()>=a?1:0,u=(0,ve.default)(l).isoWeeks()+s;return u}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},WEEKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=q.getCellDate(arguments[0]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=1;if(arguments.length==2){if(o=q.getFirstValue(arguments[1]),re(o))return o;if(!K(o))return y.error.v;o=parseInt(o)}if([1,2,3,11,12,13,14,15,16,17].indexOf(o)==-1)return y.error.nm;var a=t[o][(0,ve.default)(l).day()];return a}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},DAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);return re(t)?t:(0,ve.default)(t).isValid()?(0,ve.default)(t).date():y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},DAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=(0,ve.default)(t).diff((0,ve.default)(l),"days");return o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},DAYS360:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=!1;if(arguments.length==3&&(o=q.getCellBoolen(arguments[2]),re(o)))return o;var a=(0,ve.default)(t).month(),s=(0,ve.default)(l).month(),u,f;if(o)u=(0,ve.default)(t).date()===31?30:(0,ve.default)(t).date(),f=(0,ve.default)(l).date()===31?30:(0,ve.default)(l).date();else{var m=(0,ve.default)().set({year:(0,ve.default)(t).year(),month:a+1,date:0}).date(),d=(0,ve.default)().set({year:(0,ve.default)(l).year(),month:s+1,date:0}).date();u=(0,ve.default)(t).date()===m?30:(0,ve.default)(t).date(),(0,ve.default)(l).date()===d?u<30?(s++,f=1):f=30:f=(0,ve.default)(l).date()}var p=360*(0,ve.default)(l).diff((0,ve.default)(t),"years")+30*(s-a)+(f-u);return p}catch(g){var b=g;return b=y.errorInfo(b),[y.error.v,b]}},DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;if(o=parseInt(o),t<0||t>=1e4)return y.error.nm;t>=0&&t<=1899&&(t=t+1900);var a=(0,ve.default)().set({year:t,month:l-1,date:o});return(0,ve.default)(a).year()<1900?y.error.nm:(0,ve.default)(a).format("YYYY-MM-DD")}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},DATEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;t=(0,ve.default)(t).format("YYYY-MM-DD");var l=_l(t)[2];return l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},DATEDIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{ls(arguments);for(var e=0;e<arguments.length-1;e++)if(arguments[e]=moment.fromOADate(arguments[e]).format("l"),!dr(arguments[e]))return y.error.v;var t=(0,ve.default)(arguments[0]),l=(0,ve.default)(arguments[1]),o=arguments[2],a=y.error.v;if(window.luckysheet_function.DAYS.f(l,t)<0)return y.error.v;switch(o){case"Y":case"y":a=l.diff(t,"years",!1);break;case"M":case"m":a=l.diff(t,"months",!1);break;case"D":case"d":a=l.diff(t,"days",!1);break;case"MD":case"md":a=l.format("DD")-t.format("DD");break;case"YM":case"ym":var s=parseInt(t.format("M")),u=parseInt(l.format("M"));a=s<=u?u-s:u+12-s;break;case"YD":case"yd":var s=_l(t.format("MM-DD"))[2],u=_l(l.format("MM-DD"))[2];a=s<=u?u-s:u+365-s;break;default:a=y.error.v}return a}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},WORKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{if(arguments.length==3)var t=window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1,arguments[2]);else var t=window.luckysheet_function.WORKDAY_INTL.f(arguments[0],arguments[1],1);return t}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},WORKDAY_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],l=q.getCellDate(arguments[0]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[1]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=t[1];if(arguments.length>=3&&(a=arguments[2],!(typeof a=="string"&&a.length=="7"&&/^[0-1]{7}$/g.test(a)))){if(a=q.getFirstValue(arguments[2]),re(a))return a;if(!K(a))return y.error.v;if(a=parseInt(a),a<1||a>7&&a<11||a>17)return y.error.nm;a=t[a]}var s=[];if(arguments.length==4&&(s=q.getCellrangeDate(arguments[3]),re(s)))return s;for(var e=0;e<s.length;e++)if(!(0,ve.default)(s[e]).isValid())return y.error.v;for(var u=0;u<o;){l=(0,ve.default)(l).add(1,"days");var f=(0,ve.default)(l).weekday();if(G(a)){if(f===a[0]||f===a[1])continue}else if(f==0&&(f=7),a.charAt(f-1)=="0")continue;for(var m=0;m<s.length;m++)if((0,ve.default)(l).diff((0,ve.default)(s[m]),"days")===0){u--;break}u++}return(0,ve.default)(l).format("YYYY-MM-DD")}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},YEAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);return re(t)?t:(0,ve.default)(t).isValid()?(0,ve.default)(t).year():y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},YEARFRAC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=0;if(arguments.length==3){if(o=q.getFirstValue(arguments[2]),re(o))return o;if(!K(o))return y.error.v;o=parseInt(o)}if(o<0||o>4)return y.error.nm;var a=(0,ve.default)(t).date(),s=(0,ve.default)(t).month()+1,u=(0,ve.default)(t).year(),f=(0,ve.default)(l).date(),m=(0,ve.default)(l).month()+1,d=(0,ve.default)(l).year(),p;switch(o){case 0:a===31&&f===31?(a=30,f=30):a===31?a=30:a===30&&f===31&&(f=30),p=(f+m*30+d*360-(a+s*30+u*360))/360;break;case 1:var b=365;if(u===d||u+1===d&&(s>m||s===m&&a>=f))return(u===d&&q.isLeapYear(u)||q.feb29Between(t,l)||m===1&&f===29)&&(b=366),(0,ve.default)(l).diff((0,ve.default)(t),"days")/b;var g=d-u+1,v=((0,ve.default)().set({year:d+1,month:0,date:1})-(0,ve.default)().set({year:u,month:0,date:1}))/1e3/60/60/24,x=v/g;p=(0,ve.default)(l).diff((0,ve.default)(t),"days")/x;break;case 2:p=(0,ve.default)(l).diff((0,ve.default)(t),"days")/360;break;case 3:p=(0,ve.default)(l).diff((0,ve.default)(t),"days")/365;break;case 4:p=(f+m*30+d*360-(a+s*30+u*360))/360;break}return p}catch(S){var _=S;return _=y.errorInfo(_),[y.error.v,_]}},TODAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return(0,ve.default)().format("YYYY-MM-DD")}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},MONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);return re(t)?t:(0,ve.default)(t).isValid()?(0,ve.default)(t).month()+1:y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},EFFECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseInt(l),t<=0||l<1?y.error.nm:Math.pow(1+t/l,l)-1):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},DOLLAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=2;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}l>9&&(l=9);for(var o="0.",e=1;e<=l;e++)o+="0";var a=t>0?1:-1;return a*Math.floor(Math.abs(t)*Math.pow(10,l))/Math.pow(10,l)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},DOLLARDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;if(l=parseInt(l),l<0)return y.error.nm;if(l==0)return y.error.d;var o=parseInt(t,10);o+=t%1*Math.pow(10,Math.ceil(Math.log(l)/Math.LN10))/l;var a=Math.pow(10,Math.ceil(Math.log(l)/Math.LN2)+1);return o=Math.round(o*a)/a,o}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},DOLLARFR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;if(l=parseInt(l),l<0)return y.error.nm;if(l==0)return y.error.d;var o=parseInt(t,10);return o+=t%1*Math.pow(10,-Math.ceil(Math.log(l)/Math.LN10))*l,o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},DB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseInt(a);var s=12;if(arguments.length==5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseInt(s)}if(t<0||l<0||o<0||a<0)return y.error.nm;if(s<1||s>12)return y.error.nm;if(a>o)return y.error.nm;if(l>=t)return 0;for(var u=(1-Math.pow(l/t,1/o)).toFixed(3),f=t*u*s/12,m=f,d=0,p=a===o?o-1:a,e=2;e<=p;e++)d=(t-m)*u,m+=d;if(a===1)var b=f;else if(a===o)var b=(t-m)*u;else var b=d;return b}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},DDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseInt(a);var s=2;if(arguments.length==5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}if(t<0||l<0||o<0||a<0||s<=0)return y.error.nm;if(a>o)return y.error.nm;if(l>=t)return 0;for(var u=0,f=0,e=1;e<=a;e++)f=Math.min((t-u)*(s/o),t-l-u),u+=f;return f}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},RATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}var u=.1;if(arguments.length==6){if(u=q.getFirstValue(arguments[5]),re(u))return u;if(!K(u))return y.error.v;u=parseFloat(u)}if(s!=0&&s!=1)return y.error.nm;for(var f=1e-6,m=100,d=0,p=!1,b=u;d<m&&!p;){var g=Math.pow(b+1,t),v=Math.pow(b+1,t-1),x=a+g*o+l*(g-1)*(b*s+1)/b,_=t*v*o-l*(g-1)*(b*s+1)/Math.pow(b,2),S=t*l*v*(b*s+1)/b+l*(g-1)*s/b,I=b-x/(_+S);Math.abs(I-b)<f&&(p=!0),d++,b=I}return p?b:y.error.nm}catch(F){var P=F;return P=y.errorInfo(P),[y.error.v,P]}},CUMPRINC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseInt(a);var s=q.getFirstValue(arguments[4]);if(re(s))return s;if(!K(s))return y.error.v;s=parseInt(s);var u=q.getFirstValue(arguments[5]);if(re(u))return u;if(!K(u))return y.error.v;if(u=parseFloat(u),t<=0||l<=0||o<=0)return y.error.nm;if(a<1||s<1||a>s)return y.error.nm;if(u!=0&&u!=1)return y.error.nm;var f=window.luckysheet_function.PMT.f(t,l,o,0,u),m=0;a===1&&(u===0?m=f+o*t:m=f,a++);for(var e=a;e<=s;e++)u>0?m+=f-(window.luckysheet_function.FV.f(t,e-2,f,o,1)-f)*t:m+=f-window.luckysheet_function.FV.f(t,e-1,f,o,0)*t;return m}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},COUPNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=0;if(arguments.length==4){var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return y.error.nm;if(a<0||a>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var s=(0,ve.default)(t).date(),u=(0,ve.default)(t).month()+1,f=(0,ve.default)(t).year(),m=(0,ve.default)(l).date(),d=(0,ve.default)(l).month()+1,p=(0,ve.default)(l).year(),b;switch(a){case 0:s===31&&m===31?(s=30,m=30):s===31?s=30:s===30&&m===31&&(m=30),b=(m+d*30+p*360-(s+u*30+f*360))/(360/o);break;case 1:var g=365;if(f===p||f+1===p&&(u>d||u===d&&s>=m))return(f===p&&q.isLeapYear(f)||q.feb29Between(t,l)||d===1&&m===29)&&(g=366),(0,ve.default)(l).diff((0,ve.default)(t),"days")/(g/o);var v=p-f+1,x=((0,ve.default)().set({year:p+1,month:0,date:1})-(0,ve.default)().set({year:f,month:0,date:1}))/1e3/60/60/24,_=x/v;b=(0,ve.default)(l).diff((0,ve.default)(t),"days")/(_/o);break;case 2:b=(0,ve.default)(l).diff((0,ve.default)(t),"days")/(360/o);break;case 3:b=(0,ve.default)(l).diff((0,ve.default)(t),"days")/(365/o);break;case 4:b=(m+d*30+p*360-(s+u*30+f*360))/(360/o);break}return Math.round(b)}catch(I){var S=I;return S=y.errorInfo(S),[y.error.v,S]}},SYD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);return re(a)?a:K(a)?(a=parseInt(a),o==0?y.error.nm:a<1||a>o?y.error.nm:(t-l)*(o-a+1)*2/(o*(o+1))):y.error.v}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},TBILLEQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);return re(o)?o:K(o)?(o=parseFloat(o),o<=0?y.error.nm:(0,ve.default)(t)-(0,ve.default)(l)>0?y.error.nm:(0,ve.default)(l)-(0,ve.default)(t)>365*24*60*60*1e3?y.error.nm:365*o/(360-o*(0,ve.default)(l).diff((0,ve.default)(t),"days"))):y.error.v}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},TBILLYIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);return re(o)?o:K(o)?(o=parseFloat(o),o<=0?y.error.nm:(0,ve.default)(t)-(0,ve.default)(l)>=0?y.error.nm:(0,ve.default)(l)-(0,ve.default)(t)>365*24*60*60*1e3?y.error.nm:(100-o)/o*(360/(0,ve.default)(l).diff((0,ve.default)(t),"days"))):y.error.v}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},TBILLPRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);return re(o)?o:K(o)?(o=parseFloat(o),o<=0?y.error.nm:(0,ve.default)(t)-(0,ve.default)(l)>0?y.error.nm:(0,ve.default)(l)-(0,ve.default)(t)>365*24*60*60*1e3?y.error.nm:100*(1-o*(0,ve.default)(l).diff((0,ve.default)(t),"days")/360)):y.error.v}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},PV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return y.error.nm;if(t===0)var u=-o*l-a;else var u=((1-Math.pow(1+t,l))/t*o*(1+t*s)-a)/Math.pow(1+t,l);return u}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},ACCRINT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getCellDate(arguments[2]);if(re(o))return o;if(!(0,ve.default)(o).isValid())return y.error.v;var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=q.getFirstValue(arguments[4]);if(re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s);var u=q.getFirstValue(arguments[5]);if(re(u))return u;if(!K(u))return y.error.v;u=parseInt(u);var f=0;if(arguments.length>=7){if(f=q.getFirstValue(arguments[6]),re(f))return f;if(!K(f))return y.error.v;f=parseInt(f)}var m=!0;if(arguments.length==8&&(m=q.getCellBoolen(arguments[7]),re(m)))return m;if(a<=0||s<=0)return y.error.nm;if(u!=1&&u!=2&&u!=4)return y.error.nm;if(f<0||f>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(o)>=0)return y.error.nm;var d;if((0,ve.default)(o)-(0,ve.default)(l)>=0&&!m){var p=(0,ve.default)(l).date(),b=(0,ve.default)(l).month()+1,g=(0,ve.default)(l).year(),v=(0,ve.default)(o).date(),x=(0,ve.default)(o).month()+1,_=(0,ve.default)(o).year();switch(f){case 0:p===31&&v===31?(p=30,v=30):p===31?p=30:p===30&&v===31&&(v=30),d=(v+x*30+_*360-(p+b*30+g*360))/360;break;case 1:var S=365;if(g===_||g+1===_&&(b>x||b===x&&p>=v))return(g===_&&q.isLeapYear(g)||q.feb29Between(l,o)||x===1&&v===29)&&(S=366),(0,ve.default)(o).diff((0,ve.default)(l),"days")/S;var I=_-g+1,P=((0,ve.default)().set({year:_+1,month:0,date:1})-(0,ve.default)().set({year:g,month:0,date:1}))/1e3/60/60/24,F=P/I;d=(0,ve.default)(o).diff((0,ve.default)(l),"days")/F;break;case 2:d=(0,ve.default)(o).diff((0,ve.default)(l),"days")/360;break;case 3:d=(0,ve.default)(o).diff((0,ve.default)(l),"days")/365;break;case 4:d=(v+x*30+_*360-(p+b*30+g*360))/360;break}}else{var p=(0,ve.default)(t).date(),b=(0,ve.default)(t).month()+1,g=(0,ve.default)(t).year(),v=(0,ve.default)(o).date(),x=(0,ve.default)(o).month()+1,_=(0,ve.default)(o).year();switch(f){case 0:p===31&&v===31?(p=30,v=30):p===31?p=30:p===30&&v===31&&(v=30),d=(v+x*30+_*360-(p+b*30+g*360))/360;break;case 1:var S=365;if(g===_||g+1===_&&(b>x||b===x&&p>=v))return(g===_&&q.isLeapYear(g)||q.feb29Between(t,o)||x===1&&v===29)&&(S=366),(0,ve.default)(o).diff((0,ve.default)(t),"days")/S;var I=_-g+1,P=((0,ve.default)().set({year:_+1,month:0,date:1})-(0,ve.default)().set({year:g,month:0,date:1}))/1e3/60/60/24,F=P/I;d=(0,ve.default)(o).diff((0,ve.default)(t),"days")/F;break;case 2:d=(0,ve.default)(o).diff((0,ve.default)(t),"days")/360;break;case 3:d=(0,ve.default)(o).diff((0,ve.default)(t),"days")/365;break;case 4:d=(v+x*30+_*360-(p+b*30+g*360))/360;break}}return s*a*d}catch(k){var D=k;return D=y.errorInfo(D),[y.error.v,D]}},ACCRINTM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseInt(s)}if(o<=0||a<=0)return y.error.nm;if(s<0||s>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var u=(0,ve.default)(t).date(),f=(0,ve.default)(t).month()+1,m=(0,ve.default)(t).year(),d=(0,ve.default)(l).date(),p=(0,ve.default)(l).month()+1,b=(0,ve.default)(l).year(),g;switch(s){case 0:u===31&&d===31?(u=30,d=30):u===31?u=30:u===30&&d===31&&(d=30),g=(d+p*30+b*360-(u+f*30+m*360))/360;break;case 1:var v=365;if(m===b||m+1===b&&(f>p||f===p&&u>=d))return(m===b&&q.isLeapYear(m)||q.feb29Between(t,l)||p===1&&d===29)&&(v=366),(0,ve.default)(l).diff((0,ve.default)(t),"days")/v;var x=b-m+1,_=((0,ve.default)().set({year:b+1,month:0,date:1})-(0,ve.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,S=_/x;g=(0,ve.default)(l).diff((0,ve.default)(t),"days")/S;break;case 2:g=(0,ve.default)(l).diff((0,ve.default)(t),"days")/360;break;case 3:g=(0,ve.default)(l).diff((0,ve.default)(t),"days")/365;break;case 4:g=(d+p*30+b*360-(u+f*30+m*360))/360;break}return a*o*g}catch(P){var I=P;return I=y.errorInfo(I),[y.error.v,I]}},COUPDAYBS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return y.error.nm;if(a<0||a>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;for(var s,u=Math.ceil((0,ve.default)(l).diff((0,ve.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var f=(0,ve.default)(l).subtract(12/o*e,"months");if(f<=(0,ve.default)(t)){s=f;break}}var m;switch(a){case 0:var d=(0,ve.default)(s).date(),p=(0,ve.default)(s).month()+1,b=(0,ve.default)(s).year(),g=(0,ve.default)(t).date(),v=(0,ve.default)(t).month()+1,x=(0,ve.default)(t).year();d===31&&g===31?(d=30,g=30):d===31?d=30:d===30&&g===31&&(g=30),m=g+v*30+x*360-(d+p*30+b*360);break;case 1:case 2:case 3:m=(0,ve.default)(t).diff((0,ve.default)(s),"days");break;case 4:var d=(0,ve.default)(s).date(),p=(0,ve.default)(s).month()+1,b=(0,ve.default)(s).year(),g=(0,ve.default)(t).date(),v=(0,ve.default)(t).month()+1,x=(0,ve.default)(t).year();m=g+v*30+x*360-(d+p*30+b*360);break}return m}catch(S){var _=S;return _=y.errorInfo(_),[y.error.v,_]}},COUPDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return y.error.nm;if(a<0||a>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var s;switch(a){case 0:s=360/o;break;case 1:for(var u=Math.ceil((0,ve.default)(l).diff((0,ve.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var f=(0,ve.default)(l).subtract(12/o*e,"months");if(f<=(0,ve.default)(t)){var m=(0,ve.default)(l).subtract(12/o*(e-1),"months");s=(0,ve.default)(m).diff((0,ve.default)(f),"days");break}}break;case 2:s=360/o;break;case 3:s=365/o;break;case 4:s=360/o;break}return s}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},COUPDAYSNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return y.error.nm;if(a<0||a>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;for(var s,u=Math.ceil((0,ve.default)(l).diff((0,ve.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var f=(0,ve.default)(l).subtract(12/o*e,"months");if(f<=(0,ve.default)(t)){s=(0,ve.default)(l).subtract(12/o*(e-1),"months");break}}var m;switch(a){case 0:var d=(0,ve.default)(t).date(),p=(0,ve.default)(t).month()+1,b=(0,ve.default)(t).year(),g=(0,ve.default)(s).date(),v=(0,ve.default)(s).month()+1,x=(0,ve.default)(s).year();d===31&&g===31?(d=30,g=30):d===31?d=30:d===30&&g===31&&(g=30),m=g+v*30+x*360-(d+p*30+b*360);break;case 1:case 2:case 3:m=(0,ve.default)(s).diff((0,ve.default)(t),"days");break;case 4:var d=(0,ve.default)(t).date(),p=(0,ve.default)(t).month()+1,b=(0,ve.default)(t).year(),g=(0,ve.default)(s).date(),v=(0,ve.default)(s).month()+1,x=(0,ve.default)(s).year();m=g+v*30+x*360-(d+p*30+b*360);break}return m}catch(S){var _=S;return _=y.errorInfo(_),[y.error.v,_]}},COUPNCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return y.error.nm;if(a<0||a>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;for(var s,u=Math.ceil((0,ve.default)(l).diff((0,ve.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var f=(0,ve.default)(l).subtract(12/o*e,"months");if(f<=(0,ve.default)(t)){s=(0,ve.default)(l).subtract(12/o*(e-1),"months");break}}return(0,ve.default)(s).format("YYYY-MM-DD")}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},COUPPCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=0;if(arguments.length==4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseInt(a)}if(o!=1&&o!=2&&o!=4)return y.error.nm;if(a<0||a>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;for(var s,u=Math.ceil((0,ve.default)(l).diff((0,ve.default)(t),"months")/(12/o))+1,e=1;e<=u;e++){var f=(0,ve.default)(l).subtract(12/o*e,"months");if(f<=(0,ve.default)(t)){s=f;break}}return(0,ve.default)(s).format("YYYY-MM-DD")}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},FV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return y.error.nm;var u;if(t===0)u=a+o*l;else{var f=Math.pow(1+t,l);s===1?u=a*f+o*(1+t)*(f-1)/t:u=a*f+o*(f-1)/t}return-u}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},FVSCHEDULE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;o=o.concat(q.getDataArr(l,!1))}else G(l)=="object"&&l.startCell!=null?o=o.concat(q.getCellDataArr(l,"number",!1)):o.push(l);for(var a=[],e=0;e<o.length;e++){var s=o[e];if(!K(s))return y.error.v;a.push(parseFloat(s))}for(var u=a.length,f=t,e=0;e<u;e++)f*=1+a[e];return f}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},YIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=q.getFirstValue(arguments[4]);if(re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s);var u=q.getFirstValue(arguments[5]);if(re(u))return u;if(!K(u))return y.error.v;u=parseInt(u);var f=0;if(arguments.length==7){if(f=q.getFirstValue(arguments[6]),re(f))return f;if(!K(f))return y.error.v;f=parseInt(f)}if(o<0)return y.error.nm;if(a<=0||s<=0)return y.error.nm;if(u!=1&&u!=2&&u!=4)return y.error.nm;if(f<0||f>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var m=window.luckysheet_function.COUPNUM.f(t,l,u,f);if(m>1){for(var d=1,p=0,b=d,e=1;e<=100;e++){var g=window.luckysheet_function.PRICE.f(t,l,o,b,s,u,f);if(Math.abs(g-a)<1e-6)break;g>a?p=b:d=b,b=(d+p)/2}var v=b}else var x=window.luckysheet_function.COUPDAYSNC.f(t,l,u,f),_=window.luckysheet_function.COUPDAYS.f(t,l,u,f),S=window.luckysheet_function.COUPDAYBS.f(t,l,u,f),I=s/100+o/u,P=a/100+S/_*(o/u),F=u*_/x,v=(I-P)/P*F;return v}catch(k){var D=k;return D=y.errorInfo(D),[y.error.v,D]}},YIELDDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseInt(s)}if(o<=0||a<=0)return y.error.nm;if(s<0||s>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var u=window.luckysheet_function.YEARFRAC.f(t,l,s);return(a/o-1)/u}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},NOMINAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseInt(l),t<=0||l<1?y.error.nm:(Math.pow(t+1,1/l)-1)*l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},XIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];if(!K(a))return y.error.v;o.push(parseFloat(a))}var s=q.getCellrangeDate(arguments[1]);if(re(s))return s;for(var e=0;e<s.length;e++)if(!(0,ve.default)(s[e]).isValid())return y.error.v;var u=.1;if(arguments.length==3){if(u=q.getFirstValue(arguments[2]),re(u))return u;if(!K(u))return y.error.v;u=parseFloat(u)}for(var f=!1,m=!1,e=0;e<o.length&&(o[e]>0&&(f=!0),o[e]<0&&(m=!0),!(f&&m));e++);if(!f||!m)return y.error.nm;if(o.length!=s.length)return y.error.nm;var d=function(P,F,D){for(var k=D+1,w=P[0],C=1;C<P.length;C++)w+=P[C]/Math.pow(k,window.luckysheet_function.DAYS.f(F[C],F[0])/365);return w},p=function(P,F,D){for(var k=D+1,w=0,C=1;C<P.length;C++){var T=window.luckysheet_function.DAYS.f(F[C],F[0])/365;w-=T*P[C]/Math.pow(k,T+1)}return w},b=u,g=1e-10,v,x,_,S=!0;do _=d(o,s,b),v=b-_/p(o,s,b),x=Math.abs(v-b),b=v,S=x>g&&Math.abs(_)>g;while(S);return b}catch(P){var I=P;return I=y.errorInfo(I),[y.error.v,I]}},MIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"number",!1)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];if(!K(a))return y.error.v;o.push(parseFloat(a))}var s=q.getFirstValue(arguments[1]);if(re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s);var u=q.getFirstValue(arguments[2]);if(re(u))return u;if(!K(u))return y.error.v;u=parseFloat(u);for(var f=o.length,m=[],d=[],e=0;e<f;e++)o[e]<0?m.push(o[e]):d.push(o[e]);if(m.length==0||d.length==0)return y.error.d;var p=-window.luckysheet_function.NPV.f(u,d)*Math.pow(1+u,f-1),b=window.luckysheet_function.NPV.f(s,m)*(1+s);return Math.pow(p/b,1/(f-1))-1}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},IRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"number",!0)):l.push(t);for(var o=[],e=0;e<l.length;e++){var a=l[e];if(!K(a))return y.error.v;o.push(parseFloat(a))}var s=.1;if(arguments.length==2){if(s=q.getFirstValue(arguments[1]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}for(var u=[],f=!1,m=!1,e=0;e<l.length;e++)u[e]=e===0?0:u[e-1]+365,l[e]>0&&(f=!0),l[e]<0&&(m=!0);if(!f||!m)return y.error.nm;var d=function(P,F,D){for(var k=D+1,w=P[0],C=1;C<P.length;C++)w+=P[C]/Math.pow(k,(F[C]-F[0])/365);return w},p=function(P,F,D){for(var k=D+1,w=0,C=1;C<P.length;C++){var T=(F[C]-F[0])/365;w-=T*P[C]/Math.pow(k,T+1)}return w},b=s,g=1e-10,v,x,_,S=!0;do _=d(o,u,b),v=b-_/p(o,u,b),x=Math.abs(v-b),b=v,S=x>g&&Math.abs(_)>g;while(S);return b}catch(P){var I=P;return I=y.errorInfo(I),[y.error.v,I]}},NPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);for(var l=[],e=1;e<arguments.length;e++){var o=arguments[e];if(G(o)=="array"){if(G(o[0])=="array"&&!q.isDyadicArr(o))return y.error.v;l=l.concat(q.getDataArr(o,!0))}else G(o)=="object"&&o.startCell!=null?l=l.concat(q.getCellDataArr(o,"number",!0)):l.push(o)}for(var a=[],e=0;e<l.length;e++){var s=l[e];K(s)&&a.push(parseFloat(s))}var u=0;if(a.length>0)for(var e=0;e<a.length;e++)u+=a[e]/Math.pow(1+t,e+1);return u}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},XNPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=arguments[1],o=[];if(G(l)=="array"){if(G(l[0])=="array"&&!q.isDyadicArr(l))return y.error.v;o=o.concat(q.getDataArr(l,!1))}else G(l)=="object"&&l.startCell!=null?o=o.concat(q.getCellDataArr(l,"number",!1)):o.push(l);for(var a=[],e=0;e<o.length;e++){var s=o[e];if(!K(s))return y.error.v;a.push(parseFloat(s))}var u=q.getCellrangeDate(arguments[2]);if(re(u))return u;for(var e=0;e<u.length;e++)if(!(0,ve.default)(u[e]).isValid())return y.error.v;if(a.length!=u.length)return y.error.nm;for(var f=0,e=0;e<a.length;e++)f+=a[e]/Math.pow(1+t,window.luckysheet_function.DAYS.f(u[e],u[0])/365);return f}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},CUMIPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseInt(a);var s=q.getFirstValue(arguments[4]);if(re(s))return s;if(!K(s))return y.error.v;s=parseInt(s);var u=q.getFirstValue(arguments[5]);if(re(u))return u;if(!K(u))return y.error.v;if(u=parseFloat(u),t<=0||l<=0||o<=0)return y.error.nm;if(a<1||s<1||a>s)return y.error.nm;if(u!=0&&u!=1)return y.error.nm;var f=window.luckysheet_function.PMT.f(t,l,o,0,u),m=0;a===1&&u===0&&(m=-o,a++);for(var e=a;e<=s;e++)u===1?m+=window.luckysheet_function.FV.f(t,e-2,f,o,1)-f:m+=window.luckysheet_function.FV.f(t,e-1,f,o,0);return m*=t,m}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},PMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a)}var s=0;if(arguments.length==5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return y.error.nm;var u;if(t===0)u=(o+a)/l;else{var f=Math.pow(1+t,l);s===1?u=(a*t/(f-1)+o*t/(1-1/f))/(1+t):u=a*t/(f-1)+o*t/(1-1/f)}return-u}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},IPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=0;if(arguments.length>=5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}var u=0;if(arguments.length>=6){if(u=q.getFirstValue(arguments[5]),re(u))return u;if(!K(u))return y.error.v;u=parseFloat(u)}if(l<1||l>o)return y.error.nm;if(u!=0&&u!=1)return y.error.nm;var f=window.luckysheet_function.PMT.f(t,o,a,s,u),m;l===1?u===1?m=0:m=-a:u===1?m=window.luckysheet_function.FV.f(t,l-2,f,a,1)-f:m=window.luckysheet_function.FV.f(t,l-1,f,a,0);var d=m*t;return d}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},PPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=0;if(arguments.length>=5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}var u=0;if(arguments.length>=6){if(u=q.getFirstValue(arguments[5]),re(u))return u;if(!K(u))return y.error.v;u=parseFloat(u)}if(l<1||l>o)return y.error.nm;if(u!=0&&u!=1)return y.error.nm;var f=window.luckysheet_function.PMT.f(t,o,a,s,u),m=window.luckysheet_function.IPMT.f(t,l,o,a,s,u);return f-m}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},INTRATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseInt(s)}if(o<=0||a<=0)return y.error.nm;if(s<0||s>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var u=(0,ve.default)(t).date(),f=(0,ve.default)(t).month()+1,m=(0,ve.default)(t).year(),d=(0,ve.default)(l).date(),p=(0,ve.default)(l).month()+1,b=(0,ve.default)(l).year(),g;switch(s){case 0:u===31&&d===31?(u=30,d=30):u===31?u=30:u===30&&d===31&&(d=30),g=360/(d+p*30+b*360-(u+f*30+m*360));break;case 1:var v=365;if(m===b||m+1===b&&(f>p||f===p&&u>=d))return(m===b&&q.isLeapYear(m)||q.feb29Between(t,l)||p===1&&d===29)&&(v=366),g=v/(0,ve.default)(l).diff((0,ve.default)(t),"days"),g=(a-o)/o*g,g;var x=b-m+1,_=((0,ve.default)().set({year:b+1,month:0,date:1})-(0,ve.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,S=_/x;g=S/(0,ve.default)(l).diff((0,ve.default)(t),"days");break;case 2:g=360/(0,ve.default)(l).diff((0,ve.default)(t),"days");break;case 3:g=365/(0,ve.default)(l).diff((0,ve.default)(t),"days");break;case 4:g=360/(d+p*30+b*360-(u+f*30+m*360));break}return g=(a-o)/o*g,g}catch(P){var I=P;return I=y.errorInfo(I),[y.error.v,I]}},PRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=q.getFirstValue(arguments[4]);if(re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s);var u=q.getFirstValue(arguments[5]);if(re(u))return u;if(!K(u))return y.error.v;u=parseInt(u);var f=0;if(arguments.length==7){if(f=q.getFirstValue(arguments[6]),re(f))return f;if(!K(f))return y.error.v;f=parseInt(f)}if(o<0||a<0)return y.error.nm;if(s<=0)return y.error.nm;if(u!=1&&u!=2&&u!=4)return y.error.nm;if(f<0||f>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var m=window.luckysheet_function.COUPDAYSNC.f(t,l,u,f),d=window.luckysheet_function.COUPDAYS.f(t,l,u,f),p=window.luckysheet_function.COUPDAYBS.f(t,l,u,f),b=window.luckysheet_function.COUPNUM.f(t,l,u,f);if(b>1){for(var g=s/Math.pow(1+a/u,b-1+m/d),v=0,e=1;e<=b;e++)v+=100*o/u/Math.pow(1+a/u,e-1+m/d);var x=100*(o/u)*(p/d),_=g+v-x}else var S=d-p,g=100*(o/u)+s,v=a/u*(S/d)+1,x=100*(o/u)*(p/d),_=g/v-x;return _}catch(P){var I=P;return I=y.errorInfo(I),[y.error.v,I]}},PRICEDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseInt(s)}if(o<=0||a<=0)return y.error.nm;if(s<0||s>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var u=(0,ve.default)(t).date(),f=(0,ve.default)(t).month()+1,m=(0,ve.default)(t).year(),d=(0,ve.default)(l).date(),p=(0,ve.default)(l).month()+1,b=(0,ve.default)(l).year(),g;switch(s){case 0:u===31&&d===31?(u=30,d=30):u===31?u=30:u===30&&d===31&&(d=30),g=(d+p*30+b*360-(u+f*30+m*360))/360;break;case 1:var v=365;if(m===b||m+1===b&&(f>p||f===p&&u>=d))return(m===b&&q.isLeapYear(m)||q.feb29Between(t,l)||p===1&&d===29)&&(v=366),g=(0,ve.default)(l).diff((0,ve.default)(t),"days")/v,g=a-o*a*g,g;var x=b-m+1,_=((0,ve.default)().set({year:b+1,month:0,date:1})-(0,ve.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,S=_/x;g=(0,ve.default)(l).diff((0,ve.default)(t),"days")/S;break;case 2:g=(0,ve.default)(l).diff((0,ve.default)(t),"days")/360;break;case 3:g=(0,ve.default)(l).diff((0,ve.default)(t),"days")/365;break;case 4:g=(d+p*30+b*360-(u+f*30+m*360))/360;break}return g=a-o*a*g,g}catch(P){var I=P;return I=y.errorInfo(I),[y.error.v,I]}},PRICEMAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getCellDate(arguments[2]);if(re(o))return o;if(!(0,ve.default)(o).isValid())return y.error.v;var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=q.getFirstValue(arguments[4]);if(re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s);var u=0;if(arguments.length==6){if(u=q.getFirstValue(arguments[5]),re(u))return u;if(!K(u))return y.error.v;u=parseInt(u)}if(a<0||s<0)return y.error.nm;if(u<0||u>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var f=(0,ve.default)(t).date(),m=(0,ve.default)(t).month()+1,d=(0,ve.default)(t).year(),p=(0,ve.default)(l).date(),b=(0,ve.default)(l).month()+1,g=(0,ve.default)(l).year(),v=(0,ve.default)(o).date(),x=(0,ve.default)(o).month()+1,_=(0,ve.default)(o).year(),S;switch(u){case 0:f==31&&(f=30),p==31&&(p=30),v==31&&(v=30);var I=360,P=p+b*30+g*360-(f+m*30+d*360),F=p+b*30+g*360-(v+x*30+_*360),D=f+m*30+d*360-(v+x*30+_*360);break;case 1:var k=365;if(d===g||d+1===g&&(m>b||m===b&&f>=p)){(d===g&&q.isLeapYear(d)||q.feb29Between(t,l)||b===1&&p===29)&&(k=366);var I=k,P=(0,ve.default)(l).diff((0,ve.default)(t),"days"),F=(0,ve.default)(t).diff((0,ve.default)(o),"days"),D=(0,ve.default)(l).diff((0,ve.default)(o),"days");return S=(100+F/I*a*100)/(1+P/I*s)-D/I*a*100,S}var w=g-d+1,C=((0,ve.default)().set({year:g+1,month:0,date:1})-(0,ve.default)().set({year:d,month:0,date:1}))/1e3/60/60/24,T=C/w,I=T,P=(0,ve.default)(l).diff((0,ve.default)(t),"days"),F=(0,ve.default)(t).diff((0,ve.default)(o),"days"),D=(0,ve.default)(l).diff((0,ve.default)(o),"days");break;case 2:var I=360,P=(0,ve.default)(l).diff((0,ve.default)(t),"days"),F=(0,ve.default)(t).diff((0,ve.default)(o),"days"),D=(0,ve.default)(l).diff((0,ve.default)(o),"days");break;case 3:var I=365,P=(0,ve.default)(l).diff((0,ve.default)(t),"days"),F=(0,ve.default)(t).diff((0,ve.default)(o),"days"),D=(0,ve.default)(l).diff((0,ve.default)(o),"days");break;case 4:var I=360,P=p+b*30+g*360-(f+m*30+d*360),F=p+b*30+g*360-(v+x*30+_*360),D=f+m*30+d*360-(v+x*30+_*360);break}return S=(100+F/I*a*100)/(1+P/I*s)-D/I*a*100,S}catch(z){var O=z;return O=y.errorInfo(O),[y.error.v,O]}},RECEIVED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}if(o<=0||a<=0)return y.error.nm;if(s<0||s>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var u=(0,ve.default)(t).date(),f=(0,ve.default)(t).month()+1,m=(0,ve.default)(t).year(),d=(0,ve.default)(l).date(),p=(0,ve.default)(l).month()+1,b=(0,ve.default)(l).year(),g;switch(s){case 0:u==31&&(u=30),d==31&&(d=30);var v=360,x=d+p*30+b*360-(u+f*30+m*360);break;case 1:var _=365;if(m===b||m+1===b&&(f>p||f===p&&u>=d)){(m===b&&q.isLeapYear(m)||q.feb29Between(t,l)||p===1&&d===29)&&(_=366);var v=_,x=(0,ve.default)(l).diff((0,ve.default)(t),"days");return g=o/(1-a*x/v),g}var S=b-m+1,I=((0,ve.default)().set({year:b+1,month:0,date:1})-(0,ve.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,P=I/S,v=P,x=(0,ve.default)(l).diff((0,ve.default)(t),"days");break;case 2:var v=360,x=(0,ve.default)(l).diff((0,ve.default)(t),"days");break;case 3:var v=365,x=(0,ve.default)(l).diff((0,ve.default)(t),"days");break;case 4:var v=360,x=d+p*30+b*360-(u+f*30+m*360);break}return g=o/(1-a*x/v),g}catch(D){var F=D;return F=y.errorInfo(F),[y.error.v,F]}},DISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=0;if(arguments.length==5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}if(o<=0||a<=0)return y.error.nm;if(s<0||s>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var u=(0,ve.default)(t).date(),f=(0,ve.default)(t).month()+1,m=(0,ve.default)(t).year(),d=(0,ve.default)(l).date(),p=(0,ve.default)(l).month()+1,b=(0,ve.default)(l).year(),g;switch(s){case 0:u==31&&(u=30),d==31&&(d=30);var v=360,x=d+p*30+b*360-(u+f*30+m*360);break;case 1:var _=365;if(m===b||m+1===b&&(f>p||f===p&&u>=d)){(m===b&&q.isLeapYear(m)||q.feb29Between(t,l)||p===1&&d===29)&&(_=366);var v=_,x=(0,ve.default)(l).diff((0,ve.default)(t),"days");return g=(a-o)/a*(v/x),g}var S=b-m+1,I=((0,ve.default)().set({year:b+1,month:0,date:1})-(0,ve.default)().set({year:m,month:0,date:1}))/1e3/60/60/24,P=I/S,v=P,x=(0,ve.default)(l).diff((0,ve.default)(t),"days");break;case 2:var v=360,x=(0,ve.default)(l).diff((0,ve.default)(t),"days");break;case 3:var v=365,x=(0,ve.default)(l).diff((0,ve.default)(t),"days");break;case 4:var v=360,x=d+p*30+b*360-(u+f*30+m*360);break}return g=(a-o)/a*(v/x),g}catch(D){var F=D;return F=y.errorInfo(F),[y.error.v,F]}},NPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=0;if(arguments.length>=4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a)}var s=0;if(arguments.length>=5){if(s=q.getFirstValue(arguments[4]),re(s))return s;if(!K(s))return y.error.v;s=parseFloat(s)}if(s!=0&&s!=1)return y.error.nm;var u=l*(1+t*s)-a*t,f=o*t+l*(1+t*s);return Math.log(u/f)/Math.log(1+t)}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},SLN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o=q.getFirstValue(arguments[2]);return re(o)?o:K(o)?(o=parseFloat(o),o==0?y.error.d:(t-l)/o):y.error.v}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},DURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=q.getFirstValue(arguments[4]);if(re(s))return s;if(!K(s))return y.error.v;s=parseInt(s);var u=0;if(arguments.length==6){if(u=q.getFirstValue(arguments[5]),re(u))return u;if(!K(u))return y.error.v;u=parseInt(u)}if(o<0||a<0)return y.error.nm;if(s!=1&&s!=2&&s!=4)return y.error.nm;if(u<0||u>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;for(var f=window.luckysheet_function.COUPNUM.f(t,l,s,u),m=0,d=0,e=1;e<=f;e++)m+=100*(o/s)*e/Math.pow(1+a/s,e),d+=100*(o/s)/Math.pow(1+a/s,e);var p=(m+100*f/Math.pow(1+a/s,f))/(d+100/Math.pow(1+a/s,f));return p=p/s,p}catch(g){var b=g;return b=y.errorInfo(b),[y.error.v,b]}},MDURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellDate(arguments[0]);if(re(t))return t;if(!(0,ve.default)(t).isValid())return y.error.v;var l=q.getCellDate(arguments[1]);if(re(l))return l;if(!(0,ve.default)(l).isValid())return y.error.v;var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o);var a=q.getFirstValue(arguments[3]);if(re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a);var s=q.getFirstValue(arguments[4]);if(re(s))return s;if(!K(s))return y.error.v;s=parseInt(s);var u=0;if(arguments.length==6){if(u=q.getFirstValue(arguments[5]),re(u))return u;if(!K(u))return y.error.v;u=parseInt(u)}if(o<0||a<0)return y.error.nm;if(s!=1&&s!=2&&s!=4)return y.error.nm;if(u<0||u>4)return y.error.nm;if((0,ve.default)(t)-(0,ve.default)(l)>=0)return y.error.nm;var f=window.luckysheet_function.DURATION.f(t,l,o,a,s,u);return f/(1+a/s)}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},BIN2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!/^[01]{1,10}$/g.test(t))return y.error.nm;var l=parseInt(t,2),o=t.toString();return o.length===10&&o.substring(0,1)==="1"?parseInt(o.substring(1),2)-512:l}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},BIN2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;var l=null;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}if(!/^[01]{1,10}$/g.test(t))return y.error.nm;var o=parseInt(t,2).toString(16).toUpperCase();return l==null?o:l<0||l<o.length?y.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},BIN2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;var l=null;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}if(!/^[01]{1,10}$/g.test(t))return y.error.nm;var o=t.toString();if(o.length===10&&o.substring(0,1)==="1")return(1073741312+parseInt(o.substring(1),2)).toString(8);var a=parseInt(t,2).toString(8);return l==null?a:l<0||l<a.length?y.error.nm:new Array(l-a.length+1).join("0")+a}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},DEC2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=null;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return y.error.nm;if(t<0)return"1"+new Array(9-(512+t).toString(2).length).join("0")+(512+t).toString(2);var o=parseInt(t,10).toString(2);return l==null?o:l<0||l<o.length?y.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},DEC2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=null;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return y.error.nm;if(t<0)return(1099511627776+t).toString(16).toUpperCase();var o=parseInt(t,10).toString(16).toUpperCase();return l==null?o:l<0||l<o.length?y.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},DEC2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=null;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return y.error.nm;if(t<0)return(1073741824+t).toString(8);var o=parseInt(t,10).toString(8);return l==null?o:l<0||l<o.length?y.error.nm:new Array(l-o.length+1).join("0")+o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},HEX2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;var l=null;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return y.error.nm;var o=t.length===10&&t.substring(0,1).toLowerCase()==="f",a=o?parseInt(t,16)-1099511627776:parseInt(t,16);if(a<-512||a>511)return y.error.nm;if(o)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var s=a.toString(2);return l==null?s:l<0||l<s.length?y.error.nm:new Array(l-s.length+1).join("0")+s}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},HEX2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return y.error.nm;var l=parseInt(t,16);return l>=549755813888?l-1099511627776:l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},HEX2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;var l=null;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return y.error.nm;var o=parseInt(t,16);if(o>536870911&&o<1098974756864)return y.error.nm;if(o>=1098974756864)return(o-1098437885952).toString(8);var a=o.toString(8);return l==null?a:l<0||l<a.length?y.error.nm:new Array(l-a.length+1).join("0")+a}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},OCT2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;var l=null;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}if(!/^[0-7]{1,10}$/.test(t))return y.error.nm;t=t.toString();var o=t.length===10&&t.substring(0,1)==="7",a=o?parseInt(t,8)-1073741824:parseInt(t,8);if(a<-512||a>511)return Et.num;if(o)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var s=a.toString(2);return l==null?s:l<0||l<s.length?y.error.nm:new Array(l-s.length+1).join("0")+s}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},OCT2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!/^[0-7]{1,10}$/.test(t))return y.error.nm;var l=parseInt(t,8);return l>=536870912?l-1073741824:l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},OCT2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;var l=null;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}if(!/^[0-7]{1,10}$/.test(t))return y.error.nm;var o=parseInt(t,8);if(o>=536870912)return"FF"+(o+3221225472).toString(16).toUpperCase();var a=o.toString(16).toUpperCase();return l==null?a:l<0||l<a.length?y.error.nm:new Array(l-a.length+1).join("0")+a}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},COMPLEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l);var o="i";if(arguments.length==3&&(o=arguments[2].toString()),o!="i"&&o!="j")return y.error.v;if(t===0&&l===0)return 0;if(t===0)return l===1?o:l.toString()+o;if(l===0)return t.toString();var a=l>0?"+":"";return t.toString()+a+(l===1?o:l.toString()+o)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},IMREAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return y.error.v;if(t=="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;var l=t.indexOf("+"),o=t.indexOf("-");l===0&&(l=t.indexOf("+",1)),o===0&&(o=t.indexOf("-",1));var a=t.substring(t.length-1,t.length),s=a==="i"||a==="j";return l>=0||o>=0?s?l>=0?isNaN(t.substring(0,l))||isNaN(t.substring(l+1,t.length-1))?y.error.nm:Number(t.substring(0,l)):isNaN(t.substring(0,o))||isNaN(t.substring(o+1,t.length-1))?y.error.nm:Number(t.substring(0,o)):y.error.nm:s?isNaN(t.substring(0,t.length-1))?y.error.nm:0:isNaN(t)?y.error.nm:t}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},IMAGINARY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return y.error.v;if(t=="0")return 0;if(["i","j"].indexOf(t)>=0)return 1;t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var l=t.indexOf("+"),o=t.indexOf("-");l===0&&(l=t.indexOf("+",1)),o===0&&(o=t.indexOf("-",1));var a=t.substring(t.length-1,t.length),s=a==="i"||a==="j";return l>=0||o>=0?s?l>=0?isNaN(t.substring(0,l))||isNaN(t.substring(l+1,t.length-1))?y.error.nm:Number(t.substring(l+1,t.length-1)):isNaN(t.substring(0,o))||isNaN(t.substring(o+1,t.length-1))?y.error.nm:-Number(t.substring(o+1,t.length-1)):y.error.nm:s?isNaN(t.substring(0,t.length-1))?y.error.nm:t.substring(0,t.length-1):isNaN(t)?y.error.nm:0}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},IMCONJUGATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;t=t.toString();var l=window.luckysheet_function.IMREAL.f(t);if(re(l))return l;var o=window.luckysheet_function.IMAGINARY.f(t);if(re(o))return o;var a=t.substring(t.length-1);return a=a==="i"||a==="j"?a:"i",o!==0?window.luckysheet_function.COMPLEX.f(l,-o,a):t}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},IMABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(re(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);return re(l)?l:Math.sqrt(Math.pow(t,2)+Math.pow(l,2))}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},DELTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=0;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseFloat(l)}return t===l?1:0}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},IMSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(re(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(re(l))return l;for(var o=arguments[0],e=1;e<arguments.length;e++){var a=window.luckysheet_function.IMREAL.f(o);if(re(a))return a;var s=window.luckysheet_function.IMAGINARY.f(o);if(re(s))return s;var u=window.luckysheet_function.IMREAL.f(arguments[e]);if(re(u))return u;var f=window.luckysheet_function.IMAGINARY.f(arguments[e]);if(re(f))return f;o=window.luckysheet_function.COMPLEX.f(a+u,s+f)}return o}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},IMSUB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return y.error.v;var l=window.luckysheet_function.IMREAL.f(t);if(re(l))return l;var o=window.luckysheet_function.IMAGINARY.f(t);if(re(o))return o;var a=q.getFirstValue(arguments[1]);if(re(a))return a;if(a=a.toString(),a.toLowerCase()=="true"||a.toLowerCase()=="false")return y.error.v;var s=window.luckysheet_function.IMREAL.f(a);if(re(s))return s;var u=window.luckysheet_function.IMAGINARY.f(a);if(re(u))return u;var f=t.substring(t.length-1),m=a.substring(a.length-1),d="i";return(f==="j"||m==="j")&&(d="j"),window.luckysheet_function.COMPLEX.f(l-s,o-u,d)}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},IMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheet_function.IMREAL.f(arguments[0]);if(re(t))return t;var l=window.luckysheet_function.IMAGINARY.f(arguments[0]);if(re(l))return l;for(var o=arguments[0],e=1;e<arguments.length;e++){var a=window.luckysheet_function.IMREAL.f(o);if(re(a))return a;var s=window.luckysheet_function.IMAGINARY.f(o);if(re(s))return s;var u=window.luckysheet_function.IMREAL.f(arguments[e]);if(re(u))return u;var f=window.luckysheet_function.IMAGINARY.f(arguments[e]);if(re(f))return f;o=window.luckysheet_function.COMPLEX.f(a*u-s*f,a*f+s*u)}return o}catch(d){var m=d;return m=y.errorInfo(m),[y.error.v,m]}},IMDIV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(t=t.toString(),t.toLowerCase()=="true"||t.toLowerCase()=="false")return y.error.v;var l=window.luckysheet_function.IMREAL.f(t);if(re(l))return l;var o=window.luckysheet_function.IMAGINARY.f(t);if(re(o))return o;var a=q.getFirstValue(arguments[1]);if(re(a))return a;if(a=a.toString(),a.toLowerCase()=="true"||a.toLowerCase()=="false")return y.error.v;var s=window.luckysheet_function.IMREAL.f(a);if(re(s))return s;var u=window.luckysheet_function.IMAGINARY.f(a);if(re(u))return u;var f=t.substring(t.length-1),m=a.substring(a.length-1),d="i";if((f==="j"||m==="j")&&(d="j"),s===0&&u===0)return y.error.nm;var p=s*s+u*u;return window.luckysheet_function.COMPLEX.f((l*s+o*u)/p,(o*s-l*u)/p,d)}catch(g){var b=g;return b=y.errorInfo(b),[y.error.v,b]}},NOT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellBoolen(arguments[0]);return re(t)?t:!t}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},TRUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return!0}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},FALSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return!1}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},AND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=!0,e=0;e<arguments.length;e++){var l=q.getCellBoolen(arguments[e]);if(re(l))return l;if(!l){t=!1;break}}return t}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},IFERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[1],"text"),l=q.getFirstValue(arguments[0],"text");return re(l)||G(l)==="string"&&$.trim(l)===""?t:l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},IF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getCellBoolen(arguments[0]);if(re(t))return t;var l=q.getFirstValue(arguments[1],"text");if(re(l)&&o!=Et.d)return l;var o="";return arguments.length==3&&(o=q.getFirstValue(arguments[2],"text"),re(o)&&o!=Et.d)?o:t?l:o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},OR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t=!1,e=0;e<arguments.length;e++){var l=q.getCellBoolen(arguments[e]);if(re(l))return l;if(l){t=!0;break}}return t}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},NE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;var l=q.getFirstValue(arguments[1]);return re(l)?l:t!=l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;var l=q.getFirstValue(arguments[1]);return re(l)?l:t==l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},GT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),t>l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},GTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),t>=l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},LT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),t<l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},LTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),t<=l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ADD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),t+l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},MINUS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),t-l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},MULTIPLY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),t*l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},DIVIDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseFloat(l),l==0?y.error.d:t/l):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},CONCAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;var l=q.getFirstValue(arguments[1],"text");return re(l)?l:t+""+l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},UNARY_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=t/100;return Math.round(l*100)/100}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},CONCATENATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{for(var t="",e=0;e<arguments.length;e++){var l=q.getFirstValue(arguments[e],"text");if(re(l))return l;t=t+""+l}return t}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},CODE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:t==""?y.error.v:t.charCodeAt(0)}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},CHAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseInt(t),t<1||t>255?y.error.v:String.fromCharCode(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},ARABIC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;if(t=t.toString().toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))return y.error.v;var l=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(a){l+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]}),l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ROMAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{let o=function(a){var s=[["","I","II","III","IV","V","VI","VII","VIII","IX"],["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"],["","M","MM","MMM"]],u=s[3][Math.floor(a/1e3)],f=s[2][Math.floor(a%1e3/100)],m=s[1][Math.floor(a%100/10)],d=s[0][a%10];return u+f+m+d};var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseInt(t),t==0?"":t<1||t>3999?y.error.v:o(t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},REGEXEXTRACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;var l=q.getFirstValue(arguments[1],"text");if(re(l))return l;var o=t.match(new RegExp(l));return o?o[o.length>1?o.length-1:0]:null}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},REGEXMATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;var l=q.getFirstValue(arguments[1],"text");if(re(l))return l;var o=t.match(new RegExp(l));return!!o}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},REGEXREPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;var l=q.getFirstValue(arguments[1],"text");if(re(l))return l;var o=q.getFirstValue(arguments[2],"text");return re(o)?o:t.replace(new RegExp(l),o)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)||G(t)=="string"?t:""}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},FIXED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=2;if(arguments.length>=2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}var o=!1;if(arguments.length==3&&(o=q.getCellBoolen(arguments[2]),re(o)))return o;if(l>127)return y.error.v;var a=o?"0":"#,##0";return l<=0?t=Math.round(t*Math.pow(10,l))/Math.pow(10,l):l>0&&(a+="."+new Array(l+1).join("0")),Bl(a,t)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},FIND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();var l=q.getFirstValue(arguments[1],"text");if(re(l))return l;l=l.toString();var o=1;if(arguments.length==3){if(o=q.getFirstValue(arguments[2]),re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o)}if(o<0||o>l.length)return y.error.v;if(t=="")return o;if(l.indexOf(t)==-1)return y.error.v;var a=l.indexOf(t,o-1)+1;return a}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},FINDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();var l=q.getFirstValue(arguments[1],"text");if(re(l))return l;l=l.toString();var o=1;if(arguments.length==3){if(o=q.getFirstValue(arguments[2]),re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o)}if(o<0||o>l.length)return y.error.v;if(t=="")return o;if(l.indexOf(t)==-1)return y.error.v;for(var a=l.split(""),s=l.indexOf(t,o-1),u=0,e=0;e<s;e++)/[^\x00-\xff]/g.test(a[e])?u+=2:u+=1;return u}catch(m){var f=m;return f=y.errorInfo(f),[y.error.v,f]}},JOIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;for(var l=[],e=1;e<arguments.length;e++){var o=arguments[e];if(G(o)=="array"){if(G(o[0])=="array"&&!q.isDyadicArr(o))return y.error.v;l=l.concat(q.getDataArr(o,!1))}else G(o)=="object"&&o.startCell!=null?l=l.concat(q.getCellDataArr(o,"text",!1)):l.push(o)}return l.join(t)}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},LEFT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();var l=1;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}return l<0?y.error.v:l>=t.length?t:l==0?"":t.substr(0,l)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},RIGHT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();var l=1;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}return l<0?y.error.v:l>=t.length?t:l==0?"":t.substr(-l,l)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},MID:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getFirstValue(arguments[2]);return re(o)?o:K(o)?(o=parseInt(o),l<1||o<0?y.error.v:l>t.length?"":l+o>t.length?t.substr(l-1,t.length-l+1):t.substr(l-1,o)):y.error.v}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},LEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:(t=t.toString(),t.length)}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},LENB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:(t=t.toString(),t.replace(/[^\x00-\xff]/g,"aa").length)}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},LOWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:(t=t.toString(),t&&t.toLowerCase())}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},UPPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:(t=t.toString(),t&&t.toUpperCase())}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},EXACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();var l=q.getFirstValue(arguments[1],"text");return re(l)?l:(l=l.toString(),t===l)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},REPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();var l=q.getFirstValue(arguments[1]);if(re(l))return l;if(!K(l))return y.error.v;l=parseInt(l);var o=q.getFirstValue(arguments[2]);if(re(o))return o;if(!K(o))return y.error.v;o=parseInt(o);var a=q.getFirstValue(arguments[3],"text");return re(a)?a:(a=a.toString(),t.substr(0,l-1)+a+t.substr(l-1+o))}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},REPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();var l=q.getFirstValue(arguments[1]);return re(l)?l:K(l)?(l=parseInt(l),l<0?y.error.v:(l>100&&(l=100),new Array(l+1).join(t))):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},SEARCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();var l=q.getFirstValue(arguments[1],"text");if(re(l))return l;l=l.toString();var o=1;if(arguments.length==3){if(o=q.getFirstValue(arguments[2]),re(o))return o;if(!K(o))return y.error.v;o=parseInt(o)}if(o<=0||o>l.length)return y.error.v;var a=l.toLowerCase().indexOf(t.toLowerCase(),o-1)+1;return a===0?y.error.v:a}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},SUBSTITUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();var l=q.getFirstValue(arguments[1],"text");if(re(l))return l;l=l.toString();var o=q.getFirstValue(arguments[2],"text");if(re(o))return o;o=o.toString();var a=null;if(arguments.length==4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseInt(a)}var s=new RegExp(l,"g"),u;if(a==null)u=t.replace(s,o);else{if(a<=0)return y.error.v;var f=t.match(s);if(f==null||a>f.length)return t;for(var m=l.length,d=0,e=1;e<=a;e++)d=t.indexOf(l,d)+1;u=t.substring(0,d-1)+o+t.substring(d-1+m)}return u}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},CLEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");if(re(t))return t;t=t.toString();for(var l=[],e=0;e<t.length;e++){var o=t.charCodeAt(e);(/[\u4e00-\u9fa5]/g.test(t.charAt(e))||o>31&&o<127)&&l.push(t.charAt(e))}return l.join("")}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1],"text");return re(l)?l:(l=l.toString(),Bl(l,t))}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},TRIM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:(t=t.toString(),t.replace(/ +/g," ").trim())}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},VALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:(t=t.toString(),_l(t)[2])}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},PROPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:(t=t.toString().toLowerCase(),t.replace(/[a-zA-Z]+/g,function(o){return o.substring(0,1).toUpperCase()+o.substring(1)}))}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},CONVERT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseFloat(t);var l=q.getFirstValue(arguments[1],"text");if(re(l))return l;l=l.toString();var o=q.getFirstValue(arguments[2],"text");if(re(o))return o;o=o.toString();for(var a=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,30856775814671900],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,1125899906842624,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},u={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},f=null,m=null,d=l,p=o,b=1,g=1,v,e=0;e<a.length;e++)v=a[e][2]===null?[]:a[e][2],(a[e][1]===d||v.indexOf(d)>=0)&&(f=a[e]),(a[e][1]===p||v.indexOf(p)>=0)&&(m=a[e]);if(f===null){var x=s[l.substring(0,2)],_=u[l.substring(0,1)];l.substring(0,2)==="da"&&(_=["dekao",10,"da"]),x?(b=x[2],d=l.substring(2)):_&&(b=_[1],d=l.substring(_[2].length));for(var S=0;S<a.length;S++)v=a[S][2]===null?[]:a[S][2],(a[S][1]===d||v.indexOf(d)>=0)&&(f=a[S])}if(m===null){var I=s[o.substring(0,2)],P=u[o.substring(0,1)];o.substring(0,2)==="da"&&(P=["dekao",10,"da"]),I?(g=I[2],p=o.substring(2)):P&&(g=P[1],p=o.substring(P[2].length));for(var F=0;F<a.length;F++)v=a[F][2]===null?[]:a[F][2],(a[F][1]===p||v.indexOf(p)>=0)&&(m=a[F])}return f===null||m===null?y.error.na:f[3]!==m[3]?y.error.na:t*f[6]*b/(m[6]*g)}catch(k){var D=k;return D=y.errorInfo(D),[y.error.v,D]}},SUMX2MY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(G(o)=="array"){if(G(o[0])=="array"&&!q.isDyadicArr(o))return y.error.v;a=a.concat(q.getDataArr(o,!1))}else G(o)=="object"&&o.startCell!=null?a=a.concat(q.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return y.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];K(f)&&K(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}for(var d=0,e=0;e<s.length;e++)d+=Math.pow(s[e],2)-Math.pow(u[e],2);return d}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},SUMX2PY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(G(o)=="array"){if(G(o[0])=="array"&&!q.isDyadicArr(o))return y.error.v;a=a.concat(q.getDataArr(o,!1))}else G(o)=="object"&&o.startCell!=null?a=a.concat(q.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return y.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];K(f)&&K(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}for(var d=0,e=0;e<s.length;e++)d+=Math.pow(s[e],2)+Math.pow(u[e],2);return d}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},SUMXMY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!1))}else G(t)=="object"&&t.startCell!=null?l=l.concat(q.getCellDataArr(t,"text",!1)):l.push(t);var o=arguments[1],a=[];if(G(o)=="array"){if(G(o[0])=="array"&&!q.isDyadicArr(o))return y.error.v;a=a.concat(q.getDataArr(o,!1))}else G(o)=="object"&&o.startCell!=null?a=a.concat(q.getCellDataArr(o,"text",!1)):a.push(o);if(l.length!=a.length)return y.error.na;for(var s=[],u=[],e=0;e<l.length;e++){var f=l[e],m=a[e];K(f)&&K(m)&&(s.push(parseFloat(f)),u.push(parseFloat(m)))}for(var d=0,e=0;e<s.length;e++)d+=Math.pow(s[e]-u[e],2);return d}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},TRANSPOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=q.getDataDyadicArr(t)}else G(t)=="object"&&t.startCell!=null&&(l=q.getCellDataDyadicArr(t,"number"));return l=l[0].map(function(a,s){return l.map(function(u){return u[s]})}),l}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},TREND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{let w=function(C,T){for(var O=0,z=0,A=0,E=0,L=0;L<C.length;L++)for(var N=0;N<C[L].length;N++)O+=C[L][N],z+=T[L][N],A+=C[L][N]*T[L][N],E+=C[L][N]*C[L][N];var W=C.length*C[0].length,X=O/W,te=z/W,ue=A/W,pe=E/W,ne=(ue-X*te)/(pe-X*X),me=te-ne*X;return[ne,me]};var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=q.getDataDyadicArr(t)}else if(G(t)=="object"&&t.startCell!=null)l=q.getCellDataDyadicArr(t,"text");else{if(!K(t))return y.error.v;var o=[];o.push(parseFloat(t)),l.push(o)}for(var a=l.length,s=l[0].length,e=0;e<a;e++)for(var u=0;u<s;u++){if(!K(l[e][u]))return y.error.v;l[e][u]=parseFloat(l[e][u])}for(var f=[],e=1;e<=a;e++)for(var u=1;u<=s;u++){var m=(e-1)*s+u;f.push(m)}if(arguments.length>=2){var d=arguments[1];if(f=[],G(d)=="array"){if(G(d[0])=="array"&&!q.isDyadicArr(d))return y.error.v;f=q.getDataDyadicArr(d)}else if(G(d)=="object"&&d.startCell!=null)f=q.getCellDataDyadicArr(d,"text");else{if(!K(d))return y.error.v;var o=[];o.push(parseFloat(d)),f.push(o)}for(var e=0;e<f.length;e++)for(var u=0;u<f[0].length;u++){if(!K(f[e][u]))return y.error.v;f[e][u]=parseFloat(f[e][u])}}var p=f.length,b=f[0].length,g=f;if(arguments.length>=3){var v=arguments[2];if(g=[],G(v)=="array"){if(G(v[0])=="array"&&!q.isDyadicArr(v))return y.error.v;g=q.getDataDyadicArr(v)}else if(G(v)=="object"&&v.startCell!=null)g=q.getCellDataDyadicArr(v,"text");else{if(!K(v))return y.error.v;var o=[];o.push(parseFloat(v)),g.push(o)}for(var e=0;e<g.length;e++)for(var u=0;u<g[0].length;u++){if(!K(g[e][u]))return y.error.v;g[e][u]=parseFloat(g[e][u])}}var x=!0;if(arguments.length==4&&(x=q.getCellBoolen(arguments[3]),re(x)))return x;if(a!=p||s!=b)return y.error.r;var _=w(f,l),S=_[0];if(x)var I=_[1];else var I=0;for(var P=[],e=0;e<g.length;e++)for(var u=0;u<g[e].length;u++){var F=g[e][u],D=S*F+I;P.push(Math.round(D*1e9)/1e9)}return P}catch(w){var k=w;return k=y.errorInfo(k),[y.error.v,k]}},FREQUENCY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=l.concat(q.getDataArr(t,!0))}else if(G(t)=="object"&&t.startCell!=null)l=l.concat(q.getCellDataArr(t,"number",!0));else{if(!K(t))return y.error.v;l.push(t)}for(var o=[],e=0;e<l.length;e++)K(l[e])&&o.push(parseFloat(l[e]));var a=arguments[1],s=[];if(G(a)=="array"){if(G(a[0])=="array"&&!q.isDyadicArr(a))return y.error.v;s=s.concat(q.getDataArr(a,!0))}else if(G(a)=="object"&&a.startCell!=null)s=s.concat(q.getCellDataArr(a,"number",!0));else{if(!K(a))return y.error.v;s.push(a)}for(var u=[],e=0;e<s.length;e++)K(s[e])&&u.push(parseFloat(s[e]));if(o.length==0&&u.length==0)return[[0],[0]];if(o.length==0){for(var f=[[0]],e=0;e<u.length;e++)f.push([0]);return f}else{if(u.length==0)return[[0],[o.length]];u.sort(function(x,_){return x-_});for(var f=[],e=0;e<u.length;e++)if(e==0){for(var m=0,d=0;d<o.length;d++)o[d]<=u[0]&&m++;f.push([m])}else if(e==u.length-1){for(var p=0,b=0,d=0;d<o.length;d++)o[d]<=u[e]&&o[d]>u[e-1]&&p++,o[d]>u[e]&&b++;f.push([p]),f.push([b])}else{for(var m=0,d=0;d<o.length;d++)o[d]<=u[e]&&o[d]>u[e-1]&&m++;f.push([m])}return f}}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},GROWTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{let w=function(C,T){for(var O=0,z=0,A=0,E=0,L=0;L<C.length;L++)for(var N=0;N<C[L].length;N++)O+=C[L][N],z+=Math.log(T[L][N]),A+=C[L][N]*Math.log(T[L][N]),E+=C[L][N]*C[L][N];var W=C.length*C[0].length,X=O/W,te=z/W,ue=A/W,pe=E/W,ne=(ue-X*te)/(pe-X*X),me=te-ne*X;return[Math.exp(ne),Math.exp(me)]};var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=q.getDataDyadicArr(t)}else if(G(t)=="object"&&t.startCell!=null)l=q.getCellDataDyadicArr(t,"text");else{if(!K(t))return y.error.v;var o=[];o.push(parseFloat(t)),l.push(o)}for(var a=l.length,s=l[0].length,e=0;e<a;e++)for(var u=0;u<s;u++){if(!K(l[e][u]))return y.error.v;l[e][u]=parseFloat(l[e][u])}for(var f=[],e=1;e<=a;e++)for(var u=1;u<=s;u++){var m=(e-1)*s+u;f.push(m)}if(arguments.length>=2){var d=arguments[1];if(f=[],G(d)=="array"){if(G(d[0])=="array"&&!q.isDyadicArr(d))return y.error.v;f=q.getDataDyadicArr(d)}else if(G(d)=="object"&&d.startCell!=null)f=q.getCellDataDyadicArr(d,"text");else{if(!K(d))return y.error.v;var o=[];o.push(parseFloat(d)),f.push(o)}for(var e=0;e<f.length;e++)for(var u=0;u<f[0].length;u++){if(!K(f[e][u]))return y.error.v;f[e][u]=parseFloat(f[e][u])}}var p=f.length,b=f[0].length,g=f;if(arguments.length>=3){var v=arguments[2];if(g=[],G(v)=="array"){if(G(v[0])=="array"&&!q.isDyadicArr(v))return y.error.v;g=q.getDataDyadicArr(v)}else if(G(v)=="object"&&v.startCell!=null)g=q.getCellDataDyadicArr(v,"text");else{if(!K(v))return y.error.v;var o=[];o.push(parseFloat(v)),g.push(o)}for(var e=0;e<g.length;e++)for(var u=0;u<g[0].length;u++){if(!K(g[e][u]))return y.error.v;g[e][u]=parseFloat(g[e][u])}}var x=!0;if(arguments.length==4&&(x=q.getCellBoolen(arguments[3]),re(x)))return x;if(a!=p||s!=b)return y.error.r;var _=w(f,l),S=_[0];if(x)var I=_[1];else var I=1;for(var P=[],e=0;e<g.length;e++)for(var u=0;u<g[e].length;u++){var F=g[e][u],D=I*Math.pow(S,F);P.push(Math.round(D*1e9)/1e9)}return P}catch(w){var k=w;return k=y.errorInfo(k),[y.error.v,k]}},LINEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return y.error.v}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},LOGEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return y.error.v}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},MDETERM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{let u=function(f,m){var d,p=new Array;if(m==1)return d=f[0][0],d;if(m==2)return d=f[0][0]*f[1][1]-f[0][1]*f[1][0],d;if(m==3)return d=f[0][0]*f[1][1]*f[2][2]+f[1][0]*f[2][1]*f[0][2]+f[2][0]*f[0][1]*f[1][2]-f[2][0]*f[1][1]*f[0][2]-f[0][0]*f[2][1]*f[1][2]-f[1][0]*f[0][1]*f[2][2],d;d=0;for(var b=new Array,g=new Array,v=0;v<m;v++)p[v]=f[v][0]*Math.pow(-1,v+1+1);for(var v=0;v<m;v++){g[v]=new Array;for(var x=0;x<m-1;x++)g[v][x]=f[v][x+1]}for(var v=0;v<m;v++){for(var x=0;x<m;x++){b[x]=new Array;for(var _=0;_<m-1;_++)v>x?b[x][_]=g[x][_]:v<x&&(b[x-1][_]=g[x][_])}d+=p[v]*arguments.callee(b,m-1)}return d};var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=q.getDataDyadicArr(t)}else if(G(t)=="object"&&t.startCell!=null)l=q.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++){if(!K(l[e][a]))return y.error.v;l[e][a]=parseFloat(l[e][a])}return l.length!=l[0].length?y.error.v:u(l,l.length)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},MINVERSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=q.getDataDyadicArr(t)}else if(G(t)=="object"&&t.startCell!=null)l=q.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++){if(!K(l[e][a]))return y.error.v;l[e][a]=parseFloat(l[e][a])}return l.length!=l[0].length?y.error.v:Th(l)}catch(u){var s=u;return s=y.errorInfo(s),[y.error.v,s]}},MMULT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=q.getDataDyadicArr(t)}else if(G(t)=="object"&&t.startCell!=null)l=q.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++){if(!K(l[e][a]))return y.error.v;l[e][a]=parseFloat(l[e][a])}var s=arguments[1],u=[];if(G(s)=="array"){if(G(s[0])=="array"&&!q.isDyadicArr(s))return y.error.v;u=q.getDataDyadicArr(s)}else if(G(s)=="object"&&s.startCell!=null)u=q.getCellDataDyadicArr(s,"text");else{var o=[];o.push(s),u.push(o)}for(var e=0;e<u.length;e++)for(var a=0;a<u[e].length;a++){if(!K(u[e][a]))return y.error.v;u[e][a]=parseFloat(u[e][a])}if(l[0].length!=u.length)return y.error.v;for(var f=l.length,m=u[0].length,d=[],p=0;p<f;p++){for(var o=[],b=0;b<m;b++){for(var g=0,n=0;n<l[0].length;n++)g+=l[p][n]*u[n][b];o.push(g)}d.push(o)}return d}catch(x){var v=x;return v=y.errorInfo(v),[y.error.v,v]}},SUMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=q.getDataDyadicArr(t)}else if(G(t)=="object"&&t.startCell!=null)l=q.getCellDataDyadicArr(t,"text");else{var o=[];o.push(t),l.push(o)}for(var e=0;e<l.length;e++)for(var a=0;a<l[e].length;a++)K(l[e][a])?l[e][a]=parseFloat(l[e][a]):l[e][a]=0;var s=l.length,u=l[0].length;if(arguments.length>=2)for(var e=1;e<arguments.length;e++){var f=arguments[e],m=[];if(G(f)=="array"){if(G(f[0])=="array"&&!q.isDyadicArr(f))return y.error.v;m=q.getDataDyadicArr(f)}else if(G(f)=="object"&&f.startCell!=null)m=q.getCellDataDyadicArr(f,"text");else{var o=[];o.push(f),m.push(o)}if(m.length!=s||m[0].length!=u)return y.error.v;for(var d=0;d<s;d++)for(var p=0;p<u;p++)K(m[d][p])?l[d][p]=l[d][p]*parseFloat(m[d][p]):l[d][p]=0}for(var b=0,d=0;d<s;d++)for(var p=0;p<u;p++)b+=l[d][p];return b}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},ISFORMULA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;return G(t)=="object"&&t.startCell!=null?t.data==null?!1:(G(t.data)=="array"?l=t.data[0][0]:l=t.data,l!=null&&l.f!=null):y.error.v}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},CELL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=t[0][0]}else l=t[0];else if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;if(G(t.data)=="array")return y.error.v;if(l=t.data.v,ft(l))return y.error.v}else l=t;var o=arguments[1],a;if(G(o)=="object"&&o.startCell!=null)a=o.startCell;else return y.error.v;if(["address","col","color","contents","filename","format","parentheses","prefix","protect","row","type","width"].indexOf(l)==-1)return y.error.v;var s=ur()[Me(h.currentSheetIndex)],u=y.getcellrange(a),f=u.row[0],m=u.column[0];let b=ur(),g=Me(h.calculateSheetIndex),v=b[g].data,x;switch(y.execFunctionGlobalData!=null&&y.execFunctionGlobalData[f+"_"+m+"_"+h.calculateSheetIndex]!=null?x=y.execFunctionGlobalData[f+"_"+m+"_"+h.calculateSheetIndex].v:v[f][m]!=null&&v[f][m].v!=null&&v[f][m].v!=""?(x=v[f][m],x instanceof Object&&(x=x.v)):x=0,l){case"address":return a;case"col":return m+1;case"color":return 0;case"contents":return x;case"filename":return s.name;case"format":return v[f][m]==null||v[f][m].ct==null?"G":v[f][m].ct.fa;case"parentheses":return v[f][m]==null||v[f][m].v==null||v[f][m].v==""?0:v[f][m].v>0?1:0;case"prefix":return x==0?"":v[f][m].ht==0?"^":v[f][m].ht==1?"'":v[f][m].ht==2?'"':"";case"protect":return 0;case"row":return f+1;case"type":return x==0?"b":"l";case"width":var d=s.config;return d.columnlen!=null&&m in d.columnlen?d.columnlen[m]:h.defaultcollen}}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},NA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return y.error.na}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},ERROR_TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=t[0][0]}else l=t[0];else if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.na;if(G(t.data)=="array"){if(l=t.data[0][0],l==null||ft(l.v))return y.error.na;l=l.v}else{if(ft(t.data.v))return y.error.na;l=t.data.v}}else l=t;var o={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7,"#GETTING_DATA":8};return l in o?o[l]:y.error.na}catch(s){var a=s;return a=y.errorInfo(a),[y.error.v,a]}},ISBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;return G(t)=="object"&&t.startCell!=null?t.data==null:!1}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ISERR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=t[0][0]}else l=t[0];else if(G(t)=="object"&&t.startCell!=null){if(G(t.data)=="array")return!0;if(t.data==null||ft(t.data.v))return!1;l=t.data.v}else l=t;return["#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ISERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=t[0][0]}else l=t[0];else if(G(t)=="object"&&t.startCell!=null){if(G(t.data)=="array")return!0;if(t.data==null||ft(t.data.v))return!1;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ISLOGICAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=t[0][0]}else l=t[0];else if(G(t)=="object"&&t.startCell!=null){if(G(t.data)=="array"||t.data==null||ft(t.data.v))return!1;l=t.data.v}else l=t;return l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ISNA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=t[0][0]}else l=t[0];else if(G(t)=="object"&&t.startCell!=null){if(G(t.data)=="array"||t.data==null||ft(t.data.v))return!1;l=t.data.v}else l=t;return l.toString()=="#N/A"}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ISNONTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=t[0][0]}else l=t[0];else if(G(t)=="object"&&t.startCell!=null){if(G(t.data)=="array"||t.data==null||ft(t.data.v))return!0;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1||l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?!0:!!K(l)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ISNUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=t[0][0]}else l=t[0];else if(G(t)=="object"&&t.startCell!=null){if(G(t.data)=="array"||t.data==null||ft(t.data.v))return!1;l=t.data.v}else l=t;return!!K(l)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},ISREF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{return G(arguments[0])=="object"&&arguments[0].startCell!=null}catch(l){var t=l;return t=y.errorInfo(t),[y.error.v,t]}},ISTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=t[0][0]}else l=t[0];else if(G(t)=="object"&&t.startCell!=null){if(G(t.data)=="array"||t.data==null||ft(t.data.v))return!1;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1||l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?!1:!K(l)}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")return 64;if(G(t)=="object"&&t.startCell!=null){if(G(t.data)=="array")return 16;if(t.data==null||ft(t.data.v))return 1;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1?16:l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?4:K(l)?1:2}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},N:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;l=t[0][0]}else l=t[0];else if(G(t)=="object"&&t.startCell!=null)if(G(t.data)=="array"){if(l=t.data[0][0],l==null||ft(l.v))return 0;l=l.v}else{if(t.data==null||ft(t.data.v))return 0;l=t.data.v}else l=t;return["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(l)>-1?l:l.toString().toLowerCase()=="true"||l.toString().toLowerCase()=="false"?l.toString().toLowerCase()=="true"?1:0:K(l)?parseFloat(l):0}catch(a){var o=a;return o=y.errorInfo(o),[y.error.v,o]}},TO_DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),Bl("yyyy-mm-dd",t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},TO_PURE_NUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:(0,ve.default)(t).isValid()?_l(t)[2]:(0,bf.default)(t).value()==null?t:(0,bf.default)(t).value()}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},TO_TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0],"text");return re(t)?t:Bl("@",t)}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},TO_DOLLARS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),Bl("$ 0.00",t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},TO_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);return re(t)?t:K(t)?(t=parseFloat(t),Bl("0%",t)):y.error.v}catch(o){var l=o;return l=y.errorInfo(l),[y.error.v,l]}},DGET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);return u.length===0?y.error.v:u.length>1?y.error.nm:f[u[0]]}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},DMAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);for(var d=f[u[0]],e=1;e<u.length;e++)d<f[u[e]]&&(d=f[u[e]]);return d}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},DMIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=findResultIndex(l,s),f=[];if(G(o)==="string"){var m=findField(l,o);f=rest(l[m])}else f=rest(l[o]);for(var d=f[u[0]],e=1;e<u.length;e++)d>f[u[e]]&&(d=f[u[e]]);return d}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},DAVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);for(var d=0,e=0;e<u.length;e++)d+=f[u[e]];return u.length===0?y.error.d:d/u.length}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},DCOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return window.luckysheet_function.COUNT.f.apply(window.luckysheet_function.COUNT,d)}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},DCOUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return window.luckysheet_function.COUNTA.f.apply(window.luckysheet_function.COUNTA,d)}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},DPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];d=q.compact(d);var p=1;for(e=0;e<d.length;e++)p*=d[e];return p}catch(g){var b=g;return b=y.errorInfo(b),[y.error.v,b]}},DSTDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return d=q.compact(d),window.luckysheet_function.STDEVA.f.apply(window.luckysheet_function.STDEVA,d)}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},DSTDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return d=q.compact(d),window.luckysheet_function.STDEVP.f.apply(window.luckysheet_function.STDEVP,d)}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},DSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];d=q.compact(d);var p=0;for(e=0;e<d.length;e++)p+=d[e];return p}catch(g){var b=g;return b=y.errorInfo(b),[y.error.v,b]}},DVAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return d=q.compact(d),window.luckysheet_function.VAR_S.f.apply(window.luckysheet_function.VAR_S,d)}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},DVARP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="object"&&t.startCell!=null){if(t.data==null)return y.error.v;l=q.getCellDataDyadicArr(t,"text")}else return y.error.v;var o=q.getFirstValue(arguments[1],"text");if(re(o))return o;if(ft(o))return y.error.v;var a=arguments[2],s=[];if(G(a)=="object"&&a.startCell!=null){if(a.data==null)return y.error.v;s=q.getCellDataDyadicArr(a,"text")}else return y.error.v;if(!K(o)&&G(o)!=="string")return y.error.v;var u=q.findResultIndex(l,s),f=[];if(G(o)==="string"){var m=q.findField(l,o);f=q.rest(l[m])}else f=q.rest(l[o]);for(var d=[],e=0;e<u.length;e++)d[e]=f[u[e]];return d=q.compact(d),window.luckysheet_function.VAR_P.f.apply(window.luckysheet_function.VAR_P,d)}catch(b){var p=b;return p=y.errorInfo(p),[y.error.v,p]}},LINESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList,s=arguments[0],u=arguments[1],f=arguments[2],m=arguments[3],d=arguments[4],p=arguments[5],b=arguments[6],g=arguments[7];let w=ur(),C=Me(h.calculateSheetIndex),T=w[C].data;var v=y.readCellDataToOneArray(s),x=_t.getCellRealSize(T,t,l),_=x[0],S=x[1],I={};f==null&&(f=1),I.lineWidth=f,I.offsetY=f+1,I.height=S-(f+1),I.width=_;var P=function(O,z){z&&(typeof z=="number"&&(z>19&&(z=z%20),z=a[z]),I[O]=z)};if(u==null&&(u="#2ec7c9"),P("lineColor",u),I.fillColor=0,m)if(typeof m=="string"){m=m.toLowerCase();var F=null;m=="min"?F=window.luckysheet_function.MIN.f({data:v}):m=="max"?F=window.luckysheet_function.MAX.f({data:v}):m=="avg"||m=="mean"?F=window.luckysheet_function.AVERAGE.f({data:v}):m=="median"&&(F=window.luckysheet_function.MEDIAN.f({data:v})),F&&(I.normalRangeMin=F,I.normalRangeMax=F)}else I.normalRangeMin=m,I.normalRangeMax=m;d==null&&(d="#000"),P("normalRangeColor",d),P("maxSpotColor",p),P("minSpotColor",b),g==null&&(g="1.5"),I.spotRadius=g;var D=Hi.init(v,I);return D}catch(w){var k=w;return k=y.errorInfo(k),[y.error.v,k]}},AREASPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList,s=arguments[0],u=arguments[1],f=arguments[2],m=arguments[3],d=arguments[4],p=arguments[5],b=y.readCellDataToOneArray(s);let D=ur(),k=Me(h.calculateSheetIndex),w=D[k].data;var g=_t.getCellRealSize(w,t,l),v=g[0],x=g[1],_={};m==null&&(m=1),_.lineWidth=m,_.offsetY=m+1,_.height=x-(m+1),_.width=v;var S=function(C,T){T&&(typeof T=="number"&&(T>19&&(T=T%20),T=a[T]),_[C]=T)};if(u==null&&(u="#2ec7c9"),S("lineColor",u),S("fillColor",f),m==null&&(m="1"),_.lineWidth=m,d)if(typeof d=="string"){d=d.toLowerCase();var I=null;d=="min"?I=window.luckysheet_function.MIN.f({data:b}):d=="max"?I=window.luckysheet_function.MAX.f({data:b}):d=="avg"||d=="mean"?I=window.luckysheet_function.AVERAGE.f({data:b}):d=="median"&&(I=window.luckysheet_function.MEDIAN.f({data:b})),I&&(_.normalRangeMin=I,_.normalRangeMax=I)}else _.normalRangeMin=d,_.normalRangeMax=d;p==null&&(p="#000"),S("normalRangeColor",p);var P=Hi.init(b,_);return P}catch(D){var F=D;return F=y.errorInfo(F),[y.error.v,F]}},COLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList,s=arguments[0],u=y.readCellDataToOneArray(s);let F=ur(),D=Me(h.calculateSheetIndex),k=F[D].data;var f=_t.getCellRealSize(k,t,l),m=f[0],d=f[1],p={};p.height=d,p.width=m;var b=function(w,C){C&&(typeof C=="number"&&(C>19&&(C=C%20),C=a[C]),p[w]=C)},g=arguments[1],v=arguments[2],x=arguments[3],_=arguments[4];p.type="column",g==null&&(g="1"),p.barSpacing=g,v==null&&(v="#fc5c5c"),b("barColor",v),x==null&&(x="#97b552"),b("negBarColor",x),_==null||_===!1||typeof _!="number"?p.chartRangeMax=void 0:p.chartRangeMax=_;var S=y.sparklinesColorMap(arguments);S&&(p.colorMap=S);var I=Hi.init(u,p);return I}catch(F){var P=F;return P=y.errorInfo(P),[y.error.v,P]}},STACKCOLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList,s=arguments[0],u=[],f=[];if(s!=null&&s.data!=null&&(f=s.data),G(f)=="array")f=y.getPureValueByData(f);else{if(G(f)=="object")return f=f.v,[f];/\{.*?\}/.test(f)&&(f=f.replace(/\{/g,"[").replace(/\}/g,"]")),f=new Function("return "+f)()}var m=arguments[1],d=f.length;if(m==null||!!m)for(var p=0;p<f[0].length;p++){for(var b="",g=0;g<f.length;g++)b+=f[g][p]+":";b=b.substr(0,b.length-1),u.push(b)}else{for(var g=0;g<f.length;g++){for(var v="",p=0;p<f[0].length;p++)v+=f[g][p]+":";v=v.substr(0,v.length-1),u.push(v)}var d=f[0].length}let T=ur(),O=Me(h.calculateSheetIndex),z=T[O].data;var x=_t.getCellRealSize(z,t,l),_=x[0],S=x[1],I={};I.height=S,I.width=_;var P=function(A,E){E&&(typeof E=="number"&&(E>19&&(E=E%20),E=a[E]),I[A]=E)},F=arguments[2],D=arguments[3];I.type="column",F==null&&(F="1"),I.barSpacing=F,D==null||D===!1||typeof D!="number"?I.chartRangeMax=void 0:I.chartRangeMax=D;var k=y.sparklinesColorMap(arguments,4);k&&(I.colorMap=k);var w=Hi.init(u,I);return w}catch(T){var C=T;return C=y.errorInfo(C),[y.error.v,C]}},BARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList,s=arguments[0],u=y.readCellDataToOneArray(s);let F=ur(),D=Me(h.calculateSheetIndex),k=F[D].data;var f=_t.getCellRealSize(k,t,l),m=f[0],d=f[1],p={};p.height=d,p.width=m;var b=function(w,C){C&&(typeof C=="number"&&(C>19&&(C=C%20),C=a[C]),p[w]=C)},g=arguments[1],v=arguments[2],x=arguments[3],_=arguments[4];p.type="bar",g==null&&(g="1"),p.barSpacing=g,v==null&&(v="#fc5c5c"),b("barColor",v),x==null&&(x="#97b552"),b("negBarColor",x),_==null||_===!1||typeof _!="number"?p.chartRangeMax=void 0:p.chartRangeMax=_;var S=y.sparklinesColorMap(arguments);S&&(p.colorMap=S);var I=Hi.init(u,p);return I}catch(F){var P=F;return P=y.errorInfo(P),[y.error.v,P]}},STACKBARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList,s=arguments[0],u=[],f=[];if(s!=null&&s.data!=null&&(f=s.data),G(f)=="array")f=y.getPureValueByData(f);else{if(G(f)=="object")return f=f.v,[f];/\{.*?\}/.test(f)&&(f=f.replace(/\{/g,"[").replace(/\}/g,"]")),f=new Function("return "+f)()}var m=arguments[1],d=f.length;if(m==null||!!m)for(var p=0;p<f[0].length;p++){for(var b="",g=0;g<f.length;g++)b+=f[g][p]+":";b=b.substr(0,b.length-1),u.push(b)}else{for(var g=0;g<f.length;g++){for(var v="",p=0;p<f[0].length;p++)v+=f[g][p]+":";v=v.substr(0,v.length-1),u.push(v)}var d=f[0].length}let T=ur(),O=Me(h.calculateSheetIndex),z=T[O].data;var x=_t.getCellRealSize(z,t,l),_=x[0],S=x[1],I={};I.height=S,I.width=_;var P=function(A,E){E&&(typeof E=="number"&&(E>19&&(E=E%20),E=a[E]),I[A]=E)},F=arguments[2],D=arguments[3];I.type="bar",F==null&&(F="1"),I.barSpacing=F,D==null||D===!1||typeof D!="number"?I.chartRangeMax=void 0:I.chartRangeMax=D;var k=y.sparklinesColorMap(arguments,4);k&&(I.colorMap=k);var w=Hi.init(u,I);return w}catch(T){var C=T;return C=y.errorInfo(C),[y.error.v,C]}},DISCRETESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList,s=arguments[0],u=y.readCellDataToOneArray(s);let I=ur(),P=Me(h.calculateSheetIndex),F=I[P].data;var f=_t.getCellRealSize(F,t,l),m=f[0],d=f[1],p={};p.height=d,p.width=m;var b=function(D,k){k&&(typeof k=="number"&&(k>19&&(k=k%20),k=a[k]),p[D]=k)},g=arguments[1],v=arguments[2],x=arguments[3];p.type="discrete",g==null&&(g=0),p.thresholdValue=g,v==null&&(v="#2ec7c9"),b("lineColor",v),x==null&&(x="#fc5c5c"),b("thresholdColor",x);var _=Hi.init(u,p);return _}catch(I){var S=I;return S=y.errorInfo(S),[y.error.v,S]}},TRISTATESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList,s=arguments[0],u=y.readCellDataToOneArray(s);let F=ur(),D=Me(h.calculateSheetIndex),k=F[D].data;var f=_t.getCellRealSize(k,t,l),m=f[0],d=f[1],p={};p.height=d,p.width=m;var b=function(w,C){C&&(typeof C=="number"&&(C>19&&(C=C%20),C=a[C]),p[w]=C)},g=arguments[1],v=arguments[2],x=arguments[3],_=arguments[4];p.type="tristate",g==null&&(g="1"),p.barSpacing=g,v==null&&(v="#fc5c5c"),b("barColor",v),x==null&&(x="#97b552"),b("negBarColor",x),_==null&&(_="#999"),b("zeroBarColor",_);var S=y.sparklinesColorMap(arguments);S&&(p.colorMap=S);var I=Hi.init(u,p);return I}catch(F){var P=F;return P=y.errorInfo(P),[y.error.v,P]}},PIESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList,s=arguments[0],u=y.readCellDataToOneArray(s);let P=ur(),F=Me(h.calculateSheetIndex),D=P[F].data;var f=_t.getCellRealSize(D,t,l),m=f[0],d=f[1],p={};p.height=d,p.width=m;var b=function(k,w){w&&(typeof w=="number"&&(w>19&&(w=w%20),w=a[w]),p[k]=w)},g=arguments[1],v=arguments[2],x=arguments[3];p.type="pie",g==null&&(g=0),p.offset=g,v==null&&(v=0),b("borderWidth",v),x==null&&(x="#97b552"),b("borderColor",x);var _=y.sparklinesColorMap(arguments,4);_&&(p.colorMap=_);var S=Hi.init(u,p);return S}catch(P){var I=P;return I=y.errorInfo(I),[y.error.v,I]}},BOXSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList,s=arguments[0],u=y.readCellDataToOneArray(s);let I=ur(),P=Me(h.calculateSheetIndex),F=I[P].data;var f=_t.getCellRealSize(F,t,l),m=f[0],d=f[1],p={};p.height=d,p.width=m;var b=function(D,k){k&&(typeof k=="number"&&(k>19&&(k=k%20),k=a[k]),p[D]=k)},g=arguments[1],v=arguments[2],x=arguments[3];p.type="box",g==null&&(g=1.5),p.outlierIQR=g,v==null?v=0:b("target",v),x==null&&(x=1.5),b("spotRadius",x);var _=Hi.init(u,p);return _}catch(I){var S=I;return S=y.errorInfo(S),[y.error.v,S]}},BULLETSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentFunction,a=y.colorList;let _=ur(),S=Me(h.calculateSheetIndex),I=_[S].data;var s=_t.getCellRealSize(I,t,l),u=s[0],f=s[1],m={};m.height=f,m.width=u;var d=function(P,F){F&&(typeof F=="number"&&(F>19&&(F=F%20),F=a[F]),m[P]=F)},p=[];ls(arguments);var b=y.getValueByFuncData(arguments[0]),g=y.getValueByFuncData(arguments[1]);p.push(b),p.push(g);for(var e=2;e<arguments.length;e++)p.push(y.getValueByFuncData(arguments[e]));m.type="bullet";var v=Hi.init(p,m);return v}catch(_){var x=_;return x=y.errorInfo(x),[y.error.v,x]}},SORT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[],o=1,a=1;if(G(t)=="array")if(G(t[0])=="array"){if(!q.isDyadicArr(t))return y.error.v;for(var e=0;e<t.length;e++){for(var s=[],u=0;u<t[e].length;u++){var f=t[e][u];s.push(f)}l.push(s)}o=l.length,a=l[0].length}else{for(var e=0;e<t.length;e++){var f=t[e];l.push(f)}o=l.length}else if(G(t)=="object"&&t.startCell!=null)if(t.data!=null)if(G(t.data)=="array"){for(var e=0;e<t.data.length;e++){for(var s=[],u=0;u<t.data[e].length;u++)if(t.data[e][u]!=null){var f=t.data[e][u].v;ft(f)&&(f=0),s.push(f)}else s.push(0);l.push(s)}o=l.length,a=l[0].length}else{var f=t.data.v;ft(f)&&(f=0),l.push(f)}else l.push(0);else{var f=t;l.push(f)}var m=1;if(arguments.length>=2){if(m=q.getFirstValue(arguments[1]),re(m))return m;if(!K(m))return y.error.v;m=parseInt(m)}var d=1;if(arguments.length>=3){if(d=q.getFirstValue(arguments[2]),re(d))return d;if(!K(d))return y.error.v;d=Math.floor(parseFloat(d))}var p=!1;if(arguments.length==4&&(p=q.getCellBoolen(arguments[3]),re(p)))return p;if(p){if(m<1||m>o)return y.error.v}else if(m<1||m>a)return y.error.v;if(d!=1&&d!=-1)return y.error.v;var b=function(x,_){if(G(x)=="array"&&(x=x[m-1]),G(_)=="array"&&(_=_[m-1]),!isNaN(x)&&!isNaN(_))return x-_;if(isNaN(x))if(isNaN(_)){if(x>_)return 1;if(x<_)return-1}else return 1;else return-1},g=function(x,_){if(G(x)=="array"&&(x=x[m-1]),G(_)=="array"&&(_=_[m-1]),!isNaN(x)&&!isNaN(_))return _-x;if(isNaN(x))if(isNaN(_)){if(x>_)return-1;if(x<_)return 1}else return-1;else return 1};return p?(l=l[0].map(function(x,_){return l.map(function(S){return S[_]})}),d==1&&l.sort(b),d==-1&&l.sort(g),l=l[0].map(function(x,_){return l.map(function(S){return S[_]})})):(d==1&&l.sort(b),d==-1&&l.sort(g)),l}catch(x){var v=x;return v=y.errorInfo(v),[y.error.v,v]}},FILTER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=q.getDataDyadicArr(t)}else if(G(t)=="object"&&t.startCell!=null)l=q.getCellDataDyadicArr(t,"number");else{var o=[];o.push(parseFloat(t)),l.push(o)}var a=l.length,s=l[0].length,u=arguments[1],f=[],m="row";if(G(u)=="array")if(G(u[0])=="array"){if(!q.isDyadicArr(u))return y.error.v;if(u.length>1&&u[0].length>1)return y.error.v;if(u.length>1){if(u.length!=l.length)return y.error.v;m="row";for(var e=0;e<u.length;e++){var d=u[e][0];if(G(d)!="boolean")if(G(d)=="string"&&(d.toLowerCase()=="true"||d.toLowerCase()=="false"))d.toLowerCase()=="true"?d=!0:d.toLowerCase()=="false"&&(d=!1);else if(K(d))d=parseFloat(d),d=d!=0;else return y.error.v;f.push(d)}}if(u[0].length>1){if(u[0].length!=l[0].length)return y.error.v;m="col";for(var e=0;e<u[0].length;e++){var d=u[0][e];if(G(d)!="boolean")if(G(d)=="string"&&(d.toLowerCase()=="true"||d.toLowerCase()=="false"))d.toLowerCase()=="true"?d=!0:d.toLowerCase()=="false"&&(d=!1);else if(K(d))d=parseFloat(d),d=d!=0;else return y.error.v;f.push(d)}}}else{if(u.length!=l[0].length)return y.error.v;m="col";for(var e=0;e<u.length;e++){var d=u[e];if(G(d)!="boolean")if(G(d)=="string"&&(d.toLowerCase()=="true"||d.toLowerCase()=="false"))d.toLowerCase()=="true"?d=!0:d.toLowerCase()=="false"&&(d=!1);else if(K(d))d=parseFloat(d),d=d!=0;else return y.error.v;f.push(d)}}else if(G(u)=="object"&&u.data!=null&&G(u.data)=="array"){if(u.data.length>1&&u.data[0].length>1)return y.error.v;if(u.data.length>1){if(u.data.length!=l.length)return y.error.v;m="row";for(var e=0;e<u.data.length;e++){var d=u.data[e][0].v;if(ft(d)&&(d=0),G(d)!="boolean")if(G(d)=="string"&&(d.toLowerCase()=="true"||d.toLowerCase()=="false"))d.toLowerCase()=="true"?d=!0:d.toLowerCase()=="false"&&(d=!1);else if(K(d))d=parseFloat(d),d=d!=0;else return y.error.v;f.push(d)}}if(u.data[0].length>1){if(u.data[0].length!=l[0].length)return y.error.v;m="col";for(var e=0;e<u.data[0].length;e++){var d=u.data[0][e].v;if(ft(d)&&(d=0),G(d)!="boolean")if(G(d)=="string"&&(d.toLowerCase()=="true"||d.toLowerCase()=="false"))d.toLowerCase()=="true"?d=!0:d.toLowerCase()=="false"&&(d=!1);else if(K(d))d=parseFloat(d),d=d!=0;else return y.error.v;f.push(d)}}}else return y.error.v;var p="";if(arguments.length==3&&(p=q.getFirstValue(arguments[2],"text"),re(p)))return p;var b=[];if(m=="row")for(var e=0;e<l.length;e++)f[e]&&b.push(l[e]);else for(var e=0;e<l.length;e++){for(var o=[],g=0;g<l[0].length;g++)f[g]&&o.push(l[e][g]);o.length>0&&b.push(o)}return b.length==0?p:b}catch(x){var v=x;return v=y.errorInfo(v),[y.error.v,v]}},UNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=arguments[0],l=[];if(G(t)=="array"){if(G(t[0])=="array"&&!q.isDyadicArr(t))return y.error.v;l=q.getDataDyadicArr(t)}else if(G(t)=="object"&&t.startCell!=null)l=q.getCellDataDyadicArr(t,"number");else{var o=[];o.push(parseFloat(t)),l.push(o)}var a=!1;if(arguments.length>=2&&(a=q.getCellBoolen(arguments[1]),re(a)))return a;var s=!1;if(arguments.length==3&&(s=q.getCellBoolen(arguments[2]),re(s)))return s;if(a){l=l[0].map(function(v,x){return l.map(function(_){return _[x]})});for(var u={},f=[],m=[],e=0;e<l.length;e++){for(var d="",p=0;p<l[e].length;p++)d+=l[e][p].toString()+"|||";f.push(d),d in u||(u[d]=0,m.push(l[e]))}if(s){for(var b=[],e=0;e<f.length;e++)f.indexOf(f[e])==f.lastIndexOf(f[e])&&b.push(l[e]);return b=b[0].map(function(v,x){return b.map(function(_){return _[x]})}),b}else return m=m[0].map(function(v,x){return m.map(function(_){return _[x]})}),m}else{for(var u={},f=[],m=[],e=0;e<l.length;e++){for(var d="",p=0;p<l[e].length;p++)d+=l[e][p].toString()+"|||";f.push(d),d in u||(u[d]=0,m.push(l[e]))}if(s){for(var b=[],e=0;e<f.length;e++)f.indexOf(f[e])==f.lastIndexOf(f[e])&&b.push(l[e]);return b}else return m}}catch(v){var g=v;return g=y.errorInfo(g),[y.error.v,g]}},RANDARRAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=1;if(arguments.length>=1){if(t=q.getFirstValue(arguments[0]),re(t))return t;if(!K(t))return y.error.v;t=parseInt(t)}var l=1;if(arguments.length==2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}if(t<=0||l<=0)return y.error.v;for(var o=[],e=0;e<t;e++){for(var a=[],s=0;s<l;s++)a.push(Math.random().toFixed(9));o.push(a)}return o}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},SEQUENCE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=q.getFirstValue(arguments[0]);if(re(t))return t;if(!K(t))return y.error.v;t=parseInt(t);var l=1;if(arguments.length>=2){if(l=q.getFirstValue(arguments[1]),re(l))return l;if(!K(l))return y.error.v;l=parseInt(l)}var o=1;if(arguments.length>=3){if(o=q.getFirstValue(arguments[2]),re(o))return o;if(!K(o))return y.error.v;o=parseFloat(o)}var a=1;if(arguments.length==4){if(a=q.getFirstValue(arguments[3]),re(a))return a;if(!K(a))return y.error.v;a=parseFloat(a)}if(t<=0||l<=0)return y.error.v;for(var s=[],e=0;e<t;e++){for(var u=[],f=0;f<l;f++){var m=o+a*(f+l*e);u.push(m)}s.push(u)}return s}catch(p){var d=p;return d=y.errorInfo(d),[y.error.v,d]}},EVALUATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;for(var e=0;e<arguments.length;e++){var n=y.errorParamCheck(this.p,arguments[e],e);if(!n[0])return y.error.v}try{var t=window.luckysheetCurrentRow,l=window.luckysheetCurrentColumn,o=window.luckysheetCurrentIndex,a=q.getFirstValue(arguments[0]).toString();if(re(a))return a;a.trim().indexOf("=")!=0&&(a="="+a);var s=y.execstringformula(a,t,l,o);return s[1]}catch(f){var u=f;return u=y.errorInfo(u),[y.error.v,u]}},REMOTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return y.error.na;try{let n=window.luckysheetCurrentRow,t=window.luckysheetCurrentColumn,l=window.luckysheetCurrentFunction,o=q.getFirstValue(arguments[0]);return re(o)?o:(ut.remoteFunction(o,a=>{let s=It.deepCopyFlowData(h.flowdata);y.execFunctionGroup(n,t,a),s[n][t]={v:a,f:l},al(s,[{row:[n,n],column:[t,t]}])}),"Loading...")}catch(n){console.log(n);var e=n;return e=y.errorInfo(e),[y.error.v,e]}}},_k=__});var import_plugin,C_,$k,Sk=Nt(()=>{import_plugin=qe(Ye());Ck();il();Xl();C_=function(){let n=Be().functionlist;for(let l=0;l<n.length;l++){let o=n[l];o.f=_k[o.n]}h.functionlist=n;let t={};for(let l=0;l<n.length;l++){let o=n[l];t[o.n]=o}window.luckysheet_function=t,h.luckysheet_function=t},$k=C_});function $_(e,n){let t=kt.getSheetByIndex();t.config==null&&(t.config={}),t.config.sheetViewZoom==null&&(t.config.sheetViewZoom={});let l=1,o="zoomScaleNormal";S_(t),e=="viewNormal"?o="viewNormalZoomScale":e=="viewLayout"?o="viewLayoutZoomScale":e=="viewPage"&&(o="viewPageZoomScale",l=.6,I_(t));let a=t.config.sheetViewZoom[o];a==null&&(a=l),t.config.curentsheetView=e,h.clearjfundo&&h.jfredo.push({type:"viewChange",curType:e,preType:n,sheetIndex:h.currentSheetIndex}),Ue.saveParam("cg",h.currentSheetIndex,e,{k:"curentsheetView"}),h.currentSheetView=e,rs(a)}function S_(e){}function I_(e){}function T_(e){let n=e.parent(),t=n.find("luckysheet-print-viewBtn-active").attr("type");if(e.attr("type")==t)return;let l=e.attr("type");if(l!=null)$_(l,t);else return;e.parent().find(".luckysheet-print-viewBtn").removeClass("luckysheet-print-viewBtn-active"),e.addClass("luckysheet-print-viewBtn-active")}function Ik(){let e=ut.container,n=this;$("#"+e).find(".luckysheet-print-viewBtn").click(function(){T_($(this))})}var import_plugin,Tk=Nt(()=>{import_plugin=qe(Ye());Vn();fu();kn();qr();Ri();il()});var Fk=Fn((Qh,Rk)=>{var import_plugin=qe(Ye());(function(e,n){typeof Qh=="object"&&typeof Rk!="undefined"?n(Qh):typeof define=="function"&&define.amd?define(["exports"],n):(e=typeof globalThis!="undefined"?globalThis:e||self,n(e.zh={}))})(Qh,function(e){"use strict";var n=typeof window!="undefined"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},t={weekdays:{shorthand:["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],longhand:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"]},months:{shorthand:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"],longhand:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"]},rangeSeparator:" \u81F3 ",weekAbbreviation:"\u5468",scrollTitle:"\u6EDA\u52A8\u5207\u6362",toggleTitle:"\u70B9\u51FB\u5207\u6362 12/24 \u5C0F\u65F6\u65F6\u5236"};n.l10ns.zh=t;var l=n.l10ns;e.Mandarin=t,e.default=l,Object.defineProperty(e,"__esModule",{value:!0})})});function R_(e){clearTimeout(Mk),Mk=setTimeout(()=>{$("#luckysheet-icon-undo")[e?"removeClass":"addClass"]("disabled")},10)}function F_(e){clearTimeout(Dk),Dk=setTimeout(()=>{$("#luckysheet-icon-redo")[e?"removeClass":"addClass"]("disabled")},10)}var import_plugin,Mk,Dk,Ak,zk=Nt(()=>{import_plugin=qe(Ye());Ol();il();wi();fr();mc();Ak=function(){Zh(h,"jfredo",(e,n,t,l)=>{n!=="length"&&sl.createHookFunction("updated",t),R_(h.jfredo.length)}),Zh(h,"jfundo",(e,n,t,l)=>{F_(h.jfundo.length)}),Zh(h,"asyncLoad",(e,n,t,l)=>{n==="length"&&t===0&&sl.createHookFunction("workbookCreateAfter",Uh())})}});function Pk(){Bg(),Ey(),lk(),sk(),uk(),hk(),gk(),vk(),C1(),Ik(),Ak()}var import_plugin,Ok,xn,Ek=Nt(()=>{import_plugin=qe(Ye());o0();Ol();il();Xl();qr();Vn();kn();ho();tk();Ja();rk();ck();fk();dk();pk();yk();xk();fr();gs();Ar();Sk();Rr();Er();Do();jr();fu();Tk();wi();mc();_g();Ok=qe(Fk());zk();Im();sc();xn={};xn=Ng(Ag,xn);xn.create=function(e){sl.destroy(),h.toJsonOptions={};for(let f in e)f!=="data"&&(h.toJsonOptions[f]=e[f]);let n=Ng(i0,e),t=n.loadUrl,l=n.menu,o=n.title,a=n.container;h.container=a,h.luckysheetfile=n.data,h.defaultcolumnNum=n.column,h.defaultrowNum=n.row,h.defaultFontSize=n.defaultFontSize,h.fullscreenmode=n.fullscreenmode,h.lang=n.lang,h.allowEdit=n.allowEdit,h.limitSheetNameLength=n.limitSheetNameLength,h.defaultSheetNameMaxLength=n.defaultSheetNameMaxLength,h.fontList=n.fontList,Ue.gridKey=n.gridKey,Ue.loadUrl=n.loadUrl,Ue.updateUrl=n.updateUrl,Ue.updateImageUrl=n.updateImageUrl,Ue.title=n.title,Ue.loadSheetUrl=n.loadSheetUrl,Ue.allowUpdate=n.allowUpdate,ut.autoFormatw=n.autoFormatw,ut.accuracy=n.accuracy,ut.total=n.data[0].total,ut.loading=n.loading,ut.allowCopy=n.allowCopy,ut.showtoolbar=n.showtoolbar,ut.showtoolbarConfig=n.showtoolbarConfig,ut.showinfobar=n.showinfobar,ut.showsheetbar=n.showsheetbar,ut.showsheetbarConfig=n.showsheetbarConfig,ut.showstatisticBar=n.showstatisticBar,ut.showstatisticBarConfig=n.showstatisticBarConfig,ut.sheetFormulaBar=n.sheetFormulaBar,ut.cellRightClickConfig=n.cellRightClickConfig,ut.sheetRightClickConfig=n.sheetRightClickConfig,ut.pointEdit=n.pointEdit,ut.pointEditUpdate=n.pointEditUpdate,ut.pointEditZoom=n.pointEditZoom,ut.userInfo=n.userInfo,ut.userMenuItem=n.userMenuItem,ut.myFolderUrl=n.myFolderUrl,ut.functionButton=n.functionButton,ut.showConfigWindowResize=n.showConfigWindowResize,ut.enableAddRow=n.enableAddRow,ut.enableAddBackTop=n.enableAddBackTop,ut.addRowCount=n.addRowCount,ut.enablePage=n.enablePage,ut.pageInfo=n.pageInfo,ut.editMode=n.editMode,ut.beforeCreateDom=n.beforeCreateDom,ut.workbookCreateBefore=n.workbookCreateBefore,ut.workbookCreateAfter=n.workbookCreateAfter,ut.remoteFunction=n.remoteFunction,ut.fireMousedown=n.fireMousedown,ut.forceCalculation=n.forceCalculation,ut.plugins=n.plugins,ut.rowHeaderWidth=n.rowHeaderWidth,ut.columnHeaderHeight=n.columnHeaderHeight,ut.defaultColWidth=n.defaultColWidth,ut.defaultRowHeight=n.defaultRowHeight,ut.title=n.title,ut.container=n.container,ut.hook=n.hook,ut.pager=n.pager,ut.initShowsheetbarConfig=!1,ut.imageUpdateMethodConfig=n.imageUpdateMethodConfig,h.lang==="zh"&&jh.localize(Ok.default.zh),h.asyncLoad.push(...ut.plugins),wk(n.plugins,n.data),$k();let s=n.devicePixelRatio;s==null&&(s=1),h.devicePixelRatio=Math.ceil(s);let u=Wo("#"+a);h.loadingObj=u,t==""?(kt.initialjfFile(l,o),Pk()):$.post(t,{gridKey:Ue.gridKey},function(f){let m=new Function("return "+f)();h.luckysheetfile=m,kt.initialjfFile(l,o),Pk(),Ue.allowUpdate&&Ue.openWebSocket()})};xn.getluckysheetfile=ur;xn.getluckysheet_select_save=$0;xn.setluckysheet_select_save=I0;xn.getconfig=S0;xn.getGridData=kt.getGridData;xn.buildGridData=kt.buildGridData;xn.luckysheetrefreshgrid=Xt;xn.jfrefreshgrid=al;xn.getcellvalue=Vt;xn.setcellvalue=kr;xn.getdatabyselection=hr;xn.sheetmanage=kt;xn.flowdata=function(){return h.flowdata};xn.selectHightlightShow=gl;xn.destroy=sl.destroy;xn.showLoadingProgress=Uc;xn.hideLoadingProgress=Ku;xn.luckysheetextendData=xh;xn.locales=Wd});function M_(){HTMLElement.prototype.__defineGetter__("runtimeStyle",D_),window.constructor.prototype.__defineGetter__("event",A_),Event.prototype.__defineGetter__("srcElement",z_)}function D_(){return this.style}function A_(){return Nk()}function z_(){return this.target}function Nk(){if(document.all)return window.event;for(var e=Nk.caller;e!=null;){var n=e.arguments[0];if(n){var t=n.constructor;if(t.toString().indexOf("Event")!=-1)return n}e=e.caller}return null}var import_plugin,Lk,Hk=Nt(()=>{import_plugin=qe(Ye());Lk=M_});var O_=Fn((fL,jk)=>{var import_plugin=qe(Ye());n0();Ek();Hk();window.addEventListener&&navigator.userAgent.indexOf("Firefox")>0&&Lk();jk.exports=xn});return O_();})();
/*!
 * jQuery JavaScript Library v2.2.4
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-05-20T17:23Z
 */
/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */
